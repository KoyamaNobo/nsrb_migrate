000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JTN71U.
000030*********************************************************
000040*    PROGRAM         :  上海成型生協出荷データ抽出      *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT JNSR ASSIGN TO JNSR1-MSD JNSR2-MSD JNSR3-MSD
000170         ORGANIZATION IS INDEXED
000180         ACCESS MODE IS DYNAMIC
000190         RECORD KEY IS JNSR-KEY1
000200         ALTERNATE RECORD KEY IS JNSR-KEY2
000210         ALTERNATE RECORD KEY IS JNSR-KEY3
000220         FILE STATUS IS ERR-STAT.
000230     SELECT JNSRW ASSIGN TO JNSRW-MSD.
000240 I-O-CONTROL.
000250     APPLY SHARED-MODE ON M-DATE
000260     APPLY SHARED-MODE ON JNSR.
000270 DATA DIVISION.
000280 FILE SECTION.
000290     COPY LIBFDD.
000300     COPY L-JNSR.
000310 FD  JNSRW
000320     BLOCK    2     RECORDS
000330     LABEL    RECORD   STANDARD
000340     VALUE     OF  IDENTIFICATION  WK0128ID.
000350 01  JNSRW-R.
000360     02  JNSRW-HCD      PIC  9(006).
000370     02  JNSRW-TCD      PIC  9(004).
000380     02  JNSRW-CCD      PIC  9(003).
000390     02  JNSRW-NSC      PIC  9(002).
000400     02  JNSRW-SIZ      PIC  9(001).
000410     02  JNSRW-ASU.
000420       03  JNSRW-SUD   OCCURS  10.
000430         04  JNSRW-SU   PIC S9(004).
000440     02  JNSRW-DATE     PIC  9(008).
000450     02  F              PIC  X(064).
000460 WORKING-STORAGE SECTION.
000470 77  W-ME               PIC  X(040).
000480 77  WK0128ID           PIC  X(009) VALUE SPACE.
000490 01  STN-NO.
000500     02  STN-NO1        PIC  X(003).
000510     02  STN-NO2        PIC  X(003).
000520 01  W-FID.
000530     02  W-FID1         PIC  X(006) VALUE "WK0128".
000540     02  W-FID2         PIC  X(003).
000550 01  W-DATA.
000560     02  W-DC           PIC  9(001).
000570     02  W-AHCD.
000580       03  W-HCDD  OCCURS  20.
000590         04  W-HCD      PIC  9(004).
000600     02  W-HCDC.
000610       03  F            PIC  X(040) VALUE
000620            "6266629767060000000000000000000000000000".
000630       03  F            PIC  X(040) VALUE
000640            "0000000000000000000000000000000000000000".
000650     02  CNT            PIC  9(002).
000660     02  W-SHCD         PIC  9(006).
000670     02  W-SHCDD  REDEFINES  W-SHCD.
000680       03  W-SHCD1      PIC  9(004).
000690       03  W-SHCD2      PIC  9(002).
000700     02  W-EHCD         PIC  9(006).
000710     02  W-EHCDD  REDEFINES  W-EHCD.
000720       03  W-EHCD1      PIC  9(004).
000730       03  W-EHCD2      PIC  9(002).
000740 01  ERR-STAT           PIC  X(002).
000750 SCREEN  SECTION.
000760 SD  C-CRT
000770     END STATUS IS ESTAT.
000780 01  C-CLEAR.
000790     02  C-CL    LINE   1  CLEAR SCREEN.
000800 01  C-MID.
000810     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
000820          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000830     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
000840          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000850     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
000860          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
000870     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
000880          NC"＊＊＊　　上海生協　出荷データ　抽出　　＊＊＊".
000890     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
000900          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
000910     02  LINE   8  COLUMN  10  PIC  N(023) VALUE
000920          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000930     02  LINE   9  COLUMN  10  PIC  N(023) VALUE
000940          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000950 01  C-ERR.
000960     02  LINE  24.
000970       03  E-ME    COLUMN  15  PIC  X(040) FROM  W-ME.
000980       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000990       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001000       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
001010       03  E-CL.
001020         04  COLUMN   1  PIC  X(040) VALUE
001030              "                                        ".
001040         04  COLUMN  41  PIC  X(040) VALUE
001050              "                                        ".
001060     COPY LIBSCR.
001070 PROCEDURE DIVISION.
001080 M-05.
001090     DISPLAY C-CLEAR.
001100     DISPLAY C-MID.
001110     COPY LIBCPR.
001120*
001130     CALL "CBLSTNNO" USING STN-NO.
001140     MOVE STN-NO2 TO W-FID2.
001150     MOVE W-FID TO WK0128ID.
001160     OPEN OUTPUT JNSRW.
001170     OPEN INPUT JNSR.
001180     MOVE W-HCDC TO W-AHCD.
001190     MOVE 00 TO W-SHCD2.
001200     MOVE 99 TO W-EHCD2.
001210     MOVE ZERO TO CNT.
001220 M-10.
001230     ADD 1 TO CNT.
001240     IF CNT > 40
001250         GO TO M-90.
001260     IF W-HCD(CNT) = ZERO
001270         GO TO M-90.
001280     MOVE W-HCD(CNT) TO W-SHCD1 W-EHCD1.
001290*
001300     MOVE SPACE TO JNSR-KEY1.
001310     MOVE W-SHCD TO JNSR-01.
001320     START JNSR KEY NOT < JNSR-KEY1 INVALID KEY
001330         GO TO M-10.
001340 M-15.
001350     READ JNSR NEXT RECORD WITH UNLOCK AT END
001360         GO TO M-10.
001370     IF JNSR-01 > W-EHCD
001380         GO TO M-10.
001390*
001400     INITIALIZE JNSRW-R.
001410     MOVE JNSR-01  TO JNSRW-HCD.
001420     MOVE JNSR-111 TO JNSRW-TCD.
001430     MOVE JNSR-112 TO JNSRW-CCD.
001440     MOVE JNSR-03  TO JNSRW-NSC.
001450     MOVE JNSR-07  TO JNSRW-SIZ.
001460     MOVE JNSR-081(01) TO JNSRW-SU(01).
001470     MOVE JNSR-081(02) TO JNSRW-SU(02).
001480     MOVE JNSR-081(03) TO JNSRW-SU(03).
001490     MOVE JNSR-081(04) TO JNSRW-SU(04).
001500     MOVE JNSR-081(05) TO JNSRW-SU(05).
001510     MOVE JNSR-081(06) TO JNSRW-SU(06).
001520     MOVE JNSR-081(07) TO JNSRW-SU(07).
001530     MOVE JNSR-081(08) TO JNSRW-SU(08).
001540     MOVE JNSR-081(09) TO JNSRW-SU(09).
001550     MOVE JNSR-081(10) TO JNSRW-SU(10).
001560     MOVE JNSR-02  TO JNSRW-DATE.
001570     WRITE JNSRW-R.
001580     GO TO M-15.
001590 M-90.
001600     CLOSE JNSR.
001610     CLOSE JNSRW.
001620 M-95.
001630     DISPLAY C-CLEAR.
001640     STOP RUN.
