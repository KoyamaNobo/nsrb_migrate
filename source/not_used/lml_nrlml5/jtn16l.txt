000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JTN16U.
000030*********************************************************
000040*    PROGRAM         :  生協出荷予定変換リスト          *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT HI2-M ASSIGN TO HI-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY HI-KEY2
000200         FILE STATUS IS ERR-STAT.
000210     SELECT TC-M ASSIGN TO TC-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY TC-KEY
000250         FILE STATUS IS ERR-STAT.
000260     SELECT SSYF ASSIGN TO SSY-MSD.
000270     SELECT SP-F ASSIGN TO P-PRN999.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON M-DATE
000300     APPLY SHARED-MODE ON HI2-M
000310     APPLY SHARED-MODE ON TC-M
000320     APPLY SHIFT-CODE  ON SP-F.
000330 DATA DIVISION.
000340 FILE SECTION.
000350     COPY LIBFDD.
000360     COPY LIHIM2.
000370     COPY LITCM.
000380     COPY LSPF.
000390 FD  SSYF
000400     BLOCK  2 RECORDS
000410     LABEL RECORD IS STANDARD
000420     VALUE OF IDENTIFICATION WK0128ID.
000430 01  SSY-R.
000440     02  SSY-KEY.
000450       03  SSY-HCD      PIC  9(006).
000460       03  SSY-TCD      PIC  9(004).
000470       03  SSY-ND       PIC  9(008).
000480       03  SSY-SIZ      PIC  9(001).
000490     02  SSY-ASU.
000500       03  SSY-SUD   OCCURS  10.
000510         04  SSY-SU     PIC S9(006).
000520     02  F              PIC  X(049).
000530 WORKING-STORAGE SECTION.
000540 77  ERR-STAT           PIC  X(002).
000550 77  W-FILE             PIC  X(013).
000560 77  WK0128ID           PIC  X(009) VALUE SPACE.
000570 01  STN-NO.
000580     02  STN-NO1        PIC  X(003).
000590     02  STN-NO2        PIC  X(003).
000600 01  W-FID.
000610     02  W-FID1         PIC  X(006) VALUE "WK0128".
000620     02  W-FID2         PIC  X(003).
000630 01  HEAD1.
000640     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000650     02  F              PIC  X(028) VALUE SPACE.
000660     02  F              PIC  N(023) VALUE
000670          NC"＊＊＊　　生協　出荷予定　変換リスト　　＊＊＊".
000680     02  F              PIC  X(015) VALUE SPACE.
000690     02  F              PIC  X(005) VALUE "DATE ".
000700     02  H-DATE         PIC 99B99B99.
000710     02  F              PIC  X(007) VALUE "     P.".
000720     02  H-PAGE         PIC Z9.
000730 01  HEAD2.
000740     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
000750     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".
000760     02  F              PIC  N(006) VALUE NC"品　　　名　".
000770     02  F              PIC  X(095) VALUE SPACE.
000780 01  HEAD3.
000790     02  F              PIC  X(006) VALUE SPACE.
000800     02  F              PIC  X(005) VALUE "ｺｰﾄﾞ ".
000810     02  F              PIC  N(008) VALUE NC"得　意　先　名　".
000820     02  F              PIC  X(088) VALUE SPACE.
000830 01  HEAD4.
000840     02  F              PIC  X(023) VALUE SPACE.
000850     02  F              PIC  N(004) VALUE NC"　納入日".
000860     02  F              PIC  X(003) VALUE SPACE.
000870     02  F              PIC  X(001) VALUE "1".
000880     02  F              PIC  X(004) VALUE SPACE.
000890     02  F              PIC  N(002) VALUE NC"３号".
000900     02  F              PIC  X(004) VALUE SPACE.
000910     02  F              PIC  N(002) VALUE NC"２号".
000920     02  F              PIC  X(005) VALUE SPACE.
000930     02  F              PIC  X(002) VALUE "SS".
000940     02  F              PIC  X(006) VALUE SPACE.
000950     02  F              PIC  X(001) VALUE "S".
000960     02  F              PIC  X(006) VALUE SPACE.
000970     02  F              PIC  X(001) VALUE "M".
000980     02  F              PIC  X(006) VALUE SPACE.
000990     02  F              PIC  X(001) VALUE "L".
001000     02  F              PIC  X(005) VALUE SPACE.
001010     02  F              PIC  X(002) VALUE "LL".
001020     02  F              PIC  X(005) VALUE SPACE.
001030     02  F              PIC  X(002) VALUE "XL".
001040     02  F              PIC  X(004) VALUE SPACE.
001050     02  F              PIC  X(003) VALUE "XXL".
001060     02  F              PIC  X(003) VALUE SPACE.
001070     02  F              PIC  X(004) VALUE "30.0".
001080     02  F              PIC  X(008) VALUE SPACE.
001090 01  HEAD5.
001100     02  F              PIC  X(032) VALUE SPACE.
001110     02  F              PIC  X(001) VALUE "2".
001120     02  F              PIC  X(003) VALUE SPACE.
001130     02  F              PIC  X(004) VALUE "12.5".
001140     02  F              PIC  X(003) VALUE SPACE.
001150     02  F              PIC  X(004) VALUE "13.0".
001160     02  F              PIC  X(003) VALUE SPACE.
001170     02  F              PIC  X(004) VALUE "13.5".
001180     02  F              PIC  X(003) VALUE SPACE.
001190     02  F              PIC  X(004) VALUE "14.0".
001200     02  F              PIC  X(003) VALUE SPACE.
001210     02  F              PIC  X(004) VALUE "15.0".
001220     02  F              PIC  X(003) VALUE SPACE.
001230     02  F              PIC  X(004) VALUE "16.0".
001240     02  F              PIC  X(003) VALUE SPACE.
001250     02  F              PIC  X(004) VALUE "17.0".
001260     02  F              PIC  X(003) VALUE SPACE.
001270     02  F              PIC  X(004) VALUE "18.0".
001280     02  F              PIC  X(003) VALUE SPACE.
001290     02  F              PIC  X(004) VALUE "19.0".
001300     02  F              PIC  X(003) VALUE SPACE.
001310     02  F              PIC  X(004) VALUE "20.0".
001320     02  F              PIC  X(008) VALUE SPACE.
001330 01  HEAD6.
001340     02  F              PIC  X(032) VALUE SPACE.
001350     02  F              PIC  X(001) VALUE "3".
001360     02  F              PIC  X(003) VALUE SPACE.
001370     02  F              PIC  X(004) VALUE "21.0".
001380     02  F              PIC  X(003) VALUE SPACE.
001390     02  F              PIC  X(004) VALUE "21.5".
001400     02  F              PIC  X(003) VALUE SPACE.
001410     02  F              PIC  X(004) VALUE "22.0".
001420     02  F              PIC  X(003) VALUE SPACE.
001430     02  F              PIC  X(004) VALUE "22.5".
001440     02  F              PIC  X(003) VALUE SPACE.
001450     02  F              PIC  X(004) VALUE "23.0".
001460     02  F              PIC  X(003) VALUE SPACE.
001470     02  F              PIC  X(004) VALUE "23.5".
001480     02  F              PIC  X(003) VALUE SPACE.
001490     02  F              PIC  X(004) VALUE "24.0".
001500     02  F              PIC  X(003) VALUE SPACE.
001510     02  F              PIC  X(004) VALUE "24.5".
001520     02  F              PIC  X(003) VALUE SPACE.
001530     02  F              PIC  X(004) VALUE "25.0".
001540     02  F              PIC  X(015) VALUE SPACE.
001550 01  HEAD7.
001560     02  F              PIC  X(032) VALUE SPACE.
001570     02  F              PIC  X(001) VALUE "4".
001580     02  F              PIC  X(003) VALUE SPACE.
001590     02  F              PIC  X(004) VALUE "24.0".
001600     02  F              PIC  X(003) VALUE SPACE.
001610     02  F              PIC  X(004) VALUE "24.5".
001620     02  F              PIC  X(003) VALUE SPACE.
001630     02  F              PIC  X(004) VALUE "25.0".
001640     02  F              PIC  X(003) VALUE SPACE.
001650     02  F              PIC  X(004) VALUE "25.5".
001660     02  F              PIC  X(003) VALUE SPACE.
001670     02  F              PIC  X(004) VALUE "26.0".
001680     02  F              PIC  X(003) VALUE SPACE.
001690     02  F              PIC  X(004) VALUE "26.5".
001700     02  F              PIC  X(003) VALUE SPACE.
001710     02  F              PIC  X(004) VALUE "27.0".
001720     02  F              PIC  X(003) VALUE SPACE.
001730     02  F              PIC  X(004) VALUE "27.5".
001740     02  F              PIC  X(019) VALUE SPACE.
001750     02  F              PIC  N(002) VALUE NC"合計".
001760 01  W-P1.
001770     02  P-HCD          PIC  9(006).
001780     02  F              PIC  X(001).
001790     02  P-HNA          PIC  N(024).
001800     02  F              PIC  X(068).
001810 01  W-P2.
001820     02  F              PIC  X(006).
001830     02  P-TCD          PIC  9(004).
001840     02  F              PIC  X(001).
001850     02  P-TNA          PIC  N(026).
001860     02  F              PIC  X(061).
001870 01  W-P3.
001880     02  F              PIC  X(010).
001890     02  P-TM           PIC  N(008).
001900     02  P-ND           PIC 99/99/99.
001910     02  F              PIC  X(002).
001920     02  P-SIZ          PIC  9(001).
001930     02  P-SUD.
001940       03  P-SU         PIC ---,---  OCCURS  10.
001950     02  P-SUT          PIC ----,--9.
001960 01  W-DATA.
001970     02  W-PAGE         PIC  9(002).
001980     02  W-EC           PIC  9(001).
001990     02  W-HCD          PIC  9(006).
002000     02  W-TCD          PIC  9(004).
002010     02  W-ND           PIC  9(008).
002020     02  W-NDL   REDEFINES W-ND.
002030       03  F            PIC  9(002).
002040       03  W-NDS        PIC  9(006).
002050       03  W-NDSD  REDEFINES W-NDS.
002060         04  W-NNEN     PIC  9(002).
002070         04  W-NGET     PIC  9(002).
002080         04  W-NPEY     PIC  9(002).
002090     02  W-ASUD.
002100       03  W-ASU   OCCURS   4.
002110         04  W-SUD   OCCURS  10.
002120           05  W-SU     PIC S9(006).
002130     02  W-SUT          PIC S9(006).
002140     02  W-BSU          PIC S9(006).
002150     02  W-SC           PIC  9(001).
002160     02  CNT            PIC  9(002).
002170     02  W-FC           PIC  9(001).
002180     02  W-RC           PIC  9(001).
002190     02  W-KC           PIC  9(001).
002200     02  WS-ASUD.
002210       03  WS-ASU   OCCURS   4.
002220         04  WS-SUD   OCCURS  10.
002230           05  WS-SU    PIC S9(006).
002240     02  WA-ASUD.
002250       03  WA-ASU   OCCURS   4.
002260         04  WA-SUD   OCCURS  10.
002270           05  WA-SU    PIC S9(006).
002280     02  W-DMM          PIC  9(001).
002290     02  W-NGP.
002300       03  W-NEN        PIC  9(004).
002310       03  W-NENL  REDEFINES W-NEN.
002320         04  W-NEN1     PIC  9(002).
002330         04  W-NEN2     PIC  9(002).
002340       03  W-GET        PIC  9(002).
002350       03  W-PEY        PIC  9(002).
002360     02  W-NGPL  REDEFINES W-NGP.
002370       03  F            PIC  9(002).
002380       03  W-NGPS       PIC  9(006).
002390     02  W-SYSD         PIC  9(008).
002400     02  W-SYSDD REDEFINES W-SYSD.
002410       03  F            PIC  9(002).
002420       03  W-SYSH       PIC  9(006).
002430     02  W-SNGP         PIC  9(008).
002440     02  W-ENGP         PIC  9(008).
002450     02  CHK.
002460       03  CHK1         PIC  9(001).
002470       03  CHK2         PIC  9(001).
002480     COPY LSTAT.
002490 SCREEN SECTION.
002500 SD  C-CRT
002510     END STATUS IS ESTAT.
002520 01  C-CLEAR.
002530     02  LINE  1  CLEAR SCREEN.
002540 01  C-MID.
002550     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
002560          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002570     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
002580          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002590     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
002600          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002610     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
002620          NC"＊＊＊　　生協　出荷予定　変換リスト　　＊＊＊".
002630     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
002640          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002650     02  LINE   8  COLUMN  10  PIC  N(023) VALUE
002660          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002670     02  LINE   9  COLUMN  10  PIC  N(023) VALUE
002680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002690     02  LINE  23  COLUMN  42  PIC  X(022) VALUE
002700          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002710 01  C-ACP.
002720     02  A-DMM   LINE  23  COLUMN  59  PIC  9(001)
002730          USING W-DMM   CHECK OVERFLOW NO IFC.
002740 01  C-ERR.
002750     02  LINE  24.
002760       03  E-ME1   COLUMN  15  PIC  X(025) VALUE
002770            "***  ﾋﾝﾒｲ ﾅｼ  ***        ".
002780       03  E-ME2   COLUMN  15  PIC  X(025) VALUE
002790            "***  ﾄｸｲｻｷ ﾅｼ  ***       ".
002800       03  E-ME3   COLUMN  15  PIC  X(025) VALUE
002810            "***  ｻｲｽﾞ ｴﾗｰ  ***       ".
002820       03  E-ME4   COLUMN  15  PIC  X(025) VALUE
002830            "***  ﾋﾂﾞｹ ﾁｪｯｸ  ***      ".
002840       03  E-ME5   COLUMN  15  PIC  X(025) VALUE
002850            "***  ｽｳﾘｮｳ ｶﾞ ﾊｲｯﾃﾅｲ  ***".
002860       03  E-ME6   COLUMN  15  PIC  X(025) VALUE
002870            "***  DATA ﾅｼ  ***        ".
002880       03  E-HCD   COLUMN  41  PIC  9(006) FROM  SSY-HCD.
002890       03  E-TCD   COLUMN  48  PIC  9(004) FROM  SSY-TCD.
002900       03  E-ND    COLUMN  53  PIC  9(008) FROM  SSY-ND.
002910     COPY LIBSCR.
002920     COPY LSSEM.
002930 PROCEDURE DIVISION.
002940 M-05.
002950     DISPLAY C-CLEAR.
002960     DISPLAY C-MID.
002970     MOVE ZERO TO W-DATA.
002980 M-10.
002990     ACCEPT A-DMM.
003000     IF ESTAT = PF9
003010         MOVE 255 TO COMPLETION-CODE
003020         GO TO M-95.
003030     IF ESTAT NOT = HTB AND SKP
003040         GO TO M-10.
003050     IF W-DMM = 9
003060         MOVE 255 TO COMPLETION-CODE
003070         GO TO M-95.
003080     IF W-DMM NOT = 1
003090         GO TO M-10.
003100     DISPLAY C-CLEAR.
003110     DISPLAY C-MID.
003120     DISPLAY A-DMM.
003130*
003140     ACCEPT W-NGPS FROM DATE.
003150     COPY LIBCPR.
003160     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
003170         ADD DATE-NC1 TO W-NEN.
003180     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
003190         ADD DATE-NC2 TO W-NEN.
003200     MOVE W-NGP TO W-SYSD.
003210*
003220     ADD 1 TO W-GET.
003230     IF W-GET = 13
003240         ADD 1 TO W-NEN
003250         MOVE 1 TO W-GET.
003260     ADD 1 TO W-GET.
003270     IF W-GET = 13
003280         ADD 1 TO W-NEN
003290         MOVE 1 TO W-GET.
003300     ADD 1 TO W-GET.
003310     IF W-GET = 13
003320         ADD 1 TO W-NEN
003330         MOVE 1 TO W-GET.
003340     ADD 1 TO W-GET.
003350     IF W-GET = 13
003360         ADD 1 TO W-NEN
003370         MOVE 1 TO W-GET.
003380     MOVE 31 TO W-PEY.
003390     MOVE W-NGP TO W-ENGP.
003400*
003410     MOVE W-SYSD TO W-NGP.
003420     SUBTRACT 1 FROM W-GET.
003430     IF W-GET = ZERO
003440         SUBTRACT 1 FROM W-NEN
003450         MOVE 12 TO W-GET.
003460     SUBTRACT 1 FROM W-GET.
003470     IF W-GET = ZERO
003480         SUBTRACT 1 FROM W-NEN
003490         MOVE 12 TO W-GET.
003500     SUBTRACT 1 FROM W-GET.
003510     IF W-GET = ZERO
003520         SUBTRACT 1 FROM W-NEN
003530         MOVE 12 TO W-GET.
003540     SUBTRACT 1 FROM W-GET.
003550     IF W-GET = ZERO
003560         SUBTRACT 1 FROM W-NEN
003570         MOVE 12 TO W-GET.
003580     MOVE 1 TO W-PEY.
003590     MOVE W-NGP TO W-SNGP.
003600*
003610     CALL "CBLSTNNO" USING STN-NO.
003620     MOVE STN-NO2 TO W-FID2.
003630     MOVE W-FID TO WK0128ID.
003640     OPEN INPUT SSYF.
003650     READ SSYF AT END
003660         MOVE 255 TO COMPLETION-CODE
003670         CLOSE SSYF
003680         DISPLAY E-ME6 E-ME99
003690         GO TO M-95.
003700     OPEN INPUT HI2-M TC-M.
003710 M-15.
003720     MOVE SSY-HCD TO HI-MHCD HI-HCD.
003730     READ HI2-M WITH UNLOCK INVALID KEY
003740         MOVE 255 TO COMPLETION-CODE
003750         DISPLAY E-ME1 E-HCD E-TCD E-ND E-ME99
003760         DISPLAY E-CL.
003770     MOVE SSY-TCD TO TC-TCD.
003780     MOVE 001 TO TC-CCD.
003790     READ TC-M WITH UNLOCK INVALID KEY
003800         MOVE 255 TO COMPLETION-CODE
003810         DISPLAY E-ME2 E-HCD E-TCD E-ND E-ME99
003820         DISPLAY E-CL.
003830     IF SSY-ND < W-SNGP OR > W-ENGP
003840         MOVE 255 TO COMPLETION-CODE
003850         DISPLAY E-ME4 E-HCD E-TCD E-ND E-ME99
003860         DISPLAY E-CL.
003870     IF ZERO = SSY-SU(01) AND SSY-SU(02) AND SSY-SU(03) AND
003880               SSY-SU(04) AND SSY-SU(05) AND SSY-SU(06) AND
003890               SSY-SU(07) AND SSY-SU(08) AND SSY-SU(09) AND
003900               SSY-SU(10)
003910         MOVE 255 TO COMPLETION-CODE
003920         DISPLAY E-ME5 E-HCD E-TCD E-ND E-ME99
003930         DISPLAY E-CL.
003940     READ SSYF AT END
003950         GO TO M-20.
003960     GO TO M-15.
003970 M-20.
003980     IF COMPLETION-CODE = 255
003990         CLOSE SSYF
004000         CLOSE HI2-M TC-M
004010         GO TO M-95.
004020     CLOSE SSYF.
004030*
004040     OPEN INPUT SSYF.
004050     OPEN OUTPUT SP-F.
004060     MOVE ZERO TO W-PAGE.
004070     ACCEPT H-DATE FROM DATE.
004080     PERFORM MID-010 THRU MID-EX.
004090     READ SSYF AT END
004100         MOVE 255 TO COMPLETION-CODE
004110         DISPLAY E-ME6 E-ME99
004120         GO TO M-90.
004130 M-25.
004140     MOVE ZERO TO CHK1 WA-ASUD.
004150     MOVE SSY-HCD TO W-HCD.
004160     MOVE W-HCD TO HI-MHCD HI-HCD.
004170     READ HI2-M WITH UNLOCK INVALID KEY
004180         MOVE SPACE TO HI-NAME
004190         MOVE NC"＊＊　品名マスター　なし　＊＊" TO HI-NAME.
004200     MOVE SPACE TO W-P1.
004210     MOVE W-HCD TO P-HCD.
004220     MOVE HI-NAME TO P-HNA.
004230 M-30.
004240     MOVE ZERO TO CHK2 WS-ASUD W-KC.
004250     MOVE SSY-TCD TO W-TCD.
004260     MOVE W-TCD TO TC-TCD.
004270     MOVE 001 TO TC-CCD.
004280     READ TC-M WITH UNLOCK INVALID KEY
004290         MOVE SPACE TO TC-NAME
004300         MOVE NC"＊＊　得意先マスター　なし　＊＊" TO TC-NAME.
004310     MOVE SPACE TO W-P2.
004320     MOVE W-TCD TO P-TCD.
004330     MOVE TC-NAME TO P-TNA.
004340 M-35.
004350     IF W-KC = 1
004360         MOVE 2 TO W-KC.
004370     IF W-KC = 0
004380         MOVE 1 TO W-KC.
004390     MOVE ZERO TO W-ASUD W-SUT W-FC W-RC.
004400     MOVE SSY-ND TO W-ND.
004410 M-40.
004420     MOVE SSY-ASU TO W-ASU(SSY-SIZ).
004430     MOVE ZERO TO CNT.
004440 M-45.
004450     ADD 1 TO CNT.
004460     IF CNT < 11
004470         ADD SSY-SU(CNT) TO W-SUT WS-SU(SSY-SIZ,CNT)
004480                                  WA-SU(SSY-SIZ,CNT)
004490         GO TO M-45.
004500     IF W-FC = 0
004510         MOVE SSY-SIZ TO W-FC.
004520     MOVE SSY-SIZ TO W-RC.
004530 M-50.
004540     READ SSYF AT END
004550         GO TO M-65.
004560     IF SSY-HCD NOT = W-HCD
004570         GO TO M-60.
004580     IF SSY-TCD NOT = W-TCD
004590         GO TO M-55.
004600     IF SSY-ND = W-ND
004610         GO TO M-40.
004620     PERFORM PR3-RTN THRU PR3-EX.
004630     GO TO M-35.
004640 M-55.
004650     PERFORM PR3-RTN THRU PR3-EX.
004660     PERFORM SUB-RTN THRU SUB-EX.
004670     GO TO M-30.
004680 M-60.
004690     PERFORM PR3-RTN THRU PR3-EX.
004700     PERFORM SUB-RTN THRU SUB-EX.
004710     PERFORM KEI-RTN THRU KEI-EX.
004720     GO TO M-25.
004730 M-65.
004740     PERFORM PR3-RTN THRU PR3-EX.
004750     PERFORM SUB-RTN THRU SUB-EX.
004760     PERFORM KEI-RTN THRU KEI-EX.
004770 M-90.
004780     CLOSE SP-F.
004790     CLOSE HI2-M.
004800     CLOSE TC-M.
004810     CLOSE SSYF.
004820 M-95.
004830     DISPLAY C-CLEAR.
004840     STOP RUN.
004850 MID-RTN.
004860     MOVE SPACE TO SP-R.
004870     WRITE SP-R AFTER PAGE.
004880 MID-010.
004890     ADD 1 TO W-PAGE.
004900     MOVE W-PAGE TO H-PAGE.
004910     MOVE SPACE TO SP-R.
004920     MOVE HEAD1 TO SP-R.
004930     WRITE SP-R.
004940     MOVE SPACE TO SP-R.
004950     MOVE HEAD2 TO SP-R.
004960     WRITE SP-R AFTER 2.
004970     MOVE SPACE TO SP-R.
004980     MOVE HEAD3 TO SP-R.
004990     WRITE SP-R.
005000     MOVE SPACE TO SP-R.
005010     MOVE HEAD4 TO SP-R.
005020     WRITE SP-R.
005030     MOVE SPACE TO SP-R.
005040     MOVE HEAD5 TO SP-R.
005050     WRITE SP-R.
005060     MOVE SPACE TO SP-R.
005070     MOVE HEAD6 TO SP-R.
005080     WRITE SP-R.
005090     MOVE SPACE TO SP-R.
005100     MOVE HEAD7 TO SP-R.
005110     WRITE SP-R.
005120     MOVE SPACE TO SP-R.
005130 MID-EX.
005140     EXIT.
005150 PR1-RTN.
005160     IF LINAGE-COUNTER > 58
005170         PERFORM MID-RTN THRU MID-EX.
005180     MOVE SPACE TO SP-R.
005190     MOVE W-P1 TO SP-R.
005200     WRITE SP-R.
005210     MOVE SPACE TO SP-R.
005220     MOVE 1 TO CHK1.
005230     MOVE 0 TO CHK2.
005240 PR1-EX.
005250     EXIT.
005260 PR2-RTN.
005270     IF LINAGE-COUNTER > 59
005280         PERFORM MID-RTN THRU MID-EX.
005290     MOVE SPACE TO SP-R.
005300     MOVE W-P2 TO SP-R.
005310     WRITE SP-R.
005320     MOVE SPACE TO SP-R.
005330     MOVE 1 TO CHK2.
005340 PR2-EX.
005350     EXIT.
005360 PR3-RTN.
005370     IF CHK1 = 0
005380         PERFORM PR1-RTN THRU PR1-EX.
005390     IF CHK2 = 0
005400         PERFORM PR2-RTN THRU PR2-EX.
005410     MOVE SPACE TO W-P3.
005420     MOVE SPACE TO P-TM.
005430     MOVE 0 TO W-SC.
005440 PR3-010.
005450     ADD 1 TO W-SC.
005460     IF W-SC = 5
005470         GO TO PR3-EX.
005480     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
005490           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
005500           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
005510           AND W-SU(W-SC,10)
005520         GO TO PR3-010.
005530     MOVE W-SC TO P-SIZ.
005540     IF W-SC = W-FC
005550         MOVE W-NDS TO P-ND.
005560     IF W-SC = W-RC
005570         MOVE W-SUT TO P-SUT.
005580     MOVE ZERO TO CNT.
005590 PR3-020.
005600     ADD 1 TO CNT.
005610     IF CNT < 11
005620         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
005630         GO TO PR3-020.
005640     IF LINAGE-COUNTER > 60
005650         PERFORM MID-RTN THRU MID-EX
005660         PERFORM PR1-RTN THRU PR1-EX
005670         PERFORM PR2-RTN THRU PR2-EX.
005680     MOVE SPACE TO SP-R.
005690     MOVE W-P3 TO SP-R.
005700     WRITE SP-R.
005710     MOVE SPACE TO SP-R.
005720     IF W-SC NOT = W-RC
005730         GO TO PR3-010.
005740 PR3-EX.
005750     EXIT.
005760 SUB-RTN.
005770     IF W-KC NOT = 2
005780         GO TO SUB-EX.
005790     MOVE ZERO TO W-ASUD.
005800     MOVE WS-ASUD TO W-ASUD.
005810     MOVE 0 TO W-SC W-FC W-RC W-SUT.
005820 SUB-010.
005830     ADD 1 TO W-SC.
005840     IF W-SC = 5
005850         GO TO SUB-030.
005860     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
005870           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
005880           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
005890           AND W-SU(W-SC,10)
005900         GO TO SUB-010.
005910     IF W-FC = 0
005920         MOVE W-SC TO W-FC.
005930     MOVE W-SC TO W-RC.
005940     MOVE ZERO TO CNT.
005950 SUB-020.
005960     ADD 1 TO CNT.
005970     IF CNT < 11
005980         ADD W-SU(W-SC,CNT) TO W-SUT
005990         GO TO SUB-020.
006000     GO TO SUB-010.
006010 SUB-030.
006020     MOVE 0 TO W-SC.
006030 SUB-040.
006040     ADD 1 TO W-SC.
006050     IF W-SC = 5
006060         GO TO SUB-EX.
006070     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
006080           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
006090           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
006100           AND W-SU(W-SC,10)
006110         GO TO SUB-040.
006120*
006130     MOVE SPACE TO W-P3.
006140     MOVE SPACE TO P-TM.
006150     MOVE W-SC TO P-SIZ.
006160     IF W-SC = W-FC
006170         MOVE NC"　　＜　小計　＞" TO P-TM.
006180     IF W-SC = W-RC
006190         MOVE W-SUT TO P-SUT.
006200     MOVE ZERO TO CNT.
006210 SUB-050.
006220     ADD 1 TO CNT.
006230     IF CNT < 11
006240         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
006250         GO TO SUB-050.
006260     IF LINAGE-COUNTER > 60
006270         PERFORM MID-RTN THRU MID-EX
006280         PERFORM PR1-RTN THRU PR1-EX
006290         PERFORM PR2-RTN THRU PR2-EX.
006300     MOVE SPACE TO SP-R.
006310     MOVE W-P3 TO SP-R.
006320     WRITE SP-R.
006330     MOVE SPACE TO SP-R.
006340     IF W-SC NOT = W-RC
006350         GO TO SUB-040.
006360 SUB-EX.
006370     EXIT.
006380 KEI-RTN.
006390     MOVE ZERO TO W-ASUD.
006400     MOVE WA-ASUD TO W-ASUD.
006410     MOVE 0 TO W-SC W-FC W-RC W-SUT.
006420 KEI-010.
006430     ADD 1 TO W-SC.
006440     IF W-SC = 5
006450         GO TO KEI-030.
006460     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
006470           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
006480           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
006490           AND W-SU(W-SC,10)
006500         GO TO KEI-010.
006510     IF W-FC = 0
006520         MOVE W-SC TO W-FC.
006530     MOVE W-SC TO W-RC.
006540     MOVE ZERO TO CNT.
006550 KEI-020.
006560     ADD 1 TO CNT.
006570     IF CNT < 11
006580         ADD W-SU(W-SC,CNT) TO W-SUT
006590         GO TO KEI-020.
006600     GO TO KEI-010.
006610 KEI-030.
006620     MOVE 0 TO W-SC.
006630 KEI-040.
006640     ADD 1 TO W-SC.
006650     IF W-SC = 5
006660         GO TO KEI-EX.
006670     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
006680           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
006690           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
006700           AND W-SU(W-SC,10)
006710         GO TO KEI-040.
006720*
006730     MOVE SPACE TO W-P3.
006740     MOVE SPACE TO P-TM.
006750     MOVE W-SC TO P-SIZ.
006760     IF W-SC = W-FC
006770         MOVE NC"【　合　計　】　" TO P-TM.
006780     IF W-SC = W-RC
006790         MOVE W-SUT TO P-SUT.
006800     MOVE ZERO TO CNT.
006810 KEI-050.
006820     ADD 1 TO CNT.
006830     IF CNT < 11
006840         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
006850         GO TO KEI-050.
006860     IF LINAGE-COUNTER > 60
006870         PERFORM MID-RTN THRU MID-EX
006880         PERFORM PR1-RTN THRU PR1-EX
006890     MOVE SPACE TO SP-R.
006900     MOVE W-P3 TO SP-R.
006910     WRITE SP-R.
006920     MOVE SPACE TO SP-R.
006930     IF W-SC NOT = W-RC
006940         GO TO KEI-040.
006950 KEI-EX.
006960     EXIT.
