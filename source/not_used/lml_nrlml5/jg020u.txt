000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JG020U.
000030************************************************************
000040*    PROGRAM         :  ＪＣＯＮ　印刷中区分　セット･解除  *
000050*    PRINTER TYPE    :  JIPS                               *
000060*    SCREEN          :  ------                             *
000070*    COMPILE TYPE    :  COBOL                              *
000080*    JS-SIGN         :  0:解除 , 1=セット                  *
000090*    W-JS1           :  倉庫区分(4:早島 , 6:玉島)          *
000100*    W-JS2           :  1:出荷指図書  　 , 2:荷札          *
000110*                    :  3:送り状　　  　 , 4:ワークマンEOS *
000120*                    :  5:ナフコEOS 　   , 6:トラスコ他FAX *
000130*                    :  7:赤ちゃん本舗   , 8:              *
000140************************************************************
000150 ENVIRONMENT DIVISION.
000160 CONFIGURATION SECTION.
000170 SOURCE-COMPUTER. SYSTEM3100.
000180 OBJECT-COMPUTER. SYSTEM3100.
000190 INPUT-OUTPUT SECTION.
000200 FILE-CONTROL.
000210     SELECT JCON ASSIGN TO JCON-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY JCON1-KEY
000250         FILE STATUS IS ERR-STAT.
000260 I-O-CONTROL.
000270     APPLY SHARED-MODE ON JCON.
000280 DATA DIVISION.
000290 FILE SECTION.
000300     COPY L-JCON.
000310 WORKING-STORAGE SECTION.
000320 77  JS-SIGN            PIC  9(001).
000330 77  W-JS1              PIC  9(001).
000340 77  W-JS2              PIC  9(001).
000350 01  W-DATA.
000360     02  W-KSN          PIC  N(006).
000370     02  W-SON          PIC  N(006).
000380     02  W-SRN          PIC  N(010).
000390     02  W-DMM          PIC  9(001).
000400     02  W-FILE         PIC  X(013).
000410 01  ERR-STAT           PIC  X(002).
000420     COPY LSTAT.
000430 SCREEN SECTION.
000440 SD  C-CRT
000450     END STATUS IS ESTAT.
000460 01  C-CLEAR.
000470     02  C-CL    LINE   1  CLEAR SCREEN.
000480 01  C-MID.
000490     02  LINE   1  COLUMN  15  PIC  N(020) VALUE
000500          NC"＊＊＊　　ＪＣＯＮ　印刷中区分　　＊＊＊".
000510     02  LINE   8  COLUMN  15  PIC  N(002) VALUE
000520          NC"処理".
000530     02  LINE  10  COLUMN  15  PIC  N(002) VALUE
000540          NC"倉庫".
000550     02  LINE  12  COLUMN  15  PIC  N(015) VALUE
000560          NC"伝票".
000570 01  C-DSP.
000580     02  D-MEI.
000590       03  LINE   8  COLUMN  23  PIC  N(006) FROM  W-KSN.
000600       03  LINE  10  COLUMN  23  PIC  N(006) FROM  W-SON.
000610       03  LINE  12  COLUMN  23  PIC  N(010) FROM  W-SRN.
000620 01  C-ERR.
000630     02  LINE  24.
000640       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
000650            "***  ｿｳｺNO ﾅｼ  ***".
000660       03  E-ME5   COLUMN  15  PIC  X(018) VALUE
000670            "***  ﾃﾞｰﾀ ｴﾗｰ  ***".
000680       03  E-ME6   COLUMN  15  PIC  X(019) VALUE
000690            "***  ﾃﾞｰﾀ ｴﾗｰ?  ***".
000700       03  E-ME12  COLUMN  15  PIC  X(021) VALUE
000710            "***  REWRITE ｴﾗｰ  ***".
000720     COPY LSSEM.
000730 PROCEDURE DIVISION.
000740 M-05.
000750     DISPLAY C-CLEAR.
000760     DISPLAY C-MID.
000770     ACCEPT JS-SIGN.
000780     ACCEPT W-JS1.
000790     ACCEPT W-JS2.
000800     IF JS-SIGN > 1
000810         MOVE 255 TO COMPLETION-CODE
000820         GO TO M-95.
000830     IF W-JS1 NOT = 4 AND 6
000840         MOVE 255 TO COMPLETION-CODE
000850         GO TO M-95.
000860     IF W-JS2 < 1 OR > 7
000870         MOVE 255 TO COMPLETION-CODE
000880         GO TO M-95.
000890     DISPLAY C-CLEAR.
000900     DISPLAY C-MID.
000910     IF JS-SIGN = 0
000920         MOVE NC"【解　除】　" TO W-KSN.
000930     IF JS-SIGN = 1
000940         MOVE NC"【セット】　" TO W-KSN.
000950     IF W-JS1 = 4
000960         MOVE NC"｛早島倉庫｝" TO W-SON.
000970     IF W-JS1 = 6
000980         MOVE NC"｛玉島倉庫｝" TO W-SON.
000990     IF W-JS2 = 1
001000         MOVE NC"（出荷指図書）　　　" TO W-SRN.
001010     IF W-JS2 = 2
001020         MOVE NC"（荷　　　札）　　　" TO W-SRN.
001030     IF W-JS2 = 3
001040         MOVE NC"（送　り　状）　　　" TO W-SRN.
001050     IF W-JS2 = 4
001060         MOVE NC"（ワークマンＥＯＳ）" TO W-SRN.
001070     IF W-JS2 = 5
001080         MOVE NC"（ナフコＥＯＳ）　　" TO W-SRN.
001090     IF W-JS2 = 6
001100         MOVE NC"（トラスコ他ＦＡＸ）" TO W-SRN.
001110     IF W-JS2 = 7
001120         MOVE NC"（赤ちゃん本舗）　　" TO W-SRN.
001130     DISPLAY D-MEI.
001140     OPEN I-O JCON.
001150 M-10.
001160     MOVE 5 TO JCON5-01.
001170     MOVE W-JS1 TO JCON5-02.
001180     READ JCON INVALID KEY
001190         MOVE 255 TO COMPLETION-CODE
001200         DISPLAY E-ME2 E-ME99
001210         GO TO M-90.
001220     IF JS-SIGN = 1
001230         GO TO M-15.
001240*
001250     IF W-JS2 = 1
001260         IF JCON5-031 = 1
001270             MOVE 0 TO JCON5-031
001280             GO TO M-20
001290           ELSE
001300             DISPLAY E-ME5 E-ME99
001310             GO TO M-90.
001320     IF W-JS2 = 2
001330         IF JCON5-032 = 1
001340             MOVE 0 TO JCON5-032
001350             GO TO M-20
001360           ELSE
001370             DISPLAY E-ME5 E-ME99
001380             GO TO M-90.
001390     IF W-JS2 = 3
001400         IF JCON5-033 = 1
001410             MOVE 0 TO JCON5-033
001420             GO TO M-20
001430           ELSE
001440             DISPLAY E-ME5 E-ME99
001450             GO TO M-90.
001460     IF W-JS2 = 4
001470         IF JCON5-034 = 1
001480             MOVE 0 TO JCON5-034
001490             GO TO M-20
001500           ELSE
001510             DISPLAY E-ME5 E-ME99
001520             GO TO M-90.
001530     IF W-JS2 = 5
001540         IF JCON5-035 = 1
001550             MOVE 0 TO JCON5-035
001560             GO TO M-20
001570           ELSE
001580             DISPLAY E-ME5 E-ME99
001590             GO TO M-90.
001600     IF W-JS2 = 6
001610         IF JCON5-036 = 1
001620             MOVE 0 TO JCON5-036
001630             GO TO M-20
001640           ELSE
001650             DISPLAY E-ME5 E-ME99
001660             GO TO M-90.
001670     IF W-JS2 = 7
001680         IF JCON5-037 = 1
001690             MOVE 0 TO JCON5-037
001700             GO TO M-20
001710           ELSE
001720             DISPLAY E-ME5 E-ME99
001730             GO TO M-90.
001740     DISPLAY E-ME6 E-ME99.
001750     GO TO M-90.
001760 M-15.
001770     IF W-JS2 = 1
001780         IF JCON5-031 = 0
001790             MOVE 1 TO JCON5-031
001800             GO TO M-20
001810           ELSE
001820             DISPLAY E-ME5 E-ME99
001830             GO TO M-90.
001840     IF W-JS2 = 2
001850         IF JCON5-032 = 0
001860             MOVE 1 TO JCON5-032
001870             GO TO M-20
001880           ELSE
001890             DISPLAY E-ME5 E-ME99
001900             GO TO M-90.
001910     IF W-JS2 = 3
001920         IF JCON5-033 = 0
001930             MOVE 1 TO JCON5-033
001940             GO TO M-20
001950           ELSE
001960             DISPLAY E-ME5 E-ME99
001970             GO TO M-90.
001980     IF W-JS2 = 4
001990         IF JCON5-034 = 0
002000             MOVE 1 TO JCON5-034
002010             GO TO M-20
002020           ELSE
002030             DISPLAY E-ME5 E-ME99
002040             GO TO M-90.
002050     IF W-JS2 = 5
002060         IF JCON5-035 = 0
002070             MOVE 1 TO JCON5-035
002080             GO TO M-20
002090           ELSE
002100             DISPLAY E-ME5 E-ME99
002110             GO TO M-90.
002120     IF W-JS2 = 6
002130         IF JCON5-036 = 0
002140             MOVE 1 TO JCON5-036
002150             GO TO M-20
002160           ELSE
002170             DISPLAY E-ME5 E-ME99
002180             GO TO M-90.
002190     IF W-JS2 = 7
002200         IF JCON5-037 = 0
002210             MOVE 1 TO JCON5-037
002220             GO TO M-20
002230           ELSE
002240             DISPLAY E-ME5 E-ME99
002250             GO TO M-90.
002260     DISPLAY E-ME6 E-ME99.
002270     GO TO M-90.
002280 M-20.
002290     REWRITE JCON5-R INVALID KEY
002300         MOVE 255 TO COMPLETION-CODE
002310         DISPLAY E-STAT E-ME12 E-ME99.
002320 M-90.
002330     CLOSE JCON.
002340 M-95.
002350     DISPLAY C-CLEAR.
002360     STOP RUN.
