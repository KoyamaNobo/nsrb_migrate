000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JK030L.
000030******************************************************************
000040*    ëqå…  èoâ◊éwê}èë                                          *
000050*    ÇmÇnÅDÇPÇXÇS  î~ä_        ÇgÇOÇPÅDÇOÇWÅDÇPÇU                *
000060******************************************************************
000070
000080 ENVIRONMENT       DIVISION.
000090 CONFIGURATION     SECTION.
000100 SOURCE-COMPUTER.  SYSTEM3100.
000110 OBJECT-COMPUTER.  SYSTEM3100.
000120 INPUT-OUTPUT      SECTION.
000130 FILE-CONTROL.
000140     COPY  LIBCSE.                                                I.981027
000150*****SELECT  GDMM   ASSIGN  GDMM-MSD                              D.011018
000160*****               ORGANIZATION  INDEXED                         D.011018
000170*****               ACCESS  MODE  RANDOM                          D.011018
000180*****               RECORD  KEY   GDMM-KEY                        D.011018
000190*****               FILE  STATUS  ERR-STAT.                       D.011018
000200     SELECT  JSTR   ASSIGN  JSTR-MSD
000210                    ORGANIZATION  INDEXED
000220                    ACCESS  MODE  DYNAMIC
000230                    RECORD  KEY   JSTR-KEY
000240                    FILE  STATUS  ERR-STAT.
000250     SELECT  JCON   ASSIGN  JCON-MSD
000260                    ORGANIZATION  INDEXED
000270                    ACCESS  MODE  RANDOM
000280                    RECORD  KEY   JCON2-KEY.
000290     SELECT  TC-M   ASSIGN  TCM-MSD
000300                    ORGANIZATION  INDEXED
000310                    ACCESS  MODE  RANDOM
000320                    RECORD  KEY   TC-KEY.
000330*****SELECT  SHM    ASSIGN  SHM-MSD                               D.010818
000340     SELECT  HI2-M  ASSIGN  HIM-MSD                               I.010818
000350                    ORGANIZATION  INDEXED
000360                    ACCESS  MODE  RANDOM
000370                    RECORD  KEY   HI-KEY2.                        I.010818
000380*****               RECORD  KEY   SHM-KEY.                        D.010818
000390     SELECT  PRN-F  ASSIGN  PRF-PRN999.
000400 I-O-CONTROL.
000410     APPLY  SHARED-MODE  ON  JSTR
000420                             JCON
000430                             TC-M
000440                             HI2-M                                I.010818
000450*****                        SHM                                  D.010818
000460*****                        GDMM                                 D.011018
000470                             M-DATE                               I.981027
000480     APPLY  SHIFT-CODE   ON  PRN-F.
000490
000500 DATA              DIVISION.
000510 FILE              SECTION.
000520       COPY  LIBFDD.                                              I.981027
000530       COPY  L-JSTR.
000540       COPY  L-JCON.
000550       COPY  LITCM.
000560       COPY  LIHIM2.                                              I.010818
000570*****  COPY  L-SHM.                                               D.010818
000580*****  COPY  L-GDMM.                                              D.011018
000590 FD  PRN-F
000600     LABEL  RECORD  OMITTED
000610     LINAGE  33.
000620 01  PRN-R                 PIC X(180).
000630 WORKING-STORAGE   SECTION.
000640 01  END-SW                PIC 9      VALUE 0.
000650 01  RED-SW                PIC 9      VALUE 0.
000660*01  TCM-SW                PIC 9      VALUE 0.                    D.020819
000670 01  WORK-1.
000680*****02  F                 PIC X(108).                            D.890901
000690*****02  F                 PIC X(104).                            D.950201
000700*****02  F                 PIC X(94).                             D.950202
000710*****02  F                 PIC X(98).                             D.980827
000720     02  F                 PIC X(93).                             I.980827
000730     02  ST-CD0            PIC X(5).                              I.950201
000740     02  WORK-10           PIC N(02).                             I.950201
000750     02  ED-CD0            PIC X(5).                              I.950201
000760     02  F                 PIC X(7).                              I.950201
000770     02  WORK-11           PIC 9(6).                               ì`ï[áÇ
000780 01  WORK-1A.                                                     I.020819
000790     02  F                 PIC X(85)  VALUE  SPACE.               I.020819
000800     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.020819
000810     02  F                 PIC X(8)   VALUE  ""3F504F40677F4F9B"".I.020819
000820     02  WORK-NA           PIC N(8)   VALUE  SPACE.               I.020819
000830     02  F                 PIC X(8)   VALUE  ""3F504F40674F40A0"".I.020819
000840     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.020819
000850 01  WORK-1B.                                                     I.020819
000860     02  F                 PIC X(87)  VALUE  SPACE.               I.020819
000870     02  F                 PIC N(1)   VALUE  NC"Åß".              I.020819
000880     02  WORK-UNO          PIC X(8)   VALUE  SPACE.               I.020819
000890 01  WORK-1C.                                                     I.020819
000900     02  F                 PIC X(87)  VALUE  SPACE.               I.020819
000910     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.020819
000920     02  WORK-JS           PIC N(14)  VALUE  SPACE.               I.020819
000930     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.020819
000940 01  WORK-2.
000950*****02  F                 PIC X(38).                             D.890901
000960*****02  F                 PIC X(35).                             D.950202
000970*****02  F                 PIC X(39).                             D.980827
000980*****02  F                 PIC X(34).                             D.020819
000990*****02  WORK-M1           PIC N(02).                             D.020819
001000     02  F                 PIC X(38).                             I.020819
001010     02  WORK-M2           PIC X(01).                             I.890901
001020     02  WORK-21.                                                  èoâ◊ì˙
001030*****    03  WORK-211      PIC ZZ.                                D.980527
001040         03  WORK-211      PIC 9(2).                              I.980527
001050         03  F             PIC X(4).
001060         03  WORK-212      PIC ZZ.                                   åé
001070         03  F             PIC X(4).
001080         03  WORK-213      PIC ZZ.                                   ì˙
001090*****02  F                 PIC X(10).                             D 890920
001100     02  F                 PIC X(09).                             A 890920
001110     02  WORK-22           PIC N(2).                                ì`ãÊ
001120     02  F                 PIC X(4).
001130     02  WORK-23           PIC N(06).                             A 890920
001140     02  F                 PIC X(05).                             I.020819
001150     02  WORK-TM           PIC X(03).                             I.020819
001160     02  F                 PIC X(01).                             I.020819
001170     02  WORK-TEL          PIC X(14).                             I.020819
001180*****02  WORK-23           PIC 9.                                 D 890920
001190 01  WORK-3.
001200*****02  F                 PIC X(66).                             D.980827
001210*****02  F                 PIC X(07).                             D.910703
001220*****02  WORK-32           PIC 9(6).                              D.910703
001230*****02  F                 PIC X(62).                             D.950202
001240     02  F                 PIC X(61).                             I.980827
001250     02  WORK-31           PIC 9(6).                              ëóÇËèÛáÇ
001260     02  F                 PIC X(20).                             I.020819
001270     02  WORK-FM           PIC X(03).                             I.020819
001280     02  F                 PIC X(01).                             I.020819
001290     02  WORK-FAX          PIC X(14).                             I.020819
001300*****02  F                 PIC X(36).                             D.910702
001310 01  WORK-3A.                                                     I.910703
001320*****02  F                 PIC X(105).                            D.950202
001330*****02  F                 PIC X(109).                            D.980827
001340*****02  F                 PIC X(104).                            D.000125
001350*****02  F                 PIC X(5).                              D.010222
001360*****02  WORK-33A.                                                D.010222
001370*****  03  WORK-33F        PIC X(1).                              D.010222
001380*****  03  WORK-33         PIC Z(3).                              D.010222
001390*****  03  WORK-33R        PIC X(1).                              D.010222
001400*****02  F                 PIC X(94).                             D.010222
001410     02  F                 PIC X(104).                            I.010222
001420     02  WORK-32           PIC 9(6).                              I.900411
001430 01  WORK-4.
001440*****02  F                 PIC X(11).                             D.980827
001450*****02  F                 PIC X(07).                             D.950202
001460     02  F                 PIC X(06).                             I.980827
001470     02  WORK-41           PIC 9(4).                              ìæà”êÊCD
001480     02  F                 PIC X(4).
001490     02  ST-CD1            PIC X(5).                              1.5BYTE
001500*****02  WORK-42           PIC N(24).                             D.020418
001510*****02  F                 PIC X(8).                              D.020418
001520     02  WORK-42           PIC N(26).                             I.020418
001530     02  F                 PIC X(5).                              I.020418
001540     02  WORK-43           PIC X(3).                              íºëóêÊCD
001550     02  F                 PIC X(4).
001560     02  WORK-44           PIC N(26).                             I.020418
001570*****02  WORK-44           PIC N(24).                             D.020418
001580     02  ED-CD1            PIC X(5).                              2BYTE
001590 01  WORK-5.
001600*****02  F                 PIC X(12).                             D.980827
001610*****02  F                 PIC X(08).                             D.950202
001620*****02  ST-CD2            PIC X(5).                              D 911002
001630*****02  WORK-51           PIC N(4).                              D 911002
001640*****02  F                 PIC X(07).                             D.041221
001650     02  F                 PIC X(06).                             I.041221
001660     02  ED-CD2            PIC X(5).                              2BYTE
001670     02  F                 PIC X(31).                             I.981028
001680     02  WORK-51F          PIC X(01).                             I.981028
001690     02  WORK-51           PIC X(10).                             I.981028
001700     02  WORK-51R          PIC X(01).                             I.981028
001710*****02  F                 PIC X(40).                             D 911002
001720*****02  F                 PIC X(37).                             D.981028
001730*****02  WORK-51A          PIC 9(06).                             D.981028
001740*****02  WORK-51AR  REDEFINES  WORK-51A  PIC X(06).               D.981028
001750     02  F                 PIC X(02).                             A 911002
001760     02  WORK-52           OCCURS  10.
001770         03  WORK-521      PIC ----B.                             1æØƒë´êî
001780*****02  F                 PIC X.                                 D.920826
001790     02  WORK-53           PIC ----.                                 åv
001800     02  WORK-54           PIC X(01).                             I.920826
001810     02  WORK-55           PIC ZZZ.                               I.920826
001820 01  WORK-6.
001830*****02  F                 PIC X(12).                             D.980827
001840*****02  F                 PIC X(08).                             D.950202
001850*****02  F                 PIC X(07).                             D.040210
001860*****02  F                 PIC X(08).                             D.041221
001870     02  F                 PIC X(06).                             I.041221
001880     02  WORK-61           PIC 9(6).                               ïiñºCD
001890     02  F                 PIC X.
001900     02  ST-CD3            PIC X(5).                              1.5BYTE
001910     02  WORK-62           PIC N(24).                               ïiñº
001920     02  ED-CD3            PIC X(5).                              2BYTE
001930     02  F                 PIC X.
001940     02  WORK-63           PIC 9.                                 ª≤ΩﬁãÊï™
001950     02  F                 PIC X.                                 I.041221
001960*****02  F                 PIC X.                                 D.040210
001970     02  WORK-64           OCCURS  10.
001980         03  WORK-641      PIC -----.                              éwê}êî
001990     02  WORK-65           PIC -------.                             çáåv
002000     02  WORK-65R  REDEFINES  WORK-65.                            A 911002
002010         03  WORK-651      PIC X(01).                             A 911002
002020         03  WORK-652      PIC ------.                            A 911002
002030     02  WORK-66           PIC X(01).                             A 911002
002040 01  WORK-6A.                                                     A 911002
002050*****02  F                 PIC X(103).                            D.950202
002060*****02  F                 PIC X(107).                            D.980827
002070*****02  F                 PIC X(102).                            D.041221
002080     02  F                 PIC X(101).                            I.041221
002090     02  WORK-61A          PIC ----.                              A 911002
002100     02  F                 PIC X(01).                             A 911002
002110     02  WORK-62A          PIC X(03).                             A 911002
002120 01  WORK-7.
002130*****02  F                 PIC X(40).                             D.890901
002140*****02  F                 PIC X(35).                             D 890920
002150*****02  F                 PIC X(24).                             D.950202
002160*****02  F                 PIC X(28).                             D.980827
002170     02  F                 PIC X(23).                             I.980827
002180     02  WORK-70           PIC ZZ9.                               I.900411
002190     02  WORK-70R  REDEFINES   WORK-70  PIC X(03).                I.900618
002200     02  F                 PIC X(09).                             I.900411
002210     02  ST-CD4            PIC X(5).                              1.5BYTE
002220     02  WORK-71           PIC N(06).                             I.020819
002230*****02  WORK-71.                                                 D.020819
002240*****    03  WORK-711      PIC N(5).                              D.020819
002250*****    03  WORK-712      PIC N.                                 D.020819
002260     02  F                 PIC X(4).
002270     02  WORK-72.
002280         03  WORK-721      PIC N(23).                               ìEóv
002290         03  WORK-722      PIC N(9).                               îzíBì˙
002300     02  ED-CD4            PIC X(5).                              2BYTE
002310*****02  F                 PIC X(7).                              D.041221
002320     02  F                 PIC X(6).                              I.041221
002330     02  WORK-73           PIC -------.                             çáåv
002340 01  WORK-8.
002350     02  WORK-81           OCCURS  10.
002360         03  WORK-811      PIC S9(2).
002370     02  WORK-82           PIC S9(6).
002380 01  WORK-9.
002390     02  WORK-91           OCCURS  10.
002400         03  WORK-911      PIC S9(4).
002410     02  WORK-92           PIC S9(6).
002420 01  I                     PIC 9.
002430 01  J                     PIC 9(2).
002440 01  PAGE-C                PIC 9(3).
002450 01  GOKEI                 PIC S9(6).
002460 01  SEN-W                 PIC 9.                                  ëIë-W
002470 01  TEST-W                PIC 9.                                 √ΩƒàÛéöW
002480 01  DEN-W                 PIC 9(6).                               ì`ï[-W
002490 01  DEN-W1                PIC 9(6).                              ì`ï[(FR)
002500 01  DEN-W2                PIC 9(6).                               ÅV (TO)
002510 01  KAKU-W                PIC 9.                                  ämîF-W
002520 01  ERR-STAT              PIC X(2).
002530 01  JS-SIGN               PIC 9(1).                              I.900411
002540*01  WYMD                  PIC 9(6).                              D.981021
002550 01  OLD-OKNO              PIC 9(6)  VALUE  0.                    I.900618
002560 01  SETSU                 PIC S9(3).                             A 911002
002570 01  W-DATA.                                                      I.981021
002580     02  W-DATE            PIC 9(06).                             I.981021
002590     02  W-NGP           REDEFINES  W-DATE.                       I.981021
002600       03  W-NEN           PIC 9(02).                             I.981021
002610       03  W-GET           PIC 9(02).                             I.981021
002620       03  W-PEY           PIC 9(02).                             I.981021
002630     02  W-SDATE           PIC 9(08).                             I.981021
002640     02  W-SNGP.                                                  I.981021
002650       03  W-SNEN          PIC 9(04).                             I.981021
002660       03  W-SNENL       REDEFINES  W-SNEN.                       I.981021
002670         04  W-SNEN1       PIC 9(02).                             I.981021
002680         04  W-SNEN2       PIC 9(02).                             I.981021
002690       03  W-SGET          PIC 9(02).                             I.981021
002700       03  W-SPEY          PIC 9(02).                             I.981021
002710     02  W-EDATE           PIC 9(08).                             I.981021
002720     02  W-ENGP.                                                  I.981021
002730       03  W-ENEN          PIC 9(04).                             I.981021
002740       03  W-ENENL       REDEFINES  W-ENEN.                       I.981021
002750         04  W-ENEN1       PIC 9(02).                             I.981021
002760         04  W-ENEN2       PIC 9(02).                             I.981021
002770       03  W-EGET          PIC 9(02).                             I.981021
002780       03  W-EPEY          PIC 9(02).                             I.981021
002790 01  W-HND.                                                       I.000808
002800     02  W-NAME            PIC N(24).                             I.000808
002810     02  W-NAMED REDEFINES W-NAME.                                I.000808
002820       03  W-NAD   OCCURS  24.                                    I.000808
002830         04  W-NA          PIC N(01).                             I.000808
002840     COPY  LWMSG.
002850 SCREEN            SECTION.
002860 SD  GAMEN  END  STATUS  END-STS.
002870 01  ACP-NYURYOKU.
002880     02  ACP-SEN   LINE   7.
002890         03  COLUMN  45  PIC 9     INTO  SEN-W
002900                                   CHECK  OVERFLOW  NO  IFC.
002910     02  ACP-TEST  LINE  12.
002920         03  COLUMN  45  PIC 9     INTO  TEST-W
002930                                   CHECK  OVERFLOW  NO  IFC.
002940     02  ACP-SNGP  LINE  17.                                      I.981021
002950       03  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981021
002960             USING  W-SNEN2  NO  IFC.                             I.981021
002970       03  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981021
002980             USING  W-SGET   NO  IFC.                             I.981021
002990       03  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981021
003000             USING  W-SPEY   NO  IFC.                             I.981021
003010     02  ACP-ENGP  LINE  19.                                      I.981021
003020       03  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981021
003030             USING  W-ENEN2  NO  IFC.                             I.981021
003040       03  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981021
003050             USING  W-EGET   NO  IFC.                             I.981021
003060       03  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981021
003070             USING  W-EPEY   NO  IFC.                             I.981021
003080     02  ACP-DEN1  LINE  17.
003090         03  COLUMN  31  PIC 9(6)  INTO  DEN-W1
003100                                   CHECK  OVERFLOW  NO  IFC.
003110     02  ACP-DEN2  LINE  19.
003120         03  COLUMN  31  PIC 9(6)  INTO  DEN-W2
003130                                   CHECK  OVERFLOW  NO  IFC.
003140     02  ACP-KAKU  LINE  24.
003150         03  COLUMN  63  PIC 9     INTO  KAKU-W
003160                                   CHECK  OVERFLOW  NO  IFC.
003170 01  DSP-GAMEN.
003180     02  LINE   1  COLUMN  26  VALUE
003190         NC"èoÅ@â◊Å@éwÅ@ê}Å@èë" REVERSE.
003200     02  LINE   3.                                                I.981021
003210       03  COLUMN  63    PIC 9(02)    FROM   W-NEN.               I.981021
003220       03  COLUMN  65    PIC N(01)    VALUE  NC"îN".              I.981021
003230       03  COLUMN  67    PIC 9(02)    FROM   W-GET.               I.981021
003240       03  COLUMN  69    PIC N(01)    VALUE  NC"åé".              I.981021
003250       03  COLUMN  71    PIC 9(02)    FROM   W-PEY.               I.981021
003260       03  COLUMN  73    PIC N(01)    VALUE  NC"ì˙".              I.981021
003270     02  LINE   5  COLUMN  25  VALUE  NC"ÇPÅ@î≠Å@çs".
003280     02  LINE   7.
003290         03  COLUMN  25  VALUE NC"ÇQÅ@çƒî≠çsÅ@Å@ëIë".
003300         03  COLUMN  44  VALUE   "[".
003310         03  COLUMN  46  VALUE   "]".
003320     02  LINE  10  COLUMN  21  VALUE  NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".
003330     02  LINE  12.
003340         03  COLUMN  31  VALUE   "(YES=1,NO=2) [".
003350         03  COLUMN  46  VALUE   "]".
003360*****02  LINE  15  COLUMN  31  VALUE  NC"ì`ï[áÇ".                 I.981021
003370     02  LINE  17  COLUMN  21  VALUE  NC"ÇeÇqÇnÇl".
003380     02  LINE  19  COLUMN  21  VALUE  NC"ÇsÇn".
003390     02  LINE  24.
003400         03  COLUMN  41  VALUE  NC"ämîFÅi".
003410         03  COLUMN  47  VALUE    "OK=1,NO=9".
003420         03  COLUMN  56  VALUE  NC"Åj".
003430         03  COLUMN  58  VALUE    "--->  ÿ¿∞›".
003440 01  DSP-GAMEN1.                                                  I.981021
003450     02  DSP-DNOM  LINE  15    COLUMN  31    VALUE  NC"ì`ï[áÇ".   I.981021
003460     02  DSP-DATM.                                                I.981021
003470       03  LINE  15    COLUMN  31    VALUE  NC"ì˙Å@ït".           I.981021
003480       03  LINE  17    COLUMN  31    VALUE  "  /  /  ".           I.981021
003490       03  LINE  19    COLUMN  31    VALUE  "  /  /  ".           I.981021
003500 01  DSP-CLER  LINE   1.
003510     02  CLEAR  SCREEN.
003520 01  DSP-CLER2.
003530     02  LINE 17   COLUMN 31   PIC X(08)   VALUE  "        ".     I.981021
003540     02  LINE 19   COLUMN 31   PIC X(08)   VALUE  "        ".     I.981021
003550*****02  LINE 17   COLUMN 31   PIC X(6)    VALUE  "      ".       D.981021
003560*****02  LINE 19   COLUMN 31   PIC X(6)    VALUE  "      ".       D.981021
003570 01  DSP-MI.
003580     02  LINE  24  COLUMN   1  VALUE
003590         NC"ÅñÅñèoâ◊éwê}ÉgÉâÉìÅ@ñ¢ìoò^".
003600*01  DSP-GDMM.                                                    D.011018
003610*****02  LINE  24  COLUMN   1  VALUE                              D.011018
003620*****    NC"ÅñÅñÉ_É~Å[ÇeÅ@Ç»Çµ".                                  D.011018
003630     COPY  LSERR.                                                 R.900411
003640     COPY  LIBSCR.                                                I.981027
003650
003660*
003670 PROCEDURE         DIVISION.
003680 MAINLINE-ROUTINE.
003690     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
003700     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
003710*****IF  END-STS  =  "P9"                                         D.011018
003720*****    IF  JS-SIGN  =  4       CLOSE  GDMM.                     D.011018
003730     IF  END-STS  =  "P9"  STOP  RUN.
003740     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
003750     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
003760              UNTIL  NOT  (END-SW  NOT  =  9).
003770     IF  PAGE-C  NOT =  1                                         I.900510
003780         MOVE     SPACE     TO    PRN-R                           I.890915
003790         WRITE    PRN-R     AFTER     PAGE.                       I.890915
003800*
003810     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
003820 MAINLINE-END.
003830     STOP  RUN.
003840
003850******************************************************************
003860*    ÉÅÉCÉìèàóù  ÅiÇoÇqÇnÇbÅ|ÇqÇsÇmÅj                            *
003870******************************************************************
003880 PROC-RTN.
003890     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003900     PERFORM  GENT-RTN   THRU  GENT-RTN-EXIT
003910              UNTIL  NOT  (END-SW  =  0  AND  RED-SW  =  1).
003920 PROC-RTN-EXIT.
003930     EXIT.
003940
003950******************************************************************
003960*    ÅiÇfÇdÇmÇsÅ|ÇqÇsÇmÅj                                        *
003970******************************************************************
003980 GENT-RTN.
003990     PERFORM  READ2-RTN  THRU  READ2-RTN-EXIT.
004000     PERFORM  DETL-RTN   THRU  DETL-RTN-EXIT.
004010     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
004020     PERFORM  TOTL-RTN   THRU  TOTL-RTN-EXIT.
004030 GENT-RTN-EXIT.
004040     EXIT.
004050
004060******************************************************************
004070*    èâä˙ê›íËèàóù  ÅiÇhÇmÇhÇsÅ|ÇqÇsÇmÅj                          *
004080******************************************************************
004090 INIT-RTN.
004100     ACCEPT   JS-SIGN.                                            I.900411
004110*****ACCEPT   WYMD    FROM    DATE.                               D.981021
004120     MOVE  1      TO  PAGE-C.
004130     MOVE  0      TO  GOKEI.
004140     MOVE  0      TO  SETSU.                                      A 911002
004150     MOVE  SPACE  TO  WORK-1  WORK-2  WORK-3  WORK-3A             I.981021
004160                      WORK-4  WORK-5  WORK-6  WORK-6A             I.981021
004170                      WORK-7  WORK-8  WORK-9.                     I.981021
004180     MOVE  ZERO   TO  W-DATA.                                     I.981021
004190     ACCEPT  W-DATE  FROM  DATE.                                  I.981021
004200     COPY  LIBCPR.                                                I.981027
004210 INIT-RTN-EXIT.
004220     EXIT.
004230
004240******************************************************************
004250*    ëIëèàóù  ÅiÇrÇkÇbÇsÅ|ÇqÇsÇmÅj                              *
004260******************************************************************
004270 SLCT-RTN.
004280 SLCT-010.
004290     DISPLAY  DSP-CLER.
004300     DISPLAY  DSP-GAMEN.
004310*****IF  JS-SIGN      =  4                                        D.011018
004320*****    OPEN  I-O      GDMM                                      D.011018
004330*****    MOVE  "0"      TO  GDMM-KEY                              D.011018
004340*****    READ  GDMM     INVALID  KEY                              D.011018
004350*****          CLOSE    GDMM                                      D.011018
004360*****          DISPLAY  DSP-GDMM   DISP-BUZ-B                     D.011018
004370*****          STOP  RUN.                                         D.011018
004380 SLCT-020.
004390     ACCEPT   ACP-SEN.
004400     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW
004410                                GO  TO  SLCT-RTN-EXIT.
004420     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-020.
004430     IF  SEN-W NOT = 1  AND  2                                    I.981021
004440         GO  TO  SLCT-020.                                        I.981021
004450     DISPLAY  DSP-CLER2.                                          I.981021
004460     IF  SEN-W = 2                                                I.981021
004470         DISPLAY  DSP-DNOM                                        I.981021
004480         GO  TO  SLCT-030.                                        I.981021
004490     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.981021
004500     IF  W-SNGP = ZERO                                            I.981021
004510         DISPLAY  ERR-02                                          I.981021
004520         GO  TO  SLCT-020.                                        I.981021
004530     DISPLAY  DSP-DATM  ACP-SNGP  ACP-ENGP.                       I.981021
004540*****IF  SEN-W   =  1  OR  2    GO  TO  SLCT-030                  I.981021
004550*****ELSE                       GO  TO  SLCT-020.                 I.981021
004560 SLCT-030.
004570     ACCEPT   ACP-TEST.
004580     IF  END-STS       =  "09"  GO  TO  SLCT-020.
004590     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-030.
004600     IF  TEST-W  =  1
004610         PERFORM  TEST-RTN  THRU  TEST-RTN-EXIT
004620         GO  TO  SLCT-030.
004630     IF  TEST-W  =  2           GO  TO  SLCT-040
004640     ELSE                       GO  TO  SLCT-030.
004650 SLCT-040.
004660     IF  SEN-W    =  1          GO  TO  SLCT-060.
004670     ACCEPT   ACP-DEN1.
004680     IF  END-STS       =  "09"  DISPLAY  DSP-CLER2
004690                                GO  TO  SLCT-030.
004700     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-040.
004710 SLCT-050.
004720     ACCEPT   ACP-DEN2.
004730     IF  END-STS       =  "09"  GO  TO  SLCT-040.
004740     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-050.
004750     IF  DEN-W1  >  DEN-W2      GO  TO  SLCT-040.
004760     GO  TO  SLCT-060.                                            I.981021
004770 SLCT-052.                                                        I.981021
004780     ACCEPT  ACP-SNEN.                                            I.981021
004790     IF  END-STS = "09"                                           I.981021
004800         GO  TO  SLCT-030.                                        I.981021
004810     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
004820         GO  TO  SLCT-052.                                        I.981021
004830     MOVE  ZERO  TO  W-SNEN1.                                     I.981021
004840     IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
004850         ADD  DATE-NC1  TO  W-SNEN.                               I.981027
004860     IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
004870         ADD  DATE-NC2  TO  W-SNEN.                               I.981027
004880*****IF  W-SNEN2 > 90                                             D.981027
004890*****    ADD  1900  TO  W-SNEN                                    D.981027
004900*****  ELSE                                                       D.981027
004910*****    ADD  2000  TO  W-SNEN.                                   D.981027
004920 SLCT-053.                                                        I.981021
004930     ACCEPT  ACP-SGET.                                            I.981021
004940     IF  END-STS = "09"                                           I.981021
004950         GO  TO  SLCT-052.                                        I.981021
004960     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
004970         GO  TO  SLCT-053.                                        I.981021
004980     IF  W-SGET < 1  OR  > 12                                     I.981021
004990         GO  TO  SLCT-053.                                        I.981021
005000 SLCT-054.                                                        I.981021
005010     ACCEPT  ACP-SPEY.                                            I.981021
005020     IF  END-STS = "09"                                           I.981021
005030         GO  TO  SLCT-053.                                        I.981021
005040     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
005050         GO  TO  SLCT-054.                                        I.981021
005060     IF  W-SPEY < 1  OR  > 31                                     I.981021
005070         GO  TO  SLCT-054.                                        I.981021
005080     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981021
005090         GO  TO  SLCT-052.                                        I.981021
005100 SLCT-056.                                                        I.981021
005110     ACCEPT  ACP-ENEN.                                            I.981021
005120     IF  END-STS = "09"                                           I.981021
005130         GO  TO  SLCT-054.                                        I.981021
005140     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
005150         GO  TO  SLCT-056.                                        I.981021
005160     MOVE  ZERO  TO  W-ENEN1.                                     I.981021
005170     IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
005180         ADD  DATE-NC1  TO  W-ENEN.                               I.981027
005190     IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
005200         ADD  DATE-NC2  TO  W-ENEN.                               I.981027
005210*****IF  W-SNEN2 > 90                                             D.981027
005220*****    ADD  1900  TO  W-ENEN                                    D.981027
005230*****  ELSE                                                       D.981027
005240*****    ADD  2000  TO  W-ENEN.                                   D.981027
005250 SLCT-057.                                                        I.981021
005260     ACCEPT  ACP-EGET.                                            I.981021
005270     IF  END-STS = "09"                                           I.981021
005280         GO  TO  SLCT-056.                                        I.981021
005290     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
005300         GO  TO  SLCT-057.                                        I.981021
005310     IF  W-EGET < 1  OR  > 12                                     I.981021
005320         GO  TO  SLCT-057.                                        I.981021
005330 SLCT-058.                                                        I.981021
005340     ACCEPT  ACP-EPEY.                                            I.981021
005350     IF  END-STS = "09"                                           I.981021
005360         GO  TO  SLCT-057.                                        I.981021
005370     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981021
005380         GO  TO  SLCT-058.                                        I.981021
005390     IF  W-EPEY < 1  OR  > 31                                     I.981021
005400         GO  TO  SLCT-058.                                        I.981021
005410     IF  W-SNGP > W-ENGP                                          I.981021
005420         GO  TO  SLCT-056.                                        I.981021
005430     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981021
005440         GO  TO  SLCT-056.                                        I.981021
005450 SLCT-060.
005460     ACCEPT  ACP-KAKU.
005470     IF  END-STS       =  "09"
005480*****    IF  SEN-W  =  1        DISPLAY  DSP-CLER2                D.981021
005490*****                           GO  TO  SLCT-030                  D.981021
005500     IF  SEN-W = 1                                                I.981021
005510         GO  TO  SLCT-052                                         I.981021
005520       ELSE
005530         GO  TO  SLCT-040.
005540     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-060.
005550     IF  KAKU-W  =  1           GO  TO  SLCT-RTN-EXIT.
005560*****IF  KAKU-W  =  9           GO  TO  SLCT-010                  D.980317
005570     IF  KAKU-W  =  9           DISPLAY  DSP-CLER                 I.980317
005580                                DISPLAY  DSP-GAMEN                I.980317
005590                                GO  TO  SLCT-020                  I.980317
005600     ELSE                       GO  TO  SLCT-060.
005610 SLCT-RTN-EXIT.
005620     EXIT.
005630
005640******************************************************************
005650*    ÇqÇdÇ`ÇcèàóùÅiÇPÅj  ÅiÇqÇdÇ`ÇcÇPÅ|ÇqÇsÇmÅj                  *
005660******************************************************************
005670 READ1-RTN.
005680     IF  SEN-W   =  1  GO  TO  READ1-010
005690     ELSE              GO  TO  READ1-030.
005700 READ1-010.
005710*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ ( Ø∫≥))
005720     IF  RED-SW  =  1  GO  TO  READ1-020.
005730     READ  JSTR  NEXT  AT  END
005740                 MOVE  24  TO  ERR-LIN
005750                 DISPLAY  DISP-MSG-SPACE
005760                 DISPLAY  DSP-MI
005770                 DISPLAY  DISP-BUZ-B
005780                 PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005790                 STOP  RUN.
005800     IF  JSTR-17   NOT =  9               GO  TO  READ1-020.      I.930618
005810     IF  JS-SIGN  =  1                                            I.900411
005820         IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-020.      I.900411
005830     IF  JS-SIGN  =  2                                            I.900411
005840         IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-020.      *R 92/05
005850     IF  JS-SIGN  =  3                                            I.950201
005860         IF  JSTR-07  NOT =  2  AND  3  AND  5  AND  6            I.950201
005870                                          GO  TO  READ1-020.      I.950201
005880     IF  JS-SIGN  =  4                                            I.980114
005890         IF  JSTR-07  NOT =  7                                    I.980114
005900                                          GO  TO  READ1-020.      I.980114
005910     IF  JSTR-03   NOT  =  0  GO  TO  READ1-020.
005920     IF  JSTR-158  NOT  =  0  GO  TO  READ1-020.
005930     IF  JSTR-04 < W-SNGP  OR  W-ENGP                             I.981021
005940         GO  TO  READ1-020.                                       I.981021
005950     MOVE  1  TO  RED-SW.
005960     GO  TO  READ1-RTN-EXIT.
005970 READ1-020.
005980     READ  JSTR  NEXT  AT  END
005990                 MOVE  9  TO  END-SW
006000                 GO  TO  READ1-RTN-EXIT.
006010     IF  JSTR-17   NOT =  9               GO  TO  READ1-020.      I.930618
006020***  IF  JSTR-07   NOT  =  2  AND  3  GO  TO  READ1-020.          D 911001
006030     IF  JS-SIGN  =  1                                            A 911001
006040         IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-020.          :
006050     IF  JS-SIGN  =  2                                                :
006060         IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-020.      *R 92/05
006070     IF  JS-SIGN  =  3                                            I.950201
006080         IF  JSTR-07  NOT =  2  AND  3  AND  5  AND  6            I.950201
006090                                          GO  TO  READ1-020.      I.950201
006100     IF  JS-SIGN  =  4                                            I.980114
006110         IF  JSTR-07  NOT =  7                                    I.980114
006120                                          GO  TO  READ1-020.      I.980114
006130     IF  JSTR-03   NOT  =  0  GO  TO  READ1-020.
006140     IF  JSTR-158  NOT  =  0  GO  TO  READ1-020.
006150     IF  JSTR-04 < W-SNGP  OR  W-ENGP                             I.981021
006160         GO  TO  READ1-020.                                       I.981021
006170     MOVE  1  TO  RED-SW.
006180     GO  TO  READ1-RTN-EXIT.
006190 READ1-030.
006200*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ (ª≤ Ø∫≥))
006210     IF  RED-SW  =  1  GO  TO  READ1-040.
006220     MOVE  DEN-W1  TO  JSTR-01.
006230     MOVE  0       TO  JSTR-02.
006240     START  JSTR  KEY  IS  NOT  <  JSTR-KEY  INVALID  KEY
006250                  MOVE  24  TO  ERR-LIN
006260                  DISPLAY  DISP-MSG-SPACE
006270                  DISPLAY  DSP-MI
006280                  DISPLAY  DISP-BUZ-B
006290                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006300                  STOP  RUN.
006310 READ1-040.
006320     READ  JSTR  NEXT  AT  END
006330                 MOVE  9  TO  END-SW
006340                 GO  TO  READ1-RTN-EXIT.
006350     IF  DEN-W2  <  JSTR-01  MOVE  9  TO  END-SW
006360                             GO  TO  READ1-RTN-EXIT.
006370     IF  JSTR-17       =  0               GO  TO  READ1-040.      I.961104
006380*****IF  JSTR-17   NOT =  9               GO  TO  READ1-040.      D.961104
006390*****IF  JSTR-07   NOT  =  2  AND  3  GO  TO  READ1-040.          D 911001
006400     IF  JS-SIGN  =  1                                            A 911001
006410         IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-040.          :
006420     IF  JS-SIGN  =  2                                                :
006430         IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-040.      *R 92/05
006440     IF  JS-SIGN  =  3                                            I.950201
006450         IF  JSTR-07  NOT =  2  AND  3  AND  5  AND  6            I.950201
006460                                          GO  TO  READ1-040.      I.950201
006470     IF  JS-SIGN  =  4                                            I.980114
006480         IF  JSTR-07  NOT =  7                                    I.980114
006490                                          GO  TO  READ1-040.      I.980114
006500     IF  JSTR-03   NOT  =  0  GO  TO  READ1-040.
006510     IF  JSTR-158  NOT  =  1  GO  TO  READ1-040.
006520     MOVE  1  TO  RED-SW.
006530 READ1-RTN-EXIT.
006540     EXIT.
006550
006560******************************************************************
006570*    ÇqÇdÇ`ÇcèàóùÅiÇQÅj  ÅiÇqÇdÇ`ÇcÇQÅ|ÇqÇsÇmÅj                  *
006580******************************************************************
006590 READ2-RTN.
006600*****MOVE  0         TO  TCM-SW.                                  D.020819
006610 READ2-010.
006620*    (¡Æ∏ø≥ª∑•œΩ¿ … ÿ∞ƒﬁ)
006630     MOVE  JSTR-061  TO  TC-TCD.
006640     MOVE  1         TO  TC-CCD.
006650     READ  TC-M  UNLOCK  INVALID  KEY
006660                         MOVE  JSTR-061  TO  WORK-41
006670                         MOVE  SPACE     TO  WORK-42
006680*****                    MOVE  ZERO      TO  TC-DNO               D.010820
006690                         GO  TO  READ2-020.
006700*****IF  ( TC-STK  NOT  =  0 )  AND  ( JSTR-062  =  1 )           D.971002
006710*****    MOVE  1     TO  TCM-SW                                   D.971002
006720*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
006730     MOVE  JSTR-061  TO  WORK-41.
006740     MOVE  TC-NAME   TO  WORK-42.
006750 READ2-020.
006760     IF  JSTR-062  =  1
006770         MOVE  SPACE  TO  WORK-43
006780         MOVE  SPACE  TO  WORK-44
006790         GO  TO  READ2-030
006800     ELSE
006810         MOVE  JSTR-061  TO  TC-TCD
006820         MOVE  JSTR-062  TO  TC-CCD
006830         READ  TC-M  UNLOCK  INVALID  KEY
006840                             MOVE  JSTR-062  TO  WORK-43
006850                             MOVE  SPACE     TO  WORK-44
006860*****                        MOVE  ZERO      TO  TC-DNO           D.010820
006870                             GO  TO  READ2-030.
006880*****IF  TC-STK  NOT  =  0                                        D.971002
006890*****    MOVE  1     TO  TCM-SW                                   D.971002
006900*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
006910     MOVE  JSTR-062  TO  WORK-43.
006920     MOVE  TC-NAME   TO  WORK-44.
006930 READ2-030.
006940*    (À›“≤•œΩ¿ … ÿ∞ƒﬁ)
006950*****MOVE  JSTR-09  TO  SHM-01.                                   D.010818
006960*****READ  SHM  UNLOCK  INVALID  KEY                              D.010818
006970     MOVE  JSTR-09  TO  HI-MHCD HI-HCD.                           I.010818
006980     READ  HI2-M  UNLOCK  INVALID  KEY                            I.010818
006990                        MOVE  SPACE  TO  WORK-62
007000                        GO  TO  READ2-040.
007010*****IF    JSTR-061     =  0459  OR  0460                         D.020819
007020*****      MOVE  SHM-02    TO  W-NAME                             D.010818
007030     IF    JSTR-061     =  0013  OR  0459  OR  0460               I.020819
007040           MOVE  HI-NAME   TO  W-NAME                             I.010818
007050           MOVE  SPACE     TO  W-NA(24)                           I.000808
007060           MOVE  W-NAME    TO  WORK-62                            I.000808
007070        ELSE                                                      I.000808
007080           MOVE  HI-NAME TO  WORK-62.                             I.010818
007090*****      MOVE  SHM-02  TO  WORK-62.                             D.010818
007100 READ2-040.
007110*    (∫›ƒ€∞Ÿ•Ãß≤Ÿ … ÿ∞ƒﬁ)
007120     MOVE  2        TO  JCON2-01.
007130     MOVE  JSTR-14  TO  JCON2-02.
007140     READ  JCON  UNLOCK  INVALID  KEY
007150                         MOVE  SPACE  TO  WORK-71                 I.020819
007160*****                    MOVE  SPACE  TO  WORK-711  WORK-712      D.020819
007170                         GO  TO  READ2-RTN-EXIT.
007180     MOVE  JCON2-03  TO  WORK-71.                                 I.020819
007190*****MOVE  JCON2-03  TO  WORK-711.                                D.020819
007200*****MOVE  SPACE     TO  WORK-712.                                D.020819
007210 READ2-RTN-EXIT.
007220     EXIT.
007230
007240******************************************************************
007250*    ñæç◊èoóÕèàóù  ÅiÇcÇdÇsÇkÅ|ÇqÇsÇmÅj                          *
007260******************************************************************
007270 DETL-RTN.
007280*****IF  TCM-SW  =  1                                             D.020819
007290*****    GO  TO  DETL-010.                                        D.020819
007300     IF  DEN-W  NOT  =  JSTR-01
007310         PERFORM  HEAD-RTN  THRU  HEAD-RTN-EXIT.
007320     PERFORM  WRITE-RTN  THRU  WRITE-RTN-EXIT.
007330 DETL-010.                                                        A 911002
007340     IF  SEN-W  =  1
007350         MOVE  1  TO  JSTR-158
007360         REWRITE  JSTR-R  INVALID  KEY
007370                          MOVE  JSTR-KEY  TO  ERR-K
007380                          MOVE  "JSTR"    TO  ERR-F
007390                          MOVE  "R"       TO  ERR-M
007400                          MOVE   0        TO  ERR-LIN
007410                          PERFORM  ERR-RTN   THRU  ERR-EX
007420                          PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007430                          STOP  RUN.
007440     MOVE  JSTR-01           TO  DEN-W.
007450*****ADD   WORK-92  WORK-82  TO  GOKEI.                           D 890920
007460     IF    JSTR-09  <  999900                                     *I920303
007470           ADD   WORK-92     TO  GOKEI                            A 890920
007480           ADD   WORK-82     TO  SETSU.                           A 911002
007490 DETL-RTN-EXIT.
007500     EXIT.
007510*
007520******************************************************************
007530*    çáåvèoóÕèàóù  ÅiÇsÇnÇsÇkÅ|ÇqÇsÇmÅj                          *
007540******************************************************************
007550 TOTL-RTN.
007560*****IF  TCM-SW  NOT  =  0                                        D.020819
007570*****    GO  TO  TOTL-RTN-EXIT.                                   D.020819
007580     IF  END-SW  =  9
007590***      PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
007600         COMPUTE  J  =  16  -  (I  *  2)                          *R 92/07
007610         MOVE   GOKEI           TO  WORK-73
007620         MOVE   ""3FE04F40A0""  TO  ST-CD4
007630         MOVE   ""3FE04FE080""  TO  ED-CD4
007640         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
007650         GO  TO  TOTL-RTN-EXIT.
007660     IF  JSTR-01  NOT  =  DEN-W
007670***      PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
007680         COMPUTE  J  =  16  -  (I  *  2)                          *R 92/07
007690         MOVE   GOKEI           TO  WORK-73
007700         MOVE   ""3FE04F40A0""  TO  ST-CD4
007710         MOVE   ""3FE04FE080""  TO  ED-CD4
007720         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
007730         MOVE  0  TO  GOKEI.
007740 TOTL-RTN-EXIT.
007750     EXIT.
007760
007770******************************************************************
007780*    ÉZÉbÉgêîèoóÕèàóù  ÅiÇsÇnÇsÇkÇPÅ|ÇqÇsÇmÅj                    *
007790******************************************************************
007800 TOTL1-RTN.                                                       A 911002
007810     COMPUTE  J  =  16  -  (I  *  2)  -  1.                       A 911002
007820     IF  SETSU  NOT  =  0                                         A 911002
007830         MOVE  SETSU    TO  WORK-61A                              A 911002
007840         MOVE  "æØƒ"    TO  WORK-62A                              A 911002
007850         WRITE  PRN-R   FROM  WORK-6A  AFTER J                    A 911002
007860     ELSE                                                         A 911002
007870         MOVE  SPACE    TO  PRN-R                                 A 911002
007880         WRITE  PRN-R   AFTER J.                                  A 911002
007890     MOVE  0    TO  SETSU.                                        A 911002
007900 TOTL1-EX.                                                        A 911002
007910******************************************************************
007920*    å©èoÇµèoóÕèàóù  ÅiÇgÇdÇ`ÇcÅ|ÇqÇsÇmÅj                        *
007930******************************************************************
007940 HEAD-RTN.
007950     IF  PAGE-C  NOT  =  1
007960         MOVE  SPACE  TO  PRN-R
007970         WRITE  PRN-R  AFTER  PAGE.
007980*****MOVE  ""3FE04F40A0""  TO  ST-CD1.                            D.950201
007990*****MOVE  ""3FE04FE080""  TO  ED-CD1.                            D.950201
008000     MOVE  ""3FE04F40A0""  TO  ST-CD0  ST-CD1.                    I.950201
008010     MOVE  ""3FE04FE080""  TO  ED-CD0  ED-CD1.                    I.950201
008020     IF  SEN-W    =  1        MOVE  SPACE     TO  WORK-10         I.950201
008030                       ELSE   MOVE  NC"çƒÅ@"  TO  WORK-10.        I.950201
008040     MOVE  JSTR-01         TO  WORK-11.
008050     MOVE  "TEL" TO WORK-TM.                                      I.020819
008060     MOVE  "FAX" TO WORK-FM.                                      I.020819
008070     IF  JSTR-061       =  0459                                   I.020819
008080         MOVE  NC"äîéÆâÔé–è„éRõâã∆" TO  WORK-NA                   I.020819
008090         MOVE  "663-8033" TO  WORK-UNO                            I.020819
008100         MOVE NC"ï∫å…åßêºã{ésçÇñÿìåí¨ÇPÇTÅ|ÇP" TO WORK-JS         I.020819
008110         MOVE  "0798-64-5111  " TO  WORK-TEL                      I.020819
008120         MOVE  "0798-64-3718  " TO  WORK-FAX                      I.020819
008130       ELSE                                                       I.020819
008140         IF  JSTR-061       =  0460                               I.020819
008150             MOVE  NC"äîéÆâÔé–ÉEÉGÉÑÉ}" TO  WORK-NA               I.020819
008160             MOVE  "663-8033" TO  WORK-UNO                        I.020819
008170             MOVE NC"ï∫å…åßêºã{ésçÇñÿìåí¨ÇPÇTÅ|ÇP" TO WORK-JS     I.020819
008180             MOVE  "0798-67-0810  " TO  WORK-TEL                  I.020819
008190             MOVE  "0798-67-0139  " TO  WORK-FAX                  I.020819
008200           ELSE                                                   I.020819
008210             IF  JSTR-061       =  3966                           I.020819
008220                 MOVE  NC"ëΩî‰ó«äîéÆâÔé–Å@" TO  WORK-NA           I.020819
008230                 MOVE  "165-0021" TO  WORK-UNO                    I.020819
008240                 MOVE NC"ìåãûìsíÜñÏãÊä€éRÇQÅ|ÇTÅ|ÇPÇX" TO WORK-JS I.020819
008250                 MOVE  "03-5373-6711  " TO  WORK-TEL              I.020819
008260                 MOVE  "03-5373-0263  " TO  WORK-FAX              I.020819
008270               ELSE                                               I.020819
008280                 MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–" TO WORK-NA            I.020819
008290                 MOVE  "700-0034" TO  WORK-UNO                    I.020819
008300                 MOVE NC"â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇUÅ@Å@" TO WORK-JS I.020819
008310                 MOVE  "086-252-2456  " TO  WORK-TEL              I.020819
008320                 MOVE  "086-254-8595  " TO  WORK-FAX.             I.020819
008330*****MOVE  NC"ÅÅÅÅ"        TO  WORK-M1.                           D.900917
008340     MOVE    "'"           TO  WORK-M2.                           I.890915
008350*****MOVE  JSTR-041        TO  WORK-211.                          D.980527
008360     MOVE  JSTR-0412       TO  WORK-211.                          I.980527
008370     MOVE  JSTR-042        TO  WORK-212.
008380     MOVE  JSTR-043        TO  WORK-213.
008390     IF  JSTR-03  =  0  MOVE  NC"èoâ◊"  TO  WORK-22.
008400     IF  JSTR-03  =  7  MOVE  NC"ÉTèo"  TO  WORK-22.              A 911002
008410*****IF  JSTR-03  =  1  MOVE  NC"ï‘ïi"  TO  WORK-22.              D 911002
008420*****IF  JSTR-03  =  2  MOVE  NC"ïsó«"  TO  WORK-22.              D 911002
008430*****MOVE  JSTR-07   TO  WORK-23.                                 D 890920
008440     MOVE  3         TO  JCON3-01.                                A 890920
008450     MOVE  JSTR-07   TO  JCON3-02.                                A 890920
008460     READ  JCON      UNLOCK  INVALID                              A 890920
008470                             MOVE ALL NX"2121"  TO  JCON3-03.     A 890920
008480     MOVE  JCON3-03  TO  WORK-23.                                 A 890920
008490     MOVE  JSTR-14B  TO  WORK-31.
008500*****MOVE  SPACE     TO  WORK-33A.                                D.010222
008510*****IF  TC-DNO  NOT =  000  AND 900                              D.010222
008520*****    MOVE  "("       TO  WORK-33F                             D.010222
008530*****    MOVE  TC-DNO    TO  WORK-33                              D.010222
008540*****    MOVE  ")"       TO  WORK-33R.                            D.010222
008550     MOVE  W-DATE    TO  WORK-32.                                 I.981021
008560*****MOVE  WYMD      TO  WORK-32.                                 D.981021
008570     MOVE  1         TO  I.
008580     ADD   1         TO  PAGE-C.
008590     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
008600     WRITE  PRN-R  FROM  WORK-1A AFTER  1.                        I.020819
008610     WRITE  PRN-R  FROM  WORK-1B AFTER  1.                        I.020819
008620     WRITE  PRN-R  FROM  WORK-1C AFTER  1.                        I.020819
008630     WRITE  PRN-R  FROM  WORK-2  AFTER  1.                        I.020819
008640*****WRITE  PRN-R  FROM  WORK-2  AFTER  4.                        D.020819
008650     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
008660     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
008670     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
008680     IF  JSTR-14B  =  OLD-OKNO                                    I.900618
008690           MOVE  SPACE     TO  WORK-70R                           I.900618
008700     ELSE  MOVE  JSTR-15A  TO  WORK-70.                           I.900411
008710     MOVE  JSTR-15   TO  WORK-721.
008720     MOVE  JSTR-14D  TO  WORK-722.
008730     MOVE  JSTR-14B  TO  OLD-OKNO.                                I.900618
008740 HEAD-RTN-EXIT.
008750     EXIT.
008760
008770******************************************************************
008780*    ÇvÇqÇhÇsÇdèàóù  ÅiÇvÇqÇhÇsÇdÅ|ÇqÇsÇmÅj                      *
008790******************************************************************
008800 WRITE-RTN.
008810     INITIALIZE  WORK-5  WORK-8  WORK-9.
008820     MOVE  ""3FE04F40A0""  TO          ST-CD3.                    R 911002
008830     MOVE  ""3FE04FE080""  TO  ED-CD2  ED-CD3.
008840*****IF  JSTR-13  =  1                                            D 911002
008850*********MOVE  NC"óaÇËèoâ◊"  TO  WORK-51                          D 911002
008860*****ELSE                                                         D 911002
008870*********MOVE  SPACE         TO  WORK-51.                         D 911002
008880*****IF  JSTR-13  =  2                                            D.960626
008890*****    MOVE  JSTR-081      TO  WORK-51A                         D.960626
008900*****ELSE                                                         D.960626
008910*****MOVE  SPACE         TO  WORK-51AR.                           D.981028
008920*****IF  JSTR-14A  NOT  >  1                                      D.981028
008930     IF (JSTR-14A  NOT  >  1)   AND   (JSTR-20     =  SPACE)      I.981028
008940         IF  I  =  1
008950             WRITE  PRN-R  FROM  WORK-5  AFTER  5
008960             GO  TO  WRITE-010
008970         ELSE
008980*****        MOVE   SPACE  TO   PRN-R                             D 920629
008990*****        WRITE  PRN-R  AFTER  1                               D 920629
009000             WRITE  PRN-R  FROM  WORK-5  AFTER  1
009010             GO  TO  WRITE-010.
009020*****IF  JSTR-03   NOT  =  0                                      *D 92/07
009030*****    COMPUTE WORK-811(1)  = JSTR-1111(1)  *  -1  / JSTR-14A   *
009040*****    COMPUTE WORK-811(2)  = JSTR-1111(2)  *  -1  / JSTR-14A   *
009050*****    COMPUTE WORK-811(3)  = JSTR-1111(3)  *  -1  / JSTR-14A   *
009060*****    COMPUTE WORK-811(4)  = JSTR-1111(4)  *  -1  / JSTR-14A   *
009070*****    COMPUTE WORK-811(5)  = JSTR-1111(5)  *  -1  / JSTR-14A   *
009080*****    COMPUTE WORK-811(6)  = JSTR-1111(6)  *  -1  / JSTR-14A   *
009090*****    COMPUTE WORK-811(7)  = JSTR-1111(7)  *  -1  / JSTR-14A   *
009100*****    COMPUTE WORK-811(8)  = JSTR-1111(8)  *  -1  / JSTR-14A   *
009110*****    COMPUTE WORK-811(9)  = JSTR-1111(9)  *  -1  / JSTR-14A   *
009120*****    COMPUTE WORK-811(10) = JSTR-1111(10) *  -1  / JSTR-14A   *
009130*****    COMPUTE WORK-82      = JSTR-1111(1)  +  JSTR-1111(2)     *
009140*****                         + JSTR-1111(3)  +  JSTR-1111(4)     *
009150*****                         + JSTR-1111(5)  +  JSTR-1111(6)     *
009160*****                         + JSTR-1111(7)  +  JSTR-1111(8)     *
009170*****                         + JSTR-1111(9)  +  JSTR-1111(10)    *
009180*****    COMPUTE WORK-82      = WORK-82       *  -1  / JSTR-14A   *
009190*****ELSE                                                         *
009200*****COMPUTE WORK-811(1)  = JSTR-1111(1)  / JSTR-14A.             D.981028
009210*****COMPUTE WORK-811(2)  = JSTR-1111(2)  / JSTR-14A.             D.981028
009220*****COMPUTE WORK-811(3)  = JSTR-1111(3)  / JSTR-14A.             D.981028
009230*****COMPUTE WORK-811(4)  = JSTR-1111(4)  / JSTR-14A.             D.981028
009240*****COMPUTE WORK-811(5)  = JSTR-1111(5)  / JSTR-14A.             D.981028
009250*****COMPUTE WORK-811(6)  = JSTR-1111(6)  / JSTR-14A.             D.981028
009260*****COMPUTE WORK-811(7)  = JSTR-1111(7)  / JSTR-14A.             D.981028
009270*****COMPUTE WORK-811(8)  = JSTR-1111(8)  / JSTR-14A.             D.981028
009280*****COMPUTE WORK-811(9)  = JSTR-1111(9)  / JSTR-14A.             D.981028
009290*****COMPUTE WORK-811(10) = JSTR-1111(10) / JSTR-14A.             D.981028
009300*****COMPUTE WORK-82      = JSTR-1111(1)  + JSTR-1111(2)          D.981028
009310*****                     + JSTR-1111(3)  + JSTR-1111(4)          D.981028
009320*****                     + JSTR-1111(5)  + JSTR-1111(6)          D.981028
009330*****                     + JSTR-1111(7)  + JSTR-1111(8)          D.981028
009340*****                     + JSTR-1111(9)  + JSTR-1111(10).        D.981028
009350*****COMPUTE WORK-82      = WORK-82       / JSTR-14A.             D.981028
009360*****MOVE  WORK-811(1)   TO  WORK-521(1).                         D.981028
009370*****MOVE  WORK-811(2)   TO  WORK-521(2).                         D.981028
009380*****MOVE  WORK-811(3)   TO  WORK-521(3).                         D.981028
009390*****MOVE  WORK-811(4)   TO  WORK-521(4).                         D.981028
009400*****MOVE  WORK-811(5)   TO  WORK-521(5).                         D.981028
009410*****MOVE  WORK-811(6)   TO  WORK-521(6).                         D.981028
009420*****MOVE  WORK-811(7)   TO  WORK-521(7).                         D.981028
009430*****MOVE  WORK-811(8)   TO  WORK-521(8).                         D.981028
009440*****MOVE  WORK-811(9)   TO  WORK-521(9).                         D.981028
009450*****MOVE  WORK-811(10)  TO  WORK-521(10).                        D.981028
009460*****MOVE  WORK-82       TO  WORK-53.                             *D 92/07
009470*****MOVE  WORK-82       TO  WORK-53.                             D.981028
009480*****MOVE  "X"           TO  WORK-54.                             D.981028
009490*****MOVE  JSTR-14A      TO  WORK-55.                             D.981028
009500     IF  JSTR-14A       >  1                                      I.981028
009510         COMPUTE WORK-811(1)  = JSTR-1111(1)  / JSTR-14A          I.981028
009520         COMPUTE WORK-811(2)  = JSTR-1111(2)  / JSTR-14A          I.981028
009530         COMPUTE WORK-811(3)  = JSTR-1111(3)  / JSTR-14A          I.981028
009540         COMPUTE WORK-811(4)  = JSTR-1111(4)  / JSTR-14A          I.981028
009550         COMPUTE WORK-811(5)  = JSTR-1111(5)  / JSTR-14A          I.981028
009560         COMPUTE WORK-811(6)  = JSTR-1111(6)  / JSTR-14A          I.981028
009570         COMPUTE WORK-811(7)  = JSTR-1111(7)  / JSTR-14A          I.981028
009580         COMPUTE WORK-811(8)  = JSTR-1111(8)  / JSTR-14A          I.981028
009590         COMPUTE WORK-811(9)  = JSTR-1111(9)  / JSTR-14A          I.981028
009600         COMPUTE WORK-811(10) = JSTR-1111(10) / JSTR-14A          I.981028
009610         COMPUTE WORK-82      = JSTR-1111(1)  + JSTR-1111(2)      I.981028
009620                              + JSTR-1111(3)  + JSTR-1111(4)      I.981028
009630                              + JSTR-1111(5)  + JSTR-1111(6)      I.981028
009640                              + JSTR-1111(7)  + JSTR-1111(8)      I.981028
009650                              + JSTR-1111(9)  + JSTR-1111(10)     I.981028
009660         COMPUTE WORK-82      = WORK-82       / JSTR-14A          I.981028
009670         MOVE  WORK-811(1)   TO  WORK-521(1)                      I.981028
009680         MOVE  WORK-811(2)   TO  WORK-521(2)                      I.981028
009690         MOVE  WORK-811(3)   TO  WORK-521(3)                      I.981028
009700         MOVE  WORK-811(4)   TO  WORK-521(4)                      I.981028
009710         MOVE  WORK-811(5)   TO  WORK-521(5)                      I.981028
009720         MOVE  WORK-811(6)   TO  WORK-521(6)                      I.981028
009730         MOVE  WORK-811(7)   TO  WORK-521(7)                      I.981028
009740         MOVE  WORK-811(8)   TO  WORK-521(8)                      I.981028
009750         MOVE  WORK-811(9)   TO  WORK-521(9)                      I.981028
009760         MOVE  WORK-811(10)  TO  WORK-521(10)                     I.981028
009770         MOVE  WORK-82       TO  WORK-53                          I.981028
009780         MOVE  "X"           TO  WORK-54                          I.981028
009790         MOVE  JSTR-14A      TO  WORK-55.                         I.981028
009800     IF  JSTR-20    NOT =  SPACE                                  I.981028
009810         MOVE  "["           TO  WORK-51F                         I.981028
009820         MOVE  JSTR-20       TO  WORK-51                          I.981028
009830         MOVE  "]"           TO  WORK-51R.                        I.981028
009840     IF  I  =  1
009850*****    MOVE   JSTR-14A     TO  WORK-53                          D.920826
009860         WRITE  PRN-R  FROM  WORK-5  AFTER  5
009870     ELSE
009880*****    MOVE   ZERO         TO  WORK-53                          D.920826
009890         WRITE  PRN-R  FROM  WORK-5  AFTER  1.
009900 WRITE-010.
009910     MOVE  JSTR-09       TO  WORK-61.
009920     MOVE  JSTR-10       TO  WORK-63.
009930*****IF  JSTR-03  NOT  =  0                                       *D 92/07
009940*****    COMPUTE  WORK-911(1)   =  JSTR-1111(1)   *   -1          *
009950*****    COMPUTE  WORK-911(2)   =  JSTR-1111(2)   *   -1          *
009960*****    COMPUTE  WORK-911(3)   =  JSTR-1111(3)   *   -1          *
009970*****    COMPUTE  WORK-911(4)   =  JSTR-1111(4)   *   -1          *
009980*****    COMPUTE  WORK-911(5)   =  JSTR-1111(5)   *   -1          *
009990*****    COMPUTE  WORK-911(6)   =  JSTR-1111(6)   *   -1          *
010000*****    COMPUTE  WORK-911(7)   =  JSTR-1111(7)   *   -1          *
010010*****    COMPUTE  WORK-911(8)   =  JSTR-1111(8)   *   -1          *
010020*****    COMPUTE  WORK-911(9)   =  JSTR-1111(9)   *   -1          *
010030*****    COMPUTE  WORK-911(10)  =  JSTR-1111(10)  *   -1          *
010040*****    COMPUTE  WORK-92       =  JSTR-1111(1)  +  JSTR-1111(2)  *
010050*****                           +  JSTR-1111(3)  +  JSTR-1111(4)  *
010060*****                           +  JSTR-1111(5)  +  JSTR-1111(6)  *
010070*****                           +  JSTR-1111(7)  +  JSTR-1111(8)  *
010080*****                           +  JSTR-1111(9)  +  JSTR-1111(10) *
010090*****    COMPUTE  WORK-92       =  WORK-92        *   -1          *
010100*****    MOVE  WORK-911(1)   TO  WORK-641(1)                      *
010110*****    MOVE  WORK-911(2)   TO  WORK-641(2)                      *
010120*****    MOVE  WORK-911(3)   TO  WORK-641(3)                      *
010130*****    MOVE  WORK-911(4)   TO  WORK-641(4)                      *
010140*****    MOVE  WORK-911(5)   TO  WORK-641(5)                      *
010150*****    MOVE  WORK-911(6)   TO  WORK-641(6)                      *
010160*****    MOVE  WORK-911(7)   TO  WORK-641(7)                      *
010170*****    MOVE  WORK-911(8)   TO  WORK-641(8)                      *
010180*****    MOVE  WORK-911(9)   TO  WORK-641(9)                      *
010190*****    MOVE  WORK-911(10)  TO  WORK-641(10)                     *
010200*********MOVE  WORK-92       TO  WORK-65                          * 911002
010210*****    GO  TO  WRITE-020                                        * 911002
010220*****ELSE
010230     MOVE  JSTR-1111(1)   TO  WORK-641(1).
010240     MOVE  JSTR-1111(2)   TO  WORK-641(2).
010250     MOVE  JSTR-1111(3)   TO  WORK-641(3).
010260     MOVE  JSTR-1111(4)   TO  WORK-641(4).
010270     MOVE  JSTR-1111(5)   TO  WORK-641(5).
010280     MOVE  JSTR-1111(6)   TO  WORK-641(6).
010290     MOVE  JSTR-1111(7)   TO  WORK-641(7).
010300     MOVE  JSTR-1111(8)   TO  WORK-641(8).
010310     MOVE  JSTR-1111(9)   TO  WORK-641(9).
010320     MOVE  JSTR-1111(10)  TO  WORK-641(10).
010330     COMPUTE  WORK-92  =  JSTR-1111(1)  +  JSTR-1111(2)
010340                       +  JSTR-1111(3)  +  JSTR-1111(4)
010350                       +  JSTR-1111(5)  +  JSTR-1111(6)
010360                       +  JSTR-1111(7)  +  JSTR-1111(8)
010370                       +  JSTR-1111(9)  +  JSTR-1111(10).         R 911002
010380*********MOVE  WORK-92  TO  WORK-65.                              D 911002
010390 WRITE-020.                                                       A 911002
010400*****IF  JSTR-13  =  2                                            D.960626
010410     IF  JSTR-13  =  4 OR 5                                       I.960626
010420         MOVE  "("       TO  WORK-651                             A 911002
010430         MOVE  WORK-92   TO  WORK-652                             A 911002
010440         MOVE  ")"       TO  WORK-66                              A 911002
010450      ELSE                                                        A 911002
010460         MOVE  WORK-92   TO  WORK-65                              A 911002
010470         MOVE  SPACE     TO  WORK-66.                             A 911002
010480     WRITE  PRN-R  FROM  WORK-6  AFTER  1.
010490     ADD  1  TO  I.
010500 WRITE-RTN-EXIT.
010510     EXIT.
010520
010530******************************************************************
010540*    ÉeÉXÉgàÛéöèàóù  ÅiÇsÇdÇrÇsÅ|ÇqÇsÇmÅj                        *
010550******************************************************************
010560 TEST-RTN.
010570     OPEN  OUTPUT  PRN-F.
010580*****MOVE ""3FE04F40A0"" TO  ST-CD1.                              D.950201
010590*****MOVE ""3FE04FE080"" TO  ED-CD1.                              D.950201
010600     MOVE ""3FE04F40A0"" TO  ST-CD0  ST-CD1.                      I.950201
010610     MOVE ""3FE04FE080"" TO  ED-CD0  ED-CD1.                      I.950201
010620     MOVE  SPACE         TO  WORK-10.                             I.950201
010630     MOVE  ALL    "9"    TO  WORK-11.
010640*****MOVE  NC"ÅÅÅÅ"      TO  WORK-M1.                             D.900917
010650     MOVE  "'"           TO  WORK-M2.                             I.890915
010660     MOVE  ALL    "9"    TO  WORK-211  WORK-212  WORK-213.
010670*****MOVE  ALL  NC"ÇX"   TO  WORK-22.                             D 890920
010680     MOVE  ALL  NC"Çm"   TO  WORK-23.                             A 890920
010690     MOVE  ALL    "9"    TO  WORK-31  WORK-32.                    R.900411
010700     MOVE  ALL    "9"    TO  WORK-41  WORK-43.
010710     MOVE  ALL  NC"ÇX"   TO  WORK-42  WORK-44.
010720     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
010730     WRITE  PRN-R  FROM  WORK-2  AFTER  4.
010740     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
010750     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
010760     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
010770     MOVE  1  TO  I.
010780 TEST-010.
010790     MOVE ""3FE04F40A0"" TO          ST-CD3.                      R 911002
010800     MOVE ""3FE04FE080"" TO  ED-CD2  ED-CD3.
010810*****MOVE  ALL  NC"ÇX"   TO  WORK-51.                             D 911002
010820*****MOVE  ALL    "9"    TO  WORK-51A.                            D.960626
010830     MOVE         99     TO  WORK-521(1)  WORK-521(2)
010840                             WORK-521(3)  WORK-521(4)
010850                             WORK-521(5)  WORK-521(6)
010860                             WORK-521(7)  WORK-521(8)
010870                             WORK-521(9)  WORK-521(10).
010880     MOVE         999    TO  WORK-53.
010890     MOVE         "X"    TO  WORK-54.                             I.920826
010900     MOVE         999    TO  WORK-55.                             I.920826
010910     MOVE  ALL    "9"    TO  WORK-61.
010920     MOVE  ALL  NC"ÇX"   TO  WORK-62.
010930     MOVE  ALL    "9"    TO  WORK-63.
010940     MOVE  ALL    "9"    TO  WORK-641(1)  WORK-641(2)
010950                             WORK-641(3)  WORK-641(4)
010960                             WORK-641(5)  WORK-641(6)
010970                             WORK-641(7)  WORK-641(8)
010980                             WORK-641(9)  WORK-641(10).
010990     MOVE  ALL    "9"    TO  WORK-65.
011000     IF  I  =  1
011010         WRITE  PRN-R  FROM  WORK-5  AFTER  5
011020         WRITE  PRN-R  FROM  WORK-6  AFTER  1
011030     ELSE
011040         WRITE  PRN-R  FROM  WORK-5  AFTER  1
011050         WRITE  PRN-R  FROM  WORK-6  AFTER  1.
011060     IF  I  =  6             GO  TO  TEST-020
011070                      ELSE   ADD  1  TO  I
011080                             GO  TO  TEST-010.
011090 TEST-020.
011100     MOVE ""3FE04F40A0"" TO  ST-CD4.
011110     MOVE ""3FE04FE080"" TO  ED-CD4.
011120*****MOVE       "999"    TO  WORK-61A.                            *D 92/07
011130*****MOVE       "æØƒ"    TO  WORK-62A.                            *D 92/07
011140     WRITE  PRN-R  FROM  WORK-6A  AFTER  1.                       A 911002
011150*****MOVE  ALL  NC"ÇX"   TO  WORK-711  WORK-712                   D.020819
011160     MOVE  ALL  NC"ÇX"   TO  WORK-71                              I.020819
011170                             WORK-721  WORK-722.
011180     MOVE  ALL    "9"    TO  WORK-73  WORK-70.                    R.900411
011190     WRITE  PRN-R  FROM  WORK-7  AFTER  1.                        R 911002
011200     CLOSE  PRN-F.
011210 TEST-RTN-EXIT.
011220     EXIT.
011230 SEL-RTN.                                                         I.981021
011240     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981021
011250     OPEN  INPUT  JSTR.                                           I.981021
011260 SEL-010.                                                         I.981021
011270     READ  JSTR  NEXT  RECORD  AT  END                            I.981021
011280         GO  TO  SEL-090.                                         I.981021
011290     IF  JSTR-17   NOT =  9               GO  TO  SEL-010.        I.981028
011300     IF  JS-SIGN  =  1                                            I.981028
011310         IF  JSTR-07  NOT =  2  AND  3    GO  TO  SEL-010.        I.981028
011320     IF  JS-SIGN  =  2                                            I.981028
011330         IF  JSTR-07  NOT =  5  AND  6    GO  TO  SEL-010.        I.981028
011340     IF  JS-SIGN  =  3                                            I.981028
011350         IF  JSTR-07  NOT =  2  AND  3  AND  5  AND  6            I.981028
011360                                          GO  TO  SEL-010.        I.981028
011370     IF  JS-SIGN  =  4                                            I.981028
011380         IF  JSTR-07  NOT =  7                                    I.981028
011390                                          GO  TO  SEL-010.        I.981028
011400     IF  JSTR-03   NOT  =  0              GO  TO  SEL-010.        I.981028
011410     IF  JSTR-158  NOT  =  0              GO  TO  SEL-010.        I.981028
011420     IF  W-SDATE = ZERO                                           I.981021
011430         MOVE  JSTR-04  TO  W-SDATE.                              I.981021
011440     IF  W-SDATE > JSTR-04                                        I.981021
011450         MOVE  JSTR-04  TO  W-SDATE.                              I.981021
011460     IF  W-EDATE < JSTR-04                                        I.981021
011470         MOVE  JSTR-04  TO  W-EDATE.                              I.981021
011480 SEL-090.                                                         I.981021
011490     CLOSE  JSTR.                                                 I.981021
011500     MOVE  W-SDATE  TO  W-SNGP.                                   I.981021
011510     MOVE  W-EDATE  TO  W-ENGP.                                   I.981021
011520 SEL-EX.                                                          I.981021
011530     EXIT.                                                        I.981021
011540******************************************************************
011550*    ÇnÇoÇdÇmèàóù  ÅiÇnÇoÇdÇmÅ|ÇqÇsÇmÅj                        *
011560******************************************************************
011570 OPEN-RTN.
011580     OPEN  I-O     JSTR
011590           INPUT   JCON
011600                   TC-M
011610                   HI2-M                                          I.010818
011620*****              SHM                                            D.010818
011630           OUTPUT  PRN-F.
011640 OPEN-RTN-EXIT.
011650     EXIT.
011660
011670******************************************************************
011680*    ÇbÇkÇnÇrÇdèàóù  ÅiÇbÇkÇrÇdÅ|ÇqÇsÇmÅj                        *
011690******************************************************************
011700 CLSE-RTN.
011710     CLOSE  JSTR
011720            JCON
011730            TC-M
011740            HI2-M                                                 I.010818
011750*****       SHM                                                   D.010818
011760            PRN-F.
011770*****IF  JS-SIGN      =  4              CLOSE  GDMM.              D.011018
011780 CLSE-RTN-EXIT.
011790     EXIT.
011800
011810     COPY  LPERR.                                                 R.900411
