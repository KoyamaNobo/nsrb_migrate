000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JTN15I.
000030*********************************************************
000040*    PROGRAM         :  生協出荷予定入力　              *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SJN15I                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT HI2-M ASSIGN TO HI-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY HI-KEY2
000200         FILE STATUS IS ERR-STAT.
000210     SELECT TC-M ASSIGN TO TC-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY TC-KEY
000250         FILE STATUS IS ERR-STAT.
000260     SELECT GSYF ASSIGN TO GSY-RDB
000270         ORGANIZATION INDEXED
000280         ACCESS MODE DYNAMIC
000290         RECORD KEY GSY-KEY
000300         FILE STATUS IS ERR-STAT.
000310     SELECT SP-F ASSIGN TO P-PRN999.
000320 I-O-CONTROL.
000330     APPLY SHARED-MODE ON M-DATE
000340     APPLY SHARED-MODE ON HI2-M
000350     APPLY SHARED-MODE ON TC-M
000360     APPLY SHARED-MODE ON GSYF
000370     APPLY SHIFT-CODE  ON SP-F.
000380 DATA DIVISION.
000390 FILE SECTION.
000400     COPY LIBFDD.
000410     COPY LIHIM2.
000420     COPY LITCM.
000430     COPY LIGSYF.
000440     COPY LSPF.
000450 WORKING-STORAGE SECTION.
000460 77  ERR-STAT           PIC  X(002).
000470 77  W-FILE             PIC  X(013).
000480 01  HEAD1.
000490     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000500     02  F              PIC  X(040) VALUE SPACE.
000510     02  F              PIC  N(023) VALUE
000520          NC"＊＊＊　　生協　出荷予定　入力リスト　　＊＊＊".
000530     02  F              PIC  X(028) VALUE SPACE.
000540     02  F              PIC  X(005) VALUE "DATE ".
000550     02  H-DATE         PIC 99B99B99.
000560     02  F              PIC  X(007) VALUE "     P.".
000570     02  H-PAGE         PIC Z9.
000580 01  HEAD2.
000590     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
000600     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".
000610     02  F              PIC  N(006) VALUE NC"品　　　名　".
000620     02  F              PIC  X(120) VALUE SPACE.
000630 01  HEAD3.
000640     02  F              PIC  X(006) VALUE SPACE.
000650     02  F              PIC  X(005) VALUE "ｺｰﾄﾞ ".
000660     02  F              PIC  N(008) VALUE NC"得　意　先　名　".
000670     02  F              PIC  X(113) VALUE SPACE.
000680 01  HEAD4.
000690     02  F              PIC  X(023) VALUE SPACE.
000700     02  F              PIC  N(004) VALUE NC"　納入日".
000710     02  F              PIC  X(003) VALUE SPACE.
000720     02  F              PIC  X(001) VALUE "1".
000730     02  F              PIC  X(004) VALUE SPACE.
000740     02  F              PIC  N(002) VALUE NC"３号".
000750     02  F              PIC  X(004) VALUE SPACE.
000760     02  F              PIC  N(002) VALUE NC"２号".
000770     02  F              PIC  X(005) VALUE SPACE.
000780     02  F              PIC  X(002) VALUE "SS".
000790     02  F              PIC  X(006) VALUE SPACE.
000800     02  F              PIC  X(001) VALUE "S".
000810     02  F              PIC  X(006) VALUE SPACE.
000820     02  F              PIC  X(001) VALUE "M".
000830     02  F              PIC  X(006) VALUE SPACE.
000840     02  F              PIC  X(001) VALUE "L".
000850     02  F              PIC  X(005) VALUE SPACE.
000860     02  F              PIC  X(002) VALUE "LL".
000870     02  F              PIC  X(005) VALUE SPACE.
000880     02  F              PIC  X(002) VALUE "XL".
000890     02  F              PIC  X(004) VALUE SPACE.
000900     02  F              PIC  X(003) VALUE "XXL".
000910     02  F              PIC  X(003) VALUE SPACE.
000920     02  F              PIC  X(004) VALUE "30.0".
000930     02  F              PIC  X(009) VALUE SPACE.
000940     02  F              PIC  N(004) VALUE NC"摘　要　".
000950     02  F              PIC  X(018) VALUE SPACE.
000960 01  HEAD5.
000970     02  F              PIC  X(032) VALUE SPACE.
000980     02  F              PIC  X(001) VALUE "2".
000990     02  F              PIC  X(003) VALUE SPACE.
001000     02  F              PIC  X(004) VALUE "12.5".
001010     02  F              PIC  X(003) VALUE SPACE.
001020     02  F              PIC  X(004) VALUE "13.0".
001030     02  F              PIC  X(003) VALUE SPACE.
001040     02  F              PIC  X(004) VALUE "13.5".
001050     02  F              PIC  X(003) VALUE SPACE.
001060     02  F              PIC  X(004) VALUE "14.0".
001070     02  F              PIC  X(003) VALUE SPACE.
001080     02  F              PIC  X(004) VALUE "15.0".
001090     02  F              PIC  X(003) VALUE SPACE.
001100     02  F              PIC  X(004) VALUE "16.0".
001110     02  F              PIC  X(003) VALUE SPACE.
001120     02  F              PIC  X(004) VALUE "17.0".
001130     02  F              PIC  X(003) VALUE SPACE.
001140     02  F              PIC  X(004) VALUE "18.0".
001150     02  F              PIC  X(003) VALUE SPACE.
001160     02  F              PIC  X(004) VALUE "19.0".
001170     02  F              PIC  X(003) VALUE SPACE.
001180     02  F              PIC  X(004) VALUE "20.0".
001190     02  F              PIC  X(033) VALUE SPACE.
001200 01  HEAD6.
001210     02  F              PIC  X(032) VALUE SPACE.
001220     02  F              PIC  X(001) VALUE "3".
001230     02  F              PIC  X(003) VALUE SPACE.
001240     02  F              PIC  X(004) VALUE "21.0".
001250     02  F              PIC  X(003) VALUE SPACE.
001260     02  F              PIC  X(004) VALUE "21.5".
001270     02  F              PIC  X(003) VALUE SPACE.
001280     02  F              PIC  X(004) VALUE "22.0".
001290     02  F              PIC  X(003) VALUE SPACE.
001300     02  F              PIC  X(004) VALUE "22.5".
001310     02  F              PIC  X(003) VALUE SPACE.
001320     02  F              PIC  X(004) VALUE "23.0".
001330     02  F              PIC  X(003) VALUE SPACE.
001340     02  F              PIC  X(004) VALUE "23.5".
001350     02  F              PIC  X(003) VALUE SPACE.
001360     02  F              PIC  X(004) VALUE "24.0".
001370     02  F              PIC  X(003) VALUE SPACE.
001380     02  F              PIC  X(004) VALUE "24.5".
001390     02  F              PIC  X(003) VALUE SPACE.
001400     02  F              PIC  X(004) VALUE "25.0".
001410     02  F              PIC  X(040) VALUE SPACE.
001420 01  HEAD7.
001430     02  F              PIC  X(032) VALUE SPACE.
001440     02  F              PIC  X(001) VALUE "4".
001450     02  F              PIC  X(003) VALUE SPACE.
001460     02  F              PIC  X(004) VALUE "24.0".
001470     02  F              PIC  X(003) VALUE SPACE.
001480     02  F              PIC  X(004) VALUE "24.5".
001490     02  F              PIC  X(003) VALUE SPACE.
001500     02  F              PIC  X(004) VALUE "25.0".
001510     02  F              PIC  X(003) VALUE SPACE.
001520     02  F              PIC  X(004) VALUE "25.5".
001530     02  F              PIC  X(003) VALUE SPACE.
001540     02  F              PIC  X(004) VALUE "26.0".
001550     02  F              PIC  X(003) VALUE SPACE.
001560     02  F              PIC  X(004) VALUE "26.5".
001570     02  F              PIC  X(003) VALUE SPACE.
001580     02  F              PIC  X(004) VALUE "27.0".
001590     02  F              PIC  X(003) VALUE SPACE.
001600     02  F              PIC  X(004) VALUE "27.5".
001610     02  F              PIC  X(019) VALUE SPACE.
001620     02  F              PIC  N(002) VALUE NC"合計".
001630     02  F              PIC  X(025) VALUE SPACE.
001640 01  W-P1.
001650     02  P-HCD          PIC  9(006).
001660     02  F              PIC  X(001).
001670     02  P-HNA          PIC  N(024).
001680     02  F              PIC  X(093).
001690 01  W-P2.
001700     02  F              PIC  X(006).
001710     02  P-TCD          PIC  9(004).
001720     02  F              PIC  X(001).
001730     02  P-TNA          PIC  N(026).
001740     02  F              PIC  X(086).
001750 01  W-P3.
001760     02  F              PIC  X(010).
001770     02  P-TM           PIC  N(008).
001780     02  P-ND           PIC 99/99/99.
001790     02  F              PIC  X(002).
001800     02  P-SIZ          PIC  9(001).
001810     02  P-SUD.
001820       03  P-SU         PIC ---,---  OCCURS  10.
001830     02  P-SUT          PIC ----,--9.
001840     02  F              PIC  X(001).
001850     02  P-TEK          PIC  N(016).
001860 01  W-DATA.
001870     02  W-PAGE         PIC  9(002).
001880     02  W-ACT          PIC  9(001).
001890     02  W-HCD          PIC  9(006).
001900     02  W-TCD          PIC  9(004).
001910     02  W-ND           PIC  9(008).
001920     02  W-NDL   REDEFINES W-ND.
001930       03  F            PIC  9(002).
001940       03  W-NDS        PIC  9(006).
001950       03  W-NDSD  REDEFINES W-NDS.
001960         04  W-NNEN     PIC  9(002).
001970         04  W-NGET     PIC  9(002).
001980         04  W-NPEY     PIC  9(002).
001990     02  W-ASUD.
002000       03  W-ASU   OCCURS   4.
002010         04  W-SUD   OCCURS  10.
002020           05  W-SU     PIC S9(006).
002030     02  W-SUT          PIC S9(006).
002040     02  W-TEK          PIC  N(016).
002050     02  W-BSU          PIC S9(006).
002060     02  W-SC           PIC  9(001).
002070     02  CNT            PIC  9(002).
002080     02  W-L            PIC  9(002).
002090     02  W-C            PIC S9(002).
002100     02  W-FC           PIC  9(001).
002110     02  W-RC           PIC  9(001).
002120     02  W-KC           PIC  9(001).
002130     02  WS-ASUD.
002140       03  WS-ASU   OCCURS   4.
002150         04  WS-SUD   OCCURS  10.
002160           05  WS-SU    PIC S9(006).
002170     02  WA-ASUD.
002180       03  WA-ASU   OCCURS   4.
002190         04  WA-SUD   OCCURS  10.
002200           05  WA-SU    PIC S9(006).
002210     02  W-DMM          PIC  9(001).
002220     02  W-SED.
002230       03  W-FHCD       PIC  9(006).
002240       03  W-THCD       PIC  9(006).
002250       03  W-FTCD       PIC  9(004).
002260       03  W-TTCD       PIC  9(004).
002270       03  W-FND.
002280         04  W-FNN      PIC  9(002).
002290         04  W-FNG      PIC  9(002).
002300         04  W-FNP      PIC  9(002).
002310       03  W-TND.
002320         04  W-TNN      PIC  9(002).
002330         04  W-TNG      PIC  9(002).
002340         04  W-TNP      PIC  9(002).
002350       03  W-FNDD       PIC  9(008).
002360       03  W-TNDD       PIC  9(008).
002370     02  W-NGP.
002380       03  W-NEN        PIC  9(004).
002390       03  W-NENL  REDEFINES W-NEN.
002400         04  W-NEN1     PIC  9(002).
002410         04  W-NEN2     PIC  9(002).
002420       03  W-GET        PIC  9(002).
002430       03  W-PEY        PIC  9(002).
002440     02  W-NGPL  REDEFINES W-NGP.
002450       03  F            PIC  9(002).
002460       03  W-NGPS       PIC  9(006).
002470     02  W-SYSD         PIC  9(008).
002480     02  W-SYSDD REDEFINES W-SYSD.
002490       03  F            PIC  9(002).
002500       03  W-SYSH       PIC  9(006).
002510     02  W-SNGP         PIC  9(008).
002520     02  W-ENGP         PIC  9(008).
002530     02  CHK.
002540       03  CHK1         PIC  9(001).
002550       03  CHK2         PIC  9(001).
002560     COPY LSTAT.
002570 SCREEN SECTION.
002580 SD  C-CRT
002590     END STATUS IS ESTAT.
002600 01  C-CLEAR.
002610     02  LINE  1  CLEAR SCREEN.
002620 01  C-MID.
002630     02  LINE   1  COLUMN  30  PIC  N(010) VALUE
002640          NC"生協　出荷予定　入力".
002650     02  LINE   3  COLUMN  20  PIC  X(041) VALUE
002660          "追加=1 修正=2 削除=3 作表=4 終了=9   ﾘﾀｰﾝ".
002670     02  LINE  10  COLUMN  36  PIC  X(022) VALUE
002680          "品名   得意先   納入日".
002690     02  LINE  12.
002700       03  COLUMN  24  PIC  N(004) VALUE NC"ＦＲＯＭ".
002710       03  COLUMN  53  PIC  X(001) VALUE "/".
002720       03  COLUMN  56  PIC  X(001) VALUE "/".
002730     02  LINE  14.
002740       03  COLUMN  24  PIC  N(004) VALUE NC"ＴＯ　　".
002750       03  COLUMN  53  PIC  X(001) VALUE "/".
002760       03  COLUMN  56  PIC  X(001) VALUE "/".
002770     02  LINE  23  COLUMN  42  PIC  X(022) VALUE
002780          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002790 01  C-ACP.
002800     02  A-ACT   LINE   3  COLUMN  56  PIC  9(001)
002810          USING W-ACT   CHECK OVERFLOW NO IFC.
002820     02  A-HCD   LINE   5  COLUMN   7  PIC  9(006)
002830          USING W-HCD   CHECK OVERFLOW NO IFC.
002840     02  A-TCD   LINE   7  COLUMN   7  PIC  9(004)
002850          USING W-TCD   CHECK OVERFLOW NO IFC.
002860     02  LINE   9.
002870       03  A-NNEN  COLUMN   9  PIC  9(002)
002880            USING W-NNEN                 NO IFC.
002890       03  A-NGET  COLUMN  12  PIC  9(002)
002900            USING W-NGET                 NO IFC.
002910       03  A-NPEY  COLUMN  15  PIC  9(002)
002920            USING W-NPEY  CHECK OVERFLOW NO IFC.
002930     02  A-SU    LINE W-L  COLUMN W-C  PIC S9(006)
002940          USING W-SU(W-SC,CNT) CHECK OVERFLOW NO IFC.
002950     02  A-TEK   LINE  20  COLUMN   7  PIC  N(016)
002960          USING W-TEK   CHECK OVERFLOW NO IFC.
002970     02  A-DMM   LINE  23  COLUMN  59  PIC  9(001)
002980          USING W-DMM   CHECK OVERFLOW NO IFC.
002990*
003000     02  LINE  12.
003010       03  A-FHCD  COLUMN  35  PIC  9(006)
003020            USING W-FHCD  CHECK OVERFLOW NO IFC.
003030       03  A-FTCD  COLUMN  44  PIC  9(004)
003040            USING W-FTCD  CHECK OVERFLOW NO IFC.
003050       03  A-FNN   COLUMN  51  PIC  9(002)
003060            USING W-FNN                  NO IFC.
003070       03  A-FNG   COLUMN  54  PIC  9(002)
003080            USING W-FNG                  NO IFC.
003090       03  A-FNP   COLUMN  57  PIC  9(002)
003100            USING W-FNP   CHECK OVERFLOW NO IFC.
003110     02  LINE  14.
003120       03  A-THCD  COLUMN  35  PIC  9(006)
003130            USING W-THCD  CHECK OVERFLOW NO IFC.
003140       03  A-TTCD  COLUMN  44  PIC  9(004)
003150            USING W-TTCD  CHECK OVERFLOW NO IFC.
003160       03  A-TNN   COLUMN  51  PIC  9(002)
003170            USING W-TNN                  NO IFC.
003180       03  A-TNG   COLUMN  54  PIC  9(002)
003190            USING W-TNG                  NO IFC.
003200       03  A-TNP   COLUMN  57  PIC  9(002)
003210            USING W-TNP   CHECK OVERFLOW NO IFC.
003220 01  C-DSP.
003230     02  D-HNA   LINE   5  COLUMN  19  PIC  N(024) FROM  HI-NAME.
003240     02  D-TNA   LINE   7  COLUMN  19  PIC  N(026) FROM  TC-NAME.
003250     02  D-SU    LINE W-L  COLUMN W-C  PIC ------  FROM
003260                                       W-SU(W-SC,CNT).
003270     02  D-SUT   LINE  18  COLUMN  72  PIC ---,--- FROM  W-SUT.
003280 01  C-ERR.
003290     02  LINE  24.
003300       03  E-ME1   COLUMN  15  PIC  X(025) VALUE
003310            "***  DATA ｱﾘ  ***        ".
003320       03  E-ME2   COLUMN  15  PIC  X(025) VALUE
003330            "***  DATA ﾅｼ  ***        ".
003340       03  E-ME3   COLUMN  15  PIC  X(025) VALUE
003350            "***  ﾋﾝﾒｲ ﾅｼ  ***        ".
003360       03  E-ME4   COLUMN  15  PIC  X(025) VALUE
003370            "***  ﾄｸｲｻｷ ﾅｼ  ***       ".
003380       03  E-ME5   COLUMN  15  PIC  X(025) VALUE
003390            "***  ﾋﾂﾞｹ ﾁｪｯｸ  ***      ".
003400       03  E-ME6   COLUMN  15  PIC  X(025) VALUE
003410            "***  ｽｳﾘｮｳ ｶﾞ ﾊｲｯﾃﾅｲ  ***".
003420       03  E-ME11  COLUMN  15  PIC  X(025) VALUE
003430            "***  WRITE ｴﾗｰ  ***      ".
003440       03  E-ME12  COLUMN  15  PIC  X(025) VALUE
003450            "***  REWRITE ｴﾗｰ  ***    ".
003460       03  E-ME13  COLUMN  15  PIC  X(025) VALUE
003470            "***  DELETE ｴﾗｰ  ***     ".
003480       03  E-DATE.
003490         04  COLUMN  43  PIC  9(008) FROM  W-SNGP.
003500         04  COLUMN  53  PIC  9(008) FROM  W-ENGP.
003510         04  COLUMN  63  PIC  9(008) FROM  W-NGP.
003520         04  COLUMN  73  PIC  9(008) FROM  W-SYSD.
003530     COPY LIBSCR.
003540     COPY LSSEM.
003550 PROCEDURE DIVISION.
003560 M-020.
003570     MOVE ZERO TO W-DATA.
003580     ACCEPT W-NGPS FROM DATE.
003590     COPY LIBCPR.
003600     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
003610         ADD DATE-NC1 TO W-NEN.
003620     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
003630         ADD DATE-NC2 TO W-NEN.
003640     MOVE W-NGP TO W-SYSD.
003650*
003660     ADD 1 TO W-GET.
003670     IF W-GET = 13
003680         ADD 1 TO W-NEN
003690         MOVE 1 TO W-GET.
003700     ADD 1 TO W-GET.
003710     IF W-GET = 13
003720         ADD 1 TO W-NEN
003730         MOVE 1 TO W-GET.
003740     ADD 1 TO W-GET.
003750     IF W-GET = 13
003760         ADD 1 TO W-NEN
003770         MOVE 1 TO W-GET.
003780     ADD 1 TO W-GET.
003790     IF W-GET = 13
003800         ADD 1 TO W-NEN
003810         MOVE 1 TO W-GET.
003820     MOVE 31 TO W-PEY.
003830     MOVE W-NGP TO W-ENGP.
003840*
003850     MOVE W-SYSD TO W-NGP.
003860     SUBTRACT 1 FROM W-GET.
003870     IF W-GET = ZERO
003880         SUBTRACT 1 FROM W-NEN
003890         MOVE 12 TO W-GET.
003900     SUBTRACT 1 FROM W-GET.
003910     IF W-GET = ZERO
003920         SUBTRACT 1 FROM W-NEN
003930         MOVE 12 TO W-GET.
003940     SUBTRACT 1 FROM W-GET.
003950     IF W-GET = ZERO
003960         SUBTRACT 1 FROM W-NEN
003970         MOVE 12 TO W-GET.
003980     SUBTRACT 1 FROM W-GET.
003990     IF W-GET = ZERO
004000         SUBTRACT 1 FROM W-NEN
004010         MOVE 12 TO W-GET.
004020     MOVE 1 TO W-PEY.
004030     MOVE W-NGP TO W-SNGP.
004040*
004050     OPEN INPUT HI2-M TC-M.
004060     OPEN I-O GSYF.
004070 M-040.
004080     DISPLAY C-CLEAR.
004090     CALL "SJN15I".
004100     IF W-ACT = 1 OR 2 OR 3
004110         DISPLAY A-ACT A-HCD D-HNA
004120         GO TO M-100.
004130 M-060.
004140     ACCEPT A-ACT.
004150     IF ESTAT NOT = HTB AND SKP
004160         GO TO M-060.
004170     IF W-ACT = 9
004180         GO TO M-960.
004190     IF W-ACT = 4
004200         GO TO M-500.
004210     IF W-ACT NOT = 1 AND 2 AND 3
004220         GO TO M-060.
004230 M-100.
004240     ACCEPT A-HCD.
004250     DISPLAY E-CL.
004260     IF ESTAT = BTB
004270         GO TO M-060.
004280     IF ESTAT NOT = HTB AND SKP
004290         GO TO M-100.
004300     MOVE W-HCD TO HI-MHCD HI-HCD.
004310     READ HI2-M WITH UNLOCK INVALID KEY
004320         DISPLAY E-ME3 E-ME98
004330         GO TO M-100.
004340     DISPLAY D-HNA.
004350     MOVE 0 TO HI-S(4,10).
004360 M-120.
004370     ACCEPT A-TCD.
004380     DISPLAY E-CL.
004390     IF ESTAT = BTB
004400         GO TO M-100.
004410     IF ESTAT NOT = HTB AND SKP
004420         GO TO M-120.
004430     MOVE W-TCD TO TC-TCD.
004440     MOVE 001 TO TC-CCD.
004450     READ TC-M WITH UNLOCK INVALID KEY
004460         DISPLAY E-ME4 E-ME98
004470         GO TO M-120.
004480     DISPLAY D-TNA.
004490 M-140.
004500     ACCEPT A-NNEN.
004510     DISPLAY E-CL.
004520     IF ESTAT = BTB
004530         GO TO M-120.
004540     IF ESTAT NOT = NOC AND HTB AND SKP
004550         GO TO M-140.
004560 M-160.
004570     ACCEPT A-NGET.
004580     DISPLAY E-CL.
004590     IF ESTAT = BTB
004600         GO TO M-140.
004610     IF ESTAT NOT = NOC AND HTB AND SKP
004620         GO TO M-160.
004630     IF W-NGET < 1 OR > 12
004640         GO TO M-160.
004650 M-180.
004660     ACCEPT A-NPEY.
004670     DISPLAY E-CL.
004680     IF ESTAT = BTB
004690         GO TO M-160.
004700     IF ESTAT NOT = HTB AND SKP
004710         GO TO M-180.
004720     IF W-NPEY < 1 OR > 31
004730         GO TO M-180.
004740*
004750     MOVE W-ND TO W-NGP.
004760     MOVE ZERO TO W-NEN1.
004770     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
004780         ADD DATE-NC1 TO W-NEN.
004790     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
004800         ADD DATE-NC2 TO W-NEN.
004810     IF W-NGP < W-SNGP OR > W-ENGP
004820         DISPLAY E-ME5 E-DATE E-ME98
004830         GO TO M-140.
004840     IF W-NGP < W-SYSD
004850         DISPLAY E-ME5 E-ME98.
004860     MOVE W-NGP TO W-ND.
004870*
004880     MOVE SPACE TO GSY-KEY.
004890     MOVE W-HCD TO GSY-HCD.
004900     MOVE W-TCD TO GSY-TCD.
004910     MOVE W-ND TO GSY-ND.
004920     START GSYF KEY NOT < GSY-KEY INVALID KEY
004930         GO TO M-220.
004940     READ GSYF NEXT RECORD AT END
004950         GO TO M-220.
004960     IF (W-HCD NOT = GSY-HCD) OR (W-TCD NOT = GSY-TCD) OR
004970        (W-ND NOT = GSY-ND)
004980         GO TO M-220.
004990     IF W-ACT = 1
005000         DISPLAY E-ME1 E-ME98
005010         GO TO M-100.
005020     MOVE ZERO TO W-ASUD.
005030     MOVE GSY-TEK TO W-TEK.
005040 M-200.
005050     MOVE GSY-ASU TO W-ASU(GSY-SIZ).
005060     READ GSYF NEXT RECORD AT END
005070         GO TO M-240.
005080     IF (W-HCD NOT = GSY-HCD) OR (W-TCD NOT = GSY-TCD) OR
005090        (W-ND NOT = GSY-ND)
005100         GO TO M-240.
005110     GO TO M-200.
005120 M-220.
005130     IF W-ACT NOT = 1
005140         DISPLAY E-ME2 E-ME98
005150         GO TO M-100.
005160     MOVE ZERO TO W-ASUD.
005170     MOVE SPACE TO W-TEK.
005180 M-240.
005190     PERFORM DSP-RTN THRU DSP-EX.
005200     PERFORM ACP-RTN THRU ACP-EX.
005210     IF ESTAT = BTB
005220         GO TO M-140.
005230     IF W-ACT = 3
005240         IF W-DMM = 9
005250             GO TO M-100.
005260*
005270     MOVE ZERO TO W-SC.
005280 M-260.
005290     ADD 1 TO W-SC.
005300     IF W-SC = 5
005310         GO TO M-040.
005320     INITIALIZE GSY-R.
005330     MOVE W-HCD TO GSY-HCD.
005340     MOVE W-TCD TO GSY-TCD.
005350     MOVE W-ND TO GSY-ND.
005360     MOVE W-SC TO GSY-SIZ.
005370     READ GSYF INVALID KEY
005380         GO TO M-280.
005390     IF W-ACT = 3
005400         GO TO M-340.
005410     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
005420           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
005430           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
005440           AND W-SU(W-SC,10)
005450         GO TO M-340.
005460     MOVE W-SU(W-SC,01) TO GSY-SU(01).
005470     MOVE W-SU(W-SC,02) TO GSY-SU(02).
005480     MOVE W-SU(W-SC,03) TO GSY-SU(03).
005490     MOVE W-SU(W-SC,04) TO GSY-SU(04).
005500     MOVE W-SU(W-SC,05) TO GSY-SU(05).
005510     MOVE W-SU(W-SC,06) TO GSY-SU(06).
005520     MOVE W-SU(W-SC,07) TO GSY-SU(07).
005530     MOVE W-SU(W-SC,08) TO GSY-SU(08).
005540     MOVE W-SU(W-SC,09) TO GSY-SU(09).
005550     MOVE W-SU(W-SC,10) TO GSY-SU(10).
005560     MOVE W-TEK TO GSY-TEK.
005570     MOVE HI-BCD1 TO GSY-BCD1.
005580     MOVE W-SYSH TO GSY-ID.
005590     REWRITE GSY-R INVALID KEY
005600         DISPLAY E-STAT E-ME12 E-ME99
005610         GO TO M-960.
005620     GO TO M-260.
005630 M-280.
005640     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
005650           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
005660           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
005670           AND W-SU(W-SC,10)
005680         GO TO M-260.
005690     MOVE W-SU(W-SC,01) TO GSY-SU(01).
005700     MOVE W-SU(W-SC,02) TO GSY-SU(02).
005710     MOVE W-SU(W-SC,03) TO GSY-SU(03).
005720     MOVE W-SU(W-SC,04) TO GSY-SU(04).
005730     MOVE W-SU(W-SC,05) TO GSY-SU(05).
005740     MOVE W-SU(W-SC,06) TO GSY-SU(06).
005750     MOVE W-SU(W-SC,07) TO GSY-SU(07).
005760     MOVE W-SU(W-SC,08) TO GSY-SU(08).
005770     MOVE W-SU(W-SC,09) TO GSY-SU(09).
005780     MOVE W-SU(W-SC,10) TO GSY-SU(10).
005790     MOVE W-TEK TO GSY-TEK.
005800     MOVE HI-BCD1 TO GSY-BCD1.
005810     MOVE W-SYSH TO GSY-ID.
005820 M-300.
005830     WRITE GSY-R INVALID KEY
005840         DISPLAY E-STAT E-ME11 E-ME99
005850         GO TO M-320.
005860     GO TO M-260.
005870 M-320.
005880     IF ERR-STAT NOT = "24"
005890         DISPLAY E-ME78 E-ME99
005900         GO TO M-960.
005910     DISPLAY E-CL.
005920     CLOSE GSYF.
005930     DISPLAY E-ME71 E-ME98 STOP " ".
005940     DISPLAY E-CL.
005950     OPEN I-O GSYF.
005960     DISPLAY E-CL.
005970     GO TO M-300.
005980 M-340.
005990     DELETE GSYF INVALID KEY
006000         DISPLAY E-STAT E-ME13 E-ME99
006010         GO TO M-960.
006020     GO TO M-260.
006030 M-500.
006040     PERFORM LST-RTN THRU LST-EX.
006050     IF ESTAT = BTB
006060         GO TO M-040.
006070*
006080     MOVE SPACE TO GSY-KEY.
006090     MOVE W-FHCD TO GSY-HCD.
006100     MOVE W-FTCD TO GSY-TCD.
006110     MOVE W-FNDD TO GSY-ND.
006120     START GSYF KEY NOT < GSY-KEY INVALID KEY
006130         DISPLAY E-ME2 E-ME99
006140         GO TO M-500.
006150 M-520.
006160     READ GSYF NEXT RECORD WITH UNLOCK AT END
006170         DISPLAY E-ME2 E-ME99
006180         GO TO M-500.
006190     IF GSY-HCD > W-THCD
006200         DISPLAY E-ME2 E-ME99
006210         GO TO M-500.
006220     IF GSY-TCD < W-FTCD OR > W-TTCD
006230         GO TO M-520.
006240     IF GSY-ND < W-FNDD OR > W-TNDD
006250         GO TO M-520.
006260*
006270     OPEN OUTPUT SP-F.
006280     MOVE ZERO TO W-PAGE.
006290     ACCEPT H-DATE FROM DATE.
006300     PERFORM MID-010 THRU MID-EX.
006310 M-540.
006320     MOVE ZERO TO CHK1 WA-ASUD.
006330     MOVE GSY-HCD TO W-HCD.
006340     MOVE W-HCD TO HI-MHCD HI-HCD.
006350     READ HI2-M WITH UNLOCK INVALID KEY
006360         MOVE SPACE TO HI-NAME
006370         MOVE NC"＊＊　品名マスター　なし　＊＊" TO HI-NAME.
006380     MOVE SPACE TO W-P1.
006390     MOVE W-HCD TO P-HCD.
006400     MOVE HI-NAME TO P-HNA.
006410 M-560.
006420     MOVE ZERO TO CHK2 WS-ASUD W-KC.
006430     MOVE GSY-TCD TO W-TCD.
006440     MOVE W-TCD TO TC-TCD.
006450     MOVE 001 TO TC-CCD.
006460     READ TC-M WITH UNLOCK INVALID KEY
006470         MOVE SPACE TO TC-NAME
006480         MOVE NC"＊＊　得意先マスター　なし　＊＊" TO TC-NAME.
006490     MOVE SPACE TO W-P2.
006500     MOVE W-TCD TO P-TCD.
006510     MOVE TC-NAME TO P-TNA.
006520 M-580.
006530     IF W-KC = 1
006540         MOVE 2 TO W-KC.
006550     IF W-KC = 0
006560         MOVE 1 TO W-KC.
006570     MOVE ZERO TO W-ASUD W-SUT W-FC W-RC.
006580     MOVE GSY-ND TO W-ND.
006590     MOVE GSY-TEK TO W-TEK.
006600 M-600.
006610     MOVE GSY-ASU TO W-ASU(GSY-SIZ).
006620     MOVE ZERO TO CNT.
006630 M-610.
006640     ADD 1 TO CNT.
006650     IF CNT < 11
006660         ADD GSY-SU(CNT) TO W-SUT WS-SU(GSY-SIZ,CNT)
006670                                  WA-SU(GSY-SIZ,CNT)
006680         GO TO M-610.
006690     IF W-FC = 0
006700         MOVE GSY-SIZ TO W-FC.
006710     MOVE GSY-SIZ TO W-RC.
006720 M-620.
006730     READ GSYF NEXT RECORD WITH UNLOCK AT END
006740         GO TO M-680.
006750     IF GSY-HCD > W-THCD
006760         GO TO M-680.
006770     IF GSY-TCD < W-FTCD OR > W-TTCD
006780         GO TO M-620.
006790     IF GSY-ND < W-FNDD OR > W-TNDD
006800         GO TO M-620.
006810     IF GSY-HCD NOT = W-HCD
006820         GO TO M-660.
006830     IF GSY-TCD NOT = W-TCD
006840         GO TO M-640.
006850     IF GSY-ND = W-ND
006860         GO TO M-600.
006870     PERFORM PR3-RTN THRU PR3-EX.
006880     GO TO M-580.
006890 M-640.
006900     PERFORM PR3-RTN THRU PR3-EX.
006910     PERFORM SUB-RTN THRU SUB-EX.
006920     GO TO M-560.
006930 M-660.
006940     PERFORM PR3-RTN THRU PR3-EX.
006950     PERFORM SUB-RTN THRU SUB-EX.
006960     PERFORM KEI-RTN THRU KEI-EX.
006970     GO TO M-540.
006980 M-680.
006990     PERFORM PR3-RTN THRU PR3-EX.
007000     PERFORM SUB-RTN THRU SUB-EX.
007010     PERFORM KEI-RTN THRU KEI-EX.
007020     CLOSE SP-F.
007030     GO TO M-040.
007040 M-960.
007050     CLOSE HI2-M.
007060     CLOSE TC-M.
007070     CLOSE GSYF.
007080 M-980.
007090     DISPLAY C-CLEAR.
007100     STOP RUN.
007110 MID-RTN.
007120     MOVE SPACE TO SP-R.
007130     WRITE SP-R AFTER PAGE.
007140 MID-010.
007150     ADD 1 TO W-PAGE.
007160     MOVE W-PAGE TO H-PAGE.
007170     MOVE SPACE TO SP-R.
007180     MOVE HEAD1 TO SP-R.
007190     WRITE SP-R.
007200     MOVE SPACE TO SP-R.
007210     MOVE HEAD2 TO SP-R.
007220     WRITE SP-R AFTER 2.
007230     MOVE SPACE TO SP-R.
007240     MOVE HEAD3 TO SP-R.
007250     WRITE SP-R.
007260     MOVE SPACE TO SP-R.
007270     MOVE HEAD4 TO SP-R.
007280     WRITE SP-R.
007290     MOVE SPACE TO SP-R.
007300     MOVE HEAD5 TO SP-R.
007310     WRITE SP-R.
007320     MOVE SPACE TO SP-R.
007330     MOVE HEAD6 TO SP-R.
007340     WRITE SP-R.
007350     MOVE SPACE TO SP-R.
007360     MOVE HEAD7 TO SP-R.
007370     WRITE SP-R.
007380     MOVE SPACE TO SP-R.
007390 MID-EX.
007400     EXIT.
007410 PR1-RTN.
007420     IF LINAGE-COUNTER > 58
007430         PERFORM MID-RTN THRU MID-EX.
007440     MOVE SPACE TO SP-R.
007450     MOVE W-P1 TO SP-R.
007460     WRITE SP-R.
007470     MOVE SPACE TO SP-R.
007480     MOVE 1 TO CHK1.
007490     MOVE 0 TO CHK2.
007500 PR1-EX.
007510     EXIT.
007520 PR2-RTN.
007530     IF LINAGE-COUNTER > 59
007540         PERFORM MID-RTN THRU MID-EX.
007550     MOVE SPACE TO SP-R.
007560     MOVE W-P2 TO SP-R.
007570     WRITE SP-R.
007580     MOVE SPACE TO SP-R.
007590     MOVE 1 TO CHK2.
007600 PR2-EX.
007610     EXIT.
007620 PR3-RTN.
007630     IF CHK1 = 0
007640         PERFORM PR1-RTN THRU PR1-EX.
007650     IF CHK2 = 0
007660         PERFORM PR2-RTN THRU PR2-EX.
007670     MOVE SPACE TO W-P3.
007680     MOVE SPACE TO P-TM P-TEK.
007690     MOVE 0 TO W-SC.
007700 PR3-010.
007710     ADD 1 TO W-SC.
007720     IF W-SC = 5
007730         GO TO PR3-EX.
007740     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
007750           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
007760           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
007770           AND W-SU(W-SC,10)
007780         GO TO PR3-010.
007790     MOVE W-SC TO P-SIZ.
007800     IF W-SC = W-FC
007810         MOVE W-NDS TO P-ND
007820         MOVE W-TEK TO P-TEK.
007830     IF W-SC = W-RC
007840         MOVE W-SUT TO P-SUT.
007850     MOVE ZERO TO CNT.
007860 PR3-020.
007870     ADD 1 TO CNT.
007880     IF CNT < 11
007890         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
007900         GO TO PR3-020.
007910     IF LINAGE-COUNTER > 60
007920         PERFORM MID-RTN THRU MID-EX
007930         PERFORM PR1-RTN THRU PR1-EX
007940         PERFORM PR2-RTN THRU PR2-EX.
007950     MOVE SPACE TO SP-R.
007960     MOVE W-P3 TO SP-R.
007970     WRITE SP-R.
007980     MOVE SPACE TO SP-R.
007990     IF W-SC NOT = W-RC
008000         GO TO PR3-010.
008010 PR3-EX.
008020     EXIT.
008030 SUB-RTN.
008040     IF W-KC NOT = 2
008050         GO TO SUB-EX.
008060     MOVE ZERO TO W-ASUD.
008070     MOVE WS-ASUD TO W-ASUD.
008080     MOVE 0 TO W-SC W-FC W-RC W-SUT.
008090 SUB-010.
008100     ADD 1 TO W-SC.
008110     IF W-SC = 5
008120         GO TO SUB-030.
008130     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
008140           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
008150           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
008160           AND W-SU(W-SC,10)
008170         GO TO SUB-010.
008180     IF W-FC = 0
008190         MOVE W-SC TO W-FC.
008200     MOVE W-SC TO W-RC.
008210     MOVE ZERO TO CNT.
008220 SUB-020.
008230     ADD 1 TO CNT.
008240     IF CNT < 11
008250         ADD W-SU(W-SC,CNT) TO W-SUT
008260         GO TO SUB-020.
008270     GO TO SUB-010.
008280 SUB-030.
008290     MOVE 0 TO W-SC.
008300 SUB-040.
008310     ADD 1 TO W-SC.
008320     IF W-SC = 5
008330         GO TO SUB-EX.
008340     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
008350           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
008360           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
008370           AND W-SU(W-SC,10)
008380         GO TO SUB-040.
008390*
008400     MOVE SPACE TO W-P3.
008410     MOVE SPACE TO P-TM P-TEK.
008420     MOVE W-SC TO P-SIZ.
008430     IF W-SC = W-FC
008440         MOVE NC"　　＜　小計　＞" TO P-TM.
008450     IF W-SC = W-RC
008460         MOVE W-SUT TO P-SUT.
008470     MOVE ZERO TO CNT.
008480 SUB-050.
008490     ADD 1 TO CNT.
008500     IF CNT < 11
008510         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
008520         GO TO SUB-050.
008530     IF LINAGE-COUNTER > 60
008540         PERFORM MID-RTN THRU MID-EX
008550         PERFORM PR1-RTN THRU PR1-EX
008560         PERFORM PR2-RTN THRU PR2-EX.
008570     MOVE SPACE TO SP-R.
008580     MOVE W-P3 TO SP-R.
008590     WRITE SP-R.
008600     MOVE SPACE TO SP-R.
008610     IF W-SC NOT = W-RC
008620         GO TO SUB-040.
008630 SUB-EX.
008640     EXIT.
008650 KEI-RTN.
008660     MOVE ZERO TO W-ASUD.
008670     MOVE WA-ASUD TO W-ASUD.
008680     MOVE 0 TO W-SC W-FC W-RC W-SUT.
008690 KEI-010.
008700     ADD 1 TO W-SC.
008710     IF W-SC = 5
008720         GO TO KEI-030.
008730     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
008740           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
008750           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
008760           AND W-SU(W-SC,10)
008770         GO TO KEI-010.
008780     IF W-FC = 0
008790         MOVE W-SC TO W-FC.
008800     MOVE W-SC TO W-RC.
008810     MOVE ZERO TO CNT.
008820 KEI-020.
008830     ADD 1 TO CNT.
008840     IF CNT < 11
008850         ADD W-SU(W-SC,CNT) TO W-SUT
008860         GO TO KEI-020.
008870     GO TO KEI-010.
008880 KEI-030.
008890     MOVE 0 TO W-SC.
008900 KEI-040.
008910     ADD 1 TO W-SC.
008920     IF W-SC = 5
008930         GO TO KEI-EX.
008940     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
008950           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
008960           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
008970           AND W-SU(W-SC,10)
008980         GO TO KEI-040.
008990*
009000     MOVE SPACE TO W-P3.
009010     MOVE SPACE TO P-TM P-TEK.
009020     MOVE W-SC TO P-SIZ.
009030     IF W-SC = W-FC
009040         MOVE NC"【　合　計　】　" TO P-TM.
009050     IF W-SC = W-RC
009060         MOVE W-SUT TO P-SUT.
009070     MOVE ZERO TO CNT.
009080 KEI-050.
009090     ADD 1 TO CNT.
009100     IF CNT < 11
009110         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
009120         GO TO KEI-050.
009130     IF LINAGE-COUNTER > 60
009140         PERFORM MID-RTN THRU MID-EX
009150         PERFORM PR1-RTN THRU PR1-EX
009160     MOVE SPACE TO SP-R.
009170     MOVE W-P3 TO SP-R.
009180     WRITE SP-R.
009190     MOVE SPACE TO SP-R.
009200     IF W-SC NOT = W-RC
009210         GO TO KEI-040.
009220 KEI-EX.
009230     EXIT.
009240 DSP-RTN.
009250     MOVE ZERO TO W-SC W-SUT.
009260     MOVE 10 TO W-L.
009270 DSP-010.
009280     ADD 2 TO W-L.
009290     ADD 1 TO W-SC.
009300     IF W-SC = 5
009310         GO TO DSP-030.
009320     MOVE ZERO TO CNT.
009330     MOVE -5 TO W-C.
009340 DSP-020.
009350     ADD 7 TO W-C.
009360     ADD 1 TO CNT.
009370     IF CNT NOT = 11
009380         DISPLAY D-SU
009390         ADD W-SU(W-SC,CNT) TO W-SUT
009400         GO TO DSP-020.
009410     GO TO DSP-010.
009420 DSP-030.
009430     DISPLAY D-SUT A-TEK.
009440 DSP-EX.
009450     EXIT.
009460 ACP-RTN.
009470     IF W-ACT = 3
009480         GO TO ACP-080.
009490     MOVE 0 TO W-SC.
009500     MOVE 10 TO W-L.
009510 ACP-010.
009520     ADD 2 TO W-L.
009530     ADD 1 TO W-SC.
009540     IF W-SC = 5
009550         GO TO ACP-060.
009560     MOVE ZERO TO CNT.
009570     MOVE -5 TO W-C.
009580 ACP-020.
009590     ADD 7 TO W-C.
009600     ADD 1 TO CNT.
009610     IF CNT = 11
009620         GO TO ACP-010.
009630     IF HI-S(W-SC,CNT) = ZERO
009640         MOVE ZERO TO W-SU(W-SC,CNT)
009650         DISPLAY D-SU
009660         GO TO ACP-020.
009670 ACP-030.
009680     MOVE W-SU(W-SC,CNT) TO W-BSU.
009690     ACCEPT A-SU.
009700     DISPLAY E-CL.
009710     IF ESTAT = ADV
009720         MOVE W-BSU TO W-SU(W-SC,CNT)
009730         DISPLAY D-SU
009740         GO TO ACP-060.
009750     IF ESTAT = BTB
009760         GO TO ACP-040.
009770     IF ESTAT NOT = HTB AND SKP
009780         GO TO ACP-030.
009790     DISPLAY D-SU.
009800     GO TO ACP-020.
009810 ACP-040.
009820     SUBTRACT 7 FROM W-C.
009830     SUBTRACT 1 FROM CNT.
009840     IF CNT = ZERO
009850         GO TO ACP-050.
009860     IF HI-S(W-SC,CNT) = ZERO
009870         GO TO ACP-040.
009880     GO TO ACP-030.
009890 ACP-050.
009900     SUBTRACT 2 FROM W-L.
009910     SUBTRACT 1 FROM W-SC.
009920     IF W-SC = 0
009930         GO TO ACP-EX.
009940     MOVE 11 TO CNT.
009950     MOVE 72 TO W-C.
009960     GO TO ACP-040.
009970 ACP-060.
009980     PERFORM DSP-RTN THRU DSP-EX.
009990 ACP-070.
010000     ACCEPT A-TEK.
010010     IF ESTAT = BTB
010020         MOVE 5 TO W-SC
010030         MOVE 20 TO W-L
010040         GO TO ACP-050.
010050     IF ESTAT NOT = HTB AND SKP
010060         GO TO ACP-070.
010070 ACP-080.
010080     ACCEPT A-DMM.
010090     IF ESTAT = BTB
010100         IF W-ACT = 3
010110             GO TO ACP-EX
010120           ELSE
010130             GO TO ACP-070.
010140     IF ESTAT NOT = HTB AND SKP
010150         GO TO ACP-080.
010160     IF W-DMM = 9
010170         IF W-ACT = 3
010180             GO TO ACP-EX
010190           ELSE
010200             GO TO ACP-RTN.
010210     IF W-DMM NOT = 1
010220         GO TO ACP-080.
010230 ACP-EX.
010240     EXIT.
010250 LST-RTN.
010260     DISPLAY C-CLEAR.
010270     DISPLAY C-MID.
010280 LST-010.
010290     ACCEPT A-FHCD.
010300     IF ESTAT = BTB
010310         GO TO LST-EX.
010320     IF ESTAT NOT = HTB AND SKP
010330         GO TO LST-010.
010340 LST-020.
010350     ACCEPT A-THCD.
010360     IF ESTAT = BTB
010370         GO TO LST-010.
010380     IF ESTAT NOT = HTB AND SKP
010390         GO TO LST-020.
010400     IF W-FHCD > W-THCD
010410         GO TO LST-020.
010420 LST-030.
010430     ACCEPT A-FTCD.
010440     IF ESTAT = BTB
010450         GO TO LST-020.
010460     IF ESTAT NOT = HTB AND SKP
010470         GO TO LST-030.
010480 LST-040.
010490     ACCEPT A-TTCD.
010500     IF ESTAT = BTB
010510         GO TO LST-030.
010520     IF ESTAT NOT = HTB AND SKP
010530         GO TO LST-040.
010540     IF W-FTCD > W-TTCD
010550         GO TO LST-040.
010560 LST-050.
010570     ACCEPT A-FNN.
010580     IF ESTAT = BTB
010590         GO TO LST-040.
010600     IF ESTAT NOT = NOC AND HTB AND SKP
010610         GO TO LST-050.
010620 LST-060.
010630     ACCEPT A-FNG.
010640     IF ESTAT = BTB
010650         GO TO LST-050.
010660     IF ESTAT NOT = NOC AND HTB AND SKP
010670         GO TO LST-060.
010680     IF W-FNG > 12
010690         GO TO LST-060.
010700     IF W-FNG = ZERO
010710         IF W-FNN NOT = ZERO
010720             GO TO LST-060.
010730 LST-070.
010740     ACCEPT A-FNP.
010750     IF ESTAT = BTB
010760         GO TO LST-060.
010770     IF ESTAT NOT = HTB AND SKP
010780         GO TO LST-070.
010790*
010800     IF ZERO = W-FNN AND W-FNG
010810         MOVE ZERO TO W-FNDD
010820         GO TO LST-080.
010830     MOVE ZERO TO W-NGP.
010840     MOVE W-FND TO W-NGPS.
010850     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
010860         ADD DATE-NC1 TO W-NEN.
010870     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
010880         ADD DATE-NC2 TO W-NEN.
010890     MOVE W-NGP TO W-FNDD.
010900 LST-080.
010910     ACCEPT A-TNN.
010920     IF ESTAT = BTB
010930         GO TO LST-070.
010940     IF ESTAT NOT = NOC AND HTB AND SKP
010950         GO TO LST-080.
010960 LST-090.
010970     ACCEPT A-TNG.
010980     IF ESTAT = BTB
010990         GO TO LST-080.
011000     IF ESTAT NOT = NOC AND HTB AND SKP
011010         GO TO LST-090.
011020     IF W-TNG NOT = 99
011030         IF W-TNG < 1 OR > 12
011040             GO TO LST-090.
011050     IF W-TNG = 99
011060         IF W-TNN NOT = 99
011070             GO TO LST-090.
011080 LST-100.
011090     ACCEPT A-TNP.
011100     IF ESTAT = BTB
011110         GO TO LST-090.
011120     IF ESTAT NOT = HTB AND SKP
011130         GO TO LST-100.
011140     IF W-FND > W-TND
011150         GO TO LST-080.
011160*
011170     IF 99 = W-TNN AND W-TNG
011180         MOVE 99999999 TO W-TNDD
011190         GO TO LST-110.
011200     MOVE ZERO TO W-NGP.
011210     MOVE W-TND TO W-NGPS.
011220     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
011230         ADD DATE-NC1 TO W-NEN.
011240     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
011250         ADD DATE-NC2 TO W-NEN.
011260     MOVE W-NGP TO W-TNDD.
011270 LST-110.
011280     ACCEPT A-DMM.
011290     IF ESTAT = BTB
011300         GO TO LST-100.
011310     IF ESTAT NOT = HTB AND SKP
011320         GO TO LST-110.
011330     IF W-DMM = 9
011340         GO TO LST-010.
011350     IF W-DMM NOT = 1
011360         GO TO LST-110.
011370 LST-EX.
011380     EXIT.
