000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID.      JT283U.
000030 AUTHOR.          ________.
000040*********************************************************
000050*    PROGRAM         :  倉別在庫ワーク　作成            *
000060*    PRINTER TYPE    :  JIPS                            *
000070*    DATA WRITTN     :  97/07/09                        *
000080*    COMPILE TYPE    :  CBL85 (74MODE)                  *
000090*********************************************************
000100 ENVIRONMENT      DIVISION.
000110 CONFIGURATION    SECTION.
000120 SOURCE-COMPUTER. NEAC-SYSTEM3100.
000130 OBJECT-COMPUTER. NEAC-SYSTEM3100.
000140 INPUT-OUTPUT     SECTION.
000150 FILE-CONTROL.
000160     SELECT  JT-YZAI   ASSIGN  TO  F1-MSD
000170         FILE  STATUS  ERR-STAT.
000180     SELECT  NJZAI     ASSIGN  TO  F2-MSD
000190         ORGANIZATION  IS INDEXED
000200         ACCESS MODE   IS DYNAMIC
000210         RECORD KEY    IS NJZAI-KEY.
000220     SELECT  JMST3     ASSIGN  TO  F3-MSD
000230         ORGANIZATION  IS INDEXED
000240         ACCESS MODE   IS DYNAMIC
000250         RECORD KEY    IS JMST3-KEY.
000260*****SELECT  SHM       ASSIGN  TO  SHM-MSD                        D.010808
000270     SELECT  HI2-M     ASSIGN  TO  HI2-MSD                        I.010808
000280         ORGANIZATION  IS INDEXED
000290         ACCESS MODE   IS RANDOM
000300         RECORD KEY    IS HI-KEY2.                                I.010808
000310*****    RECORD KEY    IS SHM-KEY.                                D.010808
000320 I-O-CONTROL.
000330*****APPLY SHARED-MODE    ON  NJZAI  JMST3  SHM                   D.010808
000340     APPLY SHARED-MODE    ON  NJZAI  JMST3  HI2-M                 I.010808
000350     APPLY EXCLUSIVE-MODE ON  JT-YZAI.
000360 DATA    DIVISION.
000370 FILE    SECTION.
000380 COPY   LNJZAI.
000390 COPY   LJMST3.
000400 COPY   LIHIM2.                                                   I.010808
000410*COPY   L-SHM.                                                    D.010808
000420 FD  JT-YZAI
000430     BLOCK    2     RECORDS                                       I.970530
000440     LABEL    RECORD   STANDARD
000450     VALUE    OF  IDENTIFICATION   WK0128ID.                      I.970530
000460*
000470 01  YZAI1-R.
000480     02   FILLER              PIC X(07).
000490     02   YZAI1-01            PIC 9(6).                           ﾋﾝﾒｲｺｰﾄﾞ
000500     02   YZAI1-02            PIC N(24).
000510     02   YZAI1-03            PIC 9(1).                           ｻｲｽﾞｸﾌﾞﾝ
000520     02   YZAI1-04.                                               ｻﾞｲｺｽｳ
000530          03   YZAI1-041      OCCURS  10.                         ｻｲｽﾞﾍﾞﾂ
000540              04   YZAI1-0411 PIC S9(6).
000550          03   YZAI1-042      PIC S9(06).
000560*
000570 01  YZAI2-R.
000580     02   YZAI2-01            PIC 9(6).                           ﾋﾝﾒｲｺｰﾄﾞ
000590     02   YZAI2-02            PIC N(24).
000600     02   YZAI2-03            PIC 9(1).                           ｻｲｽﾞｸﾌﾞﾝ
000610     02   YZAI2-04.                                               ｻﾞｲｺｽｳ
000620          03   YZAI2-041      OCCURS  10.                         ｻｲｽﾞﾍﾞﾂ
000630              04   YZAI2-0411 PIC S9(6).
000640          03   YZAI2-042      PIC S9(06).
000650     02   FILLER              PIC X(07).
000660 WORKING-STORAGE  SECTION.
000670 77  JS-SIGN                  PIC  9(1).                          I.001208
000680 77  ERR-STAT                 PIC  X(2).
000690 77  WK0128ID                 PIC  X(009) VALUE SPACE.            I.970530
000700 01  STN-NO.
000710     02  STN-NO1              PIC  X(003).
000720     02  STN-NO2              PIC  X(003).
000730 01  W-FID.
000740     02  W-FID1               PIC  X(006) VALUE "WK0128".         I.970530
000750     02  W-FID2               PIC  X(003).
000760 01  W-SUD.
000770     02  W-SU                 PIC S9(06)  OCCURS  10.
000780 01  W-SUT                    PIC  S9(06).
000790 01  ZERO-SW                  PIC  9(01).
000800 01  W-KEY.
000810     02  W-KURA               PIC  9(01).
000820     02  W-HCD                PIC  9(06).
000830 01  W-AREA.
000840     02  I                    PIC  9(02).
000850     02  W-SEN                PIC  9(01).                         I.001208
000860     02  W-FROM.
000870         03  W-FH1            PIC  9(06).                         I.961108
000880         03  W-FH2            PIC  9(06).                         I.961108
000890         03  W-FH3            PIC  9(06).                         I.961108
000900         03  W-FH4            PIC  9(06).                         I.961108
000910         03  W-FH5            PIC  9(06).                         I.961108
000920         03  W-FH6            PIC  9(06).                         I.001208
000930     02  W-TO.
000940         03  W-TH             PIC  9(06).                         I.961108
000950         03  W-TH1            PIC  9(06).                         I.961108
000960         03  W-TH2            PIC  9(06).                         I.961108
000970         03  W-TH3            PIC  9(06).                         I.961108
000980         03  W-TH4            PIC  9(06).                         I.961108
000990         03  W-TH5            PIC  9(06).                         I.961108
001000         03  W-TH6            PIC  9(06).                         I.001208
001010     02  OKC                  PIC  9(01).                         確認　
001020***
001030 COPY  LWMSG.
001040***
001050 SCREEN      SECTION.
001060 SD  C-CRT
001070     END  STATUS  IS  ESTAT.
001080 01  C-CLEAR.
001090     02  C-CL     LINE   1  CLEAR SCREEN.
001100 01  CLR-01.
001110     02  CLR-SEN   LINE 11  COLUMN 55  VALUE " ".                 I.001208
001120     02  CLR-FH1   LINE 16  COLUMN 26  VALUE "      ".            I.961108
001130     02  CLR-TH1   LINE 18  COLUMN 26  VALUE "      ".            I.961108
001140     02  CLR-FH2   LINE 16  COLUMN 34  VALUE "      ".            I.961108
001150     02  CLR-TH2   LINE 18  COLUMN 34  VALUE "      ".            I.961108
001160     02  CLR-FH3   LINE 16  COLUMN 42  VALUE "      ".            I.961108
001170     02  CLR-TH3   LINE 18  COLUMN 42  VALUE "      ".            I.961108
001180     02  CLR-FH4   LINE 16  COLUMN 50  VALUE "      ".            I.961108
001190     02  CLR-TH4   LINE 18  COLUMN 50  VALUE "      ".            I.961108
001200     02  CLR-FH5   LINE 16  COLUMN 58  VALUE "      ".            I.961108
001210     02  CLR-TH5   LINE 18  COLUMN 58  VALUE "      ".            I.961108
001220     02  CLR-FH6   LINE 16  COLUMN 66  VALUE "      ".            I.001208
001230     02  CLR-TH6   LINE 18  COLUMN 66  VALUE "      ".            I.001208
001240***
001250 01  DSP-AREA.
001260     02  DSP-MID.                                                 I.001208
001270       03  LINE  1  COLUMN 27  VALUE                              I.001208
001280            "                      " REVERSE.                     I.001208
001290       03  LINE  1  COLUMN 28  VALUE                              I.001208
001300           NC"倉別在庫ワーク　抽出".                              I.001208
001310       03  LINE  5  COLUMN 30  VALUE                              I.001208
001320             "一　　　　　般  =  1".                              I.001208
001330       03  LINE  6  COLUMN 30  VALUE                              I.001208
001340             "上　　　　　山  =  2".                              I.001208
001350       03  LINE  7  COLUMN 30  VALUE                              I.001208
001360             "キサシューズ　  =  3".                              I.001208
001370       03  LINE  8  COLUMN 30  VALUE                              I.001208
001380             "キサスポーツ　  =  4".                              I.001208
001390       03  LINE  9  COLUMN 30  VALUE                              I.001208
001400             "その他ＯＥＭ　  =  5".                              I.001208
001410       03  LINE 10  COLUMN 30  VALUE                              I.001208
001420             "ヴィヴェンディ  =  6".                              I.001208
001430       03  LINE 11  COLUMN 30  VALUE                              I.001208
001440             "教　　　　　育  =  7 ...  ".                        I.001208
001450       03  LINE 14  COLUMN 22  VALUE                              I.001208
001460           "    品名１      ２      ３      ４      ５      ６".  I.001208
001470       03  LINE 16  COLUMN 13  VALUE  "ＦＲＯＭ".                 I.001208
001480       03  LINE 18  COLUMN 13  VALUE  "ＴＯ".                     I.001208
001490       03  LINE 23  COLUMN 41  VALUE  "確認(OK=1,NO=9)-->   ﾘﾀｰﾝ".I.001208
001500     02  DSP-FLP    LINE 20  COLUMN 29  VALUE                     I.001208
001510         NC"フロッピー　セット" BLINK.                            I.001208
001520*****02  LINE  1  COLUMN 27  VALUE                                D.001208
001530*****     "                      " REVERSE.                       D.001208
001540*****02  LINE  1  COLUMN 28  VALUE                                D.001208
001550*****    NC"倉別在庫ワーク　抽出".                                D.001208
001560*****02  LINE  7  COLUMN 29  VALUE                                D.001208
001570*****    NC"フロッピー　セット" BLINK.                            D.001208
001580*****02  LINE 14  COLUMN 22  VALUE                                D.001208
001590*****    "    品名１      ２      ３      ４      ５".            D.001208
001600*****02  LINE 16  COLUMN 13  VALUE  "ＦＲＯＭ".                   D.001208
001610*****02  LINE 18  COLUMN 13  VALUE  "ＴＯ".                       D.001208
001620*****02  LINE 23  COLUMN 41  VALUE  "確認(OK=1,NO=9)-->   ﾘﾀｰﾝ".  D.001208
001630 01  ACP-AREA.
001640     02  ACP-SEN        LINE 11  COLUMN 55     PIC 9(01)          I.001208
001650                        USING W-SEN     CHECK OVERFLOW NO IFC.    I.001208
001660     02  ACP-FH1        LINE 16  COLUMN 26     PIC 9(06)          I.961108
001670                        USING W-FH1     CHECK OVERFLOW NO IFC.    I.961108
001680     02  ACP-TH1        LINE 18  COLUMN 26     PIC 9(06)          I.961108
001690                        USING W-TH1     CHECK OVERFLOW NO IFC.    I.961108
001700     02  ACP-FH2        LINE 16  COLUMN 34     PIC 9(06)          I.961108
001710                        USING W-FH2     CHECK OVERFLOW NO IFC.    I.961108
001720     02  ACP-TH2        LINE 18  COLUMN 34     PIC 9(06)          I.961108
001730                        USING W-TH2     CHECK OVERFLOW NO IFC.    I.961108
001740     02  ACP-FH3        LINE 16  COLUMN 42     PIC 9(06)          I.961108
001750                        USING W-FH3     CHECK OVERFLOW NO IFC.    I.961108
001760     02  ACP-TH3        LINE 18  COLUMN 42     PIC 9(06)          I.961108
001770                        USING W-TH3     CHECK OVERFLOW NO IFC.    I.961108
001780     02  ACP-FH4        LINE 16  COLUMN 50     PIC 9(06)          I.961108
001790                        USING W-FH4     CHECK OVERFLOW NO IFC.    I.961108
001800     02  ACP-TH4        LINE 18  COLUMN 50     PIC 9(06)          I.961108
001810                        USING W-TH4     CHECK OVERFLOW NO IFC.    I.961108
001820     02  ACP-FH5        LINE 16  COLUMN 58     PIC 9(06)          I.961108
001830                        USING W-FH5     CHECK OVERFLOW NO IFC.    I.961108
001840     02  ACP-TH5        LINE 18  COLUMN 58     PIC 9(06)          I.961108
001850                        USING W-TH5     CHECK OVERFLOW NO IFC.    I.961108
001860     02  ACP-FH6        LINE 16  COLUMN 66     PIC 9(06)          I.001208
001870                        USING W-FH6     CHECK OVERFLOW NO IFC.    I.001208
001880     02  ACP-TH6        LINE 18  COLUMN 66     PIC 9(06)          I.001208
001890                        USING W-TH6     CHECK OVERFLOW NO IFC.    I.001208
001900     02  ACP-OKC        LINE 23  COLUMN 61     PIC 9(01)
001910                        USING OKC       CHECK OVERFLOW NO IFC.
001920*
001930 01  DISP-MSG-SPACE1     LINE 24.
001940     02  COLUMN 1        PIC X(40)     VALUE " ".
001950***
001960 COPY  LSMSG.
001970***
001980 PROCEDURE   DIVISION.
001990*
002000****************************
002010***  ﾒ ｲ ﾝ  R T N        ***
002020****************************
002030 MR-RTN.
002040     PERFORM  INI-RTN     THRU   INI-EX.
002050     IF  ESTAT     =  "P9"
002060         STOP  RUN.
002070     PERFORM  UPD1-RTN    THRU   UPD1-EX.
002080     PERFORM  UPD2-RTN    THRU   UPD2-EX.
002090     PERFORM  END-RTN     THRU   END-EX.
002100     STOP  RUN.
002110*********************************
002120***   ｲﾆｼｬﾙ   R T N           ***
002130*********************************
002140 INI-RTN.
002150     DISPLAY  C-CLEAR.
002160     ACCEPT JS-SIGN.                                              I.001208
002170     IF JS-SIGN > 1                                               I.001208
002180         MOVE  255     TO  COMPLETION-CODE                        I.001208
002190         GO  TO  INI-EX.                                          I.001208
002200*****DISPLAY  DSP-AREA.                                           D.001208
002210     DISPLAY  DSP-MID.                                            I.001208
002220     IF JS-SIGN = 0                                               I.001208
002230         DISPLAY  DSP-FLP.                                        I.001208
002240     INITIALIZE  W-AREA.                                          I.961108
002250 INI-020.                                                         I.001208
002260     ACCEPT  ACP-SEN.                                             I.001208
002270     IF  ESTAT  =  "P9"                                           I.001208
002280         MOVE  255     TO  COMPLETION-CODE                        I.001208
002290         GO  TO  INI-EX.                                          I.001208
002300     IF  ESTAT  NOT =  "01"  AND  "06"                            I.001208
002310         GO  TO  INI-020.                                         I.001208
002320     DISPLAY  ACP-SEN.                                            I.001208
002330     IF  W-SEN      <  1  OR  >  7                                I.001208
002340         GO  TO  INI-020.                                         I.001208
002350     MOVE ZERO TO W-FH1 W-TH1 W-FH2 W-TH2 W-FH3 W-TH3             I.001208
002360                  W-FH4 W-TH4 W-FH5 W-TH5 W-FH6 W-TH6.            I.001208
002370     IF  W-SEN      =  1                                          I.001208
002380         MOVE  100000    TO  W-FH1                                I.001208
002390         MOVE  103199    TO  W-TH1                                I.001208
002400         MOVE  103500    TO  W-FH2                                I.001208
002410         MOVE  105999    TO  W-TH2                                I.001208
002420         MOVE  120000    TO  W-FH3                                I.001208
002430         MOVE  122399    TO  W-TH3                                I.001208
002440         MOVE  123100    TO  W-FH4                                I.001208
002450         MOVE  123699    TO  W-TH4                                I.001208
002460         MOVE  131100    TO  W-FH5                                I.001208
002470         MOVE  199999    TO  W-TH5                                I.001208
002480         MOVE  950100    TO  W-FH6                                I.001208
002490         MOVE  980099    TO  W-TH6.                               I.001208
002500     IF  W-SEN      =  2                                          I.001208
002510         MOVE  122500    TO  W-FH1                                I.001208
002520         MOVE  123099    TO  W-TH1                                I.001208
002530         MOVE  124000    TO  W-FH2                                I.001208
002540         MOVE  124999    TO  W-TH2.                               I.001208
002550     IF  W-SEN      =  3                                          I.001208
002560         MOVE  750000    TO  W-FH1                                I.001208
002570         MOVE  829999    TO  W-TH1.                               I.001208
002580     IF  W-SEN      =  4                                          I.001208
002590         MOVE  831000    TO  W-FH1                                I.001208
002600         MOVE  899999    TO  W-TH1.                               I.001208
002610     IF  W-SEN      =  5                                          I.001208
002620         MOVE  128100    TO  W-FH1                                I.001208
002630         MOVE  129999    TO  W-TH1                                I.001208
002640         MOVE  224900    TO  W-FH2                                I.001208
002650         MOVE  225099    TO  W-TH2                                I.001208
002660         MOVE  260000    TO  W-FH3                                I.001208
002670         MOVE  289999    TO  W-TH3                                I.001208
002680         MOVE  400000    TO  W-FH4                                I.001208
002690         MOVE  699999    TO  W-TH4.                               I.001208
002700     IF  W-SEN      =  6                                          I.001208
002710         MOVE  210000    TO  W-FH1                                I.001208
002720         MOVE  224899    TO  W-TH1                                I.001208
002730         MOVE  225100    TO  W-FH2                                I.001208
002740         MOVE  259999    TO  W-TH2.                               I.001208
002750     IF  W-SEN      =  7                                          I.001208
002760         MOVE  106100    TO  W-FH1                                I.001208
002770         MOVE  113099    TO  W-TH1.                               I.001208
002780     IF W-FH2 = ZERO                                              I.001208
002790         MOVE W-TH1 TO W-TH                                       I.001208
002800         DISPLAY ACP-FH1 ACP-TH1                                  I.001208
002810                 CLR-FH2 CLR-TH2 CLR-FH3 CLR-TH3                  I.001208
002820                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
002830         GO  TO  INI-510.                                         I.001208
002840     IF W-FH3 = ZERO                                              I.001208
002850         MOVE W-TH2 TO W-TH                                       I.001208
002860         DISPLAY ACP-FH1 ACP-TH1 ACP-FH2 ACP-TH2                  I.001208
002870                 CLR-FH3 CLR-TH3                                  I.001208
002880                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
002890         GO  TO  INI-510.                                         I.001208
002900     IF W-FH4 = ZERO                                              I.001208
002910         MOVE W-TH3 TO W-TH                                       I.001208
002920         DISPLAY ACP-FH1 ACP-TH1 ACP-FH2 ACP-TH2 ACP-FH3 ACP-TH3  I.001208
002930                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
002940         GO  TO  INI-510.                                         I.001208
002950     IF W-FH5 = ZERO                                              I.001208
002960         MOVE W-TH4 TO W-TH                                       I.001208
002970         DISPLAY ACP-FH1 ACP-TH1                                  I.001208
002980                 ACP-FH2 ACP-TH2 ACP-FH3 ACP-TH3 ACP-FH4 ACP-TH4  I.001208
002990                 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.001208
003000         GO  TO  INI-510.                                         I.001208
003010     IF W-FH6 = ZERO                                              I.001208
003020         MOVE W-TH5 TO W-TH                                       I.001208
003030         DISPLAY ACP-FH1 ACP-TH1 ACP-FH2 ACP-TH2                  I.001208
003040                 ACP-FH3 ACP-TH3 ACP-FH4 ACP-TH4 ACP-FH5 ACP-TH5  I.001208
003050                 CLR-FH6 CLR-TH6                                  I.001208
003060         GO  TO  INI-510.                                         I.001208
003070     MOVE W-TH6 TO W-TH.                                          I.001208
003080     DISPLAY ACP-FH1 ACP-TH1 ACP-FH2 ACP-TH2 ACP-FH3 ACP-TH3      I.001208
003090             ACP-FH4 ACP-TH4 ACP-FH5 ACP-TH5 ACP-FH6 ACP-TH6.     I.001208
003100     GO  TO  INI-510.                                             I.001208
003110 INI-055.                                                         I.961108
003120     ACCEPT  ACP-FH1.                                             I.961108
003130     IF  ESTAT  =  "P9"
003140         MOVE  255     TO  COMPLETION-CODE
003150         GO  TO  INI-EX.
003160     IF  ESTAT  =  "09"                                           I.001208
003170         GO  TO  INI-020.                                         I.001208
003180     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003190         GO  TO  INI-055.                                         I.961108
003200     DISPLAY  ACP-FH1.                                            I.961108
003210 INI-060.
003220     ACCEPT  ACP-TH1.                                             I.961108
003230     IF  ESTAT  =  "09"
003240         GO  TO  INI-055.                                         I.961108
003250     IF  ESTAT  NOT =  "01"  AND  "06"
003260         GO  TO  INI-060.
003270     DISPLAY  ACP-TH1.                                            I.961108
003280     IF  W-FH1   >  W-TH1                                         I.961108
003290         GO  TO  INI-060.
003300     IF W-TH1 = 999999                                            I.961108
003310         MOVE W-TH1 TO W-TH                                       I.961108
003320         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4         I.961108
003330                                  W-FH5 W-TH5 W-FH6 W-TH6         I.001208
003340*****                                         W-FH5 W-TH5         D.001208
003350         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-TH3                  I.961108
003360                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
003370*****            CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5                  D.001208
003380         GO TO INI-510.                                           I.961108
003390 INI-070.                                                         I.961108
003400     ACCEPT  ACP-FH2.                                             I.961108
003410     IF  ESTAT  =  "09"                                           I.961108
003420         GO  TO  INI-060.                                         I.961108
003430     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003440         GO  TO  INI-070.                                         I.961108
003450     IF W-FH2 = ZERO                                              I.961108
003460         MOVE W-TH1 TO W-TH                                       I.961108
003470         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4         I.961108
003480                                  W-FH5 W-TH5 W-FH6 W-TH6         I.001208
003490*****                                         W-FH5 W-TH5         D.001208
003500         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-TH3                  I.961108
003510                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
003520*****            CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5                  D.001208
003530         GO TO INI-510.                                           I.961108
003540     DISPLAY  ACP-FH2.                                            I.961108
003550     IF  W-FH2   <  W-TH1                                         I.961108
003560         GO  TO  INI-070.                                         I.961108
003570 INI-080.                                                         I.961108
003580     ACCEPT  ACP-TH2.                                             I.961108
003590     IF  ESTAT  =  "09"                                           I.961108
003600         GO  TO  INI-070.                                         I.961108
003610     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003620         GO  TO  INI-080.                                         I.961108
003630     DISPLAY  ACP-TH2.                                            I.961108
003640     IF  W-FH2   >  W-TH2                                         I.961108
003650         GO  TO  INI-080.                                         I.961108
003660     IF W-TH2 = 999999                                            I.961108
003670         MOVE W-TH2 TO W-TH                                       I.961108
003680         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5         I.961108
003690                                              W-FH6 W-TH6         I.001208
003700         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-TH4                  I.961108
003710                 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.001208
003720*****                            CLR-FH5 CLR-FH5                  D.001208
003730         GO TO INI-510.                                           I.961108
003740 INI-090.                                                         I.961108
003750     ACCEPT  ACP-FH3.                                             I.961108
003760     IF  ESTAT  =  "09"                                           I.961108
003770         GO  TO  INI-080.                                         I.961108
003780     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003790         GO  TO  INI-090.                                         I.961108
003800     IF W-FH3 = ZERO                                              I.961108
003810         MOVE W-TH2 TO W-TH                                       I.961108
003820         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5         I.961108
003830                                              W-FH6 W-TH6         I.001208
003840         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-TH4                  I.961108
003850                 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.001208
003860*****                            CLR-FH5 CLR-FH5                  D.001208
003870         GO TO INI-510.                                           I.961108
003880     DISPLAY  ACP-FH3.                                            I.961108
003890     IF  W-FH3   <  W-TH2                                         I.961108
003900         GO  TO  INI-090.                                         I.961108
003910 INI-100.                                                         I.961108
003920     ACCEPT  ACP-TH3.                                             I.961108
003930     IF  ESTAT  =  "09"                                           I.961108
003940         GO  TO  INI-090.                                         I.961108
003950     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003960         GO  TO  INI-100.                                         I.961108
003970     DISPLAY  ACP-TH3.                                            I.961108
003980     IF  W-FH3   >  W-TH3                                         I.961108
003990         GO  TO  INI-100.                                         I.961108
004000     IF W-TH3 = 999999                                            I.961108
004010         MOVE W-TH3 TO W-TH                                       I.961108
004020         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5 W-FH6 W-TH6         I.001208
004030         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
004040*****    MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5                     D.001208
004050*****    DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5                  D.001208
004060         GO TO INI-510.                                           I.961108
004070 INI-110.                                                         I.961108
004080     ACCEPT  ACP-FH4.                                             I.961108
004090     IF  ESTAT  =  "09"                                           I.961108
004100         GO  TO  INI-100.                                         I.961108
004110     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004120         GO  TO  INI-110.                                         I.961108
004130     IF W-FH4 = ZERO                                              I.961108
004140         MOVE W-TH3 TO W-TH                                       I.961108
004150         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5 W-FH6 W-TH6         I.001208
004160         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.001208
004170*****    MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5                     D.001208
004180*****    DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5                  D.001208
004190         GO TO INI-510.                                           I.961108
004200     DISPLAY  ACP-FH4.                                            I.961108
004210     IF  W-FH4   <  W-TH3                                         I.961108
004220         GO  TO  INI-110.                                         I.961108
004230 INI-120.                                                         I.961108
004240     ACCEPT  ACP-TH4.                                             I.961108
004250     IF  ESTAT  =  "09"                                           I.961108
004260         GO  TO  INI-110.                                         I.961108
004270     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004280         GO  TO  INI-120.                                         I.961108
004290     DISPLAY  ACP-TH4.                                            I.961108
004300     IF  W-FH4   >  W-TH4                                         I.961108
004310         GO  TO  INI-120.                                         I.961108
004320     IF W-TH4 = 999999                                            I.961108
004330         MOVE W-TH4 TO W-TH                                       I.961108
004340         MOVE ZERO TO W-FH5 W-TH5 W-FH6 W-TH6                     I.001208
004350         DISPLAY CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.001208
004360*****    MOVE ZERO TO W-FH5 W-TH5                                 D.001208
004370*****    DISPLAY CLR-FH5 CLR-FH5                                  D.001208
004380         GO TO INI-510.                                           I.961108
004390 INI-130.                                                         I.961108
004400     ACCEPT  ACP-FH5.                                             I.961108
004410     IF  ESTAT  =  "09"                                           I.961108
004420         GO  TO  INI-120.                                         I.961108
004430     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004440         GO  TO  INI-130.                                         I.961108
004450     IF W-FH5 = ZERO                                              I.961108
004460         MOVE W-TH4 TO W-TH                                       I.961108
004470         MOVE ZERO TO W-FH5 W-TH5 W-FH6 W-TH6                     I.001208
004480         DISPLAY CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.001208
004490*****    MOVE ZERO TO W-FH5 W-TH5                                 D.001208
004500*****    DISPLAY CLR-FH5 CLR-FH5                                  D.001208
004510         GO TO INI-510.                                           I.961108
004520     DISPLAY  ACP-FH5.                                            I.961108
004530     IF  W-FH5   <  W-TH4                                         I.961108
004540         GO  TO  INI-130.                                         I.961108
004550 INI-140.                                                         I.961108
004560     ACCEPT  ACP-TH5.                                             I.961108
004570     IF  ESTAT  =  "09"                                           I.961108
004580         GO  TO  INI-130.                                         I.961108
004590     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004600         GO  TO  INI-140.                                         I.961108
004610     DISPLAY  ACP-TH5.                                            I.961108
004620     IF  W-FH5   >  W-TH5                                         I.961108
004630         GO  TO  INI-140.                                         I.961108
004640     MOVE W-TH5 TO W-TH.                                          I.961108
004650     IF W-TH5 = 999999                                            I.961108
004660         MOVE W-TH5 TO W-TH                                       I.961108
004670         MOVE ZERO TO W-FH6 W-TH6                                 I.001208
004680         DISPLAY CLR-FH6 CLR-TH6                                  I.001208
004690         GO TO INI-510.                                           I.001208
004700 INI-150.                                                         I.001208
004710     ACCEPT  ACP-FH6.                                             I.001208
004720     IF  ESTAT  =  "09"                                           I.001208
004730         GO  TO  INI-140.                                         I.001208
004740     IF  ESTAT  NOT =  "01"  AND  "06"                            I.001208
004750         GO  TO  INI-150.                                         I.001208
004760     IF W-FH6 = ZERO                                              I.001208
004770         MOVE W-TH5 TO W-TH                                       I.001208
004780         MOVE ZERO TO W-FH6 W-TH6                                 I.001208
004790         DISPLAY CLR-FH6 CLR-TH6                                  I.001208
004800         GO TO INI-510.                                           I.001208
004810     DISPLAY  ACP-FH6.                                            I.001208
004820     IF  W-FH6   <  W-TH5                                         I.001208
004830         GO  TO  INI-150.                                         I.001208
004840 INI-160.                                                         I.001208
004850     ACCEPT  ACP-TH6.                                             I.001208
004860     IF  ESTAT  =  "09"                                           I.001208
004870         GO  TO  INI-150.                                         I.001208
004880     IF  ESTAT  NOT =  "01"  AND  "06"                            I.001208
004890         GO  TO  INI-160.                                         I.001208
004900     DISPLAY  ACP-TH6.                                            I.001208
004910     IF  W-FH6   >  W-TH6                                         I.001208
004920         GO  TO  INI-160.                                         I.001208
004930     MOVE W-TH6 TO W-TH.                                          I.001208
004940 INI-510.
004950     ACCEPT  ACP-OKC.
004960     IF  ESTAT  NOT =  "09"                                       I.961108
004970         GO TO INI-520.                                           I.961108
004980     IF  W-FH2 = ZERO                                             I.961108
004990         GO  TO  INI-060.
005000     IF  W-FH3 = ZERO                                             I.961108
005010         GO  TO  INI-080.                                         I.961108
005020     IF  W-FH4 = ZERO                                             I.961108
005030         GO  TO  INI-100.                                         I.961108
005040     IF  W-FH5 = ZERO                                             I.961108
005050         GO  TO  INI-120.                                         I.961108
005060     IF  W-FH6 = ZERO                                             I.001208
005070         GO  TO  INI-140.                                         I.961108
005080     GO  TO  INI-160.                                             I.001208
005090 INI-520.                                                         I.961108
005100     IF  ESTAT  NOT =  "01"  AND  "06"
005110         GO  TO  INI-510.
005120     DISPLAY  ACP-OKC.
005130     IF  OKC  NOT =  "1"  AND  "9"
005140         GO  TO  INI-510.
005150     IF  OKC  =  "9"
005160         GO  TO  INI-020.                                         I.001208
005170*****    GO  TO  INI-RTN.                                         D.001208
005180*
005190     CALL "CBLSTNNO" USING STN-NO.
005200     MOVE STN-NO2 TO W-FID2.
005210     MOVE W-FID TO WK0128ID.                                      I.970530
005220*****OPEN  INPUT   NJZAI  SHM.                                    D.010808
005230     OPEN  INPUT   NJZAI  HI2-M.                                  I.010808
005240     OPEN  INPUT   JMST3.
005250     OPEN  OUTPUT  JT-YZAI.
005260 INI-EX.
005270      EXIT.
005280******************************
005290***   UPD1  RTN            ***
005300******************************
005310 UPD1-RTN.
005320*
005330     INITIALIZE                 NJZAI-KEY.
005340     MOVE  9                TO  NJZAI-01.
005350     MOVE  W-FH1            TO  NJZAI-02.                         I.961108
005360*
005370     START  NJZAI  KEY  NOT <  NJZAI-KEY  INVALID
005380         GO  TO  UPD1-EX.
005390 UPD1-010.
005400***  倉別在庫マスタ　ＲＥＡＤ
005410     READ  NJZAI  NEXT  UNLOCK  AT  END
005420         GO  TO  UPD1-EX.
005430*
005440     MOVE  NJZAI-02         TO  W-HCD.
005450     IF  W-HCD     >  W-TH
005460         GO  TO  UPD1-EX.
005470     IF  W-HCD     >= W-FH1 AND   <=  W-TH1                       I.961108
005480         GO  TO  UPD1-020.                                        I.961108
005490     IF  W-HCD     >= W-FH2 AND   <=  W-TH2                       I.961108
005500         GO  TO  UPD1-020.                                        I.961108
005510     IF  W-HCD     >= W-FH3 AND   <=  W-TH3                       I.961108
005520         GO  TO  UPD1-020.                                        I.961108
005530     IF  W-HCD     >= W-FH4 AND   <=  W-TH4                       I.961108
005540         GO  TO  UPD1-020.                                        I.961108
005550     IF  W-HCD     >= W-FH5 AND   <=  W-TH5                       I.961108
005560         GO  TO  UPD1-020.                                        I.961108
005570     IF  W-HCD     >= W-FH6 AND   <=  W-TH6                       I.001208
005580         GO  TO  UPD1-020.                                        I.001208
005590     GO  TO  UPD1-010.                                            I.961108
005600*
005610 UPD1-020.                                                        I.961108
005620     PERFORM  ZC1-RTN      THRU  ZC1-EX.
005630     IF  ZERO-SW  =  0
005640         GO  TO  UPD1-010.
005650*
005660***  品名マスタ　ＲＥＡＤ
005670     MOVE  NJZAI-02     TO  HI-MHCD HI-HCD.                       I.010808
005680     READ  HI2-M  UNLOCK  INVALID                                 I.010808
005690         MOVE  SPACE    TO  HI-NAME.                              I.010808
005700*****MOVE  NJZAI-02     TO  SHM-KEY.                              D.010808
005710*****READ  SHM  UNLOCK  INVALID                                   D.010808
005720*****    MOVE  SPACE    TO  SHM-02.                               D.010808
005730*
005740*****MOVE  SPACE     TO  YZAI1-R.                                 D.001208
005750*****INITIALIZE  YZAI1-R.                                         D.001208
005760*****MOVE  NJZAI-02  TO  YZAI1-01.                                D.001208
005770*****MOVE  SHM-02    TO  YZAI1-02.                                D.001208
005780*****MOVE  NJZAI-03  TO  YZAI1-03.                                D.001208
005790     IF JS-SIGN = 0                                               I.001208
005800         MOVE  SPACE     TO  YZAI1-R                              I.001208
005810         INITIALIZE  YZAI1-R                                      I.001208
005820         MOVE  NJZAI-02  TO  YZAI1-01                             I.001208
005830         MOVE  HI-NAME   TO  YZAI1-02                             I.010808
005840*****    MOVE  SHM-02    TO  YZAI1-02                             D.010808
005850         MOVE  NJZAI-03  TO  YZAI1-03                             I.001208
005860       ELSE                                                       I.001208
005870         MOVE  SPACE     TO  YZAI2-R                              I.001208
005880         INITIALIZE  YZAI2-R                                      I.001208
005890         MOVE  NJZAI-02  TO  YZAI2-01                             I.001208
005900         MOVE  HI-NAME   TO  YZAI2-02                             I.010808
005910*****    MOVE  SHM-02    TO  YZAI2-02                             D.010808
005920         MOVE  NJZAI-03  TO  YZAI2-03.                            I.001208
005930     PERFORM  MOV-RTN       THRU  MOV-EX.
005940     PERFORM  WRI-RTN       THRU  WRI-EX.
005950     GO  TO  UPD1-010.
005960 UPD1-EX.
005970     EXIT.
005980*
005990******************************
006000***   UPD2  RTN            ***
006010******************************
006020 UPD2-RTN.
006030*
006040     INITIALIZE                 JMST3-KEY.
006050     MOVE  W-FH1            TO  JMST3-03.                         I.961108
006060*
006070     START  JMST3  KEY  NOT <  JMST3-KEY  INVALID
006080         GO  TO  UPD2-EX.
006090 UPD2-010.
006100***  受注マスタ　ＲＥＡＤ
006110     READ  JMST3  NEXT  UNLOCK  AT  END
006120         GO  TO  UPD2-EX.
006130*
006140     IF  JMST3-01  NOT =  5  AND  6                               I.961108
006150         GO  TO  UPD2-010.                                        I.961108
006160     IF  JMST3-03  >  W-TH
006170         GO  TO  UPD2-EX.
006180     IF  JMST3-03  >= W-FH1 AND   <=  W-TH1                       I.961108
006190         GO  TO  UPD2-020.                                        I.961108
006200     IF  JMST3-03  >= W-FH2 AND   <=  W-TH2                       I.961108
006210         GO  TO  UPD2-020.                                        I.961108
006220     IF  JMST3-03  >= W-FH3 AND   <=  W-TH3                       I.961108
006230         GO  TO  UPD2-020.                                        I.961108
006240     IF  JMST3-03  >= W-FH4 AND   <=  W-TH4                       I.961108
006250         GO  TO  UPD2-020.                                        I.961108
006260     IF  JMST3-03  >= W-FH5 AND   <=  W-TH5                       I.961108
006270         GO  TO  UPD2-020.                                        I.961108
006280     IF  JMST3-03  >= W-FH6 AND   <=  W-TH6                       I.001208
006290         GO  TO  UPD2-020.                                        I.001208
006300     GO  TO  UPD2-010.                                            I.961108
006310*
006320 UPD2-020.                                                        I.961108
006330     PERFORM  ZC2-RTN      THRU  ZC2-EX.
006340     IF  ZERO-SW  =  0
006350         GO  TO  UPD2-010.
006360*
006370***  品名マスタ　ＲＥＡＤ
006380     MOVE  JMST3-03     TO  HI-MHCD HI-HCD.                       I.010808
006390     READ  HI2-M  UNLOCK  INVALID                                 I.010808
006400         MOVE  SPACE    TO  HI-NAME.                              I.010808
006410*****MOVE  JMST3-03     TO  SHM-KEY.                              D.010808
006420*****READ  SHM  UNLOCK  INVALID                                   D.010808
006430*****    MOVE  SPACE    TO  SHM-02.                               D.010808
006440*
006450*****MOVE  SPACE     TO  YZAI1-R.                                 D.001208
006460*****INITIALIZE  YZAI1-R.                                         D.001208
006470*****MOVE  JMST3-03  TO  YZAI1-01.                                D.001208
006480*****MOVE  SHM-02    TO  YZAI1-02.                                D.001208
006490*****MOVE  JMST3-09  TO  YZAI1-03.                                D.001208
006500     IF JS-SIGN = 0                                               I.001208
006510         MOVE  SPACE     TO  YZAI1-R                              I.001208
006520         INITIALIZE  YZAI1-R                                      I.001208
006530         MOVE  JMST3-03  TO  YZAI1-01                             I.001208
006540         MOVE  HI-NAME   TO  YZAI1-02                             I.010808
006550*****    MOVE  SHM-02    TO  YZAI1-02                             D.010808
006560         MOVE  JMST3-09  TO  YZAI1-03                             I.001208
006570       ELSE                                                       I.001208
006580         MOVE  SPACE     TO  YZAI2-R                              I.001208
006590         INITIALIZE  YZAI2-R                                      I.001208
006600         MOVE  JMST3-03  TO  YZAI2-01                             I.001208
006610         MOVE  HI-NAME   TO  YZAI2-02                             I.010808
006620*****    MOVE  SHM-02    TO  YZAI2-02                             D.010808
006630         MOVE  JMST3-09  TO  YZAI2-03.                            I.001208
006640     PERFORM  MOV-RTN       THRU  MOV-EX.
006650     PERFORM  WRI-RTN       THRU  WRI-EX.
006660     GO  TO  UPD2-010.
006670 UPD2-EX.
006680     EXIT.
006690*
006700**************************
006710***  ﾌ ｧ ｲ ﾙ  CLOSE    ***
006720**************************
006730 END-RTN.
006740*****CLOSE   JT-YZAI  NJZAI  SHM.                                 D.010808
006750     CLOSE   JT-YZAI  NJZAI  HI2-M.                               I.010808
006760     CLOSE   JMST3.
006770     DISPLAY  C-CLEAR.
006780 END-EX.
006790     EXIT.
006800************************************
006810***  ＪＴ−ＹＺＡＩ　ＷＲＩＴＥ  ***
006820************************************
006830 WRI-RTN.
006840*****WRITE    YZAI1-R.                                            D.001208
006850     IF JS-SIGN = 0                                               I.001208
006860         WRITE    YZAI1-R                                         I.001208
006870       ELSE                                                       I.001208
006880         WRITE    YZAI2-R.                                        I.001208
006890     IF  ERR-STAT  NOT = "00"
006900              MOVE  "W"          TO  ERR-M
006910              MOVE  "WK0128"     TO  ERR-F                        I.970530
006920              PERFORM  ERR-RTN   THRU  ERR-EX.
006930 WRI-EX.
006940     EXIT.
006950********************************
006960*    在庫　ＺＥＲＯ　チェック  *
006970********************************
006980 ZC1-RTN.
006990     MOVE  ZERO  TO  W-SUD.
007000     MOVE  0     TO  ZERO-SW.
007010     MOVE  1     TO  I.
007020 ZC1-010.
007030     IF  I  >  10
007040         GO  TO  ZC1-EX.
007050     COMPUTE  W-SU(I)  =  NJZAI-0411(I)  -  NJZAI-0511(I)
007060                       +  NJZAI-0611(I)  +  NJZAI-0711(I)
007070                       -  NJZAI-0811(I)  +  NJZAI-1111(I).
007080     COMPUTE  W-SU(I)  =  W-SU(I)    -  NJZAI-0911(I).
007090     IF  (ZERO-SW   = 0)  AND  (W-SU(I)  NOT =  ZERO)
007100         MOVE   1     TO  ZERO-SW.
007110     ADD  1     TO  I.
007120     GO  TO  ZC1-010.
007130 ZC1-EX.
007140     EXIT.
007150****************************************
007160*    預り・取よけ　ＺＥＲＯ　チェック  *
007170****************************************
007180 ZC2-RTN.
007190     MOVE  ZERO  TO  W-SUD.
007200     MOVE  0     TO  ZERO-SW.
007210     MOVE  1     TO  I.
007220 ZC2-010.
007230     IF  I  >  10
007240         GO  TO  ZC2-EX.
007250     COMPUTE  W-SU(I)  =  JMST3-1111(I)  -  JMST3-1211(I)
007260                       -  JMST3-141 (I)  -  JMST3-151 (I).
007270     COMPUTE  W-SU(I)  =  -1             *  W-SU(I).
007280     IF  (ZERO-SW   = 0)  AND  (W-SU(I)  NOT =  ZERO)
007290         MOVE   1     TO  ZERO-SW.
007300     ADD  1     TO  I.
007310     GO  TO  ZC2-010.
007320 ZC2-EX.
007330     EXIT.
007340*****************************
007350*    数量　ＭＯＶＥ         *
007360*****************************
007370 MOV-RTN.
007380     MOVE  ZERO  TO  W-SUT.
007390     MOVE  1     TO  I.
007400 MOV-010.
007410     IF  I  >  10
007420         GO  TO  MOV-020.
007430*****MOVE   W-SU(I)     TO  YZAI1-0411(I).                        D.001208
007440     IF JS-SIGN = 0                                               I.001208
007450         MOVE   W-SU(I)     TO  YZAI1-0411(I)                     I.001208
007460       ELSE                                                       I.001208
007470         MOVE   W-SU(I)     TO  YZAI2-0411(I).                    I.001208
007480     ADD    W-SU(I)     TO  W-SUT.
007490     ADD  1     TO  I.
007500     GO  TO  MOV-010.
007510 MOV-020.
007520     IF JS-SIGN = 0                                               I.001208
007530         MOVE   W-SUT       TO  YZAI1-042                         I.001208
007540       ELSE                                                       I.001208
007550         MOVE   W-SUT       TO  YZAI2-042.                        I.001208
007560*****MOVE   W-SUT       TO  YZAI1-042.                            D.001208
007570 MOV-EX.
007580     EXIT.
007590***
007600 COPY  LPMSG.
007610***
