000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JT085L.
000030*********************************************************
000040*    PROGRAM         :  倉別棚卸・在庫差額表            *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  98/12/26                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT JT-KTZ ASSIGN TO KTZ-MSD.
000170     SELECT SHM ASSIGN TO SH-MSD
000180         ORGANIZATION IS INDEXED
000190         ACCESS MODE IS RANDOM
000200         RECORD KEY IS SHM-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT JCON ASSIGN TO JCON-MSD
000230         ORGANIZATION IS INDEXED
000240         ACCESS MODE IS RANDOM
000250         RECORD KEY IS JCON1-KEY
000260         FILE STATUS IS ERR-STAT.
000270     SELECT SP-F ASSIGN TO P-PRN999.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON SHM
000300     APPLY SHARED-MODE ON JCON
000310     APPLY SHIFT-CODE  ON SP-F.
000320 DATA DIVISION.
000330 FILE SECTION.
000340     COPY L-SHM.
000350     COPY L-JCON.
000360     COPY LSPF.
000370 FD  JT-KTZ
000380     BLOCK  2 RECORDS
000390     LABEL RECORD IS STANDARD
000400     VALUE OF IDENTIFICATION WK0128ID.
000410 01  KTZ-R.
000420     02  KTZ-KURA       PIC  9(001).
000430     02  KTZ-HCD        PIC  9(006).
000440     02  KTZ-DC         PIC  9(001).
000450     02  KTZ-SIZ        PIC  9(001).
000460     02  KTZ-ASUD.
000470       03  KTZ-SUD  OCCURS  10.
000480         04  KTZ-SU     PIC  9(006).
000490     02  F              PIC  X(059).
000500 WORKING-STORAGE SECTION.
000510 77  WK0128ID           PIC  X(009) VALUE SPACE.
000520 01  STN-NO.
000530     02  STN-NO1        PIC  X(003).
000540     02  STN-NO2        PIC  X(003).
000550 01  W-FID.
000560     02  W-FID1         PIC  X(006) VALUE "WK0128".
000570     02  W-FID2         PIC  X(003).
000580 01  HEAD1.
000590     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000600     02  F              PIC  X(043) VALUE SPACE.
000610     02  F              PIC  N(020) VALUE
000620          NC"＊＊＊　　倉別棚卸・在庫差額表　　＊＊＊".
000630     02  F              PIC  X(030) VALUE SPACE.
000640     02  F              PIC  X(005) VALUE "DATE ".
000650     02  H-DATE         PIC 99B99B99.
000660     02  F              PIC  X(007) VALUE "     P.".
000670     02  H-PAGE         PIC ZZ9.
000680 01  HEAD2.
000690     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
000700     02  F              PIC  N(006) VALUE NC"倉　庫　名　".
000710     02  F              PIC  X(127) VALUE SPACE.
000720 01  HEAD3.
000730     02  F              PIC  X(008) VALUE SPACE.
000740     02  F              PIC  X(006) VALUE "ｺｰﾄﾞ  ".
000750     02  F              PIC  N(006) VALUE NC"品　　　名　".
000760     02  F              PIC  X(022) VALUE SPACE.
000770     02  F              PIC  X(001) VALUE "1".
000780     02  F              PIC  X(005) VALUE SPACE.
000790     02  F              PIC  N(002) VALUE NC"３号".
000800     02  F              PIC  X(005) VALUE SPACE.
000810     02  F              PIC  N(002) VALUE NC"２号".
000820     02  F              PIC  X(005) VALUE SPACE.
000830     02  F              PIC  N(002) VALUE NC"１号".
000840     02  F              PIC  X(005) VALUE SPACE.
000850     02  F              PIC  N(002) VALUE NC"０号".
000860     02  F              PIC  X(005) VALUE SPACE.
000870     02  F              PIC  N(002) VALUE NC"　中".
000880     02  F              PIC  X(005) VALUE SPACE.
000890     02  F              PIC  N(002) VALUE NC"　大".
000900     02  F              PIC  X(005) VALUE SPACE.
000910     02  F              PIC  N(002) VALUE NC"特大".
000920     02  F              PIC  X(004) VALUE SPACE.
000930     02  F              PIC  X(004) VALUE "28.0".
000940     02  F              PIC  X(004) VALUE SPACE.
000950     02  F              PIC  X(004) VALUE "29.0".
000960     02  F              PIC  X(004) VALUE SPACE.
000970     02  F              PIC  X(004) VALUE "30.0".
000980     02  F              PIC  X(010) VALUE SPACE.
000990 01  HEAD4.
001000     02  F              PIC  X(045) VALUE SPACE.
001010     02  F              PIC  X(001) VALUE "2".
001020     02  F              PIC  X(004) VALUE SPACE.
001030     02  F              PIC  X(004) VALUE "12.5".
001040     02  F              PIC  X(004) VALUE SPACE.
001050     02  F              PIC  X(004) VALUE "13.0".
001060     02  F              PIC  X(004) VALUE SPACE.
001070     02  F              PIC  X(004) VALUE "13.5".
001080     02  F              PIC  X(004) VALUE SPACE.
001090     02  F              PIC  X(004) VALUE "14.0".
001100     02  F              PIC  X(004) VALUE SPACE.
001110     02  F              PIC  X(004) VALUE "15.0".
001120     02  F              PIC  X(004) VALUE SPACE.
001130     02  F              PIC  X(004) VALUE "16.0".
001140     02  F              PIC  X(004) VALUE SPACE.
001150     02  F              PIC  X(004) VALUE "17.0".
001160     02  F              PIC  X(004) VALUE SPACE.
001170     02  F              PIC  X(004) VALUE "18.0".
001180     02  F              PIC  X(004) VALUE SPACE.
001190     02  F              PIC  X(004) VALUE "19.0".
001200     02  F              PIC  X(004) VALUE SPACE.
001210     02  F              PIC  X(004) VALUE "20.0".
001220     02  F              PIC  X(010) VALUE SPACE.
001230 01  HEAD5.
001240     02  F              PIC  X(045) VALUE SPACE.
001250     02  F              PIC  X(001) VALUE "3".
001260     02  F              PIC  X(004) VALUE SPACE.
001270     02  F              PIC  X(004) VALUE "21.0".
001280     02  F              PIC  X(004) VALUE SPACE.
001290     02  F              PIC  X(004) VALUE "21.5".
001300     02  F              PIC  X(004) VALUE SPACE.
001310     02  F              PIC  X(004) VALUE "22.0".
001320     02  F              PIC  X(004) VALUE SPACE.
001330     02  F              PIC  X(004) VALUE "22.5".
001340     02  F              PIC  X(004) VALUE SPACE.
001350     02  F              PIC  X(004) VALUE "23.0".
001360     02  F              PIC  X(004) VALUE SPACE.
001370     02  F              PIC  X(004) VALUE "23.5".
001380     02  F              PIC  X(004) VALUE SPACE.
001390     02  F              PIC  X(004) VALUE "24.0".
001400     02  F              PIC  X(004) VALUE SPACE.
001410     02  F              PIC  X(004) VALUE "24.5".
001420     02  F              PIC  X(004) VALUE SPACE.
001430     02  F              PIC  X(004) VALUE "25.0".
001440     02  F              PIC  X(018) VALUE SPACE.
001450 01  HEAD6.
001460     02  F              PIC  X(045) VALUE SPACE.
001470     02  F              PIC  X(001) VALUE "4".
001480     02  F              PIC  X(004) VALUE SPACE.
001490     02  F              PIC  X(004) VALUE "24.0".
001500     02  F              PIC  X(004) VALUE SPACE.
001510     02  F              PIC  X(004) VALUE "24.5".
001520     02  F              PIC  X(004) VALUE SPACE.
001530     02  F              PIC  X(004) VALUE "25.0".
001540     02  F              PIC  X(004) VALUE SPACE.
001550     02  F              PIC  X(004) VALUE "25.5".
001560     02  F              PIC  X(004) VALUE SPACE.
001570     02  F              PIC  X(004) VALUE "26.0".
001580     02  F              PIC  X(004) VALUE SPACE.
001590     02  F              PIC  X(004) VALUE "26.5".
001600     02  F              PIC  X(004) VALUE SPACE.
001610     02  F              PIC  X(004) VALUE "27.0".
001620     02  F              PIC  X(004) VALUE SPACE.
001630     02  F              PIC  X(004) VALUE "27.5".
001640     02  F              PIC  X(020) VALUE SPACE.
001650     02  F              PIC  N(004) VALUE NC"　合　計".
001660 01  W-P1.
001670     02  P-KURA         PIC  9(001).
001680     02  F              PIC  X(001).
001690     02  P-KURAN        PIC  N(006).
001700     02  F              PIC  X(125).
001710 01  W-P2.
001720     02  F              PIC  X(007).
001730     02  P-HCD          PIC  9(006).
001740     02  F              PIC  X(001).
001750     02  P-HNA          PIC  N(024).
001760     02  F              PIC  X(086).
001770 01  W-P3.
001780     02  F              PIC  X(032).
001790     02  P-MSG          PIC  N(008).
001800     02  F              PIC  X(001).
001810     02  P-SIZ          PIC  9(001).
001820     02  P-SUD.
001830         03  P-SU       PIC ----,--9  OCCURS  10 TIMES.
001840     02  P-SUT          PIC --,---,--9.
001850 01  W-PT.
001860     02  P-TTM          PIC  N(020).
001870     02  F              PIC  X(106).
001880 01  W-DATA.
001890     02  W-KURA         PIC  9(001).
001900     02  W-HCD          PIC  9(006).
001910     02  W-D.
001920         03  W-ASUD.
001930             04  W-ABSU  OCCURS   4.
001940                 05  W-BSUD   OCCURS  10.
001950                     06  W-BSU   PIC S9(006).
001960             04  W-ACSU  OCCURS   4.
001970                 05  W-CSUD   OCCURS  10.
001980                     06  W-CSU   PIC S9(006).
001990             04  W-ATSU  OCCURS   4.
002000                 05  W-TSUD   OCCURS  10.
002010                     06  W-TSU   PIC S9(006).
002020             04  W-ASSU  OCCURS   4.
002030                 05  W-SSUD   OCCURS  10.
002040                     06  W-SSU   PIC S9(006).
002050         03  W-AZC.
002060             04  W-BZCD.
002070                 05  W-BZC   OCCURS   4  PIC  9(001).
002080             04  W-CZCD.
002090                 05  W-CZC   OCCURS   4  PIC  9(001).
002100             04  W-TZCD.
002110                 05  W-TZC   OCCURS   4  PIC  9(001).
002120             04  W-SZCD.
002130                 05  W-SZC   OCCURS   4  PIC  9(001).
002140         03  W-SUTD.
002150             04  W-SUT     OCCURS   4  PIC S9(007).
002160     02  WS-ASUD.
002170         03  WS-ABSU  OCCURS   4.
002180             04  WS-BSUD   OCCURS  10.
002190                 05  WS-BSU   PIC S9(006).
002200         03  WS-ACSU  OCCURS   4.
002210             04  WS-CSUD   OCCURS  10.
002220                 05  WS-CSU   PIC S9(006).
002230         03  WS-ATSU  OCCURS   4.
002240             04  WS-TSUD   OCCURS  10.
002250                 05  WS-TSU   PIC S9(006).
002260         03  WS-ASSU  OCCURS   4.
002270             04  WS-SSUD   OCCURS  10.
002280                 05  WS-SSU   PIC S9(006).
002290     02  WA-ASUD.
002300         03  WA-ABSU  OCCURS   4.
002310             04  WA-BSUD   OCCURS  10.
002320                 05  WA-BSU   PIC S9(006).
002330         03  WA-ACSU  OCCURS   4.
002340             04  WA-CSUD   OCCURS  10.
002350                 05  WA-CSU   PIC S9(006).
002360         03  WA-ATSU  OCCURS   4.
002370             04  WA-TSUD   OCCURS  10.
002380                 05  WA-TSU   PIC S9(006).
002390         03  WA-ASSU  OCCURS   4.
002400             04  WA-SSUD   OCCURS  10.
002410                 05  WA-SSU   PIC S9(006).
002420     02  W-ASU.
002430         03  W-SUD   OCCURS  10.
002440             04  W-SU   PIC S9(006).
002450     02  W-PAGE         PIC  9(003) VALUE ZERO.
002460     02  CHK.
002470       03  CHK1         PIC  9(001).
002480       03  CHK2         PIC  9(001).
002490       03  CHK3         PIC  9(001).
002500       03  CHK4         PIC  9(001).
002510     02  W-TC           PIC  9(001).
002520     02  W-C            PIC  9(001).
002530     02  CNT            PIC  9(002).
002540 01  ERR-STAT           PIC  X(002).
002550     COPY LSTAT.
002560 SCREEN SECTION.
002570 SD  C-CRT
002580     END STATUS IS ESTAT.
002590 01  C-CLEAR.
002600     02  C-CL    LINE   1  CLEAR SCREEN.
002610 01  C-MID.
002620     02  LINE   3  COLUMN  10  PIC  N(020) VALUE
002630          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002640     02  LINE   4  COLUMN  10  PIC  N(020) VALUE
002650          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002660     02  LINE   5  COLUMN  10  PIC  N(020) VALUE
002670          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".
002680     02  LINE   6  COLUMN  10  PIC  N(020) VALUE
002690          NC"＊＊＊　　倉別棚卸・在庫差額表　　＊＊＊".
002700     02  LINE   7  COLUMN  10  PIC  N(020) VALUE
002710          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".
002720     02  LINE   8  COLUMN  10  PIC  N(020) VALUE
002730          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002740     02  LINE   9  COLUMN  10  PIC  N(020) VALUE
002750          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002760 01  C-ERR.
002770     02  LINE  24.
002780       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002790       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002800            "***  DATA ﾅｼ  ***".
002810       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002820       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002830       03  E-CL    COLUMN  10  PIC  X(050) VALUE
002840            "                                                  ".
002850 PROCEDURE DIVISION.
002860 M-05.
002870     DISPLAY C-CLEAR.
002880     DISPLAY C-MID.
002890     CALL "CBLSTNNO" USING STN-NO.
002900     MOVE STN-NO2 TO W-FID2.
002910     MOVE W-FID TO WK0128ID.
002920     OPEN INPUT JT-KTZ.
002930 M-10.
002940     READ JT-KTZ AT END
002950         CLOSE JT-KTZ
002960         DISPLAY E-ME1 E-ME99
002970         GO TO M-95.
002980     OPEN INPUT SHM JCON.
002990     OPEN OUTPUT SP-F.
003000     ACCEPT H-DATE FROM DATE.
003010     PERFORM HED-010 THRU HED-EX.
003020     MOVE ZERO TO WA-ASUD.
003030 M-15.
003040     MOVE KTZ-KURA TO W-KURA.
003050     MOVE 3 TO JCON3-01.
003060     MOVE KTZ-KURA TO JCON3-02.
003070     READ JCON WITH UNLOCK INVALID KEY
003080         MOVE SPACE TO JCON3-03.
003090     MOVE ZERO TO CHK WS-ASUD.
003100 M-20.
003110     MOVE KTZ-HCD TO W-HCD.
003120     MOVE KTZ-HCD TO SHM-KEY.
003130     READ SHM WITH UNLOCK INVALID KEY
003140         MOVE SPACE TO SHM-02.
003150     MOVE ZERO TO W-D CHK2.
003160 M-25.
003170     IF KTZ-DC = 0
003180         MOVE KTZ-ASUD TO W-ABSU(KTZ-SIZ).
003190     IF KTZ-DC = 1
003200         MOVE KTZ-ASUD TO W-ACSU(KTZ-SIZ).
003210     IF KTZ-DC = 2
003220         MOVE KTZ-ASUD TO W-ATSU(KTZ-SIZ).
003230 M-30.
003240     READ JT-KTZ AT END
003250         GO TO M-80.
003260     IF KTZ-KURA NOT = W-KURA
003270         GO TO M-35.
003280     IF KTZ-HCD = W-HCD
003290         GO TO M-25.
003300     MOVE 0 TO W-TC.
003310     PERFORM MEI-RTN THRU MEI-EX.
003320     GO TO M-20.
003330 M-35.
003340     MOVE 0 TO W-TC.
003350     PERFORM MEI-RTN THRU MEI-EX.
003360     MOVE 1 TO W-TC.
003370     PERFORM KEI-RTN THRU KEI-EX.
003380     GO TO M-15.
003390 M-80.
003400     MOVE 0 TO W-TC.
003410     PERFORM MEI-RTN THRU MEI-EX.
003420     MOVE 1 TO W-TC.
003430     PERFORM KEI-RTN THRU KEI-EX.
003440     MOVE 2 TO W-TC.
003450     PERFORM KEI-RTN THRU KEI-EX.
003460 M-90.
003470     CLOSE SHM.
003480     CLOSE JCON.
003490     CLOSE JT-KTZ.
003500     CLOSE SP-F.
003510 M-95.
003520     DISPLAY C-CLEAR.
003530     STOP RUN.
003540 HED-RTN.
003550     MOVE SPACE TO SP-R.
003560     WRITE SP-R AFTER PAGE.
003570 HED-010.
003580     ADD 1 TO W-PAGE.
003590     MOVE W-PAGE TO H-PAGE.
003600     MOVE SPACE TO SP-R.
003610     MOVE HEAD1 TO SP-R.
003620     WRITE SP-R.
003630     MOVE SPACE TO SP-R.
003640     MOVE HEAD2 TO SP-R.
003650     WRITE SP-R.
003660     MOVE SPACE TO SP-R.
003670     MOVE HEAD3 TO SP-R.
003680     WRITE SP-R.
003690     MOVE SPACE TO SP-R.
003700     MOVE HEAD4 TO SP-R.
003710     WRITE SP-R.
003720     MOVE SPACE TO SP-R.
003730     MOVE HEAD5 TO SP-R.
003740     WRITE SP-R.
003750     MOVE SPACE TO SP-R.
003760     MOVE HEAD6 TO SP-R.
003770     WRITE SP-R.
003780     MOVE SPACE TO SP-R.
003790 HED-EX.
003800     EXIT.
003810 MEI-RTN.
003820     MOVE 0 TO W-C.
003830 MEI-010.
003840     ADD 1 TO W-C.
003850     IF W-C = 5
003860         GO TO MEI-030.
003870     MOVE ZERO TO CNT.
003880 MEI-020.
003890     ADD 1 TO CNT.
003900     IF CNT = 11
003910         GO TO MEI-010.
003920     IF ZERO = W-BSU(W-C,CNT) AND W-CSU(W-C,CNT)
003930                              AND W-TSU(W-C,CNT)
003940         GO TO MEI-020.
003950     COMPUTE W-SSU(W-C,CNT) = W-TSU(W-C,CNT) - W-BSU(W-C,CNT)
003960                                             - W-CSU(W-C,CNT).
003970     IF W-BSU(W-C,CNT) NOT = ZERO
003980         ADD W-BSU(W-C,CNT) TO W-SUT(1) WS-BSU(W-C,CNT)
003990                                        WA-BSU(W-C,CNT)
004000         IF W-BZC(W-C) = 0
004010             MOVE 1 TO W-BZC(W-C).
004020     IF W-CSU(W-C,CNT) NOT = ZERO
004030         ADD W-CSU(W-C,CNT) TO W-SUT(2) WS-CSU(W-C,CNT)
004040                                        WA-CSU(W-C,CNT)
004050         IF W-CZC(W-C) = 0
004060             MOVE 1 TO W-CZC(W-C).
004070     IF W-TSU(W-C,CNT) NOT = ZERO
004080         ADD W-TSU(W-C,CNT) TO W-SUT(3) WS-TSU(W-C,CNT)
004090                                        WA-TSU(W-C,CNT)
004100         IF W-TZC(W-C) = 0
004110             MOVE 1 TO W-TZC(W-C).
004120     IF W-SSU(W-C,CNT) NOT = ZERO
004130         ADD W-SSU(W-C,CNT) TO W-SUT(4) WS-SSU(W-C,CNT)
004140                                        WA-SSU(W-C,CNT)
004150         IF W-SZC(W-C) = 0
004160             MOVE 1 TO W-SZC(W-C).
004170     GO TO MEI-020.
004180 MEI-030.
004190     IF W-AZC = ZERO
004200         GO TO MEI-EX.
004210     IF CHK1 = 0
004220         PERFORM KNA-RTN THRU KNA-EX.
004230     IF CHK2 = 0
004240         PERFORM HNA-RTN THRU HNA-EX.
004250*
004260     PERFORM WRI-RTN THRU WRI-EX.
004270 MEI-EX.
004280     EXIT.
004290 KEI-RTN.
004300     MOVE ZERO TO W-D CHK4.
004310     IF W-TC = 1
004320         MOVE WS-ASUD TO W-ASUD
004330       ELSE
004340         MOVE WA-ASUD TO W-ASUD.
004350     MOVE 0 TO W-C.
004360 KEI-010.
004370     ADD 1 TO W-C.
004380     IF W-C = 5
004390         GO TO KEI-030.
004400     MOVE ZERO TO CNT.
004410 KEI-020.
004420     ADD 1 TO CNT.
004430     IF CNT = 11
004440         GO TO KEI-010.
004450     IF ZERO = W-BSU(W-C,CNT) AND W-CSU(W-C,CNT)
004460                              AND W-TSU(W-C,CNT)
004470         GO TO KEI-020.
004480     IF W-BSU(W-C,CNT) NOT = ZERO
004490         ADD W-BSU(W-C,CNT) TO W-SUT(1)
004500         IF W-BZC(W-C) = 0
004510             MOVE 1 TO W-BZC(W-C).
004520     IF W-CSU(W-C,CNT) NOT = ZERO
004530         ADD W-CSU(W-C,CNT) TO W-SUT(2)
004540         IF W-CZC(W-C) = 0
004550             MOVE 1 TO W-CZC(W-C).
004560     IF W-TSU(W-C,CNT) NOT = ZERO
004570         ADD W-TSU(W-C,CNT) TO W-SUT(3)
004580         IF W-TZC(W-C) = 0
004590             MOVE 1 TO W-TZC(W-C).
004600     IF W-SSU(W-C,CNT) NOT = ZERO
004610         ADD W-SSU(W-C,CNT) TO W-SUT(4)
004620         IF W-SZC(W-C) = 0
004630             MOVE 1 TO W-SZC(W-C).
004640     GO TO KEI-020.
004650 KEI-030.
004660     IF W-AZC = ZERO
004670         GO TO KEI-EX.
004680     IF CHK4 = 0
004690         IF W-TC = 1
004700             PERFORM STM-RTN THRU STM-EX
004710           ELSE
004720             PERFORM ATM-RTN THRU ATM-EX.
004730*
004740     PERFORM WRI-RTN THRU WRI-EX.
004750 KEI-EX.
004760     EXIT.
004770 WRI-RTN.
004780     IF W-BZCD = ZERO
004790         GO TO WRI-020.
004800     MOVE ZERO TO W-C CHK3.
004810 WRI-010.
004820     ADD 1 TO W-C.
004830     IF W-C = 5
004840         GO TO WRI-020.
004850     IF W-BZC(W-C) = ZERO
004860         GO TO WRI-010.
004870     MOVE SPACE TO W-P3.
004880     MOVE SPACE TO P-MSG.
004890     IF CHK3 = ZERO
004900         MOVE NC"｛　帳　簿　｝　" TO P-MSG
004910         MOVE 1 TO CHK3.
004920     MOVE W-C TO P-SIZ.
004930     MOVE ZERO TO W-ASU.
004940     MOVE W-ABSU(W-C) TO W-ASU.
004950     PERFORM SET-RTN THRU SET-EX.
004960     IF W-C = 1
004970         IF 0 = W-BZC(2) AND W-BZC(3) AND W-BZC(4)
004980             MOVE W-SUT(1) TO P-SUT.
004990     IF W-C = 2
005000         IF 0 = W-BZC(3) AND W-BZC(4)
005010             MOVE W-SUT(1) TO P-SUT.
005020     IF W-C = 3
005030         IF 0 = W-BZC(4)
005040             MOVE W-SUT(1) TO P-SUT.
005050     IF W-C = 4
005060         MOVE W-SUT(1) TO P-SUT.
005070     IF LINAGE-COUNTER > 60
005080         MOVE NC"｛　帳　簿　｝　" TO P-MSG
005090         PERFORM HED-RTN THRU HED-EX
005100         IF W-TC = 0
005110             PERFORM KNA-RTN THRU KNA-EX
005120             PERFORM HNA-RTN THRU HNA-EX
005130           ELSE
005140             IF W-TC = 1
005150                 PERFORM KNA-RTN THRU KNA-EX
005160                 PERFORM STM-RTN THRU STM-EX
005170               ELSE
005180                 PERFORM ATM-RTN THRU ATM-EX.
005190     MOVE SPACE TO SP-R.
005200     MOVE W-P3 TO SP-R.
005210     WRITE SP-R.
005220     MOVE SPACE TO SP-R.
005230     GO TO WRI-010.
005240 WRI-020.
005250     IF W-CZCD = ZERO
005260         GO TO WRI-040.
005270     MOVE ZERO TO W-C CHK3.
005280 WRI-030.
005290     ADD 1 TO W-C.
005300     IF W-C = 5
005310         GO TO WRI-040.
005320     IF W-CZC(W-C) = ZERO
005330         GO TO WRI-030.
005340     MOVE SPACE TO W-P3.
005350     MOVE SPACE TO P-MSG.
005360     IF CHK3 = ZERO
005370         MOVE NC"＜　調　整　＞　" TO P-MSG
005380         MOVE 1 TO CHK3.
005390     MOVE W-C TO P-SIZ.
005400     MOVE ZERO TO W-ASU.
005410     MOVE W-ACSU(W-C) TO W-ASU.
005420     PERFORM SET-RTN THRU SET-EX.
005430     IF W-C = 1
005440         IF 0 = W-CZC(2) AND W-CZC(3) AND W-CZC(4)
005450             MOVE W-SUT(2) TO P-SUT.
005460     IF W-C = 2
005470         IF 0 = W-CZC(3) AND W-CZC(4)
005480             MOVE W-SUT(2) TO P-SUT.
005490     IF W-C = 3
005500         IF 0 = W-CZC(4)
005510             MOVE W-SUT(2) TO P-SUT.
005520     IF W-C = 4
005530         MOVE W-SUT(2) TO P-SUT.
005540     IF LINAGE-COUNTER > 60
005550         MOVE NC"＜　調　整　＞　" TO P-MSG
005560         PERFORM HED-RTN THRU HED-EX
005570         IF W-TC = 0
005580             PERFORM KNA-RTN THRU KNA-EX
005590             PERFORM HNA-RTN THRU HNA-EX
005600           ELSE
005610             IF W-TC = 1
005620                 PERFORM KNA-RTN THRU KNA-EX
005630                 PERFORM STM-RTN THRU STM-EX
005640               ELSE
005650                 PERFORM ATM-RTN THRU ATM-EX.
005660     MOVE SPACE TO SP-R.
005670     MOVE W-P3 TO SP-R.
005680     WRITE SP-R.
005690     MOVE SPACE TO SP-R.
005700     GO TO WRI-030.
005710 WRI-040.
005720     IF W-TZCD = ZERO
005730         GO TO WRI-060.
005740     MOVE ZERO TO W-C CHK3.
005750 WRI-050.
005760     ADD 1 TO W-C.
005770     IF W-C = 5
005780         GO TO WRI-060.
005790     IF W-TZC(W-C) = ZERO
005800         GO TO WRI-050.
005810     MOVE SPACE TO W-P3.
005820     MOVE SPACE TO P-MSG.
005830     IF CHK3 = ZERO
005840         MOVE NC"〔　棚　卸　〕　" TO P-MSG
005850         MOVE 1 TO CHK3.
005860     MOVE W-C TO P-SIZ.
005870     MOVE ZERO TO W-ASU.
005880     MOVE W-ATSU(W-C) TO W-ASU.
005890     PERFORM SET-RTN THRU SET-EX.
005900     IF W-C = 1
005910         IF 0 = W-TZC(2) AND W-TZC(3) AND W-TZC(4)
005920             MOVE W-SUT(3) TO P-SUT.
005930     IF W-C = 2
005940         IF 0 = W-TZC(3) AND W-TZC(4)
005950             MOVE W-SUT(3) TO P-SUT.
005960     IF W-C = 3
005970         IF 0 = W-TZC(4)
005980             MOVE W-SUT(3) TO P-SUT.
005990     IF W-C = 4
006000         MOVE W-SUT(3) TO P-SUT.
006010     IF LINAGE-COUNTER > 60
006020         MOVE NC"〔　棚　卸　〕　" TO P-MSG
006030         PERFORM HED-RTN THRU HED-EX
006040         IF W-TC = 0
006050             PERFORM KNA-RTN THRU KNA-EX
006060             PERFORM HNA-RTN THRU HNA-EX
006070           ELSE
006080             IF W-TC = 1
006090                 PERFORM KNA-RTN THRU KNA-EX
006100                 PERFORM STM-RTN THRU STM-EX
006110               ELSE
006120                 PERFORM ATM-RTN THRU ATM-EX.
006130     MOVE SPACE TO SP-R.
006140     MOVE W-P3 TO SP-R.
006150     WRITE SP-R.
006160     MOVE SPACE TO SP-R.
006170     GO TO WRI-050.
006180 WRI-060.
006190     IF W-SZCD = ZERO
006200         GO TO WRI-EX.
006210     MOVE ZERO TO W-C CHK3.
006220 WRI-070.
006230     ADD 1 TO W-C.
006240     IF W-C = 5
006250         GO TO WRI-EX.
006260     IF W-SZC(W-C) = ZERO
006270         GO TO WRI-070.
006280     MOVE SPACE TO W-P3.
006290     MOVE SPACE TO P-MSG.
006300     IF CHK3 = ZERO
006310         MOVE NC"《　差　額　》　" TO P-MSG
006320         MOVE 1 TO CHK3.
006330     MOVE W-C TO P-SIZ.
006340     MOVE ZERO TO W-ASU.
006350     MOVE W-ASSU(W-C) TO W-ASU.
006360     PERFORM SET-RTN THRU SET-EX.
006370     IF W-C = 1
006380         IF 0 = W-SZC(2) AND W-SZC(3) AND W-SZC(4)
006390             MOVE W-SUT(4) TO P-SUT.
006400     IF W-C = 2
006410         IF 0 = W-SZC(3) AND W-SZC(4)
006420             MOVE W-SUT(4) TO P-SUT.
006430     IF W-C = 3
006440         IF 0 = W-SZC(4)
006450             MOVE W-SUT(4) TO P-SUT.
006460     IF W-C = 4
006470         MOVE W-SUT(4) TO P-SUT.
006480     IF LINAGE-COUNTER > 60
006490         MOVE NC"《　差　額　》　" TO P-MSG
006500         PERFORM HED-RTN THRU HED-EX
006510         IF W-TC = 0
006520             PERFORM KNA-RTN THRU KNA-EX
006530             PERFORM HNA-RTN THRU HNA-EX
006540           ELSE
006550             IF W-TC = 1
006560                 PERFORM KNA-RTN THRU KNA-EX
006570                 PERFORM STM-RTN THRU STM-EX
006580               ELSE
006590                 PERFORM ATM-RTN THRU ATM-EX.
006600     MOVE SPACE TO SP-R.
006610     MOVE W-P3 TO SP-R.
006620     WRITE SP-R.
006630     MOVE SPACE TO SP-R.
006640     GO TO WRI-070.
006650 WRI-EX.
006660     EXIT.
006670 SET-RTN.
006680     MOVE ZERO TO CNT.
006690 SET-010.
006700     ADD 1 TO CNT.
006710     IF CNT = 11
006720         GO TO SET-EX.
006730     IF W-SU(CNT) NOT = ZERO
006740         MOVE W-SU(CNT) TO P-SU(CNT).
006750     GO TO SET-010.
006760 SET-EX.
006770     EXIT.
006780 KNA-RTN.
006790     MOVE SPACE TO W-P1.
006800     MOVE W-KURA TO P-KURA.
006810     MOVE JCON3-03 TO P-KURAN.
006820     IF LINAGE-COUNTER > 58
006830         PERFORM HED-RTN THRU HED-EX.
006840     MOVE SPACE TO SP-R.
006850     MOVE W-P1 TO SP-R.
006860     WRITE SP-R.
006870     MOVE SPACE TO SP-R.
006880     MOVE 1 TO CHK1.
006890 KNA-EX.
006900     EXIT.
006910 HNA-RTN.
006920     MOVE SPACE TO W-P2.
006930     MOVE W-HCD TO P-HCD.
006940     MOVE SHM-02 TO P-HNA.
006950     IF LINAGE-COUNTER > 59
006960         PERFORM HED-RTN THRU HED-EX
006970         PERFORM KNA-RTN THRU KNA-EX.
006980     MOVE SPACE TO SP-R.
006990     MOVE W-P2 TO SP-R.
007000     WRITE SP-R.
007010     MOVE SPACE TO SP-R.
007020     MOVE 1 TO CHK2.
007030 HNA-EX.
007040     EXIT.
007050 STM-RTN.
007060     MOVE SPACE TO W-PT.
007070     MOVE NC"　　　　　　［　　小　計　　］　　　　　" TO P-TTM.
007080     IF LINAGE-COUNTER > 59
007090         PERFORM HED-RTN THRU HED-EX
007100         PERFORM KNA-RTN THRU KNA-EX.
007110     MOVE SPACE TO SP-R.
007120     MOVE W-PT TO SP-R.
007130     WRITE SP-R.
007140     MOVE SPACE TO SP-R.
007150     MOVE 1 TO CHK4.
007160 STM-EX.
007170     EXIT.
007180 ATM-RTN.
007190     MOVE SPACE TO W-PT.
007200     MOVE NC"【　　総　合　計　　】　　　　　　　　　" TO P-TTM.
007210     IF LINAGE-COUNTER > 59
007220         PERFORM HED-RTN THRU HED-EX.
007230     MOVE SPACE TO SP-R.
007240     MOVE W-PT TO SP-R.
007250     WRITE SP-R.
007260     MOVE SPACE TO SP-R.
007270     MOVE 1 TO CHK4.
007280 ATM-EX.
007290     EXIT.
