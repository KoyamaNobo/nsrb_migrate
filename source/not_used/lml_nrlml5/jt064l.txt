000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         JT064L.
000030**************************************************
000040**************************************************
000050**                                              **
000060**     ëóÇËèÛî≠çsÅiÉtÉbÉgÉèÅ[ÉNÅj               **
000070**                                              **
000080**        USER  NAME : ì˙êiÉSÉÄ.                **
000090**        DATE       : 1994•02•05               **
000100**        TYPE       : COBOL                    **
000110**        PROGRAM-ID : JT064L                   **
000120**        SCREEN-ID  : ------.                  **
000130**        AUTHOR     : IKUMI.N                  **
000140**************************************************
000150**************************************************
000160 ENVIRONMENT         DIVISION.
000170 CONFIGURATION       SECTION.
000180 SOURCE-COMPUTER.    SYSTEM150.
000190 OBJECT-COMPUTER.    SYSTEM150.
000200 INPUT-OUTPUT        SECTION.
000210 FILE-CONTROL.
000220     COPY  LIBCSE.                                                I.981027
000230     SELECT  GDMM   ASSIGN  GDMM-MSD                              I.980317
000240                    ORGANIZATION  INDEXED                         I.980317
000250                    ACCESS  MODE  RANDOM                          I.980317
000260                    RECORD  KEY   GDMM-KEY                        I.980317
000270                    FILE  STATUS  ERR-STAT.                       I.980317
000280     SELECT  OKJF     ASSIGN  TO  F1-MSD                          ëóÇËèÛÇe
000290         ORGANIZATION         INDEXED
000300         ACCESS               DYNAMIC
000310         RECORD               OKJF-KEY
000320         FILE STATUS          IS  ERR-STAT.
000330     SELECT  TC-M     ASSIGN  TO  F2-MSD                          íºëóêÊÇl
000340         ORGANIZATION         INDEXED
000350         ACCESS               DYNAMIC
000360         RECORD               TC-KEY
000370         FILE STATUS          IS  ERR-STAT.
000380     SELECT  JCON     ASSIGN  TO  F3-MSD                          ÇbÇmÇsÇe
000390         ORGANIZATION         INDEXED
000400         ACCESS               DYNAMIC
000410         RECORD               JCON3-KEY
000420         FILE STATUS          IS  ERR-STAT.
000430     SELECT  P-F      ASSIGN  TO  P-PRN999.
000440 I-O-CONTROL.
000450     APPLY  SHARED-MODE  ON  OKJF  TC-M  JCON
000460                             GDMM                                 I.980317
000470                             M-DATE                               I.981027
000480     APPLY   SHIFT-CODE ON P-F.
000490*********************************************
000500**                                          *
000510**        DATA             DIVISION         *
000520**                                          *
000530*********************************************
000540 DATA                DIVISION.
000550 FILE                SECTION.
000560     COPY  LIBFDD.                                                I.981027
000570     COPY  L-GDMM.                                                I.980317
000580     COPY    LOKJF.
000590     COPY    L-JCON.
000600     COPY    LITCM.
000610*
000620 FD  P-F
000630     LABEL       RECORD  OMITTED
000640     LINAGE          IS       24.
000650 01  P-R                     PIC     X(136).
000660*
000670 01  P-R0.                                                        3 LINE
000680*****03  F                   PIC     X(18).                       D.980826
000690*****03  F                   PIC     X(17).                       D.950202
000700*****03  R0-C                PIC     X(01).                       D.950202
000710     03  F                   PIC     X(13).                       I.980826
000720*****03  R0-01               PIC        Z9.                       D.000106
000730     03  R0-01               PIC     9(02).                       I.000106
000740     03  F                   PIC     X(03).
000750     03  R0-02               PIC        Z9.                       MM
000760     03  F                   PIC     X(03).
000770     03  R0-03               PIC        Z9.                       DD
000780 01  P-R1.                                                        êlñº
000790     03  R1-15K              PIC     X(05).
000800*****03  F                   PIC     X(14).                       D.980826
000810     03  F                   PIC     X(09).                       I.980826
000820     03  R1-01               PIC     N(16).
000830*****03  F                   PIC     X(01).                       D.940223
000840*****03  R1-X                PIC     X(01).                       D.940223
000850*****03  F                   PIC     X(01).                       D.940223
000860     03  F                   PIC     X(03).                       I.940223
000870     03  R1-02               PIC     N(12).
000880 01  P-R2.
000890*****03  F                   PIC     X(16).                       D.980826
000900     03  F                   PIC     X(11).                       I.980826
000910     03  R2-01               PIC     N(14).
000920     03  F                   PIC     X(04).
000930     03  R2-02               PIC     N(12).
000940 01  P-R3.                                                        I.930607
000950*****03  F                   PIC     X(14).                       D.980826
000960     03  F                   PIC     X(09).                       I.980826
000970     03  R3-01               PIC     N(16).                       I.930607
000980     03  F                   PIC     X(03).                       I.930607
000990     03  R3-02               PIC     N(14).                       I.930607
001000 01  P-R4.                                                        10 LINE
001010*****03  F                   PIC     X(20).                       D.980826
001020     03  F                   PIC     X(15).                       I.980826
001030     03  R4-01               PIC     N(12).
001040     03  F                   PIC     X(06).
001050     03  R4-02               PIC     N(12).
001060 01  P-R5.                                                        16 LINE
001070*****03  F                   PIC     X(24).                       D.980826
001080*****03  R5-01               PIC     X(12).                       D.970130
001090*****03  F                   PIC     X(08).                       D.970130
001100*****03  R5-02               PIC     X(12).                       D.970130
001110     03  F                   PIC     X(19).                       I.980826
001120     03  R5-01               PIC     X(14).                       I.970130
001130     03  F                   PIC     X(06).                       I.970130
001140     03  R5-02               PIC     X(14).                       I.970130
001150 01  P-R6.                                                        17 LINE
001160     03  R6-20K              PIC     X(05).                       2.0 BYTE
001170*****03  F                   PIC     X(16).                       D.980826
001180     03  F                   PIC     X(11).                       I.980826
001190     03  R6-01               PIC     N(08).
001200 01  P-R7.                                                        18 19 L
001210*****03  F                   PIC     X(39).                       D.980826
001220     03  F                   PIC     X(34).                       I.980826
001230     03  R7-01               PIC     N(02).
001240     03  F                   PIC     X(20).                       I.960904
001250     03  R7-02               PIC    ZZ,ZZZ.                       I.960904
001260 01  P-R8.                                                        18 19 L
001270     03  R8-15K              PIC     X(05).
001280*****03  F                   PIC     X(16).                       D.980826
001290     03  F                   PIC     X(11).                       I.980826
001300     03  R8-01               PIC     N(12).
001310     03  F                   PIC     X(04).
001320     03  R8-02               PIC     X(02).
001330     03  R8-03               PIC     N(04).
001340     03  F                   PIC     X(18).
001350     03  R8-20K              PIC     X(05).
001360     03  R8-04               PIC     N(03).
001370 01  P-R9.                                                        20 LINE
001380*****03  F                   PIC     X(16).                       D.980826
001390     03  F                   PIC     X(11).                       I.980826
001400     03  R9-01               PIC     N(09).
001410     03  F                   PIC     X(03).
001420     03  R9-02               PIC     9(06).
001430     03  F                   PIC     X(01).                       I.950202
001440     03  R9-03               PIC     N(01).                       I.950202
001450*********************************************
001460**                                          *
001470**        WORKING  STORAGE  SECTION         *
001480**                                          *
001490*********************************************
001500 WORKING-STORAGE     SECTION.
001510 01  ERR-STAT        PIC X(02).                                   FILE ERR
001520 01  W-JS            PIC X(01).                                   91.09 A
001530 01  W-JS-MEI        PIC N(05).                                   91.09 A
001540 01  JS-SIGN         PIC X(01).
001550******************************
001560*     WORK         AREA      *
001570******************************
001580 01  WORK-AREA.
001590     03  ENDFLG        PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001600     03  ENDFLG2       PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001610     03  ACT1          PIC     9.                                 TEST
001620     03  ACT2          PIC     9.
001630     03  ACT3          PIC     9(06).                             áÇ
001640     03  ACTK          PIC     9(01).                             ∂∏∆›
001650     03  LCNT          PIC     9(02).                             ◊≤›∂≥›¿∞
001660     03  DSW           PIC     9(01).                             DATAóLñ≥
001670     03  DATE-WORK.
001680         05  YY        PIC     99.
001690         05  MM        PIC     99.
001700         05  DD        PIC     99.
001710     03  JSUX.
001720         05  JSU1      PIC     N(12).
001730         05  JSU2      PIC     N(12).
001740     03  NAMEX.
001750         05  N1        PIC     N(12).
001760         05  N2        PIC     N(12).
001770     03  KSU           PIC     ZZ9.
001780     03  KSUR      REDEFINES   KSU   PIC  X(03).
001790     03  W-NGP.                                                   I.981027
001800       04  F              PIC 9(02).                              I.981027
001810       04  W-NGPS         PIC 9(06).                              I.981027
001820     03  W-NGPL         REDEFINES  W-NGP.                         I.981027
001830       04  W-NEN          PIC 9(04).                              I.981027
001840       04  W-NENL       REDEFINES  W-NEN.                         I.981027
001850         05  W-NEN1       PIC 9(02).                              I.981027
001860         05  W-NEN2       PIC 9(02).                              I.981027
001870       04  F              PIC 9(04).                              I.981027
001880     03  W-SDATE          PIC 9(08).                              I.981027
001890     03  W-EDATE          PIC 9(08).                              I.981027
001900     03  W-SNGP.                                                  I.981027
001910       04  W-SNEN         PIC 9(04).                              I.981027
001920       04  W-SNENL      REDEFINES  W-SNEN.                        I.981027
001930         05  W-SNEN1      PIC 9(02).                              I.981027
001940         05  W-SNEN2      PIC 9(02).                              I.981027
001950       04  W-SGET         PIC 9(02).                              I.981027
001960       04  W-SPEY         PIC 9(02).                              I.981027
001970     03  W-ENGP.                                                  I.981027
001980       04  W-ENEN         PIC 9(04).                              I.981027
001990       04  W-ENENL      REDEFINES  W-ENEN.                        I.981027
002000         05  W-ENEN1      PIC 9(02).                              I.981027
002010         05  W-ENEN2      PIC 9(02).                              I.981027
002020       04  W-EGET         PIC 9(02).                              I.981027
002030       04  W-EPEY         PIC 9(02).                              I.981027
002040 01  SOM.                                                         ëqÅ@ñº
002050     03  F1        PIC     N(01)     VALUE    NC"Åi".
002060     03  F2        PIC     N(06).
002070     03  F3        PIC     N(01)     VALUE    NC"Åj".
002080 01  W-SOK             PIC  N(07).                                I.940720
002090     COPY    LWMSG.                                               COPYLIB.
002100*********************************************
002110**                                          *
002120**        SCREEN            SECTION         *
002130**                                          *
002140*********************************************
002150 SCREEN             SECTION.
002160 SD  CRT-X
002170     END  STATUS    IS   ESTAT.
002180 01  DISP-CLEAR.
002190     03  CLE-01     LINE   1     CLEAR  SCREEN.
002200******************************
002210*     DISPLAY      SECTION.  *
002220******************************
002230 01  DISP-AREA1.
002240     03  DSP-JS   LINE  1  COLUMN  1   PIC  N(05)  FROM W-JS-MEI. 91.09 A
002250     03  DSP-RVE  LINE  1  COLUMN  20  PIC  X(12)  VALUE
002260                                           " "  REVERSE.
002270     03  DISP-01  LINE  1  COLUMN  21  PIC  N(05)  VALUE
002280                                         NC"ëóÇËèÛî≠çs".
002290     03  DISP-02  LINE  3  COLUMN  11  PIC  N(06)  VALUE
002300                                           NC"ÉtÉbÉgÉèÅ[ÉN".
002310     03  DISP-02A LINE  3  COLUMN  26  PIC  N(07)  FROM  W-SOK.   I.940720
002320     03  DISP-03  LINE  6  COLUMN  13  PIC  N(09)  VALUE
002330                                 NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".
002340     03  DISP-04  LINE  6  COLUMN  32  PIC  X(12)  VALUE
002350                                       "(YES=1,NO=2)".
002360     03  DISP-05  LINE  9  COLUMN  13  PIC  N(06)  VALUE
002370                                       NC"ÇPÅDêVãKî≠çs".
002380     03  DISP-06  LINE 11  COLUMN  13  PIC  N(05)  VALUE
002390                                       NC"ÇQÅDçƒî≠çs".
002400     03  DISP-07  LINE 13  COLUMN  17  PIC  N(02)  VALUE
002410                                       NC"ëIë".
002420     03  DISP-08  LINE 13  COLUMN  22  PIC  X(03)  VALUE
002430                                       "[ ]".
002440     03  DISP-09  LINE 23  COLUMN  41  PIC  N(03)  VALUE
002450                                       NC"ämîFÅi".
002460     03  DISP-10  LINE 23  COLUMN  47  PIC  X(09)  VALUE
002470                                       "OK=1,NO=9".
002480     03  DISP-11  LINE 23  COLUMN  56  PIC  N(01)  VALUE
002490                                       NC"Åj".
002500     03  DISP-12  LINE 23  COLUMN  58  PIC  X(08)  VALUE
002510                                       "--> ÿ¿∞›".
002520 01  DISP-AREA2.
002530     03  DISP-21  LINE 16  COLUMN  15  PIC  X(09)  VALUE
002540                                       "ëóÇËèÛNO:".
002550     03  DSP-DATM.                                                I.981027
002560       04  LINE  15    COLUMN  31    VALUE  NC"ì˙Å@ït".           I.981027
002570       04  LINE  17.                                              I.981027
002580         05  COLUMN  21    VALUE  NC"ÇeÇqÇnÇl".                   I.981027
002590         05  COLUMN  31    VALUE  "  /  /  ".                     I.981027
002600       04  LINE  19.                                              I.981027
002610         05  COLUMN  21    VALUE  NC"ÇsÇn".                       I.981027
002620         05  COLUMN  31    VALUE  "  /  /  ".                     I.981027
002630 01  DISP-AREA3.
002640     03  DISP-22  LINE 24  COLUMN  01  PIC  N(09)  VALUE
002650                                       NC"äYìñÉfÅ[É^ñ≥".
002660******************************
002670*     ACCEPT       SECTION.  *
002680******************************
002690 01  ACT-AREA.
002700     03  ACT-01  LINE    6 COLUMN  46  PIC  9
002710                 INTO      ACT1      CHECK  OVERFLOW  NO IFC.
002720     03  ACT-02  LINE   13 COLUMN  23  PIC  9
002730                 INTO      ACT2      CHECK  OVERFLOW  NO IFC.
002740     03  ACT-03  LINE   16 COLUMN  24  PIC  9(06)
002750                 INTO      ACT3      CHECK  OVERFLOW  NO IFC.
002760     03  ACP-SNGP  LINE  17.                                      I.981027
002770       04  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981027
002780             USING  W-SNEN2  NO  IFC.                             I.981027
002790       04  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981027
002800             USING  W-SGET   NO  IFC.                             I.981027
002810       04  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981027
002820             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.            I.981027
002830     03  ACP-ENGP  LINE  19.                                      I.981027
002840       04  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981027
002850             USING  W-ENEN2  NO  IFC.                             I.981027
002860       04  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981027
002870             USING  W-EGET   NO  IFC.                             I.981027
002880       04  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981027
002890             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.            I.981027
002900     03  ACT-04  LINE   23 COLUMN  61  PIC  9(01)
002910                 INTO      ACTK      CHECK  OVERFLOW  NO IFC.
002920*
002930******************************
002940*     CLEAR        SECTION.  *
002950******************************
002960 01  CLR-AREA.
002970     03  CLR-01  LINE    6 COLUMN  46  PIC  X     VALUE   " ".
002980     03  CLR-02  LINE   13 COLUMN  23  PIC  X     VALUE   " ".
002990     03  CLR-03  LINE   16 COLUMN  24  PIC  X(06) VALUE   " ".
003000     03  CLR-04  LINE   23 COLUMN  61  PIC  X     VALUE   " ".
003010     03  CLR-05  LINE   16 COLUMN  15  PIC  X(15) VALUE   " ".
003020     03  CLR-DATM.                                                I.981027
003030       04  LINE  15    COLUMN  31    PIC X(06)    VALUE  " ".     I.981027
003040       04  LINE  17.                                              I.981027
003050         05  COLUMN  21    PIC X(08)    VALUE  " ".               I.981027
003060         05  COLUMN  31    PIC X(08)    VALUE  " ".               I.981027
003070       04  LINE  19.                                              I.981027
003080         05  COLUMN  21    PIC X(04)    VALUE  " ".               I.981027
003090         05  COLUMN  31    PIC X(08)    VALUE  " ".               I.981027
003100*
003110 01  DSP-GDMM.                                                    I.980317
003120     02  LINE  24  COLUMN   1  VALUE                              I.980317
003130         NC"ÅñÅñÉ_É~Å[ÇeÅ@Ç»Çµ".                                  I.980317
003140     COPY    LSMSG.                                               COPYLIB.
003150     COPY  LIBSCR.                                                I.981027
003160**
003170*********************************************
003180**                                          *
003190**        PROCEDURE        DIVISION         *
003200**                                          *
003210*********************************************
003220 PROCEDURE           DIVISION.
003230 MAIN-LOGIC.
003240     PERFORM   INITIAL-RTN  THRU  INITIAL-EXT.                    START
003250               PERFORM      MAIN-RTN  THRU  MAIN-EXT              PROCES
003260                            UNTIL     ENDFLG = "END".
003270                       PERFORM     END-RTN THRU    END-EX.        END
003280     STOP     RUN.
003290*********************************************
003300**                                          *
003310**        INITIAL            ROUTIN         *
003320**                                          *
003330*********************************************
003340 INITIAL-RTN.
003350     ACCEPT  JS-SIGN.
003360     ACCEPT  W-JS.                                                91.09 A
003370     IF  W-JS  =  ZERO                                            91.09 A
003380         MOVE  NC"Åkã≥Å@àÁÅl"    TO  W-JS-MEI.                    91.09 A
003390     IF  W-JS  =  1                                               91.09 A
003400         MOVE  NC"ÅkàÍÅ@î Ål"    TO  W-JS-MEI.                    91.09 A
003410     IF  JS-SIGN  =  0       MOVE  NC"Åoñ{é–ópÅpÅ@Å@"   TO  W-SOK.I.940720
003420*****IF  JS-SIGN  =  3       MOVE  NC"Åoì˙êiâªê¨ópÅp"   TO  W-SOK.D.950203
003430*****IF  JS-SIGN  =  5       MOVE  NC"Åoì˙êiâªê¨ópÅp"   TO  W-SOK.D.960417
003440*
003450     MOVE    SPACE      TO    WORK-AREA.
003460     INITIALIZE               WORK-AREA.
003470*
003480     DISPLAY  DISP-CLEAR.
003490     DISPLAY  DISP-AREA1.
003500     IF  JS-SIGN      =  4                                        I.980317
003510         OPEN  I-O      GDMM                                      I.980317
003520         MOVE  "0"      TO  GDMM-KEY                              I.980317
003530         READ  GDMM     INVALID  KEY                              I.980317
003540               CLOSE    GDMM                                      I.980317
003550               DISPLAY  DSP-GDMM   DISP-BUZ-B                     I.980317
003560               STOP  RUN.                                         I.980317
003570     COPY  LIBCPR.                                                I.981028
003580     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.981027
003590     OPEN     INPUT   TC-M  JCON.
003600     OPEN     I-O     OKJF.
003610     OPEN    OUTPUT   P-F.
003620 INITIAL-EXT.
003630     EXIT.
003640*********************************************
003650**                                          *
003660**        MAIN               ROUTIN         *
003670**                                          *
003680*********************************************
003690 MAIN-RTN.
003700 MAIN-10.                                                         TESTàÛéö
003710     ACCEPT    ACT-01.
003720     DISPLAY   DISP-MSG-SPACE.
003730              IF  ESTAT   =   "P9"                                PF9
003740                               MOVE  "END"  TO  ENDFLG
003750                               GO     TO        MAIN-EXT.
003760              IF  ESTAT   =   "01"  OR  "06"
003770                               NEXT   SENTENCE
003780                  ELSE
003790                               GO     TO  MAIN-10.
003800              IF  ACT1  NOT =   1  AND 2
003810                               GO     TO  MAIN-10.
003820              IF  ACT1      =   1
003830                        PERFORM    TEST-RTN    THRU    TEST-EXT
003840                        GO   TO    MAIN-10.
003850 MAIN-20.                                                         î≠çsëIë
003860     ACCEPT   ACT-02.
003870     DISPLAY  DISP-MSG-SPACE.
003880     IF  ESTAT = "09"
003890         GO  TO  MAIN-10.
003900     IF  ESTAT = "01"  OR  "06"
003910         NEXT  SENTENCE
003920       ELSE
003930         GO  TO  MAIN-20.
003940     IF  ACT2 NOT = 1  AND  2
003950         GO  TO  MAIN-20.
003960     IF  ACT2 = 2                                                 I.981027
003970         DISPLAY  CLR-DATM                                        I.981027
003980         GO  TO  MAIN-30.                                         I.981027
003990     DISPLAY  CLR-05  DSP-DATM  ACP-SNGP  ACP-ENGP.               I.981027
004000     IF  W-SNGP = ZERO                                            I.981027
004010         DISPLAY  DISP-22                                         I.981027
004020         GO  TO  MAIN-20.                                         I.981027
004030     GO  TO  MAIN-40.                                             I.981027
004040*****IF  ACT2 = 1                                                 D.981027
004050*****    DISPLAY  CLR-05                                          D.981027
004060*****    GO  TO  MAIN-40.                                         D.981027
004070 MAIN-30.                                                         áÇ
004080*****DISPLAY   DISP-AREA2.                                        D.981027
004090     DISPLAY   DISP-21.                                           I.981027
004100     ACCEPT    ACT-03.
004110     DISPLAY   DISP-MSG-SPACE.
004120              IF  ESTAT   =   "P9"                                PF9
004130                               MOVE  "END"  TO  ENDFLG
004140                               GO     TO        MAIN-EXT.
004150              IF  ESTAT   =   "09"
004160                               GO     TO  MAIN-20.
004170              IF  ESTAT   =   "01"  OR  "06"
004180*****                          NEXT   SENTENCE                    D.981027
004190                               GO     TO  MAIN-40                 I.981027
004200                  ELSE
004210                               GO     TO  MAIN-30.
004220 MAIN-32.                                                         I.981027
004230     ACCEPT  ACP-SNEN.                                            I.981027
004240     IF  ESTAT = "09"                                             I.981027
004250         GO  TO  MAIN-20.                                         I.981027
004260     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004270         GO  TO  MAIN-32.                                         I.981027
004280     MOVE  ZERO  TO  W-SNEN1.                                     I.981027
004290     IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
004300         ADD  DATE-NC1  TO  W-SNEN.                               I.981027
004310     IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
004320         ADD  DATE-NC2  TO  W-SNEN.                               I.981027
004330*****IF  W-SNEN2 > 90                                             D.981027
004340*****    ADD  1900  TO  W-SNEN                                    D.981027
004350*****  ELSE                                                       D.981027
004360*****    ADD  2000  TO  W-SNEN.                                   D.981027
004370 MAIN-33.                                                         I.981027
004380     ACCEPT  ACP-SGET.                                            I.981027
004390     IF  ESTAT = "09"                                             I.981027
004400         GO  TO  MAIN-32.                                         I.981027
004410     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004420         GO  TO  MAIN-33.                                         I.981027
004430     IF  W-SGET < 1  OR  > 12                                     I.981027
004440         GO  TO  MAIN-33.                                         I.981027
004450 MAIN-34.                                                         I.981027
004460     ACCEPT  ACP-SPEY.                                            I.981027
004470     IF  ESTAT = "09"                                             I.981027
004480         GO  TO  MAIN-33.                                         I.981027
004490     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004500         GO  TO  MAIN-34.                                         I.981027
004510     IF  W-SPEY < 1  OR  > 31                                     I.981027
004520         GO  TO  MAIN-34.                                         I.981027
004530     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981027
004540         GO  TO  MAIN-32.                                         I.981027
004550 MAIN-36.                                                         I.981027
004560     ACCEPT  ACP-ENEN.                                            I.981027
004570     IF  ESTAT = "09"                                             I.981027
004580         GO  TO  MAIN-34.                                         I.981027
004590     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004600         GO  TO  MAIN-36.                                         I.981027
004610     MOVE  ZERO  TO  W-ENEN1.                                     I.981027
004620     IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
004630         ADD  DATE-NC1  TO  W-ENEN.                               I.981027
004640     IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
004650         ADD  DATE-NC2  TO  W-ENEN.                               I.981027
004660*****IF  W-ENEN2 > 90                                             D.981027
004670*****    ADD  1900  TO  W-ENEN                                    D.981027
004680*****  ELSE                                                       D.981027
004690*****    ADD  2000  TO  W-ENEN.                                   I.981027
004700 MAIN-37.                                                         I.981027
004710     ACCEPT  ACP-EGET.                                            I.981027
004720     IF  ESTAT = "09"                                             I.981027
004730         GO  TO  MAIN-36.                                         I.981027
004740     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004750         GO  TO  MAIN-37.                                         I.981027
004760     IF  W-EGET < 1  OR  > 12                                     I.981027
004770         GO  TO  MAIN-37.                                         I.981027
004780 MAIN-38.                                                         I.981027
004790     ACCEPT  ACP-EPEY.                                            I.981027
004800     IF  ESTAT = "09"                                             I.981027
004810         GO  TO  MAIN-37.                                         I.981027
004820     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981027
004830         GO  TO  MAIN-38.                                         I.981027
004840     IF  W-EPEY < 1  OR  > 31                                     I.981027
004850         GO  TO  MAIN-38.                                         I.981027
004860     IF  W-SNGP > W-ENGP                                          I.981027
004870         GO  TO  MAIN-36.                                         I.981027
004880     IF  W-ENGP < W-SDATE  OR  > W-EDATE                          I.981027
004890         GO  TO  MAIN-36.                                         I.981027
004900 MAIN-40.                                                         ämÅ@îF
004910     ACCEPT    ACT-04.
004920     DISPLAY   DISP-MSG-SPACE.
004930              IF  ESTAT   =   "09"
004940                  IF  ACT2    =   1
004950*****                          GO     TO  MAIN-20                 D.981027
004960                               GO     TO  MAIN-32                 I.981027
004970                      ELSE
004980                               GO     TO  MAIN-30.
004990              IF  ESTAT   =   "01"  OR  "06"
005000                               NEXT   SENTENCE
005010                  ELSE
005020                               GO     TO  MAIN-40.
005030              IF  ACTK  NOT =   1  AND 9
005040                               GO     TO  MAIN-40.
005050*
005060              IF  ACTK      =   1
005070                        MOVE       ZERO         TO     DSW
005080                        PERFORM    PRINT-RTN    THRU   PRINT-EXT
005090                  ELSE
005100                        DISPLAY    CLR-05
005110                        DISPLAY    CLR-01
005120                        DISPLAY    CLR-02
005130                        DISPLAY    CLR-04
005140                        GO   TO    MAIN-10.
005150*****         IF  ACT2      =   1                                 D.951222
005160*****                   GO   TO    MAIN-20                        D.951222
005170*****             ELSE                                            D.951222
005180              IF  ACT2      =   2                                 I.951222
005190                        GO   TO    MAIN-30.
005200              IF  DSW       =   0                                 I.951222
005210                        GO   TO    MAIN-20.                       I.951222
005220              MOVE  "END"  TO  ENDFLG.                            I.951222
005230 MAIN-EXT.
005240     EXIT.
005250*********************************************
005260**                                          *
005270**        FAINAL             ROUTIN         *
005280**                                          *
005290*********************************************
005300 END-RTN.
005310     CLOSE     OKJF.
005320     CLOSE     TC-M.
005330     CLOSE     JCON.
005340     CLOSE     P-F.
005350     IF  JS-SIGN      =  4              CLOSE  GDMM.              I.980317
005360 END-EX.
005370     EXIT.
005380*********************************************
005390**                                          *
005400**        SUB    ROUTIN     SECTION         *
005410**                                          *
005420*********************************************
005430*
005440******************************
005450*     TEST         ROUTIN    *
005460******************************
005470 TEST-RTN.
005480     IF     LCNT  =  20
005490                  MOVE       ZERO     TO        LCNT
005500                  MOVE       SPACE    TO        P-R
005510                  WRITE      P-R      AFTER     PAGE.
005520*
005530     MOVE       99       TO  R0-01  R0-02  R0-03.
005540     WRITE      P-R      AFTER     2.
005550     MOVE       SPACE    TO        P-R.
005560*
005570     MOVE        ""3FE04F40A0""  TO               R1-15K.         1.5BYTE
005580     MOVE  ALL NC"Çm"    TO        R1-01   R1-02.
005590     WRITE      P-R      AFTER     3.
005600     MOVE       SPACE    TO        P-R.
005610*
005620     MOVE  ALL NC"Çm"    TO        R2-01  R2-02.
005630     WRITE      P-R      AFTER     1.
005640     MOVE       SPACE    TO        P-R.
005650*
005660     MOVE  ALL NC"Çm"    TO        R3-01  R3-02.
005670     WRITE      P-R      AFTER     2.
005680*
005690     WRITE      P-R      AFTER     1.
005700     MOVE       SPACE    TO        P-R.
005710*
005720     MOVE  ALL NC"Çm"    TO        R4-01  R4-02.
005730     WRITE      P-R      AFTER     1.
005740     MOVE       SPACE    TO        P-R.
005750*
005760     MOVE      ALL "X"   TO        R5-01  R5-02.
005770     WRITE      P-R      AFTER     3.
005780     MOVE       SPACE    TO        P-R.
005790*
005800     MOVE        ""3FE04FE080""  TO               R6-20K.         2.0BYTE
005810     MOVE  ALL NC"Çm"  TO        F2.
005820     MOVE       SOM      TO        R6-01.
005830     WRITE      P-R      AFTER     1.
005840     MOVE       SPACE    TO        P-R.
005850*
005860     MOVE  ALL NC"â◊ép"  TO        R7-01.
005870     MOVE    99999       TO        R7-02.                         I.960904
005880     WRITE      P-R      AFTER     1.
005890     MOVE       SPACE    TO        P-R.
005900*
005910     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
005920     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
005930     MOVE  NC"ínâ∫ÅEïzåCÅEí∑åCÅEÇªÇÃëº"  TO  R8-01.
005940     MOVE    "1."                     TO  R8-02.
005950     MOVE    NC"ÉPÅ[ÉXÅ@"             TO  R8-03.
005960     MOVE    SPACE                    TO  R8-04.
005970     WRITE      P-R      AFTER     1.
005980     MOVE       SPACE    TO        P-R.
005990*
006000     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
006010     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
006020     MOVE    SPACE                    TO  R8-01.
006030     MOVE    "2."                     TO  R8-02.
006040     MOVE    NC"éÜÅ@ïÔÅ@"             TO  R8-03.
006050     MOVE    SPACE                    TO  R8-04.
006060     WRITE      P-R      AFTER     1.
006070     MOVE       SPACE    TO        P-R.
006080*
006090     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
006100     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
006110     MOVE    SPACE                    TO  R8-01.
006120     MOVE    "3."                     TO  R8-02.
006130     MOVE    NC"ñÿÅ@î†Å@"             TO  R8-03.
006140     MOVE    NC"ÇXÇXÇX"               TO  R8-04.
006150     WRITE      P-R      AFTER     1.
006160     MOVE       SPACE    TO        P-R.
006170*
006180     MOVE  ALL NC"Çm"    TO        R9-01.
006190     MOVE  ALL  "9"      TO        R9-02.
006200     WRITE      P-R      AFTER     2.
006210     MOVE       SPACE    TO        P-R.
006220*
006230*
006240     MOVE       20       TO        LCNT.
006250 TEST-EXT.
006260     EXIT.
006270*********************************************
006280**                                          *
006290**        PRINT              ROUTIN         *
006300**                                          *
006310*********************************************
006320 PRINT-RTN.
006330     IF     LCNT  =  20
006340                  MOVE       ZERO     TO        LCNT
006350                  MOVE       SPACE    TO        P-R
006360                  WRITE      P-R      AFTER     PAGE.
006370*********  ñæ  ç◊  ïî  ********
006380     IF  ACT2      =   1                                          êVãKî≠çs
006390                   NEXT  SENTENCE
006400         ELSE
006410                   GO   TO    PRT-20.                             çƒî≠çs
006420 PRT-10.                                                          ëóÇËèÛÇe
006430     IF      ENDFLG2  =  "END"   GO   TO  PRT-15.
006440     READ    OKJF  NEXT          AT  END
006450                                 MOVE      "END"  TO  ENDFLG2
006460                                 GO  TO    PRT-15.
006470     IF      W-JS  =  ZERO                                        91.09 A
006480         IF      OKJF-09  NOT =  ZERO                             91.09 A
006490                      GO   TO  PRT-10.                            91.09 A
006500     IF      W-JS  =  1                                           91.09 A
006510         IF      OKJF-09  NOT =  1                                91.09 A
006520                      GO   TO  PRT-10.                            91.09 A
006530     IF      OKJF-08  =  1                                        àÛéöª≤›
006540                      GO   TO  PRT-10.
006550     IF      OKJF-02  NOT = 7                                     â^ëóã∆CD
006560                      GO   TO  PRT-10.
006570     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
006580                         NEXT   SENTENCE
006590             ELSE
006600                         GO  TO  PRT-10.
006610     IF      JS-SIGN  =  0
006620             IF  OKJF-04    =    2  OR  3  OR  5  OR  6  OR  7    I.980116
006630                                               GO  TO  PRT-10.    I.980116
006640*****    IF  OKJF-04    =    2 OR 3 OR 5 OR 6  GO  TO  PRT-10.    D.980116
006650*****    IF  OKJF-04    =    2 OR 3 OR 5 OR 6 OR 7 GO  TO  PRT-10.D.960417
006660     IF      JS-SIGN  =  1
006670             IF   OKJF-04    NOT =  2  AND  3  GO  TO  PRT-10.
006680     IF      JS-SIGN  =  2
006690             IF   OKJF-04    NOT =  5  AND  6  GO  TO  PRT-10.    *R 92/05
006700     IF      JS-SIGN  =  3                                        I.940720
006710             IF   OKJF-04    NOT =  2  AND  3  AND  5  AND  6     I.950203
006720                                               GO  TO  PRT-10.    I.950203
006730     IF      JS-SIGN  =  4                                        I.980116
006740             IF   OKJF-04    NOT =  7          GO  TO  PRT-10.    I.980116
006750*****IF      JS-SIGN  =  5                                        D.960417
006760*****        IF   OKJF-04    NOT =  7          GO  TO  PRT-10.    D.960417
006770     MOVE  ZERO     TO  W-NGP.                                    I.981027
006780     MOVE  OKJF-03  TO  W-NGPS.                                   I.981027
006790     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     I.981027
006800         ADD  DATE-NC1  TO  W-NEN.                                I.981027
006810     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     I.981027
006820         ADD  DATE-NC2  TO  W-NEN.                                I.981027
006830*****IF  W-NEN2 > 90                                              D.981028
006840*****    ADD  1900  TO  W-NEN                                     D.981028
006850*****  ELSE                                                       D.981028
006860*****    ADD  2000  TO  W-NEN.                                    D.981028
006870     IF  W-NGP < W-SNGP  OR  > W-ENGP                             I.981027
006880         GO  TO  PRT-10.                                          I.981027
006890     GO  TO  PRT-30.
006900 PRT-15.
006910     IF      DSW  =  ZERO
006920                         DISPLAY    DISP-AREA3
006930                         GO   TO    PRINT-EXT
006940             ELSE
006950                         GO   TO    PRINT-EXT.
006960 PRT-20.
006970     MOVE    ACT3     TO  OKJF-01.
006980     READ    OKJF                   INVALID
006990                         DISPLAY    DISP-AREA3
007000                         GO   TO    PRINT-EXT.
007010     IF      OKJF-02  NOT = 7                                     â^ëóã∆CD
007020                         DISPLAY    DISP-AREA3
007030                         GO   TO    PRINT-EXT.
007040     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
007050                         NEXT   SENTENCE
007060             ELSE
007070                         DISPLAY    DISP-AREA3
007080                         GO   TO    PRINT-EXT.
007090     IF      W-JS  =  ZERO                                        91.09 A
007100         IF      OKJF-09  NOT =  ZERO                                :
007110                         DISPLAY    DISP-AREA3                       :
007120                         GO   TO    PRINT-EXT.                       :
007130     IF      W-JS  =  1                                              :
007140         IF      OKJF-09  NOT =  1                                   :
007150                         DISPLAY    DISP-AREA3                       :
007160                         GO   TO    PRINT-EXT.                    91.09 A
007170     IF      JS-SIGN  =  0
007180*****        IF       OKJF-04    =     2  OR  3  OR  5  OR  6     D.980116
007190*****        IF       OKJF-04    =     2  OR  3  OR  5  OR  6 OR 7D.960417
007200             IF       OKJF-04    =  2  OR  3  OR  5  OR  6  OR  7 I.980116
007210                         DISPLAY    DISP-AREA3
007220                         GO   TO    PRINT-EXT.
007230     IF      JS-SIGN  =  1
007240             IF       OKJF-04    NOT =  2  AND  3
007250                         DISPLAY    DISP-AREA3
007260                         GO   TO    PRINT-EXT.
007270     IF      JS-SIGN  =  2
007280             IF       OKJF-04    NOT =  5  AND  6                 *R 92/05
007290                         DISPLAY    DISP-AREA3
007300                         GO   TO    PRINT-EXT.
007310     IF      JS-SIGN  =  3                                        I.940720
007320             IF       OKJF-04    NOT =  2  AND  3  AND  5  AND  6 I.950203
007330                         DISPLAY    DISP-AREA3                    I.950203
007340                         GO   TO    PRINT-EXT.                    I.950203
007350     IF      JS-SIGN  =  4                                        I.980116
007360             IF       OKJF-04    NOT =  7                         I.980116
007370                         DISPLAY    DISP-AREA3                    I.980116
007380                         GO   TO    PRINT-EXT.                    I.980116
007390*****IF      JS-SIGN  =  5                                        D.960417
007400*****        IF       OKJF-04    NOT =  7                         D.960417
007410*****                    DISPLAY    DISP-AREA3                    D.960417
007420*****                    GO   TO    PRINT-EXT.                    D.960417
007430 PRT-30.                                                          íºëóêÊÇl
007440     MOVE    OKJF-05  TO  TC-KEY.
007450     READ    TC-M        UNLOCK     INVALID
007460                         MOVE       SPACE  TO  TC-R
007470                         INITIALIZE            TC-R.
007480 PRT-40.                                                          ÇbÇmÇsÇe
007490     MOVE    3        TO  JCON3-01.
007500     MOVE    OKJF-04  TO  JCON3-02.
007510     READ    JCON        UNLOCK     INVALID
007520                         MOVE       SPACE  TO  JCON3-R
007530                         INITIALIZE            JCON3-R.
007540     MOVE       1        TO  DSW.                                 DATAóLñ≥
007550 PRT-50.
007560*
007570*
007580*****IF    ACT2       =  2         MOVE  "#"     TO  R0-C.        D.950202
007590     MOVE       OKJF-03  TO  DATE-WORK.
007600     MOVE       YY       TO  R0-01.
007610     MOVE       MM       TO  R0-02.
007620     MOVE       DD       TO  R0-03.
007630     WRITE      P-R      AFTER     2.
007640     MOVE       SPACE    TO        P-R.
007650*
007660     MOVE        ""3FE04F40A0""  TO               R1-15K.         D.930607
007670     MOVE       SPACE    TO        R1-01  R1-02.                  D.930607
007680*****IF    ACT2       =  2         MOVE  "#"     TO  R1-X.        D.940223
007690     MOVE       TC-NAME  TO        NAMEX.
007700     MOVE       N1       TO        R1-01.                         I.930607
007710     IF    TC-STK     =  5                                        I.971013
007720           MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–"   TO  R1-02.                I.971013
007730     WRITE      P-R      AFTER     3.
007740     MOVE       SPACE    TO        P-R.
007750*
007760     MOVE       SPACE    TO        R2-01  R2-02.                  D.930607
007770     MOVE       N2       TO        R2-01.
007780     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
007790          MOVE  NC"äîéÆâÔé–è„éRõâã∆"   TO  R2-02                  I.930607
007800     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
007810                MOVE  NC"äîéÆâÔé–ÉEÉGÉÑÉ}"   TO  R2-02            I.930607
007820           ELSE  IF    TC-STK     =  5                            I.971013
007830                       MOVE  NC"Å@ÉîÉBÉîÉFÉìÉfÉBéñã∆ïî" TO R1-02  I.971013
007840                  ELSE MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–"   TO  R2-02.    I.930607
007850     WRITE      P-R      AFTER     1.
007860     MOVE       SPACE    TO        P-R.
007870*
007880     MOVE       SPACE    TO        R3-01  R3-02.                  D.930607
007890     MOVE       TC-JSU   TO        JSUX.
007900     MOVE       JSU1     TO        R3-01.
007910     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
007920           OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
007930                MOVE  NC"ï∫å…åßêºã{ésÅ@Å@Å@Å@Å@Å@"   TO  R3-02
007940     ELSE       MOVE  NC"â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇU"   TO  R3-02.
007950     WRITE      P-R      AFTER     2.
007960     MOVE       SPACE    TO        P-R.
007970*
007980     MOVE       SPACE    TO        R3-01  R3-02.                  D.930607
007990     MOVE       JSU2     TO        R3-01.
008000     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
008010           OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
008020*****           MOVE  NC"Å@Å@îÛÉmå˚í¨ÇPÅ|ÇPÇQÅ|ÇQ"   TO  R3-02.   D.940809
008030                MOVE  NC"Å@Å@Å@Å@çÇñÿìåí¨ÇPÇTÅ|ÇP"   TO  R3-02.   I.940809
008040     WRITE      P-R      AFTER     1.
008050     MOVE       SPACE    TO        P-R.
008060*
008070     MOVE       SPACE    TO        R4-01.
008080     MOVE  TC-JSS        TO        R4-01.
008090     WRITE      P-R      AFTER     1.
008100     MOVE       SPACE    TO        P-R.
008110*
008120     MOVE       TC-TEL   TO        R5-01.
008130     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
008140*****      OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     D.940809
008150*****           MOVE    "0798-64-5111"    TO     R5-02            D.970130
008160                MOVE    "0798-64-5111  "  TO     R5-02            I.970130
008170     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     I.940809
008180*****           MOVE    "0798-67-0810"    TO     R5-02            D.970130
008190*****ELSE       MOVE    "086-252-2456"    TO     R5-02.           D.970130
008200                MOVE    "0798-67-0810  "  TO     R5-02            I.970130
008210     ELSE       MOVE    "086-252-2456  "  TO     R5-02.           I.970130
008220     WRITE      P-R      AFTER     3.
008230     MOVE       SPACE    TO        P-R.
008240*
008250     MOVE        ""3FE04FE080""  TO               R6-20K.         2.0BYTE
008260     MOVE       JCON3-03 TO        F2.
008270     MOVE       SOM      TO        R6-01.
008280     WRITE      P-R      AFTER     1.
008290     MOVE       SPACE    TO        P-R.
008300*
008310     MOVE      NC"â◊ép"  TO        R7-01.
008320     MOVE       OKJF-11  TO        R7-02.                         I.960904
008330     WRITE      P-R      AFTER     1.
008340     MOVE       SPACE    TO        P-R.
008350*
008360     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
008370     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
008380     MOVE  NC"ínâ∫ÅEïzåCÅEí∑åCÅEÇªÇÃëº"  TO  R8-01.
008390     MOVE    "1."        TO        R8-02.
008400     MOVE    NC"ÉPÅ[ÉXÅ@" TO        R8-03.
008410     MOVE    SPACE       TO        R8-04.
008420     WRITE      P-R      AFTER     1.
008430     MOVE       SPACE    TO        P-R.
008440*
008450     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
008460     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
008470     MOVE    SPACE                    TO  R8-01.
008480     MOVE    "2."                     TO  R8-02.
008490     MOVE    NC"éÜÅ@ïÔÅ@"             TO  R8-03.
008500     MOVE    SPACE       TO        R8-04.
008510     WRITE      P-R      AFTER     1.
008520     MOVE       SPACE    TO        P-R.
008530*
008540     MOVE        ""3FE04F40A0""  TO               R8-15K.         1.5BYTE
008550     MOVE        ""3FE04FE080""  TO               R8-20K.         2.0BYTE
008560     IF  TC-STK     NOT  =  0                                     I.971007
008570         MOVE  NC"Åyí îÃÅzÅ@Å@Å@Å@Å@Å@Å@Å@"  TO  R8-01            I.971007
008580     ELSE                                                         I.971007
008590         MOVE    SPACE                    TO  R8-01.
008600     MOVE    "3."                     TO  R8-02.
008610     MOVE    NC"ñÿÅ@î†Å@"             TO  R8-03.
008620     MOVE       OKJF-07  TO        KSU.                           I.930420
008630     MOVE       KSUR     TO        R8-04.                         I.930420
008640     WRITE      P-R      AFTER     1.
008650     MOVE       SPACE    TO        P-R.
008660*
008670     MOVE  OKJF-06       TO        R9-01.
008680     MOVE       OKJF-01  TO        R9-02.
008690     IF    ACT2       =  2         MOVE  NC"çƒ"     TO  R9-03.    I.950202
008700     WRITE      P-R      AFTER     2.
008710     MOVE       SPACE    TO        P-R.
008720*
008730     MOVE       20       TO        LCNT.
008740*
008750*
008760 PRT-60.
008770     MOVE          1     TO        OKJF-08.
008780     REWRITE  OKJF-R  INVALID
008790              MOVE    "OKJF"     TO    ERR-F
008800              MOVE    "R"        TO    ERR-M
008810              MOVE     OKJF-KEY  TO    ERR-K
008820              PERFORM  ERR-RTN   THRU  ERR-EX.
008830     IF       ACT2  =  1         GO    TO    PRINT-RTN.
008840 PRINT-EXT.
008850     EXIT.
008860 SEL-RTN.                                                         I.981027
008870     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981027
008880     OPEN  INPUT  OKJF.                                           I.981027
008890 SEL-010.                                                         I.981027
008900     READ  OKJF  NEXT  RECORD  AT  END                            I.981027
008910         GO  TO  SEL-090.                                         I.981027
008920     IF  W-JS = ZERO                                              I.981027
008930         IF  OKJF-09 NOT = ZERO                                   I.981027
008940             GO  TO  SEL-010.                                     I.981027
008950     IF  W-JS = 1                                                 I.981027
008960         IF  OKJF-09 NOT = 1                                      I.981027
008970             GO  TO  SEL-010.                                     I.981027
008980     IF  OKJF-08 = 1                                              I.981027
008990         GO  TO  SEL-010.                                         I.981027
009000     IF  OKJF-02 NOT = 7                                          I.981027
009010         GO  TO  SEL-010.                                         I.981027
009020     IF  (OKJF-07 > ZERO)  AND  (OKJF-10 = 1)                     I.981027
009030         NEXT  SENTENCE                                           I.981027
009040       ELSE                                                       I.981027
009050         GO  TO  SEL-010.                                         I.981027
009060     IF  JS-SIGN = 0                                              I.981027
009070         IF  OKJF-04 = 2  OR  3  OR  5  OR  6                     I.981027
009080             GO  TO  SEL-010.                                     I.981027
009090     IF  JS-SIGN = 1                                              I.981027
009100         IF  OKJF-04 NOT = 2  AND  3                              I.981027
009110             GO  TO  SEL-010.                                     I.981027
009120     IF  JS-SIGN = 2                                              I.981027
009130         IF  OKJF-04 NOT = 5  AND  6                              I.981027
009140             GO  TO  SEL-010.                                     I.981027
009150     IF  JS-SIGN = 3                                              I.981027
009160         IF  OKJF-04 NOT = 2  AND  3  AND  5  AND  6              I.981027
009170             GO  TO  SEL-010.                                     I.981027
009180     MOVE  ZERO     TO  W-NGP.                                    I.981027
009190     MOVE  OKJF-03  TO  W-NGPS.                                   I.981027
009200     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     I.981027
009210         ADD  DATE-NC1  TO  W-NEN.                                I.981027
009220     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     I.981027
009230         ADD  DATE-NC2  TO  W-NEN.                                I.981027
009240*****IF  W-NEN2 > 90                                              D.981027
009250*****    ADD  1900  TO  W-NEN                                     D.981027
009260*****  ELSE                                                       D.981027
009270*****    ADD  2000  TO  W-NEN.                                    I.981027
009280     IF  W-SDATE = ZERO                                           I.981027
009290         MOVE  W-NGP  TO  W-SDATE.                                I.981027
009300     IF  W-SDATE > W-NGP                                          I.981027
009310         MOVE  W-NGP  TO  W-SDATE.                                I.981027
009320     IF  W-EDATE < W-NGP                                          I.981027
009330         MOVE  W-NGP  TO  W-EDATE.                                I.981027
009340     GO  TO  SEL-010.                                             I.981027
009350 SEL-090.                                                         I.981027
009360     CLOSE  OKJF.                                                 I.981027
009370     MOVE  W-SDATE  TO  W-SNGP.                                   I.981027
009380     MOVE  W-EDATE  TO  W-ENGP.                                   I.981027
009390 SEL-EX.                                                          I.981027
009400     EXIT.                                                        I.981027
009410     COPY    LPMSG.                                               COPYLIB.
009420*********************  ÇoÇqÇnÇfÇqÇ`ÇlÅ@Å@ÇdÇmÇcÅ@*************************
