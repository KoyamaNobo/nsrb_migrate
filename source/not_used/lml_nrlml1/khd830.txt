000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHD830.
000030***********************************************************
000040*    PROGRAM         :  防振予定実績対比日報              *
000050*    PRINTER TYPE    :  JIPS                              *
000060*    SCREEN          :  ******                            *
000070*    COMPILE TYPE    :  COBOL                             *
000080***********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160*****SELECT KKB-M ASSIGN TO KKB-MSD                               D.021016
000170*****    ORGANIZATION INDEXED                                     D.021016
000180*****    ACCESS MODE RANDOM                                       D.021016
000190*****    RECORD KEY KKB-KEY                                       D.021016
000200*****    FILE STATUS IS ERR-STAT.                                 D.021016
000210     SELECT KH-M ASSIGN TO KH-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE DYNAMIC
000240         RECORD KEY KH-KEY
000250         FILE STATUS IS ERR-STAT.
000260     SELECT KUK-F ASSIGN TO KUK-MSD.
000270     SELECT SP-F ASSIGN TO P-PRN999.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON M-DATE
000300*****APPLY SHARED-MODE ON KKB-M                                   D.021016
000310     APPLY SHARED-MODE ON KH-M
000320     APPLY SHIFT-CODE  ON SP-F.
000330 DATA DIVISION.
000340 FILE SECTION.
000350     COPY LIBFDD.
000360*****COPY LIKKBM.                                                 D.021016
000370     COPY LIKHM.
000380     COPY LSPF.
000390 FD  KUK-F
000400*****BLOCK  4 RECORDS                                             D.021016
000410     BLOCK  2 RECORDS                                             I.021016
000420     LABEL RECORD STANDARD
000430     VALUE OF IDENTIFICATION WK0128ID.                            I.021016
000440*****VALUE OF IDENTIFICATION WK0064ID.                            D.021016
000450 01  KUK-R.
000460     02  KUK-HCD        PIC  X(005).
000470     02  KUK-YD.
000480       03  KUK-STS      PIC S9(006).
000490       03  KUK-KYS      PIC S9(006).
000500     02  KUK-GD.
000510       03  KUK-GSS      PIC S9(006).
000520       03  KUK-GSK      PIC S9(008).                              I.021016
000530       03  KUK-GKS      PIC S9(006).
000540       03  KUK-GKK      PIC S9(008).                              I.021016
000550       03  KUK-GIS      PIC S9(006).                              I.021016
000560       03  KUK-GIK      PIC S9(008).                              I.021016
000570       03  KUK-GHS      PIC S9(005).                              I.021016
000580       03  KUK-GHK      PIC S9(007).                              I.021016
000590       03  KUK-PSS      PIC S9(005).                              I.021016
000600       03  KUK-PSK      PIC S9(007).                              I.021016
000610       03  KUK-PKS      PIC S9(005).                              I.021016
000620       03  KUK-PKK      PIC S9(007).                              I.021016
000630       03  KUK-PIS      PIC S9(005).                              I.021016
000640       03  KUK-PIK      PIC S9(007).                              I.021016
000650       03  KUK-PHS      PIC S9(004).                              I.021016
000660       03  KUK-PHK      PIC S9(006).                              I.021016
000670*****  03  KUK-GHS      PIC S9(006).                              D.021016
000680*****  03  KUK-PSS      PIC S9(006).                              D.021016
000690*****  03  KUK-PKS      PIC S9(006).                              D.021016
000700     02  KUK-ZSU        PIC S9(006).
000710     02  KUK-KIS        PIC  9(001).
000720     02  KUK-PEY        PIC  9(002).
000730     02  F              PIC  X(002).                              I.021016
000740*****02  F              PIC  X(008).                              D.021016
000750 WORKING-STORAGE SECTION.
000760*77  JS-SIGN            PIC  9(001).                              D.021016
000770*77  WK0064ID           PIC  X(009) VALUE SPACE.                  D.021016
000780 77  WK0128ID           PIC  X(009) VALUE SPACE.                  I.021016
000790 01  STN-NO.
000800     02  STN-NO1        PIC  X(003).
000810     02  STN-NO2        PIC  X(003).
000820 01  W-FID.
000830*****02  W-FID1         PIC  X(006) VALUE "WK0064".               D.021016
000840     02  W-FID1         PIC  X(006) VALUE "WK0128".               I.021016
000850     02  W-FID2         PIC  X(003).
000860 01  HEAD1.
000870     02  F              PIC  X(005) VALUE ""3FE04FE080"".         I.021016
000880     02  F              PIC  X(038) VALUE SPACE.                  I.021016
000890     02  F              PIC  N(022) VALUE                         I.021016
000900          NC"＊＊＊　　防振　予定・実績対比日報　　＊＊＊".       I.021016
000910     02  F              PIC  X(010) VALUE SPACE.                  I.021016
000920     02  F              PIC  N(002) VALUE NC"（　".               I.021016
000930     02  H-PEY          PIC Z9.                                   I.021016
000940     02  F              PIC  N(005) VALUE NC"日現在　）".         I.021016
000950     02  F              PIC  X(005) VALUE SPACE.                  I.021016
000960     02  F              PIC  X(005) VALUE "DATE ".                I.021016
000970     02  H-DATE         PIC 99B99B99.                             I.021016
000980     02  F              PIC  X(07) VALUE "     P.".               I.021016
000990     02  H-PAGE         PIC Z9.                                   I.021016
001000*****02  F              PIC  X(007) VALUE SPACE.                  D.021016
001010*****02  HEAD11.                                                  D.021016
001020*****  03  F            PIC  X(005) VALUE ""3FE04FE080"".         D.021016
001030*****  03  H-KIS        PIC  N(006) VALUE SPACE.                  D.021016
001040*****  03  F            PIC  X(022) VALUE SPACE.                  D.021016
001050*****  03  F            PIC  N(021) VALUE                         D.021016
001060*****       NC"＊＊＊　　加硫　予定・実績対比表　　＊＊＊".       D.021016
001070*****  03  F            PIC  X(010) VALUE SPACE.                  D.021016
001080*****  03  F            PIC  N(002) VALUE NC"（　".               D.021016
001090*****  03  H-PEY        PIC Z9.                                   D.021016
001100*****  03  F            PIC  N(005) VALUE NC"日現在　）".         D.021016
001110*****  03  F            PIC  X(005) VALUE SPACE.                  D.021016
001120*****  03  F            PIC  X(005) VALUE "DATE ".                D.021016
001130*****  03  H-DATE       PIC 99B99B99.                             D.021016
001140*****  03  F            PIC  X(07) VALUE "     P.".               D.021016
001150*****  03  H-PAGE       PIC Z9.                                   D.021016
001160 01  HEAD2.
001170     02  F              PIC  X(005) VALUE ""3FE04F40A0"".         I.021016
001180     02  F              PIC  X(123) VALUE SPACE.                  I.021016
001190     02  F              PIC  X(003) VALUE "( )".                  I.021016
001200     02  F              PIC  N(006) VALUE NC"内は当日分　".       I.021016
001210*****02  F              PIC  X(007) VALUE SPACE.                  D.021016
001220*****02  HEAD21.                                                  D.021016
001230*****  03  F            PIC  X(026) VALUE SPACE.                  D.021016
001240*****  03  F            PIC  X(029) VALUE                         D.021016
001250*****       "I-------   予　定   -------I ".                      D.021016
001260*****  03  F            PIC  X(049) VALUE                         D.021016
001270*****       "I-----------------   実　績   ------------------I".  D.021016
001280*****  03  F              PIC  X(025) VALUE SPACE.                D.021016
001290 01  HEAD3.
001300     03  F              PIC  X(006) VALUE " ｺｰﾄﾞ ".               I.021016
001310     03  F              PIC  N(006) VALUE NC"品　　　名　".       I.021016
001320     03  F              PIC  X(013) VALUE SPACE.                  I.021016
001330     03  F              PIC  N(004) VALUE NC"　出荷数".           I.021016
001340     03  F              PIC  X(005) VALUE SPACE.                  I.021016
001350     03  F              PIC  N(004) VALUE NC"出荷金額".           I.021016
001360     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001370     03  F              PIC  N(004) VALUE NC"　加硫数".           I.021016
001380     03  F              PIC  X(005) VALUE SPACE.                  I.021016
001390     03  F              PIC  N(004) VALUE NC"加硫金額".           I.021016
001400     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001410     03  F              PIC  N(004) VALUE NC"　仕入数".           I.021016
001420     03  F              PIC  X(005) VALUE SPACE.                  I.021016
001430     03  F              PIC  N(004) VALUE NC"仕入金額".           I.021016
001440     03  F              PIC  N(004) VALUE NC"　不良数".           I.021016
001450     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001460     03  F              PIC  N(004) VALUE NC"不良金額".           I.021016
001470     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001480     03  F              PIC  N(004) VALUE NC"　手配数".           I.021016
001490     03  F              PIC  X(005) VALUE SPACE.                  I.021016
001500     03  F              PIC  N(004) VALUE NC"手配金額".           I.021016
001510     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001520     03  F              PIC  N(004) VALUE NC"入庫予定".           I.021016
001530     03  F              PIC  X(002) VALUE SPACE.                  I.021016
001540     03  F              PIC  N(006) VALUE NC"入庫予定金額".       I.021016
001550 01  HEAD4.                                                       I.021016
001560     02  F              PIC  X(017) VALUE SPACE.                  I.021016
001570     02  F              PIC  N(006) VALUE NC"　前月繰越数".       I.021016
001580     02  F              PIC  X(074) VALUE SPACE.                  I.021016
001590     02  F              PIC  N(004) VALUE NC"　在庫数".           I.021016
001600     02  F              PIC  X(001) VALUE SPACE.                  I.021016
001610     02  F              PIC  N(004) VALUE NC"　達成率".           I.021016
001620     02  F              PIC  X(006) VALUE "% ﾘｰﾄﾞ".               I.021016
001630     02  F              PIC  N(002) VALUE NC"日数".               I.021016
001640     02  F              PIC  X(013) VALUE SPACE.                  I.021016
001650     02  F              PIC  X(005) VALUE ""3FE04FE080"".         I.021016
001660*****02  F              PIC  X(005) VALUE ""3FE04F40A0"".         D.021016
001670*****02  F              PIC  N(002) VALUE NC"機種".               D.021016
001680*****02  F              PIC  X(004) VALUE SPACE.                  D.021016
001690*****02  HEAD31.                                                  D.021016
001700*****  03  F            PIC  X(005) VALUE ""3FE04F40A0"".         D.021016
001710*****  03  F            PIC  X(006) VALUE " ｺｰﾄﾞ ".               D.021016
001720*****  03  F            PIC  N(006) VALUE NC"品　　　名　".       D.021016
001730*****  03  F            PIC  X(012) VALUE SPACE.                  D.021016
001740*****  03  F            PIC  N(006) VALUE NC"　出荷手配数".       D.021016
001750*****  03  F            PIC  X(004) VALUE SPACE.                  D.021016
001760*****  03  F            PIC  N(004) VALUE NC"　加硫数".           D.021016
001770*****  03  F            PIC  X(006) VALUE "  ｼｮｯﾄ".               D.021016
001780*****  03  F            PIC  N(002) VALUE NC"数　".               D.021016
001790*****  03  F            PIC  X(004) VALUE SPACE.                  D.021016
001800*****  03  F            PIC  N(004) VALUE NC"　出荷数".           D.021016
001810*****  03  F            PIC  X(003) VALUE "(  ".                  D.021016
001820*****  03  F            PIC  N(004) VALUE NC"当日出荷".           D.021016
001830*****  03  F            PIC  X(005) VALUE ")    ".                D.021016
001840*****  03  F            PIC  N(004) VALUE NC"　加硫数".           D.021016
001850*****  03  F            PIC  X(003) VALUE "(  ".                  D.021016
001860*****  03  F            PIC  N(004) VALUE NC"当日加硫".           D.021016
001870*****  03  F            PIC  X(002) VALUE ") ".                   D.021016
001880*****  03  F            PIC  X(002) VALUE SPACE.                  D.021016
001890*****  03  F            PIC  N(004) VALUE NC"　不良数".           D.021016
001900*****  03  F            PIC  X(002) VALUE SPACE.                  D.021016
001910*****  03  F            PIC  N(002) VALUE NC"達成".               D.021016
001920*****  03  F            PIC  X(005) VALUE "%    ".                D.021016
001930*****  03  F            PIC  N(004) VALUE NC"　繰越数".           D.021016
001940*****  03  F            PIC  X(006) VALUE "  ﾘｰﾄﾞ".               D.021016
001950*****  03  F            PIC  N(002) VALUE NC"日数".               D.021016
001960*01  W-P.                                                         D.021016
001970*****02  P-KSN1         PIC  X(006).                              D.021016
001980*****02  F              PIC  X(001).                              D.021016
001990*****02  W-PD.                                                    D.021016
002000*****  03  P-HCD        PIC  X(005).                              D.021016
002010*****  03  F            PIC  X(001).                              D.021016
002020*****  03  P-NAME       PIC  X(020).                              D.021016
002030*****  03  P-STS        PIC --,---,--9.                           D.021016
002040*****  03  P-KYS        PIC --,---,--9.                           D.021016
002050*****  03  P-YSS        PIC ----,--9.                             D.021016
002060*****  03  P-GSS        PIC ---,---,--9.                          D.021016
002070*****  03  P-F1         PIC  X(001).                              D.021016
002080*****  03  P-PSS        PIC ----,--9.                             D.021016
002090*****  03  P-R1         PIC  X(001).                              D.021016
002100*****  03  P-GKS        PIC --,---,--9.                           D.021016
002110*****  03  P-F2         PIC  X(001).                              D.021016
002120*****  03  P-PKS        PIC ----,--9.                             D.021016
002130*****  03  P-R2         PIC  X(001).                              D.021016
002140*****  03  P-GHS        PIC -----,--9.                            D.021016
002150*****  03  P-TR         PIC -----9.                               D.021016
002160*****  03  P-ZSU        PIC --,---,--9.                           D.021016
002170*****  03  P-RT         PIC ---,--9.9.                            D.021016
002180 01  W-P1.                                                        I.021016
002190     02  P-HCD          PIC  X(005).                              I.021016
002200     02  F              PIC  X(001).                              I.021016
002210     02  P-NAME         PIC  X(020).                              I.021016
002220     02  P-GSS          PIC ----,--9.                             I.021016
002230     02  P-GSK          PIC ---,---,--9.                          I.021016
002240     02  P-GKS          PIC ----,--9.                             I.021016
002250     02  P-GKK          PIC ---,---,--9.                          I.021016
002260     02  P-GIS          PIC ----,--9.                             I.021016
002270     02  P-GIK          PIC ---,---,--9.                          I.021016
002280     02  P-GHS          PIC -----9.                               I.021016
002290     02  P-GHK          PIC ----,--9.                             I.021016
002300     02  P-STS          PIC ----,--9.                             I.021016
002310     02  P-STK          PIC ---,---,--9.                          I.021016
002320     02  P-KYS          PIC ----,--9.                             I.021016
002330     02  P-KYK          PIC ---,---,--9.                          I.021016
002340 01  W-P2.                                                        I.021016
002350     02  F              PIC  X(018).                              I.021016
002360     02  P-ZKS          PIC ----,--9.                             I.021016
002370     02  P-F1           PIC  X(001).                              I.021016
002380     02  P-PSS          PIC ---,--9.                              I.021016
002390     02  P-R1           PIC  X(001).                              I.021016
002400     02  P-F2           PIC  X(001).                              I.021016
002410     02  P-PSK          PIC -----,--9.                            I.021016
002420     02  P-R2           PIC  X(001).                              I.021016
002430     02  P-F3           PIC  X(001).                              I.021016
002440     02  P-PKS          PIC --,--9.                               I.021016
002450     02  P-PKSD  REDEFINES P-PKS  PIC ZZ,ZZ9.                     I.021016
002460     02  P-R3           PIC  X(001).                              I.021016
002470     02  P-F4           PIC  X(001).                              I.021016
002480     02  P-PKK          PIC -----,--9.                            I.021016
002490     02  P-R4           PIC  X(001).                              I.021016
002500     02  P-F5           PIC  X(001).                              I.021016
002510     02  P-PIS          PIC --,--9.                               I.021016
002520     02  P-PISD  REDEFINES P-PIS  PIC ZZ,ZZ9.                     I.021016
002530     02  P-R5           PIC  X(001).                              I.021016
002540     02  P-F6           PIC  X(001).                              I.021016
002550     02  P-PIK          PIC -----,--9.                            I.021016
002560     02  P-R6           PIC  X(001).                              I.021016
002570     02  P-F7           PIC  X(001).                              I.021016
002580     02  P-PHS          PIC ---9.                                 I.021016
002590     02  P-PHSD  REDEFINES P-PHS  PIC ZZZ9.                       I.021016
002600     02  P-R7           PIC  X(001).                              I.021016
002610     02  P-F8           PIC  X(001).                              I.021016
002620     02  P-PHK          PIC --,--9.                               I.021016
002630     02  P-PHKD  REDEFINES P-PHK  PIC ZZ,ZZ9.                     I.021016
002640     02  P-R8           PIC  X(001).                              I.021016
002650     02  P-ZSU          PIC ----,--9.                             I.021016
002660     02  P-TR           PIC ----9.99.                             I.021016
002670     02  P-RT           PIC ----9.99.                             I.021016
002680     02  F              PIC  X(012).                              I.021016
002690 01  W-DATA.
002700     02  W-HCD          PIC  X(005).                              I.021016
002710     02  W-D.
002720*****  03  W-YSS        PIC S9(006).                              D.021016
002730       03  W-GSS        PIC S9(006).                              I.021016
002740       03  W-GSK        PIC S9(008).                              I.021016
002750       03  W-GKS        PIC S9(006).                              I.021016
002760       03  W-GKK        PIC S9(008).                              I.021016
002770       03  W-GIS        PIC S9(006).                              I.021016
002780       03  W-GIK        PIC S9(008).                              I.021016
002790       03  W-GHS        PIC S9(005).                              I.021016
002800       03  W-GHK        PIC S9(006).                              I.021016
002810       03  W-STS        PIC S9(006).                              I.021016
002820       03  W-STK        PIC S9(008).                              I.021016
002830       03  W-KYS        PIC S9(006).                              I.021016
002840       03  W-KYK        PIC S9(008).                              I.021016
002850       03  W-ZKS        PIC S9(006).                              I.021016
002860       03  W-PSS        PIC S9(005).                              I.021016
002870       03  W-PSK        PIC S9(007).                              I.021016
002880       03  W-PKS        PIC S9(005).                              I.021016
002890       03  W-PKK        PIC S9(007).                              I.021016
002900       03  W-PIS        PIC S9(005).                              I.021016
002910       03  W-PIK        PIC S9(007).                              I.021016
002920       03  W-PHS        PIC S9(004).                              I.021016
002930       03  W-PHK        PIC S9(006).                              I.021016
002940       03  W-ZSU        PIC S9(006).
002950       03  W-RT         PIC S9(004)V9(02).                        I.021016
002960       03  W-TR         PIC S9(004)V9(02).                        I.021016
002970*****  03  W-RT         PIC S9(004)V9(01).                        D.021016
002980*****  03  W-TR         PIC S9(003).                              D.021016
002990     02  W-DMM          PIC  9(001).
003000     02  W-NS           PIC S9(006).                              I.021016
003010*****02  W-KIS          PIC  9(001).                              D.021016
003020     02  CHK            PIC  9(001) VALUE 0.
003030     02  W-ALL          PIC S9(006)V9(04).
003040     02  W-PAGE         PIC  9(002) VALUE ZERO.
003050*01  WS-D.                                                        D.021016
003060*****02  WS-STS         PIC S9(007).                              D.021016
003070*****02  WS-KYS         PIC S9(007).                              D.021016
003080*****02  WS-YSS         PIC S9(006).                              D.021016
003090*****02  WS-GSS         PIC S9(007).                              D.021016
003100*****02  WS-GKS         PIC S9(007).                              D.021016
003110*****02  WS-GHS         PIC S9(006).                              D.021016
003120*****02  WS-ZSU         PIC S9(007).                              D.021016
003130*****02  WS-PSS         PIC S9(006).                              D.021016
003140*****02  WS-PKS         PIC S9(006).                              D.021016
003150 01  WA-D.
003160     03  WA-GSK         PIC S9(008).                              I.021016
003170     03  WA-GKK         PIC S9(008).                              I.021016
003180     03  WA-GIK         PIC S9(008).                              I.021016
003190     03  WA-GHK         PIC S9(006).                              I.021016
003200     03  WA-PSK         PIC S9(008).                              I.021016
003210     03  WA-PKK         PIC S9(008).                              I.021016
003220     03  WA-PIK         PIC S9(008).                              I.021016
003230     03  WA-PHK         PIC S9(006).                              I.021016
003240     03  WA-STK         PIC S9(008).                              I.021016
003250     03  WA-KYK         PIC S9(008).                              I.021016
003260*****02  WA-STS         PIC S9(007).                              D.021016
003270*****02  WA-KYS         PIC S9(007).                              D.021016
003280*****02  WA-YSS         PIC S9(006).                              D.021016
003290*****02  WA-GSS         PIC S9(007).                              D.021016
003300*****02  WA-GKS         PIC S9(007).                              D.021016
003310*****02  WA-GHS         PIC S9(006).                              D.021016
003320*****02  WA-ZSU         PIC S9(007).                              D.021016
003330*****02  WA-PSS         PIC S9(006).                              D.021016
003340*****02  WA-PKS         PIC S9(006).                              D.021016
003350 01  ERR-STAT           PIC  X(002).
003360*****COPY LSTAT.                                                  D.021016
003370 SCREEN SECTION.
003380 SD  C-CRT
003390     END STATUS IS ESTAT.
003400 01  C-CLEAR.
003410     02  C-CL    LINE   1  CLEAR SCREEN.
003420 01  C-MID.
003430*****02  LINE   3  COLUMN  10  PIC  N(020) VALUE                  D.021016
003440*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           D.021016
003450*****02  LINE   4  COLUMN  10  PIC  N(020) VALUE                  D.021016
003460*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           D.021016
003470*****02  LINE   5  COLUMN  10  PIC  N(020) VALUE                  D.021016
003480*****     NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           D.021016
003490*****02  LINE   6  COLUMN  10  PIC  N(020) VALUE                  D.021016
003500*****     NC"＊＊＊　　加硫予定・実績対比表　　＊＊＊".           D.021016
003510*****02  LINE   7  COLUMN  10  PIC  N(020) VALUE                  D.021016
003520*****     NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           D.021016
003530*****02  LINE   8  COLUMN  10  PIC  N(020) VALUE                  D.021016
003540*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           D.021016
003550*****02  LINE   9  COLUMN  10  PIC  N(020) VALUE                  D.021016
003560*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           D.021016
003570*****02  LINE  20  COLUMN  19  PIC  X(022) VALUE                  D.021016
003580*****     "確認  OK=1 NO=9   ﾘﾀｰﾝ".                               D.021016
003590     02  LINE   3  COLUMN  10  PIC  N(021) VALUE                  I.021016
003600          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         I.021016
003610     02  LINE   4  COLUMN  10  PIC  N(021) VALUE                  I.021016
003620          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         I.021016
003630     02  LINE   5  COLUMN  10  PIC  N(021) VALUE                  I.021016
003640          NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".         I.021016
003650     02  LINE   6  COLUMN  10  PIC  N(021) VALUE                  I.021016
003660          NC"＊＊＊　　防振予定・実績対比日報　　＊＊＊".         I.021016
003670     02  LINE   7  COLUMN  10  PIC  N(021) VALUE                  I.021016
003680          NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".         I.021016
003690     02  LINE   8  COLUMN  10  PIC  N(021) VALUE                  I.021016
003700          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         I.021016
003710     02  LINE   9  COLUMN  10  PIC  N(021) VALUE                  I.021016
003720          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         I.021016
003730*01  C-ACP.                                                       I.021016
003740*****02  A-DMM   LINE  20  COLUMN  36  PIC  9(001)                D.021016
003750*****     USING W-DMM   CHECK OVERFLOW NO IFC.                    D.021016
003760*01  C-DSP.                                                       D.021016
003770*****02  D-KIS   LINE   7  COLUMN  24  PIC N(006) FROM  H-KIS.    D.021016
003780     COPY LIBSCR.
003790 PROCEDURE DIVISION.
003800 M-05.
003810*****ACCEPT JS-SIGN.                                              D.021016
003820*****IF JS-SIGN NOT = 0 AND 1 AND 2                               D.980203
003830*****IF JS-SIGN NOT = 0 AND 1                                     D.021016
003840*****    STOP RUN.                                                D.021016
003850*****IF JS-SIGN = 1                                               D.980203
003860*****    MOVE NC"【Ｌ．Ｐ】　" TO H-KIS.                          D.980203
003870*****IF JS-SIGN = 2                                               D.980203
003880*****    MOVE NC"【ＬＴＩ他】" TO H-KIS.                          D.980203
003890*****DISPLAY C-CLEAR.                                             D.021016
003900*****DISPLAY C-MID.                                               D.021016
003910*****DISPLAY D-KIS.                                               D.980203
003920*****IF JS-SIGN = 0                                               I.021016
003930*****    MOVE 1 TO W-DMM                                          D.021016
003940*****    DISPLAY A-DMM                                            D.021016
003950*****    GO TO M-07.                                              D.021016
003960*M-06.                                                            D.021016
003970*****ACCEPT A-DMM.                                                D.021016
003980*****IF ESTAT = PF9                                               D.021016
003990*****    DISPLAY C-CLEAR                                          D.021016
004000*****    STOP RUN.                                                D.021016
004010*****IF ESTAT NOT = HTB AND SKP                                   D.021016
004020*****    GO TO M-06.                                              D.021016
004030*****IF W-DMM = 9                                                 D.021016
004040*****    DISPLAY C-CLEAR                                          D.021016
004050*****    STOP RUN.                                                D.021016
004060*****IF W-DMM NOT = 1                                             D.021016
004070*****    GO TO M-06.                                              D.021016
004080*M-07.                                                            D.021016
004090     DISPLAY C-CLEAR.
004100     DISPLAY C-MID.
004110*****DISPLAY A-DMM.                                               D.021016
004120     COPY LIBCPR.
004130     MOVE DATE-03R TO H-DATE.
004140     CALL "CBLSTNNO" USING STN-NO.
004150     MOVE STN-NO2 TO W-FID2.
004160     MOVE W-FID TO WK0128ID.                                      I.021016
004170*****MOVE W-FID TO WK0064ID.                                      D.021016
004180     OPEN INPUT KUK-F.
004190     OPEN INPUT KH-M.                                             I.021016
004200*M-08.                                                            D.021016
004210     READ KUK-F AT END
004220         GO TO M-95.                                              I.021016
004230*****    CLOSE KUK-F                                              D.021016
004240*****    DISPLAY C-CLEAR                                          D.021016
004250*****    STOP RUN.                                                D.021016
004260*****MOVE ZERO TO W-D.                                            D.021016
004270*****COMPUTE W-ZSU = KUK-ZSU + KUK-GKS - KUK-GSS - KUK-GHS.       D.021016
004280*****IF ZERO = KUK-STS AND KUK-KYS AND KUK-GSS AND KUK-GKS AND    D.021016
004290*****          KUK-GHS AND KUK-PSS AND KUK-PKS AND W-ZSU          D.021016
004300*****    GO TO M-08.                                              D.021016
004310*****IF JS-SIGN = 1                                               D.980203
004320*****    IF KUK-KIS > 1                                           D.980203
004330*****        GO TO M-08.                                          D.980203
004340*****IF JS-SIGN = 2                                               D.980203
004350*****    IF KUK-KIS < 2                                           D.980203
004360*****        GO TO M-08.                                          D.980203
004370*
004380*****IF JS-SIGN = 0                                               D.021016
004390*****    OPEN INPUT KKB-M.                                        D.021016
004400*****OPEN INPUT KH-M.                                             D.021016
004410*****OPEN OUTPUT SP-F.                                            D.021016
004420*****MOVE DATE-03R TO H-DATE.                                     D.021016
004430     MOVE KUK-PEY TO H-PEY.
004440     MOVE ZERO TO WA-D.
004450*****PERFORM S-10 THRU S-15.                                      D.021016
004460*M-09.                                                            D.021016
004470*****IF JS-SIGN NOT = 0                                           D.021016
004480*****    GO TO M-10.                                              D.021016
004490*****MOVE ZERO TO WS-D CHK.                                       D.021016
004500*****MOVE KUK-KIS TO W-KIS.                                       D.021016
004510*****MOVE SPACE TO KKB-KEY.                                       D.021016
004520*****MOVE 02 TO KKB-NO.                                           D.021016
004530*****MOVE W-KIS TO KKB-KS1.                                       D.021016
004540*****READ KKB-M WITH UNLOCK INVALID KEY                           D.021016
004550*****    MOVE "***** " TO KKB-KSN1.                               D.021016
004560 M-10.
004570     MOVE KUK-HCD TO W-HCD.                                       I.021016
004580     MOVE ZERO TO W-D.                                            I.021016
004590     MOVE KUK-HCD TO KH-KEY.
004600     READ KH-M WITH UNLOCK INVALID KEY
004610         MOVE "   **  KHM ﾅｼ  **   " TO KH-NAME
004620         MOVE ZERO TO KH-T1.                                      I.021016
004630*****    MOVE ZERO TO KH-TRS.                                     D.021016
004640*****IF KH-TRS NOT = ZERO                                         D.021016
004650*****    IF KUK-KYS NOT = ZERO                                    D.021016
004660*****        COMPUTE W-YSS = (KUK-KYS / KH-TRS) + 0.999.          D.021016
004670*****IF KUK-GKS = ZERO                                            D.021016
004680*****    GO TO M-15.                                              D.021016
004690*****IF KUK-KYS NOT = ZERO                                        D.021016
004700*****    COMPUTE W-TR = (KUK-GKS * 100) / KUK-KYS                 D.021016
004710*****    GO TO M-15.                                              D.021016
004720*****IF KUK-GKS > ZERO                                            D.021016
004730*****    MOVE 100 TO W-TR                                         D.021016
004740*****  ELSE                                                       D.021016
004750*****    MOVE -100 TO W-TR.                                       D.021016
004760 M-15.
004770     ADD KUK-GSS TO W-GSS.                                        I.021016
004780     ADD KUK-GSK TO W-GSK.                                        I.021016
004790     ADD KUK-GKS TO W-GKS.                                        I.021016
004800     ADD KUK-GKK TO W-GKK.                                        I.021016
004810     ADD KUK-GIS TO W-GIS.                                        I.021016
004820     ADD KUK-GIK TO W-GIK.                                        I.021016
004830     ADD KUK-GHS TO W-GHS.                                        I.021016
004840     ADD KUK-GHK TO W-GHK.                                        I.021016
004850     ADD KUK-STS TO W-STS.                                        I.021016
004860     COMPUTE W-STK = W-STS * KH-T1.                               I.021016
004870     ADD KUK-KYS TO W-KYS.                                        I.021016
004880     COMPUTE W-KYK = W-KYS * KH-T1.                               I.021016
004890     ADD KUK-ZSU TO W-ZKS.                                        I.021016
004900     ADD KUK-PSS TO W-PSS.                                        I.021016
004910     ADD KUK-PSK TO W-PSK.                                        I.021016
004920     ADD KUK-PKS TO W-PKS.                                        I.021016
004930     ADD KUK-PKK TO W-PKK.                                        I.021016
004940     ADD KUK-PIS TO W-PIS.                                        I.021016
004950     ADD KUK-PIK TO W-PIK.                                        I.021016
004960     ADD KUK-PHS TO W-PHS.                                        I.021016
004970     ADD KUK-PHK TO W-PHK.                                        I.021016
004980     COMPUTE W-ZSU = W-ZKS - W-GSS + W-GKS + W-GIS - W-GHS.       I.021016
004990*****MOVE ZERO TO W-RT.                                           D.021016
005000*****IF W-ZSU NOT = ZERO                                          D.021016
005010*****    IF KUK-STS > ZERO                                        D.021016
005020*****        COMPUTE W-RT ROUNDED = W-ZSU / (KUK-STS / 20).       D.021016
005030*
005040*****MOVE SPACE TO W-P.                                           D.021016
005050*****IF JS-SIGN = 0                                               D.021016
005060*****    IF CHK = 0                                               D.021016
005070*****        MOVE 5 TO CHK                                        D.021016
005080*****        MOVE KKB-KSN1 TO P-KSN1.                             D.021016
005090*****MOVE KUK-HCD TO P-HCD.                                       D.021016
005100*****MOVE KH-NAME TO P-NAME.                                      D.021016
005110*****MOVE KUK-STS TO P-STS.                                       D.021016
005120*****MOVE KUK-KYS TO P-KYS.                                       D.021016
005130*****MOVE W-YSS TO P-YSS.                                         D.021016
005140*****MOVE KUK-GSS TO P-GSS.                                       D.021016
005150*****MOVE KUK-GKS TO P-GKS.                                       D.021016
005160*****MOVE "(" TO P-F1 P-F2.                                       D.021016
005170*****MOVE ")" TO P-R1 P-R2.                                       D.021016
005180*****MOVE KUK-PSS TO P-PSS.                                       D.021016
005190*****MOVE KUK-PKS TO P-PKS.                                       D.021016
005200*****MOVE KUK-GHS TO P-GHS.                                       D.021016
005210*****MOVE W-TR TO P-TR.                                           D.021016
005220*****MOVE W-ZSU TO P-ZSU.                                         D.021016
005230*****MOVE W-RT TO P-RT.                                           D.021016
005240*****IF LINAGE-COUNTER < 61                                       D.021016
005250*****    GO TO M-16.                                              D.021016
005260*****PERFORM S-05 THRU S-15.                                      D.021016
005270*****IF JS-SIGN = 0                                               D.021016
005280*****    MOVE KKB-KSN1 TO P-KSN1.                                 D.021016
005290*M-16.                                                            D.021016
005300*****MOVE SPACE TO SP-R.                                          D.021016
005310*****IF JS-SIGN = 0                                               D.021016
005320*****    MOVE W-P TO SP-R                                         D.021016
005330*****  ELSE                                                       D.021016
005340*****    MOVE W-PD TO SP-R.                                       D.021016
005350*****WRITE SP-R.                                                  D.021016
005360*****MOVE SPACE TO SP-R.                                          D.021016
005370*
005380*****ADD KUK-STS TO WA-STS.                                       D.021016
005390*****ADD KUK-KYS TO WA-KYS.                                       D.021016
005400*****ADD W-YSS TO WA-YSS.                                         D.021016
005410*****ADD KUK-GSS TO WA-GSS.                                       D.021016
005420*****ADD KUK-GKS TO WA-GKS.                                       D.021016
005430*****ADD KUK-PSS TO WA-PSS.                                       D.021016
005440*****ADD KUK-PKS TO WA-PKS.                                       D.021016
005450*****ADD KUK-GHS TO WA-GHS.                                       D.021016
005460*****ADD W-ZSU TO WA-ZSU.                                         D.021016
005470*****IF JS-SIGN = 0                                               D.021016
005480*****    ADD KUK-STS TO WS-STS                                    D.021016
005490*****    ADD KUK-KYS TO WS-KYS                                    D.021016
005500*****    ADD W-YSS TO WS-YSS                                      D.021016
005510*****    ADD KUK-GSS TO WS-GSS                                    D.021016
005520*****    ADD KUK-GKS TO WS-GKS                                    D.021016
005530*****    ADD KUK-PSS TO WS-PSS                                    D.021016
005540*****    ADD KUK-PKS TO WS-PKS                                    D.021016
005550*****    ADD KUK-GHS TO WS-GHS                                    D.021016
005560*****    ADD W-ZSU TO WS-ZSU.                                     D.021016
005570 M-20.
005580     READ KUK-F AT END
005590         GO TO M-80.
005600     IF KUK-HCD = W-HCD                                           I.021016
005610         GO TO M-15.                                              I.021016
005620     PERFORM S-20 THRU S-25.                                      I.021016
005630     GO TO M-10.                                                  I.021016
005640*****MOVE ZERO TO W-D.                                            D.021016
005650*****COMPUTE W-ZSU = KUK-ZSU + KUK-GKS - KUK-GSS - KUK-GHS.       D.021016
005660*****IF ZERO = KUK-STS AND KUK-KYS AND KUK-GSS AND KUK-GKS AND    D.021016
005670*****          KUK-GHS AND KUK-PSS AND KUK-PKS AND W-ZSU          D.021016
005680*****    GO TO M-20.                                              D.021016
005690*****IF JS-SIGN = 1                                               D.980203
005700*****    IF KUK-KIS > 1                                           D.980203
005710*****        GO TO M-20.                                          D.980203
005720*****IF JS-SIGN = 2                                               D.980203
005730*****    IF KUK-KIS < 2                                           D.980203
005740*****        GO TO M-20.                                          D.980203
005750*****IF JS-SIGN NOT = 0                                           D.021016
005760*****    GO TO M-10.                                              D.021016
005770*****IF KUK-KIS = W-KIS                                           D.021016
005780*****    GO TO M-10.                                              D.021016
005790*****PERFORM S-16 THRU S-18.                                      D.021016
005800*****GO TO M-09.                                                  D.021016
005810 M-80.
005820     PERFORM S-20 THRU S-25.                                      I.021016
005830*****IF JS-SIGN = 0                                               D.021016
005840*****    PERFORM S-16 THRU S-18.                                  D.021016
005850     PERFORM S-30 THRU S-35.
005860 M-95.
005870*****IF JS-SIGN = 0                                               D.021016
005880*****    CLOSE KKB-M.                                             D.021016
005890     CLOSE KH-M.
005900     CLOSE KUK-F.
005910     IF W-PAGE NOT = ZERO                                         I.021016
005920         CLOSE SP-F.
005930     DISPLAY C-CLEAR.
005940     STOP RUN.
005950 S-05.
005960     MOVE SPACE TO SP-R.
005970     WRITE SP-R AFTER PAGE.
005980 S-10.
005990     ADD 1 TO W-PAGE.
006000     MOVE W-PAGE TO H-PAGE.
006010     MOVE SPACE TO SP-R.
006020     MOVE HEAD1 TO SP-R.                                          I.021016
006030*****IF JS-SIGN = 0                                               D.021016
006040*****    MOVE HEAD1 TO SP-R                                       D.021016
006050*****  ELSE                                                       D.021016
006060*****    MOVE HEAD11 TO SP-R.                                     D.021016
006070     WRITE SP-R.
006080     MOVE SPACE TO SP-R.
006090     MOVE HEAD2 TO SP-R.                                          I.021016
006100     WRITE SP-R.                                                  I.021016
006110*****IF JS-SIGN = 0                                               D.021016
006120*****    MOVE HEAD2 TO SP-R                                       D.021016
006130*****  ELSE                                                       D.021016
006140*****    MOVE HEAD21 TO SP-R.                                     D.021016
006150*****WRITE SP-R AFTER 2.                                          D.021016
006160     MOVE SPACE TO SP-R.
006170     MOVE HEAD3 TO SP-R.                                          I.021016
006180*****IF JS-SIGN = 0                                               D.021016
006190*****    MOVE HEAD3 TO SP-R                                       D.021016
006200*****  ELSE                                                       D.021016
006210*****    MOVE HEAD31 TO SP-R.                                     D.021016
006220     WRITE SP-R.
006230     MOVE SPACE TO SP-R.
006240     MOVE HEAD4 TO SP-R.                                          I.021016
006250     WRITE SP-R.                                                  I.021016
006260     MOVE SPACE TO SP-R.                                          I.021016
006270     WRITE SP-R.                                                  I.021016
006280 S-15.
006290     EXIT.
006300*S-16.                                                            D.021016
006310*****MOVE ZERO TO W-TR.                                           D.021016
006320*****IF WS-GKS = ZERO                                             D.021016
006330*****    GO TO S-17.                                              D.021016
006340*****IF WS-KYS NOT = ZERO                                         D.021016
006350*****    COMPUTE W-TR = (WS-GKS * 100) / WS-KYS                   D.021016
006360*****    GO TO S-17.                                              D.021016
006370*****IF WS-GKS > ZERO                                             D.021016
006380*****    MOVE 100 TO W-TR                                         D.021016
006390*****  ELSE                                                       D.021016
006400*****    MOVE -100 TO W-TR.                                       D.021016
006410*S-17.                                                            D.021016
006420*****MOVE SPACE TO W-P.                                           D.021016
006430*****MOVE "    <  SUB TOTAL  > " TO P-NAME.                       D.021016
006440*****MOVE WS-STS TO P-STS.                                        D.021016
006450*****MOVE WS-KYS TO P-KYS.                                        D.021016
006460*****MOVE WS-YSS TO P-YSS.                                        D.021016
006470*****MOVE WS-GSS TO P-GSS.                                        D.021016
006480*****MOVE WS-GKS TO P-GKS.                                        D.021016
006490*****MOVE "(" TO P-F1 P-F2.                                       D.021016
006500*****MOVE ")" TO P-R1 P-R2.                                       D.021016
006510*****MOVE WS-PSS TO P-PSS.                                        D.021016
006520*****MOVE WS-PKS TO P-PKS.                                        D.021016
006530*****MOVE WS-GHS  TO P-GHS.                                       D.021016
006540*****MOVE W-TR TO P-TR.                                           D.021016
006550*****MOVE WS-ZSU TO P-ZSU.                                        D.021016
006560*****IF LINAGE-COUNTER > 60                                       D.021016
006570*****    MOVE KKB-KSN1 TO P-KSN1                                  D.021016
006580*****    PERFORM S-05 THRU S-15.                                  D.021016
006590*****MOVE SPACE TO SP-R.                                          D.021016
006600*****MOVE W-P TO SP-R.                                            D.021016
006610*****WRITE SP-R.                                                  D.021016
006620*****MOVE SPACE TO SP-R.                                          D.021016
006630*****WRITE SP-R.                                                  D.021016
006640*S-18.                                                            D.021016
006650*****EXIT.                                                        D.021016
006660 S-20.                                                            I.021016
006670     IF ZERO = W-GSS AND W-GSK AND W-GKS AND W-GKK AND W-GIS AND  I.021016
006680               W-GIK AND W-GHS AND W-GHK AND W-STS AND W-STK AND  I.021016
006690               W-KYS AND W-KYK AND W-ZKS AND W-PSS AND W-PSK AND  I.021016
006700               W-PKS AND W-PKK AND W-PIS AND W-PIK AND W-PHS AND  I.021016
006710               W-PHK AND W-ZSU                                    I.021016
006720         GO TO S-25.                                              I.021016
006730     IF W-PAGE = ZERO                                             I.021016
006740         OPEN OUTPUT SP-F                                         I.021016
006750         PERFORM S-10 THRU S-15.                                  I.021016
006760*
006770     COMPUTE W-NS = W-GKS + W-GIS - W-GHS.                        I.021016
006780     IF W-KYS NOT = ZERO                                          I.021016
006790         IF W-NS > ZERO                                           I.021016
006800             COMPUTE W-ALL = (W-NS * 100) / W-KYS                 I.021016
006810             COMPUTE W-TR ROUNDED = W-ALL * 1.                    I.021016
006820     IF W-ZSU NOT = ZERO                                          I.021016
006830         IF W-STS > ZERO                                          I.021016
006840             COMPUTE W-ALL ROUNDED = W-ZSU / (W-STS / 20)         I.021016
006850             COMPUTE W-RT ROUNDED = W-ALL * 1.                    I.021016
006860*
006870     MOVE SPACE TO W-P1 W-P2.                                     I.021016
006880*****MOVE KUK-HCD TO P-HCD.                                       D.030111
006890     MOVE W-HCD TO P-HCD.                                         I.030111
006900     MOVE KH-NAME TO P-NAME.                                      I.021016
006910     MOVE W-GSS TO P-GSS.                                         I.021016
006920     MOVE W-GSK TO P-GSK.                                         I.021016
006930     MOVE W-GKS TO P-GKS.                                         I.021016
006940     MOVE W-GKK TO P-GKK.                                         I.021016
006950     MOVE W-GIS TO P-GIS.                                         I.021016
006960     MOVE W-GIK TO P-GIK.                                         I.021016
006970     MOVE W-GHS TO P-GHS.                                         I.021016
006980     MOVE W-GHK TO P-GHK.                                         I.021016
006990     MOVE W-STS TO P-STS.                                         I.021016
007000     MOVE W-STK TO P-STK.                                         I.021016
007010     MOVE W-KYS TO P-KYS.                                         I.021016
007020     MOVE W-KYK TO P-KYK.                                         I.021016
007030     MOVE "(" TO P-F1 P-F2 P-F3 P-F4 P-F5 P-F6 P-F7 P-F8.         I.021016
007040     MOVE ")" TO P-R1 P-R2 P-R3 P-R4 P-R5 P-R6 P-R7 P-R8.         I.021016
007050     MOVE W-ZKS TO P-ZKS.                                         I.021016
007060     MOVE W-PSS TO P-PSS.                                         I.021016
007070     MOVE W-PSK TO P-PSK.                                         I.021016
007080     IF W-PKS < ZERO                                              I.021016
007090         MOVE W-PKS TO P-PKS                                      I.021016
007100       ELSE                                                       I.021016
007110         MOVE W-PKS TO P-PKSD.                                    I.021016
007120     MOVE W-PKK TO P-PKK.                                         I.021016
007130     IF W-PIS < ZERO                                              I.021016
007140         MOVE W-PIS TO P-PIS                                      I.021016
007150       ELSE                                                       I.021016
007160         MOVE W-PIS TO P-PISD.                                    I.021016
007170     MOVE W-PIK TO P-PIK.                                         I.021016
007180     IF W-PHS < ZERO                                              I.021016
007190         MOVE W-PHS TO P-PHS                                      I.021016
007200       ELSE                                                       I.021016
007210         MOVE W-PHS TO P-PHSD.                                    I.021016
007220     IF W-PHK < ZERO                                              I.021016
007230         MOVE W-PHK TO P-PHK                                      I.021016
007240       ELSE                                                       I.021016
007250         MOVE W-PHK TO P-PHKD.                                    I.021016
007260     MOVE W-ZSU TO P-ZSU.                                         I.021016
007270     IF W-KYS NOT = ZERO                                          I.021016
007280         MOVE W-TR TO P-TR.                                       I.021016
007290     IF W-STS NOT = ZERO                                          I.021016
007300         MOVE W-RT TO P-RT.                                       I.021016
007310     IF LINAGE-COUNTER > 59                                       I.021016
007320         PERFORM S-05 THRU S-15.                                  I.021016
007330     MOVE SPACE TO SP-R.                                          I.021016
007340     MOVE W-P1 TO SP-R.                                           I.021016
007350     WRITE SP-R.                                                  I.021016
007360     MOVE SPACE TO SP-R.                                          I.021016
007370     MOVE W-P2 TO SP-R.                                           I.021016
007380     WRITE SP-R.                                                  I.021016
007390     MOVE SPACE TO SP-R.                                          I.021016
007400     WRITE SP-R.                                                  I.021016
007410*
007420     ADD W-GSK TO WA-GSK.                                         I.021016
007430     ADD W-GKK TO WA-GKK.                                         I.021016
007440     ADD W-GIK TO WA-GIK.                                         I.021016
007450     ADD W-GHK TO WA-GHK.                                         I.021016
007460     ADD W-PSK TO WA-PSK.                                         I.021016
007470     ADD W-PKK TO WA-PKK.                                         I.021016
007480     ADD W-PIK TO WA-PIK.                                         I.021016
007490     ADD W-PHK TO WA-PHK.                                         I.021016
007500     ADD W-STK TO WA-STK.                                         I.021016
007510     ADD W-KYK TO WA-KYK.                                         I.021016
007520 S-25.                                                            I.021016
007530     EXIT.                                                        I.021016
007540 S-30.
007550*****MOVE ZERO TO W-TR.                                           D.021016
007560*****IF WA-GKS = ZERO                                             D.021016
007570*****    GO TO S-31.                                              D.021016
007580*****IF WA-KYS NOT = ZERO                                         D.021016
007590*****    COMPUTE W-TR = (WA-GKS * 100) / WA-KYS                   D.021016
007600*****    GO TO S-31.                                              D.021016
007610*****IF WA-GKS > ZERO                                             D.021016
007620*****    MOVE 100 TO W-TR                                         D.021016
007630*****  ELSE                                                       D.021016
007640*****    MOVE -100 TO W-TR.                                       D.021016
007650*S-31.                                                            D.021016
007660*****MOVE SPACE TO W-P.                                           D.021016
007670*****MOVE "  [  ALL TOTAL  ]   " TO P-NAME.                       D.021016
007680*****MOVE WA-STS TO P-STS.                                        D.021016
007690*****MOVE WA-KYS TO P-KYS.                                        D.021016
007700*****MOVE WA-YSS TO P-YSS.                                        D.021016
007710*****MOVE WA-GSS TO P-GSS.                                        D.021016
007720*****MOVE WA-GKS TO P-GKS.                                        D.021016
007730*****MOVE "(" TO P-F1 P-F2.                                       D.021016
007740*****MOVE ")" TO P-R1 P-R2.                                       D.021016
007750*****MOVE WA-PSS TO P-PSS.                                        D.021016
007760*****MOVE WA-PKS TO P-PKS.                                        D.021016
007770*****MOVE WA-GHS  TO P-GHS.                                       D.021016
007780*****MOVE W-TR TO P-TR.                                           D.021016
007790*****MOVE WA-ZSU TO P-ZSU.                                        D.021016
007800     MOVE SPACE TO W-P1 W-P2.                                     I.021016
007810     MOVE "　　［　合　計　］　" TO P-NAME.                       I.021016
007820     MOVE WA-GSK TO P-GSK.                                        I.021016
007830     MOVE WA-GKK TO P-GKK.                                        I.021016
007840     MOVE WA-GIK TO P-GIK.                                        I.021016
007850     MOVE WA-GHK TO P-GHK.                                        I.021016
007860     MOVE "(" TO P-F2 P-F4 P-F6 P-F8.                             I.021016
007870     MOVE ")" TO P-R2 P-R4 P-R6 P-R8.                             I.021016
007880     MOVE WA-PSK TO P-PSK.                                        I.021016
007890     MOVE WA-PKK TO P-PKK.                                        I.021016
007900     MOVE WA-PIK TO P-PIK.                                        I.021016
007910     MOVE WA-PHK TO P-PHK.                                        I.021016
007920     MOVE WA-STK TO P-STK.                                        I.021016
007930     MOVE WA-KYK TO P-KYK.                                        I.021016
007940     IF LINAGE-COUNTER > 59
007950         PERFORM S-05 THRU S-15.
007960     MOVE SPACE TO SP-R.
007970     MOVE W-P1 TO SP-R.                                           I.021016
007980     WRITE SP-R.                                                  I.021016
007990     MOVE SPACE TO SP-R.                                          I.021016
008000     MOVE W-P2 TO SP-R.                                           I.021016
008010     WRITE SP-R.                                                  I.021016
008020*****IF JS-SIGN = 0                                               D.021016
008030*****    MOVE W-P TO SP-R                                         D.021016
008040*****  ELSE                                                       D.021016
008050*****    MOVE W-PD TO SP-R.                                       D.021016
008060*****IF JS-SIGN = 0                                               D.021016
008070*****    WRITE SP-R                                               D.021016
008080*****  ELSE                                                       D.021016
008090*****    WRITE SP-R AFTER 2.                                      D.021016
008100 S-35.
008110     EXIT.
