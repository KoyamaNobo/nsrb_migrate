000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HMD225.
000030*********************************************************
000040*    PROGRAM         :  売上・値引伝票発行  JS-SIGN=0   *
000050*                    :              再発行  JS-SIGN=1   *
000060*    PRINTER TYPE    :  JIPS                            *
000070*    SCREEN          :  ******                          *
000080*    FORM            :  FHD225                          *
000090*    COMPILE TYPE    :  COBOL                           *
000100*    BASE PROGRAM    :  HMD220                          *
000110*********************************************************
000120 ENVIRONMENT DIVISION.
000130 CONFIGURATION SECTION.
000140 SOURCE-COMPUTER. SYSTEM3100.
000150 OBJECT-COMPUTER. SYSTEM3100.
000160 INPUT-OUTPUT SECTION.
000170 FILE-CONTROL.
000180     COPY LIBCSE.                                                 I.031219
000190     SELECT S-TRAN ASSIGN TO S-MSD
000200         FILE STATUS IS ERR-STAT.
000210     SELECT STRANYR ASSIGN TO STRANY-MSD.                         I.010208
000220*****SELECT HUND-F ASSIGN TO HUND-MSD                             D.000825
000230*****    FILE STATUS IS ERR-STAT.                                 D.000825
000240*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000250     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000260         ORGANIZATION IS INDEXED
000270         ACCESS MODE IS RANDOM
000280         RECORD KEY IS HI-KEY
000290         ALTERNATE RECORD KEY IS HI-KEY2                          I.010802
000300         FILE STATUS IS ERR-STAT.
000310     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000320         ORGANIZATION IS INDEXED
000330         ACCESS MODE IS RANDOM
000340         RECORD KEY IS T-KEY
000350         ALTERNATE  RECORD KEY IS T-KEY2
000360         FILE STATUS IS ERR-STAT.
000370*****SELECT TT-M ASSIGN TO TT-MSD                                 D.070126
000380*****    ORGANIZATION IS INDEXED                                  D.070126
000390*****    ACCESS MODE IS RANDOM                                    D.070126
000400*****    RECORD KEY IS TT-KEY                                     D.070126
000410*****    FILE STATUS IS ERR-STAT.                                 D.070126
000420*****SELECT HKBM ASSIGN TO HKB-MSD                                D.070126
000430*****    ORGANIZATION IS INDEXED                                  D.070126
000440*****    ACCESS MODE IS RANDOM                                    D.070126
000450*****    RECORD KEY IS HKB-KEY                                    D.070126
000460*****    FILE STATUS IS ERR-STAT.                                 D.070126
000470     SELECT TC-M ASSIGN TO TC-MSD
000480         ORGANIZATION INDEXED
000490         RECORD KEY TC-KEY
000500         ACCESS MODE RANDOM
000510         FILE STATUS IS ERR-STAT.
000520     SELECT SP-F ASSIGN TO P-PRN999-FHD225.                       I.081119
000530*****SELECT TUKF ASSIGN TO TUK-MSD                                D.030912
000540*****SELECT TUKF ASSIGN TO TUK1-MSD TUK2-MSD                      D.070126
000550*****    ORGANIZATION INDEXED                                     D.070126
000560*****    ACCESS MODE RANDOM                                       D.070126
000570*****    RECORD KEY TUK-KEY                                       D.070126
000580*****    ALTERNATE RECORD KEY TUK-KEY2                            D.070126
000590*****    FILE STATUS IS ERR-STAT.                                 D.070126
000600*****SELECT SP-F ASSIGN TO P-PRN999.                              D.081119
000610 I-O-CONTROL.
000620     APPLY SHARED-MODE ON M-DATE                                  I.031219
000630     APPLY SHARED-MODE ON HI-M TC-M
000640     APPLY SHARED-MODE ON T-M
000650*****APPLY SHARED-MODE ON TT-M                                    D.070126
000660*****APPLY SHARED-MODE ON HKBM                                    D.070126
000670*****APPLY SHARED-MODE ON TUKF                                    D.070126
000680     APPLY SHIFT-CODE  ON SP-F.
000690 DATA DIVISION.
000700 FILE SECTION.
000710     COPY LIBFDD.                                                 I.031219
000720     COPY LIHIM.
000730     COPY LITM.
000740*****COPY LITTM.                                                  D.070126
000750     COPY LITCM.
000760*****COPY LIHKBM.                                                 D.070126
000770*****COPY LITUKF.                                                 D.070126
000780 FD  S-TRAN
000790     BLOCK  2 RECORDS
000800     LABEL RECORD STANDARD
000810     VALUE OF IDENTIFICATION IS "STRAN".
000820 01  S-R                PIC  X(128).                              I.010208
000830 FD  STRANYR                                                      I.010208
000840     BLOCK  2 RECORDS                                             I.010208
000850     LABEL RECORD STANDARD                                        I.010208
000860     VALUE OF IDENTIFICATION IS "STRANYR".                        I.050625
000870*****VALUE OF IDENTIFICATION IS SNTRF-ID.                         D.050625
000880*****VALUE OF IDENTIFICATION IS "SNTRF".                          D.031219
000890 01  STRANYR-R          PIC  X(128).                              I.010208
000900*01  S-R1.                                                        D.010208
000910*****02  S1-DNO         PIC  9(006).                              D.010208
000920*****02  S1-GNO         PIC  9(001).                              D.010208
000930*****02  S1-DATE        PIC  9(008).                              D.010208
000940*****02  S1-TCD         PIC  9(004).                              D.010208
000950*****02  S1-HCD         PIC  9(006).                              D.010208
000960*****02  S1-SIZ         PIC  9(001).                              D.010208
000970*****02  S1-ASU.                                                  D.010208
000980*****  03  S1-SUD   OCCURS 10.                                    D.010208
000990*****    04  S1-SU      PIC S9(004)   COMP-3.                     D.010208
001000*****02  S1-SUT         PIC S9(005).                              D.010208
001010*****02  S1-T           PIC  9(005).                              D.010208
001020*****02  S1-KIN         PIC S9(008).                              D.010208
001030*****02  S1-CSC         PIC  9(001).                              D.010208
001040*****02  S1-DC          PIC  9(001).                              D.010208
001050*****02  S1-FT          PIC  9(005).                              D.010208
001060*****02  S1-CCD         PIC  9(003).                              D.010208
001070*****02  F              PIC  X(011).                              D.010208
001080*****02  S1-HSC         PIC  9(001).                              D.010208
001090*****02  S1-KOSU        PIC  9(003).                              D.010208
001100*****02  S1-FRC         PIC  9(001).                              D.010208
001110*****02  S1-TCD2        PIC  9(004).                              D.010208
001120*****02  S1-BIK         PIC  X(010).                              D.010208
001130*****02  F              PIC  X(012).                              D.010208
001140*****02  S1-DHC         PIC  9(001).                              D.010208
001150*****02  S1-UNC         PIC  9(001).                              D.010208
001160*01  S-R2.                                                        D.010208
001170*****02  S2-DNO         PIC  9(006).                              D.010208
001180*****02  S2-GNO         PIC  9(001).                              D.010208
001190*****02  S2-DATE        PIC  9(008).                              D.010208
001200*****02  S2-TCD         PIC  9(004).                              D.010208
001210*****02  S2-BI          PIC  N(024).                              D.010208
001220*****02  S2-HNO.                                                  D.010208
001230*****  03  S2-HN1       PIC  9(006).                              D.010208
001240*****  03  S2-HN2       PIC  9(006).                              D.010208
001250*****  03  S2-HN3       PIC  9(006).                              D.010208
001260*****  03  S2-HN4       PIC  9(006).                              D.010208
001270*****  03  S2-HN5       PIC  9(006).                              D.010208
001280*****  03  S2-HN6       PIC  9(006).                              D.010208
001290*****02  S2-TAX         PIC S9(007).                              D.010208
001300*****02  S2-SHZZ        PIC S9(007).                              D.010208
001310*****02  S2-UZ          PIC S9(009).                              D.010208
001320*****02  S2-DHC         PIC  9(001).                              D.010208
001330*****02  S2-UNC         PIC  9(001).                              D.010208
001340*FD  HUND-F                                                       D.000825
001350*****BLOCK  6 RECORDS                                             D.000825
001360*****LABEL RECORD STANDARD                                        D.000825
001370*****VALUE OF IDENTIFICATION IS "HUNDF".                          D.000825
001380*01  HUND-R.                                                      D.000825
001390*****02  UN-DATE        PIC  9(008).                              D.000825
001400*****02  UN-NO          PIC  9(006).                              D.000825
001410*****02  UN-TCD         PIC  9(004).                              D.000825
001420*****02  UN-SHZ         PIC S9(006).                              D.000825
001430*****02  UN-KIN         PIC S9(008).                              D.000825
001440*****02  UN-UNC         PIC  9(001).                              D.000825
001450*****02  UN-CSC         PIC  9(001).                              D.000825
001460*****02  F              PIC  X(008).                              D.000825
001470 FD  SP-F
001480     LABEL RECORD OMITTED
001490     LINAGE IS 36 LINES.
001500 01  SP-R               PIC  X(170).
001510 WORKING-STORAGE  SECTION.
001520 77  JS-SIGN            PIC  X(001).
001530 77  W-DCHK             PIC  9(001).
001540 77  W-DZC              PIC  9(001) VALUE 0.
001550 77  W-FILE             PIC  X(013).
001560*77  SNTRF-ID           PIC  X(009).                              D.050625
001570 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
001580 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
001590 77  W-30K              PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.051031
001600 77  W-40K              PIC  X(008) VALUE ""3F504F40674F40A0"".   I.051031
001610 01  W-P01.
001620     02  P-15K1         PIC  X(005).
001630*****02  F              PIC  X(089).                              D.041015
001640*****02  F              PIC  X(088).                              D.081119
001650     02  F              PIC  X(080).                              I.081119
001660     02  P-DCM          PIC  N(004).                              I.081119
001670     02  P-CSC          PIC  Z(001).
001680     02  P-DC           PIC  Z(001).
001690     02  P-FRC          PIC  9(001).
001700*****02  F              PIC  X(002).                              D.081119
001710     02  P-DNOM         PIC  N(002).                              I.081119
001720     02  P-DNO          PIC  9(006).
001730*****02  F              PIC  X(003).                              D.010523
001740     02  P-NBK          PIC  X(001).                              I.010523
001750     02  F              PIC  X(002).                              I.010523
001760     02  P-SHC          PIC  X(001).                              I.010208
001770*****02  F              PIC  X(004).                              D.010208
001780 01  W-P02.
001790     02  P-20K1         PIC  X(005).                              I.081119
001800*****02  F              PIC  X(011).                              D.020404
001810*****02  P-UB           PIC  X(008).                              D.020404
001820*****02  F              PIC  X(068).                              D.020404
001830*****02  F              PIC  X(087).                              D.041015
001840     02  F              PIC  X(086).                              I.041015
001850     02  P-NC           PIC  X(001).
001860     02  P-NEN          PIC  9(002).                              I.081119
001870     02  P-NENM         PIC  N(001).                              I.081119
001880     02  P-GET          PIC  Z(002).                              I.081119
001890     02  P-GETM         PIC  N(001).                              I.081119
001900     02  P-PEY          PIC  Z(002).                              I.081119
001910     02  P-PEYM         PIC  N(001).                              I.081119
001920     02  F              PIC  X(004).                              I.081119
001930*****02  P-DATE         PIC 99BB99BB99.                           D.081119
001940*****02  F              PIC  X(006).                              D.081119
001950 01  W-P03.
001960     02  P-15K2         PIC  X(005).                              I.081119
001970     02  F              PIC  X(048).                              I.081119
001980     02  P-30K          PIC  X(008).                              I.081119
001990     02  P-DPM          PIC  N(008).                              I.081119
002000     02  P-40K          PIC  X(008).                              I.081119
002010     02  F              PIC  X(031).                              I.081119
002020*****02  F              PIC  X(057).                              D.020404
002030*****02  F              PIC  X(009).                              D.041015
002040*****02  F              PIC  X(008).                              D.081119
002050*****02  P-UBM          PIC  N(002).                              D.081119
002060*****02  P-UB           PIC  X(008).                              D.081119
002070*****02  F              PIC  X(029).                              D.081119
002080*****02  P-MID21        PIC  X(007).                              D.081119
002090*****02  F              PIC  X(001).                              D.081119
002100*****02  P-MID22        PIC  X(007).                              D.081119
002110*****02  F              PIC  X(040).                              D.081119
002120*****02  F              PIC  X(032).                              D.020404
002130*01  W-P04.                                                       D.081119
002140*****02  F              PIC  X(011).                              D.041015
002150*****02  F              PIC  X(010).                              D.081119
002160*****02  P-JUO          PIC  N(020).                              D.081119
002170*****02  F              PIC  X(039).                              D.081119
002180*****02  P-30K          PIC  X(008).                              D.081119
002190*****02  P-NRN          PIC  N(008).                              D.081119
002200*****02  P-40K          PIC  X(008).                              D.081119
002210*****02  F              PIC  X(063).                              D.051031
002220*****02  F              PIC  X(010).                              D.020404
002230*****02  P-JUO          PIC  N(024).                              D.020404
002240*****02  F              PIC  X(058).                              D.020404
002250*01  W-P05.                                                       D.081119
002260*****02  F              PIC  X(011).                              D.041015
002270*****02  F              PIC  X(010).                              D.081119
002280*****02  P-JUU          PIC  N(020).                              D.081119
002290*****02  F              PIC  X(040).                              D.081119
002300*****02  P-NRUM         PIC  N(002).                              D.081119
002310*****02  P-NRU          PIC  X(008).                              D.081119
002320*****02  F              PIC  X(012).                              D.081119
002330*****02  F              PIC  X(063).                              D.051031
002340*****02  F              PIC  X(028).                              D.020404
002350*****02  P-JUU          PIC  N(012).                              D.020404
002360*****02  F              PIC  X(058).                              D.020404
002370 01  W-P06.                                                       I.020404
002380*****02  F              PIC  X(056).                              D.041015
002390     02  F              PIC  X(055).                              I.041015
002400     02  P-AZH          PIC  N(006).                              I.020404
002410     02  F              PIC  X(039).                              I.081119
002420*****02  F              PIC  X(016).                              D.081119
002430*****02  P-NRJ          PIC  N(014).                              D.081119
002440*****02  F              PIC  X(002).                              D.081119
002450*****02  F              PIC  X(039).                              D.051031
002460 01  W-P07.
002470*****02  F              PIC  X(012).                              D.041015
002480     02  F              PIC  X(011).                              I.041015
002490     02  P-TNAO         PIC  N(020).                              I.020404
002500     02  F              PIC  X(062).                              I.081119
002510*****02  F              PIC  X(041).                              D.081119
002520*****02  P-NRT          PIC  X(018).                              D.081119
002530*****02  F              PIC  X(003).                              D.081119
002540*****02  F              PIC  X(062).                              D.051031
002550*****02  P-TNA          PIC  N(024).                              D.020404
002560*****02  F              PIC  X(010).                              D.020404
002570*****02  P-AZH          PIC  N(006).                              D.020404
002580*****02  F              PIC  X(037).                              D.020404
002590 01  W-P08.
002600*****02  F              PIC  X(012).                              D.041015
002610     02  F              PIC  X(011).                              I.041015
002620     02  P-TNAU         PIC  N(020).                              I.020404
002630     02  F              PIC  X(003).                              I.020404
002640*****02  F              PIC  X(006).                              D.020404
002650     02  P-TF           PIC  X(001).                              I.010220
002660     02  P-TNC1         PIC  9(001).                              I.010220
002670     02  P-TV           PIC  X(001).                              I.010220
002680     02  P-DCC          PIC  9(001).                              I.010220
002690     02  P-TR           PIC  X(001).                              I.010220
002700     02  F              PIC  X(001).                              I.051108
002710*****02  F              PIC  X(002).                              D.051108
002720*****02  P-W            PIC  X(003).                              D.010220
002730*****02  P-W            PIC  X(002).                              D.051108
002740     02  P-W            PIC  N(002).                              I.051108
002750     02  P-TCD          PIC  9(004).
002760     02  P-V            PIC  X(001).
002770     02  P-CCD          PIC  9(003).
002780     02  F              PIC  X(001).
002790     02  P-X            PIC  X(002).
002800     02  F              PIC  X(039).                              I.081119
002810*****02  F              PIC  X(018).                              D.081119
002820*****02  P-NRF          PIC  X(018).                              D.081119
002830*****02  F              PIC  X(003).                              D.081119
002840*****02  F              PIC  X(039).                              D.051031
002850*****02  F              PIC  X(078).                              D.020404
002860*****02  F              PIC  X(084).                              D.010220
002870 01  W-P08A.                                                      I.081119
002880     02  F              PIC  X(017).                              I.081119
002890     02  P-HMM          PIC  N(008).                              I.081119
002900     02  F              PIC  X(012).                              I.081119
002910     02  P-SIZM         PIC  X(041).                              I.081119
002920     02  P-SUM          PIC  N(004).                              I.081119
002930     02  F              PIC  X(001).                              I.081119
002940     02  P-TM           PIC  N(002).                              I.081119
002950     02  F              PIC  X(002).                              I.081119
002960     02  P-KINM         PIC  N(004).                              I.081119
002970     02  F              PIC  X(002).                              I.081119
002980 01  W-P09.
002990*****02  F              PIC  X(007).                              D.041015
003000     02  F              PIC  X(006).                              I.041015
003010     02  P-HCD          PIC  9(006).
003020     02  F              PIC  X(016).
003030     02  P-F            PIC  X(001).
003040     02  P-BIK          PIC  X(010).
003050     02  P-R            PIC  X(001).
003060     02  F              PIC  X(063).
003070 01  W-P10.
003080*****02  F              PIC  X(006).                              D.041015
003090     02  F              PIC  X(005).                              I.041015
003100     02  P-HNA          PIC  N(024).
003110     02  P-SIZ          PIC  Z(001).
003120     02  P-SUD.
003130       03  P-SU    OCCURS  10  PIC  Z(004).
003140     02  P-SUT          PIC  -(006).
003150     02  P-T            PIC  Z(005).
003160*****02  P-20K1         PIC  X(005).                              D.081119
003170     02  P-20K2         PIC  X(005).                              I.081119
003180     02  P-D.
003190       03  P-KIN        PIC  -(010).
003200     02  P-AZM   REDEFINES P-D     PIC  N(005).
003210     02  P-15K3         PIC  X(005).                              I.081119
003220*****02  P-15K2         PIC  X(005).                              D.081119
003230 01  W-P11.
003240*****02  P-CD11         PIC  X(005).                              D.020405
003250*****02  F              PIC  X(009).                              D.041015
003260     02  F              PIC  X(008).                              I.041015
003270     02  P-KOSU         PIC  N(004).
003280     02  P-KO           PIC  N(002).
003290     02  F              PIC  X(007).                              I.020405
003300     02  P-CNAM         PIC  N(032).                              I.020405
003310*****02  F              PIC  X(001).                              D.020405
003320*****02  F              PIC  X(006).                              D.020405
003330*****02  P-CD1          PIC  X(005).                              D.020405
003340*****02  P-CNAM         PIC  N(030).                              D.020405
003350 01  W-P12.
003360*****02  F              PIC  X(083).                              D.041015
003370*****02  F              PIC  X(082).                              D.081119
003380     02  F              PIC  X(003).                              I.081119
003390     02  P-TKM1         PIC  N(002).                              I.081119
003400     02  F              PIC  X(069).                              I.081119
003410     02  P-GOM          PIC  N(004).                              I.081119
003420     02  F              PIC  X(001).                              I.081119
003430     02  P-ASUT         PIC  -(006).
003440     02  F              PIC  X(005).
003450     02  P-AKIN         PIC  -(010).
003460 01  W-P13.
003470*****02  F              PIC  X(010).                              D.041015
003480     02  F              PIC  X(009).                              I.041015
003490     02  P-BI           PIC  N(024).
003500     02  F              PIC  X(035).
003510     02  P-ZR           PIC  X(004).
003520 01  W-P14.
003530*****02  P-CD3          PIC  X(005).                              D.020405
003540*****02  F              PIC  X(010).                              D.020405
003550*****02  P-HNM          PIC  N(007).                              D.020405
003560*****02  P-CD4          PIC  X(005).                              D.020405
003570*****02  F              PIC  X(012).                              D.041015
003580     02  F              PIC  X(011).                              I.041015
003590     02  P-HNM          PIC  N(008).                              I.020405
003600     02  F              PIC  X(001).
003610     02  P-HNO          PIC  9(006).                              I.081224
003620*****02  P-HN1          PIC  9(006).                              D.081224
003630*****02  P-C2           PIC  X(001).                              D.081224
003640*****02  P-HN2          PIC  9(006).                              D.081224
003650*****02  P-C3           PIC  X(001).                              D.081224
003660*****02  P-HN3          PIC  9(006).                              D.081224
003670*****02  P-C4           PIC  X(001).                              D.081224
003680*****02  P-HN4          PIC  9(006).                              D.081224
003690*****02  P-C5           PIC  X(001).                              D.081224
003700*****02  P-HN5          PIC  9(006).                              D.081224
003710*****02  P-C6           PIC  X(001).                              D.081224
003720*****02  P-HN6          PIC  9(006).                              D.081224
003730*****02  F              PIC  X(010).                              D.081224
003740     02  F              PIC  X(045).                              I.081224
003750     02  P-SZM          PIC  N(004).                              I.081119
003760     02  P-SHZ          PIC  -(007).                              I.081119
003770     02  P-TKM          PIC  N(004).                              I.081119
003780     02  P-TKIN         PIC  -(009).                              I.081119
003790 01  W-P15.                                                       I.081119
003800     02  F              PIC  X(003).                              I.081119
003810     02  P-TKM2         PIC  N(002).                              I.081119
003820     02  F              PIC  X(097).                              I.081119
003830     02  P-20K3         PIC  X(005).                              I.081119
003840*****02  F              PIC  X(015).                              D.081119
003850*****02  P-SHZ          PIC  -(008).                              D.081119
003860*****02  F              PIC  X(005).                              D.081119
003870*****02  P-TKIN         PIC  -(010).                              D.081119
003880*01  W-P15X.                                                      D.070126
003890*****02  F              PIC  X(081).                              D.041015
003900*****02  F              PIC  X(080).                              D.070126
003910*****02  P-SHZZ         PIC -------9.                             D.070126
003920*****02  F              PIC  X(004).                              D.070126
003930*****02  P-UZ           PIC ----------9.                          D.070126
003940*****02  P-20K2         PIC  X(005).                              D.081119
003950 01  W-R.                                                         I.010208
003960     02  WR-S1.                                                   I.010208
003970       03  S1-DNO       PIC  9(006).                              I.010208
003980       03  S1-GNO       PIC  9(001).                              I.010208
003990       03  S1-DATE      PIC  9(008).                              I.010208
004000       03  S1-NGP   REDEFINES S1-DATE.                            I.031219
004010         04  S1-NG      PIC  9(006).                              I.031219
004020         04  S1-PEY     PIC  9(002).                              I.031219
004030       03  S1-TCD       PIC  9(004).                              I.010208
004040       03  S1-HCD       PIC  9(006).                              I.010208
004050       03  S1-SIZ       PIC  9(001).                              I.010208
004060       03  S1-ASU.                                                I.010208
004070         04  S1-SUD   OCCURS 10.                                  I.010208
004080           05  S1-SU    PIC S9(004)   COMP-3.                     I.010208
004090       03  S1-SUT       PIC S9(005).                              I.010208
004100       03  S1-T         PIC  9(005).                              I.010208
004110       03  S1-KIN       PIC S9(008).                              I.010208
004120       03  S1-CSC       PIC  9(001).                              I.010208
004130       03  S1-DC        PIC  9(001).                              I.010208
004140       03  S1-FT        PIC  9(005).                              I.010208
004150       03  S1-CCD       PIC  9(003).                              I.010208
004160       03  F            PIC  X(011).                              I.010208
004170       03  S1-HSC       PIC  9(001).                              I.010208
004180       03  S1-KOSU      PIC  9(003).                              I.010208
004190       03  S1-FRC       PIC  9(001).                              I.010208
004200       03  S1-TCD2      PIC  9(004).                              I.010208
004210       03  S1-BIK       PIC  X(010).                              I.010208
004220       03  F            PIC  X(012).                              I.010208
004230       03  S1-DHC       PIC  9(001).                              I.010208
004240       03  S1-UNC       PIC  9(001).                              I.010208
004250     02  WR-S2    REDEFINES WR-S1.                                I.010208
004260       03  S2-DNO       PIC  9(006).                              I.010208
004270       03  S2-GNO       PIC  9(001).                              I.010208
004280       03  S2-DATE      PIC  9(008).                              I.010208
004290       03  S2-TCD       PIC  9(004).                              I.010208
004300       03  S2-BI        PIC  N(024).                              I.010208
004310       03  S2-HNO       PIC  9(006).                              I.081224
004320       03  F            PIC  X(030).                              I.081224
004330*****  03  S2-HNO.                                                D.081224
004340*****    04  S2-HN1     PIC  9(006).                              D.081224
004350*****    04  S2-HN2     PIC  9(006).                              D.081224
004360*****    04  S2-HN3     PIC  9(006).                              D.081224
004370*****    04  S2-HN4     PIC  9(006).                              D.081224
004380*****    04  S2-HN5     PIC  9(006).                              D.081224
004390*****    04  S2-HN6     PIC  9(006).                              D.081224
004400       03  S2-TAX       PIC S9(007).                              I.010208
004410       03  S2-SHZZ      PIC S9(007).                              I.010208
004420       03  S2-UZ        PIC S9(009).                              I.010208
004430       03  S2-DHC       PIC  9(001).                              I.010208
004440       03  S2-UNC       PIC  9(001).                              I.010208
004450 01  W-DATA.
004460     02  W-TD.
004470       03  W-ASUT       PIC S9(006).
004480       03  W-AKIN       PIC S9(008).
004490*****  03  W-UG         PIC S9(008).                              D.071003
004500       03  W-SHZ        PIC S9(006).
004510       03  W-TKIN       PIC S9(008).
004520     02  W-D.
004530       03  W-TPC        PIC  9(001).
004540       03  W-GNO        PIC  9(001).
004550       03  W-L          PIC  9(002).
004560       03  W-LC         PIC  9(002).
004570       03  W-ASU.
004580         04  W-SU    OCCURS  10  PIC S9(004).
004590       03  W-SUT        PIC S9(005).
004600       03  W-KIN        PIC S9(008).
004610       03  W-KINZ       PIC S9(007).
004620       03  CNT          PIC  9(002).
004630       03  W-DC         PIC  9(001).
004640       03  W-BE         PIC  9(001).
004650       03  W-HSC        PIC  9(001).
004660       03  W-CSC        PIC  9(001).
004670     02  CHK.
004680       03  CHK1         PIC  9(001).
004690       03  CHK2         PIC  9(001).
004700     02  W-DNO          PIC  9(006).
004710*****02  W-DATE         PIC  9(008).                              D.081119
004720*****02  W-NGP   REDEFINES W-DATE.                                D.081119
004730*****  03  F            PIC  9(002).                              D.081119
004740*****  03  W-NGPS       PIC  9(006).                              D.081119
004750     02  W-AAL          PIC  X(014) VALUE "13110907050301".
004760     02  W-ALD   REDEFINES W-AAL.
004770       03  W-AL    OCCURS   7  PIC  9(002).
004780     02  W-CCD          PIC  9(003).
004790     02  W-NGPD.                                                  I.050625
004800       03  W-NG.                                                  I.050625
004810         04  W-NEN      PIC  9(004).                              I.050625
004820         04  W-NEND  REDEFINES W-NEN.                             I.050625
004830           05  W-NEN1   PIC  9(002).                              I.050625
004840           05  W-NEN2   PIC  9(002).                              I.050625
004850         04  W-GET      PIC  9(002).                              I.050625
004860       03  W-PEY        PIC  9(002).                              I.050625
004870*****02  W-NG.                                                    D.050625
004880*****  03  W-NEN        PIC  9(004).                              D.050625
004890*****  03  W-NEND  REDEFINES W-NEN.                               D.050625
004900*****    04  W-NEN1     PIC  9(002).                              D.050625
004910*****    04  W-NEN2     PIC  9(002).                              D.050625
004920*****  03  W-GET        PIC  9(002).                              D.050625
004930*****02  W-NGL   REDEFINES W-NG.                                  D.050625
004940*****  03  F            PIC  9(002).                              D.050625
004950*****  03  W-NGS        PIC  9(004).                              D.050625
004960*****02  W-NGD          PIC  9(004).                              D.050625
004970     02  W-SENGP.                                                 I.050625
004980       03  W-SNGP       PIC  9(008).                              I.050625
004990       03  W-SNGPD REDEFINES W-SNGP.                              I.050625
005000         04  W-SNG      PIC  9(006).                              I.050625
005010         04  F          PIC  9(002).                              I.050625
005020       03  W-ENGP       PIC  9(008).                              I.050625
005030       03  W-ENGPD REDEFINES W-ENGP.                              I.050625
005040         04  W-ENG      PIC  9(006).                              I.050625
005050         04  F          PIC  9(002).                              I.050625
005060     02  W-SETCD.                                                 I.050625
005070       03  W-STCD       PIC  9(004).                              I.050625
005080       03  W-ETCD       PIC  9(004).                              I.050625
005090     02  W-SEDNO.
005100       03  W-SDNO       PIC  9(006).
005110       03  W-EDNO       PIC  9(006).
005120     02  W-DMM          PIC  9(001).
005130     02  W-CCC          PIC  9(001).
005140     02  W-NAME         PIC  N(024).                              I.000821
005150     02  W-NAMED REDEFINES W-NAME.                                I.000821
005160       03  W-NAD   OCCURS  24.                                    I.000821
005170         04  W-NA       PIC  N(001).                              I.000821
005180     02  W-NC           PIC  9(001).                              I.050625
005190 01  ERR-STAT           PIC  X(002).
005200 01  W-AREA.
005210     02  W-KOSU         PIC ZZZZ.
005220     02  N              PIC  9(002).
005230*****02  TBL-NAM        PIC  N(030).                              D.020405
005240     02  TBL-NAM        PIC  N(032).                              I.020405
005250     02  TBL-NAMR  REDEFINES TBL-NAM.
005260       03  T-NAM        PIC  N(001)  OCCURS  32.                  I.020405
005270*****  03  T-NAM        PIC  N(001)  OCCURS  30.                  D.020405
005280     02  SV-KOSU        PIC  9(003).
005290     02  SV-TCD         PIC  9(004).
005300     02  SV-CCD2        PIC  9(003).
005310     COPY LNAMW.                                                  I.020405
005320     COPY LSTAT.
005330*****COPY LDAIW.                                                  D.070126
005340 SCREEN SECTION.
005350 SD  C-CRT
005360     END STATUS IS ESTAT.
005370 01  C-CLEAR.
005380     02  C-CL    LINE   1  CLEAR SCREEN.
005390 01  C-MID.
005400     02  LINE   2  COLUMN  15  PIC  N(023) VALUE
005410          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005420     02  LINE   3  COLUMN  15  PIC  N(023) VALUE
005430          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005440     02  LINE   4  COLUMN  15  PIC  N(023) VALUE
005450          NC"＊＊＊　　【ナフコ・ワークマン白紙】　　＊＊＊".     I.081119
005460*****     NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     D.081119
005470     02  LINE   5  COLUMN  15  PIC  N(023) VALUE
005480          NC"＊＊＊　　売上・返品・値引伝票　作成　　＊＊＊".
005490     02  LINE   6  COLUMN  15  PIC  N(023) VALUE
005500          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
005510     02  LINE   7  COLUMN  15  PIC  N(023) VALUE
005520          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005530     02  LINE   8  COLUMN  15  PIC  N(023) VALUE
005540          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005550 01  C-DSP.
005560     02  D-SHM.
005570       03  LINE   6  COLUMN  33  PIC  N(005) VALUE NC"（再発行）".
005580*****  03  LINE  10  COLUMN  23  PIC  X(030) VALUE                D.031219
005590*****  03  LINE  10  COLUMN  23  PIC  X(013) VALUE                D.050625
005600*****       "'  年   月 分".                                      D.050625
005610*****       "'  年   月 分".                                      D.050625
005620       03  LINE  10  COLUMN  23  PIC  X(030) VALUE                I.050625
005630            "伝票№ 000000 より 999999 まで".
005640       03  LINE  12  COLUMN  23  PIC  X(037) VALUE                I.050625
005650            "'00年00月00日 より '99年99月99日 まで".              I.050625
005660       03  LINE  14  COLUMN  23  PIC  X(030) VALUE                I.050625
005670            "得意先   0000 より 9999   まで".                     I.050625
005680*****  03  LINE  12  COLUMN  27  PIC  X(022) VALUE                D.031219
005690*****  03  LINE  14  COLUMN  27  PIC  X(022) VALUE                D.060524
005700       03  LINE  16  COLUMN  27  PIC  X(022) VALUE                I.060524
005710            "確認  OK=1 NO=9   ﾘﾀｰﾝ".
005720     02  D-CM.
005730       03  LINE  18  COLUMN  22  PIC  X(032) VALUE                I.081119
005740            "-----   白紙用紙　セット   -----".                   I.081119
005750       03  LINE  20  COLUMN  21  PIC  X(035) VALUE                I.081119
005760            "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  ｼﾅｲ=1 ｽﾙ=9    ﾘﾀｰﾝ  ]".                I.081119
005770*****  03  LINE  14  COLUMN  24  PIC  X(028) VALUE                D.031219
005780*****  03  LINE  16  COLUMN  24  PIC  X(028) VALUE                D.050625
005790*****       "----------------------------".                       D.050625
005800*****  03  LINE  15  COLUMN  24  PIC  X(028) VALUE                D.031219
005810*****  03  LINE  17  COLUMN  24  PIC  X(028) VALUE                D.050625
005820*****  03  LINE  18  COLUMN  24  PIC  X(028) VALUE                D.081119
005830*****       "-----   用紙　セット   -----".                       D.081119
005840*****  03  LINE  16  COLUMN  24  PIC  X(028) VALUE                D.031219
005850*****  03  LINE  18  COLUMN  24  PIC  X(028) VALUE                D.050625
005860*****       "----------------------------".
005870*****  03  LINE  18  COLUMN  21  PIC  X(034) VALUE                D.031219
005880*****  03  LINE  20  COLUMN  21  PIC  X(034) VALUE                D.081119
005890*****       "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  OK=1 NO=9    ﾘﾀｰﾝ  ]".                 D.081119
005900*****02  D-DM    LINE  20.                                        D.031219
005910*****02  D-DM    LINE  22.                                        D.081119
005920*****  03  D-UDM    COLUMN  27  PIC  N(010) VALUE                 D.081119
005930*****       NC"【　　売上伝票　　】".                             D.081119
005940*****  03  D-HDM    COLUMN  27  PIC  N(010) VALUE                 D.081119
005950*****       NC"【　返品値引伝票　】".                             D.081119
005960 01  C-ACP.
005970     02  LINE  10.
005980*****  03  A-NEN   COLUMN  24  PIC  9(002)                        D.050625
005990*****       USING W-NEN2  CHECK OVERFLOW NO IFC.                  D.050625
006000*****  03  A-GET   COLUMN  29  PIC  9(002)                        D.050625
006010*****       USING W-GET   CHECK OVERFLOW NO IFC.                  D.050625
006020*****02  LINE  12.                                                D.050625
006030       03  A-SDNO  COLUMN  30  PIC  9(006)
006040            USING W-SDNO  CHECK OVERFLOW NO IFC.
006050       03  A-EDNO  COLUMN  42  PIC  9(006)
006060            USING W-EDNO  CHECK OVERFLOW NO IFC.
006070     02  LINE  12.                                                I.050625
006080       03  A-SNEN  COLUMN  24  PIC  9(002)                        I.050625
006090            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
006100       03  A-SGET  COLUMN  28  PIC  9(002)                        I.050625
006110            USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
006120       03  A-SPEY  COLUMN  32  PIC  9(002)                        I.050625
006130            USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
006140       03  A-ENEN  COLUMN  43  PIC  9(002)                        I.050625
006150            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
006160       03  A-EGET  COLUMN  47  PIC  9(002)                        I.050625
006170            USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
006180       03  A-EPEY  COLUMN  51  PIC  9(002)                        I.050625
006190            USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
006200     02  LINE  14.                                                I.050625
006210       03  A-STCD  COLUMN  32  PIC  9(004)                        I.050625
006220            USING W-STCD  CHECK OVERFLOW NO IFC.                  I.050625
006230       03  A-ETCD  COLUMN  42  PIC  9(004)                        I.050625
006240            USING W-ETCD  CHECK OVERFLOW NO IFC.                  I.050625
006250*****02  A-DMM   LINE  12  COLUMN  44  PIC  9(001)                D.031219
006260*****02  A-DMM   LINE  14  COLUMN  44  PIC  9(001)                D.050625
006270     02  A-DMM   LINE  16  COLUMN  44  PIC  9(001)                I.050625
006280          USING W-DMM   CHECK OVERFLOW NO IFC.
006290*****02  A-TPC   LINE  18  COLUMN  47  PIC  9(001)                D.031219
006300*****02  A-TPC   LINE  20  COLUMN  47  PIC  9(001)                D.081119
006310     02  A-TPC   LINE  20  COLUMN  48  PIC  9(001)                I.081119
006320          USING W-TPC   CHECK OVERFLOW NO IFC.
006330 01  C-ERR.
006340     02  LINE  24.
006350       03  EMSG-JS COLUMN  15  PIC  X(024) VALUE
006360            "***  ｺﾝﾄﾛｰﾙ情報ｴﾗｰ   ***".
006370*****  03  E-ME1   COLUMN  15  PIC  X(017) VALUE                  D.070126
006380*****       "***  HKBM ﾅｼ  ***".                                  D.070126
006390*****  03  E-ME2   COLUMN  15  PIC  X(016) VALUE                  D.070126
006400*****       "***  TTM ﾅｼ  ***".                                   D.070126
006410       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
006420            "***  HIM ﾅｼ  ***".
006430       03  E-ME4   COLUMN  15  PIC  X(034) VALUE
006440            "***  ﾊｯｺｳｸﾌﾞﾝ ﾉ ﾄﾞｳｷｶﾞ ﾄﾚﾃｲﾅｲ  ***".
006450       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
006460            "***  STRAN ｴﾗｰ (OVER)  ***".
006470       03  E-ME6   COLUMN  15  PIC  X(024) VALUE
006480            "***  STRAN ｴﾗｰ (NO)  ***".
006490       03  E-ME7   COLUMN  15  PIC  X(026) VALUE
006500            "***  STRAN ｴﾗｰ (ﾋﾞｺｳ)  ***".
006510       03  E-ME10  COLUMN  15  PIC  X(015) VALUE
006520            "***  TM ﾅｼ  ***".
006530       03  E-ME11  COLUMN  15  PIC  X(018) VALUE
006540            "***  DATA ﾅｼ   ***".
006550*****  03  E-ME22  COLUMN  15  PIC  X(025) VALUE                  D.070126
006560*****       "***  TTM REWRITE ｴﾗｰ  ***".                          D.070126
006570*****  03  E-ME23  COLUMN  15  PIC  X(028) VALUE                  D.070126
006580*****       "***   HKBM REWRITE ｴﾗｰ   ***".                       D.070126
006590       03  E-ME24  COLUMN  15  PIC  X(029) VALUE
006600            "***   STRAN REWRITE ｴﾗｰ   ***".
006610*****  03  E-ME26  COLUMN  15  PIC  X(027) VALUE                  D.000825
006620*****       "***   HUNDF WRITE ｴﾗｰ   ***".                        D.000825
006630*****  03  E-ME27  COLUMN  15  PIC  X(026) VALUE                  D.070126
006640*****       "***   HKBM WRITE ｴﾗｰ   ***".                         D.070126
006650*****  03  E-ME28  COLUMN  15  PIC  X(026) VALUE                  D.070126
006660*****       "***   TUKF WRITE ｴﾗｰ   ***".                         D.070126
006670*****  03  E-ME50  COLUMN  15  PIC  X(026) VALUE                  D.070126
006680*****       "***   ﾀﾞｲﾁｮｳNO ｵｰﾊﾞｰ   ***".                         D.070126
006690       03  E-TCD   COLUMN  50  PIC  9(004) FROM  S1-TCD.
006700       03  E-HCD   COLUMN  50  PIC  9(006) FROM  S1-HCD.
006710     COPY LSSEM.
006720     COPY LIBSCR.                                                 I.031219
006730 PROCEDURE DIVISION.
006740 M-020.
006750     ACCEPT JS-SIGN.
006760     DISPLAY C-CLEAR.
006770     DISPLAY C-MID.
006780     IF JS-SIGN NOT = 0 AND 1
006790         MOVE 255 TO COMPLETION-CODE                              I.010208
006800         DISPLAY EMSG-JS E-ME99
006810         STOP RUN.
006820*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P07 W-P08.     D.020603
006830*****MOVE SPACE TO W-P11 W-P13.                                   D.020603
006840*****MOVE SPACE TO W-P09 W-P10 W-P12 W-P14 W-P15X.                D.020603
006850*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            D.081119
006860*****              W-P07 W-P08.                                   D.081119
006870*****MOVE SPACE TO W-P09 W-P10 W-P11 W-P12 W-P13 W-P14 W-P15X.    D.070126
006880*****MOVE SPACE TO W-P09 W-P10 W-P11 W-P12 W-P13 W-P14.           D.081119
006890*****MOVE W-15K TO P-15K2.                                        D.081119
006900*****MOVE W-20K TO P-20K1 P-20K2.                                 D.081119
006910     MOVE SPACE TO W-P01 W-P02 W-P03 W-P06 W-P07 W-P08            I.081119
006920                   W-P09 W-P10 W-P11 W-P12 W-P13 W-P14 W-P15.     I.081119
006930     MOVE W-15K TO P-15K1 P-15K2 P-15K3.                          I.081119
006940     MOVE W-20K TO P-20K1 P-20K2 P-20K3.                          I.081119
006950     MOVE W-30K TO P-30K.                                         I.051031
006960     MOVE W-40K TO P-40K.                                         I.051031
006970     MOVE SPACE TO P-AZH P-TNAO P-TNAU P-W P-HNA P-KOSU P-KO      I.081119
006980                   P-BI P-HNM.                                    I.081119
006990*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-AZH                D.051031
007000*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-AZH P-NRN          D.051108
007010*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-W P-AZH P-NRN      D.081119
007020*****              P-HNA P-BI P-HNM.                              D.081119
007030*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-HNA P-BI P-HNM.    D.020603
007040*****MOVE SPACE TO P-JUO P-JUU P-TNA P-HNA P-BI P-HNM.            D.020405
007050*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-W P-AZH P-NRN      D.081119
007060*****              P-HNA P-BI P-HNM.                              D.081119
007070*****MOVE NC"　〒" TO P-UBM.                                      D.081119
007080*****MOVE ALL "X" TO P-UB.                                        D.081119
007090*****MOVE ALL NC"Ｘ" TO P-JUO P-JUU P-TNAO P-TNAU                 D.051108
007100*****MOVE ALL NC"Ｘ" TO P-JUO P-JUU P-TNAO P-TNAU P-W             D.081119
007110*****                   P-HNA P-BI P-CNAM P-KO.                   D.081119
007120*****MOVE  NC"日進ゴム株式会社" TO P-NRN.                         D.081119
007130*****MOVE  NC"　〒" TO P-NRUM.                                    D.081119
007140*****MOVE    "700-0975" TO P-NRU.                                 D.081119
007150*****MOVE  NC"　岡山市今８丁目１６番１７号" TO P-NRJ.             D.081119
007160*****MOVE    "TEL (086) 243-2456" TO P-NRT.                       D.081119
007170*****MOVE    "FAX (086) 242-0550" TO P-NRF.                       D.081119
007180*****MOVE    "700-0034" TO P-NRU.                                 D.051207
007190*****MOVE  NC"　岡山市高柳東町１３番４６号" TO P-NRJ.             D.051207
007200*****MOVE    "TEL (086) 252-2456" TO P-NRT.                       D.051207
007210*****MOVE    "FAX (086) 254-8595" TO P-NRF.                       D.051207
007220*****MOVE ALL NC"Ｘ" TO P-JUO P-JUU P-TNA P-HNA P-BI P-CNAM.      D.020405
007230*****MOVE ALL NC"Ｘ" TO P-KO.                                     D.020405
007240     MOVE ALL NC"Ｎ" TO P-AZH P-TNAO P-TNAU P-W P-HNA P-BI P-KO.  I.081119
007250     MOVE NC"伝票区分" TO P-DCM.                                  I.081119
007260     MOVE NC"　№" TO P-DNOM.                                     I.081119
007270     MOVE NC"年" TO P-NENM.                                       I.081119
007280     MOVE NC"月" TO P-GETM.                                       I.081119
007290     MOVE NC"日" TO P-PEYM.                                       I.081119
007300     MOVE NC"売　上　伝　票　" TO P-DPM.                          I.081119
007310     MOVE NC"　摘" TO P-TKM1.                                     I.081119
007320     MOVE NC"　合　計" TO P-GOM.                                  I.081119
007330     MOVE NC"消費税　" TO P-SZM.                                  I.081119
007340     MOVE NC"総合計　" TO P-TKM.                                  I.081119
007350     MOVE NC"　要" TO P-TKM2.                                     I.081119
007360*****MOVE ALL "9" TO P-DNO P-HCD P-SUD P-SUT P-T P-KIN            D.081119
007370     MOVE ALL "9" TO P-DNO P-TCD P-HCD P-SUD P-SUT P-T P-KIN      I.081119
007380                     P-ASUT P-AKIN P-SHZ P-TKIN.                  D.070126
007390*****                P-ASUT P-AKIN P-UZ P-SHZ P-SHZZ P-TKIN.      D.070126
007400     MOVE NC"９９９９"   TO  P-KOSU.
007410     MOVE "'" TO P-NC.
007420*****MOVE 999999 TO P-DATE.                                       D.081119
007430     MOVE 99 TO P-NEN P-GET P-PEY.                                I.081119
007440     MOVE 9 TO P-CSC P-DC P-SIZ.
007450     IF JS-SIGN = 0
007460        GO TO M-100.
007470*****COPY LIBCPR.                                                 D.050625
007480*****MOVE D-NHNG TO W-NGD.                                        D.050625
007490*****MOVE W-NGD TO W-NGS.                                         D.060624
007500     DISPLAY D-SHM.
007510     MOVE 0 TO W-NC.                                              I.050625
007520*****DISPLAY A-NEN A-GET.                                         D.050625
007530*M-030.                                                           D.050625
007540*****ACCEPT A-NEN.                                                D.050625
007550*****IF ESTAT = PF9                                               D.050625
007560*****    DISPLAY C-CLEAR                                          D.050625
007570*****    STOP RUN.                                                D.050625
007580*****IF ESTAT NOT = HTB AND SKP                                   D.050625
007590*****    GO TO M-030.                                             D.050625
007600*****MOVE ZERO TO W-NEN1.                                         D.050625
007610*****IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        D.050625
007620*****    ADD DATE-NC1 TO W-NEN.                                   D.050625
007630*****IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        D.050625
007640*****    ADD DATE-NC2 TO W-NEN.                                   D.050625
007650*M-035.                                                           D.050625
007660*****ACCEPT A-GET.                                                D.050625
007670*****IF ESTAT = BTB                                               D.050625
007680*****    GO TO M-030.                                             D.050625
007690*****IF ESTAT NOT = HTB AND SKP                                   D.050625
007700*****    GO TO M-035.                                             D.050625
007710*****IF W-GET < 1 OR > 12                                         D.050625
007720*****    GO TO M-035.                                             D.050625
007730 M-040.
007740     ACCEPT A-SDNO.
007750*****IF ESTAT = BTB                                               D.050625
007760*****    GO TO M-035.                                             D.050625
007770     IF ESTAT = PF9                                               I.050625
007780         MOVE 255 TO COMPLETION-CODE                              I.081119
007790         DISPLAY C-CLEAR                                          I.050625
007800         STOP RUN.                                                I.050625
007810*****IF ESTAT = PF9                                               D.031219
007820*****    DISPLAY C-CLEAR                                          D.031219
007830*****    STOP RUN.                                                D.031219
007840     IF ESTAT NOT = HTB AND SKP
007850         GO TO M-040.
007860 M-060.
007870     ACCEPT A-EDNO.
007880     IF ESTAT = BTB
007890         GO TO M-040.
007900     IF ESTAT = PF9                                               I.050625
007910         MOVE 255 TO COMPLETION-CODE                              I.081119
007920         DISPLAY C-CLEAR                                          I.050625
007930         STOP RUN.                                                I.050625
007940     IF ESTAT NOT = HTB AND SKP
007950         GO TO M-060.
007960     IF W-SDNO > W-EDNO
007970         GO TO M-060.
007980 M-062.                                                           I.050625
007990     ACCEPT A-SNEN.                                               I.050625
008000     IF ESTAT = BTB                                               I.050625
008010         GO TO M-060.                                             I.050625
008020     IF ESTAT = PF9                                               I.050625
008030         MOVE 255 TO COMPLETION-CODE                              I.081119
008040         DISPLAY C-CLEAR                                          I.050625
008050         STOP RUN.                                                I.050625
008060     IF ESTAT NOT = HTB AND SKP                                   I.050625
008070         GO TO M-062.                                             I.050625
008080 M-064.                                                           I.050625
008090     ACCEPT A-SGET.                                               I.050625
008100     IF ESTAT = BTB                                               I.050625
008110         GO TO M-062.                                             I.050625
008120     IF ESTAT = PF9                                               I.050625
008130         MOVE 255 TO COMPLETION-CODE                              I.081119
008140         DISPLAY C-CLEAR                                          I.050625
008150         STOP RUN.                                                I.050625
008160     IF ESTAT NOT = HTB AND SKP                                   I.050625
008170         GO TO M-064.                                             I.050625
008180 M-066.                                                           I.050625
008190     ACCEPT A-SPEY.                                               I.050625
008200     IF ESTAT = BTB                                               I.050625
008210         GO TO M-064.                                             I.050625
008220     IF ESTAT = PF9                                               I.050625
008230         MOVE 255 TO COMPLETION-CODE                              I.081119
008240         DISPLAY C-CLEAR                                          I.050625
008250         STOP RUN.                                                I.050625
008260     IF ESTAT NOT = HTB AND SKP                                   I.050625
008270         GO TO M-066.                                             I.050625
008280     IF W-NEN2 = ZERO                                             I.050625
008290         MOVE ZERO TO W-NEN1                                      I.050625
008300       ELSE                                                       I.050625
008310         MOVE 20 TO W-NEN1.                                       I.050625
008320     MOVE W-NGPD TO W-SNGP.                                       I.050625
008330 M-068.                                                           I.050625
008340     ACCEPT A-ENEN.                                               I.050625
008350     IF ESTAT = BTB                                               I.050625
008360         GO TO M-066.                                             I.050625
008370     IF ESTAT = PF9                                               I.050625
008380         MOVE 255 TO COMPLETION-CODE                              I.081119
008390         DISPLAY C-CLEAR                                          I.050625
008400         STOP RUN.                                                I.050625
008410     IF ESTAT NOT = HTB AND SKP                                   I.050625
008420         GO TO M-068.                                             I.050625
008430     IF W-NEN2 = ZERO                                             I.050625
008440         GO TO M-068.                                             I.050625
008450 M-070.                                                           I.050625
008460     ACCEPT A-EGET.                                               I.050625
008470     IF ESTAT = BTB                                               I.050625
008480         GO TO M-068.                                             I.050625
008490     IF ESTAT = PF9                                               I.050625
008500         MOVE 255 TO COMPLETION-CODE                              I.081119
008510         DISPLAY C-CLEAR                                          I.050625
008520         STOP RUN.                                                I.050625
008530     IF ESTAT NOT = HTB AND SKP                                   I.050625
008540         GO TO M-070.                                             I.050625
008550 M-072.                                                           I.050625
008560     ACCEPT A-EPEY.                                               I.050625
008570     IF ESTAT = BTB                                               I.050625
008580         GO TO M-070.                                             I.050625
008590     IF ESTAT = PF9                                               I.050625
008600         MOVE 255 TO COMPLETION-CODE                              I.081119
008610         DISPLAY C-CLEAR                                          I.050625
008620         STOP RUN.                                                I.050625
008630     IF ESTAT NOT = HTB AND SKP                                   I.050625
008640         GO TO M-072.                                             I.050625
008650     IF W-NEN2 = ZERO                                             I.050625
008660         MOVE ZERO TO W-NEN1                                      I.050625
008670       ELSE                                                       I.050625
008680         MOVE 20 TO W-NEN1.                                       I.050625
008690     MOVE W-NGPD TO W-ENGP.                                       I.050625
008700     IF W-SNGP > W-ENGP                                           I.050625
008710         GO TO M-068.                                             I.050625
008720 M-074.                                                           I.050625
008730     ACCEPT A-STCD.                                               I.050625
008740     IF ESTAT = BTB                                               I.050625
008750         GO TO M-072.                                             I.050625
008760     IF ESTAT = PF9                                               I.050625
008770         MOVE 255 TO COMPLETION-CODE                              I.081119
008780         DISPLAY C-CLEAR                                          I.050625
008790         STOP RUN.                                                I.050625
008800     IF ESTAT NOT = HTB AND SKP                                   I.050625
008810         GO TO M-074.                                             I.050625
008820 M-076.                                                           I.050625
008830     ACCEPT A-ETCD.                                               I.050625
008840     IF ESTAT = BTB                                               I.050625
008850         GO TO M-074.                                             I.050625
008860     IF ESTAT = PF9                                               I.050625
008870         MOVE 255 TO COMPLETION-CODE                              I.081119
008880         DISPLAY C-CLEAR                                          I.050625
008890         STOP RUN.                                                I.050625
008900     IF ESTAT NOT = HTB AND SKP                                   I.050625
008910         GO TO M-076.                                             I.050625
008920     IF W-STCD > W-ETCD                                           I.050625
008930         GO TO M-076.                                             I.050625
008940 M-080.
008950     ACCEPT A-DMM.
008960     IF ESTAT = BTB
008970         GO TO M-076.                                             I.050625
008980*****    GO TO M-060.                                             D.050625
008990     IF ESTAT NOT = HTB AND SKP
009000         GO TO M-080.
009010     IF W-DMM = 9
009020         MOVE 255 TO COMPLETION-CODE                              I.081119
009030         DISPLAY C-CLEAR
009040         STOP RUN.
009050     IF W-DMM NOT = 1
009060         GO TO M-080.
009070*****IF W-NGD = W-NGS                                             D.050625
009080*****    MOVE "SNTRF    " TO SNTRF-ID                             D.050625
009090*****  ELSE                                                       D.050625
009100*****    MOVE "STRANYR  " TO SNTRF-ID.                            D.050625
009110     GO TO M-110.                                                 I.010208
009120 M-100.
009130     PERFORM CHK-RTN THRU CHK-EX.
009140*****IF W-DCHK = 0                                                D.050928
009150     IF W-DCHK = 0 OR 2                                           I.050928
009160         MOVE 255 TO COMPLETION-CODE
009170         DISPLAY E-ME11 E-ME99
009180         DISPLAY C-CLEAR
009190         STOP RUN.
009200*****IF JS-SIGN = 1                                               D.010208
009210*****    IF W-DCHK = 1                                            D.010208
009220*****        MOVE 255 TO COMPLETION-CODE                          D.010208
009230*****        DISPLAY E-ME11 E-ME99                                D.010208
009240*****        DISPLAY C-CLEAR                                      D.010208
009250*****        STOP RUN.                                            D.010208
009260*****IF JS-SIGN = 0                                               D.010208
009270*****IF W-DCHK = 2                                                D.050928
009280*****    MOVE 255 TO COMPLETION-CODE                              D.050928
009290*****    DISPLAY E-ME11 E-ME99                                    D.050928
009300*****    DISPLAY C-CLEAR                                          D.050928
009310*****    STOP RUN.                                                D.050928
009320     IF W-DCHK = 3
009330         MOVE 255 TO COMPLETION-CODE
009340         DISPLAY E-ME4 E-ME99
009350         DISPLAY C-CLEAR
009360         STOP RUN.
009370 M-110.                                                           I.010208
009380     OPEN OUTPUT SP-F.
009390     IF JS-SIGN = 1                                               I.050625
009400         IF W-NC = 0                                              I.050625
009410             MOVE 1 TO W-NC                                       I.050625
009420           ELSE                                                   I.050625
009430             GO TO M-200.                                         I.050625
009440     DISPLAY D-CM.                                                I.081119
009450*****DISPLAY D-CM E-ME99.                                         D.081119
009460*M-120.                                                           D.081119
009470*****PERFORM MID-RTN THRU MID-EX.                                 D.081119
009480*****ADD 1 TO W-GNO.                                              D.081119
009490*****MOVE SPACE TO SP-R.                                          D.081119
009500*****MOVE W-P09 TO SP-R.                                          D.081119
009510*****WRITE SP-R.                                                  D.081119
009520*****MOVE SPACE TO SP-R.                                          D.081119
009530*****MOVE W-P10 TO SP-R.                                          D.081119
009540*****WRITE SP-R.                                                  D.081119
009550 M-140.
009560     ACCEPT A-TPC.
009570     IF ESTAT = PF9                                               I.081119
009580         CLOSE SP-F                                               I.081119
009590         MOVE 255 TO COMPLETION-CODE                              I.081119
009600         DISPLAY C-CLEAR                                          I.081119
009610         STOP RUN.                                                I.081119
009620     IF ESTAT NOT = HTB AND SKP
009630         GO TO M-140.
009640     IF W-TPC = 1
009650*****    MOVE SPACE TO SP-R                                       D.081119
009660*****    WRITE SP-R AFTER PAGE                                    D.081119
009670         GO TO M-200.
009680     IF W-TPC NOT = 9
009690         GO TO M-140.
009700*
009710     PERFORM MID-RTN THRU MID-EX.                                 I.081119
009720 M-150.                                                           I.081119
009730     ADD 1 TO W-GNO.
009740     IF W-GNO NOT = 7
009750         MOVE SPACE TO SP-R
009760         MOVE W-P09 TO SP-R
009770         WRITE SP-R
009780         MOVE SPACE TO SP-R
009790         MOVE W-P10 TO SP-R
009800         WRITE SP-R
009810         GO TO M-150.                                             I.081119
009820*****    GO TO M-140.                                             D.081119
009830     MOVE SPACE TO SP-R.
009840     MOVE W-P11 TO SP-R.
009850     WRITE SP-R AFTER 1.
009860     MOVE SPACE TO SP-R.
009870     MOVE W-P12 TO SP-R.
009880     WRITE SP-R AFTER 1.
009890     MOVE SPACE TO SP-R.
009900     MOVE W-P13 TO SP-R.
009910     WRITE SP-R AFTER 1.
009920     MOVE SPACE TO SP-R.
009930     MOVE W-P14 TO SP-R.
009940     WRITE SP-R AFTER 1.
009950     MOVE SPACE TO SP-R.
009960     MOVE W-P15 TO SP-R.                                          I.081119
009970     WRITE SP-R AFTER 1.                                          I.081119
009980     MOVE SPACE TO SP-R.                                          I.081119
009990*****MOVE W-P15X TO SP-R.                                         D.070126
010000*****WRITE SP-R AFTER 3.                                          D.070126
010010*****MOVE SPACE TO SP-R.                                          D.070126
010020     WRITE SP-R AFTER PAGE.
010030     GO TO M-140.                                                 I.081119
010040*****GO TO M-120.                                                 D.081119
010050 M-200.
010060     MOVE ZERO TO CHK.
010070     OPEN INPUT HI-M T-M TC-M.
010080     IF JS-SIGN = 1
010090         OPEN INPUT STRANYR                                       I.010208
010100         GO TO M-230.                                             I.010208
010110*****    OPEN INPUT S-TRAN                                        D.010208
010120*****    GO TO M-220.                                             D.010208
010130     OPEN I-O S-TRAN.
010140*****OPEN I-O TT-M.                                               D.070126
010150*****OPEN EXTEND HUND-F.                                          D.000825
010160*****OPEN I-O TUKF.                                               D.070126
010170*****OPEN I-O HKBM.                                               D.070126
010180 M-220.
010190     READ S-TRAN AT END
010200         GO TO M-920.
010210     MOVE S-R TO WR-S1.                                           I.010208
010220     IF S1-DHC NOT = 1
010230         GO TO M-240.
010240     GO TO M-220.                                                 I.010208
010250 M-230.                                                           I.010208
010260     READ STRANYR AT END                                          I.010208
010270         GO TO M-920.                                             I.010208
010280     MOVE STRANYR-R TO WR-S1.                                     I.010208
010290*****IF JS-SIGN = 1                                               D.010208
010300*****IF S1-NG < W-NG                                              D.050625
010310     IF S1-NG < W-SNG                                             I.050625
010320         GO TO M-230.                                             I.031219
010330*****IF S1-NG > W-NG                                              D.050625
010340     IF S1-NG > W-ENG                                             I.050625
010350         GO TO M-920.                                             I.031219
010360*****IF S1-DNO < W-SDNO                                           D.050625
010370     IF S1-DNO < W-SDNO OR > W-EDNO                               I.050625
010380         GO TO M-230.                                             I.010221
010390     IF S1-DATE < W-SNGP OR > W-ENGP                              I.050625
010400         GO TO M-230.                                             I.050625
010410     IF S1-TCD < W-STCD OR > W-ETCD                               I.050625
010420         GO TO M-230.                                             I.050625
010430*****    GO TO M-220.                                             D.010221
010440*****IF JS-SIGN = 1                                               D.010208
010450*****IF S1-DNO > W-EDNO                                           D.050625
010460*****    GO TO M-920.                                             D.050625
010470 M-240.
010480     IF W-DZC = 0
010490         MOVE 1 TO W-DZC.
010500     MOVE ZERO TO W-TD W-D.
010510     MOVE S1-DNO TO W-DNO.
010520     MOVE S1-CSC TO W-CSC.
010530     MOVE S1-HSC TO W-HSC.
010540*****IF S1-UNC = 1                                                D.081119
010550*****    IF S1-KIN < 0                                            D.081119
010560*****        MOVE 1 TO CHK1                                       D.081119
010570*****        GO TO M-260                                          D.081119
010580*****      ELSE                                                   D.081119
010590*****        MOVE 5 TO CHK1                                       D.081119
010600*****        GO TO M-260.                                         D.081119
010610*****IF S1-DC = 1 OR 2 OR 5                                       D.081119
010620*****    MOVE 5 TO CHK1                                           D.081119
010630*****    GO TO M-260.                                             D.081119
010640*****IF S1-DC = 0 OR 6                                            D.081119
010650*****    MOVE 1 TO CHK1                                           D.081119
010660*****    GO TO M-260.                                             D.081119
010670*****IF S1-SUT < ZERO                                             D.081119
010680*****    MOVE 5 TO CHK1                                           D.081119
010690*****  ELSE                                                       D.081119
010700*****    MOVE 1 TO CHK1.                                          D.081119
010710*M-260.                                                           D.081119
010720*****IF CHK1 = CHK2                                               D.081119
010730*****    GO TO M-280.                                             D.081119
010740*****IF CHK1 = 1                                                  D.081119
010750*****    DISPLAY D-UDM                                            D.081119
010760*****  ELSE                                                       D.081119
010770*****    DISPLAY D-HDM.                                           D.081119
010780*****DISPLAY E-ME99.                                              D.081119
010790*****MOVE CHK1 TO CHK2.                                           D.081119
010800*M-280.                                                           D.081119
010810     MOVE S1-KOSU TO SV-KOSU.
010820     MOVE S1-TCD2 TO SV-TCD.
010830     MOVE S1-CCD TO SV-CCD2.
010840     MOVE S1-TCD TO T-KEY.
010850     READ T-M WITH UNLOCK INVALID KEY
010860         DISPLAY E-ME10 E-TCD E-ME99
010870         GO TO M-980.
010880*
010890     MOVE 0 TO W-CCC.
010900     IF S1-CCD = ZERO OR 001
010910         GO TO M-300.
010920     MOVE S1-TCD2 TO TC-TCD.
010930     MOVE S1-CCD TO TC-CCD.
010940     READ TC-M WITH UNLOCK INVALID KEY
010950         MOVE 0 TO TC-DHC.
010960     IF TC-DHC NOT = 0
010970         MOVE 1 TO W-CCC.
010980 M-300.
010990*****IF JS-SIGN = 1                                               D.081119
011000*****    GO TO M-320.                                             D.081119
011010*****MOVE S1-TCD TO TT-KEY.                                       D.070126
011020*****READ TT-M INVALID KEY                                        D.070126
011030*****    DISPLAY E-ME2 E-TCD E-ME99                               D.070126
011040*****    GO TO M-980.                                             D.070126
011050*M-320.                                                           D.081119
011060*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P07 W-P08.     D.020603
011070*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            D.081119
011080*****              W-P07 W-P08.                                   D.081119
011090     MOVE SPACE TO W-P01 W-P02 W-P03 W-P06 W-P07 W-P08.           I.081119
011100     MOVE W-15K TO P-15K1 P-15K2.                                 I.081119
011110     MOVE W-20K TO P-20K1.                                        I.081119
011120*****MOVE SPACE TO P-AZH.                                         D.081119
011130     MOVE W-30K TO P-30K.                                         I.051031
011140     MOVE W-40K TO P-40K.                                         I.051031
011150     MOVE SPACE TO P-DCM P-DNOM P-NENM P-GETM P-PEYM P-DPM P-AZH  I.081119
011160                   P-TNAO P-TNAU P-W.                             I.081119
011170     MOVE NC"伝票区分" TO P-DCM.                                  I.081119
011180     MOVE NC"　№" TO P-DNOM.                                     I.081119
011190*****MOVE  NC"日進ゴム株式会社" TO P-NRN.                         D.081119
011200*****MOVE  NC"　〒" TO P-NRUM.                                    D.081119
011210*****MOVE    "700-0975" TO P-NRU.                                 D.081119
011220*****MOVE  NC"　岡山市今８丁目１６番１７号" TO P-NRJ.             D.081119
011230*****MOVE    "TEL (086) 243-2456" TO P-NRT.                       D.081119
011240*****MOVE    "FAX (086) 242-0550" TO P-NRF.                       D.081119
011250*****MOVE    "700-0034" TO P-NRU.                                 D.051207
011260*****MOVE  NC"　岡山市高柳東町１３番４６号" TO P-NRJ.             D.051207
011270*****MOVE    "TEL (086) 252-2456" TO P-NRT.                       D.051207
011280*****MOVE    "FAX (086) 254-8595" TO P-NRF.                       D.051207
011290     MOVE S1-CSC TO P-CSC.
011300     IF S1-UNC = 0
011310         IF S1-DC = 4
011320             MOVE 0 TO P-DC
011330           ELSE
011340             MOVE S1-DC TO P-DC.
011350     IF S1-FRC NOT = 0
011360         MOVE S1-FRC TO P-FRC.
011370     MOVE W-DNO TO P-DNO.
011380     IF S1-UNC = 1                                                I.010523
011390         IF S1-KIN < 0                                            I.010523
011400             MOVE "-" TO P-NBK.                                   I.010523
011410     IF JS-SIGN = 1                                               I.010208
011420         MOVE "." TO P-SHC.                                       I.010208
011430*M-340.                                                           D.020405
011440*****MOVE NC"　〒" TO P-UBM.                                      D.081119
011450*****IF W-CCC = 1                                                 D.081119
011460*****    MOVE TC-UNO TO P-UB                                      D.081119
011470*****  ELSE                                                       D.081119
011480*****    MOVE T-UNO TO P-UB.                                      D.081119
011490     MOVE S1-DATE TO W-NGPD.                                      I.081119
011500     MOVE "'" TO P-NC.
011510     MOVE NC"年" TO P-NENM.                                       I.081119
011520     MOVE NC"月" TO P-GETM.                                       I.081119
011530     MOVE NC"日" TO P-PEYM.                                       I.081119
011540     MOVE W-NEN2 TO P-NEN.                                        I.081119
011550     MOVE W-GET TO P-GET.                                         I.081119
011560     MOVE W-PEY TO P-PEY.                                         I.081119
011570     IF S1-UNC = 0                                                I.081119
011580         IF S1-DC = 0 OR 6                                        I.081119
011590             MOVE NC"売　上　伝　票　" TO P-DPM                   I.081119
011600           ELSE                                                   I.081119
011610             IF S1-DC = 1 OR 2 OR 5                               I.081119
011620                 MOVE NC"返　品　伝　票　" TO P-DPM               I.081119
011630               ELSE                                               I.081119
011640                 IF S1-DC = 3 OR 4 OR 7                           I.081119
011650                     IF S1-SUT < ZERO                             I.081119
011660                         MOVE NC"値　引　伝　票　" TO P-DPM       I.081119
011670                       ELSE                                       I.081119
011680                         MOVE NC"売　上　伝　票　" TO P-DPM.      I.081119
011690     IF S1-UNC = 1                                                I.081119
011700         IF S1-KIN < 0                                            I.081119
011710             MOVE NC"売　上　伝　票　" TO P-DPM                   I.081119
011720           ELSE                                                   I.081119
011730             MOVE NC"値　引　伝　票　" TO P-DPM.                  I.081119
011740*****MOVE S1-DATE TO W-DATE.                                      D.081119
011750*****MOVE W-NGPS TO P-DATE.                                       D.081119
011760*****IF S1-UNC = 1                                                D.081119
011770*****    IF S1-KIN >= 0                                           D.081119
011780*****        MOVE "=======" TO P-MID21.                           D.081119
011790*****IF S1-UNC = 0                                                D.081119
011800*****    IF S1-DC = 1 OR 2 OR 5                                   D.081119
011810*****        MOVE "=======" TO P-MID22                            D.081119
011820*****      ELSE                                                   D.081119
011830*****        IF S1-DC = 3 OR 4 OR 7                               D.081119
011840*****            IF S1-SUT < ZERO                                 D.081119
011850*****                MOVE "=======" TO P-MID22.                   D.081119
011860     IF W-CCC = 1
011870*****    MOVE TC-JSU TO P-JUO                                     D.081119
011880*****    MOVE TC-JSS TO P-JUU                                     D.081119
011890         MOVE TC-NAME TO WN-NAME                                  I.020405
011900*****    MOVE TC-NAME TO P-TNA                                    D.020405
011910       ELSE
011920*****    MOVE T-JSU TO P-JUO                                      D.081119
011930*****    MOVE T-JSS TO P-JUU                                      D.081119
011940         MOVE T-NAME TO WN-NAME.                                  I.020405
011950     COPY LNAMP.                                                  I.020405
011960     MOVE WN-ONAME TO P-TNAO.                                     I.020405
011970     MOVE WN-UNAME TO P-TNAU.                                     I.020405
011980*****    MOVE T-NAME TO P-TNA.                                    D.020405
011990     IF S1-DC = 2
012000         MOVE NC"不良返品　　" TO P-AZH.
012010     IF S1-DC = 3
012020         MOVE NC"預り保管　　" TO P-AZH.
012030     IF S1-DC = 8
012040         MOVE NC"消費税調整分" TO P-AZH.
012050*****MOVE "№ " TO P-W.                                           D.010220
012060     MOVE "(" TO P-TF.                                            I.010220
012070     MOVE T-TNC1 TO P-TNC1.                                       I.010220
012080     MOVE "-" TO P-TV.                                            I.010220
012090     MOVE T-DCC TO P-DCC.                                         I.010220
012100     MOVE ")" TO P-TR.                                            I.010220
012110*****MOVE "№" TO P-W.                                            D.051108
012120     MOVE NC"　№" TO P-W.                                        I.051108
012130     MOVE S1-TCD TO P-TCD.
012140     IF W-CCC = 1
012150         MOVE "-" TO P-V
012160         MOVE S1-CCD TO P-CCD.
012170     IF T-SS NOT = 20 AND 99
012180         IF T-SS > 29
012190             MOVE "**" TO P-X
012200           ELSE
012210             IF T-SS NOT = ZERO
012220                 MOVE " *" TO P-X.
012230     PERFORM MID-RTN THRU MID-EX.
012240     IF S1-DC NOT = 8
012250         GO TO M-360.
012260     ADD S1-KIN TO W-AKIN.
012270     PERFORM MEI-120 THRU MEI-EX.
012280     GO TO M-400.
012290 M-360.
012300     ADD 1 TO W-GNO.
012310     IF W-GNO = 7
012320         DISPLAY E-ME5 E-ME99
012330         GO TO M-980.
012340     IF W-GNO NOT = S1-GNO
012350         DISPLAY E-ME6 E-ME99.
012360     PERFORM MEI-RTN THRU MEI-EX.
012370 M-400.
012380     IF JS-SIGN = 1                                               I.010221
012390         GO TO M-420.                                             I.010221
012400     READ S-TRAN AT END
012410         DISPLAY E-ME7 E-ME99
012420         GO TO M-980.
012430     MOVE S-R TO WR-S1.                                           I.010208
012440     GO TO M-440.                                                 I.010208
012450 M-420.                                                           I.010208
012460     READ STRANYR AT END                                          I.010208
012470         DISPLAY E-ME7 E-ME99                                     I.010208
012480         GO TO M-980.                                             I.010208
012490     MOVE STRANYR-R TO WR-S1.                                     I.010208
012500 M-440.                                                           I.010208
012510     IF S1-DNO = W-DNO
012520         IF S1-GNO NOT = 9
012530             GO TO M-360.
012540     IF S1-DNO NOT = W-DNO
012550         DISPLAY E-ME7 E-ME99
012560         GO TO M-980.
012570     PERFORM KEI-RTN THRU KEI-EX.
012580     IF JS-SIGN = 1                                               I.010208
012590         GO TO M-230                                              I.010208
012600       ELSE                                                       I.010208
012610         GO TO M-220.
012620 M-920.
012630     IF W-DZC = 0
012640         DISPLAY E-ME11 E-ME99.
012650 M-980.
012660*****CLOSE S-TRAN.                                                D.010208
012670     CLOSE HI-M T-M TC-M.
012680     CLOSE SP-F.                                                  I.050625
012690*****IF JS-SIGN = 0                                               D.010208
012700     IF JS-SIGN = 1                                               I.010208
012710         CLOSE STRANYR                                            I.010208
012720         GO TO M-040                                              I.050625
012730       ELSE                                                       I.010208
012740         CLOSE S-TRAN.                                            I.070126
012750*****    CLOSE S-TRAN                                             D.070126
012760*****    CLOSE TT-M                                               D.070126
012770*****    CLOSE HKBM                                               D.070126
012780*****    CLOSE TUKF.                                              D.070126
012790*****    CLOSE TUKF                                               D.000825
012800*****    CLOSE HUND-F.                                            D.000825
012810*****CLOSE SP-F.                                                  D.050625
012820     DISPLAY C-CLEAR.
012830     STOP RUN.
012840 MID-RTN.
012850     MOVE SPACE TO SP-R.
012860     MOVE W-15K TO P-15K1 P-15K2.                                 I.081119
012870     MOVE W-20K TO P-20K1.                                        I.081119
012880     MOVE W-30K TO P-30K.                                         I.081119
012890     MOVE W-40K TO P-40K.                                         I.081119
012900*****MOVE W-15K TO P-15K1.                                        D.081119
012910*****MOVE W-15K TO P-15K1 P-CD1 P-CD4.                            D.020405
012920*****MOVE W-20K TO P-CD3 P-CD11.                                  D.020405
012930     MOVE W-P01 TO SP-R.
012940     WRITE SP-R.
012950     MOVE SPACE TO SP-R.
012960     MOVE W-P02 TO SP-R.
012970     WRITE SP-R AFTER 2.
012980     MOVE SPACE TO SP-R.
012990     MOVE W-P03 TO SP-R.
013000     WRITE SP-R.
013010     MOVE SPACE TO SP-R.
013020*****MOVE W-P04 TO SP-R.                                          D.081119
013030*****WRITE SP-R AFTER 2.                                          D.081119
013040*****WRITE SP-R.                                                  D.020405
013050*****MOVE SPACE TO SP-R.                                          D.081119
013060*****MOVE W-P05 TO SP-R.                                          D.081119
013070*****WRITE SP-R.                                                  D.081119
013080*****MOVE SPACE TO SP-R.                                          D.081119
013090     MOVE W-P06 TO SP-R.                                          I.020603
013100     WRITE SP-R AFTER 4.                                          I.081119
013110*****WRITE SP-R.                                                  .D081119
013120     MOVE SPACE TO SP-R.                                          I.020603
013130     MOVE W-P07 TO SP-R.
013140     WRITE SP-R.                                                  I.020603
013150*****WRITE SP-R AFTER 2.                                          D.020603
013160     MOVE SPACE TO SP-R.
013170     MOVE W-P08 TO SP-R.
013180     WRITE SP-R.                                                  I.020405
013190*****WRITE SP-R AFTER 2.                                          D.020405
013200     MOVE SPACE TO SP-R.
013210*****WRITE SP-R AFTER 5.                                          D.081119
013220*
013230     MOVE SPACE TO W-P08A.                                        I.081119
013240     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
013250     MOVE "1         SS   S   M   L  LL 28.029.030.0" TO P-SIZM.  I.081119
013260     MOVE W-P08A TO SP-R.                                         I.081119
013270     WRITE SP-R AFTER 2.                                          I.081119
013280     MOVE SPACE TO SP-R.                                          I.081119
013290     MOVE SPACE TO W-P08A.                                        I.081119
013300     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
013310     MOVE "212.513.013.514.015.016.017.018.019.020.0" TO P-SIZM.  I.081119
013320     MOVE W-P08A TO SP-R.                                         I.081119
013330     WRITE SP-R.                                                  I.081119
013340     MOVE SPACE TO SP-R.                                          I.081119
013350     MOVE SPACE TO W-P08A.                                        I.081119
013360     MOVE NC"品　　　　　名　" TO P-HMM.                          I.081119
013370     MOVE NC"　数量　" TO P-SUM.                                  I.081119
013380     MOVE NC"単価" TO P-TM.                                       I.081119
013390     MOVE NC"金　　額" TO P-KINM.                                 I.081119
013400     MOVE "321.021.522.022.523.023.524.024.525.0    " TO P-SIZM.  I.081119
013410     MOVE W-P08A TO SP-R.                                         I.081119
013420     WRITE SP-R.                                                  I.081119
013430     MOVE SPACE TO SP-R.                                          I.081119
013440     MOVE SPACE TO W-P08A.                                        I.081119
013450     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
013460     MOVE "424.024.525.025.526.026.527.027.5        " TO P-SIZM.  I.081119
013470     MOVE W-P08A TO SP-R.                                         I.081119
013480     WRITE SP-R.                                                  I.081119
013490     MOVE SPACE TO SP-R.                                          I.081119
013500     MOVE ZERO TO W-GNO.
013510 MID-EX.
013520     EXIT.
013530 MEI-RTN.
013540     MOVE S1-DC TO W-DC.
013550     MOVE SPACE TO W-P09 W-P10.
013560     MOVE SPACE TO P-HNA.                                         I.081119
013570     MOVE W-15K TO P-15K3.                                        I.081119
013580     MOVE W-20K TO P-20K2.                                        I.081119
013590*****MOVE W-15K TO P-15K2.                                        D.081119
013600*****MOVE W-20K TO P-20K1.                                        D.081119
013610*****IF S1-UNC = 1                                                D.000819
013620     IF (S1-UNC = 1) OR (S1-HCD > 999899) OR (S1-DC = 3)          I.000819
013630         GO TO MEI-040.
013640     MOVE ZERO TO CNT W-ASU.
013650 MEI-020.
013660     ADD 1 TO CNT.
013670     IF CNT = 11
013680         GO TO MEI-040.
013690     MOVE S1-SU(CNT) TO W-SU(CNT).
013700     IF W-SU(CNT) NOT = ZERO
013710         MOVE W-SU(CNT) TO P-SU(CNT).
013720     GO TO MEI-020.
013730 MEI-040.
013740     IF S1-HCD NOT = ZERO
013750         MOVE S1-HCD TO P-HCD
013760         IF S1-UNC = 0
013770             MOVE S1-SIZ TO P-SIZ.
013780     MOVE S1-SUT TO W-SUT.
013790     IF S1-HCD = ZERO
013800         GO TO MEI-100.
013810     IF S1-DC = 3 OR 4 OR 7
013820         IF W-SUT < ZERO
013830             COMPUTE W-SUT = W-SUT * -1.
013840     MOVE W-SUT TO P-SUT.
013850     IF S1-DC NOT = 4
013860         GO TO MEI-060.
013870     IF S1-SUT < ZERO
013880         MOVE NC"預りへ戻し" TO P-AZM
013890       ELSE
013900         MOVE NC"預り出荷　" TO P-AZM.
013910     GO TO MEI-080.
013920 MEI-060.
013930     IF S1-DC = 9
013940         MOVE NC"預り振替　"    TO P-AZM
013950         GO TO MEI-080.
013960     MOVE S1-T TO P-T.
013970     MOVE S1-KIN TO W-KIN.
013980*****IF S1-DC = 3                                                 D.010523
013990     IF (S1-DC = 3) OR (S1-UNC = 1)                               I.010523
014000         IF W-KIN < ZERO
014010             COMPUTE W-KIN = W-KIN * -1.
014020     MOVE W-KIN TO P-KIN.
014030 MEI-080.
014040     MOVE S1-HCD TO HI-KEY.
014050     READ HI-M WITH UNLOCK INVALID KEY
014060         DISPLAY E-ME3 E-HCD E-ME99
014070         MOVE SPACE TO HI-NAME.
014080*****IF S1-TCD = 0459 OR 0460                                     D.010419
014090*****IF S1-TCD = 0458 OR 0459 OR 0460                             D.010709
014100     IF S1-TCD = 0013 OR 0458 OR 0459 OR 0460                     I.010709
014110         MOVE HI-NAME TO W-NAME                                   I.000821
014120         MOVE SPACE TO W-NA(24)                                   I.000821
014130         MOVE W-NAME TO P-HNA                                     I.000821
014140       ELSE                                                       I.000821
014150         MOVE HI-NAME TO P-HNA.
014160     IF S1-UNC = 0
014170         IF S1-BIK NOT = SPACE
014180             MOVE "[" TO P-F
014190             MOVE S1-BIK TO P-BIK
014200             MOVE "]" TO P-R.
014210 MEI-100.
014220     MOVE SPACE TO SP-R.
014230     MOVE W-P09 TO SP-R.
014240     WRITE SP-R.
014250     MOVE SPACE TO SP-R.
014260     MOVE W-P10 TO SP-R.
014270     WRITE SP-R.
014280     IF S1-HCD <  999900
014290         ADD W-SUT TO W-ASUT.
014300     IF S1-DC NOT = 4 AND 9
014310         ADD S1-KIN TO W-AKIN.
014320*****IF S1-UNC = 0                                                D.071003
014330*****    IF S1-DC NOT = 4                                         D.071003
014340*****        IF JS-SIGN = 0                                       D.071003
014350*****            COMPUTE W-UG = W-UG + (S1-SUT * S1-FT).          D.072103
014360 MEI-120.
014370     IF JS-SIGN = 1
014380         GO TO MEI-EX.
014390     MOVE 1 TO S1-DHC.
014400     MOVE WR-S1 TO S-R.                                           I.010208
014410*****REWRITE S-R1.                                                D.010208
014420     REWRITE S-R.                                                 I.010208
014430     IF ERR-STAT NOT = "00"
014440         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
014450         DISPLAY E-CL.
014460 MEI-EX.
014470     EXIT.
014480 KEI-RTN.
014490     MOVE SPACE TO W-P11 W-P12 W-P13 W-P14.                       I.081119
014500     MOVE ALL NC"　" TO P-KOSU P-KO P-CNAM P-TKM1 P-GOM P-BI      I.081119
014510                        P-HNM P-SZM P-TKM.                        I.081119
014520*****MOVE SPACE TO W-P12 W-P14 W-P15X.                            D.070126
014530*****MOVE SPACE TO W-P12 W-P14.                                   D.081119
014540*****MOVE W-20K TO P-20K2.                                        D.081119
014550*****MOVE ALL NC"　" TO P-BI P-HNM P-CNAM P-KOSU P-KO.            D.081119
014560*****MOVE W-15K TO P-CD1 P-CD4.                                   D.020405
014570*****MOVE W-20K TO P-CD3 P-CD11.                                  D.020405
014580 KEI-020.
014590     IF SV-KOSU NOT = ZERO
014600        MOVE SV-KOSU TO   W-KOSU
014610        MOVE W-KOSU  TO   P-KOSU
014620        MOVE NC"個口" TO  P-KO.
014630     IF SV-CCD2 NOT = ZERO AND 001
014640         IF W-CCC = 0
014650             PERFORM TNA-RTN THRU TNA-EX.
014660     MOVE S2-BI TO P-BI.
014670     MOVE NC"　摘" TO P-TKM1.                                     I.081119
014680     MOVE NC"　合　計" TO P-GOM.                                  I.081119
014690     MOVE NC"消費税　" TO P-SZM.                                  I.081119
014700     MOVE NC"総合計　" TO P-TKM.                                  I.081119
014710*****IF S2-HN1 = ZERO                                             D.081224
014720     IF S2-HNO = ZERO                                             I.081224
014730         GO TO KEI-040.
014740*****MOVE NC"※発送明細書№"   TO P-HNM.                          D.020405
014750     MOVE NC"　※発送明細書№" TO P-HNM.                          I.020405
014760     MOVE S2-HNO TO P-HNO.                                        I.081224
014770*****IF S2-HN1 NOT = ZERO                                         D.081224
014780*****    MOVE S2-HN1 TO P-HN1.                                    D.081224
014790*****IF S2-HN2 NOT = ZERO                                         D.081224
014800*****    MOVE "," TO P-C2                                         D.081224
014810*****    MOVE S2-HN2 TO P-HN2.                                    D.081224
014820*****IF S2-HN3 NOT = ZERO                                         D.081224
014830*****    MOVE "," TO P-C3                                         D.081224
014840*****    MOVE S2-HN3 TO P-HN3.                                    D.081224
014850*****IF S2-HN4 NOT = ZERO                                         D.081224
014860*****    MOVE "," TO P-C4                                         D.081224
014870*****    MOVE S2-HN4 TO P-HN4.                                    D.081224
014880*****IF S2-HN5 NOT = ZERO                                         D.081224
014890*****    MOVE "," TO P-C5                                         D.081224
014900*****    MOVE S2-HN5 TO P-HN5.                                    D.081224
014910*****IF S2-HN6 NOT = ZERO                                         D.081224
014920*****    MOVE "," TO P-C6                                         D.081224
014930*****    MOVE S2-HN6 TO P-HN6.                                    D.081224
014940 KEI-040.
014950     IF W-GNO = ZERO
014960         MOVE W-AKIN TO W-SHZ W-KINZ
014970         MOVE ZERO TO W-AKIN W-KIN
014980         GO TO KEI-060.
014990     MOVE W-ASUT TO P-ASUT.
015000     MOVE W-AKIN TO W-KIN.
015010     IF W-HSC = 0
015020         COMPUTE W-SHZ ROUNDED = W-KIN * 0.05.
015030     IF W-HSC = 3
015040         COMPUTE W-SHZ ROUNDED = W-KIN * 0.03.
015050     MOVE W-SHZ TO W-KINZ.
015060*****IF W-DC = 3                                                  D.010523
015070     IF (W-DC = 3) OR (S2-UNC = 1)                                I.010523
015080         IF W-KIN < ZERO
015090             COMPUTE W-KIN = W-KIN * -1
015100             COMPUTE W-KINZ = W-KINZ * -1.
015110 KEI-060.
015120     MOVE W-KIN TO P-AKIN.
015130*****IF W-KINZ NOT = ZERO                                         D.081119
015140*****    IF W-HSC = 0                                             D.081119
015150*****        MOVE "(5%)" TO P-ZR                                  D.081119
015160*****      ELSE                                                   D.081119
015170*****        IF W-HSC = 3                                         D.081119
015180*****            MOVE "(3%)" TO P-ZR.                             D.081119
015190     MOVE W-KINZ TO P-SHZ.
015200     COMPUTE W-TKIN = W-KIN + W-KINZ.
015210     MOVE W-TKIN TO P-TKIN.
015220     IF JS-SIGN = 0
015230         IF W-DC = 1 OR 2 OR 5
015240             COMPUTE W-AKIN = W-AKIN * -1
015250             COMPUTE W-SHZ = W-SHZ * -1.                          I.071003
015260*****        COMPUTE W-SHZ = W-SHZ * -1                           D.071003
015270*****        COMPUTE W-UG = W-UG * -1.                            D.071003
015280*****IF JS-SIGN NOT = 0                                           D.070126
015290*****    MOVE S2-UZ TO P-UZ                                       D.070126
015300*****    MOVE S2-SHZZ TO P-SHZZ                                   D.070126
015310*****    GO TO KEI-080.                                           D.070126
015320*****IF S2-UNC = 0                                                D.070126
015330*****    COMPUTE W-KIN = TT-TUZ + W-AKIN                          D.070126
015340*****    COMPUTE W-KINZ = TT-TUZZ + W-SHZ                         D.070126
015350*****  ELSE                                                       D.070126
015360*****    COMPUTE W-KIN = TT-TUZ - W-AKIN                          D.070126
015370*****    COMPUTE W-KINZ = TT-TUZZ - W-SHZ.                        D.070126
015380*****MOVE W-KIN TO P-UZ.                                          D.070126
015390*****MOVE W-KINZ TO P-SHZZ.                                       D.070126
015400*KEI-080.                                                         D.070126
015410     ADD 1 TO W-GNO.
015420*
015430     MOVE SPACE TO SP-R.
015440     MOVE W-P11 TO SP-R.
015450     WRITE SP-R AFTER W-AL(W-GNO).
015460     MOVE SPACE TO SP-R.
015470     MOVE W-P12  TO SP-R.
015480     WRITE SP-R AFTER 1.
015490     MOVE SPACE TO SP-R.
015500     MOVE W-P13 TO SP-R.
015510     WRITE SP-R AFTER 1.
015520     MOVE SPACE TO SP-R.
015530*****MOVE W-20K TO P-20K2.                                        D.081119
015540     MOVE W-P14 TO SP-R.
015550     WRITE SP-R AFTER 1.
015560     MOVE SPACE TO SP-R.
015570     MOVE W-P15 TO SP-R.                                          I.081119
015580     WRITE SP-R AFTER 1.                                          I.081119
015590     MOVE SPACE TO SP-R.                                          I.081119
015600*****MOVE W-20K TO P-20K2.                                        D.070126
015610*****MOVE W-P15X TO SP-R.                                         D.070126
015620*****WRITE SP-R AFTER 3.                                          D.070126
015630     MOVE SPACE TO SP-R.
015640     WRITE SP-R AFTER PAGE.
015650     IF JS-SIGN = 1
015660         GO TO KEI-EX.
015670*****MOVE W-KIN TO TT-TUZ.                                        D.070126
015680*****MOVE W-KINZ TO TT-TUZZ.                                      D.070126
015690*****IF S2-UNC = 0                                                D.070126
015700*****    ADD W-AKIN TO TT-TUA                                     D.070126
015710*****    ADD W-SHZ TO TT-TUAZ                                     D.070126
015720*****    ADD W-UG TO TT-TUG                                       D.070126
015730*****  ELSE                                                       D.070126
015740*****    ADD W-AKIN TO TT-TNB                                     D.070126
015750*****    ADD W-SHZ TO TT-TNBZ.                                    D.070126
015760*****IF S2-UNC = 0                                                D.001123
015770*****    IF W-CSC = 0                                             D.001123
015780*****        ADD W-AKIN TO TT-SUA                                 D.001123
015790*****        ADD W-SHZ TO TT-SUAZ                                 D.001123
015800*****      ELSE                                                   D.001123
015810*****        ADD W-AKIN TO TT-STS                                 D.001123
015820*****        ADD W-SHZ TO TT-STSZ.                                D.001123
015830*****IF S2-UNC NOT = 0                                            D.001123
015840*****    IF W-CSC = 0                                             D.001123
015850*****        SUBTRACT W-AKIN FROM TT-SUA                          D.001123
015860*****        SUBTRACT W-SHZ FROM TT-SUAZ                          D.001123
015870*****      ELSE                                                   D.001123
015880*****        SUBTRACT W-AKIN FROM TT-STS                          D.001123
015890*****        SUBTRACT W-SHZ FROM TT-STSZ.                         D.001123
015900*****REWRITE TT-R INVALID KEY                                     D.070126
015910*****    DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      D.070126
015920*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
015930*KEI-100.                                                         D.000825
015940*****MOVE ZERO TO HUND-R.                                         D.000825
015950*****MOVE W-DATE TO UN-DATE.                                      D.000825
015960*****MOVE W-DNO TO UN-NO.                                         D.000825
015970*****MOVE T-KEY TO UN-TCD.                                        D.000825
015980*****MOVE W-SHZ TO UN-SHZ.                                        D.000825
015990*****MOVE W-AKIN TO UN-KIN.                                       D.000825
016000*****MOVE W-CSC TO UN-CSC.                                        D.000825
016010*****MOVE S2-UNC TO UN-UNC.                                       D.000825
016020*****WRITE HUND-R.                                                D.000825
016030*****IF ERR-STAT = "00"                                           D.000825
016040*****    CALL "CBLTCLS" USING HUND-F                              D.000825
016050*****    GO TO KEI-120.                                           D.000825
016060*****DISPLAY E-STAT E-ME26 E-ME99.                                D.000825
016070*****IF ERR-STAT NOT = "34"                                       D.000825
016080*****    DISPLAY E-ME78 E-ME99                                    D.000825
016090*****    GO TO KEI-120.                                           D.000825
016100*****DISPLAY E-CL.                                                D.000825
016110*****CLOSE HUND-F.                                                D.000825
016120*****MOVE "HUNDF        " TO W-FILE.                              D.000825
016130*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000825
016140*****DISPLAY E-CL.                                                D.000825
016150*****OPEN EXTEND HUND-F.                                          D.000825
016160*****GO TO KEI-100.                                               D.000825
016170 KEI-120.
016180*****MOVE W-KINZ TO S2-SHZZ.                                      D.070126
016190*****MOVE W-KIN TO S2-UZ.                                         D.070126
016200     MOVE W-SHZ TO S2-TAX.
016210     MOVE 1 TO S2-DHC.
016220     MOVE WR-S2 TO S-R.                                           I.010208
016230*****REWRITE S-R2.                                                D.010208
016240     REWRITE S-R.                                                 I.010208
016250     IF ERR-STAT NOT = "00"
016260         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
016270         DISPLAY E-CL.
016280*
016290*****MOVE SPACE TO HKB-KEY.                                       D.070126
016300*****MOVE "05" TO HKB-NO.                                         D.070126
016310*****READ HKBM INVALID KEY                                        D.070126
016320*****    DISPLAY E-ME78 E-ME1 E-ME99                              D.070126
016330*****    GO TO KEI-140.                                           D.070126
016340*****MOVE HKB-DAI TO W-DAI.                                       D.070126
016350*****GO TO KEI-160.                                               D.070126
016360*KEI-140.                                                         D.070126
016370*****INITIALIZE HKB-R.                                            D.070126
016380*****MOVE SPACE TO HKB-KEY.                                       D.070126
016390*****MOVE "05" TO HKB-NO.                                         D.070126
016400*****WRITE HKB-R INVALID KEY                                      D.070126
016410*****    DISPLAY E-ME78 E-STAT E-ME27 E-ME99                      D.070126
016420*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
016430*****INITIALIZE W-DAI.                                            D.070126
016440*KEI-160.                                                         D.070126
016450*****COPY LDAIP.                                                  D.070126
016460*****IF W-DAI1 = "999"                                            D.070126
016470*****    DISPLAY E-ME78 E-ME50 E-ME99                             D.070126
016480*****    DISPLAY E-CL.                                            D.070126
016490*****MOVE W-DAI TO HKB-DAI.                                       D.070126
016500*****REWRITE HKB-R INVALID KEY                                    D.070126
016510*****    DISPLAY E-ME78 E-STAT E-ME23 E-ME99                      D.070126
016520*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
016530*KEI-180.                                                         D.070126
016540*****INITIALIZE TUK-R.                                            D.070126
016550*****MOVE T-KEY TO TUK-TCD.                                       D.030912
016560*****MOVE T-KEY TO TUK-TCD TUK-TCD2.                              D.070126
016570*****MOVE W-DAI TO TUK-DAI.                                       D.070126
016580*****MOVE W-DATE TO TUK-DATE.                                     D.070126
016590*****IF S2-UNC = 0                                                D.070126
016600*****    MOVE 1 TO TUK-DC                                         D.070126
016610*****  ELSE                                                       D.070126
016620*****    MOVE 2 TO TUK-DC.                                        D.070126
016630*****MOVE W-AKIN TO TUK-KIN.                                      D.070126
016640*****MOVE W-SHZ TO TUK-SHZ.                                       D.070126
016650*****MOVE W-DNO TO TUK-DNO.                                       D.070126
016660*****MOVE 0 TO TUK-GNO.                                           D.070126
016670*****MOVE T-TNC TO TUK-TNC.                                       D.070126
016680*****MOVE T-DCC TO TUK-DCC.                                       D.070126
016690*****MOVE T-DNO TO TUK-DCN.                                       D.010220
016700*****MOVE 0 TO TUK-BMC.                                           D.070126
016710*****WRITE TUK-R INVALID KEY                                      D.070126
016720*****    DISPLAY E-STAT E-ME28 E-ME99                             D.070126
016730*****    GO TO KEI-200.                                           D.070126
016740*****GO TO KEI-EX.                                                D.070126
016750*KEI-200.                                                         D.070126
016760*****IF ERR-STAT NOT = "24"                                       D.070126
016770*****    DISPLAY E-ME78 E-ME99                                    D.070126
016780*****    GO TO KEI-EX.                                            D.070126
016790*****DISPLAY E-CL.                                                D.070126
016800*****CLOSE TUKF.                                                  D.070126
016810*****MOVE "TUKF         " TO W-FILE.                              D.070126
016820*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.070126
016830*****DISPLAY E-CL.                                                D.070126
016840*****OPEN I-O TUKF.                                               D.070126
016850*****GO TO KEI-180.                                               D.070126
016860 KEI-EX.
016870     EXIT.
016880 TNA-RTN.
016890     MOVE SV-TCD TO TC-TCD.
016900     MOVE SV-CCD2 TO TC-CCD.
016910     READ TC-M UNLOCK INVALID KEY
016920         MOVE SPACE TO TC-NAME.
016930     MOVE TC-NAME TO P-CNAM.
016940     MOVE P-CNAM TO TBL-NAM.
016950     MOVE 26 TO N.                                                I.020405
016960*****MOVE 24 TO N.                                                D.020405
016970 TNA-020.
016980     IF N = 0
016990         GO TO TNA-EX.
017000     IF T-NAM(N) NOT = SPACE AND NC"　"
017010         GO TO TNA-040.
017020     COMPUTE N = N - 1.
017030     GO TO TNA-020.
017040 TNA-040.
017050*****IF W-DC = 1 OR 2 OR 5                                        D.050614
017060     IF W-DC = 1 OR 2                                             I.050614
017070         ADD 1 TO N
017080         MOVE NC"様" TO T-NAM(N)
017090         ADD 1 TO N
017100         MOVE NC"よ" TO T-NAM(N)
017110         ADD 1 TO N
017120         MOVE NC"り" TO T-NAM(N)
017130         ADD 1 TO N
017140         MOVE NC"返" TO T-NAM(N)
017150         ADD 1 TO N
017160         MOVE NC"品" TO T-NAM(N)
017170         MOVE TBL-NAM TO P-CNAM
017180         GO TO TNA-EX.
017190     ADD 1 TO N.
017200     MOVE NC"様" TO T-NAM(N).
017210     ADD 1 TO N.
017220     MOVE NC"　" TO T-NAM(N).
017230     ADD 1 TO N.
017240     MOVE NC"直" TO T-NAM(N).
017250     ADD 1 TO N.
017260     MOVE NC"送" TO T-NAM(N).
017270     MOVE TBL-NAM TO P-CNAM.
017280 TNA-EX.
017290     EXIT.
017300 CHK-RTN.
017310     MOVE 0 TO W-DCHK.
017320     OPEN INPUT S-TRAN.
017330 CHK-020.
017340     READ S-TRAN AT END
017350         GO TO CHK-040.
017360     MOVE S-R TO WR-S1.                                           I.050928
017370     IF W-DCHK = 1
017380         IF S1-DHC = 1
017390             MOVE 3 TO W-DCHK
017400             GO TO CHK-040
017410           ELSE
017420             GO TO CHK-020.
017430     IF W-DCHK = 2
017440         IF S1-DHC NOT = 1
017450             MOVE 3 TO W-DCHK
017460             GO TO CHK-040
017470           ELSE
017480             GO TO CHK-020.
017490     IF S1-DHC NOT = 1
017500         MOVE 1 TO W-DCHK
017510       ELSE
017520         MOVE 2 TO W-DCHK.
017530     GO TO CHK-020.
017540 CHK-040.
017550     CLOSE S-TRAN.
017560 CHK-EX.
017570     EXIT.
017580 ERR-RTN.
017590     DISPLAY E-ME99
017600     GO TO ERR-RTN.
017610 ERR-EX.
017620     EXIT.
