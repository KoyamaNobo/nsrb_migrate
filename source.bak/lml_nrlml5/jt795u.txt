000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT795U.
000030 AUTHOR.                        I.N.
000040***************************************************
000050*    PROGRAM        : 受注・預り・取よけ台帳抽出  *
000060*                   : JS-SIGN  0=当月  1=前月     *
000070*    DATA WRITTEN   : 95/10/03                    *
000080*    SCREEN USED    : UNUSED                      *
000090*    FORM   USED    : UNUSED                      *
000100*    PRINTER TYPE   : UNUSED                      *
000110*    COMPILE TYPE   : COBOL                       *
000120***************************************************
000130 ENVIRONMENT                    DIVISION.
000140 CONFIGURATION                  SECTION.
000150 SOURCE-COMPUTER.               SYSTEM150.
000160 OBJECT-COMPUTER.               SYSTEM150.
000170 INPUT-OUTPUT                   SECTION.
000180 FILE-CONTROL.
000190**   前月受注マスタ(KEY1)  **
000200     SELECT   DJMST     ASSIGN  F1-MSD
000210                        ORGANIZATION  INDEXED
000220                        ACCESS MODE   DYNAMIC
000230                        RECORD KEY    DJMST-KEY1.
000240**   前月出荷累積ファイル  **
000250*****SELECT   DJSRU     ASSIGN  F2-MSD                            D.971208
000260     SELECT   DJNSR     ASSIGN  F2-MSD                            I.971208
000270                        ORGANIZATION  INDEXED                     I.060825
000280                        ACCESS MODE   DYNAMIC                     I.060825
000290                        RECORD KEY    DJNSR-KEY2                  I.060825
000300*****                   ORGANIZATION  SEQUENTIAL                  D.060825
000310                        FILE  STATUS  ERR-STAT.
000320**   受注マスタ(KEY1)  **
000330     SELECT   JMST1     ASSIGN  F3-MSD                            I.981202
000340                        ORGANIZATION  INDEXED                     I.981202
000350                        ACCESS MODE   DYNAMIC                     I.981202
000360                        RECORD KEY    JMST1-KEY1.                 I.981202
000370**   出荷累積ファイル  **
000380     SELECT   JNSR      ASSIGN  F41-MSD  F42-MSD  F43-MSD         I.981202
000390                        ORGANIZATION  INDEXED                     I.981202
000400                        ACCESS MODE   DYNAMIC                     I.981202
000410                        RECORD KEY    JNSR-KEY1                   I.981202
000420              ALTERNATE RECORD KEY    JNSR-KEY2                   I.981202
000430              ALTERNATE RECORD KEY    JNSR-KEY3.                  I.981202
000440**   ワークファイル(05)  **
000450     SELECT   JT-WK05   ASSIGN  F5-MSD
000460                        ORGANIZATION  SEQUENTIAL
000470                        FILE  STATUS  ERR-STAT.
000480**   コントロールＦ  **
000490     SELECT   JCON      ASSIGN  F6-MSD
000500                        ORGANIZATION  INDEXED
000510                        ACCESS MODE   RANDOM
000520                        RECORD KEY    JCON6-KEY.
000530 I-O-CONTROL.
000540*****APPLY   SHARED-MODE      ON  DJMST  DJSRU  JCON              D.971208
000550*****APPLY   SHARED-MODE      ON  DJMST  DJNSR  JCON              D.981202
000560     APPLY   SHARED-MODE      ON  DJMST  DJNSR  JMST1  JNSR  JCON I.981202
000570     APPLY   EXCLUSIVE-MODE   ON  JT-WK05.
000580*
000590*
000600 DATA                       DIVISION.
000610 FILE                       SECTION.
000620     COPY  LJMST1.                                                I.981202
000630     COPY  L-JNSR.                                                I.981202
000640***  前月受注マスタ  （ＫＥＹ１）
000650*
000660 FD  DJMST                                                        ｼｭﾁｭｳ
000670     BLOCK    3     RECORDS                                       ﾏｽﾀｰ
000680     LABEL    RECORD   STANDARD
000690     VALUE    OF  IDENTIFICATION  "BU-JMST1".                     I.060825
000700*****VALUE    OF  IDENTIFICATION  "DJMST".                        D.060825
000710*
000720 01  DJMST-R.
000730     02   DJMST-01                  PIC 9(1).                     ｱｽﾞｶﾘ
000740     02   DJMST-02.                                               ｼﾞｭﾁｭｳﾋﾞ
000750*****     03   DJMST-021            PIC 9(2).                     D.980527
000760          03   DJMST-021            PIC 9(4).                     I.980527
000770          03   DJMST-022            PIC 9(2).                     ﾂｷ
000780          03   DJMST-023            PIC 9(2).                     ﾋ
000790     02   DJMST-03                  PIC 9(6).                     ﾋﾝｺｰﾄﾞ
000800     02   DJMST-04                  PIC 9(4).                     ﾄｸｲｺｰﾄﾞ
000810     02   DJMST-05                  PIC 9(6).                     ﾋﾝｺｰﾄﾞ
000820     02   DJMST-06.                                               ﾉｳｷ
000830*****     03   DJMST-061            PIC 9(2).                     D.980527
000840          03   DJMST-061            PIC 9(4).                     I.980527
000850          03   DJMST-062            PIC 9(2).                     ﾂｷ
000860          03   DJMST-063            PIC 9(2).                     ﾋ
000870     02   DJMST-KEY1.
000880          03   DJMST-07             PIC 9(6).                     ｼﾞｭﾁｭｳNO
000890          03   DJMST-08             PIC 9(1).                     ｷﾞｮｳ NO
000900     02   DJMST-09                  PIC 9(1).                     ｻｲｽﾞｸﾌﾞﾝ
000910     02   DJMST-10                  PIC 9(3).                     ﾁｮｸｿｳ NO
000920     02   DJMST-11.                                               ｼﾞｭﾁｭｳｽｳ
000930          03  DJMST-111            OCCURS  10.                    ｻｲｽﾞﾍﾞﾂ
000940              04  DJMST-1111       PIC S9(6)   COMP-3.
000950     02   DJMST-12.                                               ｼｭｯｺｽｳ
000960          03  DJMST-121            OCCURS  10.                    ｻｲｽﾞﾍﾞﾂ
000970              04  DJMST-1211       PIC S9(6)   COMP-3.
000980     02   DJMST-14.                                               ｾﾞﾝｹﾞﾂﾏﾂ
000990          03  DJMST-141  OCCURS 10 PIC S9(06)  COMP-3.            ｻｲｽﾞﾍﾞﾂ
001000     02   DJMST-15.                                               ｼｭｯｶｻｼｽﾞ
001010          03  DJMST-151  OCCURS 10 PIC S9(06)  COMP-3.            ｻｲｽﾞﾍﾞﾂ
001020     02   DJMST-16                 PIC S9(03).                    ｾｯﾄｽｳ
001030     02   F                        PIC X(04).                     I.941223
001040     02   DJMST-18                 PIC 9(01).                     ｳﾘｱｹﾞKBN
001050     02   F                        PIC X(07).                     I.981020
001060*****02   DJMST-19.                                               D.981020
001070*****     03   DJMST-191           PIC 9(06).                     D.981020
001080*****     03   DJMST-192           PIC 9(01).                     D.981020
001090     02   DJMST-20                 PIC 9(03).                     ﾍﾝｺｳNO.
001100     02   DJMST-13                 PIC N(32).                     ﾃｷﾖｳ
001110     02   DJMST-21                 PIC 9(01).                     完了区分
001120     02   DJMST-17                 PIC 9(05).                     I.941223
001130*****02   FILLER                   PIC X(50).                     D.980527
001140     02   FILLER                   PIC X(46).                     I.980527
001150     02   DJMST-90                 PIC 9(01).                     教育一般
001160     02   DJMST-91                 PIC 9(02).                     担当区分
001170*FD  DJSRU                                                        D.971208
001180*****BLOCK    5     RECORDS                                       D.971208
001190 FD  DJNSR                                                        I.971208
001200     BLOCK    3     RECORDS                                       I.971208
001210     LABEL    RECORD   STANDARD
001220     VALUE     OF  IDENTIFICATION  "BU-JNSR2".                    I.060825
001230*****VALUE     OF  IDENTIFICATION  "DJNSR".                       D.060825
001240 01  DJNSR-R.                                                     I.971208
001250     02  DJNSR-KEY1.                                              I.971208
001260       03  DJNSR-01             PIC  9(06)  COMP-3.               I.971208
001270       03  DJNSR-02             PIC  9(08)  COMP-3.               I.980527
001280*****  03  DJNSR-02             PIC  9(06)  COMP-3.               D.980527
001290       03  DJNSR-03             PIC  9(02).                       I.971208
001300       03  DJNSR-04             PIC  9(06)  COMP-3.               I.971208
001310       03  DJNSR-05             PIC  9(01).                       I.971208
001320     02  DJNSR-06               PIC  9(01).                       I.971208
001330     02  DJNSR-07               PIC  9(01).                       I.971208
001340     02  DJNSR-08.                                                I.971208
001350       03  DJNSR-081            PIC S9(04)  COMP-3    OCCURS  10. I.971208
001360     02  DJNSR-09               PIC  9(01).                       I.971208
001370     02  DJNSR-10               PIC  9(01).                       I.971208
001380     02  DJNSR-11.                                                I.971208
001390       03  DJNSR-111            PIC  9(04).                       I.971208
001400       03  DJNSR-112            PIC  9(03).                       I.971208
001410     02  DJNSR-12               PIC  9(06)  COMP-3.               I.971208
001420     02  DJNSR-13               PIC  9(01).                       I.971208
001430     02  DJNSR-14               PIC  9(01).                       I.971208
001440     02  DJNSR-KEY2.                                              I.971208
001450       03  DJNSR-15.                                              I.971208
001460         04  DJNSR-151          PIC  9(06)  COMP-3.               I.971208
001470         04  DJNSR-152          PIC  9(01).                       I.971208
001480*****  03  DJNSR-16             PIC  9(06)  COMP-3.               D.980527
001490       03  DJNSR-16             PIC  9(08)  COMP-3.               I.980527
001500       03  DJNSR-17             PIC  9(01).                       I.971208
001510       03  DJNSR-18.                                              I.971208
001520         04  DJNSR-181          PIC  9(06)  COMP-3.               I.971208
001530         04  DJNSR-182          PIC  9(01).                       I.971208
001540     02  DJNSR-KEY3.                                              I.971208
001550       03  DJNSR-19             PIC  9(04).                       I.971208
001560*****  03  DJNSR-20             PIC  9(06)  COMP-3.               D.980527
001570       03  DJNSR-20             PIC  9(08)  COMP-3.               I.980527
001580       03  DJNSR-21             PIC  9(01).                       I.971208
001590       03  DJNSR-22.                                              I.971208
001600         04  DJNSR-221          PIC  9(06)  COMP-3.               I.971208
001610         04  DJNSR-222          PIC  9(01).                       I.971208
001620     02  DJNSR-23               PIC  N(09).                       I.971208
001630     02  DJNSR-24               PIC  N(23).                       I.971208
001640*****02  FILLER                 PIC  X(11).                       D.980527
001650     02  FILLER                 PIC  X(08).                       I.980527
001660     02  DJNSR-90               PIC  9(01).                       I.971208
001670     02  DJNSR-91               PIC  9(01).                       I.971208
001680     02  DJNSR-92               PIC  9(02).                       I.971208
001690*****VALUE     OF  IDENTIFICATION  "DJSRU".                       D.971208
001700*
001710*01  DJSRU-R.                                                     D.971208
001720*****02   DJSRU-01               PIC 9(1).                        D.971208
001730*****02   DJSRU-KEY1.                                             D.971208
001740*****     03   DJSRU-06.                                          D.971208
001750*****          04  DJSRU-061     PIC 9(6).                        D.971208
001760*****          04  DJSRU-062     PIC 9(1).                        D.971208
001770*****     03   DJSRU-03.                                          D.971208
001780*****          04  DJSRU-031     PIC 9(2).                        D.971208
001790*****          04  DJSRU-032     PIC 9(2).                        D.971208
001800*****          04  DJSRU-033     PIC 9(2).                        D.971208
001810*****     03   DJSRU-03A         PIC 9(1).                        D.971208
001820*****     03   DJSRU-02.                                          D.971208
001830*****          04   DJSRU-021    PIC 9(6).                        D.971208
001840*****          04   DJSRU-022    PIC 9(1).                        D.971208
001850*****02   DJSRU-04.                                               D.971208
001860*****     03  DJSRU-041          PIC 9(4).                        D.971208
001870*****     03  DJSRU-042          PIC 9(3).                        D.971208
001880*****02   DJSRU-05               PIC 9(1).                        D.971208
001890*****02   DJSRU-07               PIC 9(6).                        D.971208
001900*****02   DJSRU-08               PIC 9(1).                        D.971208
001910*****02   DJSRU-09.                                               D.971208
001920*****     03  DJSRU-091    OCCURS  10.                            D.971208
001930*****         04  DJSRU-0911     PIC S9(4)   COMP-3.              D.971208
001940*****     03  DJSRU-092          PIC S9(6)   COMP-3.              D.971208
001950*****02   DJSRU-10               PIC X(1).                        D.971208
001960*****02   DJSRU-11.                                               D.971208
001970*****     03  DJSRU-111          PIC 9(6).                        D.971208
001980*****     03  DJSRU-112          PIC 9(1).                        D.971208
001990*****02   DJSRU-KEY2.                                             D.971208
002000*****     03   DJSRU-12          PIC 9(4).                        D.971208
002010*****     03   DJSRU-13.                                          D.971208
002020*****         04  DJSRU-131      PIC 9(2).                        D.971208
002030*****         04  DJSRU-132      PIC 9(2).                        D.971208
002040*****         04  DJSRU-133      PIC 9(2).                        D.971208
002050*****     03   DJSRU-14          PIC 9(1).                        D.971208
002060*****     03   DJSRU-15.                                          D.971208
002070*****         04  DJSRU-151      PIC 9(6).                        D.971208
002080*****         04  DJSRU-152      PIC 9(1).                        D.971208
002090*****02   DJSRU-16               PIC 9(2).                        D.971208
002100*****02   DJSRU-17               PIC 9(1).                        D.971208
002110*****02   FILLER                PIC X(2).                         D.971208
002120*FD  JT-WK05                                                      D.980108
002130*****BLOCK    1     RECORDS                                       D.980108
002140*****LABEL    RECORD   STANDARD                                   D.980108
002150*****VALUE    OF  IDENTIFICATION   WK0256ID.                      D.980108
002160*
002170*01  WK05-R.                                                      D.980108
002180*****02   WK05-01               PIC 9(1).                         D.980108
002190*****02   WK05-KEY.                                               D.980108
002200*****     03   WK05-06.                                           D.980108
002210*****          04  WK05-061     PIC 9(6).                         D.980108
002220*****          04  WK05-062     PIC 9(1).                         D.980108
002230*****     03   WK05-03.                                           D.980108
002240*****          04  WK05-031     PIC 9(2).                         D.980108
002250*****          04  WK05-032     PIC 9(2).                         D.980108
002260*****          04  WK05-033     PIC 9(2).                         D.980108
002270*****     03   WK05-030  REDEFINES  WK05-03  PIC 9(6).            D.980108
002280*****     03   WK05-03A         PIC 9(1).                         D.980108
002290*****     03   WK05-02.                                           D.980108
002300*****          04   WK05-021    PIC 9(6).                         D.980108
002310*****          04   WK05-022    PIC 9(1).                         D.980108
002320*****02   WK05-04.                                                D.980108
002330*****     03  WK05-041          PIC 9(4).                         D.980108
002340*****     03  WK05-042          PIC 9(3).                         D.980108
002350*****02   WK05-05               PIC 9(1).                         D.980108
002360*****02   WK05-07               PIC 9(6).                         D.980108
002370*****02   WK05-08               PIC 9(1).                         D.980108
002380*****02   WK05-09.                                                D.980108
002390*****     03  WK05-091    OCCURS  10.                             D.980108
002400*****         04  WK05-0911     PIC S9(4)   COMP-3.               D.980108
002410*****     03  WK05-092          PIC S9(6)   COMP-3.               D.980108
002420*****02   WK05-10               PIC X(1).                         D.980108
002430*****02   WK05-11.                                                D.980108
002440*****     03  WK05-111          PIC 9(6).                         D.980108
002450*****     03  WK05-112          PIC 9(1).                         D.980108
002460*****02   WK05-KEY2.                                              D.980108
002470*****     03   WK05-12          PIC 9(4).                         D.980108
002480*****     03   WK05-13.                                           D.980108
002490*****         04  WK05-131      PIC 9(2).                         D.980108
002500*****         04  WK05-132      PIC 9(2).                         D.980108
002510*****         04  WK05-133      PIC 9(2).                         D.980108
002520*****     03   WK05-14          PIC 9(1).                         D.980108
002530*****     03   WK05-15.                                           D.980108
002540*****         04  WK05-151      PIC 9(6).                         D.980108
002550*****         04  WK05-152      PIC 9(1).                         D.980108
002560*****02   WK05-16               PIC 9(2).                         D.980108
002570*****02   FILLER                PIC X(3).                         D.980108
002580*****02   FILLER                PIC X(4).                         D.980108
002590*****02   WK05-95               PIC X(6).                         D.980108
002600*****02   WK05-96.                                                D.980108
002610*****     03  WK05-961          PIC 9(2).                         D.980108
002620*****     03  WK05-962          PIC 9(2).                         D.980108
002630*****     03  WK05-963          PIC 9(2).                         D.980108
002640*****02   WK05-97               PIC 9(5).                         D.980108
002650*****02   WK05-98               PIC S9(3).                        D.980108
002660*****02   WK05-99               PIC 9(2).                         D.980108
002670*****02   FILLER                PIC X(128).                       D.980108
002680     COPY  LTWK05.                                                I.980108
002690 COPY  L-JCON.
002700*
002710 WORKING-STORAGE            SECTION.
002720 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
002730 01  JS-SIGN                   PIC X(01).
002740*01  WK0256ID                  PIC X(09).                         D.980108
002750 01  WK0128ID                  PIC X(09).                         I.980108
002760 01  STN-NO.
002770     02  STN-NO1               PIC X(03).
002780     02  STN-NO2               PIC X(03).
002790 01  W-FID.
002800*****02  W-FID1                PIC X(06)    VALUE "WK0256".       D.980108
002810     02  W-FID1                PIC X(06)    VALUE "WK0128".       I.980108
002820     02  W-FID2                PIC X(03).
002830 01  S-AREA.
002840     03  S-TUKI                PIC 9(02).
002850     03  S-OKC                 PIC 9(01).
002860 01  W-AREA.
002870     03  END-SW                PIC 9(01).
002880     03  I                     PIC 9(02).
002890     03  W-YMD                 PIC 9(06).
002900     03  W-YMDD  REDEFINES W-YMD.
002910         04  W-YY              PIC 9(02).
002920         04  W-MM              PIC 9(02).
002930         04  W-DD              PIC 9(02).
002940     03  W-KEI                 PIC S9(06).                        I.981203
002950 01  WJMST-R.                                                     I.981202
002960     02   WJMST-01                  PIC 9(1).                     I.981202
002970     02   WJMST-02.                                               I.981202
002980          03   WJMST-021            PIC 9(4).                     I.981202
002990          03   WJMST-022            PIC 9(2).                     I.981202
003000          03   WJMST-023            PIC 9(2).                     I.981202
003010     02   WJMST-03                  PIC 9(6).                     I.981202
003020     02   WJMST-04                  PIC 9(4).                     I.981202
003030     02   WJMST-05                  PIC 9(6).                     I.981202
003040     02   WJMST-06.                                               I.981202
003050          03   WJMST-061            PIC 9(4).                     I.981202
003060          03   WJMST-062            PIC 9(2).                     I.981202
003070          03   WJMST-063            PIC 9(2).                     I.981202
003080     02   WJMST-KEY1.                                             I.981202
003090          03   WJMST-07             PIC 9(6).                     I.981202
003100          03   WJMST-08             PIC 9(1).                     I.981202
003110     02   WJMST-09                  PIC 9(1).                     I.981202
003120     02   WJMST-10                  PIC 9(3).                     I.981202
003130     02   WJMST-11.                                               I.981202
003140          03  WJMST-111            OCCURS  10.                    I.981202
003150              04  WJMST-1111       PIC S9(6)   COMP-3.            I.981202
003160     02   WJMST-12.                                               I.981202
003170          03  WJMST-121            OCCURS  10.                    I.981202
003180              04  WJMST-1211       PIC S9(6)   COMP-3.            I.981202
003190     02   WJMST-14.                                               I.981202
003200          03  WJMST-141  OCCURS 10 PIC S9(06)  COMP-3.            I.981202
003210     02   WJMST-15.                                               I.981202
003220          03  WJMST-151  OCCURS 10 PIC S9(06)  COMP-3.            I.981202
003230     02   WJMST-16                 PIC S9(03).                    I.981202
003240     02   F                        PIC X(04).                     I.981202
003250     02   WJMST-18                 PIC 9(01).                     I.981202
003260     02   F                        PIC X(07).                     I.981202
003270     02   WJMST-20                 PIC 9(03).                     I.981202
003280     02   WJMST-13                 PIC N(32).                     I.981202
003290     02   WJMST-21                 PIC 9(01).                     I.981202
003300     02   WJMST-17                 PIC 9(05).                     I.981202
003310     02   FILLER                   PIC X(46).                     I.981202
003320     02   WJMST-90                 PIC 9(01).                     I.981202
003330     02   WJMST-91                 PIC 9(02).                     I.981202
003340 01  WJNSR-R.                                                     I.981202
003350     02  WJNSR-KEY1.                                              I.981202
003360       03  WJNSR-01             PIC  9(06)  COMP-3.               I.981202
003370       03  WJNSR-02             PIC  9(08)  COMP-3.               I.981202
003380       03  WJNSR-03             PIC  9(02).                       I.981202
003390       03  WJNSR-04             PIC  9(06)  COMP-3.               I.981202
003400       03  WJNSR-05             PIC  9(01).                       I.981202
003410     02  WJNSR-06               PIC  9(01).                       I.981202
003420     02  WJNSR-07               PIC  9(01).                       I.981202
003430     02  WJNSR-08.                                                I.981202
003440       03  WJNSR-081            PIC S9(04)  COMP-3    OCCURS  10. I.981202
003450     02  WJNSR-09               PIC  9(01).                       I.981202
003460     02  WJNSR-10               PIC  9(01).                       I.981202
003470     02  WJNSR-11.                                                I.981202
003480       03  WJNSR-111            PIC  9(04).                       I.981202
003490       03  WJNSR-112            PIC  9(03).                       I.981202
003500     02  WJNSR-12               PIC  9(06)  COMP-3.               I.981202
003510     02  WJNSR-13               PIC  9(01).                       I.981202
003520     02  WJNSR-14               PIC  9(01).                       I.981202
003530     02  WJNSR-KEY2.                                              I.981202
003540       03  WJNSR-15.                                              I.981202
003550         04  WJNSR-151          PIC  9(06)  COMP-3.               I.981202
003560         04  WJNSR-152          PIC  9(01).                       I.981202
003570       03  WJNSR-16             PIC  9(08)  COMP-3.               I.981202
003580       03  WJNSR-17             PIC  9(01).                       I.981202
003590       03  WJNSR-18.                                              I.981202
003600         04  WJNSR-181          PIC  9(06)  COMP-3.               I.981202
003610         04  WJNSR-182          PIC  9(01).                       I.981202
003620     02  WJNSR-KEY3.                                              I.981202
003630       03  WJNSR-19             PIC  9(04).                       I.981202
003640       03  WJNSR-20             PIC  9(08)  COMP-3.               I.981202
003650       03  WJNSR-21             PIC  9(01).                       I.981202
003660       03  WJNSR-22.                                              I.981202
003670         04  WJNSR-221          PIC  9(06)  COMP-3.               I.981202
003680         04  WJNSR-222          PIC  9(01).                       I.981202
003690     02  WJNSR-23               PIC  N(09).                       I.981202
003700     02  WJNSR-24               PIC  N(23).                       I.981202
003710     02  FILLER                 PIC  X(08).                       I.981202
003720     02  WJNSR-90               PIC  9(01).                       I.981202
003730     02  WJNSR-91               PIC  9(01).                       I.981202
003740     02  WJNSR-92               PIC  9(02).                       I.981202
003750 COPY    LWMSG.
003760*
003770 SCREEN                  SECTION.
003780 SD  CRT-X
003790     END STATUS  IS  ESTAT.
003800 01  CLE-01          LINE  1.
003810     02  CLEAR   SCREEN.
003820 01  DSP-AREA.
003830     02  LINE  01  COLUMN  20  PIC X(28) VALUE
003840           "                            " REVERSE.
003850     02  LINE  01  COLUMN  21  PIC N(13) VALUE
003860         NC"受注・預り・取よけ台帳抽出".
003870     02  LINE  06  COLUMN  34  VALUE  NC"月度".
003880     02  LINE  23  COLUMN  41  VALUE  "確認（OK=1,NO=9）-->".
003890     02  LINE  23  COLUMN  62  VALUE  "ﾘﾀｰﾝ".
003900 01  ACP-AREA.
003910     02  DSP-TUKI  LINE  06  COLUMN  31  PIC Z9
003920         FROM   S-TUKI.
003930     02  ACP-OKC   LINE  23  COLUMN  61  PIC 9(01)
003940         INTO   S-OKC          CHECK OVERFLOW  NO IFC.
003950*01  DSP-SET.                                                     D.981202
003960*****02  LINE  10  COLUMN  28  VALUE  NC"得意先別セット品".       D.981202
003970 01  CLR-AREA.
003980     02  LINE  06  COLUMN  31  PIC  X(02)  VALUE  "  ".
003990     02  LINE  23  COLUMN  61  PIC  X(01)  VALUE  " ".
004000 01  DSP-ERR     LINE  24.                                        I.941124
004010     02  ERR-MSG1    COLUMN   1   PIC  N(07) VALUE                I.941124
004020         NC"ＪＣＯＮ　なし".                                      I.941124
004030*
004040 COPY    LSMSG.
004050*
004060 PROCEDURE               DIVISION.
004070************************************
004080*    メイン　ルーチン              *
004090************************************
004100 PRO-010.
004110     PERFORM   INT-RTN   THRU  INT-EX.
004120     IF  END-SW           =  1
004130         GO  TO  PRO-900.
004140     PERFORM   MAIN-RTN  THRU  MAIN-EX.
004150     PERFORM     END-RTN    THRU   END-EX.
004160 PRO-900.
004170     STOP  RUN.
004180*********************************************
004190*    ＩＮＴ−ＲＴＮ                         *
004200*********************************************
004210 INT-RTN.
004220     MOVE    255  TO  COMPLETION-CODE.
004230     ACCEPT    JS-SIGN.
004240     IF  JS-SIGN  NOT =  "0"  AND  "1"        GO  TO  INT-RTN.    I.981202
004250*****IF  JS-SIGN  NOT =  "N"  AND  "S"        GO  TO  INT-RTN.    D.981202
004260*
004270     OPEN  INPUT   JCON.
004280     MOVE    SPACE          TO  JCON6-KEY.
004290     MOVE    6              TO  JCON6-01.
004300     READ    JCON       UNLOCK   INVALID  KEY
004310             DISPLAY   ERR-MSG1  DISP-BUZ-B
004320             MOVE    1           TO   END-SW
004330             GO  TO  INT-EX.
004340     MOVE    JCON6-032          TO  W-MM.
004350     CLOSE   JCON.
004360*****SUBTRACT    1     FROM         W-MM.                         D.981202
004370     IF  JS-SIGN  NOT =  0                                        I.981202
004380         SUBTRACT    1     FROM         W-MM                      I.981202
004390         IF  W-MM         =  ZERO
004400             MOVE  12        TO  W-MM.
004410*****CALL  "CBLSTNNO" USING STN-NO.                               D.981202
004420*****MOVE  STN-NO2          TO  W-FID2.                           D.981202
004430*****MOVE  W-FID            TO  WK0128ID.                         D.981202
004440*****MOVE  W-FID            TO  WK0256ID.                         D.980108
004450***  画面処理
004460     PERFORM   INP-RTN   THRU  INP-EX.
004470     IF  END-SW       =  1
004480         GO  TO  INT-EX.
004490**
004500     CALL  "CBLSTNNO" USING STN-NO.                               I.981202
004510     MOVE  STN-NO2          TO  W-FID2.                           I.981202
004520     MOVE  W-FID            TO  WK0128ID.                         I.981202
004530     IF  JS-SIGN      =  0                                        I.981202
004540         OPEN  INPUT   JMST1  JNSR                                I.981202
004550       ELSE                                                       I.981202
004560         OPEN  INPUT   DJMST  DJNSR.                              I.981202
004570     OPEN  OUTPUT  JT-WK05.                                       I.981202
004580*****OPEN  INPUT   DJMST  DJSRU                                   D.971208
004590*****OPEN  INPUT   DJMST  DJNSR                                   D.981202
004600*****      OUTPUT  JT-WK05.                                       D.981202
004610 INT-EX.
004620     EXIT.
004630*********************************************
004640*    画面処理       ＩＮＰ−ＲＴＮ          *
004650*********************************************
004660 INP-RTN.
004670     DISPLAY   CLE-01.
004680     DISPLAY   DSP-AREA.
004690*****IF  JS-SIGN          =   "S"            DISPLAY  DSP-SET.    D.981202
004700     MOVE  W-MM         TO  S-TUKI.
004710     DISPLAY   DSP-TUKI.
004720 INP-070.
004730     ACCEPT    ACP-OKC.
004740     DISPLAY   DISP-MSG-SPACE.
004750     IF  ESTAT            =   "P9"
004760         MOVE  1              TO  END-SW
004770         GO  TO  INP-EX.
004780     IF  ESTAT        NOT =   "01"  AND  "06"
004790         GO  TO  INP-070.
004800     IF  S-OKC            =  9
004810         MOVE  1              TO  END-SW
004820         GO  TO  INP-EX.
004830     IF  S-OKC        NOT =  1
004840         GO  TO  INP-070.
004850 INP-EX.
004860     EXIT.
004870*********************************************
004880*    ＥＮＤ−ＲＴＮ                         *
004890*********************************************
004900 END-RTN.
004910     IF  JS-SIGN      =  0                                        I.981202
004920         CLOSE   JMST1  JNSR                                      I.981202
004930       ELSE                                                       I.981202
004940         CLOSE   DJMST  DJNSR.                                    I.981202
004950     CLOSE  JT-WK05.                                              I.981202
004960*****CLOSE  DJMST  DJNSR  JT-WK05.                                D.981202
004970*****CLOSE  DJMST  DJSRU  JT-WK05.                                D.971208
004980 END-EX.
004990     EXIT.
005000*********************************************
005010*    メイン処理　　　                       *
005020*********************************************
005030 MAIN-RTN.
005040     PERFORM  ZEN-RTN    THRU  ZEN-EX.
005050*
005060     PERFORM  MEI-RTN    THRU  MEI-EX.
005070 MAIN-EX.
005080     EXIT.
005090*********************************************
005100*    前残レコード抽出処理                   *
005110*********************************************
005120 ZEN-RTN.
005130     IF  JS-SIGN          =  1               GO  TO  ZEN-020.     I.981202
005140 ZEN-010.                                                         I.981202
005150     READ  JMST1  NEXT  UNLOCK  AT  END      GO  TO  ZEN-EX.      I.981202
005160     IF  JMST1-01     NOT =  0  AND  5  AND  6  GO  TO  ZEN-010.  I.981202
005170     INITIALIZE          WJMST-R.                                 I.981202
005180     MOVE  JMST1-R   TO  WJMST-R.                                 I.981202
005190     GO  TO  ZEN-030.                                             I.981202
005200 ZEN-020.                                                         I.981202
005210     READ  DJMST  NEXT  UNLOCK  AT  END      GO  TO  ZEN-EX.
005220     IF  DJMST-01     NOT =  0  AND  5  AND  6  GO  TO  ZEN-020.  I.981202
005230*****IF  DJMST-01     NOT =  0  AND  5  AND  6  GO  TO  ZEN-RTN.  D.981202
005240*****IF  JS-SIGN          =  "S"                                  D.981202
005250*****    IF  DJMST-16          =  ZERO                            D.981202
005260*****        GO  TO  ZEN-020.                                     D.981202
005270     INITIALIZE          WJMST-R.                                 I.981202
005280     MOVE  DJMST-R   TO  WJMST-R.                                 I.981202
005290*****        GO  TO  ZEN-RTN.                                     D.981202
005300 ZEN-030.                                                         I.981202
005310     PERFORM  SET1-RTN   THRU  SET1-EX.
005320     PERFORM  WRT-RTN    THRU  WRT-EX.
005330*
005340     MOVE  ZERO          TO  COMPLETION-CODE.
005350     GO  TO  ZEN-RTN.
005360 ZEN-EX.
005370     EXIT.
005380*********************************************
005390*    明細レコード抽出処理                   *
005400*********************************************
005410 MEI-RTN.
005420     IF  JS-SIGN          =  1               GO  TO  MEI-020.     I.981202
005430*****READ  DJSRU                 AT  END      GO  TO  MEI-EX.     D.971208
005440*****IF  DJSRU-06         =  ZERO                                 D.971208
005450 MEI-010.                                                         I.981202
005460     READ  JNSR    NEXT  UNLOCK  AT  END      GO  TO  MEI-EX.     I.981202
005470     IF  JNSR-151         =  ZERO                                 I.981202
005480         GO  TO  MEI-010.                                         I.981202
005490     IF  JNSR-92     NOT  =  SPACE  AND  ZERO                     I.981202
005500         GO  TO  MEI-010.                                         I.981202
005510     IF  JNSR-13      NOT =  0  AND  5  AND  6  GO  TO  MEI-010.  I.981202
005520     MOVE  JNSR-151       TO  JMST1-07.                           I.981202
005530     MOVE  JNSR-152       TO  JMST1-08.                           I.981202
005540     READ  JMST1  UNLOCK  INVALID            GO  TO  MEI-010.     I.981202
005550     INITIALIZE          WJNSR-R.                                 I.981202
005560     MOVE  JNSR-R    TO  WJNSR-R.                                 I.981202
005570     INITIALIZE          WJMST-R.                                 I.981202
005580     MOVE  JMST1-R   TO  WJMST-R.                                 I.981202
005590     GO  TO  MEI-030.                                             I.981202
005600 MEI-020.                                                         I.981202
005610*****READ  DJNSR                 AT  END      GO  TO  MEI-EX.     D.060825
005620     READ  DJNSR   NEXT RECORD   AT  END      GO  TO  MEI-EX.     I.060825
005630     IF  DJNSR-151        =  ZERO                                 I.971208
005640         GO  TO  MEI-020.                                         I.981202
005650*****    GO  TO  MEI-RTN.                                         D.981202
005660*****IF  DJSRU-16    NOT  =  SPACE  AND  ZERO                     D.971208
005670     IF  DJNSR-92    NOT  =  SPACE  AND  ZERO                     I.971208
005680         GO  TO  MEI-020.                                         I.981202
005690     IF  DJNSR-13      NOT =  0  AND  5  AND  6  GO  TO  MEI-020. I.981202
005700*****    GO  TO  MEI-RTN.                                         D.981202
005710*****MOVE  DJSRU-06       TO  DJMST-KEY1.                         D.971208
005720     MOVE  DJNSR-151      TO  DJMST-07.                           I.971208
005730     MOVE  DJNSR-152      TO  DJMST-08.                           I.971208
005740     READ  DJMST  UNLOCK  INVALID            GO  TO  MEI-020.     I.981202
005750     INITIALIZE          WJNSR-R.                                 I.981202
005760     MOVE  DJNSR-R   TO  WJNSR-R.                                 I.981202
005770     INITIALIZE          WJMST-R.                                 I.981202
005780     MOVE  DJMST-R   TO  WJMST-R.                                 I.981202
005790*****READ  DJMST  UNLOCK  INVALID            GO  TO  MEI-RTN.     D.981202
005800*****IF  DJNSR-13      NOT =  0  AND  5  AND  6  GO  TO  MEI-RTN. D.981202
005810*****IF  DJSRU-01      NOT =  0  AND  5  AND  6  GO  TO  MEI-RTN. D.971208
005820*****IF  JS-SIGN          =  "S"                                  D.981202
005830*****    IF  DJMST-16          =  ZERO                            D.981202
005840*****        GO  TO  MEI-RTN.                                     D.981202
005850 MEI-030.                                                         I.981202
005860     PERFORM  SET2-RTN   THRU  SET2-EX.
005870     PERFORM  WRT-RTN    THRU  WRT-EX.
005880*
005890     MOVE  ZERO          TO  COMPLETION-CODE.
005900     GO  TO  MEI-RTN.
005910 MEI-EX.
005920     EXIT.
005930**********************************************
005940*    ＳＥＴ１−ＲＴＮ                        *
005950**********************************************
005960 SET1-RTN.
005970     MOVE  SPACE         TO  WK05-R.
005980     INITIALIZE              WK05-R.
005990*****MOVE  DJMST-01      TO  WK05-01.                             D.981202
006000*****MOVE  DJMST-07      TO  WK05-061.                            D.981202
006010*****MOVE  DJMST-08      TO  WK05-062.                            D.981202
006020     MOVE  WJMST-01      TO  WK05-01.                             I.981202
006030     MOVE  WJMST-07      TO  WK05-061.                            I.981202
006040     MOVE  WJMST-08      TO  WK05-062.                            I.981202
006050     MOVE  ZERO          TO  WK05-03.
006060*****MOVE  ZERO          TO  WK05-03A.                            D.980108
006070     MOVE  ZERO          TO  WK05-02.
006080     MOVE  WJMST-04      TO  WK05-041.                            I.981202
006090     MOVE  WJMST-10      TO  WK05-042.                            I.981202
006100     MOVE  WJMST-03      TO  WK05-07.                             I.981202
006110     MOVE  WJMST-09      TO  WK05-08.                             I.981202
006120*****MOVE  DJMST-04      TO  WK05-041.                            D.981202
006130*****MOVE  DJMST-10      TO  WK05-042.                            D.981202
006140*****MOVE  ZERO          TO  WK05-05.                             D.980108
006150*****MOVE  DJMST-03      TO  WK05-07.                             D.981202
006160*****MOVE  DJMST-09      TO  WK05-08.                             D.981202
006170     PERFORM  SUR-RTN  THRU  SUR-EX
006180           VARYING  I    FROM  1  BY  1
006190           UNTIL    I     >  10.
006200     MOVE  ZERO          TO  WK05-10.
006210*****MOVE  DJMST-19      TO  WK05-11.                             D.980108
006220*****MOVE  DJMST-04      TO  WK05-12.                             D.980108
006230*****MOVE  ZERO          TO  WK05-13.                             D.980108
006240*****MOVE  ZERO          TO  WK05-14.                             D.980108
006250*****MOVE  ZERO          TO  WK05-15.                             D.980108
006260*****MOVE  DJMST-03      TO  WK05-95.                             D.981202
006270*****MOVE  DJMST-02      TO  WK05-96.                             D.981202
006280*****MOVE  DJMST-17      TO  WK05-97.                             D.981202
006290*****MOVE  DJMST-16      TO  WK05-98.                             D.981202
006300     MOVE  WJMST-03      TO  WK05-95.                             I.981202
006310     MOVE  WJMST-02      TO  WK05-96.                             I.981202
006320     MOVE  WJMST-17      TO  WK05-97.                             I.981202
006330*****MOVE  WJMST-16      TO  WK05-98.                             D.981203
006340     IF (WJMST-16    NOT =  ZERO)  AND  (WK05-092  NOT = ZERO)    I.981203
006350         COMPUTE  W-KEI  =  WJMST-1111(01)  +  WJMST-1111(02)  +  I.981203
006360                            WJMST-1111(03)  +  WJMST-1111(04)  +  I.981203
006370                            WJMST-1111(05)  +  WJMST-1111(06)  +  I.981203
006380                            WJMST-1111(07)  +  WJMST-1111(08)  +  I.981203
006390                            WJMST-1111(09)  +  WJMST-1111(10)     I.981203
006400         IF  W-KEI       NOT =  ZERO                              I.981203
006410             COMPUTE  W-KEI     =  W-KEI    /  WJMST-16           I.981203
006420             IF  W-KEI       NOT =  ZERO                          I.981203
006430                 COMPUTE  WK05-98   =  WK05-092 /  W-KEI.         I.981203
006440     MOVE  S-TUKI        TO  WK05-99.
006450 SET1-EX.
006460     EXIT.
006470**********************************************
006480*    ＳＥＴ２−ＲＴＮ                        *
006490**********************************************
006500 SET2-RTN.
006510     MOVE  SPACE         TO  WK05-R.
006520     INITIALIZE              WK05-R.
006530*****MOVE  DJSRU-01       TO  WK05-01.                            D.971208
006540*****MOVE  DJSRU-06       TO  WK05-06.                            D.971208
006550*****MOVE  DJSRU-03       TO  WK05-03.                            D.971208
006560*****MOVE  DJSRU-03A      TO  WK05-03A.                           D.971208
006570*****MOVE  DJSRU-02       TO  WK05-02.                            D.971208
006580*****MOVE  DJSRU-04       TO  WK05-04.                            D.971208
006590*****MOVE  DJSRU-05       TO  WK05-05.                            D.971208
006600*****MOVE  DJSRU-07       TO  WK05-07.                            D.971208
006610*****MOVE  DJSRU-08       TO  WK05-08.                            D.971208
006620*****MOVE  DJSRU-09       TO  WK05-09.                            D.971208
006630*****MOVE  DJSRU-10       TO  WK05-10.                            D.971208
006640*****MOVE  DJSRU-11       TO  WK05-11.                            D.971208
006650*****MOVE  DJSRU-12       TO  WK05-12.                            D.971208
006660*****MOVE  DJSRU-13       TO  WK05-13.                            D.971208
006670*****MOVE  DJSRU-14       TO  WK05-14.                            D.971208
006680*****MOVE  DJSRU-15       TO  WK05-15.                            D.971208
006690*****MOVE  DJNSR-13      TO  WK05-01.                             D.981202
006700*****MOVE  DJNSR-151     TO  WK05-061.                            D.981202
006710*****MOVE  DJNSR-152     TO  WK05-062.                            D.981202
006720*****MOVE  DJNSR-16      TO  WK05-030.                            D.981202
006730*****MOVE  DJNSR-17      TO  WK05-03A.                            D.980108
006740*****MOVE  DJNSR-181     TO  WK05-021.                            D.981202
006750*****MOVE  DJNSR-182     TO  WK05-022.                            D.981202
006760*****MOVE  DJNSR-11      TO  WK05-04.                             D.981202
006770*****MOVE  DJNSR-06      TO  WK05-05.                             D.980108
006780*****MOVE  DJNSR-01      TO  WK05-07.                             D.981202
006790*****MOVE  DJNSR-07      TO  WK05-08.                             D.981202
006800*****MOVE  DJNSR-081(01) TO  WK05-0911(01).                       D.981202
006810*****MOVE  DJNSR-081(02) TO  WK05-0911(02).                       D.981202
006820*****MOVE  DJNSR-081(03) TO  WK05-0911(03).                       D.981202
006830*****MOVE  DJNSR-081(04) TO  WK05-0911(04).                       D.981202
006840*****MOVE  DJNSR-081(05) TO  WK05-0911(05).                       D.981202
006850*****MOVE  DJNSR-081(06) TO  WK05-0911(06).                       D.981202
006860*****MOVE  DJNSR-081(07) TO  WK05-0911(07).                       D.981202
006870*****MOVE  DJNSR-081(08) TO  WK05-0911(08).                       D.981202
006880*****MOVE  DJNSR-081(09) TO  WK05-0911(09).                       D.981202
006890*****MOVE  DJNSR-081(10) TO  WK05-0911(10).                       D.981202
006900*****COMPUTE  WK05-092    =   DJNSR-081(01)  +  DJNSR-081(02)  +  D.981202
006910*****                         DJNSR-081(03)  +  DJNSR-081(04)  +  D.981202
006920*****                         DJNSR-081(05)  +  DJNSR-081(06)  +  D.981202
006930*****                         DJNSR-081(07)  +  DJNSR-081(08)  +  D.981202
006940*****                         DJNSR-081(09)  +  DJNSR-081(10).    D.981202
006950*****MOVE  DJNSR-10      TO  WK05-10.                             D.981202
006960*****MOVE  DJNSR-19      TO  WK05-12.                             D.980108
006970*****MOVE  DJNSR-20      TO  WK05-13.                             D.980108
006980*****MOVE  DJNSR-21      TO  WK05-14.                             D.980108
006990*****MOVE  DJNSR-221     TO  WK05-151.                            D.980108
007000*****MOVE  DJNSR-222     TO  WK05-152.                            D.980108
007010*****MOVE  DJMST-03      TO  WK05-95.                             D.981202
007020*****MOVE  DJMST-02      TO  WK05-96.                             D.981202
007030*****MOVE  DJMST-17      TO  WK05-97.                             D.981202
007040*****MOVE  DJMST-16      TO  WK05-98.                             D.981202
007050     MOVE  WJNSR-13      TO  WK05-01.                             I.981202
007060     MOVE  WJMST-07      TO  WK05-061.                            I.990409
007070     MOVE  WJMST-08      TO  WK05-062.                            I.990409
007080*****MOVE  WJNSR-151     TO  WK05-061.                            D.990409
007090*****MOVE  WJNSR-152     TO  WK05-062.                            D.990409
007100     MOVE  WJNSR-16      TO  WK05-030.                            I.981202
007110     MOVE  WJNSR-181     TO  WK05-021.                            I.981202
007120     MOVE  WJNSR-182     TO  WK05-022.                            I.981202
007130     MOVE  WJNSR-11      TO  WK05-04.                             I.981202
007140     MOVE  WJNSR-01      TO  WK05-07.                             I.981202
007150     MOVE  WJNSR-07      TO  WK05-08.                             I.981202
007160     MOVE  WJNSR-081(01) TO  WK05-0911(01).                       I.981202
007170     MOVE  WJNSR-081(02) TO  WK05-0911(02).                       I.981202
007180     MOVE  WJNSR-081(03) TO  WK05-0911(03).                       I.981202
007190     MOVE  WJNSR-081(04) TO  WK05-0911(04).                       I.981202
007200     MOVE  WJNSR-081(05) TO  WK05-0911(05).                       I.981202
007210     MOVE  WJNSR-081(06) TO  WK05-0911(06).                       I.981202
007220     MOVE  WJNSR-081(07) TO  WK05-0911(07).                       I.981202
007230     MOVE  WJNSR-081(08) TO  WK05-0911(08).                       I.981202
007240     MOVE  WJNSR-081(09) TO  WK05-0911(09).                       I.981202
007250     MOVE  WJNSR-081(10) TO  WK05-0911(10).                       I.981202
007260     COMPUTE  WK05-092    =   WJNSR-081(01)  +  WJNSR-081(02)  +  I.981202
007270                              WJNSR-081(03)  +  WJNSR-081(04)  +  I.981202
007280                              WJNSR-081(05)  +  WJNSR-081(06)  +  I.981202
007290                              WJNSR-081(07)  +  WJNSR-081(08)  +  I.981202
007300                              WJNSR-081(09)  +  WJNSR-081(10).    I.981202
007310     MOVE  WJNSR-10      TO  WK05-10.                             I.981202
007320     MOVE  WJNSR-152     TO  WK05-94.                             I.990409
007330     MOVE  WJMST-03      TO  WK05-95.                             I.981202
007340     MOVE  WJMST-02      TO  WK05-96.                             I.981202
007350     MOVE  WJMST-17      TO  WK05-97.                             I.981202
007360     MOVE  WJMST-16      TO  WK05-98.                             I.981202
007370     MOVE  S-TUKI        TO  WK05-99.
007380 SET2-EX.
007390     EXIT.
007400**********************************************
007410*    ＷＲＴ−ＲＴＮ　                        *
007420**********************************************
007430 WRT-RTN.
007440     WRITE  WK05-R.
007450     IF  ERR-STAT   NOT   =   "00"
007460         MOVE    "WK0256 "  TO  ERR-F
007470         MOVE    "W"        TO  ERR-M
007480         PERFORM    ERR-RTN    THRU    ERR-EX.
007490     MOVE    ZERO TO  COMPLETION-CODE.                            A 911129
007500 WRT-EX.
007510     EXIT.
007520**************************************************
007530*    出荷数セット　処理                          *
007540**************************************************
007550 SUR-RTN.
007560*****COMPUTE  WK05-0911(I)  =  DJMST-1111(I)  -  DJMST-141(I).    D.981202
007570     COMPUTE  WK05-0911(I)  =  WJMST-1111(I)  -  WJMST-141(I).    I.981202
007580     ADD   WK05-0911(I)    TO  WK05-092.
007590 SUR-EX.
007600     EXIT.
007610***
007620 COPY    LPMSG.
007630***
