000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JTO10U.
000030*================================================================*
000040*                  Å@    ÇnÅ^ÇkëóêMÇeê∂ê¨ÉvÉçÉOÉâÉÄ áT           *
000050*                       ÇWÇXÅ^Å@ÇWÅ^ÇPÇU   ÇaÇxÅ@ÇrÅDÇdÇáÇÅÇóÇÅ  *
000060*    JS-SK     : 1=ÇªÇÃëº , 2=ì°ìcÅEóºîı , 3=ì°ìcÅEóºîı(NEW)     *
000070*    JS-SIGN   : 0=ã≥àÁ , 1=ÉèÅ[ÉNÅEÉJÉWÉÖÉAÉã                   *
000080*================================================================*
000090 ENVIRONMENT                    DIVISION.
000100 CONFIGURATION                  SECTION.
000110 SOURCE-COMPUTER.               SYSTEM3100.
000120 OBJECT-COMPUTER.               SYSTEM3100.
000130 INPUT-OUTPUT                   SECTION.
000140 FILE-CONTROL.
000150*----/ÇnÅ^ÇkëóêMÇe/----*
000160              SELECT  JOLSF     ASSIGN  KOL-MSD
000170                                FILE  STATUS  ERR-STAT.
000180*----/ÇnÅ^ÇkëóêMÇeÇQ/----*                                        *A050901
000190              SELECT  JOLSF2    ASSIGN  KOL2-MSD                  *A050901
000200                                ORGANIZATION  RELATIVE            *A050901
000210                                ACCESS        SEQUENTIAL          *A050901
000220                                FILE  STATUS  ERR-STAT.           *A050901
000230*----/ÇnÅ^ÇkèÛãµÇe/----*
000240              SELECT  JOJF      ASSIGN  JOJ-MSD
000250                                ORGANIZATION  INDEXED
000260                                ACCESS  MODE  RANDOM
000270                                RECORD  KEY   JOJF-KEY
000280                                FILE  STATUS  ERR-STAT.
000290*----/èoâ◊éwê}ÉgÉâÉì/----*
000300              SELECT  JSTR      ASSIGN  JST-MSD
000310                                ORGANIZATION  INDEXED
000320                                ACCESS  MODE  SEQUENTIAL
000330                                RECORD  KEY   JSTR-KEY.
000340*----/â◊éDÉgÉâÉì/----*
000350              SELECT  JNIF      ASSIGN  JNI-MSD
000360                                ORGANIZATION  INDEXED
000370                                ACCESS  MODE  SEQUENTIAL
000380                                RECORD  KEY   JNIF1-KEY.
000390*----/ëóÇËèÛÉgÉâÉì/----*
000400              SELECT  OKJF      ASSIGN  OKJ-MSD
000410                                ORGANIZATION  INDEXED
000420                                ACCESS  MODE  SEQUENTIAL
000430                                RECORD  KEY   OKJF-KEY.
000440              SELECT  TDNWF     ASSIGN  TDNW-MSD                  I.040922
000450                                ORGANIZATION  INDEXED             I.040922
000460                                ACCESS  MODE  SEQUENTIAL          I.040922
000470                                RECORD  KEY   TDNW1-KEY.          I.040922
000480              SELECT  TDNNF     ASSIGN  TDNN-MSD                  I.050119
000490                                ORGANIZATION  INDEXED             I.050119
000500                                ACCESS  MODE  SEQUENTIAL          I.050119
000510                                RECORD  KEY   TDNN1-KEY.          I.050119
000520              SELECT  TDIF      ASSIGN  TDI-MSD                   I.080325
000530                                ORGANIZATION  INDEXED             I.080325
000540                                ACCESS  MODE  SEQUENTIAL          I.080325
000550                                RECORD  KEY   TDI-KEY.            I.080325
000560              SELECT  TDNAF     ASSIGN  TDNA-MSD                  I.091221
000570                                ORGANIZATION  INDEXED             I.091221
000580                                ACCESS  MODE  SEQUENTIAL          I.091221
000590                                RECORD  KEY   TDNA-KEY.           I.091221
000600*----/ÉRÉìÉgÉçÅ[ÉãÇe/----*                                        I.900411
000610              SELECT  JCON      ASSIGN  JCO-MSD
000620                                ORGANIZATION  INDEXED
000630                                ACCESS  MODE  RANDOM
000640                                RECORD  KEY   JCON4-KEY.
000650*
000660 I-O-CONTROL.
000670     APPLY  SHARED-MODE  ON  JSTR  JNIF
000680                      OKJF  TDNWF  TDNNF TDIF TDNAF JOJF  JCON.   I.091221
000690*****                       OKJF  TDNWF  TDNNF TDIF JOJF  JCON.   D.091221
000700*****                             OKJF  TDNWF  TDNNF JOJF  JCON.  D.080325
000710*****                             OKJF  TDNWF  JOJF  JCON.        D.050119
000720*****                                 OKJF  JOJF  JCON.           D.040922
000730*
000740 DATA                           DIVISION.
000750 FILE                           SECTION.
000760     COPY  L-JSTR.
000770     COPY  L-JNIF.
000780     COPY  L-JOJF.
000790     COPY  L-JOSF.
000800     COPY  L-JOS2.                                                *A050901
000810     COPY  LOKJF.
000820     COPY  LITDNW.                                                I.040922
000830     COPY  LITDNN.                                                I.050119
000840     COPY  L-TDIF.                                                I.080325
000850     COPY  LITDNA.                                                I.091221
000860     COPY  L-JCON.                                                I.900411
000870*
000880 WORKING-STORAGE                SECTION.
000890     COPY  LWMSG.
000900*
000910 77  JS-SIGN                    PIC  9(01).                       I.911120
000920 77  JS-SK                      PIC  9(01).                       *A050901
000930 77  W-BUMON                    PIC  9(01).                       I.051126
000940 01  WORK-AREA.
000950     02  II                     PIC  9(02).                       *A050901
000960     02  WORK-01.
000970         03  HIZ1-W             PIC  9(06).
000980         03  HIZ1-WR            REDEFINES  HIZ1-W.
000990             04  YY1-W          PIC  9(02).
001000             04  MM1-W          PIC  9(02).
001010             04  DD1-W          PIC  9(02).
001020         03  HIZ2-W             PIC  9(06).
001030         03  HIZ2-WR            REDEFINES  HIZ2-W.
001040             04  YY2-W          PIC  9(02).
001050             04  MM2-W          PIC  9(02).
001060             04  DD2-W          PIC  9(02).
001070         03  TIM1-W             PIC  9(08).
001080         03  TIM1-WR            REDEFINES  TIM1-W.
001090             04  JI1-W          PIC  9(02).
001100             04  FU1-W          PIC  9(02).
001110             04  SE1-W          PIC  9(04).
001120         03  TIM2-W             PIC  9(08).
001130         03  TIM2-WR            REDEFINES  TIM2-W.
001140             04  JI2-W          PIC  9(02).
001150             04  FU2-W          PIC  9(02).
001160             04  SE2-W          PIC  9(04).
001170         03  INP-W              PIC  9(01).
001180         03  KAKU-W             PIC  X(01).
001190         03  STS-W              PIC  9(01).
001200         03  ERR-CD             PIC  9(01).
001210         03  ERR-SW             PIC  9(01).
001220         03  ERR-STAT           PIC  X(02).
001230         03  DEN-CP             PIC  9(06).
001240         03  NXT-NO             PIC  9(04).
001250         03  NN                 PIC  9(02).
001260         03  NA                 PIC  9(02).
001270         03  W-SKB              PIC  9(01).                       I.900411
001280         03  W-SNM              PIC  N(06).                       I.900411
001290****     03  W-FUJ              PIC  9(01).                       D 911106
001300 01  STR-TMP.
001310     02  STR-01                 PIC  9(02).
001320     02  STR-02.
001330         03  STR-020            PIC  9(07).                       KEY
001340         03  STR-021            PIC  X(243).                      *R 92/05
001350         03  STR-021A           PIC  X(01).                       *I 92/05
001360         03  STR-022            PIC  9(01).
001370         03  STR-023            PIC  9(01).
001380         03  STR-024            PIC  9(01).
001390 01  NIF-TMP.
001400     02  NIF-01                 PIC  9(02).
001410     02  NIF-02                 OCCURS  2.
001420         03  NIF-021            PIC  9(07).                       KEY
001430         03  NIF-022            PIC  X(120).                      R.900411
001440 01  OKJ-TMP.
001450     02  OKJ-01                 PIC  9(02).
001460     02  OKJ-02                 OCCURS  4.
001470         03  OKJ-021            PIC  9(06).                       KEY
001480         03  OKJ-022            PIC  X(57).                       I.040628
001490*****    03  OKJ-022            PIC  X(45).                       D.040628
001500 01  TDNW-TMP.                                                    I.040922
001510     02  TDNW-01                PIC  9(02).                       I.040922
001520     02  TDNW-02.                                                 I.040922
001530         03  TDNW-02A           PIC  X(11).                       I.040922
001540         03  TDNW-020           PIC  X(07).                       I.040922
001550         03  TDNW-02B           PIC  X(02).                       I.040922
001560         03  TDNW-021           PIC  X(233).                      I.040922
001570         03  TDNW-022           PIC  9(01).                       I.040922
001580 01  TDNN-TMP.                                                    I.050119
001590     02  TDNN-01                PIC  9(02).                       I.050119
001600     02  TDNN-02.                                                 I.050119
001610         03  TDNN-02A           PIC  X(11).                       I.050119
001620         03  TDNN-020           PIC  X(07).                       I.050119
001630         03  TDNN-02B           PIC  X(02).                       I.050119
001640         03  TDNN-021           PIC  X(233).                      I.050119
001650         03  TDNN-022           PIC  9(01).                       I.050119
001660 01  TDI-TMP.                                                     I.080325
001670     02  TDI-01                 PIC  9(02).                       I.008032
001680     02  TDI-02.                                                  I.080325
001690         03  TDI-02A            PIC  X(07).                       I.080325
001700         03  TDI-020           PIC   X(245).                      I.100922
001710         03  TDI-021           PIC   X(01).                       I.100922
001720         03  TDI-022           PIC   X(01).                       I.100922
001730*****    03  TDI-020           PIC   X(163).                      D.100922
001740*****    03  F                  PIC  X(84).                       D.100922
001750 01  TDNA-TMP.                                                    I.091221
001760     02  TDNA-01                PIC  9(02).                       I.091221
001770     02  TDNA-02.                                                 I.091221
001780         03  TDNA-02A           PIC  X(07).                       I.091221
001790*****    03  TDNA-020           PIC  X(06).                       D.100901
001800         03  TDNA-020           PIC  X(07).                       I.100901
001810         03  TDNA-02B           PIC  X(02).                       I.091221
001820         03  TDNA-021           PIC  X(218).                      I.100901
001830*****    03  TDNA-021           PIC  X(219).                      D.100901
001840         03  TDNA-022           PIC  X(01).                       I.091221
001850         03  TDNA-023           PIC  9(08).                       I.091221
001860         03  TDNA-024           PIC  9(01).                       I.091221
001870         03  TDNA-025           PIC  X(08).                       I.091221
001880         03  TDNA-026           PIC  9(01).                       I.091221
001890         03  TDNA-027           PIC  9(01).                       I.091221
001900 01  KEN-WORK.
001910*****02  KEN-W                  OCCURS  3.                        D.040922
001920*****02  KEN-W                  OCCURS  4.                        D.050119
001930*****02  KEN-W                  OCCURS  5.                        D.080325
001940*****02  KEN-W                  OCCURS  6.                        D.091221
001950     02  KEN-W                  OCCURS  7.                        I.091221
001960         03  FST-WK.
001970             04  FST-W1         PIC  9(06).
001980             04  FST-W2         PIC  9(01).
001990         03  LST-WK.
002000             04  LST-W1         PIC  9(06).
002010             04  LST-W2         PIC  9(01).
002020         03  CNT-W              PIC  9(05).
002030 01  DEFINE-WORK.
002040     02  FIL-DF                 PIC  X(10)  OCCURS  4.
002050     02  M-DF                   PIC  X(01)  OCCURS  4.
002060*****02  KBN-DF                 PIC  9(02)  OCCURS  3.            D.040922
002070*****02  KBN-DF                 PIC  9(02)  OCCURS  4.            D.050119
002080*****02  KBN-DF                 PIC  9(02)  OCCURS  5.            D.080325
002090*****02  KBN-DF                 PIC  9(02)  OCCURS  6.            D.091221
002100     02  KBN-DF                 PIC  9(02)  OCCURS  7.            I.091221
002110     02  HTAB                   PIC  X(02)  VALUE  "01".
002120     02  BSKIP                  PIC  X(02)  VALUE  "09".
002130     02  PF6                    PIC  X(02)  VALUE  "P6".
002140     02  PF9                    PIC  X(02)  VALUE  "P9".
002150 01  KEY-WORK.
002160     02  KEY-01                 PIC  9(02).
002170     02  KEY-02                 PIC  9(07).
002180*01  BUSYO-WORK.                                                  D.980311
002190*****02  W-BKB1                 PIC  X(01).                       D.980311
002200*****02  W-BKB2                 PIC  X(01).                       D.930622
002210*****02  W-BKB3                 PIC  X(01).                       D.980311
002220*****02  W-BKB4                 PIC  X(01).                       D.980311
002230*****02  W-BNM1                 PIC  N(02).                       D.980311
002240*****02  W-BNM2                 PIC  N(02).                       D.930622
002250*****02  W-BNM3                 PIC  N(02).                       D.980311
002260*****02  W-BNM4                 PIC  N(02).                       D.980311
002270*01  SYS-NAME                   PIC  N(05).                       D.100109
002280 SCREEN                         SECTION.
002290 SD  GAMEN  END  STATUS  END-STS.
002300 01  CLR-GMN     LINE    1.                                       I.890901
002310     02     CLEAR        SCREEN.                                  I.890901
002320 01  DSP-GMN.
002330*****02  LINE   1  COLUMN  20  PIC  N(16)  VALUE                  D.980311
002340*****  NC"ÅñÅñÅ@éıÇnÅ^ÇkëóêMÇeê∂ê¨áTÅ@ÅñÅñ".                      D.980311
002350     02  LINE   1  COLUMN  22  PIC  N(15)  VALUE                  I.980311
002360       NC"ÅñÅñÅ@ÇnÅ^ÇkëóêMÇeê∂ê¨áTÅ@ÅñÅñ".                        I.980311
002370     02  LINE   4.                                                I.030724
002380         03  COLUMN  19  PIC  X(11)  VALUE                        I.051126
002390             "ã≥Å@àÁ=0 , ".                                       I.051126
002400         03  COLUMN  30  PIC  X(14)  VALUE                        I.070411
002410             "àÍÅ@î =1 ...  ".                                    I.070411
002420*****    03  COLUMN  30  PIC  N(09)  VALUE                        D.070411
002430*****        NC"ÉèÅ[ÉNÅEÉJÉWÉÖÉAÉã".                              D.070411
002440*****    03  COLUMN  48  PIC  X(08)  VALUE "=1 ...  ".            D.070411
002450*****    03  COLUMN  16  PIC  X(22)  VALUE                        D.051126
002460*****        "ã≥Å@àÁ=0 , ÉèÅ[ÉN=1 , ".                            D.051126
002470*****    03  COLUMN  38  PIC  N(05)  VALUE NC"ÉJÉWÉÖÉAÉã".        D.051126
002480*****    03  COLUMN  48  PIC  X(08)  VALUE "=2 ...  ".            D.051126
002490*****02  LINE   4  COLUMN  20  PIC  X(22)  VALUE                  D.030724
002500     02  LINE   7  COLUMN  20  PIC  X(22)  VALUE                  I.030724
002510         "èoâ◊ì˙ ÅÅ   îN  åé  ì˙".
002520*****02  LINE   7  COLUMN  20  PIC  X(14)  VALUE                  D.030724
002530     02  LINE  10  COLUMN  20  PIC  X(14)  VALUE                  I.030724
002540         "ëóêMêÊ = ( ) :".                                        I.900411
002550***  02  LINE   9  COLUMN  20  PIC  X(49)  VALUE                  D 911106
002560***      "ì°çËèoâ◊ÉfÅ[É^ëóêMãÊï™ ÅÅ    Åi0:Ç∑ÇÈÅC1:ÇµÇ»Ç¢Åj".     D 911106
002570*****02  LINE  15  COLUMN  20  PIC  X(23)  VALUE                  D.980311
002580*****    "êVâ™ÉfÅ[É^èàóùïîèêÅÅ( )".                               D.980311
002590*****02  LINE  15  COLUMN  51  PIC  X(21)  VALUE                  D.980311
002600*****    "ÅiSPACE=ì˙êi,1=êVâ™Åj".                                 D.980311
002610*****02  LINE  16  COLUMN  20  PIC  X(23)  VALUE                  D.930622
002620*****    "ízç`ÉfÅ[É^èàóùïîèêÅÅ( )".                               D.930622
002630*****02  LINE  17  COLUMN  20  PIC  X(23)  VALUE                  D.930622
002640*****02  LINE  16  COLUMN  20  PIC  X(23)  VALUE                  D.980311
002650*****    "ì°çËÉfÅ[É^èàóùïîèêÅÅ( )".                               D.980311
002660*****02  LINE  18  COLUMN  20  PIC  X(23)  VALUE                  D.930622
002670*****02  LINE  17  COLUMN  20  PIC  X(23)  VALUE                  D.980311
002680*****    "ã¥ñ{ÉfÅ[É^èàóùïîèêÅÅ( )".                               D.980311
002690*****    "éRã„ÉfÅ[É^èàóùïîèêÅÅ( )".                               D.931202
002700     02  LINE  24  COLUMN  40  PIC  X(13)  VALUE
002710         "ämîF      ( )".
002720 01  GMN-SIGN      LINE   4.                                      I.030724
002730*****02  ACP-SIGN  COLUMN  55  PIC  9(01)  USING  JS-SIGN         D.070411
002740     02  ACP-SIGN  COLUMN  43  PIC  9(01)  USING  JS-SIGN         I.070411
002750                                       CHECK  OVERFLOW  NO  IFC.  I.030724
002760*01  HIZUKE        LINE   4.                                      D.030724
002770 01  HIZUKE        LINE   7.                                      I.030724
002780     02  ACP-YY1   COLUMN  30  PIC  9(02)  INTO  YY1-W  NO  IFC.
002790     02  ACP-MM1   COLUMN  34  PIC  9(02)  INTO  MM1-W  NO  IFC.
002800     02  ACP-DD1   COLUMN  38  PIC  9(02)  INTO  DD1-W
002810                                       CHECK  OVERFLOW  NO  IFC.
002820*01  SOUSIN        LINE   7.                                      D.030724
002830 01  SOUSIN        LINE  10.                                      I.030724
002840     02  ACP-SKB   COLUMN  30  PIC  9(01)  USING  W-SKB           I.900411
002850                                       CHECK  OVERFLOW  NO  IFC.  I.900411
002860     02  ACP-SNM   COLUMN  35  PIC  N(06)  USING  W-SNM           I.900411
002870                                       CHECK  OVERFLOW  NO  IFC.  I.900411
002880*01  BUSYO-AREA.                                                  D.980311
002890*****02  ACP-BKB1  LINE  15  COLUMN  41    PIC X(01)              D.980311
002900*****              USING W-BKB1        CHECK  OVERFLOW  NO  IFC.  D.980311
002910*****02  DSP-BNM1  LINE  15  COLUMN  44    PIC N(02)              D.980311
002920*****              FROM  W-BNM1.                                  D.980311
002930*****02  ACP-BKB2  LINE  16  COLUMN  41    PIC X(01)              D.930622
002940*****              USING W-BKB2        CHECK  OVERFLOW  NO  IFC.  D.930622
002950*****02  DSP-BNM2  LINE  16  COLUMN  44    PIC N(02)              D.930622
002960*****              FROM  W-BNM2.                                  D.930622
002970*****02  ACP-BKB3  LINE  17  COLUMN  41    PIC X(01)              D.930622
002980*****02  ACP-BKB3  LINE  16  COLUMN  41    PIC X(01)              D.980311
002990*****              USING W-BKB3        CHECK  OVERFLOW  NO  IFC.  D.980311
003000*****02  DSP-BNM3  LINE  17  COLUMN  44    PIC N(02)              D.930622
003010*****02  DSP-BNM3  LINE  16  COLUMN  44    PIC N(02)              D.980311
003020*****              FROM  W-BNM3.                                  D.980311
003030*****02  ACP-BKB4  LINE  18  COLUMN  41    PIC X(01)              D.930622
003040*****02  ACP-BKB4  LINE  17  COLUMN  41    PIC X(01)              D.980311
003050*****              USING W-BKB4        CHECK  OVERFLOW  NO  IFC.  D.980311
003060*****02  DSP-BNM4  LINE  18  COLUMN  44    PIC N(02)              D.930622
003070*****02  DSP-BNM4  LINE  17  COLUMN  44    PIC N(02)              D.980311
003080*****              FROM  W-BNM4.                                  D.980311
003090*01  SOUSIN2       LINE   4.                                      D.030724
003100 01  SOUSIN2       LINE   7.                                      I.030724
003110     02  DSP-HIZ.
003120         03        COLUMN  30  PIC  9(02)  FROM  YY1-W.
003130         03        COLUMN  34  PIC  Z9     FROM  MM1-W.
003140         03        COLUMN  38  PIC  Z9     FROM  DD1-W.
003150     02  CLR-HIZ.
003160         03        COLUMN  30  PIC  X(02)  VALUE  " ".
003170         03        COLUMN  34  PIC  X(02)  VALUE  " ".
003180         03        COLUMN  38  PIC  X(02)  VALUE  " ".
003190*01  SOUSIN3       LINE   9.                                      D 911106
003200*****02  ACP-FUJ   COLUMN  46  PIC  9(01)  USING  W-FUJ               :
003210*****                                  CHECK  OVERFLOW  NO  IFC.  D 911106
003220*01  MESSEGE       LINE  12.                                      D.030724
003230 01  MESSEGE       LINE  15.                                      I.030724
003240     02  DSP-MSG.
003250         03        COLUMN  10  PIC  N(19)  VALUE
003260           NC"ñ¢ëóêMÉfÅ[É^óLÇËÅAèàóùÇé¿çsÇµÇ‹Ç∑Ç©ÅH".
003270         03        COLUMN  49  PIC  X(17)  VALUE
003280           "YES=1,NO=9--->( )".
003290     02  ACP-INP   COLUMN  64  PIC  9(01)  INTO  INP-W
003300                                       CHECK  OVERFLOW  NO  IFC.
003310*01  MESSEGE1      LINE  12.                                      D.030724
003320 01  MESSEGE1      LINE  15.                                      I.030724
003330     02  DSP-MSG1.                                                I.890901
003340         03        COLUMN  10  PIC  N(20)  VALUE                  I.890901
003350           NC"ëºÇ≈ÉfÅ[É^ê∂ê¨íÜÇ≈Ç∑ÅBèàóùÇíÜífÇµÇ‹Ç∑ÅB".          I.890901
003360*01  MESSEGE2      LINE  12.                                      D.030724
003370 01  MESSEGE2      LINE  15.                                      I.030724
003380     02  DSP-MSG2.                                                I.980313
003390         03        COLUMN  10  PIC  N(12)  VALUE                  I.980313
003400           NC"ëóêMÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB".                          I.980313
003410 01  MESSEGE3      LINE  15.                                      I.090929
003420     02  DSP-MSG3.                                                I.090929
003430         03        COLUMN  10  PIC  N(18)  VALUE                  I.090929
003440           NC"ëOâÒÉfÅ[É^ñ¢èàóùÅBèàóùÇíÜífÇµÇ‹Ç∑ÅB".              I.090929
003450 01  MESSEGE4      LINE  15.                                      I.100109
003460     02  DSP-MSG4.                                                I.100109
003470         03        COLUMN  10  PIC  N(18)  VALUE                  I.100109
003480           NC"ÇiÇqÇbÇnÇcÇdÉGÉâÅ[èàóùÇíÜífÇµÇ‹Ç∑ÅB".              I.100109
003490 01  ACP-KAKU      LINE  24.
003500     02            COLUMN  51  PIC  X(01)  INTO  KAKU-W
003510                                       CHECK  OVERFLOW  NO  IFC.
003520*01  DSP-SYSIN         LINE  01.                                  D.100109
003530*****02            COLUMN  01  PIC  N(05)  FROM  SYS-NAME.        D.100109
003540*01  DSP-ICHK      LINE  21.                                      D.980311
003550*****02  DSP-IC    COLUMN  10  PIC  N(09)  VALUE                  D.980311
003560*****     NC"èàóùïîèêÅ@É`ÉFÉbÉN".                                 D.980311
003570*****02  DSP-ICS   COLUMN  10  PIC  X(18)  VALUE                  D.980311
003580*****       "                  ".                                 D.980311
003590     COPY  LSERR.                                                 R.900411
003600*================================================================*
003610 PROCEDURE                      DIVISION.
003620*
003630 MAINLINE-ROUTINE.
003640     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
003650     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
003660     IF  END-STS     =  PF9         STOP  RUN.
003670     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
003680     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT.
003690     PERFORM  ENDR-RTN  THRU  ENDR-RTN-EXIT.
003700     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
003710*
003720 MAINLINE-END.
003730     STOP  RUN.
003740*
003750 PROC-RTN.
003760     PERFORM  JSTR-RTN  THRU  JSTR-RTN-EXIT.
003770     PERFORM  JNIF-RTN  THRU  JNIF-RTN-EXIT.
003780     PERFORM  OKJF-RTN  THRU  OKJF-RTN-EXIT.
003790*****IF  JS-SK       =  2                                         D.090929
003800*****    IF  JS-SIGN     =  0                                     D.100105
003810     IF  JS-SK = 3                                                I.100105
003820         IF  W-SKB       =  3                                     I.100105
003830             PERFORM  TDNA-RTN  THRU  TDNA-RTN-EXIT.              I.091221
003840*****IF  JS-SIGN     =  1                                         D.100105
003850*****    IF  W-SKB       =  1                                     D.051126
003860     IF  W-SKB       =  1                                         I.100105
003870         PERFORM  TDNW-RTN  THRU  TDNW-RTN-EXIT                   I.050119
003880         PERFORM  TDNN-RTN  THRU  TDNN-RTN-EXIT                   I.080325
003890         PERFORM  TDI-RTN   THRU  TDI-RTN-EXIT.                   I.080325
003900*****        PERFORM  TDNN-RTN  THRU  TDNN-RTN-EXIT.              D.080325
003910*****    PERFORM  TDNW-RTN  THRU  TDNW-RTN-EXIT.                  D.050119
003920     PERFORM  JOJF-RTN  THRU  JOJF-RTN-EXIT.
003930 PROC-RTN-EXIT.
003940     EXIT.
003950*
003960*================================================================*
003970*    èâä˙ê›íËèàóù                                                *
003980*================================================================*
003990 INIT-RTN.
004000     ACCEPT  JS-SK.                                               *A050901
004010     IF JS-SK = 3                                                 I.091221
004020         ACCEPT  JS-SIGN.                                         I.091221
004030*****ACCEPT  JS-SIGN.                                             D.030724
004040*****MOVE  SPACE     TO  KEN-WORK  KEY-WORK                       D.980312
004050     MOVE  SPACE     TO  KEY-WORK                                 I.980312
004060                         STR-TMP   NIF-TMP  OKJ-TMP               I.091221
004070                         TDNW-TMP  TDNN-TMP TDI-TMP   TDNA-TMP.   I.091221
004080*****    STR-TMP   NIF-TMP  OKJ-TMP  TDNW-TMP  TDNN-TMP  TDI-TMP. D.091221
004090*****      STR-TMP   NIF-TMP  OKJ-TMP  TDNW-TMP  TDNN-TMP.        D.080325
004100*****      STR-TMP   NIF-TMP  OKJ-TMP  TDNW-TMP.                  D.050119
004110*****                    STR-TMP   NIF-TMP  OKJ-TMP.              D.040922
004120     MOVE  ZERO      TO  KEN-WORK.                                I.980312
004130     MOVE  ZERO      TO  ERR-SW ERR-CD.
004140     MOVE  10        TO  ERR-LIN.
004150     MOVE  "JOJF"    TO  FIL-DF(1)  FIL-DF(2) FIL-DF(3).
004160*****IF JS-SK = 1                                                 D.090929
004170     IF JS-SK = 1 OR 3                                            I.090929
004180        MOVE  "JOLSF"   TO  FIL-DF(4)
004190     ELSE                                                         *A050901
004200        MOVE  "JOLSF2"  TO  FIL-DF(4).                            *A050901
004210     MOVE  "W"       TO  M-DF(1)  M-DF(4).
004220     MOVE  "R"       TO  M-DF(2).
004230     MOVE  "A"       TO  M-DF(3).
004240     MOVE  11        TO  KBN-DF(1).
004250     MOVE  12        TO  KBN-DF(2).
004260     MOVE  13        TO  KBN-DF(3).
004270     MOVE  14        TO  KBN-DF(4).                               I.040922
004280     MOVE  15        TO  KBN-DF(5).                               I.050119
004290     MOVE  16        TO  KBN-DF(6).                               I.080325
004300     MOVE  17        TO  KBN-DF(7).                               I.091221
004310 INIT-RTN-EXIT.
004320     EXIT.
004330*================================================================*
004340*    ÇnÇoÇdÇmèàóù                                                *
004350*================================================================*
004360 OPEN-RTN.
004370     OPEN  INPUT  JSTR  JNIF  OKJF  JCON.
004380*****IF JS-SK = 1                                                 D.090929
004390     IF JS-SK = 1 OR 3                                            I.090929
004400        OPEN OUTPUT JOLSF
004410     ELSE                                                         *A050901
004420        OPEN OUTPUT JOLSF2.                                       I.090929
004430*****   OPEN OUTPUT JOLSF2                                        D.090929
004440*****IF  JS-SIGN     =  1                                         D.100105
004450     IF  W-SKB       =  1                                         I.100105
004460            OPEN  INPUT  TDNWF  TDNNF  TDIF                       I.091221
004470     ELSE                                                         I.091221
004480         IF  (W-SKB       =  3)  AND  (JS-SK       =  3)          I.100105
004490            OPEN  INPUT  TDNAF.                                   I.091221
004500*****       OPEN  INPUT  TDNWF  TDNNF  TDIF.                      D.091221
004510*****       OPEN  INPUT  TDNWF  TDNNF.                            D.080325
004520*****   OPEN  INPUT  TDNWF  TDNNF                                 D.061206
004530*****   OPEN OUTPUT JOLSF2.                                       D.061206
004540*****IF  JS-SIGN     =  1                                         D.051126
004550*****    OPEN  INPUT  TDNWF  TDNNF.                               D.051126
004560*****    OPEN  INPUT  TDNWF.                                      D.050119
004570 OPEN-RTN-EXIT.
004580     EXIT.
004590*================================================================*
004600*    ëIëèàóùÅ@Å@Å@Å@               (SLCT-RTN)                   *
004610*================================================================*
004620 SLCT-RTN.
004630     DISPLAY  CLR-GMN  DSP-GMN.                                   I.030724
004640     IF  JS-SK   NOT =  3           GO  TO  SLCT-005.             I.090929
004650     OPEN  INPUT  JOLSF.                                          I.090929
004660     READ  JOLSF    AT  END                                       I.090929
004670           CLOSE    JOLSF                                         I.091221
004680           DISPLAY ACP-SIGN                                       I.091221
004690           GO  TO  SLCT-010.                                      I.091221
004700*****      CLOSE    JOLSF           GO  TO  SLCT-005.             D.091221
004710     CLOSE    JOLSF.                                              I.090929
004720     DISPLAY   DSP-MSG3  DISP-BUZ-B.                              I.090929
004730     MOVE      200      TO    COMPLETION-CODE.                    I.090929
004740     MOVE      PF9      TO    END-STS                             I.090929
004750     GO   TO   SLCT-RTN-EXIT.                                     I.090929
004760 SLCT-005.                                                        I.030724
004770     ACCEPT  ACP-SIGN.                                            I.030724
004780*****IF  END-STS     =  PF9         MOVE 255 TO COMPLETION-CODE   D.060323
004790     IF  END-STS     =  PF9         MOVE 200 TO COMPLETION-CODE   I.060323
004800                                    GO TO  SLCT-RTN-EXIT.         I.030724
004810     IF  END-STS NOT =  HTAB        GO TO  SLCT-005.              I.030724
004820*****IF  JS-SIGN NOT =  0  AND  1  AND  2                         D.051126
004830     IF  JS-SIGN NOT =  0  AND  1                                 I.051126
004840                                    GO TO  SLCT-005.              I.030724
004850*****IF  JS-SIGN  =  0                                            D.030724
004860*****    MOVE  NC"Åmã≥Å@àÁÅn"  TO  SYS-NAME.                      D.030724
004870*****IF  JS-SIGN  =  1                                            D.030724
004880*****    MOVE  NC"ÅmÉèÅ[ÉNÅn"  TO  SYS-NAME.                      D.030724
004890*****IF  JS-SIGN  =  2                                            D.030724
004900*****    MOVE  NC"ÅmÉJÉWÉÖÅn"  TO  SYS-NAME.                      D.030724
004910*****    MOVE  NC"ÅmàÍÅ@î Ån"  TO  SYS-NAME.                      D.030707
004920*****IF  JS-SIGN  =  9                                            D.030724
004930*****    MOVE  NC"Å@Å@Å@Å@Å@"  TO  SYS-NAME.                      D.030724
004940*****DISPLAY  CLR-GMN  DSP-GMN   DSP-SYSIN.                       D.030724
004950 SLCT-010.
004960     ACCEPT  ACP-YY1.
004970*****IF  END-STS     =  PF9         MOVE 255 TO COMPLETION-CODE   D.060323
004980     IF  END-STS     =  PF9         MOVE 200 TO COMPLETION-CODE   I.060323
004990                                    GO TO  SLCT-RTN-EXIT.
005000     IF  END-STS     =  BSKIP                                     I.091221
005010         IF  JS-SK   NOT =  3       GO TO  SLCT-005.              I.091221
005020*****IF  END-STS     =  BSKIP       GO TO  SLCT-005.              D.091221
005030*****IF  YY1-W       =  ZERO        ACCEPT  HIZ1-W  FROM  DATE    D.980525
005040*****                               GO TO  SLCT-035.              D.980525
005050 SLCT-020.
005060     ACCEPT  ACP-MM1.
005070     IF  END-STS     =  BSKIP       GO TO  SLCT-010.
005080     IF  MM1-W       =  ZERO                                      I.980525
005090         IF  YY1-W       =  ZERO    GO TO  SLCT-030.              I.980525
005100     IF  MM1-W  <  1  OR  MM1-W  >  12                            I.980525
005110                                    GO TO  SLCT-020.              I.980525
005120 SLCT-030.
005130     ACCEPT  ACP-DD1.
005140     IF  END-STS     =  BSKIP       GO TO  SLCT-020.
005150     IF  END-STS NOT =  HTAB        GO TO  SLCT-030.
005160     IF  DD1-W       =  ZERO                                      I.980525
005170         IF  MM1-W       =  ZERO    ACCEPT  HIZ1-W  FROM  DATE    I.980525
005180                                    GO TO  SLCT-035.              I.980525
005190     IF  DD1-W  <  1  OR  DD1-W  >  31                            I.980525
005200                                    GO TO  SLCT-030.              I.980525
005210*****IF  (YY1-W      =  ZERO)  OR                                 D.980525
005220*****    (MM1-W  <  1  OR  MM1-W  >  12)  OR                      D.980525
005230*****    (DD1-W  <  1  OR  DD1-W  >  31)                          D.980525
005240*****                               DISPLAY  CLR-HIZ              D.980525
005250*****                               GO TO  SLCT-010.              D.980525
005260 SLCT-035.
005270     DISPLAY  DSP-HIZ.
005280     IF  JS-SK   NOT =  3           GO TO  SLCT-040.              I.091221
005290*****IF  JS-SIGN     =  0                                         D.100109
005300     IF  COMPLETION-CODE  =  010                                  I.100109
005310         MOVE    3          TO  W-SKB                             I.091221
005320     ELSE
005330         IF  COMPLETION-CODE  =  000                              I.100109
005340             MOVE    1          TO  W-SKB                         I.100109
005350         ELSE                                                     I.100109
005360             DISPLAY   DSP-MSG4  DISP-BUZ-B                       I.100109
005370             MOVE      200      TO    COMPLETION-CODE             I.100109
005380             MOVE      PF9      TO    END-STS                     I.100109
005390             GO   TO   SLCT-RTN-EXIT.                             I.100109
005400*****    IF  JS-SIGN     =  1                                     D.100109
005410*****        MOVE    1          TO  W-SKB.                        D.100109
005420     DISPLAY  ACP-SKB.                                            I.091221
005430     GO TO  SLCT-045.                                             I.100109
005440*****GO TO  SLCT-045.                                             D.100105
005450 SLCT-040.                                                        I.900411
005460     ACCEPT   ACP-SKB.                                            I.900411
005470     IF  END-STS     =  BSKIP       GO TO  SLCT-010.              I.900411
005480     IF  END-STS NOT =  HTAB        GO TO  SLCT-040.              I.900411
005490     IF  W-SKB  =  0                GO TO  SLCT-040.              I.900411
005500 SLCT-045.                                                        I.091221
005510     OPEN   INPUT  JCON.
005520     MOVE    4          TO  JCON4-01.                             I.900411
005530     MOVE    W-SKB      TO  JCON4-02.                             I.900411
005540     READ    JCON       UNLOCK    INVALID                         I.900411
005550             DISPLAY  INV-D01  DISP-BUZ-J                         I.900411
005560             CLOSE JCON                                           I.900417
005570             GO  TO  SLCT-040.                                    I.900411
005580     CLOSE JCON.                                                  I.900417
005590     MOVE    JCON4-03   TO  W-SNM.                                I.900411
005600     DISPLAY  ACP-SNM.                                            I.900411
005610*****IF  JS-SK  =  2                                              D.091221
005620*****IF  JS-SK  =  2  OR  3                                       D.100109
005630     IF  JS-SK  =  2                                              I.100109
005640         IF  W-SKB  NOT =  1 AND 3  GO TO  SLCT-040.              I.061206
005650*****    IF  W-SKB  NOT =  1        GO TO  SLCT-040.              D.061206
005660*    IF  JS-SK  =  1                                              I.051216
005670*        IF  W-SKB      =  1 OR  3  GO TO  SLCT-040.              I.061206
005680*****    IF  W-SKB      =  1        GO TO  SLCT-040.              D.061206
005690*SLCT-040A.                                                       D.980311
005700*****ACCEPT   ACP-BKB1.                                           D.980311
005710*****IF  END-STS     =  BSKIP       GO TO  SLCT-040.              D.980311
005720*****IF  END-STS NOT =  HTAB        GO TO  SLCT-040A.             D.980311
005730*****IF  W-BKB1  NOT =  " " AND "1" GO TO  SLCT-040A.             D.980311
005740*****IF  W-BKB1      =  " "     MOVE  SPACE  TO  W-BNM1.          D.980311
005750*****IF  W-BKB1      =  "1"     MOVE  NC"êVâ™"   TO  W-BNM1.      D.980311
005760*****DISPLAY     DSP-BNM1.                                        D.980311
005770*SLCT-040B.                                                       D.930622
005780*****ACCEPT   ACP-BKB2.                                           D.930622
005790*****IF  END-STS     =  BSKIP       GO TO  SLCT-040A.             D.930622
005800*****IF  END-STS NOT =  HTAB        GO TO  SLCT-040B.             D.930622
005810*****IF  W-BKB2  NOT =  " " AND "1" GO TO  SLCT-040B.             D.930622
005820*****IF  W-BKB2      =  " "     MOVE  SPACE  TO  W-BNM2.          D.930622
005830*****IF  W-BKB2      =  "1"     MOVE  NC"êVâ™"   TO  W-BNM2.      D.930622
005840*****DISPLAY     DSP-BNM2.                                        D.930622
005850*SLCT-040C.                                                       D.980311
005860*****ACCEPT   ACP-BKB3.                                           D.980311
005870*****IF  END-STS     =  BSKIP       GO TO  SLCT-040B.             D.930622
005880*****IF  END-STS     =  BSKIP       GO TO  SLCT-040A.             D.980311
005890*****IF  END-STS NOT =  HTAB        GO TO  SLCT-040C.             D.980311
005900*****IF  W-BKB3  NOT =  " " AND "1" GO TO  SLCT-040C.             D.980311
005910*****IF  W-BKB3      =  " "     MOVE  SPACE  TO  W-BNM3.          D.980311
005920*****IF  W-BKB3      =  "1"     MOVE  NC"êVâ™"   TO  W-BNM3.      D.980311
005930*****DISPLAY     DSP-BNM3.                                        D.980311
005940*SLCT-040D.                                                       D.980311
005950*****ACCEPT   ACP-BKB4.                                           D.980311
005960*****IF  END-STS     =  BSKIP       GO TO  SLCT-040C.             D.980311
005970*****IF  END-STS NOT =  HTAB        GO TO  SLCT-040D.             D.980311
005980*****IF  W-BKB4  NOT =  " " AND "1" GO TO  SLCT-040D.             D.980311
005990*****IF  W-BKB4      =  " "     MOVE  SPACE  TO  W-BNM4.          D.980311
006000*****IF  W-BKB4      =  "1"     MOVE  NC"êVâ™"   TO  W-BNM4.      D.980311
006010*****DISPLAY     DSP-BNM4.                                        D.980311
006020*****IF  SPACE       =  W-BKB1  OR  W-BKB3  OR  W-BKB4            D.980311
006030*****    DISPLAY  DSP-IC   DISP-BUZ-B                             D.980311
006040*****    DISPLAY  DSP-ICS.                                        D.980311
006050*****IF  SPACE       =  W-BKB1  OR  W-BKB3                        D.941220
006060*****    DISPLAY  DSP-IC   DISP-BUZ-B                             D.941220
006070*****    DISPLAY  DSP-ICS.                                        D.941220
006080*SLCT-047.                                                        D 911106
006090*****ACCEPT   ACP-FUJ.                                                :
006100*****IF  END-STS     =  BSKIP       GO TO  SLCT-040.                  :
006110*****IF  END-STS NOT =  HTAB        GO TO  SLCT-047.                  :
006120*****IF  W-FUJ   NOT =  0 AND 1     GO TO  SLCT-047.              D 911106
006130 SLCT-050.
006140     ACCEPT  ACP-KAKU.
006150*****IF  END-STS     =  PF9         MOVE 255 TO COMPLETION-CODE   D.060323
006160     IF  END-STS     =  PF9         MOVE 200 TO COMPLETION-CODE   I.060323
006170                                    GO TO  SLCT-RTN-EXIT.
006180     IF  END-STS     =  BSKIP                                     I.100109
006190         IF  JS-SK       =  3       GO TO  SLCT-010               I.100109
006200         ELSE                       GO TO  SLCT-040.              I.100109
006210*****IF  END-STS     =  BSKIP       GO TO  SLCT-040.              D.100109
006220*****IF  END-STS     =  BSKIP                                     D.100105
006230*****    IF  JS-SK       =  3       GO TO  SLCT-010               D.100105
006240*****    ELSE                       GO TO  SLCT-040.              D.100105
006250*****IF  END-STS     =  BSKIP       GO TO  SLCT-040.              D.091221
006260*****IF  END-STS     =  BSKIP       GO TO  SLCT-040D.             D.980311
006270*****IF  END-STS     =  BSKIP       GO TO  SLCT-040C.             D.941220
006280     IF  END-STS     =  PF6         GO TO  SLCT-RTN.
006290     IF  END-STS NOT =  HTAB        GO TO  SLCT-050.
006300 SLCT-060.
006310     OPEN  I-O  JOJF.
006320     ACCEPT  TIM1-W  FROM  TIME.
006330     MOVE  0001      TO  JOJF-01.
006340*----/ÇnÅ^ÇkèÛãµÇeÅ@ÇqÇdÇ`Çc/----*
006350     READ  JOJF  INVALID  KEY       GO TO  SLCT-100.
006360*
006370     IF    JOJF-061  =   9                                        I.890901
006380           DISPLAY   DSP-MSG1  DISP-BUZ-B                         I.890901
006390*****      MOVE      255      TO    COMPLETION-CODE               D.060324
006400           MOVE      200      TO    COMPLETION-CODE               I.060324
006410           CLOSE     JOJF                                         I.890901
006420           MOVE      PF9      TO    END-STS                       I.890901
006430           GO   TO   SLCT-RTN-EXIT.                               I.890901
006440*
006450     MOVE  1         TO  NN.
006460 SLCT-070.
006470     IF  JOJF-08(NN) NOT =  ZERO    GO TO  SLCT-080.
006480     ADD   1         TO  NN.
006490     IF  NN      NOT >   10         GO TO  SLCT-070.
006500     GO TO  SLCT-RTN-EXIT.
006510 SLCT-080.
006520     DISPLAY  DSP-MSG.
006530 SLCT-090.
006540     ACCEPT   ACP-INP.
006550     IF  END-STS NOT =  HTAB        GO TO  SLCT-090.
006560     IF  INP-W   NOT =  1  AND
006570         INP-W   NOT =  9           GO TO  SLCT-090.
006580     IF  INP-W       =  9           CLOSE  JOJF
006590*****                               MOVE 255 TO COMPLETION-CODE   D.060324
006600                                    MOVE 200 TO COMPLETION-CODE   I.060324
006610                                    MOVE  PF9  TO  END-STS
006620                                    GO TO  SLCT-RTN-EXIT.
006630     MOVE  JOJF-90   TO  NXT-NO.
006640     MOVE  SPACE     TO  JOJF-REC.
006650     MOVE  0001      TO  JOJF-01.
006660     MOVE  NXT-NO    TO  JOJF-90.
006670     MOVE  9         TO  JOJF-061.                                I.890901
006680*----/ÇnÅ^ÇkèÛãµÇeÅ@ÇqÇdÇvÇqÇhÇsÇd/----*
006690     REWRITE  JOJF-REC  INVALID  KEY
006700                                    MOVE  02  TO  ERR-CD
006710                                    MOVE  1   TO  ERR-SW
006720                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
006730                                    STOP  RUN.
006740     GO TO  SLCT-RTN-EXIT.
006750 SLCT-100.
006760     INITIALIZE          JOJF-REC.
006770     MOVE  0001      TO  JOJF-01.
006780*****MOVE  10        TO  JOJF-90.                                 D.981211
006790     MOVE  100       TO  JOJF-90.                                 I.981211
006800     MOVE  9         TO  JOJF-061.                                I.890901
006810*----/ÇnÅ^ÇkèÛãµÇeÅ@ÇvÇqÇhÇsÇd/----*
006820     WRITE    JOJF-REC  INVALID  KEY
006830                                   MOVE  01  TO  ERR-CD
006840                                   MOVE  1   TO  ERR-SW
006850                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
006860                                    STOP  RUN.
006870 SLCT-RTN-EXIT.
006880     EXIT.
006890*================================================================*
006900*    èoâ◊éwê}ÉgÉâÉìèàóù             (JSTR-RTN)                   *
006910*================================================================*
006920 JSTR-RTN.
006930     MOVE  ZERO      TO  CNT-W(1).
006940     MOVE  KBN-DF(1) TO  STR-01.
006950 JSTR-010.
006960*----/èoâ◊éwê}ÉgÉâÉìÅ@ÇqÇdÇ`Çc/----*
006970     READ  JSTR  UNLOCK  AT  END    GO TO  JSTR-RTN-EXIT.
006980*****IF  JS-SIGN   =     0   AND    JSTR-16     NOT =     0       D.030707
006990*****                               GO  TO  JSTR-010.             D.030707
007000*****IF  JS-SIGN   =     1   AND    JSTR-16     NOT =     1       D.030707
007010*****                               GO  TO  JSTR-010.             D.030707
007020*****IF  JS-SIGN   =     9   AND  ( JSTR-16     NOT =  0 AND 1 )  D.030707
007030*****IF  JS-SIGN  NOT =  9   AND  ( JSTR-16     NOT =  JS-SIGN)   D.030724
007040*****IF  JSTR-16  NOT =  JS-SIGN                                  D.051126
007050     MOVE  JSTR-16   TO  W-BUMON.                                 I.051126
007060     IF  W-BUMON      =  2                                        I.051126
007070         MOVE  1         TO  W-BUMON.                             I.051126
007080     IF  W-BUMON  NOT =  JS-SIGN                                  I.051126
007090                                    GO  TO  JSTR-010.             *I 92/05
007100*
007110*****IF  JSTR-07   NOT =     2  AND  3  AND  6  AND  5            D.930622
007120*****IF  JSTR-07   NOT =     2          AND  6  AND  5            D.980311
007130*****IF  JSTR-07   NOT =     2          AND  6                    D.941220
007140*****                               GO  TO  JSTR-010.             D.980311
007150*****IF  JSTR-07   =     2   AND    W-BKB1      NOT =    "1"      D.980311
007160*****                               GO  TO  JSTR-010.             D.980311
007170*****IF  JSTR-07   =     3   AND    W-BKB2      NOT =    "1"      D.930622
007180*****                               GO  TO  JSTR-010.             D.930622
007190*****IF  JSTR-07   =     6   AND    W-BKB3      NOT =    "1"      D.980311
007200*****                               GO  TO  JSTR-010.             D.980311
007210*****IF  JSTR-07   =     5   AND    W-BKB4      NOT =    "1"      D.980311
007220*****                               GO  TO  JSTR-010.             D.980311
007230*****IF  W-SKB  =  1     AND                                      I.900411
007240*****      JSTR-07    NOT =     2  AND  3  AND  6                 R 91/10
007250*****                               GO  TO  JSTR-010.             I.900411
007260*****IF  JSTR-03  NOT =  0  AND  7  GO  TO  JSTR-010.             A 920317
007270*****IF (W-SKB = 1) AND (W-FUJ = 1) AND (JSTR-07 = 6)             D 911106
007280*****                               GO  TO  JSTR-010.             D 911106
007290*****IF  W-SKB  =  2     AND                                      D 91/10
007300*****      JSTR-07    NOT =     6                                 D 91/10
007310*****                               GO  TO  JSTR-010.             D 91/10
007320*****IF  JSTR-07   NOT =  6         GO  TO  JSTR-010.             D.980317
007330     IF  W-SKB         =  1                                       I.980317
007340         IF  JSTR-07   NOT =  6     GO  TO  JSTR-010.             I.980317
007350     IF  W-SKB         =  2                                       I.980317
007360         IF  JSTR-07   NOT =  7     GO  TO  JSTR-010.             I.980317
007370     IF  W-SKB         =  3                                       I.051214
007380         IF  JSTR-07   NOT =  4     GO  TO  JSTR-010.             I.051214
007390     IF  JSTR-158  NOT =  0         GO  TO  JSTR-010.             I.900411
007400     IF  JSTR-03   NOT =  0 AND 7   GO  TO  JSTR-010.             *I 92/05
007410*****IF  JSTR-04   NOT =  HIZ1-W    GO  TO  JSTR-010.             D.980525
007420     IF  JSTR-04S  NOT =  HIZ1-W    GO  TO  JSTR-010.             I.980525
007430     IF  JSTR-05       =  ZERO      GO  TO  JSTR-010.             I.900525
007440     IF  JSTR-17   NOT =  9         GO  TO  JSTR-010.             I.940324
007450*****IF  (JSTR-07  =  2  OR  3) AND (JSTR-03  =  ZERO)  AND       D.900411
007460*********(JSTR-158 =  ZERO)  AND  (JSTR-043  =  DD1-W)            D.900411
007470************************************NEXT  SENTENCE                D.900411
007480*****ELSE                                                         D.900411
007490************************************GO TO  JSTR-010.              D.900411
007500*****IF  JS-SIGN      =  0                                        I.911120
007510*****    IF  JSTR-16     NOT =  0            GO  TO  JSTR-010.    I.911120
007520*****IF  JS-SIGN      =  1                                        I.911120
007530*****    IF  JSTR-16     NOT =  1            GO  TO  JSTR-010.    I.911120
007540*****IF  JS-SIGN      =  9                                        A 920317
007550*****    IF  JSTR-16     NOT =  0  AND  1    GO  TO  JSTR-010.    A 920317
007560     MOVE  JSTR-R    TO  STR-02.
007570     MOVE  "1"       TO  STR-021A.                                *I 92/05
007580     MOVE  JSTR-158  TO  STR-022.
007590     MOVE  JSTR-16   TO  STR-023.
007600     MOVE  JSTR-17   TO  STR-024.
007610*
007620*****IF JS-SK = 1                                                 D.090929
007630     IF JS-SK = 1 OR 3                                            I.090929
007640        MOVE  STR-TMP   TO  JOLSF11-REC
007650        GO  TO  JSTR-W1                                           *A050901
007660     ELSE                                                         *A050901
007670        PERFORM J211-SET-RTN THRU J211-SET-EX                     *A050901
007680        GO  TO  JSTR-W2.                                          *A050901
007690*
007700 JSTR-W1.                                                         *A050901
007710*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
007720     WRITE  JOLSF11-REC.
007730     IF  ERR-STAT    =  "34"
007740                                    MOVE  KBN-DF(1)  TO  KEY-01
007750                                    MOVE  STR-020    TO  KEY-02
007760                                    MOVE  04         TO  ERR-CD
007770                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
007780                                    STOP  RUN.
007790     GO  TO  JSTR-100.                                            *A050901
007800 JSTR-W2.                                                         *A050901
007810*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
007820     WRITE  JOLSF211-REC INVALID                                  *A050901
007830            MOVE  KBN-DF(1)  TO  KEY-01                           *A050901
007840            MOVE  STR-020    TO  KEY-02                           *A050901
007850            MOVE  04         TO  ERR-CD                           *A050901
007860            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
007870            STOP  RUN.                                            *A050901
007880 JSTR-100.                                                        *A050901
007890     IF  CNT-W(1)    =  ZERO        MOVE JSTR-01 TO FST-W1(1)
007900                                    MOVE JSTR-02 TO FST-W2(1).
007910     MOVE  JSTR-01   TO  LST-W1(1).
007920     MOVE  JSTR-02   TO  LST-W2(1).
007930     ADD   1         TO  CNT-W(1).
007940     GO TO  JSTR-010.
007950 JSTR-RTN-EXIT.
007960     EXIT.
007970*================================================================**A050901
007980*    ÇnÅ^ÇkëóêMÇeÇQèoâ◊éwê}ÉZÉbÉgèàóùÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@**A050901
007990*================================================================**A050901
008000 J211-SET-RTN.                                                    *A050901
008010     MOVE SPACE         TO JOLSF211-REC.                          *A050901
008020     INITIALIZE            JOLSF211-REC.                          *A050901
008030     MOVE KBN-DF(1)     TO JOLSF211-01.                           *A050901
008040     MOVE JSTR-01       TO JOLSF211-02.                           *A050901
008050     MOVE JSTR-02       TO JOLSF211-03.                           *A050901
008060     MOVE JSTR-03       TO JOLSF211-04.                           *A050901
008070     MOVE JSTR-04       TO JOLSF211-05.                           *A050901
008080     MOVE JSTR-05       TO JOLSF211-06.                           *A050901
008090     MOVE JSTR-06       TO JOLSF211-07.                           *A050901
008100     MOVE JSTR-07       TO JOLSF211-08.                           *A050901
008110     MOVE JSTR-08       TO JOLSF211-09.                           *A050901
008120     MOVE JSTR-09       TO JOLSF211-10.                           *A050901
008130     MOVE JSTR-10       TO JOLSF211-11.                           *A050901
008140     PERFORM VARYING II FROM 1 BY 1 UNTIL II > 10                 *A050901
008150             MOVE JSTR-1111(II) TO JOLSF211-1211(II)              *A050901
008160             IF JSTR-1111(II) < ZERO                              *A050901
008170                MOVE 1             TO JOLSF211-1211S(II)          *A050901
008180             END-IF                                               *A050901
008190     END-PERFORM.                                                 *A050901
008200     MOVE JSTR-112      TO JOLSF211-122.                          *A050901
008210     IF JSTR-112 < ZERO                                           *A050901
008220        MOVE 1             TO JOLSF211-122S.                      *A050901
008230     PERFORM VARYING II FROM 1 BY 1 UNTIL II > 10                 *A050901
008240             MOVE JSTR-1211(II) TO JOLSF211-1311(II)              *A050901
008250             IF JSTR-1211(II) < ZERO                              *A050901
008260                MOVE 1             TO JOLSF211-1311S(II)          *A050901
008270             END-IF                                               *A050901
008280     END-PERFORM.                                                 *A050901
008290     MOVE JSTR-122      TO JOLSF211-132.                          *A050901
008300     IF JSTR-122 < ZERO                                           *A050901
008310        MOVE 1             TO JOLSF211-132S.                      *A050901
008320     MOVE JSTR-13       TO JOLSF211-14.                           *A050901
008330     MOVE JSTR-14       TO JOLSF211-15.                           *A050901
008340     MOVE JSTR-14A      TO JOLSF211-15A.                          *A050901
008350     MOVE JSTR-14B      TO JOLSF211-15B.                          *A050901
008360     MOVE JSTR-14C      TO JOLSF211-15C.                          *A050901
008370     MOVE JSTR-14D      TO JOLSF211-15D.                          *A050901
008380     MOVE JSTR-15       TO JOLSF211-16.                           *A050901
008390     MOVE JSTR-20       TO JOLSF211-20.                           *A050901
008400     MOVE JSTR-15A      TO JOLSF211-16A.                          *A050901
008410     IF JSTR-15A < ZERO                                           *A050901
008420        MOVE 1             TO JOLSF211-16AS.                      *A050901
008430     MOVE "1"           TO JOLSF211-19.                           *A050901
008440     MOVE JSTR-158      TO JOLSF211-168.                          *A050901
008450     MOVE JSTR-16       TO JOLSF211-17.                           *A050901
008460     MOVE JSTR-17       TO JOLSF211-18.                           *A050901
008470 J211-SET-EX.                                                     *A050901
008480     EXIT.                                                        *A050901
008490*================================================================*
008500*    â◊éDÉgÉâÉìèàóù                 (JNIF-RTN)                   *
008510*================================================================*
008520 JNIF-RTN.
008530     MOVE  ZERO      TO  CNT-W(2).
008540     MOVE  1         TO  STS-W.
008550 JNIF-010.
008560*----/â◊éDÉgÉâÉìÅ@ÇqÇdÇ`Çc/----*
008570     READ  JNIF  UNLOCK  AT  END    GO TO  JNIF-050.
008580 JNIF-020.
008590     MOVE  JNIF1-01  TO  DEN-CP.
008600     IF  JNIF1-02    =  7           GO TO  JNIF-010.
008610*****IF  JS-SIGN   =     0   AND    JNIF1-13A   NOT =     0       D.030707
008620*****                               GO  TO  JNIF-010.             D.030707
008630*****IF  JS-SIGN   =     1   AND    JNIF1-13A   NOT =     1       D.030707
008640*****                               GO  TO  JNIF-010.             D.030707
008650*****IF  JS-SIGN   =     9   AND  ( JNIF1-13A   NOT =  0 AND 1 )  D.030707
008660*****IF  JS-SIGN  NOT =  9   AND  ( JNIF1-13A   NOT =  JS-SIGN)   D.030724
008670*****IF  JNIF1-13A   NOT =  JS-SIGN                               D.051126
008680     MOVE  JNIF1-13A TO  W-BUMON.                                 I.051126
008690     IF  W-BUMON      =  2                                        I.051126
008700         MOVE  1         TO  W-BUMON.                             I.051126
008710     IF  W-BUMON  NOT =  JS-SIGN                                  I.051126
008720                                    GO  TO  JNIF-010.             *I 92/05
008730*
008740*****IF  JNIF1-07  NOT =     2  AND  3  AND  6  AND  5            D.930622
008750*****IF  JNIF1-07  NOT =     2          AND  6  AND  5            D.980311
008760*****IF  JNIF1-07  NOT =     2          AND  6                    D.941220
008770*****                               GO  TO  JNIF-010.             D.980311
008780*****IF  JNIF1-07  =     2   AND    W-BKB1      NOT =    "1"      D.980311
008790*****                               GO  TO  JNIF-010.             D.980311
008800*****IF  JNIF1-07  =     3   AND    W-BKB2      NOT =    "1"      D.930622
008810*****                               GO  TO  JNIF-010.             D.930622
008820*****IF  JNIF1-07  =     6   AND    W-BKB3      NOT =    "1"      D.980311
008830*****                               GO  TO  JNIF-010.             D.980311
008840*****IF  JNIF1-07  =     5   AND    W-BKB4      NOT =    "1"      D.980311
008850*****                               GO  TO  JNIF-010.             D.980311
008860*****IF  JNIF1-07  NOT =  6         GO  TO  JNIF-010.             D.980317
008870     IF  W-SKB         =  1                                       I.980317
008880         IF  JNIF1-07  NOT =  6     GO  TO  JNIF-010.             I.980317
008890     IF  W-SKB         =  2                                       I.980317
008900         IF  JNIF1-07  NOT =  7     GO  TO  JNIF-010.             I.980317
008910     IF  W-SKB         =  3                                       I.051214
008920         IF  JNIF1-07  NOT =  4     GO  TO  JNIF-010.             I.051214
008930     IF  JNIF1-10  NOT =  0         GO  TO  JNIF-010.             I.900411
008940     IF  JNIF1-11  NOT =  1         GO  TO  JNIF-010.             I.900411
008950     IF  JNIF1-04  NOT =  HIZ1-W    GO  TO  JNIF-010.             I.930622
008960*****IF  W-SKB  =  1     AND                                      I.900411
008970*****      JNIF1-07    NOT =     2  AND  3  AND  6                R 91/10
008980*****                               GO  TO  JNIF-010.             I.900411
008990*****IF (W-SKB = 1) AND (W-FUJ = 1) AND (JNIF1-07 = 6)            D 911106
009000*****                               GO  TO  JNIF-010.             D 911106
009010*****IF  W-SKB  =  2     AND                                      D 91/10
009020*****      JNIF1-07    NOT =     6                                D 91/10
009030*****                               GO  TO  JNIF-010.             D 91/10
009040*****IF  (JNIF1-07  =  2  OR  3)  AND  (JNIF1-11  =  1)  AND      D.900411
009050*********(JNIF1-10  =  ZERO)        NEXT  SENTENCE
009060*****ELSE
009070************************************GO TO  JNIF-040.
009080*****IF  JS-SIGN      =  0                                        I.911120
009090*****    IF  JNIF1-13A   NOT =  0            GO  TO  JNIF-010.    I.911120
009100*****IF  JS-SIGN      =  1                                        I.911120
009110*****    IF  JNIF1-13A   NOT =  1            GO  TO  JNIF-010.    I.911120
009120*****IF  JS-SIGN      =  9                                        A 920317
009130*****    IF  JNIF1-13A   NOT =  0  AND  1    GO  TO  JNIF-010.    A 920317
009140*****IF JS-SK = 1       GO  TO  JNIF-030.                         D.090929
009150     IF JS-SK = 1 OR 3  GO  TO  JNIF-030.                         I.090929
009160 JNIF-025.                                                        *A050901
009170     PERFORM J212-SET-RTN THRU J212-SET-EX.                       *A050901
009180     PERFORM J212-WRI-RTN THRU J212-WRI-EX.                       *A050901
009190     IF  JNIF1-02     = 7           GO TO  JNIF-010.              *A050901
009200*                                                                 *A050901
009210     READ  JNIF  UNLOCK  AT  END    GO TO  JNIF-050.              *A050901
009220     IF  JNIF1-01    =  DEN-CP      GO TO  JNIF-025.              *A050901
009230     GO TO  JNIF-020.                                             *A050901
009240 JNIF-030.
009250     PERFORM  WNIF-RTN  THRU  WNIF-RTN-EXIT.
009260*----/â◊éDÉgÉâÉìÅ@ÇqÇdÇ`Çc/----*
009270     READ  JNIF  UNLOCK  AT  END    GO TO  JNIF-050.
009280     IF  JNIF1-01    =  DEN-CP      GO TO  JNIF-030.
009290     GO TO  JNIF-020.
009300*JNIF-040.                                                        D.930622
009310*----/â◊éDÉgÉâÉìÅ@ÇqÇdÇ`Çc/----*
009320*****READ  JNIF  UNLOCK  AT  END    GO TO  JNIF-050.              D.930622
009330*****IF  JNIF1-01    =  DEN-CP      GO TO  JNIF-040.              D.930622
009340*****GO TO  JNIF-020.                                             D.930622
009350 JNIF-050.
009360     IF  STS-W       =  1           GO TO  JNIF-RTN-EXIT.
009370*
009380     MOVE  NIF-TMP   TO  JOLSF12-REC.
009390*
009400*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
009410     WRITE  JOLSF12-REC.
009420     IF  ERR-STAT    =  "34"
009430                                    MOVE  KBN-DF(2)  TO  KEY-01
009440                                    MOVE  NIF-021(1) TO  KEY-02
009450                                    MOVE  04         TO  ERR-CD
009460                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
009470                                    STOP  RUN.
009480 JNIF-RTN-EXIT.
009490     EXIT.
009500*================================================================**A050901
009510*    ÇnÅ^ÇkëóêMÇeÇQâ◊éDÉZÉbÉgèàóù    Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@**A050901
009520*================================================================**A050901
009530 J212-SET-RTN.                                                    *A050901
009540     MOVE KBN-DF(2)     TO JOLSF212-01.                           *A050901
009550     IF JNIF1-02 = 7                                              *A050901
009560        MOVE SPACE         TO JOLSF2122-A                         *A050901
009570        INITIALIZE            JOLSF2122-A                         *A050901
009580        MOVE JNIF2-01      TO JOLSF2122-01                        *A050901
009590        MOVE JNIF2-02      TO JOLSF2122-02                        *A050901
009600        MOVE JNIF2-02A     TO JOLSF2122-02A                       *A050901
009610        MOVE JNIF2-03      TO JOLSF2122-03                        *A050901
009620        MOVE JNIF2-04      TO JOLSF2122-04                        *A050901
009630        MOVE JNIF2-05      TO JOLSF2122-05                        *A050901
009640        MOVE JNIF2-06      TO JOLSF2122-06                        *A050901
009650        MOVE JNIF2-07      TO JOLSF2122-07                        *A050901
009660        IF JNIF2-07 < ZERO                                        *A050901
009670           MOVE 1             TO JOLSF2122-07S                    *A050901
009680        END-IF                                                    *A050901
009690        MOVE JNIF2-07A     TO JOLSF2122-07A                       *A050901
009700        MOVE JNIF2-08      TO JOLSF2122-08                        *A050901
009710     ELSE                                                         *A050901
009720        MOVE SPACE         TO JOLSF2121-A                         *A050901
009730        INITIALIZE            JOLSF2121-A                         *A050901
009740        MOVE JNIF1-01      TO JOLSF2121-01                        *A050901
009750        MOVE JNIF1-02      TO JOLSF2121-02                        *A050901
009760        MOVE JNIF1-03      TO JOLSF2121-03                        *A050901
009770        MOVE JNIF1-04      TO JOLSF2121-04                        *A050901
009780        MOVE JNIF1-05      TO JOLSF2121-05                        *A050901
009790        MOVE JNIF1-06      TO JOLSF2121-06                        *A050901
009800        MOVE JNIF1-07      TO JOLSF2121-07                        *A050901
009810        MOVE JNIF1-08      TO JOLSF2121-08                        *A050901
009820        IF JNIF1-08 < ZERO                                        *A050901
009830           MOVE 1             TO JOLSF2121-08S                    *A050901
009840        END-IF                                                    *A050901
009850        PERFORM VARYING II FROM 1 BY 1 UNTIL II > 27              *A050901
009860                MOVE JNIF1-091(II) TO JOLSF2121-091(II)           *A050901
009870                IF JNIF1-091(II) < ZERO                           *A050901
009880                   MOVE 1             TO JOLSF2121-091S(II)       *A050901
009890                END-IF                                            *A050901
009900        END-PERFORM                                               *A050901
009910        MOVE JNIF1-10      TO JOLSF2121-10                        *A050901
009920        MOVE JNIF1-11      TO JOLSF2121-11                        *A050901
009930        MOVE JNIF1-12      TO JOLSF2121-12                        *A050901
009940        MOVE JNIF1-13      TO JOLSF2121-13                        *A050901
009950        IF JNIF1-13 < ZERO                                        *A050901
009960           MOVE 1             TO JOLSF2121-13S                    *A050901
009970        END-IF                                                    *A050901
009980        MOVE JNIF1-13A     TO JOLSF2121-13A                       *A050901
009990        MOVE JNIF1-14      TO JOLSF2121-14.                       *A050901
010000 J212-SET-EX.                                                     *A050901
010010     EXIT.                                                        *A050901
010020*
010030 J212-WRI-RTN.                                                    *A050901
010040*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
010050     WRITE  JOLSF212-REC  INVALID                                 *A050901
010060            MOVE  KBN-DF(2)  TO  KEY-01                           *A050901
010070            MOVE  NIF-021(1) TO  KEY-02                           *A050901
010080            MOVE  04         TO  ERR-CD                           *A050901
010090            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
010100            STOP  RUN.                                            *A050901
010110*
010120     ADD   1         TO  CNT-W(2).                                I.051026
010130     MOVE  JNIF1-01  TO  LST-W1(2).                               I.051026
010140     MOVE  JNIF1-02  TO  LST-W2(2).                               I.051026
010150 J212-WRI-EX.                                                     *A050901
010160     EXIT.                                                        *A050901
010170*================================================================*
010180*    ëóÇËèÛÇeèàóù                   (OKJF-RTN)                   *
010190*================================================================*
010200 OKJF-RTN.
010210     MOVE  ZERO      TO  CNT-W(3).
010220     MOVE  1         TO  STS-W.
010230 OKJF-010.
010240*----/ëóÇËèÛÇeÅ@ÇqÇdÇ`Çc/----*
010250     READ  OKJF UNLOCK  AT  END     GO TO  OKJF-020.
010260*****IF  JS-SIGN   =     0   AND    OKJF-09     NOT =     0       D.030707
010270*****                               GO  TO  OKJF-010.             D.030707
010280*****IF  JS-SIGN   =     1   AND    OKJF-09     NOT =     1       D.030707
010290*****                               GO  TO  OKJF-010.             D.030707
010300*****IF  JS-SIGN   =     9   AND  ( OKJF-09     NOT =  0 AND 1 )  D.030707
010310*****IF  JS-SIGN  NOT =  9   AND  ( OKJF-09     NOT =  JS-SIGN)   D.030724
010320*****IF  OKJF-09     NOT =  JS-SIGN                               D.051126
010330     MOVE  OKJF-09   TO  W-BUMON.                                 I.051126
010340     IF  W-BUMON      =  2                                        I.051126
010350         MOVE  1         TO  W-BUMON.                             I.051126
010360     IF  W-BUMON  NOT =  JS-SIGN                                  I.051126
010370                                    GO  TO  OKJF-010.             *I 92/05
010380*
010390*****IF  OKJF-04   NOT =     2  AND  3  AND  6  AND  5            D.930622
010400*****IF  OKJF-04   NOT =     2          AND  6  AND  5            D.980311
010410*****IF  OKJF-04   NOT =     2          AND  6                    D.941220
010420*****                               GO  TO  OKJF-010.             D.980311
010430*****IF  OKJF-04   =     2   AND    W-BKB1      NOT =    "1"      D.980311
010440*****                               GO  TO  OKJF-010.             D.980311
010450*****IF  OKJF-04   =     3   AND    W-BKB2      NOT =    "1"      D.930622
010460*****                               GO  TO  OKJF-010.             D.930622
010470*****IF  OKJF-04   =     6   AND    W-BKB3      NOT =    "1"      D.980311
010480*****                               GO  TO  OKJF-010.             D.980311
010490*****IF  OKJF-04   =     5   AND    W-BKB4      NOT =    "1"      D.980311
010500*****                               GO  TO  OKJF-010.             D.980311
010510*****IF  W-SKB  =  1     AND                                      I.900411
010520*****      OKJF-04    NOT =     2  AND  3   AND  6                R 91/10
010530*****                               GO  TO  OKJF-010.             I.900411
010540*****IF (W-SKB = 1) AND (W-FUJ = 1) AND (OKJF-04 = 6)             D 911106
010550*****                               GO  TO  OKJF-010.             D 911106
010560*****IF  W-SKB  =  2     AND                                      D 91/10
010570*****      OKJF-04    NOT =     6                                 D 91/10
010580*****                               GO  TO  OKJF-010.             D 91/10
010590*****IF  OKJF-04   NOT =  6         GO  TO  OKJF-010.             D.980317
010600     IF  W-SKB         =  1                                       I.980317
010610         IF  OKJF-04   NOT =  6     GO  TO  OKJF-010.             I.980317
010620     IF  W-SKB         =  2                                       I.980317
010630         IF  OKJF-04   NOT =  7     GO  TO  OKJF-010.             I.980317
010640     IF  W-SKB         =  3                                       I.051214
010650         IF  OKJF-04   NOT =  4     GO  TO  OKJF-010.             I.051214
010660     IF  OKJF-08   NOT =  0         GO  TO  OKJF-010.             I.900411
010670     IF  OKJF-07       =  ZERO      GO  TO  OKJF-010.             I.900411
010680     IF  OKJF-10   NOT =  1         GO  TO  OKJF-010.             I.940324
010690     IF  OKJF-03   NOT =  HIZ1-W    GO  TO  OKJF-010.             I.930622
010700*****IF  (OKJF-04  NOT =  2  AND  3)  OR  (OKJF-07  =  ZERO)  OR  D.900411
010710*********(OKJF-08      =  1)  OR  (OKJF-02  =  9)                 D.900411
010720************************************GO TO  OKJF-010.              D.900411
010730*****IF  JS-SIGN      =  0                                        I.911120
010740*****    IF  OKJF-09     NOT =  0            GO  TO  OKJF-010.    I.911120
010750*****IF  JS-SIGN      =  1                                        I.911120
010760*****    IF  OKJF-09     NOT =  1            GO  TO  OKJF-010.    I.911120
010770*****IF  JS-SIGN      =  9                                        A 920317
010780*****    IF  OKJF-09     NOT =  0  AND  1    GO  TO  OKJF-010.    A 920317
010790     PERFORM  WOKJ-RTN  THRU  WOKJ-RTN-EXIT.
010800     GO TO  OKJF-010.
010810 OKJF-020.
010820     IF  STS-W       =  1           GO TO  OKJF-RTN-EXIT.
010830*
010840*****IF JS-SK = 1                                                 D.090929
010850     IF JS-SK = 1 OR 3                                            I.090929
010860        MOVE  OKJ-TMP   TO  JOLSF13-REC
010870        GO TO  OKJF-W1                                            *A050901
010880     ELSE                                                         *A050901
010890        MOVE  OKJ-TMP   TO  JOLSF213-REC                          *A050901
010900        GO TO  OKJF-W2.                                           *A050901
010910 OKJF-W1.                                                         *A050901
010920*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
010930     WRITE  JOLSF13-REC.
010940     IF  ERR-STAT    =  "34"
010950                                    MOVE  KBN-DF(3)  TO  KEY-01
010960                                    MOVE  OKJ-021(1) TO  KEY-02
010970                                    MOVE  04         TO  ERR-CD
010980                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
010990                                    STOP  RUN.
011000     GO TO  OKJF-RTN-EXIT.                                        *A050901
011010 OKJF-W2.                                                         *A050901
011020*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
011030     WRITE  JOLSF213-REC  INVALID                                 *A050901
011040            MOVE  KBN-DF(3)  TO  KEY-01                           *A050901
011050            MOVE  OKJ-021(1) TO  KEY-02                           *A050901
011060            MOVE  04         TO  ERR-CD                           *A050901
011070            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
011080            STOP  RUN.                                            *A050901
011090 OKJF-RTN-EXIT.
011100     EXIT.
011110*================================================================*
011120*    ÉèÅ[ÉNÉ}Éìì`ï[èàóù           (TDNW-RTN)
011130*================================================================*
011140 TDNW-RTN.                                                        I.040922
011150     MOVE  ZERO      TO  CNT-W(4).                                I.040922
011160     MOVE  KBN-DF(4) TO  TDNW-01.                                 I.040922
011170 TDNW-010.                                                        I.040922
011180     READ  TDNWF UNLOCK  AT  END    GO TO  TDNW-RTN-EXIT.         I.040922
011190     IF  TDNW1-PC  NOT =  1         GO  TO  TDNW-010.             I.040922
011200     MOVE  TDNW-R1   TO  TDNW-02.                                 I.040922
011210     MOVE  TDNW1-PC  TO  TDNW-022.                                I.040922
011220*****IF JS-SK = 1                                                 D.090929
011230     IF JS-SK = 1 OR 3                                            I.090929
011240        MOVE  TDNW-TMP  TO  JOLSF14-REC                           I.040922
011250        GO  TO  TDNW-W1                                           *A050901
011260     ELSE                                                         *A050901
011270        MOVE  TDNW-TMP  TO  JOLSF214-REC                          *A050901
011280        GO  TO  TDNW-W2.                                          *A050901
011290 TDNW-W1.                                                         *A050901
011300*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
011310     WRITE  JOLSF14-REC.                                          I.040922
011320     IF  ERR-STAT    =  "34"                                      I.040922
011330                                    MOVE  KBN-DF(4)  TO  KEY-01   I.040922
011340                                    MOVE  TDNW-020   TO  KEY-02   I.040922
011350                                    MOVE  04         TO  ERR-CD   I.040922
011360                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT       I.040922
011370                                    STOP  RUN.                    I.040922
011380     GO  TO  TDNW-100.                                            *A050901
011390 TDNW-W2.                                                         *A050901
011400*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
011410     WRITE  JOLSF214-REC  INVALID                                 *A050901
011420            MOVE  KBN-DF(4)  TO  KEY-01                           *A050901
011430            MOVE  TDNW-020   TO  KEY-02                           *A050901
011440            MOVE  04         TO  ERR-CD                           *A050901
011450            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
011460            STOP  RUN.                                            *A050901
011470 TDNW-100.                                                        *A050901
011480     IF  CNT-W(4)    =  ZERO        MOVE TDNW-020 TO FST-WK(4).   I.040922
011490     MOVE  TDNW-020  TO  LST-WK(4).                               I.040922
011500     ADD   1         TO  CNT-W(4).                                I.040922
011510     GO TO  TDNW-010.                                             I.040922
011520 TDNW-RTN-EXIT.                                                   I.040922
011530     EXIT.                                                        I.040922
011540*================================================================*
011550*    ÉiÉtÉRì`ï[èàóù               (TDNN-RTN)
011560*================================================================*
011570 TDNN-RTN.                                                        I.040922
011580     MOVE  ZERO      TO  CNT-W(5).                                I.040922
011590     MOVE  KBN-DF(5) TO  TDNN-01.                                 I.040922
011600 TDNN-010.                                                        I.040922
011610     READ  TDNNF UNLOCK  AT  END    GO TO  TDNN-RTN-EXIT.         I.040922
011620     IF  TDNN1-PC  NOT =  1         GO  TO  TDNN-010.             I.040922
011630     MOVE  TDNN-R1   TO  TDNN-02.                                 I.040922
011640     MOVE  TDNN1-PC  TO  TDNN-022.                                I.040922
011650*****IF JS-SK = 1                                                 D.090929
011660     IF JS-SK = 1 OR 3                                            I.090929
011670        MOVE  TDNN-TMP  TO  JOLSF15-REC                           I.040922
011680        GO TO  TDNN-W1                                            *A050901
011690     ELSE                                                         *A050901
011700        MOVE  TDNN-TMP  TO  JOLSF215-REC                          *A050901
011710        GO TO  TDNN-W2.                                           *A050901
011720 TDNN-W1.                                                         *A050901
011730*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
011740     WRITE  JOLSF15-REC.                                          I.040922
011750     IF  ERR-STAT    =  "34"                                      I.040922
011760                                    MOVE  KBN-DF(5)  TO  KEY-01   I.040922
011770                                    MOVE  TDNN-020   TO  KEY-02   I.040922
011780                                    MOVE  04         TO  ERR-CD   I.040922
011790                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT       I.040922
011800                                    STOP  RUN.                    I.040922
011810     GO TO  TDNN-100.                                             *A050901
011820 TDNN-W2.                                                         *A050901
011830*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
011840     WRITE  JOLSF215-REC  INVALID                                 *A050901
011850            MOVE  KBN-DF(5)  TO  KEY-01                           *A050901
011860            MOVE  TDNN-020   TO  KEY-02                           *A050901
011870            MOVE  04         TO  ERR-CD                           *A050901
011880            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
011890            STOP  RUN.                                            *A050901
011900 TDNN-100.                                                        *A050901
011910     IF  CNT-W(5)    =  ZERO        MOVE TDNN-020 TO FST-WK(5).   I.040922
011920     MOVE  TDNN-020  TO  LST-WK(5).                               I.040922
011930     ADD   1         TO  CNT-W(5).                                I.040922
011940     GO TO  TDNN-010.                                             I.040922
011950 TDNN-RTN-EXIT.                                                   I.040922
011960     EXIT.                                                        I.040922
011970*================================================================*
011980*    ÉgÉâÉXÉRëºì`ï[èàóù         (TDI-RTN)
011990*================================================================*
012000 TDI-RTN.                                                         I.080325
012010     MOVE  ZERO      TO  CNT-W(6).                                I.080325
012020     MOVE  KBN-DF(6) TO  TDI-01.                                  I.080325
012030 TDI-010.                                                         I.080325
012040     READ  TDIF  UNLOCK  AT  END    GO  TO  TDI-RTN-EXIT.         I.080325
012050     IF  TDI-UPC   NOT =  1         GO  TO  TDI-010.              I.080325
012060     IF  TDI-PRC       =  9         GO  TO  TDI-010.              I.091217
012070     IF  TDI-TCD       =  6010      GO  TO  TDI-010.              I.120217
012080     IF  W-SKB         =  1                                       I.080325
012090         IF  TDI-SOK   NOT =  6     GO  TO  TDI-010.              I.080325
012100     IF  W-SKB         =  2                                       I.080325
012110         IF  TDI-SOK   NOT =  7     GO  TO  TDI-010.              I.080325
012120     IF  W-SKB         =  3                                       I.080325
012130         IF  TDI-SOK   NOT =  4     GO  TO  TDI-010.              I.080325
012140     IF  TDI-DATE  NOT =  HIZ1-W    GO  TO  TDI-010.              I.080325
012150     MOVE  TDI-R     TO  TDI-02.                                  I.080325
012160     MOVE  TDI-PRC   TO  TDI-021.                                 I.100922
012170     MOVE  TDI-UPC   TO  TDI-022.                                 I.100922
012180*****IF JS-SK = 1                                                 D.090929
012190     IF JS-SK = 1 OR 3                                            I.090929
012200        MOVE  TDI-TMP   TO  JOLSF16-REC                           I.080325
012210        GO TO  TDI-W1.                                            I.080401
012220*****   GO TO  TDI-W1                                             D.080401
012230*****ELSE                                                         D.080401
012240*****   MOVE  TDI-TMP   TO  JOLSF216-REC                          D.080401
012250     MOVE SPACE         TO JOLSF216-REC.                          I.080401
012260     INITIALIZE            JOLSF216-REC.                          I.080401
012270     MOVE KBN-DF(6)     TO JOLSF216-01.                           I.080401
012280     MOVE TDI-KEY       TO JOLSF216-KEY.                          I.080401
012290     MOVE TDI-DATE      TO JOLSF216-DATE.                         I.080401
012300     MOVE TDI-TCD       TO JOLSF216-TCD.                          I.080401
012310     MOVE TDI-CCD       TO JOLSF216-CCD.                          I.080401
012320     MOVE TDI-TPC       TO JOLSF216-TPC.                          I.080401
012330     MOVE TDI-HCD       TO JOLSF216-HCD.                          I.080401
012340     MOVE TDI-SIZ       TO JOLSF216-SIZ.                          I.080401
012350     MOVE TDI-SKB       TO JOLSF216-SKB.                          I.080401
012360     MOVE TDI-SNO       TO JOLSF216-SNO.                          I.080401
012370     MOVE TDI-SU        TO JOLSF216-SU.                           I.080401
012380     IF  TDI-SU        <  0                                       I.080401
012390         MOVE 1             TO JOLSF216-SUS.                      I.080401
012400     MOVE TDI-GT        TO JOLSF216-GT.                           I.080401
012410     MOVE TDI-UT        TO JOLSF216-UT.                           I.080401
012420     MOVE TDI-GKIN      TO JOLSF216-GKIN.                         I.080401
012430     IF  TDI-GKIN      <  0                                       I.080401
012440         MOVE 1             TO JOLSF216-GKINS.                    I.080401
012450     MOVE TDI-UKIN      TO JOLSF216-UKIN.                         I.080401
012460     IF  TDI-UKIN      <  0                                       I.080401
012470         MOVE 1             TO JOLSF216-UKINS.                    I.080401
012480     MOVE TDI-JNOD      TO JOLSF216-JNOD.                         I.080401
012490     MOVE TDI-SOK       TO JOLSF216-SOK.                          I.080401
012500     MOVE TDI-UNS       TO JOLSF216-UNS.                          I.080401
012510     MOVE TDI-ISU       TO JOLSF216-ISU.                          I.080401
012520     MOVE TDI-HNO       TO JOLSF216-HNO.                          I.080401
012530     MOVE TDI-TEKI      TO JOLSF216-TEKI.                         I.080401
012540     MOVE TDI-TRN       TO JOLSF216-TRN.                          I.080401
012550     MOVE TDI-PRC       TO JOLSF216-PRC.                          I.080401
012560     MOVE TDI-UPC       TO JOLSF216-UPC.                          I.080401
012570     GO TO  TDI-W2.                                               I.080325
012580 TDI-W1.                                                          I.080325
012590*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
012600     WRITE  JOLSF16-REC.                                          I.080325
012610     IF  ERR-STAT    =  "34"                                      I.080325
012620                                    MOVE  KBN-DF(6)  TO  KEY-01   I.080325
012630                                    MOVE  TDI-02A    TO  KEY-02   I.080325
012640                                    MOVE  04         TO  ERR-CD   I.080325
012650                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT       I.080325
012660                                    STOP  RUN.                    I.080325
012670     GO TO  TDI-100.                                              I.080325
012680 TDI-W2.                                                          I.080325
012690*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*
012700     WRITE  JOLSF216-REC  INVALID                                 I.080325
012710            MOVE  KBN-DF(6)  TO  KEY-01                           I.080325
012720            MOVE  TDI-02A    TO  KEY-02                           I.080325
012730            MOVE  04         TO  ERR-CD                           I.080325
012740            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                I.080325
012750            STOP  RUN.                                            I.080325
012760 TDI-100.                                                         I.080325
012770     IF  CNT-W(6)    =  ZERO        MOVE TDI-02A  TO FST-WK(6).   I.080325
012780     MOVE  TDI-02A   TO  LST-WK(6).                               I.080325
012790     ADD   1         TO  CNT-W(6).                                I.080325
012800     GO TO  TDI-010.                                              I.080325
012810 TDI-RTN-EXIT.                                                    I.080325
012820     EXIT.                                                        I.080325
012830*================================================================*
012840*    ê‘ÇøÇ·ÇÒñ{ï‹ì`ï[èàóù       (TDNA-RTN)
012850*================================================================*
012860 TDNA-RTN.                                                        I.091221
012870     MOVE  ZERO      TO  CNT-W(6).                                I.091221
012880     MOVE  KBN-DF(7) TO  TDNA-01.                                 I.091221
012890 TDNA-010.                                                        I.091221
012900     READ  TDNAF UNLOCK  AT  END    GO  TO  TDNA-RTN-EXIT.        I.091221
012910     IF  TDNA-RC       =  1         GO  TO  TDNA-010.             I.091221
012920     IF  TDNA-PC       =  9         GO  TO  TDNA-010.             I.091221
012930     IF  TDNA-DNGPS NOT =  HIZ1-W    GO  TO  TDNA-010.            I.091221
012940     MOVE  TDNA-R    TO  TDNA-02.                                 I.091221
012950     MOVE  SPACE     TO  TDNA-022.                                I.091221
012960     MOVE  TDNA-DNGP TO  TDNA-023.                                I.091221
012970     MOVE  TDNA-NRC  TO  TDNA-024.                                I.091221
012980     MOVE  SPACE     TO  TDNA-025.                                I.091221
012990     MOVE  TDNA-PC   TO  TDNA-026.                                I.091221
013000     MOVE  TDNA-RC   TO  TDNA-027.                                I.091221
013010     IF JS-SK = 1 OR 3                                            I.091221
013020        MOVE  TDNA-TMP  TO  JOLSF17-REC                           I.091221
013030        GO TO  TDNA-W1.                                           I.091221
013040     MOVE SPACE         TO JOLSF217-REC.                          I.091221
013050     INITIALIZE            JOLSF217-REC.                          I.091221
013060     MOVE KBN-DF(7)     TO JOLSF217-01.                           I.091221
013070     MOVE TDNA-KEY      TO JOLSF217-KEY.                          I.091221
013080     MOVE TDNA-JAN      TO JOLSF217-JAN.                          I.091221
013090     MOVE TDNA-SU       TO JOLSF217-SU.                           I.091221
013100     IF  TDNA-SU       <  0                                       I.091221
013110         MOVE 1             TO JOLSF217-SUS.                      I.091221
013120     MOVE TDNA-GTN      TO JOLSF217-GTN.                          I.091221
013130     MOVE TDNA-UTN      TO JOLSF217-UTN.                          I.091221
013140     MOVE TDNA-GKIN     TO JOLSF217-GKIN.                         I.091221
013150     IF  TDNA-GKIN     <  0                                       I.091221
013160         MOVE 1             TO JOLSF217-GKINS.                    I.091221
013170     MOVE TDNA-UKIN     TO JOLSF217-UKIN.                         I.091221
013180     IF  TDNA-UKIN     <  0                                       I.091221
013190         MOVE 1             TO JOLSF217-UKINS.                    I.091221
013200     MOVE TDNA-DPM      TO JOLSF217-DPM.                          I.091221
013210     MOVE TDNA-CLS      TO JOLSF217-CLS.                          I.091221
013220     MOVE TDNA-SHM      TO JOLSF217-SHM.                          I.091221
013230     MOVE TDNA-MKH      TO JOLSF217-MKH.                          I.091221
013240     MOVE TDNA-MSB      TO JOLSF217-MSB.                          I.091221
013250     MOVE TDNA-TY       TO JOLSF217-TY.                           I.091221
013260     MOVE TDNA-HCD      TO JOLSF217-HCD.                          I.091221
013270     MOVE TDNA-COR      TO JOLSF217-COR.                          I.091221
013280     MOVE TDNA-SIZ      TO JOLSF217-SIZ.                          I.091221
013290     MOVE TDNA-NSU      TO JOLSF217-NSU.                          I.091221
013300     MOVE TDNA-TSC      TO JOLSF217-TSC.                          I.091221
013310     MOVE TDNA-CCD      TO JOLSF217-CCD.                          I.091221
013320     MOVE TDNA-TNA      TO JOLSF217-TNA.                          I.091221
013330     MOVE TDNA-HNO      TO JOLSF217-HNO.                          I.091221
013340     MOVE TDNA-HNGP     TO JOLSF217-HNGP.                         I.091221
013350     MOVE TDNA-NNGP     TO JOLSF217-NNGP.                         I.091221
013360     MOVE TDNA-THC      TO JOLSF217-THC.                          I.091221
013370     MOVE TDNA-BI       TO JOLSF217-BI.                           I.091221
013380     MOVE TDNA-SNGP     TO JOLSF217-SNGP.                         I.091221
013390     MOVE TDNA-HNA      TO JOLSF217-HNA.                          I.091221
013400     MOVE TDNA-ZON      TO JOLSF217-ZON.                          I.091221
013410     MOVE TDNA-DC       TO JOLSF217-DC.                           I.091221
013420     MOVE TDNA-DNGP     TO JOLSF217-DNGP.                         I.091221
013430     MOVE TDNA-NRC      TO JOLSF217-NRC.                          I.091221
013440     MOVE TDNA-PC       TO JOLSF217-PC.                           I.091221
013450     MOVE TDNA-RC       TO JOLSF217-RC.                           I.091221
013460     GO TO  TDNA-W2.                                              I.091221
013470 TDNA-W1.                                                         I.091221
013480*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
013490     WRITE  JOLSF17-REC.                                          I.091221
013500     IF  ERR-STAT    =  "34"                                      I.091221
013510                                    MOVE  KBN-DF(7)  TO  KEY-01   I.091221
013520                                    MOVE  TDNA-020   TO  KEY-02   I.091221
013530                                    MOVE  04         TO  ERR-CD   I.091221
013540                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT       I.091221
013550                                    STOP  RUN.                    I.091221
013560     GO TO  TDNA-100.                                             I.091221
013570 TDNA-W2.                                                         I.091221
013580*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*
013590     WRITE  JOLSF217-REC  INVALID                                 I.091221
013600            MOVE  KBN-DF(7)  TO  KEY-01                           I.091221
013610            MOVE  TDNA-020   TO  KEY-02                           I.091221
013620            MOVE  04         TO  ERR-CD                           I.091221
013630            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                I.091221
013640            STOP  RUN.                                            I.091221
013650 TDNA-100.                                                        I.091221
013660     IF  CNT-W(7)    =  ZERO        MOVE TDNA-020  TO FST-WK(7).  I.091221
013670     MOVE  TDNA-020  TO  LST-WK(7).                               I.091221
013680     ADD   1         TO  CNT-W(7).                                I.091221
013690     GO TO  TDNA-010.                                             I.091221
013700 TDNA-RTN-EXIT.                                                   I.091221
013710     EXIT.                                                        I.091221
013720*================================================================*
013730*    ÇnÅ^ÇkèÛãµÇeèàóù               (JOJF-RTN)                   *
013740*================================================================*
013750 JOJF-RTN.
013760*****IF  KEN-WORK    =  ZERO        GO TO  JOJF-RTN-EXIT.         D.980313
013770     IF  KEN-WORK    =  ZERO                                      I.980313
013780*****                               MOVE  255 TO  COMPLETION-CODE D.060324
013790                                    MOVE  200 TO  COMPLETION-CODE I.060324
013800                                    DISPLAY  DSP-MSG2 DISP-BUZ-B  I.980313
013810                                    MOVE  0         TO  JOJF-061  I.070226
013820                                    GO TO  JOJF-090.              I.070226
013830*****                               GO TO  JOJF-RTN-EXIT.         D.070226
013840     MOVE  0001      TO  JOJF-01.
013850*----/ÇnÅ^ÇkèÛãµÇeÅ@ÇqÇdÇ`Çc/----*
013860     READ  JOJF  INVALID  KEY       MOVE  03  TO  ERR-CD
013870                 PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
013880                                    STOP  RUN.
013890     ACCEPT  HIZ2-W  FROM  DATE.
013900     ACCEPT  TIM2-W  FROM  TIME.
013910     MOVE  MM2-W     TO  JOJF-021.
013920     MOVE  DD2-W     TO  JOJF-022.
013930     MOVE  JI1-W     TO  JOJF-031.
013940     MOVE  FU1-W     TO  JOJF-032.
013950     MOVE  JI2-W     TO  JOJF-041.
013960     MOVE  FU2-W     TO  JOJF-042.
013970     IF  JS-SK       =  3                                         I.090930
013980         MOVE  3         TO  JOJF-05                              I.090930
013990     ELSE                                                         I.090930
014000         MOVE  1         TO  JOJF-05.
014010*****MOVE  ZERO      TO  JOJF-061  JOJF-063.                      D.890901
014020     MOVE  ZERO      TO  JOJF-063.                                I.890901
014030     MOVE  SPACE     TO  JOJF-062.
014040     MOVE  W-SKB     TO  JOJF-07.                                 R.900411
014050     MOVE  1         TO  NN  NA.
014060 JOJF-010.
014070     IF  CNT-W(NN)   =  ZERO        GO TO  JOJF-020.
014080     MOVE  KBN-DF(NN)  TO  JOJF-08(NA).
014090     MOVE  CNT-W(NN)   TO  JOJF-09(NA).
014100     MOVE  ZERO        TO  JOJF-10(NA).
014110     MOVE  FST-WK(NN)  TO  JOJF-11(NA).
014120     MOVE  LST-WK(NN)  TO  JOJF-12(NA).
014130     ADD   1         TO  NA.
014140 JOJF-020.
014150     ADD   1         TO  NN.
014160     IF  NN      NOT >  7           GO TO  JOJF-010.              I.091221
014170*****IF  NN      NOT >  6           GO TO  JOJF-010.              D.091221
014180*****IF  NN      NOT >  5           GO TO  JOJF-010.              D.080325
014190*****IF  NN      NOT >  4           GO TO  JOJF-010.              D.050119
014200*****IF  NN      NOT >  3           GO TO  JOJF-010.              D.040922
014210 JOJF-090.
014220*----/ÇnÅ^ÇkèÛãµÇeÅ@ÇqÇdÇvÇqÇhÇsÇd/----*
014230     REWRITE  JOJF-REC  INVALID  KEY
014240                                    MOVE  01  TO  ERR-CD
014250                  PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
014260                                    STOP  RUN.
014270 JOJF-RTN-EXIT.
014280     EXIT.
014290*================================================================*
014300*    â◊éDÉgÉâÉìÇvÇqÇhÇsÇdèàóù       (WNIF-RTN)                   *
014310*================================================================*
014320 WNIF-RTN.
014330     IF  CNT-W(2)    =  ZERO        MOVE  JNIF1-01  TO  FST-W1(2)
014340                                    MOVE  JNIF1-02  TO  FST-W2(2).
014350     MOVE  JNIF1-R   TO  NIF-02(STS-W).
014360     ADD    1        TO  STS-W.
014370     MOVE  KBN-DF(2) TO  NIF-01.
014380     IF  STS-W   NOT >  2           GO TO  WNIF-010.
014390*
014400     MOVE  NIF-TMP   TO  JOLSF12-REC.
014410*
014420*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
014430     WRITE  JOLSF12-REC.
014440     IF  ERR-STAT    =  "34"
014450                                    MOVE  KBN-DF(2)  TO  KEY-01
014460                                    MOVE  NIF-021(1) TO  KEY-02
014470                                    MOVE  04  TO  ERR-CD
014480                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
014490                                    STOP  RUN.
014500*
014510     MOVE  1         TO  STS-W.
014520     MOVE  SPACE     TO  NIF-TMP.
014530 WNIF-010.
014540     ADD   1         TO  CNT-W(2).
014550     MOVE  JNIF1-01  TO  LST-W1(2).
014560     MOVE  JNIF1-02  TO  LST-W2(2).
014570 WNIF-RTN-EXIT.
014580     EXIT.
014590*================================================================*
014600*    ëóÇËèÛÇeÇvÇqÇhÇsÇdèàóù         (WOKJ-RTN)                   *
014610*================================================================*
014620 WOKJ-RTN.
014630     IF  CNT-W(3)    =  ZERO        MOVE  OKJF-01  TO  FST-W1(3).
014640     MOVE  OKJF-R    TO  OKJ-02(STS-W).
014650     ADD   1         TO  STS-W.
014660     MOVE  KBN-DF(3) TO  OKJ-01.
014670     IF  STS-W   NOT >  4           GO TO  WOKJ-010.
014680*****IF JS-SK = 1                                                 D.090929
014690     IF JS-SK = 1 OR 3                                            I.090929
014700        MOVE  OKJ-TMP   TO  JOLSF13-REC
014710        GO TO  WOKJ-W1                                            *A050901
014720     ELSE                                                         *A050901
014730        MOVE  OKJ-TMP   TO  JOLSF213-REC                          *A050901
014740        GO TO  WOKJ-W2.                                           *A050901
014750 WOKJ-W1.                                                         *A050901
014760*----/ÇnÅ^ÇkëóêMÇeÅ@ÇvÇqÇhÇsÇd/----*
014770     WRITE  JOLSF13-REC.
014780     IF  ERR-STAT    =  "34"
014790                                    MOVE  KBN-DF(3)  TO  KEY-01
014800                                    MOVE  OKJ-021(1) TO  KEY-02
014810                                    MOVE  04  TO  ERR-CD
014820                     PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT
014830                                    STOP  RUN.
014840     GO TO  WOKJ-005.                                             *A050901
014850 WOKJ-W2.                                                         *A050901
014860*----/ÇnÅ^ÇkëóêMÇeÇQÅ@ÇvÇqÇhÇsÇd/----*                            *A050901
014870     WRITE  JOLSF213-REC  INVALID                                 *A050901
014880            MOVE  KBN-DF(3)  TO  KEY-01                           *A050901
014890            MOVE  OKJ-021(1) TO  KEY-02                           *A050901
014900            MOVE  04  TO  ERR-CD                                  *A050901
014910            PERFORM  ESUB-RTN  THRU  ESUB-RTN-EXIT                *A050901
014920            STOP  RUN.                                            *A050901
014930 WOKJ-005.                                                        *A050901
014940     MOVE  1         TO  STS-W.
014950     MOVE  SPACE     TO  OKJ-TMP.
014960 WOKJ-010.
014970     ADD   1         TO  CNT-W(3).
014980     MOVE  OKJF-01   TO  LST-W1(3).
014990 WOKJ-RTN-EXIT.
015000     EXIT.
015010*================================================================*
015020*    ÇdÇqÇqÇnÇqèàóù                 (ESUB-RTN)                   *
015030*================================================================*
015040 ESUB-RTN.
015050     MOVE  FIL-DF(ERR-CD)  TO  ERR-F.
015060     MOVE    M-DF(ERR-CD)  TO  ERR-M.
015070     IF  ERR-CD      = 4            MOVE  KEY-WORK  TO  ERR-K
015080     ELSE
015090                                    MOVE  "0001"    TO  ERR-K.
015100     PERFORM  ERR-RTN  THRU  ERR-EX.
015110     MOVE  255     TO  COMPLETION-CODE.
015120     IF  ERR-SW    =  1             CLOSE  JOJF
015130                                    GO TO  ESUB-RTN-EXIT.
015140*****IF JS-SK = 1                                                 D.090929
015150     IF JS-SK = 1 OR 3                                            I.090929
015160        CLOSE  JOLSF
015170        OPEN  OUTPUT  JOLSF
015180     ELSE                                                         *A050901
015190        CLOSE  JOLSF2                                             *A050901
015200        OPEN  OUTPUT  JOLSF2.                                     *A050901
015210     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
015220
015230 ESUB-RTN-EXIT.
015240     EXIT.
015250*================================================================*
015260*    ÇbÇkÇnÇrÇdèàóù                                              *
015270*================================================================*
015280 CLSE-RTN.
015290     CLOSE   JSTR  JNIF  OKJF
015300             JOJF         JCON.                                   R.900411
015310*****IF JS-SK = 1                                                 D.090929
015320     IF JS-SK = 1 OR 3                                            I.090929
015330        CLOSE   JOLSF
015340     ELSE                                                         *A050901
015350        CLOSE   JOLSF2.                                           *A050901
015360*****IF  JS-SIGN     =  1                                         D.051130
015370*****IF  JS-SK       =  2                                         D.090929
015380*****IF  JS-SIGN     =  0                                         D.100105
015390     IF (JS-SK       =  3)  AND  (W-SKB       =  3)               I.100105
015400             CLOSE  TDNAF.                                        I.091221
015410*****IF  JS-SIGN     =  1                                         D.100105
015420     IF  W-SKB       =  1                                         I.100105
015430             CLOSE  TDNWF  TDNNF  TDIF.                           I.080325
015440*****        CLOSE  TDNWF  TDNNF.                                 D.080325
015450*****    CLOSE  TDNWF.                                            D.050119
015460 CLSE-RTN-EXIT.
015470     EXIT.
015480*================================================================*
015490*    èIóπèàóù                                                    *
015500*================================================================*
015510 ENDR-RTN.
015520*****NOTHING.
015530 ENDR-RTN-EXIT.
015540     EXIT.
015550*================================================================
015560     COPY  LPERR.                                                 R.900411
