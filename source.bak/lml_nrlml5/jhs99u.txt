000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JHS99U.
000030**********************************************
000040*****    ÇiÇ`ÇmÉ}ÉXÉ^Å@ÇdÇòÇÉÇÖÇåïœä∑    *****
000050**********************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120*****SELECT CODEF ASSIGN TO CODE-MSD                              D.100716
000130     SELECT CODEF ASSIGN TO CODE-MSD CODE2-MSD                    I.100716
000140         ORGANIZATION INDEXED
000150         ACCESS MODE DYNAMIC
000160         RECORD KEY CODE-KEY
000170         ALTERNATE RECORD KEY CODE-KEY2                           I.100716
000180         FILE STATUS IS ERR-STAT.
000190     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000200         ORGANIZATION INDEXED
000210         ACCESS MODE DYNAMIC
000220         RECORD KEY HI-KEY
000230         ALTERNATE RECORD KEY HI-KEY2
000240         FILE STATUS IS ERR-STAT.
000250     SELECT JANF ASSIGN TO JANF-MSD
000260         ORGANIZATION INDEXED
000270         ACCESS MODE DYNAMIC
000280         RECORD KEY JAN-KEY
000290         FILE STATUS IS ERR-STAT.
000300 I-O-CONTROL.
000310     APPLY SHARED-MODE ON CODEF
000320     APPLY SHARED-MODE ON HI-M.
000330 DATA DIVISION.
000340 FILE SECTION.
000350     COPY LICODE.
000360     COPY LIHIM.
000370 FD  JANF                                                         105/2
000380     BLOCK  2 RECORDS
000390     LABEL RECORD IS STANDARD
000400     VALUE OF IDENTIFICATION "JANF".
000410 01  JAN-R.
000420     02  JAN-KEY.
000430       03  JAN-ITF      PIC  X(016).
000440       03  JAN-ITFD  REDEFINES  JAN-ITF.
000450         04  JAN-ITF1   PIC  X(013).
000460         04  JAN-ITF2   PIC  X(003).
000470     02  JAN-KBN        PIC  X(001).
000480     02  JAN-JAN        PIC  X(013).
000490     02  JAN-HCD        PIC  X(006).
000500     02  JAN-NAME       PIC  N(024).
000510     02  JAN-SIZ        PIC  X(004).
000520     02  JAN-ISU        PIC  X(003).
000530     02  JAN-DATE       PIC  X(008).
000540     02  JAN-TIME       PIC  X(006).
000550 WORKING-STORAGE SECTION.
000560 77  ERR-STAT           PIC  X(002).
000570 77  W-FILE             PIC  X(013).
000580 01  W-DATA.
000590     02  W-DATE.
000600       03  W-NEN1       PIC  9(002).
000610       03  W-NGPS       PIC  9(006).
000620     02  W-TIME.
000630       03  W-TIME1      PIC  9(006).
000640       03  W-TIME2      PIC  9(002).
000650     02  W-S            PIC  9(001).
000660 01  W-SET.
000670     02  W-ADSM.
000680       03  F            PIC  X(040) VALUE
000690            "        SS  S   M   L   LL  XL  XXL    ".
000700       03  F            PIC  X(040) VALUE
000710            "                            28.029.030.0".
000720       03  F            PIC  X(040) VALUE
000730            "12.513.013.514.015.016.017.018.019.020.0".
000740       03  F            PIC  X(040) VALUE
000750            "21.021.522.022.523.023.524.024.525.0    ".
000760       03  F            PIC  X(040) VALUE
000770            "24.024.525.025.526.026.527.027.5        ".
000780     02  W-ADSD.
000790       03  W-ADS   OCCURS   5.
000800         04  W-DSD   OCCURS  10.
000810           05  W-DS     PIC  X(004).
000820     COPY LSTAT.
000830 SCREEN SECTION.
000840 SD  C-CRT
000850     END STATUS IS ESTAT.
000860 01  C-CLEAR.
000870     02  LINE   1  CLEAR SCREEN.
000880 01  C-MID.
000890     02  LINE   3  COLUMN  15  PIC  N(022) VALUE
000900         NC"ÅñÅñÅñÅ@Å@ÇiÇ`ÇmÉ}ÉXÉ^Å@ÇbÇrÇuïœä∑Å@Å@ÅñÅñÅñ".
000910 01  C-ERR.
000920     02  LINE  24.
000930       03  E-ME2   COLUMN  15  PIC  X(022) VALUE
000940            "***  ¿›º≠∏À›“≤ ≈º  ***".
000950       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
000960            "***  À›“≤ ≈º  ***".
000970       03  E-ME5   COLUMN  15  PIC  X(017) VALUE
000980            "***  ª≤Ωﬁ ≈º  ***".
000990       03  E-ME9   COLUMN  15  PIC  X(019) VALUE
001000            "***  WRITE ¥◊∞  ***".
001010       03  E-JAN   COLUMN  40  PIC  X(013) FROM  CODE-JAN.
001020       03  E-HCD   COLUMN  56  PIC  9(006) FROM  CODE-HCD.
001030     COPY LSSEM.
001040 PROCEDURE DIVISION.
001050 M-05.
001060     DISPLAY C-CLEAR.
001070     DISPLAY C-MID.
001080     MOVE ZERO TO W-DATA.
001090     ACCEPT W-NGPS FROM DATE.
001100     ACCEPT W-TIME FROM TIME.
001110     MOVE 20 TO W-NEN1.
001120     MOVE W-ADSM TO W-ADSD.
001130     OPEN INPUT CODEF.
001140     OPEN INPUT HI-M.
001150     OPEN OUTPUT JANF.
001160     CLOSE JANF.
001170     OPEN I-O JANF.
001180 M-10.
001190     READ CODEF NEXT RECORD WITH UNLOCK AT END
001200         GO TO M-90.
001210     IF CODE-TCD NOT = ZERO
001220         GO TO M-10.
001230     IF CODE-HCD = 999999                                         I.101004
001240         GO TO M-10.                                              I.101004
001250     MOVE CODE-HCD TO HI-KEY.
001260     READ HI-M WITH UNLOCK INVALID KEY
001270         DISPLAY E-ME4 E-JAN E-HCD
001280         DISPLAY E-CL
001290         GO TO M-10.
001300     IF CODE-ISU = ZERO
001310         GO TO M-20.
001320     MOVE CODE-ITF TO JAN-ITF.
001330     READ JANF INVALID KEY
001340         GO TO M-15.
001350     GO TO M-20.
001360 M-15.
001370     INITIALIZE JAN-R.
001380     MOVE SPACE TO JAN-ITF JAN-JAN JAN-NAME JAN-SIZ.
001390     MOVE ZERO TO JAN-KBN JAN-HCD JAN-ISU.
001400     MOVE CODE-ITF TO JAN-ITF.
001410     MOVE 1 TO JAN-KBN.
001420     MOVE CODE-JAN TO JAN-JAN.
001430     MOVE CODE-HCD TO JAN-HCD.
001440     IF HI-SMS NOT = SPACE
001450         MOVE HI-SMS TO JAN-NAME
001460       ELSE
001470         MOVE HI-NAME TO JAN-NAME.
001480     MOVE CODE-SIZ TO W-S.
001490     IF HI-SSC = 0
001500         ADD 1 TO W-S.
001510     IF W-DS(W-S,CODE-SNO) = SPACE
001520         DISPLAY E-ME5 E-JAN E-HCD E-ME99
001530         DISPLAY E-CL
001540         GO TO M-10.
001550     MOVE W-DS(W-S,CODE-SNO) TO JAN-SIZ.
001560     MOVE HI-ISU TO JAN-ISU.
001570     MOVE W-DATE TO JAN-DATE.
001580     MOVE W-TIME1 TO JAN-TIME.
001590     WRITE JAN-R INVALID KEY
001600         DISPLAY E-ME9 E-JAN E-HCD E-ME99
001610         GO TO M-90.
001620 M-20.
001630     MOVE CODE-JAN TO JAN-ITF1.
001640     MOVE SPACE TO JAN-ITF2.
001650     READ JANF INVALID KEY
001660         GO TO M-25.
001670     GO TO M-10.
001680 M-25.
001690     INITIALIZE JAN-R.
001700     MOVE SPACE TO JAN-ITF JAN-JAN JAN-NAME JAN-SIZ.
001710     MOVE ZERO TO JAN-KBN JAN-HCD JAN-ISU.
001720     MOVE CODE-JAN TO JAN-ITF1.
001730     MOVE SPACE TO JAN-ITF2.
001740     MOVE 0 TO JAN-KBN.
001750     MOVE CODE-JAN TO JAN-JAN.
001760     MOVE CODE-HCD TO JAN-HCD.
001770     IF HI-SMS NOT = SPACE
001780         MOVE HI-SMS TO JAN-NAME
001790       ELSE
001800         MOVE HI-NAME TO JAN-NAME
001810         DISPLAY E-ME2 E-JAN E-HCD E-ME99
001820         DISPLAY E-CL.
001830     MOVE CODE-SIZ TO W-S.
001840     IF HI-SSC = 0
001850         ADD 1 TO W-S.
001860     IF W-DS(W-S,CODE-SNO) = SPACE
001870         DISPLAY E-ME5 E-JAN E-HCD E-ME99
001880         DISPLAY E-CL
001890         GO TO M-10.
001900     MOVE W-DS(W-S,CODE-SNO) TO JAN-SIZ.
001910     MOVE 1 TO JAN-ISU.
001920     MOVE W-DATE TO JAN-DATE.
001930     MOVE W-TIME1 TO JAN-TIME.
001940     WRITE JAN-R INVALID KEY
001950         DISPLAY E-ME9 E-JAN E-HCD E-ME99
001960         GO TO M-90.
001970     GO TO M-10.
001980 M-90.
001990     CLOSE CODEF.
002000     CLOSE HI-M.
002010     CLOSE JANF.
002020 M-95.
002030     DISPLAY C-CLEAR.
002040     STOP RUN.
