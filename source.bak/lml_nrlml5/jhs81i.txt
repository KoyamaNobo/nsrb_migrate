000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JHS81I.
000030*********************************************************
000040*    PROGRAM         :  ƒ[ƒNƒ}ƒ““X–¼ƒtƒ@ƒCƒ‹@ƒƒ“ƒe  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT WTNAF ASSIGN TO WTNA-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE DYNAMIC
000180         RECORD KEY WTNA-KEY
000190         FILE STATUS IS ERR-STAT.
000200 I-O-CONTROL.
000210     APPLY SHARED-MODE ON WTNAF.
000220 DATA DIVISION.
000230 FILE SECTION.
000240 FD  WTNAF
000250     BLOCK  4 RECORDS
000260     LABEL RECORD IS STANDARD
000270     VALUE OF IDENTIFICATION "WTNAF".
000280 01  WTNA-R.
000290     02  WTNA-KEY.
000300       03  WTNA-TNC     PIC  9(004).                              I.100916
000310*****  03  WTNA-TNC     PIC  9(003).                              D.100916
000320     02  WTNA-NAME      PIC  N(026).
000330     02  WTNA-BSC       PIC  9(001).
000340     02  F              PIC  X(007).                              I.100916
000350*****02  F              PIC  X(008).                              D.100916
000360 WORKING-STORAGE  SECTION.
000370 77  ERR-STAT           PIC  X(002).
000380 77  W-FILE             PIC  X(013).
000390 01  W-DATA.
000400     02  W-CRT.
000410       03  W-ACT       PIC  9(001).
000420*****  03  W-TNC       PIC  9(003).                               D.100916
000430       03  W-TNC       PIC  9(004).                               I.100916
000440       03  W-NAME      PIC  N(026).
000450       03  W-BSC       PIC  9(001).
000460       03  W-DMM       PIC  9(001).
000470*
000480     02  W-L            PIC  9(002).
000490     02  W-C1           PIC  9(002).
000500     02  W-C2           PIC  9(002).
000510     02  W-C3           PIC  9(002).
000520     02  W-CHK          PIC  X(001).
000530     02  W-END          PIC  9(001).
000540     COPY LSTAT.
000550 SCREEN SECTION.
000560 SD  C-CRT
000570     END STATUS IS ESTAT.
000580 01  C-CLEAR.
000590     02  C-CL    LINE   1  CLEAR SCREEN.
000600 01  C-MID.
000610     02  LINE   1  COLUMN  30  PIC  N(010) VALUE
000620          NC"ƒ[ƒNƒ}ƒ““X–¼@“ü—Í".
000630     02  LINE   3  COLUMN  19  PIC  X(043) VALUE
000640          "“o˜^=1 C³=2 íœ=3 –â‡‚¹=5 I—¹=9   ØÀ°Ý".
000650 01  C-MID1.
000660     02  LINE   7.
000670*****  03  COLUMN   7  PIC  N(002) VALUE NC"“X”Ô".                D.100916
000680       03  COLUMN   6  PIC  N(002) VALUE NC"“X”Ô".                I.100916
000690       03  COLUMN  17  PIC  N(002) VALUE NC"“X–¼".
000700     02  LINE   9.
000710       03  COLUMN  17  PIC  N(002) VALUE NC"êŠ".
000720       03  COLUMN  25  PIC  X(015) VALUE
000730            "0=ˆÉ¨è,1=—³‰¤".                                    I.130708
000740*****       "0=ˆÉ¨è,1=¬–q".                                    D.130708
000750     02  LINE  23  COLUMN  43  PIC  X(028) VALUE
000760          "Šm”FiOK=1,NO=9j--->   ØÀ°Ý".
000770     02  LINE   7.
000780*****  03  COLUMN   7  UNDER    LINE TO 14.                       D.100916
000790       03  COLUMN   6  UNDER    LINE TO 14.                       I.100916
000800       03  COLUMN  17  UNDER    LINE TO 73.
000810     02  LINE   9  COLUMN  17  UNDER    LINE TO 22.
000820 01  C-MID2.
000830     02  LINE   5.
000840       03  COLUMN   4  PIC  N(001) VALUE NC"‡‚".                  I.100916
000850       03  COLUMN   8  PIC  N(003) VALUE NC"“X@–¼".              I.100916
000860       03  COLUMN  30  PIC  N(001) VALUE NC"‡‚".                  I.100916
000870       03  COLUMN  34  PIC  N(003) VALUE NC"“X@–¼".              I.100916
000880       03  COLUMN  56  PIC  N(001) VALUE NC"‡‚".                  I.100916
000890       03  COLUMN  60  PIC  N(003) VALUE NC"“X@–¼".              I.100916
000900*****  03  COLUMN   5  PIC  N(001) VALUE NC"‡‚".                  D.100916
000910*****  03  COLUMN   8  PIC  N(003) VALUE NC"“X@–¼".              D.100916
000920*****  03  COLUMN  29  PIC  N(001) VALUE NC"‡‚".                  D.100916
000930*****  03  COLUMN  33  PIC  N(003) VALUE NC"“X@–¼".              D.100916
000940*****  03  COLUMN  55  PIC  N(001) VALUE NC"‡‚".                  D.100916
000950*****  03  COLUMN  58  PIC  N(003) VALUE NC"“X@–¼".              D.100916
000960*****  03  COLUMN  35  PIC  N(001) VALUE NC"Œv".                  D.100916
000970     02  LINE  23  COLUMN  41  PIC  X(030) VALUE
000980          "Šm”F (NEXT=1,NO=9) --->   ØÀ°Ý".
000990     02  LINE   5  COLUMN   2  OVER     LINE TO 80                I.100916
001000                               UNDER    LINE TO 80                I.100916
001010                               VERTICAL LINE AT  2  28  54  80.   I.100916
001020     02  LINE   6  COLUMN   2  OVER     LINE TO 80                I.100916
001030                               VERTICAL LINE AT  2  28  54  80.   I.100916
001040     02  LINE   7  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001050     02  LINE   8  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001060     02  LINE   9  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001070     02  LINE  10  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001080     02  LINE  11  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001090     02  LINE  12  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001100     02  LINE  13  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001110     02  LINE  14  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001120     02  LINE  15  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001130     02  LINE  16  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001140     02  LINE  17  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001150     02  LINE  18  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001160     02  LINE  19  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001170     02  LINE  20  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001180     02  LINE  21  COLUMN   2  VERTICAL LINE AT  2  28  54  80.   I.100916
001190     02  LINE  22  COLUMN   2  UNDER    LINE TO 80                I.100916
001200                               VERTICAL LINE AT  2  28  54  80.   I.100916
001210*****02  LINE   5  COLUMN   3  OVER     LINE TO 78                D.100916
001220*****                          UNDER    LINE TO 78                D.100916
001230*****                          VERTICAL LINE AT  3  28  53  78.   D.100916
001240*****02  LINE   6  COLUMN   3  OVER     LINE TO 78                D.100916
001250*****                          VERTICAL LINE AT  3  28  53  78.   D.100916
001260*****02  LINE   7  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001270*****02  LINE   8  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001280*****02  LINE   9  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001290*****02  LINE  10  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001300*****02  LINE  11  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001310*****02  LINE  12  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001320*****02  LINE  13  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001330*****02  LINE  14  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001340*****02  LINE  15  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001350*****02  LINE  16  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001360*****02  LINE  17  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001370*****02  LINE  18  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001380*****02  LINE  19  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001390*****02  LINE  20  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001400*****02  LINE  21  COLUMN   3  VERTICAL LINE AT  3  28  53  78.   D.100916
001410*****02  LINE  22  COLUMN   3  UNDER    LINE TO 78                D.100916
001420*****                          VERTICAL LINE AT  3  28  53  78.   D.100916
001430 01  C-ACP.
001440     02  A-ACT   LINE   3  COLUMN  57  PIC  9(001)
001450          USING W-ACT   CHECK OVERFLOW NO IFC.
001460*
001470     02  LINE   7.
001480*****  03  A-TNC   COLUMN  12  PIC  9(003)                        D.100916
001490       03  A-TNC   COLUMN  11  PIC  9(004)                        I.100916
001500            USING W-TNC   CHECK OVERFLOW NO IFC.
001510       03  A-NAME  COLUMN  22  PIC  N(026)
001520            USING W-NAME  CHECK OVERFLOW NO IFC.
001530     02  A-BSC   LINE   9  COLUMN  22  PIC  9(001)
001540          USING W-BSC   CHECK OVERFLOW NO IFC.
001550*
001560     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
001570          USING W-DMM   CHECK OVERFLOW NO IFC.
001580 01  C-DSP.
001590     02  LINE W-L.
001600*****  03  D-TNC   COLUMN W-C1 PIC  9(003) FROM  WTNA-TNC.        D.100916
001610       03  D-TNC   COLUMN W-C1 PIC  9(004) FROM  WTNA-TNC.        I.100916
001620       03  D-BSC   COLUMN W-C2 PIC  X(001) FROM  W-CHK.
001630       03  D-NAME  COLUMN W-C3 PIC  N(010) FROM  WTNA-NAME.
001640 01  C-ERR.
001650     02  LINE  24.
001660       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
001670            "***  DATA Å¼  ***".
001680       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
001690            "***  Ä³Û¸ ½ÞÐ  ***".
001700       03  E-ME9   COLUMN  15  PIC  N(005) VALUE
001710            NC"ƒLƒƒƒ“ƒZƒ‹".
001720       03  E-ME11  COLUMN  15  PIC  X(026) VALUE
001730            "***  WRITE ´×°  ***".
001740       03  E-ME12  COLUMN  15  PIC  X(027) VALUE
001750            "***  REWRITE ´×°   ***".
001760       03  E-ME13  COLUMN  15  PIC  X(027) VALUE
001770            "***  DELETE ´×°  ***".
001780       03  E-KEY   COLUMN  45  PIC  X(004) FROM  WTNA-TNC.        I.100916
001790*****  03  E-KEY   COLUMN  45  PIC  X(003) FROM  WTNA-TNC.        D.100916
001800     COPY LSSEM.
001810 PROCEDURE DIVISION.
001820 M-020.
001830     DISPLAY C-CLEAR.
001840     DISPLAY C-MID C-MID1.
001850     MOVE ZERO TO W-CRT.
001860*
001870     OPEN I-O WTNAF.
001880 M-040.
001890     ACCEPT A-ACT.
001900     IF ESTAT = PF9
001910         GO TO M-900.
001920     IF ESTAT NOT = HTB AND SKP
001930         GO TO M-040.
001940     IF W-ACT = 9
001950         GO TO M-900.
001960     IF W-ACT NOT = 1 AND 2 AND 3 AND 5
001970         GO TO M-040.
001980     IF W-ACT = 5
001990         GO TO M-200.
002000 M-060.
002010     ACCEPT A-TNC.
002020     DISPLAY E-CL.
002030     IF ESTAT = BTB
002040         GO TO M-040.
002050     IF ESTAT NOT = HTB AND SKP
002060         GO TO M-060.
002070     IF W-TNC = ZERO
002080         GO TO M-060.
002090*
002100     MOVE W-TNC TO WTNA-KEY.
002110     READ WTNAF INVALID KEY
002120         GO TO M-080.
002130     MOVE WTNA-NAME TO W-NAME.
002140     MOVE WTNA-BSC TO W-BSC.
002150     DISPLAY A-NAME A-BSC.
002160     IF W-ACT = 1
002170         DISPLAY E-ME2 E-ME99
002180         GO TO M-060.
002190     GO TO M-100.
002200 M-080.
002210     IF W-ACT NOT = 1
002220         DISPLAY E-ME1 E-ME99
002230         GO TO M-060.
002240 M-100.
002250     ACCEPT A-NAME.
002260     DISPLAY E-CL.
002270     IF ESTAT = BTB
002280         GO TO M-060.
002290     IF ESTAT NOT = HTB AND SKP
002300         GO TO M-100.
002310 M-110.
002320     ACCEPT A-BSC.
002330     DISPLAY E-CL.
002340     IF ESTAT = BTB
002350         GO TO M-100.
002360     IF ESTAT NOT = HTB AND SKP
002370         GO TO M-110.
002380*****IF W-BSC > 1                                                 D.091104
002390     IF W-BSC NOT = 0 AND 1 AND 9                                 I.091104
002400         GO TO M-110.
002410 M-120.
002420     ACCEPT A-DMM.
002430     DISPLAY E-CL.
002440     IF ESTAT = BTB
002450         GO TO M-110.
002460     IF ESTAT NOT = HTB AND SKP
002470         GO TO M-120.
002480     IF W-DMM = 9
002490         DISPLAY E-ME9 E-ME99
002500         GO TO M-060.
002510     IF W-DMM NOT = 1
002520         GO TO M-120.
002530*
002540     IF W-ACT NOT = 1
002550         GO TO M-140.
002560     INITIALIZE WTNA-R.
002570     MOVE W-TNC TO WTNA-KEY.
002580     MOVE W-NAME TO WTNA-NAME.
002590     MOVE W-BSC TO WTNA-BSC.
002600     WRITE WTNA-R INVALID KEY
002610         DISPLAY E-ME11 E-ME99
002620         GO TO M-900.
002630     GO TO M-180.
002640 M-140.
002650     IF W-ACT NOT = 2
002660         GO TO M-160.
002670     MOVE W-NAME TO WTNA-NAME.
002680     MOVE W-BSC TO WTNA-BSC.
002690     REWRITE WTNA-R INVALID KEY
002700         DISPLAY E-ME12 E-ME99
002710         GO TO M-900.
002720     GO TO M-180.
002730 M-160.
002740     DELETE WTNAF INVALID KEY
002750         DISPLAY E-ME13 E-ME99
002760         GO TO M-900.
002770 M-180.
002780     DISPLAY C-CLEAR.
002790     DISPLAY C-MID C-MID1.
002800     DISPLAY A-ACT.
002810     GO TO M-060.
002820 M-200.
002830     DISPLAY C-CLEAR.
002840     DISPLAY C-MID C-MID2.
002850     DISPLAY A-ACT.
002860     CLOSE WTNAF.
002870     OPEN INPUT WTNAF.
002880     MOVE 0 TO W-END.
002890     MOVE 5 TO W-L.
002900*****MOVE 4 TO W-C1.                                              D.100916
002910     MOVE 3 TO W-C1.                                              I.100916
002920     MOVE 7 TO W-C2.
002930     MOVE 8 TO W-C3.
002940*
002950     READ WTNAF NEXT RECORD AT END
002960         MOVE 1 TO W-END
002970         DISPLAY E-ME1 E-ME98
002980         GO TO M-240.
002990     IF WTNA-BSC = 0
003000         MOVE SPACE TO W-CHK
003010       ELSE
003020         MOVE "*" TO W-CHK.
003030 M-220.
003040     ADD 1 TO W-L.
003050     IF W-L < 23
003060         DISPLAY D-TNC D-BSC D-NAME
003070         GO TO M-280.
003080*****IF W-C1 = 4                                                  D.100916
003090     IF W-C1 = 3                                                  I.100916
003100         MOVE 5 TO W-L
003110         MOVE 29 TO W-C1
003120         MOVE 33 TO W-C2                                          I.100916
003130         MOVE 34 TO W-C3                                          I.100916
003140*****    MOVE 32 TO W-C2                                          D.100916
003150*****    MOVE 33 TO W-C3                                          D.100916
003160         GO TO M-220
003170       ELSE
003180         IF W-C1 = 29
003190             MOVE 5 TO W-L
003200             MOVE 55 TO W-C1                                      I.100916
003210             MOVE 59 TO W-C2                                      I.100916
003220             MOVE 60 TO W-C3                                      I.100916
003230*****        MOVE 54 TO W-C1                                      D.100916
003240*****        MOVE 57 TO W-C2                                      D.100916
003250*****        MOVE 58 TO W-C3                                      D.100916
003260             GO TO M-220.
003270 M-240.
003280     ACCEPT A-DMM.
003290     DISPLAY E-CL.
003300     IF ESTAT NOT = HTB AND SKP
003310         GO TO M-120.
003320     IF W-DMM = 9
003330         GO TO M-260.
003340     IF W-DMM NOT = 1
003350         GO TO M-240.
003360     IF W-END = 1
003370         GO TO M-260.
003380*
003390     DISPLAY C-CLEAR.
003400     DISPLAY C-MID C-MID2.
003410     DISPLAY A-ACT.
003420     MOVE 5 TO W-L.
003430*****MOVE 4 TO W-C1.                                              D.100916
003440     MOVE 3 TO W-C1.                                              I.100916
003450     MOVE 7 TO W-C2.
003460     MOVE 8 TO W-C3.
003470     GO TO M-220.
003480 M-260.
003490     DISPLAY C-CLEAR.
003500     DISPLAY C-MID C-MID1.
003510     MOVE ZERO TO W-CRT.
003520*
003530     CLOSE WTNAF.
003540     OPEN I-O WTNAF.
003550     GO TO M-040.
003560 M-280.
003570     READ WTNAF NEXT RECORD AT END
003580         MOVE 1 TO W-END
003590         GO TO M-240.
003600     IF WTNA-BSC = 0
003610         MOVE SPACE TO W-CHK
003620       ELSE
003630         IF WTNA-BSC = 1                                          I.091104
003640             MOVE "*" TO W-CHK                                    I.091104
003650           ELSE                                                   I.091104
003660             IF WTNA-BSC = 9                                      I.091104
003670                 MOVE "#" TO W-CHK.                               I.091104
003680*****    MOVE "*" TO W-CHK.                                       D.091104
003690     GO TO M-220.
003700 M-900.
003710     CLOSE WTNAF.
003720 M-980.
003730     DISPLAY C-CLEAR.
003740     STOP RUN.
