000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JTN72L.
000030*********************************************************
000040*    PROGRAM         :  上海成型生協分日付別出荷集計表  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY HI-KEY
000200         ALTERNATE RECORD KEY HI-KEY2
000210         FILE STATUS ERR-STAT.
000220     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE RANDOM
000250         RECORD KEY T-KEY
000260         ALTERNATE RECORD KEY T-KEY2
000270         FILE STATUS ERR-STAT.
000280     SELECT JNSRW ASSIGN TO JNSRW-MSD.
000290     SELECT SP-F ASSIGN TO P-PRN999.
000300 I-O-CONTROL.
000310     APPLY SHARED-MODE ON M-DATE
000320     APPLY SHARED-MODE ON HI-M
000330     APPLY SHARED-MODE ON T-M
000340     APPLY SHIFT-CODE ON SP-F.
000350 DATA DIVISION.
000360 FILE SECTION.
000370     COPY LIBFDD.
000380     COPY LIHIM.
000390     COPY LITM.
000400     COPY LSPF.
000410 FD  JNSRW
000420     BLOCK  2 RECORDS
000430     LABEL RECORD IS STANDARD
000440     VALUE OF IDENTIFICATION WK0128ID.
000450 01  WSKUH-R.
000460     02  JNSRW-HCD      PIC  9(006).
000470     02  JNSRW-TCD      PIC  9(004).
000480     02  JNSRW-CCD      PIC  9(003).
000490     02  JNSRW-NSC      PIC  9(002).
000500     02  JNSRW-SIZ      PIC  9(001).
000510     02  JNSRW-ASU.
000520       03  JNSRW-SUD  OCCURS  10.
000530         04  JNSRW-SU   PIC S9(004).
000540     02  JNSRW-DATE     PIC  9(008).
000550     02  F              PIC  X(064).
000560 WORKING-STORAGE SECTION.
000570 77  W-ME               PIC  X(040).
000580 77  WK0128ID           PIC  X(009) VALUE SPACE.
000590 01  STN-NO.
000600     02  STN-NO1        PIC  X(003).
000610     02  STN-NO2        PIC  X(003).
000620 01  W-FID.
000630     02  W-FID1         PIC  X(006) VALUE "WK0128".
000640     02  W-FID2         PIC  X(003).
000650 01  HEAD1.
000660     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000670     02  F              PIC  N(001) VALUE NC"【".
000680     02  F              PIC  X(002) VALUE " '".
000690     02  H-SNEN         PIC  9(002).
000700     02  F              PIC  X(001) VALUE "/".
000710     02  H-SGET         PIC Z9.
000720     02  F              PIC  X(001) VALUE "/".
000730     02  H-SPEY         PIC Z9.
000740     02  F              PIC  X(001) VALUE SPACE.
000750     02  F              PIC  N(001) VALUE NC"〜".
000760     02  F              PIC  X(002) VALUE " '".
000770     02  H-ENEN         PIC  9(002).
000780     02  F              PIC  X(001) VALUE "/".
000790     02  H-EGET         PIC Z9.
000800     02  F              PIC  X(001) VALUE "/".
000810     02  H-EPEY         PIC Z9.
000820     02  F              PIC  X(001) VALUE SPACE.
000830     02  F              PIC  N(001) VALUE NC"】".
000840     02  F              PIC  X(015) VALUE SPACE.
000850     02  F              PIC  N(023) VALUE
000860          NC"＊＊＊　　上海成型生協別　出荷集計表　　＊＊＊".
000870     02  F              PIC  X(025) VALUE SPACE.
000880     02  F              PIC  X(005) VALUE "DATE ".
000890     02  H-DATE         PIC 99B99B99.
000900     02  F              PIC  X(007) VALUE "     P.".
000910     02  H-PAGE         PIC Z9.
000920 01  HEAD2.
000930     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
000940     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".
000950     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
000960     02  F              PIC  X(038) VALUE SPACE.
000970     02  F              PIC  X(001) VALUE "1".
000980     02  F              PIC  X(004) VALUE SPACE.
000990     02  F              PIC  N(002) VALUE NC"３号".
001000     02  F              PIC  X(004) VALUE SPACE.
001010     02  F              PIC  N(002) VALUE NC"２号".
001020     02  F              PIC  X(005) VALUE SPACE.
001030     02  F              PIC  X(002) VALUE "SS".
001040     02  F              PIC  X(006) VALUE SPACE.
001050     02  F              PIC  X(001) VALUE "S".
001060     02  F              PIC  X(006) VALUE SPACE.
001070     02  F              PIC  X(001) VALUE "M".
001080     02  F              PIC  X(006) VALUE SPACE.
001090     02  F              PIC  X(001) VALUE "L".
001100     02  F              PIC  X(005) VALUE SPACE.
001110     02  F              PIC  X(002) VALUE "LL".
001120     02  F              PIC  X(005) VALUE SPACE.
001130     02  F              PIC  X(002) VALUE "XL".
001140     02  F              PIC  X(004) VALUE SPACE.
001150     02  F              PIC  X(003) VALUE "XXL".
001160     02  F              PIC  X(003) VALUE SPACE.
001170     02  F              PIC  X(004) VALUE "30.0".
001180     02  F              PIC  X(008) VALUE SPACE.
001190 01  HEAD3.
001200     02  F              PIC  X(012) VALUE SPACE.
001210     02  F              PIC  X(005) VALUE "ｺｰﾄﾞ ".
001220     02  F              PIC  N(008) VALUE NC"得　意　先　名　".
001230     02  F              PIC  X(028) VALUE SPACE.
001240     02  F              PIC  X(001) VALUE "2".
001250     02  F              PIC  X(003) VALUE SPACE.
001260     02  F              PIC  X(004) VALUE "12.5".
001270     02  F              PIC  X(003) VALUE SPACE.
001280     02  F              PIC  X(004) VALUE "13.0".
001290     02  F              PIC  X(003) VALUE SPACE.
001300     02  F              PIC  X(004) VALUE "13.5".
001310     02  F              PIC  X(003) VALUE SPACE.
001320     02  F              PIC  X(004) VALUE "14.0".
001330     02  F              PIC  X(003) VALUE SPACE.
001340     02  F              PIC  X(004) VALUE "15.0".
001350     02  F              PIC  X(003) VALUE SPACE.
001360     02  F              PIC  X(004) VALUE "16.0".
001370     02  F              PIC  X(003) VALUE SPACE.
001380     02  F              PIC  X(004) VALUE "17.0".
001390     02  F              PIC  X(003) VALUE SPACE.
001400     02  F              PIC  X(004) VALUE "18.0".
001410     02  F              PIC  X(003) VALUE SPACE.
001420     02  F              PIC  X(004) VALUE "19.0".
001430     02  F              PIC  X(003) VALUE SPACE.
001440     02  F              PIC  X(004) VALUE "20.0".
001450     02  F              PIC  X(008) VALUE SPACE.
001460 01  HEAD4.
001470     02  F              PIC  X(057) VALUE SPACE.
001480     02  F              PIC  X(001) VALUE "3".
001490     02  F              PIC  X(003) VALUE SPACE.
001500     02  F              PIC  X(004) VALUE "21.0".
001510     02  F              PIC  X(003) VALUE SPACE.
001520     02  F              PIC  X(004) VALUE "21.5".
001530     02  F              PIC  X(003) VALUE SPACE.
001540     02  F              PIC  X(004) VALUE "22.0".
001550     02  F              PIC  X(003) VALUE SPACE.
001560     02  F              PIC  X(004) VALUE "22.5".
001570     02  F              PIC  X(003) VALUE SPACE.
001580     02  F              PIC  X(004) VALUE "23.0".
001590     02  F              PIC  X(003) VALUE SPACE.
001600     02  F              PIC  X(004) VALUE "23.5".
001610     02  F              PIC  X(003) VALUE SPACE.
001620     02  F              PIC  X(004) VALUE "24.0".
001630     02  F              PIC  X(003) VALUE SPACE.
001640     02  F              PIC  X(004) VALUE "24.5".
001650     02  F              PIC  X(003) VALUE SPACE.
001660     02  F              PIC  X(004) VALUE "25.0".
001670     02  F              PIC  X(003) VALUE SPACE.
001680     02  F              PIC  X(004) VALUE "    ".
001690     02  F              PIC  X(008) VALUE SPACE.
001700 01  HEAD5.
001710     02  F              PIC  X(057) VALUE SPACE.
001720     02  F              PIC  X(001) VALUE "4".
001730     02  F              PIC  X(003) VALUE SPACE.
001740     02  F              PIC  X(004) VALUE "24.0".
001750     02  F              PIC  X(003) VALUE SPACE.
001760     02  F              PIC  X(004) VALUE "24.5".
001770     02  F              PIC  X(003) VALUE SPACE.
001780     02  F              PIC  X(004) VALUE "25.0".
001790     02  F              PIC  X(003) VALUE SPACE.
001800     02  F              PIC  X(004) VALUE "25.5".
001810     02  F              PIC  X(003) VALUE SPACE.
001820     02  F              PIC  X(004) VALUE "26.0".
001830     02  F              PIC  X(003) VALUE SPACE.
001840     02  F              PIC  X(004) VALUE "26.5".
001850     02  F              PIC  X(003) VALUE SPACE.
001860     02  F              PIC  X(004) VALUE "27.0".
001870     02  F              PIC  X(003) VALUE SPACE.
001880     02  F              PIC  X(004) VALUE "27.5".
001890     02  F              PIC  X(003) VALUE SPACE.
001900     02  F              PIC  X(004) VALUE "    ".
001910     02  F              PIC  X(003) VALUE SPACE.
001920     02  F              PIC  X(004) VALUE "    ".
001930     02  F              PIC  X(005) VALUE SPACE.
001940     02  F              PIC  N(002) VALUE NC"合計".
001950 01  W-P1.
001960     02  P-HCD          PIC  9(006).
001970     02  F              PIC  X(001).
001980     02  P-HNA          PIC  N(024).
001990     02  F              PIC  X(093).
002000 01  W-P2.
002010     02  F              PIC  X(012).
002020     02  P-TCD          PIC  9(004).
002030     02  F              PIC  X(001).
002040     02  P-TNA          PIC  N(026).
002050     02  F              PIC  X(001).
002060     02  P-SIZ          PIC  X(001).
002070     02  P-ASU.
002080       03  P-SUD   OCCURS  10.
002090         04  P-SU       PIC ---,---.
002100     02  P-SUT          PIC ----,--9.
002110 01  W-DATA.
002120     02  W-SNGP.
002130       03  W-SNG.
002140         04  W-SNEN     PIC  9(004).
002150         04  W-SNENL REDEFINES W-SNEN.
002160           05  W-SNEN1  PIC  9(002).
002170           05  W-SNEN2  PIC  9(002).
002180         04  W-SGET     PIC  9(002).
002190       03  W-SPEY       PIC  9(002).
002200     02  W-ENGP.
002210       03  W-ENG.
002220         04  W-ENEN     PIC  9(004).
002230         04  W-ENENL REDEFINES W-ENEN.
002240           05  W-ENEN1  PIC  9(002).
002250           05  W-ENEN2  PIC  9(002).
002260         04  W-EGET     PIC  9(002).
002270       03  W-EPEY       PIC  9(002).
002280     02  W-DMM          PIC  9(001).
002290     02  W-HCD          PIC  9(006).
002300     02  W-TCD          PIC  9(004).
002310     02  W-PAGE         PIC  9(002).
002320     02  W-SUT          PIC S9(006).
002330     02  CHK            PIC  9(001).
002340     02  CNT            PIC  9(002).
002350     02  W-DC           PIC  9(001).
002360     02  W-SC           PIC  9(001).
002370     02  W-ASUD.
002380       03  W-ASU   OCCURS  4.
002390         04  W-SUD   OCCURS 10.
002400           05  W-SU     PIC S9(005).
002410     02  W-TASUD.
002420       03  W-TASU   OCCURS  4.
002430         04  W-TSUD   OCCURS 10.
002440           05  W-TSU    PIC S9(005).
002450     02  W-AZC.
002460       03  W-ZCD   OCCURS    4.
002470         04  W-ZC       PIC  9(001).
002480 01  ERR-STAT           PIC  X(002).
002490     COPY LSTAT.
002500 SCREEN  SECTION.
002510 SD  C-CRT
002520     END STATUS IS ESTAT.
002530 01  C-CLEAR.
002540     02  C-CL    LINE   1  CLEAR SCREEN.
002550 01  C-MID.
002560     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
002570          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002580     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
002590          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002600     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
002610          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002620     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
002630          NC"＊＊＊　　上海成型生協別　出荷集計表　　＊＊＊".
002640     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
002650          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002660     02  LINE   8  COLUMN  10  PIC  N(023) VALUE
002670          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002680     02  LINE   9  COLUMN  10  PIC  N(023) VALUE
002690          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002700     02  LINE  14.
002710       03  COLUMN  12  PIC  X(042) VALUE
002720          "[  '  年   月   日  〜  '  年   月   日  ]".
002730       03  COLUMN  58  PIC  X(009) VALUE "終了=ｆ･9".
002740     02  LINE  20  COLUMN  35  PIC  X(022) VALUE
002750            "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002760 01  C-ACP.
002770     02  LINE  14.
002780       03  A-SNEN2 COLUMN  16  PIC  9(002)
002790            USING W-SNEN2 CHECK OVERFLOW NO IFC.
002800       03  A-SGET  COLUMN  21  PIC  9(002)
002810            USING W-SGET  CHECK OVERFLOW NO IFC.
002820       03  A-SPEY  COLUMN  26  PIC  9(002)
002830            USING W-SPEY  CHECK OVERFLOW NO IFC.
002840       03  A-ENEN2 COLUMN  37  PIC  9(002)
002850            USING W-ENEN2 CHECK OVERFLOW NO IFC.
002860       03  A-EGET  COLUMN  42  PIC  9(002)
002870            USING W-EGET  CHECK OVERFLOW NO IFC.
002880       03  A-EPEY  COLUMN  47  PIC  9(002)
002890            USING W-EPEY  CHECK OVERFLOW NO IFC.
002900     02  A-DMM   LINE  20  COLUMN  52  PIC  9(001)
002910          USING W-DMM   CHECK OVERFLOW NO IFC.
002920 01  C-ERR.
002930     02  LINE  24.
002940       03  E-ME    COLUMN  15  PIC  X(040) FROM  W-ME.
002950       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002960       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002970       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002980     COPY LIBSCR.
002990 PROCEDURE DIVISION.
003000 M-05.
003010     DISPLAY C-CLEAR.
003020     DISPLAY C-MID.
003030     MOVE ZERO TO W-DATA.
003040     CALL "CBLSTNNO" USING STN-NO.
003050     MOVE STN-NO2 TO W-FID2.
003060     MOVE W-FID TO WK0128ID.
003070     OPEN INPUT HI-M T-M.
003080     COPY LIBCPR.
003090 M-10.
003100     PERFORM ACP-RTN THRU ACP-EX.
003110     IF COMPLETION-CODE = 255
003120         GO TO M-90.
003130*
003140     OPEN INPUT JNSRW.
003150 M-12.
003160     READ JNSRW AT END
003170         CLOSE JNSRW
003180         MOVE SPACE TO W-ME
003190         MOVE "***  DATA ﾅｼ  ***" TO W-ME
003200         DISPLAY E-ME E-ME99
003210         GO TO M-10.
003220     IF JNSRW-DATE < W-SNGP OR > W-ENGP
003230         GO TO M-12.
003240     IF JNSRW-NSC NOT = 22
003250         GO TO M-12.
003260     IF ZERO = JNSRW-SU(01) AND JNSRW-SU(02) AND JNSRW-SU(03) AND
003270               JNSRW-SU(04) AND JNSRW-SU(05) AND JNSRW-SU(06) AND
003280               JNSRW-SU(07) AND JNSRW-SU(08) AND JNSRW-SU(09) AND
003290               JNSRW-SU(10)
003300         GO TO M-12.
003310*
003320     MOVE W-SNEN2 TO H-SNEN.
003330     MOVE W-SGET TO H-SGET.
003340     MOVE W-SPEY TO H-SPEY.
003350     MOVE W-ENEN2 TO H-ENEN.
003360     MOVE W-EGET TO H-EGET.
003370     MOVE W-EPEY TO H-EPEY.
003380     ACCEPT H-DATE FROM DATE.
003390     OPEN OUTPUT SP-F.
003400     PERFORM MID-010 THRU MID-EX.
003410 M-15.
003420     MOVE ZERO TO W-TASUD CHK W-DC.
003430     MOVE JNSRW-HCD TO W-HCD.
003440     MOVE W-HCD TO HI-KEY.
003450     READ HI-M WITH UNLOCK INVALID KEY
003460         MOVE SPACE TO HI-NAME
003470         MOVE NC"＊＊　品名なし　＊＊" TO HI-NAME.
003480*
003490     MOVE SPACE TO W-P1.
003500     MOVE W-HCD TO P-HCD.
003510     MOVE HI-NAME TO P-HNA.
003520 M-20.
003530     MOVE ZERO TO W-ASUD W-SUT W-AZC.
003540     MOVE JNSRW-TCD TO W-TCD.
003550     MOVE W-TCD TO T-KEY.
003560     READ T-M WITH UNLOCK INVALID KEY
003570         MOVE SPACE TO T-NAME
003580         MOVE NC"＊＊　得意先なし　＊＊" TO T-NAME.
003590 M-25.
003600     MOVE ZERO TO CNT.
003610 M-30.
003620     ADD 1 TO CNT.
003630     IF CNT > 10
003640         GO TO M-35.
003650     ADD JNSRW-SU(CNT) TO W-SU(JNSRW-SIZ,CNT) W-SUT
003660                          W-TSU(JNSRW-SIZ,CNT).
003670     IF W-ZC(JNSRW-SIZ) = 0
003680         MOVE 1 TO W-ZC(JNSRW-SIZ).
003690     GO TO M-30.
003700 M-35.
003710     READ JNSRW AT END
003720         GO TO M-80.
003730     IF JNSRW-DATE < W-SNGP OR > W-ENGP
003740         GO TO M-35.
003750     IF JNSRW-NSC NOT = 22
003760         GO TO M-35.
003770     IF ZERO = JNSRW-SU(01) AND JNSRW-SU(02) AND JNSRW-SU(03) AND
003780               JNSRW-SU(04) AND JNSRW-SU(05) AND JNSRW-SU(06) AND
003790               JNSRW-SU(07) AND JNSRW-SU(08) AND JNSRW-SU(09) AND
003800               JNSRW-SU(10)
003810         GO TO M-35.
003820     IF JNSRW-HCD NOT = W-HCD
003830         GO TO M-40.
003840     IF JNSRW-TCD = W-TCD
003850         GO TO M-25.
003860     PERFORM MEI-RTN THRU MEI-EX.
003870     GO TO M-20.
003880 M-40.
003890     PERFORM MEI-RTN THRU MEI-EX.
003900     PERFORM KEI-RTN THRU KEI-EX.
003910     GO TO M-15.
003920 M-80.
003930     PERFORM MEI-RTN THRU MEI-EX.
003940     PERFORM KEI-RTN THRU KEI-EX.
003950*
003960     CLOSE JNSRW.
003970     CLOSE SP-F.
003980     GO TO M-10.
003990 M-90.
004000     CLOSE HI-M T-M.
004010 M-95.
004020     DISPLAY C-CLEAR.
004030     STOP RUN.
004040 ACP-RTN.
004050     ACCEPT A-SNEN2.
004060     IF ESTAT = PF9
004070         MOVE 255 TO COMPLETION-CODE
004080         GO TO ACP-EX.
004090     IF ESTAT NOT = HTB AND SKP
004100         GO TO ACP-RTN.
004110     MOVE ZERO TO W-SNEN1.
004120     IF W-SNEN2 >= DATE-NF1 AND <= DATE-NT1
004130         ADD DATE-NC1 TO W-SNEN.
004140     IF W-SNEN2 >= DATE-NF2 AND <= DATE-NT2
004150         ADD DATE-NC2 TO W-SNEN.
004160 ACP-010.
004170     ACCEPT A-SGET.
004180     IF ESTAT = PF9
004190         MOVE 255 TO COMPLETION-CODE
004200         GO TO ACP-EX.
004210     IF ESTAT = BTB
004220         GO TO ACP-RTN.
004230     IF ESTAT NOT = HTB AND SKP
004240         GO TO ACP-010.
004250     IF W-SGET < 1 OR > 12
004260         GO TO ACP-010.
004270 ACP-020.
004280     ACCEPT A-SPEY.
004290     IF ESTAT = PF9
004300         MOVE 255 TO COMPLETION-CODE
004310         GO TO ACP-EX.
004320     IF ESTAT = BTB
004330         GO TO ACP-010.
004340     IF ESTAT NOT = HTB AND SKP
004350         GO TO ACP-020.
004360     IF W-SPEY < 1 OR > 31
004370         GO TO ACP-020.
004380 ACP-030.
004390     ACCEPT A-ENEN2.
004400     IF ESTAT = PF9
004410         MOVE 255 TO COMPLETION-CODE
004420         GO TO ACP-EX.
004430     IF ESTAT = BTB
004440         GO TO ACP-020.
004450     IF ESTAT NOT = HTB AND SKP
004460         GO TO ACP-030.
004470     MOVE ZERO TO W-ENEN1.
004480     IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1
004490         ADD DATE-NC1 TO W-ENEN.
004500     IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2
004510         ADD DATE-NC2 TO W-ENEN.
004520     IF W-SNEN > W-ENEN
004530         GO TO ACP-030.
004540 ACP-040.
004550     ACCEPT A-EGET.
004560     IF ESTAT = PF9
004570         MOVE 255 TO COMPLETION-CODE
004580         GO TO ACP-EX.
004590     IF ESTAT = BTB
004600         GO TO ACP-030.
004610     IF ESTAT NOT = HTB AND SKP
004620         GO TO ACP-040.
004630     IF W-SNG > W-ENG
004640         GO TO ACP-040.
004650 ACP-050.
004660     ACCEPT A-EPEY.
004670     IF ESTAT = PF9
004680         MOVE 255 TO COMPLETION-CODE
004690         GO TO ACP-EX.
004700     IF ESTAT = BTB
004710         GO TO ACP-040.
004720     IF ESTAT NOT = HTB AND SKP
004730         GO TO ACP-050.
004740     IF W-SNGP > W-ENGP
004750         GO TO ACP-050.
004760 ACP-100.
004770     ACCEPT A-DMM.
004780     IF ESTAT = PF9
004790         MOVE 255 TO COMPLETION-CODE
004800         GO TO ACP-EX.
004810     IF ESTAT = BTB
004820         GO TO ACP-050.
004830     IF ESTAT NOT = HTB AND SKP
004840         GO TO ACP-100.
004850     IF W-DMM = 9
004860         GO TO ACP-RTN.
004870     IF W-DMM NOT = 1
004880         GO TO ACP-100.
004890 ACP-EX.
004900     EXIT.
004910 MID-RTN.
004920     MOVE SPACE TO SP-R.
004930     WRITE SP-R AFTER PAGE.
004940 MID-010.
004950     ADD 1 TO W-PAGE.
004960     MOVE W-PAGE TO H-PAGE.
004970     MOVE SPACE TO SP-R.
004980     MOVE HEAD1 TO SP-R.
004990     WRITE SP-R.
005000     MOVE SPACE TO SP-R.
005010     MOVE HEAD2 TO SP-R.
005020     WRITE SP-R AFTER 2.
005030     MOVE SPACE TO SP-R.
005040     MOVE HEAD3 TO SP-R.
005050     WRITE SP-R.
005060     MOVE SPACE TO SP-R.
005070     MOVE HEAD4 TO SP-R.
005080     WRITE SP-R.
005090     MOVE SPACE TO SP-R.
005100     MOVE HEAD5 TO SP-R.
005110     WRITE SP-R.
005120     MOVE SPACE TO SP-R.
005130     WRITE SP-R.
005140 MID-EX.
005150     EXIT.
005160 MEI-RTN.
005170     IF W-AZC = ZERO
005180         GO TO MEI-EX.
005190     IF CHK NOT = 0
005200         GO TO MEI-010.
005210     MOVE 1 TO CHK.
005220     IF LINAGE-COUNTER > 59
005230         PERFORM MID-RTN THRU MID-EX.
005240     MOVE SPACE TO SP-R.
005250     MOVE W-P1 TO SP-R.
005260     WRITE SP-R.
005270     MOVE SPACE TO SP-R.
005280 MEI-010.
005290     MOVE SPACE TO W-P2.
005300     MOVE W-TCD TO P-TCD.
005310     MOVE T-NAME TO P-TNA.
005320     MOVE 0 TO W-SC.
005330 MEI-020.
005340     ADD 1 TO W-SC.
005350     IF W-SC > 4
005360         GO TO MEI-EX.
005370     IF W-ZC(W-SC) = 0
005380         GO TO MEI-020.
005390     MOVE W-SC TO P-SIZ.
005400     MOVE ZERO TO CNT.
005410 MEI-030.
005420     ADD 1 TO CNT.
005430     IF CNT < 11
005440         MOVE W-SU(W-SC,CNT) TO P-SU(CNT)
005450         GO TO MEI-030.
005460     IF W-SC = 1
005470         IF 0 = W-ZC(2) AND W-ZC(3) AND W-ZC(4)
005480             MOVE W-SUT TO P-SUT.
005490     IF W-SC = 2
005500         IF 0 = W-ZC(3) AND W-ZC(4)
005510             MOVE W-SUT TO P-SUT.
005520     IF W-SC = 3
005530         IF 0 = W-ZC(4)
005540             MOVE W-SUT TO P-SUT.
005550     IF W-SC = 4
005560         MOVE W-SUT TO P-SUT.
005570*
005580     IF LINAGE-COUNTER > 60
005590         PERFORM MID-RTN THRU MID-EX
005600         MOVE SPACE TO SP-R
005610         MOVE W-P1 TO SP-R
005620         WRITE SP-R
005630         MOVE SPACE TO SP-R
005640         MOVE W-TCD TO P-TCD
005650         MOVE T-NAME TO P-TNA.
005660     MOVE SPACE TO SP-R.
005670     MOVE W-P2 TO SP-R.
005680     WRITE SP-R.
005690     MOVE SPACE TO SP-R.
005700     MOVE SPACE TO W-P2.
005710     MOVE SPACE TO P-TNA.
005720     GO TO MEI-020.
005730 MEI-EX.
005740     EXIT.
005750 KEI-RTN.
005760     MOVE ZERO TO W-SC W-AZC W-SUT.
005770 KEI-010.
005780     ADD 1 TO W-SC.
005790     IF W-SC > 4
005800         GO TO KEI-030.
005810     MOVE ZERO TO CNT.
005820 KEI-020.
005830     ADD 1 TO CNT.
005840     IF CNT > 10
005850         GO TO KEI-010.
005860     IF W-TSU(W-SC,CNT) NOT = ZERO
005870         ADD W-TSU(W-SC,CNT) TO W-SUT
005880         IF W-ZC(W-SC) = 0
005890             MOVE 1 TO W-ZC(W-SC).
005900     GO TO KEI-020.
005910 KEI-030.
005920     IF W-AZC = ZERO
005930         GO TO KEI-EX.
005940     MOVE SPACE TO W-P2.
005950     MOVE NC"　　　　［　合　計　］　" TO P-TNA.
005960     MOVE ZERO TO W-SC.
005970 KEI-040.
005980     ADD 1 TO W-SC.
005990     IF W-SC > 4
006000         GO TO KEI-EX.
006010     IF W-ZC(W-SC) = 0
006020         GO TO KEI-040.
006030     MOVE ZERO TO CNT.
006040 KEI-050.
006050     ADD 1 TO CNT.
006060     IF CNT < 11
006070         MOVE W-TSU(W-SC,CNT) TO P-SU(CNT)
006080         GO TO KEI-050.
006090     IF W-SC = 1
006100         IF 0 = W-ZC(2) AND W-ZC(3) AND W-ZC(4)
006110             MOVE W-SUT TO P-SUT.
006120     IF W-SC = 2
006130         IF 0 = W-ZC(3) AND W-ZC(4)
006140             MOVE W-SUT TO P-SUT.
006150     IF W-SC = 3
006160         IF 0 = W-ZC(4)
006170             MOVE W-SUT TO P-SUT.
006180     IF W-SC = 4
006190         MOVE W-SUT TO P-SUT.
006200*
006210     IF LINAGE-COUNTER > 60
006220         PERFORM MID-RTN THRU MID-EX
006230         MOVE SPACE TO SP-R
006240         MOVE W-P1 TO SP-R
006250         WRITE SP-R
006260         MOVE SPACE TO SP-R
006270         MOVE W-TCD TO P-TCD
006280         MOVE T-NAME TO P-TNA.
006290     MOVE SPACE TO SP-R.
006300     MOVE W-P2 TO SP-R.
006310     WRITE SP-R.
006320     MOVE SPACE TO SP-R.
006330     MOVE SPACE TO W-P2.
006340     MOVE SPACE TO P-TNA.
006350     GO TO KEI-040.
006360 KEI-EX.
006370     EXIT.
