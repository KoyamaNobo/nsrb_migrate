000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT292L.
000030 AUTHOR.                        E-SHIGIHARA.
000040***************************************************
000050*    PROGRAM        : 得意先別受注残帳　　　　    *
000060*    DATA WRITTEN   : 87/08/28                    *
000070*    SCREEN USED    : UNUSED                      *
000080*    FORM   USED    : UNUSED                      *
000090*    PRINTER TYPE   : JIPS                        *
000100*    COMPILE TYPE   : COBOL                       *
000110***************************************************
000120 ENVIRONMENT                    DIVISION.
000130 CONFIGURATION                  SECTION.
000140 SOURCE-COMPUTER.               SYSTEM150.
000150 OBJECT-COMPUTER.               SYSTEM150.
000160 INPUT-OUTPUT                   SECTION.
000170 FILE-CONTROL.
000180     SELECT   JT-WK04   ASSIGN  F1-MSD.                           I.010202
000190*****SELECT   JMST2     ASSIGN  F1-MSD                            D.010202
000200*****                   ORGANIZATION  INDEXED                     D.010202
000210*****                   ACCESS MODE   DYNAMIC                     D.010202
000220*****                   RECORD KEY    JMST2-KEY.                  D.010202
000230     SELECT   TC-M      ASSIGN  F2-MSD
000240                        ORGANIZATION  INDEXED
000250                        ACCESS MODE   RANDOM
000260                        RECORD KEY    TC-KEY.
000270*****SELECT   SHM       ASSIGN  F3-MSD                            D.010818
000280     SELECT   HI2-M     ASSIGN  F3-MSD                            I.010818
000290                        ORGANIZATION  INDEXED
000300                        ACCESS MODE   RANDOM
000310                        RECORD KEY    HI-KEY2.                    I.010818
000320*****                   RECORD KEY    SHM-KEY.                    D.010818
000330     SELECT  P-F        ASSIGN  P1-PRN999.
000340 I-O-CONTROL.
000350*****APPLY   SHARED-MODE ON  JMST2   TC-M    SHM                  D.010202
000360*****APPLY   SHARED-MODE ON  TC-M    SHM                          D.010818
000370     APPLY   SHARED-MODE ON  TC-M    HI2-M                        I.010818
000380     APPLY   SHIFT-CODE  ON  P-F.
000390*
000400*
000410 DATA                       DIVISION.
000420 FILE                       SECTION.
000430*COPY  LJMST2.                                                    D.010202
000440 COPY  LTWK04.                                                    I.010202
000450 COPY  LITCM.
000460 COPY  LIHIM2.                                                    I.010818
000470*COPY  L-SHM.                                                     D.010818
000480 FD  P-F
000490     LABEL  RECORD   OMITTED   LINAGE    66.                      I.930922
000500*****LABEL  RECORD   OMITTED   LINAGE    51.                      D.930922
000510 01  P-R                       PIC X(256).
000520 01  R1-R.
000530     02  R1-K1                 PIC X(05).
000540*****02  F                     PIC X(8).                          D.930922
000550*****02  R1-00                 PIC 9(6).                          D.930922
000560*****02  R1-00R  REDEFINES     R1-00         PIC  X(06).          D.930922
000570     02  R1-00                 PIC 9(4).                          I.930922
000580     02  F                     PIC X.
000590*****02  FILLER                PIC X(15).
000600*****02  R1-01                 PIC N(20).                         D.930922
000610*****02  R1-01                 PIC N(24).                         D.020418
000620     02  R1-01                 PIC N(26).                         I.020418
000630     02  R1-K2                 PIC X(05).
000640 01  R3-R.
000650     02  R3-K1                 PIC X(05).
000660*****02  FILLER                PIC X(24).                         D.930517
000670*****02  R3-01                 PIC N(08).                         D.930517
000680     02  F                     PIC X(02).                         I.930922
000690     02  R3-00                 PIC 9(06).                         I.930922
000700     02  F                     PIC X.                             I.930922
000710     02  R3-01                 PIC N(24).                         I.930922
000720     02  R3-K2                 PIC X(05).
000730 WORKING-STORAGE            SECTION.
000740 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000750 77  WK0256ID           PIC  X(009) VALUE SPACE.                  I.010202
000760 01  STN-NO.                                                      I.010202
000770     02  STN-NO1        PIC  X(003).                              I.010202
000780     02  STN-NO2        PIC  X(003).                              I.010202
000790 01  W-FID.                                                       I.010202
000800     02  W-FID1         PIC  X(006) VALUE "WK0256".               I.010202
000810     02  W-FID2         PIC  X(003).                              I.010202
000820 01  R2.                                                          *R87112
000830     02  R2-R        OCCURS  4.
000840         03  R2-K2             PIC X(05).                         *I 92/07
000850         03  FILLER            PIC X(04).                         I.070410
000860*****    03  FILLER            PIC X(07).                         D.070410
000870*****    03  FILLER            PIC X(15).                         D.930517
000880*****    03  FILLER            PIC X(10).                         D.930922
000890*****    03  FILLER            PIC X(11).                         D.951204
000900*****    03  FILLER            PIC X(12).                         D.980604
000910*****    03  R2-FD             PIC X(01).                         D.930922
000920         03  R2-00             PIC 9(03).                         I.930517
000930         03  F                 PIC X(02).                         I.930922
000940*****    03  R2-RD             PIC X(01).                         D.930922
000950*****    03  R2-01             PIC X(01).                         D.930922
000960         03  R2-021            PIC 9(02).                         I.070410
000970         03  R2-022            PIC X(01).                         I.070410
000980         03  R2-02             PIC 9(02).                         C.930922
000990         03  R2-03             PIC X(01).
001000         03  R2-M.                                                *I 92/07
001010             04  R2-04         PIC 9(02).                         C.930922
001020*****        04  R2-05         PIC X(01).                         D.930922
001030*****        04  R2-A          PIC X(01).                         D.930922
001040*****        04  F             PIC X(02).                         D.951204
001050             04  F             PIC X(01).                         I.951204
001060             04  R2-06         PIC 9(02).                         C.930922
001070             04  R2-B          PIC X(01).                         91.10 A
001080             04  R2-07         PIC 9(02).                         C.930922
001090             04  F             PIC X(01).                         I.951204
001100*****        04  F             PIC X(02).                         D.951204
001110*****        04  R2-C          PIC X(01).                         D.930922
001120*****        04  R2-D          PIC X(01).                         D.930922
001130*****        04  R2-08         PIC 9(06).                         D.930922
001140*****        04  R2-E          PIC X(01).                         D.930922
001150*****        04  R2-09         PIC 9(01).                         D.930922
001160*****        04  R2-F          PIC X(01).                         D.930922
001170*****        04  R2-G          PIC X(01).                         D.930922
001180*****        04  R2-10         PIC ZZZZ.                          D.930922
001190*****        04  R2-H          PIC X(01).                         D.930922
001200         03  R2-MR  REDEFINES  R2-M.                              *I 92/07
001210             04  FILLER        PIC X(01).                         I.930922
001220             04  R2-KEI        PIC N(04).                         I.951204
001230*****        04  FILLER        PIC X(09).                         D.930922
001240*****        04  R2-KEI        PIC N(05).                         D.951204
001250*****        04  FILLER        PIC X(11).                         D.930922
001260         03  R2-08             PIC 9(06).                         I.930922
001270         03  R2-E              PIC X(01).                         I.930922
001280         03  R2-09             PIC 9(01).                         I.930922
001290*****    03  FILLER            PIC X(01).                         D.930922
001300*****    03  FILLER            PIC X(02).                         D.951204
001310         03  FILLER            PIC X(01).                         I.951204
001320         03  R2-16             PIC 9(01).
001330*****    03  FILLER            PIC X(01).                         D.930922
001340         03  R2-17        OCCURS   10.
001350             04  R2-171        PIC ---,---.                       I.930922
001360*****        04  R2-171        PIC ------.                        D.930922
001370*****        04  FILLER        PIC X(01).                         D.930922
001380*****    03  R2-18             PIC -------9.                      D.930922
001390         03  R2-18             PIC ----,--9.                      I.930922
001400         03  FILLER            PIC X(01).                         91.10 A
001410*****    03  R2-K1             PIC X(05).                         D.010202
001420*****    03  R2-21             PIC N(08).                         D.010202
001430*****    03  F                 PIC X(01).                         D.010202
001440         03  F                 PIC X(13).                         I.010202
001450         03  R2-22             PIC X(10).                         I.980604
001460*****    03  R2-10             PIC ZZ,ZZZ.                        D.980604
001470*****    03  R2-19             PIC 9(06).                         D.951204
001480*****    03  R2-I              PIC X(01).                         D.951204
001490*****    03  R2-20             PIC 9(01).                         D.951204
001500*****    03  R2-10             PIC ZZ,ZZZ.                        D.950106
001510*****    03  R2-10             PIC ZZZ,ZZZ.                       D.951204
001520*01  MID1-R.                                                      D.930922
001530*****02  M1-K2                 PIC X(05)  VALUE  ""3FE04FE080"".  D.930922
001540*****02  FILLER                PIC X(20)    VALUE   SPACE.        D.930922
001550*****02  FILLER                PIC N(07)    VALUE                 D.930922
001560*****      NC"得　意　先　名".                                    D.930922
001570*****02  FILLER                PIC X(81)  VALUE  SPACE.           *A871112
001580*****02  M1-SEN                PIC N(05).                         ﾞ
001590*01  MID2-R.                                                      D.930922
001600*****02  M2-K2                 PIC X(05)  VALUE  ""3FE04FE080"".  D.930922
001610*****02  FILLER                PIC X(52)    VALUE   SPACE.        D.930922
001620*****02  FILLER                PIC N(07)    VALUE                 D.930922
001630*****      NC"受　注　残　帳".                                    D.930922
001640*****02  FILLER                PIC X(06)  VALUE  SPACE.           D.930922
001650*****02  M2-SEN                PIC N(05).                         D.930922
001660*****02  FILLER                PIC X(16)    VALUE   SPACE.        D.930922
001670*****02  M2-01                 PIC Z9.                            D.930922
001680*****02  FILLER                PIC X(02)    VALUE   SPACE.        D.930922
001690*****02  M2-02                 PIC Z9.                            D.930922
001700*****02  FILLER                PIC X(02)    VALUE   SPACE.        D.930922
001710*****02  M2-03                 PIC Z9.                            D.930922
001720*****02  FILLER                PIC X(17)    VALUE   SPACE.        D.930922
001730*****02  M2-04                 PIC ZZ9.                           D.930922
001740*01  MID3-R.                                                      D.930922
001750*****02  M3-K1                 PIC X(05)  VALUE  ""3FE04F40A0"".  D.930922
001760*****02  FILLER                PIC X(10)    VALUE   SPACE.        D.930922
001770*****02  M3-01                 PIC 9(04).                         D.930922
001780*****02  FILLER                PIC X(01)    VALUE   SPACE.        D.930922
001790*****02  M3-02                 PIC N(20).                         D.930922
001800*****02  M3-K2                 PIC X(05)  VALUE  ""3FE04FE080"".  D.930922
001810*01  MID4-R.                                                      D.930922
001820*****02  M4-K2                 PIC X(05)  VALUE  ""3FE04FE080"".  D.930922
001830*****02  FILLER                PIC X(20)  VALUE   SPACE.          D.930922
001840*****02  FILLER                PIC N(07)  VALUE                   D.930922
001850*****         NC"品　　　　　名".                                 D.930922
001860*01  MID5-R.                                                      D.930922
001870*****02  M5-K2                 PIC X(05)  VALUE  ""3FE04FE080"".  D.930922
001880*****02  FILLER                PIC X(15)    VALUE   SPACE.        D.930922
001890*****02  FILLER                PIC X(07)    VALUE   "(受 日)".    D.930922
001900*****02  FILLER                PIC X(07)    VALUE   "(出 日)".    D.930922
001910*****02  FILLER                PIC X(10)    VALUE   "(受注№行)". D.930922
001920*****02  FILLER                PIC X(07)    VALUE   "(単 価)".    D.930922
001930*01  MID6-R.                                                      D.930922
001940*****02  M6-K2                 PIC X(05)    VALUE  ""3FE04FE080"".D.930922
001950*****02  FILLER                PIC X(127)   VALUE   SPACE.        D.930922
001960*****02  FILLER                PIC N(04)    VALUE NC"預り№行".   D.930922
001970 01  HEAD1.                                                       I.930922
001980     02  K-2                   PIC X(05)  VALUE  ""3FE04FE080"".  I.930922
001990     02  FILLER                PIC X(32)  VALUE   SPACE.          I.960821
002000*****02  FILLER                PIC X(44)  VALUE   SPACE.          D.960821
002010*****02  FILLER                PIC N(07)  VALUE                   D.950106
002020*****      NC"受　注　残　帳".                                    D.950106
002030*****02  FILLER                PIC N(10)  VALUE                   D.951205
002040*****      NC"受　　注　　残　　帳".                              D.951205
002050     02  FILLER                PIC N(05)  VALUE                   I.951205
002060           NC"得意先別　".                                        I.951205
002070     02  H-PM                  PIC N(03).                         I.951205
002080     02  FILLER                PIC N(03)  VALUE                   I.951205
002090           NC"　残帳".                                            I.951205
002100     02  FILLER                PIC X(02)  VALUE  SPACE.           I.960821
002110     02  H-CHK                 PIC N(05)  VALUE  SPACE.           I.960821
002120     02  FILLER                PIC X(06)  VALUE  SPACE.           I.930922
002130     02  H-SEN                 PIC N(05).                         I.930922
002140     02  FILLER                PIC X(32)  VALUE  SPACE.           I.930922
002150*****02  H-NEN                 PIC Z9.                            D.980527
002160     02  H-NEN                 PIC 9(02).                         I.980527
002170     02  FILLER                PIC N(01)  VALUE  NC"年".          I.930922
002180     02  H-GET                 PIC Z9.                            I.930922
002190     02  FILLER                PIC N(01)  VALUE  NC"月".          I.930922
002200     02  H-PEY                 PIC Z9.                            I.930922
002210     02  FILLER                PIC N(01)  VALUE  NC"日".          I.930922
002220     02  FILLER                PIC X(07)  VALUE  "     P.".       I.930922
002230     02  H-PAGE                PIC ZZ9.                           I.930922
002240*****02  FILLER                PIC X(06)  VALUE  SPACE.           D.950106
002250*****02  FILLER                PIC X(01)  VALUE  SPACE.           D.951205
002260 01  HEAD2.                                                       I.930922
002270     02  K-1                   PIC X(05)  VALUE  ""3FE04F40A0"".  I.930922
002280     02  FILLER                PIC X(05)  VALUE  "ｺｰﾄﾞ ".         I.930922
002290     02  FILLER                PIC N(10)  VALUE                   I.930922
002300           NC"得　　意　　先　　名".                              I.930922
002310     02  FILLER                PIC X(115)  VALUE  SPACE.          I.950106
002320*****02  FILLER                PIC X(114)  VALUE  SPACE.          D.950106
002330 01  HEAD3.                                                       I.930922
002340     02  FILLER                PIC X(09)  VALUE  "   ｺｰﾄﾞ  ".     I.930922
002350     02  FILLER                PIC N(08)  VALUE                   I.930922
002360           NC"品　　　　　名　".                                  I.930922
002370     02  FILLER                PIC X(114)  VALUE  SPACE.          I.950106
002380*****02  FILLER                PIC X(113)  VALUE  SPACE.          D.950106
002390 01  HEAD4.                                                       I.930922
002400*****02  FILLER                PIC X(11)  VALUE  SPACE.           D.951204
002410*****02  FILLER                PIC X(12)  VALUE  SPACE.           D.980604
002420*****02  FILLER                PIC X(07)  VALUE  SPACE.           D.070410
002430     02  FILLER                PIC X(04)  VALUE  SPACE.           I.070410
002440     02  FILLER                PIC N(02)  VALUE  NC"直送".        I.930922
002450     02  FILLER                PIC X(02)  VALUE  SPACE.           I.951204
002460     02  FILLER                PIC X(02)  VALUE  SPACE.           I.070410
002470     02  FILLER                PIC N(04)  VALUE  NC"受注日　".    I.951204
002480     02  FILLER                PIC X(01)  VALUE  SPACE.           I.070410
002490     02  FILLER                PIC N(04)  VALUE  NC"予定日　".    I.951204
002500     02  FILLER                PIC N(06)  VALUE  NC"受注№－行　".I.951204
002510*****02  FILLER                PIC X(01)  VALUE  SPACE.           D.951204
002520*****02  FILLER                PIC N(04)  VALUE  NC"　受注日".    D.951204
002530*****02  FILLER                PIC X(01)  VALUE  SPACE.           D.951204
002540*****02  FILLER                PIC N(04)  VALUE  NC"　予定日".    D.951204
002550*****02  FILLER                PIC X(02)  VALUE  SPACE.           D.951204
002560*****02  FILLER                PIC N(04)  VALUE  NC"　受注№".    D.951204
002570*****02  FILLER                PIC X(01)  VALUE  "-".             I.951204
002580*****02  FILLER                PIC N(02)  VALUE  NC"行　".        D.951204
002590     02  FILLER                PIC X(01)  VALUE  "1".             I.930922
002600     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002610     02  FILLER                PIC N(02)  VALUE  NC"３号".        I.930922
002620     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002630     02  FILLER                PIC N(02)  VALUE  NC"２号".        I.930922
002640     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002650     02  FILLER                PIC N(02)  VALUE  NC"１号".        I.930922
002660     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002670     02  FILLER                PIC N(02)  VALUE  NC"０号".        I.930922
002680     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002690     02  FILLER                PIC N(02)  VALUE  NC"　中".        I.930922
002700     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002710     02  FILLER                PIC N(02)  VALUE  NC"　大".        I.930922
002720     02  FILLER                PIC X(04)  VALUE  SPACE.           I.930922
002730     02  FILLER                PIC N(02)  VALUE  NC"特大".        I.930922
002740     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
002750     02  FILLER                PIC X(04)  VALUE  "28.0".          I.930922
002760     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
002770     02  FILLER                PIC X(04)  VALUE  "29.0".          I.930922
002780     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
002790     02  FILLER                PIC X(04)  VALUE  "30.0".          I.930922
002800     02  FILLER                PIC X(09)  VALUE  SPACE.           I.930922
002810*****02  FILLER                PIC N(04)  VALUE  NC"　預り№".    D.951204
002820*****02  FILLER                PIC X(01)  VALUE  "-".             D.951204
002830*****02  FILLER                PIC N(02)  VALUE  NC"行　".        D.951204
002840*****02  FILLER                PIC X(01)  VALUE  SPACE.           D.950106
002850*****02  FILLER                PIC X(02)  VALUE  SPACE.           D.951204
002860*****02  FILLER                PIC N(04)  VALUE  NC"摘　　要".    D.010202
002870*****02  FILLER                PIC X(07)  VALUE  SPACE.           D.010202
002880     02  FILLER                PIC X(13)  VALUE  SPACE.           I.010202
002890     02  FILLER                PIC N(04)  VALUE  NC"備　　考".    I.980604
002900     02  FILLER                PIC X(04)  VALUE  SPACE.           I.980604
002910*****02  FILLER                PIC X(09)  VALUE  SPACE.           D.980604
002920*****02  FILLER                PIC N(02)  VALUE  NC"単価".        D.980604
002930 01  HEAD5.                                                       I.930922
002940*****02  FILLER                PIC X(40)  VALUE  SPACE.           D.951204
002950*****02  FILLER                PIC X(38)  VALUE  SPACE.           D.980604
002960     02  FILLER                PIC X(33)  VALUE  SPACE.           I.980604
002970     02  FILLER                PIC X(01)  VALUE  "2".             I.930922
002980     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
002990     02  FILLER                PIC X(04)  VALUE  "12.5".          I.930922
003000     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003010     02  FILLER                PIC X(04)  VALUE  "13.0".          I.930922
003020     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003030     02  FILLER                PIC X(04)  VALUE  "13.5".          I.930922
003040     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003050     02  FILLER                PIC X(04)  VALUE  "14.0".          I.930922
003060     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003070     02  FILLER                PIC X(04)  VALUE  "15.0".          I.930922
003080     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003090     02  FILLER                PIC X(04)  VALUE  "16.0".          I.930922
003100     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003110     02  FILLER                PIC X(04)  VALUE  "17.0".          I.930922
003120     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003130     02  FILLER                PIC X(04)  VALUE  "18.0".          I.930922
003140     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003150     02  FILLER                PIC X(04)  VALUE  "19.0".          I.930922
003160     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003170     02  FILLER                PIC X(04)  VALUE  "20.0".          I.930922
003180     02  FILLER                PIC X(32)  VALUE  SPACE.           I.980604
003190*****02  FILLER                PIC X(27)  VALUE  SPACE.           D.980604
003200*****02  FILLER                PIC X(23)  VALUE  SPACE.           D.950106
003210*****02  FILLER                PIC X(24)  VALUE  SPACE.           D.951204
003220 01  HEAD6.                                                       I.930922
003230*****02  FILLER                PIC X(40)  VALUE  SPACE.           D.951204
003240*****02  FILLER                PIC X(38)  VALUE  SPACE.           D.980604
003250     02  FILLER                PIC X(33)  VALUE  SPACE.           I.980604
003260     02  FILLER                PIC X(01)  VALUE  "3".             I.930922
003270     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003280     02  FILLER                PIC X(04)  VALUE  "21.0".          I.930922
003290     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003300     02  FILLER                PIC X(04)  VALUE  "21.5".          I.930922
003310     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003320     02  FILLER                PIC X(04)  VALUE  "22.0".          I.930922
003330     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003340     02  FILLER                PIC X(04)  VALUE  "22.5".          I.930922
003350     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003360     02  FILLER                PIC X(04)  VALUE  "23.0".          I.930922
003370     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003380     02  FILLER                PIC X(04)  VALUE  "23.5".          I.930922
003390     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003400     02  FILLER                PIC X(04)  VALUE  "24.0".          I.930922
003410     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003420     02  FILLER                PIC X(04)  VALUE  "24.5".          I.930922
003430     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003440     02  FILLER                PIC X(04)  VALUE  "25.0".          I.930922
003450     02  FILLER                PIC X(39)  VALUE  SPACE.           I.980604
003460*****02  FILLER                PIC X(34)  VALUE  SPACE.           D.980604
003470*****02  FILLER                PIC X(30)  VALUE  SPACE.           D.950106
003480*****02  FILLER                PIC X(31)  VALUE  SPACE.           D.951204
003490 01  HEAD7.                                                       I.930922
003500*****02  FILLER                PIC X(40)  VALUE  SPACE.           D.951204
003510*****02  FILLER                PIC X(38)  VALUE  SPACE.           D.980604
003520     02  FILLER                PIC X(33)  VALUE  SPACE.           I.980604
003530     02  FILLER                PIC X(01)  VALUE  "4".             I.930922
003540     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003550     02  FILLER                PIC X(04)  VALUE  "24.0".          I.930922
003560     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003570     02  FILLER                PIC X(04)  VALUE  "24.5".          I.930922
003580     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003590     02  FILLER                PIC X(04)  VALUE  "25.0".          I.930922
003600     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003610     02  FILLER                PIC X(04)  VALUE  "25.5".          I.930922
003620     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003630     02  FILLER                PIC X(04)  VALUE  "26.0".          I.930922
003640     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003650     02  FILLER                PIC X(04)  VALUE  "26.5".          I.930922
003660     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003670     02  FILLER                PIC X(04)  VALUE  "27.0".          I.930922
003680     02  FILLER                PIC X(03)  VALUE  SPACE.           I.930922
003690     02  FILLER                PIC X(04)  VALUE  "27.5".          I.930922
003700     02  FILLER                PIC X(19)  VALUE  SPACE.           I.930922
003710     02  FILLER                PIC N(02)  VALUE  NC"合計".        I.930922
003720     02  FILLER                PIC X(24)  VALUE  SPACE.           I.980604
003730*****02  FILLER                PIC X(19)  VALUE  SPACE.           D.980604
003740*****02  FILLER                PIC X(15)  VALUE  SPACE.           D.950106
003750*****02  FILLER                PIC X(16)  VALUE  SPACE.           D.951204
003760 01  ACT-WORK.
003770*****02  W-FROM                PIC 9(04).                         D.010202
003780*****02  W-TO                  PIC 9(04).                         D.010202
003790*****02  W-TST                 PIC 9(01).                         D.930922
003800     02  W-PC                  PIC 9(01).                         I.951205
003810*****02  W-OK                  PIC 9(01).                         D.010202
003820     02  I                     PIC 9(02).
003830     02  TOT                   PIC S9(07).
003840     02  OLD-1                 PIC 9(04).
003850     02  OLD-2                 PIC 9(06).
003860     02  OLD-3                 PIC X(07).                         *R 92/07
003870     02  NEW-1                 PIC 9(04).                         *A871112
003880     02  NEW-2                 PIC 9(06).                         ﾞ
003890     02  CNT                   PIC 9(01).
003900     02  SW1                   PIC 9(01).
003910     02  SW2                   PIC 9(01).
003920     02  W-ZAN                 PIC S9(06).
003930     02  0-CNT     OCCURS  4   PIC  9(02).                        *R871112
003940     02  W-CHK                 PIC  9(01).                        I.960821
003950     02  W-SEN                 PIC  9(01).                        *A871112
003960     02  W-JYU.                                                   ﾞ
003970         03  W-J1              PIC  9(01).                        ﾞ
003980         03  W-J2              PIC  9(05).                        ﾞ
003990     02  N                     PIC  9(01).                        ﾞ
004000     02  CNT-M                 PIC  9(01).                        ﾞ
004010     02  CNT-M1                PIC  9(01).                        ﾞ
004020     02  W-NC                  PIC  9(01).                        ﾞ
004030     02  O-SW1                 PIC  9(01).                        ﾞ
004040     02  O-SW2                 PIC  9(01).                        ﾞ
004050     02  ASW                   PIC  9(01).                        ﾞ
004060     02  J                     PIC  9(01).                        ﾞ
004070     02  W-GC                  PIC  9(01).                        I.930922
004080     02  W-DCC                 PIC  9(01).                        I.930922
004090*****02  W-TEKI.                                                  D.010202
004100*****    03  W-TEKI1           PIC  N(09).                        D.010202
004110*****    03  W-TEKI2           PIC  N(08).                        D.010202
004120*****    03  W-TEKI3           PIC  N(15).                        D.010202
004130 01  W-A.
004140     02  W-AA        OCCURS         4.
004150         03  W-AAA             PIC  S9(06)  OCCURS 10.
004160 01  W-B.
004170     02  W-BB        OCCURS         4.
004180         03  W-BBB             PIC  S9(06)  OCCURS 10.
004190 01  W-AREA.
004200     02  PCNT                  PIC 9(03)   VALUE   0.
004210     02  LCNT                  PIC 9(02)   VALUE  90.
004220*****02  W-KEI                 PIC N(05).                         D.951204
004230     02  W-KEI                 PIC N(04).                         I.951204
004240     02  W-KEY.                                                   *I 92/07
004250         03  W-JNO             PIC 9(06).                         *I 92/07
004260         03  W-GYO             PIC 9(01).                         *I 92/07
004270     02  G-SW                  PIC 9(01).                         *I 92/07
004280 01  WYMD.
004290     02  WYY                   PIC 9(02).
004300     02  WMM                   PIC 9(02).
004310     02  WDD                   PIC 9(02).
004320*01  K-1                     PIC X(05)  VALUE  ""3FE04F40A0"".    D.930922
004330*01  K-2                     PIC X(05)  VALUE  ""3FE04FE080"".    D.930922
004340 COPY    LWMSG.
004350*
004360 SCREEN                  SECTION.
004370 SD  CRT-X
004380     END STATUS  IS  ESTAT.
004390 01  CLE-01          LINE  1.
004400     02  CLEAR   SCREEN.
004410*01  CLE-02.                                                      D.010202
004420*****02  LINE 8  COLUMN  33   VALUE "      ".                     D.951205
004430*****02  LINE 10 COLUMN  33   VALUE "      ".                     D.951205
004440*****02  LINE 15 COLUMN  47   VALUE " ".                          D.930922
004450*****02  LINE 05 COLUMN  60   VALUE " ".                          D.010202
004460*****02  LINE 10 COLUMN  34   VALUE "    ".                       D.010202
004470*****02  LINE 12 COLUMN  34   VALUE "    ".                       D.010202
004480*****02  LINE 16 COLUMN  56   VALUE " ".                          D.010202
004490*****02  LINE 23 COLUMN  61   VALUE " ".                          D.010202
004500*****02  LINE 14 COLUMN  62   VALUE " ".                          D.951205
004510 01  DSP-AREA.
004520     02  DSP-01       LINE 1.
004530*****    03  COLUMN  23  VALUE  "                    " REVERSE.   D.951205
004540*****    03  COLUMN  24  VALUE  NC"得意先別　受注残帳".           D.951205
004550         03  COLUMN  23  VALUE                                    I.951205
004560               "                                    " REVERSE.    I.951205
004570         03  COLUMN  24  VALUE                                    I.951205
004580              NC"得意先別　受注・預り・取よけ　残帳　　（白紙）". I.010202
004590*****         NC"得意先別　受注・預り・取よけ　残帳".             D.010202
004600*****02  DSP-21          LINE 5.                                  D.010202
004610*****    03  COLUMN  21  VALUE  NC"受　注".                       D.010202
004620*****    03  COLUMN  27  VALUE  " = 0 , ".                        D.010202
004630*****    03  COLUMN  34  VALUE  NC"預　り".                       D.010202
004640*****    03  COLUMN  40  VALUE  " = 5 , ".                        D.010202
004650*****    03  COLUMN  47  VALUE  NC"取よけ".                       D.010202
004660*****    03  COLUMN  53  VALUE  " = 6    ".                       D.010202
004670*****02  DSP-22       LINE 8.                                     D.010202
004680*****    03  COLUMN  25  VALUE                                    D.010202
004690*****         "指図含まない = 0  ,  含む = 1    ".                D.010202
004700*****02  DSP-02          LINE 6.                                  D.951205
004710*****02  DSP-02          LINE 8.                                  D.960821
004720*****02  DSP-02          LINE 10.                                 D.010202
004730*****    03  COLUMN  31  VALUE  NC"得意先".                       D.010202
004740*****    03  COLUMN  37  VALUE  "ｺｰﾄﾞ".                           D.010202
004750*****02  DSP-03      LINE   8.                                    D.951205
004760*****02  DSP-03      LINE  10.                                    D.960821
004770*****02  DSP-03      LINE  12.                                    D.010202
004780*****    03  COLUMN  24  VALUE  NC"ＦＲＯＭ".                     D.010202
004790*****02  DSP-04      LINE  10.                                    D.951205
004800*****02  DSP-04      LINE  12.                                    D.960821
004810*****02  DSP-04      LINE  14.                                    D.010202
004820*****    03  COLUMN  24  VALUE  NC"ＴＯ".                         D.010202
004830*****02  DSP-05      LINE  13.                                    D.930922
004840*****    03  COLUMN  24  VALUE  NC"テストプリント印字".           D.930922
004850*****02  DSP-06      LINE  15.                                    D.930922
004860*****    03  COLUMN  34  VALUE  "(YES=1,NO=2)".                   D.930922
004870*****02  DSP-07      LINE  23.                                    D.010202
004880*****    03  COLUMN  41  VALUE  NC"確認（".                       D.010202
004890*****    03  COLUMN  47  VALUE  "OK=1,NO=9".                      D.010202
004900*****    03  COLUMN  56  VALUE  NC"）".                           D.010202
004910*****    03  COLUMN  58  VALUE  "--> ﾘﾀｰﾝ".                       D.010202
004920*****02  DSP-08  LINE 12  COLUMN  51 PIC X(09) VALUE  "０ 教　育".D.010202
004930*****02  DSP-09  LINE 14  COLUMN  51 PIC X(09) VALUE  "１ 一　般".D.010202
004940*****02  DSP-10  LINE 16  COLUMN  51 PIC X(09) VALUE  "２ 全　件".D.010202
004950*****02  DSP-11  LINE 18  COLUMN  52 PIC X(08) VALUE  "選択 [ ]". D.010202
004960*****02  DSP-08  LINE  8  COLUMN  51 PIC X(09) VALUE  "０ 教　育".D.951205
004970*****02  DSP-09  LINE 10  COLUMN  51 PIC X(09) VALUE  "１ 一　般".D.951205
004980*****02  DSP-10  LINE 12  COLUMN  51 PIC X(09) VALUE  "２ 全　件".D.951205
004990*****02  DSP-11  LINE 14  COLUMN  56 PIC X(08) VALUE  "選択 [ ]". D.951205
005000*****02  DSP-08  LINE 10  COLUMN  51 PIC X(09) VALUE  "０ 教　育".D.960821
005010*****02  DSP-09  LINE 12  COLUMN  51 PIC X(09) VALUE  "１ 一　般".D.960821
005020*****02  DSP-10  LINE 14  COLUMN  51 PIC X(09) VALUE  "２ 全　件".D.960821
005030*****02  DSP-11  LINE 16  COLUMN  52 PIC X(08) VALUE  "選択 [ ]". D.960821
005040*01  ACP-AREA.                                                    D.010202
005050*****02  ACP-PC      LINE  5 COLUMN  60  PIC 9(01)                D.010202
005060*****            USING W-PC      CHECK  OVERFLOW  NO  IFC.        D.010202
005070*****02  ACP-CHK     LINE  8 COLUMN  57  PIC 9(01)                D.010202
005080*****            USING W-CHK     CHECK  OVERFLOW  NO  IFC.        D.010202
005090*****02  ACP-FROM    LINE 8  COLUMN  33  PIC 9(04)                D.951205
005100*****02  ACP-FROM    LINE 10 COLUMN  34  PIC 9(04)                D.960821
005110*****02  ACP-FROM    LINE 12 COLUMN  34  PIC 9(04)                D.010202
005120*****            USING  W-FROM    CHECK  OVERFLOW  NO  IFC.       D.010202
005130*****02  ACP-TO      LINE 10 COLUMN  33  PIC 9(04)                D.951205
005140*****02  ACP-TO      LINE 12 COLUMN  34  PIC 9(04)                D.960821
005150*****02  ACP-TO      LINE 14 COLUMN  34  PIC 9(04)                D.010202
005160*****            USING  W-TO      CHECK  OVERFLOW  NO  IFC.       D.010202
005170*****02  ACP-TST     LINE 15 COLUMN  47  PIC 9(01)                D.930922
005180*****            USING  W-TST     CHECK  OVERFLOW  NO  IFC.       D.930922
005190*****02  ACP-OK      LINE 23 COLUMN  61  PIC 9(01)                D.010202
005200*****            INTO  W-OK      CHECK  OVERFLOW  NO  IFC.        D.010202
005210*****02  ACP-SEN     LINE 14 COLUMN  62  PIC 9(01)                D.951205
005220*****02  ACP-SEN     LINE 16 COLUMN  58  PIC 9(01)                D.960821
005230*****02  ACP-SEN     LINE 18 COLUMN  58  PIC 9(01)                D.010202
005240*****            USING W-SEN     CHECK  OVERFLOW  NO  IFC.        D.010202
005250 COPY    LSMSG.
005260*
005270 PROCEDURE               DIVISION.
005280************************************
005290*    メイン　ルーチン              *
005300************************************
005310 HAJIME.
005320     PERFORM   INT-RTN   THRU  INT-EX.
005330 MR005.                                                           I.951205
005340     READ      JT-WK04           AT END                           I.010202
005350         DISPLAY  ERR-02   DISP-BUZ-B                             I.010202
005360         GO  TO  MR999.                                           I.010202
005370     MOVE  WK04-88    TO  W-CHK.                                  I.010202
005380     MOVE  WK04-89    TO  W-PC.                                   I.010202
005390     MOVE  WK04-90    TO  W-SEN.                                  I.010202
005400     CLOSE   JT-WK04.                                             I.010202
005410     OPEN  INPUT   JT-WK04.                                       I.010202
005420*****ACCEPT        ACP-PC.                                        D.010202
005430*****DISPLAY       DISP-MSG-SPACE.                                D.010202
005440*****IF  ESTAT  =  "P9"                                           D.010202
005450*****    GO  TO  MR999.                                           D.010202
005460*****IF ESTAT  NOT  =  "01"   AND    "06"                         D.010202
005470*****   GO  TO  MR005.                                            D.010202
005480*****DISPLAY       ACP-PC.                                        D.010202
005490*****IF  W-PC  NOT  =  0  AND  5  AND  6                          D.010202
005500*****   GO  TO  MR005.                                            D.010202
005510*MR007.                                                           D.010202
005520*****ACCEPT        ACP-CHK.                                       D.010202
005530*****DISPLAY       DISP-MSG-SPACE.                                D.010202
005540*****IF  ESTAT  =  "09"                                           D.010202
005550*****    GO  TO  MR005.                                           D.010202
005560*****IF ESTAT  NOT  =  "01"   AND    "06"                         D.010202
005570*****   GO  TO  MR007.                                            D.010202
005580*****DISPLAY       ACP-CHK.                                       D.010202
005590*****IF  W-CHK  >   1                                             D.010202
005600*****    GO  TO  MR007.                                           D.010202
005610*MR010.                                                           D.010202
005620*****ACCEPT        ACP-FROM.                                      D.010202
005630*****DISPLAY       DISP-MSG-SPACE.                                D.010202
005640*****IF  ESTAT  =  "P9"                                           D.010202
005650*****    GO  TO  MR007.                                           D.010202
005660*****    GO  TO  MR005.                                           D.960821
005670*****    GO  TO  MR999.                                           D.951205
005680*****IF ESTAT  NOT  =  "01"   AND    "06"                         D.010202
005690*****   GO  TO  MR010.                                            D.010202
005700*****DISPLAY       ACP-FROM.                                      D.010202
005710*MR020.                                                           D.010202
005720*****ACCEPT       ACP-TO.                                         D.010202
005730*****DISPLAY      DISP-MSG-SPACE.                                 D.010202
005740*****IF  ESTAT  =  "09"                                           D.010202
005750*****    GO  TO  MR010.                                           D.010202
005760*****IF  ESTAT  NOT  =  "01"   AND    "06"                        D.010202
005770*****    GO  TO  MR020.                                           D.010202
005780*****DISPLAY      ACP-TO.                                         D.010202
005790*****IF  W-FROM   >  W-TO                                         D.010202
005800*****    GO  TO  MR010.                                           D.010202
005810*MR030.                                                           D.930922
005820*****ACCEPT       ACP-TST.                                        D.930922
005830*****DISPLAY      DISP-MSG-SPACE.                                 D.930922
005840*****IF  ESTAT  =  "09"                                           D.930922
005850*****    GO  TO  MR020.                                           D.930922
005860*****IF  ESTAT  NOT  =  "01"   AND    "06"                        D.930922
005870*****    GO  TO  MR030.                                           D.930922
005880*****DISPLAY      ACP-TST.                                        D.930922
005890*****IF  W-TST  NOT  =  "1"   AND    "2"                          D.930922
005900*****    GO  TO  MR030.                                           D.930922
005910*****IF  W-TST    =  1                                            D.930922
005920*****    PERFORM    TST-RTN   THRU     TST-EX                     D.930922
005930*****    GO  TO  MR030.                                           D.930922
005940*MR035.                                                           D.010202
005950*****ACCEPT     ACP-SEN.                                          D.010202
005960*****DISPLAY    DISP-MSG-SPACE.                                   D.010202
005970*****IF  ESTAT  =  "09"                                           D.010202
005980*****    GO  TO  MR020.                                           D.010202
005990*****    GO  TO  MR030.                                           D.930922
006000*****IF  ESTAT  NOT  =  "01"  AND  "06"                           D.010202
006010*****    GO  TO  MR035.                                           D.010202
006020*****IF  W-SEN   NOT  =  0  AND  1  AND  2      GO  TO  MR035.    D.010202
006030*MR040.                                                           D.010202
006040*****ACCEPT     ACP-OK.                                           D.010202
006050*****DISPLAY    DISP-MSG-SPACE.                                   D.010202
006060*****IF  ESTAT  =  "09"                                           D.010202
006070*****    GO  TO  MR035.                                           D.010202
006080*****IF  ESTAT  NOT  =  "01"                                      D.010202
006090*****    GO  TO  MR040.                                           D.010202
006100*****IF  W-OK   NOT  =  "1"   AND      "9"                        D.010202
006110*****    GO  TO  MR040.                                           D.010202
006120*****IF  W-OK        =  "9"                                       D.010202
006130*****    DISPLAY         CLE-02                                   D.010202
006140*****    INITIALIZE   ACT-WORK                                    D.010202
006150*****    GO  TO  MR005.                                           D.010202
006160*****    GO  TO  MR010.                                           D.951205
006170*****MOVE    W-FROM      TO     JMST2-04.                         D.010202
006180*****MOVE    0           TO     JMST2-05.                         D.010202
006190*****MOVE    0           TO     JMST2-06.                         D.010202
006200*****MOVE    0           TO     JMST2-07.                         D.010202
006210*****MOVE    0           TO     JMST2-08.                         D.010202
006220*****MOVE    0           TO     JMST2-09.                         D.010202
006230*****START    JMST2  KEY  NOT  <  JMST2-KEY    INVALID            D.010202
006240*****    GO  TO  MR999.                                           D.010202
006250     IF  W-PC     =  0                                            I.951205
006260         MOVE  NC"受注　"    TO  H-PM.                            I.951205
006270     IF  W-PC     =  5                                            I.951205
006280         MOVE  NC"預り　"    TO  H-PM.                            I.951205
006290     IF  W-PC     =  6                                            I.951205
006300         MOVE  NC"取よけ"    TO  H-PM.                            I.951205
006310     IF  W-CHK    =   1                                           I.960821
006320         MOVE  NC"（指図含）"   TO  H-CHK                         I.960821
006330       ELSE                                                       I.960821
006340         MOVE  ALL  NX"2121"    TO  H-CHK.                        I.960821
006350 MR050.
006360*****MOVE  ZERO       TO  W-GC.                                   D.010202
006370*****READ    JMST2   NEXT   UNLOCK    AT      END                 D.010202
006380     READ    JT-WK04                  AT      END                 I.010202
006390         PERFORM     TOT-RTN     THRU     TOT-EX
006400         PERFORM     GP1-RTN     THRU     GP1-EX
006410         PERFORM     GP2-RTN     THRU     GP2-EX
006420         GO  TO  MR999.
006430     MOVE  WK04-07    TO  W-JNO.                                  I.010202
006440     MOVE  WK04-08    TO  W-GYO.                                  I.010202
006450*****MOVE  JMST2-07   TO  W-JNO.                                  D.010202
006460*****MOVE  JMST2-08   TO  W-GYO.                                  D.010202
006470*****IF  JMST2-01    NOT  =  0  AND  2     GO  TO  MR050.         D.951205
006480*****IF   W-PC    NOT  =  JMST2-01                                D.010202
006490*****     GO  TO  MR050.                                          D.010202
006500*****MOVE  JMST2-07  TO  W-JYU.                                   D.010202
006510*****IF   W-SEN  =  0                                             D.010202
006520*****     IF  W-J1  NOT  =  0 AND 1        GO  TO  MR050.         D.010202
006530*****IF   W-SEN  =  1                                             D.010202
006540*****     IF  W-J1  NOT  =  2 AND 3        GO  TO  MR050.         D.010202
006550*****IF  W-FROM   >  JMST2-04                                     D.010202
006560*****    GO  TO  MR050.                                           D.010202
006570*****IF  W-TO     <  JMST2-04                                     D.010202
006580*****IF  W-TO     <  WK04-04                                      D.010202
006590*****    PERFORM     TOT-RTN     THRU     TOT-EX                  D.010202
006600*****    PERFORM     GP1-RTN     THRU     GP1-EX                  D.010202
006610*****    PERFORM     GP2-RTN     THRU     GP2-EX                  D.010202
006620*****    GO  TO  MR999.                                           D.010202
006630*****IF (JMST2-04  NOT  =   OLD-1)  OR  (CNT  =  0)               D.010202
006640     IF (WK04-04  NOT   =   OLD-1)  OR  (CNT  =  0)               I.010202
006650         PERFORM  TOT-RTN  THRU   TOT-EX
006660         PERFORM     GP1-RTN     THRU     GP1-EX
006670         PERFORM     GP2-RTN     THRU     GP2-EX
006680         MOVE     1   TO   CNT-M                                  *A871112
006690         GO  TO  MR060.
006700*****IF  JMST2-05  NOT  =   OLD-2                                 D.010202
006710     IF  WK04-05  NOT   =   OLD-2                                 I.010202
006720         PERFORM  TOT-RTN  THRU   TOT-EX
006730         PERFORM     GP1-RTN     THRU     GP1-EX
006740         MOVE  1  TO  CNT-M1                                      *A871112
006750         GO  TO  MR060.
006760*****IF  JMST2-07  NOT  =   OLD-3                                 *D 92/07
006770     IF  W-KEY     NOT  =   OLD-3                                 *I 92/07
006780         PERFORM  TOT-RTN  THRU   TOT-EX
006790         GO  TO  MR060.
006800     IF  N  >    4                                                *A871112
006810         PERFORM  TOT-RTN  THRU  TOT-EX.                          ﾞ
006820 MR060.
006830     PERFORM     MOV-RTN    THRU   MOV-EX.
006840     GO  TO  MR050.
006850 MR999.
006860     PERFORM     END-RTN    THRU   END-EX.
006870     STOP  RUN.
006880*********************************************
006890*    ＩＮＴ－ＲＴＮ                         *
006900*********************************************
006910 INT-RTN.
006920     INITIALIZE     ACT-WORK    R2.
006930     MOVE     ZERO    TO   W-A   W-B  G-SW.                       *R 92/07
006940     ACCEPT         WYMD        FROM     DATE.
006950     DISPLAY        CLE-01      DSP-AREA.
006960*****OPEN  INPUT   JMST2    TC-M       SHM                        D.010202
006970     CALL "CBLSTNNO" USING STN-NO.                                I.010202
006980     MOVE STN-NO2 TO W-FID2.                                      I.010202
006990     MOVE W-FID TO WK0256ID.                                      I.010202
007000*****OPEN  INPUT   JT-WK04  TC-M       SHM                        D.010818
007010     OPEN  INPUT   JT-WK04  TC-M       HI2-M                      I.010818
007020     OPEN  OUTPUT  P-F.
007030 INT-EX.
007040     EXIT.
007050*********************************************
007060*    ＥＮＤ－ＲＴＮ                         *
007070*********************************************
007080 END-RTN.
007090*****CLOSE  JMST2   TC-M    SHM     P-F.                          D.010202
007100*****CLOSE  JT-WK04 TC-M    SHM     P-F.                          D.010818
007110     CLOSE  JT-WK04 TC-M    HI2-M   P-F.                          I.010818
007120     DISPLAY CLE-01.
007130 END-EX.
007140     EXIT.
007150**********************************************
007160*    ＨＥＤ－ＲＴＮ                          *
007170**********************************************
007180*HED-RTN.                                                         D.980527
007190*****MOVE   JMST2-03  TO    SHM-01   M3-01.
007200*****READ   SHM    UNLOCK   INVALID
007210*****    MOVE   ALL NX"2121"  TO    SHM-02.
007220*****MOVE   SHM-02    TO    M3-02.
007230*****MOVE   JMST2-04  TO    TC-TCD   M3-01.                       D.930922
007240*****MOVE 001 TO TC-CCD.                                          D.930922
007250*****READ   TC-M    UNLOCK   INVALID                              D.930922
007260*****    MOVE   ALL NX"2121"  TO    TC-NAME.                      D.930922
007270*****MOVE   TC-NAME   TO    M3-02.                                D.930922
007280 HED-010.
007290     MOVE   SPACE     TO  P-R.
007300     IF     LCNT      NOT     =    90
007310         WRITE    P-R     AFTER    PAGE.
007320     ADD    1         TO  PCNT.
007330     IF    W-SEN      =   0                                       I.930922
007340           MOVE  NC"【教　育】"   TO  H-SEN.                      I.930922
007350     IF    W-SEN      =   1                                       I.930922
007360           MOVE  NC"【一　般】"   TO  H-SEN.                      I.070420
007370*****      MOVE  NC"【ワーク】"   TO  H-SEN.                      D.070420
007380*****      MOVE  NC"【一　般】"   TO  H-SEN.                      D.030728
007390*****IF    W-SEN      =   2                                       D.070420
007400*****      MOVE  NC"【カジュ】"   TO  H-SEN.                      D.070420
007410     IF    W-SEN      =   9                                       I.030728
007420           MOVE  ALL  NX"2121"    TO  H-SEN.                      I.930922
007430     MOVE   WYY       TO  H-NEN.                                  I.930922
007440     MOVE   WMM       TO  H-GET.                                  I.930922
007450     MOVE   WDD       TO  H-PEY.                                  I.930922
007460     MOVE   PCNT      TO  H-PAGE.                                 I.930922
007470*****MOVE   MID1-R    TO  P-R.                                    D.930922
007480     MOVE   HEAD1     TO  P-R.                                    I.930922
007490     WRITE     P-R    AFTER   1.
007500     MOVE   SPACE    TO  P-R.
007510*****IF    W-SEN      =   0                                       D.930922
007520*****      MOVE  NC"【教　育】"   TO  M2-SEN.                     D.930922
007530*****IF    W-SEN      =   1                                       D.930922
007540*****      MOVE  NC"【一　般】"   TO  M2-SEN.                     D.930922
007550*****IF    W-SEN      =   2                                       D.930922
007560*****      MOVE  ALL  NX"2121"    TO  M2-SEN.                     D.930922
007570*****MOVE   WYY       TO  M2-01.                                  D.930922
007580*****MOVE   WMM       TO  M2-02.                                  D.930922
007590*****MOVE   WDD       TO  M2-03.                                  D.930922
007600*****MOVE   PCNT      TO  M2-04.                                  D.930922
007610*****MOVE   MID2-R    TO  P-R.                                    D.930922
007620     MOVE   HEAD2     TO  P-R.                                    I.930922
007630     WRITE     P-R    AFTER   1.
007640     MOVE   SPACE    TO  P-R.
007650*****MOVE   MID3-R    TO  P-R.                                    D.930922
007660     MOVE   HEAD3     TO  P-R.                                    I.930922
007670     WRITE     P-R    AFTER   1.
007680     MOVE   SPACE    TO  P-R.
007690*****MOVE   MID4-R    TO  P-R.                                    D.930922
007700     MOVE   HEAD4     TO  P-R.                                    I.930922
007710     WRITE     P-R    AFTER   1.
007720     MOVE   SPACE    TO  P-R.
007730     MOVE   HEAD5     TO  P-R.                                    I.930922
007740*****MOVE   MID5-R    TO  P-R.                                    D.930922
007750*****WRITE     P-R    AFTER   2.                                  D.930922
007760     WRITE     P-R    AFTER   1.                                  I.930922
007770     MOVE   SPACE    TO  P-R.
007780*****MOVE   MID6-R    TO  P-R.                                    D.930922
007790     MOVE   HEAD6     TO  P-R.                                    I.930922
007800     WRITE     P-R    AFTER   1.                                  91.10 A
007810     MOVE   SPACE    TO  P-R.                                     91.10 A
007820     MOVE   HEAD7     TO  P-R.                                    I.930922
007830     WRITE     P-R    AFTER   1.                                  I.930922
007840     MOVE   SPACE    TO  P-R.                                     I.930922
007850     MOVE   8        TO  LCNT.
007860 HED-EX.
007870     EXIT.
007880***************************************************
007890*    ＴＣＭ－ＲＴＮ                               *
007900***************************************************
007910 TCM-RTN.                                                         I.930922
007920*****IF  LCNT    NOT <  58                                        D.070410
007930     IF  LCNT    NOT <  60                                        I.070410
007940             PERFORM     HED-010  THRU  HED-EX.                   I.930922
007950     MOVE   SPACE    TO  P-R.                                     I.930922
007960     MOVE   K-1      TO  R1-K1.                                   I.930922
007970     MOVE   K-2      TO  R1-K2.                                   I.930922
007980     MOVE   OLD-1    TO    TC-TCD   R1-00.                        I.930922
007990     MOVE 001 TO TC-CCD.                                          I.930922
008000     READ   TC-M    UNLOCK   INVALID                              I.930922
008010         MOVE   ALL NX"2121"  TO    TC-NAME.                      I.930922
008020     MOVE   TC-NAME   TO    R1-01.                                I.930922
008030     WRITE     P-R    AFTER   1.                                  I.930922
008040     MOVE   SPACE    TO  P-R.                                     I.930922
008050     ADD    1        TO  LCNT.                                    I.930922
008060 TCM-EX.                                                          I.930922
008070     EXIT.                                                        I.930922
008080***************************************************
008090*    ＨＩＭ－ＲＴＮ                               *
008100***************************************************
008110*SHM-RTN.                                                         D.010818
008120 HIM-RTN.                                                         I.010818
008130*****IF  LCNT    NOT <  59                                        D.070410
008140     IF  LCNT    NOT <  61                                        I.070410
008150             PERFORM     HED-010  THRU  HED-EX                    I.930922
008160             PERFORM     TCM-RTN  THRU  TCM-EX.                   I.930922
008170     MOVE   SPACE    TO  P-R.                                     I.930922
008180     MOVE   K-1      TO  R3-K1.                                   I.930922
008190     MOVE   K-2      TO  R3-K2.                                   I.930922
008200*****MOVE   OLD-2    TO    SHM-01   R3-00.                        D.010818
008210*****READ   SHM    UNLOCK   INVALID                               D.010818
008220*****    MOVE   ALL NX"2121"  TO    SHM-02.                       D.010818
008230*****MOVE   SHM-02    TO    R3-01.                                D.010818
008240     MOVE   OLD-2    TO    HI-MHCD HI-HCD   R3-00.                I.010818
008250     READ   HI2-M  UNLOCK   INVALID                               I.010818
008260         MOVE   ALL NX"2121"  TO    HI-NAME.                      I.010818
008270     MOVE   HI-NAME   TO    R3-01.                                I.010818
008280     WRITE     P-R    AFTER   1.                                  I.930922
008290     MOVE   SPACE    TO  P-R.                                     I.930922
008300     ADD    1        TO  LCNT.                                    I.930922
008310*SHM-EX.                                                          D.010818
008320 HIM-EX.                                                          I.010818
008330     EXIT.                                                        I.930922
008340***************************************************
008350*    ＴＳＴ－ＲＴＮ                               *
008360***************************************************
008370*TST-RTN.                                                         D.930922
008380*****MOVE    SPACE   TO  P-R.                                     D.930922
008390*****IF   LCNT   NOT   =     90                                   D.930922
008400*****    WRITE   P-R     AFTER    PAGE.                           D.930922
008410*****MOVE   MID1-R  TO  P-R.                                      D.930922
008420*****WRITE  P-R     AFTER   1.                                    D.930922
008430*****MOVE   SPACE   TO  P-R.                                      D.930922
008440*****MOVE   "99"    TO  M2-01.                                    D.930922
008450*****MOVE   "99"    TO  M2-02.                                    D.930922
008460*****MOVE   "99"    TO  M2-03.                                    D.930922
008470*****MOVE   "999"   TO  M2-04.                                    D.930922
008480*****MOVE   MID2-R  TO  P-R.                                      D.930922
008490*****WRITE  P-R     AFTER   1.                                    D.930922
008500*****MOVE   SPACE   TO  P-R.                                      D.930922
008510*****MOVE   ALL "9"      TO  M3-01.                               D.930922
008520*****MOVE   ALL NC"Ｎ"   TO  M3-02.                               D.930922
008530*****MOVE   MID3-R  TO  P-R.                                      D.930922
008540*****WRITE  P-R     AFTER   1.                                    D.930922
008550*****MOVE   SPACE   TO  P-R.                                      D.930922
008560*****MOVE   MID4-R  TO  P-R.                                      D.930922
008570*****WRITE  P-R     AFTER   1.                                    D.930922
008580*****MOVE   SPACE   TO  P-R.                                      D.930922
008590*****MOVE   MID5-R  TO  P-R.                                      D.930922
008600*****WRITE  P-R     AFTER   2.                                    D.930922
008610*****MOVE   SPACE   TO  P-R.                                      D.930922
008620*****MOVE   MID6-R  TO  P-R.                                      D.930922
008630*****WRITE   P-R     AFTER     1.                                 D.930922
008640*****MOVE   SPACE   TO  P-R.                                      D.930922
008650*****MOVE   8       TO  LCNT.                                     D.930922
008660*****MOVE    "("     TO    R2-01(1).                              D.930922
008670*****MOVE    "99"    TO    R2-02(1).                              D.930922
008680*****MOVE    "/"     TO    R2-03(1).                              D.930922
008690*****MOVE    "99"    TO    R2-04(1).                              D.930922
008700*****MOVE    ")"     TO    R2-05(1).                              D.930922
008710*****MOVE    "("     TO    R2-A(1)  R2-D(1)  R2-G(1).             D.930922
008720*****MOVE    ")"     TO    R2-C(1)  R2-F(1)  R2-H(1).             D.930922
008730*****MOVE    "-"     TO    R2-E(1)  R2-I(1).                      D.930922
008740*****MOVE    "/"     TO    R2-B(1).                               D.930922
008750*****MOVE ALL "9"    TO    R2-06(1).                              D.930922
008760*****MOVE ALL "9"    TO    R2-07(1).                              D.930922
008770*****MOVE ALL "9"    TO    R2-08(1).                              D.930922
008780*****MOVE ALL "9"    TO    R2-09(1).                              D.930922
008790*****MOVE ALL "9"    TO    R2-10(1).                              D.930922
008800*****MOVE ALL "9"    TO    R2-16(1).                              D.930922
008810*****MOVE ALL "9"    TO    R2-19(1).                              D.930922
008820*****MOVE ALL "9"    TO    R2-20(1).                              D.930922
008830*****MOVE    0       TO    I.                                     D.930922
008840*TST-010.                                                         D.930922
008850*****ADD     1       TO    I.                                     D.930922
008860*****IF      I       >     10                                     D.930922
008870*****    GO  TO  TST-020.                                         D.930922
008880*****MOVE  ALL "9"   TO    R2-171(1 , I).                         D.930922
008890*****GO  TO  TST-010.                                             D.930922
008900*TST-020.                                                         D.930922
008910*****MOVE  ALL "9"   TO    R2-18(1).                              D.930922
008920*TST-030.                                                         D.930922
008930*****MOVE  K-2       TO    R2-K2(1).                              D.930922
008940*****MOVE  R2-R(1)   TO    P-R.                                   D.930922
008950*****WRITE   P-R     AFTER     1.                                 D.930922
008960*****ADD     1       TO  LCNT.                                    D.930922
008970*****IF    LCNT   NOT   =    49                                   D.930922
008980*****    GO  TO  TST-030.                                         D.930922
008990*****MOVE SPACE      TO  P-R.                                     D.930922
009000*TST-EX.                                                          D.930922
009010*****EXIT.                                                        D.930922
009020***************************************************
009030*    ＭＯＶ－ＲＴＮ                               *
009040***************************************************
009050 MOV-RTN.
009060     IF    N  =    0                                              *A871112
009070           MOVE    1  TO  N.                                      ﾞ
009080     MOVE  SPACE     TO  R2-R(N).                                 *R871112
009090*****MOVE  SPACE     TO  R2-21(N).                                D.010202
009100     IF  N     =    1                                             *R871112
009110           GO  TO  MOV-020.
009120     GO  TO  MOV-030.
009130 MOV-020.
009140     IF  WK04-10  NOT   =  001                                    I.010202
009150         MOVE  WK04-10     TO    R2-00(N).                        I.010202
009160*****IF  JMST2-10  NOT  =  001                                    D.010202
009170*****    MOVE  "["         TO    R2-FD(N)                         D.930922
009180*****    MOVE  JMST2-10    TO    R2-00(N).                        D.010202
009190*****    MOVE  "]"         TO    R2-RD(N).                        D.930922
009200*****MOVE     "("       TO     R2-01(N).                          D.930922
009210*****MOVE   JMST2-022   TO     R2-02(N).                          D.010202
009220     MOVE   WK04-021    TO     R2-021(N).                         I.070410
009230     MOVE   WK04-022    TO     R2-02(N).                          I.010202
009240*****MOVE     "/"       TO     R2-03(N).                          D.070410
009250     MOVE     "/"       TO     R2-03(N) R2-022(N).                I.070410
009260     MOVE   WK04-023    TO     R2-04(N).                          I.010202
009270*****MOVE   JMST2-023   TO     R2-04(N).                          D.010202
009280*****MOVE     ")"       TO     R2-05(N).                          D.930922
009290*****MOVE     ")"       TO     R2-C(N)  R2-F(N)  R2-H(N).         D.930922
009300*****MOVE     "("       TO     R2-A(N)  R2-D(N)  R2-G(N).         D.930922
009310*****MOVE     "/"       TO     R2-B(N).                           D.930922
009320     MOVE     "-"       TO     R2-E(N).                           91.10 A
009330*****MOVE   JMST2-062   TO     R2-06(N).                          D.930922
009340*****MOVE   JMST2-063   TO     R2-07(N).                          D.930922
009350*****IF  JMST2-06       NOT  =  ZERO                              D.010202
009360     IF  WK04-06       NOT   =  ZERO                              I.010202
009370         MOVE     "/"       TO     R2-B(N)                        I.930922
009380         MOVE   WK04-062    TO     R2-06(N)                       I.010202
009390         MOVE   WK04-063    TO     R2-07(N).                      I.010202
009400     MOVE   WK04-07     TO     R2-08(N).                          I.010202
009410     MOVE   WK04-08     TO     R2-09(N).                          I.010202
009420     MOVE   WK04-22     TO     R2-22(N).                          I.010202
009430*****    MOVE   JMST2-062   TO     R2-06(N)                       D.010202
009440*****    MOVE   JMST2-063   TO     R2-07(N).                      D.010202
009450*****MOVE   JMST2-07    TO     R2-08(N).                          D.010202
009460*****MOVE   JMST2-08    TO     R2-09(N).                          D.010202
009470*****MOVE   JMST2-17    TO     R2-10(N).                          D.980604
009480*****IF  JMST2-01  =  2                                           D.951204
009490*****    MOVE    "-"        TO     R2-I(1)                        D.951204
009500*****    MOVE   JMST2-191   TO     R2-19(N)                       D.951204
009510*****    MOVE   JMST2-192   TO     R2-20(N).                      D.951204
009520*****MOVE   JMST2-13  TO  W-TEKI.                                 D.010202
009530*****MOVE   W-TEKI2   TO  R2-21(N).                               D.010202
009540*****MOVE   JMST2-22    TO     R2-22(N).                          D.010202
009550 MOV-030.
009560*****MOVE   JMST2-09  TO  R2-16(N).                               D.010202
009570     MOVE   WK04-09   TO  R2-16(N).                               I.010202
009580     MOVE   0       TO  I.
009590 MOV-040.
009600     ADD    1       TO  I.
009610     IF     I       >   10
009620         GO  TO  MOV-050.
009630*****COMPUTE W-ZAN = JMST2-1111(I) - JMST2-141(I) - JMST2-1211(I).D.960821
009640     IF     W-CHK   =   0                                         I.960821
009650*****       COMPUTE  W-ZAN  =  JMST2-1111(I)  -  JMST2-141(I)     D.010202
009660*****                                         -  JMST2-1211(I)    D.010202
009670            COMPUTE  W-ZAN  =  WK04-1111(I)  -  WK04-141(I)       I.010202
009680                                             -  WK04-1211(I)      I.010202
009690         ELSE                                                     I.960821
009700            COMPUTE  W-ZAN  =  WK04-1111(I)  -  WK04-141(I)       I.010202
009710                            -  WK04-1211(I)  -  WK04-151(I).      I.010202
009720*****       COMPUTE  W-ZAN  =  JMST2-1111(I)  -  JMST2-141(I)     D.010202
009730*****                       -  JMST2-1211(I)  -  JMST2-151(I).    D.010202
009740     MOVE    W-ZAN       TO   R2-171(N , I).                      *R871112
009750     ADD     W-ZAN       TO         TOT.
009760*****IF  JMST2-09     =        1                                  D.010202
009770     IF  WK04-09      =        1                                  I.010202
009780           ADD   W-ZAN   TO    W-AAA(1 , I)   W-BBB(1 , I)
009790           IF    SW1        <        1
009800                 MOVE       1        TO       SW1
009810           IF    SW2        <        1
009820                 MOVE       1        TO       SW2.
009830*****IF  JMST2-09     =        2                                  D.010202
009840     IF  WK04-09      =        2                                  I.010202
009850           ADD   W-ZAN   TO    W-AAA(2 , I)   W-BBB(2 , I)
009860           IF    SW1        <        2
009870                 MOVE       2        TO       SW1
009880           IF    SW2        <        2
009890                 MOVE       2        TO       SW2.
009900*****IF  JMST2-09     =        3                                  D.010202
009910     IF  WK04-09      =        3                                  I.010202
009920           ADD   W-ZAN   TO    W-AAA(3 , I)   W-BBB(3 , I)
009930           IF    SW1        <        3
009940                 MOVE       3        TO       SW1
009950           IF    SW2        <        3
009960                 MOVE       3        TO       SW2.
009970*****IF  JMST2-09     =        4                                  D.010202
009980     IF  WK04-09      =        4                                  I.010202
009990           ADD   W-ZAN   TO    W-AAA(4 , I)   W-BBB(4 , I)
010000           MOVE       4        TO       SW1   SW2.
010010     IF  W-ZAN        =        0                                  A 621019
010020           ADD     1     TO    0-CNT(N).                          A 621019
010030     MOVE    0     TO   W-ZAN.
010040     GO  TO  MOV-040.
010050 MOV-050.
010060     IF     0-CNT(N)   =    10
010070            MOVE    0  TO   0-CNT(N)
010080            MOVE   O-SW1   TO   SW1                               ﾞ
010090            MOVE   O-SW2   TO   SW2                               ﾞ
010100            GO  TO  MOV-EX.
010110*****MOVE   JMST2-04   TO  OLD-1.                                 D.010202
010120*****MOVE   JMST2-05   TO  OLD-2.                                 D.010202
010130     MOVE   WK04-04    TO  OLD-1.                                 I.010202
010140     MOVE   WK04-05    TO  OLD-2.                                 I.010202
010150     MOVE   W-KEY      TO  OLD-3                                  *R 92/07
010160     MOVE     1        TO   CNT.
010170     ADD      1        TO   N.                                    *A871112
010180     MOVE     SW1   TO   O-SW1.                                   ﾞ
010190     MOVE     SW2   TO   O-SW2.                                   ﾞ
010200 MOV-EX.
010210     EXIT.
010220***************************************************
010230*    ＴＯＴーＲＴＮ                               *
010240***************************************************
010250 TOT-RTN.
010260     IF  CNT      =       0
010270         GO  TO  TOT-EX.
010280     IF  W-GC     =       1                                       I.930922
010290         IF  W-DCC       NOT  =  9                                I.930922
010300             MOVE   SPACE     TO     P-R                          I.930922
010310             GO     TO    TOT-030.                                I.930922
010320     IF  N        =       1             GO  TO  TOT-EX.
010330     COMPUTE   N  =  N   -   1.
010340     IF  TOT      =       ZERO                                    *A871112
010350               IF    R2-R(N)   =   SPACE
010360                     MOVE    0    TO  N                           ﾞ
010370                     GO  TO  TOT-EX.
010380     IF  (CNT-M       =  1)  OR  (LCNT  =  90)                    ﾞ
010390             PERFORM  TCM-RTN  THRU  TCM-EX                       I.930922
010400             MOVE   1        TO  CNT-M1.                          I.930922
010410*****        MOVE  JMST2-04  TO  NEW-1                            D.930922
010420*****        MOVE  OLD-1  TO  JMST2-04                            D.930922
010430*****        PERFORM  HED-RTN  THRU  HED-EX                       D.930922
010440*****        MOVE  NEW-1    TO  JMST2-04.                         D.930922
010450     IF  (CNT-M1      =  1)  OR  (LCNT  =  8)                     ﾞ
010460             IF    W-GC      =   0                                I.930922
010470                   PERFORM  HIM-RTN  THRU  HIM-EX.                I.010818
010480*****              PERFORM  SHM-RTN  THRU  SHM-EX.                D.010818
010490*****        MOVE  JMST2-04  TO  NEW-1                            D.930922
010500*****        MOVE  OLD-1     TO  JMST2-04                         D.930922
010510*****        MOVE  JMST2-05  TO  NEW-2                            D.930922
010520*****        MOVE  OLD-2  TO  JMST2-05                            D.930922
010530*****        PERFORM  MOV1-RTN  THRU  MOV1-EX                     D.930922
010540*****        MOVE  NEW-1    TO  JMST2-04                          D.930922
010550*****        MOVE  NEW-2    TO  JMST2-05.                         D.930922
010560     MOVE   N    TO     W-NC.                                     ﾞ
010570     MOVE   0    TO     N.                                        ﾞ
010580 TOT-010.                                                         ﾞ
010590     ADD    1  TO    N.                                           ﾞ
010600     IF     N  =  W-NC                     GO  TO  TOT-020.       ﾞ
010610     IF     0-CNT(N)  =   10          MOVE  0  TO  0-CNT(N)       ﾞ
010620                                      GO  TO  TOT-010.            ﾞ
010630*****IF  LCNT    NOT <  49                                        D.930922
010640*****IF  LCNT    NOT <  60                                        D.070410
010650     IF  LCNT    NOT <  62                                        I.070410
010660             PERFORM     HED-010  THRU  HED-EX                    ﾞ
010670             PERFORM  TCM-RTN  THRU  TCM-EX                       I.930922
010680             IF    W-GC      =   0                                I.930922
010690                   PERFORM  HIM-RTN  THRU  HIM-EX.                I.010818
010700*****              PERFORM  SHM-RTN  THRU  SHM-EX.                D.010818
010710*****        MOVE  JMST2-05  TO  NEW-2                            D.930922
010720*****        MOVE  OLD-2  TO  JMST2-05                            D.930922
010730*****        PERFORM  MOV1-RTN  THRU  MOV1-EX                     D.930922
010740*****        MOVE  NEW-2    TO  JMST2-05.                         D.930922
010750     MOVE SPACE  TO  P-R.                                         ﾞ
010760     MOVE K-2    TO  R2-K2(N).                                    *I 92/07
010770*****MOVE K-1    TO  R2-K1(N).                                    D.010202
010780     MOVE    R2-R(N)  TO  P-R.                                    ﾞ
010790     WRITE   P-R  AFTER 1.                                        ﾞ
010800     MOVE    SPACE TO  P-R.                                       ﾞ
010810     ADD     1       TO  LCNT.                                    ﾞ
010820     MOVE    0       TO  0-CNT(N).                                ﾞ
010830     IF      W-DCC   =   5                                        I.930922
010840             MOVE    9        TO  W-DCC.                          I.930922
010850     IF      W-DCC   =   0                                        I.930922
010860             MOVE    5        TO  W-DCC.                          I.930922
010870     GO  TO  TOT-010.                                             ﾞ
010880 TOT-020.                                                         ﾞ
010890*****IF  LCNT    NOT <  49                                        D.930922
010900*****IF  LCNT    NOT <  60                                        D.070410
010910     IF  LCNT    NOT <  62                                        I.070410
010920             PERFORM     HED-010  THRU  HED-EX                    ﾞ
010930             PERFORM  TCM-RTN  THRU  TCM-EX                       I.930922
010940             IF    W-GC      =   0                                I.930922
010950                   PERFORM  HIM-RTN  THRU  HIM-EX.                I.010818
010960*****              PERFORM  SHM-RTN  THRU  SHM-EX.                D.010818
010970*****        MOVE  JMST2-05  TO  NEW-2                            D.930922
010980*****        MOVE  OLD-2  TO  JMST2-05                            D.930922
010990*****        PERFORM  MOV1-RTN  THRU  MOV1-EX                     D.930922
011000*****        MOVE  NEW-2    TO  JMST2-05.                         D.930922
011010     MOVE       TOT     TO    R2-18(N).                           *R871112
011020     MOVE     SPACE      TO    P-R.                               ﾞ
011030     MOVE     K-2        TO    R2-K2(N).                          *I 92/07
011040*****MOVE K-1    TO  R2-K1(N).                                    D.010202
011050     MOVE     R2-R(N)    TO    P-R.                               ﾞ
011060 TOT-030.                                                         I.930922
011070     WRITE    P-R     AFTER      1.                               ﾞ
011080     MOVE     SPACE      TO    P-R.
011090*****WRITE    P-R     AFTER      1.
011100     IF      W-DCC   =   5                                        I.930922
011110             MOVE    9        TO  W-DCC.                          I.930922
011120     IF      W-DCC   =   0                                        I.930922
011130             MOVE    5        TO  W-DCC.                          I.930922
011140     ADD      1          TO    LCNT.
011150     MOVE    0       TO  0-CNT(N).                                ﾞ
011160     MOVE     0          TO     TOT     N   CNT-M  CNT-M1.        *R871112
011170     IF      W-GC    =   1                                        I.930922
011180             MOVE    0         TO  W-DCC.                         I.930922
011190 TOT-EX.
011200***************************************************
011210*    ＧＰ１－ＲＴＮ                               *
011220***************************************************
011230 GP1-RTN.
011240     IF  CNT      =       0
011250         GO  TO  GP1-120.
011260*****MOVE NC"小　　　計"  TO     W-KEI.                           D.951204
011270     MOVE NC"　小　計"  TO     W-KEI.                             I.951204
011280     MOVE  SPACE        TO     R2.                                ﾞ
011290     MOVE     1      TO  J  N.                                    *A
011300     PERFORM  MZA-RTN  THRU  MZA-EX.                              ﾞ
011310     IF       ASW    =   1           GO  TO  GP1-030.             ﾞ
011320     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
011330     MOVE   SPACE   TO     W-KEI.
011340     MOVE   1       TO     R2-16(N).
011350     MOVE   0       TO     I.
011360 GP1-010.
011370     ADD    1       TO     I.
011380     IF     I       >      10
011390        ADD  1  TO    N                                           *A871112
011400        GO  TO  GP1-020.
011410     MOVE   W-AAA(1 , I)  TO     R2-171(N , I).
011420     ADD    W-AAA(1 , I)  TO     TOT.
011430     GO  TO  GP1-010.
011440 GP1-020.
011450     IF     SW1       =       1
011460            MOVE   1       TO    W-GC                             I.930922
011470*****       PERFORM   SYG-RTN   THRU     SYG-EX                   D.930922
011480            PERFORM   TOT-RTN   THRU     TOT-EX
011490            GO  TO    GP1-120.
011500 GP1-030.
011510     MOVE     2      TO  J.                                       ﾞ
011520     PERFORM  MZA-RTN  THRU  MZA-EX.                              ﾞ
011530     IF       ASW    =   1           GO  TO  GP1-060.             ﾞ
011540     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
011550     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
011560     MOVE   2       TO     R2-16(N).
011570     MOVE   0       TO     I.
011580 GP1-040.
011590     ADD    1       TO     I.
011600     IF     I       >      10
011610        ADD  1  TO    N                                           *A871112
011620        GO  TO  GP1-050.
011630     MOVE   W-AAA(2 , I)  TO     R2-171(N , I).
011640     ADD    W-AAA(2 , I)  TO     TOT.
011650     GO  TO  GP1-040.
011660 GP1-050.
011670     IF     SW1       =       2
011680            MOVE   1       TO    W-GC                             I.930922
011690*****       PERFORM   SYG-RTN   THRU     SYG-EX                   D.930922
011700            PERFORM   TOT-RTN   THRU     TOT-EX
011710            GO  TO    GP1-120.
011720 GP1-060.
011730     MOVE     3      TO  J.                                       ﾞ
011740     PERFORM  MZA-RTN  THRU  MZA-EX.                              ﾞ
011750     IF       ASW    =   1           GO  TO  GP1-090.             ﾞ
011760     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
011770     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
011780     MOVE   3       TO     R2-16(N).
011790     MOVE   0       TO     I.
011800 GP1-070.
011810     ADD    1       TO     I.
011820     IF     I       >      10
011830        ADD  1  TO    N                                           *A871112
011840        GO  TO  GP1-080.
011850     MOVE   W-AAA(3 , I)  TO     R2-171(N , I).
011860     ADD    W-AAA(3 , I)  TO     TOT.
011870     GO  TO  GP1-070.
011880 GP1-080.
011890     IF     SW1       =       3
011900            MOVE   1       TO    W-GC                             I.930922
011910*****       PERFORM   SYG-RTN   THRU     SYG-EX                   D.930922
011920            PERFORM   TOT-RTN   THRU     TOT-EX
011930            GO  TO    GP1-120.
011940 GP1-090.
011950     MOVE     4      TO  J.                                       ﾞ
011960     PERFORM  MZA-RTN  THRU  MZA-EX.                              ﾞ
011970     IF       ASW    =   1           GO  TO  GP1-120.             ﾞ
011980     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
011990     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
012000     MOVE   4       TO     R2-16(N).
012010     MOVE   0       TO     I.
012020 GP1-100.
012030     ADD    1       TO     I.
012040     IF     I       >      10
012050        ADD  1  TO    N                                           *A871112
012060        GO  TO  GP1-110.
012070     MOVE   W-AAA(4 , I)  TO     R2-171(N , I).
012080     ADD    W-AAA(4 , I)  TO     TOT.
012090     GO  TO  GP1-100.
012100 GP1-110.
012110     IF     SW1       =       4
012120            MOVE   1       TO    W-GC                             I.930922
012130*****       PERFORM   SYG-RTN   THRU     SYG-EX                   D.930922
012140            PERFORM   TOT-RTN   THRU     TOT-EX.
012150 GP1-120.
012160     MOVE   ZERO      TO   W-GC.                                  I.930922
012170     MOVE   ZERO      TO   W-A.
012180     MOVE   ZERO      TO   SW1    N    O-SW1.                     *R871112
012190 GP1-EX.
012200     EXIT.
012210***************************************************
012220*    ＧＰ２－ＲＴＮ                               *
012230***************************************************
012240 GP2-RTN.
012250     IF  CNT      =       0
012260         GO  TO  GP2-120.
012270     MOVE     1      TO  G-SW.                                    *I 92/07
012280*****MOVE NC"合　　　計"  TO   W-KEI.                             D.951204
012290     MOVE NC"合　　計"  TO   W-KEI.                               I.951204
012300     MOVE  SPACE        TO     R2.                                ﾞ
012310     MOVE     1      TO  J  N.                                    *A
012320     PERFORM  MZB-RTN  THRU  MZB-EX.                              ﾞ
012330     IF       ASW    =   1           GO  TO  GP2-030.             ﾞ
012340     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
012350     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
012360     MOVE   1       TO     R2-16(N).
012370     MOVE   0       TO     I.
012380 GP2-010.
012390     ADD    1       TO     I.
012400     IF     I       >      10
012410        ADD  1  TO    N                                           *A871112
012420        GO  TO  GP2-020.
012430     MOVE   W-BBB(1 , I)  TO     R2-171(N , I).
012440     ADD    W-BBB(1 , I)  TO     TOT.
012450     GO  TO  GP2-010.
012460 GP2-020.
012470     IF     SW2       =       1
012480            MOVE   2        TO     W-GC                           I.930922
012490*****       PERFORM   GOG-RTN   THRU     GOG-EX                   D.930922
012500            PERFORM   TOT-RTN   THRU     TOT-EX
012510            GO  TO    GP2-120.
012520 GP2-030.
012530     MOVE     2      TO  J.                                       ﾞ
012540     PERFORM  MZB-RTN  THRU  MZB-EX.                              ﾞ
012550     IF       ASW    =   1           GO  TO  GP2-060.             ﾞ
012560     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
012570     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
012580     MOVE   2       TO     R2-16(N).
012590     MOVE   0       TO     I.
012600 GP2-040.
012610     ADD    1       TO     I.
012620     IF     I       >      10
012630        ADD  1  TO    N                                           *A871112
012640        GO  TO  GP2-050.
012650     MOVE   W-BBB(2 , I)  TO     R2-171(N , I).
012660     ADD    W-BBB(2 , I)  TO     TOT.
012670     GO  TO  GP2-040.
012680 GP2-050.
012690     IF     SW2       =       2
012700            MOVE   2        TO     W-GC                           I.930922
012710*****       PERFORM   GOG-RTN   THRU     GOG-EX                   D.930922
012720            PERFORM   TOT-RTN   THRU     TOT-EX
012730            GO  TO    GP2-120.
012740 GP2-060.
012750     MOVE     3      TO  J.                                       ﾞ
012760     PERFORM  MZB-RTN  THRU  MZB-EX.                              ﾞ
012770     IF       ASW    =   1           GO  TO  GP2-090.             ﾞ
012780     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
012790     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
012800     MOVE   3       TO     R2-16(N).
012810     MOVE   0       TO     I.
012820 GP2-070.
012830     ADD    1       TO     I.
012840     IF     I       >      10
012850        ADD  1  TO    N                                           *A871112
012860        GO  TO  GP2-080.
012870     MOVE   W-BBB(3 , I)  TO     R2-171(N , I).
012880     ADD    W-BBB(3 , I)  TO     TOT.
012890     GO  TO  GP2-070.
012900 GP2-080.
012910     IF     SW2       =       3
012920            MOVE   2        TO     W-GC                           I.930922
012930*****       PERFORM   GOG-RTN   THRU     GOG-EX                   D.930922
012940            PERFORM   TOT-RTN   THRU     TOT-EX
012950            GO  TO    GP2-120.
012960 GP2-090.
012970     MOVE     4      TO  J.                                       ﾞ
012980     PERFORM  MZB-RTN  THRU  MZB-EX.                              ﾞ
012990     IF       ASW    =   1           GO  TO  GP2-120.             ﾞ
013000     MOVE   W-KEI   TO     R2-KEI(N).                             *I 92/07
013010     MOVE   SPACE   TO     W-KEI.                                 *I 92/07
013020     MOVE   4       TO     R2-16(N).
013030     MOVE   0       TO     I.
013040 GP2-100.
013050     ADD    1       TO     I.
013060     IF     I       >      10
013070        ADD  1  TO    N                                           *A871112
013080        GO  TO  GP2-110.
013090     MOVE   W-BBB(4 , I)  TO     R2-171(N , I).
013100     ADD    W-BBB(4 , I)  TO     TOT.
013110     GO  TO  GP2-100.
013120 GP2-110.
013130     IF     SW2       =       4
013140            MOVE   2        TO     W-GC                           I.930922
013150*****       PERFORM   GOG-RTN   THRU     GOG-EX                   D.930922
013160            PERFORM   TOT-RTN   THRU     TOT-EX.
013170 GP2-120.
013180     MOVE   ZERO      TO   W-B.
013190     MOVE   ZERO      TO   SW2    N    O-SW2.                     *R871112
013200     MOVE     0      TO  G-SW.                                    *I 92/07
013210     MOVE   ZERO      TO   W-GC   W-DCC.                          I.930922
013220 GP2-EX.
013230     EXIT.
013240*******************************
013250*       ＭＯＶ１－ＲＴＮ      *                                   *A871112
013260*******************************
013270*MOV1-RTN.                                                        D.930922
013280*****IF  LCNT    NOT <  49                                        D.930922
013290*****    PERFORM     HED-RTN  THRU  HED-EX.                       D.930922
013300*****MOVE   K-1         TO     R1-K1.                             D.930922
013310*****MOVE   JMST2-04    TO     TC-TCD.
013320*****MOVE   "001"       TO     TC-CCD.
013330*****READ   TC-M     INVALID
013340*****    MOVE   ALL NX"2121"  TO  TC-NAME.
013350*****MOVE   TC-NAME  TO  R1-01.
013360*****IF  G-SW         =  1                                        D.930922
013370*****    MOVE   SPACE    TO  R1-00R  R1-01                        *I 92/07
013380*****    GO  TO  MOV1-EX.                                         D.930922
013390*****MOVE   JMST2-05    TO     SHM-KEY.                           D.930922
013400*****READ   SHM      INVALID                                      D.930922
013410*****    MOVE   ALL NX"2121"  TO  SHM-02.                         D.930922
013420*****MOVE   SHM-01   TO  R1-00.                                   D.930922
013430*****MOVE   SHM-02   TO  R1-01.                                   D.930922
013440*MOV1-010.                                                        D.930922
013450*****MOVE   K-2      TO  R1-K2.                                   D.930922
013460*****WRITE  P-R     AFTER    1.                                   D.930922
013470*****MOVE   SPACE    TO  P-R.                                     D.930922
013480*****ADD      1      TO  LCNT.                                    D.930922
013490*MOV1-EX.                                                         D.930922
013500*****EXIT.                                                        D.930922
013510*****************************
013520*      ＭＺＡ　－ＲＴＮ     ＊
013530*****************************
013540 MZA-RTN.                                                         *A871113
013550     MOVE    0    TO    I    ASW.
013560 MZA-001.
013570     ADD     1    TO    I.
013580     IF      I    >    10
013590                  MOVE    1   TO   ASW
013600                  GO  TO  MZA-EX.
013610     IF     W-AAA(J , I)  NOT   =    0       GO  TO  MZA-EX.
013620     GO  TO  MZA-001.
013630 MZA-EX.
013640     EXIT.
013650*****************************
013660*      ＭＺＢ　－ＲＴＮ     ＊
013670*****************************
013680 MZB-RTN.                                                         *A871113
013690     MOVE    0    TO    I    ASW.
013700 MZB-001.
013710     ADD     1    TO    I.
013720     IF      I    >    10
013730                  MOVE    1   TO   ASW
013740                  GO  TO  MZB-EX.
013750     IF     W-BBB(J , I)  NOT   =    0       GO  TO  MZB-EX.
013760     GO  TO  MZB-001.
013770 MZB-EX.
013780     EXIT.
013790*****************************
013800*      ＳＹＧ　－ＲＴＮ     ＊
013810*****************************
013820*SYG-RTN.                                                         D.930922
013830*****IF  LCNT       NOT  <     49                                 D.930922
013840*****      PERFORM  HED-010    THRU     HED-EX.                   D.930922
013850*****MOVE   K-1         TO     R3-K1.                             *D 92/07
013860*****MOVE NC"小　　　　　計　"  TO     R3-01.                     *D 92/07
013870*****MOVE   K-2         TO     R3-K2.                             *D 92/07
013880*****WRITE  P-R     AFTER    1.                                   D.930922
013890*****MOVE   SPACE    TO  P-R.                                     D.930922
013900*****ADD      1      TO  LCNT.                                    D.930922
013910*SYG-EX.                                                          D.930922
013920*****EXIT.                                                        D.930922
013930*****************************
013940*      ＧＯＧ　－ＲＴＮ     ＊
013950*****************************
013960*GOG-RTN.                                                         D.930922
013970*****IF  LCNT       NOT  <     49                                 D.930922
013980*****      PERFORM  HED-010    THRU     HED-EX.                   D.930922
013990*****MOVE   K-1         TO     R3-K1.                             *D 92/07
014000*****MOVE NC"合　　　　　計　"  TO     R3-01.                     *D 92/07
014010*****MOVE   K-2         TO     R3-K2.                             *D 92/07
014020*****WRITE  P-R     AFTER    1.                                   D.930922
014030*****MOVE   SPACE    TO  P-R.                                     D.930922
014040*****ADD      1      TO  LCNT.                                    D.930922
014050*GOG-EX.                                                          D.930922
014060*****EXIT.                                                        D.930922
014070 COPY    LPMSG.
