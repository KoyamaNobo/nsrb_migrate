000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT050L.
000030 AUTHOR.                        E-SHIGIHARA.
000040**********************************************************
000050*    PROGRAM        : 荷札・入日記　　　　　　           *
000060*    DATA WRITTEN   : 87/08/19                           *
000070*    SCREEN USED    : UNUSED                             *
000080*    FORM   USED    : UNUSED                             *
000090*    PRINTER TYPE   : JIPS                               *
000100*    COMPILE TYPE   : COBOL                              *
000110*    JS-W           : 0=本社 , 1=選択 , 2=藤田 , 3=早島  *
000120**********************************************************
000130 ENVIRONMENT                    DIVISION.
000140 CONFIGURATION                  SECTION.
000150 SOURCE-COMPUTER.               SYSTEM150.
000160 OBJECT-COMPUTER.               SYSTEM150.
000170 INPUT-OUTPUT                   SECTION.
000180 FILE-CONTROL.
000190*****COPY  LIBCSE.                                                D.090919
000200*****SELECT  GDMM   ASSIGN  GDMM-MSD                              D.011018
000210*****               ORGANIZATION  INDEXED                         D.011018
000220*****               ACCESS  MODE  RANDOM                          D.011018
000230*****               RECORD  KEY   GDMM-KEY                        D.011018
000240*****               FILE  STATUS  ERR-STAT.                       D.011018
000250     SELECT   JNIF      ASSIGN  F1-MSD
000260                        ORGANIZATION  INDEXED
000270                        ACCESS MODE   DYNAMIC
000280                        RECORD KEY    JNIF1-KEY.
000290*****SELECT   SHM       ASSIGN  F2-MSD                            D.010808
000300     SELECT   HI2-M     ASSIGN  F2-MSD                            I.010808
000310                        ORGANIZATION  INDEXED
000320                        ACCESS MODE   RANDOM
000330                        RECORD KEY    HI-KEY2.                    I.010808
000340*****                   RECORD KEY    SHM-KEY.                    D.010808
000350     SELECT   TC-M      ASSIGN  F3-MSD
000360                        ORGANIZATION  INDEXED
000370                        ACCESS MODE   RANDOM
000380                        RECORD KEY    TC-KEY.
000390     SELECT   JCON      ASSIGN  F4-MSD
000400                        ORGANIZATION  INDEXED
000410                        ACCESS MODE   RANDOM
000420                        RECORD KEY    JCON2-KEY.
000430     SELECT  P-F        ASSIGN  P1-PRN999.
000440 I-O-CONTROL.
000450*****APPLY   SHARED-MODE ON  JNIF   SHM    TC-M   JCON            D.010808
000460     APPLY   SHARED-MODE ON  JNIF   HI2-M  TC-M   JCON            I.010808
000470*****                        GDMM                                 D.011018
000480*****                        M-DATE                               D.090919
000490     APPLY   SHIFT-CODE  ON  P-F.
000500*
000510 DATA                       DIVISION.
000520 FILE                       SECTION.
000530*****COPY  LIBFDD.                                                D.090919
000540*****COPY  L-GDMM.                                                D.011018
000550 COPY  L-JNIF.
000560*COPY  L-SHM.                                                     D.010808
000570 COPY  LIHIM2.                                                    I.010808
000580 COPY  LITCM.
000590 COPY  L-JCON.
000600 FD  P-F
000610     LABEL  RECORD   OMITTED   LINAGE    28.                      I.060308
000620*****LABEL  RECORD   OMITTED   LINAGE    29.                      D.060308
000630 01  P-R                       PIC X(180).
000640 WORKING-STORAGE            SECTION.
000650 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000660 77  JS-SIGN                   PIC X(01).                         I.890828
000670 77  JS-W                      PIC X(01).                         I.091019
000680 77  W-JS                      PIC X(01).                         I.911113
000690*77  JS-SIGN3                  PIC X(01).                         D.981029
000700*77  JS-SIGN4                  PIC X(01).                         D.011109
000710 77  STR-SW                    PIC X(02).                         I.900417
000720*01  WS-MID                    PIC N(05).                         D.030722
000730*01  WS-YOUSI                  PIC N(06)  VALUE  SPACE.           D.011109
000740*01  W-P.                                                         D.981029
000750*****02  F                     PIC X(006).                        D.980826
000760*****02  F                     PIC X(001).                        D.981029
000770*****02  W-P1                  PIC X(174).                        D.981029
000780 01  W-P                       PIC X(175).                        I.981029
000790 01  R1-R.
000800     02  R1-K1                 PIC X(05).
000810*****02  FILLER                PIC X(09).                         D.920826
000820*****02  FILLER                PIC X(01).                         D.981029
000830*****02  FILLER                PIC X(02).                         D.031107
000840     02  FILLER                PIC X(01).                         I.031107
000850     02  R1-01                 PIC N(14).
000860     02  R1-K2                 PIC X(05).
000870 01  R2-R.
000880     02  R2-K1                 PIC X(05).
000890*****02  FILLER                PIC X(01).                         D.981029
000900*****02  FILLER                PIC X(15).                         D.920826
000910*****02  FILLER                PIC X(07).                         D.960821
000920*****02  R2-01                 PIC N(10).                         D.960821
000930*****02  FILLER                PIC X(02).                         D.031107
000940     02  FILLER                PIC X(01).                         I.031107
000950     02  R2-01                 PIC N(14).                         I.960821
000960     02  FILLER                PIC X(01).                         I.920826
000970*****02  R2-02        OCCURS   27.                                D.920826
000980*****02  R2-02        OCCURS   25.                                D.060822
000990*****    03  R2-021            PIC ZZZ.                           D.060822
001000     02  R2-02A.                                                  I.060822
001010       03  R2-02        OCCURS   25.                              I.060822
001020           04  R2-021          PIC ZZZ.                           I.060822
001030     02  R2-02B   REDEFINES R2-02A.                               I.060822
001040       03  R2-B02        OCCURS   25.                             I.060822
001050           04  R2-B020         PIC X.                             I.060822
001060           04  R2-B021         PIC ZZ.                            I.060822
001070     02  R2-03                 PIC ZZZZ.                          R.900411
001080     02  R2-K2                 PIC X(05).
001090 01  MID0-R.                                                      I.090919
001100     02  M0-K1                 PIC X(05)  VALUE ""3FE04F40A0"".   I.090919
001110     02  FILLER                PIC X(01)  VALUE   SPACE.          I.090919
001120     02  M0-01                 PIC N(05)  VALUE   SPACE.          I.090919
001130 01  MID1-R.
001140     02  M1-K2                 PIC X(05)  VALUE ""3FE04FE080"".   I.950201
001150*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.981029
001160*****02  FILLER                PIC X(16)    VALUE   SPACE.        D.920826
001170*****02  M1-01                 PIC X(06).                         D.970130
001180*****02  FILLER                PIC X(49)    VALUE   SPACE.        D.920826
001190*****02  FILLER                PIC X(43)    VALUE   SPACE.        D.950202
001200*****02  FILLER                PIC X(33)    VALUE   SPACE.        D.970130
001210*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.031107
001220     02  FILLER                PIC X(08)    VALUE   SPACE.        I.031107
001230     02  M1-01                 PIC X(08).                         I.970130
001240     02  FILLER                PIC X(31)    VALUE   SPACE.        I.970130
001250     02  M1-S                  PIC N(01)    VALUE   SPACE.        I.950202
001260     02  FILLER                PIC X(08)    VALUE   SPACE.        I.950202
001270     02  M1-06                 PIC 9(06).                         I.951115
001280*****02  M1-02                 PIC 9(06).                         D.951115
001290*****02  FILLER                PIC X(11)    VALUE   SPACE.        D.920826
001300*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.950202
001310*****02  M1-C                  PIC X(01).                         D.950201
001320     02  FILLER                PIC X(09)    VALUE   SPACE.        I.950202
001330     02  M1-03                 PIC 9(02).
001340     02  FILLER                PIC X(03)    VALUE   SPACE.
001350     02  M1-04                 PIC Z9.
001360     02  FILLER                PIC X(03)    VALUE   SPACE.        *R871111
001370     02  M1-05                 PIC Z9.
001380     02  FILLER                PIC X(11)    VALUE   SPACE.        I.920826
001390     02  M1-02                 PIC 9(06).                         I.951115
001400*****02  FILLER                PIC X(07)    VALUE   SPACE.        D.920826
001410*****02  M1-06                 PIC 9(06).                         D.951115
001420*01  MID1A-R.                                                     D.920826
001430*****02  FILLER                PIC X(110)   VALUE   SPACE.        D.920826
001440*****02  M1A-01                PIC ZZZ.                           D.920826
001450 01  MID2A-R.                                                     I.060308
001460     02  M2A-K1                PIC X(05)  VALUE ""3FE04F40A0"".   I.060308
001470     02  FILLER                PIC X(51)    VALUE   SPACE.        I.060308
001480     02  M2A-UM                PIC N(02)  VALUE NC"　〒".         I.060308
001490     02  M2A-UNO               PIC X(08)    VALUE   SPACE.        I.060308
001500     02  F                     PIC X(02)    VALUE   SPACE.        I.060308
001510     02  M2A-JSO               PIC N(06).                         I.060308
001520 01  MID2-R.
001530     02  M2-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001540     02  FILLER                PIC X(06)    VALUE   SPACE.        I.031107
001550*****02  FILLER                PIC X(07)    VALUE   SPACE.        D.031107
001560*****02  FILLER                PIC X(15)    VALUE   SPACE.        D.920826
001570*****02  FILLER                PIC X(06)    VALUE   SPACE.        D.981029
001580*****02  M2-01                 PIC N(24).                         D.020417
001590     02  M2-01                 PIC N(20).                         I.020417
001600     02  F                     PIC X(16)    VALUE   SPACE.        I.060308
001610     02  M2-JSN                PIC N(14).                         I.060308
001620*****02  M2-K2                 PIC X(05)  VALUE ""3FE04FE080"".   D.060308
001630*****02  FILLER                PIC X(52)    VALUE   SPACE.        D.960821
001640*****02  FILLER                PIC X(56)    VALUE   SPACE.        D.010305
001650*****02  F                     PIC X(11)    VALUE   SPACE.        D.020508
001660*****02  F                     PIC X(17)    VALUE   SPACE.        D.060308
001670*****02  M2-UM                 PIC N(01)    VALUE   SPACE.        D.060308
001680*****02  M2-UNO                PIC X(08)    VALUE   SPACE.        D.060308
001690*****02  F                     PIC X(35)    VALUE   SPACE.        D.060308
001700     02  F                     PIC X(25)    VALUE   SPACE.        I.060308
001710     02  M2-02                 PIC ZZZ.                           I.920826
001720 01  MID3-R.
001730     02  M3-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001740*****02  FILLER                PIC X(33)    VALUE   SPACE.        D.920826
001750*****02  FILLER                PIC X(24)    VALUE   SPACE.        D.981029
001760*****02  FILLER                PIC X(25)    VALUE   SPACE.        D.020417
001770*****02  M3-01                 PIC N(12).                         D.020417
001780*****02  FILLER                PIC X(13)    VALUE   SPACE.        D.031107
001790*****02  FILLER                PIC X(12)    VALUE   SPACE.        D.060308
001800*****02  M3-01                 PIC N(20).                         D.060308
001810*****02  F                     PIC X(11)    VALUE   SPACE.        D.060308
001820     02  FILLER                PIC X(13)    VALUE   SPACE.        I.060308
001830     02  M3-01                 PIC N(20).                         I.060308
001840     02  F                     PIC X(09)    VALUE   SPACE.        I.060308
001850     02  M3-JS                 PIC N(14)    VALUE   SPACE.        I.010305
001860*****02  F                     PIC X(26)    VALUE   SPACE.        D.060308
001870*****02  FILLER                PIC X(58)    VALUE   SPACE.        D.010305
001880*****02  FILLER                PIC X(61)    VALUE   SPACE.        D.910725
001890*****02  FILLER                PIC X(36)    VALUE   SPACE.        D.920826
001900*****02  M3-03F                PIC X(01).                         D.920826
001910*****02  M3-03                 PIC N(06).                         D.920826
001920*****02  M3-03R                PIC X(01).                         D.920826
001930*****02  F                     PIC X(26)    VALUE   SPACE.        D.060308
001940*****02  FILLER                PIC X(58)    VALUE   SPACE.        D.010305
001950*****02  FILLER                PIC X(61)    VALUE   SPACE.        D.910725
001960*****02  FILLER                PIC X(36)    VALUE   SPACE.        D.920826
001970*****02  M3-03F                PIC X(01).                         D.920826
001980*****02  M3-03                 PIC N(06).                         D.920826
001990*****02  M3-03R                PIC X(01).                         D.920826
002000*****02  FILLER                PIC X(14)    VALUE   SPACE.        D.920826
002010     02  FILLER                PIC X(28)    VALUE   SPACE.        I.060308
002020     02  M3-K2                 PIC X(05)  VALUE ""3FE04FE080"".
002030     02  M3-02                 PIC N(01).
002040 01  MID4-R.                                                      *R871111
002050*****02  FILLER                PIC X(17)    VALUE   SPACE.        D.920826
002060*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.981029
002070*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.031107
002080     02  FILLER                PIC X(08)    VALUE   SPACE.        I.031107
002090     02  M5-K1                 PIC X(05)  VALUE ""3FE04F40A0"".   ﾞ
002100*****02  M5-01                 PIC N(24).                         D.020412
002110     02  M5-01                 PIC N(26).                         I.020412
002120     02  FILLER                PIC X(05)    VALUE   SPACE.        I.060308
002130*****02  M5-K2                 PIC X(05)  VALUE ""3FE04FE080"".   D.060308
002140*****02  FILLER                PIC X(32)    VALUE   SPACE.        D.920826
002150*****02  FILLER                PIC X(31)    VALUE   SPACE.        D.010305
002160*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.020412
002170*****02  FILLER                PIC X(06)    VALUE   SPACE.        D.060308
002180     02  M5-K2            PIC X(08) VALUE  ""3F507F4F654F40A0"".  ﾞ
002190     02  M4-NA                 PIC N(14)    VALUE   SPACE.        I.060308
002200*****02  M4-NA                 PIC N(10)    VALUE   SPACE.        D.060308
002210     02  F                     PIC X(02)    VALUE   SPACE.        I.010305
002220     02  M5-K2A                PIC X(05)  VALUE ""3FE04FE080"".   I.060308
002230     02  M5-02                 PIC N(06).                         ﾞ
002240     02  M4-K4            PIC X(08) VALUE  ""3F504F40674F40A0"".  ﾞ
002250*****02  FILLER                PIC X(06)   VALUE   SPACE.         D.920826
002260     02  FILLER                PIC X(03)   VALUE   SPACE.         I.920826
002270     02  M4-K3            PIC X(08) VALUE  ""3F507F4F657F4F9B"".  ﾞ
002280     02  M4-01                 PIC N(03).                         ﾞ
002290     02  M4-K5            PIC X(08) VALUE  ""3F504F40674F40A0"".  ﾞ
002300 01  MID5-R.                                                      I.010305
002310*****02  F                     PIC X(54)   VALUE   SPACE.         D.031107
002320*****02  F                     PIC X(53)   VALUE   SPACE.         D.060308
002330*****02  M5-TM                 PIC X(03)   VALUE   SPACE.         D.060308
002340     02  F                     PIC X(54)   VALUE   SPACE.         I.060308
002350     02  M5-TM                 PIC X(03)   VALUE   "TEL".         I.060308
002360     02  F                     PIC X(01)   VALUE   SPACE.         I.010305
002370     02  M5-TEL                PIC X(14)   VALUE   SPACE.         I.010305
002380*01  MID6-R.                                                      D.021108
002390*****02  F                     PIC X(95)   VALUE   SPACE.         D.981029
002400*****02  F                     PIC X(96)   VALUE   SPACE.         D.021108
002410*****02  F                     PIC X(03)   VALUE   " 3L".         D.021108
002420*****02  F                     PIC X(10)   VALUE   SPACE.         D.021108
002430 01  MEI                           PIC X(1080).
002440 01  MEIR      REDEFINES       MEI.
002450     02  MEI-R      OCCURS            6.
002460         03  MEI1-R                PIC X(50).
002470         03  MEI2-R                PIC X(130).
002480 01  R3-R.
002490     02  R3-K1                 PIC X(05).
002500*****02  FILLER                PIC X(31).                         D.920826
002510*****02  FILLER                PIC X(24).                         D.981029
002520*****02  FILLER                PIC X(25).                         D.031107
002530     02  FILLER                PIC X(24).                         I.031107
002540     02  R3-K30                PIC X(08).                         I.060308
002550     02  R3-01                 PIC N(28).                         *A631025
002560     02  R3-K20                PIC X(08).                         I.060308
002570     02  F                     PIC X(26).                         I.920826
002580     02  R3-02                 PIC N(06).                         I.920826
002590     02  R3-K2                 PIC X(05).
002600 01  ACT-WORK.
002610     02  W-SEN                 PIC 9(01).
002620     02  W-TST                 PIC 9(01).
002630     02  W-FROM                PIC 9(06).
002640     02  W-TO                  PIC 9(06).
002650     02  W-OK                  PIC 9(01).
002660     02  I                     PIC 9(02).
002670     02  W-T                   PIC S9(03).
002680     02  OLD1                  PIC 9(06).
002690     02  W-CNT                 PIC 9(03).
002700*****02  G-CNT                 PIC 9(03).                         D.960821
002710*****02  M-CNT                 PIC 9(03).                         D.960821
002720     02  A                     PIC X(03).
002730     02  AR     REDEFINES      A.
002740         03  AAR               PIC ZZ9.
002750     02  W-TEKI.                                                  *A631025
002760         03  W-TEKI1           PIC N(04).                         "
002770         03  W-TEKI2           PIC N(19).                         "
002780     02  P-TEKI.                                                  *A631025
002790         03  P-TEKI1           PIC N(19).                         "
002800         03  P-TEKI2           PIC N(09).                         "
002810     02  SV-GYO                PIC 9(01).                         I.890831
002820     02  SV-TCD                PIC 9(04).                         I.010305
002830     02  W-OKNO                PIC 9(06).                         I.960821
002840     02  W-NO                  PIC 9(03).                         I.960821
002850     02  W-ANAME.                                                 I.960821
002860       03  W-NNA               PIC N(24).                         I.960821
002870       03  W-NNMD  REDEFINES  W-NNA.                              I.960821
002880         04  W-NNM             PIC N(01)  OCCURS  24.             I.960821
002890       03  W-PNA   REDEFINES  W-NNA.                              I.960821
002900         04  W-PNA1            PIC N(14).                         I.960821
002910         04  W-PNA2            PIC N(10).                         I.960821
002920       03  W-ONA               PIC N(14).                         I.960821
002930       03  W-ONMD  REDEFINES  W-ONA.                              I.960821
002940         04  W-ONM             PIC N(01)  OCCURS  14.             I.960821
002950       03  W-UNA               PIC N(14).                         I.960821
002960       03  W-UNMD  REDEFINES  W-UNA.                              I.960821
002970         04  W-UNM             PIC N(01)  OCCURS  14.             I.960821
002980     02  W-C.                                                     I.960821
002990       03  W-C1                PIC 9(02).                         I.960821
003000       03  W-C2                PIC 9(02).                         I.960821
003010       03  W-C3                PIC 9(02).                         I.960821
003020       03  W-C4                PIC 9(02).                         I.960821
003030     02  W-NGP.                                                   I.981022
003040       03  F                   PIC 9(02).                         I.981022
003050       03  W-NGPS              PIC 9(06).                         I.981022
003060     02  W-NGPL              REDEFINES  W-NGP.                    I.981022
003070       03  W-NEN               PIC 9(04).                         I.981022
003080       03  W-NENL            REDEFINES  W-NEN.                    I.981022
003090         04  W-NEN1            PIC 9(02).                         I.981022
003100         04  W-NEN2            PIC 9(02).                         I.981022
003110       03  F                   PIC 9(04).                         I.981022
003120     02  W-SDATE               PIC 9(08).                         I.981022
003130     02  W-EDATE               PIC 9(08).                         I.981022
003140     02  W-SNGP.                                                  I.981022
003150       03  W-SNEN              PIC 9(04).                         I.981022
003160       03  W-SNENL           REDEFINES  W-SNEN.                   I.981022
003170         04  W-SNEN1           PIC 9(02).                         I.981022
003180         04  W-SNEN2           PIC 9(02).                         I.981022
003190       03  W-SGET              PIC 9(02).                         I.981022
003200       03  W-SPEY              PIC 9(02).                         I.981022
003210     02  W-ENGP.                                                  I.981022
003220       03  W-ENEN              PIC 9(04).                         I.981022
003230       03  W-ENENL           REDEFINES  W-ENEN.                   I.981022
003240         04  W-ENEN1           PIC 9(02).                         I.981022
003250         04  W-ENEN2           PIC 9(02).                         I.981022
003260       03  W-EGET              PIC 9(02).                         I.981022
003270       03  W-EPEY              PIC 9(02).                         I.981022
003280     02  W-POC                 PIC 9(01).                         I.030722
003290     02  W-FOC                 PIC 9(01).                         I.030722
003300     02  W-KEI                 PIC 9(04)   VALUE  0.              I.091214
003310 01  W-AREA.
003320     02  LCNT                  PIC 9(02)   VALUE  90.
003330*01  W-SHM.                                                       D.960821
003340*****02  W-SHM-021.                                               D.960821
003350*****    03  WSH-01     OCCURS  14  PIC  N.                       D.960821
003360*****02  W-SHM-022.                                               D.960821
003370*****    03  WSH-02     OCCURS  10  PIC  N.                       D.960821
003380 01  SOUKO                   PIC N(06).                           I.920826
003390*01  W-NC                    PIC 9(02)  VALUE  ZERO.              D.960821
003400 01  K-1                     PIC X(05)  VALUE  ""3FE04F40A0"".
003410 01  K-2                     PIC X(05)  VALUE  ""3FE04FE080"".
003420 COPY    LWMSG.
003430*
003440 SCREEN                  SECTION.
003450 SD  CRT-X
003460     END STATUS  IS  ESTAT.
003470 01  CLE-01          LINE  1.
003480     02  CLEAR   SCREEN.
003490 01  CLE-02.
003500*****02  CLE-JS    LINE  5   COLUMN 69   VALUE " ".               D.070411
003510     02  CLE-JS    LINE  5   COLUMN 54   VALUE " ".               I.070411
003520     02  CLE-021   LINE  9   COLUMN 45   VALUE " ".               I.030722
003530     02  CLE-022   LINE 12   COLUMN 55   VALUE " ".               I.030722
003540*****02  CLE-021   LINE 7    COLUMN 45   VALUE " ".               D.030722
003550*****02  CLE-022   LINE 12   COLUMN 45   VALUE " ".               D.030722
003560*****02  LINE 7  COLUMN 45    VALUE " ".                          D.950202
003570*****02  LINE 12 COLUMN 45    VALUE " ".                          D.950202
003580*****02  LINE 17 COLUMN 31    VALUE "      ".                     D.950202
003590*****02  LINE 19 COLUMN 31    VALUE "      ".                     D.950202
003600*****02  LINE 23 COLUMN 62    VALUE " ".                          D.950202
003610*****02  CLE-023   LINE 17   COLUMN 31   VALUE "      ".          D.981022
003620*****02  CLE-024   LINE 19   COLUMN 31   VALUE "      ".          D.981022
003630     02  CLE-023   LINE 17   COLUMN 31   VALUE "        ".        I.981022
003640     02  CLE-024   LINE 19   COLUMN 31   VALUE "        ".        I.981022
003650     02  CLE-025   LINE 23   COLUMN 62   VALUE " ".               I.950202
003660 01  DSP-AREA.
003670     02  DSP-01       LINE 1.
003680         03  COLUMN  25  VALUE  "                 "  REVERSE.
003690         03  COLUMN  26  VALUE  NC"荷".
003700         03  COLUMN  29  VALUE  NC"札・入".
003710         03  COLUMN  36  VALUE  NC"日".
003720         03  COLUMN  39  VALUE  NC"記".
003730*****    03  COLUMN  50  VALUE  NC"社名なし用紙".                 D.030722
003740     02  DSP-00       LINE 5.                                     I.030722
003750         03  COLUMN  21  VALUE  NC"教　育".                       I.030722
003760         03  COLUMN  27  VALUE  "=0 , ".                          I.030722
003770*****    03  COLUMN  32  VALUE  NC"ワーク".                       D.070411
003780         03  COLUMN  32  VALUE  NC"一　般".                       I.070411
003790         03  COLUMN  38  VALUE  "=1 , ".                          I.030722
003800         03  COLUMN  43  VALUE  NC"ＡＬＬ".                       I.070411
003810         03  COLUMN  49  VALUE  "=9    ".                         I.070411
003820*****    03  COLUMN  43  VALUE  NC"カジュアル".                   D.070411
003830*****    03  COLUMN  53  VALUE  "=2 , ".                          D.070411
003840*****    03  COLUMN  58  VALUE  NC"ＡＬＬ".                       D.070411
003850*****    03  COLUMN  64  VALUE  "=9    ".                         D.070411
003860*****02  DSP-02          LINE 5.                                  D.030722
003870     02  DSP-02          LINE 7.                                  I.030722
003880         03  COLUMN  25  VALUE  NC"１　発　行".
003890*****02  DSP-03      LINE   7.                                    D.030722
003900     02  DSP-03      LINE   9.                                    I.030722
003910         03  COLUMN  25  VALUE  NC"２　再発行　　選択".
003920         03  COLUMN  44  VALUE  "[ ]".
003930*****02  DSP-04      LINE  10.                                    D.030722
003940*****    03  COLUMN  21  VALUE  NC"テストプリント印字".           D.030722
003950     02  DSP-05      LINE  12.
003960         03  COLUMN  21  VALUE  NC"テストプリント印字".           I.030722
003970         03  COLUMN  41  VALUE  "(YES=1,NO=2) [ ]".               I.030722
003980*****    03  COLUMN  31  VALUE  "(YES=1,NO=2) [ ]".               D.030722
003990*****02  DSP-06      LINE  15.                                    D.981022
004000*****    03  COLUMN  31  VALUE  NC"伝票".                         D.981022
004010*****    03  COLUMN  35  VALUE  "NO".                             D.981022
004020     02  DSP-07      LINE  17.
004030         03  COLUMN  21  VALUE  NC"ＦＲＯＭ".
004040     02  DSP-08      LINE  19.
004050         03  COLUMN  21  VALUE  NC"ＴＯ".
004060     02  DSP-09      LINE  23.
004070         03  COLUMN  41  VALUE  NC"確認（".
004080         03  COLUMN  47  VALUE  "OK=1,NO=9".
004090         03  COLUMN  56  VALUE  NC"）".
004100         03  COLUMN  58  VALUE  "---> ﾘﾀｰﾝ".
004110 01  DSP-AREA1.                                                   I.981022
004120     02  DISP-15  LINE  3  COLUMN  13  PIC  X(39)  VALUE          I.060308
004130          "本社=0 , 藤田=1 , 津山=2 , 早島=3 ...  ".              I.170403
004140*****     "本社=0 , 玉島=1 , 津山=2 , 早島=3 ...  ".              D.170403
004150*****     "本社=0 , 玉島=1 , 津山=2 , 両備=3 ...  ".              D.091019
004160*****     "本社=0 , 玉島=1 , 津山=2 , 高屋=3 ...  ".              D.060926
004170     02  DSP-DNOM.                                                I.981022
004180       03  LINE  15    COLUMN  31    VALUE  NC"伝票№".           I.981022
004190       03  LINE  17    COLUMN  31    VALUE  "        ".           I.981022
004200       03  LINE  19    COLUMN  31    VALUE  "        ".           I.981022
004210     02  DSP-DATM.                                                I.981022
004220       03  LINE  15    COLUMN  31    VALUE  NC"日　付".           I.981022
004230       03  LINE  17    COLUMN  31    VALUE  "  /  /  ".           I.981022
004240       03  LINE  19    COLUMN  31    VALUE  "  /  /  ".           I.981022
004250*01  DSP-MID.                                                     D.030722
004260*****02  LINE   1  COLUMN   1  PIC  N(05)  FROM  WS-MID.          D.030722
004270*01  DSP-YOUSI.                                                   D.011109
004280*****02  LINE   1  COLUMN  50  PIC  N(06)  FROM  WS-YOUSI.        D.011109
004290 01  ACP-AREA.
004300     02  ACP-SIGN    LINE  3 COLUMN  51  PIC 9(01)                I.060308
004310                 USING  JS-SIGN   CHECK  OVERFLOW  NO  IFC.       I.060308
004320*****02  ACP-JS      LINE  5 COLUMN  69  PIC 9(01)                D.070411
004330     02  ACP-JS      LINE  5 COLUMN  54  PIC 9(01)                I.070411
004340                 USING  W-JS      CHECK  OVERFLOW  NO  IFC.       I.030722
004350*****02  ACP-SEN     LINE 7  COLUMN  45  PIC 9(01)                D.030722
004360     02  ACP-SEN     LINE 9  COLUMN  45  PIC 9(01)                I.030722
004370                 USING  W-SEN     CHECK  OVERFLOW  NO  IFC.
004380*****02  ACP-TST     LINE 12 COLUMN  45  PIC 9(01)                D.030722
004390     02  ACP-TST     LINE 12 COLUMN  55  PIC 9(01)                I.030722
004400                 USING  W-TST     CHECK  OVERFLOW  NO  IFC.
004410     02  ACP-FROM    LINE 17 COLUMN  31  PIC 9(06)
004420                 USING  W-FROM    CHECK  OVERFLOW  NO  IFC.
004430     02  ACP-TO      LINE 19 COLUMN  31  PIC 9(06)
004440                 USING  W-TO      CHECK  OVERFLOW  NO  IFC.
004450     02  ACP-SNGP  LINE  17.                                      I.981022
004460       03  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981022
004470             USING  W-SNEN2  NO  IFC.                             I.981022
004480       03  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981022
004490             USING  W-SGET   NO  IFC.                             I.981022
004500       03  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981022
004510             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.            I.981022
004520     02  ACP-ENGP  LINE  19.                                      I.981022
004530       03  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981022
004540             USING  W-ENEN2  NO  IFC.                             I.981022
004550       03  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981022
004560             USING  W-EGET   NO  IFC.                             I.981022
004570       03  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981022
004580             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.            I.981022
004590     02  ACP-OK      LINE 23 COLUMN  62  PIC 9(01)
004600                 INTO  W-OK      CHECK  OVERFLOW  NO  IFC.
004610*01  DSP-GDMM.                                                    D.011018
004620*****02  LINE  24  COLUMN   1  VALUE                              D.011018
004630*****    NC"＊＊ダミーＦ　なし".                                  D.011018
004640 COPY    LSMSG.
004650*****COPY  LIBSCR.                                                D.090919
004660*
004670 PROCEDURE               DIVISION.
004680************************************
004690*    メイン　ルーチン              *
004700************************************
004710 HAJIME.
004720     PERFORM   INT-RTN   THRU  INT-EX.
004730*****IF JS-SIGN     =  0                                          D.091019
004740     IF JS-W    NOT =  1                                          I.091019
004750        GO  TO  MR004.                                            I.060308
004760     DISPLAY    DISP-15.                                          I.060308
004770 MR003.                                                           I.060308
004780     ACCEPT       ACP-SIGN.                                       I.060308
004790     DISPLAY      DISP-MSG-SPACE.                                 I.060308
004800     IF ESTAT  =  "P9"                                            I.060308
004810        GO  TO  MR999.                                            I.060308
004820     IF  ESTAT  NOT  =  "01"   AND    "06"                        I.060308
004830         GO  TO  MR003.                                           I.060308
004840     DISPLAY      ACP-SIGN.                                       I.060308
004850     IF  JS-SIGN  NOT  =  0  AND  1  AND  2  AND  3               I.060308
004860         GO  TO  MR003.                                           I.060308
004870 MR004.                                                           I.091019
004880*****IF  JS-SIGN  NOT  =  0                                       D.091019
004890     IF (JS-W          =  2  OR  3)  OR                           I.091019
004900       ((JS-W          =  1)  AND  (JS-SIGN   NOT =  0))          I.091019
004910         MOVE  9        TO  W-JS                                  I.091005
004920         DISPLAY  ACP-JS                                          I.091005
004930         GO  TO  MR010.                                           I.091005
004940 MR005.                                                           I.030722
004950     ACCEPT       ACP-JS.                                         I.030722
004960     DISPLAY      DISP-MSG-SPACE.                                 I.030722
004970     IF ESTAT  =  "P9"                                            I.030722
004980        GO  TO  MR999.                                            I.030722
004990     IF  ESTAT  =  "09"                                           I.060308
005000         IF  JS-SIGN  NOT =  0                                    I.060308
005010             GO  TO  MR003.                                       I.060308
005020     IF  ESTAT  NOT  =  "01"   AND    "06"                        I.030722
005030         GO  TO  MR005.                                           I.030722
005040     DISPLAY      ACP-JS.                                         I.030722
005050*****IF  W-JS   NOT  =  0  AND  1  AND  2  AND  9                 D.070411
005060     IF  W-JS   NOT  =  0  AND  1  AND  9                         I.070411
005070         GO  TO  MR005.                                           I.030722
005080*****DISPLAY        CLE-01      DSP-AREA  ACP-JS.                 D.060308
005090 MR010.
005100     ACCEPT        ACP-SEN.
005110     DISPLAY       DISP-MSG-SPACE.
005120     IF ESTAT  =  "P9"
005130        GO  TO  MR999.
005140     IF  ESTAT  =  "09"                                           I.030722
005150         IF (JS-W         =  0)  OR                               D.091019
005160           ((JS-W          =  1)  AND  (JS-SIGN       =  0))      I.091019
005170             GO  TO  MR005                                        I.091019
005180         ELSE                                                     I.091019
005190           IF  JS-W          =  1                                 I.091019
005200               GO  TO  MR003.                                     I.091019
005210*****    IF  JS-SIGN  NOT =  0                                    D.091019
005220*****        GO  TO  MR003                                        D.091019
005230*****    ELSE                                                     D.091019
005240*****        GO  TO  MR005.                                       D.091019
005250     IF ESTAT  NOT  =  "01"   AND    "06"
005260        GO  TO  MR010.
005270     DISPLAY       ACP-SEN.
005280*****IF W-SEN  NOT  =  "1"   AND    "2"                           D.030722
005290     IF W-SEN  NOT  =  1   AND    2                               I.030722
005300        GO  TO  MR010.
005310*****IF  W-SEN = "2"                                              D.030722
005320     IF  W-SEN =  2                                               I.030722
005330         MOVE  NC"再"    TO  M1-S                                 I.981022
005340         MOVE  ZERO      TO  W-SNGP                               I.981022
005350         MOVE  99999999  TO  W-ENGP                               I.981022
005360         DISPLAY  DSP-DNOM                                        I.981022
005370         GO  TO  MR020.                                           I.981022
005380*
005390     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.981022
005400     IF  W-SNGP = ZERO                                            I.981022
005410         DISPLAY  ERR-02                                          I.981022
005420         GO  TO  MR010.                                           I.981022
005430     DISPLAY  DSP-DATM  ACP-SNGP  ACP-ENGP.                       I.981022
005440     MOVE  ZERO    TO  W-FROM.                                    I.981022
005450     MOVE  999999  TO  W-TO.                                      I.981022
005460*****IF W-SEN       =  "1"               MOVE  " "     TO  M1-C   D.950201
005470*****                             ELSE   MOVE  "#"     TO  M1-C.  D.950201
005480*****IF W-SEN       =  "1"            MOVE  NC"　"    TO  M1-S    D.981022
005490*****                                 DISPLAY  CLE-023  CLE-024   D.981022
005500*****                                 MOVE  ZERO      TO  W-FROM  D.981022
005510*****                                 MOVE  999999    TO  W-TO    D.981022
005520*****                          ELSE   MOVE  NC"再"    TO  M1-S.   D.981022
005530 MR020.
005540     ACCEPT       ACP-TST.
005550     DISPLAY      DISP-MSG-SPACE.
005560     IF  ESTAT  =  "09"
005570         GO  TO  MR010.
005580     IF  ESTAT  NOT  =  "01"   AND    "06"
005590         GO  TO  MR020.
005600     DISPLAY      ACP-TST.
005610*****IF  W-TST  NOT  =  "1"   AND    "2"                          D.030722
005620     IF  W-TST  NOT  =  1   AND    2                              I.030722
005630         GO  TO  MR020.
005640     IF  W-TST    =  1
005650         PERFORM    TST-RTN   THRU     TST-EX
005660         GO  TO  MR020.
005670     IF W-SEN       =   1             GO  TO  MR050.              I.030722
005680*****IF W-SEN       =  "1"            GO  TO  MR050.              D.030722
005690 MR030.
005700     ACCEPT        ACP-FROM.
005710     DISPLAY       DISP-MSG-SPACE.
005720     IF  ESTAT  =  "09"
005730         GO  TO  MR020.
005740     IF ESTAT  NOT  =  "01"   AND    "06"
005750        GO  TO  MR030.
005760     DISPLAY       ACP-FROM.
005770 MR040.
005780     ACCEPT       ACP-TO.
005790     DISPLAY      DISP-MSG-SPACE.
005800     IF  ESTAT  =  "09"
005810         GO  TO  MR030.
005820     IF  ESTAT  NOT  =  "01"   AND    "06"
005830         GO  TO  MR040.
005840     DISPLAY      ACP-TO.
005850     IF  W-FROM   >  W-TO
005860         GO  TO  MR030.
005870     GO  TO  MR050.                                               I.981022
005880 MR042.                                                           I.981022
005890     ACCEPT  ACP-SNEN.                                            I.981022
005900     IF  ESTAT = "09"                                             I.981022
005910         GO  TO  MR020.                                           I.981022
005920     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
005930         GO  TO  MR042.                                           I.981022
005940     MOVE  20    TO  W-SNEN1.                                     I.090919
005950*****MOVE  ZERO  TO  W-SNEN1.                                     D.090919
005960*****IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1                    D.090919
005970*****    ADD  DATE-NC1  TO  W-SNEN.                               D.090919
005980*****IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2                    D.090919
005990*****    ADD  DATE-NC2  TO  W-SNEN.                               D.090919
006000*****IF  W-SNEN2 > 90                                             D.981027
006010*****    ADD  1900  TO  W-SNEN                                    D.981027
006020*****  ELSE                                                       D.981027
006030*****    ADD  2000  TO  W-SNEN.                                   D.981027
006040 MR043.                                                           I.981022
006050     ACCEPT  ACP-SGET.                                            I.981022
006060     IF  ESTAT = "09"                                             I.981022
006070         GO  TO  MR042.                                           I.981022
006080     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006090         GO  TO  MR043.                                           I.981022
006100     IF  W-SGET < 1  OR  > 12                                     I.981022
006110         GO  TO  MR043.                                           I.981022
006120 MR044.                                                           I.981022
006130     ACCEPT  ACP-SPEY.                                            I.981022
006140     IF  ESTAT = "09"                                             I.981022
006150         GO  TO  MR043.                                           I.981022
006160     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006170         GO  TO  MR044.                                           I.981022
006180     IF  W-SGET < 1  OR  > 31                                     I.981022
006190         GO  TO  MR044.                                           I.981022
006200     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981022
006210         GO  TO  MR042.                                           I.981022
006220 MR046.                                                           I.981022
006230     ACCEPT  ACP-ENEN.                                            I.981022
006240     IF  ESTAT = "09"                                             I.981022
006250         GO  TO  MR044.                                           I.981022
006260     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006270         GO  TO  MR046.                                           I.981022
006280     MOVE  20    TO  W-ENEN1.                                     I.090919
006290*****MOVE  ZERO  TO  W-ENEN1.                                     D.090919
006300*****IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1                    D.090919
006310*****    ADD  DATE-NC1  TO  W-ENEN.                               D.090919
006320*****IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2                    D.090919
006330*****    ADD  DATE-NC2  TO  W-ENEN.                               D.090919
006340*****IF  W-ENEN2 > 90                                             D.981027
006350*****    ADD  1900  TO  W-ENEN                                    D.981027
006360*****  ELSE                                                       D.981027
006370*****    ADD  2000  TO  W-ENEN.                                   D.981027
006380 MR047.                                                           I.981022
006390     ACCEPT  ACP-EGET.                                            I.981022
006400     IF  ESTAT = "09"                                             I.981022
006410         GO  TO  MR046.                                           I.981022
006420     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006430         GO  TO  MR047.                                           I.981022
006440     IF  W-EGET < 1  OR  > 12                                     I.981022
006450         GO  TO  MR047.                                           I.981022
006460 MR048.                                                           I.981022
006470     ACCEPT  ACP-EPEY.                                            I.981022
006480     IF  ESTAT = "09"                                             I.981022
006490         GO  TO  MR047.                                           I.981022
006500     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006510         GO  TO  MR048.                                           I.981022
006520     IF  W-SPEY < 1  OR  > 31                                     I.981022
006530         GO  TO  MR048.                                           I.981022
006540     IF  W-SNGP > W-ENGP                                          I.981022
006550         GO  TO  MR046.                                           I.981022
006560     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981022
006570         GO  TO  MR046.                                           I.981022
006580 MR050.
006590     ACCEPT     ACP-OK.
006600     DISPLAY    DISP-MSG-SPACE.
006610     IF  ESTAT  =  "09"
006620*****    GO  TO  MR040.                                           D.950202
006630*****    IF  W-SEN     =  "1"               GO  TO  MR020         D.981022
006640*****IF  W-SEN = "1"                                              D.030722
006650     IF  W-SEN =  1                                               I.030722
006660         GO  TO  MR042                                            I.981022
006670       ELSE                                                       I.950202
006680         GO  TO  MR040.                                           I.950202
006690     IF  ESTAT  NOT  =  "01"
006700         GO  TO  MR050.
006710     IF  W-OK   NOT  =  "1"   AND      "9"
006720         GO  TO  MR050.
006730     IF  W-OK        =  "9"
006740         DISPLAY         CLE-02
006750         INITIALIZE   ACT-WORK
006760         GO  TO  MR010.
006770*
006780     IF  W-FOC     =  0                                           I.030722
006790         MOVE  1       TO  W-FOC                                  I.030722
006800         OPEN  I-O     JNIF                                       I.030722
006810         OPEN  INPUT   HI2-M   TC-M      JCON.                    I.030722
006820     IF  W-POC     =  0                                           I.030722
006830         MOVE  1       TO  W-POC                                  I.030722
006840         OPEN  OUTPUT  P-F.                                       I.030722
006850     MOVE    W-FROM   TO  JNIF1-01.
006860     MOVE    ZERO     TO  JNIF1-02.
006870 MR055.
006880     START   JNIF     KEY  NOT  <  JNIF1-KEY   INVALID
006890         GO  TO  MR999.
006900     MOVE   "ON"      TO         STR-SW.                          I.900416
006910 MR060.
006920     READ    JNIF     NEXT       AT   END
006930*********MOVE  SPACE  TO  P-R                                     D.900416
006940*********WRITE  P-R  AFTER  PAGE                                  D.900416
006950         GO  TO  MR990.                                           R.900416
006960*****IF  JNIF1-02    =    7                 GO  TO  MR065.        D.080121
006970     IF  JNIF1-02    =    7                                       I.080121
006980         IF  OLD1        =    JNIF1-01      GO  TO  MR065         I.080121
006990         ELSE                               GO  TO  MR060.        I.080121
007000     MOVE     JNIF1-07    TO       SV-GYO.                        I.890831
007010     MOVE     JNIF1-051   TO       SV-TCD.                        I.010305
007020     IF  JS-SIGN  =  0                                            I.890828
007030         IF   JNIF1-07    NOT  =  1             GO  TO  MR060.    I.060308
007040*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6 OR 7                D.051216
007050*****    IF   JNIF1-07    =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
007060*****                                           GO  TO  MR060.    D.060308
007070*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6   GO  TO  MR060.    D.980122
007080     IF  JS-SIGN  =  1                                            I.890828
007090         IF   JNIF1-07    NOT  =  6             GO  TO  MR060.    I.060308
007100*****    IF   JNIF1-07    NOT =  2 AND 3        GO  TO  MR060.    D.060308
007110     IF  JS-SIGN  =  2                                            I.900411
007120         IF   JNIF1-07    NOT  =  7             GO  TO  MR060.    I.060308
007130*****    IF   JNIF1-07    NOT =  5 AND 6        GO  TO  MR060.    D.060308
007140     IF  JS-SIGN  =  3                                            I.950201
007150         IF   JNIF1-07    NOT  =  4             GO  TO  MR060.    I.060308
007160*****    IF   JNIF1-07    NOT =  2 AND 3 AND 5 AND 6              D.060308
007170*****                                           GO  TO  MR060.    D.060308
007180*****IF  JS-SIGN  =  4                                            D.060308
007190*****    IF   JNIF1-07    NOT =  7              GO  TO  MR060.    D.060308
007200***
007210     IF  W-JS      NOT =  9                                       I.030707
007220         IF  JNIF1-13A   NOT =  W-JS            GO  TO  MR060.    I.030707
007230*****IF  W-JS     =  0                                            D.030707
007240*****    IF   JNIF1-13A   NOT =  0              GO  TO  MR060.    D.030707
007250*****IF  W-JS     =  1                                            D.030707
007260*****    IF   JNIF1-13A   NOT =  1              GO  TO  MR060.    D.030707
007270*****IF  W-JS     =  9                                            D.030707
007280*****    IF   JNIF1-13A   NOT =  0 AND 1        GO  TO  MR060.    D.030707
007290*****IF  JS-SIGN4 =  0                                            D.011109
007300*****    IF   JNIF1-051       =  0459  OR  0460  OR  3966         D.011109
007310*****                                           GO  TO  MR060.    D.011109
007320*****IF  JS-SIGN4 =  1                                            D.011109
007330*****    IF   JNIF1-051   NOT =  0459 AND  0460 AND  3966         D.011109
007340*****                                           GO  TO  MR060.    D.011109
007350     MOVE  ZERO      TO  W-NGP.                                   I.981027
007360     MOVE  JNIF1-04  TO  W-NGPS.                                  I.981022
007370     MOVE  20        TO  W-NEN1.                                  1.090919
007380*****IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     D.090919
007390*****    ADD  DATE-NC1  TO  W-NEN.                                D.090919
007400*****IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     D.090919
007410*****    ADD  DATE-NC2  TO  W-NEN.                                D.090919
007420*****IF  W-NEN2 > 90                                              D.981027
007430*****    ADD  1900  TO  W-NEN                                     D.981027
007440*****  ELSE                                                       D.981027
007450*****    ADD  2000  TO  W-NEN.                                    D.981027
007460     IF  W-NGP < W-SNGP  OR  > W-ENGP                             I.981022
007470         GO  TO  MR060.                                           I.981022
007480     MOVE   "OF"      TO         STR-SW.                          I.900416
007490     GO  TO   MR066.                                              I.890831
007500 MR065.
007510     IF  JS-SIGN  =  0                                            I.890828
007520         IF   SV-GYO      NOT  =  1             GO  TO  MR060.    I.060308
007530*****    IF   SV-GYO      =  2 OR 3 OR 5 OR 6 OR 7                D.051216
007540*****    IF   SV-GYO      =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
007550*****                                           GO  TO  MR060.    D.060308
007560*****    IF   SV-GYO      =  2 OR 3 OR 5 OR 6   GO  TO  MR060.    D.980122
007570     IF  JS-SIGN  =  1                                            I.890828
007580         IF   SV-GYO      NOT  =  6             GO  TO  MR060.    I.060308
007590*****    IF   SV-GYO      NOT =    2  AND  3    GO  TO  MR060.    D.060308
007600     IF  JS-SIGN  =  2                                            I.900411
007610         IF   SV-GYO      NOT  =  7             GO  TO  MR060.    I.060308
007620*****    IF   SV-GYO      NOT =    5  AND  6    GO  TO  MR060.    D.060308
007630     IF  JS-SIGN  =  3                                            I.950201
007640         IF   SV-GYO      NOT  =  4             GO  TO  MR060.    I.060308
007650*****    IF   SV-GYO      NOT =    2  AND  3  AND  5  AND  6      D.060308
007660*****                                           GO  TO  MR060.    D.060308
007670*****IF  JS-SIGN  =  4                                            D.060308
007680*****    IF   SV-GYO      NOT =    7            GO  TO  MR060.    D.060308
007690***
007700     IF  W-JS      NOT =  9                                       I.030707
007710         IF   JNIF2-07A   NOT =  W-JS           GO  TO  MR060.    I.030707
007720*****IF  W-JS     =  0                                            D.030707
007730*****    IF   JNIF2-07A   NOT =  0              GO  TO  MR060.    D.030707
007740*****IF  W-JS     =  1                                            D.030707
007750*****    IF   JNIF2-07A   NOT =  1              GO  TO  MR060.    D.030707
007760*****IF  W-JS     =  9                                            D.030707
007770*****    IF   JNIF2-07A   NOT =  0 AND 1        GO  TO  MR060.    D.030707
007780*****IF  JS-SIGN4 =  0                                            D.011109
007790*****    IF   SV-TCD          =  0459  OR  0460  OR  3966         D.011109
007800*****                                           GO  TO  MR060.    D.011109
007810*****IF  JS-SIGN4 =  1                                            D.011109
007820*****    IF   SV-TCD      NOT =  0459 AND  0460 AND  3966         D.011109
007830*****                                           GO  TO  MR060.    D.011109
007840     MOVE   "OF"      TO         STR-SW.                          I.900416
007850 MR066.
007860     IF  W-SEN    =  1
007870         IF  (JNIF1-10    =   0)   AND     (JNIF1-11     =    1)
007880             NEXT    SENTENCE
007890         ELSE        GO  TO  MR060.
007900     IF  W-SEN    =   2
007910         IF  JNIF1-10    =   1
007920             NEXT    SENTENCE
007930         ELSE        GO  TO  MR060.
007940     IF  W-FROM   >  JNIF1-01
007950         GO  TO  MR060.
007960     IF  W-TO     <  JNIF1-01
007970         MOVE  SPACE  TO  P-R
007980         WRITE  P-R  AFTER  PAGE
007990         GO  TO  MR999.
008000     IF  JNIF1-14  NOT  =    W-OKNO                               I.960821
008010         MOVE   JNIF1-14     TO   W-OKNO                          I.960821
008020         MOVE   ZERO         TO   W-NO.                           I.960821
008030     IF  JNIF1-01  NOT  =    OLD1
008040         PERFORM  HED-RTN  THRU   HED-EX
008050*****    MOVE   JNIF1-13     TO   G-CNT  M-CNT                    D.960821
008060*****    MOVE   JNIF1-13     TO   W-CNT.                          D.960821
008070*MR070.                                                           D.960821
008080         MOVE   JNIF1-13     TO   W-CNT                           I.960821
008090         MOVE   JNIF1-01     TO      OLD1.
008100     IF  JNIF1-02        =   7
008110         GO  TO  MR080.
008120     PERFORM     MOV-RTN    THRU   MOV-EX.
008130     GO  TO  MR060.
008140 MR080.
008150     MOVE  SPACE     TO     R3-R.                                 I.960821
008160     MOVE     K-1    TO     R3-K1.
008170     MOVE  M5-K2     TO     R3-K30.                               I.060308
008180     MOVE  M4-K5     TO     R3-K20.                               I.060308
008190     MOVE  JNIF2-03  TO     W-TEKI.                               *A631025
008200     MOVE  W-TEKI2   TO     P-TEKI1.                              "
008210     MOVE  JNIF2-02A TO     P-TEKI2.                              "
008220     MOVE  P-TEKI    TO     R3-01.                                "
008230     MOVE   SOUKO    TO     R3-02.                                I.920826
008240     MOVE     K-2    TO     R3-K2.
008250     IF  W-SEN   =    1
008260         PERFORM    RW2-RTN     THRU     RW2-EX.
008270     PERFORM     PRI-RTN    THRU     PRI-EX
008280         W-CNT       TIMES.
008290     INITIALIZE  R1-R     R2-R      MEI.
008300     MOVE  0  TO  SV-GYO.                                         I.981022
008310     MOVE  ZERO TO  SV-TCD.                                       I.010305
008320     GO  TO  MR060.
008330 MR990.                                                           I.900416
008340     IF  STR-SW  =  "ON"                    GO  TO  MR999.        I.900416
008350     MOVE  SPACE  TO  P-R.                                        I.900416
008360     WRITE  P-R  AFTER  PAGE.                                     I.900416
008370 MR999.
008380     PERFORM     END-RTN    THRU   END-EX.
008390     STOP  RUN.
008400*********************************************
008410*    ＩＮＴ－ＲＴＮ                         *
008420*********************************************
008430 INT-RTN.
008440     ACCEPT        JS-W.                                          I.091019
008450     IF  JS-W       >  3                      STOP  RUN.          I.091019
008460     IF  JS-W       =  0            MOVE  0       TO  JS-SIGN.    I.091019
008470     IF  JS-W       =  2            MOVE  1       TO  JS-SIGN.    I.091019
008480     IF  JS-W       =  3            MOVE  3       TO  JS-SIGN.    I.091019
008490*****ACCEPT        JS-SIGN.                                       D.091019
008500*****ACCEPT        W-JS.                                          D.030722
008510*****IF  JS-SIGN   =  0                                           D.011109
008520*****    IF  W-JS       =   1                                     D.011109
008530*****        ACCEPT     JS-SIGN4.                                 D.011109
008540*****ACCEPT        JS-SIGN3.                                      D.981029
008550*
008560     INITIALIZE     ACT-WORK.
008570     DISPLAY        CLE-01      DSP-AREA.
008580***
008590*****MOVE  SPACE         TO  WS-MID.                              D.030722
008600*****IF  W-JS       =  0   MOVE  NC"［教　育］"  TO  WS-MID.      D.030722
008610*****IF  W-JS       =  1   MOVE  NC"［ワーク］"  TO  WS-MID.      D.030722
008620*****IF  W-JS       =  2   MOVE  NC"［カジュ］"  TO  WS-MID.      D.030722
008630*****IF  W-JS       =  1   MOVE  NC"［一　般］"  TO  WS-MID.      D.030707
008640*****DISPLAY  DSP-MID.                                            D.030722
008650***
008660*****MOVE  SPACE         TO  WS-YOUSI.                            D.011109
008670*****IF  JS-SIGN4   =  0   MOVE  NC"社名あり用紙"  TO  WS-YOUSI.  D.011109
008680*****IF  JS-SIGN4   =  1   MOVE  NC"社名なし用紙"  TO  WS-YOUSI.  D.011109
008690*****IF  JS-SIGN    =  0                                          D.011109
008700*****    IF  W-JS       =   1                                     D.011109
008710*****        DISPLAY  DSP-YOUSI                                   D.011109
008720*****        IF  JS-SIGN4   =  1                                  D.011109
008730*****            MOVE  NC"〒"        TO  M2-UM                    D.011109
008740*****MOVE  NC"〒"        TO  M2-UM.                               D.060308
008750*****MOVE    "TEL"       TO  M5-TM.                               D.060308
008760***
008770*****IF  JS-SIGN      =  4                                        D.011018
008780*****    OPEN  I-O      GDMM                                      D.011018
008790*****    MOVE  "0"      TO  GDMM-KEY                              D.011018
008800*****    READ  GDMM     INVALID  KEY                              D.011018
008810*****          CLOSE    GDMM                                      D.011018
008820*****          DISPLAY  DSP-GDMM   DISP-BUZ-B                     D.011018
008830*****          STOP  RUN.                                         D.011018
008840*****OPEN  I-O     JNIF                                           D.030722
008850*****OPEN  INPUT   SHM     TC-M      JCON                         D.010808
008860*****OPEN  INPUT   HI2-M   TC-M      JCON                         D.030722
008870*****OPEN  OUTPUT  P-F.                                           D.030722
008880 INT-EX.
008890     EXIT.
008900*********************************************
008910*    ＥＮＤ－ＲＴＮ                         *
008920*********************************************
008930 END-RTN.
008940     IF  W-FOC     =  1                                           I.030722
008950         CLOSE  JNIF    HI2-M   TC-M    JCON.                     I.030722
008960     IF  W-POC     =  1                                           I.030722
008970         CLOSE  P-F.                                              I.030722
008980*****CLOSE  JNIF    SHM     TC-M    JCON    P-F.                  D.010808
008990*****CLOSE  JNIF    HI2-M   TC-M    JCON    P-F.                  D.030722
009000*****IF  JS-SIGN      =  4              CLOSE  GDMM.              D.011018
009010     DISPLAY CLE-01.
009020 END-EX.
009030     EXIT.
009040**********************************************
009050*    ＨＥＤ－ＲＴＮ                          *
009060**********************************************
009070 HED-RTN.
009080     MOVE    JNIF1-05    TO  TC-KEY.
009090     READ    TC-M    WITH UNLOCK     INVALID
009100         MOVE   SPACE   TO  TC-UNO
009110         MOVE  ALL NX"2121"  TO  TC-NAME
009120         MOVE  ALL NX"2121"  TO  TC-JSU
009130         MOVE  ALL NX"2121"  TO  TC-JSS.
009140     MOVE   TC-UNO    TO  M1-01.
009150     MOVE   JNIF1-01  TO  M1-02.
009160     MOVE   JNIF1-041 TO  M1-03.
009170     MOVE   JNIF1-042 TO  M1-04.
009180     MOVE   JNIF1-043 TO  M1-05.
009190     MOVE   JNIF1-14  TO  M1-06.
009200     MOVE   TC-JSU   TO  M2-01.
009210     MOVE   TC-JSS   TO  M3-01.
009220     IF  JNIF1-08    <   0
009230             MOVE      NC"－"      TO       M3-02
009240     ELSE    MOVE      NC"　"      TO       M3-02.
009250     IF  JNIF1-08  =  ZERO   MOVE  "***"  TO    A                 I900524
009260                ELSE         MOVE   JNIF1-08 TO  AAR.
009270     MOVE   A        TO  M4-01.
009280     MOVE   TC-NAME  TO  M5-01.
009290     MOVE   JNIF1-06 TO  JCON2-02.
009300     MOVE   "2"      TO  JCON2-01.
009310     READ   JCON     WITH UNLOCK  INVALID
009320         MOVE   ALL NX"2121"  TO  JCON2-03.
009330     MOVE   JCON2-03 TO  M5-02.
009340     MOVE   JNIF1-07 TO  JCON3-02.
009350     MOVE   "3"      TO  JCON3-01.
009360     READ   JCON     WITH UNLOCK  INVALID
009370         MOVE   ALL NX"2121"  TO  JCON3-03.
009380     MOVE   JCON3-03 TO  SOUKO.                                   I.920826
009390     IF  JNIF1-07    =   1                                        I.090519
009400         IF  JNIF1-051   =   2654  OR  2656  OR  2657  OR  4038   I.090519
009410                                   OR  4054  OR  4056  OR  4057   I.090519
009420             MOVE      NC"富　士　　　"  TO       SOUKO.          I.090519
009430     MOVE   SPACE    TO  M0-01.                                   I.090919
009440     IF  JNIF1-051   =   2650  OR  2651  OR  2652                 I.090919
009450         IF  JNIF1-052 NOT =   001                                I.090919
009460             MOVE   NC"☆☆☆☆☆"    TO  M0-01.                  I.090919
009470     IF  JNIF1-051   =   7040                                     I.101013
009480         MOVE   NC"◎◎◎◎◎"    TO  M0-01.                      I.101013
009490*****MOVE   JCON3-03 TO  M3-03.                                   D.920826
009500*****MOVE   "("      TO  M3-03F.                                  D.920826
009510*****MOVE   ")"      TO  M3-03R.                                  D.920826
009520*****IF  JS-SIGN     NOT =  0                                     D.011109
009530*****    GO  TO HED-EX.                                           D.011109
009540*****IF  W-JS        NOT =  1                                     D.011109
009550*****    GO  TO HED-EX.                                           D.011109
009560*****IF  JS-SIGN4    NOT =  1                                     D.011109
009570*****    GO  TO HED-EX.                                           D.011109
009580*****IF  JNIF1-052       =  001                                   D.060308
009590*****    MOVE  "700-0034"       TO  M2-UNO                        D.051202
009600*****    MOVE  NC"岡山市高柳東町１３－４６　　" TO  M3-JS         D.051202
009610*****    MOVE  "700-0975"       TO  M2-UNO                        D.060308
009620*****    MOVE  NC"岡山市今８丁目１６－１７　　" TO  M3-JS         D.060308
009630*****    MOVE  NC"日進ゴム株式会社　　" TO  M4-NA                 D.060308
009640*****    MOVE  "086-243-2456  " TO  M5-TEL                        D.060308
009650*****    MOVE  "086-252-2456  " TO  M5-TEL                        D.051202
009660*****    GO  TO HED-EX.                                           D.060308
009670*****IF  JNIF1-051       =  4038                                  D.091112
009680     IF  JNIF1-051       =  4038  OR  4054  OR  4056  OR  4057    I.091112
009690         MOVE  "542-0081"       TO  M2A-UNO                       I.090519
009700         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.090519
009710         MOVE  NC"大阪市中央区南船場　　　　　" TO  M2-JSN        I.090519
009720         MOVE  NC"　　　　　　　１丁目１１－９" TO  M3-JS         I.090519
009730         MOVE  NC"千曲産業株式会社　　" TO  M4-NA                 I.090519
009740         MOVE  "06-6268-4561  " TO  M5-TEL                        I.090519
009750         GO  TO HED-EX.                                           I.090519
009760     IF  JNIF1-051       =  2654  OR  2656  OR  2657              I.090519
009770         MOVE  "520-2132"       TO  M2A-UNO                       I.090519
009780         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.090519
009790         MOVE  NC"滋賀県大津市神領１－９－３　" TO  M2-JSN        I.090519
009800         MOVE  NC"　　　　　　　　　　　　　　" TO  M3-JS         I.090519
009810         MOVE  NC"株式会社新日本教育シューズ　" TO  M4-NA         I.090519
009820         MOVE  "077-543-1331  " TO  M5-TEL                        I.090519
009830         GO  TO HED-EX.                                           I.090519
009840     IF  JNIF1-052   NOT =  001                                   I.060308
009850         IF  JNIF1-051       =  0459                              I.010305
009860*****    MOVE  "663-8033"       TO  M2-UNO                        D.060308
009870*****    MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M3-JS         D.060308
009880             MOVE  "663-8033"       TO  M2A-UNO                   I.060308
009890             MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M2-JSN    I.060308
009900             MOVE  NC"株式会社上山實業　　" TO  M4-NA             I.010305
009910             MOVE  "0798-64-5111  " TO  M5-TEL                    I.011109
009920             GO  TO HED-EX.                                       I.060308
009930*****  ELSE                                                       D.060308
009940*****    MOVE  "0798-64-5111  " TO  M5-TEL.                       D.011109
009950     IF  JNIF1-052   NOT =  001                                   I.060308
009960         IF  JNIF1-051       =  0460                              I.010305
009970*****        MOVE  "663-8033"       TO  M2-UNO                    D.060308
009980*****        MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M3-JS     D.060308
009990             MOVE  "663-8033"       TO  M2A-UNO                   I.060308
010000             MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M2-JSN    I.060308
010010             MOVE  NC"株式会社ウエヤマ　　" TO  M4-NA             I.010305
010020             MOVE  "0798-67-0810  " TO  M5-TEL                    I.011109
010030             GO  TO HED-EX.                                       I.060308
010040     IF  JNIF1-051       =  3015                                  I.110804
010050         MOVE  "114-0034"       TO  M2A-UNO                       I.110804
010060         MOVE  NC"東京都北区上十条４－１－５　" TO  M2-JSN        I.110804
010070         MOVE  NC"株式会社スギヤマ　　" TO  M4-NA                 I.110804
010080         MOVE  "03-3909-8883  " TO  M5-TEL                        I.110804
010090         GO  TO HED-EX.                                           I.110804
010100*****      ELSE                                                   D.060308
010110*****        MOVE  "0798-67-0810  " TO  M5-TEL.                   D.011109
010120*****IF  JNIF1-052   NOT =  001                                   D.090919
010130*****    IF  JNIF1-051       =  3966                              D.090919
010140*****            MOVE  "165-0021"       TO  M2-UNO                D.060308
010150*****            MOVE  NC"東京都中野区丸山２－５－１９" TO  M3-JS D.060308
010160*****        MOVE  "165-0021"       TO  M2A-UNO                   D.090919
010170*****        MOVE  NC"東京都中野区丸山２－５－１９" TO  M2-JSN    D.090919
010180*****        MOVE  NC"多比良株式会社　　　" TO  M4-NA             D.090919
010190*****        MOVE  "03-5373-6711  " TO  M5-TEL                    D.090919
010200*****        GO  TO HED-EX.                                       D.090919
010210*****          ELSE                                               D.060308
010220*****            MOVE  "700-0034"       TO  M2-UNO                D.051202
010230*****            MOVE  NC"岡山市高柳東町１３－４６　　" TO  M3-JS D.051202
010240*****            MOVE  "700-0975"       TO  M2-UNO                D.060308
010250*****            MOVE  NC"岡山市今８丁目１６－１７　　" TO  M3-JS D.060308
010260     IF  JS-SIGN         =  0                                     I.060308
010270         MOVE  "700-0975"       TO  M2A-UNO                       I.060308
010280         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.060308
010290*****    MOVE  NC"岡山市今８丁目１６－１７　　" TO  M2-JSN        D.090519
010300         MOVE  NC"岡山市北区今８丁目１６－１７" TO  M2-JSN        I.090519
010310         MOVE  NC"　　　　　　　　　　　　　　" TO  M3-JS         I.060308
010320         MOVE  NC"日進ゴム株式会社　　" TO  M4-NA                 I.011109
010330     ELSE  IF  JS-SIGN         =  1                               I.060308
010340               MOVE  "701-0221"       TO  M2A-UNO                 I.170403
010350               MOVE  NC"岡山市南区　" TO  M2A-JSO                 I.170403
010360               MOVE  NC"　　　藤田錦５６４－１８９　" TO  M2-JSN  I.170403
010370               MOVE  NC"日本通運㈱岡山支店藤田倉庫内" TO  M3-JS   I.170403
010380               MOVE  NC"日進ゴム㈱　藤田配送センター" TO  M4-NA   I.170403
010390*****          MOVE  "713-8103"       TO  M2A-UNO                 D.170403
010400*****          MOVE  NC"岡山県倉敷市" TO  M2A-JSO                 D.170403
010410*****          MOVE  NC"玉島乙島字新湊８２６２－１　" TO  M2-JSN  D.170403
010420*****          MOVE  NC"　　水島港国際物流センター内" TO  M3-JS   D.170403
010430*****          MOVE  NC"日進ゴム㈱　玉島物流センター" TO  M4-NA   D.170403
010440     ELSE  IF  JS-SIGN         =  2                               I.060308
010450               MOVE  "709-3717"       TO  M2A-UNO                 I.060308
010460               MOVE  NC"　　　　　　" TO  M2A-JSO                 I.060308
010470               MOVE  NC"岡山県久米郡　　　　　　　　" TO  M2-JSN  I.060308
010480               MOVE  NC"　　美咲町原田３２２７－１　" TO  M3-JS   I.060308
010490               MOVE  NC"日進ゴム㈱　津山物流センター" TO  M4-NA   I.060308
010500     ELSE  IF  JS-SIGN         =  3                               I.060308
010510               MOVE  "701-0304"       TO  M2A-UNO                 I.060926
010520               MOVE  NC"岡山県都窪郡" TO  M2A-JSO                 I.060926
010530               MOVE  NC"早島町早島４５０７－３７　　" TO  M2-JSN  I.060926
010540*****          MOVE  NC"両備運輸中四国配送センター内" TO  M3-JS   D.080121
010550               MOVE  NC"両備ＨＤ中四国物流センター内" TO  M3-JS   I.080121
010560               MOVE  NC"日進ゴム　早島配送センター　" TO  M4-NA.  I.060926
010570*****          MOVE  "703-8233"       TO  M2A-UNO                 D.060926
010580*****          MOVE  NC"　　　　　　" TO  M2A-JSO                 D.060926
010590*****          MOVE  NC"岡山市高屋３０８　　　　　　" TO  M2-JSN  D.060926
010600*****          MOVE  NC"　　　　　両備運輸㈱内　　　" TO  M3-JS   D.060926
010610*****          MOVE  NC"日進ゴム㈱　高屋配送センター" TO  M4-NA.  D.060926
010620     MOVE  "086-243-2456  " TO  M5-TEL.                           I.011109
010630*****            MOVE  "086-252-2456  " TO  M5-TEL.               D.051202
010640*****            MOVE  "03-5373-6711  " TO  M5-TEL.               D.011109
010650 HED-EX.
010660     EXIT.
010670**********************************************
010680*    ＰＲＩ－ＲＴＮ                          *
010690**********************************************
010700 PRI-RTN.
010710     MOVE SPACE  TO  P-R.
010720     IF  LCNT    NOT =  90
010730         WRITE  P-R  AFTER  PAGE.
010740     MOVE    SPACE  TO  W-P.                                      I.090919
010750     MOVE    MID0-R TO  W-P.                                      I.090919
010760     MOVE    W-P    TO  P-R.                                      I.090919
010770     WRITE   P-R  AFTER 3.                                        I.090919
010780     MOVE    SPACE TO  P-R.                                       I.090919
010790     MOVE    SPACE  TO  W-P.                                      I.961015
010800*****MOVE    MID1-R TO  P-R.                                      D.961015
010810*****IF  JS-SIGN3    =  0                                         D.981029
010820*****                MOVE    MID1-R TO  W-P1                      D.981029
010830*****          ELSE                                               D.981029
010840     MOVE    MID1-R TO  W-P.                                      I.961015
010850     MOVE    W-P    TO  P-R.                                      I.961015
010860     WRITE   P-R  AFTER 2.                                        I.090919
010870*****WRITE   P-R  AFTER 5.                                        D.090919
010880     MOVE    SPACE TO  P-R.
010890     ADD     1     TO  W-NO.                                      I.960821
010900     MOVE    W-NO  TO  M2-02.                                     I.960821
010910*****IF      G-CNT  <  2           GO       TO  PRI-005.          D 920614
010920*****IF      G-CNT  <  2           GO       TO  PRI-005.          D.960821
010930*****IF      G-CNT  <  2                                          D.920826
010940*****        WRITE  P-R  AFTER  1                                 D.920826
010950*****        GO TO  PRI-005.                                      D.920826
010960*****IF      G-CNT  =  M-CNT       MOVE  0  TO  M-CNT.            D.960821
010970*****ADD     1     TO  M-CNT.                                     D.960821
010980*****MOVE    M-CNT TO  M2-02.                                     D.960821
010990*****MOVE    M-CNT TO  M1A-01.                                    D.920826
011000*****MOVE    MID1A-R  TO  P-R.                                    D.920826
011010*****WRITE   P-R   AFTER  1.                                      D.920826
011020*****MOVE    SPACE TO  P-R.                                       D.920826
011030 PRI-005.                                                         A 911106
011040     MOVE    SPACE   TO  W-P.                                     I.961015
011050*****MOVE    MID2-R  TO  P-R.                                     D.961015
011060*****IF  JS-SIGN3    =  0                                         D.981029
011070*****                MOVE    MID2-R  TO  W-P1                     D.981029
011080*****           ELSE                                              D.981029
011090***  WRITE   P-R  AFTER 2.                                        D 911106
011100*****WRITE   P-R  AFTER 1.                                        D.920826
011110     MOVE    MID2A-R TO  W-P.                                     I.060308
011120     MOVE    W-P     TO  P-R.                                     I.060308
011130     WRITE   P-R  AFTER 1.                                        I.060308
011140     MOVE    SPACE TO  P-R.                                       I.060308
011150     MOVE    SPACE   TO  W-P.                                     I.060308
011160     MOVE    MID2-R  TO  W-P.                                     I.961015
011170     MOVE    W-P     TO  P-R.                                     I.961015
011180     WRITE   P-R  AFTER 1.                                        I.060308
011190*****WRITE   P-R  AFTER 2.                                        D.060308
011200     MOVE    SPACE TO  P-R.
011210     MOVE    SPACE   TO  W-P.                                     I.961015
011220*****MOVE    MID3-R  TO  P-R.                                     D.961015
011230*****IF  JS-SIGN3    =  0                                         D.981029
011240*****                MOVE    MID3-R  TO  W-P1                     D.981029
011250*****           ELSE                                              D.981029
011260     MOVE    MID3-R  TO  W-P.                                     I.961015
011270     MOVE    W-P     TO  P-R.                                     I.961015
011280     WRITE   P-R  AFTER 1.
011290     MOVE    SPACE TO  P-R.
011300     MOVE    SPACE   TO  W-P.                                     I.961015
011310*****MOVE    MID4-R  TO  P-R.                                     D.961015
011320*****IF  JS-SIGN3    =  0                                         D.981029
011330*****                MOVE    MID4-R  TO  W-P1                     D.981029
011340*****           ELSE                                              D.981029
011350     MOVE    MID4-R  TO  W-P.                                     I.961015
011360     MOVE    W-P     TO  P-R.                                     I.961015
011370     WRITE   P-R  AFTER 1.
011380     MOVE    SPACE TO  P-R.
011390     MOVE    SPACE   TO  W-P.                                     I.961015
011400     MOVE  MID5-R        TO  W-P.                                 I.011109
011410     MOVE  W-P           TO  P-R.                                 I.011109
011420     WRITE  P-R     AFTER  1.                                     I.011109
011430     MOVE  SPACE         TO  P-R.                                 I.011109
011440     MOVE  SPACE         TO  W-P.                                 I.011109
011450     WRITE   P-R  AFTER 2.                                        I.021108
011460*****IF  JS-SIGN4    =  1                                         D.011109
011470*****    MOVE  MID5-R        TO  W-P                              D.011109
011480*****    MOVE  W-P           TO  P-R                              D.011109
011490*****    WRITE  P-R     AFTER  1                                  D.011109
011500*****    MOVE  SPACE         TO  P-R                              D.011109
011510*****    MOVE  SPACE         TO  W-P                              D.011109
011520*****  ELSE                                                       D.011109
011530*****    WRITE  P-R     AFTER  1.                                 D.011109
011540*****WRITE   P-R  AFTER 3.                                        D.950317
011550*****MOVE    MID6-R  TO  P-R.                                     D.961015
011560*****IF  JS-SIGN3    =  0                                         D.981029
011570*****                MOVE    MID6-R  TO  W-P1                     D.981029
011580*****           ELSE                                              D.981029
011590*****MOVE    MID6-R  TO  W-P.                                     D.021108
011600*****MOVE    W-P     TO  P-R.                                     D.021108
011610*****WRITE   P-R  AFTER 1.                                        D.021108
011620*****WRITE   P-R  AFTER 2.                                        D.010305
011630*****MOVE    SPACE TO  P-R.                                       D.021108
011640*****WRITE   P-R  AFTER 1.                                        D.021108
011650     MOVE    0    TO    I.
011660 PRI-010.
011670     ADD     1    TO    I.
011680     IF      I     >    6
011690         GO  TO  PRI-020.
011700     MOVE    MEI1-R(I)     TO    P-R.
011710     WRITE   P-R  AFTER 1.
011720     MOVE    SPACE TO  P-R.
011730     MOVE    MEI2-R(I)     TO    P-R.
011740     WRITE   P-R  AFTER 1.
011750     MOVE    SPACE TO  P-R.
011760     GO  TO  PRI-010.
011770 PRI-020.
011780     MOVE    SPACE         TO    W-P.                             I.961015
011790*****MOVE    R3-R          TO    P-R.                             D.961015
011800*****IF  JS-SIGN3    =  0                                         D.981029
011810*****                MOVE    R3-R          TO    W-P1             D.981029
011820*****           ELSE                                              D.981029
011830     MOVE    R3-R          TO    W-P.                             I.961015
011840     MOVE    W-P           TO    P-R.                             I.961015
011850     WRITE   P-R  AFTER 1.                                        I.060308
011860*****WRITE   P-R  AFTER 2.                                        D.060308
011870     MOVE    SPACE TO  P-R.
011880*
011890     MOVE    SPACE TO  R2-R.                                      I.091214
011900     MOVE   K-1    TO  R2-K1.                                     I.091214
011910     MOVE    SPACE TO  R2-01.                                     I.091214
011920     MOVE   K-2    TO  R2-K2.                                     I.091214
011930     MOVE   W-KEI  TO  R2-03.                                     I.091214
011940     MOVE    SPACE         TO    W-P.                             I.091214
011950     MOVE    R2-R          TO    W-P.                             I.091214
011960     MOVE    W-P           TO    P-R.                             I.091214
011970     WRITE   P-R  AFTER 1.                                        I.091214
011980     MOVE    SPACE TO  P-R.                                       I.091214
011990*
012000     MOVE    0     TO  W-KEI.                                     I.091214
012010     MOVE    7     TO  LCNT.
012020 PRI-EX.
012030     EXIT.
012040***************************************************
012050*    ＴＳＴ－ＲＴＮ                               *
012060***************************************************
012070 TST-RTN.
012080     IF  W-POC     =  0                                           I.030722
012090         MOVE  1       TO  W-POC                                  I.030722
012100         OPEN  OUTPUT  P-F.                                       I.030722
012110     MOVE    SPACE   TO  P-R.
012120     IF   LCNT   NOT   =     90
012130         WRITE   P-R     AFTER    PAGE.
012140     MOVE   ALL "X" TO  M1-01.
012150     MOVE   ALL "9" TO  M1-02.
012160     MOVE   "99"    TO  M1-03.
012170     MOVE   "99"    TO  M1-04.
012180     MOVE   "99"    TO  M1-05.
012190     MOVE   ALL "9" TO  M1-06.                                    I.920826
012200     MOVE   SPACE   TO  W-P.                                      I.961015
012210*****MOVE   MID1-R  TO  P-R.                                      D.961015
012220*****IF  JS-SIGN3    =  0                                         D.981029
012230*****                MOVE   MID1-R  TO  W-P1                      D.981029
012240*****           ELSE                                              D.810295
012250     MOVE   MID1-R  TO  W-P.                                      I.961015
012260     MOVE   W-P     TO  P-R.                                      I.961015
012270     WRITE  P-R     AFTER   5.
012280     MOVE   SPACE   TO  P-R.
012290     MOVE   SPACE   TO  M2A-JSO.                                  I.060308
012300     MOVE  ALL NC"Ｎ"   TO    M2-JSN.                             I.060308
012310     MOVE  ALL NC"Ｎ"   TO    M2-01.
012320*****MOVE   ALL "X" TO  M2-UNO.                                   D.060308
012330     MOVE   ALL "X" TO  M2A-UNO.                                  I.060308
012340     MOVE    SPACE   TO    W-P.                                   I.961015
012350     MOVE    MID2A-R TO    W-P.                                   I.060308
012360     MOVE    W-P     TO    P-R.                                   I.060308
012370     WRITE   P-R     AFTER     1.                                 I.060308
012380     MOVE    SPACE   TO    P-R.                                   I.060308
012390     MOVE    SPACE   TO    W-P.                                   I.060308
012400*****MOVE    MID2-R  TO    P-R.                                   D.961015
012410*****IF  JS-SIGN3    =  0                                         D.981029
012420*****                MOVE    MID2-R  TO    W-P1                   D.981029
012430*****           ELSE                                              D.981029
012440     MOVE    MID2-R  TO    W-P.                                   I.961015
012450     MOVE    W-P     TO    P-R.                                   I.961015
012460     WRITE   P-R     AFTER     1.                                 I.060308
012470*****WRITE   P-R     AFTER     2.                                 D.060308
012480     MOVE    SPACE   TO    P-R.
012490     MOVE  ALL NC"Ｎ"   TO    M3-01.
012500     MOVE  ALL NC"Ｎ"   TO    M3-02.
012510     MOVE  ALL NC"Ｎ"   TO    M3-JS.                              I.010305
012520     MOVE  SPACE       TO    W-P.                                 I.961015
012530*****MOVE  ALL NC"Ｎ"   TO    M3-03.                              D.920826
012540*****MOVE   "("      TO  M3-03F.                                  D.920826
012550*****MOVE   ")"      TO  M3-03R.                                  D.920826
012560*****MOVE  MID3-R      TO    P-R.                                 D.961015
012570*****IF  JS-SIGN3    =  0                                         D.981029
012580*****                MOVE  MID3-R      TO    W-P1                 D.981029
012590*****           ELSE                                              D.981029
012600     MOVE  MID3-R      TO    W-P.                                 I.961015
012610     MOVE  W-P         TO    P-R.                                 I.961015
012620     WRITE   P-R       AFTER   1.
012630     MOVE  SPACE       TO    P-R.
012640     MOVE  ALL NC"Ｎ"   TO    M4-01.
012650     MOVE  ALL NC"Ｎ"   TO    M5-01.
012660     MOVE  ALL NC"Ｎ"   TO    M5-02.
012670     MOVE  ALL NC"Ｎ"   TO    M4-NA.                              I.010305
012680     MOVE  SPACE       TO    W-P.                                 I.961015
012690*****MOVE  MID4-R      TO    P-R.                                 D.961015
012700*****IF  JS-SIGN3    =  0                                         D.981029
012710*****                MOVE  MID4-R      TO    W-P1                 D.981029
012720*****           ELSE                                              D.981029
012730     MOVE  MID4-R      TO    W-P.                                 I.961015
012740     MOVE  W-P         TO    P-R.                                 I.961015
012750     WRITE   P-R   AFTER 1.
012760     MOVE   SPACE      TO    P-R.
012770     MOVE  ALL "X"       TO  M5-TEL.                              I.011109
012780     MOVE  MID5-R        TO  W-P.                                 I.011109
012790     MOVE  W-P           TO  P-R.                                 I.011109
012800     WRITE  P-R     AFTER  1.                                     I.011109
012810     MOVE  SPACE         TO  P-R.                                 I.011109
012820     WRITE  P-R     AFTER  2.                                     I.011109
012830*****IF  JS-SIGN4    =  1                                         D.011109
012840*****    MOVE  ALL "X"       TO  M5-TEL                           D.011109
012850*****    MOVE  MID5-R        TO  W-P                              D.011109
012860*****    MOVE  W-P           TO  P-R                              D.011109
012870*****    WRITE  P-R     AFTER  1                                  D.011109
012880*****    MOVE  SPACE         TO  P-R                              D.011109
012890*****    WRITE  P-R     AFTER  2                                  D.011109
012900*****  ELSE                                                       D.011109
012910*****    WRITE   P-R   AFTER 3.                                   D.011109
012920     MOVE    0         TO    LCNT.
012930 TST-010.
012940     MOVE    K-1     TO    R1-K1.
012950     MOVE  ALL NC"Ｎ" TO    R1-01.
012960     MOVE    K-2     TO    R1-K2.
012970     MOVE    SPACE   TO    W-P.                                   I.961015
012980*****MOVE    R1-R    TO    P-R.                                   D.961015
012990*****IF  JS-SIGN3    =  0                                         D.981029
013000*****                MOVE    R1-R    TO    W-P1                   D.981029
013010*****           ELSE                                              D.981029
013020     MOVE    R1-R    TO    W-P.                                   I.961015
013030     MOVE    W-P     TO    P-R.                                   I.961015
013040     WRITE   P-R     AFTER     1.
013050*****WRITE   P-R     AFTER     1.                                 D.980318
013060     MOVE    SPACE   TO    P-R.
013070     MOVE    K-1     TO    R2-K1.
013080     MOVE  ALL NC"Ｎ" TO    R2-01.
013090     MOVE    0       TO    I.
013100 TST-020.
013110     ADD     1       TO    I.
013120*****IF      I       >     27                                     D.920826
013130     IF      I       >     25                                     I.920826
013140         GO  TO  TST-030.
013150     MOVE  ALL "9"   TO    R2-021(I).
013160     GO  TO  TST-020.
013170 TST-030.
013180     MOVE  ALL "9"   TO    R2-03.
013190     MOVE  SPACE     TO    W-P.                                   I.961015
013200*****MOVE  R2-R      TO    P-R.                                   D.961015
013210*****IF  JS-SIGN3    =  0                                         D.981029
013220*****                MOVE  R2-R      TO    W-P1                   D.981029
013230*****           ELSE                                              D.981029
013240     MOVE  R2-R      TO    W-P.                                   I.961015
013250     MOVE  W-P       TO    P-R.                                   I.961015
013260     WRITE   P-R     AFTER     1.
013270     MOVE SPACE      TO  P-R.
013280     ADD     1       TO  LCNT.
013290     IF    LCNT   NOT   =    6
013300         GO  TO  TST-010.
013310     MOVE    K-1     TO   R3-K1.
013320     MOVE    M5-K2   TO   R3-K30.                                 I.060308
013330     MOVE    M4-K5   TO   R3-K20.                                 I.060308
013340     MOVE  ALL NC"Ｎ" TO   R3-01.
013350     MOVE  ALL NC"Ｎ" TO   R3-02.                                 I.920826
013360     MOVE    K-2     TO   R3-K2.
013370     MOVE    SPACE   TO   W-P.                                    I.961015
013380*****MOVE    R3-R    TO   P-R.                                    D.961015
013390*****IF  JS-SIGN3    =  0                                         D.981029
013400*****                MOVE    R3-R    TO   W-P1                    D.981029
013410*****           ELSE                                              D.981029
013420     MOVE    R3-R    TO   W-P.                                    I.961015
013430     MOVE    W-P     TO   P-R.                                    I.961015
013440     WRITE   P-R     AFTER     1.                                 I.060208
013450*****WRITE   P-R     AFTER     2.                                 D.060208
013460     MOVE SPACE      TO  P-R.
013470     ADD     1       TO  LCNT.
013480 TST-EX.
013490     EXIT.
013500***************************************************
013510*    ＭＯＶ－ＲＴＮ                               *
013520***************************************************
013530 MOV-RTN.
013540     MOVE   SPACE    TO  R1-R  R2-R  MEI1-R(JNIF1-02)             I.941206
013550                                     MEI2-R(JNIF1-02).            I.941206
013560     MOVE   K-1      TO  R1-K1.
013570     MOVE   JNIF1-03 TO  HI-MHCD HI-HCD.                          I.010808
013580     READ   HI2-M    WITH UNLOCK  INVALID                         I.010808
013590         MOVE   ZERO          TO  HI-ASSD                         I.010808
013600         MOVE   ZERO          TO  HI-HKB                          I.060822
013610         MOVE   ALL NX"2121"  TO  HI-NAME HI-SMS.                 I.090919
013620*****    MOVE   ALL NX"2121"  TO  HI-NAME.                        D.090919
013630*****MOVE   JNIF1-03 TO  SHM-KEY.                                 D.010808
013640*****READ   SHM      WITH UNLOCK  INVALID                         D.010808
013650*****    MOVE   ZERO          TO  SHM-04                          D.010808
013660*****    MOVE   ALL NX"2121"  TO  SHM-02.                         D.010808
013670*****MOVE   SHM-02  TO  W-SHM.                                    D.960821
013680*****IF    W-SHM-022  =  SPACE           GO  TO  MOV-002.         D.960821
013690*****MOVE  15        TO  W-NC.                                    D.960821
013700     MOVE   ALL NX"2121"     TO  W-NNA  W-ONA  W-UNA.             I.960821
013710*****IF    SHM-02        =   SPACE                                D.010808
013720*****IF    HI-NAME       =   SPACE                                D.090919
013730     IF    SPACE         =   HI-NAME   AND  HI-SMS                I.090919
013740                         GO  TO  MOV-008.                         I.960821
013750*****IF    HI-SMS    NOT =   SPACE                                D.100625
013760     IF   (HI-SMS    NOT =   SPACE)  AND  (JNIF1-07      =  6)    I.100625
013770           MOVE   HI-SMS  TO  W-NNA                               I.090919
013780     ELSE                                                         I.090919
013790           MOVE   HI-NAME TO  W-NNA.                              I.010808
013800*****MOVE   SHM-02  TO  W-NNA.                                    D.010808
013810*****IF    JNIF1-051     =   0459  OR  0460                       D.010709
013820     IF    JNIF1-051     =   0013  OR  0459  OR  0460             I.010709
013830           MOVE  SPACE   TO  W-NNM(24).                           I.000808
013840     MOVE   25      TO  W-C1.                                     I.960821
013850 MOV-001.                                                         ﾞ
013860     SUBTRACT    1    FROM   W-C1.                                I.960821
013870     IF    W-C1          =    ZERO                                I.960821
013880                         GO  TO  MOV-008.                         I.960821
013890     IF    W-NNM(W-C1)   =   SPACE                                I.960821
013900                         GO  TO  MOV-001.                         I.960821
013910     IF    W-C1          <   15                                   I.960821
013920                         MOVE   W-NNA      TO  W-UNA              I.960821
013930                         GO  TO  MOV-008.                         I.960821
013940     MOVE   ZERO    TO  W-C2.                                     I.960821
013950*****SUBTRACT    1    FROM   W-NC.                                D.960821
013960*****IF    W-NC  =    4                                           D.960821
013970*****            MOVE    SHM-02   TO  W-SHM                       D.960821
013980*****            GO  TO  MOV-002.                                 D.960821
013990*****IF    WSH-01(W-NC)  =   SPACE       GO  TO  MOV-002.         D.960821
014000*****IF    WSH-02(1)     =   SPACE       GO  TO  MOV-002.         D.960821
014010*****IF    WSH-02(10)    NOT  =  SPACE                            D.960821
014020*****            MOVE  SHM-02  TO  W-SHM                          D.960821
014030*****            GO  TO  MOV-002.                                 D.960821
014040*****MOVE  WSH-02(9)  TO  WSH-02(10).                             D.960821
014050*****MOVE  WSH-02(8)  TO  WSH-02(9).                              D.960821
014060*****MOVE  WSH-02(7)  TO  WSH-02(8).                              D.960821
014070*****MOVE  WSH-02(6)  TO  WSH-02(7).                              D.960821
014080*****MOVE  WSH-02(5)  TO  WSH-02(6).                              D.960821
014090*****MOVE  WSH-02(4)  TO  WSH-02(5).                              D.960821
014100*****MOVE  WSH-02(3)  TO  WSH-02(4).                              D.960821
014110*****MOVE  WSH-02(2)  TO  WSH-02(3).                              D.960821
014120*****MOVE  WSH-02(1)  TO  WSH-02(2).                              D.960821
014130*****MOVE  WSH-01(W-NC) TO  WSH-02(1).                            D.960821
014140*****MOVE  SPACE      TO  WSH-01(W-NC).                           D.960821
014150*****GO  TO  MOV-001.                                             D.960821
014160 MOV-002.                                                         ﾞ
014170     ADD         1    TO     W-C2.                                I.960821
014180     IF    W-C2    >    14                                        I.960821
014190                        MOVE   W-PNA1         TO  W-ONA           I.960821
014200                        MOVE   W-PNA2         TO  W-UNA           I.960821
014210                        GO  TO  MOV-006.                          I.960821
014220     MOVE  W-NNM(W-C2)  TO   W-ONM(W-C2).                         I.960821
014230     IF    W-NNM(W-C2)  NOT =    SPACE                            I.960821
014240                        GO  TO  MOV-002.                          I.960821
014250     COMPUTE  W-C3   =  W-C1      -     W-C2.                     I.960821
014260     IF    W-C3    >    14                                        I.960821
014270                        GO  TO  MOV-002.                          I.960821
014280*
014290     MOVE  14           TO   W-C4.                                I.960821
014300 MOV-003.                                                         I.960821
014310     IF    W-C4          =    ZERO                                I.960821
014320                         MOVE  NC"ＤＡＴＡ　エラー"  TO  ERR-MSGN I.960821
014330                         DISPLAY  DISP-MSG-01  DISP-BUZ-B         I.960821
014340                         DISPLAY  DISP-MSG-SPACE                  I.960821
014350                         GO  TO  MOV-006.                         I.960821
014360     MOVE  W-NNM(W-C1)  TO   W-UNM(W-C4).                         I.960821
014370     SUBTRACT    1    FROM   W-C1  W-C4.                          I.960821
014380     IF    W-C1     NOT  =    W-C2                                I.960821
014390                         GO  TO  MOV-003.                         I.960821
014400 MOV-006.                                                         I.960821
014410     IF    W-ONA         =    SPACE                               I.960821
014420                         GO  TO  MOV-008.                         I.960821
014430     IF    W-UNA         =    SPACE                               I.960821
014440                         GO  TO  MOV-008.                         I.960821
014450     IF    W-UNM(14) NOT =    SPACE                               I.960821
014460                         GO  TO  MOV-008.                         I.960821
014470     MOVE   15      TO  W-C1.                                     I.960821
014480     MOVE   14      TO  W-C2.                                     I.960821
014490 MOV-007.                                                         I.960821
014500     SUBTRACT    1    FROM   W-C1  W-C2.                          I.960821
014510     IF    W-C2     NOT  =    ZERO                                I.960821
014520                         MOVE  W-UNM(W-C2)   TO  W-UNM(W-C1)      I.960821
014530                         GO  TO  MOV-007.                         I.960821
014540     MOVE  SPACE         TO  W-UNM(W-C1).                         I.960821
014550     IF    W-UNM(14)     =    SPACE                               I.960821
014560                         GO  TO  MOV-006.                         I.960821
014570 MOV-008.                                                         I.960821
014580*****MOVE  W-SHM-021 TO  R1-01.                                   D.960821
014590     MOVE   W-ONA   TO  R1-01.                                    I.960821
014600     MOVE   K-2     TO  R1-K2.
014610     MOVE   SPACE   TO  W-P.                                      I.961015
014620*****MOVE   R1-R    TO  MEI1-R(JNIF1-02).                         D.961015
014630*****IF  JS-SIGN3    =  0                                         D.981029
014640*****                MOVE   R1-R    TO  W-P1                      D.981029
014650*****           ELSE                                              D.981029
014660     MOVE   R1-R    TO  W-P.                                      I.961015
014670     MOVE   W-P     TO  MEI1-R(JNIF1-02).                         I.961015
014680     MOVE   K-1     TO  R2-K1.
014690     MOVE   W-UNA   TO  R2-01.                                    I.960821
014700*****MOVE W-SHM-022 TO  R2-01.                                    D.960821
014710*****MOVE   0       TO  I.                                        D.920826
014720 MOV-010.
014730*****ADD    1       TO  I.                                        D.920826
014740*****IF     I       >   27                                        D.920826
014750*****    GO  TO  MOV-020.                                         D.920826
014760*****MOVE    JNIF1-091(I)    TO   R2-021(I).                      D.920826
014770*****ADD     JNIF1-091(I)    TO   W-T.                            D.920826
014780*****GO  TO  MOV-010.                                             D.920826
014790     COMPUTE W-T  = JNIF1-091(01) + JNIF1-091(02) + JNIF1-091(03) I.920826
014800                  + JNIF1-091(04) + JNIF1-091(05) + JNIF1-091(06) I.920826
014810                  + JNIF1-091(07) + JNIF1-091(08) + JNIF1-091(09) I.920826
014820                  + JNIF1-091(10) + JNIF1-091(11) + JNIF1-091(12) I.920826
014830                  + JNIF1-091(13) + JNIF1-091(14) + JNIF1-091(15) I.920826
014840                  + JNIF1-091(16) + JNIF1-091(17) + JNIF1-091(18) I.920826
014850                  + JNIF1-091(19) + JNIF1-091(20) + JNIF1-091(21) I.920826
014860                  + JNIF1-091(22) + JNIF1-091(23) + JNIF1-091(24) I.920826
014870                  + JNIF1-091(25) + JNIF1-091(26) + JNIF1-091(27).I.920826
014880*****IF  0        =    SHM-0411(01)  AND  SHM-0411(02)            D.010808
014890*****             AND  SHM-0411(03)  AND  SHM-0411(04)            D.010808
014900*****             AND  SHM-0411(05)  AND  SHM-0411(06)            D.010808
014910*****             AND  SHM-0411(07)                               D.010808
014920*****IF  0        =    HI-S1(01)  AND  HI-S1(02)                  D.060822
014930*****             AND  HI-S1(03)  AND  HI-S1(04)                  D.060822
014940*****             AND  HI-S1(05)  AND  HI-S1(06)                  D.060822
014950*****             AND  HI-S1(07)                                  D.060822
014960     IF  (HI-S1(01) NOT = 0)  OR (HI-S1(02) NOT = 0) OR           I.060822
014970         (HI-S1(03) NOT = 0)  OR (HI-S1(04) NOT = 0) OR           I.060822
014980         (HI-S1(05) NOT = 0)  OR (HI-S1(06) NOT = 0) OR           I.060822
014990         (HI-S1(07) NOT = 0)                                      I.060822
015000         GO  TO  MOV-015.                                         I.060822
015010     IF   HI-HKB        = 0                                       I.060822
015020                MOVE    JNIF1-091(02)    TO   R2-021(01)          I.920826
015030                MOVE    JNIF1-091(04)    TO   R2-021(02)          I.920826
015040                MOVE    JNIF1-091(05)    TO   R2-021(03)          I.920826
015050                MOVE    JNIF1-091(06)    TO   R2-021(04)          I.920826
015060                MOVE    JNIF1-091(07)    TO   R2-021(05)          I.920826
015070                MOVE    JNIF1-091(08)    TO   R2-021(06)          I.920826
015080                MOVE    JNIF1-091(09)    TO   R2-021(07)          I.920826
015090                MOVE    JNIF1-091(10)    TO   R2-021(08)          I.920826
015100                MOVE    JNIF1-091(11)    TO   R2-021(09)          I.920826
015110                MOVE    JNIF1-091(12)    TO   R2-021(10)          I.920826
015120                MOVE    JNIF1-091(13)    TO   R2-021(11)          I.920826
015130                MOVE    JNIF1-091(14)    TO   R2-021(12)          I.920826
015140                MOVE    JNIF1-091(15)    TO   R2-021(13)          I.920826
015150                MOVE    JNIF1-091(16)    TO   R2-021(14)          I.920826
015160                MOVE    JNIF1-091(17)    TO   R2-021(15)          I.920826
015170                MOVE    JNIF1-091(18)    TO   R2-021(16)          I.920826
015180                MOVE    JNIF1-091(19)    TO   R2-021(17)          I.920826
015190                MOVE    JNIF1-091(20)    TO   R2-021(18)          I.920826
015200                MOVE    JNIF1-091(21)    TO   R2-021(19)          I.920826
015210                MOVE    JNIF1-091(22)    TO   R2-021(20)          I.920826
015220                MOVE    JNIF1-091(23)    TO   R2-021(21)          I.920826
015230                MOVE    JNIF1-091(24)    TO   R2-021(22)          I.920826
015240                MOVE    JNIF1-091(25)    TO   R2-021(23)          I.920826
015250                MOVE    JNIF1-091(26)    TO   R2-021(24)          I.920826
015260                MOVE    JNIF1-091(27)    TO   R2-021(25)          I.920826
015270                GO  TO  MOV-020.                                  I.060822
015280     MOVE    JNIF1-091(02)    TO   R2-B021(01).                   I.060822
015290     IF    JNIF1-091(03)  NOT  =  ZERO                            I.160317
015300             MOVE    JNIF1-091(03)    TO   R2-B021(01).           I.160317
015310     MOVE    JNIF1-091(04)    TO   R2-B021(02).                   I.060822
015320     MOVE    JNIF1-091(05)    TO   R2-B021(03).                   I.060822
015330     MOVE    JNIF1-091(06)    TO   R2-B021(04).                   I.060822
015340     MOVE    JNIF1-091(07)    TO   R2-B021(05).                   I.060822
015350     MOVE    JNIF1-091(08)    TO   R2-B021(06).                   I.060822
015360     MOVE    JNIF1-091(09)    TO   R2-B021(07).                   I.060822
015370     MOVE    JNIF1-091(10)    TO   R2-B021(08).                   I.060822
015380     MOVE    JNIF1-091(11)    TO   R2-B021(09).                   I.060822
015390     MOVE    JNIF1-091(12)    TO   R2-B021(10).                   I.060822
015400     MOVE    JNIF1-091(13)    TO   R2-B021(11).                   I.060822
015410     MOVE    JNIF1-091(14)    TO   R2-B021(12).                   I.060822
015420     MOVE    JNIF1-091(15)    TO   R2-B021(13).                   I.060822
015430     MOVE    JNIF1-091(16)    TO   R2-B021(14).                   I.060822
015440     MOVE    JNIF1-091(17)    TO   R2-B021(15).                   I.060822
015450     MOVE    JNIF1-091(18)    TO   R2-B021(16).                   I.062822
015460     MOVE    JNIF1-091(19)    TO   R2-B021(17).                   I.060822
015470     MOVE    JNIF1-091(20)    TO   R2-B021(18).                   I.060822
015480     MOVE    JNIF1-091(21)    TO   R2-B021(19).                   I.060822
015490     MOVE    JNIF1-091(22)    TO   R2-B021(20).                   I.060822
015500     MOVE    JNIF1-091(23)    TO   R2-B021(21).                   I.060822
015510     MOVE    JNIF1-091(24)    TO   R2-B021(22).                   I.060822
015520     MOVE    JNIF1-091(25)    TO   R2-B021(23).                   I.060822
015530     MOVE    JNIF1-091(26)    TO   R2-B021(24).                   I.060822
015540     MOVE    JNIF1-091(27)    TO   R2-B021(25).                   I.060822
015550*****IF  JNIF1-091(02)   NOT =  ZERO                              D.160317
015560     IF (JNIF1-091(02)   NOT =  ZERO)  OR                         I.160317
015570       ((JNIF1-091(03)   NOT =  ZERO)  AND                        I.160317
015580         (HI-HKB   NOT  = 0))                                     I.160317
015590         MOVE    "*"              TO   R2-B020(01).               I.060822
015600     IF  JNIF1-091(04)   NOT =  ZERO                              I.060822
015610         MOVE    "*"              TO   R2-B020(02).               I.060822
015620     IF  JNIF1-091(05)   NOT =  ZERO                              I.060822
015630         MOVE    "*"              TO   R2-B020(03).               I.060822
015640     IF  JNIF1-091(06)   NOT =  ZERO                              I.060822
015650         MOVE    "*"              TO   R2-B020(04).               I.060822
015660     IF  JNIF1-091(07)   NOT =  ZERO                              I.060822
015670         MOVE    "*"              TO   R2-B020(05).               I.060822
015680     IF  JNIF1-091(08)   NOT =  ZERO                              I.060822
015690         MOVE    "*"              TO   R2-B020(06).               I.060822
015700     IF  JNIF1-091(09)   NOT =  ZERO                              I.060822
015710         MOVE    "*"              TO   R2-B020(07).               I.060822
015720     IF  JNIF1-091(10)   NOT =  ZERO                              I.060822
015730         MOVE    "*"              TO   R2-B020(08).               I.060822
015740     IF  JNIF1-091(11)   NOT =  ZERO                              I.060822
015750         MOVE    "*"              TO   R2-B020(09).               I.060822
015760     IF  JNIF1-091(12)   NOT =  ZERO                              I.060822
015770         MOVE    "*"              TO   R2-B020(10).               I.060822
015780     IF  JNIF1-091(13)   NOT =  ZERO                              I.060822
015790         MOVE    "*"              TO   R2-B020(11).               I.060822
015800     IF  JNIF1-091(14)   NOT =  ZERO                              I.060822
015810         MOVE    "*"              TO   R2-B020(12).               I.060822
015820     IF  JNIF1-091(15)   NOT =  ZERO                              I.060822
015830         MOVE    "*"              TO   R2-B020(13).               I.060822
015840     IF  JNIF1-091(16)   NOT =  ZERO                              I.060822
015850         MOVE    "*"              TO   R2-B020(14).               I.060822
015860     IF  JNIF1-091(17)   NOT =  ZERO                              I.060822
015870         MOVE    "*"              TO   R2-B020(15).               I.060822
015880     IF  JNIF1-091(18)   NOT =  ZERO                              I.060822
015890         MOVE    "*"              TO   R2-B020(16).               I.062822
015900     IF  JNIF1-091(19)   NOT =  ZERO                              I.060822
015910         MOVE    "*"              TO   R2-B020(17).               I.060822
015920     IF  JNIF1-091(20)   NOT =  ZERO                              I.060822
015930         MOVE    "*"              TO   R2-B020(18).               I.060822
015940     IF  JNIF1-091(21)   NOT =  ZERO                              I.060822
015950         MOVE    "*"              TO   R2-B020(19).               I.060822
015960     IF  JNIF1-091(22)   NOT =  ZERO                              I.060822
015970         MOVE    "*"              TO   R2-B020(20).               I.060822
015980     IF  JNIF1-091(23)   NOT =  ZERO                              I.060822
015990         MOVE    "*"              TO   R2-B020(21).               I.060822
016000     IF  JNIF1-091(24)   NOT =  ZERO                              I.060822
016010         MOVE    "*"              TO   R2-B020(22).               I.060822
016020     IF  JNIF1-091(25)   NOT =  ZERO                              I.060822
016030         MOVE    "*"              TO   R2-B020(23).               I.060822
016040     IF  JNIF1-091(26)   NOT =  ZERO                              I.060822
016050         MOVE    "*"              TO   R2-B020(24).               I.060822
016060     IF  JNIF1-091(27)   NOT =  ZERO                              I.060822
016070         MOVE    "*"              TO   R2-B020(25).               I.060822
016080     GO  TO  MOV-020.                                             I.060822
016090*****  ELSE     MOVE    JNIF1-091(01)    TO   R2-021(01)          D.060822
016100*****           MOVE    JNIF1-091(02)    TO   R2-021(02)          D.060822
016110*****           MOVE    JNIF1-091(03)    TO   R2-021(03)          D.060822
016120*****           MOVE    JNIF1-091(04)    TO   R2-021(04)          D.060822
016130*****           MOVE    JNIF1-091(05)    TO   R2-021(05)          D.060822
016140*****           MOVE    JNIF1-091(06)    TO   R2-021(06)          D.060822
016150*****           MOVE    JNIF1-091(07)    TO   R2-021(07).         D.941205
016160*****           MOVE    JNIF1-091(07)    TO   R2-021(07)          D.060822
016170*****           MOVE    JNIF1-091(25)    TO   R2-021(23)          D.060822
016180*****           MOVE    JNIF1-091(26)    TO   R2-021(24)          D.060822
016190 MOV-015.                                                         I.060822
016200     MOVE    JNIF1-091(01)    TO   R2-021(01).                    I.060822
016210     MOVE    JNIF1-091(02)    TO   R2-021(02).                    I.060822
016220     MOVE    JNIF1-091(03)    TO   R2-021(03).                    I.060822
016230     MOVE    JNIF1-091(04)    TO   R2-021(04).                    I.060822
016240     MOVE    JNIF1-091(05)    TO   R2-021(05).                    I.060822
016250     MOVE    JNIF1-091(06)    TO   R2-021(06).                    I.060822
016260     MOVE    JNIF1-091(07)    TO   R2-021(07).                    I.060822
016270     MOVE    JNIF1-091(25)    TO   R2-021(23).                    I.060822
016280     MOVE    JNIF1-091(26)    TO   R2-021(24).                    I.060822
016290     MOVE    JNIF1-091(27)    TO   R2-021(25).                    I.941205
016300 MOV-020.
016310     MOVE    W-T     TO    R2-03.
016320     MOVE    SPACE   TO    W-P.                                   I.961015
016330*****MOVE    R2-R    TO    MEI2-R(JNIF1-02).                      D.961015
016340*****IF  JS-SIGN3    =  0                                         D.981029
016350*****                MOVE    R2-R    TO    W-P1                   D.981029
016360*****           ELSE                                              D.981029
016370     MOVE    R2-R    TO    W-P.                                   I.961015
016380     MOVE    W-P     TO    MEI2-R(JNIF1-02).                      I.961015
016390     ADD     W-T     TO  W-KEI.                                   I.091214
016400     MOVE    0       TO  W-T.
016410     IF  W-SEN    =    1
016420         PERFORM      RW1-RTN        THRU        RW1-EX.
016430 MOV-EX.
016440     EXIT.
016450***************************************************
016460*    ＲＷ１ーＲＴＮ                               *
016470***************************************************
016480 RW1-RTN.
016490     MOVE   "1"     TO  JNIF1-10.
016500     REWRITE        JNIF1-R       INVALID
016510         MOVE       "JNIF"  TO    ERR-F
016520         MOVE       "R"     TO    ERR-M
016530         MOVE    JNIF1-KEY  TO    ERR-K
016540         PERFORM   ERR-RTN   THRU   ERR-EX.
016550 RW1-EX.
016560***************************************************
016570*    ＲＷ２ーＲＴＮ                               *
016580***************************************************
016590 RW2-RTN.
016600     MOVE   "1"     TO  JNIF2-04.
016610     REWRITE        JNIF2-R       INVALID
016620         MOVE       "JNIF"  TO    ERR-F
016630         MOVE       "R"     TO    ERR-M
016640         MOVE    JNIF2-KEY  TO    ERR-K
016650         PERFORM   ERR-RTN   THRU   ERR-EX.
016660 RW2-EX.
016670     EXIT.
016680***************************************************
016690*    ﾋﾂﾞｹ ｾｯﾄ                ROUTIN               *
016700***************************************************
016710 SEL-RTN.                                                         I.981022
016720*****CLOSE  JNIF.                                                 D.030722
016730     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981022
016740     OPEN  INPUT  JNIF.                                           I.981022
016750 SEL-010.                                                         I.981022
016760     READ  JNIF  NEXT  RECORD  AT  END                            I.981022
016770         GO  TO  SEL-090.                                         I.981022
016780     IF  JNIF1-10 = 1                                             I.981022
016790         GO  TO  SEL-010.                                         I.981022
016800     IF  JNIF1-02    =    7                     GO  TO  SEL-010.  I.981028
016810     IF  JS-SIGN  =  0                                            I.981028
016820         IF   JNIF1-07    NOT =  1              GO  TO  SEL-010.  I.060308
016830*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6 OR 7                D.051216
016840*****    IF   JNIF1-07    =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
016850*****                                           GO  TO  SEL-010.  D.060308
016860     IF  JS-SIGN  =  1                                            I.981028
016870         IF   JNIF1-07    NOT =  6              GO  TO  SEL-010.  I.060308
016880*****    IF   JNIF1-07    NOT =  2 AND 3        GO  TO  SEL-010.  D.060308
016890     IF  JS-SIGN  =  2                                            I.981028
016900         IF   JNIF1-07    NOT =  7              GO  TO  SEL-010.  I.060308
016910*****    IF   JNIF1-07    NOT =  5 AND 6        GO  TO  SEL-010.  D.060308
016920     IF  JS-SIGN  =  3                                            I.981028
016930         IF   JNIF1-07    NOT =  4              GO  TO  SEL-010.  I.060308
016940*****    IF   JNIF1-07    NOT =  2 AND 3 AND 5 AND 6              D.060308
016950*****                                           GO  TO  SEL-010.  D.060308
016960     IF  W-JS      NOT =  9                                       I.030707
016970         IF   JNIF1-13A   NOT =  W-JS           GO  TO  SEL-010.  I.030707
016980*****IF  JS-SIGN  =  4                                            D.030707
016990*****    IF   JNIF1-07    NOT =  7              GO  TO  SEL-010.  D.030707
017000*****IF  W-JS     =  0                                            D.030707
017010*****    IF   JNIF1-13A   NOT =  0              GO  TO  SEL-010.  D.030707
017020*****IF  W-JS     =  1                                            D.030707
017030*****    IF   JNIF1-13A   NOT =  1              GO  TO  SEL-010.  D.030707
017040*****IF  W-JS     =  9                                            D.030707
017050*****    IF   JNIF1-13A   NOT =  0 AND 1        GO  TO  SEL-010.  D.030707
017060*****IF  JS-SIGN4 =  0                                            D.011109
017070*****    IF   JNIF1-051       =  0459  OR  0460  OR  3966         D.011109
017080*****                                           GO  TO  SEL-010.  D.011109
017090*****IF  JS-SIGN4 =  1                                            D.011109
017100*****    IF   JNIF1-051   NOT =  0459 AND  0460 AND  3966         D.011109
017110*****                                           GO  TO  SEL-010.  D.011109
017120     MOVE  ZERO     TO  W-NGP.                                    I.981022
017130     MOVE  JNIF1-04  TO  W-NGPS.                                  I.981022
017140     MOVE  20       TO  W-NEN1.                                   I.090919
017150*****IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     D.090919
017160*****    ADD  DATE-NC1  TO  W-NEN.                                D.090919
017170*****IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     D.090919
017180*****    ADD  DATE-NC2  TO  W-NEN.                                D.090919
017190*****IF  W-NEN2 > 90                                              D.981027
017200*****    ADD  1900  TO  W-NEN                                     D.981027
017210*****  ELSE                                                       D.981027
017220*****    ADD  2000  TO  W-NEN.                                    D.981027
017230     IF  W-SDATE = ZERO                                           I.981022
017240         MOVE  W-NGP  TO  W-SDATE.                                I.981022
017250     IF  W-SDATE > W-NGP                                          I.981022
017260         MOVE  W-NGP  TO  W-SDATE.                                I.981022
017270     IF  W-EDATE < W-NGP                                          I.981022
017280         MOVE  W-NGP  TO  W-EDATE.                                I.981022
017290     GO  TO  SEL-010.                                             I.981022
017300 SEL-090.                                                         I.981022
017310     CLOSE  JNIF.                                                 I.981022
017320     MOVE  W-SDATE  TO  W-SNGP.                                   I.981022
017330     MOVE  W-EDATE  TO  W-ENGP.                                   I.981022
017340*****OPEN  I-O  JNIF.                                             D.030722
017350 SEL-EX.                                                          I.981022
017360     EXIT.                                                        I.981022
017370 COPY    LPMSG.
