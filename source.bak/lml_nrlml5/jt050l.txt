000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT050L.
000030 AUTHOR.                        E-SHIGIHARA.
000040**********************************************************
000050*    PROGRAM        : 荷札・入日記　　　　　　           *
000060*    DATA WRITTEN   : 87/08/19                           *
000070*    SCREEN USED    : UNUSED                             *
000080*    FORM   USED    : UNUSED                             *
000090*    PRINTER TYPE   : JIPS                               *
000100*    COMPILE TYPE   : COBOL                              *
000110*    JS-W           : 0=本社 , 1=選択 , 2=玉島 , 3=早島  *
000120**********************************************************
000130 ENVIRONMENT                    DIVISION.
000140 CONFIGURATION                  SECTION.
000150 SOURCE-COMPUTER.               SYSTEM150.
000160 OBJECT-COMPUTER.               SYSTEM150.
000170 INPUT-OUTPUT                   SECTION.
000180 FILE-CONTROL.
000190*****COPY  LIBCSE.                                                D.090919
000200*****SELECT  GDMM   ASSIGN  GDMM-MSD                              D.011018
000210*****               ORGANIZATION  INDEXED                         D.011018
000220*****               ACCESS  MODE  RANDOM                          D.011018
000230*****               RECORD  KEY   GDMM-KEY                        D.011018
000240*****               FILE  STATUS  ERR-STAT.                       D.011018
000250     SELECT   JNIF      ASSIGN  F1-MSD
000260                        ORGANIZATION  INDEXED
000270                        ACCESS MODE   DYNAMIC
000280                        RECORD KEY    JNIF1-KEY.
000290*****SELECT   SHM       ASSIGN  F2-MSD                            D.010808
000300     SELECT   HI2-M     ASSIGN  F2-MSD                            I.010808
000310                        ORGANIZATION  INDEXED
000320                        ACCESS MODE   RANDOM
000330                        RECORD KEY    HI-KEY2.                    I.010808
000340*****                   RECORD KEY    SHM-KEY.                    D.010808
000350     SELECT   TC-M      ASSIGN  F3-MSD
000360                        ORGANIZATION  INDEXED
000370                        ACCESS MODE   RANDOM
000380                        RECORD KEY    TC-KEY.
000390     SELECT   JCON      ASSIGN  F4-MSD
000400                        ORGANIZATION  INDEXED
000410                        ACCESS MODE   RANDOM
000420                        RECORD KEY    JCON2-KEY.
000430     SELECT  P-F        ASSIGN  P1-PRN999.
000440 I-O-CONTROL.
000450*****APPLY   SHARED-MODE ON  JNIF   SHM    TC-M   JCON            D.010808
000460     APPLY   SHARED-MODE ON  JNIF   HI2-M  TC-M   JCON            I.010808
000470*****                        GDMM                                 D.011018
000480*****                        M-DATE                               D.090919
000490     APPLY   SHIFT-CODE  ON  P-F.
000500*
000510 DATA                       DIVISION.
000520 FILE                       SECTION.
000530*****COPY  LIBFDD.                                                D.090919
000540*****COPY  L-GDMM.                                                D.011018
000550 COPY  L-JNIF.
000560*COPY  L-SHM.                                                     D.010808
000570 COPY  LIHIM2.                                                    I.010808
000580 COPY  LITCM.
000590 COPY  L-JCON.
000600 FD  P-F
000610     LABEL  RECORD   OMITTED   LINAGE    28.                      I.060308
000620*****LABEL  RECORD   OMITTED   LINAGE    29.                      D.060308
000630 01  P-R                       PIC X(180).
000640 WORKING-STORAGE            SECTION.
000650 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000660 77  JS-SIGN                   PIC X(01).                         I.890828
000670 77  JS-W                      PIC X(01).                         I.091019
000680 77  W-JS                      PIC X(01).                         I.911113
000690*77  JS-SIGN3                  PIC X(01).                         D.981029
000700*77  JS-SIGN4                  PIC X(01).                         D.011109
000710 77  STR-SW                    PIC X(02).                         I.900417
000720*01  WS-MID                    PIC N(05).                         D.030722
000730*01  WS-YOUSI                  PIC N(06)  VALUE  SPACE.           D.011109
000740*01  W-P.                                                         D.981029
000750*****02  F                     PIC X(006).                        D.980826
000760*****02  F                     PIC X(001).                        D.981029
000770*****02  W-P1                  PIC X(174).                        D.981029
000780 01  W-P                       PIC X(175).                        I.981029
000790 01  R1-R.
000800     02  R1-K1                 PIC X(05).
000810*****02  FILLER                PIC X(09).                         D.920826
000820*****02  FILLER                PIC X(01).                         D.981029
000830*****02  FILLER                PIC X(02).                         D.031107
000840     02  FILLER                PIC X(01).                         I.031107
000850     02  R1-01                 PIC N(14).
000860     02  R1-K2                 PIC X(05).
000870 01  R2-R.
000880     02  R2-K1                 PIC X(05).
000890*****02  FILLER                PIC X(01).                         D.981029
000900*****02  FILLER                PIC X(15).                         D.920826
000910*****02  FILLER                PIC X(07).                         D.960821
000920*****02  R2-01                 PIC N(10).                         D.960821
000930*****02  FILLER                PIC X(02).                         D.031107
000940     02  FILLER                PIC X(01).                         I.031107
000950     02  R2-01                 PIC N(14).                         I.960821
000960     02  FILLER                PIC X(01).                         I.920826
000970*****02  R2-02        OCCURS   27.                                D.920826
000980*****02  R2-02        OCCURS   25.                                D.060822
000990*****    03  R2-021            PIC ZZZ.                           D.060822
001000     02  R2-02A.                                                  I.060822
001010       03  R2-02        OCCURS   25.                              I.060822
001020           04  R2-021          PIC ZZZ.                           I.060822
001030     02  R2-02B   REDEFINES R2-02A.                               I.060822
001040       03  R2-B02        OCCURS   25.                             I.060822
001050           04  R2-B020         PIC X.                             I.060822
001060           04  R2-B021         PIC ZZ.                            I.060822
001070     02  R2-03                 PIC ZZZZ.                          R.900411
001080     02  R2-K2                 PIC X(05).
001090 01  MID0-R.                                                      I.090919
001100     02  M0-K1                 PIC X(05)  VALUE ""3FE04F40A0"".   I.090919
001110     02  FILLER                PIC X(01)  VALUE   SPACE.          I.090919
001120     02  M0-01                 PIC N(05)  VALUE   SPACE.          I.090919
001130 01  MID1-R.
001140     02  M1-K2                 PIC X(05)  VALUE ""3FE04FE080"".   I.950201
001150*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.981029
001160*****02  FILLER                PIC X(16)    VALUE   SPACE.        D.920826
001170*****02  M1-01                 PIC X(06).                         D.970130
001180*****02  FILLER                PIC X(49)    VALUE   SPACE.        D.920826
001190*****02  FILLER                PIC X(43)    VALUE   SPACE.        D.950202
001200*****02  FILLER                PIC X(33)    VALUE   SPACE.        D.970130
001210*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.031107
001220     02  FILLER                PIC X(08)    VALUE   SPACE.        I.031107
001230     02  M1-01                 PIC X(08).                         I.970130
001240     02  FILLER                PIC X(31)    VALUE   SPACE.        I.970130
001250     02  M1-S                  PIC N(01)    VALUE   SPACE.        I.950202
001260     02  FILLER                PIC X(08)    VALUE   SPACE.        I.950202
001270     02  M1-06                 PIC 9(06).                         I.951115
001280*****02  M1-02                 PIC 9(06).                         D.951115
001290*****02  FILLER                PIC X(11)    VALUE   SPACE.        D.920826
001300*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.950202
001310*****02  M1-C                  PIC X(01).                         D.950201
001320     02  FILLER                PIC X(09)    VALUE   SPACE.        I.950202
001330     02  M1-03                 PIC 9(02).
001340     02  FILLER                PIC X(03)    VALUE   SPACE.
001350     02  M1-04                 PIC Z9.
001360     02  FILLER                PIC X(03)    VALUE   SPACE.        *R871111
001370     02  M1-05                 PIC Z9.
001380     02  FILLER                PIC X(11)    VALUE   SPACE.        I.920826
001390     02  M1-02                 PIC 9(06).                         I.951115
001400*****02  FILLER                PIC X(07)    VALUE   SPACE.        D.920826
001410*****02  M1-06                 PIC 9(06).                         D.951115
001420*01  MID1A-R.                                                     D.920826
001430*****02  FILLER                PIC X(110)   VALUE   SPACE.        D.920826
001440*****02  M1A-01                PIC ZZZ.                           D.920826
001450 01  MID2A-R.                                                     I.060308
001460     02  M2A-K1                PIC X(05)  VALUE ""3FE04F40A0"".   I.060308
001470     02  FILLER                PIC X(51)    VALUE   SPACE.        I.060308
001480     02  M2A-UM                PIC N(02)  VALUE NC"　〒".         I.060308
001490     02  M2A-UNO               PIC X(08)    VALUE   SPACE.        I.060308
001500     02  F                     PIC X(02)    VALUE   SPACE.        I.060308
001510     02  M2A-JSO               PIC N(06).                         I.060308
001520 01  MID2-R.
001530     02  M2-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001540     02  FILLER                PIC X(06)    VALUE   SPACE.        I.031107
001550*****02  FILLER                PIC X(07)    VALUE   SPACE.        D.031107
001560*****02  FILLER                PIC X(15)    VALUE   SPACE.        D.920826
001570*****02  FILLER                PIC X(06)    VALUE   SPACE.        D.981029
001580*****02  M2-01                 PIC N(24).                         D.020417
001590     02  M2-01                 PIC N(20).                         I.020417
001600     02  F                     PIC X(16)    VALUE   SPACE.        I.060308
001610     02  M2-JSN                PIC N(14).                         I.060308
001620*****02  M2-K2                 PIC X(05)  VALUE ""3FE04FE080"".   D.060308
001630*****02  FILLER                PIC X(52)    VALUE   SPACE.        D.960821
001640*****02  FILLER                PIC X(56)    VALUE   SPACE.        D.010305
001650*****02  F                     PIC X(11)    VALUE   SPACE.        D.020508
001660*****02  F                     PIC X(17)    VALUE   SPACE.        D.060308
001670*****02  M2-UM                 PIC N(01)    VALUE   SPACE.        D.060308
001680*****02  M2-UNO                PIC X(08)    VALUE   SPACE.        D.060308
001690*****02  F                     PIC X(35)    VALUE   SPACE.        D.060308
001700     02  F                     PIC X(25)    VALUE   SPACE.        I.060308
001710     02  M2-02                 PIC ZZZ.                           I.920826
001720 01  MID3-R.
001730     02  M3-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001740*****02  FILLER                PIC X(33)    VALUE   SPACE.        D.920826
001750*****02  FILLER                PIC X(24)    VALUE   SPACE.        D.981029
001760*****02  FILLER                PIC X(25)    VALUE   SPACE.        D.020417
001770*****02  M3-01                 PIC N(12).                         D.020417
001780*****02  FILLER                PIC X(13)    VALUE   SPACE.        D.031107
001790*****02  FILLER                PIC X(12)    VALUE   SPACE.        D.060308
001800*****02  M3-01                 PIC N(20).                         D.060308
001810*****02  F                     PIC X(11)    VALUE   SPACE.        D.060308
001820     02  FILLER                PIC X(13)    VALUE   SPACE.        I.060308
001830     02  M3-01                 PIC N(20).                         I.060308
001840     02  F                     PIC X(09)    VALUE   SPACE.        I.060308
001850     02  M3-JS                 PIC N(14)    VALUE   SPACE.        I.010305
001860*****02  F                     PIC X(26)    VALUE   SPACE.        D.060308
001870*****02  FILLER                PIC X(58)    VALUE   SPACE.        D.010305
001880*****02  FILLER                PIC X(61)    VALUE   SPACE.        D.910725
001890*****02  FILLER                PIC X(36)    VALUE   SPACE.        D.920826
001900*****02  M3-03F                PIC X(01).                         D.920826
001910*****02  M3-03                 PIC N(06).                         D.920826
001920*****02  M3-03R                PIC X(01).                         D.920826
001930*****02  F                     PIC X(26)    VALUE   SPACE.        D.060308
001940*****02  FILLER                PIC X(58)    VALUE   SPACE.        D.010305
001950*****02  FILLER                PIC X(61)    VALUE   SPACE.        D.910725
001960*****02  FILLER                PIC X(36)    VALUE   SPACE.        D.920826
001970*****02  M3-03F                PIC X(01).                         D.920826
001980*****02  M3-03                 PIC N(06).                         D.920826
001990*****02  M3-03R                PIC X(01).                         D.920826
002000*****02  FILLER                PIC X(14)    VALUE   SPACE.        D.920826
002010     02  FILLER                PIC X(28)    VALUE   SPACE.        I.060308
002020     02  M3-K2                 PIC X(05)  VALUE ""3FE04FE080"".
002030     02  M3-02                 PIC N(01).
002040 01  MID4-R.                                                      *R871111
002050*****02  FILLER                PIC X(17)    VALUE   SPACE.        D.920826
002060*****02  FILLER                PIC X(08)    VALUE   SPACE.        D.981029
002070*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.031107
002080     02  FILLER                PIC X(08)    VALUE   SPACE.        I.031107
002090     02  M5-K1                 PIC X(05)  VALUE ""3FE04F40A0"".   ﾞ
002100*****02  M5-01                 PIC N(24).                         D.020412
002110     02  M5-01                 PIC N(26).                         I.020412
002120     02  FILLER                PIC X(05)    VALUE   SPACE.        I.060308
002130*****02  M5-K2                 PIC X(05)  VALUE ""3FE04FE080"".   D.060308
002140*****02  FILLER                PIC X(32)    VALUE   SPACE.        D.920826
002150*****02  FILLER                PIC X(31)    VALUE   SPACE.        D.010305
002160*****02  FILLER                PIC X(09)    VALUE   SPACE.        D.020412
002170*****02  FILLER                PIC X(06)    VALUE   SPACE.        D.060308
002180     02  M5-K2            PIC X(08) VALUE  ""3F507F4F654F40A0"".  ﾞ
002190     02  M4-NA                 PIC N(14)    VALUE   SPACE.        I.060308
002200*****02  M4-NA                 PIC N(10)    VALUE   SPACE.        D.060308
002210     02  F                     PIC X(02)    VALUE   SPACE.        I.010305
002220     02  M5-K2A                PIC X(05)  VALUE ""3FE04FE080"".   I.060308
002230     02  M5-02                 PIC N(06).                         ﾞ
002240     02  M4-K4            PIC X(08) VALUE  ""3F504F40674F40A0"".  ﾞ
002250*****02  FILLER                PIC X(06)   VALUE   SPACE.         D.920826
002260     02  FILLER                PIC X(03)   VALUE   SPACE.         I.920826
002270     02  M4-K3            PIC X(08) VALUE  ""3F507F4F657F4F9B"".  ﾞ
002280     02  M4-01                 PIC N(03).                         ﾞ
002290     02  M4-K5            PIC X(08) VALUE  ""3F504F40674F40A0"".  ﾞ
002300 01  MID5-R.                                                      I.010305
002310*****02  F                     PIC X(54)   VALUE   SPACE.         D.031107
002320*****02  F                     PIC X(53)   VALUE   SPACE.         D.060308
002330*****02  M5-TM                 PIC X(03)   VALUE   SPACE.         D.060308
002340     02  F                     PIC X(54)   VALUE   SPACE.         I.060308
002350     02  M5-TM                 PIC X(03)   VALUE   "TEL".         I.060308
002360     02  F                     PIC X(01)   VALUE   SPACE.         I.010305
002370     02  M5-TEL                PIC X(14)   VALUE   SPACE.         I.010305
002380*01  MID6-R.                                                      D.021108
002390*****02  F                     PIC X(95)   VALUE   SPACE.         D.981029
002400*****02  F                     PIC X(96)   VALUE   SPACE.         D.021108
002410*****02  F                     PIC X(03)   VALUE   " 3L".         D.021108
002420*****02  F                     PIC X(10)   VALUE   SPACE.         D.021108
002430 01  MEI                           PIC X(1080).
002440 01  MEIR      REDEFINES       MEI.
002450     02  MEI-R      OCCURS            6.
002460         03  MEI1-R                PIC X(50).
002470         03  MEI2-R                PIC X(130).
002480 01  R3-R.
002490     02  R3-K1                 PIC X(05).
002500*****02  FILLER                PIC X(31).                         D.920826
002510*****02  FILLER                PIC X(24).                         D.981029
002520*****02  FILLER                PIC X(25).                         D.031107
002530     02  FILLER                PIC X(24).                         I.031107
002540     02  R3-K30                PIC X(08).                         I.060308
002550     02  R3-01                 PIC N(28).                         *A631025
002560     02  R3-K20                PIC X(08).                         I.060308
002570     02  F                     PIC X(26).                         I.920826
002580     02  R3-02                 PIC N(06).                         I.920826
002590     02  R3-K2                 PIC X(05).
002600 01  ACT-WORK.
002610     02  W-SEN                 PIC 9(01).
002620     02  W-TST                 PIC 9(01).
002630     02  W-FROM                PIC 9(06).
002640     02  W-TO                  PIC 9(06).
002650     02  W-OK                  PIC 9(01).
002660     02  I                     PIC 9(02).
002670     02  W-T                   PIC S9(03).
002680     02  OLD1                  PIC 9(06).
002690     02  W-CNT                 PIC 9(03).
002700*****02  G-CNT                 PIC 9(03).                         D.960821
002710*****02  M-CNT                 PIC 9(03).                         D.960821
002720     02  A                     PIC X(03).
002730     02  AR     REDEFINES      A.
002740         03  AAR               PIC ZZ9.
002750     02  W-TEKI.                                                  *A631025
002760         03  W-TEKI1           PIC N(04).                         "
002770         03  W-TEKI2           PIC N(19).                         "
002780     02  P-TEKI.                                                  *A631025
002790         03  P-TEKI1           PIC N(19).                         "
002800         03  P-TEKI2           PIC N(09).                         "
002810     02  SV-GYO                PIC 9(01).                         I.890831
002820     02  SV-TCD                PIC 9(04).                         I.010305
002830     02  W-OKNO                PIC 9(06).                         I.960821
002840     02  W-NO                  PIC 9(03).                         I.960821
002850     02  W-ANAME.                                                 I.960821
002860       03  W-NNA               PIC N(24).                         I.960821
002870       03  W-NNMD  REDEFINES  W-NNA.                              I.960821
002880         04  W-NNM             PIC N(01)  OCCURS  24.             I.960821
002890       03  W-PNA   REDEFINES  W-NNA.                              I.960821
002900         04  W-PNA1            PIC N(14).                         I.960821
002910         04  W-PNA2            PIC N(10).                         I.960821
002920       03  W-ONA               PIC N(14).                         I.960821
002930       03  W-ONMD  REDEFINES  W-ONA.                              I.960821
002940         04  W-ONM             PIC N(01)  OCCURS  14.             I.960821
002950       03  W-UNA               PIC N(14).                         I.960821
002960       03  W-UNMD  REDEFINES  W-UNA.                              I.960821
002970         04  W-UNM             PIC N(01)  OCCURS  14.             I.960821
002980     02  W-C.                                                     I.960821
002990       03  W-C1                PIC 9(02).                         I.960821
003000       03  W-C2                PIC 9(02).                         I.960821
003010       03  W-C3                PIC 9(02).                         I.960821
003020       03  W-C4                PIC 9(02).                         I.960821
003030     02  W-NGP.                                                   I.981022
003040       03  F                   PIC 9(02).                         I.981022
003050       03  W-NGPS              PIC 9(06).                         I.981022
003060     02  W-NGPL              REDEFINES  W-NGP.                    I.981022
003070       03  W-NEN               PIC 9(04).                         I.981022
003080       03  W-NENL            REDEFINES  W-NEN.                    I.981022
003090         04  W-NEN1            PIC 9(02).                         I.981022
003100         04  W-NEN2            PIC 9(02).                         I.981022
003110       03  F                   PIC 9(04).                         I.981022
003120     02  W-SDATE               PIC 9(08).                         I.981022
003130     02  W-EDATE               PIC 9(08).                         I.981022
003140     02  W-SNGP.                                                  I.981022
003150       03  W-SNEN              PIC 9(04).                         I.981022
003160       03  W-SNENL           REDEFINES  W-SNEN.                   I.981022
003170         04  W-SNEN1           PIC 9(02).                         I.981022
003180         04  W-SNEN2           PIC 9(02).                         I.981022
003190       03  W-SGET              PIC 9(02).                         I.981022
003200       03  W-SPEY              PIC 9(02).                         I.981022
003210     02  W-ENGP.                                                  I.981022
003220       03  W-ENEN              PIC 9(04).                         I.981022
003230       03  W-ENENL           REDEFINES  W-ENEN.                   I.981022
003240         04  W-ENEN1           PIC 9(02).                         I.981022
003250         04  W-ENEN2           PIC 9(02).                         I.981022
003260       03  W-EGET              PIC 9(02).                         I.981022
003270       03  W-EPEY              PIC 9(02).                         I.981022
003280     02  W-POC                 PIC 9(01).                         I.030722
003290     02  W-FOC                 PIC 9(01).                         I.030722
003300     02  W-KEI                 PIC 9(04)   VALUE  0.              I.091214
003310 01  W-AREA.
003320     02  LCNT                  PIC 9(02)   VALUE  90.
003330*01  W-SHM.                                                       D.960821
003340*****02  W-SHM-021.                                               D.960821
003350*****    03  WSH-01     OCCURS  14  PIC  N.                       D.960821
003360*****02  W-SHM-022.                                               D.960821
003370*****    03  WSH-02     OCCURS  10  PIC  N.                       D.960821
003380 01  SOUKO                   PIC N(06).                           I.920826
003390*01  W-NC                    PIC 9(02)  VALUE  ZERO.              D.960821
003400 01  K-1                     PIC X(05)  VALUE  ""3FE04F40A0"".
003410 01  K-2                     PIC X(05)  VALUE  ""3FE04FE080"".
003420 COPY    LWMSG.
003430*
003440 SCREEN                  SECTION.
003450 SD  CRT-X
003460     END STATUS  IS  ESTAT.
003470 01  CLE-01          LINE  1.
003480     02  CLEAR   SCREEN.
003490 01  CLE-02.
003500*****02  CLE-JS    LINE  5   COLUMN 69   VALUE " ".               D.070411
003510     02  CLE-JS    LINE  5   COLUMN 54   VALUE " ".               I.070411
003520     02  CLE-021   LINE  9   COLUMN 45   VALUE " ".               I.030722
003530     02  CLE-022   LINE 12   COLUMN 55   VALUE " ".               I.030722
003540*****02  CLE-021   LINE 7    COLUMN 45   VALUE " ".               D.030722
003550*****02  CLE-022   LINE 12   COLUMN 45   VALUE " ".               D.030722
003560*****02  LINE 7  COLUMN 45    VALUE " ".                          D.950202
003570*****02  LINE 12 COLUMN 45    VALUE " ".                          D.950202
003580*****02  LINE 17 COLUMN 31    VALUE "      ".                     D.950202
003590*****02  LINE 19 COLUMN 31    VALUE "      ".                     D.950202
003600*****02  LINE 23 COLUMN 62    VALUE " ".                          D.950202
003610*****02  CLE-023   LINE 17   COLUMN 31   VALUE "      ".          D.981022
003620*****02  CLE-024   LINE 19   COLUMN 31   VALUE "      ".          D.981022
003630     02  CLE-023   LINE 17   COLUMN 31   VALUE "        ".        I.981022
003640     02  CLE-024   LINE 19   COLUMN 31   VALUE "        ".        I.981022
003650     02  CLE-025   LINE 23   COLUMN 62   VALUE " ".               I.950202
003660 01  DSP-AREA.
003670     02  DSP-01       LINE 1.
003680         03  COLUMN  25  VALUE  "                 "  REVERSE.
003690         03  COLUMN  26  VALUE  NC"荷".
003700         03  COLUMN  29  VALUE  NC"札・入".
003710         03  COLUMN  36  VALUE  NC"日".
003720         03  COLUMN  39  VALUE  NC"記".
003730*****    03  COLUMN  50  VALUE  NC"社名なし用紙".                 D.030722
003740     02  DSP-00       LINE 5.                                     I.030722
003750         03  COLUMN  21  VALUE  NC"教　育".                       I.030722
003760         03  COLUMN  27  VALUE  "=0 , ".                          I.030722
003770*****    03  COLUMN  32  VALUE  NC"ワーク".                       D.070411
003780         03  COLUMN  32  VALUE  NC"一　般".                       I.070411
003790         03  COLUMN  38  VALUE  "=1 , ".                          I.030722
003800         03  COLUMN  43  VALUE  NC"ＡＬＬ".                       I.070411
003810         03  COLUMN  49  VALUE  "=9    ".                         I.070411
003820*****    03  COLUMN  43  VALUE  NC"カジュアル".                   D.070411
003830*****    03  COLUMN  53  VALUE  "=2 , ".                          D.070411
003840*****    03  COLUMN  58  VALUE  NC"ＡＬＬ".                       D.070411
003850*****    03  COLUMN  64  VALUE  "=9    ".                         D.070411
003860*****02  DSP-02          LINE 5.                                  D.030722
003870     02  DSP-02          LINE 7.                                  I.030722
003880         03  COLUMN  25  VALUE  NC"１　発　行".
003890*****02  DSP-03      LINE   7.                                    D.030722
003900     02  DSP-03      LINE   9.                                    I.030722
003910         03  COLUMN  25  VALUE  NC"２　再発行　　選択".
003920         03  COLUMN  44  VALUE  "[ ]".
003930*****02  DSP-04      LINE  10.                                    D.030722
003940*****    03  COLUMN  21  VALUE  NC"テストプリント印字".           D.030722
003950     02  DSP-05      LINE  12.
003960         03  COLUMN  21  VALUE  NC"テストプリント印字".           I.030722
003970         03  COLUMN  41  VALUE  "(YES=1,NO=2) [ ]".               I.030722
003980*****    03  COLUMN  31  VALUE  "(YES=1,NO=2) [ ]".               D.030722
003990*****02  DSP-06      LINE  15.                                    D.981022
004000*****    03  COLUMN  31  VALUE  NC"伝票".                         D.981022
004010*****    03  COLUMN  35  VALUE  "NO".                             D.981022
004020     02  DSP-07      LINE  17.
004030         03  COLUMN  21  VALUE  NC"ＦＲＯＭ".
004040     02  DSP-08      LINE  19.
004050         03  COLUMN  21  VALUE  NC"ＴＯ".
004060     02  DSP-09      LINE  23.
004070         03  COLUMN  41  VALUE  NC"確認（".
004080         03  COLUMN  47  VALUE  "OK=1,NO=9".
004090         03  COLUMN  56  VALUE  NC"）".
004100         03  COLUMN  58  VALUE  "---> ﾘﾀｰﾝ".
004110 01  DSP-AREA1.                                                   I.981022
004120     02  DISP-15  LINE  3  COLUMN  13  PIC  X(39)  VALUE          I.060308
004130          "本社=0 , 玉島=1 , 津山=2 , 早島=3 ...  ".              I.091019
004140*****     "本社=0 , 玉島=1 , 津山=2 , 両備=3 ...  ".              D.091019
004150*****     "本社=0 , 玉島=1 , 津山=2 , 高屋=3 ...  ".              D.060926
004160     02  DSP-DNOM.                                                I.981022
004170       03  LINE  15    COLUMN  31    VALUE  NC"伝票№".           I.981022
004180       03  LINE  17    COLUMN  31    VALUE  "        ".           I.981022
004190       03  LINE  19    COLUMN  31    VALUE  "        ".           I.981022
004200     02  DSP-DATM.                                                I.981022
004210       03  LINE  15    COLUMN  31    VALUE  NC"日　付".           I.981022
004220       03  LINE  17    COLUMN  31    VALUE  "  /  /  ".           I.981022
004230       03  LINE  19    COLUMN  31    VALUE  "  /  /  ".           I.981022
004240*01  DSP-MID.                                                     D.030722
004250*****02  LINE   1  COLUMN   1  PIC  N(05)  FROM  WS-MID.          D.030722
004260*01  DSP-YOUSI.                                                   D.011109
004270*****02  LINE   1  COLUMN  50  PIC  N(06)  FROM  WS-YOUSI.        D.011109
004280 01  ACP-AREA.
004290     02  ACP-SIGN    LINE  3 COLUMN  51  PIC 9(01)                I.060308
004300                 USING  JS-SIGN   CHECK  OVERFLOW  NO  IFC.       I.060308
004310*****02  ACP-JS      LINE  5 COLUMN  69  PIC 9(01)                D.070411
004320     02  ACP-JS      LINE  5 COLUMN  54  PIC 9(01)                I.070411
004330                 USING  W-JS      CHECK  OVERFLOW  NO  IFC.       I.030722
004340*****02  ACP-SEN     LINE 7  COLUMN  45  PIC 9(01)                D.030722
004350     02  ACP-SEN     LINE 9  COLUMN  45  PIC 9(01)                I.030722
004360                 USING  W-SEN     CHECK  OVERFLOW  NO  IFC.
004370*****02  ACP-TST     LINE 12 COLUMN  45  PIC 9(01)                D.030722
004380     02  ACP-TST     LINE 12 COLUMN  55  PIC 9(01)                I.030722
004390                 USING  W-TST     CHECK  OVERFLOW  NO  IFC.
004400     02  ACP-FROM    LINE 17 COLUMN  31  PIC 9(06)
004410                 USING  W-FROM    CHECK  OVERFLOW  NO  IFC.
004420     02  ACP-TO      LINE 19 COLUMN  31  PIC 9(06)
004430                 USING  W-TO      CHECK  OVERFLOW  NO  IFC.
004440     02  ACP-SNGP  LINE  17.                                      I.981022
004450       03  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981022
004460             USING  W-SNEN2  NO  IFC.                             I.981022
004470       03  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981022
004480             USING  W-SGET   NO  IFC.                             I.981022
004490       03  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981022
004500             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.            I.981022
004510     02  ACP-ENGP  LINE  19.                                      I.981022
004520       03  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981022
004530             USING  W-ENEN2  NO  IFC.                             I.981022
004540       03  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981022
004550             USING  W-EGET   NO  IFC.                             I.981022
004560       03  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981022
004570             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.            I.981022
004580     02  ACP-OK      LINE 23 COLUMN  62  PIC 9(01)
004590                 INTO  W-OK      CHECK  OVERFLOW  NO  IFC.
004600*01  DSP-GDMM.                                                    D.011018
004610*****02  LINE  24  COLUMN   1  VALUE                              D.011018
004620*****    NC"＊＊ダミーＦ　なし".                                  D.011018
004630 COPY    LSMSG.
004640*****COPY  LIBSCR.                                                D.090919
004650*
004660 PROCEDURE               DIVISION.
004670************************************
004680*    メイン　ルーチン              *
004690************************************
004700 HAJIME.
004710     PERFORM   INT-RTN   THRU  INT-EX.
004720*****IF JS-SIGN     =  0                                          D.091019
004730     IF JS-W    NOT =  1                                          I.091019
004740        GO  TO  MR004.                                            I.060308
004750     DISPLAY    DISP-15.                                          I.060308
004760 MR003.                                                           I.060308
004770     ACCEPT       ACP-SIGN.                                       I.060308
004780     DISPLAY      DISP-MSG-SPACE.                                 I.060308
004790     IF ESTAT  =  "P9"                                            I.060308
004800        GO  TO  MR999.                                            I.060308
004810     IF  ESTAT  NOT  =  "01"   AND    "06"                        I.060308
004820         GO  TO  MR003.                                           I.060308
004830     DISPLAY      ACP-SIGN.                                       I.060308
004840     IF  JS-SIGN  NOT  =  0  AND  1  AND  2  AND  3               I.060308
004850         GO  TO  MR003.                                           I.060308
004860 MR004.                                                           I.091019
004870*****IF  JS-SIGN  NOT  =  0                                       D.091019
004880     IF (JS-W          =  2  OR  3)  OR                           I.091019
004890       ((JS-W          =  1)  AND  (JS-SIGN   NOT =  0))          I.091019
004900         MOVE  9        TO  W-JS                                  I.091005
004910         DISPLAY  ACP-JS                                          I.091005
004920         GO  TO  MR010.                                           I.091005
004930 MR005.                                                           I.030722
004940     ACCEPT       ACP-JS.                                         I.030722
004950     DISPLAY      DISP-MSG-SPACE.                                 I.030722
004960     IF ESTAT  =  "P9"                                            I.030722
004970        GO  TO  MR999.                                            I.030722
004980     IF  ESTAT  =  "09"                                           I.060308
004990         IF  JS-SIGN  NOT =  0                                    I.060308
005000             GO  TO  MR003.                                       I.060308
005010     IF  ESTAT  NOT  =  "01"   AND    "06"                        I.030722
005020         GO  TO  MR005.                                           I.030722
005030     DISPLAY      ACP-JS.                                         I.030722
005040*****IF  W-JS   NOT  =  0  AND  1  AND  2  AND  9                 D.070411
005050     IF  W-JS   NOT  =  0  AND  1  AND  9                         I.070411
005060         GO  TO  MR005.                                           I.030722
005070*****DISPLAY        CLE-01      DSP-AREA  ACP-JS.                 D.060308
005080 MR010.
005090     ACCEPT        ACP-SEN.
005100     DISPLAY       DISP-MSG-SPACE.
005110     IF ESTAT  =  "P9"
005120        GO  TO  MR999.
005130     IF  ESTAT  =  "09"                                           I.030722
005140         IF (JS-W         =  0)  OR                               D.091019
005150           ((JS-W          =  1)  AND  (JS-SIGN       =  0))      I.091019
005160             GO  TO  MR005                                        I.091019
005170         ELSE                                                     I.091019
005180           IF  JS-W          =  1                                 I.091019
005190               GO  TO  MR003.                                     I.091019
005200*****    IF  JS-SIGN  NOT =  0                                    D.091019
005210*****        GO  TO  MR003                                        D.091019
005220*****    ELSE                                                     D.091019
005230*****        GO  TO  MR005.                                       D.091019
005240     IF ESTAT  NOT  =  "01"   AND    "06"
005250        GO  TO  MR010.
005260     DISPLAY       ACP-SEN.
005270*****IF W-SEN  NOT  =  "1"   AND    "2"                           D.030722
005280     IF W-SEN  NOT  =  1   AND    2                               I.030722
005290        GO  TO  MR010.
005300*****IF  W-SEN = "2"                                              D.030722
005310     IF  W-SEN =  2                                               I.030722
005320         MOVE  NC"再"    TO  M1-S                                 I.981022
005330         MOVE  ZERO      TO  W-SNGP                               I.981022
005340         MOVE  99999999  TO  W-ENGP                               I.981022
005350         DISPLAY  DSP-DNOM                                        I.981022
005360         GO  TO  MR020.                                           I.981022
005370*
005380     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.981022
005390     IF  W-SNGP = ZERO                                            I.981022
005400         DISPLAY  ERR-02                                          I.981022
005410         GO  TO  MR010.                                           I.981022
005420     DISPLAY  DSP-DATM  ACP-SNGP  ACP-ENGP.                       I.981022
005430     MOVE  ZERO    TO  W-FROM.                                    I.981022
005440     MOVE  999999  TO  W-TO.                                      I.981022
005450*****IF W-SEN       =  "1"               MOVE  " "     TO  M1-C   D.950201
005460*****                             ELSE   MOVE  "#"     TO  M1-C.  D.950201
005470*****IF W-SEN       =  "1"            MOVE  NC"　"    TO  M1-S    D.981022
005480*****                                 DISPLAY  CLE-023  CLE-024   D.981022
005490*****                                 MOVE  ZERO      TO  W-FROM  D.981022
005500*****                                 MOVE  999999    TO  W-TO    D.981022
005510*****                          ELSE   MOVE  NC"再"    TO  M1-S.   D.981022
005520 MR020.
005530     ACCEPT       ACP-TST.
005540     DISPLAY      DISP-MSG-SPACE.
005550     IF  ESTAT  =  "09"
005560         GO  TO  MR010.
005570     IF  ESTAT  NOT  =  "01"   AND    "06"
005580         GO  TO  MR020.
005590     DISPLAY      ACP-TST.
005600*****IF  W-TST  NOT  =  "1"   AND    "2"                          D.030722
005610     IF  W-TST  NOT  =  1   AND    2                              I.030722
005620         GO  TO  MR020.
005630     IF  W-TST    =  1
005640         PERFORM    TST-RTN   THRU     TST-EX
005650         GO  TO  MR020.
005660     IF W-SEN       =   1             GO  TO  MR050.              I.030722
005670*****IF W-SEN       =  "1"            GO  TO  MR050.              D.030722
005680 MR030.
005690     ACCEPT        ACP-FROM.
005700     DISPLAY       DISP-MSG-SPACE.
005710     IF  ESTAT  =  "09"
005720         GO  TO  MR020.
005730     IF ESTAT  NOT  =  "01"   AND    "06"
005740        GO  TO  MR030.
005750     DISPLAY       ACP-FROM.
005760 MR040.
005770     ACCEPT       ACP-TO.
005780     DISPLAY      DISP-MSG-SPACE.
005790     IF  ESTAT  =  "09"
005800         GO  TO  MR030.
005810     IF  ESTAT  NOT  =  "01"   AND    "06"
005820         GO  TO  MR040.
005830     DISPLAY      ACP-TO.
005840     IF  W-FROM   >  W-TO
005850         GO  TO  MR030.
005860     GO  TO  MR050.                                               I.981022
005870 MR042.                                                           I.981022
005880     ACCEPT  ACP-SNEN.                                            I.981022
005890     IF  ESTAT = "09"                                             I.981022
005900         GO  TO  MR020.                                           I.981022
005910     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
005920         GO  TO  MR042.                                           I.981022
005930     MOVE  20    TO  W-SNEN1.                                     I.090919
005940*****MOVE  ZERO  TO  W-SNEN1.                                     D.090919
005950*****IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1                    D.090919
005960*****    ADD  DATE-NC1  TO  W-SNEN.                               D.090919
005970*****IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2                    D.090919
005980*****    ADD  DATE-NC2  TO  W-SNEN.                               D.090919
005990*****IF  W-SNEN2 > 90                                             D.981027
006000*****    ADD  1900  TO  W-SNEN                                    D.981027
006010*****  ELSE                                                       D.981027
006020*****    ADD  2000  TO  W-SNEN.                                   D.981027
006030 MR043.                                                           I.981022
006040     ACCEPT  ACP-SGET.                                            I.981022
006050     IF  ESTAT = "09"                                             I.981022
006060         GO  TO  MR042.                                           I.981022
006070     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006080         GO  TO  MR043.                                           I.981022
006090     IF  W-SGET < 1  OR  > 12                                     I.981022
006100         GO  TO  MR043.                                           I.981022
006110 MR044.                                                           I.981022
006120     ACCEPT  ACP-SPEY.                                            I.981022
006130     IF  ESTAT = "09"                                             I.981022
006140         GO  TO  MR043.                                           I.981022
006150     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006160         GO  TO  MR044.                                           I.981022
006170     IF  W-SGET < 1  OR  > 31                                     I.981022
006180         GO  TO  MR044.                                           I.981022
006190     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981022
006200         GO  TO  MR042.                                           I.981022
006210 MR046.                                                           I.981022
006220     ACCEPT  ACP-ENEN.                                            I.981022
006230     IF  ESTAT = "09"                                             I.981022
006240         GO  TO  MR044.                                           I.981022
006250     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006260         GO  TO  MR046.                                           I.981022
006270     MOVE  20    TO  W-ENEN1.                                     I.090919
006280*****MOVE  ZERO  TO  W-ENEN1.                                     D.090919
006290*****IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1                    D.090919
006300*****    ADD  DATE-NC1  TO  W-ENEN.                               D.090919
006310*****IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2                    D.090919
006320*****    ADD  DATE-NC2  TO  W-ENEN.                               D.090919
006330*****IF  W-ENEN2 > 90                                             D.981027
006340*****    ADD  1900  TO  W-ENEN                                    D.981027
006350*****  ELSE                                                       D.981027
006360*****    ADD  2000  TO  W-ENEN.                                   D.981027
006370 MR047.                                                           I.981022
006380     ACCEPT  ACP-EGET.                                            I.981022
006390     IF  ESTAT = "09"                                             I.981022
006400         GO  TO  MR046.                                           I.981022
006410     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006420         GO  TO  MR047.                                           I.981022
006430     IF  W-EGET < 1  OR  > 12                                     I.981022
006440         GO  TO  MR047.                                           I.981022
006450 MR048.                                                           I.981022
006460     ACCEPT  ACP-EPEY.                                            I.981022
006470     IF  ESTAT = "09"                                             I.981022
006480         GO  TO  MR047.                                           I.981022
006490     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981022
006500         GO  TO  MR048.                                           I.981022
006510     IF  W-SPEY < 1  OR  > 31                                     I.981022
006520         GO  TO  MR048.                                           I.981022
006530     IF  W-SNGP > W-ENGP                                          I.981022
006540         GO  TO  MR046.                                           I.981022
006550     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981022
006560         GO  TO  MR046.                                           I.981022
006570 MR050.
006580     ACCEPT     ACP-OK.
006590     DISPLAY    DISP-MSG-SPACE.
006600     IF  ESTAT  =  "09"
006610*****    GO  TO  MR040.                                           D.950202
006620*****    IF  W-SEN     =  "1"               GO  TO  MR020         D.981022
006630*****IF  W-SEN = "1"                                              D.030722
006640     IF  W-SEN =  1                                               I.030722
006650         GO  TO  MR042                                            I.981022
006660       ELSE                                                       I.950202
006670         GO  TO  MR040.                                           I.950202
006680     IF  ESTAT  NOT  =  "01"
006690         GO  TO  MR050.
006700     IF  W-OK   NOT  =  "1"   AND      "9"
006710         GO  TO  MR050.
006720     IF  W-OK        =  "9"
006730         DISPLAY         CLE-02
006740         INITIALIZE   ACT-WORK
006750         GO  TO  MR010.
006760*
006770     IF  W-FOC     =  0                                           I.030722
006780         MOVE  1       TO  W-FOC                                  I.030722
006790         OPEN  I-O     JNIF                                       I.030722
006800         OPEN  INPUT   HI2-M   TC-M      JCON.                    I.030722
006810     IF  W-POC     =  0                                           I.030722
006820         MOVE  1       TO  W-POC                                  I.030722
006830         OPEN  OUTPUT  P-F.                                       I.030722
006840     MOVE    W-FROM   TO  JNIF1-01.
006850     MOVE    ZERO     TO  JNIF1-02.
006860 MR055.
006870     START   JNIF     KEY  NOT  <  JNIF1-KEY   INVALID
006880         GO  TO  MR999.
006890     MOVE   "ON"      TO         STR-SW.                          I.900416
006900 MR060.
006910     READ    JNIF     NEXT       AT   END
006920*********MOVE  SPACE  TO  P-R                                     D.900416
006930*********WRITE  P-R  AFTER  PAGE                                  D.900416
006940         GO  TO  MR990.                                           R.900416
006950*****IF  JNIF1-02    =    7                 GO  TO  MR065.        D.080121
006960     IF  JNIF1-02    =    7                                       I.080121
006970         IF  OLD1        =    JNIF1-01      GO  TO  MR065         I.080121
006980         ELSE                               GO  TO  MR060.        I.080121
006990     MOVE     JNIF1-07    TO       SV-GYO.                        I.890831
007000     MOVE     JNIF1-051   TO       SV-TCD.                        I.010305
007010     IF  JS-SIGN  =  0                                            I.890828
007020         IF   JNIF1-07    NOT  =  1             GO  TO  MR060.    I.060308
007030*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6 OR 7                D.051216
007040*****    IF   JNIF1-07    =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
007050*****                                           GO  TO  MR060.    D.060308
007060*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6   GO  TO  MR060.    D.980122
007070     IF  JS-SIGN  =  1                                            I.890828
007080         IF   JNIF1-07    NOT  =  6             GO  TO  MR060.    I.060308
007090*****    IF   JNIF1-07    NOT =  2 AND 3        GO  TO  MR060.    D.060308
007100     IF  JS-SIGN  =  2                                            I.900411
007110         IF   JNIF1-07    NOT  =  7             GO  TO  MR060.    I.060308
007120*****    IF   JNIF1-07    NOT =  5 AND 6        GO  TO  MR060.    D.060308
007130     IF  JS-SIGN  =  3                                            I.950201
007140         IF   JNIF1-07    NOT  =  4             GO  TO  MR060.    I.060308
007150*****    IF   JNIF1-07    NOT =  2 AND 3 AND 5 AND 6              D.060308
007160*****                                           GO  TO  MR060.    D.060308
007170*****IF  JS-SIGN  =  4                                            D.060308
007180*****    IF   JNIF1-07    NOT =  7              GO  TO  MR060.    D.060308
007190***
007200     IF  W-JS      NOT =  9                                       I.030707
007210         IF  JNIF1-13A   NOT =  W-JS            GO  TO  MR060.    I.030707
007220*****IF  W-JS     =  0                                            D.030707
007230*****    IF   JNIF1-13A   NOT =  0              GO  TO  MR060.    D.030707
007240*****IF  W-JS     =  1                                            D.030707
007250*****    IF   JNIF1-13A   NOT =  1              GO  TO  MR060.    D.030707
007260*****IF  W-JS     =  9                                            D.030707
007270*****    IF   JNIF1-13A   NOT =  0 AND 1        GO  TO  MR060.    D.030707
007280*****IF  JS-SIGN4 =  0                                            D.011109
007290*****    IF   JNIF1-051       =  0459  OR  0460  OR  3966         D.011109
007300*****                                           GO  TO  MR060.    D.011109
007310*****IF  JS-SIGN4 =  1                                            D.011109
007320*****    IF   JNIF1-051   NOT =  0459 AND  0460 AND  3966         D.011109
007330*****                                           GO  TO  MR060.    D.011109
007340     MOVE  ZERO      TO  W-NGP.                                   I.981027
007350     MOVE  JNIF1-04  TO  W-NGPS.                                  I.981022
007360     MOVE  20        TO  W-NEN1.                                  1.090919
007370*****IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     D.090919
007380*****    ADD  DATE-NC1  TO  W-NEN.                                D.090919
007390*****IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     D.090919
007400*****    ADD  DATE-NC2  TO  W-NEN.                                D.090919
007410*****IF  W-NEN2 > 90                                              D.981027
007420*****    ADD  1900  TO  W-NEN                                     D.981027
007430*****  ELSE                                                       D.981027
007440*****    ADD  2000  TO  W-NEN.                                    D.981027
007450     IF  W-NGP < W-SNGP  OR  > W-ENGP                             I.981022
007460         GO  TO  MR060.                                           I.981022
007470     MOVE   "OF"      TO         STR-SW.                          I.900416
007480     GO  TO   MR066.                                              I.890831
007490 MR065.
007500     IF  JS-SIGN  =  0                                            I.890828
007510         IF   SV-GYO      NOT  =  1             GO  TO  MR060.    I.060308
007520*****    IF   SV-GYO      =  2 OR 3 OR 5 OR 6 OR 7                D.051216
007530*****    IF   SV-GYO      =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
007540*****                                           GO  TO  MR060.    D.060308
007550*****    IF   SV-GYO      =  2 OR 3 OR 5 OR 6   GO  TO  MR060.    D.980122
007560     IF  JS-SIGN  =  1                                            I.890828
007570         IF   SV-GYO      NOT  =  6             GO  TO  MR060.    I.060308
007580*****    IF   SV-GYO      NOT =    2  AND  3    GO  TO  MR060.    D.060308
007590     IF  JS-SIGN  =  2                                            I.900411
007600         IF   SV-GYO      NOT  =  7             GO  TO  MR060.    I.060308
007610*****    IF   SV-GYO      NOT =    5  AND  6    GO  TO  MR060.    D.060308
007620     IF  JS-SIGN  =  3                                            I.950201
007630         IF   SV-GYO      NOT  =  4             GO  TO  MR060.    I.060308
007640*****    IF   SV-GYO      NOT =    2  AND  3  AND  5  AND  6      D.060308
007650*****                                           GO  TO  MR060.    D.060308
007660*****IF  JS-SIGN  =  4                                            D.060308
007670*****    IF   SV-GYO      NOT =    7            GO  TO  MR060.    D.060308
007680***
007690     IF  W-JS      NOT =  9                                       I.030707
007700         IF   JNIF2-07A   NOT =  W-JS           GO  TO  MR060.    I.030707
007710*****IF  W-JS     =  0                                            D.030707
007720*****    IF   JNIF2-07A   NOT =  0              GO  TO  MR060.    D.030707
007730*****IF  W-JS     =  1                                            D.030707
007740*****    IF   JNIF2-07A   NOT =  1              GO  TO  MR060.    D.030707
007750*****IF  W-JS     =  9                                            D.030707
007760*****    IF   JNIF2-07A   NOT =  0 AND 1        GO  TO  MR060.    D.030707
007770*****IF  JS-SIGN4 =  0                                            D.011109
007780*****    IF   SV-TCD          =  0459  OR  0460  OR  3966         D.011109
007790*****                                           GO  TO  MR060.    D.011109
007800*****IF  JS-SIGN4 =  1                                            D.011109
007810*****    IF   SV-TCD      NOT =  0459 AND  0460 AND  3966         D.011109
007820*****                                           GO  TO  MR060.    D.011109
007830     MOVE   "OF"      TO         STR-SW.                          I.900416
007840 MR066.
007850     IF  W-SEN    =  1
007860         IF  (JNIF1-10    =   0)   AND     (JNIF1-11     =    1)
007870             NEXT    SENTENCE
007880         ELSE        GO  TO  MR060.
007890     IF  W-SEN    =   2
007900         IF  JNIF1-10    =   1
007910             NEXT    SENTENCE
007920         ELSE        GO  TO  MR060.
007930     IF  W-FROM   >  JNIF1-01
007940         GO  TO  MR060.
007950     IF  W-TO     <  JNIF1-01
007960         MOVE  SPACE  TO  P-R
007970         WRITE  P-R  AFTER  PAGE
007980         GO  TO  MR999.
007990     IF  JNIF1-14  NOT  =    W-OKNO                               I.960821
008000         MOVE   JNIF1-14     TO   W-OKNO                          I.960821
008010         MOVE   ZERO         TO   W-NO.                           I.960821
008020     IF  JNIF1-01  NOT  =    OLD1
008030         PERFORM  HED-RTN  THRU   HED-EX
008040*****    MOVE   JNIF1-13     TO   G-CNT  M-CNT                    D.960821
008050*****    MOVE   JNIF1-13     TO   W-CNT.                          D.960821
008060*MR070.                                                           D.960821
008070         MOVE   JNIF1-13     TO   W-CNT                           I.960821
008080         MOVE   JNIF1-01     TO      OLD1.
008090     IF  JNIF1-02        =   7
008100         GO  TO  MR080.
008110     PERFORM     MOV-RTN    THRU   MOV-EX.
008120     GO  TO  MR060.
008130 MR080.
008140     MOVE  SPACE     TO     R3-R.                                 I.960821
008150     MOVE     K-1    TO     R3-K1.
008160     MOVE  M5-K2     TO     R3-K30.                               I.060308
008170     MOVE  M4-K5     TO     R3-K20.                               I.060308
008180     MOVE  JNIF2-03  TO     W-TEKI.                               *A631025
008190     MOVE  W-TEKI2   TO     P-TEKI1.                              "
008200     MOVE  JNIF2-02A TO     P-TEKI2.                              "
008210     MOVE  P-TEKI    TO     R3-01.                                "
008220     MOVE   SOUKO    TO     R3-02.                                I.920826
008230     MOVE     K-2    TO     R3-K2.
008240     IF  W-SEN   =    1
008250         PERFORM    RW2-RTN     THRU     RW2-EX.
008260     PERFORM     PRI-RTN    THRU     PRI-EX
008270         W-CNT       TIMES.
008280     INITIALIZE  R1-R     R2-R      MEI.
008290     MOVE  0  TO  SV-GYO.                                         I.981022
008300     MOVE  ZERO TO  SV-TCD.                                       I.010305
008310     GO  TO  MR060.
008320 MR990.                                                           I.900416
008330     IF  STR-SW  =  "ON"                    GO  TO  MR999.        I.900416
008340     MOVE  SPACE  TO  P-R.                                        I.900416
008350     WRITE  P-R  AFTER  PAGE.                                     I.900416
008360 MR999.
008370     PERFORM     END-RTN    THRU   END-EX.
008380     STOP  RUN.
008390*********************************************
008400*    ＩＮＴ－ＲＴＮ                         *
008410*********************************************
008420 INT-RTN.
008430     ACCEPT        JS-W.                                          I.091019
008440     IF  JS-W       >  3                      STOP  RUN.          I.091019
008450     IF  JS-W       =  0            MOVE  0       TO  JS-SIGN.    I.091019
008460     IF  JS-W       =  2            MOVE  1       TO  JS-SIGN.    I.091019
008470     IF  JS-W       =  3            MOVE  3       TO  JS-SIGN.    I.091019
008480*****ACCEPT        JS-SIGN.                                       D.091019
008490*****ACCEPT        W-JS.                                          D.030722
008500*****IF  JS-SIGN   =  0                                           D.011109
008510*****    IF  W-JS       =   1                                     D.011109
008520*****        ACCEPT     JS-SIGN4.                                 D.011109
008530*****ACCEPT        JS-SIGN3.                                      D.981029
008540*
008550     INITIALIZE     ACT-WORK.
008560     DISPLAY        CLE-01      DSP-AREA.
008570***
008580*****MOVE  SPACE         TO  WS-MID.                              D.030722
008590*****IF  W-JS       =  0   MOVE  NC"［教　育］"  TO  WS-MID.      D.030722
008600*****IF  W-JS       =  1   MOVE  NC"［ワーク］"  TO  WS-MID.      D.030722
008610*****IF  W-JS       =  2   MOVE  NC"［カジュ］"  TO  WS-MID.      D.030722
008620*****IF  W-JS       =  1   MOVE  NC"［一　般］"  TO  WS-MID.      D.030707
008630*****DISPLAY  DSP-MID.                                            D.030722
008640***
008650*****MOVE  SPACE         TO  WS-YOUSI.                            D.011109
008660*****IF  JS-SIGN4   =  0   MOVE  NC"社名あり用紙"  TO  WS-YOUSI.  D.011109
008670*****IF  JS-SIGN4   =  1   MOVE  NC"社名なし用紙"  TO  WS-YOUSI.  D.011109
008680*****IF  JS-SIGN    =  0                                          D.011109
008690*****    IF  W-JS       =   1                                     D.011109
008700*****        DISPLAY  DSP-YOUSI                                   D.011109
008710*****        IF  JS-SIGN4   =  1                                  D.011109
008720*****            MOVE  NC"〒"        TO  M2-UM                    D.011109
008730*****MOVE  NC"〒"        TO  M2-UM.                               D.060308
008740*****MOVE    "TEL"       TO  M5-TM.                               D.060308
008750***
008760*****IF  JS-SIGN      =  4                                        D.011018
008770*****    OPEN  I-O      GDMM                                      D.011018
008780*****    MOVE  "0"      TO  GDMM-KEY                              D.011018
008790*****    READ  GDMM     INVALID  KEY                              D.011018
008800*****          CLOSE    GDMM                                      D.011018
008810*****          DISPLAY  DSP-GDMM   DISP-BUZ-B                     D.011018
008820*****          STOP  RUN.                                         D.011018
008830*****OPEN  I-O     JNIF                                           D.030722
008840*****OPEN  INPUT   SHM     TC-M      JCON                         D.010808
008850*****OPEN  INPUT   HI2-M   TC-M      JCON                         D.030722
008860*****OPEN  OUTPUT  P-F.                                           D.030722
008870 INT-EX.
008880     EXIT.
008890*********************************************
008900*    ＥＮＤ－ＲＴＮ                         *
008910*********************************************
008920 END-RTN.
008930     IF  W-FOC     =  1                                           I.030722
008940         CLOSE  JNIF    HI2-M   TC-M    JCON.                     I.030722
008950     IF  W-POC     =  1                                           I.030722
008960         CLOSE  P-F.                                              I.030722
008970*****CLOSE  JNIF    SHM     TC-M    JCON    P-F.                  D.010808
008980*****CLOSE  JNIF    HI2-M   TC-M    JCON    P-F.                  D.030722
008990*****IF  JS-SIGN      =  4              CLOSE  GDMM.              D.011018
009000     DISPLAY CLE-01.
009010 END-EX.
009020     EXIT.
009030**********************************************
009040*    ＨＥＤ－ＲＴＮ                          *
009050**********************************************
009060 HED-RTN.
009070     MOVE    JNIF1-05    TO  TC-KEY.
009080     READ    TC-M    WITH UNLOCK     INVALID
009090         MOVE   SPACE   TO  TC-UNO
009100         MOVE  ALL NX"2121"  TO  TC-NAME
009110         MOVE  ALL NX"2121"  TO  TC-JSU
009120         MOVE  ALL NX"2121"  TO  TC-JSS.
009130     MOVE   TC-UNO    TO  M1-01.
009140     MOVE   JNIF1-01  TO  M1-02.
009150     MOVE   JNIF1-041 TO  M1-03.
009160     MOVE   JNIF1-042 TO  M1-04.
009170     MOVE   JNIF1-043 TO  M1-05.
009180     MOVE   JNIF1-14  TO  M1-06.
009190     MOVE   TC-JSU   TO  M2-01.
009200     MOVE   TC-JSS   TO  M3-01.
009210     IF  JNIF1-08    <   0
009220             MOVE      NC"－"      TO       M3-02
009230     ELSE    MOVE      NC"　"      TO       M3-02.
009240     IF  JNIF1-08  =  ZERO   MOVE  "***"  TO    A                 I900524
009250                ELSE         MOVE   JNIF1-08 TO  AAR.
009260     MOVE   A        TO  M4-01.
009270     MOVE   TC-NAME  TO  M5-01.
009280     MOVE   JNIF1-06 TO  JCON2-02.
009290     MOVE   "2"      TO  JCON2-01.
009300     READ   JCON     WITH UNLOCK  INVALID
009310         MOVE   ALL NX"2121"  TO  JCON2-03.
009320     MOVE   JCON2-03 TO  M5-02.
009330     MOVE   JNIF1-07 TO  JCON3-02.
009340     MOVE   "3"      TO  JCON3-01.
009350     READ   JCON     WITH UNLOCK  INVALID
009360         MOVE   ALL NX"2121"  TO  JCON3-03.
009370     MOVE   JCON3-03 TO  SOUKO.                                   I.920826
009380     IF  JNIF1-07    =   1                                        I.090519
009390         IF  JNIF1-051   =   2654  OR  2656  OR  2657  OR  4038   I.090519
009400                                   OR  4054  OR  4056  OR  4057   I.090519
009410             MOVE      NC"富　士　　　"  TO       SOUKO.          I.090519
009420     MOVE   SPACE    TO  M0-01.                                   I.090919
009430     IF  JNIF1-051   =   2650  OR  2651  OR  2652                 I.090919
009440         IF  JNIF1-052 NOT =   001                                I.090919
009450             MOVE   NC"☆☆☆☆☆"    TO  M0-01.                  I.090919
009460     IF  JNIF1-051   =   7040                                     I.101013
009470         MOVE   NC"◎◎◎◎◎"    TO  M0-01.                      I.101013
009480*****MOVE   JCON3-03 TO  M3-03.                                   D.920826
009490*****MOVE   "("      TO  M3-03F.                                  D.920826
009500*****MOVE   ")"      TO  M3-03R.                                  D.920826
009510*****IF  JS-SIGN     NOT =  0                                     D.011109
009520*****    GO  TO HED-EX.                                           D.011109
009530*****IF  W-JS        NOT =  1                                     D.011109
009540*****    GO  TO HED-EX.                                           D.011109
009550*****IF  JS-SIGN4    NOT =  1                                     D.011109
009560*****    GO  TO HED-EX.                                           D.011109
009570*****IF  JNIF1-052       =  001                                   D.060308
009580*****    MOVE  "700-0034"       TO  M2-UNO                        D.051202
009590*****    MOVE  NC"岡山市高柳東町１３－４６　　" TO  M3-JS         D.051202
009600*****    MOVE  "700-0975"       TO  M2-UNO                        D.060308
009610*****    MOVE  NC"岡山市今８丁目１６－１７　　" TO  M3-JS         D.060308
009620*****    MOVE  NC"日進ゴム株式会社　　" TO  M4-NA                 D.060308
009630*****    MOVE  "086-243-2456  " TO  M5-TEL                        D.060308
009640*****    MOVE  "086-252-2456  " TO  M5-TEL                        D.051202
009650*****    GO  TO HED-EX.                                           D.060308
009660*****IF  JNIF1-051       =  4038                                  D.091112
009670     IF  JNIF1-051       =  4038  OR  4054  OR  4056  OR  4057    I.091112
009680         MOVE  "542-0081"       TO  M2A-UNO                       I.090519
009690         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.090519
009700         MOVE  NC"大阪市中央区南船場　　　　　" TO  M2-JSN        I.090519
009710         MOVE  NC"　　　　　　　１丁目１１－９" TO  M3-JS         I.090519
009720         MOVE  NC"千曲産業株式会社　　" TO  M4-NA                 I.090519
009730         MOVE  "06-6268-4561  " TO  M5-TEL                        I.090519
009740         GO  TO HED-EX.                                           I.090519
009750     IF  JNIF1-051       =  2654  OR  2656  OR  2657              I.090519
009760         MOVE  "520-2132"       TO  M2A-UNO                       I.090519
009770         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.090519
009780         MOVE  NC"滋賀県大津市神領１－９－３　" TO  M2-JSN        I.090519
009790         MOVE  NC"　　　　　　　　　　　　　　" TO  M3-JS         I.090519
009800         MOVE  NC"株式会社新日本教育シューズ　" TO  M4-NA         I.090519
009810         MOVE  "077-543-1331  " TO  M5-TEL                        I.090519
009820         GO  TO HED-EX.                                           I.090519
009830     IF  JNIF1-052   NOT =  001                                   I.060308
009840         IF  JNIF1-051       =  0459                              I.010305
009850*****    MOVE  "663-8033"       TO  M2-UNO                        D.060308
009860*****    MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M3-JS         D.060308
009870             MOVE  "663-8033"       TO  M2A-UNO                   I.060308
009880             MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M2-JSN    I.060308
009890             MOVE  NC"株式会社上山實業　　" TO  M4-NA             I.010305
009900             MOVE  "0798-64-5111  " TO  M5-TEL                    I.011109
009910             GO  TO HED-EX.                                       I.060308
009920*****  ELSE                                                       D.060308
009930*****    MOVE  "0798-64-5111  " TO  M5-TEL.                       D.011109
009940     IF  JNIF1-052   NOT =  001                                   I.060308
009950         IF  JNIF1-051       =  0460                              I.010305
009960*****        MOVE  "663-8033"       TO  M2-UNO                    D.060308
009970*****        MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M3-JS     D.060308
009980             MOVE  "663-8033"       TO  M2A-UNO                   I.060308
009990             MOVE  NC"兵庫県西宮市高木東町１５－１" TO  M2-JSN    I.060308
010000             MOVE  NC"株式会社ウエヤマ　　" TO  M4-NA             I.010305
010010             MOVE  "0798-67-0810  " TO  M5-TEL                    I.011109
010020             GO  TO HED-EX.                                       I.060308
010030     IF  JNIF1-051       =  3015                                  I.110804
010040         MOVE  "114-0034"       TO  M2A-UNO                       I.110804
010050         MOVE  NC"東京都北区上十条４－１－５　" TO  M2-JSN        I.110804
010060         MOVE  NC"株式会社スギヤマ　　" TO  M4-NA                 I.110804
010070         MOVE  "03-3909-8883  " TO  M5-TEL                        I.110804
010080         GO  TO HED-EX.                                           I.110804
010090*****      ELSE                                                   D.060308
010100*****        MOVE  "0798-67-0810  " TO  M5-TEL.                   D.011109
010110*****IF  JNIF1-052   NOT =  001                                   D.090919
010120*****    IF  JNIF1-051       =  3966                              D.090919
010130*****            MOVE  "165-0021"       TO  M2-UNO                D.060308
010140*****            MOVE  NC"東京都中野区丸山２－５－１９" TO  M3-JS D.060308
010150*****        MOVE  "165-0021"       TO  M2A-UNO                   D.090919
010160*****        MOVE  NC"東京都中野区丸山２－５－１９" TO  M2-JSN    D.090919
010170*****        MOVE  NC"多比良株式会社　　　" TO  M4-NA             D.090919
010180*****        MOVE  "03-5373-6711  " TO  M5-TEL                    D.090919
010190*****        GO  TO HED-EX.                                       D.090919
010200*****          ELSE                                               D.060308
010210*****            MOVE  "700-0034"       TO  M2-UNO                D.051202
010220*****            MOVE  NC"岡山市高柳東町１３－４６　　" TO  M3-JS D.051202
010230*****            MOVE  "700-0975"       TO  M2-UNO                D.060308
010240*****            MOVE  NC"岡山市今８丁目１６－１７　　" TO  M3-JS D.060308
010250     IF  JS-SIGN         =  0                                     I.060308
010260         MOVE  "700-0975"       TO  M2A-UNO                       I.060308
010270         MOVE  NC"　　　　　　" TO  M2A-JSO                       I.060308
010280*****    MOVE  NC"岡山市今８丁目１６－１７　　" TO  M2-JSN        D.090519
010290         MOVE  NC"岡山市北区今８丁目１６－１７" TO  M2-JSN        I.090519
010300         MOVE  NC"　　　　　　　　　　　　　　" TO  M3-JS         I.060308
010310         MOVE  NC"日進ゴム株式会社　　" TO  M4-NA                 I.011109
010320     ELSE  IF  JS-SIGN         =  1                               I.060308
010330               MOVE  "713-8103"       TO  M2A-UNO                 I.060308
010340               MOVE  NC"岡山県倉敷市" TO  M2A-JSO                 I.060308
010350               MOVE  NC"玉島乙島字新湊８２６２－１　" TO  M2-JSN  I.060308
010360               MOVE  NC"　　水島港国際物流センター内" TO  M3-JS   I.060308
010370               MOVE  NC"日進ゴム㈱　玉島物流センター" TO  M4-NA   I.060308
010380     ELSE  IF  JS-SIGN         =  2                               I.060308
010390               MOVE  "709-3717"       TO  M2A-UNO                 I.060308
010400               MOVE  NC"　　　　　　" TO  M2A-JSO                 I.060308
010410               MOVE  NC"岡山県久米郡　　　　　　　　" TO  M2-JSN  I.060308
010420               MOVE  NC"　　美咲町原田３２２７－１　" TO  M3-JS   I.060308
010430               MOVE  NC"日進ゴム㈱　津山物流センター" TO  M4-NA   I.060308
010440     ELSE  IF  JS-SIGN         =  3                               I.060308
010450               MOVE  "701-0304"       TO  M2A-UNO                 I.060926
010460               MOVE  NC"岡山県都窪郡" TO  M2A-JSO                 I.060926
010470               MOVE  NC"早島町早島４５０７－３７　　" TO  M2-JSN  I.060926
010480*****          MOVE  NC"両備運輸中四国配送センター内" TO  M3-JS   D.080121
010490               MOVE  NC"両備ＨＤ中四国物流センター内" TO  M3-JS   I.080121
010500               MOVE  NC"日進ゴム　早島配送センター　" TO  M4-NA.  I.060926
010510*****          MOVE  "703-8233"       TO  M2A-UNO                 D.060926
010520*****          MOVE  NC"　　　　　　" TO  M2A-JSO                 D.060926
010530*****          MOVE  NC"岡山市高屋３０８　　　　　　" TO  M2-JSN  D.060926
010540*****          MOVE  NC"　　　　　両備運輸㈱内　　　" TO  M3-JS   D.060926
010550*****          MOVE  NC"日進ゴム㈱　高屋配送センター" TO  M4-NA.  D.060926
010560     MOVE  "086-243-2456  " TO  M5-TEL.                           I.011109
010570*****            MOVE  "086-252-2456  " TO  M5-TEL.               D.051202
010580*****            MOVE  "03-5373-6711  " TO  M5-TEL.               D.011109
010590 HED-EX.
010600     EXIT.
010610**********************************************
010620*    ＰＲＩ－ＲＴＮ                          *
010630**********************************************
010640 PRI-RTN.
010650     MOVE SPACE  TO  P-R.
010660     IF  LCNT    NOT =  90
010670         WRITE  P-R  AFTER  PAGE.
010680     MOVE    SPACE  TO  W-P.                                      I.090919
010690     MOVE    MID0-R TO  W-P.                                      I.090919
010700     MOVE    W-P    TO  P-R.                                      I.090919
010710     WRITE   P-R  AFTER 3.                                        I.090919
010720     MOVE    SPACE TO  P-R.                                       I.090919
010730     MOVE    SPACE  TO  W-P.                                      I.961015
010740*****MOVE    MID1-R TO  P-R.                                      D.961015
010750*****IF  JS-SIGN3    =  0                                         D.981029
010760*****                MOVE    MID1-R TO  W-P1                      D.981029
010770*****          ELSE                                               D.981029
010780     MOVE    MID1-R TO  W-P.                                      I.961015
010790     MOVE    W-P    TO  P-R.                                      I.961015
010800     WRITE   P-R  AFTER 2.                                        I.090919
010810*****WRITE   P-R  AFTER 5.                                        D.090919
010820     MOVE    SPACE TO  P-R.
010830     ADD     1     TO  W-NO.                                      I.960821
010840     MOVE    W-NO  TO  M2-02.                                     I.960821
010850*****IF      G-CNT  <  2           GO       TO  PRI-005.          D 920614
010860*****IF      G-CNT  <  2           GO       TO  PRI-005.          D.960821
010870*****IF      G-CNT  <  2                                          D.920826
010880*****        WRITE  P-R  AFTER  1                                 D.920826
010890*****        GO TO  PRI-005.                                      D.920826
010900*****IF      G-CNT  =  M-CNT       MOVE  0  TO  M-CNT.            D.960821
010910*****ADD     1     TO  M-CNT.                                     D.960821
010920*****MOVE    M-CNT TO  M2-02.                                     D.960821
010930*****MOVE    M-CNT TO  M1A-01.                                    D.920826
010940*****MOVE    MID1A-R  TO  P-R.                                    D.920826
010950*****WRITE   P-R   AFTER  1.                                      D.920826
010960*****MOVE    SPACE TO  P-R.                                       D.920826
010970 PRI-005.                                                         A 911106
010980     MOVE    SPACE   TO  W-P.                                     I.961015
010990*****MOVE    MID2-R  TO  P-R.                                     D.961015
011000*****IF  JS-SIGN3    =  0                                         D.981029
011010*****                MOVE    MID2-R  TO  W-P1                     D.981029
011020*****           ELSE                                              D.981029
011030***  WRITE   P-R  AFTER 2.                                        D 911106
011040*****WRITE   P-R  AFTER 1.                                        D.920826
011050     MOVE    MID2A-R TO  W-P.                                     I.060308
011060     MOVE    W-P     TO  P-R.                                     I.060308
011070     WRITE   P-R  AFTER 1.                                        I.060308
011080     MOVE    SPACE TO  P-R.                                       I.060308
011090     MOVE    SPACE   TO  W-P.                                     I.060308
011100     MOVE    MID2-R  TO  W-P.                                     I.961015
011110     MOVE    W-P     TO  P-R.                                     I.961015
011120     WRITE   P-R  AFTER 1.                                        I.060308
011130*****WRITE   P-R  AFTER 2.                                        D.060308
011140     MOVE    SPACE TO  P-R.
011150     MOVE    SPACE   TO  W-P.                                     I.961015
011160*****MOVE    MID3-R  TO  P-R.                                     D.961015
011170*****IF  JS-SIGN3    =  0                                         D.981029
011180*****                MOVE    MID3-R  TO  W-P1                     D.981029
011190*****           ELSE                                              D.981029
011200     MOVE    MID3-R  TO  W-P.                                     I.961015
011210     MOVE    W-P     TO  P-R.                                     I.961015
011220     WRITE   P-R  AFTER 1.
011230     MOVE    SPACE TO  P-R.
011240     MOVE    SPACE   TO  W-P.                                     I.961015
011250*****MOVE    MID4-R  TO  P-R.                                     D.961015
011260*****IF  JS-SIGN3    =  0                                         D.981029
011270*****                MOVE    MID4-R  TO  W-P1                     D.981029
011280*****           ELSE                                              D.981029
011290     MOVE    MID4-R  TO  W-P.                                     I.961015
011300     MOVE    W-P     TO  P-R.                                     I.961015
011310     WRITE   P-R  AFTER 1.
011320     MOVE    SPACE TO  P-R.
011330     MOVE    SPACE   TO  W-P.                                     I.961015
011340     MOVE  MID5-R        TO  W-P.                                 I.011109
011350     MOVE  W-P           TO  P-R.                                 I.011109
011360     WRITE  P-R     AFTER  1.                                     I.011109
011370     MOVE  SPACE         TO  P-R.                                 I.011109
011380     MOVE  SPACE         TO  W-P.                                 I.011109
011390     WRITE   P-R  AFTER 2.                                        I.021108
011400*****IF  JS-SIGN4    =  1                                         D.011109
011410*****    MOVE  MID5-R        TO  W-P                              D.011109
011420*****    MOVE  W-P           TO  P-R                              D.011109
011430*****    WRITE  P-R     AFTER  1                                  D.011109
011440*****    MOVE  SPACE         TO  P-R                              D.011109
011450*****    MOVE  SPACE         TO  W-P                              D.011109
011460*****  ELSE                                                       D.011109
011470*****    WRITE  P-R     AFTER  1.                                 D.011109
011480*****WRITE   P-R  AFTER 3.                                        D.950317
011490*****MOVE    MID6-R  TO  P-R.                                     D.961015
011500*****IF  JS-SIGN3    =  0                                         D.981029
011510*****                MOVE    MID6-R  TO  W-P1                     D.981029
011520*****           ELSE                                              D.981029
011530*****MOVE    MID6-R  TO  W-P.                                     D.021108
011540*****MOVE    W-P     TO  P-R.                                     D.021108
011550*****WRITE   P-R  AFTER 1.                                        D.021108
011560*****WRITE   P-R  AFTER 2.                                        D.010305
011570*****MOVE    SPACE TO  P-R.                                       D.021108
011580*****WRITE   P-R  AFTER 1.                                        D.021108
011590     MOVE    0    TO    I.
011600 PRI-010.
011610     ADD     1    TO    I.
011620     IF      I     >    6
011630         GO  TO  PRI-020.
011640     MOVE    MEI1-R(I)     TO    P-R.
011650     WRITE   P-R  AFTER 1.
011660     MOVE    SPACE TO  P-R.
011670     MOVE    MEI2-R(I)     TO    P-R.
011680     WRITE   P-R  AFTER 1.
011690     MOVE    SPACE TO  P-R.
011700     GO  TO  PRI-010.
011710 PRI-020.
011720     MOVE    SPACE         TO    W-P.                             I.961015
011730*****MOVE    R3-R          TO    P-R.                             D.961015
011740*****IF  JS-SIGN3    =  0                                         D.981029
011750*****                MOVE    R3-R          TO    W-P1             D.981029
011760*****           ELSE                                              D.981029
011770     MOVE    R3-R          TO    W-P.                             I.961015
011780     MOVE    W-P           TO    P-R.                             I.961015
011790     WRITE   P-R  AFTER 1.                                        I.060308
011800*****WRITE   P-R  AFTER 2.                                        D.060308
011810     MOVE    SPACE TO  P-R.
011820*
011830     MOVE    SPACE TO  R2-R.                                      I.091214
011840     MOVE   K-1    TO  R2-K1.                                     I.091214
011850     MOVE    SPACE TO  R2-01.                                     I.091214
011860     MOVE   K-2    TO  R2-K2.                                     I.091214
011870     MOVE   W-KEI  TO  R2-03.                                     I.091214
011880     MOVE    SPACE         TO    W-P.                             I.091214
011890     MOVE    R2-R          TO    W-P.                             I.091214
011900     MOVE    W-P           TO    P-R.                             I.091214
011910     WRITE   P-R  AFTER 1.                                        I.091214
011920     MOVE    SPACE TO  P-R.                                       I.091214
011930*
011940     MOVE    0     TO  W-KEI.                                     I.091214
011950     MOVE    7     TO  LCNT.
011960 PRI-EX.
011970     EXIT.
011980***************************************************
011990*    ＴＳＴ－ＲＴＮ                               *
012000***************************************************
012010 TST-RTN.
012020     IF  W-POC     =  0                                           I.030722
012030         MOVE  1       TO  W-POC                                  I.030722
012040         OPEN  OUTPUT  P-F.                                       I.030722
012050     MOVE    SPACE   TO  P-R.
012060     IF   LCNT   NOT   =     90
012070         WRITE   P-R     AFTER    PAGE.
012080     MOVE   ALL "X" TO  M1-01.
012090     MOVE   ALL "9" TO  M1-02.
012100     MOVE   "99"    TO  M1-03.
012110     MOVE   "99"    TO  M1-04.
012120     MOVE   "99"    TO  M1-05.
012130     MOVE   ALL "9" TO  M1-06.                                    I.920826
012140     MOVE   SPACE   TO  W-P.                                      I.961015
012150*****MOVE   MID1-R  TO  P-R.                                      D.961015
012160*****IF  JS-SIGN3    =  0                                         D.981029
012170*****                MOVE   MID1-R  TO  W-P1                      D.981029
012180*****           ELSE                                              D.810295
012190     MOVE   MID1-R  TO  W-P.                                      I.961015
012200     MOVE   W-P     TO  P-R.                                      I.961015
012210     WRITE  P-R     AFTER   5.
012220     MOVE   SPACE   TO  P-R.
012230     MOVE   SPACE   TO  M2A-JSO.                                  I.060308
012240     MOVE  ALL NC"Ｎ"   TO    M2-JSN.                             I.060308
012250     MOVE  ALL NC"Ｎ"   TO    M2-01.
012260*****MOVE   ALL "X" TO  M2-UNO.                                   D.060308
012270     MOVE   ALL "X" TO  M2A-UNO.                                  I.060308
012280     MOVE    SPACE   TO    W-P.                                   I.961015
012290     MOVE    MID2A-R TO    W-P.                                   I.060308
012300     MOVE    W-P     TO    P-R.                                   I.060308
012310     WRITE   P-R     AFTER     1.                                 I.060308
012320     MOVE    SPACE   TO    P-R.                                   I.060308
012330     MOVE    SPACE   TO    W-P.                                   I.060308
012340*****MOVE    MID2-R  TO    P-R.                                   D.961015
012350*****IF  JS-SIGN3    =  0                                         D.981029
012360*****                MOVE    MID2-R  TO    W-P1                   D.981029
012370*****           ELSE                                              D.981029
012380     MOVE    MID2-R  TO    W-P.                                   I.961015
012390     MOVE    W-P     TO    P-R.                                   I.961015
012400     WRITE   P-R     AFTER     1.                                 I.060308
012410*****WRITE   P-R     AFTER     2.                                 D.060308
012420     MOVE    SPACE   TO    P-R.
012430     MOVE  ALL NC"Ｎ"   TO    M3-01.
012440     MOVE  ALL NC"Ｎ"   TO    M3-02.
012450     MOVE  ALL NC"Ｎ"   TO    M3-JS.                              I.010305
012460     MOVE  SPACE       TO    W-P.                                 I.961015
012470*****MOVE  ALL NC"Ｎ"   TO    M3-03.                              D.920826
012480*****MOVE   "("      TO  M3-03F.                                  D.920826
012490*****MOVE   ")"      TO  M3-03R.                                  D.920826
012500*****MOVE  MID3-R      TO    P-R.                                 D.961015
012510*****IF  JS-SIGN3    =  0                                         D.981029
012520*****                MOVE  MID3-R      TO    W-P1                 D.981029
012530*****           ELSE                                              D.981029
012540     MOVE  MID3-R      TO    W-P.                                 I.961015
012550     MOVE  W-P         TO    P-R.                                 I.961015
012560     WRITE   P-R       AFTER   1.
012570     MOVE  SPACE       TO    P-R.
012580     MOVE  ALL NC"Ｎ"   TO    M4-01.
012590     MOVE  ALL NC"Ｎ"   TO    M5-01.
012600     MOVE  ALL NC"Ｎ"   TO    M5-02.
012610     MOVE  ALL NC"Ｎ"   TO    M4-NA.                              I.010305
012620     MOVE  SPACE       TO    W-P.                                 I.961015
012630*****MOVE  MID4-R      TO    P-R.                                 D.961015
012640*****IF  JS-SIGN3    =  0                                         D.981029
012650*****                MOVE  MID4-R      TO    W-P1                 D.981029
012660*****           ELSE                                              D.981029
012670     MOVE  MID4-R      TO    W-P.                                 I.961015
012680     MOVE  W-P         TO    P-R.                                 I.961015
012690     WRITE   P-R   AFTER 1.
012700     MOVE   SPACE      TO    P-R.
012710     MOVE  ALL "X"       TO  M5-TEL.                              I.011109
012720     MOVE  MID5-R        TO  W-P.                                 I.011109
012730     MOVE  W-P           TO  P-R.                                 I.011109
012740     WRITE  P-R     AFTER  1.                                     I.011109
012750     MOVE  SPACE         TO  P-R.                                 I.011109
012760     WRITE  P-R     AFTER  2.                                     I.011109
012770*****IF  JS-SIGN4    =  1                                         D.011109
012780*****    MOVE  ALL "X"       TO  M5-TEL                           D.011109
012790*****    MOVE  MID5-R        TO  W-P                              D.011109
012800*****    MOVE  W-P           TO  P-R                              D.011109
012810*****    WRITE  P-R     AFTER  1                                  D.011109
012820*****    MOVE  SPACE         TO  P-R                              D.011109
012830*****    WRITE  P-R     AFTER  2                                  D.011109
012840*****  ELSE                                                       D.011109
012850*****    WRITE   P-R   AFTER 3.                                   D.011109
012860     MOVE    0         TO    LCNT.
012870 TST-010.
012880     MOVE    K-1     TO    R1-K1.
012890     MOVE  ALL NC"Ｎ" TO    R1-01.
012900     MOVE    K-2     TO    R1-K2.
012910     MOVE    SPACE   TO    W-P.                                   I.961015
012920*****MOVE    R1-R    TO    P-R.                                   D.961015
012930*****IF  JS-SIGN3    =  0                                         D.981029
012940*****                MOVE    R1-R    TO    W-P1                   D.981029
012950*****           ELSE                                              D.981029
012960     MOVE    R1-R    TO    W-P.                                   I.961015
012970     MOVE    W-P     TO    P-R.                                   I.961015
012980     WRITE   P-R     AFTER     1.
012990*****WRITE   P-R     AFTER     1.                                 D.980318
013000     MOVE    SPACE   TO    P-R.
013010     MOVE    K-1     TO    R2-K1.
013020     MOVE  ALL NC"Ｎ" TO    R2-01.
013030     MOVE    0       TO    I.
013040 TST-020.
013050     ADD     1       TO    I.
013060*****IF      I       >     27                                     D.920826
013070     IF      I       >     25                                     I.920826
013080         GO  TO  TST-030.
013090     MOVE  ALL "9"   TO    R2-021(I).
013100     GO  TO  TST-020.
013110 TST-030.
013120     MOVE  ALL "9"   TO    R2-03.
013130     MOVE  SPACE     TO    W-P.                                   I.961015
013140*****MOVE  R2-R      TO    P-R.                                   D.961015
013150*****IF  JS-SIGN3    =  0                                         D.981029
013160*****                MOVE  R2-R      TO    W-P1                   D.981029
013170*****           ELSE                                              D.981029
013180     MOVE  R2-R      TO    W-P.                                   I.961015
013190     MOVE  W-P       TO    P-R.                                   I.961015
013200     WRITE   P-R     AFTER     1.
013210     MOVE SPACE      TO  P-R.
013220     ADD     1       TO  LCNT.
013230     IF    LCNT   NOT   =    6
013240         GO  TO  TST-010.
013250     MOVE    K-1     TO   R3-K1.
013260     MOVE    M5-K2   TO   R3-K30.                                 I.060308
013270     MOVE    M4-K5   TO   R3-K20.                                 I.060308
013280     MOVE  ALL NC"Ｎ" TO   R3-01.
013290     MOVE  ALL NC"Ｎ" TO   R3-02.                                 I.920826
013300     MOVE    K-2     TO   R3-K2.
013310     MOVE    SPACE   TO   W-P.                                    I.961015
013320*****MOVE    R3-R    TO   P-R.                                    D.961015
013330*****IF  JS-SIGN3    =  0                                         D.981029
013340*****                MOVE    R3-R    TO   W-P1                    D.981029
013350*****           ELSE                                              D.981029
013360     MOVE    R3-R    TO   W-P.                                    I.961015
013370     MOVE    W-P     TO   P-R.                                    I.961015
013380     WRITE   P-R     AFTER     1.                                 I.060208
013390*****WRITE   P-R     AFTER     2.                                 D.060208
013400     MOVE SPACE      TO  P-R.
013410     ADD     1       TO  LCNT.
013420 TST-EX.
013430     EXIT.
013440***************************************************
013450*    ＭＯＶ－ＲＴＮ                               *
013460***************************************************
013470 MOV-RTN.
013480     MOVE   SPACE    TO  R1-R  R2-R  MEI1-R(JNIF1-02)             I.941206
013490                                     MEI2-R(JNIF1-02).            I.941206
013500     MOVE   K-1      TO  R1-K1.
013510     MOVE   JNIF1-03 TO  HI-MHCD HI-HCD.                          I.010808
013520     READ   HI2-M    WITH UNLOCK  INVALID                         I.010808
013530         MOVE   ZERO          TO  HI-ASSD                         I.010808
013540         MOVE   ZERO          TO  HI-HKB                          I.060822
013550         MOVE   ALL NX"2121"  TO  HI-NAME HI-SMS.                 I.090919
013560*****    MOVE   ALL NX"2121"  TO  HI-NAME.                        D.090919
013570*****MOVE   JNIF1-03 TO  SHM-KEY.                                 D.010808
013580*****READ   SHM      WITH UNLOCK  INVALID                         D.010808
013590*****    MOVE   ZERO          TO  SHM-04                          D.010808
013600*****    MOVE   ALL NX"2121"  TO  SHM-02.                         D.010808
013610*****MOVE   SHM-02  TO  W-SHM.                                    D.960821
013620*****IF    W-SHM-022  =  SPACE           GO  TO  MOV-002.         D.960821
013630*****MOVE  15        TO  W-NC.                                    D.960821
013640     MOVE   ALL NX"2121"     TO  W-NNA  W-ONA  W-UNA.             I.960821
013650*****IF    SHM-02        =   SPACE                                D.010808
013660*****IF    HI-NAME       =   SPACE                                D.090919
013670     IF    SPACE         =   HI-NAME   AND  HI-SMS                I.090919
013680                         GO  TO  MOV-008.                         I.960821
013690*****IF    HI-SMS    NOT =   SPACE                                D.100625
013700     IF   (HI-SMS    NOT =   SPACE)  AND  (JNIF1-07      =  6)    I.100625
013710           MOVE   HI-SMS  TO  W-NNA                               I.090919
013720     ELSE                                                         I.090919
013730           MOVE   HI-NAME TO  W-NNA.                              I.010808
013740*****MOVE   SHM-02  TO  W-NNA.                                    D.010808
013750*****IF    JNIF1-051     =   0459  OR  0460                       D.010709
013760     IF    JNIF1-051     =   0013  OR  0459  OR  0460             I.010709
013770           MOVE  SPACE   TO  W-NNM(24).                           I.000808
013780     MOVE   25      TO  W-C1.                                     I.960821
013790 MOV-001.                                                         ﾞ
013800     SUBTRACT    1    FROM   W-C1.                                I.960821
013810     IF    W-C1          =    ZERO                                I.960821
013820                         GO  TO  MOV-008.                         I.960821
013830     IF    W-NNM(W-C1)   =   SPACE                                I.960821
013840                         GO  TO  MOV-001.                         I.960821
013850     IF    W-C1          <   15                                   I.960821
013860                         MOVE   W-NNA      TO  W-UNA              I.960821
013870                         GO  TO  MOV-008.                         I.960821
013880     MOVE   ZERO    TO  W-C2.                                     I.960821
013890*****SUBTRACT    1    FROM   W-NC.                                D.960821
013900*****IF    W-NC  =    4                                           D.960821
013910*****            MOVE    SHM-02   TO  W-SHM                       D.960821
013920*****            GO  TO  MOV-002.                                 D.960821
013930*****IF    WSH-01(W-NC)  =   SPACE       GO  TO  MOV-002.         D.960821
013940*****IF    WSH-02(1)     =   SPACE       GO  TO  MOV-002.         D.960821
013950*****IF    WSH-02(10)    NOT  =  SPACE                            D.960821
013960*****            MOVE  SHM-02  TO  W-SHM                          D.960821
013970*****            GO  TO  MOV-002.                                 D.960821
013980*****MOVE  WSH-02(9)  TO  WSH-02(10).                             D.960821
013990*****MOVE  WSH-02(8)  TO  WSH-02(9).                              D.960821
014000*****MOVE  WSH-02(7)  TO  WSH-02(8).                              D.960821
014010*****MOVE  WSH-02(6)  TO  WSH-02(7).                              D.960821
014020*****MOVE  WSH-02(5)  TO  WSH-02(6).                              D.960821
014030*****MOVE  WSH-02(4)  TO  WSH-02(5).                              D.960821
014040*****MOVE  WSH-02(3)  TO  WSH-02(4).                              D.960821
014050*****MOVE  WSH-02(2)  TO  WSH-02(3).                              D.960821
014060*****MOVE  WSH-02(1)  TO  WSH-02(2).                              D.960821
014070*****MOVE  WSH-01(W-NC) TO  WSH-02(1).                            D.960821
014080*****MOVE  SPACE      TO  WSH-01(W-NC).                           D.960821
014090*****GO  TO  MOV-001.                                             D.960821
014100 MOV-002.                                                         ﾞ
014110     ADD         1    TO     W-C2.                                I.960821
014120     IF    W-C2    >    14                                        I.960821
014130                        MOVE   W-PNA1         TO  W-ONA           I.960821
014140                        MOVE   W-PNA2         TO  W-UNA           I.960821
014150                        GO  TO  MOV-006.                          I.960821
014160     MOVE  W-NNM(W-C2)  TO   W-ONM(W-C2).                         I.960821
014170     IF    W-NNM(W-C2)  NOT =    SPACE                            I.960821
014180                        GO  TO  MOV-002.                          I.960821
014190     COMPUTE  W-C3   =  W-C1      -     W-C2.                     I.960821
014200     IF    W-C3    >    14                                        I.960821
014210                        GO  TO  MOV-002.                          I.960821
014220*
014230     MOVE  14           TO   W-C4.                                I.960821
014240 MOV-003.                                                         I.960821
014250     IF    W-C4          =    ZERO                                I.960821
014260                         MOVE  NC"ＤＡＴＡ　エラー"  TO  ERR-MSGN I.960821
014270                         DISPLAY  DISP-MSG-01  DISP-BUZ-B         I.960821
014280                         DISPLAY  DISP-MSG-SPACE                  I.960821
014290                         GO  TO  MOV-006.                         I.960821
014300     MOVE  W-NNM(W-C1)  TO   W-UNM(W-C4).                         I.960821
014310     SUBTRACT    1    FROM   W-C1  W-C4.                          I.960821
014320     IF    W-C1     NOT  =    W-C2                                I.960821
014330                         GO  TO  MOV-003.                         I.960821
014340 MOV-006.                                                         I.960821
014350     IF    W-ONA         =    SPACE                               I.960821
014360                         GO  TO  MOV-008.                         I.960821
014370     IF    W-UNA         =    SPACE                               I.960821
014380                         GO  TO  MOV-008.                         I.960821
014390     IF    W-UNM(14) NOT =    SPACE                               I.960821
014400                         GO  TO  MOV-008.                         I.960821
014410     MOVE   15      TO  W-C1.                                     I.960821
014420     MOVE   14      TO  W-C2.                                     I.960821
014430 MOV-007.                                                         I.960821
014440     SUBTRACT    1    FROM   W-C1  W-C2.                          I.960821
014450     IF    W-C2     NOT  =    ZERO                                I.960821
014460                         MOVE  W-UNM(W-C2)   TO  W-UNM(W-C1)      I.960821
014470                         GO  TO  MOV-007.                         I.960821
014480     MOVE  SPACE         TO  W-UNM(W-C1).                         I.960821
014490     IF    W-UNM(14)     =    SPACE                               I.960821
014500                         GO  TO  MOV-006.                         I.960821
014510 MOV-008.                                                         I.960821
014520*****MOVE  W-SHM-021 TO  R1-01.                                   D.960821
014530     MOVE   W-ONA   TO  R1-01.                                    I.960821
014540     MOVE   K-2     TO  R1-K2.
014550     MOVE   SPACE   TO  W-P.                                      I.961015
014560*****MOVE   R1-R    TO  MEI1-R(JNIF1-02).                         D.961015
014570*****IF  JS-SIGN3    =  0                                         D.981029
014580*****                MOVE   R1-R    TO  W-P1                      D.981029
014590*****           ELSE                                              D.981029
014600     MOVE   R1-R    TO  W-P.                                      I.961015
014610     MOVE   W-P     TO  MEI1-R(JNIF1-02).                         I.961015
014620     MOVE   K-1     TO  R2-K1.
014630     MOVE   W-UNA   TO  R2-01.                                    I.960821
014640*****MOVE W-SHM-022 TO  R2-01.                                    D.960821
014650*****MOVE   0       TO  I.                                        D.920826
014660 MOV-010.
014670*****ADD    1       TO  I.                                        D.920826
014680*****IF     I       >   27                                        D.920826
014690*****    GO  TO  MOV-020.                                         D.920826
014700*****MOVE    JNIF1-091(I)    TO   R2-021(I).                      D.920826
014710*****ADD     JNIF1-091(I)    TO   W-T.                            D.920826
014720*****GO  TO  MOV-010.                                             D.920826
014730     COMPUTE W-T  = JNIF1-091(01) + JNIF1-091(02) + JNIF1-091(03) I.920826
014740                  + JNIF1-091(04) + JNIF1-091(05) + JNIF1-091(06) I.920826
014750                  + JNIF1-091(07) + JNIF1-091(08) + JNIF1-091(09) I.920826
014760                  + JNIF1-091(10) + JNIF1-091(11) + JNIF1-091(12) I.920826
014770                  + JNIF1-091(13) + JNIF1-091(14) + JNIF1-091(15) I.920826
014780                  + JNIF1-091(16) + JNIF1-091(17) + JNIF1-091(18) I.920826
014790                  + JNIF1-091(19) + JNIF1-091(20) + JNIF1-091(21) I.920826
014800                  + JNIF1-091(22) + JNIF1-091(23) + JNIF1-091(24) I.920826
014810                  + JNIF1-091(25) + JNIF1-091(26) + JNIF1-091(27).I.920826
014820*****IF  0        =    SHM-0411(01)  AND  SHM-0411(02)            D.010808
014830*****             AND  SHM-0411(03)  AND  SHM-0411(04)            D.010808
014840*****             AND  SHM-0411(05)  AND  SHM-0411(06)            D.010808
014850*****             AND  SHM-0411(07)                               D.010808
014860*****IF  0        =    HI-S1(01)  AND  HI-S1(02)                  D.060822
014870*****             AND  HI-S1(03)  AND  HI-S1(04)                  D.060822
014880*****             AND  HI-S1(05)  AND  HI-S1(06)                  D.060822
014890*****             AND  HI-S1(07)                                  D.060822
014900     IF  (HI-S1(01) NOT = 0)  OR (HI-S1(02) NOT = 0) OR           I.060822
014910         (HI-S1(03) NOT = 0)  OR (HI-S1(04) NOT = 0) OR           I.060822
014920         (HI-S1(05) NOT = 0)  OR (HI-S1(06) NOT = 0) OR           I.060822
014930         (HI-S1(07) NOT = 0)                                      I.060822
014940         GO  TO  MOV-015.                                         I.060822
014950     IF   HI-HKB        = 0                                       I.060822
014960                MOVE    JNIF1-091(02)    TO   R2-021(01)          I.920826
014970                MOVE    JNIF1-091(04)    TO   R2-021(02)          I.920826
014980                MOVE    JNIF1-091(05)    TO   R2-021(03)          I.920826
014990                MOVE    JNIF1-091(06)    TO   R2-021(04)          I.920826
015000                MOVE    JNIF1-091(07)    TO   R2-021(05)          I.920826
015010                MOVE    JNIF1-091(08)    TO   R2-021(06)          I.920826
015020                MOVE    JNIF1-091(09)    TO   R2-021(07)          I.920826
015030                MOVE    JNIF1-091(10)    TO   R2-021(08)          I.920826
015040                MOVE    JNIF1-091(11)    TO   R2-021(09)          I.920826
015050                MOVE    JNIF1-091(12)    TO   R2-021(10)          I.920826
015060                MOVE    JNIF1-091(13)    TO   R2-021(11)          I.920826
015070                MOVE    JNIF1-091(14)    TO   R2-021(12)          I.920826
015080                MOVE    JNIF1-091(15)    TO   R2-021(13)          I.920826
015090                MOVE    JNIF1-091(16)    TO   R2-021(14)          I.920826
015100                MOVE    JNIF1-091(17)    TO   R2-021(15)          I.920826
015110                MOVE    JNIF1-091(18)    TO   R2-021(16)          I.920826
015120                MOVE    JNIF1-091(19)    TO   R2-021(17)          I.920826
015130                MOVE    JNIF1-091(20)    TO   R2-021(18)          I.920826
015140                MOVE    JNIF1-091(21)    TO   R2-021(19)          I.920826
015150                MOVE    JNIF1-091(22)    TO   R2-021(20)          I.920826
015160                MOVE    JNIF1-091(23)    TO   R2-021(21)          I.920826
015170                MOVE    JNIF1-091(24)    TO   R2-021(22)          I.920826
015180                MOVE    JNIF1-091(25)    TO   R2-021(23)          I.920826
015190                MOVE    JNIF1-091(26)    TO   R2-021(24)          I.920826
015200                MOVE    JNIF1-091(27)    TO   R2-021(25)          I.920826
015210                GO  TO  MOV-020.                                  I.060822
015220     MOVE    JNIF1-091(02)    TO   R2-B021(01).                   I.060822
015230     IF    JNIF1-091(03)  NOT  =  ZERO                            I.160317
015240             MOVE    JNIF1-091(03)    TO   R2-B021(01).           I.160317
015250     MOVE    JNIF1-091(04)    TO   R2-B021(02).                   I.060822
015260     MOVE    JNIF1-091(05)    TO   R2-B021(03).                   I.060822
015270     MOVE    JNIF1-091(06)    TO   R2-B021(04).                   I.060822
015280     MOVE    JNIF1-091(07)    TO   R2-B021(05).                   I.060822
015290     MOVE    JNIF1-091(08)    TO   R2-B021(06).                   I.060822
015300     MOVE    JNIF1-091(09)    TO   R2-B021(07).                   I.060822
015310     MOVE    JNIF1-091(10)    TO   R2-B021(08).                   I.060822
015320     MOVE    JNIF1-091(11)    TO   R2-B021(09).                   I.060822
015330     MOVE    JNIF1-091(12)    TO   R2-B021(10).                   I.060822
015340     MOVE    JNIF1-091(13)    TO   R2-B021(11).                   I.060822
015350     MOVE    JNIF1-091(14)    TO   R2-B021(12).                   I.060822
015360     MOVE    JNIF1-091(15)    TO   R2-B021(13).                   I.060822
015370     MOVE    JNIF1-091(16)    TO   R2-B021(14).                   I.060822
015380     MOVE    JNIF1-091(17)    TO   R2-B021(15).                   I.060822
015390     MOVE    JNIF1-091(18)    TO   R2-B021(16).                   I.062822
015400     MOVE    JNIF1-091(19)    TO   R2-B021(17).                   I.060822
015410     MOVE    JNIF1-091(20)    TO   R2-B021(18).                   I.060822
015420     MOVE    JNIF1-091(21)    TO   R2-B021(19).                   I.060822
015430     MOVE    JNIF1-091(22)    TO   R2-B021(20).                   I.060822
015440     MOVE    JNIF1-091(23)    TO   R2-B021(21).                   I.060822
015450     MOVE    JNIF1-091(24)    TO   R2-B021(22).                   I.060822
015460     MOVE    JNIF1-091(25)    TO   R2-B021(23).                   I.060822
015470     MOVE    JNIF1-091(26)    TO   R2-B021(24).                   I.060822
015480     MOVE    JNIF1-091(27)    TO   R2-B021(25).                   I.060822
015490*****IF  JNIF1-091(02)   NOT =  ZERO                              D.160317
015500     IF (JNIF1-091(02)   NOT =  ZERO)  OR                         I.160317
015510       ((JNIF1-091(03)   NOT =  ZERO)  AND                        I.160317
015520         (HI-HKB   NOT  = 0))                                     I.160317
015530         MOVE    "*"              TO   R2-B020(01).               I.060822
015540     IF  JNIF1-091(04)   NOT =  ZERO                              I.060822
015550         MOVE    "*"              TO   R2-B020(02).               I.060822
015560     IF  JNIF1-091(05)   NOT =  ZERO                              I.060822
015570         MOVE    "*"              TO   R2-B020(03).               I.060822
015580     IF  JNIF1-091(06)   NOT =  ZERO                              I.060822
015590         MOVE    "*"              TO   R2-B020(04).               I.060822
015600     IF  JNIF1-091(07)   NOT =  ZERO                              I.060822
015610         MOVE    "*"              TO   R2-B020(05).               I.060822
015620     IF  JNIF1-091(08)   NOT =  ZERO                              I.060822
015630         MOVE    "*"              TO   R2-B020(06).               I.060822
015640     IF  JNIF1-091(09)   NOT =  ZERO                              I.060822
015650         MOVE    "*"              TO   R2-B020(07).               I.060822
015660     IF  JNIF1-091(10)   NOT =  ZERO                              I.060822
015670         MOVE    "*"              TO   R2-B020(08).               I.060822
015680     IF  JNIF1-091(11)   NOT =  ZERO                              I.060822
015690         MOVE    "*"              TO   R2-B020(09).               I.060822
015700     IF  JNIF1-091(12)   NOT =  ZERO                              I.060822
015710         MOVE    "*"              TO   R2-B020(10).               I.060822
015720     IF  JNIF1-091(13)   NOT =  ZERO                              I.060822
015730         MOVE    "*"              TO   R2-B020(11).               I.060822
015740     IF  JNIF1-091(14)   NOT =  ZERO                              I.060822
015750         MOVE    "*"              TO   R2-B020(12).               I.060822
015760     IF  JNIF1-091(15)   NOT =  ZERO                              I.060822
015770         MOVE    "*"              TO   R2-B020(13).               I.060822
015780     IF  JNIF1-091(16)   NOT =  ZERO                              I.060822
015790         MOVE    "*"              TO   R2-B020(14).               I.060822
015800     IF  JNIF1-091(17)   NOT =  ZERO                              I.060822
015810         MOVE    "*"              TO   R2-B020(15).               I.060822
015820     IF  JNIF1-091(18)   NOT =  ZERO                              I.060822
015830         MOVE    "*"              TO   R2-B020(16).               I.062822
015840     IF  JNIF1-091(19)   NOT =  ZERO                              I.060822
015850         MOVE    "*"              TO   R2-B020(17).               I.060822
015860     IF  JNIF1-091(20)   NOT =  ZERO                              I.060822
015870         MOVE    "*"              TO   R2-B020(18).               I.060822
015880     IF  JNIF1-091(21)   NOT =  ZERO                              I.060822
015890         MOVE    "*"              TO   R2-B020(19).               I.060822
015900     IF  JNIF1-091(22)   NOT =  ZERO                              I.060822
015910         MOVE    "*"              TO   R2-B020(20).               I.060822
015920     IF  JNIF1-091(23)   NOT =  ZERO                              I.060822
015930         MOVE    "*"              TO   R2-B020(21).               I.060822
015940     IF  JNIF1-091(24)   NOT =  ZERO                              I.060822
015950         MOVE    "*"              TO   R2-B020(22).               I.060822
015960     IF  JNIF1-091(25)   NOT =  ZERO                              I.060822
015970         MOVE    "*"              TO   R2-B020(23).               I.060822
015980     IF  JNIF1-091(26)   NOT =  ZERO                              I.060822
015990         MOVE    "*"              TO   R2-B020(24).               I.060822
016000     IF  JNIF1-091(27)   NOT =  ZERO                              I.060822
016010         MOVE    "*"              TO   R2-B020(25).               I.060822
016020     GO  TO  MOV-020.                                             I.060822
016030*****  ELSE     MOVE    JNIF1-091(01)    TO   R2-021(01)          D.060822
016040*****           MOVE    JNIF1-091(02)    TO   R2-021(02)          D.060822
016050*****           MOVE    JNIF1-091(03)    TO   R2-021(03)          D.060822
016060*****           MOVE    JNIF1-091(04)    TO   R2-021(04)          D.060822
016070*****           MOVE    JNIF1-091(05)    TO   R2-021(05)          D.060822
016080*****           MOVE    JNIF1-091(06)    TO   R2-021(06)          D.060822
016090*****           MOVE    JNIF1-091(07)    TO   R2-021(07).         D.941205
016100*****           MOVE    JNIF1-091(07)    TO   R2-021(07)          D.060822
016110*****           MOVE    JNIF1-091(25)    TO   R2-021(23)          D.060822
016120*****           MOVE    JNIF1-091(26)    TO   R2-021(24)          D.060822
016130 MOV-015.                                                         I.060822
016140     MOVE    JNIF1-091(01)    TO   R2-021(01).                    I.060822
016150     MOVE    JNIF1-091(02)    TO   R2-021(02).                    I.060822
016160     MOVE    JNIF1-091(03)    TO   R2-021(03).                    I.060822
016170     MOVE    JNIF1-091(04)    TO   R2-021(04).                    I.060822
016180     MOVE    JNIF1-091(05)    TO   R2-021(05).                    I.060822
016190     MOVE    JNIF1-091(06)    TO   R2-021(06).                    I.060822
016200     MOVE    JNIF1-091(07)    TO   R2-021(07).                    I.060822
016210     MOVE    JNIF1-091(25)    TO   R2-021(23).                    I.060822
016220     MOVE    JNIF1-091(26)    TO   R2-021(24).                    I.060822
016230     MOVE    JNIF1-091(27)    TO   R2-021(25).                    I.941205
016240 MOV-020.
016250     MOVE    W-T     TO    R2-03.
016260     MOVE    SPACE   TO    W-P.                                   I.961015
016270*****MOVE    R2-R    TO    MEI2-R(JNIF1-02).                      D.961015
016280*****IF  JS-SIGN3    =  0                                         D.981029
016290*****                MOVE    R2-R    TO    W-P1                   D.981029
016300*****           ELSE                                              D.981029
016310     MOVE    R2-R    TO    W-P.                                   I.961015
016320     MOVE    W-P     TO    MEI2-R(JNIF1-02).                      I.961015
016330     ADD     W-T     TO  W-KEI.                                   I.091214
016340     MOVE    0       TO  W-T.
016350     IF  W-SEN    =    1
016360         PERFORM      RW1-RTN        THRU        RW1-EX.
016370 MOV-EX.
016380     EXIT.
016390***************************************************
016400*    ＲＷ１ーＲＴＮ                               *
016410***************************************************
016420 RW1-RTN.
016430     MOVE   "1"     TO  JNIF1-10.
016440     REWRITE        JNIF1-R       INVALID
016450         MOVE       "JNIF"  TO    ERR-F
016460         MOVE       "R"     TO    ERR-M
016470         MOVE    JNIF1-KEY  TO    ERR-K
016480         PERFORM   ERR-RTN   THRU   ERR-EX.
016490 RW1-EX.
016500***************************************************
016510*    ＲＷ２ーＲＴＮ                               *
016520***************************************************
016530 RW2-RTN.
016540     MOVE   "1"     TO  JNIF2-04.
016550     REWRITE        JNIF2-R       INVALID
016560         MOVE       "JNIF"  TO    ERR-F
016570         MOVE       "R"     TO    ERR-M
016580         MOVE    JNIF2-KEY  TO    ERR-K
016590         PERFORM   ERR-RTN   THRU   ERR-EX.
016600 RW2-EX.
016610     EXIT.
016620***************************************************
016630*    ﾋﾂﾞｹ ｾｯﾄ                ROUTIN               *
016640***************************************************
016650 SEL-RTN.                                                         I.981022
016660*****CLOSE  JNIF.                                                 D.030722
016670     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981022
016680     OPEN  INPUT  JNIF.                                           I.981022
016690 SEL-010.                                                         I.981022
016700     READ  JNIF  NEXT  RECORD  AT  END                            I.981022
016710         GO  TO  SEL-090.                                         I.981022
016720     IF  JNIF1-10 = 1                                             I.981022
016730         GO  TO  SEL-010.                                         I.981022
016740     IF  JNIF1-02    =    7                     GO  TO  SEL-010.  I.981028
016750     IF  JS-SIGN  =  0                                            I.981028
016760         IF   JNIF1-07    NOT =  1              GO  TO  SEL-010.  I.060308
016770*****    IF   JNIF1-07    =  2 OR 3 OR 5 OR 6 OR 7                D.051216
016780*****    IF   JNIF1-07    =  2 OR 3 OR 4 OR 5 OR 6 OR 7           D.060308
016790*****                                           GO  TO  SEL-010.  D.060308
016800     IF  JS-SIGN  =  1                                            I.981028
016810         IF   JNIF1-07    NOT =  6              GO  TO  SEL-010.  I.060308
016820*****    IF   JNIF1-07    NOT =  2 AND 3        GO  TO  SEL-010.  D.060308
016830     IF  JS-SIGN  =  2                                            I.981028
016840         IF   JNIF1-07    NOT =  7              GO  TO  SEL-010.  I.060308
016850*****    IF   JNIF1-07    NOT =  5 AND 6        GO  TO  SEL-010.  D.060308
016860     IF  JS-SIGN  =  3                                            I.981028
016870         IF   JNIF1-07    NOT =  4              GO  TO  SEL-010.  I.060308
016880*****    IF   JNIF1-07    NOT =  2 AND 3 AND 5 AND 6              D.060308
016890*****                                           GO  TO  SEL-010.  D.060308
016900     IF  W-JS      NOT =  9                                       I.030707
016910         IF   JNIF1-13A   NOT =  W-JS           GO  TO  SEL-010.  I.030707
016920*****IF  JS-SIGN  =  4                                            D.030707
016930*****    IF   JNIF1-07    NOT =  7              GO  TO  SEL-010.  D.030707
016940*****IF  W-JS     =  0                                            D.030707
016950*****    IF   JNIF1-13A   NOT =  0              GO  TO  SEL-010.  D.030707
016960*****IF  W-JS     =  1                                            D.030707
016970*****    IF   JNIF1-13A   NOT =  1              GO  TO  SEL-010.  D.030707
016980*****IF  W-JS     =  9                                            D.030707
016990*****    IF   JNIF1-13A   NOT =  0 AND 1        GO  TO  SEL-010.  D.030707
017000*****IF  JS-SIGN4 =  0                                            D.011109
017010*****    IF   JNIF1-051       =  0459  OR  0460  OR  3966         D.011109
017020*****                                           GO  TO  SEL-010.  D.011109
017030*****IF  JS-SIGN4 =  1                                            D.011109
017040*****    IF   JNIF1-051   NOT =  0459 AND  0460 AND  3966         D.011109
017050*****                                           GO  TO  SEL-010.  D.011109
017060     MOVE  ZERO     TO  W-NGP.                                    I.981022
017070     MOVE  JNIF1-04  TO  W-NGPS.                                  I.981022
017080     MOVE  20       TO  W-NEN1.                                   I.090919
017090*****IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     D.090919
017100*****    ADD  DATE-NC1  TO  W-NEN.                                D.090919
017110*****IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     D.090919
017120*****    ADD  DATE-NC2  TO  W-NEN.                                D.090919
017130*****IF  W-NEN2 > 90                                              D.981027
017140*****    ADD  1900  TO  W-NEN                                     D.981027
017150*****  ELSE                                                       D.981027
017160*****    ADD  2000  TO  W-NEN.                                    D.981027
017170     IF  W-SDATE = ZERO                                           I.981022
017180         MOVE  W-NGP  TO  W-SDATE.                                I.981022
017190     IF  W-SDATE > W-NGP                                          I.981022
017200         MOVE  W-NGP  TO  W-SDATE.                                I.981022
017210     IF  W-EDATE < W-NGP                                          I.981022
017220         MOVE  W-NGP  TO  W-EDATE.                                I.981022
017230     GO  TO  SEL-010.                                             I.981022
017240 SEL-090.                                                         I.981022
017250     CLOSE  JNIF.                                                 I.981022
017260     MOVE  W-SDATE  TO  W-SNGP.                                   I.981022
017270     MOVE  W-EDATE  TO  W-ENGP.                                   I.981022
017280*****OPEN  I-O  JNIF.                                             D.030722
017290 SEL-EX.                                                          I.981022
017300     EXIT.                                                        I.981022
017310 COPY    LPMSG.
