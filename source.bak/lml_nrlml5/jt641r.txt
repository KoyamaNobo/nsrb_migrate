000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT640R.
000030 AUTHOR.                        MAYUMI.I.
000040***************************************************
000050*    PROGRAM        : ìæà”êÊï èoâ◊é¿ê—ñ‚çáÇπÅ@Å@Å@* Å@Å@Å@
000060*    DATA WRITTEN   : 91/10/31                    *
000070*    SCREEN USED    : SJ640R                      *
000080*    FORM   USED    : UNUSED                      *
000090*    PRINTER TYPE   : UNUSED                      *
000100*    COMPILE TYPE   : COBOL85 (74MODE)            *
000110*    JS-SIGN        : 0=ìæà”êÊ , 1=ìæà”êÊíºëóêÊ   *
000120***************************************************
000130 ENVIRONMENT                    DIVISION.
000140 CONFIGURATION                  SECTION.
000150 SOURCE-COMPUTER.               SYSTEM3100.
000160 OBJECT-COMPUTER.               SYSTEM3100.
000170 INPUT-OUTPUT                   SECTION.
000180 FILE-CONTROL.
000190     COPY  LIBCSE.                                                I.980526
000200***  èoâ◊ó›êœÉtÉ@ÉCÉã           ( 102/5 )
000210*****SELECT   JSRU      ASSIGN  F11-MSD  F12-MSD                  D.971205
000220*****                   ORGANIZATION  INDEXED                     D.971205
000230*****                   ACCESS MODE   DYNAMIC                     D.971205
000240*****                   RECORD KEY    JSRU-KEY1                   D.971205
000250*****        ALTERNATE  RECORD KEY    JSRU-KEY2.                  D.971205
000260***  ì¸èoå…ó›êœÉtÉ@ÉCÉã         ( 170/3 )
000270     SELECT   JNSR      ASSIGN  F11-MSD  F12-MSD  F13-MSD         I.971205
000280                        ORGANIZATION  INDEXED                     I.971205
000290                        ACCESS MODE   DYNAMIC                     I.971205
000300                        RECORD KEY    JNSR-KEY1                   I.971205
000310             ALTERNATE  RECORD KEY    JNSR-KEY2                   I.971205
000320             ALTERNATE  RECORD KEY    JNSR-KEY3.                  I.971205
000330***  íºëóêÊÉ}ÉXÉ^               ( 192/4 )
000340     SELECT   TC-M      ASSIGN  F2-MSD
000350                        ORGANIZATION  INDEXED
000360                        ACCESS MODE   RANDOM
000370                        RECORD KEY    TC-KEY.
000380***  ïiñºÉ}ÉXÉ^
000390*****SELECT   SHM       ASSIGN  F3-MSD                            D.010818
000400     SELECT   HI2-M     ASSIGN  F3-MSD                            I.010818
000410                        ORGANIZATION  INDEXED
000420                        ACCESS MODE   RANDOM
000430                        RECORD KEY    HI-KEY2.                    I.010818
000440*****                   RECORD KEY    SHM-KEY.                    D.010818
000450***  ì¸èoå…ó›êœÉèÅ[ÉNÅ@         ( 170/3 )
000460     SELECT   JT-W170   ASSIGN  F41-MSD  F42-MSD                  I.971205
000470                        ORGANIZATION  INDEXED                     I.971205
000480                        ACCESS MODE   DYNAMIC                     I.971205
000490                        RECORD KEY    JTW-KEY1                    I.971205
000500             ALTERNATE  RECORD KEY    JTW-KEY3.                   I.971205
000510***  èoâ◊ó›êœÉèÅ[ÉN             ( 102/5 )
000520*****SELECT   JT-WKN1   ASSIGN  F4-MSD                            D.971205
000530*****                   ORGANIZATION  INDEXED                     D.971205
000540*****                   ACCESS MODE   DYNAMIC                     D.971205
000550*****                   RECORD KEY    WN01-KEY.                   D.971205
000560***  ÉRÉìÉgÉçÅ[ÉãÇe             (  32/8 )
000570     SELECT   JCON      ASSIGN  F5-MSD                            I.950217
000580                        ORGANIZATION  INDEXED                     I.950217
000590                        ACCESS MODE   DYNAMIC                     I.950217
000600                        RECORD KEY    JCON2-KEY.                  I.950217
000610     SELECT   JMSTD     ASSIGN  F61-MSD  F62-MSD  F63-MSD         I.130909
000620                        ORGANIZATION  INDEXED                     I.130909
000630                        ACCESS MODE   DYNAMIC                     I.130909
000640                        RECORD KEY    JMSTD-KEY1                  I.130909
000650             ALTERNATE  RECORD KEY    JMSTD-KEY2                  I.130909
000660             ALTERNATE  RECORD KEY    JMSTD-KEY3.                 I.130909
000670 I-O-CONTROL.
000680     APPLY   SHARED-MODE ON  M-DATE JNSR HI2-M TC-M  JT-W170 JCON I.130909
000690                             JMSTD.                               I.130909
000700*****APPLY   SHARED-MODE ON  M-DATE JNSR HI2-M TC-M  JT-W170 JCON.D.130909
000710*****APPLY   SHARED-MODE ON  M-DATE JNSR  SHM  TC-M  JT-W170 JCON.D.010818
000720*****APPLY   SHARED-MODE ON  JNSR  SHM  TC-M  JT-W170 JCON.       D.980526
000730*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M.                     D.940905
000740*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M  JT-WKN1.            D.950217
000750*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M  JT-WKN1 JCON.       D.971205
000760*
000770 DATA                       DIVISION.
000780 FILE                       SECTION.
000790     COPY  LIBFDD.                                                I.980526
000800 COPY  L-JNSR.                                                    I.971205
000810 COPY  LIHIM2.                                                    I.010818
000820*COPY  L-JSRU.                                                    D.971205
000830*COPY  L-SHM.                                                     D.010818
000840 COPY  LITCM.
000850*COPY  LTWKN1.                                                    D.971205
000860 COPY  LJT170.                                                    I.971205
000870 COPY  L-JCON.                                                    I.950217
000880 COPY  LJMSTD.                                                    I.130909
000890*
000900 WORKING-STORAGE            SECTION.
000910 77  JS-SIGN                   PIC 9(01).                         I.081120
000920 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000930*77  JT-IWS102ID               PIC X(12).                         D.971205
000940 77  JT-W170K1ID               PIC X(12).                         I.971205
000950 77  JT-W170K3ID               PIC X(12).                         I.971205
000960 77  W-DC                      PIC 9(01).                         I.940905
000970 01  STN-NO.                                                      I.940905
000980     02  STN-NO-01             PIC X(03).                         I.940905
000990     02  STN-NO-02             PIC X(03).                         I.940905
001000 01  WF1-ID.                                                      I.971205
001010     02  WORK1-ID-01           PIC X(09) VALUE "JT-W170K1".       I.971205
001020     02  WORK1-ID-02           PIC X(03).                         I.971205
001030 01  WF2-ID.                                                      I.971205
001040     02  WORK2-ID-01           PIC X(09) VALUE "JT-W170K3".       I.971205
001050     02  WORK2-ID-02           PIC X(03).                         I.971205
001060*01  WF-ID.                                                       D.971205
001070*****02  WORK-ID-01            PIC X(09) VALUE "JT-IWS102".       D.971205
001080*****02  WORK-ID-02            PIC X(03).                         D.971205
001090 01  W-AREA.
001100     02  SW                    PIC X(03).
001110*    SW  =  " ON" ---> É}ÉXÉ^ÇÇqÇdÇ`ÇcÇµÇƒÅCÇhÇmÇuÇ`ÇkÇhÇcÇÃéûÅB
001120*    SW  =  "OFF" ---> É}ÉXÉ^ÇÇqÇdÇ`ÇcÇµÇƒÅCÇmÇnÇqÇlÇ`ÇkÇÃéûÅB
001130     02  LIN                   PIC 9(02).                         LINE
001140     02  LIN1                  PIC 9(02).
001150***  DISPLAY  GAMEN-CLR Ç∑ÇÈéûÅCàÍí[ LIN ÇÇrÇ`ÇuÇdÇµÇƒÇ®Ç≠ÅB
001160     02  COL                   PIC 9(02).                         COLUMN
001170     02 G                      PIC 9(02).                         çs 1Å`18
001180     02 GG                     PIC 9(02).                         çs 1Å`18
001190     02 I                      PIC 9(02).                         1Å`10
001200     02  W-DATE                PIC 9(08).                         I.980526
001210*****02  W-DATE                PIC 9(06).                         D.980526
001220     02  W-AREA1.
001230         03  W-TOK             PIC 9(04).
001240         03  W-CCD             PIC 9(03).                         I.081120
001250         03  W-AREA2.
001260             04  W-FROM            PIC 9(08).                     I.980526
001270             04  W-FROMD  REDEFINES  W-FROM.                      I.980526
001280                 05  W-FNEN        PIC 9(04).                     I.980526
001290                 05  W-FNENL  REDEFINES  W-FNEN.                  I.980526
001300                     06  W-FNEN1   PIC 9(02).                     I.980526
001310                     06  W-FNEN2   PIC 9(02).                     I.980526
001320                 05  W-FGET        PIC 9(02).                     I.980526
001330                 05  W-FPEY        PIC 9(02).                     I.980526
001340             04  W-FROML  REDEFINES  W-FROM.                      I.980526
001350                 05  F             PIC 9(02).                     I.980526
001360                 05  W-FROMS       PIC 9(06).                     I.980526
001370             04  W-TO              PIC 9(08).                     I.980526
001380             04  W-TOD    REDEFINES  W-TO.                        I.980526
001390                 05  W-TNEN        PIC 9(04).                     I.980526
001400                 05  W-TNENL  REDEFINES  W-TNEN.                  I.980526
001410                     06  W-TNEN1   PIC 9(02).                     I.980526
001420                     06  W-TNEN2   PIC 9(02).                     I.980526
001430                 05  W-TGET        PIC 9(02).                     I.980526
001440                 05  W-TPEY        PIC 9(02).                     I.980526
001450             04  W-TOL    REDEFINES  W-TO.                        I.980526
001460                 05  F             PIC 9(02).                     I.980526
001470                 05  W-TOS         PIC 9(06).                     I.980526
001480*****        04  W-FROM            PIC 9(06).                     D.980526
001490*****        04  W-TO              PIC 9(06).                     D.980526
001500             04  W-DEN             PIC N(02).
001510             04  W-HIZ.                                           I.940906
001520                 05  F             PIC 9(02).                     I.980526
001530                 05  W-HIZ1        PIC 9(02).                     I.940906
001540                 05  W-HIZ2        PIC 9(02).                     I.940906
001550                 05  W-HIZ3        PIC 9(02).                     I.940906
001560             04  W-SOK             PIC S9(06).                    I.940906
001570*****        04  W-KBN             PIC X(01).                     D.061020
001580             04  W-KBN             PIC 9(01).                     I.061020
001590             04  W-SAS             PIC 9(06).                     I.940906
001600             04  W-GP              PIC 9(04).                     I.130909
001610             04  W-GPD   REDEFINES W-GP.                          I.130909
001620                 05  W-GET         PIC 9(02).                     I.130909
001630                 05  W-PEY         PIC 9(02).                     I.130909
001640             04  W-SHOSAI.
001650                 05  W-GYO             PIC 9(02).
001660*****            05  W-SHOSAI1  OCCURS 18.                        D.061020
001670                 05  W-SHOSAI1  OCCURS 17.                        I.061020
001680                     06  W-SIZE1       PIC 9(01).                 ÉTÉCÉYãÊ
001690*****                06  W-CHO         PIC 9(07).                 D.061020
001700                     06  W-CHO.                                   I.061020
001710                         07  W-CHOT    PIC 9(04).                 I.061020
001720                         07  W-CHOC    PIC 9(03).                 I.061020
001730                     06  W-SIZE2       PIC S9(05)   OCCURS 10.    ªï èoâ◊
001740                     06  W-GNO         PIC 9(07).                 I.941117
001750                     06  W-GNOD   REDEFINES  W-GNO.               I.941117
001760                         07  W-GNO1    PIC 9(06).                 I.941117
001770                         07  W-GNO2    PIC 9(01).                 I.941117
001780                     06  W-TEK1        PIC N(09).                 I.061020
001790                     06  W-TEK2        PIC N(21).                 I.061020
001800                     06  W-OKNO        PIC 9(06).                 I.061020
001810                     06  W-UNSO        PIC 9(01).                 I.950217
001820                     06  W-KURA        PIC 9(01).                 I.061020
001830                 05  OKC               PIC 9(01).
001840*
001850 COPY    LWMSG.
001860*
001870 SCREEN                  SECTION.
001880 SD  CRT-X
001890     END STATUS  IS  ESTAT.
001900 01  CLR-1           LINE  1.
001910     02  CLEAR   SCREEN.
001920 01  CLR-AREA.
001930     02  LINE 1  COLUMN 15          PIC X(46)   VALUE " ".
001940     02  CLR-01.                                                  CLR-01
001950         03  LINE 1  COLUMN  68     PIC X(06)   VALUE " ".
001960         03  LINE 1  COLUMN  75     PIC X(06)   VALUE " ".
001970         03  CLR-02.                                              CLR-02
001980             04  LINE LIN COLUMN 4  PIC X(05)   VALUE " ".
001990             04  LINE LIN COLUMN 10 PIC X(02)   VALUE " ".        I.061020
002000             04  LINE LIN COLUMN 13 PIC X(53)   VALUE " ".        I.061020
002010             04  LINE LIN COLUMN 67 PIC X(07)   VALUE " ".        I.061020
002020             04  LINE LIN COLUMN 75 PIC X(06)   VALUE " ".        I.061020
002030*****        04  LINE LIN COLUMN 10 PIC X(04)   VALUE " ".        D.061020
002040*****        04  LINE LIN COLUMN 15 PIC X(48)   VALUE " ".        D.061020
002050*****        04  LINE LIN COLUMN 64 PIC X(08)   VALUE " ".        D.061020
002060*****        04  LINE LIN COLUMN 73 PIC X(01)   VALUE " ".        D.061020
002070*****        04  LINE LIN COLUMN 74 PIC X(06)   VALUE " ".        D.061020
002080*****        04  CLR-03  LINE 21.                                 D.061020
002090             04  CLR-03  LINE 20.                                 I.061020
002100                 05  COLUMN 13      PIC X(04)   VALUE " ".
002110                 05  COLUMN 20      PIC X(04)   VALUE " ".
002120                 05  COLUMN 27      PIC X(04)   VALUE " ".
002130                 05  COLUMN 34      PIC X(04)   VALUE " ".
002140                 05  COLUMN 41      PIC X(04)   VALUE " ".
002150                 05  COLUMN 48      PIC X(04)   VALUE " ".
002160                 05  COLUMN 55      PIC X(04)   VALUE " ".
002170                 05  COLUMN 62      PIC X(04)   VALUE " ".
002180                 05  COLUMN 69      PIC X(04)   VALUE " ".
002190                 05  COLUMN 76      PIC X(04)   VALUE " ".
002200             04  CLEAR  DATA     LINE 21.                         I.061020
002210             04  LINE 22  COLUMN   6     PIC X(52)   VALUE " ".   I.061020
002220             04  LINE 22  COLUMN  62     PIC X(06)   VALUE " ".   I.061020
002230             04  LINE 22  COLUMN  69     PIC X(01)   VALUE " ".   I.061020
002240             04  LINE 22  COLUMN  74     PIC X(06)   VALUE " ".   I.061020
002250             04  LINE 23  COLUMN   6     PIC X(60)   VALUE " ".   I.061020
002260             04  LINE 23  COLUMN  72     PIC X(01)   VALUE " ".   I.061020
002270             04  LINE 23  COLUMN  79     PIC X(01)   VALUE " ".   I.061020
002280*****        04  CLEAR  DATA     LINE 22.                         D.061020
002290*****        04  LINE 23  COLUMN  11     PIC X(48)   VALUE " ".   D.061020
002300*****        04  LINE 23  COLUMN  66     PIC X(04)   VALUE " ".   D.061020
002310*****        04  LINE 23  COLUMN  71     PIC X(06)   VALUE " ".   D.061020
002320*****        04  LINE 23  COLUMN  78     PIC X(01)   VALUE " ".   D.061020
002330*****        04  LINE 24  COLUMN   1     PIC X(12)   VALUE " ".   D.061020
002340             04  LINE 24  COLUMN  70     PIC X(01)   VALUE " ".
002350     02  CLR-SHOSAI.
002360*****    03  CLR-04  LINE 21.                                     D.061020
002370         03  CLR-04  LINE 20.                                     I.061020
002380             04  COLUMN 13          PIC X(04)   VALUE " ".
002390             04  COLUMN 20          PIC X(04)   VALUE " ".
002400             04  COLUMN 27          PIC X(04)   VALUE " ".
002410             04  COLUMN 34          PIC X(04)   VALUE " ".
002420             04  COLUMN 41          PIC X(04)   VALUE " ".
002430             04  COLUMN 48          PIC X(04)   VALUE " ".
002440             04  COLUMN 55          PIC X(04)   VALUE " ".
002450             04  COLUMN 62          PIC X(04)   VALUE " ".
002460             04  COLUMN 69          PIC X(04)   VALUE " ".
002470             04  COLUMN 76          PIC X(04)   VALUE " ".
002480*****    03  CLR-05  LINE 22.                                     D.061020
002490         03  CLR-05  LINE 21.                                     D.061020
002500             04  COLUMN 11          PIC X(06)   VALUE " ".
002510             04  COLUMN 18          PIC X(06)   VALUE " ".
002520             04  COLUMN 25          PIC X(06)   VALUE " ".
002530             04  COLUMN 32          PIC X(06)   VALUE " ".
002540             04  COLUMN 39          PIC X(06)   VALUE " ".
002550             04  COLUMN 46          PIC X(06)   VALUE " ".
002560             04  COLUMN 53          PIC X(06)   VALUE " ".
002570             04  COLUMN 60          PIC X(06)   VALUE " ".
002580             04  COLUMN 67          PIC X(06)   VALUE " ".
002590             04  COLUMN 74          PIC X(06)   VALUE " ".
002600     02  GAMEN-CLR    LINE LIN.                                   GAMEN-
002610         03  COLUMN 4                PIC X(05)   VALUE " ".            CLR
002620         03  COLUMN 10               PIC X(02)   VALUE " ".       I.061020
002630         03  COLUMN 13               PIC X(53)   VALUE " ".       I.061020
002640         03  COLUMN 67               PIC X(07)   VALUE " ".       I.061020
002650         03  COLUMN 75               PIC X(06)   VALUE " ".       I.061020
002660*****    03  COLUMN 10               PIC X(04)   VALUE " ".       D.061020
002670*****    03  COLUMN 15               PIC X(48)   VALUE " ".       D.061020
002680*****    03  COLUMN 64               PIC X(08)   VALUE " ".       D.061020
002690*****    03  COLUMN 73               PIC X(01)   VALUE " ".       D.061020
002700*****    03  COLUMN 74               PIC X(06)   VALUE " ".       D.061020
002710*
002720 01  DSP-AREA.
002730     02  LINE LIN.
002740         03  DSP-HIZ1   COLUMN 04   PIC ZZ                        èoâ◊Å@åé
002750                        FROM  W-HIZ2.                             I.940906
002760*****                   FROM  JSRU-132.                           D.940906
002770         03  DSP-HIZ    COLUMN 06   PIC X(01)                     "/"
002780                        VALUE "/".
002790         03  DSP-HIZ2   COLUMN 07   PIC ZZ                        èoâ◊Å@ì˙
002800                        FROM  W-HIZ3.                             I.940906
002810*****                   FROM  JSRU-133.                           D.940906
002820*****    03  DSP-DEN    COLUMN 10   PIC N(02)                     D.061020
002830         03  DSP-DEN    COLUMN 10   PIC N(01)                     I.061020
002840                        FROM  W-DEN.
002850*****    03  DSP-HCD    COLUMN 13   PIC 9(04)                     D.130909
002860*****                   FROM  HI-HCD1.                            D.130909
002870         03  DSP-HCD    COLUMN 13   PIC 9(06)                     I.130909
002880                        FROM  HI-HCD.                             I.130909
002890         03  DSP-HIN    COLUMN 20   PIC N(16)                     I.130909
002900                        FROM  HI-SMS.                             I.130909
002910         03  DSP-JGP    COLUMN 61   PIC 99/99                     I.130909
002920                        FROM  W-GP.                               I.130909
002930*****    03  DSP-HIN    COLUMN 15   PIC N(24)                     D.061020
002940*****    03  DSP-HIN    COLUMN 18   PIC N(24)                     D.130909
002950*****                   FROM  HI-NAME.                            D.130909
002960*****                   FROM  SHM-02.                             D.010818
002970*****    03  DSP-SOK    COLUMN 64   PIC ----,--9                  D.061020
002980         03  DSP-SOK    COLUMN 67   PIC ---,--9                   I.061020
002990                        FROM  W-SOK.                              I.940906
003000*****                   FROM  JSRU-092.                           D.940906
003010*****    03  DSP-KBN    COLUMN 73   PIC X(01)                     D.061020
003020*****                   FROM  W-KBN.                              D.061020
003030*****    03  DSP-SAS    COLUMN 74   PIC 9(06)                     D.061020
003040         03  DSP-SAS    COLUMN 75   PIC 9(06)                     I.061020
003050                        FROM  W-SAS.                              I.940906
003060*****                   FROM  JSRU-151.                           D.940906
003070*
003080 01  DSP-AREA1.
003090     02  DSP-TOK     LINE 1  COLUMN 20     PIC N(21)
003100                     FROM  TC-NAME.
003110     02  DSP-SHOSAI.
003120         03  DSP-SHOSAI1.
003130*****        04  DSP-CHON    LINE 23 COLUMN 11     PIC N(24)      D.061020
003140             04  DSP-CHOC    LINE 22 COLUMN  6     PIC 9(03)      I.061020
003150                             FROM  W-CHOC(GG).                    I.061020
003160             04  DSP-CHON    LINE 22 COLUMN 10     PIC N(24)      I.061020
003170                             FROM  TC-NAME.
003180*****        04  DSP-SIZE1   LINE 22 COLUMN 7      PIC 9(01)      D.061020
003190             04  DSP-SIZE1   LINE 21 COLUMN 7      PIC 9(01)      I.061020
003200                             FROM  W-SIZE1(GG).
003210             04  DSP-GNO.                                         I.941117
003220*****            05  LINE 23 COLUMN 66     PIC N(02)              D.061020
003230*****                        VALUE NC"éÛáÇ".                      D.061020
003240*****            05  LINE 23 COLUMN 71     PIC 9(06)              D.061020
003250                 05  LINE 22 COLUMN 62     PIC 9(06)              I.061020
003260                             FROM  W-GNO1(GG).                    I.941117
003270*****            05  LINE 23 COLUMN 78     PIC 9(01)              D.061020
003280                 05  LINE 22 COLUMN 69     PIC 9(01)              I.061020
003290                             FROM  W-GNO2(GG).                    I.941117
003300             04  DSP-OKNO    LINE 22 COLUMN 74     PIC 9(06)      I.061020
003310                             FROM  W-OKNO(GG).                    I.061020
003320             04  DSP-TEK1    LINE 23 COLUMN 6      PIC N(09)      I.061020
003330                             FROM  W-TEK1(GG).                    I.061020
003340             04  DSP-TEK2    LINE 23 COLUMN 24     PIC N(21)      I.061020
003350                             FROM  W-TEK2(GG).                    I.061020
003360             04  DSP-UNSO    LINE 23 COLUMN 72     PIC 9(01)      I.061020
003370                             FROM  W-UNSO(GG).                    I.061020
003380             04  DSP-KURA    LINE 23 COLUMN 79     PIC 9(01)      I.061020
003390                             FROM  W-KURA(GG).                    I.061020
003400*****        04  DSP-UNSO    LINE 24 COLUMN 1      PIC N(06)      D.061020
003410*****                        FROM  JCON2-03.                      D.061020
003420         03  DSP-SHOSAI2.
003430*****        04  DSP-SIZE2   LINE 22 COLUMN COL    PIC ------     D.061020
003440             04  DSP-SIZE2   LINE 21 COLUMN COL    PIC --,---     I.061020
003450                             FROM  W-SIZE2(GG I).
003460*****02  DSP-1       LINE 21.                                     D.061020
003470*****    03  COLUMN 13     VALUE "ÇRçÜ".                          D.061020
003480*****    03  COLUMN 20     VALUE "ÇQçÜ".                          D.061020
003490*****    03  COLUMN 27     VALUE "ÇPçÜ".                          D.061020
003500*****    03  COLUMN 34     VALUE "ÇOçÜ".                          D.061020
003510*****    03  COLUMN 41     VALUE " íÜ ".                          D.061020
003520*****    03  COLUMN 48     VALUE " ëÂ ".                          D.061020
003530*****    03  COLUMN 55     VALUE "ì¡ëÂ".                          D.061020
003540     02  DSP-1       LINE 20.                                     I.061020
003550         03  COLUMN 13     VALUE "    ".                          I.061020
003560         03  COLUMN 20     VALUE "    ".                          I.061020
003570         03  COLUMN 27     VALUE "ÇrÇr".                          I.061020
003580         03  COLUMN 34     VALUE "Å@Çr".                          I.061020
003590         03  COLUMN 41     VALUE "Å@Çl".                          I.061020
003600         03  COLUMN 48     VALUE "  Çk".                          I.061020
003610         03  COLUMN 55     VALUE "ÇkÇk".                          I.061020
003620         03  COLUMN 62     VALUE "28.0".
003630         03  COLUMN 69     VALUE "29.0".
003640         03  COLUMN 76     VALUE "30.0".
003650*****02  DSP-2       LINE 21.                                     D.061020
003660     02  DSP-2       LINE 20.                                     I.061020
003670         03  COLUMN 13     VALUE "12.5".
003680         03  COLUMN 20     VALUE "13.0".
003690         03  COLUMN 27     VALUE "13.5".
003700         03  COLUMN 34     VALUE "14.0".
003710         03  COLUMN 41     VALUE "15.0".
003720         03  COLUMN 48     VALUE "16.0".
003730         03  COLUMN 55     VALUE "17.0".
003740         03  COLUMN 62     VALUE "18.0".
003750         03  COLUMN 69     VALUE "19.0".
003760         03  COLUMN 76     VALUE "20.0".
003770*****02  DSP-3       LINE 21.                                     D.061020
003780     02  DSP-3       LINE 20.                                     I.061020
003790         03  COLUMN 13     VALUE "21.0".
003800         03  COLUMN 20     VALUE "21.5".
003810         03  COLUMN 27     VALUE "22.0".
003820         03  COLUMN 34     VALUE "22.5".
003830         03  COLUMN 41     VALUE "23.0".
003840         03  COLUMN 48     VALUE "23.5".
003850         03  COLUMN 55     VALUE "24.0".
003860         03  COLUMN 62     VALUE "24.5".
003870         03  COLUMN 69     VALUE "25.0".
003880         03  COLUMN 76     VALUE "    ".
003890*****02  DSP-4       LINE 21.                                     D.061020
003900     02  DSP-4       LINE 20.                                     I.061020
003910         03  COLUMN 13     VALUE "24.0".
003920         03  COLUMN 20     VALUE "24.5".
003930         03  COLUMN 27     VALUE "25.0".
003940         03  COLUMN 34     VALUE "25.5".
003950         03  COLUMN 41     VALUE "26.0".
003960         03  COLUMN 48     VALUE "26.5".
003970         03  COLUMN 55     VALUE "27.0".
003980         03  COLUMN 62     VALUE "27.5".
003990         03  COLUMN 69     VALUE "    ".
004000         03  COLUMN 76     VALUE "    ".
004010*
004020     02  DSP-CGP    LINE  LIN   COLUMN 61   PIC X(05)             I.130909
004030                           VALUE "     ".                         I.130909
004040*
004050 01  ACP-AREA.
004060     02  ACP-TOK  LINE 01  COLUMN 15     PIC 9(04)                ìæà”êÊÇb
004070                  USING  W-TOK    CHECK  OVERFLOW  NO  IFC.
004080     02  ACP-CCD  LINE 22  COLUMN  6     PIC 9(03)                I.081120
004090                  USING  W-CCD    CHECK  OVERFLOW  NO  IFC.       I.081120
004100     02  ACP-FROM LINE 01  COLUMN 68     PIC 9(06)                ÇeÇqì˙ït
004110                  USING  W-FROMS  CHECK  OVERFLOW  NO  IFC.       I.980526
004120*****             USING  W-FROM   CHECK  OVERFLOW  NO  IFC.       D.980526
004130     02  ACP-TO   LINE 01  COLUMN 75     PIC 9(06)                ÇsÇnì˙ït
004140                  USING  W-TOS    CHECK  OVERFLOW  NO  IFC.       I.980526
004150*****             USING  W-TO     CHECK  OVERFLOW  NO  IFC.       D.980526
004160*****02  ACP-GYO  LINE 22  COLUMN 2      PIC 9(02)                D.061020
004170     02  ACP-GYO  LINE 21  COLUMN 2      PIC 9(02)                I.061020
004180                  USING  W-GYO    CHECK  OVERFLOW  NO  IFC.
004190     02  ACP-OKC  LINE 24  COLUMN 70     PIC 9(01)                ämîF
004200                  USING  OKC      CHECK  OVERFLOW  NO  IFC.
004210*
004220 01  DISP-MSG-SPACE1     LINE 24.
004230     02  COLUMN  1   PIC X(39)     VALUE " ".
004240*
004250 COPY    LSMSG.
004260     COPY  LIBSCR.                                                I.980526
004270*
004280 PROCEDURE               DIVISION.
004290 HAJIME.
004300     PERFORM   INI-RTN    THRU  INI-EX.
004310     PERFORM   MAIN-RTN   THRU  MAIN-EX.
004320     PERFORM   END-RTN    THRU  END-EX.
004330     STOP  RUN.
004340************************************
004350*    ÉÅÉCÉìÅ@ÉãÅ[É`Éì              *
004360************************************
004370 MAIN-RTN.
004380     ACCEPT  ACP-TOK.                                             ìæà”êÊÇb
004390     DISPLAY DISP-MSG-SPACE1.
004400     IF  ESTAT  =  "P9"
004410         GO  TO  MAIN-EX.
004420     IF ESTAT NOT  =  "01" AND "06"
004430        GO  TO  MAIN-RTN.
004440     DISPLAY  ACP-TOK.
004450*
004460     MOVE  W-TOK    TO  TC-TCD.
004470     MOVE  "001"    TO  TC-CCD.
004480     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.
004490     IF  SW  =  " ON"
004500         DISPLAY  INV-M01
004510         GO  TO  MAIN-RTN.
004520     DISPLAY  DSP-TOK.
004530     IF JS-SIGN    =  0                                           I.081120
004540        GO  TO  MAIN-010.                                         I.081120
004550 MAIN-005.                                                        I.081120
004560     ACCEPT  ACP-CCD.                                             I.081120
004570     DISPLAY DISP-MSG-SPACE1.                                     I.081120
004580     IF  ESTAT  =  "09"                                           I.081120
004590         GO  TO  MAIN-RTN.                                        I.081120
004600     IF ESTAT NOT  =  "01" AND "06"                               I.081120
004610        GO  TO  MAIN-005.                                         I.081120
004620     DISPLAY  ACP-CCD.                                            I.081120
004630     MOVE  W-TOK    TO  TC-TCD.                                   I.081120
004640     MOVE  W-CCD    TO  TC-CCD.                                   I.081120
004650     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.                 I.081120
004660     IF  SW  =  " ON"                                             I.081120
004670         DISPLAY  INV-M01                                         I.081120
004680         GO  TO  MAIN-005.                                        I.081120
004690     DISPLAY  DSP-CHON.                                           I.081120
004700 MAIN-010.
004710     ACCEPT  ACP-FROM.                                            ÇeÇqì˙ït
004720     DISPLAY DISP-MSG-SPACE1.
004730     IF  ESTAT  =  "09"
004740         IF  JS-SIGN  =  1                                        I.081120
004750             GO  TO  MAIN-005                                     I.081120
004760         ELSE                                                     I.081120
004770             GO  TO  MAIN-RTN.
004780*****IF ESTAT NOT  =  "01" AND "06"                               D.090409
004790     IF ESTAT NOT  =  "01" AND "04" AND "06"                      I.090409
004800        GO  TO  MAIN-010.
004810     IF ESTAT      =  "04"                                        I.090409
004820        ACCEPT  W-FROMS  FROM  DATE.                              I.090409
004830     DISPLAY  ACP-FROM.
004840     IF  W-FROMS   =  ZERO                                        I.980526
004850         MOVE  ZERO     TO  W-FROM                                I.980526
004860         GO  TO  MAIN-020.                                        I.980526
004870     IF  (W-FGET  <  1  OR  >  12)  OR                            I.980526
004880         (W-FPEY  <  1  OR  >  31)                                I.980526
004890         GO  TO  MAIN-010.                                        I.980526
004900     MOVE  ZERO      TO  W-FNEN1.                                 I.980526
004910     IF W-FNEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980526
004920         ADD DATE-NC1 TO W-FNEN.                                  I.980526
004930     IF W-FNEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980526
004940         ADD DATE-NC2 TO W-FNEN.                                  I.980526
004950 MAIN-020.
004960     ACCEPT  ACP-TO.                                              ÇsÇnì˙ït
004970     DISPLAY DISP-MSG-SPACE1.
004980     IF  ESTAT  =  "09"
004990         GO  TO  MAIN-010.
005000*****IF ESTAT NOT  =  "01" AND "06"                               D.090409
005010     IF ESTAT NOT  =  "01" AND "04" AND "06"                      I.090409
005020        GO  TO  MAIN-020.
005030     IF ESTAT      =  "04"                                        I.090409
005040        ACCEPT  W-TOS  FROM  DATE.                                I.090409
005050     IF  W-TOS     =  ZERO  OR  999999                            I.980526
005060         MOVE  99999999 TO  W-TO                                  I.980526
005070         DISPLAY  ACP-TO                                          I.980526
005080         GO  TO  MAIN-025.                                        I.980526
005090     DISPLAY  ACP-TO.
005100     IF  (W-TGET  <  1  OR  >  12)  OR                            I.980526
005110         (W-TPEY  <  1  OR  >  31)                                I.980526
005120         GO  TO  MAIN-020.                                        I.980526
005130     MOVE  ZERO      TO  W-TNEN1.                                 I.980526
005140     IF W-TNEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980526
005150         ADD DATE-NC1 TO W-TNEN.                                  I.980526
005160     IF W-TNEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980526
005170         ADD DATE-NC2 TO W-TNEN.                                  I.980526
005180     IF  W-FROM  >  W-TO
005190         GO  TO  MAIN-020.
005200 MAIN-025.                                                        I.980526
005210     MOVE  2        TO  LIN.                                      * LIN
005220     MOVE  ZERO     TO  G.                                        * G
005230*
005240     MOVE  0        TO  W-DC.                                     I.940906
005250*****INITIALIZE  JSRU-KEY2.                                       D.971205
005260*****MOVE  W-TOK    TO  JSRU-12.                                  D.971205
005270*****MOVE  W-FROM   TO  JSRU-13.                                  D.971205
005280*****START  JSRU  KEY  NOT  <  JSRU-KEY2  INVALID                 D.971205
005290     INITIALIZE  JNSR-KEY3.                                       I.971205
005300     MOVE  W-TOK    TO  JNSR-19.                                  I.971205
005310     MOVE  W-FROM   TO  JNSR-20.                                  I.971205
005320     START  JNSR  KEY  NOT  <  JNSR-KEY3  INVALID                 I.971205
005330         GO  TO  MAIN-040.
005340 MAIN-030.
005350***  èoâ◊ó›åvÉtÉ@ÉCÉãÅ@ÇqÇdÇ`Çc
005360*****READ  JSRU  NEXT  UNLOCK  AT  END                            D.971205
005370     READ  JNSR  NEXT  UNLOCK  AT  END                            I.971205
005380         GO  TO  MAIN-040.
005390*****IF  W-TOK  NOT =  JSRU-12                                    D.971205
005400     IF  W-TOK  NOT =  JNSR-19                                    I.971205
005410         GO  TO  MAIN-040.
005420*****IF  W-TO  <  JSRU-13                                         D.971205
005430*****IF  W-TO  <  JNSR-20                                         D.971209
005440     MOVE   JNSR-20    TO  W-DATE.                                I.971209
005450     IF  W-TO  <  W-DATE                                          I.971209
005460         GO  TO  MAIN-040.
005470     IF  JS-SIGN    =  1                                          I.081120
005480         IF  W-CCD  NOT =  JNSR-112                               I.081120
005490             GO  TO  MAIN-030.                                    I.081120
005500*****MOVE   JSRU-13    TO  W-HIZ.                                 D.971205
005510*****MOVE   JSRU-092   TO  W-SOK.                                 D.971205
005520*****MOVE   JSRU-151   TO  W-SAS.                                 D.971205
005530*****MOVE   JNSR-20    TO  W-HIZ.                                 D.971209
005540     MOVE   W-DATE     TO  W-HIZ.                                 I.971209
005550     COMPUTE  W-SOK    =   JNSR-081(01)  +  JNSR-081(02) +        I.971205
005560                           JNSR-081(03)  +  JNSR-081(04) +        I.971205
005570                           JNSR-081(05)  +  JNSR-081(06) +        I.971205
005580                           JNSR-081(07)  +  JNSR-081(08) +        I.971205
005590                           JNSR-081(09)  +  JNSR-081(10).         I.971205
005600     MOVE   JNSR-221   TO  W-SAS.                                 I.971205
005610*****MOVE   SPACE      TO  W-KBN.                                 D.061020
005620*****IF  JSRU-06          NOT  =  ZERO                            D.971205
005630*****    IF  JSRU-01               =  0                           D.971205
005640*****IF  JNSR-151         NOT  =  ZERO                            D.061020
005650*****    IF  JNSR-13               =  0                           D.061020
005660*****                MOVE  "*"        TO  W-KBN                   D.061020
005670*****        ELSE    IF  JSRU-01           =  5                   D.971205
005680*****        ELSE    IF  JNSR-13           =  5                   D.061020
005690*****                           MOVE  "#"         TO  W-KBN       D.061020
005700*****                    ELSE   MOVE  "$"         TO  W-KBN.      D.061020
005710 NEXT-DSP.
005720     ADD  1     TO  LIN.                                          * LIN
005730     ADD  1     TO  G.                                            * G
005740*****IF  LIN  =  21                                               D.061020
005750     IF  LIN  =  20                                               I.061020
005760         SUBTRACT  1     FROM  G                                  * G
005770         GO  TO  MAIN-OKC.
005780     PERFORM  WORK-RTN     THRU  WORK-EX.
005790     PERFORM  DSP-RTN      THRU  DSP-EX.
005800     GO  TO  MAIN-030.
005810 MAIN-040.
005820     MOVE  1        TO  W-DC.                                     I.940906
005830*****INITIALIZE  WN01-KEY.                                        D.971205
005840*****MOVE  W-TOK    TO  WN01-12.                                  D.971205
005850*****MOVE  W-FROM   TO  WN01-13.                                  D.971205
005860*****START  JT-WKN1  KEY  NOT  <  WN01-KEY  INVALID               D.971205
005870     INITIALIZE  JTW-KEY3.                                        I.971205
005880     MOVE  W-TOK    TO  JTW-19.                                   I.971205
005890     MOVE  W-FROM   TO  JTW-20.                                   I.971205
005900     START  JT-W170  KEY  NOT  <  JTW-KEY3  INVALID               I.971205
005910         GO  TO  MAIN-047.                                        I.940905
005920 MAIN-042.                                                        I.940905
005930***  èoâ◊ó›åvÉèÅ[ÉNÅ@ÇqÇdÇ`Çc
005940*****READ  JT-WKN1 NEXT  UNLOCK  AT  END                          D.971205
005950     READ  JT-W170 NEXT  UNLOCK  AT  END                          I.971205
005960         GO  TO  MAIN-047.                                        I.940905
005970*****IF  W-TOK  NOT =  WN01-12                                    D.971205
005980     IF  W-TOK  NOT =  JTW-19                                     I.971205
005990         GO  TO  MAIN-047.                                        I.940905
006000*****IF  W-TO  <  WN01-13                                         D.971205
006010*****IF  W-TO  <  JTW-20                                          D.971209
006020     MOVE   JTW-20     TO  W-DATE.                                I.971209
006030     IF  W-TO  <  W-DATE                                          I.971209
006040         GO  TO  MAIN-047.                                        I.940905
006050     IF  JS-SIGN    =  1                                          I.081120
006060         IF  W-CCD  NOT =  JTW-112                                I.081120
006070             GO  TO  MAIN-042.                                    I.081120
006080     MOVE   ZERO       TO  W-HIZ.                                 I.940906
006090*****MOVE   WN01-092   TO  W-SOK.                                 D.971205
006100*****MOVE   WN01-151   TO  W-SAS.                                 D.971205
006110     COMPUTE  W-SOK    =   JTW-081(01)  +  JTW-081(02) +          I.971205
006120                           JTW-081(03)  +  JTW-081(04) +          I.971205
006130                           JTW-081(05)  +  JTW-081(06) +          I.971205
006140                           JTW-081(07)  +  JTW-081(08) +          I.971205
006150                           JTW-081(09)  +  JTW-081(10).           I.971205
006160     MOVE   JTW-221    TO  W-SAS.                                 I.971205
006170*****MOVE   SPACE      TO  W-KBN.                                 D.061020
006180*****IF  WN01-06          NOT  =  ZERO                            D.971205
006190*****    IF  WN01-01               =  0                           D.971205
006200*****IF  JTW-151          NOT  =  ZERO                            D.061020
006210*****    IF  JTW-13                =  0                           D.061020
006220*****                MOVE  "*"        TO  W-KBN                   D.061020
006230*****        ELSE    IF  WN01-01           =  5                   D.971205
006240*****        ELSE    IF  JTW-13            =  5                   D.061020
006250*****                           MOVE  "#"         TO  W-KBN       D.061020
006260*****                    ELSE   MOVE  "$"         TO  W-KBN.      D.061020
006270 MAIN-045.                                                        I.940905
006280     ADD  1     TO  LIN.                                          I.940905
006290     ADD  1     TO  G.                                            I.940905
006300*****IF  LIN  =  21                                               D.061020
006310     IF  LIN  =  20                                               I.061020
006320         SUBTRACT  1     FROM  G                                  I.940905
006330         GO  TO  MAIN-OKC.                                        I.940905
006340     PERFORM  WORK1-RTN    THRU  WORK1-EX.                        I.940906
006350     PERFORM  DSP1-RTN     THRU  DSP1-EX.                         I.940906
006360     GO  TO  MAIN-042.                                            I.940905
006370 MAIN-047.                                                        I.940905
006380     IF  LIN  =  2
006390         DISPLAY  INV-D01
006400         GO  TO  MAIN-010.
006410*****IF  LIN  NOT =  20                                           D.061020
006420     IF  LIN  NOT =  19                                           I.061020
006430         ADD  1     TO  LIN                                       * LIN
006440         MOVE  LIN     TO  LIN1
006450         PERFORM  GAMEN-CLR-RTN     THRU  GAMEN-CLR-EX
006460         MOVE  LIN1    TO  LIN.                                   * LIN
006470 MAIN-OKC.
006480     ACCEPT  ACP-OKC.                                             ämîF
006490     DISPLAY DISP-MSG-SPACE1.
006500     IF  ESTAT  =  "09"
006510         PERFORM  SHOSAI-RTN     THRU  SHOSAI-EX
006520     ELSE
006530         GO  TO  MAIN-050.
006540     IF  ESTAT  =  "09"
006550         GO  TO  MAIN-OKC.
006560 MAIN-050.
006570     IF  ESTAT NOT  =  "01" AND "06"
006580         GO  TO  MAIN-OKC.
006590     DISPLAY  ACP-OKC.
006600     IF  OKC  NOT  =  "1" AND "9"
006610         GO  TO  MAIN-OKC.
006620     IF OKC  =  "9"
006630*****    DISPLAY  CAN-01                                          D.950217
006640         PERFORM  CLR1-RTN     THRU  CLR1-EX
006650         GO  TO  MAIN-RTN.
006660*****IF  LIN  =  21                                               D.061020
006670     IF  LIN  =  20                                               I.061020
006680         PERFORM  CLR3-RTN     THRU  CLR3-EX
006690         MOVE  2        TO  LIN                                   * LIN
006700         MOVE  ZERO     TO  G                                     * G
006710         IF  W-DC      =  0                                       I.940906
006720                       GO  TO  NEXT-DSP
006730         ELSE          GO  TO  MAIN-045.                          I.940906
006740*****ELSE                                                         D.940906
006750*****IF  LIN  NOT =  21                                           D.061020
006760     IF  LIN  NOT =  20                                           I.061020
006770         DISPLAY  OK-01
006780         PERFORM  CLR1-RTN     THRU  CLR1-EX
006790         GO  TO  MAIN-RTN.
006800 MAIN-EX.
006810     EXIT.
006820************************************
006830*    ÇvÇnÇqÇjÅ|ÇqÇsÇmÅ@Å@Å@        *
006840************************************
006850 WORK-RTN.
006860*****MOVE  JSRU-08         TO  W-SIZE1(G).                        D.971205
006870*****MOVE  JSRU-04         TO  W-CHO(G).                          D.971205
006880*****MOVE  JSRU-06         TO  W-GNO(G).                          D.971205
006890*****MOVE  JSRU-17         TO  W-UNSO(G).                         D.971205
006900     MOVE   0          TO  W-KBN.                                 I.061020
006910     IF  JNSR-151         NOT  =  ZERO                            I.061020
006920         IF  JNSR-13               =  0                           I.061020
006930                     MOVE  3          TO  W-KBN                   I.061020
006940             ELSE    MOVE  JNSR-13    TO  W-KBN.                  I.061020
006950     MOVE  JNSR-07         TO  W-SIZE1(G).                        I.971205
006960     MOVE  JNSR-11         TO  W-CHO(G).                          I.971205
006970     MOVE  JNSR-151        TO  W-GNO1(G).                         I.971205
006980     MOVE  JNSR-152        TO  W-GNO2(G).                         I.971205
006990     MOVE  JNSR-14         TO  W-UNSO(G).                         I.971205
007000     MOVE  JNSR-23         TO  W-TEK1(G).                         I.061020
007010     MOVE  JNSR-24         TO  W-TEK2(G).                         I.061020
007020     MOVE  JNSR-12         TO  W-OKNO(G).                         I.061020
007030     MOVE  JNSR-06         TO  W-KURA(G).                         I.061020
007040     MOVE  1               TO  I.
007050 WORK-010.
007060     IF  I  >  10
007070         GO  TO  WORK-EX.
007080*****MOVE  JSRU-0911(I)    TO  W-SIZE2(G I).                      D.971205
007090     MOVE  JNSR-081(I)     TO  W-SIZE2(G I).                      I.971205
007100     ADD  1     TO  I.
007110     GO  TO  WORK-010.
007120 WORK-EX.
007130     EXIT.
007140************************************
007150*    ÇcÇrÇoÅ|ÇqÇsÇmÅ@Å@Å@Å@        *
007160************************************
007170 DSP-RTN.
007180     MOVE  SPACE           TO  W-DEN.
007190*****IF  JSRU-10  =  0                                            D.971205
007200     IF  JNSR-10  =  0                                            I.971205
007210         IF  W-KBN    =  3                                        I.061020
007220             MOVE  NC"éÛíç"    TO  W-DEN                          I.061020
007230         ELSE   IF  W-KBN    =  5                                 I.061020
007240                    MOVE  NC"óaÇË"    TO  W-DEN                   I.061020
007250         ELSE   IF  W-KBN    =  6                                 I.061020
007260                    MOVE  NC"éÊÇË"    TO  W-DEN                   I.061020
007270         ELSE   IF  W-KBN    =  0                                 I.061020
007280                    MOVE  NC"èoâ◊"    TO  W-DEN.
007290*****IF  JSRU-10  =  1                                            D.971205
007300     IF  JNSR-10  =  1                                            I.971205
007310         MOVE  NC"ï‘ïi"    TO  W-DEN.
007320*****IF  JSRU-10  =  2                                            D.971205
007330     IF  JNSR-10  =  2                                            I.971205
007340         MOVE  NC"ïsó«"    TO  W-DEN.
007350*****IF  JSRU-10  =  3                                            D.971205
007360     IF  JNSR-10  =  3                                            I.971205
007370         MOVE  NC"í˘ê≥"    TO  W-DEN.
007380*****IF  JSRU-10  =  5                                            D.971205
007390     IF  JNSR-10  =  5                                            I.971205
007400         MOVE  NC"ï‘ëº"    TO  W-DEN.                             I.950218
007410*****IF  JSRU-10  =  7                                            D.971205
007420     IF  JNSR-10  =  7                                            I.971205
007430         MOVE  NC"ÉTèo"    TO  W-DEN.
007440*****MOVE  JSRU-07         TO  SHM-KEY.                           D.971205
007450*****MOVE  JNSR-01         TO  SHM-KEY.                           D.971209
007460*****MOVE  JNSR-01         TO  SHM-01.                            D.010818
007470*****PERFORM  SHM-READ-RTN     THRU  SHM-READ-EX.                 D.010818
007480     MOVE  JNSR-01         TO  HI-MHCD HI-HCD.                    I.010818
007490     PERFORM  HIM-READ-RTN     THRU  HIM-READ-EX.                 I.010818
007500     MOVE  JNSR-151        TO  JMSTD-07.                          I.130909
007510     MOVE  JNSR-152        TO  JMSTD-08.                          I.130909
007520     PERFORM  JMS-READ-RTN     THRU  JMS-READ-EX.                 I.130909
007530     DISPLAY  DSP-AREA.
007540     IF  W-GP     =  ZERO                                         I.130909
007550         DISPLAY  DSP-CGP.                                        I.130909
007560 DSP-EX.
007570     EXIT.
007580************************************
007590*    ÇvÇnÇqÇjÇPÅ|ÇqÇsÇmÅ@Å@        *
007600************************************
007610 WORK1-RTN.
007620*****MOVE  WN01-08         TO  W-SIZE1(G).                        D.971205
007630*****MOVE  WN01-04         TO  W-CHO(G).                          D.971205
007640*****MOVE  WN01-06         TO  W-GNO(G).                          D.971205
007650*****MOVE  WN01-17         TO  W-UNSO(G).                         D.971205
007660     MOVE   0          TO  W-KBN.                                 I.061020
007670     IF  JTW-151          NOT  =  ZERO                            I.061020
007680         IF  JTW-13                =  0                           I.061020
007690                     MOVE  3          TO  W-KBN                   I.061020
007700             ELSE    MOVE  JTW-13     TO  W-KBN.                  I.061020
007710     MOVE  JTW-07          TO  W-SIZE1(G).                        I.971205
007720     MOVE  JTW-11          TO  W-CHO(G).                          I.971205
007730     MOVE  JTW-151         TO  W-GNO1(G).                         I.971205
007740     MOVE  JTW-152         TO  W-GNO2(G).                         I.971205
007750     MOVE  JTW-14          TO  W-UNSO(G).                         I.971205
007760     MOVE  JTW-23          TO  W-TEK1(G).                         I.061020
007770     MOVE  JTW-24          TO  W-TEK2(G).                         I.061020
007780     MOVE  JTW-12          TO  W-OKNO(G).                         I.061020
007790     MOVE  JTW-06          TO  W-KURA(G).                         I.061020
007800     MOVE  1               TO  I.
007810 WORK1-010.
007820     IF  I  >  10
007830         GO  TO  WORK1-EX.
007840*****MOVE  WN01-0911(I)    TO  W-SIZE2(G I).                      D.971205
007850     MOVE  JTW-081(I)     TO  W-SIZE2(G I).                       I.971205
007860     ADD  1     TO  I.
007870     GO  TO  WORK1-010.
007880 WORK1-EX.
007890     EXIT.
007900************************************
007910*    ÇcÇrÇoÇPÅ|ÇqÇsÇmÅ@Å@Å@        *
007920************************************
007930 DSP1-RTN.
007940     MOVE  SPACE           TO  W-DEN.
007950*****IF  WN01-10  =  0                                            D.971205
007960     IF  JTW-10   =  0                                            I.971205
007970         IF  W-KBN    =  3                                        I.061020
007980             MOVE  NC"éÛíç"    TO  W-DEN                          I.061020
007990         ELSE   IF  W-KBN    =  5                                 I.061020
008000                    MOVE  NC"óaÇË"    TO  W-DEN                   I.061020
008010         ELSE   IF  W-KBN    =  6                                 I.061020
008020                    MOVE  NC"éÊÇË"    TO  W-DEN                   I.061020
008030         ELSE   IF  W-KBN    =  0                                 I.061020
008040                    MOVE  NC"èoâ◊"    TO  W-DEN.
008050*****IF  WN01-10  =  1                                            D.971205
008060     IF  JTW-10   =  1                                            I.971205
008070         MOVE  NC"ï‘ïi"    TO  W-DEN.
008080*****IF  WN01-10  =  2                                            D.971205
008090     IF  JTW-10   =  2                                            I.971205
008100         MOVE  NC"ïsó«"    TO  W-DEN.
008110*****IF  WN01-10  =  3                                            D.971205
008120     IF  JTW-10   =  3                                            I.971205
008130         MOVE  NC"í˘ê≥"    TO  W-DEN.
008140*****IF  WN01-10  =  7                                            D.971205
008150     IF  JTW-10   =  7                                            I.971205
008160         MOVE  NC"ÉTèo"    TO  W-DEN.
008170*****MOVE  WN01-07         TO  SHM-KEY.                           D.971205
008180*****MOVE  JTW-01          TO  SHM-KEY.                           D.971209
008190*****MOVE  JTW-01          TO  SHM-01.                            D.010818
008200*****PERFORM  SHM-READ-RTN     THRU  SHM-READ-EX.                 D.010818
008210     MOVE  JTW-01          TO  HI-MHCD HI-HCD.                    I.010818
008220     PERFORM  HIM-READ-RTN     THRU  HIM-READ-EX.                 I.010818
008230     MOVE  JTW-151         TO  JMSTD-07.                          I.130909
008240     MOVE  JTW-152         TO  JMSTD-08.                          I.130909
008250     PERFORM  JMS-READ-RTN     THRU  JMS-READ-EX.                 I.130909
008260     DISPLAY  DSP-AREA.
008270     IF  W-GP     =  ZERO                                         I.130909
008280         DISPLAY  DSP-CGP.                                        I.130909
008290 DSP1-EX.
008300     EXIT.
008310************************************
008320*    ÇfÇ`ÇlÇdÇmÅ|ÇbÇkÇqÅ|ÇqÇsÇm    *
008330************************************
008340 GAMEN-CLR-RTN.
008350*****IF  LIN  >  20                                               D.061020
008360     IF  LIN  >  19                                               I.061020
008370         GO  TO  GAMEN-CLR-EX.
008380     DISPLAY  GAMEN-CLR.
008390     ADD  1     TO  LIN.
008400     GO  TO  GAMEN-CLR-RTN.
008410 GAMEN-CLR-EX.
008420     EXIT.
008430************************************
008440*    ÇrÇgÇnÇrÇ`ÇhÅ|ÇqÇsÇmÅ@        *
008450************************************
008460 SHOSAI-RTN.
008470     ACCEPT  ACP-GYO.                                             çs 1Å`18
008480     IF  ESTAT  =  "09"
008490         GO  TO  SHOSAI-EX.
008500     IF  ESTAT NOT  =  "01" AND "06"
008510         GO  TO  SHOSAI-RTN.
008520     IF  W-GYO  >  G
008530         GO  TO  SHOSAI-RTN.
008540     IF  W-GYO  =  ZERO
008550         GO  TO  SHOSAI-RTN.
008560     MOVE  W-GYO          TO  GG.
008570     MOVE  W-CHO(GG)      TO  TC-KEY.
008580     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.
008590*****PERFORM  JCON-READ-RTN    THRU  JCON-READ-EX.                D.061020
008600     DISPLAY  DSP-SHOSAI1.
008610*
008620     IF  W-SIZE1(GG)  =  1
008630         DISPLAY  DSP-1.
008640     IF  W-SIZE1(GG)  =  2
008650         DISPLAY  DSP-2.
008660     IF  W-SIZE1(GG)  =  3
008670         DISPLAY  DSP-3.
008680     IF  W-SIZE1(GG)  =  4
008690         DISPLAY  DSP-4.
008700*
008710     IF  W-SIZE1(GG)  NOT =  1  AND  2  AND  3  AND  4
008720         DISPLAY  CLR-SHOSAI
008730         GO  TO  SHOSAI-020.
008740*
008750     MOVE  1     TO  I.
008760     MOVE  11    TO  COL.
008770 SHOSAI-010.
008780     IF  I  >  10
008790         GO  TO  SHOSAI-020.
008800     DISPLAY  DSP-SIZE2.
008810     ADD  1     TO  I.
008820     ADD  7     TO  COL.
008830     GO  TO  SHOSAI-010.
008840 SHOSAI-020.
008850     GO  TO  SHOSAI-RTN.
008860 SHOSAI-EX.
008870     EXIT.
008880*********************************************
008890*    ÇbÇkÇqÅ|ÇqÇsÇmÇP                       *
008900*********************************************
008910 CLR1-RTN.
008920     INITIALIZE  W-AREA1.
008930     MOVE  3     TO  LIN.
008940 CLR1-010.
008950*****IF  LIN  >  20                                               D.061020
008960     IF  LIN  >  19                                               I.061020
008970         GO  TO  CLR1-EX.
008980     DISPLAY  CLR-AREA.
008990     ADD   1     TO  LIN.
009000     GO  TO  CLR1-010.
009010 CLR1-EX.
009020     EXIT.
009030*********************************************
009040*    ÇbÇkÇqÅ|ÇqÇsÇmÇR                       *
009050*********************************************
009060 CLR3-RTN.
009070     INITIALIZE  W-SHOSAI  W-DEN.
009080     MOVE  3     TO  LIN.
009090 CLR3-010.
009100*****IF  LIN  >  20                                               D.061020
009110     IF  LIN  >  19                                               I.061020
009120         GO  TO  CLR3-EX.
009130     DISPLAY  CLR-02.
009140     ADD   1     TO  LIN.
009150     GO  TO  CLR3-010.
009160 CLR3-EX.
009170     EXIT.
009180*********************************************
009190*    ÇhÇmÇhÅ|ÇqÇsÇm                         *
009200*********************************************
009210 INI-RTN.
009220     ACCEPT         JS-SIGN.                                      I.081120
009230     IF  JS-SIGN   NOT =  0    AND   1          STOP  RUN.        I.081120
009240     DISPLAY        CLR-1.
009250     CALL  "SJ640R".
009260     CALL  "CBLSTNNO"  USING  STN-NO.                             I.940905
009270     MOVE  STN-NO-02   TO     WORK1-ID-02  WORK2-ID-02.           I.971205
009280     MOVE  WF1-ID      TO     JT-W170K1ID.                        I.971205
009290     MOVE  WF2-ID      TO     JT-W170K3ID.                        I.971205
009300     OPEN  INPUT  JMSTD.                                          I.130909
009310     OPEN  INPUT  JNSR  HI2-M  TC-M  JT-W170  JCON.               I.010818
009320*****OPEN  INPUT  JNSR  SHM  TC-M  JT-W170  JCON.                 D.010818
009330     COPY  LIBCPR.                                                I.980526
009340*****MOVE  STN-NO-02   TO     WORK-ID-02.                         D.971205
009350*****MOVE  WF-ID       TO     JT-IWS102ID.                        D.971205
009360*****OPEN  INPUT  JSRU  SHM  TC-M.                                D.940905
009370*****OPEN  INPUT  JSRU  SHM  TC-M  JT-WKN1.                       D.950217
009380*****OPEN  INPUT  JSRU  SHM  TC-M  JT-WKN1  JCON.                 D.971205
009390 INI-EX.
009400     EXIT.
009410*********************************************
009420*    ÇdÇmÇcÅ|ÇqÇsÇm                         *
009430*********************************************
009440 END-RTN.
009450*****CLOSE  JSRU  SHM  TC-M.                                      D.940905
009460*****CLOSE  JSRU  SHM  TC-M  JT-WKN1.                             D.950217
009470*****CLOSE  JSRU  SHM  TC-M  JT-WKN1  JCON.                       D.971205
009480*****CLOSE  JNSR  SHM  TC-M  JT-W170  JCON.                       D.010818
009490     CLOSE  JMSTD.                                                I.130909
009500     CLOSE  JNSR  HI2-M TC-M  JT-W170  JCON.                      I.010818
009510     DISPLAY CLR-1.
009520 END-EX.
009530     EXIT.
009540************************************
009550*    íºëóêÊÉ}ÉXÉ^Å@ÇqÇdÇ`Çc        *
009560************************************
009570 TCM-READ-RTN.
009580     MOVE  "OFF"     TO  SW.
009590***  íºëóêÊÉ}ÉXÉ^Å@ÇqÇdÇ`Çc
009600     READ  TC-M  UNLOCK  INVALID
009610         MOVE  " ON"     TO  SW
009620         MOVE  SPACE     TO   TC-NAME.
009630 TCM-READ-EX.
009640     EXIT.
009650************************************
009660*    ïiñºÉ}ÉXÉ^Å@ÇqÇdÇ`Çc      *
009670************************************
009680*SHM-READ-RTN.                                                    D.010818
009690 HIM-READ-RTN.                                                    I.010818
009700     MOVE  "OFF"     TO  SW.
009710*****READ  SHM  UNLOCK  INVALID                                   D.010818
009720     READ  HI2-M  UNLOCK  INVALID                                 I.010818
009730         MOVE  " ON"     TO  SW
009740         MOVE  SPACE     TO   HI-SMS.                             I.130909
009750*****    MOVE  SPACE     TO   HI-NAME.                            D.130909
009760*****    MOVE  SPACE     TO   SHM-02.                             D.010818
009770*SHM-READ-EX.                                                     D.010818
009780 HIM-READ-EX.                                                     I.010818
009790     EXIT.
009800*
009810 JMS-READ-RTN.                                                    I.130909
009820     MOVE  ZERO         TO  W-GP.                                 I.130909
009830     READ  JMSTD  UNLOCK  INVALID KEY                             I.130909
009840         GO  TO  JMS-READ-EX.                                     I.130909
009850     MOVE  JMSTD-022    TO  W-GET.                                I.130909
009860     MOVE  JMSTD-023    TO  W-PEY.                                I.130909
009870 JMS-READ-EX.                                                     I.130909
009880     EXIT.
009890************************************
009900*    ÉRÉìÉgÉçÅ[ÉãÇeÅ@ÇqÇdÇ`Çc      *
009910************************************
009920*JCON-READ-RTN.                                                   D.061020
009930*****MOVE  2         TO  JCON2-01.                                D.061020
009940*****MOVE  W-UNSO(GG) TO  JCON2-02.                               D.061020
009950*****READ  JCON UNLOCK  INVALID                                   D.061020
009960*****    MOVE  " ON"     TO  SW                                   D.061020
009970*****    MOVE  SPACE     TO   JCON2-03.                           D.061020
009980*JCON-READ-EX.                                                    D.061020
009990*****EXIT.                                                        D.061020
010000*
010010 COPY LPMSG.
