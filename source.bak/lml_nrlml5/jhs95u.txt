000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JHS95U.
000030******************************************
000040*****    ÇbÇnÇcÇdÇeÅ@ÇhÇsÇeÉZÉbÉg    *****
000050******************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120*****SELECT CODEF ASSIGN TO CODE-MSD                              D.100716
000130     SELECT CODEF ASSIGN TO CODE-MSD CODE2-MSD                    I.100716
000140         ORGANIZATION INDEXED
000150         ACCESS MODE DYNAMIC
000160         RECORD KEY CODE-KEY
000170         ALTERNATE RECORD KEY CODE-KEY2                           I.100716
000180         FILE STATUS IS ERR-STAT.
000190     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000200         ORGANIZATION INDEXED
000210         ACCESS MODE DYNAMIC
000220         RECORD KEY HI-KEY
000230         ALTERNATE RECORD KEY HI-KEY2
000240         FILE STATUS IS ERR-STAT.
000250 I-O-CONTROL.
000260     APPLY SHARED-MODE ON CODEF
000270     APPLY SHARED-MODE ON HI-M.
000280 DATA DIVISION.
000290 FILE SECTION.
000300     COPY LICODE.
000310     COPY LIHIM.
000320 WORKING-STORAGE SECTION.
000330 77  ERR-STAT           PIC  X(002).
000340 77  W-FILE             PIC  X(013).
000350 01  W-DATA.
000360     02  W-DMM          PIC  9(001).
000370     02  W-ITF.
000380         03  W-D1         PIC 9.
000390         03  W-D2         PIC 9.
000400         03  W-D3         PIC 9.
000410         03  W-D4         PIC 9.
000420         03  W-D5         PIC 9.
000430         03  W-D6         PIC 9.
000440         03  W-D7         PIC 9.
000450         03  W-D8         PIC 9.
000460         03  W-D9         PIC 9.
000470         03  W-D10        PIC 9.
000480         03  W-D11        PIC 9.
000490         03  W-D12        PIC 9.
000500         03  W-D13        PIC 9.
000510         03  W-D14        PIC 9.
000520         03  W-D15        PIC 9.
000530         03  W-D16        PIC 9.
000540 01  W-KDATA.
000550     02  W-K1             PIC 9(3).
000560     02  W-K2             PIC 9(3).
000570     02  W-K3             PIC 9.
000580     02  KEISAND          PIC 9(3).
000590     02  KEISAN   REDEFINES  KEISAND.
000600         03  K-D1         PIC 9(2).
000610         03  K-D2         PIC 9(1).
000620     COPY LSTAT.
000630 SCREEN SECTION.
000640 SD  C-CRT
000650     END STATUS IS ESTAT.
000660 01  C-CLEAR.
000670     02  LINE   1  CLEAR SCREEN.
000680 01  C-MID.
000690     02  LINE   2  COLUMN  10  PIC  N(022) VALUE
000700          NC"ÅñÅñÅñÅ@Å@ÇbÇnÇcÇdÇeÅ@ÇhÇsÇeÉZÉbÉgÅ@Å@ÅñÅñÅñ".
000710 01  C-ACP.
000720     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
000730          USING W-DMM   CHECK OVERFLOW NO IFC.
000740 01  C-ERR.
000750     02  LINE  24.
000760       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
000770            "***  À›“≤ ≈º  ***".
000780       03  E-ME12  COLUMN  15  PIC  X(021) VALUE                  I.071122
000790            "***  REWRITE ¥◊∞  ***".                              I.071122
000800       03  E-JAN   COLUMN  40  PIC  X(013) FROM  CODE-JAN.
000810       03  E-HCD   COLUMN  55  PIC  9(006) FROM  CODE-HCD.
000820     COPY LSSEM.
000830 PROCEDURE DIVISION.
000840 M-05.
000850     DISPLAY C-CLEAR.
000860     DISPLAY C-MID.
000870     OPEN I-O CODEF.
000880     OPEN INPUT HI-M.
000890 M-10.
000900     READ CODEF NEXT RECORD AT END
000910         GO TO M-90.
000920     IF CODE-TCD NOT = ZERO
000930         GO TO M-10.
000940     MOVE CODE-HCD TO HI-KEY.
000950     READ HI-M WITH UNLOCK INVALID KEY
000960         DISPLAY E-ME4 E-JAN E-HCD E-ME99
000970         DISPLAY E-CL
000980         GO TO M-10.
000990     MOVE CODE-JAN TO CODE-JAND.
001000     MOVE HI-ISU TO CODE-ISU.
001010     PERFORM S-05 THRU S-10.
001020     REWRITE CODE-R INVALID KEY
001030         DISPLAY E-ME12 E-JAN E-HCD E-ME99
001040         DISPLAY E-CL.
001050     GO TO M-10.
001060 M-90.
001070     CLOSE CODEF.
001080     CLOSE HI-M.
001090 M-95.
001100     DISPLAY C-CLEAR.
001110     STOP RUN.
001120 S-05.
001130     MOVE CODE-ITF TO W-ITF.
001140     COMPUTE W-K1 = W-D1 + W-D3 + W-D5 + W-D7 + W-D9 + W-D11
001150                                             + W-D13 + W-D15.
001160     COMPUTE W-K1 = W-K1 * 3.
001170     COMPUTE W-K2 = W-D2 + W-D4 + W-D6 + W-D8 + W-D10 + W-D12
001180                                                     + W-D14.
001190     COMPUTE KEISAND = W-K1 + W-K2.
001200     COMPUTE W-K3 = 10 - K-D2.
001210     MOVE W-K3 TO W-D16.
001220     MOVE W-ITF TO CODE-ITF.
001230 S-10.
001240     EXIT.
