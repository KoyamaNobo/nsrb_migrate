000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JSS20L.
000030*********************************************************
000040*    PROGRAM         :  納品書発行（とうきょうコープ）  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT SK-HAT ASSIGN TO HAT-RDB
000160         ORGANIZATION INDEXED
000170         ACCESS MODE  DYNAMIC
000180         RECORD KEY   HAT-KEY
000190         FILE STATUS IS ERR-STAT.
000200     SELECT STENM ASSIGN TO STENM-RDB
000210         ORGANIZATION INDEXED
000220         ACCESS MODE  RANDOM
000230         RECORD KEY   STE-KEY1
000240         FILE STATUS IS ERR-STAT.
000250     SELECT SNOWK ASSIGN TO SNOWK-MSD
000260         ORGANIZATION SEQUENTIAL
000270         ACCESS MODE  SEQUENTIAL
000280         FILE STATUS IS ERR-STAT.
000290     SELECT HI2-M ASSIGN TO HI2-MSD
000300         ORGANIZATION INDEXED
000310         ACCESS MODE  RANDOM
000320         RECORD KEY   HI-KEY2
000330         FILE STATUS IS ERR-STAT.
000340     SELECT SP-F ASSIGN TO P-PRN999.
000350 I-O-CONTROL.
000360     APPLY SHARED-MODE ON SK-HAT STENM HI2-M
000370     APPLY SHIFT-CODE  ON SP-F.
000380*
000390 DATA DIVISION.
000400 FILE SECTION.
000410 FD  SP-F
000420     LABEL RECORD IS OMITTED
000430     LINAGE IS 30 LINES.
000440 01  SP-R               PIC  X(206).
000450     COPY    LSKHAT.
000460     COPY    LSTENM.
000470     COPY    LSNOWK.
000480     COPY    LIHIM2.
000490*
000500 WORKING-STORAGE SECTION.
000510 77  SNOWK-ID           PIC  X(06)  VALUE  "SNOWK1".
000520 77  W-FILE             PIC  X(13).
000530 01  ERR-STAT           PIC  X(02).
000540 01  HEAD1.
000550     02  F              PIC  X(05)  VALUE  ""3FE04F40A0"".
000560     02  W-HEAD1.
000570*****  03  F            PIC  X(52)  VALUE  SPACE.                 D.041015
000580       03  F            PIC  X(51)  VALUE  SPACE.                 I.041015
000590       03  H-SNO17      PIC  N(16).
000600     02  F              PIC  X(05)  VALUE  ""3FE04FE080"".
000610 01  HEAD2.
000620     02  F              PIC  X(05)  VALUE  ""3FE04F40A0"".
000630     02  W-HEAD2.
000640*****  03  F            PIC  X(07)  VALUE  SPACE.                 D.041015
000650       03  F            PIC  X(06)  VALUE  SPACE.                 I.041015
000660       03  H-SYATEN     PIC  N(12).
000670       03  F            PIC  X(03)  VALUE  SPACE.
000680       03  H-SNO081     PIC  Z999.                                I.040421
000690*****  03  H-SNO081     PIC  ZZZ9.                                D.040421
000700       03  F            PIC  X(04)  VALUE  SPACE.
000710       03  H-STE06      PIC  X(02).
000720       03  F            PIC  X(06)  VALUE  SPACE.
000730       03  H-STE07      PIC  9(02).
000740       03  F            PIC  X(02)  VALUE  SPACE.
000750       03  H-SNO07      PIC  9(06).
000760       03  F            PIC  X(02)  VALUE  SPACE.
000770       03  H-STE05      PIC  9(06).
000780       03  F            PIC  X(05)  VALUE  SPACE.
000790       03  H-JYUSYO     PIC  N(12).
000800     02  F              PIC  X(05)  VALUE  ""3FE04FE080"".
000810 01  MEI.
000820     02  F              PIC  X(05)  VALUE  ""3FE04F40A0"".
000830     02  W-MEI.
000840*****  03  F            PIC  X(06)  VALUE  SPACE.                 D.040322
000850*****  03  F            PIC  X(04)  VALUE  SPACE.                 D.041015
000860       03  F            PIC  X(03)  VALUE  SPACE.                 I.041015
000870       03  M-SNO09      PIC  N(14).
000880       03  F            PIC  X(12)  VALUE  SPACE.                 I.040322
000890*****  03  F            PIC  X(10)  VALUE  SPACE.                 D.040322
000900       03  M-SNO12      PIC  -----.
000910       03  F            PIC  X(11)  VALUE  SPACE.
000920       03  M-SNO13      PIC  Z(06).
000930       03  F            PIC  X(04)  VALUE  SPACE.
000940       03  M-SNO14      PIC  --------.
000950       03  F            PIC  X(02)  VALUE  SPACE.
000960       03  M-SNO15      PIC  Z(06).
000970       03  F            PIC  X(01)  VALUE  SPACE.
000980       03  M-SNO16      PIC  --------.
000990     02  F              PIC  X(05)  VALUE  ""3FE04FE080"".
001000 01  FOOT.
001010     02  F              PIC  X(05)  VALUE  ""3FE04F40A0"".
001020     02  W-FOOT.
001030*****  03  F            PIC  X(52)  VALUE  SPACE.                 D.041015
001040       03  F            PIC  X(51)  VALUE  SPACE.                 I.041015
001050       03  F-GENKA      PIC  ---------.
001060       03  F            PIC  X(09)  VALUE  SPACE.
001070       03  F-BIKO       PIC  ---------.
001080     02  F              PIC  X(05)  VALUE  ""3FE04FE080"".
001090 01  W-SCR.
001100     02  W-YMD.
001110       03  W-YEAR       PIC  9(04).
001120       03  W-MONTH      PIC  9(02).
001130       03  W-DAY        PIC  9(02).
001140     02  W-PRNT         PIC  9(01).
001150     02  W-TEST         PIC  9(01).
001160     02  W-DDM          PIC  9(01).
001170     02  W-FROM         PIC  9(06).
001180     02  W-TO           PIC  9(06).
001190 01  W-SYSDATE.
001200     02  W-SYSYMD       PIC  9(08).
001210     02  F              REDEFINES  W-SYSYMD.
001220       03  W-SYSY       PIC  9(04).
001230       03  W-SYSM       PIC  9(02).
001240       03  W-SYSD       PIC  9(02).
001250 01  W-DATA.
001260     02  W-FLG          PIC  9(01).
001270     02  W-GNO          PIC  9(01).
001280     02  W-NNO          PIC  9(10).
001290     02  CNT            PIC  9(02).
001300     02  W-GENKA        PIC S9(09).
001310     02  W-BIKO         PIC S9(09).
001320 01  W-OLD.
001330     02  O-TYCD         PIC  9(07).
001340     02  O-KICD         PIC  9(07).
001350     02  O-HATNO        PIC  9(06).
001360     COPY    LWSIZC.
001370     COPY    LSTAT.
001380     COPY    LWMSG.
001390*
001400 SCREEN SECTION.
001410 SD  C-CRT
001420     END STATUS ESTAT.
001430 01  C-CLEAR.
001440     02  LINE   1  CLEAR SCREEN.
001450 01  ACP-AREA.
001460     02  LINE  06.
001470       03  A-YEAR      COLUMN  31    PIC  9(02)
001480           USING  W-YEAR     NO IFC.
001490       03  A-MONTH     COLUMN  35    PIC  9(02)
001500           USING  W-MONTH    NO IFC.
001510       03  A-DAY       COLUMN  39    PIC  9(02)
001520           USING  W-DAY      CHECK  OVERFLOW  NO IFC.
001530     02  A-PRNT     LINE  09    COLUMN  42  PIC  9(01)
001540         USING  W-PRNT     CHECK  OVERFLOW  NO IFC.
001550     02  A-TEST     LINE  12    COLUMN  42  PIC  9(01)
001560         USING  W-TEST     CHECK  OVERFLOW  NO IFC.
001570     02  A-FROM     LINE  15    COLUMN  31  PIC  9(06)
001580         USING  W-FROM     CHECK  OVERFLOW  NO IFC.
001590     02  A-TO       LINE  16    COLUMN  31  PIC  9(06)
001600         USING  W-TO       CHECK  OVERFLOW  NO IFC.
001610     02  A-DDM      LINE  23    COLUMN  66  PIC  9(01)
001620         USING  W-DDM      CHECK  OVERFLOW  NO IFC.
001630 01  CLR-AREA.
001640     02  C-FROM  LINE 15  COLUMN 31  PIC Z(06)  FROM W-FROM.
001650     02  C-TO    LINE 16  COLUMN 31  PIC Z(06)  FROM W-TO.
001660 01  DSP-AREA.
001670     02  LINE  01.
001680       03  D-TITLE     COLUMN  16    PIC  N(19)  VALUE
001690           NC"＊＊＊　　生協　納品書　発行　　＊＊＊".
001700       03  D-SYSYMD    COLUMN  63    PIC  N(05)  VALUE
001710           NC"年　月　日".
001720       03  D-SYSY      COLUMN  61    PIC  9(02)
001730           FROM   W-SYSY.
001740       03  D-SYSM      COLUMN  65    PIC  9(02)
001750           FROM   W-SYSM.
001760       03  D-SYSD      COLUMN  69    PIC  9(02)
001770           FROM   W-SYSD.
001780     02  D-COPE     LINE  03    COLUMN  19  PIC  N(14)  VALUE
001790       NC"【コープとうきょう　　　　】".
001800     02  LINE  06.
001810       03  D-YMD       COLUMN  21    PIC  X(22)  VALUE
001820         "納  期 ：   年  月  日".
001830     02  D-PRNT     LINE  08    COLUMN  21  PIC  N(05)  VALUE
001840       NC"１　発　行".
001850     02  LINE  09.
001860       03  D-REPRNT    COLUMN  21    PIC  N(05)  VALUE
001870         NC"２　再発行".
001880       03  D-SEL       COLUMN  36    PIC  X(08)  VALUE
001890           "選択 [ ]".
001900     02  D-TEST     LINE  11    COLUMN  21  PIC  N(05)  VALUE
001910       NC"テスト印字".
001920     02  D-YN       LINE  12    COLUMN  26  PIC  X(18)  VALUE
001930         "(YES=1,NO=2)   [ ]".
001940     02  D-FT.
001950         03  LINE 14 COLUMN 31 VALUE "発注№".
001960         03  LINE 15 COLUMN 21 VALUE "ＦＲＯＭ".
001970         03  LINE 16 COLUMN 21 VALUE "ＴＯ".
001980     02  D-DDM      LINE  23    COLUMN  50  PIC  X(21)  VALUE
001990           "確認 OK=1 NO=9   ﾘﾀｰﾝ".
002000 01  MSG-AREA.
002010     02  M-ERR01    LINE  24    COLUMN  15  PIC  N(09)  VALUE
002020         NC"印字対象データなし".
002030     COPY    LSSEM.
002040     COPY    LSMSG.
002050*
002060 PROCEDURE DIVISION.
002070 MAIN-01.
002080     PERFORM    INIT-RTN  THRU  INIT-EX.
002090 MAIN-02.
002100     PERFORM    ACP-RTN  THRU  ACP-EX.
002110     IF  W-FLG = 9
002120         MOVE     255  TO  COMPLETION-CODE
002130     ELSE
002140         PERFORM    LST-RTN  THRU  LST-EX
002150         IF  W-NNO = 0
002160             GO TO    MAIN-02.
002170 MAIN-05.
002180     PERFORM    END-RTN  THRU  END-EX.
002190     STOP RUN.
002200*
002210*-----初期処理-----*
002220 INIT-RTN.
002230     DISPLAY    C-CLEAR.
002240     ACCEPT     W-SYSYMD  FROM  DATE.
002250     ADD     2000  TO  W-SYSY.
002260     DISPLAY    DSP-AREA.
002270     INITIALIZE    W-DATA  W-SCR.
002280     MOVE    1   TO  W-PRNT  W-TEST.
002290 INIT-EX.
002300     EXIT.
002310*
002320*-----終了処理-----*
002330 END-RTN.
002340     IF  W-FLG NOT = 9
002350         CLOSE    SK-HAT  STENM  SNOWK  HI2-M.
002360     DISPLAY    C-CLEAR.
002370 END-EX.
002380     EXIT.
002390*
002400*-----画面処理-----*
002410 ACP-RTN.
002420 ACP-01.
002430     INITIALIZE    W-YEAR.
002440     ACCEPT     A-YEAR.
002450     DISPLAY    E-CL.
002460     IF  ESTAT = PF9
002470         MOVE     9  TO  W-FLG
002480         GO TO    ACP-EX.
002490     IF  ESTAT NOT = HTB AND SKP AND NOC
002500         GO TO    ACP-01.
002510     ADD    2000  TO  W-YEAR.
002520 ACP-02.
002530     ACCEPT    A-MONTH.
002540     IF  ESTAT = BTB
002550         GO TO    ACP-01.
002560     IF  ESTAT NOT = HTB AND SKP AND NOC
002570         GO TO    ACP-02.
002580     IF  W-MONTH > 12
002590         GO TO    ACP-02.
002600 ACP-03.
002610     ACCEPT    A-DAY.
002620     IF  ESTAT = BTB
002630         GO TO    ACP-02.
002640     IF  ESTAT NOT = HTB AND SKP
002650         GO TO    ACP-03.
002660     IF  W-YMD = "20000000"
002670         MOVE    W-SYSYMD  TO  W-YMD
002680         DISPLAY    A-YEAR  A-MONTH  A-DAY.
002690     IF  W-DAY = 00
002700         GO TO    ACP-03.
002710     IF  W-MONTH = 02
002720         IF  W-DAY > 29
002730             GO TO    ACP-03
002740         ELSE
002750             GO TO    ACP-04.
002760     IF  W-MONTH = 04 OR 06 OR 09 OR 11
002770         IF  W-DAY > 30
002780             GO TO    ACP-03
002790         ELSE
002800             GO TO    ACP-04.
002810     IF  W-MONTH = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12
002820         IF  W-DAY > 31
002830             GO TO    ACP-03
002840         END-IF
002850     ELSE
002860         GO TO    ACP-02.
002870 ACP-04.
002880     DISPLAY    A-PRNT.
002890     ACCEPT     A-PRNT.
002900     IF  ESTAT = BTB
002910         GO TO    ACP-03.
002920     IF  ESTAT NOT = HTB AND SKP
002930         GO TO    ACP-04.
002940     IF  W-PRNT NOT = 1 AND 2
002950         GO TO    ACP-04.
002960 ACP-05.
002970     DISPLAY    A-TEST.
002980     ACCEPT     A-TEST.
002990     IF  ESTAT = BTB
003000         GO TO    ACP-04.
003010     IF  ESTAT NOT = HTB AND SKP
003020         GO TO    ACP-05.
003030     IF  W-TEST NOT = 1 AND 2
003040         GO TO    ACP-05.
003050     IF  W-TEST = 1                                               I.040322
003060         PERFORM TEST-RTN THRU TEST-EX                            I.040322
003070         GO TO ACP-05.                                            I.040322
003080 ACP-06.
003090     IF  W-PRNT NOT = 2
003100         MOVE  ZERO     TO W-FROM W-TO
003110         DISPLAY C-FROM C-TO
003120         GO  TO  ACP-99.
003130*
003140     ACCEPT     A-FROM.
003150     IF  ESTAT = BTB
003160         GO TO    ACP-05.
003170     IF  ESTAT NOT = HTB AND SKP
003180         GO TO    ACP-06.
003190 ACP-07.
003200     ACCEPT     A-TO.
003210     IF  ESTAT = BTB
003220         GO TO    ACP-06.
003230     IF  ESTAT NOT = HTB AND SKP
003240         GO TO    ACP-07.
003250     IF  W-FROM > W-TO
003260         GO TO    ACP-07.
003270 ACP-99.
003280     ACCEPT    A-DDM.
003290     IF  ESTAT = BTB
003300         IF  W-PRNT NOT = 2
003310             GO TO    ACP-05
003320         ELSE
003330             GO TO    ACP-07.
003340     IF  ESTAT = PF9
003350         MOVE     9  TO  W-FLG
003360         GO TO    ACP-EX.
003370     IF  ESTAT NOT = HTB AND SKP
003380         GO TO    ACP-99.
003390     IF  W-DDM = 9
003400         MOVE     9  TO  W-FLG
003410     ELSE
003420         IF  W-DDM NOT = 1
003430             GO TO    ACP-99.                                     I.040322
003440*****        GO TO    ACP-99                                      D.040322
003450*****    ELSE                                                     D.040322
003460*****        IF  W-TEST = 1                                       D.040322
003470*****            PERFORM    TEST-RTN  THRU  TEST-EX               D.040322
003480*****            GO TO    ACP-05.                                 D.040322
003490 ACP-EX.
003500     EXIT.
003510*
003520*----出力処理-----*
003530 LST-RTN.
003540     OPEN I-O       SK-HAT.
003550     OPEN INPUT     STENM  HI2-M.
003560     OPEN OUTPUT    SNOWK.
003570     MOVE    0  TO  W-NNO  W-GNO.
003580     IF  W-PRNT = 1
003590         MOVE    0         TO  W-FLG
003600         MOVE    ZERO      TO  W-FROM
003610         MOVE    999999    TO  W-TO
003620     ELSE
003630         MOVE    1  TO  W-FLG.
003640     SELECT    SK-HAT
003650         WHERE    HAT-041 = 3241 AND HAT-03 = W-YMD
003660              AND HAT-99  = 0    AND HAT-97 = W-FLG
003670              AND HAT-01  NOT <  W-FROM
003680              AND HAT-01  NOT >  W-TO
003690         ORDER BY    HAT-04 HAT-18 HAT-01 HAT-02.
003700     MOVE    1  TO  W-FLG.
003710 LST-01.
003720     READ    SK-HAT    NEXT RECORD  WITH UNLOCK
003730         AT END    SCRATCH    SK-HAT
003740                   GO TO    LST-02.
003750     IF  NOT(HAT-04 = O-TYCD AND HAT-18 = O-KICD
003760             AND HAT-01 = O-HATNO)
003770         MOVE    HAT-04  TO  O-TYCD
003780         MOVE    HAT-18  TO  O-KICD
003790         MOVE    HAT-01  TO  O-HATNO
003800         MOVE    0  TO  W-GNO
003810         MOVE    1  TO  W-FLG.
003820     IF  HAT-11 = 0
003830         GO TO    LST-01.
003840     MOVE    HAT-07  TO  SIZE-WK-HIN.
003850     MOVE    HAT-08  TO  SIZE-WK-CD.
003860     PERFORM    SIZE-RTN  THRU  SIZE-EX.
003870     IF  SIZE-WK-SW NOT = 0
003880         GO TO    LST-01.
003890     IF  W-GNO < 6 AND W-FLG = 0
003900         ADD     1  TO  W-GNO
003910     ELSE
003920         ADD     1  TO  W-NNO
003930         MOVE    1  TO  W-GNO
003940         MOVE    0  TO  W-FLG.
003950     PERFORM    WSNOWK-RTN  THRU  WSNOWK-EX.
003960     GO TO    LST-01.
003970 LST-02.
003980     CLOSE    SNOWK.
003990     MOVE     0  TO  W-FLG.
004000     IF  W-NNO = 0
004010         DISPLAY    M-ERR01  DISP-BUZ-B
004020         CLOSE    SK-HAT  STENM  HI2-M
004030         GO TO    LST-EX.
004040     OPEN INPUT     SNOWK.
004050     OPEN OUTPUT    SP-F.
004060     READ    SNOWK    NEXT RECORD  WITH UNLOCK
004070         AT END    GO TO    LST-99.
004080     MOVE    99  TO  CNT.
004090     MOVE    SNO-03  TO  O-HATNO.
004100     MOVE    SNO-04  TO  W-GNO.
004110     PERFORM    HEAD-RTN  THRU  HEAD-EX.
004120 LST-03.
004130     INITIALIZE    W-MEI.
004140     MOVE     SNO-091  TO  M-SNO09.
004150     MOVE     SPACE    TO  SP-R.
004160     MOVE     MEI      TO  SP-R.
004170     WRITE    SP-R.
004180     INITIALIZE     W-MEI.
004190     MOVE     SNO-092  TO  M-SNO09.
004200     MOVE     SNO-10   TO  M-SNO09(11:04).
004210     MOVE     SNO-12   TO  M-SNO12.
004220     MOVE     SNO-13   TO  M-SNO13.
004230     MOVE     SNO-14   TO  M-SNO14.
004240     MOVE     SNO-15   TO  M-SNO15.
004250     MOVE     SNO-16   TO  M-SNO16.
004260     MOVE     SPACE    TO  SP-R.
004270     MOVE     MEI      TO  SP-R.
004280     WRITE    SP-R.
004290     ADD    2  TO  CNT.
004300     ADD    SNO-14  TO  W-GENKA.
004310     ADD    SNO-16  TO  W-BIKO.
004320     READ    SNOWK  NEXT RECORD  WITH UNLOCK
004330         AT END    PERFORM    RHAT-RTN  THRU  RHAT-EX
004340                   PERFORM    FOOT-RTN  THRU  FOOT-EX
004350                   GO TO    LST-99.
004360     IF  W-PRNT = 1
004370         IF  NOT(SNO-03 = O-HATNO AND SNO-04 = W-GNO)
004380             PERFORM    RHAT-RTN  THRU  RHAT-EX.                  I.040419
004390*****        PERFORM    RHAT-RTN  THRU  RHAT-EX                   D.040419
004400*****        MOVE    SNO-03  TO  O-HATNO                          D.040419
004410*****        MOVE    SNO-04  TO  W-GNO.                           D.040419
004420*****IF  W-NNO = SNO-051                                          D.040419
004430     IF  O-HATNO   =  SNO-03                                      I.040419
004440         MOVE    SNO-04  TO  W-GNO                                I.040419
004450         GO TO    LST-03
004460     ELSE
004470         PERFORM    FOOT-RTN  THRU  FOOT-EX
004480         PERFORM    HEAD-RTN  THRU  HEAD-EX
004490         MOVE    SNO-03  TO  O-HATNO                              I.040419
004500         MOVE    SNO-04  TO  W-GNO                                I.040419
004510         GO TO    LST-03.
004520 LST-99.
004530     CLOSE    SP-F.
004540 LST-EX.
004550     EXIT.
004560*
004570*-----ヘッダー印字処理-----*
004580 HEAD-RTN.
004590     IF  CNT NOT = 99
004600         MOVE     SPACE  TO  SP-R
004610         WRITE    SP-R   AFTER  PAGE.
004620     MOVE    SNO-051  TO  W-NNO.
004630     MOVE    SNO-08   TO  STE-02.
004640     READ    STENM    WITH UNLOCK
004650         INVALID KEY    INITIALIZE    STE-R.
004660     INITIALIZE    W-HEAD1.
004670     MOVE     SNO-17(01:16)  TO  H-SNO17.
004680     MOVE     SPACE    TO  SP-R.
004690     MOVE     HEAD1    TO  SP-R.
004700     WRITE    SP-R     AFTER  2.
004710     INITIALIZE    W-HEAD1.
004720     MOVE     SNO-17(17:07)  TO  H-SNO17.
004730     MOVE     SPACE    TO  SP-R.
004740     MOVE     W-HEAD1  TO  SP-R.
004750     WRITE    SP-R.
004760     MOVE     SPACE    TO  W-HEAD2.
004770     INITIALIZE    H-SYATEN  H-JYUSYO.
004780     MOVE     STE-03  TO  H-SYATEN.
004790     MOVE     NC"岡山市高柳東町１３－４６"  TO  H-JYUSYO.
004800     MOVE     SPACE   TO  SP-R.
004810     MOVE     HEAD2   TO  SP-R.
004820     WRITE    SP-R    AFTER  2.
004830*****INITIALIZE    W-HEAD2.                                       D.040415
004840     MOVE     SPACE    TO  W-HEAD2.                               I.040415
004850     INITIALIZE    H-SYATEN  H-JYUSYO.                            I.040415
004860     IF  STE-04(13:03)   NOT =  SPACE                             I.040415
004870         MOVE     STE-04(01:12)   TO  H-SYATEN                    I.040415
004880         MOVE     SPACE    TO  SP-R                               I.040415
004890         MOVE     HEAD2    TO  SP-R                               I.040415
004900         WRITE    SP-R                                            I.040415
004910         MOVE     SPACE    TO  W-HEAD2                            I.040415
004920         INITIALIZE    H-SYATEN  H-JYUSYO                         I.040415
004930         MOVE     STE-04(13:03)   TO  H-SYATEN                    I.040415
004940       ELSE                                                       I.040415
004950         MOVE     STE-04(01:12)   TO  H-SYATEN.
004960     MOVE     SNO-081  TO  H-SNO081.
004970     MOVE     STE-06   TO  H-STE06.
004980     MOVE     STE-07   TO  H-STE07.
004990     MOVE     SNO-07(03:06)  TO  H-SNO07.
005000     MOVE     STE-05   TO  H-STE05.
005010     MOVE     NC"日進ゴム株式会社　　　　"  TO  H-JYUSYO.
005020     MOVE     SPACE    TO  SP-R.
005030     MOVE     HEAD2    TO  SP-R.
005040     IF  STE-04(13:03)   NOT =  SPACE                             I.040415
005050         WRITE    SP-R                                            I.040415
005060       ELSE                                                       I.040415
005070         WRITE    SP-R     AFTER  2.
005080     MOVE     SPACE    TO  SP-R.
005090     WRITE    SP-R     AFTER  2.
005100     MOVE     ZERO     TO  W-GENKA  W-BIKO  CNT.
005110 HEAD-EX.
005120     EXIT.
005130*
005140*-----フッター印字処理-----*
005150 FOOT-RTN.
005160     MOVE     SPACE  TO  SP-R.
005170     COMPUTE    CNT = 13 - CNT.
005180     WRITE    SP-R   AFTER  CNT.
005190     INITIALIZE    W-FOOT.
005200     MOVE     W-GENKA  TO  F-GENKA.
005210     MOVE     W-BIKO   TO  F-BIKO.
005220     MOVE     SPACE    TO  SP-R.
005230     MOVE     FOOT     TO  SP-R.
005240     WRITE    SP-R.
005250     MOVE     SPACE  TO  SP-R.
005260 FOOT-EX.
005270     EXIT.
005280*
005290*-----テスト印字処理-----*
005300 TEST-RTN.
005310     OPEN OUTPUT    SP-F.
005320     INITIALIZE     W-HEAD1.
005330     MOVE     ALL "X"  TO  H-SNO17.
005340     MOVE     SPACE  TO  SP-R.
005350     MOVE     HEAD1  TO  SP-R.
005360     WRITE    SP-R   AFTER  2.
005370     INITIALIZE    W-HEAD1.
005380     MOVE     ALL "X"  TO  H-SNO17(01:07).
005390     MOVE     SPACE  TO  SP-R.
005400     MOVE     HEAD1  TO  SP-R.
005410     WRITE    SP-R.
005420     MOVE     SPACE  TO  W-HEAD2.
005430     INITIALIZE    H-SYATEN  H-JYUSYO.
005440     MOVE     ALL "X"  TO  H-SYATEN.
005450     MOVE     NC"岡山市高柳東町１３－４６"  TO  H-JYUSYO.
005460     MOVE     SPACE  TO  SP-R.
005470     MOVE     HEAD2  TO  SP-R.
005480     WRITE    SP-R   AFTER  2.
005490     INITIALIZE    W-HEAD2.
005500     MOVE     ALL "X"  TO  H-SYATEN.
005510     MOVE     ALL "9"  TO  H-STE06  H-STE07  H-SNO081
005520                           H-SNO07  H-STE05.
005530     MOVE     NC"日進ゴム株式会社　　　　"  TO  H-JYUSYO.
005540     MOVE     SPACE  TO  SP-R.
005550     MOVE     HEAD2  TO  SP-R.
005560     WRITE    SP-R   AFTER  2.
005570     MOVE     SPACE  TO  SP-R.
005580     WRITE    SP-R   AFTER  2.
005590     MOVE     1  TO  CNT.
005600 TEST-01.
005610     INITIALIZE    W-MEI.
005620     MOVE     ALL "X"  TO  M-SNO09.
005630     MOVE     SPACE  TO  SP-R.
005640     MOVE     MEI    TO  SP-R.
005650     WRITE    SP-R.
005660     INITIALIZE    W-MEI.
005670     MOVE     ALL "X"  TO  M-SNO09.
005680     MOVE     ALL "9"  TO  M-SNO12  M-SNO13  M-SNO14
005690                           M-SNO15  M-SNO16.
005700     MOVE     SPACE    TO  SP-R.
005710     MOVE     MEI      TO  SP-R.
005720     WRITE    SP-R.
005730     IF  CNT < 6
005740         ADD    1  TO  CNT
005750         GO TO     TEST-01.
005760     INITIALIZE    W-FOOT.
005770     MOVE     ALL "9"  TO  F-GENKA  F-BIKO.
005780     MOVE     SPACE  TO  SP-R.
005790     MOVE     FOOT   TO  SP-R.
005800     WRITE    SP-R   AFTER  2.
005810     MOVE     SPACE  TO  SP-R.
005820     CLOSE    SP-F.
005830 TEST-EX.
005840     EXIT.
005850*
005860*-----生協納品書ワーク１追加処理-----*
005870 WSNOWK-RTN.
005880     MOVE    HAT-04  TO  SNO-01.
005890     MOVE    HAT-18  TO  SNO-02.
005900     MOVE    HAT-01  TO  SNO-03.
005910     MOVE    HAT-02  TO  SNO-04.
005920     MOVE    W-NNO   TO  SNO-051.
005930     MOVE    W-GNO   TO  SNO-052.
005940     MOVE    HAT-10  TO  SNO-06.
005950     MOVE    HAT-03  TO  SNO-07.
005960     MOVE    HAT-06  TO  SNO-08.
005970     MOVE    HAT-09  TO  SNO-09.
005980     MOVE    SIZE-WK-NM  TO  SNO-10.
005990     MOVE    HAT-15  TO  SNO-11.
006000     MOVE    HAT-13  TO  SNO-13.
006010     MOVE    HAT-14  TO  SNO-15.
006020     MOVE    HAT-19  TO  SNO-17.
006030     MOVE    HAT-24  TO  SNO-18.
006040     IF  HAT-24 = 0
006050         MOVE    HAT-11  TO  SNO-12
006060     ELSE
006070         COMPUTE    SNO-12 = HAT-11 * (-1).
006080     COMPUTE    SNO-14 = SNO-13 * SNO-12.
006090     COMPUTE    SNO-16 = SNO-15 * SNO-12.
006100     WRITE    SNO-R.
006110     IF  ERR-STAT NOT = "00"
006120         MOVE    "W"       TO  ERR-M
006130         MOVE    "SNOWK"   TO  ERR-F
006140         MOVE    SNO-R     TO  ERR-K
006150         PERFORM    ERR-RTN  THRU  ERR-EX.
006160 WSNOWK-EX.
006170     EXIT.
006180*
006190*-----生協　発注データ修正処理-----*
006200 RHAT-RTN.
006210     MOVE    O-HATNO  TO  HAT-01.
006220     MOVE    W-GNO    TO  HAT-02.
006230     READ    SK-HAT
006240         INVALID KEY    GO TO    RHAT-EX.
006250     MOVE    1  TO  HAT-97.
006260     REWRITE    HAT-R
006270         INVALID KEY    MOVE    "R"        TO  ERR-M
006280                        MOVE    "SK-HAT"   TO  ERR-F
006290                        MOVE    HAT-KEY    TO  ERR-K
006300                        PERFORM    ERR-RTN  THRU  ERR-EX.
006310 RHAT-EX.
006320     EXIT.
006330*
006340***
006350     COPY    LPSIZC.
006360     COPY    LPMSG.
