000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JHS70L.
000030*********************************************************
000040*    PROGRAM         :  “ˆê“`•[ì¬iƒgƒ‰ƒXƒR‘¼j      *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  0=–{ŽÐ , 1=“¡“c                 *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT TDIW ASSIGN TO TDIW-MSD.
000170     SELECT TC-M ASSIGN TO TC-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE RANDOM
000200         RECORD KEY TC-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT HI2-M ASSIGN TO HI2-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE RANDOM
000250         RECORD KEY HI-KEY2
000260         FILE STATUS IS ERR-STAT.
000270     SELECT TDIF ASSIGN TO TDI-MSD
000280         ORGANIZATION INDEXED
000290         ACCESS MODE DYNAMIC
000300         RECORD KEY TDI-KEY
000310         FILE STATUS IS ERR-STAT.
000320     SELECT WTNAF ASSIGN TO WTNAF-MSD
000330         ORGANIZATION INDEXED
000340         ACCESS MODE RANDOM
000350         RECORD KEY WTNA-KEY
000360         FILE STATUS IS ERR-STAT.
000370     SELECT CODEF ASSIGN TO CODEF-RDB                             I.091228
000380         FILE STATUS IS ERR-STAT.                                 I.091228
000390     SELECT SP-F ASSIGN TO P-PRN999.
000400 I-O-CONTROL.
000410     APPLY SHARED-MODE ON WTNAF
000420     APPLY SHARED-MODE ON TC-M
000430     APPLY SHARED-MODE ON HI2-M
000440     APPLY SHARED-MODE ON CODEF                                   I.091228
000450     APPLY SHIFT-CODE  ON SP-F.
000460 DATA DIVISION.
000470 FILE SECTION.
000480     COPY LITCM.
000490     COPY LIHIM2.
000500     COPY LITDIF.
000510     COPY LRCODE.                                                 I.091228
000520 FD  TDIW                                                         I.170703
000530     BLOCK  1 RECORDS                                             I.170703
000540     LABEL RECORD IS STANDARD                                     I.170703
000550     VALUE OF IDENTIFICATION WK0256ID.                            I.170703
000560 01  TDIW-R.                                                      I.170703
000570     02  TDIW-KEY.                                                I.170703
000580       03  TDIW-DNO      PIC  9(006).                             I.170703
000590       03  TDIW-GNO      PIC  9(001).                             I.170703
000600     02  TDIW-DATE       PIC  9(006).                             I.170703
000610     02  TDIW-NGP   REDEFINES TDIW-DATE.                          I.170703
000620       03  TDIW-NEN      PIC  9(002).                             I.170703
000630       03  TDIW-GET      PIC  9(002).                             I.170703
000640       03  TDIW-PEY      PIC  9(002).                             I.170703
000650     02  TDIW-CYO        PIC  9(007).                             I.170703
000660     02  TDIW-CYOD  REDEFINES TDIW-CYO.                           I.170703
000670       03  TDIW-TCD      PIC  9(004).                             I.170703
000680       03  TDIW-CCD      PIC  9(003).                             I.170703
000690     02  TDIW-TPC        PIC  9(004).                             I.170703
000700     02  TDIW-HCD        PIC  9(006).                             I.170703
000710     02  TDIW-SIZ        PIC  X(003).                             I.170703
000720     02  TDIW-SKB        PIC  9(001).                             I.170703
000730     02  TDIW-SNO        PIC  9(002).                             I.170703
000740     02  TDIW-SU         PIC S9(005).                             I.170703
000750     02  TDIW-GT         PIC  9(007).                             I.170703
000760     02  TDIW-UT         PIC  9(007).                             I.170703
000770     02  TDIW-GKIN       PIC S9(008).                             I.170703
000780     02  TDIW-UKIN       PIC S9(008).                             I.170703
000790     02  TDIW-JNOD.                                               I.170703
000800       03  TDIW-JNO      PIC  9(006).                             I.170703
000810       03  TDIW-JGN      PIC  9(001).                             I.170703
000820     02  TDIW-SOK        PIC  9(001).                             I.170703
000830     02  TDIW-UNS        PIC  9(001).                             I.170703
000840     02  TDIW-ISU        PIC  9(003).                             I.170703
000850     02  TDIW-HNO        PIC  X(010).                             I.170703
000860     02  TDIW-TEKI       PIC  N(028).                             I.170703
000870     02  TDIW-TED   REDEFINES TDIW-TEKI.                          I.170703
000880       03  TDIW-THT      PIC  N(009).                             I.170703
000890       03  TDIW-TTE      PIC  N(019).                             I.170703
000900     02  TDIW-TRN        PIC  X(020).                             I.170703
000910     02  TDIW-JAN        PIC  X(013).                             I.170703
000920     02  TDIW-UTC        PIC  9(001).                             I.170703
000930     02  F              PIC  X(051).                              I.170703
000940     02  TDIW-NNGP       PIC  9(006).                             I.170703
000950     02  TDIW-NHMS       PIC  9(006).                             I.170703
000960     02  F              PIC  X(008).                              I.170703
000970     02  TDIW-PRC        PIC  9(001).                             I.170703
000980     02  TDIW-UPC        PIC  9(001).                             I.170703
000990 FD  WTNAF
001000     BLOCK  4 RECORDS
001010     LABEL RECORD IS STANDARD
001020     VALUE OF IDENTIFICATION "WTNAF".
001030 01  WTNA-R.
001040     02  WTNA-KEY.
001050*****  03  WTNA-TNC     PIC  9(003).                              D.101018
001060       03  WTNA-TNC     PIC  9(004).                              I.101018
001070     02  WTNA-NAME      PIC  N(026).
001080     02  F              PIC  X(008).                              I.101018
001090*****02  F              PIC  X(009).                              D.101018
001100 FD  SP-F
001110     LABEL RECORD OMITTED
001120     LINAGE IS 30 LINES.
001130 01  SP-R               PIC  X(136).
001140 WORKING-STORAGE  SECTION.
001150 77  ERR-STAT           PIC  X(002).
001160 77  W-FILE             PIC  X(013).
001170 77  JS-SIGN            PIC  9(001).                              I.091102
001180 77  W-END              PIC  9(001) VALUE 0.
001190 77  W-POC              PIC  9(001) VALUE 0.                      I.091102
001200 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
001210 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
001220 77  WK0256ID           PIC  X(009) VALUE SPACE.                  I.170703
001230 01  STN-NO.                                                      I.170703
001240     02  STN-NO1        PIC  X(003).                              I.170703
001250     02  STN-NO2        PIC  X(003).                              I.170703
001260 01  W-FID.                                                       I.170703
001270     02  W-FID1         PIC  X(006) VALUE "WK0256".               I.170703
001280     02  W-FID2         PIC  X(003).                              I.170703
001290 01  W-P01.
001300     02  P-20K1         PIC  X(005).
001310*****02  F              PIC  X(008).                              D.091211
001320     02  F              PIC  X(009).                              I.091211
001330     02  P-NAME         PIC  X(010).
001340     02  F              PIC  X(080).
001350 01  W-P02.
001360     02  P-15K2         PIC  X(005).
001370*****02  F              PIC  X(006).                              D.091211
001380     02  F              PIC  X(007).                              I.091211
001390     02  P-TNA          PIC  N(014).
001400     02  P-TNAD  REDEFINES P-TNA.
001410       03  F            PIC  N(002).
001420       03  P-TNAU       PIC  N(012).
001430     02  F              PIC  X(003).
001440     02  P-SCD          PIC  9(002).
001450*****02  F              PIC  X(003).                              D.101018
001460*****02  P-MCD          PIC  9(003).                              D.101018
001470     02  F              PIC  X(002).                              I.101018
001480     02  P-TPC          PIC  9(004).                              I.101018
001490     02  P-MCDD  REDEFINES P-TPC.                                 I.101018
001500       03  F            PIC  9(001).                              I.101018
001510       03  P-MCD        PIC  9(003).                              I.101018
001520     02  F              PIC  X(003).
001530*****02  P-BRC          PIC  9(003).                              D.120209
001540*****02  F              PIC  X(002).                              D.120209
001550     02  P-BRC          PIC  Z(004).                              I.120209
001560     02  F              PIC  X(001).                              I.120209
001570     02  P-DPC          PIC  X(002).
001580     02  F              PIC  X(001).                              I.100222
001590     02  P-DNO          PIC  9(006).                              I.100222
001600     02  P-DNO0         PIC  9(001).                              I.100222
001610     02  F              PIC  X(001).                              I.100222
001620*****02  F              PIC  X(009).                              D.100222
001630     02  P-THC          PIC  9(006).
001640     02  F              PIC  X(005).
001650     02  P-NR           PIC  N(006).
001660     02  F              PIC  X(011).
001670     02  P-NNEN         PIC  9(002).
001680     02  P-NGETD        PIC  9(002).                              I.120220
001690     02  P-AGET  REDEFINES P-NGETD.                               I.120220
001700       03  P-NGET       PIC Z9.                                   I.120220
001710     02  P-NPEYD        PIC  9(002).                              I.120220
001720     02  P-APEY  REDEFINES P-NPEYD.                               I.120220
001730       03  P-NPEY       PIC Z9.                                   I.120220
001740*****02  P-NGET         PIC Z9.                                   D.120220
001750*****02  P-NPEY         PIC Z9.                                   D.120220
001760     02  F              PIC  X(004).
001770     02  P-20K2         PIC  X(005).
001780 01  W-P03.
001790     02  P-15K3         PIC  X(005).
001800*****02  F              PIC  X(006).                              D.091211
001810     02  F              PIC  X(007).                              I.091211
001820     02  P-HNA          PIC  N(016).
001830     02  P-HNAD  REDEFINES P-HNA.
001840       03  F            PIC  N(008).
001850       03  P-HNAU       PIC  N(008).
001860*****02  F              PIC  X(014).                              D.091102
001870     02  F              PIC  X(006).                              I.091102
001880     02  P-SHC          PIC  X(008).                              I.091105
001890*****02  P-SHC          PIC  X(007).                              D.091105
001900*****02  F              PIC  X(001).                              D.091105
001910     02  P-COR          PIC  N(004).
001920     02  F              PIC  X(001).
001930     02  P-SIZ          PIC  X(004).
001940     02  P-SU           PIC  Z(006).
001950     02  F              PIC  X(005).
001960     02  P-GTN          PIC  Z(006).
001970     02  F              PIC  X(002).
001980     02  P-GKIN         PIC  Z(009).
001990     02  P-UTN          PIC  Z(006).
002000     02  P-UKIN         PIC  Z(009).
002010     02  P-20K3         PIC  X(005).
002020 01  W-DATA.
002030*****02  W-POC          PIC  9(001).                              D.091102
002040     02  W-TPC          PIC  9(001).
002050     02  W-HKC          PIC  9(001).
002060     02  W-SEN          PIC  9(001).
002070     02  W-SED.
002080*****  03  W-SDNO       PIC  9(006).                              D.170703
002090*****  03  W-EDNO       PIC  9(006).                              D.170703
002100       03  W-SNGP       PIC  9(006).                              I.170703
002110       03  W-ENGP       PIC  9(006).                              I.170703
002120       03  W-SCYO       PIC  9(007).                              I.170703
002130       03  W-ECYO       PIC  9(007).                              I.170703
002140       03  W-STPC       PIC  9(004).                              I.170703
002150       03  W-ETPC       PIC  9(004).                              I.170703
002160     02  W-DMM          PIC  9(001).
002170     02  W-NGP          PIC  9(006).                              I.170703
002180     02  W-NGPD  REDEFINES W-NGP.                                 I.170703
002190       03  W-NEN        PIC  9(002).                              I.170703
002200       03  W-GET        PIC  9(002).                              I.170703
002210       03  W-PEY        PIC  9(002).                              I.170703
002220     02  W-CYO          PIC  9(007).                              I.170703
002230     02  W-CYOD  REDEFINES W-CYO.                                 I.170703
002240       03  W-TCD        PIC  9(004).                              I.170703
002250       03  W-CCD        PIC  9(003).                              I.170703
002260     02  W-DNO          PIC  9(006).
002270     02  W-DNO0         PIC  9(001).                              I.121128
002280     02  W-HNO          PIC  X(010).
002290     02  W-TNA          PIC  N(026).
002300     02  W-TNAD  REDEFINES W-TNA.
002310       03  W-TNAO       PIC  N(014).
002320       03  W-TNAU       PIC  N(012).
002330     02  WT-D.
002340       03  WT-SU        PIC  9(006).
002350       03  WT-GKIN      PIC  9(009).
002360       03  WT-UKIN      PIC  9(009).
002370     02  W-INV          PIC  9(001).
002380     02  W-LC           PIC  9(002).
002390     02  W-NC1          PIC  9(002).
002400     02  W-NC2          PIC  9(002).
002410     02  W-ANA          PIC  N(024).
002420     02  W-ANAD  REDEFINES W-ANA.
002430       03  W-NAD   OCCURS  24.
002440         04  W-NA       PIC  N(001).
002450     02  W-AHNA         PIC  N(024).
002460     02  W-AHNAD REDEFINES W-AHNA.
002470       03  W-HNAD   OCCURS  24.
002480         04  W-HNA      PIC  N(001).
002490     02  W-AHMD  REDEFINES W-AHNA.
002500       03  W-HMD1       PIC  N(016).
002510       03  W-HMD2       PIC  N(008).
002520     02  W-ACOR         PIC  N(008).
002530     02  W-ACORD REDEFINES W-ACOR.
002540       03  W-CORD   OCCURS   8.
002550         04  W-COR      PIC  N(001).
002560     02  W-ACRD REDEFINES W-ACOR.
002570       03  W-CR1        PIC  N(004).
002580       03  W-CR2        PIC  N(004).
002590     02  W-SHC          PIC  X(008).                              I.091228
002600     02  W-SC           PIC  9(002).
002610     02  W-ASZD.
002620       03  W-SZD   OCCURS  34.
002630         04  W-SZ       PIC  X(003).
002640     02  W-MSZ.
002650       03  F            PIC  X(045) VALUE
002660            "SS S  M  L  LL XL XXL125130135140150160170180".
002670       03  F            PIC  X(045) VALUE
002680            "190200210215220225230235240245250255260265270".
002690       03  F            PIC  X(012) VALUE
002700            "275280290300".
002710     02  W-ASIZD.
002720       03  W-SIZD  OCCURS  34.
002730         04  W-SIZ      PIC  X(004).
002740     02  W-MSIZ.
002750       03  F            PIC  X(048) VALUE
002760            "SS  S   M   L   LL  XL  XXL 12.513.013.514.015.0".
002770       03  F            PIC  X(048) VALUE
002780            "16.017.018.019.020.021.021.522.022.523.023.524.0".
002790       03  F            PIC  X(040) VALUE
002800            "24.525.025.526.026.527.027.528.029.030.0".
002810     COPY LSTAT.
002820 SCREEN SECTION.
002830 SD  C-CRT
002840     END STATUS IS ESTAT.
002850 01  C-CLEAR.
002860     02  C-CL    LINE   1  CLEAR SCREEN.
002870 01  C-MID.
002880     02  LINE   1  COLUMN  20  PIC  N(014) VALUE
002890          NC"ƒ`ƒF[ƒ“ƒXƒgƒA“ˆê“`•[@”­s".
002900     02  LINE   2  COLUMN  20  PIC  N(013) VALUE
002910          NC"iƒ^ƒCƒv—p‚PŒ^j".
002920     02  LINE   4  COLUMN  10  PIC  N(007) VALUE
002930          NC"yƒgƒ‰ƒXƒR‘¼z".
002940     02  LINE   7  COLUMN  22  PIC  X(035) VALUE
002950          "ƒeƒXƒgƒvƒŠƒ“ƒgˆóŽš (YES=1,NO=9) [ ]".
002960     02  LINE  10  COLUMN  22  PIC  X(010) VALUE
002970          "‚PD”­@s".
002980     02  LINE  11  COLUMN  22  PIC  X(018) VALUE
002990          "‚QDÄ”­s     [ ]".
003000     02  LINE  23  COLUMN  43  PIC  X(028) VALUE
003010          "Šm”F (OK=1,NO=9) --->   ØÀ°Ý".
003020 01  C-ACP.
003030     02  A-TPC   LINE   7  COLUMN  55  PIC  9(001)
003040          USING W-TPC   CHECK OVERFLOW NO IFC.
003050     02  A-HKC   LINE  11  COLUMN  38  PIC  9(001)
003060          USING W-HKC   CHECK OVERFLOW NO IFC.
003070*****02  A-SDNO  LINE  15  COLUMN  34  PIC  9(006)                D.170703
003080*****     USING W-SDNO  CHECK OVERFLOW NO IFC.                    D.170703
003090*****02  A-EDNO  LINE  16  COLUMN  34  PIC  9(006)                D.170703
003100*****     USING W-EDNO  CHECK OVERFLOW NO IFC.                    D.170703
003110     02  LINE  15.                                                I.170703
003120       03  A-SNGP  COLUMN  34  PIC  9(006)                        I.170703
003130            USING W-SNGP  CHECK OVERFLOW NO IFC.                  I.170703
003140       03  A-SCYO  COLUMN  45  PIC  9(007)                        I.170703
003150            USING W-SCYO  CHECK OVERFLOW NO IFC.                  I.170703
003160       03  A-STPC  COLUMN  61  PIC  9(004)                        I.170703
003170            USING W-STPC  CHECK OVERFLOW NO IFC.                  I.170703
003180     02  LINE  16.                                                I.170703
003190       03  A-ENGP  COLUMN  34  PIC  9(006)                        I.170703
003200            USING W-ENGP  CHECK OVERFLOW NO IFC.                  I.170703
003210       03  A-ECYO  COLUMN  45  PIC  9(007)                        I.170703
003220            USING W-ECYO  CHECK OVERFLOW NO IFC.                  I.170703
003230       03  A-ETPC  COLUMN  61  PIC  9(004)                        I.170703
003240            USING W-ETPC  CHECK OVERFLOW NO IFC.                  I.170703
003250     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
003260          USING W-DMM   CHECK OVERFLOW NO IFC.
003270 01  C-DSP.
003280     02  D-SHM.
003290*****  03  LINE  14  COLUMN  33  PIC  N(004) VALUE                D.170703
003300*****       NC"“`•[”Ô†".                                         D.170703
003310       03  LINE  14  COLUMN  33  PIC  N(004) VALUE                I.170703
003320            NC"@“ú•t@".                                         I.170703
003330       03  LINE  14  COLUMN  44  PIC  X(010) VALUE                I.170703
003340              "’¼‘—æº°ÄÞ".                                       I.170703
003350       03  LINE  14  COLUMN  57  PIC  X(015) VALUE                I.170703
003360              "“X–¼º°ÄÞ(Ü°¸ÏÝ)".                                  I.170703
003370       03  LINE  15  COLUMN  22  PIC  N(004) VALUE
003380            NC"‚e‚q‚n‚l".
003390       03  LINE  16  COLUMN  22  PIC  N(002) VALUE
003400            NC"‚s‚n".
003410     02  D-SHMC.
003420       03  LINE  14  COLUMN  33  PIC  X(008) VALUE
003430            "      ".
003440       03  LINE  14  COLUMN  44  PIC  X(010) VALUE                I.170703
003450            "          ".                                         I.170703
003460       03  LINE  14  COLUMN  57  PIC  X(015) VALUE                I.170703
003470            "               ".                                    I.170703
003480       03  LINE  15  COLUMN  34  PIC  X(045) VALUE                I.170703
003490            "                                             ".      I.170703
003500       03  LINE  16  COLUMN  34  PIC  X(045) VALUE                I.170703
003510            "                                             ".      I.170703
003520*****  03  LINE  15  COLUMN  22  PIC  X(028) VALUE                D.170703
003530*****       "                    ".                               D.170703
003540*****  03  LINE  16  COLUMN  22  PIC  X(028) VALUE                D.170703
003550*****       "                    ".                               D.170703
003560 01  C-ERR.
003570     02  LINE  24.
003580       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
003590            "***  DATA Å¼  ***".
003600       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
003610            "***  DATA ´×°  ***".
003620       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
003630            "***  Ä¸²»· Å¼  ***".
003640       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
003650            "***  Á®¸¿³»· Å¼  ***".
003660       03  E-ME5   COLUMN  15  PIC  X(017) VALUE
003670            "***  ËÝÒ² Å¼  ***".
003680       03  E-ME6   COLUMN  15  PIC  X(017) VALUE
003690            "***  »²½Þ Å¼  ***".
003700       03  E-ME7   COLUMN  15  PIC  X(017) VALUE
003710            "***  ÃÝÒ² Å¼  ***".
003720       03  E-ME11  COLUMN  15  PIC  X(026) VALUE
003730            "***  TDIF REWRITE ´×°  ***".
003740     COPY LSSEM.
003750 PROCEDURE DIVISION.
003760 M-00.
003770     ACCEPT JS-SIGN.                                              I.091102
003780     IF JS-SIGN > 1                                               I.091102
003790         GO TO M-95.                                              I.091102
003800     DISPLAY C-CLEAR.
003810     DISPLAY C-MID.
003820*****MOVE 0 TO W-POC.                                             D.091102
003830*M-01.                                                            D.091217
003840*****ACCEPT A-TPC.                                                D.091217
003850     PERFORM ACP-RTN THRU ACP-EX.                                 I.091217
003860     IF ESTAT = PF9
003870         GO TO M-95.
003880*****IF ESTAT NOT = HTB AND SKP                                   D.091217
003890*****    GO TO M-01.                                              D.091217
003900*****IF W-TPC = 9                                                 D.091217
003910*****    GO TO M-02.                                              D.091217
003920*****IF W-TPC NOT = 1                                             D.091217
003930*****    GO TO M-01.                                              D.091217
003940*****PERFORM TST-RTN THRU TST-EX.                                 D.091217
003950*****GO TO M-01.                                                  D.091217
003960*M-02.                                                            D.091217
003970*****ACCEPT A-HKC.                                                D.091217
003980*****IF ESTAT = BTB                                               D.091217
003990*****    GO TO M-01.                                              D.091217
004000*****IF ESTAT NOT = HTB AND SKP                                   D.091217
004010*****    GO TO M-02.                                              D.091217
004020*****IF W-HKC = 1                                                 D.091217
004030*****    DISPLAY D-SHMC                                           D.091217
004040*****    GO TO M-05.                                              D.091217
004050*****IF W-HKC NOT = 2                                             D.091217
004060*****    GO TO M-02.                                              D.091217
004070*****DISPLAY D-SHM.                                               D.091217
004080*M-03.                                                            D.091217
004090*****ACCEPT A-SDNO.                                               D.091217
004100*****IF ESTAT = BTB                                               D.091217
004110*****    GO TO M-02.                                              D.091217
004120*****IF ESTAT NOT = HTB AND SKP                                   D.091217
004130*****    GO TO M-03.                                              D.091217
004140*M-04.                                                            D.091217
004150*****ACCEPT A-EDNO.                                               D.091217
004160*****IF ESTAT = BTB                                               D.091217
004170*****    GO TO M-03.                                              D.091217
004180*****IF ESTAT NOT = HTB AND SKP                                   D.091217
004190*****    GO TO M-04.                                              D.091217
004200*****IF W-SDNO > W-EDNO                                           D.091217
004210*****    GO TO M-04.                                              D.091217
004220*M-05.                                                            D.091217
004230*****ACCEPT A-DMM.                                                D.091217
004240*****IF ESTAT = BTB                                               D.091217
004250*****    IF W-HKC = 1                                             D.091217
004260*****        GO TO M-02                                           D.091217
004270*****      ELSE                                                   D.091217
004280*****        GO TO M-04.                                          D.091217
004290*****IF ESTAT NOT = HTB AND SKP                                   D.091217
004300*****    GO TO M-05.                                              D.091217
004310*****IF W-DMM = 9                                                 D.091217
004320*****    GO TO M-02.                                              D.091217
004330*****IF W-DMM NOT = 1                                             D.091217
004340*****    GO TO M-05.                                              D.091217
004350*
004360*****IF W-HKC = 1                                                 D.170703
004370*****    OPEN I-O TDIF                                            D.170703
004380*****    GO TO M-10.                                              D.170703
004390*****OPEN INPUT TDIF                                              D.170703
004400*****MOVE ZERO TO TDI-KEY.                                        D.170703
004410*****MOVE W-SDNO TO TDI-DNO.                                      D.170703
004420*****START TDIF KEY NOT < TDI-KEY INVALID KEY                     D.170703
004430*****    CLOSE TDIF                                               D.170703
004440*****    DISPLAY E-ME1 E-ME99                                     D.170703
004450*****    GO TO M-95.                                              D.170703
004460     CALL "CBLSTNNO" USING STN-NO.                                I.170703
004470     MOVE STN-NO2 TO W-FID2.                                      I.170703
004480     MOVE W-FID TO WK0256ID.                                      I.170703
004490     OPEN INPUT TDIW.                                             I.170703
004500 M-10.
004510*****READ TDIF NEXT RECORD WITH UNLOCK AT END                     D.170703
004520*****    CLOSE TDIF                                               D.170703
004530     READ TDIW AT END                                             I.170703
004540         DISPLAY E-ME1 E-ME99
004550         GO TO M-95.
004560*****IF TDI-TCD = 5000                                            D.170703
004570     IF TDIW-TCD = 5000                                           I.170703
004580         GO TO M-10.                                              I.091102
004590*****IF TDI-SOK NOT = 1                                           D.091102
004600*****    GO TO M-10.                                              D.091102
004610     IF W-HKC = 1
004620*****    IF TDI-PRC = 9                                           D.170703
004630         IF TDIW-PRC = 9                                          I.170703
004640             GO TO M-10.
004650*****IF W-HKC = 2                                                 D.170703
004660*****    IF TDI-DNO > W-EDNO                                      D.170703
004670*****        CLOSE TDIF                                           D.170703
004680*****        DISPLAY E-ME1 E-ME99                                 D.170703
004690*****        GO TO M-95.                                          D.170703
004700     IF W-HKC = 2
004710*****    IF TDI-PRC NOT = 9                                       D.170703
004720         IF TDIW-PRC NOT = 9                                      I.170703
004730             GO TO M-10.
004740     IF W-HKC = 2
004750*****    IF (TDIW-DATE < W-SNGP AND > W-ENGP) OR                  D.170915
004760*****       (TDIW-CYO < W-SCYO AND > W-ECYO) OR                   D.170915
004770*****       (TDIW-TPC < W-STPC AND > W-ETPC)                      D.170915
004780         IF (TDIW-DATE < W-SNGP OR > W-ENGP) OR                   I.170915
004790            (TDIW-CYO < W-SCYO OR > W-ECYO) OR                    I.170915
004800            (TDIW-TPC < W-STPC OR > W-ETPC)                       I.170915
004810             GO TO M-10.                                          I.170703
004820     IF JS-SIGN = 0                                               I.091102
004830         IF W-HKC = 1                                             I.091102
004840*****        IF TDI-TCD NOT = 6010                                D.170703
004850*****            IF TDI-SOK NOT = 1                               D.170703
004860             IF TDIW-TCD NOT = 6010                               I.170703
004870                 IF TDIW-SOK NOT = 1                              I.170703
004880                     GO TO M-10.                                  I.080702
004890*****OPEN INPUT TC-M HI2-M WTNAF.                                 D.091228
004900     IF W-HKC = 1                                                 I.170703
004910         OPEN I-O TDIF.                                           I.170703
004920     OPEN INPUT TC-M HI2-M WTNAF CODEF.                           I.091228
004930     MOVE W-MSZ TO W-ASZD.
004940     MOVE W-MSIZ TO W-ASIZD.
004950 M-15.
004960*****MOVE TDI-DNO TO W-DNO.                                       D.170703
004970*****MOVE TDI-HNO TO W-HNO.                                       D.170703
004980     MOVE TDIW-DNO TO W-DNO.                                      I.170703
004990     MOVE TDIW-HNO TO W-HNO.                                      I.170703
005000     MOVE ZERO TO WT-D.
005010*
005020     IF W-POC = 0
005030         OPEN OUTPUT SP-F
005040         MOVE 1 TO W-POC
005050       ELSE
005060         MOVE SPACE TO SP-R
005070         WRITE SP-R AFTER PAGE.
005080     MOVE SPACE TO SP-R.
005090*****IF TDI-TCD = 9850                                            D.170703
005100     IF TDIW-TCD = 9850                                           I.170703
005110         MOVE SPACE TO W-P01
005120         MOVE W-20K TO P-20K1
005130         MOVE "ÀÑ× " TO P-NAME                                    I.170706
005140*****    MOVE "ÓØÜ¹" TO P-NAME                                    D.170706
005150         MOVE W-P01 TO SP-R.
005160     WRITE SP-R AFTER 2.
005170     MOVE SPACE TO SP-R.
005180*
005190*****MOVE TDI-TCD TO TC-TCD.                                      D.170703
005200     MOVE TDIW-TCD TO TC-TCD.                                     I.170703
005210     MOVE 001 TO TC-CCD.
005220     READ TC-M WITH UNLOCK INVALID KEY
005230         DISPLAY E-ME3 E-ME99
005240         DISPLAY E-CL
005250         MOVE SPACE TO TC-NAME.
005260     MOVE SPACE TO W-TNA.
005270     MOVE TC-NAME TO W-TNA.
005280*
005290     MOVE SPACE TO W-P02.
005300     MOVE W-15K TO P-15K2.
005310     MOVE W-20K TO P-20K2.
005320     MOVE SPACE TO P-TNA.
005330     MOVE W-TNAO TO P-TNA.
005340     MOVE SPACE TO P-NR.
005350     MOVE SPACE TO SP-R.
005360     MOVE W-P02 TO SP-R.
005370     WRITE SP-R AFTER 3.
005380     MOVE SPACE TO SP-R.
005390*
005400     MOVE SPACE TO W-P02.
005410     MOVE W-15K TO P-15K2.
005420     MOVE W-20K TO P-20K2.
005430     MOVE SPACE TO P-TNA P-NR.
005440     IF W-TNAU NOT = SPACE
005450         MOVE W-TNAU TO P-TNAU.
005460     MOVE NC"“úiƒSƒ€‡Š" TO P-NR.
005470     MOVE SPACE TO SP-R.
005480     MOVE W-P02 TO SP-R.
005490     WRITE SP-R.
005500     MOVE SPACE TO SP-R.
005510*
005520     MOVE SPACE TO W-TNA.
005530*****IF TDI-TCD NOT = 9850                                        D.170703
005540     IF TDIW-TCD NOT = 9850                                       I.170703
005550         GO TO M-20.
005560*****IF TDI-TPC = ZERO OR 999                                     D.170703
005570     IF TDIW-TPC = ZERO OR 999                                    I.170703
005580         GO TO M-20.
005590*****MOVE TDI-TPC TO WTNA-KEY.                                    D.170703
005600     MOVE TDIW-TPC TO WTNA-KEY.                                   I.170703
005610     READ WTNAF WITH UNLOCK INVALID KEY
005620         DISPLAY E-ME7 E-ME99
005630         DISPLAY E-CL
005640         MOVE SPACE TO WTNA-NAME.
005650     MOVE WTNA-NAME TO W-TNA.
005660     GO TO M-25.
005670 M-20.
005680*****MOVE TDI-TCD TO TC-TCD.                                      D.170703
005690*****MOVE TDI-CCD TO TC-CCD.                                      D.170703
005700     MOVE TDIW-TCD TO TC-TCD.                                     I.170703
005710     MOVE TDIW-CCD TO TC-CCD.                                     I.170703
005720     READ TC-M WITH UNLOCK INVALID KEY
005730         DISPLAY E-ME4 E-ME99
005740         DISPLAY E-CL
005750         MOVE SPACE TO TC-NAME.
005760     MOVE TC-NAME TO W-TNA.
005770 M-25.
005780     MOVE SPACE TO W-P02.
005790     MOVE W-15K TO P-15K2.
005800     MOVE W-20K TO P-20K2.
005810     MOVE SPACE TO P-TNA P-NR.
005820     MOVE W-TNAO TO P-TNA.
005830*****IF TDI-TCD = 6010                                            D.170703
005840     IF TDIW-TCD = 6010                                           I.170703
005850         MOVE 4440 TO P-BRC                                       I.120209
005860         MOVE "01" TO P-DPC                                       I.120209
005870         MOVE 351374 TO P-THC                                     I.120209
005880*****    IF TDI-CCD = 007                                         D.170703
005890         IF TDIW-CCD = 007                                        I.170703
005900             MOVE 727 TO P-MCD                                    I.120209
005910             GO TO M-30                                           I.120209
005920           ELSE                                                   I.120209
005930             MOVE 702 TO P-MCD                                    I.120209
005940             GO TO M-30.                                          I.120209
005950*****IF TDI-TCD NOT = 9850                                        D.170703
005960     IF TDIW-TCD NOT = 9850                                       I.170703
005970         GO TO M-30.                                              I.091102
005980     MOVE 07 TO P-SCD.                                            I.091102
005990     MOVE TDIW-TPC TO P-TPC.                                      I.170703
006000*****MOVE TDI-TPC TO P-TPC.                                       D.170703
006010*****MOVE TDI-TPC TO P-MCD.                                       D.101018
006020*****IF TDI-TPC = 901                                             D.101018
006030*****    MOVE 900 TO P-MCD.                                       D.101018
006040*****IF TDI-TPC = 9001                                            D.170703
006050     IF TDIW-TPC = 9001                                           I.170703
006060         MOVE 9000 TO P-TPC.                                      I.101018
006070     MOVE "AA" TO P-DPC.                                          I.091102
006080*****IF TDI-TCD = 9850                                            D.091102
006090*****    MOVE 07 TO P-SCD                                         D.091102
006100*****    MOVE TDI-TPC TO P-MCD                                    D.091102
006110*****    MOVE "AA" TO P-DPC                                       D.091102
006120*****IF TDI-CCD NOT = 900                                         D.091105
006130*****IF TDI-CCD NOT = 900 AND 901                                 D.170703
006140     IF TDIW-CCD NOT = 900 AND 901                                I.170703
006150         MOVE 976318 TO P-THC
006160       ELSE                                                       I.091102
006170         MOVE 732974 TO P-THC.                                    I.091102
006180*****IF TDI-TPC = 999                                             D.101018
006190*****IF TDI-TPC = 9999                                            D.170703
006200     IF TDIW-TPC = 9999                                           I.170703
006210         MOVE 901 TO P-BRC
006220       ELSE
006230         MOVE 501 TO P-BRC.
006240 M-30.                                                            I.091102
006250*****MOVE TDI-DNO TO P-DNO.                                       D.170703
006260*****IF TDI-TCD = 6010                                            D.170703
006270*****    COMPUTE W-DNO0 = TDI-DNO - ((TDI-DNO / 7) * 7)           D.170703
006280     MOVE TDIW-DNO TO P-DNO.                                      I.170703
006290     IF TDIW-TCD = 6010                                           I.170703
006300         COMPUTE W-DNO0 = TDIW-DNO - ((TDIW-DNO / 7) * 7)         I.170703
006310         MOVE W-DNO0 TO P-DNO0                                    I.121128
006320       ELSE                                                       I.121128
006330         MOVE 0 TO P-DNO0.                                        I.100222
006340*****MOVE TDI-NEN TO P-NNEN.                                      D.170703
006350*****IF TDI-TCD = 6010                                            D.170703
006360*****    MOVE TDI-GET TO P-NGETD                                  D.170703
006370*****    MOVE TDI-PEY TO P-NPEYD                                  D.170703
006380     MOVE TDIW-NEN TO P-NNEN.                                     I.170703
006390     IF TDIW-TCD = 6010                                           I.170703
006400         MOVE TDIW-GET TO P-NGETD                                 I.170703
006410         MOVE TDIW-PEY TO P-NPEYD                                 I.170703
006420       ELSE                                                       I.120220
006430         MOVE TDIW-GET TO P-NGET                                  I.170703
006440         MOVE TDIW-PEY TO P-NPEY.                                 I.170703
006450*****MOVE TDI-GET TO P-NGET.                                      D.120220
006460*****    MOVE TDI-GET TO P-NGET                                   D.170703
006470*****    MOVE TDI-PEY TO P-NPEY.                                  D.170703
006480     MOVE SPACE TO SP-R.
006490     MOVE W-P02 TO SP-R.
006500     WRITE SP-R.
006510     MOVE SPACE TO SP-R.
006520*
006530     IF W-TNAU NOT = SPACE
006540         MOVE SPACE TO W-P02
006550         MOVE W-15K TO P-15K2
006560         MOVE W-20K TO P-20K2
006570         MOVE SPACE TO P-TNA P-NR
006580         MOVE W-TNAU TO P-TNAU
006590         MOVE SPACE TO SP-R
006600         MOVE W-P02 TO SP-R.
006610     WRITE SP-R.
006620     MOVE SPACE TO SP-R.
006630     WRITE SP-R AFTER 2.
006640*
006650     MOVE 14 TO W-LC.
006660 M-35.
006670     PERFORM NAM-RTN THRU NAM-EX.
006680*****IF TDI-SIZ NOT = 000                                         D.170703
006690     IF TDIW-SIZ NOT = 000                                        I.170703
006700         PERFORM SIZ-RTN THRU SIZ-EX.
006710     MOVE SPACE TO W-SHC.                                         I.091228
006720*****IF TDI-TCD NOT = 9850                                        D.170703
006730     IF TDIW-TCD NOT = 9850                                       I.170703
006740         GO TO M-37.                                              I.091228
006750     CLOSE CODEF.                                                 I.091228
006760     OPEN INPUT CODEF.                                            I.091228
006770*****SELECT CODEF WHERE TDI-TCD = CODE-TCD AND                    D.170703
006780*****                   TDI-HCD = CODE-HCD AND                    D.170703
006790*****                   TDI-SKB = CODE-SIZ AND                    D.170703
006800*****                   TDI-SNO = CODE-SNO.                       D.170703
006810     SELECT CODEF WHERE TDIW-TCD = CODE-TCD AND                   I.170703
006820                        TDIW-HCD = CODE-HCD AND                   I.170703
006830                        TDIW-SKB = CODE-SIZ AND                   I.170703
006840                        TDIW-SNO = CODE-SNO.                      I.170703
006850     READ CODEF AT END SCRATCH CODEF                              I.091228
006860          MOVE SPACE TO CODE-JAN.                                 I.091228
006870     MOVE CODE-JAN TO W-SHC.                                      I.091228
006880     IF W-SHC = 00000000                                          I.091228
006890         MOVE SPACE TO W-SHC.                                     I.091228
006900 M-37.                                                            I.091228
006910     MOVE SPACE TO W-P03.
006920     MOVE W-15K TO P-15K3.
006930     MOVE W-20K TO P-20K3.
006940     MOVE SPACE TO P-HNA P-COR.
006950     IF (W-HMD2 = SPACE) AND (W-CR2 = SPACE)
006960         GO TO M-40.
006970     IF W-HMD2 NOT = SPACE
006980         MOVE W-HMD1 TO P-HNA.
006990     IF W-CR2 NOT = SPACE
007000         MOVE W-CR1 TO P-COR.
007010 M-40.
007020     MOVE SPACE TO SP-R.
007030     MOVE W-P03 TO SP-R.
007040     WRITE SP-R.
007050     MOVE SPACE TO SP-R.
007060*
007070     MOVE SPACE TO W-P03.
007080     MOVE W-15K TO P-15K3.
007090     MOVE W-20K TO P-20K3.
007100     MOVE SPACE TO P-HNA P-COR.
007110     IF W-HMD2 = SPACE
007120         MOVE W-HMD1 TO P-HNA
007130       ELSE
007140         MOVE W-HMD2 TO P-HNAU.
007150*****IF TDI-HCD = 149600                                          D.091105
007160*****    MOVE "5312500" TO P-SHC.                                 D.091105
007170*****IF TDI-CCD = 900 OR 901                                      D.091228
007180*****    MOVE TDI-TRN TO P-SHC.                                   D.091228
007190*****IF TDI-TCD = 9850                                            D.170703
007200     IF TDIW-TCD = 9850                                           I.170703
007210         MOVE W-SHC TO P-SHC.                                     I.091228
007220     IF W-CR2 = SPACE
007230         MOVE W-CR1 TO P-COR
007240       ELSE
007250         MOVE W-CR2 TO P-COR.
007260*****IF TDI-TCD NOT = 4990                                        D.170703
007270*****    IF TDI-SIZ NOT = 000                                     D.170703
007280     IF TDIW-TCD NOT = 4990                                       I.170703
007290         IF TDIW-SIZ NOT = 000                                    I.170703
007300             IF W-INV = 0
007310                 MOVE W-SIZ(W-SC) TO P-SIZ.
007320*****MOVE TDI-SU TO P-SU.                                         D.170703
007330*****MOVE TDI-GT TO P-GTN.                                        D.170703
007340*****IF TDI-TCD = 6010                                            D.170703
007350*****    IF TDI-HCD = 999999                                      D.170703
007360     MOVE TDIW-SU TO P-SU.                                        I.170703
007370     MOVE TDIW-GT TO P-GTN.                                       I.170703
007380     IF TDIW-TCD = 6010                                           I.170703
007390         IF TDIW-HCD = 999999                                     I.170703
007400             MOVE 1 TO P-SU                                       I.120314
007410             MOVE TDIW-GKIN TO P-GTN.                             I.170703
007420*****        MOVE TDI-GKIN TO P-GTN.                              D.170703
007430*****MOVE TDI-GKIN TO P-GKIN.                                     D.170703
007440*****MOVE TDI-UT TO P-UTN.                                        D.170703
007450*****MOVE TDI-UKIN TO P-UKIN.                                     D.170703
007460     MOVE TDIW-GKIN TO P-GKIN.                                    I.170703
007470     MOVE TDIW-UT TO P-UTN.                                       I.170703
007480     MOVE TDIW-UKIN TO P-UKIN.                                    I.170703
007490     MOVE SPACE TO SP-R.
007500     MOVE W-P03 TO SP-R.
007510     WRITE SP-R.
007520     MOVE SPACE TO SP-R.
007530*
007540     SUBTRACT 2 FROM W-LC.
007550*****ADD TDI-SU TO WT-SU.                                         D.170703
007560*****IF TDI-TCD = 6010                                            D.170703
007570*****    IF TDI-HCD = 999999                                      D.170703
007580     ADD TDIW-SU TO WT-SU.                                        I.170703
007590     IF TDIW-TCD = 6010                                           I.170703
007600         IF TDIW-HCD = 999999                                     I.170703
007610             ADD 1 TO WT-SU.                                      I.120314
007620     ADD TDIW-GKIN TO WT-GKIN.                                    I.170703
007630     ADD TDIW-UKIN TO WT-UKIN.                                    I.170703
007640*****ADD TDI-GKIN TO WT-GKIN.                                     D.170703
007650*****ADD TDI-UKIN TO WT-UKIN.                                     D.170703
007660 M-45.
007670*****READ TDIF NEXT RECORD WITH UNLOCK AT END                     D.170703
007680     READ TDIW AT END                                             I.170703
007690         GO TO M-80.
007700*****IF TDI-TCD = 5000                                            D.170703
007710     IF TDIW-TCD = 5000                                           I.170703
007720         GO TO M-45.                                              I.091102
007730*****IF TDI-SOK NOT = 1                                           D.091102
007740*****    GO TO M-45.                                              D.091102
007750     IF W-HKC = 1
007760*****    IF TDI-PRC = 9                                           D.170703
007770         IF TDIW-PRC = 9                                          I.170703
007780             GO TO M-45.
007790     IF W-HKC = 2
007800*****    IF TDI-DNO > W-EDNO                                      D.170703
007810*****    IF TDIW-DNO > W-EDNO                                     D.170703
007820*****    IF (TDIW-DATE < W-SNGP AND > W-ENGP) OR                  D.170915
007830*****       (TDIW-CYO < W-SCYO AND > W-ECYO) OR                   D.170915
007840*****       (TDIW-TPC < W-STPC AND > W-ETPC)                      D.170915
007850         IF (TDIW-DATE < W-SNGP OR > W-ENGP) OR                   I.170915
007860            (TDIW-CYO < W-SCYO OR > W-ECYO) OR                    I.170915
007870            (TDIW-TPC < W-STPC OR > W-ETPC)                       I.170915
007880             GO TO M-80.
007890     IF W-HKC = 2
007900*****    IF TDI-PRC NOT = 9                                       D.170703
007910         IF TDIW-PRC NOT = 9                                      I.170703
007920             GO TO M-45.
007930     IF JS-SIGN = 0                                               I.091102
007940         IF W-HKC = 1                                             I.091102
007950*****        IF TDI-TCD NOT = 6010                                D.170703
007960*****            IF TDI-SOK NOT = 1                               D.170703
007970             IF TDIW-TCD NOT = 6010                               I.170703
007980                 IF TDIW-SOK NOT = 1                              I.170703
007990                     GO TO M-45.                                  I.080702
008000*****IF TDI-DNO NOT = W-DNO                                       D.170703
008010     IF TDIW-DNO NOT = W-DNO                                      I.170703
008020         GO TO M-50.
008030     IF W-LC = ZERO
008040         DISPLAY E-ME2 E-ME99
008050         GO TO M-90.
008060     GO TO M-35.
008070 M-50.
008080     PERFORM KEI-RTN THRU KEI-EX.
008090     IF W-HKC = 2                                                 I.091217
008100         GO TO M-15.                                              I.091217
008110*****IF W-HKC = 1                                                 D.091217
008120     PERFORM REW-RTN THRU REW-EX.
008130     IF W-END NOT = 0
008140         GO TO M-90.
008150 M-55.                                                            I.091217
008160*****IF TDI-TCD = 5000                                            D.170703
008170     IF TDIW-TCD = 5000                                           I.170703
008180         GO TO M-60.                                              I.091217
008190*****IF TDI-PRC = 9                                               D.170703
008200     IF TDIW-PRC = 9                                              I.170703
008210         GO TO M-60.                                              I.091217
008220     IF JS-SIGN = 0                                               I.091217
008230*****    IF TDI-TCD NOT = 6010                                    D.170703
008240*****        IF TDI-SOK NOT = 1                                   D.170703
008250         IF TDIW-TCD NOT = 6010                                   I.170703
008260             IF TDIW-SOK NOT = 1                                  I.170703
008270                 GO TO M-60.                                      I.091217
008280     GO TO M-15.
008290 M-60.                                                            I.091217
008300*****READ TDIF NEXT RECORD WITH UNLOCK AT END                     D.170703
008310     READ TDIW AT END                                             I.170703
008320         GO TO M-85.                                              I.091217
008330     GO TO M-55.                                                  I.091217
008340 M-80.
008350     PERFORM KEI-RTN THRU KEI-EX.
008360     IF W-HKC = 1
008370         PERFORM REW-RTN THRU REW-EX.
008380 M-85.                                                            I.091217
008390     MOVE SPACE TO SP-R.
008400     WRITE SP-R AFTER PAGE.
008410 M-90.
008420     IF W-HKC = 1                                                 I.170703
008430         CLOSE TDIF.                                              I.170703
008440     CLOSE TC-M HI2-M WTNAF CODEF.                                D.091228
008450*****CLOSE TC-M HI2-M WTNAF.                                      I.091228
008460 M-95.
008470     IF W-POC NOT = 0
008480         CLOSE SP-F.
008490     DISPLAY C-CLEAR.
008500     STOP RUN.
008510**************************************************************************
008520 ACP-RTN.                                                         I.091217
008530     ACCEPT A-TPC.                                                I.091217
008540     IF ESTAT = PF9                                               I.091217
008550         GO TO ACP-EX.                                            I.091217
008560     IF ESTAT NOT = HTB AND SKP                                   I.091217
008570         GO TO ACP-RTN.                                           I.091217
008580     IF W-TPC = 9                                                 I.091217
008590         GO TO ACP-05.                                            I.091217
008600     IF W-TPC NOT = 1                                             I.091217
008610         GO TO ACP-RTN.                                           I.091217
008620     PERFORM TST-RTN THRU TST-EX.                                 I.091217
008630     GO TO ACP-RTN.                                               I.091217
008640 ACP-05.                                                          I.091217
008650     ACCEPT A-HKC.                                                I.091217
008660     IF ESTAT = BTB                                               I.091217
008670         GO TO ACP-RTN.                                           I.091217
008680     IF ESTAT NOT = HTB AND SKP                                   I.091217
008690         GO TO ACP-05.                                            I.091217
008700     IF W-HKC = 1                                                 I.091217
008710         DISPLAY D-SHMC                                           I.091217
008720         GO TO ACP-50.                                            I.091217
008730     IF W-HKC NOT = 2                                             I.091217
008740         GO TO ACP-05.                                            I.091217
008750     DISPLAY D-SHM.                                               I.091217
008760 ACP-10.                                                          I.091217
008770*****ACCEPT A-SDNO.                                               D.170703
008780     ACCEPT A-SNGP.                                               I.170703
008790     IF ESTAT = BTB                                               I.091217
008800         GO TO ACP-05.                                            I.091217
008810     IF ESTAT NOT = HTB AND SKP                                   I.091217
008820         GO TO ACP-10.                                            I.091217
008830     IF W-SNGP = ZERO                                             I.170703
008840         GO TO ACP-15.                                            I.170703
008850     MOVE W-SNGP TO W-NGP.                                        I.170703
008860     IF W-NEN < 17                                                I.170703
008870         GO TO ACP-10.                                            I.170703
008880     IF W-GET < 1 OR > 12                                         I.170703
008890         GO TO ACP-10.                                            I.170703
008900     IF W-PEY < 1 OR > 31                                         I.170703
008910         GO TO ACP-10.                                            I.170703
008920 ACP-15.                                                          I.091217
008930*****ACCEPT A-EDNO.                                               D.170703
008940     ACCEPT A-ENGP.                                               I.170703
008950     IF ESTAT = BTB                                               I.091217
008960         GO TO ACP-10.                                            I.091217
008970     IF ESTAT NOT = HTB AND SKP                                   I.091217
008980         GO TO ACP-15.                                            I.091217
008990*****IF W-SDNO > W-EDNO                                           D.170703
009000     IF W-SNGP > W-ENGP                                           I.170703
009010         GO TO ACP-15.                                            I.091217
009020     IF W-ENGP = 999999                                           I.170703
009030         GO TO ACP-20.                                            I.170703
009040     MOVE W-ENGP TO W-NGP.                                        I.170703
009050     IF W-GET < 1 OR > 12                                         I.170703
009060         GO TO ACP-10.                                            I.170703
009070     IF W-PEY < 1 OR > 31                                         I.170703
009080         GO TO ACP-10.                                            I.170703
009090 ACP-20.                                                          I.170703
009100     ACCEPT A-SCYO.                                               I.170703
009110     IF ESTAT = BTB                                               I.170703
009120         GO TO ACP-15.                                            I.170703
009130     IF ESTAT NOT = HTB AND SKP                                   I.170703
009140         GO TO ACP-20.                                            I.170703
009150 ACP-25.                                                          I.170703
009160     ACCEPT A-ECYO.                                               I.170703
009170     IF ESTAT = BTB                                               I.170703
009180         GO TO ACP-20.                                            I.170703
009190     IF ESTAT NOT = HTB AND SKP                                   I.170703
009200         GO TO ACP-25.                                            I.170703
009210     IF W-SCYO > W-ECYO                                           I.170703
009220         GO TO ACP-25.                                            I.170703
009230     IF W-SCYO < 9850000                                          I.170703
009240         IF W-ECYO > 9850999                                      I.170703
009250             GO TO ACP-30.                                        I.170703
009260     MOVE 0000 TO W-STPC.                                         I.170703
009270     MOVE 9999 TO W-ETPC.                                         I.170703
009280     DISPLAY A-STPC A-ETPC.                                       I.170703
009290     GO TO ACP-50.                                                I.170703
009300 ACP-30.                                                          I.170703
009310     ACCEPT A-STPC.                                               I.170703
009320     IF ESTAT = BTB                                               I.170703
009330         GO TO ACP-25.                                            I.170703
009340     IF ESTAT NOT = HTB AND SKP                                   I.170703
009350         GO TO ACP-30.                                            I.170703
009360 ACP-35.                                                          I.170703
009370     ACCEPT A-ETPC.                                               I.170703
009380     IF ESTAT = BTB                                               I.170703
009390         GO TO ACP-30.                                            I.170703
009400     IF ESTAT NOT = HTB AND SKP                                   I.170703
009410         GO TO ACP-35.                                            I.170703
009420     IF W-STPC > W-ETPC                                           I.170703
009430         GO TO ACP-35.                                            I.170703
009440 ACP-50.                                                          I.091217
009450     ACCEPT A-DMM.                                                I.091217
009460     IF ESTAT = BTB                                               I.091217
009470         IF W-HKC = 1                                             I.170915
009480             GO TO ACP-05                                         I.170915
009490           ELSE                                                   I.170915
009500             IF (W-SCYO < 9850000) AND (W-ECYO > 9850999)         I.170703
009510                 GO TO ACP-35                                     I.170703
009520*****    IF W-HKC = 1                                             D.170703
009530*****        GO TO ACP-05                                         D.170703
009540               ELSE                                               I.091217
009550                 GO TO ACP-25.                                    I.170703
009560*****        GO TO ACP-15.                                        D.170703
009570     IF ESTAT NOT = HTB AND SKP                                   I.091217
009580         GO TO ACP-50.                                            I.091217
009590     IF W-DMM = 9                                                 I.091217
009600         GO TO ACP-05.                                            I.091217
009610     IF W-DMM NOT = 1                                             I.091217
009620         GO TO ACP-50.                                            I.091217
009630 ACP-EX.                                                          I.091217
009640     EXIT.                                                        I.091217
009650 NAM-RTN.
009660     MOVE SPACE TO W-ANA W-AHNA W-ACOR.
009670     MOVE ZERO TO W-NC1.
009680*****IF TDI-TCD = 4990                                            D.170703
009690*****    MOVE TDI-TRN TO W-ANA                                    D.170703
009700     IF TDIW-TCD = 4990                                           I.170703
009710         MOVE TDIW-TRN TO W-ANA                                   I.170703
009720         GO TO NAM-05.
009730*****MOVE TDI-HCD TO HI-MHCD HI-HCD.                              D.170703
009740     MOVE TDIW-HCD TO HI-MHCD HI-HCD.                             I.170703
009750     READ HI2-M WITH UNLOCK INVALID KEY
009760         DISPLAY E-ME5 E-ME99
009770         DISPLAY E-CL
009780         MOVE SPACE TO HI-NAME.
009790     MOVE HI-NAME TO W-ANA.
009800 NAM-05.
009810     ADD 1 TO W-NC1.
009820     IF W-NC1 > 24
009830         GO TO NAM-EX.
009840     MOVE W-NA(W-NC1) TO W-HNA(W-NC1).
009850     IF W-NA(W-NC1) NOT = SPACE
009860         GO TO NAM-05.
009870     ADD 1 TO W-NC1.
009880     IF W-NC1 > 24
009890         GO TO NAM-EX.
009900     MOVE W-NA(W-NC1) TO W-HNA(W-NC1).
009910     IF W-NA(W-NC1) NOT = SPACE
009920         GO TO NAM-05.
009930*****IF TDI-TCD = 4990                                            D.170703
009940     IF TDIW-TCD = 4990                                           I.170703
009950         GO TO NAM-EX.
009960     MOVE ZERO TO W-NC2.
009970 NAM-10.
009980     ADD 1 TO W-NC1.
009990     IF W-NC1 > 24
010000         GO TO NAM-EX.
010010     IF W-NC2 = 0
010020         IF W-NA(W-NC1) = SPACE
010030             GO TO NAM-10.
010040     ADD 1 TO  W-NC2.
010050     IF W-NC2 < 9
010060         MOVE W-NA(W-NC1) TO W-COR(W-NC2)
010070         GO TO NAM-10.
010080 NAM-EX.
010090     EXIT.
010100 SIZ-RTN.
010110     MOVE ZERO TO W-SC W-INV.
010120 SIZ-05.
010130     ADD 1 TO W-SC.
010140     IF W-SC > 34
010150         MOVE 1 TO W-INV
010160         DISPLAY E-ME6 E-ME99
010170         DISPLAY E-CL
010180         GO TO SIZ-EX.
010190*****IF TDI-SIZ NOT = W-SZ(W-SC)                                  D.170703
010200     IF TDIW-SIZ NOT = W-SZ(W-SC)                                 I.170703
010210         GO TO SIZ-05.
010220 SIZ-EX.
010230     EXIT.
010240 KEI-RTN.
010250     MOVE SPACE TO W-P03.
010260     MOVE W-15K TO P-15K3.
010270     MOVE W-20K TO P-20K3.
010280     MOVE SPACE TO P-HNA P-COR.
010290     MOVE WT-SU TO P-SU.
010300     MOVE WT-GKIN TO P-GKIN.
010310     MOVE WT-UKIN TO P-UKIN.
010320     MOVE SPACE TO SP-R.
010330     MOVE W-P03 TO SP-R.
010340     WRITE SP-R AFTER W-LC.
010350     MOVE SPACE TO SP-R.
010360     IF W-HNO NOT = SPACE
010370         MOVE SPACE TO W-P01
010380         MOVE W-20K TO P-20K1
010390         MOVE W-HNO TO P-NAME
010400         MOVE W-P01 TO SP-R
010410         WRITE SP-R AFTER 3
010420         MOVE SPACE TO SP-R.
010430 KEI-EX.
010440     EXIT.
010450 REW-RTN.
010460     MOVE SPACE TO TDI-KEY.
010470     MOVE W-DNO TO TDI-DNO.
010480     START TDIF KEY NOT < TDI-KEY INVALID KEY
010490         MOVE 9 TO W-END
010500         DISPLAY E-ME78 E-ME1 E-ME99
010510         GO TO REW-EX.
010520 REW-05.
010530     READ TDIF NEXT RECORD AT END
010540         GO TO REW-EX.
010550     IF TDI-DNO NOT = W-DNO
010560         GO TO REW-EX.
010570     MOVE 9 TO TDI-PRC.
010580     REWRITE TDI-R INVALID KEY
010590         MOVE 9 TO W-END
010600         DISPLAY E-ME78 E-STAT E-ME11 E-ME99
010610         GO TO REW-EX.
010620     GO TO REW-05.
010630 REW-EX.
010640     EXIT.
010650 TST-RTN.
010660     IF W-POC = 0
010670         OPEN OUTPUT SP-F
010680         MOVE 1 TO W-POC
010690       ELSE
010700         MOVE SPACE TO SP-R
010710         WRITE SP-R AFTER PAGE.
010720     MOVE SPACE TO W-P01.
010730     MOVE W-20K TO P-20K1.
010740     MOVE "XXXX" TO P-NAME.
010750     MOVE W-P01 TO SP-R.
010760     WRITE SP-R AFTER 2.
010770     MOVE SPACE TO SP-R.
010780*
010790     MOVE SPACE TO W-P02.
010800     MOVE W-15K TO P-15K2.
010810     MOVE W-20K TO P-20K2.
010820     MOVE ALL NC"‚m" TO P-TNA.
010830     MOVE SPACE TO P-NR.
010840     MOVE SPACE TO SP-R.
010850     MOVE W-P02 TO SP-R.
010860     WRITE SP-R AFTER 3.
010870     MOVE SPACE TO SP-R.
010880*
010890     MOVE SPACE TO W-P02.
010900     MOVE W-15K TO P-15K2.
010910     MOVE W-20K TO P-20K2.
010920     MOVE SPACE TO P-TNA.
010930     MOVE NC"“úiƒSƒ€‡Š" TO P-NR.
010940     MOVE SPACE TO SP-R.
010950     MOVE W-P02 TO SP-R.
010960     WRITE SP-R.
010970     MOVE SPACE TO SP-R.
010980*
010990     MOVE SPACE TO W-P02.
011000     MOVE W-15K TO P-15K2.
011010     MOVE W-20K TO P-20K2.
011020     MOVE SPACE TO P-NR.
011030     MOVE ALL NC"‚m" TO P-TNA.
011040     MOVE 99 TO P-SCD P-NNEN P-NGET P-NPEY.
011050     MOVE 999 TO P-MCD P-BRC.
011060     MOVE "XX" TO P-DPC.
011070     MOVE 999999 TO P-THC.
011080     MOVE SPACE TO SP-R.
011090     MOVE W-P02 TO SP-R.
011100     WRITE SP-R.
011110     MOVE SPACE TO SP-R.
011120     WRITE SP-R AFTER 3.
011130     MOVE ZERO TO W-LC.
011140 TST-05.
011150     MOVE SPACE TO W-P03.
011160     MOVE W-15K TO P-15K3.
011170     MOVE W-20K TO P-20K3.
011180     MOVE ALL NC"‚m" TO P-HNA P-COR.
011190     MOVE "XXXX" TO P-SIZ.
011200     MOVE 99999 TO P-SU.
011210     MOVE 999999 TO P-GTN P-UTN.
011220     MOVE 999999999 TO P-GKIN P-UKIN.
011230     MOVE SPACE TO SP-R.
011240     MOVE W-P03 TO SP-R.
011250     WRITE SP-R AFTER 2.
011260     MOVE SPACE TO SP-R.
011270     ADD 1 TO W-LC.
011280     IF W-LC < 6
011290         GO TO TST-05.
011300     MOVE SPACE TO W-P03.
011310     MOVE W-15K TO P-15K3.
011320     MOVE W-20K TO P-20K3.
011330     MOVE SPACE TO P-HNA P-COR.
011340     MOVE 99999 TO P-SU.
011350     MOVE 999999999 TO P-GKIN P-UKIN.
011360     MOVE SPACE TO SP-R.
011370     MOVE W-P03 TO SP-R.
011380     WRITE SP-R AFTER 2.
011390     MOVE SPACE TO SP-R.
011400 TST-EX.
011410     EXIT.
