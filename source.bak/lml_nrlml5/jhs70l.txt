000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JHS70L.
000030*********************************************************
000040*    PROGRAM         :  “ˆê“`•[ì¬iƒgƒ‰ƒXƒR‘¼j      *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  0=–{ŽÐ , 1=‹Ê“‡                 *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT TC-M ASSIGN TO TC-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY TC-KEY
000200         FILE STATUS IS ERR-STAT.
000210     SELECT HI2-M ASSIGN TO HI2-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY HI-KEY2
000250         FILE STATUS IS ERR-STAT.
000260     SELECT TDIF ASSIGN TO TDI-MSD
000270         ORGANIZATION INDEXED
000280         ACCESS MODE DYNAMIC
000290         RECORD KEY TDI-KEY
000300         FILE STATUS IS ERR-STAT.
000310     SELECT WTNAF ASSIGN TO WTNAF-MSD
000320         ORGANIZATION INDEXED
000330         ACCESS MODE RANDOM
000340         RECORD KEY WTNA-KEY
000350         FILE STATUS IS ERR-STAT.
000360     SELECT CODEF ASSIGN TO CODEF-RDB                             I.091228
000370         FILE STATUS IS ERR-STAT.                                 I.091228
000380     SELECT SP-F ASSIGN TO P-PRN999.
000390 I-O-CONTROL.
000400     APPLY SHARED-MODE ON WTNAF
000410     APPLY SHARED-MODE ON TC-M
000420     APPLY SHARED-MODE ON HI2-M
000430     APPLY SHARED-MODE ON CODEF                                   I.091228
000440     APPLY SHIFT-CODE  ON SP-F.
000450 DATA DIVISION.
000460 FILE SECTION.
000470     COPY LITCM.
000480     COPY LIHIM2.
000490     COPY LITDIF.
000500     COPY LRCODE.                                                 I.091228
000510 FD  WTNAF
000520     BLOCK  4 RECORDS
000530     LABEL RECORD IS STANDARD
000540     VALUE OF IDENTIFICATION "WTNAF".
000550 01  WTNA-R.
000560     02  WTNA-KEY.
000570*****  03  WTNA-TNC     PIC  9(003).                              D.101018
000580       03  WTNA-TNC     PIC  9(004).                              I.101018
000590     02  WTNA-NAME      PIC  N(026).
000600     02  F              PIC  X(008).                              I.101018
000610*****02  F              PIC  X(009).                              D.101018
000620 FD  SP-F
000630     LABEL RECORD OMITTED
000640     LINAGE IS 30 LINES.
000650 01  SP-R               PIC  X(136).
000660 WORKING-STORAGE  SECTION.
000670 77  ERR-STAT           PIC  X(002).
000680 77  W-FILE             PIC  X(013).
000690 77  JS-SIGN            PIC  9(001).                              I.091102
000700 77  W-END              PIC  9(001) VALUE 0.
000710 77  W-POC              PIC  9(001) VALUE 0.                      I.091102
000720 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
000730 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
000740 01  W-P01.
000750     02  P-20K1         PIC  X(005).
000760*****02  F              PIC  X(008).                              D.091211
000770     02  F              PIC  X(009).                              I.091211
000780     02  P-NAME         PIC  X(010).
000790     02  F              PIC  X(080).
000800 01  W-P02.
000810     02  P-15K2         PIC  X(005).
000820*****02  F              PIC  X(006).                              D.091211
000830     02  F              PIC  X(007).                              I.091211
000840     02  P-TNA          PIC  N(014).
000850     02  P-TNAD  REDEFINES P-TNA.
000860       03  F            PIC  N(002).
000870       03  P-TNAU       PIC  N(012).
000880     02  F              PIC  X(003).
000890     02  P-SCD          PIC  9(002).
000900*****02  F              PIC  X(003).                              D.101018
000910*****02  P-MCD          PIC  9(003).                              D.101018
000920     02  F              PIC  X(002).                              I.101018
000930     02  P-TPC          PIC  9(004).                              I.101018
000940     02  P-MCDD  REDEFINES P-TPC.                                 I.101018
000950       03  F            PIC  9(001).                              I.101018
000960       03  P-MCD        PIC  9(003).                              I.101018
000970     02  F              PIC  X(003).
000980*****02  P-BRC          PIC  9(003).                              D.120209
000990*****02  F              PIC  X(002).                              D.120209
001000     02  P-BRC          PIC  Z(004).                              I.120209
001010     02  F              PIC  X(001).                              I.120209
001020     02  P-DPC          PIC  X(002).
001030     02  F              PIC  X(001).                              I.100222
001040     02  P-DNO          PIC  9(006).                              I.100222
001050     02  P-DNO0         PIC  9(001).                              I.100222
001060     02  F              PIC  X(001).                              I.100222
001070*****02  F              PIC  X(009).                              D.100222
001080     02  P-THC          PIC  9(006).
001090     02  F              PIC  X(005).
001100     02  P-NR           PIC  N(006).
001110     02  F              PIC  X(011).
001120     02  P-NNEN         PIC  9(002).
001130     02  P-NGETD        PIC  9(002).                              I.120220
001140     02  P-AGET  REDEFINES P-NGETD.                               I.120220
001150       03  P-NGET       PIC Z9.                                   I.120220
001160     02  P-NPEYD        PIC  9(002).                              I.120220
001170     02  P-APEY  REDEFINES P-NPEYD.                               I.120220
001180       03  P-NPEY       PIC Z9.                                   I.120220
001190*****02  P-NGET         PIC Z9.                                   D.120220
001200*****02  P-NPEY         PIC Z9.                                   D.120220
001210     02  F              PIC  X(004).
001220     02  P-20K2         PIC  X(005).
001230 01  W-P03.
001240     02  P-15K3         PIC  X(005).
001250*****02  F              PIC  X(006).                              D.091211
001260     02  F              PIC  X(007).                              I.091211
001270     02  P-HNA          PIC  N(016).
001280     02  P-HNAD  REDEFINES P-HNA.
001290       03  F            PIC  N(008).
001300       03  P-HNAU       PIC  N(008).
001310*****02  F              PIC  X(014).                              D.091102
001320     02  F              PIC  X(006).                              I.091102
001330     02  P-SHC          PIC  X(008).                              I.091105
001340*****02  P-SHC          PIC  X(007).                              D.091105
001350*****02  F              PIC  X(001).                              D.091105
001360     02  P-COR          PIC  N(004).
001370     02  F              PIC  X(001).
001380     02  P-SIZ          PIC  X(004).
001390     02  P-SU           PIC  Z(006).
001400     02  F              PIC  X(005).
001410     02  P-GTN          PIC  Z(006).
001420     02  F              PIC  X(002).
001430     02  P-GKIN         PIC  Z(009).
001440     02  P-UTN          PIC  Z(006).
001450     02  P-UKIN         PIC  Z(009).
001460     02  P-20K3         PIC  X(005).
001470 01  W-DATA.
001480*****02  W-POC          PIC  9(001).                              D.091102
001490     02  W-TPC          PIC  9(001).
001500     02  W-HKC          PIC  9(001).
001510     02  W-SEN          PIC  9(001).
001520     02  W-SED.
001530       03  W-SDNO       PIC  9(006).
001540       03  W-EDNO       PIC  9(006).
001550     02  W-DMM          PIC  9(001).
001560     02  W-DNO          PIC  9(006).
001570     02  W-DNO0         PIC  9(001).                              I.121128
001580     02  W-HNO          PIC  X(010).
001590     02  W-TNA          PIC  N(026).
001600     02  W-TNAD  REDEFINES W-TNA.
001610       03  W-TNAO       PIC  N(014).
001620       03  W-TNAU       PIC  N(012).
001630     02  WT-D.
001640       03  WT-SU        PIC  9(006).
001650       03  WT-GKIN      PIC  9(009).
001660       03  WT-UKIN      PIC  9(009).
001670     02  W-INV          PIC  9(001).
001680     02  W-LC           PIC  9(002).
001690     02  W-NC1          PIC  9(002).
001700     02  W-NC2          PIC  9(002).
001710     02  W-ANA          PIC  N(024).
001720     02  W-ANAD  REDEFINES W-ANA.
001730       03  W-NAD   OCCURS  24.
001740         04  W-NA       PIC  N(001).
001750     02  W-AHNA         PIC  N(024).
001760     02  W-AHNAD REDEFINES W-AHNA.
001770       03  W-HNAD   OCCURS  24.
001780         04  W-HNA      PIC  N(001).
001790     02  W-AHMD  REDEFINES W-AHNA.
001800       03  W-HMD1       PIC  N(016).
001810       03  W-HMD2       PIC  N(008).
001820     02  W-ACOR         PIC  N(008).
001830     02  W-ACORD REDEFINES W-ACOR.
001840       03  W-CORD   OCCURS   8.
001850         04  W-COR      PIC  N(001).
001860     02  W-ACRD REDEFINES W-ACOR.
001870       03  W-CR1        PIC  N(004).
001880       03  W-CR2        PIC  N(004).
001890     02  W-SHC          PIC  X(008).                              I.091228
001900     02  W-SC           PIC  9(002).
001910     02  W-ASZD.
001920       03  W-SZD   OCCURS  34.
001930         04  W-SZ       PIC  X(003).
001940     02  W-MSZ.
001950       03  F            PIC  X(045) VALUE
001960            "SS S  M  L  LL XL XXL125130135140150160170180".
001970       03  F            PIC  X(045) VALUE
001980            "190200210215220225230235240245250255260265270".
001990       03  F            PIC  X(012) VALUE
002000            "275280290300".
002010     02  W-ASIZD.
002020       03  W-SIZD  OCCURS  34.
002030         04  W-SIZ      PIC  X(004).
002040     02  W-MSIZ.
002050       03  F            PIC  X(048) VALUE
002060            "SS  S   M   L   LL  XL  XXL 12.513.013.514.015.0".
002070       03  F            PIC  X(048) VALUE
002080            "16.017.018.019.020.021.021.522.022.523.023.524.0".
002090       03  F            PIC  X(040) VALUE
002100            "24.525.025.526.026.527.027.528.029.030.0".
002110     COPY LSTAT.
002120 SCREEN SECTION.
002130 SD  C-CRT
002140     END STATUS IS ESTAT.
002150 01  C-CLEAR.
002160     02  C-CL    LINE   1  CLEAR SCREEN.
002170 01  C-MID.
002180     02  LINE   1  COLUMN  20  PIC  N(014) VALUE
002190          NC"ƒ`ƒF[ƒ“ƒXƒgƒA“ˆê“`•[@”­s".
002200     02  LINE   2  COLUMN  20  PIC  N(013) VALUE
002210          NC"iƒ^ƒCƒv—p‚PŒ^j".
002220     02  LINE   4  COLUMN  10  PIC  N(007) VALUE
002230          NC"yƒgƒ‰ƒXƒR‘¼z".
002240     02  LINE   7  COLUMN  22  PIC  X(035) VALUE
002250          "ƒeƒXƒgƒvƒŠƒ“ƒgˆóŽš (YES=1,NO=9) [ ]".
002260     02  LINE  10  COLUMN  22  PIC  X(010) VALUE
002270          "‚PD”­@s".
002280     02  LINE  11  COLUMN  22  PIC  X(018) VALUE
002290          "‚QDÄ”­s     [ ]".
002300     02  LINE  23  COLUMN  43  PIC  X(028) VALUE
002310          "Šm”F (OK=1,NO=9) --->   ØÀ°Ý".
002320 01  C-ACP.
002330     02  A-TPC   LINE   7  COLUMN  55  PIC  9(001)
002340          USING W-TPC   CHECK OVERFLOW NO IFC.
002350     02  A-HKC   LINE  11  COLUMN  38  PIC  9(001)
002360          USING W-HKC   CHECK OVERFLOW NO IFC.
002370     02  A-SDNO  LINE  15  COLUMN  34  PIC  9(006)
002380          USING W-SDNO  CHECK OVERFLOW NO IFC.
002390     02  A-EDNO  LINE  16  COLUMN  34  PIC  9(006)
002400          USING W-EDNO  CHECK OVERFLOW NO IFC.
002410     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
002420          USING W-DMM   CHECK OVERFLOW NO IFC.
002430 01  C-DSP.
002440     02  D-SHM.
002450       03  LINE  14  COLUMN  33  PIC  N(004) VALUE
002460            NC"“`•[”Ô†".
002470       03  LINE  15  COLUMN  22  PIC  N(004) VALUE
002480            NC"‚e‚q‚n‚l".
002490       03  LINE  16  COLUMN  22  PIC  N(002) VALUE
002500            NC"‚s‚n".
002510     02  D-SHMC.
002520       03  LINE  14  COLUMN  33  PIC  X(008) VALUE
002530            "      ".
002540       03  LINE  15  COLUMN  22  PIC  X(028) VALUE
002550            "                    ".
002560       03  LINE  16  COLUMN  22  PIC  X(028) VALUE
002570            "                    ".
002580 01  C-ERR.
002590     02  LINE  24.
002600       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002610            "***  DATA Å¼  ***".
002620       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
002630            "***  DATA ´×°  ***".
002640       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
002650            "***  Ä¸²»· Å¼  ***".
002660       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
002670            "***  Á®¸¿³»· Å¼  ***".
002680       03  E-ME5   COLUMN  15  PIC  X(017) VALUE
002690            "***  ËÝÒ² Å¼  ***".
002700       03  E-ME6   COLUMN  15  PIC  X(017) VALUE
002710            "***  »²½Þ Å¼  ***".
002720       03  E-ME7   COLUMN  15  PIC  X(017) VALUE
002730            "***  ÃÝÒ² Å¼  ***".
002740       03  E-ME11  COLUMN  15  PIC  X(026) VALUE
002750            "***  TDIF REWRITE ´×°  ***".
002760     COPY LSSEM.
002770 PROCEDURE DIVISION.
002780 M-00.
002790     ACCEPT JS-SIGN.                                              I.091102
002800     IF JS-SIGN > 1                                               I.091102
002810         GO TO M-95.                                              I.091102
002820     DISPLAY C-CLEAR.
002830     DISPLAY C-MID.
002840*****MOVE 0 TO W-POC.                                             D.091102
002850*M-01.                                                            D.091217
002860*****ACCEPT A-TPC.                                                D.091217
002870     PERFORM ACP-RTN THRU ACP-EX.                                 I.091217
002880     IF ESTAT = PF9
002890         GO TO M-95.
002900*****IF ESTAT NOT = HTB AND SKP                                   D.091217
002910*****    GO TO M-01.                                              D.091217
002920*****IF W-TPC = 9                                                 D.091217
002930*****    GO TO M-02.                                              D.091217
002940*****IF W-TPC NOT = 1                                             D.091217
002950*****    GO TO M-01.                                              D.091217
002960*****PERFORM TST-RTN THRU TST-EX.                                 D.091217
002970*****GO TO M-01.                                                  D.091217
002980*M-02.                                                            D.091217
002990*****ACCEPT A-HKC.                                                D.091217
003000*****IF ESTAT = BTB                                               D.091217
003010*****    GO TO M-01.                                              D.091217
003020*****IF ESTAT NOT = HTB AND SKP                                   D.091217
003030*****    GO TO M-02.                                              D.091217
003040*****IF W-HKC = 1                                                 D.091217
003050*****    DISPLAY D-SHMC                                           D.091217
003060*****    GO TO M-05.                                              D.091217
003070*****IF W-HKC NOT = 2                                             D.091217
003080*****    GO TO M-02.                                              D.091217
003090*****DISPLAY D-SHM.                                               D.091217
003100*M-03.                                                            D.091217
003110*****ACCEPT A-SDNO.                                               D.091217
003120*****IF ESTAT = BTB                                               D.091217
003130*****    GO TO M-02.                                              D.091217
003140*****IF ESTAT NOT = HTB AND SKP                                   D.091217
003150*****    GO TO M-03.                                              D.091217
003160*M-04.                                                            D.091217
003170*****ACCEPT A-EDNO.                                               D.091217
003180*****IF ESTAT = BTB                                               D.091217
003190*****    GO TO M-03.                                              D.091217
003200*****IF ESTAT NOT = HTB AND SKP                                   D.091217
003210*****    GO TO M-04.                                              D.091217
003220*****IF W-SDNO > W-EDNO                                           D.091217
003230*****    GO TO M-04.                                              D.091217
003240*M-05.                                                            D.091217
003250*****ACCEPT A-DMM.                                                D.091217
003260*****IF ESTAT = BTB                                               D.091217
003270*****    IF W-HKC = 1                                             D.091217
003280*****        GO TO M-02                                           D.091217
003290*****      ELSE                                                   D.091217
003300*****        GO TO M-04.                                          D.091217
003310*****IF ESTAT NOT = HTB AND SKP                                   D.091217
003320*****    GO TO M-05.                                              D.091217
003330*****IF W-DMM = 9                                                 D.091217
003340*****    GO TO M-02.                                              D.091217
003350*****IF W-DMM NOT = 1                                             D.091217
003360*****    GO TO M-05.                                              D.091217
003370*
003380     IF W-HKC = 1
003390         OPEN I-O TDIF
003400         GO TO M-10.
003410     OPEN INPUT TDIF
003420     MOVE ZERO TO TDI-KEY.
003430     MOVE W-SDNO TO TDI-DNO.
003440     START TDIF KEY NOT < TDI-KEY INVALID KEY
003450         CLOSE TDIF
003460         DISPLAY E-ME1 E-ME99
003470         GO TO M-95.
003480 M-10.
003490     READ TDIF NEXT RECORD WITH UNLOCK AT END
003500         CLOSE TDIF
003510         DISPLAY E-ME1 E-ME99
003520         GO TO M-95.
003530     IF TDI-TCD = 5000                                            I.091102
003540         GO TO M-10.                                              I.091102
003550*****IF TDI-SOK NOT = 1                                           D.091102
003560*****    GO TO M-10.                                              D.091102
003570     IF W-HKC = 1
003580         IF TDI-PRC = 9
003590             GO TO M-10.
003600     IF W-HKC = 2
003610         IF TDI-DNO > W-EDNO
003620             CLOSE TDIF
003630             DISPLAY E-ME1 E-ME99
003640             GO TO M-95.
003650     IF W-HKC = 2
003660         IF TDI-PRC NOT = 9
003670             GO TO M-10.
003680     IF JS-SIGN = 0                                               I.091102
003690         IF W-HKC = 1                                             I.091102
003700             IF TDI-TCD NOT = 6010                                I.120217
003710                 IF TDI-SOK NOT = 1                               I.080702
003720                     GO TO M-10.                                  I.080702
003730*****OPEN INPUT TC-M HI2-M WTNAF.                                 D.091228
003740     OPEN INPUT TC-M HI2-M WTNAF CODEF.                           I.091228
003750     MOVE W-MSZ TO W-ASZD.
003760     MOVE W-MSIZ TO W-ASIZD.
003770 M-15.
003780     MOVE TDI-DNO TO W-DNO.
003790     MOVE TDI-HNO TO W-HNO.
003800     MOVE ZERO TO WT-D.
003810*
003820     IF W-POC = 0
003830         OPEN OUTPUT SP-F
003840         MOVE 1 TO W-POC
003850       ELSE
003860         MOVE SPACE TO SP-R
003870         WRITE SP-R AFTER PAGE.
003880     MOVE SPACE TO SP-R.
003890     IF TDI-TCD = 9850
003900         MOVE SPACE TO W-P01
003910         MOVE W-20K TO P-20K1
003920         MOVE "ÓØÜ¹" TO P-NAME
003930         MOVE W-P01 TO SP-R.
003940     WRITE SP-R AFTER 2.
003950     MOVE SPACE TO SP-R.
003960*
003970     MOVE TDI-TCD TO TC-TCD.
003980     MOVE 001 TO TC-CCD.
003990     READ TC-M WITH UNLOCK INVALID KEY
004000         DISPLAY E-ME3 E-ME99
004010         DISPLAY E-CL
004020         MOVE SPACE TO TC-NAME.
004030     MOVE SPACE TO W-TNA.
004040     MOVE TC-NAME TO W-TNA.
004050*
004060     MOVE SPACE TO W-P02.
004070     MOVE W-15K TO P-15K2.
004080     MOVE W-20K TO P-20K2.
004090     MOVE SPACE TO P-TNA.
004100     MOVE W-TNAO TO P-TNA.
004110     MOVE SPACE TO P-NR.
004120     MOVE SPACE TO SP-R.
004130     MOVE W-P02 TO SP-R.
004140     WRITE SP-R AFTER 3.
004150     MOVE SPACE TO SP-R.
004160*
004170     MOVE SPACE TO W-P02.
004180     MOVE W-15K TO P-15K2.
004190     MOVE W-20K TO P-20K2.
004200     MOVE SPACE TO P-TNA P-NR.
004210     IF W-TNAU NOT = SPACE
004220         MOVE W-TNAU TO P-TNAU.
004230     MOVE NC"“úiƒSƒ€‡Š" TO P-NR.
004240     MOVE SPACE TO SP-R.
004250     MOVE W-P02 TO SP-R.
004260     WRITE SP-R.
004270     MOVE SPACE TO SP-R.
004280*
004290     MOVE SPACE TO W-TNA.
004300     IF TDI-TCD NOT = 9850
004310         GO TO M-20.
004320     IF TDI-TPC = ZERO OR 999
004330         GO TO M-20.
004340     MOVE TDI-TPC TO WTNA-KEY.
004350     READ WTNAF WITH UNLOCK INVALID KEY
004360         DISPLAY E-ME7 E-ME99
004370         DISPLAY E-CL
004380         MOVE SPACE TO WTNA-NAME.
004390     MOVE WTNA-NAME TO W-TNA.
004400     GO TO M-25.
004410 M-20.
004420     MOVE TDI-TCD TO TC-TCD.
004430     MOVE TDI-CCD TO TC-CCD.
004440     READ TC-M WITH UNLOCK INVALID KEY
004450         DISPLAY E-ME4 E-ME99
004460         DISPLAY E-CL
004470         MOVE SPACE TO TC-NAME.
004480     MOVE TC-NAME TO W-TNA.
004490 M-25.
004500     MOVE SPACE TO W-P02.
004510     MOVE W-15K TO P-15K2.
004520     MOVE W-20K TO P-20K2.
004530     MOVE SPACE TO P-TNA P-NR.
004540     MOVE W-TNAO TO P-TNA.
004550     IF TDI-TCD = 6010                                            I.120209
004560         MOVE 4440 TO P-BRC                                       I.120209
004570         MOVE "01" TO P-DPC                                       I.120209
004580         MOVE 351374 TO P-THC                                     I.120209
004590         IF TDI-CCD = 007                                         I.120209
004600             MOVE 727 TO P-MCD                                    I.120209
004610             GO TO M-30                                           I.120209
004620           ELSE                                                   I.120209
004630             MOVE 702 TO P-MCD                                    I.120209
004640             GO TO M-30.                                          I.120209
004650     IF TDI-TCD NOT = 9850                                        I.091102
004660         GO TO M-30.                                              I.091102
004670     MOVE 07 TO P-SCD.                                            I.091102
004680     MOVE TDI-TPC TO P-TPC.                                       I.101018
004690*****MOVE TDI-TPC TO P-MCD.                                       D.101018
004700*****IF TDI-TPC = 901                                             D.101018
004710*****    MOVE 900 TO P-MCD.                                       D.101018
004720     IF TDI-TPC = 9001                                            I.101018
004730         MOVE 9000 TO P-TPC.                                      I.101018
004740     MOVE "AA" TO P-DPC.                                          I.091102
004750*****IF TDI-TCD = 9850                                            D.091102
004760*****    MOVE 07 TO P-SCD                                         D.091102
004770*****    MOVE TDI-TPC TO P-MCD                                    D.091102
004780*****    MOVE "AA" TO P-DPC                                       D.091102
004790*****IF TDI-CCD NOT = 900                                         D.091105
004800     IF TDI-CCD NOT = 900 AND 901                                 I.091105
004810         MOVE 976318 TO P-THC
004820       ELSE                                                       I.091102
004830         MOVE 732974 TO P-THC.                                    I.091102
004840*****IF TDI-TPC = 999                                             D.101018
004850     IF TDI-TPC = 9999                                            I.101018
004860         MOVE 901 TO P-BRC
004870       ELSE
004880         MOVE 501 TO P-BRC.
004890 M-30.                                                            I.091102
004900     MOVE TDI-DNO TO P-DNO.                                       I.100222
004910     IF TDI-TCD = 6010                                            I.121128
004920         COMPUTE W-DNO0 = TDI-DNO - ((TDI-DNO / 7) * 7)           I.121128
004930         MOVE W-DNO0 TO P-DNO0                                    I.121128
004940       ELSE                                                       I.121128
004950         MOVE 0 TO P-DNO0.                                        I.100222
004960     MOVE TDI-NEN TO P-NNEN.
004970     IF TDI-TCD = 6010                                            I.120220
004980         MOVE TDI-GET TO P-NGETD                                  I.120220
004990         MOVE TDI-PEY TO P-NPEYD                                  I.120220
005000       ELSE                                                       I.120220
005010*****MOVE TDI-GET TO P-NGET.                                      D.120220
005020         MOVE TDI-GET TO P-NGET                                   I.120220
005030         MOVE TDI-PEY TO P-NPEY.
005040     MOVE SPACE TO SP-R.
005050     MOVE W-P02 TO SP-R.
005060     WRITE SP-R.
005070     MOVE SPACE TO SP-R.
005080*
005090     IF W-TNAU NOT = SPACE
005100         MOVE SPACE TO W-P02
005110         MOVE W-15K TO P-15K2
005120         MOVE W-20K TO P-20K2
005130         MOVE SPACE TO P-TNA P-NR
005140         MOVE W-TNAU TO P-TNAU
005150         MOVE SPACE TO SP-R
005160         MOVE W-P02 TO SP-R.
005170     WRITE SP-R.
005180     MOVE SPACE TO SP-R.
005190     WRITE SP-R AFTER 2.
005200*
005210     MOVE 14 TO W-LC.
005220 M-35.
005230     PERFORM NAM-RTN THRU NAM-EX.
005240     IF TDI-SIZ NOT = 000
005250         PERFORM SIZ-RTN THRU SIZ-EX.
005260     MOVE SPACE TO W-SHC.                                         I.091228
005270     IF TDI-TCD NOT = 9850                                        I.091228
005280         GO TO M-37.                                              I.091228
005290     CLOSE CODEF.                                                 I.091228
005300     OPEN INPUT CODEF.                                            I.091228
005310     SELECT CODEF WHERE TDI-TCD = CODE-TCD AND                    I.091228
005320                        TDI-HCD = CODE-HCD AND                    I.091228
005330                        TDI-SKB = CODE-SIZ AND                    I.091228
005340                        TDI-SNO = CODE-SNO.                       I.091228
005350     READ CODEF AT END SCRATCH CODEF                              I.091228
005360          MOVE SPACE TO CODE-JAN.                                 I.091228
005370     MOVE CODE-JAN TO W-SHC.                                      I.091228
005380     IF W-SHC = 00000000                                          I.091228
005390         MOVE SPACE TO W-SHC.                                     I.091228
005400 M-37.                                                            I.091228
005410     MOVE SPACE TO W-P03.
005420     MOVE W-15K TO P-15K3.
005430     MOVE W-20K TO P-20K3.
005440     MOVE SPACE TO P-HNA P-COR.
005450     IF (W-HMD2 = SPACE) AND (W-CR2 = SPACE)
005460         GO TO M-40.
005470     IF W-HMD2 NOT = SPACE
005480         MOVE W-HMD1 TO P-HNA.
005490     IF W-CR2 NOT = SPACE
005500         MOVE W-CR1 TO P-COR.
005510 M-40.
005520     MOVE SPACE TO SP-R.
005530     MOVE W-P03 TO SP-R.
005540     WRITE SP-R.
005550     MOVE SPACE TO SP-R.
005560*
005570     MOVE SPACE TO W-P03.
005580     MOVE W-15K TO P-15K3.
005590     MOVE W-20K TO P-20K3.
005600     MOVE SPACE TO P-HNA P-COR.
005610     IF W-HMD2 = SPACE
005620         MOVE W-HMD1 TO P-HNA
005630       ELSE
005640         MOVE W-HMD2 TO P-HNAU.
005650*****IF TDI-HCD = 149600                                          D.091105
005660*****    MOVE "5312500" TO P-SHC.                                 D.091105
005670*****IF TDI-CCD = 900 OR 901                                      D.091228
005680*****    MOVE TDI-TRN TO P-SHC.                                   D.091228
005690     IF TDI-TCD = 9850                                            I.091228
005700         MOVE W-SHC TO P-SHC.                                     I.091228
005710     IF W-CR2 = SPACE
005720         MOVE W-CR1 TO P-COR
005730       ELSE
005740         MOVE W-CR2 TO P-COR.
005750     IF TDI-TCD NOT = 4990
005760         IF TDI-SIZ NOT = 000
005770             IF W-INV = 0
005780                 MOVE W-SIZ(W-SC) TO P-SIZ.
005790     MOVE TDI-SU TO P-SU.
005800     MOVE TDI-GT TO P-GTN.
005810     IF TDI-TCD = 6010                                            I.120314
005820         IF TDI-HCD = 999999                                      I.120314
005830             MOVE 1 TO P-SU                                       I.120314
005840             MOVE TDI-GKIN TO P-GTN.                              I.120314
005850     MOVE TDI-GKIN TO P-GKIN.
005860     MOVE TDI-UT TO P-UTN.
005870     MOVE TDI-UKIN TO P-UKIN.
005880     MOVE SPACE TO SP-R.
005890     MOVE W-P03 TO SP-R.
005900     WRITE SP-R.
005910     MOVE SPACE TO SP-R.
005920*
005930     SUBTRACT 2 FROM W-LC.
005940     ADD TDI-SU TO WT-SU.
005950     IF TDI-TCD = 6010                                            I.120314
005960         IF TDI-HCD = 999999                                      I.120314
005970             ADD 1 TO WT-SU.                                      I.120314
005980     ADD TDI-GKIN TO WT-GKIN.
005990     ADD TDI-UKIN TO WT-UKIN.
006000 M-45.
006010     READ TDIF NEXT RECORD WITH UNLOCK AT END
006020         GO TO M-80.
006030     IF TDI-TCD = 5000                                            I.091102
006040         GO TO M-45.                                              I.091102
006050*****IF TDI-SOK NOT = 1                                           D.091102
006060*****    GO TO M-45.                                              D.091102
006070     IF W-HKC = 1
006080         IF TDI-PRC = 9
006090             GO TO M-45.
006100     IF W-HKC = 2
006110         IF TDI-DNO > W-EDNO
006120             GO TO M-80.
006130     IF W-HKC = 2
006140         IF TDI-PRC NOT = 9
006150             GO TO M-45.
006160     IF JS-SIGN = 0                                               I.091102
006170         IF W-HKC = 1                                             I.091102
006180             IF TDI-TCD NOT = 6010                                I.120217
006190                 IF TDI-SOK NOT = 1                               I.080702
006200                     GO TO M-45.                                  I.080702
006210     IF TDI-DNO NOT = W-DNO
006220         GO TO M-50.
006230     IF W-LC = ZERO
006240         DISPLAY E-ME2 E-ME99
006250         GO TO M-90.
006260     GO TO M-35.
006270 M-50.
006280     PERFORM KEI-RTN THRU KEI-EX.
006290     IF W-HKC = 2                                                 I.091217
006300         GO TO M-15.                                              I.091217
006310*****IF W-HKC = 1                                                 D.091217
006320     PERFORM REW-RTN THRU REW-EX.
006330     IF W-END NOT = 0
006340         GO TO M-90.
006350 M-55.                                                            I.091217
006360     IF TDI-TCD = 5000                                            I.091217
006370         GO TO M-60.                                              I.091217
006380     IF TDI-PRC = 9                                               I.091217
006390         GO TO M-60.                                              I.091217
006400     IF JS-SIGN = 0                                               I.091217
006410         IF TDI-TCD NOT = 6010                                    I.120217
006420             IF TDI-SOK NOT = 1                                   I.091217
006430                 GO TO M-60.                                      I.091217
006440     GO TO M-15.
006450 M-60.                                                            I.091217
006460     READ TDIF NEXT RECORD WITH UNLOCK AT END                     I.091217
006470         GO TO M-85.                                              I.091217
006480     GO TO M-55.                                                  I.091217
006490 M-80.
006500     PERFORM KEI-RTN THRU KEI-EX.
006510     IF W-HKC = 1
006520         PERFORM REW-RTN THRU REW-EX.
006530 M-85.                                                            I.091217
006540     MOVE SPACE TO SP-R.
006550     WRITE SP-R AFTER PAGE.
006560 M-90.
006570     CLOSE TDIF.
006580     CLOSE TC-M HI2-M WTNAF CODEF.                                D.091228
006590*****CLOSE TC-M HI2-M WTNAF.                                      I.091228
006600 M-95.
006610     IF W-POC NOT = 0
006620         CLOSE SP-F.
006630     DISPLAY C-CLEAR.
006640     STOP RUN.
006650**************************************************************************
006660 ACP-RTN.                                                         I.091217
006670     ACCEPT A-TPC.                                                I.091217
006680     IF ESTAT = PF9                                               I.091217
006690         GO TO ACP-EX.                                            I.091217
006700     IF ESTAT NOT = HTB AND SKP                                   I.091217
006710         GO TO ACP-RTN.                                           I.091217
006720     IF W-TPC = 9                                                 I.091217
006730         GO TO ACP-05.                                            I.091217
006740     IF W-TPC NOT = 1                                             I.091217
006750         GO TO ACP-RTN.                                           I.091217
006760     PERFORM TST-RTN THRU TST-EX.                                 I.091217
006770     GO TO ACP-RTN.                                               I.091217
006780 ACP-05.                                                          I.091217
006790     ACCEPT A-HKC.                                                I.091217
006800     IF ESTAT = BTB                                               I.091217
006810         GO TO ACP-RTN.                                           I.091217
006820     IF ESTAT NOT = HTB AND SKP                                   I.091217
006830         GO TO ACP-05.                                            I.091217
006840     IF W-HKC = 1                                                 I.091217
006850         DISPLAY D-SHMC                                           I.091217
006860         GO TO ACP-20.                                            I.091217
006870     IF W-HKC NOT = 2                                             I.091217
006880         GO TO ACP-05.                                            I.091217
006890     DISPLAY D-SHM.                                               I.091217
006900 ACP-10.                                                          I.091217
006910     ACCEPT A-SDNO.                                               I.091217
006920     IF ESTAT = BTB                                               I.091217
006930         GO TO ACP-05.                                            I.091217
006940     IF ESTAT NOT = HTB AND SKP                                   I.091217
006950         GO TO ACP-10.                                            I.091217
006960 ACP-15.                                                          I.091217
006970     ACCEPT A-EDNO.                                               I.091217
006980     IF ESTAT = BTB                                               I.091217
006990         GO TO ACP-10.                                            I.091217
007000     IF ESTAT NOT = HTB AND SKP                                   I.091217
007010         GO TO ACP-15.                                            I.091217
007020     IF W-SDNO > W-EDNO                                           I.091217
007030         GO TO ACP-15.                                            I.091217
007040 ACP-20.                                                          I.091217
007050     ACCEPT A-DMM.                                                I.091217
007060     IF ESTAT = BTB                                               I.091217
007070         IF W-HKC = 1                                             I.091217
007080             GO TO ACP-05                                         I.091217
007090           ELSE                                                   I.091217
007100             GO TO ACP-15.                                        I.091217
007110     IF ESTAT NOT = HTB AND SKP                                   I.091217
007120         GO TO ACP-20.                                            I.091217
007130     IF W-DMM = 9                                                 I.091217
007140         GO TO ACP-05.                                            I.091217
007150     IF W-DMM NOT = 1                                             I.091217
007160         GO TO ACP-20.                                            I.091217
007170 ACP-EX.                                                          I.091217
007180     EXIT.                                                        I.091217
007190 NAM-RTN.
007200     MOVE SPACE TO W-ANA W-AHNA W-ACOR.
007210     MOVE ZERO TO W-NC1.
007220     IF TDI-TCD = 4990
007230         MOVE TDI-TRN TO W-ANA
007240         GO TO NAM-05.
007250     MOVE TDI-HCD TO HI-MHCD HI-HCD.
007260     READ HI2-M WITH UNLOCK INVALID KEY
007270         DISPLAY E-ME5 E-ME99
007280         DISPLAY E-CL
007290         MOVE SPACE TO HI-NAME.
007300     MOVE HI-NAME TO W-ANA.
007310 NAM-05.
007320     ADD 1 TO W-NC1.
007330     IF W-NC1 > 24
007340         GO TO NAM-EX.
007350     MOVE W-NA(W-NC1) TO W-HNA(W-NC1).
007360     IF W-NA(W-NC1) NOT = SPACE
007370         GO TO NAM-05.
007380     ADD 1 TO W-NC1.
007390     IF W-NC1 > 24
007400         GO TO NAM-EX.
007410     MOVE W-NA(W-NC1) TO W-HNA(W-NC1).
007420     IF W-NA(W-NC1) NOT = SPACE
007430         GO TO NAM-05.
007440     IF TDI-TCD = 4990
007450         GO TO NAM-EX.
007460     MOVE ZERO TO W-NC2.
007470 NAM-10.
007480     ADD 1 TO W-NC1.
007490     IF W-NC1 > 24
007500         GO TO NAM-EX.
007510     IF W-NC2 = 0
007520         IF W-NA(W-NC1) = SPACE
007530             GO TO NAM-10.
007540     ADD 1 TO  W-NC2.
007550     IF W-NC2 < 9
007560         MOVE W-NA(W-NC1) TO W-COR(W-NC2)
007570         GO TO NAM-10.
007580 NAM-EX.
007590     EXIT.
007600 SIZ-RTN.
007610     MOVE ZERO TO W-SC W-INV.
007620 SIZ-05.
007630     ADD 1 TO W-SC.
007640     IF W-SC > 34
007650         MOVE 1 TO W-INV
007660         DISPLAY E-ME6 E-ME99
007670         DISPLAY E-CL
007680         GO TO SIZ-EX.
007690     IF TDI-SIZ NOT = W-SZ(W-SC)
007700         GO TO SIZ-05.
007710 SIZ-EX.
007720     EXIT.
007730 KEI-RTN.
007740     MOVE SPACE TO W-P03.
007750     MOVE W-15K TO P-15K3.
007760     MOVE W-20K TO P-20K3.
007770     MOVE SPACE TO P-HNA P-COR.
007780     MOVE WT-SU TO P-SU.
007790     MOVE WT-GKIN TO P-GKIN.
007800     MOVE WT-UKIN TO P-UKIN.
007810     MOVE SPACE TO SP-R.
007820     MOVE W-P03 TO SP-R.
007830     WRITE SP-R AFTER W-LC.
007840     MOVE SPACE TO SP-R.
007850     IF W-HNO NOT = SPACE
007860         MOVE SPACE TO W-P01
007870         MOVE W-20K TO P-20K1
007880         MOVE W-HNO TO P-NAME
007890         MOVE W-P01 TO SP-R
007900         WRITE SP-R AFTER 3
007910         MOVE SPACE TO SP-R.
007920 KEI-EX.
007930     EXIT.
007940 REW-RTN.
007950     MOVE SPACE TO TDI-KEY.
007960     MOVE W-DNO TO TDI-DNO.
007970     START TDIF KEY NOT < TDI-KEY INVALID KEY
007980         MOVE 9 TO W-END
007990         DISPLAY E-ME78 E-ME1 E-ME99
008000         GO TO REW-EX.
008010 REW-05.
008020     READ TDIF NEXT RECORD AT END
008030         GO TO REW-EX.
008040     IF TDI-DNO NOT = W-DNO
008050         GO TO REW-EX.
008060     MOVE 9 TO TDI-PRC.
008070     REWRITE TDI-R INVALID KEY
008080         MOVE 9 TO W-END
008090         DISPLAY E-ME78 E-STAT E-ME11 E-ME99
008100         GO TO REW-EX.
008110     GO TO REW-05.
008120 REW-EX.
008130     EXIT.
008140 TST-RTN.
008150     IF W-POC = 0
008160         OPEN OUTPUT SP-F
008170         MOVE 1 TO W-POC
008180       ELSE
008190         MOVE SPACE TO SP-R
008200         WRITE SP-R AFTER PAGE.
008210     MOVE SPACE TO W-P01.
008220     MOVE W-20K TO P-20K1.
008230     MOVE "XXXX" TO P-NAME.
008240     MOVE W-P01 TO SP-R.
008250     WRITE SP-R AFTER 2.
008260     MOVE SPACE TO SP-R.
008270*
008280     MOVE SPACE TO W-P02.
008290     MOVE W-15K TO P-15K2.
008300     MOVE W-20K TO P-20K2.
008310     MOVE ALL NC"‚m" TO P-TNA.
008320     MOVE SPACE TO P-NR.
008330     MOVE SPACE TO SP-R.
008340     MOVE W-P02 TO SP-R.
008350     WRITE SP-R AFTER 3.
008360     MOVE SPACE TO SP-R.
008370*
008380     MOVE SPACE TO W-P02.
008390     MOVE W-15K TO P-15K2.
008400     MOVE W-20K TO P-20K2.
008410     MOVE SPACE TO P-TNA.
008420     MOVE NC"“úiƒSƒ€‡Š" TO P-NR.
008430     MOVE SPACE TO SP-R.
008440     MOVE W-P02 TO SP-R.
008450     WRITE SP-R.
008460     MOVE SPACE TO SP-R.
008470*
008480     MOVE SPACE TO W-P02.
008490     MOVE W-15K TO P-15K2.
008500     MOVE W-20K TO P-20K2.
008510     MOVE SPACE TO P-NR.
008520     MOVE ALL NC"‚m" TO P-TNA.
008530     MOVE 99 TO P-SCD P-NNEN P-NGET P-NPEY.
008540     MOVE 999 TO P-MCD P-BRC.
008550     MOVE "XX" TO P-DPC.
008560     MOVE 999999 TO P-THC.
008570     MOVE SPACE TO SP-R.
008580     MOVE W-P02 TO SP-R.
008590     WRITE SP-R.
008600     MOVE SPACE TO SP-R.
008610     WRITE SP-R AFTER 3.
008620     MOVE ZERO TO W-LC.
008630 TST-05.
008640     MOVE SPACE TO W-P03.
008650     MOVE W-15K TO P-15K3.
008660     MOVE W-20K TO P-20K3.
008670     MOVE ALL NC"‚m" TO P-HNA P-COR.
008680     MOVE "XXXX" TO P-SIZ.
008690     MOVE 99999 TO P-SU.
008700     MOVE 999999 TO P-GTN P-UTN.
008710     MOVE 999999999 TO P-GKIN P-UKIN.
008720     MOVE SPACE TO SP-R.
008730     MOVE W-P03 TO SP-R.
008740     WRITE SP-R AFTER 2.
008750     MOVE SPACE TO SP-R.
008760     ADD 1 TO W-LC.
008770     IF W-LC < 6
008780         GO TO TST-05.
008790     MOVE SPACE TO W-P03.
008800     MOVE W-15K TO P-15K3.
008810     MOVE W-20K TO P-20K3.
008820     MOVE SPACE TO P-HNA P-COR.
008830     MOVE 99999 TO P-SU.
008840     MOVE 999999999 TO P-GKIN P-UKIN.
008850     MOVE SPACE TO SP-R.
008860     MOVE W-P03 TO SP-R.
008870     WRITE SP-R AFTER 2.
008880     MOVE SPACE TO SP-R.
008890 TST-EX.
008900     EXIT.
