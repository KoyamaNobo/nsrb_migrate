000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JHS15U.
000030********************************************************
000040*****    その他受信データ生成（赤ちゃん本舗）      *****
000050********************************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     SELECT JCAASF ASSIGN TO JCAAS-MSD
000130         ORGANIZATION RELATIVE
000140         FILE STATUS IS ERR-STAT.
000150     SELECT JCAASRF ASSIGN TO JCAASR-MSD
000160         FILE STATUS IS ERR-STAT.
000170     SELECT AKATF ASSIGN TO AKAT-MSD.
000180 DATA DIVISION.
000190 FILE SECTION.
000200 FD  JCAASF
000210     BLOCK  2 RECORDS
000220     LABEL RECORD IS STANDARD
000230     VALUE OF IDENTIFICATION "JCAASF".
000240 01  JCAAS-R.
000250     02  JCAAS-RC       PIC  X(001).
000260     02  JCAAS-REC1     PIC  X(126).
000270     02  JCAAS-REC2  REDEFINES JCAAS-REC1.
000280       03  JCAAS-DC     PIC  9(002).
000290       03  JCAAS-NG     PIC  9(006).
000300       03  JCAAS-TCD    PIC  9(006).
000310       03  JCAAS-CS     PIC  9(001).
000320       03  JCAAS-MC     PIC  9(002).
000330       03  JCAAS-DATE   PIC  9(008).
000340       03  JCAAS-DNO    PIC  9(011).
000350       03  JCAAS-TSC    PIC  9(002).
000360       03  JCAAS-BMC    PIC  9(007).
000370       03  JCAAS-KINF   PIC  X(001).
000380       03  JCAAS-KIN    PIC  9(009).
000390       03  JCAAS-SHZF   PIC  X(001).
000400       03  JCAAS-SHZ    PIC  9(007).
000410       03  JCAAS-KEIF   PIC  X(001).
000420       03  JCAAS-KEI    PIC  9(009).
000430       03  JCAAS-TSKF   PIC  X(001).
000440       03  JCAAS-TSK    PIC  9(009).
000450       03  JCAAS-RIT    PIC  9(003)V9(02).
000460       03  JCAAS-TEK    PIC  X(015).
000470       03  F            PIC  X(023).
000480     02  JCAAS-CHK      PIC  X(001).
000490 FD  JCAASRF
000500     BLOCK  2 RECORDS
000510     LABEL RECORD IS STANDARD
000520     VALUE OF IDENTIFICATION "JCAASRF".
000530 01  JCAASR-R.
000540     02  JCAASR-RC      PIC  X(001).
000550     02  JCAASR-REC1    PIC  X(121).
000560     02  JCAASR-REC2  REDEFINES JCAASR-REC1.
000570       03  JCAASR-DC    PIC  9(002).
000580       03  JCAASR-NG    PIC  9(006).
000590       03  JCAASR-TCD   PIC  9(006).
000600       03  JCAASR-CS    PIC  9(001).
000610       03  JCAASR-MC    PIC  9(002).
000620       03  JCAASR-DATE  PIC  9(008).
000630       03  JCAASR-DNO   PIC  9(011).
000640       03  JCAASR-TSC   PIC  9(002).
000650       03  JCAASR-BMC   PIC  9(007).
000660       03  JCAASR-KINF  PIC  X(001).
000670       03  JCAASR-KIN   PIC  9(009).
000680       03  JCAASR-SHZF  PIC  X(001).
000690       03  JCAASR-SHZ   PIC  9(007).
000700       03  JCAASR-KEIF  PIC  X(001).
000710       03  JCAASR-KEI   PIC  9(009).
000720       03  JCAASR-TSKF  PIC  X(001).
000730       03  JCAASR-TSK   PIC  9(009).
000740       03  JCAASR-RIT   PIC  9(003)V9(02).
000750       03  JCAASR-TEK   PIC  X(015).
000760       03  F            PIC  X(018).
000770     02  JCAASR-NGP     PIC  9(006).
000780 FD  AKATF
000790     BLOCK  2 RECORDS
000800     LABEL RECORD IS STANDARD
000810     VALUE OF IDENTIFICATION WK0128ID.
000820 01  AKAT-R.
000830     02  AKAT-DC        PIC  9(002).
000840     02  AKAT-NG        PIC  9(006).
000850     02  AKAT-TCD       PIC  9(006).
000860     02  AKAT-CS        PIC  9(001).
000870     02  AKAT-MC        PIC  9(002).
000880     02  AKAT-DATE      PIC  9(008).
000890     02  AKAT-DNO       PIC  9(011).
000900     02  AKAT-TSC       PIC  9(002).
000910     02  AKAT-BMC       PIC  9(007).
000920     02  AKAT-KIN       PIC S9(009).
000930     02  AKAT-SHZ       PIC S9(007).
000940     02  AKAT-KEI       PIC S9(009).
000950     02  AKAT-TSK       PIC S9(009).
000960     02  AKAT-RIT       PIC  9(003)V9(02).
000970     02  AKAT-TEK       PIC  X(015).
000980     02  F              PIC  X(029).
000990 WORKING-STORAGE SECTION.
001000 77  ERR-STAT           PIC  X(002).
001010 77  W-FILE             PIC  X(013).
001020 77  WK0128ID           PIC  X(009) VALUE SPACE.
001030 01  STN-NO.
001040     02  STN-NO1        PIC  X(003).
001050     02  STN-NO2        PIC  X(003).
001060 01  W-FID.
001070     02  W-FID1         PIC  X(006) VALUE "WK0128".
001080     02  W-FID2         PIC  X(003).
001090 01  W-DATE             PIC  9(006).
001100 SCREEN SECTION.
001110 SD  C-CRT
001120     END STATUS IS ESTAT.
001130 01  C-CLEAR.
001140     02  LINE   1  CLEAR SCREEN.
001150 01  C-MID.
001160     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
001170          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001180     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
001190          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001200     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
001210          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
001220     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
001230          NC"＊＊＊　　その他受信データ累積・生成　　＊＊＊".
001240     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
001250          NC"＊＊＊　　　　（赤ちゃん本舗）　　　　　＊＊＊".
001260     02  LINE   8  COLUMN  10  PIC  N(023) VALUE
001270          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001280     02  LINE   9  COLUMN  10  PIC  N(023) VALUE
001290          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001300 01  C-ERR.
001310     02  LINE  24.
001320       03  E-ME1   COLUMN  15  PIC  N(006) VALUE
001330            NC"データ　なし".
001340       03  E-ME2   COLUMN  15  PIC  N(007) VALUE
001350            NC"データ　エラー".
001360       03  E-ME5   COLUMN  15  PIC  N(005) VALUE
001370            NC"累積　済み".
001380       03  E-ME12  COLUMN  15  PIC  X(026) VALUE
001390            "***  JCAARF WRITE ｴﾗｰ  ***".
001400     COPY LSSEM.
001410 PROCEDURE DIVISION.
001420 M-05.
001430     DISPLAY C-CLEAR.
001440     DISPLAY C-MID.
001450*
001460     OPEN I-O JCAASF.
001470 M-10.
001480     READ JCAASF AT END
001490         MOVE 255 TO COMPLETION-CODE
001500         CLOSE JCAASF
001510         DISPLAY E-ME1 E-ME99
001520         GO TO M-95.
001530     IF JCAAS-CHK = 1
001540         DISPLAY E-ME5 E-ME99
001550         DISPLAY E-CL
001560         GO TO M-10.
001570     IF JCAAS-RC NOT = "A"
001580         MOVE 255 TO COMPLETION-CODE
001590         CLOSE JCAASF
001600         DISPLAY E-ME2 E-ME99
001610         GO TO M-95.
001620     ACCEPT W-DATE FROM DATE.
001630     OPEN EXTEND JCAASRF.
001640 M-15.
001650     INITIALIZE JCAASR-R.
001660     MOVE JCAAS-R TO JCAASR-R.
001670     MOVE W-DATE TO JCAASR-NGP.
001680     WRITE JCAASR-R.
001690     IF ERR-STAT = "00"
001700         GO TO M-20.
001710     DISPLAY E-STAT E-ME12 E-ME99.
001720     IF ERR-STAT NOT = "34"
001730         MOVE 255 TO COMPLETION-CODE
001740         CLOSE JCAASF
001750         CLOSE JCAASRF
001760         DISPLAY E-ME78 E-ME99
001770         GO TO M-95.
001780     DISPLAY E-CL.
001790     CLOSE JCAASRF.
001800     MOVE "JCAASRF      " TO W-FILE.
001810     DISPLAY E-ME71 E-ME98 STOP " ".
001820     DISPLAY E-CL.
001830     OPEN EXTEND JCAASRF.
001840     GO TO M-15.
001850 M-20.
001860     MOVE 1 TO JCAAS-CHK.
001870     REWRITE JCAAS-R.
001880*
001890     READ JCAASF AT END
001900         GO TO M-25.
001910     GO TO M-15.
001920 M-25.
001930     CLOSE JCAASF.
001940     CLOSE JCAASRF.
001950*
001960     CALL "CBLSTNNO" USING STN-NO.
001970     MOVE STN-NO2 TO W-FID2.
001980     MOVE W-FID TO WK0128ID.
001990     OPEN INPUT JCAASF.
002000     OPEN OUTPUT AKATF.
002010 M-30.
002020     READ JCAASF AT END
002030         GO TO M-90.
002040     IF JCAAS-RC NOT = "D"
002050         GO TO M-30.
002060*
002070     MOVE SPACE TO AKAT-R.
002080     MOVE JCAAS-DC   TO AKAT-DC.
002090     MOVE JCAAS-NG   TO AKAT-NG.
002100     MOVE JCAAS-TCD  TO AKAT-TCD.
002110     MOVE JCAAS-CS   TO AKAT-CS.
002120     MOVE JCAAS-MC   TO AKAT-MC.
002130     MOVE JCAAS-DATE TO AKAT-DATE.
002140     MOVE JCAAS-DNO  TO AKAT-DNO.
002150     MOVE JCAAS-TSC  TO AKAT-TSC.
002160     MOVE JCAAS-BMC  TO AKAT-BMC.
002170     MOVE JCAAS-KIN  TO AKAT-KIN.
002180     IF JCAAS-KINF = "-"
002190         COMPUTE AKAT-KIN = -1 * AKAT-KIN.
002200     MOVE JCAAS-SHZ  TO AKAT-SHZ.
002210     IF JCAAS-SHZF = "-"
002220         COMPUTE AKAT-SHZ = -1 * AKAT-SHZ.
002230     MOVE JCAAS-KEI  TO AKAT-KEI.
002240     IF JCAAS-KEIF = "-"
002250         COMPUTE AKAT-KEI = -1 * AKAT-KEI.
002260     MOVE JCAAS-TSK  TO AKAT-TSK.
002270     IF JCAAS-TSKF = "-"
002280         COMPUTE AKAT-TSK = -1 * AKAT-TSK.
002290     MOVE JCAAS-RIT  TO AKAT-RIT.
002300     MOVE JCAAS-TEK  TO AKAT-TEK.
002310     WRITE AKAT-R.
002320     GO TO M-30.
002330 M-90.
002340     CLOSE JCAASF.
002350     CLOSE AKATF.
002360 M-95.
002370     DISPLAY C-CLEAR.
002380     STOP RUN.
