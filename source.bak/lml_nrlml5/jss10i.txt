000010 IDENTIFICATION         DIVISION.
000020 PROGRAM-ID.            JSS10I.
000030*********************************************************
000040*    PROGRAM         :  ¶‹¦”­’‘“ü—Í@@              *
000050*    PRINTER TYPE    :  UNUSED                          *
000060*    SCREEN          :  SJS10I                          *
000070*    DATE      @@  :  04/02/01                        *
000080*    COMPILE TYPE    :  CBL85(74)                       *
000090*********************************************************
000100 ENVIRONMENT            DIVISION.
000110 CONFIGURATION          SECTION.
000120 SOURCE-COMPUTER.       EXPRESS5800.
000130 OBJECT-COMPUTER.       EXPRESS5800.
000140 INPUT-OUTPUT           SECTION.
000150 FILE-CONTROL.
000160     SELECT  T-M      ASSIGN TO            T1-MSD T2-MSD
000170                      ORGANIZATION         INDEXED
000180                      RECORD KEY           T-KEY
000190                      ALTERNATE RECORD KEY T-KEY2
000200                      ACCESS MODE          DYNAMIC
000210                      FILE STATUS IS       ERR-STAT.
000220     SELECT  TC-M     ASSIGN TO            TC-MSD
000230                      ORGANIZATION         INDEXED
000240                      RECORD KEY           TC-KEY
000250                      ACCESS MODE          DYNAMIC
000260                      FILE STATUS IS       ERR-STAT.
000270     SELECT  HI2-M    ASSIGN TO            HI-MSD
000280                      ORGANIZATION         INDEXED
000290                      RECORD KEY           HI-KEY2
000300                      ACCESS MODE          DYNAMIC
000310                      FILE STATUS IS       ERR-STAT.
000320     SELECT  THTM     ASSIGN TO            THT1-MSD THT2-MSD
000330                      ORGANIZATION         INDEXED
000340                      RECORD KEY           THT-KEY
000350                      ALTERNATE RECORD KEY THT-KEY2
000360                      ACCESS MODE          DYNAMIC
000370                      FILE STATUS IS       ERR-STAT.
000380     SELECT  STENM    ASSIGN TO            STE-RDB
000390                      ORGANIZATION         INDEXED
000400                      RECORD KEY           STE-KEY1
000410                      ALTERNATE RECORD KEY STE-KEY2
000420                      ACCESS MODE          DYNAMIC
000430                      FILE STATUS IS       ERR-STAT.
000440     SELECT  JCON     ASSIGN TO            JCON-MSD
000450                      ORGANIZATION         INDEXED
000460                      RECORD KEY           JCON1-KEY
000470                      ACCESS MODE          DYNAMIC
000480                      FILE STATUS IS       ERR-STAT.
000490     SELECT  JDCON    ASSIGN TO            JDCON-MSD
000500                      ORGANIZATION         INDEXED
000510                      RECORD KEY           JDCON-KEY
000520                      ACCESS MODE          DYNAMIC
000530                      FILE STATUS IS       ERR-STAT.
000540     SELECT  SK-HAT   ASSIGN TO            HAT-MSD
000550                      ORGANIZATION         INDEXED
000560                      RECORD KEY           HAT-KEY
000570                      ACCESS MODE          DYNAMIC
000580                      FILE STATUS IS       ERR-STAT.
000590*
000600     COPY LIBCSE.
000610 I-O-CONTROL.
000620     APPLY SHARED-MODE ON T-M TC-M HI2-M THTM STENM JCON JDCON
000630                          SK-HAT M-DATE.
000640*****
000650 DATA                   DIVISION.
000660 FILE                   SECTION.
000670     COPY   LITM.
000680     COPY   LITCM.
000690     COPY   LIHIM2.
000700     COPY   LITHTM.
000710     COPY   LSTENM.
000720     COPY   L-JCON.
000730     COPY   LJDCON.
000740     COPY   LSKHAT.
000750     COPY   LIBFDD.
000760****
000770 WORKING-STORAGE        SECTION.
000780 77  ERR-STAT             PIC  X(02).
000790 77  ACT                  PIC  9(01).
000800 77  ACTNM                PIC  N(02).
000810 77  OKC                  PIC  9(01).
000820 01  SYSYMD               PIC  9(08).
000830 01  SYSYMDR              REDEFINES  SYSYMD.
000840     02  SYSYY            PIC  9(04).
000850     02  SYSYYR           REDEFINES  SYSYY.
000860         03  SYSY1        PIC  9(02).
000870         03  SYSY2        PIC  9(02).
000880     02  SYSMM            PIC  9(02).
000890     02  SYSDD            PIC  9(02).
000900*01  W-UNS.
000910*    02  W-UNS-T          OCCURS  10.
000920*        03  W-UNSNM      PIC  N(06).
000930 01  WK-AREA.
000940     02  II               PIC  9(01).
000950     02  JJ               PIC  9(02).
000960     02  KK               PIC  9(02).
000970     02  LIN              PIC  9(02).
000980     02  SV-II            PIC  9(01).
000990     02  O-II             PIC  9(01).
001000     02  SW-HAT           PIC  9(01).
001010     02  SW-HIN           PIC  9(01).
001020     02  SW-HIN4          PIC  9(01).
001030     02  SW-CON           PIC  9(01).
001040     02  SW-JDCON         PIC  9(01).
001050     02  W-NGP.                                                   I.040831
001060       03  W-NEN          PIC  9(04).                             I.040831
001070       03  W-GET          PIC  9(02).                             I.040831
001080       03  W-PEY          PIC  9(02).                             I.040831
001090     02  W-FNGP           PIC  9(08).                             I.040831
001100     02  W-RNGP           PIC  9(08).                             I.040831
001110 01  G-AREA.
001120     02  G-HNO                PIC  9(06).                         ”­’‡‚
001130     02  G-HED.
001140         03  G-SYMD           PIC  9(08).                         I.040406
001150         03  G-SYMDR          REDEFINES  G-SYMD.                  I.040406
001160             04  G-SYY        PIC  9(04).                         I.040406
001170             04  G-SYYR       REDEFINES  G-SYY.                   I.040406
001180                 05  G-SY1    PIC  9(02).                         I.040406
001190                 05  G-SY2    PIC  9(02).                         I.040406
001200             04  G-SMM        PIC  9(02).                         I.040406
001210             04  G-SDD        PIC  9(02).                         I.040406
001220         03  G-NYMD           PIC  9(08).                         ”[•i“ú
001230         03  G-NYMDR          REDEFINES  G-NYMD.
001240             04  G-NYY        PIC  9(04).
001250             04  G-NYYR       REDEFINES  G-NYY.
001260                 05  G-NY1    PIC  9(02).
001270                 05  G-NY2    PIC  9(02).
001280             04  G-NMM        PIC  9(02).
001290             04  G-NDD        PIC  9(02).
001300         03  G-TCCD.
001310             04  G-TCD        PIC  9(04).                         “¾ˆÓæCD
001320             04  G-CCD        PIC  9(03).                         ’¼‘—æCD
001330         03  G-TNM            PIC  N(26).                         “¾ˆÓæ–¼
001340         03  G-CNM            PIC  N(26).                         ’¼‘—æ–¼
001350         03  G-HYMD           PIC  9(08).                         ”­’“ú
001360         03  G-HYMDR          REDEFINES  G-HYMD.
001370             04  G-HYY        PIC  9(04).
001380             04  G-HYYR       REDEFINES  G-HYY.
001390                 05  G-HY1    PIC  9(02).
001400                 05  G-HY2    PIC  9(02).
001410             04  G-HMM        PIC  9(02).
001420             04  G-HDD        PIC  9(02).
001430         03  G-DKB            PIC  9(01).                         “`‹æ
001440         03  G-DNO            PIC  9(10).                         “`•[‡‚
001450     02  G-MEI.
001460         03  G-MEI-T          OCCURS   6.
001470             04  G-HCD        PIC  9(06).                         •i–¼‚b‚c
001480             04  O-HCD        PIC  9(06).
001490             04  G-HNM        PIC  N(24).                         @@•i–¼
001500             04  G-AHCD       PIC  X(13).                         ‘ŠŽè•iCD
001510             04  G-AHCD2      PIC  X(09).                         I.040408
001520             04  G-SIZ        PIC  9(03).                         ƒTƒCƒY
001530             04  G-SKB        PIC  9(01).                         »²½Þ‹æ•ª
001540             04  G-SUR        PIC S9(04).                         ”—Ê
001550             04  G-GTAN       PIC  9(05).                         Œ´’P‰¿
001560             04  G-GKIN       PIC S9(08).                         Œ´‰¿‹àŠz
001570             04  G-UTAN       PIC  9(05).                         ”„’P‰¿
001580             04  G-UKIN       PIC S9(08).                         ”„‰¿‹àŠz
001590     02  G-FOT.
001600         03  G-GSUR           PIC S9(05).                         ‡Œv”—Ê
001610         03  G-GGKIN          PIC S9(08).                         ‡ŒvŒ´‹à
001620         03  G-GUKIN          PIC S9(08).                         ‡Œv”„‹à
001630         03  G-UCD            PIC  9(01).                         ‰^‘—
001640         03  O-UCD            PIC  9(01).
001650         03  G-UNM            PIC  N(06).                         ‰^‘—–¼
001660         03  G-HT             PIC  N(09).                         ”z’B
001670         03  G-KK.                                                Šé‰æ
001680             04  G-KKM        PIC  9(02).                           ŒŽ
001690             04  G-KKS        PIC  9(02).                           T
001700             04  G-KKG        PIC  9(03).                           †
001710         03  O-KK.
001720             04  O-KKM        PIC  9(02).
001730             04  O-KKS        PIC  9(02).
001740             04  O-KKG        PIC  9(03).
001750         03  G-KKNM           PIC  N(23).                         Šé‰æ–¼
001760*
001770 COPY LWMSG.
001780 COPY LWSIZC.
001790*****
001800 SCREEN                 SECTION.
001810 SD  DSP-CRT
001820     END STATUS IS ESTAT.
001830*
001840 01  DSP-CLEAR.
001850     02  LINE  1  CLEAR   SCREEN.
001860*
001870 01  A-AREA.
001880     02  A-L01     LINE  01.
001890         03  A-ACT     COLUMN  70  PIC  9(01)  USING  ACT         ACT
001900                       CHECK OVERFLOW  NO IFC.
001910     02  A-L02     LINE  02.                                      I.040406
001920         03  A-HNO     COLUMN  74  PIC  9(06)  USING  G-HNO       I.040406
001930                       CHECK OVERFLOW  NO IFC.                    I.040406
001940     02  A-L03     LINE  03.
001950*****    03  A-HNO     COLUMN  02  PIC  9(06)  USING  G-HNO       D.040406
001960*****                  CHECK OVERFLOW  NO IFC.                    D.040406
001970         03  A-SYMD.                                              I.040406
001980             04  A-SY  COLUMN  02  PIC  9(02)  USING  G-SY2       I.040406
001990                                       NO IFC.                    I.040406
002000             04  A-SM  COLUMN  05  PIC  9(02)  USING  G-SMM       I.040406
002010                                       NO IFC.                    I.040406
002020             04  A-SD  COLUMN  08  PIC  9(02)  USING  G-SDD       I.040406
002030                       CHECK OVERFLOW  NO IFC.                    I.040406
002040         03  A-NYMD.                                              ”[•i“ú
002050*****        04  A-NY  COLUMN  09  PIC  9(02)  USING  G-NY2       D.040406
002060             04  A-NY  COLUMN  11  PIC  9(02)  USING  G-NY2       I.040406
002070                                       NO IFC.
002080*****        04  A-NM  COLUMN  12  PIC  9(02)  USING  G-NMM       D.040406
002090             04  A-NM  COLUMN  14  PIC  9(02)  USING  G-NMM       I.040406
002100                                       NO IFC.
002110*****        04  A-ND  COLUMN  15  PIC  9(02)  USING  G-NDD       D.040406
002120             04  A-ND  COLUMN  17  PIC  9(02)  USING  G-NDD       I.040406
002130                       CHECK OVERFLOW  NO IFC.
002140         03  A-TCCD.                                              ’¼‘—æ
002150*****        04  A-TCD COLUMN  18  PIC  9(04)  USING  G-TCD       D.040406
002160             04  A-TCD COLUMN  20  PIC  9(04)  USING  G-TCD       I.040406
002170                       CHECK OVERFLOW  NO IFC.
002180*****        04  A-CCD COLUMN  23  PIC  9(03)  USING  G-CCD       D.040406
002190             04  A-CCD COLUMN  25  PIC  9(03)  USING  G-CCD       I.040406
002200                       CHECK OVERFLOW  NO IFC.
002210     02  A-L04     LINE  04.
002220         03  A-HYMD.                                              ”­’“ú
002230*****        04  A-HY  COLUMN  09  PIC  9(02)  USING  G-HY2       D.040406
002240             04  A-HY  COLUMN  11  PIC  9(02)  USING  G-HY2       I.040406
002250                                       NO IFC.
002260*****        04  A-HM  COLUMN  12  PIC  9(02)  USING  G-HMM       D.040406
002270             04  A-HM  COLUMN  14  PIC  9(02)  USING  G-HMM       I.040406
002280                                       NO IFC.
002290*****        04  A-HD  COLUMN  15  PIC  9(02)  USING  G-HDD       D.040406
002300             04  A-HD  COLUMN  17  PIC  9(02)  USING  G-HDD       I.040406
002310                       CHECK OVERFLOW  NO IFC.
002320*****    03  A-DKB     COLUMN  24  PIC  9(01)  USING  G-DKB       D.040406
002330         03  A-DKB     COLUMN  26  PIC  9(01)  USING  G-DKB       I.040406
002340                       CHECK OVERFLOW  NO IFC.
002350     02  A-L05     LINE  05.
002360*****    03  A-DNO     COLUMN  09  PIC  9(10)  USING  G-DNO       D.040406
002370         03  A-DNO     COLUMN  11  PIC  9(10)  USING  G-DNO       D.040406
002380                       CHECK OVERFLOW  NO IFC.
002390     02  A-LLIN    LINE  LIN.
002400         03  A-HCD     COLUMN  02  PIC  9(06)  USING  G-HCD(II)   •i–¼CD
002410                       CHECK OVERFLOW  NO IFC.
002420         03  A-AHCD    COLUMN  09  PIC  X(13)  USING  G-AHCD(II)  ‘ŠŽè•iCD
002430                       CHECK OVERFLOW  NO IFC.
002440         03  A-AHCD2   COLUMN  23  PIC  X(09)  USING  G-AHCD2(II) I.040408
002450                       CHECK OVERFLOW  NO IFC.                    I.040408
002460*****    03  A-SIZ     COLUMN  25  PIC  9(03)  USING  G-SIZ(II)   D.040408
002470         03  A-SIZ     COLUMN  33  PIC  9(03)  USING  G-SIZ(II)   I.040408
002480                       CHECK OVERFLOW  NO IFC.
002490*****    03  A-SUR     COLUMN  33  PIC S9(04)  USING  G-SUR(II)   D.040408
002500         03  A-SUR     COLUMN  38  PIC S9(04)  USING  G-SUR(II)   I.040408
002510                       CHECK OVERFLOW  NO IFC.
002520*****    03  A-GTAN    COLUMN  41  PIC S9(05)  USING  G-GTAN(II)  D.040408
002530         03  A-GTAN    COLUMN  44  PIC S9(05)  USING  G-GTAN(II)  I.040408
002540                       CHECK OVERFLOW  NO IFC.
002550*****    03  A-UTAN    COLUMN  61  PIC S9(05)  USING  G-UTAN(II)  D.040408
002560         03  A-UTAN    COLUMN  63  PIC S9(05)  USING  G-UTAN(II)  I.040408
002570                       CHECK OVERFLOW  NO IFC.
002580     02  A-LLINP1  LINE  LIN PLUS 1.
002590         03  A-HNM     COLUMN  09  PIC  N(24)  USING  G-HNM(II)   •i–¼
002600                       CHECK OVERFLOW  NO IFC.
002610     02  A-L22     LINE  22.
002620         03  A-UCD     COLUMN  07  PIC  9(01)  USING  G-UCD       ‰^‘—
002630                       CHECK OVERFLOW  NO IFC.
002640         03  A-KKM     COLUMN  33  PIC  9(02)  USING  G-KKM       Šé‰æEŒŽ
002650                       CHECK OVERFLOW  NO IFC.
002660         03  A-KKS     COLUMN  37  PIC  9(02)  USING  G-KKS       Šé‰æET
002670                       CHECK OVERFLOW  NO IFC.
002680         03  A-KKG     COLUMN  41  PIC  9(03)  USING  G-KKG       Šé‰æE†
002690                       CHECK OVERFLOW  NO IFC.
002700     02  A-L23     LINE  23.
002710         03  A-HT      COLUMN  07  PIC  N(09)  USING  G-HT        ”z’B
002720                       CHECK OVERFLOW  NO IFC.
002730         03  A-KKNM    COLUMN  33  PIC  N(23)  USING  G-KKNM      Šé‰æ–¼
002740                       CHECK OVERFLOW  NO IFC.
002750     02  A-L24     LINE  24.
002760         03  A-OKC     COLUMN  72  PIC  9(01)  USING  OKC
002770                       CHECK OVERFLOW  NO IFC.
002780*
002790 01  DSP-AREA.
002800     02  D-L01     LINE  01.
002810         03  D-ACTNM COLUMN 72 PIC N(02)       FROM ACTNM.
002820     02  D-L03     LINE  03.
002830         03  D-SYMD.                                              I.040406
002840             04 D-SY COLUMN 02 PIC 9(02)       FROM G-SY2.        I.040406
002850             04 D-SM COLUMN 05 PIC Z9          FROM G-SMM.        I.040406
002860             04 D-SD COLUMN 08 PIC Z9          FROM G-SDD.        I.040406
002870         03  D-NYMD.                                              ”[•i“ú
002880             04 D-NY COLUMN 11 PIC 9(02)       FROM G-NY2.        I.040406
002890             04 D-NM COLUMN 14 PIC Z9          FROM G-NMM.        I.040406
002900             04 D-ND COLUMN 17 PIC Z9          FROM G-NDD.        I.040406
002910         03  D-TNM   COLUMN 29 PIC N(26)       FROM G-TNM.        I.040406
002920*****        04 D-NY COLUMN 09 PIC 9(02)       FROM G-NY2.        D.040406
002930*****        04 D-NM COLUMN 12 PIC Z9          FROM G-NMM.        D.040406
002940*****        04 D-ND COLUMN 15 PIC Z9          FROM G-NDD.        D.040406
002950*****    03  D-TNM   COLUMN 27 PIC N(26)       FROM G-TNM.        D.040406
002960     02  D-L04     LINE  04.
002970         03  D-HYMD.                                              ”­’“ú
002980             04 D-HY COLUMN 11 PIC 9(02)       FROM G-HY2.        I.040406
002990             04 D-HM COLUMN 14 PIC Z9          FROM G-HMM.        I.040406
003000             04 D-HD COLUMN 17 PIC Z9          FROM G-HDD.        I.040406
003010         03  D-CNM   COLUMN 29 PIC N(26)       FROM G-CNM.        I.040406
003020*****        04 D-HY COLUMN 09 PIC 9(02)       FROM G-HY2.        D.040406
003030*****        04 D-HM COLUMN 12 PIC Z9          FROM G-HMM.        D.040406
003040*****        04 D-HD COLUMN 15 PIC Z9          FROM G-HDD.        D.040406
003050*****    03  D-CNM   COLUMN 27 PIC N(26)       FROM G-CNM.        D.040406
003060     02  D-LLIN    LINE  LIN.
003070         03  D-SUR   COLUMN 38 PIC ZZZ9-       FROM G-SUR(II).    I.040408
003080         03  D-GTAN  COLUMN 44 PIC ZZZZ9       FROM G-GTAN(II).   I.040408
003090         03  D-GKIN  COLUMN 50 PIC ---,---,--9 FROM G-GKIN(II).   I.040408
003100         03  D-UTAN  COLUMN 63 PIC ZZZZ9       FROM G-UTAN(II).   I.040408
003110         03  D-UKIN  COLUMN 69 PIC ---,---,--9 FROM G-UKIN(II).   I.040408
003120*****    03  D-SIZ   COLUMN 25 PIC ZZ9         FROM G-SIZ(II).    D.040406
003130*****    03  D-SUR   COLUMN 33 PIC ZZZ9-       FROM G-SUR(II).    D.040408
003140*****    03  D-GTAN  COLUMN 41 PIC ZZZZ9       FROM G-GTAN(II).   D.040408
003150*****    03  D-GKIN  COLUMN 48 PIC ---,---,--9 FROM G-GKIN(II).   D.040408
003160*****    03  D-UTAN  COLUMN 61 PIC ZZZZ9       FROM G-UTAN(II).   D.040408
003170*****    03  D-UKIN  COLUMN 68 PIC ---,---,--9 FROM G-UKIN(II).   D.040408
003180     02  D-L20     LINE  20.
003190         03  D-GSUR  COLUMN 37 PIC ZZZZ9-      FROM G-GSUR.       I.040408
003200         03  D-GGKIN COLUMN 50 PIC ---,---,--9 FROM G-GGKIN.      I.040408
003210         03  D-GUKIN COLUMN 69 PIC ---,---,--9 FROM G-GUKIN.      I.040408
003220*****    03  D-GSUR  COLUMN 32 PIC ZZZZ9-      FROM G-GSUR.       D.040408
003230*****    03  D-GGKIN COLUMN 48 PIC ---,---,--9 FROM G-GGKIN.      D.040408
003240*****    03  D-GUKIN COLUMN 68 PIC ---,---,--9 FROM G-GUKIN.      D.040408
003250     02  D-L22     LINE  22.
003260         03  D-UNM   COLUMN 09 PIC N(06)       FROM G-UNM.        ‰^‘—–¼
003270*
003280 01  C-AREA.
003290     02  C-L01     LINE  01.
003300         03  C-ACT     COLUMN 70 PIC Z           FROM ACT.        ACT
003310         03  C-ACTNM   COLUMN 72 PIC N(02)       FROM ACTNM.
003320     02  C-L02     LINE  02.                                      I.040406
003330         03  C-HNO     COLUMN 74 PIC Z(06)       FROM G-HNO.      I.040406
003340     02  C-L03     LINE  03.
003350*****    03  C-HNO     COLUMN 02 PIC Z(06)       FROM G-HNO.      D.040406
003360         03  C-SYMD.                                              I.040406
003370             04        COLUMN 02 PIC Z(02)       FROM G-SY2.      I.040406
003380             04        COLUMN 05 PIC Z(02)       FROM G-SMM.      I.040406
003390             04        COLUMN 08 PIC Z(02)       FROM G-SDD.      I.040406
003400         03  C-NYMD.                                              ”[•i“ú
003410             04        COLUMN 11 PIC Z(02)       FROM G-NY2.      I.040406
003420             04        COLUMN 14 PIC Z(02)       FROM G-NMM.      I.040406
003430             04        COLUMN 17 PIC Z(02)       FROM G-NDD.      I.040406
003440         03  C-TNM     COLUMN 29 PIC N(26)       FROM G-TNM.      I.040406
003450*****        04        COLUMN 09 PIC Z(02)       FROM G-NY2.      D.040406
003460*****        04        COLUMN 12 PIC Z(02)       FROM G-NMM.      D.040406
003470*****        04        COLUMN 15 PIC Z(02)       FROM G-NDD.      D.040406
003480*****    03  C-TNM     COLUMN 27 PIC N(26)       FROM G-TNM.      D.040406
003490         03  C-TCCD.                                              ’¼‘—æ
003500             04  C-TCD COLUMN 20 PIC Z(04)       FROM G-TCD.      I.040406
003510             04  C-CCD COLUMN 25 PIC Z(03)       FROM G-CCD.      I.040406
003520*****        04  C-TCD COLUMN 18 PIC Z(04)       FROM G-TCD.      D.040406
003530*****        04  C-CCD COLUMN 23 PIC Z(03)       FROM G-CCD.      D.040406
003540     02  C-L04     LINE  04.
003550         03  C-HYMD.                                              ”­’“ú
003560             04        COLUMN 11 PIC Z(02)       FROM G-HY2.      I.040406
003570             04        COLUMN 14 PIC Z(02)       FROM G-HMM.      I.040406
003580             04        COLUMN 17 PIC Z(02)       FROM G-HDD.      I.040406
003590         03  C-DKB     COLUMN 26 PIC Z           FROM G-DKB.      I.040406
003600         03  C-CNM     COLUMN 29 PIC N(26)       FROM G-CNM.      I.040406
003610*****        04        COLUMN 09 PIC Z(02)       FROM G-HY2.      D.040406
003620*****        04        COLUMN 12 PIC Z(02)       FROM G-HMM.      D.040406
003630*****        04        COLUMN 15 PIC Z(02)       FROM G-HDD.      D.040406
003640*****    03  C-DKB     COLUMN 24 PIC Z           FROM G-DKB.      D.040406
003650*****    03  C-CNM     COLUMN 27 PIC N(26)       FROM G-CNM.      D.040406
003660     02  C-L05     LINE  05.
003670         03  C-DNO     COLUMN 11 PIC Z(10)       FROM G-DNO.      I.040406
003680*****    03  C-DNO     COLUMN 09 PIC Z(10)       FROM G-DNO.      D.040406
003690     02  C-LLIN    LINE  LIN.
003700         03  C-HCD     COLUMN 02 PIC Z(06)       FROM G-HCD(II).  •i–¼CD
003710         03  C-AHCD    COLUMN 09 PIC X(13)       FROM G-AHCD(II). ‘ŠŽè•iCD
003720         03  C-AHCD2   COLUMN 23 PIC X(09)       FROM G-AHCD2(II).I.040408
003730         03  C-SIZ     COLUMN 33 PIC Z(03)       FROM G-SIZ(II).  I.040408
003740         03  C-SUR     COLUMN 38 PIC ZZZZ-       FROM G-SUR(II).  I.040408
003750         03  C-GTAN    COLUMN 44 PIC Z(05)       FROM G-GTAN(II). I.040408
003760         03  C-GKIN    COLUMN 50 PIC ---,---,--- FROM G-GKIN(II). I.040408
003770         03  C-UTAN    COLUMN 63 PIC Z(05)       FROM G-UTAN(II). I.040408
003780         03  C-UKIN    COLUMN 69 PIC ---,---,--- FROM G-UKIN(II). I.040408
003790*****    03  C-SIZ     COLUMN 25 PIC Z(03)       FROM G-SIZ(II).  D.040408
003800*****    03  C-SUR     COLUMN 33 PIC ZZZZ-       FROM G-SUR(II).  D.040408
003810*****    03  C-GTAN    COLUMN 41 PIC Z(05)       FROM G-GTAN(II). D.040408
003820*****    03  C-GKIN    COLUMN 48 PIC ---,---,--- FROM G-GKIN(II). D.040408
003830*****    03  C-UTAN    COLUMN 61 PIC Z(05)       FROM G-UTAN(II). D.040408
003840*****    03  C-UKIN    COLUMN 68 PIC ---,---,--- FROM G-UKIN(II). D.040408
003850     02  C-LLINP1  LINE  LIN PLUS 1.
003860         03  C-HNM     COLUMN 09 PIC N(24)       FROM G-HNM(II).  •i–¼
003870     02  C-L20     LINE  20.
003880         03  C-GSUR    COLUMN 37 PIC ------      FROM G-GSUR.     I.040408
003890         03  C-GGKIN   COLUMN 50 PIC ---,---,--- FROM G-GGKIN.    I.040408
003900         03  C-GUKIN   COLUMN 69 PIC ---,---,--- FROM G-GUKIN.    I.040408
003910*****    03  C-GSUR    COLUMN 32 PIC ------      FROM G-GSUR.     D.040408
003920*****    03  C-GGKIN   COLUMN 48 PIC ---,---,--- FROM G-GGKIN.    D.040408
003930*****    03  C-GUKIN   COLUMN 68 PIC ---,---,--- FROM G-GUKIN.    D.040408
003940     02  C-L22     LINE  22.
003950         03  C-UCD     COLUMN 07 PIC Z           FROM G-UCD.      ‰^‘—
003960         03  C-UNM     COLUMN 09 PIC N(06)       FROM G-UNM.      ‰^‘—–¼
003970         03  C-KKM     COLUMN 33 PIC Z(02)       FROM G-KKM.      Šé‰æEŒŽ
003980         03  C-KKS     COLUMN 37 PIC Z(02)       FROM G-KKS.      Šé‰æET
003990         03  C-KKG     COLUMN 41 PIC Z(03)       FROM G-KKG.      Šé‰æE†
004000     02  C-L23     LINE  23.
004010         03  C-HT      COLUMN 07 PIC N(09)       FROM G-HT.       ”z’B
004020         03  C-KKNM    COLUMN 33 PIC N(23)       FROM G-KKNM.     Šé‰æ–¼
004030     02  C-L24     LINE  24.
004040         03  C-OKC     COLUMN 72 PIC Z           FROM OKC.
004050****
004060*
004070     COPY   LSMSG.
004080     02  MSG-SPACE         COLUMN   1   VALUE
004090           "                                                 ".
004100     02  INV-TOK           COLUMN   1   VALUE
004110           "“¾ˆÓæƒ}ƒXƒ^@–¢“o˜^                             ".
004120     02  INV-CHO           COLUMN   1   VALUE
004130           "’¼‘—æƒ}ƒXƒ^@–¢“o˜^                             ".
004140     02  INV-STE           COLUMN   1   VALUE
004150           "ŽÐ“Xƒ}ƒXƒ^@–¢“o˜^                               ".
004160     02  ERR-HNO           COLUMN   1   VALUE
004170           "“¯ˆê”­’‡‚Žg—p’†‚Å‚·                             ".
004180     02  ERR-AHCD1         COLUMN   1   VALUE
004190           "‘ŠŽè•i–¼ƒR[ƒh‚ª“ü—Í‚³‚ê‚Ä‚Ü‚¹‚ñ                 ".
004200     02  ERR-AHCD2         COLUMN   1   VALUE
004210           "“¯ˆêƒR[ƒh‚ª—L‚è‚Ü‚·                             ".
004220     02  ERR-SIZ1          COLUMN   1   VALUE
004230           "ƒTƒCƒY‚ª“ü—Í‚³‚ê‚Ä‚Ü‚¹‚ñ                         ".
004240     02  ERR-SIZ2          COLUMN   1   VALUE
004250           "ƒTƒCƒY–¢“o˜^                                     ".
004260     02  ERR-SIZ3          COLUMN   1   VALUE
004270           "“¯ˆêƒTƒCƒY‚ª—L‚è‚Ü‚·                             ".
004280     02  ERR-HIN           COLUMN   1   VALUE
004290           "•i–¼‚h‚m‚c‚d‚w‚d‚cƒ}ƒXƒ^–¢“o˜^                   ".
004300     02  ERR-ISU           COLUMN   1   VALUE
004310           "“ü”–³‚µ                                         ".
004320     02  ERR-GTAN          COLUMN   1   VALUE
004330           "Œ´’P‰¿‚ªˆá‚¢‚Ü‚·                                 ".
004340     02  ERR-UTAN          COLUMN   1   VALUE
004350           "”„’P‰¿‚ªˆá‚¢‚Ü‚·                                 ".
004360*
004370     COPY  LIBSCR.
004380*****
004390 PROCEDURE              DIVISION.
004400******************************************************************
004410 MR-1.
004420     PERFORM INIT-RTN THRU INIT-EXT.
004430 MR-2.
004440     PERFORM SCRN-RTN THRU SCRN-EXT.
004450 MR-9.
004460     PERFORM END-RTN  THRU END-EX.
004470     STOP RUN.
004480*******************************************************************
004490*    ‰Šúˆ—                                                     *
004500*******************************************************************
004510 INIT-RTN.
004520     CALL "SJS10I".
004530     MOVE "255"          TO COMPLETION-CODE.
004540     ACCEPT  SYSYMD   FROM DATE.
004550     COPY  LIBCPR.
004560     IF SYSY2 >= DATE-NF1 AND <= DATE-NT1
004570        ADD DATE-NC1        TO SYSYY.
004580     IF SYSY2 >= DATE-NF2 AND <= DATE-NT2
004590        ADD DATE-NC2        TO SYSYY.
004600     MOVE SYSYMD TO W-NGP.                                        I.040831
004610     ADD 1 TO W-GET.                                              I.040831
004620     IF W-GET = 13                                                I.040831
004630         ADD 1 TO W-NEN                                           I.040831
004640         MOVE 1 TO W-GET.                                         I.040831
004650     MOVE W-NGP TO W-RNGP.                                        I.040831
004660     MOVE SYSYMD TO W-NGP.                                        I.040831
004670     SUBTRACT 1 FROM W-GET.                                       I.040831
004680     IF W-GET = ZERO                                              I.040831
004690         SUBTRACT 1 FROM W-NEN                                    I.040831
004700         MOVE 12 TO W-GET.                                        I.040831
004710     MOVE W-NGP TO W-FNGP.                                        I.040831
004720*
004730     OPEN INPUT  T-M TC-M HI2-M THTM
004740          I-O    STENM JCON JDCON SK-HAT.
004750*
004760*    INITIALIZE            W-UNS.
004770*    MOVE SPACE         TO JCON2-KEY.
004780*    MOVE 2             TO JCON2-01.
004790*    START JCON KEY NOT < JCON2-KEY INVALID  GO TO INIT-EXT.
004800*INIT-010.
004810*    READ  JCON NEXT UNLOCK AT END           GO TO INIT-EXT.
004820*    IF JCON2-01 NOT = 2                     GO TO INIT-EXT.
004830*
004840*    MOVE JCON2-03      TO W-UNSNM(JCON2-02 + 1).
004850*    GO TO INIT-010.
004860 INIT-EXT.
004870     EXIT.
004880*******************************************************************
004890*    ‰æ–Êˆ—                                                     *
004900*******************************************************************
004910 SCRN-RTN.
004920 SCRN-0.
004930     PERFORM CRE-RTN    THRU CRE-EXT.
004940 SCRN-1.
004950     PERFORM ACT-RTN    THRU ACT-EXT.
004960     IF ESTAT = "P9"                         GO TO SCRN-EXT.
004970 SCRN-2.
004980     PERFORM AHNO-RTN   THRU AHNO-EXT.
004990     IF ESTAT = "09"                         GO TO SCRN-0.
005000*
005010     IF ACT    NOT = 1
005020        PERFORM CRE-2      THRU CRE-EXT                           I.050301
005030        PERFORM DISP-RTN   THRU DISP-EXT
005040        IF SW-HAT NOT = ZERO
005050           DISPLAY INV-D01 DISP-BUZ-J
005060           GO TO SCRN-2
005070        ELSE
005080           IF ACT        = 3
005090              GO TO SCRN-99.
005100 SCRN-2A.                                                         I.040406
005110     PERFORM ASYMD-RTN  THRU ASYMD-EXT.                           I.040406
005120     IF ESTAT = "09"                         GO TO SCRN-2.        I.040406
005130 SCRN-3.
005140     PERFORM ANYMD-RTN  THRU ANYMD-EXT.
005150     IF ESTAT = "09"                         GO TO SCRN-2A.       I.040406
005160*****IF ESTAT = "09"                         GO TO SCRN-2.        D.040406
005170 SCRN-4.
005180     PERFORM ATCCD-RTN  THRU ATCCD-EXT.
005190     IF ESTAT = "09"                         GO TO SCRN-3.
005200 SCRN-5.
005210     PERFORM AHYMD-RTN  THRU AHYMD-EXT.
005220     IF ESTAT = "09"                         GO TO SCRN-4.
005230 SCRN-6.
005240     PERFORM ADKB-RTN   THRU ADKB-EXT.
005250     IF ESTAT = "09"                         GO TO SCRN-5.
005260 SCRN-7.
005270     PERFORM ADNO-RTN   THRU ADNO-EXT.
005280     IF ESTAT = "09"                         GO TO SCRN-6.
005290 SCRN-10.
005300     MOVE 1             TO II.
005310 SCRN-11.
005320     COMPUTE LIN = II * 2 + 6.
005330*
005340     PERFORM AHCD-RTN   THRU AHCD-EXT.
005350     IF ESTAT = "09"
005360        IF II     = 1
005370           GO TO SCRN-7
005380        ELSE
005390           COMPUTE II  = II  - 1
005400           GO TO SCRN-11.
005410     IF ESTAT     = "04"
005420        MOVE II      TO SV-II
005430        PERFORM VARYING II FROM II BY 1 UNTIL II > 6
005440                INITIALIZE G-MEI-T(II)
005450                COMPUTE LIN = II * 2 + 6
005460                DISPLAY C-LLIN C-LLINP1
005470        END-PERFORM
005480        MOVE ZERO    TO G-GSUR G-GGKIN G-GUKIN
005490        PERFORM VARYING JJ FROM 1 BY 1 UNTIL JJ > 6
005500                ADD  G-SUR(JJ)     TO G-GSUR
005510                ADD  G-GKIN(JJ)    TO G-GGKIN
005520                ADD  G-UKIN(JJ)    TO G-GUKIN
005530        END-PERFORM
005540        DISPLAY D-L20
005550        GO TO SCRN-30.
005560 SCRN-12.
005570     PERFORM AHNM-RTN   THRU AHNM-EXT.
005580     IF ESTAT = "09"                         GO TO SCRN-11.
005590 SCRN-13.
005600     PERFORM AAHCD-RTN  THRU AAHCD-EXT.
005610     IF ESTAT = "09"                         GO TO SCRN-12.
005620 SCRN-13A.                                                        I.040408
005630     PERFORM AAHCD2-RTN THRU AAHCD2-EXT.                          I.040408
005640     IF ESTAT = "09"                         GO TO SCRN-13.       I.040408
005650 SCRN-14.
005660     PERFORM ASIZ-RTN   THRU ASIZ-EXT.
005670     IF ESTAT = "09"                         GO TO SCRN-13A.      I.040408
005680*****IF ESTAT = "09"                         GO TO SCRN-13.       D.040408
005690 SCRN-15.
005700     PERFORM ASUR-RTN   THRU ASUR-EXT.
005710     IF ESTAT = "09"                         GO TO SCRN-14.
005720 SCRN-16.
005730     PERFORM AGTAN-RTN  THRU AGTAN-EXT.
005740     IF ESTAT = "09"                         GO TO SCRN-15.
005750 SCRN-17.
005760     PERFORM AUTAN-RTN  THRU AUTAN-EXT.
005770     IF ESTAT = "09"                         GO TO SCRN-16.
005780 SCRN-18.
005790     MOVE II            TO SV-II.
005800*
005810     IF II NOT = 6
005820        COMPUTE II  = II  + 1
005830        GO TO SCRN-11.
005840 SCRN-30.
005850     PERFORM AUCD-RTN   THRU AUCD-EXT.
005860     IF ESTAT = "09"
005870        MOVE SV-II      TO II
005880        GO TO SCRN-11.
005890 SCRN-31.
005900     PERFORM AHT-RTN    THRU AHT-EXT.
005910     IF ESTAT = "09"                         GO TO SCRN-30.
005920 SCRN-32.
005930     PERFORM AKKM-RTN   THRU AKKM-EXT.
005940     IF ESTAT = "09"                         GO TO SCRN-31.
005950 SCRN-33.
005960     PERFORM AKKS-RTN   THRU AKKS-EXT.
005970     IF ESTAT = "09"                         GO TO SCRN-32.
005980 SCRN-34.
005990     PERFORM AKKG-RTN   THRU AKKG-EXT.
006000     IF ESTAT = "09"                         GO TO SCRN-33.
006010 SCRN-35.
006020     PERFORM HKKNM-RTN  THRU HKKNM-EXT.
006030 SCRN-36.
006040     PERFORM AKKNM-RTN  THRU AKKNM-EXT.
006050     IF ESTAT = "09"                         GO TO SCRN-34.
006060 SCRN-99.
006070     PERFORM OKC-RTN    THRU OKC-EXT.
006080     IF OKC   = 9                            GO TO SCRN-0.
006090     IF ESTAT = "09"
006100        IF ACT   = 3            GO TO SCRN-2
006110        ELSE                    GO TO SCRN-36.
006120 SCRN-UPD.
006130     PERFORM UPDT-RTN  THRU UPDT-EXT.
006140     DISPLAY OK-01.
006150*
006160     PERFORM JDCON-DEL-RTN THRU JDCON-DEL-EXT.
006170*
006180     IF ACT = 1
006190        PERFORM VARYING II FROM 1 BY 1 UNTIL II > 6
006200                MOVE SPACE          TO G-AHCD(II)
006210                MOVE ZERO           TO G-UKIN(II)
006220                COMPUTE LIN = II * 2 + 6
006230                DISPLAY C-AHCD C-UKIN
006240        END-PERFORM
006250        MOVE ZERO          TO G-DNO G-GUKIN OKC
006260        DISPLAY C-DNO C-GUKIN C-OKC
006270        IF G-HCD(6) = ZERO
006280           GO TO SCRN-3
006290        ELSE
006300           GO TO SCRN-7
006310     ELSE
006320        PERFORM CRE-1     THRU CRE-EXT
006330        GO TO SCRN-2.
006340 SCRN-EXT.
006350     EXIT.
006360*-----------------------------------------------------------------*
006370*    “ü—Í€–Ú                                                     *
006380*-----------------------------------------------------------------*
006390*****                                                             ˆ—‹æ•ª
006400 ACT-RTN.
006410 ACT-0.
006420     ACCEPT  A-ACT.
006430     DISPLAY MSG-SPACE.
006440     IF ESTAT     = "P9"                     GO TO ACT-EXT.
006450     IF ESTAT NOT = "01" AND "06"            GO TO ACT-0.
006460 ACT-CHK.
006470     IF ACT   NOT = 1 AND 2 AND 3
006480        GO TO ACT-0.
006490*
006500     EVALUATE ACT
006510         WHEN 1       MOVE NC"’Ç‰Á"   TO ACTNM
006520         WHEN 2       MOVE NC"•ÏX"   TO ACTNM
006530         WHEN 3       MOVE NC"ŽæÁ"   TO ACTNM
006540         WHEN OTHER   MOVE SPACE      TO ACTNM
006550     END-EVALUATE.
006560     DISPLAY D-ACTNM.
006570 ACT-EXT.
006580     EXIT.
006590*****                                                             ”­’‡‚
006600 AHNO-RTN.
006610     IF ACT       = 1
006620        MOVE ZERO       TO G-HNO
006630        DISPLAY C-HNO
006640        GO TO AHNO-EXT.
006650*
006660     PERFORM JDCON-DEL-RTN THRU JDCON-DEL-EXT.
006670 AHNO-0.
006680     ACCEPT  A-HNO.
006690     DISPLAY MSG-SPACE.
006700     IF ESTAT     = "09"                     GO TO AHNO-EXT.
006710     IF ESTAT NOT = "01" AND "06"            GO TO AHNO-0.
006720 AHNO-CHK.
006730     PERFORM JDCON-WRI-RTN THRU JDCON-WRI-EXT.
006740     IF SW-JDCON NOT = ZERO                  GO TO AHNO-0.
006750 AHNO-EXT.
006760     EXIT.
006770*****                                                             ”[•i“ú
006780 ASYMD-RTN.                                                       I.040406
006790 ASYMD-0.                                                         I.040406
006800     ACCEPT  A-SY.                                                I.040406
006810     DISPLAY MSG-SPACE.                                           I.040406
006820     IF ESTAT      = "09"                    GO TO ASYMD-EXT.     I.040406
006830     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO ASYMD-0.       I.040406
006840     DISPLAY D-SY.                                                I.040406
006850 ASYMD-1.                                                         I.040406
006860     ACCEPT  A-SM.                                                I.040406
006870     DISPLAY MSG-SPACE.                                           I.040406
006880     IF ESTAT      = "09"                    GO TO ASYMD-0.       I.040406
006890     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO ASYMD-1.       I.040406
006900     DISPLAY D-SM.                                                I.040406
006910     IF G-SMM      > 12                      GO TO ASYMD-1.       I.040406
006920 ASYMD-2.                                                         I.040406
006930     ACCEPT  A-SD.                                                I.040406
006940     DISPLAY MSG-SPACE.                                           I.040406
006950     IF ESTAT      = "09"                    GO TO ASYMD-1.       I.040406
006960     IF ESTAT  NOT = "01" AND "06"           GO TO ASYMD-2.       I.040406
006970     DISPLAY D-SD.                                                I.040406
006980     IF G-SMM      = 2                                            I.040406
006990        IF G-SDD      > 29                                        I.040406
007000           GO TO ASYMD-2                                          I.040406
007010        END-IF                                                    I.040406
007020     ELSE                                                         I.040406
007030        IF G-SMM      = 4 OR 6 OR 9 OR 11                         I.040406
007040           IF G-SDD      > 30                                     I.040406
007050              GO TO ASYMD-2                                       I.040406
007060           END-IF                                                 I.040406
007070        ELSE                                                      I.040406
007080           IF G-SDD      > 31                                     I.040406
007090              GO TO ASYMD-2.                                      I.040406
007100 ASYMD-CHK.                                                       I.040406
007110     IF ZERO = G-SY2 AND G-SMM AND G-SDD                          I.040406
007120        MOVE SYSYMD        TO G-SYMD                              I.040406
007130        DISPLAY D-SYMD                                            I.040406
007140        GO TO ASYMD-CHK-1.                                        I.040406
007150*
007160     MOVE ZERO          TO G-SY1                                  I.040406
007170     IF G-SY2      >= DATE-NF1 AND <= DATE-NT1                    I.040406
007180        ADD  DATE-NC1      TO G-SYY.                              I.040406
007190     IF G-SY2      >= DATE-NF2 AND <= DATE-NT2                    I.040406
007200        ADD  DATE-NC2      TO G-SYY.                              I.040406
007210 ASYMD-CHK-1.                                                     I.040406
007220     IF G-SYMD  < W-FNGP OR > W-RNGP                              I.040831
007230        GO TO ASYMD-0.                                            I.040831
007240     IF G-SMM      < 1 OR > 12                                    I.040406
007250        GO TO ASYMD-1.                                            I.040406
007260     IF G-SDD      < 1                                            I.040406
007270        GO TO ASYMD-2.                                            I.040406
007280     IF G-SMM      = 2                                            I.040406
007290        IF G-SDD      > 29                                        I.040406
007300           GO TO ASYMD-2                                          I.040406
007310        END-IF                                                    I.040406
007320     ELSE                                                         I.040406
007330        IF G-SMM      = 4 OR 6 OR 9 OR 11                         I.040406
007340           IF G-SDD      > 30                                     I.040406
007350              GO TO ASYMD-2                                       I.040406
007360           END-IF                                                 I.040406
007370        ELSE                                                      I.040406
007380           IF G-SDD      > 31                                     I.040406
007390              GO TO ASYMD-2.                                      I.040406
007400 ASYMD-EXT.                                                       I.040406
007410     EXIT.                                                        I.040406
007420*****                                                             ”[•i“ú
007430 ANYMD-RTN.
007440 ANYMD-0.
007450     ACCEPT  A-NY.
007460     DISPLAY MSG-SPACE.
007470     IF ESTAT      = "09"                    GO TO ANYMD-EXT.
007480     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO ANYMD-0.
007490     DISPLAY D-NY.
007500 ANYMD-1.
007510     ACCEPT  A-NM.
007520     DISPLAY MSG-SPACE.
007530     IF ESTAT      = "09"                    GO TO ANYMD-0.
007540     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO ANYMD-1.
007550     DISPLAY D-NM.
007560     IF G-NMM      > 12                      GO TO ANYMD-1.
007570 ANYMD-2.
007580     ACCEPT  A-ND.
007590     DISPLAY MSG-SPACE.
007600     IF ESTAT      = "09"                    GO TO ANYMD-1.
007610     IF ESTAT  NOT = "01" AND "06"           GO TO ANYMD-2.
007620     DISPLAY D-ND.
007630     IF G-NMM      = 2
007640        IF G-NDD      > 29
007650           GO TO ANYMD-2
007660        END-IF
007670     ELSE
007680        IF G-NMM      = 4 OR 6 OR 9 OR 11
007690           IF G-NDD      > 30
007700              GO TO ANYMD-2
007710           END-IF
007720        ELSE
007730           IF G-NDD      > 31
007740              GO TO ANYMD-2.
007750 ANYMD-CHK.
007760     IF ZERO = G-NY2 AND G-NMM AND G-NDD
007770        MOVE SYSYMD        TO G-NYMD
007780        DISPLAY D-NYMD
007790        GO TO ANYMD-CHK-1.
007800*
007810     MOVE ZERO          TO G-NY1
007820     IF G-NY2      >= DATE-NF1 AND <= DATE-NT1
007830        ADD  DATE-NC1      TO G-NYY.
007840     IF G-NY2      >= DATE-NF2 AND <= DATE-NT2
007850        ADD  DATE-NC2      TO G-NYY.
007860 ANYMD-CHK-1.
007870     IF G-NYMD  < W-FNGP OR > W-RNGP                              I.040831
007880        GO TO ANYMD-0.                                            I.040831
007890     IF G-NMM      < 1 OR > 12
007900        GO TO ANYMD-1.
007910     IF G-NDD      < 1
007920        GO TO ANYMD-2.
007930     IF G-NMM      = 2
007940        IF G-NDD      > 29
007950           GO TO ANYMD-2
007960        END-IF
007970     ELSE
007980        IF G-NMM      = 4 OR 6 OR 9 OR 11
007990           IF G-NDD      > 30
008000              GO TO ANYMD-2
008010           END-IF
008020        ELSE
008030           IF G-NDD      > 31
008040              GO TO ANYMD-2.
008050*
008060     MOVE SPACE         TO G-HT.                                  I.040402
008070     MOVE G-NMM         TO G-HT(1:2).                             I.040402
008080     MOVE NC"^"        TO G-HT(3:1).                             I.040402
008090     MOVE G-NDD         TO G-HT(4:2).                             I.040402
008100     MOVE NC"”z’BŽw’è"  TO G-HT(6:4).                             I.040402
008110     DISPLAY A-HT.                                                I.040402
008120 ANYMD-EXT.
008130     EXIT.
008140*****                                                             “¾ˆÓ’¼‘—
008150 ATCCD-RTN.
008160 ATCCD-T.
008170     ACCEPT  A-TCD.
008180     DISPLAY MSG-SPACE.
008190     IF ESTAT      = "09"                    GO TO ATCCD-EXT.
008200     IF ESTAT  NOT = "01" AND "06"           GO TO ATCCD-T.
008210 ATCCD-T-CHK.
008220     MOVE G-TCD         TO T-KEY.
008230     READ T-M      UNLOCK INVALID
008240          DISPLAY INV-TOK DISP-BUZ-J
008250          GO TO ATCCD-T.
008260     MOVE T-NAME        TO G-TNM.
008270     DISPLAY D-TNM.
008280 ATCCD-C.
008290     ACCEPT  A-CCD.
008300     DISPLAY MSG-SPACE.
008310     IF ESTAT      = "09"                    GO TO ATCCD-T.
008320     IF ESTAT  NOT = "01" AND "06"           GO TO ATCCD-C.
008330 ATCCD-C-CHK.
008340     MOVE G-TCD         TO TC-TCD.
008350     MOVE G-CCD         TO TC-CCD.
008360     READ TC-M     UNLOCK INVALID
008370          DISPLAY INV-CHO DISP-BUZ-J
008380          GO TO ATCCD-C.
008390     MOVE TC-NAME       TO G-CNM.
008400     DISPLAY D-CNM.
008410 ATCCD-S-CHK.
008420     MOVE TC-STC        TO STE-KEY1.
008430     READ STENM    UNLOCK INVALID
008440          DISPLAY INV-STE DISP-BUZ-J
008450          GO TO ATCCD-C.
008460 ATCCD-EXT.
008470     EXIT.
008480*****                                                             ”­’“ú
008490 AHYMD-RTN.
008500     IF STE-09     = ZERO
008510        MOVE ZERO       TO G-HYMD
008520        DISPLAY C-HYMD
008530        GO TO AHYMD-EXT.
008540 AHYMD-0.
008550     ACCEPT  A-HY.
008560     DISPLAY MSG-SPACE.
008570     IF ESTAT      = "09"                    GO TO AHYMD-EXT.
008580     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO AHYMD-0.
008590     DISPLAY D-HY.
008600 AHYMD-1.
008610     ACCEPT  A-HM.
008620     DISPLAY MSG-SPACE.
008630     IF ESTAT      = "09"                    GO TO AHYMD-0.
008640     IF ESTAT  NOT = "00" AND "01" AND "06"  GO TO AHYMD-1.
008650     DISPLAY D-HM.
008660     IF G-HMM      > 12                      GO TO AHYMD-1.
008670 AHYMD-2.
008680     ACCEPT  A-HD.
008690     DISPLAY MSG-SPACE.
008700     IF ESTAT      = "09"                    GO TO AHYMD-1.
008710     IF ESTAT  NOT = "01" AND "06"           GO TO AHYMD-2.
008720     DISPLAY D-HD.
008730     IF G-HMM      = 2
008740        IF G-HDD      > 29
008750           GO TO AHYMD-2
008760        END-IF
008770     ELSE
008780        IF G-HMM      = 4 OR 6 OR 9 OR 11
008790           IF G-HDD      > 30
008800              GO TO AHYMD-2
008810           END-IF
008820        ELSE
008830           IF G-HDD      > 31
008840              GO TO AHYMD-2.
008850 AHYMD-CHK.
008860     IF ZERO       = G-HY2 AND G-HMM AND G-HDD
008870        MOVE ZERO          TO G-HY1
008880        GO TO AHYMD-EXT.
008890*
008900     MOVE ZERO          TO G-HY1
008910     IF G-HY2      >= DATE-NF1 AND <= DATE-NT1
008920        ADD  DATE-NC1      TO G-HYY.
008930     IF G-HY2      >= DATE-NF2 AND <= DATE-NT2
008940        ADD  DATE-NC2      TO G-HYY.
008950 AHYMD-CHK-1.
008960     IF G-HMM      < 1 OR > 12
008970        GO TO AHYMD-0.
008980     IF G-HDD      < 1
008990        GO TO AHYMD-0.
009000     IF G-HMM      = 2
009010        IF G-HDD      > 29
009020           GO TO AHYMD-0
009030        END-IF
009040     ELSE
009050        IF G-HMM      = 4 OR 6 OR 9 OR 11
009060           IF G-HDD      > 30
009070              GO TO AHYMD-0
009080           END-IF
009090        ELSE
009100           IF G-HDD      > 31
009110              GO TO AHYMD-0.
009120 AHYMD-EXT.
009130     EXIT.
009140*****                                                             “`‹æ
009150 ADKB-RTN.
009160 ADKB-0.
009170     ACCEPT  A-DKB.
009180     DISPLAY MSG-SPACE.
009190     IF ESTAT      = "09"                    GO TO ADKB-EXT.
009200     IF ESTAT  NOT = "01" AND "06"           GO TO ADKB-0.
009210 ADKB-CHK.
009220     IF G-DKB  NOT = 0 AND 5 AND 6           GO TO ADKB-0.        I.040602
009230*****IF G-DKB  NOT = 0 AND 5                 GO TO ADKB-0.        D.040602
009240 ADKB-EXT.
009250     EXIT.
009260*****                                                             “`•[‡‚
009270 ADNO-RTN.
009280     IF STE-11     = ZERO
009290        MOVE ZERO       TO G-DNO
009300        DISPLAY C-DNO
009310        GO TO ADNO-EXT.
009320 ADNO-0.
009330     ACCEPT  A-DNO.
009340     DISPLAY MSG-SPACE.
009350     IF ESTAT      = "09"                    GO TO ADNO-EXT.
009360     IF ESTAT  NOT = "01" AND "06"           GO TO ADNO-0.
009370 ADNO-CHK.
009380     IF G-DNO  NOT = ZERO                    GO TO ADNO-EXT.
009390*
009400     PERFORM DNO-NO-RTN THRU DNO-NO-EXT.
009410     MOVE STE-083        TO G-DNO.
009420     DISPLAY A-DNO.
009430 ADNO-EXT.
009440     EXIT.
009450*****                                                             •iƒR[ƒh
009460 AHCD-RTN.
009470     MOVE II            TO O-II.
009480     MOVE ZERO          TO SW-HIN
009490                           SW-HIN4.
009500 AHCD-0.
009510     ACCEPT  A-HCD.
009520     DISPLAY MSG-SPACE.
009530     IF ESTAT      = "09"                    GO TO AHCD-EXT.
009540     IF II NOT = 1
009550        IF ESTAT      = "04"                 GO TO AHCD-EXT.
009560     IF ESTAT  NOT = "01" AND "06"           GO TO AHCD-0.
009570 AHCD-CHK.
009580     IF G-HCD(II) = ZERO                     GO TO AHCD-0.
009590     IF G-HCD(II) = O-HCD(II)                GO TO AHCD-EXT.
009600*
009610     MOVE G-HCD(II)     TO HI-MHCD HI-HCD.
009620     READ HI2-M    UNLOCK INVALID
009630          DISPLAY INV-M01 DISP-BUZ-J
009640          GO TO AHCD-0.
009650     READ HI2-M    UNLOCK INVALID
009660          DISPLAY INV-M01 DISP-BUZ-J
009670          GO TO AHCD-0.
009680*
009690     MOVE HI-NAME        TO G-HNM(II).
009700     DISPLAY A-HNM.
009710     IF HI-ISU = ZERO
009720        IF  G-HCD(II)   <  999900                                 I.040419
009730            DISPLAY ERR-ISU DISP-BUZ-J
009740            GO TO AHCD-0.
009750*
009760     IF (ACT     = 1) AND (II NOT = 6)
009770        IF (II     = 1) OR
009780          ((II NOT = 1) AND (G-HCD(II) NOT = G-HCD(II - 1)))
009790           ADD  1              TO II
009800           PERFORM VARYING II FROM II BY 1 UNTIL II > 6
009810                   MOVE G-HCD(O-II)    TO G-HCD(II)
009820                                          O-HCD(II)
009830                   MOVE G-HNM(O-II)    TO G-HNM(II)
009840                   COMPUTE LIN = II * 2 + 6
009850                   DISPLAY A-HCD A-HNM
009860           END-PERFORM
009870           MOVE O-II           TO II
009880           COMPUTE LIN = II * 2 + 6.
009890*
009900     IF ACT     = 1
009910        PERFORM VARYING KK FROM 1 BY 1
009920          UNTIL (KK > 6) OR (KK = II)
009930                IF G-HCD(KK)(1:4) = G-HCD(II)(1:4)
009940                   MOVE G-GTAN(KK)    TO G-GTAN(II)
009950                   MOVE G-UTAN(KK)    TO G-UTAN(II)
009960                   DISPLAY D-GTAN D-UTAN
009970                   MOVE 1             TO SW-HIN4
009980                   EXIT PERFORM
009990                END-IF
010000        END-PERFORM.
010010*
010020     MOVE 1             TO SW-HIN.
010030     MOVE G-HCD(II)     TO O-HCD(II).
010040 AHCD-EXT.
010050     EXIT.
010060*****                                                             •i–¼
010070 AHNM-RTN.
010080 AHNM-0.
010090     ACCEPT  A-HNM.
010100     DISPLAY MSG-SPACE.
010110     IF ESTAT      = "09"                    GO TO AHNM-EXT.
010120     IF ESTAT  NOT = "01" AND "06"           GO TO AHNM-0.
010130 AHNM-CHK.
010140     IF (ACT     = 1) AND (II NOT = 6)
010150        IF (II     = 1) OR
010160          ((II NOT = 1) AND (G-HCD(II) NOT = G-HCD(II - 1)))
010170           ADD  1              TO II
010180           PERFORM VARYING II FROM II BY 1 UNTIL II > 6
010190                   MOVE G-HNM(O-II)    TO G-HNM(II)
010200                   COMPUTE LIN = II * 2 + 6
010210                   DISPLAY A-HNM
010220           END-PERFORM
010230           MOVE O-II           TO II
010240           COMPUTE LIN = II * 2 + 6.
010250 AHNM-EXT.
010260     EXIT.
010270*****                                                             ‘ŠŽè•i–¼
010280 AAHCD-RTN.
010290     IF STE-10     = ZERO
010300        MOVE SPACE      TO G-AHCD(II)
010310        DISPLAY C-AHCD
010320        GO TO AAHCD-EXT.
010330 AAHCD-0.
010340     ACCEPT  A-AHCD.
010350     DISPLAY MSG-SPACE.
010360     IF ESTAT      = "09"                    GO TO AAHCD-EXT.
010370     IF ESTAT  NOT = "01" AND "06"           GO TO AAHCD-0.
010380 AAHCD-CHK.
010390     IF G-AHCD(II) = SPACE
010400        DISPLAY ERR-AHCD1 DISP-BUZ-J
010410        GO TO AAHCD-EXT.
010420*
010430     PERFORM VARYING KK FROM 1 BY 1
010440       UNTIL (KK > 6) OR (KK = II)
010450             IF G-HCD(KK) = G-HCD(II)
010460                IF G-AHCD(KK) = G-AHCD(II)
010470                   DISPLAY ERR-AHCD2 DISP-BUZ-J
010480                   EXIT PERFORM
010490                END-IF
010500             END-IF
010510     END-PERFORM.
010520     IF (KK NOT = II) AND (KK NOT > 6)
010530        GO TO AAHCD-0.
010540 AAHCD-EXT.
010550     EXIT.
010560*****                                                             ‘ŠŽè•i–¼
010570 AAHCD2-RTN.                                                      I.040408
010580     IF STE-10     NOT = 2                                        I.040408
010590        MOVE SPACE      TO G-AHCD2(II)                            I.040408
010600        DISPLAY C-AHCD2                                           I.040408
010610        GO TO AAHCD2-EXT.                                         I.040408
010620 AAHCD2-0.                                                        I.040408
010630     ACCEPT  A-AHCD2.                                             I.040408
010640     DISPLAY MSG-SPACE.                                           I.040408
010650     IF ESTAT      = "09"                    GO TO AAHCD2-EXT.    I.040408
010660     IF ESTAT  NOT = "01" AND "06"           GO TO AAHCD2-0.      I.040408
010670 AAHCD2-CHK.                                                      I.040408
010680     IF G-AHCD2(II) = SPACE                                       I.040408
010690        DISPLAY ERR-AHCD1 DISP-BUZ-J                              I.040408
010700        GO TO AAHCD2-EXT.                                         I.040408
010710*
010720     PERFORM VARYING KK FROM 1 BY 1                               I.040408
010730       UNTIL (KK > 6) OR (KK = II)                                I.040408
010740             IF G-HCD(KK) = G-HCD(II)                             I.040408
010750                IF G-AHCD2(KK) = G-AHCD2(II)                      I.040408
010760                   DISPLAY ERR-AHCD2 DISP-BUZ-J                   I.040408
010770                   EXIT PERFORM                                   I.040408
010780                END-IF                                            I.040408
010790             END-IF                                               I.040408
010800     END-PERFORM.                                                 I.040408
010810     IF (KK NOT = II) AND (KK NOT > 6)                            I.040408
010820        GO TO AAHCD2-0.                                           I.040408
010830 AAHCD2-EXT.                                                      I.040408
010840     EXIT.                                                        I.040408
010850*****                                                             ƒTƒCƒY
010860 ASIZ-RTN.
010870 ASIZ-0.
010880     ACCEPT  A-SIZ.
010890     DISPLAY MSG-SPACE.
010900     IF ESTAT      = "09"                    GO TO ASIZ-EXT.
010910     IF ESTAT  NOT = "01" AND "06"           GO TO ASIZ-0.
010920*****DISPLAY D-SIZ.                                               D.040406
010930 ASIZ-CHK.
010940     IF G-SIZ(II)  = ZERO
010950        MOVE ZERO          TO G-SKB(II)
010960        DISPLAY ERR-SIZ1 DISP-BUZ-J
010970        GO TO ASIZ-0.
010980*
010990     MOVE G-HCD(II)     TO SIZE-WK-HIN.
011000     MOVE G-SIZ(II)     TO SIZE-WK-CD.
011010     PERFORM SIZE-RTN THRU SIZE-EX.
011020     IF SIZE-WK-SW  = 1
011030        DISPLAY ERR-SIZ1 DISP-BUZ-J.
011040     IF SIZE-WK-SW  = 2
011050        DISPLAY ERR-SIZ2 DISP-BUZ-J
011060        GO TO ASIZ-0.
011070     IF SIZE-WK-SW  = 9
011080        DISPLAY ERR-HIN  DISP-BUZ-J
011090        GO TO ASIZ-0.
011100     MOVE SIZE-WK-KB    TO G-SKB(II).
011110*
011120     PERFORM VARYING KK FROM 1 BY 1
011130       UNTIL (KK > 6) OR (KK = II)
011140             IF G-HCD(KK) = G-HCD(II)
011150                IF G-SIZ(KK) = G-SIZ(II)
011160                   DISPLAY ERR-SIZ3 DISP-BUZ-J
011170                   EXIT PERFORM
011180                END-IF
011190             END-IF
011200     END-PERFORM.
011210     IF (KK NOT = II) AND (KK NOT > 6)
011220        GO TO ASIZ-0.
011230 ASIZ-CHK-1.
011240     IF (SW-HIN    = ZERO) OR (SW-HIN4     = 1)
011250        GO TO ASIZ-EXT.
011260*
011270     MOVE G-TCD         TO THT-TCD.
011280     MOVE G-HCD(II)     TO THT-HCD.
011290     MOVE G-SKB(II)     TO THT-SIZ.
011300     READ THTM     UNLOCK INVALID
011310          MOVE ZERO          TO THT-T.
011320     MOVE THT-T         TO G-GTAN(II).
011330     DISPLAY D-GTAN.
011340*
011350     IF (ACT     = 1) AND (II NOT = 6)
011360        IF (II     = 1) OR
011370          ((II NOT = 1) AND (G-HCD(II) NOT = G-HCD(II - 1)))
011380           ADD  1              TO II
011390           PERFORM VARYING II FROM II BY 1 UNTIL II > 6
011400                   MOVE G-GTAN(O-II)   TO G-GTAN(II)
011410                   COMPUTE LIN = II * 2 + 6
011420                   DISPLAY D-GTAN
011430           END-PERFORM
011440           MOVE O-II           TO II
011450           COMPUTE LIN = II * 2 + 6.
011460 ASIZ-EXT.
011470     EXIT.
011480*****                                                             ”—Ê
011490 ASUR-RTN.
011500 ASUR-0.
011510     ACCEPT  A-SUR.
011520     DISPLAY MSG-SPACE.
011530     IF ESTAT      = "09"                    GO TO ASUR-EXT.
011540     IF ESTAT  NOT = "01" AND "06"           GO TO ASUR-0.
011550     DISPLAY D-SUR.
011560 ASUR-CHK.
011570     IF G-SUR(II)  = ZERO                    GO TO ASUR-0.
011580*
011590     MOVE ZERO          TO G-GSUR.
011600     PERFORM VARYING JJ FROM 1 BY 1 UNTIL JJ > 6
011610             ADD  G-SUR(JJ)     TO G-GSUR
011620     END-PERFORM.
011630     DISPLAY D-GSUR.
011640 ASUR-EXT.
011650     EXIT.
011660*****                                                             Œ´’P‰¿
011670 AGTAN-RTN.
011680 AGTAN-0.
011690     ACCEPT  A-GTAN.
011700     DISPLAY MSG-SPACE.
011710     IF ESTAT      = "09"                    GO TO AGTAN-EXT.
011720     IF ESTAT  NOT = "01" AND "06"           GO TO AGTAN-0.
011730     DISPLAY D-GTAN.
011740 AGTAN-CHK.
011750     PERFORM VARYING JJ FROM 1 BY 1
011760       UNTIL (JJ > 6) OR (II = JJ)
011770             IF G-HCD(II) = G-HCD(JJ)
011780                IF G-GTAN(II) NOT = G-GTAN(JJ)
011790                   DISPLAY ERR-GTAN DISP-BUZ-J
011800                END-IF
011810                EXIT PERFORM
011820             END-IF
011830     END-PERFORM.
011840*
011850     IF (ACT     = 1) AND (II NOT = 6)
011860        IF (II     = 1) OR
011870          ((II NOT = 1) AND (G-HCD(II) NOT = G-HCD(II - 1)))
011880           ADD  1              TO II
011890           PERFORM VARYING II FROM II BY 1 UNTIL II > 6
011900                   MOVE G-GTAN(O-II)   TO G-GTAN(II)
011910                   COMPUTE LIN = II * 2 + 6
011920                   DISPLAY D-GTAN
011930           END-PERFORM
011940           MOVE O-II           TO II
011950           COMPUTE LIN = II * 2 + 6.
011960*
011970     COMPUTE G-GKIN(II) = G-SUR(II) * G-GTAN(II).
011980     DISPLAY D-GKIN.
011990*
012000     MOVE ZERO          TO G-GGKIN.
012010     PERFORM VARYING JJ FROM 1 BY 1 UNTIL JJ > 6
012020             ADD  G-GKIN(JJ)    TO G-GGKIN
012030     END-PERFORM.
012040     DISPLAY D-GGKIN.
012050 AGTAN-EXT.
012060     EXIT.
012070*****                                                             ”„’P‰¿
012080 AUTAN-RTN.
012090 AUTAN-0.
012100     ACCEPT  A-UTAN.
012110     DISPLAY MSG-SPACE.
012120     IF ESTAT      = "09"                    GO TO AUTAN-EXT.
012130     IF ESTAT  NOT = "01" AND "06"           GO TO AUTAN-0.
012140     DISPLAY D-UTAN.
012150 AUTAN-CHK.
012160     PERFORM VARYING JJ FROM 1 BY 1
012170       UNTIL (JJ > 6) OR (II = JJ)
012180             IF G-HCD(II) = G-HCD(JJ)
012190                IF G-UTAN(II) NOT = G-UTAN(JJ)
012200                   DISPLAY ERR-UTAN DISP-BUZ-J
012210                END-IF
012220                EXIT PERFORM
012230             END-IF
012240     END-PERFORM.
012250*
012260     IF (ACT     = 1) AND (II NOT = 6)
012270        IF (II     = 1) OR
012280          ((II NOT = 1) AND (G-HCD(II) NOT = G-HCD(II - 1)))
012290           ADD  1              TO II
012300           PERFORM VARYING II FROM II BY 1 UNTIL II > 6
012310                   MOVE G-UTAN(O-II)   TO G-UTAN(II)
012320                   COMPUTE LIN = II * 2 + 6
012330                   DISPLAY D-UTAN
012340           END-PERFORM
012350           MOVE O-II           TO II
012360           COMPUTE LIN = II * 2 + 6.
012370*
012380     COMPUTE G-UKIN(II) = G-SUR(II) * G-UTAN(II).
012390     DISPLAY D-UKIN.
012400*
012410     MOVE ZERO          TO G-GUKIN.
012420     PERFORM VARYING JJ FROM 1 BY 1 UNTIL JJ > 6
012430             ADD  G-UKIN(JJ)    TO G-GUKIN
012440     END-PERFORM.
012450     DISPLAY D-GUKIN.
012460 AUTAN-EXT.
012470     EXIT.
012480*****                                                             ‰^‘—º°ÄÞ
012490 AUCD-RTN.
012500*****IF G-DKB      = 5                                            D.040602
012510     IF G-DKB      = 5  OR  6                                     I.040602
012520        INITIALIZE            G-UCD O-UCD G-UNM
012530        DISPLAY C-UCD C-UNM
012540        GO TO AUCD-EXT.
012550 AUCD-0.
012560     ACCEPT  A-UCD.
012570     DISPLAY MSG-SPACE.
012580     IF ESTAT      = "09"                    GO TO AUCD-EXT.
012590     IF ESTAT  NOT = "01" AND "06"           GO TO AUCD-0.
012600     IF   G-UCD    =  0 OR 6                 GO TO AUCD-0.        I.070307
012610*****IF   G-UCD    =  6                      GO TO AUCD-0.        D.070307
012620 AUCD-CHK.
012630     IF G-UCD      = O-UCD                   GO TO AUCD-EXT.
012640*
012650     MOVE SPACE         TO JCON2-KEY.
012660     MOVE 2             TO JCON2-01.
012670     MOVE G-UCD         TO JCON2-02.
012680     READ JCON UNLOCK INVALID
012690          DISPLAY INV-M01
012700          GO  TO  AUCD-0.
012710     MOVE JCON2-03      TO G-UNM.
012720     DISPLAY D-UNM.
012730*
012740     MOVE G-UCD         TO O-UCD.
012750*
012760*    MOVE W-UNSNM(G-UCD + 1) TO G-UNM.
012770*    DISPLAY D-UNM.
012780 AUCD-EXT.
012790     EXIT.
012800*****                                                             ”z’B
012810 AHT-RTN.
012820*****IF G-DKB      = 5                                            D.040602
012830     IF G-DKB      = 5  OR  6                                     I.040602
012840        INITIALIZE            G-HT
012850        DISPLAY C-HT
012860        GO TO AHT-EXT.
012870 AHT-0.
012880     ACCEPT  A-HT.
012890     DISPLAY MSG-SPACE.
012900     IF ESTAT      = "09"                    GO TO AHT-EXT.
012910     IF ESTAT  NOT = "01" AND "06"           GO TO AHT-0.
012920 AHT-CHK.
012930 AHT-EXT.
012940     EXIT.
012950*****                                                             Šé‰æEŒŽ
012960 AKKM-RTN.
012970*****IF G-DKB      = 5                                            D.040602
012980     IF G-DKB      = 5  OR  6                                     I.040602
012990        INITIALIZE            G-KKM O-KKM
013000        DISPLAY C-KKM
013010        GO TO AKKM-EXT.
013020 AKKM-0.
013030     ACCEPT  A-KKM.
013040     DISPLAY MSG-SPACE.
013050     IF ESTAT      = "09"                    GO TO AKKM-EXT.
013060     IF ESTAT  NOT = "01" AND "06"           GO TO AKKM-0.
013070 AKKM-CHK.
013080     IF G-KKM      > 12                      GO TO AKKM-0.
013090 AKKM-EXT.
013100     EXIT.
013110*****                                                             Šé‰æET
013120 AKKS-RTN.
013130*****IF G-DKB      = 5                                            D.040602
013140     IF G-DKB      = 5  OR  6                                     I.040602
013150        INITIALIZE            G-KKS O-KKS
013160        DISPLAY C-KKS
013170        GO TO AKKS-EXT.
013180 AKKS-0.
013190     ACCEPT  A-KKS.
013200     DISPLAY MSG-SPACE.
013210     IF ESTAT      = "09"                    GO TO AKKS-EXT.
013220     IF ESTAT  NOT = "01" AND "06"           GO TO AKKS-0.
013230 AKKS-CHK.
013240 AKKS-EXT.
013250     EXIT.
013260*****                                                             Šé‰æE†
013270 AKKG-RTN.
013280*****IF G-DKB      = 5                                            D.040602
013290     IF G-DKB      = 5  OR  6                                     I.040602
013300        INITIALIZE            G-KKG O-KKG
013310        DISPLAY C-KKG
013320        GO TO AKKG-EXT.
013330 AKKG-0.
013340     ACCEPT  A-KKG.
013350     DISPLAY MSG-SPACE.
013360     IF ESTAT      = "09"                    GO TO AKKG-EXT.
013370     IF ESTAT  NOT = "01" AND "06"           GO TO AKKG-0.
013380 AKKG-CHK.
013390 AKKG-EXT.
013400     EXIT.
013410*****                                                             Šé‰æ•ÒW
013420 HKKNM-RTN.
013430*****IF G-DKB     = 5                                             D.040602
013440     IF G-DKB     = 5  OR  6                                      I.040602
013450*****   MOVE SPACE         TO G-KKNM                              D.041208
013460*****   DISPLAY C-KKNM                                            D.041208
013470        GO  TO  HKKNM-EXT.
013480     IF G-KK      = O-KK                    GO  TO  HKKNM-EXT.
013490*
013500     MOVE SPACE         TO G-KKNM.
013510     IF G-KKM NOT = ZERO
013520        MOVE G-KKM         TO G-KKNM(1:2)
013530        MOVE NC"ŒŽ"        TO G-KKNM(3:1).
013540     IF G-KKS NOT = ZERO
013550        MOVE G-KKS         TO G-KKNM(4:2)
013560        MOVE NC"T"        TO G-KKNM(6:1).
013570     IF G-KKG NOT = ZERO
013580        MOVE G-KKG         TO G-KKNM(7:3)
013590        MOVE NC"†"        TO G-KKNM(10:1).
013600     DISPLAY A-KKNM.
013610     MOVE G-KK          TO O-KK.
013620 HKKNM-EXT.
013630     EXIT.
013640*****                                                             Šé‰æ–¼
013650 AKKNM-RTN.
013660 AKKNM-0.
013670     ACCEPT  A-KKNM.
013680     DISPLAY MSG-SPACE.
013690     IF ESTAT      = "09"                    GO TO AKKNM-EXT.
013700     IF ESTAT  NOT = "01" AND "06"           GO TO AKKNM-0.
013710 AKKNM-CHK.
013720 AKKNM-EXT.
013730     EXIT.
013740*****                                                             Šm”F
013750 OKC-RTN.
013760     ACCEPT  A-OKC.
013770     DISPLAY MSG-SPACE.
013780     IF ESTAT      = "09"                    GO TO OKC-EXT.
013790     IF ESTAT  NOT = "01" AND "06"           GO TO OKC-RTN.
013800 OKC-CHK.
013810     IF OKC    NOT = 1 AND 9                 GO TO OKC-RTN.
013820 OKC-EXT.
013830     EXIT.
013840*******************************************************************
013850*    ‰æ–Ê@•\Ž¦ˆ—                                               *
013860*******************************************************************
013870 DISP-RTN.
013880     MOVE 1             TO SW-HAT.
013890     MOVE SPACE         TO HAT-KEY.
013900     MOVE G-HNO         TO HAT-01.
013910     START SK-HAT KEY NOT < HAT-KEY INVALID GO TO DISP-EXT.
013920 DISP-010.
013930     READ  SK-HAT NEXT UNLOCK AT END        GO TO DISP-EXT.
013940     IF HAT-01 NOT = G-HNO                  GO TO DISP-EXT.
013950     IF HAT-02     = ZERO OR > 6            GO TO DISP-010.
013960     MOVE ZERO          TO SW-HAT.
013970 DISP-020.
013980     MOVE HAT-25        TO G-SYMD.                                I.040406
013990     MOVE HAT-03        TO G-NYMD.
014000     MOVE HAT-10        TO G-HYMD.
014010     MOVE HAT-04        TO G-TCCD.
014020     MOVE G-TCD         TO T-KEY.
014030     READ T-M      UNLOCK INVALID
014040          INITIALIZE T-R.
014050     MOVE T-NAME        TO G-TNM.
014060     MOVE G-TCD         TO TC-TCD.
014070     MOVE G-CCD         TO TC-CCD.
014080     READ TC-M     UNLOCK INVALID
014090          INITIALIZE TC-R.
014100     MOVE TC-NAME       TO G-CNM.
014110     MOVE TC-STC        TO STE-KEY1.
014120     READ STENM    UNLOCK INVALID
014130          DISPLAY INV-STE DISP-BUZ-J                              I.041225
014140          INITIALIZE STE-R.
014150     MOVE HAT-16        TO G-UCD.
014160*
014170     MOVE SPACE         TO JCON2-KEY.
014180     MOVE 2             TO JCON2-01.
014190     MOVE G-UCD         TO JCON2-02.
014200     READ JCON UNLOCK INVALID
014210          INITIALIZE STE-R.                                       I.040415
014220*****     DISPLAY INV-M01                                         D.040415
014230*****     GO  TO  AUCD-0.                                         D.040415
014240     MOVE JCON2-03      TO G-UNM.
014250*
014260*    MOVE W-UNSNM(G-UCD + 1) TO G-UNM.
014270     MOVE HAT-17        TO G-HT.
014280     MOVE HAT-18        TO G-KK.
014290     MOVE HAT-19        TO G-KKNM.
014300     MOVE HAT-23        TO G-DNO.
014310     MOVE HAT-24        TO G-DKB.
014320 DISP-030.
014330     MOVE HAT-07        TO G-HCD(HAT-02)
014340                           O-HCD(HAT-02).
014350     MOVE HAT-08        TO G-SIZ(HAT-02).
014360     MOVE HAT-09        TO G-HNM(HAT-02).
014370     MOVE HAT-11        TO G-SUR(HAT-02)
014380     MOVE HAT-13        TO G-GTAN(HAT-02).
014390     COMPUTE G-GKIN(HAT-02) = G-SUR(HAT-02) * G-GTAN(HAT-02).
014400     MOVE HAT-14        TO G-UTAN(HAT-02).
014410     COMPUTE G-UKIN(HAT-02) = G-SUR(HAT-02) * G-UTAN(HAT-02).
014420     MOVE HAT-15        TO G-AHCD(HAT-02).
014430     MOVE HAT-26        TO G-AHCD2(HAT-02).                       I.040408
014440 DISP-040.
014450     READ  SK-HAT NEXT UNLOCK AT END        GO TO DISP-050.
014460     IF HAT-01 NOT = G-HNO                  GO TO DISP-050.
014470     IF HAT-02     = ZERO OR > 6            GO TO DISP-040.
014480     GO TO DISP-030.
014490 DISP-050.
014500     DISPLAY D-L03 A-TCCD D-L04 A-DKB A-DNO A-L22 D-L22  A-L23.
014510*
014520     PERFORM VARYING II FROM 1 BY 1
014530       UNTIL (II > 6) OR (G-HCD(II) = ZERO)
014540             COMPUTE LIN = II * 2 + 6
014550             DISPLAY D-LLIN A-HCD A-AHCD A-AHCD2 A-SIZ A-LLINP1   I.040408
014560*****        DISPLAY D-LLIN A-HCD A-AHCD A-SIZ A-LLINP1           D.040408
014570*****        DISPLAY D-LLIN A-HCD A-AHCD A-LLINP1                 D.040406
014580     END-PERFORM.
014590*
014600     MOVE ZERO          TO G-GSUR G-GGKIN G-GUKIN.
014610     PERFORM VARYING JJ FROM 1 BY 1 UNTIL JJ > 6
014620             ADD  G-SUR(JJ)     TO G-GSUR
014630             ADD  G-GKIN(JJ)    TO G-GGKIN
014640             ADD  G-UKIN(JJ)    TO G-GUKIN
014650     END-PERFORM.
014660     DISPLAY D-L20.
014670 DISP-EXT.
014680     EXIT.
014690*******************************************************************
014700*    ‰æ–ÊƒNƒŠƒAˆ—                                               *
014710*******************************************************************
014720 CRE-RTN.
014730     MOVE ZERO          TO ACT.
014740     MOVE SPACE         TO ACTNM.
014750     DISPLAY C-L01.
014760 CRE-1.
014770     MOVE ZERO          TO G-HNO.
014780     DISPLAY C-HNO.
014790 CRE-2.
014800     INITIALIZE            G-HED.
014810*****DISPLAY C-NYMD C-TNM C-TCCD C-L04 C-L05.                     D.040406
014820     DISPLAY C-SYMD C-NYMD C-TNM C-TCCD C-L04 C-L05.              I.040406
014830 CRE-3.
014840     PERFORM VARYING II FROM 1 BY 1 UNTIL II > 6
014850             INITIALIZE G-MEI-T(II)
014860             COMPUTE LIN = II * 2 + 6
014870             DISPLAY C-LLIN C-LLINP1
014880     END-PERFORM.
014890 CRE-4.
014900     INITIALIZE            G-FOT OKC.
014910     DISPLAY C-L20 C-L22 C-L23 C-L24.
014920 CRE-EXT.
014930     EXIT.
014940*-----------------------------------------------------------------*
014950*    “`•[‡‚•t”Ôˆ—                                               *
014960*-----------------------------------------------------------------*
014970 DNO-NO-RTN.
014980     MOVE TC-STC        TO STE-KEY1.
014990     READ STENM           INVALID
015000          DISPLAY INV-STE DISP-BUZ-J                              I.041225
015010          INITIALIZE STE-R.
015020*
015030     IF STE-083 = STE-082
015040        MOVE STE-081       TO STE-083
015050     ELSE
015060        ADD  1             TO STE-083.
015070*
015080     MOVE STE-083       TO G-DNO.
015090*
015100     REWRITE STE-R        INVALID
015110             MOVE "R"          TO   ERR-M
015120             MOVE  "STENM"     TO   ERR-F
015130             MOVE  STE-KEY1    TO   ERR-K
015140             PERFORM ERR-RTN   THRU ERR-EX.
015150*
015160     DISPLAY A-DNO.
015170 DNO-NO-EXT.
015180     EXIT.
015190*-----------------------------------------------------------------*
015200*    ”r‘¼§Œä‚e@’Ç‰Á                                             *
015210*-----------------------------------------------------------------*
015220 JDCON-WRI-RTN.
015230     IF ACT = 1                             GO TO JDCON-WRI-EXT.
015240*
015250     MOVE ZERO          TO SW-JDCON.
015260     MOVE 5             TO JDCON-01.
015270     MOVE G-HNO         TO JDCON-02.
015280     WRITE JDCON-R     INVALID
015290           MOVE 1             TO SW-JDCON
015300           DISPLAY ERR-HNO DISP-BUZ-J
015310           GO TO JDCON-WRI-EXT.
015320*
015330     PERFORM CLS-JDCON-RTN THRU CLS-JDCON-EXT.
015340 JDCON-WRI-EXT.
015350     EXIT.
015360*-----------------------------------------------------------------*
015370*    ”r‘¼§Œä‚e@íœ                                             *
015380*-----------------------------------------------------------------*
015390 JDCON-DEL-RTN.
015400     IF ACT = 1                             GO TO JDCON-DEL-EXT.
015410*
015420     MOVE 5             TO JDCON-01.
015430     MOVE G-HNO         TO JDCON-02.
015440     READ JDCON        INVALID              GO TO JDCON-DEL-EXT.
015450     DELETE JDCON      INVALID              GO TO JDCON-DEL-EXT.
015460*
015470     PERFORM CLS-JDCON-RTN THRU CLS-JDCON-EXT.
015480 JDCON-DEL-EXT.
015490     EXIT.
015500*
015510 CLS-JDCON-RTN.
015520     CALL "CBLTCLS" USING JDCON.
015530 CLS-JDCON-EXT.
015540     EXIT.
015550*-----------------------------------------------------------------*
015560*    I—¹@ˆ—@                                                 *
015570*-----------------------------------------------------------------*
015580 END-RTN.
015590     CLOSE       T-M TC-M HI2-M THTM STENM
015600                 JCON JDCON SK-HAT.
015610 END-EX.
015620     EXIT.
015630*-----------------------------------------------------------------*
015640*    XV@ˆ—@                                                 *
015650*-----------------------------------------------------------------*
015660 UPDT-RTN.
015670     IF ACT NOT = 1
015680        PERFORM HAT-DEL-RTN THRU HAT-DEL-EXT.
015690*
015700     IF ACT NOT = 3
015710        MOVE ZERO             TO COMPLETION-CODE
015720        PERFORM CON-UPD-RTN THRU CON-UPD-EXT
015730        PERFORM HAT-UPD-RTN THRU HAT-UPD-EXT
015740                VARYING II FROM 1 BY 1
015750                  UNTIL (II > 6) OR (G-HCD(II) = ZERO).
015760 UPDT-EXT.
015770     EXIT.
015780*-----------------------------------------------------------------*
015790*    ƒRƒ“ƒgƒ[ƒ‹‚e@XV                                         *
015800*-----------------------------------------------------------------*
015810 CON-UPD-RTN.
015820     IF ACT NOT =  1                        GO TO CON-UPD-EXT.
015830 CON-UPD-010.
015840     MOVE ZERO          TO SW-CON.
015850     MOVE 1             TO JCON1-01.
015860     MOVE 1             TO JCON1-02.
015870     READ JCON        INVALID
015880          INITIALIZE JCON1-R
015890          MOVE 1             TO JCON1-01
015900          MOVE 1             TO JCON1-02
015910          MOVE 1             TO SW-CON.
015920 CON-UPD-020.
015930     IF SW-CON NOT = ZERO
015940        MOVE 100001        TO JCON1-03
015950        MOVE 300001        TO JCON1-04
015960        MOVE 500001        TO JCON1-05
015970     ELSE
015980        IF JCON1-05 = 599999
015990           MOVE 500001        TO JCON1-05
016000        ELSE
016010           ADD  1             TO JCON1-05.
016020*
016030     MOVE JCON1-05      TO G-HNO.
016040*
016050     IF SW-CON NOT = ZERO
016060        PERFORM WRI-CON-RTN THRU WRI-CON-EXT
016070     ELSE
016080        PERFORM REW-CON-RTN THRU REW-CON-EXT.
016090 CON-UPD-030.
016100     MOVE SPACE         TO HAT-KEY.
016110     MOVE G-HNO         TO HAT-01.
016120     START SK-HAT KEY NOT < HAT-KEY INVALID GO TO CON-UPD-EXT.
016130     READ  SK-HAT NEXT UNLOCK AT END        GO TO CON-UPD-EXT.
016140     IF HAT-01     = G-HNO                  GO TO CON-UPD-010.
016150 CON-UPD-EXT.
016160     EXIT.
016170*
016180 REW-CON-RTN.
016190     REWRITE JCON1-R        INVALID
016200             MOVE "R"           TO ERR-M
016210             MOVE "JCON"        TO ERR-F
016220             MOVE JCON1-KEY     TO ERR-K
016230             PERFORM ERR-RTN  THRU ERR-EX.
016240 REW-CON-EXT.
016250     EXIT.
016260*
016270 WRI-CON-RTN.
016280     WRITE   JCON1-R        INVALID
016290             MOVE "W"           TO ERR-M
016300             MOVE "JCON"        TO ERR-F
016310             MOVE JCON1-KEY     TO ERR-K
016320             PERFORM ERR-RTN  THRU ERR-EX.
016330*
016340     PERFORM CLS-CON-RTN THRU CLS-CON-EXT.
016350 WRI-CON-EXT.
016360     EXIT.
016370*
016380 CLS-CON-RTN.
016390     CALL "CBLTCLS" USING JCON.
016400 CLS-CON-EXT.
016410     EXIT.
016420*-----------------------------------------------------------------*
016430*    ¶‹¦”­’ƒf[ƒ^@íœˆ—                                     *
016440*-----------------------------------------------------------------*
016450 HAT-DEL-RTN.
016460     MOVE SPACE         TO HAT-KEY.
016470     MOVE G-HNO         TO HAT-01.
016480     START SK-HAT KEY NOT < HAT-KEY INVALID GO TO HAT-DEL-EXT.
016490 HAT-DEL-010.
016500     READ  SK-HAT NEXT        AT END        GO TO HAT-DEL-EXT.
016510     IF HAT-01 NOT = G-HNO                  GO TO HAT-DEL-EXT.
016520*
016530     PERFORM DEL-HAT-RTN THRU DEL-HAT-EXT.
016540     GO TO HAT-DEL-010.
016550 HAT-DEL-EXT.
016560     EXIT.
016570*-----------------------------------------------------------------*
016580*    ¶‹¦”­’ƒf[ƒ^@XVˆ—                                     *
016590*-----------------------------------------------------------------*
016600 HAT-UPD-RTN.
016610     MOVE SPACE         TO HAT-R.
016620     INITIALIZE            HAT-R.
016630*
016640     MOVE G-HNO         TO HAT-01.
016650     MOVE II            TO HAT-02.
016660     MOVE G-SYMD        TO HAT-25.                                I.040406
016670     MOVE G-NYMD        TO HAT-03.
016680     MOVE G-TCCD        TO HAT-04.
016690     MOVE 1             TO HAT-05.
016700     MOVE TC-STC        TO HAT-06.
016710     MOVE G-HCD(II)     TO HAT-07.
016720     MOVE G-SIZ(II)     TO HAT-08.
016730     MOVE G-HNM(II)     TO HAT-09.
016740     MOVE G-HYMD        TO HAT-10.
016750     MOVE G-SUR(II)     TO HAT-11.
016760     MOVE G-GTAN(II)    TO HAT-13.
016770     MOVE G-UTAN(II)    TO HAT-14.
016780     MOVE G-AHCD(II)    TO HAT-15.
016790     MOVE G-AHCD2(II)   TO HAT-26.                                I.040408
016800     MOVE G-UCD         TO HAT-16.
016810     MOVE G-HT          TO HAT-17.
016820     MOVE G-KK          TO HAT-18.
016830     MOVE G-KKNM        TO HAT-19.
016840     MOVE G-DNO         TO HAT-23.
016850     MOVE G-DKB         TO HAT-24.
016860     MOVE SYSYMD        TO HAT-21.
016870     MOVE ACT           TO HAT-22.
016880     IF  STE-12       =  0                                        I.040617
016890         MOVE  0            TO HAT-97.                            I.040617
016900     IF  STE-12       =  1                                        I.040617
016910         MOVE  2            TO HAT-97.                            I.040617
016920     IF  STE-12       =  2                                        I.040617
016930         IF  G-DKB        =  0                                    I.040617
016940             MOVE  0            TO HAT-97                         I.040617
016950           ELSE                                                   I.040617
016960             MOVE  1            TO HAT-97.                        I.040617
016970     IF  STE-12       =  3                                        I.040617
016980         IF  G-DKB        =  0                                    I.040617
016990             MOVE  1            TO HAT-97                         I.040617
017000           ELSE                                                   I.040617
017010             MOVE  0            TO HAT-97.                        I.040617
017020*****MOVE STE-12        TO HAT-97.                                D.040617
017030*
017040     PERFORM WRI-HAT-RTN THRU WRI-HAT-EXT.
017050 HAT-UPD-EXT.
017060     EXIT.
017070*
017080 DEL-HAT-RTN.
017090     DELETE  SK-HAT         INVALID
017100             MOVE "D"           TO ERR-M
017110             MOVE "SK-HAT"      TO ERR-F
017120             MOVE HAT-KEY       TO ERR-K
017130             PERFORM ERR-RTN  THRU ERR-EX.
017140*
017150     PERFORM CLS-HAT-RTN THRU CLS-HAT-EXT.
017160 DEL-HAT-EXT.
017170     EXIT.
017180*
017190 REW-HAT-RTN.
017200     REWRITE HAT-R          INVALID
017210             MOVE "R"           TO ERR-M
017220             MOVE "SK-HAT"      TO ERR-F
017230             MOVE HAT-KEY       TO ERR-K
017240             PERFORM ERR-RTN  THRU ERR-EX.
017250 REW-HAT-EXT.
017260     EXIT.
017270*
017280 WRI-HAT-RTN.
017290     WRITE   HAT-R          INVALID
017300             MOVE "W"           TO ERR-M
017310             MOVE "SK-HAT"      TO ERR-F
017320             MOVE HAT-KEY       TO ERR-K
017330             PERFORM ERR-RTN  THRU ERR-EX.
017340*
017350     PERFORM CLS-HAT-RTN THRU CLS-HAT-EXT.
017360 WRI-HAT-EXT.
017370     EXIT.
017380*
017390 CLS-HAT-RTN.
017400     CALL "CBLTCLS" USING SK-HAT.
017410 CLS-HAT-EXT.
017420     EXIT.
017430*
017440 COPY LPMSG.
017450 COPY LPSIZC.
