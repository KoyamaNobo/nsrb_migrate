000010 IDENTIFICATION        DIVISION.
000020 PROGRAM-ID.           JT321U.
000030**************************************************
000040*    PROGRAM      :    実・有効在庫データ抽出    *
000050*    DATA WRITTEN :    00/07/21                  *
000060*    SCREEN  USED :    ______                    *
000070*    COMPILE TYPE :    CBL85                     *
000080**************************************************
000090 ENVIRONMENT           DIVISION.
000100 CONFIGURATION         SECTION.
000110 SOURCE-COMPUTER.      SYSTEM100.
000120 OBJECT-COMPUTER.      SYSTEM100.
000130 INPUT-OUTPUT          SECTION.
000140 FILE-CONTROL.
000150     SELECT   NJZAI    ASSIGN  TO      F1-MSD
000160                       ORGANIZATION    INDEXED
000170                       ACCESS  MODE    DYNAMIC
000180                       RECORD  KEY     NJZAI-KEY
000190                       FILE    STATUS  ERR-STAT.
000200*****SELECT   SHM      ASSIGN  TO      F2-MSD                     D.010818
000210     SELECT   HI2-M    ASSIGN  TO      F2-MSD                     I.010818
000220                       ORGANIZATION    INDEXED
000230                       ACCESS  MODE    DYNAMIC
000240                       RECORD  KEY     HI-KEY2                    I.010818
000250*****                  RECORD  KEY     SHM-KEY                    D.010818
000260                       FILE    STATUS  ERR-STAT.
000270     SELECT   JMST3    ASSIGN  TO      F3-MSD
000280                       ORGANIZATION    INDEXED
000290                       ACCESS  MODE    DYNAMIC
000300                       RECORD  KEY     JMST3-KEY.
000310     SELECT   JNYZ     ASSIGN  TO      F4-MSD
000320                       ORGANIZATION    INDEXED
000330                       ACCESS  MODE    DYNAMIC
000340                       RECORD  KEY     JNYZ-KEY.
000350     SELECT  JT-YZAI   ASSIGN  TO  F9-MSD
000360         FILE  STATUS  ERR-STAT.
000370 I-O-CONTROL.
000380     APPLY EXCLUSIVE-MODE ON  JT-YZAI
000390     APPLY  SHARED-MODE    ON  NJZAI   HI2-M JMST3  JNYZ.         I.010818
000400*****APPLY  SHARED-MODE    ON  NJZAI   SHM   JMST3  JNYZ.         D.010818
000410 DATA                DIVISION.
000420 FILE                SECTION.
000430     COPY     LNJZAI.
000440     COPY     LIHIM2.                                             I.010818
000450*****COPY     L-SHM.                                              D.010818
000460     COPY     LJMST3.
000470     COPY     LJNYZ.
000480 FD  JT-YZAI
000490     BLOCK    2     RECORDS
000500     LABEL    RECORD   STANDARD
000510     VALUE    OF  IDENTIFICATION   WK0128ID.
000520 01  YZAI-R.
000530     02   YZAI-01             PIC 9(1).                           ｸﾗｺｰﾄﾞ
000540     02   YZAI-02             PIC 9(6).                           ﾋﾝﾒｲｺｰﾄﾞ
000550     02   YZAI-03             PIC 9(1).                           ｻｲｽﾞｸﾌﾞﾝ
000560     02   YZAI-04.                                                ｻﾞｲｺｽｳ
000570          03   YZAI-041       OCCURS  10.                         ｻｲｽﾞﾍﾞﾂ
000580              04   YZAI-0411  PIC S9(6).
000590     02   FILLER              PIC X(11).
000600     02   YZAI-88             PIC 9(01).                          ZCHK
000610     02   YZAI-89             PIC 9(01).                          ｻｲｽﾞNO
000620     02   YZAI-90             PIC 9(01).                          ﾃﾞｰﾀｸﾌﾞﾝ
000630     02   YZAI-91.                                                ﾌﾞﾝﾙｲ2
000640          03   YZAI-911       PIC 9(01).
000650          03   YZAI-912       PIC 9(01).
000660     02   YZAI-92             PIC 9(01).                          ｻﾞｲｺｸﾌﾞﾝ
000670     02   YZAI-93             PIC 9(01).
000680     02   FILLER              PIC X(42).
000690 WORKING-STORAGE     SECTION.
000700 77  ERR-STAT                 PIC  X(02).
000710 77  WK0128ID                 PIC  X(009) VALUE SPACE.
000720 01  STN-NO.
000730     02  STN-NO1              PIC  X(003).
000740     02  STN-NO2              PIC  X(003).
000750 01  W-FID.
000760     02  W-FID1               PIC  X(006) VALUE "WK0128".
000770     02  W-FID2               PIC  X(003).
000780 01  I                        PIC  9(02).
000790 01  ZERO-SW                  PIC  9(01).
000800 01  DATA-SW                  PIC  9(01).
000810 01  WORK-AREA.
000820     02  W-JCC                PIC  9(01).
000830     02  W-KURA               PIC  9(01).
000840     02  W-HCD                PIC  9(06).
000850     02  W-SIZ                PIC  9(01).
000860     02  CHK                  PIC  9(01).
000870     02  W-AREA.
000880       03  W-ZCHK             PIC  9(01).
000890       03  W-SEN              PIC  9(01).
000900       03  W-FROM.
000910           04  W-FK           PIC  9(01).
000920           04  W-FH1          PIC  9(06).
000930           04  W-FH2          PIC  9(06).
000940           04  W-FH3          PIC  9(06).
000950           04  W-FH4          PIC  9(06).
000960           04  W-FH5          PIC  9(06).
000970       03  W-TO.
000980           04  W-TK           PIC  9(01).
000990           04  W-TH           PIC  9(06).
001000           04  W-TH1          PIC  9(06).
001010           04  W-TH2          PIC  9(06).
001020           04  W-TH3          PIC  9(06).
001030           04  W-TH4          PIC  9(06).
001040           04  W-TH5          PIC  9(06).
001050       03  OKC                PIC  9(01).                         確認　
001060*
001070     COPY     LWMSG.                                              ｴﾗｰDSP
001080*
001090 SCREEN      SECTION.
001100 SD  C-CRT
001110     END  STATUS  IS  ESTAT.
001120 01  C-CLEAR.
001130     02  C-CL     LINE   1  CLEAR SCREEN.
001140 01  CLR-01.
001150     02  CLR-ZCHK  LINE 10  COLUMN 36  VALUE " ".
001160     02  CLR-SEN   LINE 10  COLUMN 54  VALUE " ".
001170     02  CLR-FK    LINE 16  COLUMN 23  VALUE " ".
001180     02  CLR-TK    LINE 18  COLUMN 23  VALUE " ".
001190     02  CLR-FH1   LINE 16  COLUMN 26  VALUE "      ".
001200     02  CLR-TH1   LINE 18  COLUMN 26  VALUE "      ".
001210     02  CLR-FH2   LINE 16  COLUMN 34  VALUE "      ".
001220     02  CLR-TH2   LINE 18  COLUMN 34  VALUE "      ".
001230     02  CLR-FH3   LINE 16  COLUMN 42  VALUE "      ".
001240     02  CLR-TH3   LINE 18  COLUMN 42  VALUE "      ".
001250     02  CLR-FH4   LINE 16  COLUMN 50  VALUE "      ".
001260     02  CLR-TH4   LINE 18  COLUMN 50  VALUE "      ".
001270     02  CLR-FH5   LINE 16  COLUMN 58  VALUE "      ".
001280     02  CLR-TH5   LINE 18  COLUMN 58  VALUE "      ".
001290***
001300 01  DSP-AREA.
001310     02  LINE  1  COLUMN 27  VALUE
001320          "                      " REVERSE.
001330     02  LINE  1  COLUMN 28  VALUE
001340         NC"倉別受払ワーク　抽出".
001350     02  LINE  8  COLUMN 13  VALUE "実在庫受払    = 0".
001360     02  LINE 10  COLUMN 13  VALUE "有効在庫受払  = 1 ...  ".
001370     02  LINE  6  COLUMN 44  VALUE "教　　育　 = 0".              I.030725
001380     02  LINE  8  COLUMN 44  VALUE "ワ　ー　ク = 1".              I.030725
001390     02  LINE 10  COLUMN 44  VALUE "一　　般   = 2".              I.070419
001400*****02  LINE 10  COLUMN 44  VALUE NC"カジュアル".                D.070419
001410*****02  LINE 10  COLUMN 54  VALUE " = 2".                        D.070419
001420     02  LINE 12  COLUMN 44  VALUE "全　　件　 = 9 ...  ".        I.030725
001430*****02  LINE  6  COLUMN 44  VALUE "教育 = 0".                    D.030725
001440*****02  LINE  8  COLUMN 44  VALUE "一般 = 1".                    D.030725
001450*****02  LINE 10  COLUMN 44  VALUE "全件 = 2 ...  ".              D.030725
001460     02  LINE 14  COLUMN 22  VALUE
001470         "倉  品名１      ２      ３      ４      ５".
001480     02  LINE 16  COLUMN 13  VALUE  "ＦＲＯＭ".
001490     02  LINE 18  COLUMN 13  VALUE  "ＴＯ".
001500     02  LINE 23  COLUMN 41  VALUE  "確認(OK=1,NO=9)-->   ﾘﾀｰﾝ".
001510 01  ACP-AREA.
001520     02  ACP-ZCHK       LINE 10  COLUMN 35     PIC 9(01)
001530                        USING W-ZCHK    CHECK OVERFLOW NO IFC.
001540*****02  ACP-SEN        LINE 10  COLUMN 57     PIC 9(01)          D.030725
001550     02  ACP-SEN        LINE 12  COLUMN 63     PIC 9(01)          I.030725
001560                        USING W-SEN     CHECK OVERFLOW NO IFC.
001570     02  ACP-FK         LINE 16  COLUMN 23     PIC 9(01)
001580                        USING W-FK      CHECK OVERFLOW NO IFC.
001590     02  ACP-TK         LINE 18  COLUMN 23     PIC 9(01)
001600                        USING W-TK      CHECK OVERFLOW NO IFC.
001610     02  ACP-FH1        LINE 16  COLUMN 26     PIC 9(06)
001620                        USING W-FH1     CHECK OVERFLOW NO IFC.
001630     02  ACP-TH1        LINE 18  COLUMN 26     PIC 9(06)
001640                        USING W-TH1     CHECK OVERFLOW NO IFC.
001650     02  ACP-FH2        LINE 16  COLUMN 34     PIC 9(06)
001660                        USING W-FH2     CHECK OVERFLOW NO IFC.
001670     02  ACP-TH2        LINE 18  COLUMN 34     PIC 9(06)
001680                        USING W-TH2     CHECK OVERFLOW NO IFC.
001690     02  ACP-FH3        LINE 16  COLUMN 42     PIC 9(06)
001700                        USING W-FH3     CHECK OVERFLOW NO IFC.
001710     02  ACP-TH3        LINE 18  COLUMN 42     PIC 9(06)
001720                        USING W-TH3     CHECK OVERFLOW NO IFC.
001730     02  ACP-FH4        LINE 16  COLUMN 50     PIC 9(06)
001740                        USING W-FH4     CHECK OVERFLOW NO IFC.
001750     02  ACP-TH4        LINE 18  COLUMN 50     PIC 9(06)
001760                        USING W-TH4     CHECK OVERFLOW NO IFC.
001770     02  ACP-FH5        LINE 16  COLUMN 58     PIC 9(06)
001780                        USING W-FH5     CHECK OVERFLOW NO IFC.
001790     02  ACP-TH5        LINE 18  COLUMN 58     PIC 9(06)
001800                        USING W-TH5     CHECK OVERFLOW NO IFC.
001810     02  ACP-OKC        LINE 23  COLUMN 61     PIC 9(01)
001820                        USING OKC       CHECK OVERFLOW NO IFC.
001830 01  DISP-ERR-AREA LINE 24.
001840     02  DISP-MSG-01.
001850         03  COLUMN  1        PIC X(39) FROM ERR-MSGX.
001860     02  DISP-MSG-SPACE.
001870         03  COLUMN  1        PIC X(39) FROM ERR-SPACE.
001880     02  DISP-BUZ-B.
001890         03  COLUMN  80       PIC X(05) VALUE ""27"B"10"".
001900     02  DISP-BUZ-J.
001910         03  COLUMN  80       PIC X(05) VALUE ""27"J"01"".
001920     02  ERR-02.
001930         03  COLUMN  1        VALUE
001940         NC"＊　データ　なし　　＊".
001950     02  ERR-DIS.
001960         03  COLUMN 2         VALUE
001970         "<<<  ".
001980         03  COLUMN 7         PIC X(12)   FROM ERR-F.
001990         03  COLUMN 19        PIC X(01)   FROM ERR-M.
002000         03  COLUMN 20        VALUE
002010         "ｴﾗｰ STATUS=".
002020         03  COLUMN 31        PIC X(02)   FROM ERR-FLG.
002030         03  COLUMN 33        VALUE
002040         "  >>>".
002050         03  COLUMN 38        VALUE
002060         " KEY=".
002070         03  COLUMN 43        PIC X(30)   FROM ERR-K.
002080**
002090 PROCEDURE               DIVISION.
002100 MEIN.
002110     PERFORM  INI-RTN    THRU  INI-EX.
002120     IF  COMPLETION-CODE  = 255                                   I.030725
002130         STOP  RUN.                                               I.030725
002140     PERFORM  UPD1-RTN   THRU  UPD1-EX.
002150     IF  W-ZCHK   =  0
002160         GO  TO  MR999.
002170     PERFORM  UPD2-RTN   THRU  UPD2-EX.
002180     PERFORM  UPD3-RTN   THRU  UPD3-EX.
002190     PERFORM  UPD4-RTN   THRU  UPD4-EX.
002200 MR999.
002210     PERFORM  END-RTN    THRU  END-EX.
002220     STOP     RUN.
002230******************************
002240*    ＩＮＩ−ＲＴＮ          *
002250*          〜初期処理〜      *
002260******************************
002270 INI-RTN.                                                         INI-RTN
002280     DISPLAY  C-CLEAR.
002290     DISPLAY  DSP-AREA.
002300     INITIALIZE  W-AREA.
002310 INI-010.
002320     ACCEPT  ACP-ZCHK.
002330     IF  ESTAT  =  "P9"
002340         MOVE  255     TO  COMPLETION-CODE
002350         GO  TO  INI-EX.
002360     IF  ESTAT  NOT =  "01"  AND  "06"
002370         GO  TO  INI-010.
002380     DISPLAY  ACP-ZCHK.
002390     IF  W-ZCHK NOT =  0 AND 1
002400         GO  TO  INI-010.
002410 INI-020.
002420     ACCEPT  ACP-SEN.
002430     IF  ESTAT  =  "09"
002440         GO  TO  INI-010.
002450     IF  ESTAT  NOT =  "01"  AND  "06"
002460         GO  TO  INI-020.
002470     DISPLAY  ACP-SEN.
002480*****IF  W-SEN  NOT =  0  AND 1 AND 2                             D.030725
002490     IF  W-SEN  NOT =  0  AND 1 AND 2 AND  9                      I.030725
002500         GO  TO  INI-020.
002510     IF  W-ZCHK     =  1
002520         MOVE   9        TO  W-FK  W-TK
002530         DISPLAY    CLR-FK   CLR-TK
002540         GO  TO  INI-055.
002550 INI-030.
002560     ACCEPT  ACP-FK.
002570     IF  ESTAT  =  "09"
002580         GO  TO  INI-020.
002590     IF  ESTAT  NOT =  "01"  AND  "06"
002600         GO  TO  INI-030.
002610     DISPLAY  ACP-FK.
002620 INI-050.
002630     ACCEPT  ACP-TK.
002640     IF  ESTAT  =  "09"
002650         GO  TO  INI-030.
002660     IF  ESTAT  NOT =  "01"  AND  "06"
002670         GO  TO  INI-050.
002680     DISPLAY  ACP-TK.
002690     IF  W-FK  >  W-TK
002700         GO  TO  INI-050.
002710 INI-055.
002720     ACCEPT  ACP-FH1.
002730     IF  ESTAT  =  "09"
002740         IF  W-ZCHK     =  1
002750             GO  TO  INI-020
002760           ELSE
002770             GO  TO  INI-050.
002780     IF  ESTAT  NOT =  "01"  AND  "06"
002790         GO  TO  INI-055.
002800     DISPLAY  ACP-FH1.
002810 INI-060.
002820     ACCEPT  ACP-TH1.
002830     IF  ESTAT  =  "09"
002840         GO  TO  INI-055.
002850     IF  ESTAT  NOT =  "01"  AND  "06"
002860         GO  TO  INI-060.
002870     DISPLAY  ACP-TH1.
002880     IF  W-FH1   >  W-TH1
002890         GO  TO  INI-060.
002900     IF W-TH1 = 999999
002910         MOVE W-TH1 TO W-TH
002920         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4
002930                                              W-FH5 W-TH5
002940         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-FH3
002950                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5
002960         GO TO INI-510.
002970 INI-070.
002980     ACCEPT  ACP-FH2.
002990     IF  ESTAT  =  "09"
003000         GO  TO  INI-060.
003010     IF  ESTAT  NOT =  "01"  AND  "06"
003020         GO  TO  INI-070.
003030     IF W-FH2 = ZERO
003040         MOVE W-TH1 TO W-TH
003050         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4
003060                                              W-FH5 W-TH5
003070         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-FH3
003080                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5
003090         GO TO INI-510.
003100     DISPLAY  ACP-FH2.
003110     IF  W-FH2   <  W-TH1
003120         GO  TO  INI-070.
003130 INI-080.
003140     ACCEPT  ACP-TH2.
003150     IF  ESTAT  =  "09"
003160         GO  TO  INI-070.
003170     IF  ESTAT  NOT =  "01"  AND  "06"
003180         GO  TO  INI-080.
003190     DISPLAY  ACP-TH2.
003200     IF  W-FH2   >  W-TH2
003210         GO  TO  INI-080.
003220     IF W-TH2 = 999999
003230         MOVE W-TH2 TO W-TH
003240         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5
003250         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-FH4
003260                                 CLR-FH5 CLR-FH5
003270         GO TO INI-510.
003280 INI-090.
003290     ACCEPT  ACP-FH3.
003300     IF  ESTAT  =  "09"
003310         GO  TO  INI-080.
003320     IF  ESTAT  NOT =  "01"  AND  "06"
003330         GO  TO  INI-090.
003340     IF W-FH3 = ZERO
003350         MOVE W-TH2 TO W-TH
003360         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5
003370         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-FH4
003380                                 CLR-FH5 CLR-FH5
003390         GO TO INI-510.
003400     DISPLAY  ACP-FH3.
003410     IF  W-FH3   <  W-TH2
003420         GO  TO  INI-090.
003430 INI-100.
003440     ACCEPT  ACP-TH3.
003450     IF  ESTAT  =  "09"
003460         GO  TO  INI-090.
003470     IF  ESTAT  NOT =  "01"  AND  "06"
003480         GO  TO  INI-100.
003490     DISPLAY  ACP-TH3.
003500     IF  W-FH3   >  W-TH3
003510         GO  TO  INI-100.
003520     IF W-TH3 = 999999
003530         MOVE W-TH3 TO W-TH
003540         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5
003550         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5
003560         GO TO INI-510.
003570 INI-110.
003580     ACCEPT  ACP-FH4.
003590     IF  ESTAT  =  "09"
003600         GO  TO  INI-100.
003610     IF  ESTAT  NOT =  "01"  AND  "06"
003620         GO  TO  INI-110.
003630     IF W-FH4 = ZERO
003640         MOVE W-TH3 TO W-TH
003650         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5
003660         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-FH5
003670         GO TO INI-510.
003680     DISPLAY  ACP-FH4.
003690     IF  W-FH4   <  W-TH3
003700         GO  TO  INI-110.
003710 INI-120.
003720     ACCEPT  ACP-TH4.
003730     IF  ESTAT  =  "09"
003740         GO  TO  INI-110.
003750     IF  ESTAT  NOT =  "01"  AND  "06"
003760         GO  TO  INI-120.
003770     DISPLAY  ACP-TH4.
003780     IF  W-FH4   >  W-TH4
003790         GO  TO  INI-120.
003800     IF W-TH4 = 999999
003810         MOVE W-TH4 TO W-TH
003820         MOVE ZERO TO W-FH5 W-TH5
003830         DISPLAY CLR-FH5 CLR-FH5
003840         GO TO INI-510.
003850 INI-130.
003860     ACCEPT  ACP-FH5.
003870     IF  ESTAT  =  "09"
003880         GO  TO  INI-120.
003890     IF  ESTAT  NOT =  "01"  AND  "06"
003900         GO  TO  INI-130.
003910     IF W-FH5 = ZERO
003920         MOVE W-TH4 TO W-TH
003930         MOVE ZERO TO W-FH5 W-TH5
003940         DISPLAY CLR-FH5 CLR-FH5
003950         GO TO INI-510.
003960     DISPLAY  ACP-FH5.
003970     IF  W-FH5   <  W-TH4
003980         GO  TO  INI-130.
003990 INI-140.
004000     ACCEPT  ACP-TH5.
004010     IF  ESTAT  =  "09"
004020         GO  TO  INI-130.
004030     IF  ESTAT  NOT =  "01"  AND  "06"
004040         GO  TO  INI-140.
004050     DISPLAY  ACP-TH5.
004060     IF  W-FH5   >  W-TH5
004070         GO  TO  INI-140.
004080     MOVE W-TH5 TO W-TH.
004090 INI-510.
004100     ACCEPT  ACP-OKC.
004110     IF  ESTAT  NOT =  "09"
004120         GO TO INI-520.
004130     IF  W-FH2 = ZERO
004140         GO  TO  INI-060.
004150     IF  W-FH3 = ZERO
004160         GO  TO  INI-080.
004170     IF  W-FH4 = ZERO
004180         GO  TO  INI-100.
004190     IF  W-FH5 = ZERO
004200         GO  TO  INI-120.
004210     GO  TO  INI-140.
004220 INI-520.
004230     IF  ESTAT  NOT =  "01"  AND  "06"
004240         GO  TO  INI-510.
004250     DISPLAY  ACP-OKC.
004260     IF  OKC  NOT =  "1"  AND  "9"
004270         GO  TO  INI-510.
004280     IF  OKC  =  "9"
004290         GO  TO  INI-RTN.
004300*
004310     CALL "CBLSTNNO" USING STN-NO.
004320     MOVE STN-NO2 TO W-FID2.
004330     MOVE W-FID TO WK0128ID.
004340     OPEN  OUTPUT  JT-YZAI.
004350     OPEN  INPUT   NJZAI  HI2-M JMST3  JNYZ.                      I.010818
004360*****OPEN  INPUT   NJZAI  SHM   JMST3  JNYZ.                      D.010818
004370 INI-EX.
004380     EXIT.
004390******************************
004400*    ＥＮＤ−ＲＴＮ          *
004410*          〜終了処理〜      *
004420******************************
004430 END-RTN.                                                         END-RTN
004440*****CLOSE    NJZAI  SHM   JMST3  JNYZ.                           D.010818
004450     CLOSE    NJZAI  HI2-M JMST3  JNYZ.                           I.010818
004460     CLOSE  JT-YZAI.
004470     DISPLAY  C-CLEAR.
004480 END-EX.
004490     EXIT.
004500******************************
004510***   UPD1  RTN            ***
004520******************************
004530 UPD1-RTN.
004540     INITIALIZE                 NJZAI-KEY.
004550     MOVE  W-FK             TO  NJZAI-01.
004560     MOVE  W-FH1            TO  NJZAI-02.
004570*
004580     START  NJZAI  KEY  NOT <  NJZAI-KEY  INVALID
004590         GO  TO  UPD1-EX.
004600 UPD1-010.
004610***  倉別在庫マスタ　ＲＥＡＤ
004620     READ  NJZAI  NEXT  UNLOCK  AT  END
004630         GO  TO  UPD1-EX.
004640     MOVE  NJZAI-01     TO  W-KURA.
004650     MOVE  NJZAI-02     TO  W-HCD.
004660     MOVE  NJZAI-03     TO  W-SIZ.
004670*****MOVE  W-HCD        TO  SHM-KEY.                              D.010818
004680*****READ  SHM  UNLOCK  INVALID                                   D.010818
004690     MOVE  W-HCD        TO  HI-MHCD HI-HCD.                       I.010818
004700     READ  HI2-M  UNLOCK  INVALID                                 I.010818
004710         GO  TO  UPD1-010.
004720     IF  W-SEN  =  0
004730*****    IF  SHM-05   <  20  OR   >  29                           D.010601
004740*****    IF  SHM-05   <  30  OR   >  39                           D.010818
004750         IF  HI-BC3   <  30  OR   >  39                           I.010818
004760             GO  TO  UPD1-010.
004770     IF  W-SEN  =  1
004780*****    IF  SHM-05   >  19  AND  <  30                           D.010601
004790*****    IF  SHM-05   >  29  AND  <  40                           D.010818
004800*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
004810         IF  HI-BC3   <  20  OR   >  29                           I.030725
004820             GO  TO  UPD1-010.
004830     IF  W-SEN  =  2                                              I.030725
004840         IF  HI-BC3   >  19                                       I.030725
004850             GO  TO  UPD1-010.                                    I.030725
004860*
004870     IF  W-KURA    >  W-TK
004880         GO  TO  UPD1-EX.
004890     IF  W-KURA    >  W-TH
004900         GO  TO  UPD1-EX.
004910     IF  W-HCD     >= W-FH1 AND   <=  W-TH1
004920         GO  TO  UPD1-020.
004930     IF  W-HCD     >= W-FH2 AND   <=  W-TH2
004940         GO  TO  UPD1-020.
004950     IF  W-HCD     >= W-FH3 AND   <=  W-TH3
004960         GO  TO  UPD1-020.
004970     IF  W-HCD     >= W-FH4 AND   <=  W-TH4
004980         GO  TO  UPD1-020.
004990     IF  W-HCD     >= W-FH5 AND   <=  W-TH5
005000         GO  TO  UPD1-020.
005010     GO  TO  UPD1-010.
005020*
005030 UPD1-020.
005040     PERFORM  ZC4-RTN      THRU  ZC4-EX.
005050     IF  ZERO-SW  =  1
005060         PERFORM  WRI-RTN      THRU  WRI-EX.
005070*
005080     IF  W-ZCHK   =  1
005090         GO  TO  UPD1-010.
005100     PERFORM  ZC0-RTN      THRU  ZC0-EX.
005110     IF  ZERO-SW  =  1
005120         PERFORM WRI-RTN THRU WRI-EX.
005130     PERFORM  ZC1-RTN      THRU  ZC1-EX.
005140     IF  ZERO-SW  =  1
005150         PERFORM WRI-RTN THRU WRI-EX.
005160     PERFORM  ZC2-RTN      THRU  ZC2-EX.
005170     IF  ZERO-SW  =  1
005180         PERFORM WRI-RTN THRU WRI-EX.
005190     PERFORM  ZC3-RTN      THRU  ZC3-EX.
005200     IF  ZERO-SW  =  1
005210         PERFORM WRI-RTN THRU WRI-EX.
005220     GO  TO  UPD1-010.
005230 UPD1-EX.
005240     EXIT.
005250******************************
005260***   UPD2  RTN            ***
005270******************************
005280 UPD2-RTN.
005290     INITIALIZE                 JMST3-KEY.
005300     MOVE  W-FH1            TO  JMST3-03.
005310*
005320     START  JMST3  KEY  NOT <  JMST3-KEY  INVALID
005330         GO  TO  UPD2-EX.
005340 UPD2-010.
005350     READ  JMST3  NEXT  UNLOCK  AT  END
005360         GO  TO  UPD2-EX.
005370     MOVE  9            TO  W-KURA.
005380     MOVE  JMST3-03     TO  W-HCD.
005390     MOVE  JMST3-09     TO  W-SIZ.
005400*****MOVE  W-HCD        TO  SHM-KEY.                              D.010818
005410*****READ  SHM  UNLOCK  INVALID                                   D.010818
005420     MOVE  W-HCD        TO  HI-MHCD HI-HCD.                       I.010818
005430     READ  HI2-M  UNLOCK  INVALID                                 I.010818
005440         GO  TO  UPD2-010.
005450     IF  W-SEN  =  0
005460*****    IF  SHM-05   <  20  OR   >  29                           D.010601
005470*****    IF  SHM-05   <  30  OR   >  39                           D.010818
005480         IF  HI-BC3   <  30  OR   >  39                           I.010818
005490             GO  TO  UPD2-010.
005500     IF  W-SEN  =  1
005510*****    IF  SHM-05   >  19  AND  <  30                           D.010601
005520*****    IF  SHM-05   >  29  AND  <  40                           D.010818
005530*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
005540         IF  HI-BC3   <  20  OR   >  29                           I.030725
005550             GO  TO  UPD2-010.
005560     IF  W-SEN  =  2                                              I.030725
005570         IF  HI-BC3   >  19                                       I.030725
005580             GO  TO  UPD2-010.                                    I.030725
005590*
005600     IF  JMST3-01  NOT =  0 AND  5  AND  6
005610         GO  TO  UPD2-010.
005620     IF  JMST3-03  >  W-TH
005630         GO  TO  UPD2-EX.
005640     IF  JMST3-03  >= W-FH1 AND   <=  W-TH1
005650         GO  TO  UPD2-020.
005660     IF  JMST3-03  >= W-FH2 AND   <=  W-TH2
005670         GO  TO  UPD2-020.
005680     IF  JMST3-03  >= W-FH3 AND   <=  W-TH3
005690         GO  TO  UPD2-020.
005700     IF  JMST3-03  >= W-FH4 AND   <=  W-TH4
005710         GO  TO  UPD2-020.
005720     IF  JMST3-03  >= W-FH5 AND   <=  W-TH5
005730         GO  TO  UPD2-020.
005740     GO  TO  UPD2-010.
005750*
005760 UPD2-020.
005770     PERFORM  ZC6-RTN      THRU  ZC6-EX.
005780     IF  ZERO-SW  =  1
005790         PERFORM WRI-RTN THRU WRI-EX.
005800     GO  TO  UPD2-010.
005810 UPD2-EX.
005820     EXIT.
005830******************************
005840***   UPD3  RTN            ***
005850******************************
005860 UPD3-RTN.
005870     INITIALIZE                 JNYZ-KEY.
005880     MOVE  W-FH1            TO  JNYZ-01.
005890     START  JNYZ   KEY  NOT <  JNYZ-KEY   INVALID
005900         GO  TO  UPD3-EX.
005910 UPD3-010.
005920     READ  JNYZ   NEXT  UNLOCK  AT  END
005930         GO  TO  UPD3-EX.
005940     MOVE  9            TO  W-KURA.
005950     MOVE  JNYZ-01      TO  W-HCD.
005960     MOVE  JNYZ-02      TO  W-SIZ.
005970*****MOVE  W-HCD        TO  SHM-KEY.                              D.010818
005980*****READ  SHM  UNLOCK  INVALID                                   D.010818
005990     MOVE  W-HCD        TO  HI-MHCD HI-HCD.                       I.010818
006000     READ  HI2-M  UNLOCK  INVALID                                 I.010818
006010         GO  TO  UPD3-010.
006020     IF  W-SEN  =  0
006030*****    IF  SHM-05   <  20  OR   >  29                           D.010601
006040*****    IF  SHM-05   <  30  OR   >  39                           D.010818
006050         IF  HI-BC3   <  30  OR   >  39                           I.010818
006060             GO  TO  UPD3-010.
006070     IF  W-SEN  =  1
006080*****    IF  SHM-05   >  19  AND  <  30                           D.010601
006090*****    IF  SHM-05   >  29  AND  <  40                           D.010818
006100*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
006110         IF  HI-BC3   <  20  OR   >  29                           I.030725
006120             GO  TO  UPD3-010.
006130     IF  W-SEN  =  2                                              I.030725
006140         IF  HI-BC3   >  19                                       I.030725
006150             GO  TO  UPD3-010.                                    I.030725
006160*
006170     IF  JNYZ-01   >  W-TH
006180         GO  TO  UPD3-EX.
006190     IF  JNYZ-01   >= W-FH1 AND   <=  W-TH1
006200         GO  TO  UPD3-020.
006210     IF  JNYZ-01   >= W-FH2 AND   <=  W-TH2
006220         GO  TO  UPD3-020.
006230     IF  JNYZ-01   >= W-FH3 AND   <=  W-TH3
006240         GO  TO  UPD3-020.
006250     IF  JNYZ-01   >= W-FH4 AND   <=  W-TH4
006260         GO  TO  UPD3-020.
006270     IF  JNYZ-01   >= W-FH5 AND   <=  W-TH5
006280         GO  TO  UPD3-020.
006290     GO  TO  UPD3-010.
006300*
006310 UPD3-020.
006320     MOVE  9             TO  NJZAI-01.
006330     MOVE  W-HCD         TO  NJZAI-02.
006340     MOVE  W-SIZ         TO  NJZAI-03.
006350     READ  NJZAI           UNLOCK  INVALID
006360           MOVE  ZERO        TO  NJZAI-0711(01)  NJZAI-0711(02)
006370                                 NJZAI-0711(03)  NJZAI-0711(04)
006380                                 NJZAI-0711(05)  NJZAI-0711(06)
006390                                 NJZAI-0711(07)  NJZAI-0711(08)
006400                                 NJZAI-0711(09)  NJZAI-0711(10).
006410     PERFORM  ZC5-RTN      THRU  ZC5-EX.
006420     IF  ZERO-SW  =  1
006430         PERFORM WRI-RTN THRU WRI-EX.
006440     GO  TO  UPD3-010.
006450 UPD3-EX.
006460     EXIT.
006470******************************
006480***   UPD4  RTN            ***
006490******************************
006500 UPD4-RTN.
006510*****INITIALIZE                 SHM-KEY.                          D.010818
006520*****MOVE  W-FH1            TO  SHM-01.                           D.010818
006530*****START  SHM    KEY  NOT <  SHM-KEY    INVALID                 D.010818
006540     INITIALIZE                 HI-KEY2.                          I.010818
006550     MOVE  W-FH1            TO  HI-MHCD HI-HCD.                   I.010818
006560     START  HI2-M  KEY  NOT <  HI-KEY2    INVALID                 I.010818
006570         GO  TO  UPD4-EX.
006580 UPD4-010.
006590*****READ  SHM    NEXT  UNLOCK  AT  END                           D.010818
006600     READ  HI2-M  NEXT  UNLOCK  AT  END                           I.010818
006610         GO  TO  UPD4-EX.
006620     IF  W-SEN  =  0
006630*****    IF  SHM-05   <  20  OR   >  29                           D.010601
006640*****    IF  SHM-05   <  30  OR   >  39                           D.010818
006650         IF  HI-BC3   <  30  OR   >  39                           I.010818
006660             GO  TO  UPD4-010.
006670     IF  W-SEN  =  1
006680*****    IF  SHM-05   >  19  AND  <  30                           D.010601
006690*****    IF  SHM-05   >  29  AND  <  40                           D.010818
006700*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
006710         IF  HI-BC3   <  20  OR   >  29                           I.030725
006720             GO  TO  UPD4-010.
006730     IF  W-SEN  =  2                                              I.030725
006740         IF  HI-BC3   >  19                                       I.030725
006750             GO  TO  UPD4-010.                                    I.030725
006760     MOVE  9            TO  W-KURA.
006770*****MOVE  SHM-01       TO  W-HCD.                                D.010818
006780     MOVE  HI-MHCD      TO  W-HCD.                                I.010818
006790     MOVE  ZERO         TO  W-SIZ   HI-S4(10).                    I.010818
006800*****MOVE  ZERO         TO  W-SIZ   SHM-0441(10).                 D.010818
006810*
006820*****IF  SHM-01    >  W-TH                                        D.010818
006830     IF  HI-MHCD   >  W-TH                                        I.010818
006840         GO  TO  UPD4-EX.
006850*****IF  SHM-01    >= W-FH1 AND   <=  W-TH1                       D.010818
006860     IF  HI-MHCD   >= W-FH1 AND   <=  W-TH1                       I.010818
006870         GO  TO  UPD4-020.
006880*****IF  SHM-01    >= W-FH2 AND   <=  W-TH2                       D.010818
006890     IF  HI-MHCD   >= W-FH2 AND   <=  W-TH2                       I.010818
006900         GO  TO  UPD4-020.
006910*****IF  SHM-01    >= W-FH3 AND   <=  W-TH3                       D.010818
006920     IF  HI-MHCD   >= W-FH3 AND   <=  W-TH3                       I.010818
006930         GO  TO  UPD4-020.
006940*****IF  SHM-01    >= W-FH4 AND   <=  W-TH4                       D.010818
006950     IF  HI-MHCD   >= W-FH4 AND   <=  W-TH4                       I.010818
006960         GO  TO  UPD4-020.
006970*****IF  SHM-01    >= W-FH5 AND   <=  W-TH5                       D.010818
006980     IF  HI-MHCD   >= W-FH5 AND   <=  W-TH5                       I.010818
006990         GO  TO  UPD4-020.
007000     GO  TO  UPD4-010.
007010 UPD4-020.
007020     ADD   1            TO  W-SIZ.
007030     IF  W-SIZ          =  5
007040         GO  TO  UPD4-010.
007050     IF  W-SIZ          =  1
007060*****    IF  SHM-041       =  ZERO                                D.010818
007070         IF  HI-SS1        =  ZERO                                I.010818
007080             GO  TO  UPD4-020.
007090     IF  W-SIZ          =  2
007100*****    IF  SHM-042       =  ZERO                                D.010818
007110         IF  HI-SS2        =  ZERO                                I.010818
007120             GO  TO  UPD4-020.
007130     IF  W-SIZ          =  3
007140*****    IF  SHM-043       =  ZERO                                D.010818
007150         IF  HI-SS3        =  ZERO                                I.010818
007160             GO  TO  UPD4-020.
007170     IF  W-SIZ          =  4
007180*****    IF  SHM-044       =  ZERO                                D.010818
007190         IF  HI-SS4        =  ZERO                                I.010818
007200             GO  TO  UPD4-020.
007210*
007220     MOVE  9             TO  NJZAI-01.
007230     MOVE  W-HCD         TO  NJZAI-02.
007240     MOVE  W-SIZ         TO  NJZAI-03.
007250     READ  NJZAI           UNLOCK  INVALID
007260           MOVE  ZERO        TO  YZAI-R
007270           GO  TO  UPD4-025.
007280     MOVE  0                TO  DATA-SW.
007290     PERFORM  SET-RTN      THRU  SET-EX.
007300*
007310 UPD4-025.
007320     INITIALIZE                 JMST3-KEY.
007330     MOVE  W-HCD            TO  JMST3-03.
007340     START  JMST3  KEY  NOT <  JMST3-KEY  INVALID
007350         GO  TO  UPD4-040.
007360 UPD4-030.
007370     READ  JMST3  NEXT  UNLOCK  AT  END
007380         GO  TO  UPD4-040.
007390     IF  W-HCD          NOT =  JMST3-03
007400         GO  TO  UPD4-040.
007410     IF  W-SIZ          NOT =  JMST3-09
007420         GO  TO  UPD4-030.
007430     IF  JMST3-01           =  0
007440         GO  TO  UPD4-030.
007450     MOVE  1                TO  DATA-SW.
007460     PERFORM  SET-RTN      THRU  SET-EX.
007470     GO  TO  UPD4-030.
007480 UPD4-040.
007490     MOVE  W-HCD        TO  JNYZ-01.
007500     MOVE  W-SIZ        TO  JNYZ-02.
007510     READ  JNYZ UNLOCK  INVALID
007520         GO  TO  UPD4-050.
007530     MOVE  9             TO  NJZAI-01.
007540     MOVE  W-HCD         TO  NJZAI-02.
007550     MOVE  W-SIZ         TO  NJZAI-03.
007560     READ  NJZAI           UNLOCK  INVALID
007570           MOVE  ZERO        TO  NJZAI-0711(01)  NJZAI-0711(02)
007580                                 NJZAI-0711(03)  NJZAI-0711(04)
007590                                 NJZAI-0711(05)  NJZAI-0711(06)
007600                                 NJZAI-0711(07)  NJZAI-0711(08)
007610                                 NJZAI-0711(09)  NJZAI-0711(10).
007620     MOVE  2                TO  DATA-SW.
007630     PERFORM  SET-RTN      THRU  SET-EX.
007640 UPD4-050.
007650     PERFORM  ZC8-RTN      THRU  ZC8-EX.
007660     IF  ZERO-SW  =  1
007670         PERFORM WRI-RTN THRU WRI-EX.
007680     GO  TO  UPD4-020.
007690 UPD4-EX.
007700     EXIT.
007710*･････････････････････････････････････････････････････････････････････････
007720********************************
007730*    前月残　セット　          *
007740********************************
007750 ZC0-RTN.
007760     MOVE  ZERO  TO  YZAI-R.
007770     MOVE  0     TO  ZERO-SW.
007780     MOVE  1     TO  I.
007790 ZC0-010.
007800     IF  I  >  10
007810         GO  TO  ZC0-EX.
007820     COMPUTE  YZAI-0411(I)  =  NJZAI-0411(I)  -  NJZAI-0511(I)
007830                            +  NJZAI-0611(I)  +  NJZAI-1111(I).
007840     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
007850         MOVE  0     TO  YZAI-90
007860         MOVE   1     TO  ZERO-SW.
007870     ADD  1     TO  I.
007880     GO  TO  ZC0-010.
007890 ZC0-EX.
007900     EXIT.
007910********************************
007920*    入庫セット　 　　         *
007930********************************
007940 ZC1-RTN.
007950     MOVE  ZERO  TO  YZAI-R.
007960     MOVE  0     TO  ZERO-SW.
007970     MOVE  1     TO  I.
007980 ZC1-010.
007990     IF  I  >  10
008000         GO  TO  ZC1-EX.
008010     MOVE  NJZAI-0711(I)  TO  YZAI-0411(I).
008020     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
008030         MOVE  1     TO  YZAI-90
008040         MOVE   1     TO  ZERO-SW.
008050     ADD  1     TO  I.
008060     GO  TO  ZC1-010.
008070 ZC1-EX.
008080     EXIT.
008090********************************
008100*    出庫セット　 　　         *
008110********************************
008120 ZC2-RTN.
008130     MOVE  ZERO  TO  YZAI-R.
008140     MOVE  0     TO  ZERO-SW.
008150     MOVE  1     TO  I.
008160 ZC2-010.
008170     IF  I  >  10
008180         GO  TO  ZC2-EX.
008190     MOVE  NJZAI-0811(I)  TO  YZAI-0411(I).
008200     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
008210         MOVE  2     TO  YZAI-90
008220         MOVE   1     TO  ZERO-SW.
008230     ADD  1     TO  I.
008240     GO  TO  ZC2-010.
008250 ZC2-EX.
008260     EXIT.
008270********************************
008280*    指図セット　 　　         *
008290********************************
008300 ZC3-RTN.
008310     MOVE  ZERO  TO  YZAI-R.
008320     MOVE  0     TO  ZERO-SW.
008330     MOVE  1     TO  I.
008340 ZC3-010.
008350     IF  I  >  10
008360         GO  TO  ZC3-EX.
008370     MOVE  NJZAI-0911(I)  TO  YZAI-0411(I).
008380     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
008390         MOVE  3     TO  YZAI-90
008400         MOVE   1     TO  ZERO-SW.
008410     ADD  1     TO  I.
008420     GO  TO  ZC3-010.
008430 ZC3-EX.
008440     EXIT.
008450********************************
008460*    実在庫セット　 　         *
008470********************************
008480 ZC4-RTN.
008490     MOVE  ZERO  TO  YZAI-R.
008500     MOVE  0     TO  ZERO-SW.
008510     MOVE  1     TO  I.
008520 ZC4-010.
008530     IF  I  >  10
008540         GO  TO  ZC4-EX.
008550     COMPUTE  YZAI-0411(I)  =  NJZAI-0411(I)  -  NJZAI-0511(I)
008560                            +  NJZAI-0611(I)  +  NJZAI-1111(I)
008570                            +  NJZAI-0711(I)  -  NJZAI-0811(I)
008580                            -  NJZAI-0911(I).
008590     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
008600         MOVE  4     TO  YZAI-90
008610         MOVE   1     TO  ZERO-SW.
008620     ADD  1     TO  I.
008630     GO  TO  ZC4-010.
008640 ZC4-EX.
008650     EXIT.
008660********************************
008670*    入予定セット　 　         *
008680********************************
008690 ZC5-RTN.
008700     MOVE  ZERO  TO  YZAI-R.
008710     MOVE  0     TO  ZERO-SW.
008720     MOVE  1     TO  I.
008730 ZC5-010.
008740     IF  I  >  10
008750         GO  TO  ZC5-EX.
008760     COMPUTE  YZAI-0411(I)  =  JNYZ-0311(I)  -  NJZAI-0711(I).
008770     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
008780         MOVE  5     TO  YZAI-90
008790         MOVE   1     TO  ZERO-SW.
008800     ADD  1     TO  I.
008810     GO  TO  ZC5-010.
008820 ZC5-EX.
008830     EXIT.
008840********************************
008850*    預り・取りけ・受注セット  *
008860********************************
008870 ZC6-RTN.
008880     MOVE  ZERO  TO  YZAI-R.
008890     IF  JMST3-01    =  0
008900         MOVE  9     TO  YZAI-90.
008910     IF  JMST3-01    =  5
008920         MOVE  6     TO  YZAI-90.
008930     IF  JMST3-01    =  6
008940         MOVE  7     TO  YZAI-90.
008950     MOVE  0     TO  ZERO-SW.
008960     MOVE  1     TO  I.
008970 ZC6-010.
008980     IF  I  >  10
008990         GO  TO  ZC6-EX.
009000     COMPUTE  YZAI-0411(I)  =  JMST3-1111(I)  -  JMST3-151(I)
009010                            -  JMST3-141(I)   -  JMST3-1211(I).
009020     IF  (ZERO-SW   = 0)  AND  (YZAI-0411(I)  NOT =  ZERO)
009030         MOVE   1     TO  ZERO-SW.
009040     ADD  1     TO  I.
009050     GO  TO  ZC6-010.
009060 ZC6-EX.
009070     EXIT.
009080********************************
009090*    有効在庫セット 　　　　　 *
009100********************************
009110 ZC8-RTN.
009120     MOVE  0     TO  ZERO-SW.
009130     MOVE  1     TO  I.
009140 ZC8-010.
009150     IF  I  >  10
009160         GO  TO  ZC8-EX.
009170     IF  YZAI-0411(I)  NOT =  ZERO
009180         MOVE  8     TO  YZAI-90
009190         MOVE   1     TO  ZERO-SW
009200         GO  TO  ZC8-EX.
009210     ADD  1     TO  I.
009220     GO  TO  ZC8-010.
009230 ZC8-EX.
009240     EXIT.
009250********************************
009260*    有効在庫　計算 　　　　　 *
009270********************************
009280 SET-RTN.
009290     MOVE  1     TO  I.
009300     IF  DATA-SW         =  1
009310         GO  TO  SET-110.
009320     IF  DATA-SW         =  2
009330         GO  TO  SET-210.
009340     MOVE  ZERO  TO  YZAI-R.
009350 SET-010.
009360     IF  I  >  10
009370         GO  TO  SET-EX.
009380     COMPUTE  YZAI-0411(I)  =  NJZAI-0411(I)  -  NJZAI-0511(I)
009390                            +  NJZAI-0611(I)  +  NJZAI-1111(I)
009400                            +  NJZAI-0711(I)  -  NJZAI-0811(I)
009410                            -  NJZAI-0911(I).
009420     ADD  1     TO  I.
009430     GO  TO  SET-010.
009440 SET-110.
009450     IF  I  >  10
009460         GO  TO  SET-EX.
009470     COMPUTE  YZAI-0411(I)  =  YZAI-0411(I)  -
009480                              (JMST3-1111(I)  -  JMST3-151(I)
009490                            -  JMST3-141(I)   -  JMST3-1211(I)).
009500     ADD  1     TO  I.
009510     GO  TO  SET-110.
009520 SET-210.
009530     IF  I  >  10
009540         GO  TO  SET-EX.
009550     COMPUTE  YZAI-0411(I)  =  YZAI-0411(I)  +
009560                              (JNYZ-0311(I)  -  NJZAI-0711(I)).
009570     ADD  1     TO  I.
009580     GO  TO  SET-210.
009590 SET-EX.
009600     EXIT.
009610************************************
009620***  ＪＴ−ＹＺＡＩ　ＷＲＩＴＥ  ***
009630************************************
009640 WRI-RTN.
009650     MOVE  W-KURA      TO  YZAI-01.
009660     MOVE  W-HCD       TO  YZAI-02.
009670     MOVE  W-SIZ       TO  YZAI-03.
009680     MOVE  W-ZCHK      TO  YZAI-88.
009690     IF  W-SIZ         =  1
009700         MOVE  4          TO  YZAI-89.
009710     IF  W-SIZ         =  2
009720         MOVE  1          TO  YZAI-89.
009730     IF  W-SIZ         =  3
009740         MOVE  2          TO  YZAI-89.
009750     IF  W-SIZ         =  4
009760         MOVE  3          TO  YZAI-89.
009770     WRITE    YZAI-R.
009780     IF  ERR-STAT  NOT = "00"
009790              MOVE  "W"          TO  ERR-M
009800              MOVE  "WK0128"     TO  ERR-F
009810              PERFORM  ERR-RTN   THRU  ERR-EX.
009820 WRI-EX.
009830     EXIT.
009840***
009850     COPY    LPMSG.
