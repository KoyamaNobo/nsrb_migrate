000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT640R.
000030 AUTHOR.                        MAYUMI.I.
000040***************************************************
000050*    PROGRAM        : ìæà”êÊï èoâ◊é¿ê—ñ‚çáÇπÅ@Å@Å@* Å@Å@Å@
000060*    DATA WRITTEN   : 91/10/31                    *
000070*    SCREEN USED    : SJ640R                      *
000080*    FORM   USED    : UNUSED                      *
000090*    PRINTER TYPE   : UNUSED                      *
000100*    COMPILE TYPE   : COBOL85 (74MODE)            *
000110*    JS-SIGN        : 0=ìæà”êÊ , 1=ìæà”êÊíºëóêÊ   *
000120***************************************************
000130 ENVIRONMENT                    DIVISION.
000140 CONFIGURATION                  SECTION.
000150 SOURCE-COMPUTER.               SYSTEM3100.
000160 OBJECT-COMPUTER.               SYSTEM3100.
000170 INPUT-OUTPUT                   SECTION.
000180 FILE-CONTROL.
000190     COPY  LIBCSE.                                                I.980526
000200***  èoâ◊ó›êœÉtÉ@ÉCÉã           ( 102/5 )
000210*****SELECT   JSRU      ASSIGN  F11-MSD  F12-MSD                  D.971205
000220*****                   ORGANIZATION  INDEXED                     D.971205
000230*****                   ACCESS MODE   DYNAMIC                     D.971205
000240*****                   RECORD KEY    JSRU-KEY1                   D.971205
000250*****        ALTERNATE  RECORD KEY    JSRU-KEY2.                  D.971205
000260***  ì¸èoå…ó›êœÉtÉ@ÉCÉã         ( 170/3 )
000270     SELECT   JNSR      ASSIGN  F11-MSD  F12-MSD  F13-MSD         I.971205
000280                        ORGANIZATION  INDEXED                     I.971205
000290                        ACCESS MODE   DYNAMIC                     I.971205
000300                        RECORD KEY    JNSR-KEY1                   I.971205
000310             ALTERNATE  RECORD KEY    JNSR-KEY2                   I.971205
000320             ALTERNATE  RECORD KEY    JNSR-KEY3.                  I.971205
000330***  íºëóêÊÉ}ÉXÉ^               ( 192/4 )
000340     SELECT   TC-M      ASSIGN  F2-MSD
000350                        ORGANIZATION  INDEXED
000360                        ACCESS MODE   RANDOM
000370                        RECORD KEY    TC-KEY.
000380***  ïiñºÉ}ÉXÉ^
000390*****SELECT   SHM       ASSIGN  F3-MSD                            D.010818
000400     SELECT   HI2-M     ASSIGN  F3-MSD                            I.010818
000410                        ORGANIZATION  INDEXED
000420                        ACCESS MODE   RANDOM
000430                        RECORD KEY    HI-KEY2.                    I.010818
000440*****                   RECORD KEY    SHM-KEY.                    D.010818
000450***  ì¸èoå…ó›êœÉèÅ[ÉNÅ@         ( 170/3 )
000460     SELECT   JT-W170   ASSIGN  F41-MSD  F42-MSD                  I.971205
000470                        ORGANIZATION  INDEXED                     I.971205
000480                        ACCESS MODE   DYNAMIC                     I.971205
000490                        RECORD KEY    JTW-KEY1                    I.971205
000500             ALTERNATE  RECORD KEY    JTW-KEY3.                   I.971205
000510***  èoâ◊ó›êœÉèÅ[ÉN             ( 102/5 )
000520*****SELECT   JT-WKN1   ASSIGN  F4-MSD                            D.971205
000530*****                   ORGANIZATION  INDEXED                     D.971205
000540*****                   ACCESS MODE   DYNAMIC                     D.971205
000550*****                   RECORD KEY    WN01-KEY.                   D.971205
000560***  ÉRÉìÉgÉçÅ[ÉãÇe             (  32/8 )
000570     SELECT   JCON      ASSIGN  F5-MSD                            I.950217
000580                        ORGANIZATION  INDEXED                     I.950217
000590                        ACCESS MODE   DYNAMIC                     I.950217
000600                        RECORD KEY    JCON2-KEY.                  I.950217
000610 I-O-CONTROL.
000620     APPLY   SHARED-MODE ON  M-DATE JNSR HI2-M TC-M  JT-W170 JCON.I.010818
000630*****APPLY   SHARED-MODE ON  M-DATE JNSR  SHM  TC-M  JT-W170 JCON.D.010818
000640*****APPLY   SHARED-MODE ON  JNSR  SHM  TC-M  JT-W170 JCON.       D.980526
000650*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M.                     D.940905
000660*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M  JT-WKN1.            D.950217
000670*****APPLY   SHARED-MODE ON  JSRU  SHM  TC-M  JT-WKN1 JCON.       D.971205
000680*
000690 DATA                       DIVISION.
000700 FILE                       SECTION.
000710     COPY  LIBFDD.                                                I.980526
000720 COPY  L-JNSR.                                                    I.971205
000730 COPY  LIHIM2.                                                    I.010818
000740*COPY  L-JSRU.                                                    D.971205
000750*COPY  L-SHM.                                                     D.010818
000760 COPY  LITCM.
000770*COPY  LTWKN1.                                                    D.971205
000780 COPY  LJT170.                                                    I.971205
000790 COPY  L-JCON.                                                    I.950217
000800*
000810 WORKING-STORAGE            SECTION.
000820 77  JS-SIGN                   PIC 9(01).                         I.081120
000830 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000840*77  JT-IWS102ID               PIC X(12).                         D.971205
000850 77  JT-W170K1ID               PIC X(12).                         I.971205
000860 77  JT-W170K3ID               PIC X(12).                         I.971205
000870 77  W-DC                      PIC 9(01).                         I.940905
000880 01  STN-NO.                                                      I.940905
000890     02  STN-NO-01             PIC X(03).                         I.940905
000900     02  STN-NO-02             PIC X(03).                         I.940905
000910 01  WF1-ID.                                                      I.971205
000920     02  WORK1-ID-01           PIC X(09) VALUE "JT-W170K1".       I.971205
000930     02  WORK1-ID-02           PIC X(03).                         I.971205
000940 01  WF2-ID.                                                      I.971205
000950     02  WORK2-ID-01           PIC X(09) VALUE "JT-W170K3".       I.971205
000960     02  WORK2-ID-02           PIC X(03).                         I.971205
000970*01  WF-ID.                                                       D.971205
000980*****02  WORK-ID-01            PIC X(09) VALUE "JT-IWS102".       D.971205
000990*****02  WORK-ID-02            PIC X(03).                         D.971205
001000 01  W-AREA.
001010     02  SW                    PIC X(03).
001020*    SW  =  " ON" ---> É}ÉXÉ^ÇÇqÇdÇ`ÇcÇµÇƒÅCÇhÇmÇuÇ`ÇkÇhÇcÇÃéûÅB
001030*    SW  =  "OFF" ---> É}ÉXÉ^ÇÇqÇdÇ`ÇcÇµÇƒÅCÇmÇnÇqÇlÇ`ÇkÇÃéûÅB
001040     02  LIN                   PIC 9(02).                         LINE
001050     02  LIN1                  PIC 9(02).
001060***  DISPLAY  GAMEN-CLR Ç∑ÇÈéûÅCàÍí[ LIN ÇÇrÇ`ÇuÇdÇµÇƒÇ®Ç≠ÅB
001070     02  COL                   PIC 9(02).                         COLUMN
001080     02 G                      PIC 9(02).                         çs 1Å`18
001090     02 GG                     PIC 9(02).                         çs 1Å`18
001100     02 I                      PIC 9(02).                         1Å`10
001110     02  W-DATE                PIC 9(08).                         I.980526
001120*****02  W-DATE                PIC 9(06).                         D.980526
001130     02  W-AREA1.
001140         03  W-TOK             PIC 9(04).
001150         03  W-CCD             PIC 9(03).                         I.081120
001160         03  W-AREA2.
001170             04  W-FROM            PIC 9(08).                     I.980526
001180             04  W-FROMD  REDEFINES  W-FROM.                      I.980526
001190                 05  W-FNEN        PIC 9(04).                     I.980526
001200                 05  W-FNENL  REDEFINES  W-FNEN.                  I.980526
001210                     06  W-FNEN1   PIC 9(02).                     I.980526
001220                     06  W-FNEN2   PIC 9(02).                     I.980526
001230                 05  W-FGET        PIC 9(02).                     I.980526
001240                 05  W-FPEY        PIC 9(02).                     I.980526
001250             04  W-FROML  REDEFINES  W-FROM.                      I.980526
001260                 05  F             PIC 9(02).                     I.980526
001270                 05  W-FROMS       PIC 9(06).                     I.980526
001280             04  W-TO              PIC 9(08).                     I.980526
001290             04  W-TOD    REDEFINES  W-TO.                        I.980526
001300                 05  W-TNEN        PIC 9(04).                     I.980526
001310                 05  W-TNENL  REDEFINES  W-TNEN.                  I.980526
001320                     06  W-TNEN1   PIC 9(02).                     I.980526
001330                     06  W-TNEN2   PIC 9(02).                     I.980526
001340                 05  W-TGET        PIC 9(02).                     I.980526
001350                 05  W-TPEY        PIC 9(02).                     I.980526
001360             04  W-TOL    REDEFINES  W-TO.                        I.980526
001370                 05  F             PIC 9(02).                     I.980526
001380                 05  W-TOS         PIC 9(06).                     I.980526
001390*****        04  W-FROM            PIC 9(06).                     D.980526
001400*****        04  W-TO              PIC 9(06).                     D.980526
001410             04  W-DEN             PIC N(02).
001420             04  W-HIZ.                                           I.940906
001430                 05  F             PIC 9(02).                     I.980526
001440                 05  W-HIZ1        PIC 9(02).                     I.940906
001450                 05  W-HIZ2        PIC 9(02).                     I.940906
001460                 05  W-HIZ3        PIC 9(02).                     I.940906
001470             04  W-SOK             PIC S9(06).                    I.940906
001480*****        04  W-KBN             PIC X(01).                     D.061020
001490             04  W-KBN             PIC 9(01).                     I.061020
001500             04  W-SAS             PIC 9(06).                     I.940906
001510             04  W-SHOSAI.
001520                 05  W-GYO             PIC 9(02).
001530*****            05  W-SHOSAI1  OCCURS 18.                        D.061020
001540                 05  W-SHOSAI1  OCCURS 17.                        I.061020
001550                     06  W-SIZE1       PIC 9(01).                 ÉTÉCÉYãÊ
001560*****                06  W-CHO         PIC 9(07).                 D.061020
001570                     06  W-CHO.                                   I.061020
001580                         07  W-CHOT    PIC 9(04).                 I.061020
001590                         07  W-CHOC    PIC 9(03).                 I.061020
001600                     06  W-SIZE2       PIC S9(05)   OCCURS 10.    ªï èoâ◊
001610                     06  W-GNO         PIC 9(07).                 I.941117
001620                     06  W-GNOD   REDEFINES  W-GNO.               I.941117
001630                         07  W-GNO1    PIC 9(06).                 I.941117
001640                         07  W-GNO2    PIC 9(01).                 I.941117
001650                     06  W-TEK1        PIC N(09).                 I.061020
001660                     06  W-TEK2        PIC N(21).                 I.061020
001670                     06  W-OKNO        PIC 9(06).                 I.061020
001680                     06  W-UNSO        PIC 9(01).                 I.950217
001690                     06  W-KURA        PIC 9(01).                 I.061020
001700                 05  OKC               PIC 9(01).
001710*
001720 COPY    LWMSG.
001730*
001740 SCREEN                  SECTION.
001750 SD  CRT-X
001760     END STATUS  IS  ESTAT.
001770 01  CLR-1           LINE  1.
001780     02  CLEAR   SCREEN.
001790 01  CLR-AREA.
001800     02  LINE 1  COLUMN 15          PIC X(46)   VALUE " ".
001810     02  CLR-01.                                                  CLR-01
001820         03  LINE 1  COLUMN  68     PIC X(06)   VALUE " ".
001830         03  LINE 1  COLUMN  75     PIC X(06)   VALUE " ".
001840         03  CLR-02.                                              CLR-02
001850             04  LINE LIN COLUMN 4  PIC X(05)   VALUE " ".
001860             04  LINE LIN COLUMN 10 PIC X(02)   VALUE " ".        I.061020
001870             04  LINE LIN COLUMN 13 PIC X(53)   VALUE " ".        I.061020
001880             04  LINE LIN COLUMN 67 PIC X(07)   VALUE " ".        I.061020
001890             04  LINE LIN COLUMN 75 PIC X(06)   VALUE " ".        I.061020
001900*****        04  LINE LIN COLUMN 10 PIC X(04)   VALUE " ".        D.061020
001910*****        04  LINE LIN COLUMN 15 PIC X(48)   VALUE " ".        D.061020
001920*****        04  LINE LIN COLUMN 64 PIC X(08)   VALUE " ".        D.061020
001930*****        04  LINE LIN COLUMN 73 PIC X(01)   VALUE " ".        D.061020
001940*****        04  LINE LIN COLUMN 74 PIC X(06)   VALUE " ".        D.061020
001950*****        04  CLR-03  LINE 21.                                 D.061020
001960             04  CLR-03  LINE 20.                                 I.061020
001970                 05  COLUMN 13      PIC X(04)   VALUE " ".
001980                 05  COLUMN 20      PIC X(04)   VALUE " ".
001990                 05  COLUMN 27      PIC X(04)   VALUE " ".
002000                 05  COLUMN 34      PIC X(04)   VALUE " ".
002010                 05  COLUMN 41      PIC X(04)   VALUE " ".
002020                 05  COLUMN 48      PIC X(04)   VALUE " ".
002030                 05  COLUMN 55      PIC X(04)   VALUE " ".
002040                 05  COLUMN 62      PIC X(04)   VALUE " ".
002050                 05  COLUMN 69      PIC X(04)   VALUE " ".
002060                 05  COLUMN 76      PIC X(04)   VALUE " ".
002070             04  CLEAR  DATA     LINE 21.                         I.061020
002080             04  LINE 22  COLUMN   6     PIC X(52)   VALUE " ".   I.061020
002090             04  LINE 22  COLUMN  62     PIC X(06)   VALUE " ".   I.061020
002100             04  LINE 22  COLUMN  69     PIC X(01)   VALUE " ".   I.061020
002110             04  LINE 22  COLUMN  74     PIC X(06)   VALUE " ".   I.061020
002120             04  LINE 23  COLUMN   6     PIC X(60)   VALUE " ".   I.061020
002130             04  LINE 23  COLUMN  72     PIC X(01)   VALUE " ".   I.061020
002140             04  LINE 23  COLUMN  79     PIC X(01)   VALUE " ".   I.061020
002150*****        04  CLEAR  DATA     LINE 22.                         D.061020
002160*****        04  LINE 23  COLUMN  11     PIC X(48)   VALUE " ".   D.061020
002170*****        04  LINE 23  COLUMN  66     PIC X(04)   VALUE " ".   D.061020
002180*****        04  LINE 23  COLUMN  71     PIC X(06)   VALUE " ".   D.061020
002190*****        04  LINE 23  COLUMN  78     PIC X(01)   VALUE " ".   D.061020
002200*****        04  LINE 24  COLUMN   1     PIC X(12)   VALUE " ".   D.061020
002210             04  LINE 24  COLUMN  70     PIC X(01)   VALUE " ".
002220     02  CLR-SHOSAI.
002230*****    03  CLR-04  LINE 21.                                     D.061020
002240         03  CLR-04  LINE 20.                                     I.061020
002250             04  COLUMN 13          PIC X(04)   VALUE " ".
002260             04  COLUMN 20          PIC X(04)   VALUE " ".
002270             04  COLUMN 27          PIC X(04)   VALUE " ".
002280             04  COLUMN 34          PIC X(04)   VALUE " ".
002290             04  COLUMN 41          PIC X(04)   VALUE " ".
002300             04  COLUMN 48          PIC X(04)   VALUE " ".
002310             04  COLUMN 55          PIC X(04)   VALUE " ".
002320             04  COLUMN 62          PIC X(04)   VALUE " ".
002330             04  COLUMN 69          PIC X(04)   VALUE " ".
002340             04  COLUMN 76          PIC X(04)   VALUE " ".
002350*****    03  CLR-05  LINE 22.                                     D.061020
002360         03  CLR-05  LINE 21.                                     D.061020
002370             04  COLUMN 11          PIC X(06)   VALUE " ".
002380             04  COLUMN 18          PIC X(06)   VALUE " ".
002390             04  COLUMN 25          PIC X(06)   VALUE " ".
002400             04  COLUMN 32          PIC X(06)   VALUE " ".
002410             04  COLUMN 39          PIC X(06)   VALUE " ".
002420             04  COLUMN 46          PIC X(06)   VALUE " ".
002430             04  COLUMN 53          PIC X(06)   VALUE " ".
002440             04  COLUMN 60          PIC X(06)   VALUE " ".
002450             04  COLUMN 67          PIC X(06)   VALUE " ".
002460             04  COLUMN 74          PIC X(06)   VALUE " ".
002470     02  GAMEN-CLR    LINE LIN.                                   GAMEN-
002480         03  COLUMN 4                PIC X(05)   VALUE " ".            CLR
002490         03  COLUMN 10               PIC X(02)   VALUE " ".       I.061020
002500         03  COLUMN 13               PIC X(53)   VALUE " ".       I.061020
002510         03  COLUMN 67               PIC X(07)   VALUE " ".       I.061020
002520         03  COLUMN 75               PIC X(06)   VALUE " ".       I.061020
002530*****    03  COLUMN 10               PIC X(04)   VALUE " ".       D.061020
002540*****    03  COLUMN 15               PIC X(48)   VALUE " ".       D.061020
002550*****    03  COLUMN 64               PIC X(08)   VALUE " ".       D.061020
002560*****    03  COLUMN 73               PIC X(01)   VALUE " ".       D.061020
002570*****    03  COLUMN 74               PIC X(06)   VALUE " ".       D.061020
002580*
002590 01  DSP-AREA.
002600     02  LINE LIN.
002610         03  DSP-HIZ1   COLUMN 04   PIC ZZ                        èoâ◊Å@åé
002620                        FROM  W-HIZ2.                             I.940906
002630*****                   FROM  JSRU-132.                           D.940906
002640         03  DSP-HIZ    COLUMN 06   PIC X(01)                     "/"
002650                        VALUE "/".
002660         03  DSP-HIZ2   COLUMN 07   PIC ZZ                        èoâ◊Å@ì˙
002670                        FROM  W-HIZ3.                             I.940906
002680*****                   FROM  JSRU-133.                           D.940906
002690*****    03  DSP-DEN    COLUMN 10   PIC N(02)                     D.061020
002700         03  DSP-DEN    COLUMN 10   PIC N(01)                     I.061020
002710                        FROM  W-DEN.
002720         03  DSP-HCD    COLUMN 13   PIC 9(04)                     I.061020
002730                        FROM  HI-HCD1.                            I.061020
002740*****    03  DSP-HIN    COLUMN 15   PIC N(24)                     D.061020
002750         03  DSP-HIN    COLUMN 18   PIC N(24)                     I.061020
002760                        FROM  HI-NAME.                            I.010818
002770*****                   FROM  SHM-02.                             D.010818
002780*****    03  DSP-SOK    COLUMN 64   PIC ----,--9                  D.061020
002790         03  DSP-SOK    COLUMN 67   PIC ---,--9                   I.061020
002800                        FROM  W-SOK.                              I.940906
002810*****                   FROM  JSRU-092.                           D.940906
002820*****    03  DSP-KBN    COLUMN 73   PIC X(01)                     D.061020
002830*****                   FROM  W-KBN.                              D.061020
002840*****    03  DSP-SAS    COLUMN 74   PIC 9(06)                     D.061020
002850         03  DSP-SAS    COLUMN 75   PIC 9(06)                     I.061020
002860                        FROM  W-SAS.                              I.940906
002870*****                   FROM  JSRU-151.                           D.940906
002880*
002890 01  DSP-AREA1.
002900     02  DSP-TOK     LINE 1  COLUMN 20     PIC N(21)
002910                     FROM  TC-NAME.
002920     02  DSP-SHOSAI.
002930         03  DSP-SHOSAI1.
002940*****        04  DSP-CHON    LINE 23 COLUMN 11     PIC N(24)      D.061020
002950             04  DSP-CHOC    LINE 22 COLUMN  6     PIC 9(03)      I.061020
002960                             FROM  W-CHOC(GG).                    I.061020
002970             04  DSP-CHON    LINE 22 COLUMN 10     PIC N(24)      I.061020
002980                             FROM  TC-NAME.
002990*****        04  DSP-SIZE1   LINE 22 COLUMN 7      PIC 9(01)      D.061020
003000             04  DSP-SIZE1   LINE 21 COLUMN 7      PIC 9(01)      I.061020
003010                             FROM  W-SIZE1(GG).
003020             04  DSP-GNO.                                         I.941117
003030*****            05  LINE 23 COLUMN 66     PIC N(02)              D.061020
003040*****                        VALUE NC"éÛáÇ".                      D.061020
003050*****            05  LINE 23 COLUMN 71     PIC 9(06)              D.061020
003060                 05  LINE 22 COLUMN 62     PIC 9(06)              I.061020
003070                             FROM  W-GNO1(GG).                    I.941117
003080*****            05  LINE 23 COLUMN 78     PIC 9(01)              D.061020
003090                 05  LINE 22 COLUMN 69     PIC 9(01)              I.061020
003100                             FROM  W-GNO2(GG).                    I.941117
003110             04  DSP-OKNO    LINE 22 COLUMN 74     PIC 9(06)      I.061020
003120                             FROM  W-OKNO(GG).                    I.061020
003130             04  DSP-TEK1    LINE 23 COLUMN 6      PIC N(09)      I.061020
003140                             FROM  W-TEK1(GG).                    I.061020
003150             04  DSP-TEK2    LINE 23 COLUMN 24     PIC N(21)      I.061020
003160                             FROM  W-TEK2(GG).                    I.061020
003170             04  DSP-UNSO    LINE 23 COLUMN 72     PIC 9(01)      I.061020
003180                             FROM  W-UNSO(GG).                    I.061020
003190             04  DSP-KURA    LINE 23 COLUMN 79     PIC 9(01)      I.061020
003200                             FROM  W-KURA(GG).                    I.061020
003210*****        04  DSP-UNSO    LINE 24 COLUMN 1      PIC N(06)      D.061020
003220*****                        FROM  JCON2-03.                      D.061020
003230         03  DSP-SHOSAI2.
003240*****        04  DSP-SIZE2   LINE 22 COLUMN COL    PIC ------     D.061020
003250             04  DSP-SIZE2   LINE 21 COLUMN COL    PIC --,---     I.061020
003260                             FROM  W-SIZE2(GG I).
003270*****02  DSP-1       LINE 21.                                     D.061020
003280*****    03  COLUMN 13     VALUE "ÇRçÜ".                          D.061020
003290*****    03  COLUMN 20     VALUE "ÇQçÜ".                          D.061020
003300*****    03  COLUMN 27     VALUE "ÇPçÜ".                          D.061020
003310*****    03  COLUMN 34     VALUE "ÇOçÜ".                          D.061020
003320*****    03  COLUMN 41     VALUE " íÜ ".                          D.061020
003330*****    03  COLUMN 48     VALUE " ëÂ ".                          D.061020
003340*****    03  COLUMN 55     VALUE "ì¡ëÂ".                          D.061020
003350     02  DSP-1       LINE 20.                                     I.061020
003360         03  COLUMN 13     VALUE "    ".                          I.061020
003370         03  COLUMN 20     VALUE "    ".                          I.061020
003380         03  COLUMN 27     VALUE "ÇrÇr".                          I.061020
003390         03  COLUMN 34     VALUE "Å@Çr".                          I.061020
003400         03  COLUMN 41     VALUE "Å@Çl".                          I.061020
003410         03  COLUMN 48     VALUE "  Çk".                          I.061020
003420         03  COLUMN 55     VALUE "ÇkÇk".                          I.061020
003430         03  COLUMN 62     VALUE "28.0".
003440         03  COLUMN 69     VALUE "29.0".
003450         03  COLUMN 76     VALUE "30.0".
003460*****02  DSP-2       LINE 21.                                     D.061020
003470     02  DSP-2       LINE 20.                                     I.061020
003480         03  COLUMN 13     VALUE "12.5".
003490         03  COLUMN 20     VALUE "13.0".
003500         03  COLUMN 27     VALUE "13.5".
003510         03  COLUMN 34     VALUE "14.0".
003520         03  COLUMN 41     VALUE "15.0".
003530         03  COLUMN 48     VALUE "16.0".
003540         03  COLUMN 55     VALUE "17.0".
003550         03  COLUMN 62     VALUE "18.0".
003560         03  COLUMN 69     VALUE "19.0".
003570         03  COLUMN 76     VALUE "20.0".
003580*****02  DSP-3       LINE 21.                                     D.061020
003590     02  DSP-3       LINE 20.                                     I.061020
003600         03  COLUMN 13     VALUE "21.0".
003610         03  COLUMN 20     VALUE "21.5".
003620         03  COLUMN 27     VALUE "22.0".
003630         03  COLUMN 34     VALUE "22.5".
003640         03  COLUMN 41     VALUE "23.0".
003650         03  COLUMN 48     VALUE "23.5".
003660         03  COLUMN 55     VALUE "24.0".
003670         03  COLUMN 62     VALUE "24.5".
003680         03  COLUMN 69     VALUE "25.0".
003690         03  COLUMN 76     VALUE "    ".
003700*****02  DSP-4       LINE 21.                                     D.061020
003710     02  DSP-4       LINE 20.                                     I.061020
003720         03  COLUMN 13     VALUE "24.0".
003730         03  COLUMN 20     VALUE "24.5".
003740         03  COLUMN 27     VALUE "25.0".
003750         03  COLUMN 34     VALUE "25.5".
003760         03  COLUMN 41     VALUE "26.0".
003770         03  COLUMN 48     VALUE "26.5".
003780         03  COLUMN 55     VALUE "27.0".
003790         03  COLUMN 62     VALUE "27.5".
003800         03  COLUMN 69     VALUE "    ".
003810         03  COLUMN 76     VALUE "    ".
003820*
003830 01  ACP-AREA.
003840     02  ACP-TOK  LINE 01  COLUMN 15     PIC 9(04)                ìæà”êÊÇb
003850                  USING  W-TOK    CHECK  OVERFLOW  NO  IFC.
003860     02  ACP-CCD  LINE 22  COLUMN  6     PIC 9(03)                I.081120
003870                  USING  W-CCD    CHECK  OVERFLOW  NO  IFC.       I.081120
003880     02  ACP-FROM LINE 01  COLUMN 68     PIC 9(06)                ÇeÇqì˙ït
003890                  USING  W-FROMS  CHECK  OVERFLOW  NO  IFC.       I.980526
003900*****             USING  W-FROM   CHECK  OVERFLOW  NO  IFC.       D.980526
003910     02  ACP-TO   LINE 01  COLUMN 75     PIC 9(06)                ÇsÇnì˙ït
003920                  USING  W-TOS    CHECK  OVERFLOW  NO  IFC.       I.980526
003930*****             USING  W-TO     CHECK  OVERFLOW  NO  IFC.       D.980526
003940*****02  ACP-GYO  LINE 22  COLUMN 2      PIC 9(02)                D.061020
003950     02  ACP-GYO  LINE 21  COLUMN 2      PIC 9(02)                I.061020
003960                  USING  W-GYO    CHECK  OVERFLOW  NO  IFC.
003970     02  ACP-OKC  LINE 24  COLUMN 70     PIC 9(01)                ämîF
003980                  USING  OKC      CHECK  OVERFLOW  NO  IFC.
003990*
004000 01  DISP-MSG-SPACE1     LINE 24.
004010     02  COLUMN  1   PIC X(39)     VALUE " ".
004020*
004030 COPY    LSMSG.
004040     COPY  LIBSCR.                                                I.980526
004050*
004060 PROCEDURE               DIVISION.
004070 HAJIME.
004080     PERFORM   INI-RTN    THRU  INI-EX.
004090     PERFORM   MAIN-RTN   THRU  MAIN-EX.
004100     PERFORM   END-RTN    THRU  END-EX.
004110     STOP  RUN.
004120************************************
004130*    ÉÅÉCÉìÅ@ÉãÅ[É`Éì              *
004140************************************
004150 MAIN-RTN.
004160     ACCEPT  ACP-TOK.                                             ìæà”êÊÇb
004170     DISPLAY DISP-MSG-SPACE1.
004180     IF  ESTAT  =  "P9"
004190         GO  TO  MAIN-EX.
004200     IF ESTAT NOT  =  "01" AND "06"
004210        GO  TO  MAIN-RTN.
004220     DISPLAY  ACP-TOK.
004230*
004240     MOVE  W-TOK    TO  TC-TCD.
004250     MOVE  "001"    TO  TC-CCD.
004260     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.
004270     IF  SW  =  " ON"
004280         DISPLAY  INV-M01
004290         GO  TO  MAIN-RTN.
004300     DISPLAY  DSP-TOK.
004310     IF JS-SIGN    =  0                                           I.081120
004320        GO  TO  MAIN-010.                                         I.081120
004330 MAIN-005.                                                        I.081120
004340     ACCEPT  ACP-CCD.                                             I.081120
004350     DISPLAY DISP-MSG-SPACE1.                                     I.081120
004360     IF  ESTAT  =  "09"                                           I.081120
004370         GO  TO  MAIN-RTN.                                        I.081120
004380     IF ESTAT NOT  =  "01" AND "06"                               I.081120
004390        GO  TO  MAIN-005.                                         I.081120
004400     DISPLAY  ACP-CCD.                                            I.081120
004410     MOVE  W-TOK    TO  TC-TCD.                                   I.081120
004420     MOVE  W-CCD    TO  TC-CCD.                                   I.081120
004430     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.                 I.081120
004440     IF  SW  =  " ON"                                             I.081120
004450         DISPLAY  INV-M01                                         I.081120
004460         GO  TO  MAIN-005.                                        I.081120
004470     DISPLAY  DSP-CHON.                                           I.081120
004480 MAIN-010.
004490     ACCEPT  ACP-FROM.                                            ÇeÇqì˙ït
004500     DISPLAY DISP-MSG-SPACE1.
004510     IF  ESTAT  =  "09"
004520         IF  JS-SIGN  =  1                                        I.081120
004530             GO  TO  MAIN-005                                     I.081120
004540         ELSE                                                     I.081120
004550             GO  TO  MAIN-RTN.
004560*****IF ESTAT NOT  =  "01" AND "06"                               D.090409
004570     IF ESTAT NOT  =  "01" AND "04" AND "06"                      I.090409
004580        GO  TO  MAIN-010.
004590     IF ESTAT      =  "04"                                        I.090409
004600        ACCEPT  W-FROMS  FROM  DATE.                              I.090409
004610     DISPLAY  ACP-FROM.
004620     IF  W-FROMS   =  ZERO                                        I.980526
004630         MOVE  ZERO     TO  W-FROM                                I.980526
004640         GO  TO  MAIN-020.                                        I.980526
004650     IF  (W-FGET  <  1  OR  >  12)  OR                            I.980526
004660         (W-FPEY  <  1  OR  >  31)                                I.980526
004670         GO  TO  MAIN-010.                                        I.980526
004680     MOVE  ZERO      TO  W-FNEN1.                                 I.980526
004690     IF W-FNEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980526
004700         ADD DATE-NC1 TO W-FNEN.                                  I.980526
004710     IF W-FNEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980526
004720         ADD DATE-NC2 TO W-FNEN.                                  I.980526
004730 MAIN-020.
004740     ACCEPT  ACP-TO.                                              ÇsÇnì˙ït
004750     DISPLAY DISP-MSG-SPACE1.
004760     IF  ESTAT  =  "09"
004770         GO  TO  MAIN-010.
004780*****IF ESTAT NOT  =  "01" AND "06"                               D.090409
004790     IF ESTAT NOT  =  "01" AND "04" AND "06"                      I.090409
004800        GO  TO  MAIN-020.
004810     IF ESTAT      =  "04"                                        I.090409
004820        ACCEPT  W-TOS  FROM  DATE.                                I.090409
004830     IF  W-TOS     =  ZERO  OR  999999                            I.980526
004840         MOVE  99999999 TO  W-TO                                  I.980526
004850         DISPLAY  ACP-TO                                          I.980526
004860         GO  TO  MAIN-025.                                        I.980526
004870     DISPLAY  ACP-TO.
004880     IF  (W-TGET  <  1  OR  >  12)  OR                            I.980526
004890         (W-TPEY  <  1  OR  >  31)                                I.980526
004900         GO  TO  MAIN-020.                                        I.980526
004910     MOVE  ZERO      TO  W-TNEN1.                                 I.980526
004920     IF W-TNEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980526
004930         ADD DATE-NC1 TO W-TNEN.                                  I.980526
004940     IF W-TNEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980526
004950         ADD DATE-NC2 TO W-TNEN.                                  I.980526
004960     IF  W-FROM  >  W-TO
004970         GO  TO  MAIN-020.
004980 MAIN-025.                                                        I.980526
004990     MOVE  2        TO  LIN.                                      * LIN
005000     MOVE  ZERO     TO  G.                                        * G
005010*
005020     MOVE  0        TO  W-DC.                                     I.940906
005030*****INITIALIZE  JSRU-KEY2.                                       D.971205
005040*****MOVE  W-TOK    TO  JSRU-12.                                  D.971205
005050*****MOVE  W-FROM   TO  JSRU-13.                                  D.971205
005060*****START  JSRU  KEY  NOT  <  JSRU-KEY2  INVALID                 D.971205
005070     INITIALIZE  JNSR-KEY3.                                       I.971205
005080     MOVE  W-TOK    TO  JNSR-19.                                  I.971205
005090     MOVE  W-FROM   TO  JNSR-20.                                  I.971205
005100     START  JNSR  KEY  NOT  <  JNSR-KEY3  INVALID                 I.971205
005110         GO  TO  MAIN-040.
005120 MAIN-030.
005130***  èoâ◊ó›åvÉtÉ@ÉCÉãÅ@ÇqÇdÇ`Çc
005140*****READ  JSRU  NEXT  UNLOCK  AT  END                            D.971205
005150     READ  JNSR  NEXT  UNLOCK  AT  END                            I.971205
005160         GO  TO  MAIN-040.
005170*****IF  W-TOK  NOT =  JSRU-12                                    D.971205
005180     IF  W-TOK  NOT =  JNSR-19                                    I.971205
005190         GO  TO  MAIN-040.
005200*****IF  W-TO  <  JSRU-13                                         D.971205
005210*****IF  W-TO  <  JNSR-20                                         D.971209
005220     MOVE   JNSR-20    TO  W-DATE.                                I.971209
005230     IF  W-TO  <  W-DATE                                          I.971209
005240         GO  TO  MAIN-040.
005250     IF  JS-SIGN    =  1                                          I.081120
005260         IF  W-CCD  NOT =  JNSR-112                               I.081120
005270             GO  TO  MAIN-030.                                    I.081120
005280*****MOVE   JSRU-13    TO  W-HIZ.                                 D.971205
005290*****MOVE   JSRU-092   TO  W-SOK.                                 D.971205
005300*****MOVE   JSRU-151   TO  W-SAS.                                 D.971205
005310*****MOVE   JNSR-20    TO  W-HIZ.                                 D.971209
005320     MOVE   W-DATE     TO  W-HIZ.                                 I.971209
005330     COMPUTE  W-SOK    =   JNSR-081(01)  +  JNSR-081(02) +        I.971205
005340                           JNSR-081(03)  +  JNSR-081(04) +        I.971205
005350                           JNSR-081(05)  +  JNSR-081(06) +        I.971205
005360                           JNSR-081(07)  +  JNSR-081(08) +        I.971205
005370                           JNSR-081(09)  +  JNSR-081(10).         I.971205
005380     MOVE   JNSR-221   TO  W-SAS.                                 I.971205
005390*****MOVE   SPACE      TO  W-KBN.                                 D.061020
005400*****IF  JSRU-06          NOT  =  ZERO                            D.971205
005410*****    IF  JSRU-01               =  0                           D.971205
005420*****IF  JNSR-151         NOT  =  ZERO                            D.061020
005430*****    IF  JNSR-13               =  0                           D.061020
005440*****                MOVE  "*"        TO  W-KBN                   D.061020
005450*****        ELSE    IF  JSRU-01           =  5                   D.971205
005460*****        ELSE    IF  JNSR-13           =  5                   D.061020
005470*****                           MOVE  "#"         TO  W-KBN       D.061020
005480*****                    ELSE   MOVE  "$"         TO  W-KBN.      D.061020
005490 NEXT-DSP.
005500     ADD  1     TO  LIN.                                          * LIN
005510     ADD  1     TO  G.                                            * G
005520*****IF  LIN  =  21                                               D.061020
005530     IF  LIN  =  20                                               I.061020
005540         SUBTRACT  1     FROM  G                                  * G
005550         GO  TO  MAIN-OKC.
005560     PERFORM  WORK-RTN     THRU  WORK-EX.
005570     PERFORM  DSP-RTN      THRU  DSP-EX.
005580     GO  TO  MAIN-030.
005590 MAIN-040.
005600     MOVE  1        TO  W-DC.                                     I.940906
005610*****INITIALIZE  WN01-KEY.                                        D.971205
005620*****MOVE  W-TOK    TO  WN01-12.                                  D.971205
005630*****MOVE  W-FROM   TO  WN01-13.                                  D.971205
005640*****START  JT-WKN1  KEY  NOT  <  WN01-KEY  INVALID               D.971205
005650     INITIALIZE  JTW-KEY3.                                        I.971205
005660     MOVE  W-TOK    TO  JTW-19.                                   I.971205
005670     MOVE  W-FROM   TO  JTW-20.                                   I.971205
005680     START  JT-W170  KEY  NOT  <  JTW-KEY3  INVALID               I.971205
005690         GO  TO  MAIN-047.                                        I.940905
005700 MAIN-042.                                                        I.940905
005710***  èoâ◊ó›åvÉèÅ[ÉNÅ@ÇqÇdÇ`Çc
005720*****READ  JT-WKN1 NEXT  UNLOCK  AT  END                          D.971205
005730     READ  JT-W170 NEXT  UNLOCK  AT  END                          I.971205
005740         GO  TO  MAIN-047.                                        I.940905
005750*****IF  W-TOK  NOT =  WN01-12                                    D.971205
005760     IF  W-TOK  NOT =  JTW-19                                     I.971205
005770         GO  TO  MAIN-047.                                        I.940905
005780*****IF  W-TO  <  WN01-13                                         D.971205
005790*****IF  W-TO  <  JTW-20                                          D.971209
005800     MOVE   JTW-20     TO  W-DATE.                                I.971209
005810     IF  W-TO  <  W-DATE                                          I.971209
005820         GO  TO  MAIN-047.                                        I.940905
005830     IF  JS-SIGN    =  1                                          I.081120
005840         IF  W-CCD  NOT =  JTW-112                                I.081120
005850             GO  TO  MAIN-042.                                    I.081120
005860     MOVE   ZERO       TO  W-HIZ.                                 I.940906
005870*****MOVE   WN01-092   TO  W-SOK.                                 D.971205
005880*****MOVE   WN01-151   TO  W-SAS.                                 D.971205
005890     COMPUTE  W-SOK    =   JTW-081(01)  +  JTW-081(02) +          I.971205
005900                           JTW-081(03)  +  JTW-081(04) +          I.971205
005910                           JTW-081(05)  +  JTW-081(06) +          I.971205
005920                           JTW-081(07)  +  JTW-081(08) +          I.971205
005930                           JTW-081(09)  +  JTW-081(10).           I.971205
005940     MOVE   JTW-221    TO  W-SAS.                                 I.971205
005950*****MOVE   SPACE      TO  W-KBN.                                 D.061020
005960*****IF  WN01-06          NOT  =  ZERO                            D.971205
005970*****    IF  WN01-01               =  0                           D.971205
005980*****IF  JTW-151          NOT  =  ZERO                            D.061020
005990*****    IF  JTW-13                =  0                           D.061020
006000*****                MOVE  "*"        TO  W-KBN                   D.061020
006010*****        ELSE    IF  WN01-01           =  5                   D.971205
006020*****        ELSE    IF  JTW-13            =  5                   D.061020
006030*****                           MOVE  "#"         TO  W-KBN       D.061020
006040*****                    ELSE   MOVE  "$"         TO  W-KBN.      D.061020
006050 MAIN-045.                                                        I.940905
006060     ADD  1     TO  LIN.                                          I.940905
006070     ADD  1     TO  G.                                            I.940905
006080*****IF  LIN  =  21                                               D.061020
006090     IF  LIN  =  20                                               I.061020
006100         SUBTRACT  1     FROM  G                                  I.940905
006110         GO  TO  MAIN-OKC.                                        I.940905
006120     PERFORM  WORK1-RTN    THRU  WORK1-EX.                        I.940906
006130     PERFORM  DSP1-RTN     THRU  DSP1-EX.                         I.940906
006140     GO  TO  MAIN-042.                                            I.940905
006150 MAIN-047.                                                        I.940905
006160     IF  LIN  =  2
006170         DISPLAY  INV-D01
006180         GO  TO  MAIN-010.
006190*****IF  LIN  NOT =  20                                           D.061020
006200     IF  LIN  NOT =  19                                           I.061020
006210         ADD  1     TO  LIN                                       * LIN
006220         MOVE  LIN     TO  LIN1
006230         PERFORM  GAMEN-CLR-RTN     THRU  GAMEN-CLR-EX
006240         MOVE  LIN1    TO  LIN.                                   * LIN
006250 MAIN-OKC.
006260     ACCEPT  ACP-OKC.                                             ämîF
006270     DISPLAY DISP-MSG-SPACE1.
006280     IF  ESTAT  =  "09"
006290         PERFORM  SHOSAI-RTN     THRU  SHOSAI-EX
006300     ELSE
006310         GO  TO  MAIN-050.
006320     IF  ESTAT  =  "09"
006330         GO  TO  MAIN-OKC.
006340 MAIN-050.
006350     IF  ESTAT NOT  =  "01" AND "06"
006360         GO  TO  MAIN-OKC.
006370     DISPLAY  ACP-OKC.
006380     IF  OKC  NOT  =  "1" AND "9"
006390         GO  TO  MAIN-OKC.
006400     IF OKC  =  "9"
006410*****    DISPLAY  CAN-01                                          D.950217
006420         PERFORM  CLR1-RTN     THRU  CLR1-EX
006430         GO  TO  MAIN-RTN.
006440*****IF  LIN  =  21                                               D.061020
006450     IF  LIN  =  20                                               I.061020
006460         PERFORM  CLR3-RTN     THRU  CLR3-EX
006470         MOVE  2        TO  LIN                                   * LIN
006480         MOVE  ZERO     TO  G                                     * G
006490         IF  W-DC      =  0                                       I.940906
006500                       GO  TO  NEXT-DSP
006510         ELSE          GO  TO  MAIN-045.                          I.940906
006520*****ELSE                                                         D.940906
006530*****IF  LIN  NOT =  21                                           D.061020
006540     IF  LIN  NOT =  20                                           I.061020
006550         DISPLAY  OK-01
006560         PERFORM  CLR1-RTN     THRU  CLR1-EX
006570         GO  TO  MAIN-RTN.
006580 MAIN-EX.
006590     EXIT.
006600************************************
006610*    ÇvÇnÇqÇjÅ|ÇqÇsÇmÅ@Å@Å@        *
006620************************************
006630 WORK-RTN.
006640*****MOVE  JSRU-08         TO  W-SIZE1(G).                        D.971205
006650*****MOVE  JSRU-04         TO  W-CHO(G).                          D.971205
006660*****MOVE  JSRU-06         TO  W-GNO(G).                          D.971205
006670*****MOVE  JSRU-17         TO  W-UNSO(G).                         D.971205
006680     MOVE   0          TO  W-KBN.                                 I.061020
006690     IF  JNSR-151         NOT  =  ZERO                            I.061020
006700         IF  JNSR-13               =  0                           I.061020
006710                     MOVE  3          TO  W-KBN                   I.061020
006720             ELSE    MOVE  JNSR-13    TO  W-KBN.                  I.061020
006730     MOVE  JNSR-07         TO  W-SIZE1(G).                        I.971205
006740     MOVE  JNSR-11         TO  W-CHO(G).                          I.971205
006750     MOVE  JNSR-151        TO  W-GNO1(G).                         I.971205
006760     MOVE  JNSR-152        TO  W-GNO2(G).                         I.971205
006770     MOVE  JNSR-14         TO  W-UNSO(G).                         I.971205
006780     MOVE  JNSR-23         TO  W-TEK1(G).                         I.061020
006790     MOVE  JNSR-24         TO  W-TEK2(G).                         I.061020
006800     MOVE  JNSR-12         TO  W-OKNO(G).                         I.061020
006810     MOVE  JNSR-06         TO  W-KURA(G).                         I.061020
006820     MOVE  1               TO  I.
006830 WORK-010.
006840     IF  I  >  10
006850         GO  TO  WORK-EX.
006860*****MOVE  JSRU-0911(I)    TO  W-SIZE2(G I).                      D.971205
006870     MOVE  JNSR-081(I)     TO  W-SIZE2(G I).                      I.971205
006880     ADD  1     TO  I.
006890     GO  TO  WORK-010.
006900 WORK-EX.
006910     EXIT.
006920************************************
006930*    ÇcÇrÇoÅ|ÇqÇsÇmÅ@Å@Å@Å@        *
006940************************************
006950 DSP-RTN.
006960     MOVE  SPACE           TO  W-DEN.
006970*****IF  JSRU-10  =  0                                            D.971205
006980     IF  JNSR-10  =  0                                            I.971205
006990         IF  W-KBN    =  3                                        I.061020
007000             MOVE  NC"éÛíç"    TO  W-DEN                          I.061020
007010         ELSE   IF  W-KBN    =  5                                 I.061020
007020                    MOVE  NC"óaÇË"    TO  W-DEN                   I.061020
007030         ELSE   IF  W-KBN    =  6                                 I.061020
007040                    MOVE  NC"éÊÇË"    TO  W-DEN                   I.061020
007050         ELSE   IF  W-KBN    =  0                                 I.061020
007060                    MOVE  NC"èoâ◊"    TO  W-DEN.
007070*****IF  JSRU-10  =  1                                            D.971205
007080     IF  JNSR-10  =  1                                            I.971205
007090         MOVE  NC"ï‘ïi"    TO  W-DEN.
007100*****IF  JSRU-10  =  2                                            D.971205
007110     IF  JNSR-10  =  2                                            I.971205
007120         MOVE  NC"ïsó«"    TO  W-DEN.
007130*****IF  JSRU-10  =  3                                            D.971205
007140     IF  JNSR-10  =  3                                            I.971205
007150         MOVE  NC"í˘ê≥"    TO  W-DEN.
007160*****IF  JSRU-10  =  5                                            D.971205
007170     IF  JNSR-10  =  5                                            I.971205
007180         MOVE  NC"ï‘ëº"    TO  W-DEN.                             I.950218
007190*****IF  JSRU-10  =  7                                            D.971205
007200     IF  JNSR-10  =  7                                            I.971205
007210         MOVE  NC"ÉTèo"    TO  W-DEN.
007220*****MOVE  JSRU-07         TO  SHM-KEY.                           D.971205
007230*****MOVE  JNSR-01         TO  SHM-KEY.                           D.971209
007240*****MOVE  JNSR-01         TO  SHM-01.                            D.010818
007250*****PERFORM  SHM-READ-RTN     THRU  SHM-READ-EX.                 D.010818
007260     MOVE  JNSR-01         TO  HI-MHCD HI-HCD.                    I.010818
007270     PERFORM  HIM-READ-RTN     THRU  HIM-READ-EX.                 I.010818
007280     DISPLAY  DSP-AREA.
007290 DSP-EX.
007300     EXIT.
007310************************************
007320*    ÇvÇnÇqÇjÇPÅ|ÇqÇsÇmÅ@Å@        *
007330************************************
007340 WORK1-RTN.
007350*****MOVE  WN01-08         TO  W-SIZE1(G).                        D.971205
007360*****MOVE  WN01-04         TO  W-CHO(G).                          D.971205
007370*****MOVE  WN01-06         TO  W-GNO(G).                          D.971205
007380*****MOVE  WN01-17         TO  W-UNSO(G).                         D.971205
007390     MOVE   0          TO  W-KBN.                                 I.061020
007400     IF  JTW-151          NOT  =  ZERO                            I.061020
007410         IF  JTW-13                =  0                           I.061020
007420                     MOVE  3          TO  W-KBN                   I.061020
007430             ELSE    MOVE  JTW-13     TO  W-KBN.                  I.061020
007440     MOVE  JTW-07          TO  W-SIZE1(G).                        I.971205
007450     MOVE  JTW-11          TO  W-CHO(G).                          I.971205
007460     MOVE  JTW-151         TO  W-GNO1(G).                         I.971205
007470     MOVE  JTW-152         TO  W-GNO2(G).                         I.971205
007480     MOVE  JTW-14          TO  W-UNSO(G).                         I.971205
007490     MOVE  JTW-23          TO  W-TEK1(G).                         I.061020
007500     MOVE  JTW-24          TO  W-TEK2(G).                         I.061020
007510     MOVE  JTW-12          TO  W-OKNO(G).                         I.061020
007520     MOVE  JTW-06          TO  W-KURA(G).                         I.061020
007530     MOVE  1               TO  I.
007540 WORK1-010.
007550     IF  I  >  10
007560         GO  TO  WORK1-EX.
007570*****MOVE  WN01-0911(I)    TO  W-SIZE2(G I).                      D.971205
007580     MOVE  JTW-081(I)     TO  W-SIZE2(G I).                       I.971205
007590     ADD  1     TO  I.
007600     GO  TO  WORK1-010.
007610 WORK1-EX.
007620     EXIT.
007630************************************
007640*    ÇcÇrÇoÇPÅ|ÇqÇsÇmÅ@Å@Å@        *
007650************************************
007660 DSP1-RTN.
007670     MOVE  SPACE           TO  W-DEN.
007680*****IF  WN01-10  =  0                                            D.971205
007690     IF  JTW-10   =  0                                            I.971205
007700         IF  W-KBN    =  3                                        I.061020
007710             MOVE  NC"éÛíç"    TO  W-DEN                          I.061020
007720         ELSE   IF  W-KBN    =  5                                 I.061020
007730                    MOVE  NC"óaÇË"    TO  W-DEN                   I.061020
007740         ELSE   IF  W-KBN    =  6                                 I.061020
007750                    MOVE  NC"éÊÇË"    TO  W-DEN                   I.061020
007760         ELSE   IF  W-KBN    =  0                                 I.061020
007770                    MOVE  NC"èoâ◊"    TO  W-DEN.
007780*****IF  WN01-10  =  1                                            D.971205
007790     IF  JTW-10   =  1                                            I.971205
007800         MOVE  NC"ï‘ïi"    TO  W-DEN.
007810*****IF  WN01-10  =  2                                            D.971205
007820     IF  JTW-10   =  2                                            I.971205
007830         MOVE  NC"ïsó«"    TO  W-DEN.
007840*****IF  WN01-10  =  3                                            D.971205
007850     IF  JTW-10   =  3                                            I.971205
007860         MOVE  NC"í˘ê≥"    TO  W-DEN.
007870*****IF  WN01-10  =  7                                            D.971205
007880     IF  JTW-10   =  7                                            I.971205
007890         MOVE  NC"ÉTèo"    TO  W-DEN.
007900*****MOVE  WN01-07         TO  SHM-KEY.                           D.971205
007910*****MOVE  JTW-01          TO  SHM-KEY.                           D.971209
007920*****MOVE  JTW-01          TO  SHM-01.                            D.010818
007930*****PERFORM  SHM-READ-RTN     THRU  SHM-READ-EX.                 D.010818
007940     MOVE  JTW-01          TO  HI-MHCD HI-HCD.                    I.010818
007950     PERFORM  HIM-READ-RTN     THRU  HIM-READ-EX.                 I.010818
007960     DISPLAY  DSP-AREA.
007970 DSP1-EX.
007980     EXIT.
007990************************************
008000*    ÇfÇ`ÇlÇdÇmÅ|ÇbÇkÇqÅ|ÇqÇsÇm    *
008010************************************
008020 GAMEN-CLR-RTN.
008030*****IF  LIN  >  20                                               D.061020
008040     IF  LIN  >  19                                               I.061020
008050         GO  TO  GAMEN-CLR-EX.
008060     DISPLAY  GAMEN-CLR.
008070     ADD  1     TO  LIN.
008080     GO  TO  GAMEN-CLR-RTN.
008090 GAMEN-CLR-EX.
008100     EXIT.
008110************************************
008120*    ÇrÇgÇnÇrÇ`ÇhÅ|ÇqÇsÇmÅ@        *
008130************************************
008140 SHOSAI-RTN.
008150     ACCEPT  ACP-GYO.                                             çs 1Å`18
008160     IF  ESTAT  =  "09"
008170         GO  TO  SHOSAI-EX.
008180     IF  ESTAT NOT  =  "01" AND "06"
008190         GO  TO  SHOSAI-RTN.
008200     IF  W-GYO  >  G
008210         GO  TO  SHOSAI-RTN.
008220     IF  W-GYO  =  ZERO
008230         GO  TO  SHOSAI-RTN.
008240     MOVE  W-GYO          TO  GG.
008250     MOVE  W-CHO(GG)      TO  TC-KEY.
008260     PERFORM  TCM-READ-RTN     THRU  TCM-READ-EX.
008270*****PERFORM  JCON-READ-RTN    THRU  JCON-READ-EX.                D.061020
008280     DISPLAY  DSP-SHOSAI1.
008290*
008300     IF  W-SIZE1(GG)  =  1
008310         DISPLAY  DSP-1.
008320     IF  W-SIZE1(GG)  =  2
008330         DISPLAY  DSP-2.
008340     IF  W-SIZE1(GG)  =  3
008350         DISPLAY  DSP-3.
008360     IF  W-SIZE1(GG)  =  4
008370         DISPLAY  DSP-4.
008380*
008390     IF  W-SIZE1(GG)  NOT =  1  AND  2  AND  3  AND  4
008400         DISPLAY  CLR-SHOSAI
008410         GO  TO  SHOSAI-020.
008420*
008430     MOVE  1     TO  I.
008440     MOVE  11    TO  COL.
008450 SHOSAI-010.
008460     IF  I  >  10
008470         GO  TO  SHOSAI-020.
008480     DISPLAY  DSP-SIZE2.
008490     ADD  1     TO  I.
008500     ADD  7     TO  COL.
008510     GO  TO  SHOSAI-010.
008520 SHOSAI-020.
008530     GO  TO  SHOSAI-RTN.
008540 SHOSAI-EX.
008550     EXIT.
008560*********************************************
008570*    ÇbÇkÇqÅ|ÇqÇsÇmÇP                       *
008580*********************************************
008590 CLR1-RTN.
008600     INITIALIZE  W-AREA1.
008610     MOVE  3     TO  LIN.
008620 CLR1-010.
008630*****IF  LIN  >  20                                               D.061020
008640     IF  LIN  >  19                                               I.061020
008650         GO  TO  CLR1-EX.
008660     DISPLAY  CLR-AREA.
008670     ADD   1     TO  LIN.
008680     GO  TO  CLR1-010.
008690 CLR1-EX.
008700     EXIT.
008710*********************************************
008720*    ÇbÇkÇqÅ|ÇqÇsÇmÇR                       *
008730*********************************************
008740 CLR3-RTN.
008750     INITIALIZE  W-SHOSAI  W-DEN.
008760     MOVE  3     TO  LIN.
008770 CLR3-010.
008780*****IF  LIN  >  20                                               D.061020
008790     IF  LIN  >  19                                               I.061020
008800         GO  TO  CLR3-EX.
008810     DISPLAY  CLR-02.
008820     ADD   1     TO  LIN.
008830     GO  TO  CLR3-010.
008840 CLR3-EX.
008850     EXIT.
008860*********************************************
008870*    ÇhÇmÇhÅ|ÇqÇsÇm                         *
008880*********************************************
008890 INI-RTN.
008900     ACCEPT         JS-SIGN.                                      I.081120
008910     IF  JS-SIGN   NOT =  0    AND   1          STOP  RUN.        I.081120
008920     DISPLAY        CLR-1.
008930     CALL  "SJ640R".
008940     CALL  "CBLSTNNO"  USING  STN-NO.                             I.940905
008950     MOVE  STN-NO-02   TO     WORK1-ID-02  WORK2-ID-02.           I.971205
008960     MOVE  WF1-ID      TO     JT-W170K1ID.                        I.971205
008970     MOVE  WF2-ID      TO     JT-W170K3ID.                        I.971205
008980     OPEN  INPUT  JNSR  HI2-M  TC-M  JT-W170  JCON.               I.010818
008990*****OPEN  INPUT  JNSR  SHM  TC-M  JT-W170  JCON.                 D.010818
009000     COPY  LIBCPR.                                                I.980526
009010*****MOVE  STN-NO-02   TO     WORK-ID-02.                         D.971205
009020*****MOVE  WF-ID       TO     JT-IWS102ID.                        D.971205
009030*****OPEN  INPUT  JSRU  SHM  TC-M.                                D.940905
009040*****OPEN  INPUT  JSRU  SHM  TC-M  JT-WKN1.                       D.950217
009050*****OPEN  INPUT  JSRU  SHM  TC-M  JT-WKN1  JCON.                 D.971205
009060 INI-EX.
009070     EXIT.
009080*********************************************
009090*    ÇdÇmÇcÅ|ÇqÇsÇm                         *
009100*********************************************
009110 END-RTN.
009120*****CLOSE  JSRU  SHM  TC-M.                                      D.940905
009130*****CLOSE  JSRU  SHM  TC-M  JT-WKN1.                             D.950217
009140*****CLOSE  JSRU  SHM  TC-M  JT-WKN1  JCON.                       D.971205
009150*****CLOSE  JNSR  SHM  TC-M  JT-W170  JCON.                       D.010818
009160     CLOSE  JNSR  HI2-M TC-M  JT-W170  JCON.                      I.010818
009170     DISPLAY CLR-1.
009180 END-EX.
009190     EXIT.
009200************************************
009210*    íºëóêÊÉ}ÉXÉ^Å@ÇqÇdÇ`Çc        *
009220************************************
009230 TCM-READ-RTN.
009240     MOVE  "OFF"     TO  SW.
009250***  íºëóêÊÉ}ÉXÉ^Å@ÇqÇdÇ`Çc
009260     READ  TC-M  UNLOCK  INVALID
009270         MOVE  " ON"     TO  SW
009280         MOVE  SPACE     TO   TC-NAME.
009290 TCM-READ-EX.
009300     EXIT.
009310************************************
009320*    ïiñºÉ}ÉXÉ^Å@ÇqÇdÇ`Çc      *
009330************************************
009340*SHM-READ-RTN.                                                    D.010818
009350 HIM-READ-RTN.                                                    I.010818
009360     MOVE  "OFF"     TO  SW.
009370*****READ  SHM  UNLOCK  INVALID                                   D.010818
009380     READ  HI2-M  UNLOCK  INVALID                                 I.010818
009390         MOVE  " ON"     TO  SW
009400         MOVE  SPACE     TO   HI-NAME.                            I.010818
009410*****    MOVE  SPACE     TO   SHM-02.                             D.010818
009420*SHM-READ-EX.                                                     D.010818
009430 HIM-READ-EX.                                                     I.010818
009440     EXIT.
009450************************************
009460*    ÉRÉìÉgÉçÅ[ÉãÇeÅ@ÇqÇdÇ`Çc      *
009470************************************
009480*JCON-READ-RTN.                                                   D.061020
009490*****MOVE  2         TO  JCON2-01.                                D.061020
009500*****MOVE  W-UNSO(GG) TO  JCON2-02.                               D.061020
009510*****READ  JCON UNLOCK  INVALID                                   D.061020
009520*****    MOVE  " ON"     TO  SW                                   D.061020
009530*****    MOVE  SPACE     TO   JCON2-03.                           D.061020
009540*JCON-READ-EX.                                                    D.061020
009550*****EXIT.                                                        D.061020
009560*
009570 COPY LPMSG.
009580*
