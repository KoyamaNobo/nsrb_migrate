000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JHS60I.
000030*************************************************************
000040*    PROGRAM         :  ìùàÍì`ï[ì¸óÕÅiê‘ÇøÇ·ÇÒñ{ï‹ÇeÇ`Çwï™Åj*
000050*    PRINTER TYPE    :  JIPS                                *
000060*    SCREEN          :  SJH60I                              *
000070*    COMPILE TYPE    :  COBOL                               *
000080*************************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT TDNAF ASSIGN TO TDNA-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE DYNAMIC
000180         RECORD KEY TDNA-KEY
000190         FILE STATUS IS ERR-STAT.
000200     SELECT AHNHF ASSIGN TO AHNH-MSD
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY AHNH-KEY
000240         FILE STATUS IS ERR-STAT.
000250     SELECT CODEF ASSIGN TO CODE-RDB
000260         FILE STATUS IS ERR-STAT.
000270     SELECT JCON ASSIGN TO JCON-MSD
000280         ORGANIZATION INDEXED
000290         ACCESS MODE RANDOM
000300         RECORD KEY JCON1-KEY
000310         FILE STATUS IS ERR-STAT.
000320     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD
000330         ORGANIZATION INDEXED
000340         ACCESS MODE DYNAMIC
000350         RECORD KEY THT-KEY
000360         ALTERNATE RECORD KEY THT-KEY2
000370         FILE STATUS IS ERR-STAT.
000380     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000390         ORGANIZATION INDEXED
000400         ACCESS MODE RANDOM
000410         RECORD KEY HI-KEY
000420         ALTERNATE RECORD KEY HI-KEY2
000430         FILE STATUS IS ERR-STAT.
000440 I-O-CONTROL.
000450     APPLY SHARED-MODE ON TDNAF
000460     APPLY SHARED-MODE ON AHNHF
000470     APPLY SHARED-MODE ON CODEF
000480     APPLY SHARED-MODE ON JCON
000490     APPLY SHARED-MODE ON THTM
000500     APPLY SHARED-MODE ON HI-M.
000510 DATA DIVISION.
000520 FILE SECTION.
000530     COPY LITDNA.
000540     COPY LIAHNH.
000550     COPY LRCODE.
000560     COPY L-JCON.
000570     COPY LIDTHT.
000580     COPY LIHIM.
000590 WORKING-STORAGE  SECTION.
000600 77  ERR-STAT           PIC  X(002).
000610 77  W-FILE             PIC  X(013).
000620 77  W-END              PIC  9(001) VALUE 0.
000630 01  W-CRT.
000640     02  W-HNO          PIC  9(009).
000650     02  W-HNGP         PIC  9(006).
000660     02  W-HNGPD REDEFINES W-HNGP.
000670       03  W-HNEN       PIC  9(002).
000680       03  W-HGET       PIC  9(002).
000690       03  W-HPEY       PIC  9(002).
000700     02  W-NNGP         PIC  9(006).
000710     02  W-NNGPD REDEFINES W-NNGP.
000720       03  W-NNEN       PIC  9(002).
000730       03  W-NGET       PIC  9(002).
000740       03  W-NPEY       PIC  9(002).
000750     02  W-BI           PIC  X(010).
000760     02  W-SNGP         PIC  9(008).
000770     02  W-SNGPL REDEFINES W-SNGP.
000780       03  F            PIC  9(002).
000790       03  W-SNGPS      PIC  9(006).
000800*****02  W-SNGPD REDEFINES W-SNGP.
000810*****  03  W-NENL       PIC  9(004).
000820*****  03  W-NEND  REDEFINES W-NENL.
000830*****    04  W-NEN1     PIC  9(002).
000840*****    04  W-NEN2     PIC  9(002).
000850*****  03  W-GET        PIC  9(002).
000860*****  03  W-PEY        PIC  9(002).
000870     02  W-HNA          PIC  X(006).
000880     02  W-ZON          PIC  X(004).
000890     02  W-DNGP         PIC  9(008).
000900     02  W-DNGPL REDEFINES W-DNGP.
000910       03  W-DNEN1      PIC  9(002).
000920       03  W-DNGPS      PIC  9(006).
000930     02  W-MEI.
000940       03  W-MEID  OCCURS   9.
000950         04  W-HCD      PIC  9(006).
000960         04  W-S        PIC  9(003).
000970         04  W-JAN      PIC  X(013).
000980         04  W-SU       PIC  9(005).
000990         04  W-GTN      PIC  9(007).
001000         04  W-UTN      PIC  9(007).
001010         04  W-GKIN     PIC  9(009).
001020         04  W-UKIN     PIC  9(009).
001030*****    04  W-DPC.                                               D.090826
001040*****      05  W-DPM    PIC  X(002).                              D.090826
001050*****      05  W-CLS    PIC  X(003).                              D.090826
001060         04  W-SHM      PIC  X(013).
001070         04  W-MSB      PIC  X(010).
001080         04  W-COR      PIC  N(004).                              I.090826
001090         04  W-SZM      PIC  X(004).                              I.090826
001100         04  W-SIZM     PIC  N(004).
001110 01  W-DATA.
001120     02  W-ACT          PIC  9(001).
001130     02  W-STC          PIC  9(007).
001140*****02  W-DNO          PIC  9(006).                              D.100901
001150     02  W-DNO          PIC  9(007).                              I.100901
001160     02  W-NRC          PIC  9(001).
001170     02  W-DMM          PIC  9(001).
001180     02  W-SDATE        PIC  9(006).
001190     02  W-EDATE        PIC  9(006).
001200     02  W-NGP.
001210       03  W-NENL       PIC  9(004).
001220       03  W-NEND  REDEFINES W-NENL.
001230         04  W-NEN1     PIC  9(002).
001240         04  W-NEN2     PIC  9(002).
001250       03  W-GET        PIC  9(002).
001260       03  W-PEY        PIC  9(002).
001270     02  W-NGPL  REDEFINES W-NGP.
001280       03  F            PIC  9(002).
001290       03  W-NGPS       PIC  9(006).
001300     02  WT-D.
001310       03  WT-SU        PIC  9(006).
001320       03  WT-GKIN      PIC  9(009).
001330       03  WT-UKIN      PIC  9(009).
001340     02  W-L1           PIC  9(002).
001350     02  W-L2           PIC  9(002).
001360     02  CNT            PIC  9(002).
001370     02  W-SC           PIC  9(001).
001380     02  W-SNO          PIC  9(002).
001390     02  W-ASIZD.
001400       03  W-ASIZ  OCCURS   4.
001410         04  W-SIZD  OCCURS  10.
001420           05  W-SIZ    PIC  X(004).
001430     02  W-DSZ          PIC  X(004).
001440     02  W-DSZD  REDEFINES W-DSZ.
001450       03  F            PIC  X(003).
001460       03  W-DSZH       PIC  X(001).
001470     02  W-MSIZ.
001480*      03  F            PIC  X(040) VALUE
001490*           "----      SS   S   M   L  LL  XL XXL    ".
001500       03  F            PIC  X(040) VALUE
001510            "                            28.029.030.0".
001520       03  F            PIC  X(040) VALUE
001530            "12.513.013.514.015.016.017.018.019.020.0".
001540       03  F            PIC  X(040) VALUE
001550            "21.021.522.022.523.023.524.024.525.0    ".
001560       03  F            PIC  X(040) VALUE
001570            "24.024.525.025.526.026.527.027.5        ".
001580     02  W-ASZD.
001590       03  W-ASZ   OCCURS   4.
001600         04  W-SZD   OCCURS  10.
001610           05  W-SZ     PIC  X(003).
001620     02  W-MSZ.
001630       03  F            PIC  X(030) VALUE
001640            "                     280290300".
001650       03  F            PIC  X(030) VALUE
001660            "125130135140150160170180190200".
001670       03  F            PIC  X(030) VALUE
001680            "210215220225230235240245250   ".
001690       03  F            PIC  X(030) VALUE
001700            "240245250255260265270275      ".
001710     02  W-AHN          PIC  N(024).                              I.090826
001720     02  W-AHND  REDEFINES W-AHN.                                 I.090826
001730       03  W-HND   OCCURS  24.                                    I.090826
001740         04  W-HN       PIC  N(001).                              I.090826
001750     02  W-CORD         PIC  N(004).                              I.090826
001760     02  W-ANAD  REDEFINES W-CORD.                                I.090826
001770       03  W-NAD  OCCURS   4.                                     I.090826
001780         04  W-NA       PIC  N(001).                              I.090826
001790     02  W-C1           PIC  9(002).                              I.090826
001800     02  W-C2           PIC  9(002).                              I.090826
001810     COPY LSTAT.
001820 SCREEN SECTION.
001830 SD  C-CRT
001840     END STATUS IS ESTAT.
001850 01  C-CLEAR.
001860     02  C-CL    LINE   1  CLEAR SCREEN.
001870 01  C-ACP.
001880     02  LINE   1.
001890       03  A-ACT   COLUMN  47  PIC  9(001)
001900            USING W-ACT       CHECK OVERFLOW NO IFC.
001910*****  03  A-DNO   COLUMN  58  PIC  9(006)                        D.100901
001920       03  A-DNO   COLUMN  57  PIC  9(007)                        I.100901
001930            USING W-DNO       CHECK OVERFLOW NO IFC.
001940       03  A-HNO   COLUMN  72  PIC  9(009)
001950            USING W-HNO       CHECK OVERFLOW NO IFC.
001960     02  LINE   2.
001970       03  A-STC   COLUMN  10  PIC  9(007)
001980            USING W-STC       CHECK OVERFLOW NO IFC.
001990       03  A-HNGP  COLUMN  61  PIC  9(006)
002000            USING W-HNGP      CHECK OVERFLOW NO IFC.
002010       03  A-NNGP  COLUMN  75  PIC  9(006)
002020            USING W-NNGP      CHECK OVERFLOW NO IFC.
002030     02  LINE W-L1.
002040       03  A-HCD   COLUMN   1  PIC  9(006)
002050            USING W-HCD(CNT)  CHECK OVERFLOW NO IFC.
002060       03  A-S     COLUMN  57  PIC  9(003)
002070            USING W-S(CNT)    CHECK OVERFLOW NO IFC.
002080*****  03  A-DPC   COLUMN  71  PIC  X(005)                        D.090826
002090*****       USING W-DPC(CNT)  CHECK OVERFLOW NO IFC.              D.090826
002100     02  LINE W-L2.
002110       03  A-SU    COLUMN  27  PIC  9(005)
002120            USING W-SU(CNT)   CHECK OVERFLOW NO IFC.
002130       03  A-MSB   COLUMN  71  PIC  X(010)
002140            USING W-MSB(CNT)  CHECK OVERFLOW NO IFC.
002150     02  LINE  22.
002160       03  A-BI    COLUMN   1  PIC  X(010)
002170            USING W-BI        CHECK OVERFLOW NO IFC.
002180       03  A-SNGP  COLUMN  13  PIC  9(006)
002190            USING W-SNGPS     CHECK OVERFLOW NO IFC.
002200     02  LINE  23.
002210       03  A-HNA   COLUMN   8  PIC  X(006)
002220            USING W-HNA       CHECK OVERFLOW NO IFC.
002230       03  A-ZON   COLUMN  20  PIC  X(004)
002240            USING W-ZON       CHECK OVERFLOW NO IFC.
002250       03  A-DNGP  COLUMN  32  PIC  9(006)
002260            USING W-DNGPS     CHECK OVERFLOW NO IFC.
002270     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
002280          USING W-DMM         CHECK OVERFLOW NO IFC.
002290 01  C-DSP.
002300*****02  D-DNOC  LINE   1  COLUMN  58  PIC  X(006) VALUE "      ".D.100901
002310     02  D-DNOC  LINE   1  COLUMN  57  PIC  X(007) VALUE          I.100901
002320          "       ".                                              I.100901
002330     02  D-NHSN  LINE   2  COLUMN  18  PIC  N(016) FROM AHNH-NHSN.
002340     02  LINE W-L1.
002350       03  D-HNA   COLUMN   8  PIC  N(024)    FROM  HI-NAME.
002360       03  D-SIZM  COLUMN  61  PIC  N(004)    FROM  W-SIZM(CNT).
002370     02  LINE W-L2.
002380       03  D-SU    COLUMN  27  PIC ZZZZ9      FROM  W-SU(CNT).
002390       03  D-GTN   COLUMN  32  PIC ZZZZ,ZZ9   FROM  W-GTN(CNT).
002400       03  D-GKIN  COLUMN  41  PIC ZZ,ZZZ,ZZ9 FROM  W-GKIN(CNT).
002410       03  D-UTN   COLUMN  51  PIC ZZZZ,ZZ9   FROM  W-UTN(CNT).
002420       03  D-UKIN  COLUMN  60  PIC ZZ,ZZZ,ZZ9 FROM  W-UKIN(CNT).
002430     02  D-TOT   LINE  22.
002440       03  COLUMN  26  PIC ZZ,ZZ9     FROM  WT-SU.
002450       03  COLUMN  41  PIC ZZ,ZZZ,ZZ9 FROM  WT-GKIN.
002460       03  COLUMN  60  PIC ZZ,ZZZ,ZZ9 FROM  WT-UKIN.
002470 01  C-SPC.
002480     02  LINE W-L1.
002490       03  COLUMN   1  PIC  X(050) VALUE
002500            "                                                  ".
002510       03  COLUMN  51  PIC  X(005) VALUE "     ".
002520       03  COLUMN  57  PIC  X(003) VALUE "   ".
002530       03  COLUMN  61  PIC  X(020) VALUE "                    ".
002540     02  LINE W-L2.
002550       03  COLUMN  27  PIC  X(050) VALUE
002560            "                                                  ".
002570       03  COLUMN  77  PIC  X(004) VALUE "    ".
002580 01  C-ERR.
002590     02  LINE  24.
002600       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002610            "***  DATA ≈º  ***".
002620       03  E-ME2   COLUMN  15  PIC  X(015) VALUE
002630            "***  –ƒ≥€∏  ***".
002640       03  E-ME3   COLUMN  15  PIC  X(017) VALUE
002650            "***  º¨√› ≈º  ***".
002660       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
002670            "***  À›“≤ ≈º  ***".
002680       03  E-ME5   COLUMN  15  PIC  X(017) VALUE
002690            "***  ª≤Ωﬁ ≈º  ***".
002700       03  E-ME6   COLUMN  15  PIC  X(019) VALUE
002710            "***  JAN –ƒ≥ƒ∏  ***".
002720       03  E-ME7   COLUMN  15  PIC  X(034) VALUE
002730            "***  ºﬁ≠º›√ﬁ∞¿ º≠≥æ≤•ª∏ºﬁÆ Ã∂  ***".
002740       03  E-ME8   COLUMN  15  PIC  X(021) VALUE
002750            "***  PROGRAM ¥◊∞  ***".
002760       03  E-ME9   COLUMN  15  PIC  X(018) VALUE
002770            "***  DATA ¥◊∞  ***".
002780       03  E-ME10  COLUMN  15  PIC  X(017) VALUE
002790            "***  JAN ¥◊∞  ***".
002800       03  E-ME11  COLUMN  15  PIC  X(016) VALUE
002810            "***  ¿›∂ ≈º  ***".
002820       03  E-ME12  COLUMN  15  PIC  X(021) VALUE
002830            "***  JAN ∂≈“≤ ≈º  ***".
002840       03  E-ME13  COLUMN  15  PIC  X(024) VALUE
002850            "***  ì`ï[î≠çsÅ@çœÇ›  ***".
002860       03  E-ME20  COLUMN  15  PIC  X(025) VALUE
002870            "***  TDNAF WRITE ¥◊∞  ***".
002880       03  E-ME21  COLUMN  15  PIC  X(027) VALUE
002890            "***  TDNAF REWRITE ¥◊∞  ***".
002900       03  E-ME22  COLUMN  15  PIC  X(026) VALUE
002910            "***  TDNAF DELETE ¥◊∞  ***".
002920       03  E-ME24  COLUMN  15  PIC  X(017) VALUE
002930            "***  JCON ≈º  ***".
002940       03  E-ME25  COLUMN  15  PIC  X(026) VALUE
002950            "***  JCON REWRITE ¥◊∞  ***".
002960*****  03  E-TDNA  COLUMN  43  PIC  X(015) FROM  TDNA-KEY.        D.100901
002970       03  E-TDNA  COLUMN  43  PIC  X(016) FROM  TDNA-KEY.        I.100901
002980     COPY LSSEM.
002990 PROCEDURE DIVISION.
003000 M-05.
003010     DISPLAY C-CLEAR.
003020     CALL "SJH60I".
003030     OPEN INPUT AHNHF.
003040     OPEN INPUT CODEF.
003050     OPEN INPUT HI-M.
003060     OPEN INPUT THTM.
003070     OPEN I-O TDNAF.
003080     OPEN I-O JCON.
003090     MOVE W-MSIZ TO W-ASIZD.
003100     MOVE W-MSZ TO W-ASZD.
003110     MOVE ZERO TO W-STC.
003120     ACCEPT W-NGPS FROM DATE.
003130     SUBTRACT 1 FROM W-GET.
003140     IF W-GET = ZERO
003150         SUBTRACT 1 FROM W-NEN2
003160         MOVE 12 TO W-GET.
003170     MOVE W-NGPS TO W-SDATE.
003180     ACCEPT W-NGPS FROM DATE.
003190     ADD 1 TO W-GET.
003200     IF W-GET = 13
003210         ADD 1 TO W-NEN2
003220         MOVE 1 TO W-GET.
003230     MOVE W-NGPS TO W-EDATE.
003240 M-10.
003250     ACCEPT A-ACT.
003260     DISPLAY E-CL.
003270     IF ESTAT = PF9
003280         GO TO M-90.
003290     IF ESTAT NOT = HTB AND SKP
003300         GO TO M-10.
003310     IF W-ACT = 9
003320         GO TO M-90.
003330     IF W-ACT < 1 OR > 3
003340         GO TO M-10.
003350 M-15.
003360     DISPLAY C-CLEAR.
003370     CALL "SJH60I".
003380     DISPLAY A-ACT.
003390     IF W-STC NOT = ZERO
003400         DISPLAY A-STC D-NHSN.
003410 M-20.
003420     ACCEPT A-STC.
003430     DISPLAY E-CL.
003440     IF ESTAT = PF9
003450         GO TO M-90.
003460     IF ESTAT = BTB
003470         GO TO M-10.
003480     IF ESTAT NOT = HTB AND SKP
003490         GO TO M-20.
003500     MOVE W-STC TO AHNH-KEY.
003510     READ AHNHF WITH UNLOCK INVALID KEY
003520         DISPLAY E-ME3 E-ME98
003530         GO TO M-20.
003540     DISPLAY D-NHSN.
003550     IF W-ACT = 1
003560         DISPLAY D-DNOC
003570         GO TO M-30.
003580 M-25.
003590     ACCEPT A-DNO.
003600     DISPLAY E-CL.
003610     IF ESTAT = BTB
003620         GO TO M-20.
003630     IF ESTAT NOT = HTB AND SKP
003640         GO TO M-25.
003650     MOVE SPACE TO TDNA-KEY.
003660     MOVE W-STC TO TDNA-STC.
003670     MOVE W-DNO TO TDNA-DNO.
003680     START TDNAF KEY NOT < TDNA-KEY INVALID KEY
003690         DISPLAY E-ME2 E-ME98
003700         GO TO M-25.
003710     READ TDNAF NEXT RECORD WITH UNLOCK AT END
003720         DISPLAY E-ME2 E-ME98
003730         GO TO M-25.
003740     IF (W-STC NOT = TDNA-STC) OR (W-DNO NOT = TDNA-DNO)
003750         DISPLAY E-ME2 E-ME98
003760         GO TO M-25.
003770     IF TDNA-PC = 9
003780         DISPLAY E-ME13 E-ME99.
003790     PERFORM DSP-RTN THRU DSP-EX.
003800     IF W-NRC = 0
003810         DISPLAY E-ME7 E-ME98
003820         GO TO M-25.
003830 M-30.
003840     PERFORM ACP-RTN THRU ACP-EX.
003850     IF COMPLETION-CODE = 255
003860         GO TO M-90.
003870     IF ESTAT = PF9
003880         GO TO M-90.
003890     IF ESTAT = BTB
003900         IF W-ACT = 1
003910             GO TO M-20
003920           ELSE
003930             GO TO M-25.
003940     IF W-DMM = 9
003950         IF W-ACT = 3
003960             GO TO M-25.
003970     PERFORM UPD-RTN THRU UPD-EX.
003980     IF COMPLETION-CODE = 255
003990         GO TO M-90.
004000     GO TO M-15.
004010 M-90.
004020     CLOSE AHNHF.
004030     CLOSE CODEF.
004040     CLOSE HI-M.
004050     CLOSE THTM.
004060     CLOSE TDNAF.
004070     CLOSE JCON.
004080 M-95.
004090     DISPLAY C-CLEAR.
004100     STOP RUN.
004110 DSP-RTN.
004120     MOVE ZERO TO W-CRT W-NRC.
004130     MOVE SPACE TO W-BI W-HNA W-ZON
004140                   W-JAN(1) W-JAN(2) W-JAN(3) W-JAN(4) W-JAN(5)
004150                   W-JAN(6) W-JAN(7) W-JAN(8) W-JAN(9)
004160*****              W-DPC(1) W-DPC(2) W-DPC(3) W-DPC(4) W-DPC(5)   D.090826
004170*****              W-DPC(6) W-DPC(7) W-DPC(8) W-DPC(9)            D.090826
004180                   W-SHM(1) W-SHM(2) W-SHM(3) W-SHM(4) W-SHM(5)
004190                   W-SHM(6) W-SHM(7) W-SHM(8) W-SHM(9)
004200                   W-MSB(1) W-MSB(2) W-MSB(3) W-MSB(4) W-MSB(5)
004210                   W-MSB(6) W-MSB(7) W-MSB(8) W-MSB(9)
004220                   W-SZM(1) W-SZM(2) W-SZM(3) W-SZM(4) W-SZM(5)   I.090826
004230                   W-SZM(6) W-SZM(7) W-SZM(8) W-SZM(9)            I.090826
004240                W-SIZM(1) W-SIZM(2) W-SIZM(3) W-SIZM(4) W-SIZM(5)
004250                W-SIZM(6) W-SIZM(7) W-SIZM(8) W-SIZM(9).
004260     MOVE TDNA-NRC TO W-NRC.
004270     MOVE TDNA-HNO TO W-HNO.
004280     MOVE TDNA-HNGP TO W-HNGP.
004290     MOVE TDNA-NNGP TO W-NNGP.
004300     MOVE TDNA-BI TO W-BI.
004310     MOVE TDNA-SNGP TO W-SNGP.
004320     MOVE TDNA-HNA TO W-HNA.
004330     MOVE TDNA-ZON TO W-ZON.
004340     MOVE TDNA-DNGP TO W-DNGP.
004350*
004360     MOVE ZERO TO CNT WT-D.
004370 DSP-010.
004380     ADD 1 TO CNT.
004390     IF CNT > 9
004400         MOVE 9 TO W-END
004410         DISPLAY E-ME9 E-ME99
004420         GO TO DSP-EX.
004430     MOVE TDNA-JAN TO W-JAN(CNT).
004440     MOVE TDNA-SU TO W-SU(CNT).
004450     MOVE TDNA-GTN TO W-GTN(CNT).
004460     MOVE TDNA-GKIN TO W-GKIN(CNT).
004470     MOVE TDNA-UTN TO W-UTN(CNT).
004480     MOVE TDNA-UKIN TO W-UKIN(CNT).
004490*****MOVE TDNA-DPM TO W-DPM(CNT).                                 D.090826
004500*****MOVE TDNA-CLS TO W-CLS(CNT).                                 D.090826
004510     MOVE TDNA-SHM TO W-SHM(CNT).
004520     MOVE TDNA-MSB TO W-MSB(CNT).
004530*
004540     ADD TDNA-SU TO WT-SU.
004550     ADD TDNA-GKIN TO WT-GKIN.
004560     ADD TDNA-UKIN TO WT-UKIN.
004570*
004580     CLOSE CODEF.
004590     OPEN INPUT CODEF.
004600     SELECT CODEF WHERE 0000 = CODE-TCD AND TDNA-JAN = CODE-JAN.
004610     READ CODEF AT END SCRATCH CODEF
004620         MOVE ZERO TO W-HCD(CNT)
004630         MOVE SPACE TO W-SIZM(CNT) W-SZM(CNT)                     I.090826
004640*****    MOVE SPACE TO W-SIZM(CNT)                                D.090826
004650         GO TO DSP-020.
004660     IF (CODE-SIZ < 1 OR > 4) OR (CODE-SNO < 1 OR > 10)
004670         MOVE ZERO TO W-HCD(CNT)
004680         MOVE SPACE TO W-SIZM(CNT) W-SZM(CNT)                     I.090826
004690*****    MOVE SPACE TO W-SIZM(CNT)                                D.090826
004700         GO TO DSP-020.
004710     MOVE W-SIZ(CODE-SIZ,CODE-SNO) TO W-DSZ.
004720     IF HI-HKB = 1
004730         MOVE 5 TO W-DSZH.
004740     MOVE W-SZ(CODE-SIZ,CODE-SNO) TO W-S(CNT).
004750*****MOVE W-DSZ TO W-SIZM(CNT).                                   D.090826
004760     MOVE W-DSZ TO W-SIZM(CNT) W-SZM(CNT).                        I.090826
004770     MOVE CODE-HCD TO W-HCD(CNT).
004780 DSP-020.
004790     READ TDNAF NEXT RECORD WITH UNLOCK AT END
004800         GO TO DSP-030.
004810     IF (W-STC NOT = TDNA-STC) OR (W-DNO NOT = TDNA-DNO)
004820         GO TO DSP-030.
004830     GO TO DSP-010.
004840 DSP-030.
004850     DISPLAY D-NHSN A-HNO A-HNGP A-NNGP A-BI A-SNGP A-HNA A-ZON
004860             A-DNGP D-TOT.
004870*
004880     MOVE ZERO TO CNT.
004890     MOVE 2 TO W-L1.
004900 DSP-040.
004910     ADD 1 TO CNT.
004920     IF CNT > 9
004930         GO TO DSP-EX.
004940     ADD 2 TO W-L1.
004950     COMPUTE W-L2 = W-L1 + 1.
004960     IF W-L1 > 20
004970         MOVE 1 TO W-END
004980         DISPLAY E-ME8 E-ME99
004990         GO TO DSP-EX.
005000*
005010     IF W-SU(CNT) = ZERO
005020         DISPLAY C-SPC
005030         GO TO DSP-040.
005040     MOVE W-HCD(CNT) TO HI-KEY.
005050     READ HI-M WITH UNLOCK INVALID KEY
005060         MOVE SPACE TO HI-NAME
005070         MOVE NC"Å@ïiñºÇ»ÇµÅ@" TO HI-NAME.
005080*
005090*****DISPLAY A-HCD D-HNA A-S D-SIZM A-DPC                         D.090826
005100     DISPLAY A-HCD D-HNA A-S D-SIZM                               I.090826
005110             D-SU D-GTN D-GKIN D-UTN D-UKIN A-MSB.
005120     GO TO DSP-040.
005130 DSP-EX.
005140     EXIT.
005150 ACP-RTN.
005160     IF W-ACT = 3
005170         GO TO ACP-280.
005180 ACP-005.
005190     ACCEPT A-HNO.
005200     DISPLAY E-CL.
005210     IF ESTAT = BTB
005220         GO TO ACP-EX.
005230     IF ESTAT NOT = HTB AND SKP
005240         GO TO ACP-005.
005250 ACP-010.
005260     ACCEPT A-HNGP.
005270     DISPLAY E-CL.
005280     IF ESTAT = BTB
005290         GO TO ACP-005.
005300     IF ESTAT NOT = HTB AND SKP
005310         GO TO ACP-010.
005320     IF W-HNGP = ZERO
005330         GO TO ACP-020.
005340     IF W-HNEN < 09
005350         GO TO ACP-010.
005360     IF W-HGET < 01 OR > 12
005370         GO TO ACP-010.
005380     IF W-HPEY < 01 OR > 31
005390         GO TO ACP-010.
005400 ACP-020.
005410     ACCEPT A-NNGP.
005420     DISPLAY E-CL.
005430     IF ESTAT = BTB
005440         GO TO ACP-010.
005450     IF ESTAT NOT = HTB AND SKP
005460         GO TO ACP-020.
005470     IF W-NNGP = ZERO
005480         GO TO ACP-030.
005490     IF W-NNEN < 09
005500         GO TO ACP-020.
005510     IF W-NGET < 01 OR > 12
005520         GO TO ACP-020.
005530     IF W-NPEY < 01 OR > 31
005540         GO TO ACP-020.
005550     IF W-HNGP > W-NNGP
005560         GO TO ACP-020.
005570 ACP-030.
005580     MOVE ZERO TO CNT.
005590     MOVE 2 TO W-L1.
005600 ACP-040.
005610     ADD 1 TO CNT.
005620     ADD 2 TO W-L1.
005630     COMPUTE W-L2 = W-L1 + 1.
005640     IF CNT > 9
005650         GO TO ACP-150.
005660     IF W-L1 > 20
005670         DISPLAY E-ME8 E-ME99
005680         MOVE 255 TO COMPLETION-CODE
005690         GO TO ACP-EX.
005700 ACP-050.
005710     ACCEPT A-HCD.
005720     DISPLAY E-CL.
005730     IF ESTAT = ADV
005740         GO TO ACP-130.
005750     IF ESTAT = BTB
005760         GO TO ACP-120.
005770     IF ESTAT NOT = HTB AND SKP
005780         GO TO ACP-050.
005790     MOVE W-HCD(CNT) TO HI-KEY.
005800     READ HI-M WITH UNLOCK INVALID KEY
005810         DISPLAY E-ME4 E-ME98
005820         GO TO ACP-050.
005830     DISPLAY D-HNA.
005840     PERFORM COR-RTN THRU COR-EX.                                 I.090826
005850     MOVE W-CORD TO W-COR(CNT).                                   I.090826
005860 ACP-060.
005870     ACCEPT A-S.
005880     DISPLAY E-CL.
005890     IF ESTAT = BTB
005900         GO TO ACP-050.
005910     IF ESTAT NOT = HTB AND SKP
005920         GO TO ACP-060.
005930     PERFORM SIZ-RTN THRU SIZ-EX.
005940     IF W-SC = 5
005950         DISPLAY E-ME5 E-ME98
005960         GO TO ACP-060.
005970     DISPLAY D-SIZM.
005980     IF HI-S(W-SC,W-SNO) = 0
005990         DISPLAY E-ME5 E-ME98
006000         GO TO ACP-060.
006010*
006020     CLOSE CODEF.
006030     OPEN INPUT CODEF.
006040     SELECT CODEF WHERE 0000 = CODE-TCD AND W-HCD(CNT) = CODE-HCD
006050                         AND W-SC = CODE-SIZ AND W-SNO = CODE-SNO.
006060     READ CODEF AT END SCRATCH CODEF
006070         MOVE SPACE TO CODE-JAN CODE-NAME.
006080     IF CODE-JAN = SPACE
006090         DISPLAY E-ME6 E-ME98
006100         GO TO ACP-060.
006110     IF CODE-NAME = SPACE
006120         DISPLAY E-ME12 E-ME98
006130         GO TO ACP-060.
006140     MOVE CODE-JAN TO W-JAN(CNT).
006150     MOVE CODE-NAME TO W-SHM(CNT).
006160*
006170     MOVE 0077 TO THT-TCD.
006180     MOVE W-HCD(CNT) TO THT-HCD.
006190     MOVE W-SC TO THT-SIZ.
006200     READ THTM WITH UNLOCK INVALID KEY
006210         GO TO ACP-070.
006220     MOVE THT-T TO W-GTN(CNT).
006230     MOVE THT-TT TO W-UTN(CNT).
006240     GO TO ACP-080.
006250 ACP-070.
006260     MOVE 0077 TO THT-TCD.
006270     MOVE W-HCD(CNT) TO THT-HCD.
006280     MOVE 9 TO THT-SIZ.
006290     READ THTM WITH UNLOCK INVALID KEY
006300         DISPLAY E-ME11 E-ME98
006310         GO TO ACP-060.
006320     MOVE THT-T TO W-GTN(CNT).
006330     MOVE THT-TT TO W-UTN(CNT).
006340 ACP-080.
006350     ACCEPT A-SU.
006360     IF ESTAT = BTB
006370         GO TO ACP-060.
006380     IF ESTAT NOT = HTB AND SKP
006390         GO TO ACP-080.
006400     DISPLAY D-SU.
006410     IF W-SU(CNT) = ZERO
006420         GO TO ACP-080.
006430     COMPUTE W-GKIN(CNT) = W-SU(CNT) * W-GTN(CNT).
006440     COMPUTE W-UKIN(CNT) = W-SU(CNT) * W-UTN(CNT).
006450     DISPLAY D-GTN D-GKIN D-UTN D-UKIN.
006460*ACP-090.                                                         D.090826
006470*****ACCEPT A-DPC.                                                D.090826
006480*****IF ESTAT = BTB                                               D.090826
006490*****    GO TO ACP-080.                                           D.090826
006500*****IF ESTAT NOT = HTB AND SKP                                   D.090826
006510*****    GO TO ACP-090.                                           D.090826
006520 ACP-100.
006530     ACCEPT A-MSB.
006540     IF ESTAT = BTB
006550         GO TO ACP-080.                                           I.090826
006560*****    GO TO ACP-090.                                           D.090826
006570     IF ESTAT NOT = HTB AND SKP
006580         GO TO ACP-100.
006590     GO TO ACP-040.
006600 ACP-120.
006610     SUBTRACT 1 FROM CNT.
006620     SUBTRACT 2 FROM W-L1.
006630     COMPUTE W-L2 = W-L1 + 1.
006640     IF CNT = 0
006650         GO TO ACP-020.
006660     IF W-HCD(CNT) = ZERO
006670         GO TO ACP-120.
006680     GO TO ACP-050.
006690 ACP-130.
006700     MOVE ZERO TO W-MEID(CNT).
006710*****MOVE SPACE TO W-JAN(CNT) W-DPC(CNT) W-SHM(CNT) W-MSB(CNT)    D.090826
006720     MOVE SPACE TO W-JAN(CNT) W-SHM(CNT) W-MSB(CNT) W-SZM(CNT)    I.090826
006730                   W-SIZM(CNT).
006740     DISPLAY C-SPC.
006750     ADD 1 TO CNT.
006760     ADD 2 TO W-L1.
006770     COMPUTE W-L2 = W-L1 + 1.
006780     IF CNT NOT = 10
006790         GO TO ACP-130.
006800 ACP-150.
006810     MOVE ZERO TO CNT WT-D.
006820 ACP-160.
006830     ADD 1 TO CNT.
006840     IF CNT NOT = 10
006850         ADD W-SU(CNT) TO WT-SU
006860         ADD W-GKIN(CNT) TO WT-GKIN
006870         ADD W-UKIN(CNT) TO WT-UKIN
006880         GO TO ACP-160.
006890     DISPLAY D-TOT.
006900 ACP-180.
006910     ACCEPT A-BI.
006920     DISPLAY E-CL.
006930     IF ESTAT = BTB
006940         MOVE 10 TO CNT
006950         MOVE 22 TO W-L1
006960         GO TO ACP-120.
006970     IF ESTAT NOT = HTB AND SKP
006980         GO TO ACP-180.
006990 ACP-190.
007000     ACCEPT A-SNGP.
007010     DISPLAY E-CL.
007020     IF ESTAT = BTB
007030         GO TO ACP-180.
007040     IF ESTAT NOT = HTB AND SKP
007050         GO TO ACP-190.
007060     IF W-SNGPS = ZERO
007070         MOVE ZERO TO W-SNGP
007080         GO TO ACP-200.
007090     MOVE W-SNGP TO W-NGP.
007100     IF W-NEN2 < 09
007110         GO TO ACP-190.
007120     IF W-GET < 01 OR > 12
007130         GO TO ACP-190.
007140     IF W-PEY < 01 OR > 31
007150         GO TO ACP-190.
007160     MOVE 20 TO W-NEN1.
007170     MOVE W-NGP TO W-SNGP.
007180 ACP-200.
007190     ACCEPT A-HNA.
007200     DISPLAY E-CL.
007210     IF ESTAT = BTB
007220         GO TO ACP-190.
007230     IF ESTAT NOT = HTB AND SKP
007240         GO TO ACP-200.
007250 ACP-210.
007260     ACCEPT A-ZON.
007270     DISPLAY E-CL.
007280     IF ESTAT = BTB
007290         GO TO ACP-200.
007300     IF ESTAT NOT = HTB AND SKP
007310         GO TO ACP-210.
007320 ACP-220.
007330     ACCEPT A-DNGP.
007340     DISPLAY E-CL.
007350     IF ESTAT = BTB
007360         GO TO ACP-210.
007370     IF ESTAT NOT = HTB AND SKP
007380         GO TO ACP-220.
007390     IF W-DNGPS = ZERO
007400         ACCEPT W-DNGPS FROM DATE
007410         DISPLAY A-DNGP
007420         MOVE 20 TO W-DNEN1
007430         GO TO ACP-280.
007440     MOVE W-DNGP TO W-NGP.
007450     IF W-NEN2 < 09
007460         GO TO ACP-220.
007470     IF W-GET < 01 OR > 12
007480         GO TO ACP-220.
007490     IF W-PEY < 01 OR > 31
007500         GO TO ACP-220.
007510     MOVE 20 TO W-NEN1.
007520     MOVE W-NGP TO W-DNGP.
007530     IF W-DNGPS < W-SDATE OR > W-EDATE
007540         GO TO ACP-220.
007550 ACP-280.
007560     ACCEPT A-DMM.
007570     DISPLAY E-CL.
007580     IF ESTAT = BTB
007590         IF W-ACT = 3
007600             GO TO ACP-EX
007610           ELSE
007620             GO TO ACP-220.
007630     IF ESTAT NOT = HTB AND SKP
007640         GO TO ACP-280.
007650     IF W-DMM = 9
007660         IF W-ACT = 3
007670             GO TO ACP-EX
007680           ELSE
007690             GO TO ACP-005.
007700     IF W-DMM NOT = 1
007710         GO TO ACP-280.
007720 ACP-EX.
007730     EXIT.
007740 UPD-RTN.
007750     IF W-ACT NOT = 1
007760         GO TO UPD-100.
007770     PERFORM CON-RTN THRU CON-EX.
007780     IF COMPLETION-CODE = 255
007790         GO TO UPD-EX.
007800     MOVE ZERO TO CNT.
007810 UPD-010.
007820     ADD 1 TO CNT.
007830     IF CNT = 10
007840         GO TO UPD-EX.
007850     IF W-HCD(CNT) = ZERO
007860         GO TO UPD-010.
007870 UPD-020.
007880     INITIALIZE TDNA-R.
007890     MOVE W-STC TO TDNA-STC.
007900     MOVE W-DNO TO TDNA-DNO.
007910     PERFORM MOV-RTN THRU MOV-EX.
007920     WRITE TDNA-R INVALID KEY
007930         DISPLAY E-STAT E-ME20 E-TDNA E-ME99
007940         GO TO UPD-030.
007950     GO TO UPD-010.
007960 UPD-030.
007970     IF ERR-STAT NOT = "24"
007980         MOVE 255 TO COMPLETION-CODE
007990         DISPLAY E-ME78 E-ME99
008000         GO TO UPD-EX.
008010     DISPLAY E-CL.
008020     CLOSE TDNAF.
008030     MOVE "TDNAF        " TO W-FILE.
008040     DISPLAY E-ME71 E-ME98 STOP " ".
008050     DISPLAY E-CL.
008060     OPEN INPUT TDNAF.
008070     GO TO UPD-020.
008080 UPD-100.
008090     MOVE SPACE TO TDNA-KEY.
008100     MOVE W-STC TO TDNA-STC.
008110     MOVE W-DNO TO TDNA-DNO.
008120     START TDNAF KEY NOT < TDNA-KEY INVALID KEY
008130         MOVE 255 TO COMPLETION-CODE
008140         DISPLAY E-ME8 E-ME78 E-ME99
008150         GO TO UPD-EX.
008160     READ TDNAF NEXT RECORD AT END
008170         MOVE 255 TO COMPLETION-CODE
008180         DISPLAY E-ME8 E-ME78 E-ME99
008190         GO TO UPD-EX.
008200     IF (TDNA-STC NOT = W-STC) OR (TDNA-DNO NOT = W-DNO)
008210         MOVE 255 TO COMPLETION-CODE
008220         DISPLAY E-ME8 E-ME78 E-ME99
008230         GO TO UPD-EX.
008240 UPD-110.
008250     DELETE TDNAF INVALID KEY
008260         MOVE 255 TO COMPLETION-CODE
008270         DISPLAY E-ME22 E-ME78 E-STAT E-TDNA E-ME99
008280         GO TO UPD-EX.
008290*
008300     READ TDNAF NEXT RECORD AT END
008310         GO TO UPD-120.
008320     IF (TDNA-STC NOT = W-STC) OR (TDNA-DNO NOT = W-DNO)
008330         GO TO UPD-120.
008340     GO TO UPD-110.
008350 UPD-120.
008360     IF W-ACT = 3
008370         GO TO UPD-EX.
008380*
008390     MOVE ZERO TO CNT.
008400 UPD-130.
008410     ADD 1 TO CNT.
008420     IF CNT = 10
008430         GO TO UPD-EX.
008440     IF W-HCD(CNT) = ZERO
008450         GO TO UPD-130.
008460 UPD-140.
008470     INITIALIZE TDNA-R.
008480     MOVE W-STC TO TDNA-STC.
008490     MOVE W-DNO TO TDNA-DNO.
008500     PERFORM MOV-RTN THRU MOV-EX.
008510     WRITE TDNA-R INVALID KEY
008520         DISPLAY E-STAT E-ME20 E-TDNA E-ME99
008530         GO TO UPD-150.
008540     GO TO UPD-130.
008550 UPD-150.
008560     IF ERR-STAT NOT = "24"
008570         MOVE 255 TO COMPLETION-CODE
008580         DISPLAY E-ME78 E-ME99
008590         GO TO UPD-EX.
008600     DISPLAY E-CL.
008610     CLOSE TDNAF.
008620     MOVE "TDNAF        " TO W-FILE.
008630     DISPLAY E-ME71 E-ME98 STOP " ".
008640     DISPLAY E-CL.
008650     OPEN INPUT TDNAF.
008660     GO TO UPD-140.
008670 UPD-EX.
008680     EXIT.
008690 SIZ-RTN.
008700     MOVE ZERO TO W-SC.
008710 SIZ-010.
008720     ADD 1 TO W-SC.
008730     IF W-SC > 4
008740         GO TO SIZ-EX.
008750     MOVE ZERO TO W-SNO.
008760 SIZ-020.
008770     ADD 1 TO W-SNO.
008780     IF W-SNO > 10
008790         GO TO SIZ-010.
008800     IF W-S(CNT) NOT = W-SZ(W-SC,W-SNO)
008810         GO TO SIZ-020.
008820     MOVE W-SIZ(W-SC,W-SNO) TO W-DSZ.
008830     IF HI-HKB = 1
008840         MOVE 5 TO W-DSZH.
008850     MOVE W-DSZ TO W-SIZM(CNT) W-SZM(CNT).                        I.090826
008860*****MOVE W-DSZ TO W-SIZM(CNT).                                   D.090826
008870 SIZ-EX.
008880     EXIT.
008890 CON-RTN.
008900*****MOVE ZERO TO JCON5-R.                                        D.090917
008910*****MOVE 5 TO JCON1-01.                                          D.090917
008920*****MOVE 1 TO JCON1-02.                                          D.090917
008930     MOVE ZERO TO JCON1-R.                                        I.090917
008940     MOVE 1 TO JCON1-01.                                          I.090917
008950     MOVE 9 TO JCON1-02.                                          I.090917
008960     READ JCON INVALID KEY
008970         MOVE 255 TO COMPLETION-CODE
008980         DISPLAY E-ME24 E-ME99
008990         GO TO CON-EX.
009000*****IF JCON5-03 = 999999                                         D.090917
009010*****    MOVE 000000 TO JCON5-03.                                 D.090917
009020*****ADD 1 TO JCON5-03.                                           D.090917
009030     IF JCON1-03 = 999999                                         I.090917
009040         MOVE 000000 TO JCON1-03.                                 I.090917
009050     ADD 1 TO JCON1-03.                                           I.090917
009060     REWRITE JCON1-R INVALID KEY
009070         MOVE 255 TO COMPLETION-CODE
009080         DISPLAY E-ME25 E-ME99
009090         GO TO CON-EX.
009100     MOVE JCON1-03 TO W-DNO.                                      I.090917
009110*****MOVE JCON5-03 TO W-DNO.                                      D.090917
009120 CON-EX.
009130     EXIT.
009140 MOV-RTN.
009150     MOVE CNT TO TDNA-DGN.
009160     MOVE W-JAN(CNT) TO TDNA-JAN.
009170     MOVE W-SU(CNT) TO TDNA-SU.
009180     MOVE W-GTN(CNT) TO TDNA-GTN.
009190     MOVE W-UTN(CNT) TO TDNA-UTN.
009200     MOVE W-GKIN(CNT) TO TDNA-GKIN.
009210     MOVE W-UKIN(CNT) TO TDNA-UKIN.
009220*****MOVE W-DPM(CNT) TO TDNA-DPM.                                 D.090826
009230*****MOVE W-CLS(CNT) TO TDNA-CLS.                                 D.090826
009240     MOVE 23 TO TDNA-DPM.                                         I.090826
009250     MOVE 392 TO TDNA-CLS.                                        I.090826
009260     MOVE W-SHM(CNT) TO TDNA-SHM.
009270     MOVE W-MSB(CNT) TO TDNA-MSB.
009280     MOVE W-HCD(CNT) TO TDNA-HCD.                                 I.090908
009290     MOVE W-COR(CNT) TO TDNA-COR.                                 I.090826
009300     MOVE W-SZM(CNT) TO TDNA-SIZ.                                 I.090826
009310     MOVE AHNH-CCD TO TDNA-CCD.                                   I.090908
009320     MOVE AHNH-NHSN TO TDNA-TNA.                                  I.090826
009330     MOVE W-HNO TO TDNA-HNO.
009340     MOVE W-HNGP TO TDNA-HNGP.
009350     MOVE W-NNGP TO TDNA-NNGP.
009360     MOVE 519001 TO TDNA-THC.
009370     MOVE W-BI TO TDNA-BI.
009380     MOVE W-SNGP TO TDNA-SNGP.
009390     MOVE W-HNA TO TDNA-HNA.
009400     MOVE W-ZON TO TDNA-ZON.
009410     MOVE W-DNGP TO TDNA-DNGP.
009420     MOVE 20 TO TDNA-DC.
009430     MOVE 1 TO TDNA-NRC.
009440 MOV-EX.
009450     EXIT.
009460 COR-RTN.                                                         I.090826
009470     MOVE SPACE TO W-AHN W-CORD.                                  I.090826
009480     MOVE HI-NAME TO W-AHN.                                       I.090826
009490     MOVE ZERO TO W-C1.                                           I.090826
009500 COR-010.                                                         I.090826
009510     ADD 1 TO W-C1.                                               I.090826
009520     IF W-C1 < 25                                                 I.090826
009530         IF W-HN(W-C1) NOT = SPACE                                I.090826
009540             GO TO COR-010.                                       I.090826
009550     ADD 1 TO W-C1.                                               I.090826
009560     IF W-C1 < 25                                                 I.090826
009570         IF W-HN(W-C1) NOT = SPACE                                I.090826
009580             GO TO COR-010.                                       I.090826
009590 COR-020.                                                         I.090826
009600     ADD 1 TO W-C1.                                               I.090826
009610     IF W-C1 > 24                                                 I.090826
009620         GO TO COR-EX.                                            I.090826
009630     IF W-HN(W-C1) = SPACE                                        I.090826
009640         GO TO COR-020.                                           I.090826
009650     MOVE ZERO TO W-C2.                                           I.090826
009660 COR-030.                                                         I.090826
009670     ADD 1 TO W-C2.                                               I.090826
009680     IF W-C2 > 4                                                  I.090826
009690         GO TO COR-EX.                                            I.090826
009700     MOVE W-HN(W-C1) TO W-NA(W-C2).                               I.090826
009710     ADD 1 TO W-C1.                                               I.090826
009720     IF W-C1 < 25                                                 I.090826
009730         GO TO COR-030.                                           I.090826
009740 COR-EX.                                                          I.090826
009750     EXIT.                                                        I.090826
