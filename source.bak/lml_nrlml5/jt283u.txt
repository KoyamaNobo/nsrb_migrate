000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID.      JT283U.
000030 AUTHOR.          MAYUMI.I.
000040*********************************************************
000050*    PROGRAM         :  倉別在庫ワーク　作成            *
000060*    PRINTER TYPE    :  JIPS                            *
000070*    DATA WRITTN     :  96/03/06                        *
000080*    COMPILE TYPE    :  CBL85 (74MODE)                  *
000090*********************************************************
000100 ENVIRONMENT      DIVISION.
000110 CONFIGURATION    SECTION.
000120 SOURCE-COMPUTER. NEAC-SYSTEM3100.
000130 OBJECT-COMPUTER. NEAC-SYSTEM3100.
000140 INPUT-OUTPUT     SECTION.
000150 FILE-CONTROL.
000160     SELECT  JT-YZAI   ASSIGN  TO  F1-MSD
000170         FILE  STATUS  ERR-STAT.
000180     SELECT  NJZAI     ASSIGN  TO  F2-MSD
000190         ORGANIZATION  IS INDEXED
000200         ACCESS MODE   IS DYNAMIC
000210         RECORD KEY    IS NJZAI-KEY.
000220     SELECT  JMST3     ASSIGN  TO  F3-MSD
000230         ORGANIZATION  IS INDEXED
000240         ACCESS MODE   IS DYNAMIC
000250         RECORD KEY    IS JMST3-KEY.
000260     SELECT  JNYZ      ASSIGN  TO  F4-MSD
000270         ORGANIZATION  IS INDEXED
000280         ACCESS MODE   IS DYNAMIC
000290         RECORD KEY    IS JNYZ-KEY.
000300*****SELECT  SHM       ASSIGN  TO  SHM-MSD                        D.010818
000310     SELECT  HI2-M     ASSIGN  TO  HIM-MSD                        I.010818
000320         ORGANIZATION  IS INDEXED
000330         ACCESS MODE   IS RANDOM
000340         RECORD KEY    IS HI-KEY2.                                I.010818
000350*****    RECORD KEY    IS SHM-KEY.                                D.010818
000360 I-O-CONTROL.
000370*****APPLY SHARED-MODE    ON  NJZAI  JMST3  JNYZ  SHM             D.010818
000380     APPLY SHARED-MODE    ON  NJZAI  JMST3  JNYZ  HI2-M           I.010818
000390     APPLY EXCLUSIVE-MODE ON  JT-YZAI.
000400 DATA    DIVISION.
000410 FILE    SECTION.
000420 COPY   LNJZAI.
000430 COPY   LJMST3.
000440 COPY   LJNYZ.
000450 COPY   LIHIM2.                                                   I.010818
000460*COPY   L-SHM.                                                    D.010818
000470 FD  JT-YZAI
000480*****BLOCK    3     RECORDS                                       D.970530
000490     BLOCK    2     RECORDS                                       I.970530
000500     LABEL    RECORD   STANDARD
000510     VALUE    OF  IDENTIFICATION   WK0128ID.                      I.970530
000520*****VALUE    OF  IDENTIFICATION   WK0085ID.                      D.970530
000530*
000540 01  YZAI-R.
000550     02   YZAI-01             PIC 9(1).                           ｸﾗｺｰﾄﾞ
000560     02   YZAI-02             PIC 9(6).                           ﾋﾝﾒｲｺｰﾄﾞ
000570     02   YZAI-03             PIC 9(1).                           ｻｲｽﾞｸﾌﾞﾝ
000580     02   YZAI-04.                                                ｻﾞｲｺｽｳ
000590          03   YZAI-04        OCCURS  10.                         ｻｲｽﾞﾍﾞﾂ
000600              04   YZAI-0411  PIC S9(6).
000610     02   FILLER              PIC X(14).
000620     02   YZAI-91.                                                ﾌﾞﾝﾙｲ2
000630          03   YZAI-911       PIC 9(01).
000640          03   YZAI-912       PIC 9(01).
000650     02   YZAI-92             PIC 9(01).                          ｻﾞｲｺｸﾌﾞﾝ
000660     02   YZAI-93             PIC 9(01).                          I.980525
000670     02   FILLER              PIC X(42).                          I.980525
000680*****02   FILLER              PIC X(43).                          D.980525
000690*
000700 WORKING-STORAGE  SECTION.
000710 77  ERR-STAT                 PIC  X(2).
000720*77  WK0085ID                 PIC  X(009) VALUE SPACE.            D.970530
000730 77  WK0128ID                 PIC  X(009) VALUE SPACE.            I.970530
000740 01  STN-NO.
000750     02  STN-NO1              PIC  X(003).
000760     02  STN-NO2              PIC  X(003).
000770 01  W-FID.
000780*****02  W-FID1               PIC  X(006) VALUE "WK0085".         D.970530
000790     02  W-FID1               PIC  X(006) VALUE "WK0128".         I.970530
000800     02  W-FID2               PIC  X(003).
000810 01  W-SUD.
000820     02  W-SU                 PIC S9(06)  OCCURS  10.
000830 01  ZERO-SW                  PIC  9(01).
000840 01  W-KEY.
000850     02  W-KURA               PIC  9(01).
000860     02  W-HCD                PIC  9(06).
000870     02  W-HCDD  REDEFINES W-HCD.                                 I.060516
000880       03  W-HCD1             PIC  9(04).                         I.060516
000890       03  W-HCD2             PIC  9(02).                         I.060516
000900     02  W-MCD                PIC  9(06).                         I.060516
000910     02  W-MCDD  REDEFINES W-MCD.                                 I.060516
000920       03  W-MCD1             PIC  9(04).                         I.060516
000930       03  W-MCD2             PIC  9(02).                         I.060516
000940 01  W-AREA.
000950     02  I                    PIC  9(02).
000960     02  W-ZCHK               PIC  9(01).
000970     02  W-SEN                PIC  9(01).
000980     02  W-FROM.
000990         03  W-FK             PIC  9(01).
001000         03  W-FH1            PIC  9(04).                         I.060516
001010         03  W-FH2            PIC  9(04).                         I.060516
001020         03  W-FH3            PIC  9(04).                         I.060516
001030         03  W-FH4            PIC  9(04).                         I.060516
001040         03  W-FH5            PIC  9(04).                         I.060516
001050         03  W-FH6            PIC  9(04).                         I.110228
001060*****    03  W-FH             PIC  9(06).                         D.961108
001070*****    03  W-FH1            PIC  9(06).                         D.060516
001080*****    03  W-FH2            PIC  9(06).                         D.060516
001090*****    03  W-FH3            PIC  9(06).                         D.060516
001100*****    03  W-FH4            PIC  9(06).                         D.060516
001110*****    03  W-FH5            PIC  9(06).                         D.060516
001120     02  W-TO.
001130         03  W-TK             PIC  9(01).
001140         03  W-TH             PIC  9(04).                         I.060516
001150         03  W-TH1            PIC  9(04).                         I.060516
001160         03  W-TH2            PIC  9(04).                         I.060516
001170         03  W-TH3            PIC  9(04).                         I.060516
001180         03  W-TH4            PIC  9(04).                         I.060516
001190         03  W-TH5            PIC  9(04).                         I.060516
001200         03  W-TH6            PIC  9(04).                         I.110228
001210*****    03  W-TH             PIC  9(06).                         D.060516
001220*****    03  W-TH1            PIC  9(06).                         D.060516
001230*****    03  W-TH2            PIC  9(06).                         D.060516
001240*****    03  W-TH3            PIC  9(06).                         D.060516
001250*****    03  W-TH4            PIC  9(06).                         D.060516
001260*****    03  W-TH5            PIC  9(06).                         D.060516
001270     02  OKC                  PIC  9(01).                         確認　
001280***
001290 COPY  LWMSG.
001300***
001310 SCREEN      SECTION.
001320 SD  C-CRT
001330     END  STATUS  IS  ESTAT.
001340 01  C-CLEAR.
001350     02  C-CL     LINE   1  CLEAR SCREEN.
001360 01  CLR-01.
001370*****02  CLR-ZCHK  LINE 12  COLUMN 31  VALUE " ".                 D.961108
001380*****02  CLR-SEN   LINE 12  COLUMN 49  VALUE " ".                 D.961108
001390*****02  CLR-FK    LINE 10  COLUMN 64  VALUE " ".                 D.961108
001400*****02  CLR-FH    LINE 10  COLUMN 67  VALUE "      ".            D.961108
001410*****02  CLR-TK    LINE 12  COLUMN 64  VALUE " ".                 D.961108
001420*****02  CLR-TH    LINE 12  COLUMN 67  VALUE "      ".            D.961108
001430     02  CLR-ZCHK  LINE 10  COLUMN 36  VALUE " ".                 I.961108
001440     02  CLR-SEN   LINE 10  COLUMN 54  VALUE " ".                 I.961108
001450     02  CLR-FK    LINE 16  COLUMN 23  VALUE " ".                 I.961108
001460     02  CLR-TK    LINE 18  COLUMN 23  VALUE " ".                 I.961108
001470     02  CLR-FH1   LINE 16  COLUMN 27  VALUE "    ".              I.060516
001480     02  CLR-TH1   LINE 18  COLUMN 27  VALUE "    ".              I.060516
001490     02  CLR-FH2   LINE 16  COLUMN 35  VALUE "    ".              I.060516
001500     02  CLR-TH2   LINE 18  COLUMN 35  VALUE "    ".              I.060516
001510     02  CLR-FH3   LINE 16  COLUMN 43  VALUE "    ".              I.060516
001520     02  CLR-TH3   LINE 18  COLUMN 43  VALUE "    ".              I.060516
001530     02  CLR-FH4   LINE 16  COLUMN 51  VALUE "    ".              I.060516
001540     02  CLR-TH4   LINE 18  COLUMN 51  VALUE "    ".              I.060516
001550     02  CLR-FH5   LINE 16  COLUMN 59  VALUE "    ".              I.060516
001560     02  CLR-TH5   LINE 18  COLUMN 59  VALUE "    ".              I.060516
001570     02  CLR-FH6   LINE 16  COLUMN 67  VALUE "    ".              I.110228
001580     02  CLR-TH6   LINE 18  COLUMN 67  VALUE "    ".              I.110228
001590*****02  CLR-FH1   LINE 16  COLUMN 26  VALUE "      ".            D.060516
001600*****02  CLR-TH1   LINE 18  COLUMN 26  VALUE "      ".            D.060516
001610*****02  CLR-FH2   LINE 16  COLUMN 34  VALUE "      ".            D.060516
001620*****02  CLR-TH2   LINE 18  COLUMN 34  VALUE "      ".            D.060516
001630*****02  CLR-FH3   LINE 16  COLUMN 42  VALUE "      ".            D.060516
001640*****02  CLR-TH3   LINE 18  COLUMN 42  VALUE "      ".            D.060516
001650*****02  CLR-FH4   LINE 16  COLUMN 50  VALUE "      ".            D.060516
001660*****02  CLR-TH4   LINE 18  COLUMN 50  VALUE "      ".            D.060516
001670*****02  CLR-FH5   LINE 16  COLUMN 58  VALUE "      ".            D.060516
001680*****02  CLR-TH5   LINE 18  COLUMN 58  VALUE "      ".            D.060516
001690***
001700 01  DSP-AREA.
001710     02  LINE  1  COLUMN 27  VALUE
001720          "                      " REVERSE.
001730     02  LINE  1  COLUMN 28  VALUE
001740         NC"倉別在庫ワーク　抽出".
001750*****02  LINE  8  COLUMN  8  VALUE "在庫数(指図含) = 1".          D.961108
001760*****02  LINE 10  COLUMN  8  VALUE "      (指図無) = 2".          D.961108
001770*****02  LINE 12  COLUMN  8  VALUE "有 効 在 庫 数 = 3 ...  ".    D.961108
001780*****02  LINE  8  COLUMN 36  VALUE "教育 = 0".                    D.961108
001790*****02  LINE 10  COLUMN 36  VALUE "一般 = 1".                    D.961108
001800*****02  LINE 12  COLUMN 36  VALUE "全件 = 2 ...  ".              D.961108
001810*****02  LINE  8  COLUMN 63  VALUE "倉 品名ｺｰﾄﾞ".                 D.961108
001820*****02  LINE 10  COLUMN 54  VALUE "ＦＲＯＭ".                    D.961108
001830*****02  LINE 12  COLUMN 54  VALUE "ＴＯ".                        D.961108
001840*****02  LINE  6  COLUMN 13  VALUE "在庫数(指図含) = 1".          D.980525
001850*****02  LINE  8  COLUMN 13  VALUE "      (指図無) = 2".          D.980525
001860*****02  LINE 10  COLUMN 13  VALUE "有 効 在 庫 数 = 3 ...  ".    D.980525
001870     02  LINE  4  COLUMN 13  VALUE "在庫数(指図含)    = 1".       I.980525
001880     02  LINE  6  COLUMN 13  VALUE "      (指図無)    = 2".       I.980525
001890     02  LINE  8  COLUMN 13  VALUE "有 効 在 庫 数    = 3".       I.980525
001900     02  LINE 10  COLUMN 13  VALUE "出荷可能･入庫予定 = 4 ...  ". I.980525
001910     02  LINE  4  COLUMN 44  VALUE "教　　育　 = 0".              I.030725
001920     02  LINE  6  COLUMN 44  VALUE "ワ　ー　ク = 1".              I.030725
001930     02  LINE  8  COLUMN 44  VALUE "一　　般　 = 2".              I.030725
001940*****02  LINE  8  COLUMN 44  VALUE NC"カジュアル".                D.070419
001950*****02  LINE  8  COLUMN 54  VALUE " = 2".                        D.070419
001960     02  LINE 10  COLUMN 44  VALUE "全　　件　 = 9 ...  ".        I.030725
001970*****02  LINE  6  COLUMN 44  VALUE "教育 = 0".                    D.030725
001980*****02  LINE  8  COLUMN 44  VALUE "一般 = 1".                    D.030725
001990*****02  LINE 10  COLUMN 44  VALUE "全件 = 2 ...  ".              D.030725
002000*****02  LINE  6  COLUMN 41  VALUE "教育 = 0".                    D.980525
002010*****02  LINE  8  COLUMN 41  VALUE "一般 = 1".                    D.980525
002020*****02  LINE 10  COLUMN 41  VALUE "全件 = 2 ...  ".              D.980525
002030*****02  LINE 14  COLUMN 22  VALUE                                D.110228
002040*****    "倉  品名１      ２      ３      ４      ５".            D.110228
002050     02  LINE 14  COLUMN 22  VALUE                                I.110228
002060         "倉  品名１      ２      ３      ４      ５      ６".    I.110228
002070     02  LINE 16  COLUMN 13  VALUE  "ＦＲＯＭ".                   I.961108
002080     02  LINE 18  COLUMN 13  VALUE  "ＴＯ".                       I.961108
002090     02  LINE 23  COLUMN 41  VALUE  "確認(OK=1,NO=9)-->   ﾘﾀｰﾝ".
002100 01  ACP-AREA.
002110*****02  ACP-ZCHK       LINE 12  COLUMN 31     PIC 9(01)          D.961108
002120*****02  ACP-ZCHK       LINE 10  COLUMN 36     PIC 9(01)          D.980525
002130     02  ACP-ZCHK       LINE 10  COLUMN 39     PIC 9(01)          I.980525
002140                        USING W-ZCHK    CHECK OVERFLOW NO IFC.
002150*****02  ACP-SEN        LINE 12  COLUMN 49     PIC 9(01)          D.961108
002160*****02  ACP-SEN        LINE 10  COLUMN 54     PIC 9(01)          D.980525
002170*****02  ACP-SEN        LINE 10  COLUMN 57     PIC 9(01)          D.030725
002180     02  ACP-SEN        LINE 10  COLUMN 63     PIC 9(01)          I.030725
002190                        USING W-SEN     CHECK OVERFLOW NO IFC.
002200*****02  ACP-FK         LINE 10  COLUMN 64     PIC 9(01)          D.961108
002210     02  ACP-FK         LINE 16  COLUMN 23     PIC 9(01)          I.961108
002220                        USING W-FK      CHECK OVERFLOW NO IFC.
002230*****02  ACP-FH         LINE 10  COLUMN 67     PIC 9(06)          D.961108
002240*****                   USING W-FH      CHECK OVERFLOW NO IFC.    D.961108
002250*****02  ACP-TK         LINE 12  COLUMN 64     PIC 9(01)          D.961108
002260     02  ACP-TK         LINE 18  COLUMN 23     PIC 9(01)          I.961108
002270                        USING W-TK      CHECK OVERFLOW NO IFC.
002280*****02  ACP-TH         LINE 12  COLUMN 67     PIC 9(06)          D.961108
002290*****                   USING W-TH      CHECK OVERFLOW NO IFC.    D.961108
002300*****02  ACP-FH1        LINE 16  COLUMN 26     PIC 9(06)          D.060516
002310     02  ACP-FH1        LINE 16  COLUMN 27     PIC 9(04)          I.060516
002320                        USING W-FH1     CHECK OVERFLOW NO IFC.    I.961108
002330*****02  ACP-TH1        LINE 18  COLUMN 26     PIC 9(06)          D.060516
002340     02  ACP-TH1        LINE 18  COLUMN 27     PIC 9(04)          I.060516
002350                        USING W-TH1     CHECK OVERFLOW NO IFC.    I.961108
002360*****02  ACP-FH2        LINE 16  COLUMN 34     PIC 9(06)          D.060516
002370     02  ACP-FH2        LINE 16  COLUMN 35     PIC 9(04)          I.060516
002380                        USING W-FH2     CHECK OVERFLOW NO IFC.    I.961108
002390*****02  ACP-TH2        LINE 18  COLUMN 34     PIC 9(06)          D.060516
002400     02  ACP-TH2        LINE 18  COLUMN 35     PIC 9(04)          I.060516
002410                        USING W-TH2     CHECK OVERFLOW NO IFC.    I.961108
002420*****02  ACP-FH3        LINE 16  COLUMN 42     PIC 9(06)          D.060516
002430     02  ACP-FH3        LINE 16  COLUMN 43     PIC 9(04)          I.060516
002440                        USING W-FH3     CHECK OVERFLOW NO IFC.    I.961108
002450*****02  ACP-TH3        LINE 18  COLUMN 42     PIC 9(06)          D.060516
002460     02  ACP-TH3        LINE 18  COLUMN 43     PIC 9(04)          I.060516
002470                        USING W-TH3     CHECK OVERFLOW NO IFC.    I.961108
002480*****02  ACP-FH4        LINE 16  COLUMN 50     PIC 9(06)          D.060516
002490     02  ACP-FH4        LINE 16  COLUMN 51     PIC 9(04)          I.060516
002500                        USING W-FH4     CHECK OVERFLOW NO IFC.    I.961108
002510*****02  ACP-TH4        LINE 18  COLUMN 50     PIC 9(06)          D.060516
002520     02  ACP-TH4        LINE 18  COLUMN 51     PIC 9(04)          I.060516
002530                        USING W-TH4     CHECK OVERFLOW NO IFC.    I.961108
002540*****02  ACP-FH5        LINE 16  COLUMN 58     PIC 9(06)          D.060516
002550     02  ACP-FH5        LINE 16  COLUMN 59     PIC 9(04)          I.060516
002560                        USING W-FH5     CHECK OVERFLOW NO IFC.    I.961108
002570*****02  ACP-TH5        LINE 18  COLUMN 58     PIC 9(06)          D.060516
002580     02  ACP-TH5        LINE 18  COLUMN 59     PIC 9(04)          I.060516
002590                        USING W-TH5     CHECK OVERFLOW NO IFC.    I.961108
002600     02  ACP-FH6        LINE 16  COLUMN 67     PIC 9(04)          I.110228
002610                        USING W-FH6     CHECK OVERFLOW NO IFC.    I.110228
002620     02  ACP-TH6        LINE 18  COLUMN 67     PIC 9(04)          I.110228
002630                        USING W-TH6     CHECK OVERFLOW NO IFC.    I.110228
002640     02  ACP-OKC        LINE 23  COLUMN 61     PIC 9(01)
002650                        USING OKC       CHECK OVERFLOW NO IFC.
002660*
002670 01  DISP-MSG-SPACE1     LINE 24.
002680     02  COLUMN 1        PIC X(40)     VALUE " ".
002690***
002700 COPY  LSMSG.
002710***
002720 PROCEDURE   DIVISION.
002730*
002740****************************
002750***  ﾒ ｲ ﾝ  R T N        ***
002760****************************
002770 MR-RTN.
002780     PERFORM  INI-RTN     THRU   INI-EX.
002790     IF  ESTAT     =  "P9"
002800         STOP  RUN.
002810     PERFORM  UPD1-RTN    THRU   UPD1-EX.
002820*****IF  W-ZCHK    =  3                                           D.980525
002830     IF  W-ZCHK    =  3  OR  4                                    I.980525
002840         PERFORM  UPD2-RTN    THRU   UPD2-EX
002850         PERFORM  UPD3-RTN    THRU   UPD3-EX.
002860     PERFORM  END-RTN     THRU   END-EX.
002870     STOP  RUN.
002880*********************************
002890***   ｲﾆｼｬﾙ   R T N           ***
002900*********************************
002910 INI-RTN.
002920     DISPLAY  C-CLEAR.
002930     DISPLAY  DSP-AREA.
002940     INITIALIZE  W-AREA.                                          I.961108
002950 INI-010.
002960     ACCEPT  ACP-ZCHK.
002970     IF  ESTAT  =  "P9"
002980         MOVE  255     TO  COMPLETION-CODE
002990         GO  TO  INI-EX.
003000     IF  ESTAT  NOT =  "01"  AND  "06"
003010         GO  TO  INI-010.
003020     DISPLAY  ACP-ZCHK.
003030*****IF  W-ZCHK NOT =  1 AND 2 AND 3                              D.980525
003040     IF  W-ZCHK NOT =  1 AND 2 AND 3 AND 4                        I.980525
003050         GO  TO  INI-010.
003060 INI-020.
003070     ACCEPT  ACP-SEN.
003080     IF  ESTAT  =  "09"
003090         GO  TO  INI-010.                                         I.941018
003100     IF  ESTAT  NOT =  "01"  AND  "06"
003110         GO  TO  INI-020.
003120     DISPLAY  ACP-SEN.
003130*****IF  W-SEN  NOT =  0  AND 1 AND 2                             D.030725
003140     IF  W-SEN  NOT =  0  AND 1 AND 2  AND  9                     I.030725
003150         GO  TO  INI-020.
003160*****IF  W-ZCHK     =  3                                          D.980525
003170     IF  W-ZCHK     =  3  OR 4                                    I.980525
003180         MOVE   9        TO  W-FK  W-TK                           I.961108
003190         DISPLAY    CLR-FK   CLR-TK                               I.961108
003200         GO  TO  INI-055.                                         I.961108
003210*****    MOVE   9        TO  W-FK                                 D.961108
003220*****    DISPLAY    CLR-FK                                        D.961108
003230*****    GO  TO  INI-040.                                         D.961108
003240 INI-030.
003250     ACCEPT  ACP-FK.
003260     IF  ESTAT  =  "09"
003270         GO  TO  INI-020.
003280     IF  ESTAT  NOT =  "01"  AND  "06"
003290         GO  TO  INI-030.
003300     DISPLAY  ACP-FK.
003310*INI-040.                                                         D.961108
003320*****ACCEPT  ACP-FH.                                              D.961108
003330*****IF  ESTAT  =  "09"                                           D.961108
003340*****    IF  W-ZCHK     =  3                                      D.961108
003350*****        GO  TO  INI-020                                      D.961108
003360*****      ELSE                                                   D.961108
003370*****        GO  TO  INI-030.                                     D.961108
003380*****IF  ESTAT  NOT =  "01"  AND  "06"                            D.961108
003390*****    GO  TO  INI-040.                                         D.961108
003400*****DISPLAY  ACP-FH.                                             D.961108
003410*****IF  W-ZCHK     =  3                                          D.961108
003420*****    MOVE   9        TO  W-TK                                 D.961108
003430*****    DISPLAY    CLR-TK                                        D.961108
003440*****    GO  TO  INI-060.                                         D.961108
003450 INI-050.
003460     ACCEPT  ACP-TK.
003470     IF  ESTAT  =  "09"
003480         GO  TO  INI-030.                                         I.961108
003490*****    GO  TO  INI-040.                                         D.961108
003500     IF  ESTAT  NOT =  "01"  AND  "06"
003510         GO  TO  INI-050.
003520     DISPLAY  ACP-TK.
003530     IF  W-FK  >  W-TK
003540         GO  TO  INI-050.
003550 INI-055.                                                         I.961108
003560     ACCEPT  ACP-FH1.                                             I.961108
003570     IF  ESTAT  =  "09"                                           I.961108
003580*****    IF  W-ZCHK     =  3                                      D.980525
003590         IF  W-ZCHK     =  3  OR 4                                I.980525
003600             GO  TO  INI-020                                      I.961108
003610           ELSE                                                   I.961108
003620             GO  TO  INI-050.                                     I.961108
003630     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003640         GO  TO  INI-055.                                         I.961108
003650     DISPLAY  ACP-FH1.                                            I.961108
003660 INI-060.
003670*****ACCEPT  ACP-TH.                                              D.961108
003680     ACCEPT  ACP-TH1.                                             I.961108
003690     IF  ESTAT  =  "09"
003700         GO  TO  INI-055.                                         I.961108
003710*****    IF  W-ZCHK     =  3                                      D.961108
003720*****        GO  TO  INI-040                                      D.961108
003730*****      ELSE                                                   D.961108
003740*****        GO  TO  INI-050.                                     D.961108
003750     IF  ESTAT  NOT =  "01"  AND  "06"
003760         GO  TO  INI-060.
003770*****DISPLAY  ACP-TH.                                             D.961108
003780*****IF  W-FROM  >  W-TO                                          D.961108
003790     DISPLAY  ACP-TH1.                                            I.961108
003800     IF  W-FH1   >  W-TH1                                         I.961108
003810         GO  TO  INI-060.
003820*****IF W-TH1 = 999999                                            D.060516
003830     IF W-TH1 = 9999                                              I.060516
003840         MOVE W-TH1 TO W-TH                                       I.961108
003850         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4         I.961108
003860                      W-FH5 W-TH5 W-FH6 W-TH6                     I.110228
003870*****                                         W-FH5 W-TH5         D.110228
003880         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-TH3                  I.961108
003890                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.110228
003900*****            CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5                  D.110228
003910         GO TO INI-510.                                           I.961108
003920 INI-070.                                                         I.961108
003930     ACCEPT  ACP-FH2.                                             I.961108
003940     IF  ESTAT  =  "09"                                           I.961108
003950         GO  TO  INI-060.                                         I.961108
003960     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
003970         GO  TO  INI-070.                                         I.961108
003980     IF W-FH2 = ZERO                                              I.961108
003990         MOVE W-TH1 TO W-TH                                       I.961108
004000         MOVE ZERO TO W-FH2 W-TH2 W-FH3 W-TH3 W-FH4 W-TH4         I.961108
004010                      W-FH5 W-TH5 W-FH6 W-TH6                     I.110228
004020*****                                         W-FH5 W-TH5         D.110228
004030         DISPLAY CLR-FH2 CLR-TH2 CLR-FH3 CLR-TH3                  I.961108
004040                 CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.110228
004050*****            CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5                  D.110228
004060         GO TO INI-510.                                           I.961108
004070     DISPLAY  ACP-FH2.                                            I.961108
004080     IF  W-FH2   <  W-TH1                                         I.961108
004090         GO  TO  INI-070.                                         I.961108
004100 INI-080.                                                         I.961108
004110     ACCEPT  ACP-TH2.                                             I.961108
004120     IF  ESTAT  =  "09"                                           I.961108
004130         GO  TO  INI-070.                                         I.961108
004140     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004150         GO  TO  INI-080.                                         I.961108
004160     DISPLAY  ACP-TH2.                                            I.961108
004170     IF  W-FH2   >  W-TH2                                         I.961108
004180         GO  TO  INI-080.                                         I.961108
004190*****IF W-TH2 = 999999                                            D.060516
004200     IF W-TH2 = 9999                                              I.060516
004210         MOVE W-TH2 TO W-TH                                       I.961108
004220         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5         I.961108
004230                      W-FH6 W-TH6                                 I.110228
004240         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-TH4                  I.961108
004250                 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.110228
004260*****                            CLR-FH5 CLR-TH5                  D.110228
004270         GO TO INI-510.                                           I.961108
004280 INI-090.                                                         I.961108
004290     ACCEPT  ACP-FH3.                                             I.961108
004300     IF  ESTAT  =  "09"                                           I.961108
004310         GO  TO  INI-080.                                         I.961108
004320     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004330         GO  TO  INI-090.                                         I.961108
004340     IF W-FH3 = ZERO                                              I.961108
004350         MOVE W-TH2 TO W-TH                                       I.961108
004360         MOVE ZERO TO W-FH3 W-TH3 W-FH4 W-TH4 W-FH5 W-TH5         I.961108
004370                      W-FH6 W-TH6                                 I.110228
004380         DISPLAY CLR-FH3 CLR-TH3 CLR-FH4 CLR-TH4                  I.961108
004390                 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.110228
004400*****                            CLR-FH5 CLR-TH5                  D.110228
004410         GO TO INI-510.                                           I.961108
004420     DISPLAY  ACP-FH3.                                            I.961108
004430     IF  W-FH3   <  W-TH2                                         I.961108
004440         GO  TO  INI-090.                                         I.961108
004450 INI-100.                                                         I.961108
004460     ACCEPT  ACP-TH3.                                             I.961108
004470     IF  ESTAT  =  "09"                                           I.961108
004480         GO  TO  INI-090.                                         I.961108
004490     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004500         GO  TO  INI-100.                                         I.961108
004510     DISPLAY  ACP-TH3.                                            I.961108
004520     IF  W-FH3   >  W-TH3                                         I.961108
004530         GO  TO  INI-100.                                         I.961108
004540*****IF W-TH3 = 999999                                            D.060516
004550     IF W-TH3 = 9999                                              I.060516
004560         MOVE W-TH3 TO W-TH                                       I.961108
004570         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5 W-FH6 W-TH6         I.110228
004580         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.110228
004590*****    MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5                     D.110228
004600*****    DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5                  D.110228
004610         GO TO INI-510.                                           I.961108
004620 INI-110.                                                         I.961108
004630     ACCEPT  ACP-FH4.                                             I.961108
004640     IF  ESTAT  =  "09"                                           I.961108
004650         GO  TO  INI-100.                                         I.961108
004660     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004670         GO  TO  INI-110.                                         I.961108
004680     IF W-FH4 = ZERO                                              I.961108
004690         MOVE W-TH3 TO W-TH                                       I.961108
004700         MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5 W-FH6 W-TH6         I.110228
004710         DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6  I.110228
004720*****    MOVE ZERO TO W-FH4 W-TH4 W-FH5 W-TH5                     D.110228
004730*****    DISPLAY CLR-FH4 CLR-TH4 CLR-FH5 CLR-TH5                  D.110228
004740         GO TO INI-510.                                           I.961108
004750     DISPLAY  ACP-FH4.                                            I.961108
004760     IF  W-FH4   <  W-TH3                                         I.961108
004770         GO  TO  INI-110.                                         I.961108
004780 INI-120.                                                         I.961108
004790     ACCEPT  ACP-TH4.                                             I.961108
004800     IF  ESTAT  =  "09"                                           I.961108
004810         GO  TO  INI-110.                                         I.961108
004820     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
004830         GO  TO  INI-120.                                         I.961108
004840     DISPLAY  ACP-TH4.                                            I.961108
004850     IF  W-FH4   >  W-TH4                                         I.961108
004860         GO  TO  INI-120.                                         I.961108
004870*****IF W-TH4 = 999999                                            D.060516
004880     IF W-TH4 = 9999                                              I.060516
004890         MOVE W-TH4 TO W-TH                                       I.961108
004900         MOVE ZERO TO W-FH5 W-TH5 W-FH6 W-TH6                     I.110228
004910         DISPLAY CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.110228
004920*****    MOVE ZERO TO W-FH5 W-TH5                                 D.110228
004930*****    DISPLAY CLR-FH5 CLR-TH5                                  D.110228
004940         GO TO INI-510.                                           I.961108
004950 INI-130.                                                         I.961108
004960     ACCEPT  ACP-FH5.                                             I.961108
004970     IF  ESTAT  =  "09"                                           I.961108
004980         GO  TO  INI-120.                                         I.961108
004990     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
005000         GO  TO  INI-130.                                         I.961108
005010     IF W-FH5 = ZERO                                              I.961108
005020         MOVE W-TH4 TO W-TH                                       I.961108
005030         MOVE ZERO TO W-FH5 W-TH5 W-FH6 W-TH6                     I.110228
005040         DISPLAY CLR-FH5 CLR-TH5 CLR-FH6 CLR-TH6                  I.110228
005050*****    MOVE ZERO TO W-FH5 W-TH5                                 D.110228
005060*****    DISPLAY CLR-FH5 CLR-TH5                                  D.110228
005070         GO TO INI-510.                                           I.961108
005080     DISPLAY  ACP-FH5.                                            I.961108
005090     IF  W-FH5   <  W-TH4                                         I.961108
005100         GO  TO  INI-130.                                         I.961108
005110 INI-140.                                                         I.961108
005120     ACCEPT  ACP-TH5.                                             I.961108
005130     IF  ESTAT  =  "09"                                           I.961108
005140         GO  TO  INI-130.                                         I.961108
005150     IF  ESTAT  NOT =  "01"  AND  "06"                            I.961108
005160         GO  TO  INI-140.                                         I.961108
005170     DISPLAY  ACP-TH5.                                            I.961108
005180     IF  W-FH5   >  W-TH5                                         I.961108
005190         GO  TO  INI-140.                                         I.961108
005200*****MOVE W-TH5 TO W-TH.                                          D.110228
005210     IF W-TH5 = 9999                                              I.110228
005220         MOVE W-TH5 TO W-TH                                       I.110228
005230         MOVE ZERO TO W-FH6 W-TH6                                 I.110228
005240         DISPLAY CLR-FH6 CLR-TH6                                  I.110228
005250         GO TO INI-510.                                           I.110228
005260 INI-150.                                                         I.110228
005270     ACCEPT  ACP-FH6.                                             I.110228
005280     IF  ESTAT  =  "09"                                           I.110228
005290         GO  TO  INI-140.                                         I.110228
005300     IF  ESTAT  NOT =  "01"  AND  "06"                            I.110228
005310         GO  TO  INI-150.                                         I.110228
005320     IF W-FH6 = ZERO                                              I.110228
005330         MOVE W-TH5 TO W-TH                                       I.961108
005340         MOVE ZERO TO W-FH6 W-TH6                                 D.110228
005350         DISPLAY CLR-FH6 CLR-TH6                                  D.110228
005360         GO TO INI-510.                                           I.961108
005370     DISPLAY  ACP-FH6.                                            I.961108
005380     IF  W-FH6   <  W-TH5                                         I.961108
005390         GO  TO  INI-150.                                         I.961108
005400 INI-160.                                                         I.961108
005410     ACCEPT  ACP-TH6.                                             I.110228
005420     IF  ESTAT  =  "09"                                           I.110228
005430         GO  TO  INI-150.                                         I.110228
005440     IF  ESTAT  NOT =  "01"  AND  "06"                            I.110228
005450         GO  TO  INI-160.                                         I.110228
005460     DISPLAY  ACP-TH6.                                            I.110228
005470     IF  W-FH6   >  W-TH6                                         I.110228
005480         GO  TO  INI-160.                                         I.110228
005490     MOVE W-TH6 TO W-TH.                                          I.110228
005500 INI-510.
005510     ACCEPT  ACP-OKC.
005520*****IF  ESTAT  =  "09"                                           D.961108
005530     IF  ESTAT  NOT =  "09"                                       I.961108
005540         GO TO INI-520.                                           I.961108
005550     IF  W-FH2 = ZERO                                             I.961108
005560         GO  TO  INI-060.
005570     IF  W-FH3 = ZERO                                             I.961108
005580         GO  TO  INI-080.                                         I.961108
005590     IF  W-FH4 = ZERO                                             I.961108
005600         GO  TO  INI-100.                                         I.961108
005610     IF  W-FH5 = ZERO                                             I.961108
005620         GO  TO  INI-120.                                         I.961108
005630     IF  W-FH6 = ZERO                                             I.110228
005640         GO  TO  INI-140.                                         I.961108
005650     GO  TO  INI-160.                                             I.110228
005660 INI-520.                                                         I.961108
005670     IF  ESTAT  NOT =  "01"  AND  "06"
005680         GO  TO  INI-510.
005690     DISPLAY  ACP-OKC.
005700     IF  OKC  NOT =  "1"  AND  "9"
005710         GO  TO  INI-510.
005720     IF  OKC  =  "9"
005730*****    DISPLAY  CLR-01                                          D.961108
005740*****    INITIALIZE  W-AREA                                       D.961108
005750         GO  TO  INI-RTN.
005760*
005770     CALL "CBLSTNNO" USING STN-NO.
005780     MOVE STN-NO2 TO W-FID2.
005790     MOVE W-FID TO WK0128ID.                                      I.970530
005800*****MOVE W-FID TO WK0085ID.                                      D.970530
005810*****OPEN  INPUT   NJZAI  SHM.                                    D.010818
005820*****IF  W-ZCHK     =  3                                          D.980525
005830     OPEN  INPUT   NJZAI  HI2-M.                                  I.010818
005840     IF  W-ZCHK     =  3 OR 4                                     I.980525
005850         OPEN  INPUT   JMST3  JNYZ.
005860     OPEN  OUTPUT  JT-YZAI.
005870 INI-EX.
005880      EXIT.
005890******************************
005900***   UPD1  RTN            ***
005910******************************
005920 UPD1-RTN.
005930*
005940     INITIALIZE                 NJZAI-KEY.
005950     MOVE  ZERO             TO  W-MCD.                            I.060516
005960     MOVE  W-FK             TO  NJZAI-01.
005970     MOVE  W-FH1            TO  W-MCD1.                           I.060516
005980     MOVE  W-MCD            TO  NJZAI-02.                         I.060516
005990*****MOVE  W-FH1            TO  NJZAI-02.                         D.060516
006000*****MOVE  W-FH             TO  NJZAI-02.                         D.961108
006010*
006020     START  NJZAI  KEY  NOT <  NJZAI-KEY  INVALID
006030         GO  TO  UPD1-EX.
006040 UPD1-010.
006050***  倉別在庫マスタ　ＲＥＡＤ
006060     READ  NJZAI  NEXT  UNLOCK  AT  END
006070         GO  TO  UPD1-EX.
006080*
006090     MOVE  NJZAI-01         TO  W-KURA.
006100     MOVE  NJZAI-02         TO  W-HCD.
006110*****IF  W-KEY     <  W-FROM                                      D.961108
006120*****    GO  TO  UPD1-010.                                        D.961108
006130*****IF  W-KEY     >  W-TO                                        D.961108
006140     IF  W-KURA    >  W-TK                                        I.961108
006150         GO  TO  UPD1-EX.
006160*****IF  W-HCD     >  W-TH                                        D.060516
006170     IF  W-HCD1    >  W-TH                                        I.060516
006180         GO  TO  UPD1-EX.                                         I.961108
006190*****IF  W-HCD     >= W-FH1 AND   <=  W-TH1                       D.060516
006200     IF  W-HCD1    >= W-FH1 AND   <=  W-TH1                       D.060516
006210         GO  TO  UPD1-020.                                        I.961108
006220*****IF  W-HCD     >= W-FH2 AND   <=  W-TH2                       D.060516
006230     IF  W-HCD1    >= W-FH2 AND   <=  W-TH2                       I.060516
006240         GO  TO  UPD1-020.                                        I.961108
006250*****IF  W-HCD     >= W-FH3 AND   <=  W-TH3                       D.060516
006260     IF  W-HCD1    >= W-FH3 AND   <=  W-TH3                       I.060516
006270         GO  TO  UPD1-020.                                        I.961108
006280*****IF  W-HCD     >= W-FH4 AND   <=  W-TH4                       D.060516
006290     IF  W-HCD1    >= W-FH4 AND   <=  W-TH4                       I.060516
006300         GO  TO  UPD1-020.                                        I.961108
006310*****IF  W-HCD     >= W-FH5 AND   <=  W-TH5                       I.060516
006320     IF  W-HCD1    >= W-FH5 AND   <=  W-TH5                       I.060516
006330         GO  TO  UPD1-020.                                        I.961108
006340     IF  W-HCD1    >= W-FH6 AND   <=  W-TH6                       I.110228
006350         GO  TO  UPD1-020.                                        I.110228
006360     GO  TO  UPD1-010.                                            I.961108
006370*
006380 UPD1-020.                                                        I.961108
006390     PERFORM  ZC1-RTN      THRU  ZC1-EX.
006400     IF  ZERO-SW  =  0
006410         GO  TO  UPD1-010.
006420*
006430***  品名マスタ　ＲＥＡＤ
006440*****MOVE  NJZAI-02     TO  SHM-KEY.                              D.010818
006450*****READ  SHM  UNLOCK  INVALID                                   D.010818
006460     MOVE  NJZAI-02     TO  HI-MHCD HI-HCD.                       I.010818
006470     READ  HI2-M  UNLOCK  INVALID                                 I.010818
006480         GO  TO  UPD1-010.
006490     IF  W-SEN  =  0
006500*****    IF  SHM-05   <  20  OR   >  29                           D.010601
006510*****    IF  SHM-05   <  30  OR   >  39                           D.010818
006520         IF  HI-BC3   <  30  OR   >  39                           I.010818
006530             GO  TO  UPD1-010.
006540     IF  W-SEN  =  1
006550*****    IF  SHM-05   >  19  AND  <  30                           D.010601
006560*****    IF  SHM-05   >  29  AND  <  40                           D.010818
006570*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
006580         IF  HI-BC3   <  20  OR   >  29                           I.030725
006590             GO  TO  UPD1-010.
006600     IF  W-SEN  =  2                                              I.030725
006610         IF  HI-BC3   > 19                                        I.030725
006620             GO  TO  UPD1-010.                                    I.030725
006630*
006640     MOVE  SPACE     TO  YZAI-R.
006650     INITIALIZE  YZAI-R.
006660     MOVE  NJZAI-01  TO  YZAI-01.
006670     MOVE  NJZAI-02  TO  YZAI-02.
006680     MOVE  NJZAI-03  TO  YZAI-03.
006690     PERFORM  MOV-RTN       THRU  MOV-EX.
006700*****MOVE  SHM-05    TO  YZAI-91.                                 D.010818
006710     MOVE  HI-BC3    TO  YZAI-91.                                 I.010818
006720     MOVE  W-ZCHK    TO  YZAI-92.
006730     PERFORM  WRI-RTN       THRU  WRI-EX.
006740     GO  TO  UPD1-010.
006750 UPD1-EX.
006760     EXIT.
006770*
006780******************************
006790***   UPD2  RTN            ***
006800******************************
006810 UPD2-RTN.
006820*
006830     INITIALIZE                 JMST3-KEY.
006840     MOVE  ZERO             TO  W-MCD.                            I.060516
006850     MOVE  W-FH1            TO  W-MCD1.                           I.060516
006860     MOVE  W-MCD            TO  JMST3-03.                         I.060516
006870*****MOVE  W-FH1            TO  JMST3-03.                         D.060516
006880*****MOVE  W-FH             TO  JMST3-03.                         D.961108
006890*
006900     START  JMST3  KEY  NOT <  JMST3-KEY  INVALID
006910         GO  TO  UPD2-EX.
006920 UPD2-010.
006930***  受注マスタ　ＲＥＡＤ
006940     READ  JMST3  NEXT  UNLOCK  AT  END
006950         GO  TO  UPD2-EX.
006960*
006970*****IF  JMST3-03  <  W-FH                                        D.961108
006980*****    GO  TO  UPD2-010.                                        D.961108
006990     IF  JMST3-01  NOT =  5  AND  6                               I.961108
007000         GO  TO  UPD2-010.                                        I.961108
007010     MOVE  JMST3-03         TO  W-HCD.                            I.060516
007020*****IF  JMST3-03  >  W-TH                                        D.060516
007030     IF  W-HCD1    >  W-TH                                        I.060516
007040         GO  TO  UPD2-EX.
007050*****IF  JMST3-03  >= W-FH1 AND   <=  W-TH1                       D.060516
007060     IF  W-HCD1    >= W-FH1 AND   <=  W-TH1                       I.060516
007070         GO  TO  UPD2-020.                                        I.961108
007080*****IF  JMST3-03  >= W-FH2 AND   <=  W-TH2                       D.060516
007090     IF  W-HCD1    >= W-FH2 AND   <=  W-TH2                       I.060516
007100         GO  TO  UPD2-020.                                        I.961108
007110*****IF  JMST3-03  >= W-FH3 AND   <=  W-TH3                       D.060516
007120     IF  W-HCD1    >= W-FH3 AND   <=  W-TH3                       I.060516
007130         GO  TO  UPD2-020.                                        I.961108
007140*****IF  JMST3-03  >= W-FH4 AND   <=  W-TH4                       D.060516
007150     IF  W-HCD1    >= W-FH4 AND   <=  W-TH4                       I.060516
007160         GO  TO  UPD2-020.                                        I.961108
007170*****IF  JMST3-03  >= W-FH5 AND   <=  W-TH5                       D.060516
007180     IF  W-HCD1    >= W-FH5 AND   <=  W-TH5                       I.060516
007190         GO  TO  UPD2-020.                                        I.961108
007200     IF  W-HCD1    >= W-FH6 AND   <=  W-TH6                       I.110228
007210         GO  TO  UPD2-020.                                        I.110228
007220     GO  TO  UPD2-010.                                            I.961108
007230*
007240*****IF  JMST3-01  NOT =  5  AND  6                               D.961108
007250*****    GO  TO  UPD2-010.                                        D.961108
007260*
007270 UPD2-020.                                                        I.961108
007280     PERFORM  ZC2-RTN      THRU  ZC2-EX.
007290     IF  ZERO-SW  =  0
007300         GO  TO  UPD2-010.
007310*
007320***  品名マスタ　ＲＥＡＤ
007330*****MOVE  JMST3-03     TO  SHM-KEY.                              D.010818
007340*****READ  SHM  UNLOCK  INVALID                                   D.010818
007350     MOVE  JMST3-03     TO  HI-MHCD HI-HCD.                       I.010818
007360     READ  HI2-M  UNLOCK  INVALID                                 I.010818
007370         GO  TO  UPD2-010.
007380     IF  W-SEN  =  0
007390*****    IF  SHM-05   <  20  OR   >  29                           D.010601
007400*****    IF  SHM-05   <  30  OR   >  39                           D.010818
007410         IF  HI-BC3   <  30  OR   >  39                           I.010818
007420             GO  TO  UPD2-010.
007430     IF  W-SEN  =  1
007440*****    IF  SHM-05   >  19  AND  <  30                           D.010601
007450*****    IF  SHM-05   >  29  AND  <  40                           D.010818
007460*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
007470         IF  HI-BC3   <  20  OR   >  29                           I.030725
007480             GO  TO  UPD2-010.
007490     IF  W-SEN  =  2                                              I.030725
007500         IF  HI-BC3   >  19                                       I.030725
007510             GO  TO  UPD2-010.                                    I.030725
007520*
007530     MOVE  SPACE     TO  YZAI-R.
007540     INITIALIZE  YZAI-R.
007550     MOVE  9         TO  YZAI-01.
007560     MOVE  JMST3-03  TO  YZAI-02.
007570     MOVE  JMST3-09  TO  YZAI-03.
007580     PERFORM  MOV-RTN       THRU  MOV-EX.
007590*****MOVE  SHM-05    TO  YZAI-91.                                 D.010818
007600     MOVE  HI-BC3    TO  YZAI-91.                                 I.010818
007610     MOVE  W-ZCHK    TO  YZAI-92.
007620     PERFORM  WRI-RTN       THRU  WRI-EX.
007630     GO  TO  UPD2-010.
007640 UPD2-EX.
007650     EXIT.
007660******************************
007670***   UPD3  RTN            ***
007680******************************
007690 UPD3-RTN.
007700*
007710     INITIALIZE                 JNYZ-KEY.
007720     MOVE  ZERO             TO  W-MCD.                            I.060516
007730     MOVE  W-FH1            TO  W-MCD1.                           I.060516
007740     MOVE  W-MCD            TO  JNYZ-01.                          I.060516
007750*****MOVE  W-FH1            TO  JNYZ-01.                          D.060516
007760*****MOVE  W-FH             TO  JNYZ-01.                          D.961108
007770*
007780     START  JNYZ   KEY  NOT <  JNYZ-KEY   INVALID
007790         GO  TO  UPD3-EX.
007800 UPD3-010.
007810***  入庫予定残Ｆ　ＲＥＡＤ
007820     READ  JNYZ   NEXT  UNLOCK  AT  END
007830         GO  TO  UPD3-EX.
007840*
007850*****IF  JNYZ-01   <  W-FH                                        D.961108
007860*****    GO  TO  UPD3-010.                                        D.961108
007870     MOVE  JNYZ-01          TO  W-HCD.                            I.060516
007880*****IF  JNYZ-01   >  W-TH                                        D.060516
007890     IF  W-HCD1    >  W-TH                                        I.060516
007900         GO  TO  UPD3-EX.
007910*****IF  JNYZ-01   >= W-FH1 AND   <=  W-TH1                       D.060516
007920     IF  W-HCD1    >= W-FH1 AND   <=  W-TH1                       I.060516
007930         GO  TO  UPD3-020.                                        I.961108
007940*****IF  JNYZ-01   >= W-FH2 AND   <=  W-TH2                       D.060516
007950     IF  W-HCD1    >= W-FH2 AND   <=  W-TH2                       I.060516
007960         GO  TO  UPD3-020.                                        I.961108
007970*****IF  JNYZ-01   >= W-FH3 AND   <=  W-TH3                       D.060516
007980     IF  W-HCD1    >= W-FH3 AND   <=  W-TH3                       I.060516
007990         GO  TO  UPD3-020.                                        I.961108
008000*****IF  JNYZ-01   >= W-FH4 AND   <=  W-TH4                       D.060516
008010     IF  W-HCD1    >= W-FH4 AND   <=  W-TH4                       I.060516
008020         GO  TO  UPD3-020.                                        I.961108
008030*****IF  JNYZ-01   >= W-FH5 AND   <=  W-TH5                       D.060516
008040     IF  W-HCD1    >= W-FH5 AND   <=  W-TH5                       I.060516
008050         GO  TO  UPD3-020.                                        I.961108
008060     IF  W-HCD1    >= W-FH6 AND   <=  W-TH6                       I.110228
008070         GO  TO  UPD3-020.                                        I.110228
008080     GO  TO  UPD3-010.                                            I.961108
008090*
008100 UPD3-020.                                                        I.961108
008110     PERFORM  ZC3-RTN      THRU  ZC3-EX.
008120     IF  ZERO-SW  =  0
008130         GO  TO  UPD3-010.
008140*
008150***  品名マスタ　ＲＥＡＤ
008160*****MOVE  JNYZ-01      TO  SHM-KEY.                              D.010818
008170*****READ  SHM  UNLOCK  INVALID                                   D.010818
008180     MOVE  JNYZ-01      TO  HI-MHCD HI-HCD.                       I.010818
008190     READ  HI2-M  UNLOCK  INVALID                                 I.010818
008200         GO  TO  UPD3-010.
008210     IF  W-SEN  =  0
008220*****    IF  SHM-05   <  20  OR   >  29                           D.010601
008230*****    IF  SHM-05   <  30  OR   >  39                           D.010818
008240         IF  HI-BC3   <  30  OR   >  39                           I.010818
008250             GO  TO  UPD3-010.
008260     IF  W-SEN  =  1
008270*****    IF  SHM-05   >  19  AND  <  30                           D.010601
008280*****    IF  SHM-05   >  29  AND  <  40                           D.010818
008290*****    IF  HI-BC3   >  29  AND  <  40                           D.030725
008300         IF  HI-BC3   <  20  OR   >  29                           I.030725
008310             GO  TO  UPD3-010.
008320     IF  W-SEN  =  2                                              I.030725
008330         IF  HI-BC3   >  19                                       I.030725
008340             GO  TO  UPD3-010.                                    I.030725
008350*
008360     MOVE  SPACE     TO  YZAI-R.
008370     INITIALIZE  YZAI-R.
008380     MOVE  9         TO  YZAI-01.
008390     MOVE  JNYZ-01   TO  YZAI-02.
008400     MOVE  JNYZ-02   TO  YZAI-03.
008410     PERFORM  MOV-RTN       THRU  MOV-EX.
008420*****MOVE  SHM-05    TO  YZAI-91.                                 D.010818
008430     MOVE  HI-BC3    TO  YZAI-91.                                 I.010818
008440     MOVE  W-ZCHK    TO  YZAI-92.
008450     IF  W-ZCHK     =  4                                          I.980525
008460         MOVE  1         TO  YZAI-93.                             I.980525
008470     PERFORM  WRI-RTN       THRU  WRI-EX.
008480     GO  TO  UPD3-010.
008490 UPD3-EX.
008500     EXIT.
008510*
008520**************************
008530***  ﾌ ｧ ｲ ﾙ  CLOSE    ***
008540**************************
008550 END-RTN.
008560     CLOSE   JT-YZAI  NJZAI  HI2-M.                               I.010818
008570*****CLOSE   JT-YZAI  NJZAI  SHM.                                 D.010818
008580*****IF  W-ZCHK     =  3                                          D.980525
008590     IF  W-ZCHK     =  3  OR  4                                   I.980525
008600         CLOSE   JMST3  JNYZ.
008610     DISPLAY  C-CLEAR.
008620 END-EX.
008630     EXIT.
008640************************************
008650***  ＪＴ−ＹＺＡＩ　ＷＲＩＴＥ  ***
008660************************************
008670 WRI-RTN.
008680     WRITE    YZAI-R.
008690     IF  ERR-STAT  NOT = "00"
008700              MOVE  "W"          TO  ERR-M
008710*****         MOVE  "WK0256"     TO  ERR-F                        D.970530
008720              MOVE  "WK0128"     TO  ERR-F                        I.970530
008730              PERFORM  ERR-RTN   THRU  ERR-EX.
008740 WRI-EX.
008750     EXIT.
008760********************************
008770*    在庫　ＺＥＲＯ　チェック  *
008780********************************
008790 ZC1-RTN.
008800     MOVE  ZERO  TO  W-SUD.
008810     MOVE  0     TO  ZERO-SW.
008820     MOVE  1     TO  I.
008830 ZC1-010.
008840     IF  I  >  10
008850         GO  TO  ZC1-EX.
008860     COMPUTE  W-SU(I)  =  NJZAI-0411(I)  -  NJZAI-0511(I)
008870                       +  NJZAI-0611(I)  +  NJZAI-0711(I)
008880                       -  NJZAI-0811(I)  +  NJZAI-1111(I).
008890     IF  W-ZCHK    NOT =  1
008900         COMPUTE  W-SU(I)  =  W-SU(I)    -  NJZAI-0911(I).
008910     IF  (ZERO-SW   = 0)  AND  (W-SU(I)  NOT =  ZERO)
008920         MOVE   1     TO  ZERO-SW.
008930     ADD  1     TO  I.
008940     GO  TO  ZC1-010.
008950 ZC1-EX.
008960     EXIT.
008970****************************************
008980*    預り・取よけ　ＺＥＲＯ　チェック  *
008990****************************************
009000 ZC2-RTN.
009010     MOVE  ZERO  TO  W-SUD.
009020     MOVE  0     TO  ZERO-SW.
009030     MOVE  1     TO  I.
009040 ZC2-010.
009050     IF  I  >  10
009060         GO  TO  ZC2-EX.
009070     COMPUTE  W-SU(I)  =  JMST3-1111(I)  -  JMST3-1211(I)
009080                       -  JMST3-141 (I)  -  JMST3-151 (I).
009090     COMPUTE  W-SU(I)  =  -1             *  W-SU(I).
009100     IF  (ZERO-SW   = 0)  AND  (W-SU(I)  NOT =  ZERO)
009110         MOVE   1     TO  ZERO-SW.
009120     ADD  1     TO  I.
009130     GO  TO  ZC2-010.
009140 ZC2-EX.
009150     EXIT.
009160****************************************
009170*    入庫予定残　ＺＥＲＯ　チェック    *
009180****************************************
009190 ZC3-RTN.
009200     MOVE  9        TO  NJZAI-01.                                 I.960308
009210     MOVE  JNYZ-01  TO  NJZAI-02.                                 I.960308
009220     MOVE  JNYZ-02  TO  NJZAI-03.                                 I.960308
009230     READ  NJZAI    WITH  UNLOCK   INVALID  KEY                   I.960308
009240           MOVE  ZERO      TO   NJZAI-0711(01)  NJZAI-0711(02)    I.960308
009250                                NJZAI-0711(03)  NJZAI-0711(04)    I.960308
009260                                NJZAI-0711(05)  NJZAI-0711(06)    I.960308
009270                                NJZAI-0711(07)  NJZAI-0711(08)    I.960308
009280                                NJZAI-0711(09)  NJZAI-0711(10).   I.960308
009290     MOVE  ZERO  TO  W-SUD.
009300     MOVE  0     TO  ZERO-SW.
009310     MOVE  1     TO  I.
009320 ZC3-010.
009330     IF  I  >  10
009340         GO  TO  ZC3-EX.
009350     COMPUTE     W-SU(I)  =    JNYZ-0311(I)  -  NJZAI-0711(I).
009360     IF  (ZERO-SW   = 0)  AND  (W-SU(I)  NOT =  ZERO)
009370         MOVE   1     TO  ZERO-SW.
009380     ADD  1     TO  I.
009390     GO  TO  ZC3-010.
009400 ZC3-EX.
009410     EXIT.
009420*****************************
009430*    数量　ＭＯＶＥ         *
009440*****************************
009450 MOV-RTN.
009460     MOVE  1     TO  I.
009470 MOV-010.
009480     IF  I  >  10
009490         GO  TO  MOV-EX.
009500     MOVE   W-SU(I)     TO  YZAI-0411(I).
009510     ADD  1     TO  I.
009520     GO  TO  MOV-010.
009530 MOV-EX.
009540     EXIT.
009550***
009560 COPY  LPMSG.
009570***
