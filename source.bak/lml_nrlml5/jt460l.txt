000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. JT460L.
000030*********************************************************
000040*    PROGRAM         :  倉庫品名別　出荷数明細表        *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  95/08/09                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM7200.
000130 OBJECT-COMPUTER. SYSTEM7200.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT JT-WK03 ASSIGN TO WK03-MSD.
000170     SELECT JCON ASSIGN TO JCON-MSD
000180         ORGANIZATION IS INDEXED
000190         ACCESS MODE IS RANDOM
000200         RECORD KEY IS JCON3-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT HI2-M ASSIGN TO HI-MSD
000230         ORGANIZATION IS INDEXED
000240         ACCESS MODE IS RANDOM
000250         RECORD KEY IS HI-KEY2
000260         FILE STATUS IS ERR-STAT.
000270     SELECT SP-F ASSIGN TO P-PRN999.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON JCON
000300     APPLY SHARED-MODE ON HI2-M
000310     APPLY SHIFT-CODE  ON SP-F.
000320 DATA DIVISION.
000330 FILE SECTION.
000340     COPY L-JCON.
000350     COPY LIHIM2.
000360     COPY LTWK03.
000370     COPY LSPF.
000380 WORKING-STORAGE SECTION.
000390 77  WK0256ID           PIC  X(009) VALUE SPACE.
000400 01  STN-NO.
000410     02  STN-NO1        PIC  X(003).
000420     02  STN-NO2        PIC  X(003).
000430 01  W-FID.
000440     02  W-FID1         PIC  X(006) VALUE "WK0256".
000450     02  W-FID2         PIC  X(003).
000460 01  HEAD1.
000470     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000480     02  F              PIC  N(002) VALUE NC"【　".
000490     02  F              PIC  X(001) VALUE "'".
000500     02  H-SNEN         PIC  9(002).
000510     02  F              PIC  N(001) VALUE NC"年".
000520     02  H-SGET         PIC Z9.
000530     02  F              PIC  N(001) VALUE NC"月".
000540     02  H-SPEY         PIC Z9.
000550     02  F              PIC  N(001) VALUE NC"日".
000560     02  F              PIC  X(001) VALUE SPACE.
000570     02  F              PIC  N(001) VALUE NC"〜".
000580     02  F              PIC  X(001) VALUE SPACE.
000590     02  F              PIC  X(001) VALUE "'".
000600     02  H-ENEN         PIC  9(002).
000610     02  F              PIC  N(001) VALUE NC"年".
000620     02  H-EGET         PIC Z9.
000630     02  F              PIC  N(001) VALUE NC"月".
000640     02  H-EPEY         PIC Z9.
000650     02  F              PIC  N(001) VALUE NC"日".
000660     02  F              PIC  N(002) VALUE NC"　】".
000670     02  F              PIC  X(010) VALUE SPACE.
000680     02  F              PIC  N(022) VALUE
000690          NC"＊＊＊　　倉庫品名別　出荷数明細表　　＊＊＊".
000700     02  F              PIC  X(019) VALUE SPACE.                  I.031209
000710     02  F              PIC  X(005) VALUE "DATE ".
000720     02  H-DATE         PIC 99/99/99.
000730     02  F              PIC  X(007) VALUE "     P.".
000740     02  H-PAGE         PIC Z9.
000750 01  HEAD2.
000760     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
000770     02  F              PIC  N(004) VALUE NC"倉庫名　".
000780     02  F              PIC  X(005) VALUE SPACE.
000790     02  F              PIC  X(006) VALUE "ｺｰﾄﾞ  ".
000800     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
000810     02  F              PIC  X(025) VALUE SPACE.
000820     02  F              PIC  X(001) VALUE "1".
000830     02  F              PIC  X(019) VALUE SPACE.
000840     02  F              PIC  X(002) VALUE "SS".
000850     02  F              PIC  X(006) VALUE SPACE.
000860     02  F              PIC  X(001) VALUE "S".
000870     02  F              PIC  X(006) VALUE SPACE.
000880     02  F              PIC  X(001) VALUE "M".
000890     02  F              PIC  X(006) VALUE SPACE.
000900     02  F              PIC  X(001) VALUE "L".
000910     02  F              PIC  X(005) VALUE SPACE.
000920     02  F              PIC  X(002) VALUE "LL".
000930     02  F              PIC  X(003) VALUE SPACE.
000940     02  F              PIC  X(004) VALUE "28.0".
000950     02  F              PIC  X(003) VALUE SPACE.
000960     02  F              PIC  X(004) VALUE "29.0".
000970     02  F              PIC  X(003) VALUE SPACE.
000980     02  F              PIC  X(004) VALUE "30.0".
000990     02  F              PIC  X(008) VALUE SPACE.
001000 01  HEAD3.
001010     02  F              PIC  X(054) VALUE SPACE.
001020     02  F              PIC  X(001) VALUE "2".
001030     02  F              PIC  X(003) VALUE SPACE.
001040     02  F              PIC  X(004) VALUE "12.5".
001050     02  F              PIC  X(003) VALUE SPACE.
001060     02  F              PIC  X(004) VALUE "13.0".
001070     02  F              PIC  X(003) VALUE SPACE.
001080     02  F              PIC  X(004) VALUE "13.5".
001090     02  F              PIC  X(003) VALUE SPACE.
001100     02  F              PIC  X(004) VALUE "14.0".
001110     02  F              PIC  X(003) VALUE SPACE.
001120     02  F              PIC  X(004) VALUE "15.0".
001130     02  F              PIC  X(003) VALUE SPACE.
001140     02  F              PIC  X(004) VALUE "16.0".
001150     02  F              PIC  X(003) VALUE SPACE.
001160     02  F              PIC  X(004) VALUE "17.0".
001170     02  F              PIC  X(003) VALUE SPACE.
001180     02  F              PIC  X(004) VALUE "18.0".
001190     02  F              PIC  X(003) VALUE SPACE.
001200     02  F              PIC  X(004) VALUE "19.0".
001210     02  F              PIC  X(003) VALUE SPACE.
001220     02  F              PIC  X(004) VALUE "20.0".
001230     02  F              PIC  X(008) VALUE SPACE.
001240 01  HEAD4.
001250     02  F              PIC  X(054) VALUE SPACE.
001260     02  F              PIC  X(001) VALUE "3".
001270     02  F              PIC  X(003) VALUE SPACE.
001280     02  F              PIC  X(004) VALUE "21.0".
001290     02  F              PIC  X(003) VALUE SPACE.
001300     02  F              PIC  X(004) VALUE "21.5".
001310     02  F              PIC  X(003) VALUE SPACE.
001320     02  F              PIC  X(004) VALUE "22.0".
001330     02  F              PIC  X(003) VALUE SPACE.
001340     02  F              PIC  X(004) VALUE "22.5".
001350     02  F              PIC  X(003) VALUE SPACE.
001360     02  F              PIC  X(004) VALUE "23.0".
001370     02  F              PIC  X(003) VALUE SPACE.
001380     02  F              PIC  X(004) VALUE "23.5".
001390     02  F              PIC  X(003) VALUE SPACE.
001400     02  F              PIC  X(004) VALUE "24.0".
001410     02  F              PIC  X(003) VALUE SPACE.
001420     02  F              PIC  X(004) VALUE "24.5".
001430     02  F              PIC  X(003) VALUE SPACE.
001440     02  F              PIC  X(004) VALUE "25.0".
001450     02  F              PIC  X(015) VALUE SPACE.
001460 01  HEAD5.
001470     02  F              PIC  X(054) VALUE SPACE.
001480     02  F              PIC  X(001) VALUE "4".
001490     02  F              PIC  X(003) VALUE SPACE.
001500     02  F              PIC  X(004) VALUE "24.0".
001510     02  F              PIC  X(003) VALUE SPACE.
001520     02  F              PIC  X(004) VALUE "24.5".
001530     02  F              PIC  X(003) VALUE SPACE.
001540     02  F              PIC  X(004) VALUE "25.0".
001550     02  F              PIC  X(003) VALUE SPACE.
001560     02  F              PIC  X(004) VALUE "25.5".
001570     02  F              PIC  X(003) VALUE SPACE.
001580     02  F              PIC  X(004) VALUE "26.0".
001590     02  F              PIC  X(003) VALUE SPACE.
001600     02  F              PIC  X(004) VALUE "26.5".
001610     02  F              PIC  X(003) VALUE SPACE.
001620     02  F              PIC  X(004) VALUE "27.0".
001630     02  F              PIC  X(003) VALUE SPACE.
001640     02  F              PIC  X(004) VALUE "27.5".
001650     02  F              PIC  X(016) VALUE SPACE.
001660     02  F              PIC  N(004) VALUE NC"　合　計".
001670 01  W-P.
001680     02  P-SOK          PIC  N(006).
001690     02  F              PIC  X(001).
001700     02  P-HCD          PIC  9(006).
001710     02  F              PIC  X(001).
001720     02  P-NAME         PIC  N(024).
001730     02  F              PIC  X(001).
001740     02  P-SIZ          PIC  9(001).
001750     02  P-SUD.
001760       03  P-SU         PIC ---,--9  OCCURS  10 TIMES.
001770     02  P-SUT          PIC ----,--9.
001780 01  W-DATA.
001790     02  W-SNGP.
001800       03  F            PIC  9(002).
001810       03  W-SNEN       PIC  9(002).
001820       03  W-SGET       PIC  9(002).
001830       03  W-SPEY       PIC  9(002).
001840     02  W-ENGP.
001850       03  F            PIC  9(002).
001860       03  W-ENEN       PIC  9(002).
001870       03  W-EGET       PIC  9(002).
001880       03  W-EPEY       PIC  9(002).
001890     02  W-SOK          PIC  9(001).
001900     02  W-HCD          PIC  9(006).
001910     02  W-L            PIC  9(002).
001920     02  CNT            PIC  9(002).
001930     02  W-C            PIC  9(001).
001940     02  CNTD           PIC  9(002).
001950     02  CHK            PIC  9(001).
001960     02  W-GC           PIC  9(002).
001970     02  W-GCD          PIC  9(002).
001980     02  W-PAGE         PIC  9(002) VALUE ZERO.
001990     02  W-NC           PIC  9(001).
002000     02  W-TC           PIC  9(001).
002010     02  W-DMM          PIC  9(001).
002020     02  W-SC           PIC  9(001).
002030     02  W-ZCD.
002040       03  W-ZC    OCCURS   4  PIC  9(001).
002050     02  W-ASUD.
002060       03  W-ASU   OCCURS   4.
002070         04  W-SU    OCCURS  10  PIC S9(005).
002080       03  W-SUT        PIC S9(006).
002090     02  WT-ZCD.
002100       03  WT-ZC   OCCURS   4  PIC  9(001).
002110     02  WT-ASUD.
002120       03  WT-ASU  OCCURS   4.
002130         04  WT-SU   OCCURS  10  PIC S9(005).
002140       03  WT-SUT       PIC S9(006).
002150     02  W-SSD.
002160       03  W-SS    OCCURS  10  PIC  9(001).
002170 01  ERR-STAT           PIC  X(002).
002180 SCREEN SECTION.
002190 SD  C-CRT
002200     END STATUS IS ESTAT.
002210 01  C-CLEAR.
002220     02  C-CL    LINE   1  CLEAR SCREEN.
002230 01  C-MID.
002240     02  LINE   1  COLUMN  10  PIC  N(022) VALUE
002250          NC"＊＊＊　　倉庫品名別　出荷数明細表　　＊＊＊".
002260 01  C-ERR.
002270     02  LINE  24.
002280       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002290       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002300            "***  DATA ﾅｼ  ***".
002310       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
002320            "***  DATA ｴﾗｰ  ***".
002330       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002340       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002350       03  E-CL    COLUMN  10  PIC  X(050) VALUE
002360            "                                                  ".
002370 PROCEDURE DIVISION.
002380 M-05.
002390     DISPLAY C-CLEAR.
002400     DISPLAY C-MID.
002410*
002420     CALL "CBLSTNNO" USING STN-NO.
002430     MOVE STN-NO2 TO W-FID2.
002440     MOVE W-FID TO WK0256ID.
002450     OPEN INPUT JT-WK03.
002460     MOVE ZERO TO W-SNGP W-ENGP.
002470 M-10.
002480     READ JT-WK03 AT END
002490         GO TO M-15.
002500     IF W-SNGP = ZERO
002510         MOVE W03-05 TO W-SNGP
002520       ELSE
002530         IF W03-05 < W-SNGP
002540             MOVE W03-05 TO W-SNGP.
002550     IF W03-05 > W-ENGP
002560         MOVE W03-05 TO W-ENGP.
002570     GO TO M-10.
002580 M-15.
002590     CLOSE JT-WK03.
002600     IF ZERO = W-SNGP AND W-ENGP
002610         DISPLAY E-ME1 E-ME99
002620         GO TO M-95.
002630*
002640     OPEN INPUT JT-WK03.
002650 M-20.
002660     READ JT-WK03 AT END
002670         CLOSE JT-WK03
002680         DISPLAY E-ME2 E-ME99
002690         GO TO M-95.
002700*
002710     ACCEPT H-DATE FROM DATE.
002720     MOVE W-SNEN TO H-SNEN.
002730     MOVE W-SGET TO H-SGET.
002740     MOVE W-SPEY TO H-SPEY.
002750     MOVE W-ENEN TO H-ENEN.
002760     MOVE W-EGET TO H-EGET.
002770     MOVE W-EPEY TO H-EPEY.
002780     OPEN INPUT JCON HI2-M.
002790     OPEN OUTPUT SP-F.
002800     PERFORM S-10 THRU S-15.
002810 M-25.
002820     MOVE W03-07 TO W-SOK.
002830     MOVE 3 TO JCON3-01.
002840     MOVE W-SOK TO JCON3-02.
002850     READ JCON WITH UNLOCK INVALID KEY
002860         MOVE SPACE TO JCON3-03.
002870     MOVE ZERO TO WT-ZCD WT-ASUD CHK.
002880 M-30.
002890     MOVE W03-09 TO W-HCD.
002900     MOVE W-HCD TO HI-MHCD HI-HCD.
002910     READ HI2-M WITH UNLOCK INVALID KEY
002920         MOVE SPACE TO HI-NAME
002930         MOVE NC"　マスター　なし　" TO HI-NAME.
002940     MOVE ZERO TO W-ZCD W-ASUD.
002950 M-35.
002960     PERFORM S-20 THRU S-30.
002970 M-40.
002980     READ JT-WK03 AT END
002990         GO TO M-90.
003000     IF W03-07 NOT = W-SOK
003010         GO TO M-45.
003020     IF W03-09 = W-HCD
003030         GO TO M-35.
003040*
003050     PERFORM S-35 THRU S-70.
003060     GO TO M-30.
003070 M-45.
003080     PERFORM S-35 THRU S-70.
003090     PERFORM S-75 THRU S-95.
003100     GO TO M-25.
003110 M-90.
003120     PERFORM S-35 THRU S-70.
003130     PERFORM S-75 THRU S-95.
003140     CLOSE SP-F.
003150     CLOSE JCON HI2-M.
003160     CLOSE JT-WK03.
003170 M-95.
003180     DISPLAY C-CLEAR.
003190     STOP RUN.
003200 S-05.
003210     MOVE SPACE TO SP-R.
003220     WRITE SP-R AFTER PAGE.
003230 S-10.
003240     ADD 1 TO W-PAGE.
003250     MOVE W-PAGE TO H-PAGE.
003260     MOVE SPACE TO SP-R.
003270     MOVE HEAD1 TO SP-R.
003280     WRITE SP-R.
003290     MOVE SPACE TO SP-R.
003300     MOVE HEAD2 TO SP-R.
003310     WRITE SP-R AFTER 2.
003320     MOVE SPACE TO SP-R.
003330     MOVE HEAD3 TO SP-R.
003340     WRITE SP-R.
003350     MOVE SPACE TO SP-R.
003360     MOVE HEAD4 TO SP-R.
003370     WRITE SP-R.
003380     MOVE SPACE TO SP-R.
003390     MOVE HEAD5 TO SP-R.
003400     WRITE SP-R.
003410     MOVE SPACE TO SP-R.
003420     WRITE SP-R.
003430 S-15.
003440     EXIT.
003450 S-20.
003460     IF W03-10 = 1
003470         MOVE 4 TO W-SC.
003480     IF W03-10 = 2
003490         MOVE 1 TO W-SC.
003500     IF W03-10 = 3
003510         MOVE 2 TO W-SC.
003520     IF W03-10 = 4
003530         MOVE 3 TO W-SC.
003540     MOVE ZERO TO CNTD.
003550 S-25.
003560     ADD 1 TO CNTD.
003570     IF CNTD NOT = 11
003580         ADD W03-1211(CNTD) TO W-SU(W-SC,CNTD)
003590         ADD W03-1211(CNTD) TO WT-SU(W-SC,CNTD)
003600         GO TO S-25.
003610     ADD W03-122 TO W-SUT WT-SUT.
003620 S-30.
003630     EXIT.
003640 S-35.
003650     MOVE ZERO TO W-SC.
003660 S-40.
003670     ADD 1 TO W-SC.
003680     IF W-SC = 5
003690         GO TO S-50.
003700     IF ZERO = W-SU(W-SC,01) AND W-SU(W-SC,02) AND W-SU(W-SC,03)
003710           AND W-SU(W-SC,04) AND W-SU(W-SC,05) AND W-SU(W-SC,06)
003720           AND W-SU(W-SC,07) AND W-SU(W-SC,08) AND W-SU(W-SC,09)
003730           AND W-SU(W-SC,10)
003740         GO TO S-40.
003750     MOVE 1 TO W-ZC(W-SC) WT-ZC(W-SC).
003760     GO TO S-40.
003770 S-50.
003780     IF W-ZCD = ZERO
003790         GO TO S-70.
003800     MOVE ZERO TO W-SC W-NC.
003810 S-55.
003820     ADD 1 TO W-SC.
003830     IF W-SC = 5
003840         MOVE SPACE TO SP-R
003850         WRITE SP-R
003860         GO TO S-70.
003870     IF W-ZC(W-SC) = 0
003880         GO TO S-55.
003890     MOVE ZERO TO W-SSD.
003900     MOVE SPACE TO W-P.
003910     MOVE SPACE TO P-SOK P-NAME.
003920     IF CHK = 0
003930         MOVE 9 TO CHK
003940         MOVE JCON3-03 TO P-SOK.
003950     IF W-NC = 0
003960         MOVE 9 TO W-NC
003970         MOVE W-HCD TO P-HCD
003980         MOVE HI-NAME TO P-NAME.
003990     IF W-SC = 1
004000         MOVE HI-SS2 TO W-SSD
004010         MOVE 2 TO P-SIZ
004020         IF 0 = W-ZC(2) AND W-ZC(3) AND W-ZC(4)
004030             MOVE W-SUT TO P-SUT.
004040     IF W-SC = 2
004050         MOVE HI-SS3 TO W-SSD
004060         MOVE 3 TO P-SIZ
004070         IF 0 = W-ZC(3) AND W-ZC(4)
004080             MOVE W-SUT TO P-SUT.
004090     IF W-SC = 3
004100         MOVE HI-SS4 TO W-SSD
004110         MOVE 0 TO W-SS(10)
004120         MOVE 4 TO P-SIZ
004130         IF 0 = W-ZC(4)
004140             MOVE W-SUT TO P-SUT.
004150     IF W-SC = 4
004160         MOVE HI-SS1 TO W-SSD
004170         MOVE 1 TO P-SIZ
004180         MOVE W-SUT TO P-SUT.
004190     MOVE ZERO TO CNTD.
004200 S-60.
004210     ADD 1 TO CNTD.
004220     IF CNTD = 11
004230         GO TO S-65.
004240     IF W-SS(CNTD) NOT = 0
004250         MOVE W-SU(W-SC,CNTD) TO P-SU(CNTD).
004260     GO TO S-60.
004270 S-65.
004280     IF LINAGE-COUNTER > 60
004290         MOVE JCON3-03 TO P-SOK
004300         MOVE W-HCD TO P-HCD
004310         MOVE HI-NAME TO P-NAME
004320         PERFORM S-05 THRU S-15.
004330     MOVE SPACE TO SP-R.
004340     MOVE W-P TO SP-R.
004350     WRITE SP-R.
004360     MOVE SPACE TO SP-R.
004370     GO TO S-55.
004380 S-70.
004390     EXIT.
004400 S-75.
004410     MOVE ZERO TO W-SC W-NC.
004420 S-80.
004430     ADD 1 TO W-SC.
004440     IF W-SC = 5
004450         MOVE SPACE TO SP-R
004460         WRITE SP-R AFTER 2
004470         GO TO S-95.
004480     IF WT-ZC(W-SC) = 0
004490         GO TO S-80.
004500     MOVE SPACE TO W-P.
004510     MOVE SPACE TO P-SOK P-NAME.
004520     IF W-NC = 0
004530         MOVE 9 TO W-NC
004540         MOVE NC"　　　　　（　合　計　）　" TO P-NAME.
004550     IF W-SC = 1
004560         MOVE 2 TO P-SIZ
004570         IF 0 = WT-ZC(2) AND WT-ZC(3) AND WT-ZC(4)
004580             MOVE WT-SUT TO P-SUT.
004590     IF W-SC = 2
004600         MOVE 3 TO P-SIZ
004610         IF 0 = WT-ZC(3) AND WT-ZC(4)
004620             MOVE WT-SUT TO P-SUT.
004630     IF W-SC = 3
004640         MOVE 4 TO P-SIZ
004650         IF 0 = WT-ZC(4)
004660             MOVE WT-SUT TO P-SUT.
004670     IF W-SC = 4
004680         MOVE 1 TO P-SIZ
004690         MOVE WT-SUT TO P-SUT.
004700     MOVE ZERO TO CNTD.
004710 S-85.
004720     ADD 1 TO CNTD.
004730     IF CNTD = 11
004740         GO TO S-90.
004750     IF W-SC = 2
004760         IF CNTD > 9
004770             GO TO S-85.
004780     IF W-SC = 3
004790         IF CNTD > 8
004800             GO TO S-85.
004810     IF WT-SU(W-SC,CNTD) NOT = ZERO
004820         MOVE WT-SU(W-SC,CNTD) TO P-SU(CNTD).
004830     GO TO S-85.
004840 S-90.
004850     IF LINAGE-COUNTER > 60
004860         MOVE JCON3-03 TO P-SOK
004870         MOVE NC"　　　　　（　合　計　）　" TO P-NAME
004880         PERFORM S-05 THRU S-15.
004890     MOVE SPACE TO SP-R.
004900     MOVE W-P TO SP-R.
004910     WRITE SP-R.
004920     MOVE SPACE TO SP-R.
004930     GO TO S-80.
004940 S-95.
004950     EXIT.
