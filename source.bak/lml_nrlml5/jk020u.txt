000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JK020U.
000030******************************************************************
000040*    éÛêMÉfÅ[É^çXêV                                              *
000050*    ÇQÇOÇOÇTÅ^ÇOÇXÅ^ÇOÇP                                        *
000060*    T.ISHISHITA                                                 *
000070*    JS-SIGN  :  0=ã ìá , 1=ëÅìá                                 *
000080******************************************************************
000090 ENVIRONMENT       DIVISION.
000100 CONFIGURATION     SECTION.
000110 SOURCE-COMPUTER.  SYSTEM3100.
000120 OBJECT-COMPUTER.  SYSTEM3100.
000130 INPUT-OUTPUT      SECTION.
000140 FILE-CONTROL.
000150     SELECT   CHKF           ASSIGN    TO   CHK-MSD.              ++++++++
000160*----<ÇnÅ^ÇkéÛêMÇe>----*
000170*****SELECT    KOLRF     ASSIGN    TO    KOLRF-RDB                D.091002
000180     SELECT    JOLSF     ASSIGN    TO    JOLSF-MSD                I.091002
000190                         ORGANIZATION    SEQUENTIAL
000200                         FILE  STATUS    ERR-STAT.
000210*----<ÇnÅ^ÇkèÛãµÇe>----*
000220*****SELECT    JOJF      ASSIGN    TO    JOJ-RDB                  D.091002
000230*****                    ORGANIZATION    INDEXED                  D.091002
000240*****                    ACCESS  MODE    DYNAMIC                  D.091002
000250*****                    RECORD   KEY    JOJF-KEY                 D.091002
000260*****                    FILE  STATUS    ERR-STAT.                D.091002
000270*----<ÉRÉìÉgÉçÅ[ÉãÇe>----*
000280*****SELECT    JCON      ASSIGN    TO    CON-RDB                  D.091002
000290*****                    ORGANIZATION    INDEXED                  D.091002
000300*****                    ACCESS  MODE    DYNAMIC                  D.091002
000310*****                    RECORD   KEY    JCON1-KEY                D.091002
000320*****                    FILE  STATUS    ERR-STAT.                D.091002
000330*----<íºëóêÊÉ}ÉXÉ^>----*
000340*****SELECT    TC-M      ASSIGN    TO    TCM-RDB                  D.091002
000350*****                    ORGANIZATION    INDEXED                  D.091002
000360*****                    ACCESS  MODE    DYNAMIC                  D.091002
000370*****                    RECORD   KEY    TC-KEY                   D.091002
000380*****                    FILE  STATUS    ERR-STAT.                D.091002
000390*----<ïiñºÉ}ÉXÉ^>----*
000400*****SELECT    HI2-M     ASSIGN    TO    HI2-RDB                  D.091002
000410*****                    ORGANIZATION    INDEXED                  D.091002
000420*****                    ACCESS  MODE    DYNAMIC                  D.091002
000430*****                    RECORD   KEY    HI-KEY2                  D.091002
000440*****                    FILE  STATUS    ERR-STAT.                D.091002
000450*----<ÉèÅ[ÉNÉ}ÉììXñºÇe>----*
000460*****SELECT    WTNAF     ASSIGN    TO    WTNA-RDB                 D.091002
000470*****                    ORGANIZATION    INDEXED                  D.091002
000480*****                    ACCESS  MODE    DYNAMIC                  D.091002
000490*****                    RECORD   KEY    WTNA-KEY                 D.091002
000500*****                    FILE  STATUS    ERR-STAT.                D.091002
000510*----<èoâ◊éwê}ÉgÉâÉì>----*
000520*****SELECT    JSTR      ASSIGN    TO    JST-RDB                  D.091002
000530     SELECT    JSTR      ASSIGN    TO    JST-MSD                  I.091002
000540                         ORGANIZATION    INDEXED
000550                         ACCESS  MODE    DYNAMIC
000560                         RECORD   KEY    JSTR-KEY
000570                         FILE  STATUS    ERR-STAT.
000580*----<â◊éDÉgÉâÉì>----*
000590*****SELECT    JNIF      ASSIGN    TO    JNI-RDB                  D.091002
000600     SELECT    JNIF      ASSIGN    TO    JNI-MSD                  I.091002
000610                         ORGANIZATION    INDEXED
000620                         ACCESS  MODE    DYNAMIC
000630                         RECORD   KEY    JNIF1-KEY
000640                         FILE  STATUS    ERR-STAT.
000650*----<ëóÇËèÛÇe>----*
000660*****SELECT    OKJF      ASSIGN    TO    OKJ-RDB                  D.091002
000670     SELECT    OKJF      ASSIGN    TO    OKJ-MSD                  I.091002
000680                         ORGANIZATION    INDEXED
000690                         ACCESS  MODE    DYNAMIC
000700                         RECORD   KEY    OKJF-KEY
000710                         FILE  STATUS    ERR-STAT.
000720*----<ìùàÍì`ï[Çe(ÉèÅ[ÉNÉ}Éì)>----*
000730*****SELECT    TDNWF     ASSIGN    TO    TDNW-RDB                 D.091002
000740     SELECT    TDNWF     ASSIGN    TO    TDNW-MSD                 I.091002
000750                         ORGANIZATION    INDEXED
000760                         ACCESS  MODE    DYNAMIC
000770                         RECORD   KEY    TDNW1-KEY
000780                         FILE  STATUS    ERR-STAT.
000790*----<ìùàÍì`ï[Çe(ÉiÉtÉR)>----*
000800*****SELECT    TDNNF     ASSIGN    TO    TDNN-RDB                 D.091002
000810     SELECT    TDNNF     ASSIGN    TO    TDNN-MSD                 I.091002
000820                         ORGANIZATION    INDEXED
000830                         ACCESS  MODE    DYNAMIC
000840                         RECORD   KEY    TDNN1-KEY
000850                         FILE  STATUS    ERR-STAT.
000860*----<ìùàÍì`ï[Çe(ÉgÉâÉXÉRëºì¸óÕ)>----*
000870*****SELECT    TDIF      ASSIGN    TO    TDI-RDB                  D.091002
000880     SELECT    TDIF      ASSIGN    TO    TDI-MSD                  D.091002
000890                         ORGANIZATION    INDEXED                  I.080407
000900                         ACCESS  MODE    DYNAMIC                  I.080407
000910                         RECORD   KEY    TDI-KEY                  I.080407
000920                         FILE  STATUS    ERR-STAT.                I.080407
000930*----<ìùàÍì`ï[Çe(ê‘ÇøÇ·ÇÒñ{ï‹)>----*                              I.091222
000940     SELECT    TDNAF     ASSIGN    TO    TDNA-MSD                 I.091222
000950                         ORGANIZATION    INDEXED                  I.091222
000960                         ACCESS  MODE    DYNAMIC                  I.091222
000970                         RECORD   KEY    TDNA-KEY                 I.091222
000980                         FILE  STATUS    ERR-STAT.                I.091222
000990*----<ä¬ã´ê›íËÇe>----*
001000*****SELECT    KANF      ASSIGN    TO    KANF-RDB                 D.091002
001010*****                    ORGANIZATION    RELATIVE                 D.091002
001020*****                    ACCESS  MODE    DYNAMIC                  D.091002
001030*****                    RELATIVE KEY    KANF-KEY.                D.091002
001040*
001050 I-O-CONTROL.
001060     APPLY   SHARED-MODE     ON  CHKF                             ++++++++
001070     APPLY  SHARED-MODE  ON  JSTR                                 I.091002
001080                             JNIF OKJF TDNWF TDNNF TDIF  TDNAF.   I.091222
001090*****                        JNIF OKJF TDNWF TDNNF TDIF.          D.091222
001100*****APPLY  SHARED-MODE  ON  JOJF JCON TC-M  HI2-M WTNAF JSTR     D.091002
001110*****                        JNIF OKJF TDNWF TDNNF TDIF  KANF.    D.091002
001120*****APPLY  SHARED-MODE  ON  JOJF JCON TC-M  HI2-M JSTR           D.080407
001130*****                        JNIF OKJF TDNWF TDNNF KANF.          D.080407
001140*
001150 DATA              DIVISION.
001160*
001170 FILE              SECTION.
001180 FD  CHKF                                                         ++++++++
001190     BLOCK 16 RECORDS                                             ++++++++
001200     LABEL RECORD IS STANDARD                                     ++++++++
001210     VALUE OF IDENTIFICATION "T-CHKF".                            ++++++++
001220 01  CHKF-R.                                                      ++++++++
001230     02  CHKF-DATE    PIC 9(06).                                  ++++++++
001240     02  CHKF-TIME    PIC 9(04).                                  ++++++++
001250     02  CHKF-SIGN    PIC 9(01).                                  ++++++++
001260     02  CHKF-SEN     PIC 9(01).                                  ++++++++
001270     02  CHKF-DMM     PIC 9(01).                                  ++++++++
001280     02  CHKF-PRG     PIC X(03).                                  ++++++++
001290     COPY    L-JOSF.                                              I.091002
001300*****COPY    L-KORF.                                              D.091002
001310*****COPY    L-JOJF.                                              D.091002
001320*****COPY    L-JCON.                                              D.091002
001330*****COPY    LITCM.                                               D.091002
001340*****COPY    LIHIM2.                                              D.091002
001350     COPY    L-JSTR.
001360     COPY    L-JNIF.
001370     COPY    LOKJF.
001380     COPY    LITDNW.
001390     COPY    LITDNN.
001400     COPY    LITDIF.                                              I.091002
001410     COPY    LITDNA.                                              I.091222
001420*****COPY    L-TDIF.                                              D.091002
001430*****COPY    L-KANF.                                              D.091002
001440*FD  WTNAF                                                        D.091002
001450*****BLOCK  4 RECORDS                                             D.091002
001460*****LABEL RECORD IS STANDARD                                     D.091002
001470*****VALUE OF IDENTIFICATION "WTNAF".                             D.091002
001480*01  WTNA-R.                                                      D.091002
001490*****02  WTNA-KEY.                                                D.091002
001500*****  03  WTNA-TNC     PIC  9(003).                              D.091002
001510*****02  WTNA-NAME      PIC  N(026).                              D.091002
001520*****02  WTNA-BSC       PIC  9(001).                              D.091002
001530*****02  F              PIC  X(008).                              D.091002
001540*
001550 WORKING-STORAGE   SECTION.
001560*----< ‹∞∏ ¥ÿ± >----*
001570 01  END-STS-WK.
001580   02  PF9         PIC X(02)   VALUE "P9".
001590   02  HTAB        PIC X(02)   VALUE "01".
001600 77  KAKU-W        PIC X(01).
001610 77  NN            PIC 9(02).
001620 77  NN-W          PIC 9(02).
001630 77  ERR-STAT      PIC X(02).
001640 77  END-SW        PIC 9(01)   VALUE  0.
001650 01  NC-WK.
001660   02  NC-01       PIC N(08)   VALUE  NC"éÛêMÉfÅ[É^Å@ÉiÉV".
001670   02  NC-02       PIC N(03)   VALUE  NC"éÛêMíÜ".
001680 01  ERR-WK        PIC N(20).
001690 01  JS-SIGN       PIC 9(01).
001700 01  W-SKM         PIC N(06).                                     I.091002
001710 01  W-DATA.                                                      ++++++++
001720     03  W-TIM               PIC  9(08).                          ++++++++
001730     03  W-TIMD  REDEFINES W-TIM.                                 ++++++++
001740       04  W-TIME            PIC  9(04).                          ++++++++
001750       04  F                 PIC  9(04).                          ++++++++
001760*01  REL-KEY.                                                     D.091002
001770*****02  KANF-KEY  PIC 9(6).                                      D.091002
001780*-------------------*
001790     COPY    LWMSG.
001800*
001810 SCREEN            SECTION.
001820 SD  GAMEN    END  STATUS  END-STS.
001830 01  DSP-CLR  LINE  1.
001840   02  CLEAR  SCREEN.
001850 01  DSP-HYOJI.
001860   02  LINE  1     COLUMN 20   PIC N(15)  VALUE                   I.091002
001870           NC"ÅñÅñÅñÅ@éÛêMÉfÅ[É^çXêVÅ@ÅñÅñÅñ".                    I.091002
001880***02  LINE  1     COLUMN 20   PIC N(16)  VALUE                   D.091002
001890*****      NC"ÅñÅñÅ@ÇnÅ^ÇkéÛêMÉfÅ[É^çXêVÅ@ÅñÅñ".                  D.091002
001900   02  LINE 24.
001910*****03            COLUMN 42   PIC N(02)  VALUE NC"ämîF".         D.100408
001920     03            COLUMN 29   PIC N(02)  VALUE NC"ämîF".         I.100408
001930     03            COLUMN 35   PIC X(15)  VALUE "OK=ÿ¿∞› , NO=F9".I.100408
001940     03            COLUMN 52   PIC X(01)  VALUE "(".
001950     03            COLUMN 54   PIC X(01)  VALUE ")".
001960*  02  LINE 04     COLUMN 15  VALUE
001970*      "***************************************************".
001980*  02  LINE 05     COLUMN 15  PIC X(01)  VALUE "*".
001990*  02  LINE 05     COLUMN 65  PIC X(01)  VALUE "*".
002000*  02  LINE 06     COLUMN 15  PIC X(01)  VALUE "*".
002010*  02  LINE 06     COLUMN 65  PIC X(01)  VALUE "*".
002020*  02  LINE 07     COLUMN 15  PIC X(01)  VALUE "*".
002030*  02  LINE 07     COLUMN 65  PIC X(01)  VALUE "*".
002040*  02  LINE 07     COLUMN 18  PIC N(23)  VALUE
002050*      NC"ÅwÉIÉìÉâÉCÉìê⁄ë±ÇeÇcÅEê≥ÅxÇÉZÉbÉgÇµÇƒâ∫Ç≥Ç¢ÅB".
002060*  02  LINE 08     COLUMN 15  PIC X(01)  VALUE "*".
002070*  02  LINE 08     COLUMN 65  PIC X(01)  VALUE "*".
002080*  02  LINE 09     COLUMN 15  PIC X(01)  VALUE "*".
002090*  02  LINE 09     COLUMN 65  PIC X(01)  VALUE "*".
002100*  02  LINE 10     COLUMN 15  VALUE
002110*      "***************************************************".
002120 01  ACP-KAKU.
002130   02  LINE 24     COLUMN 53   PIC X(01)  INTO  KAKU-W.
002140 01  DSP-SKM.                                                     I.091002
002150   02  LINE 12     COLUMN 30   PIC N(06)  INTO  W-SKM.            I.091002
002160 01  DSP-ERRMSG    LINE 24.
002170   02              COLUMN  1   PIC N(20)  FROM  ERR-WK.
002180   02              COLUMN  1   PIC X(05)  VALUE " "
002190                                                BUZZER
002200                                                WAIT.
002210   02              COLUMN  1   PIC X(40)  VALUE " ".
002220*-------------------*
002230     COPY    LSERR.
002240*
002250*==============================================================*
002260 PROCEDURE         DIVISION.
002270*--------------------------------------------------------------*
002280*    “ ≤ ›  Ÿ ∞ ¡ ›                                            *
002290*--------------------------------------------------------------*
002300 MAINLINE-ROUTINE.
002310     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
002320     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
002330     PERFORM  READ-RTN  THRU  READ-RTN-EXIT.
002340     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
002350         UNTIL  END-SW  =  9.
002360*
002370     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
002380     PERFORM  ENDR-RTN  THRU  ENDR-RTN-EXIT.
002390*
002400*****OPEN  I-O       KANF.                                        D.091002
002410*****MOVE  1     TO  KANF-KEY.                                    D.091002
002420*****READ     KANF          INVALID                               D.091002
002430*****         CLOSE         KANF                                  D.091002
002440*****         STOP  RUN.                                          D.091002
002450*****MOVE  ZERO  TO  KANF-07.                                     D.091002
002460*****REWRITE  KANF-REC      INVALID                               D.091002
002470*****         CLOSE         KANF                                  D.091002
002480*****         STOP  RUN.                                          D.091002
002490*****CLOSE           KANF.                                        D.091002
002500*
002510 MAINLINE-END.
002520     STOP RUN.
002530*--------------------------------------------------------------*
002540*    I N I T  -  R T N                                         *
002550*--------------------------------------------------------------*
002560 INIT-RTN.
002570*****OPEN  I-O       KANF.                                        D.091002
002580*****MOVE  1     TO  KANF-KEY.                                    D.091002
002590*****READ     KANF          INVALID                               D.091002
002600*****         CLOSE         KANF                                  D.091002
002610*****         STOP  RUN.                                          D.091002
002620*****MOVE  255   TO  KANF-07.                                     D.091002
002630*****REWRITE  KANF-REC      INVALID                               D.091002
002640*****         CLOSE         KANF                                  D.091002
002650*****         STOP  RUN.                                          D.091002
002660*****CLOSE           KANF.                                        D.091002
002670*
002680*****MOVE  ZERO    TO  JS-SIGN.                                   D.091002
002690     ACCEPT  JS-SIGN.                                             I.091002
002700     IF  JS-SIGN      >  1     STOP  RUN.                         I.091002
002710*
002720     DISPLAY  DSP-CLR.
002730     DISPLAY  DSP-HYOJI.
002740     IF  JS-SIGN      =  0                                        I.091002
002750         MOVE  NC"Åyã Å@ìáÅzÅ@"  TO  W-SKM                        I.091002
002760     ELSE                                                         I.091002
002770         MOVE  NC"ÅyëÅÅ@ìáÅzÅ@"  TO  W-SKM.                       I.091002
002780     DISPLAY  DSP-SKM.                                            I.091002
002790 INIT-010.
002800     ACCEPT   ACP-KAKU.
002810     IF  END-STS      =  PF9   STOP  RUN.
002820     IF  END-STS  NOT =  HTAB  GO TO INIT-010.
002830     OPEN    EXTEND     CHKF.                                     ++++++++
002840     ACCEPT  W-TIM      FROM  TIME.                               ++++++++
002850     INITIALIZE  CHKF-R.                                          ++++++++
002860     ACCEPT  CHKF-DATE  FROM  DATE.                               ++++++++
002870     MOVE    W-TIME     TO    CHKF-TIME.                          ++++++++
002880     MOVE    JS-SIGN    TO    CHKF-SIGN.                          ++++++++
002890     MOVE    8          TO    CHKF-SEN.                           ++++++++
002900     MOVE    "20U"      TO    CHKF-PRG.                           ++++++++
002910     WRITE   CHKF-R.                                              ++++++++
002920     CLOSE              CHKF.                                     ++++++++
002930*----< O/LºﬁÆ≥∑Æ≥F OPEN & READ >----*
002940*****IF  JS-SIGN  =  1                   GO  TO  INIT-RTN-EXIT.   D.091002
002950*****OPEN  I-O  JOJF.                                             D.091002
002960*****MOVE  "0002"  TO  JOJF-01.                                   D.091002
002970*****READ   JOJF   UNLOCK  INVALID  KEY                           D.091002
002980*****              MOVE  NC-01  TO  ERR-WK                        D.091002
002990*****              DISPLAY  DSP-ERRMSG                            D.091002
003000*****              CLOSE   JOJF                                   D.091002
003010*****              STOP    RUN.                                   D.091002
003020*****IF  JOJF-061  =  0                                           D.091002
003030*****    MOVE  ZERO  TO  NN-W                                     D.091002
003040*****    PERFORM  ZERO-RTN  THRU  ZERO-RTN-EXIT                   D.091002
003050*****        VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10        D.091002
003060*****    IF  NN-W  =  0                                           D.091002
003070*****              MOVE  NC-01  TO  ERR-WK                        D.091002
003080*****              DISPLAY  DSP-ERRMSG                            D.091002
003090*****              CLOSE   JOJF                                   D.091002
003100*****              STOP    RUN.                                   D.091002
003110*****IF  JOJF-061  =  6                                           D.091002
003120*****              MOVE  NC-02  TO  ERR-WK                        D.091002
003130*****              DISPLAY  DSP-ERRMSG                            D.091002
003140*****              CLOSE   JOJF                                   D.091002
003150*****              STOP    RUN.                                   D.091002
003160*****CLOSE      JOJF.                                             D.091002
003170 INIT-RTN-EXIT.
003180     EXIT.
003190*--------------------------------------------------------------*
003200*    P R O C  -  R T N                                         *
003210*--------------------------------------------------------------*
003220 PROC-RTN.
003230 PROC-010.
003240*****IF  KOLRF1-01  =  1                                          D.091002
003250*----< ∫›ƒ€∞ŸF ∫≥º›ºÆÿ >----*
003260*****    MOVE  KOLRF1-02  TO  JCON1-01                            D.091002
003270*****    MOVE  KOLRF1-03  TO  JCON1-02                            D.091002
003280*****    PERFORM  UPD1-RTN  THRU  UPD1-RTN-EXIT.                  D.091002
003290*****IF  KOLRF2-01  =  2                                          D.091002
003300*----< ¡Æ∏ø≥ª∑M ∫≥º›ºÆÿ >----*
003310*****    MOVE  KOLRF2-02  TO  TC-TCD                              D.091002
003320*****    MOVE  KOLRF2-03  TO  TC-CCD                              D.091002
003330*****    PERFORM  UPD2-RTN  THRU  UPD2-RTN-EXIT.                  D.091002
003340*****IF  KOLRF3-01  =  3                                          D.091002
003350*----< À›“≤M ∫≥º›ºÆÿ >----*
003360*****    MOVE  KOLRF3-MHCD TO HI-MHCD                             D.091002
003370*****    MOVE  KOLRF3-HCD TO HI-HCD                               D.091002
003380*****    PERFORM  UPD3-RTN  THRU  UPD3-RTN-EXIT.                  D.091002
003390*****IF  KOLRF3-01  =  4                                          D.091002
003400*----< ‹∞∏œ›√›“≤M ∫≥º›ºÆÿ >----*
003410*****    MOVE  KOLRF4-02   TO WTNA-KEY                            D.091002
003420*****    PERFORM  UPD4-RTN  THRU  UPD4-RTN-EXIT.                  D.091002
003430*****IF  KOLRF11-01  =  11                                        D.091002
003440     IF  JOLSF11-01  =  11                                        I.091002
003450*----< º≠Ø∂ªºΩﬁT ∫≥º›ºÆÿ >----*
003460*****    MOVE  KOLRF11-02  TO  JSTR-01                            D.091002
003470*****    MOVE  KOLRF11-03  TO  JSTR-02                            D.091002
003480         MOVE  JOLSF11-02  TO  JSTR-01                            I.091002
003490         MOVE  JOLSF11-03  TO  JSTR-02                            I.091002
003500         PERFORM  UPD5-RTN  THRU  UPD5-RTN-EXIT.
003510*****IF  KOLRF11-01  =  12                                        D.091002
003520     IF  JOLSF11-01  =  12                                        I.091002
003530*----< ∆Ã¿ﬁT ∫≥º›ºÆÿ >----*
003540*****    MOVE  KOLRF121-01  TO  JNIF1-01                          D.091002
003550*****    MOVE  KOLRF121-02  TO  JNIF1-02                          D.091002
003560         MOVE  JOLSF121-01  TO  JNIF1-01                          I.091002
003570         MOVE  JOLSF121-02  TO  JNIF1-02                          I.091002
003580         PERFORM  UPD6-RTN  THRU  UPD6-RTN-EXIT.
003590*****IF  KOLRF13-01  =  13                                        D.091002
003600     IF  JOLSF13-01  =  13                                        I.091002
003610*----< µ∏ÿºﬁÆ≥F ∫≥º›ºÆÿ >----*
003620         PERFORM  UPD7-RTN  THRU  UPD7-RTN-EXIT
003630             VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  4.
003640*****IF  KOLRF14-01  =  14                                        D.091002
003650     IF  JOLSF14-01  =  14                                        I.091002
003660*----< ƒ≥≤¬√ﬁ›ÀﬂÆ≥(‹∞∏œ›)>----*
003670*****    MOVE  KOLRF141-KEY TO  TDNW1-KEY                         D.091002
003680         MOVE  JOLSF141-KEY TO  TDNW1-KEY                         I.091002
003690         PERFORM  UPD8-RTN  THRU  UPD8-RTN-EXIT.
003700*****IF  KOLRF15-01  =  15                                        D.091002
003710     IF  JOLSF15-01  =  15                                        I.091002
003720*----< ƒ≥≤¬√ﬁ›ÀﬂÆ≥(≈Ã∫)>----*
003730*****    MOVE  KOLRF151-KEY TO  TDNN1-KEY                         D.091002
003740         MOVE  JOLSF151-KEY TO  TDNN1-KEY                         I.091002
003750         PERFORM  UPD9-RTN  THRU  UPD9-RTN-EXIT.
003760*****IF  KOLRF16-01  =  16                                        D.091002
003770     IF  JOLSF16-01  =  16                                        I.091002
003780*----< ƒ≥≤¬√ﬁ›ÀﬂÆ≥(ƒ◊Ω∫)>----*
003790*****    MOVE  KOLRF16-KEY  TO  TDI-KEY                           D.091002
003800         MOVE  JOLSF16-KEY  TO  TDI-KEY                           I.091002
003810         PERFORM  UPD10-RTN  THRU  UPD10-RTN-EXIT.                I.080407
003820     IF  JOLSF16-01  =  17                                        I.091002
003830*----< ƒ≥≤¬√ﬁ›ÀﬂÆ≥(±∂¡¨›Œ›Œﬂ)>----*
003840         MOVE  JOLSF17-KEY  TO  TDNA-KEY                          I.091222
003850         PERFORM  UPD11-RTN  THRU  UPD11-RTN-EXIT.                I.091222
003860*
003870     PERFORM  READ-RTN  THRU  READ-RTN-EXIT.
003880 PROC-RTN-EXIT.
003890     EXIT.
003900*--------------------------------------------------------------*
003910*ZERO-RTN.                                                        D.091002
003920*****IF  JOJF-10(NN)  NOT =  ZERO                                 D.091002
003930*****    MOVE   1  TO  NN-W                                       D.091002
003940*****    MOVE  10  TO  NN.                                        D.091002
003950*ZERO-RTN-EXIT.                                                   D.091002
003960*****EXIT.                                                        D.091002
003970*--------------------------------------------------------------*
003980*    R E A D  -  R T N                                         *
003990*--------------------------------------------------------------*
004000 READ-RTN.
004010     READ    JOLSF     AT  END   MOVE  9  TO  END-SW.             I.091002
004020*****READ    KOLRF     AT  END   MOVE  9  TO  END-SW.             D.091002
004030*
004040*DEBGDISPLAY KOLRF1-01.
004050 READ-RTN-EXIT.
004060     EXIT.
004070*--------------------------------------------------------------*
004080*    Ã ß ≤ Ÿ  ∫ ≥ º ›  º Æ ÿ                                   *
004090*--------------------------------------------------------------*
004100*====<  U P D 1  -  R T N  >====*
004110*UPD1-RTN.                                                        D.091002
004120*****READ   JCON     INVALID  KEY                                 D.091002
004130*****                PERFORM  WRT1-RTN  THRU  WRT1-RTN-EXIT       D.091002
004140*****                GO TO UPD1-RTN-EXIT.                         D.091002
004150*****PERFORM  REW1-RTN  THRU  REW1-RTN-EXIT.                      D.091002
004160*UPD1-RTN-EXIT.                                                   D.091002
004170*****EXIT.                                                        D.091002
004180*====<  U P D 2  -  R T N  >====*
004190*UPD2-RTN.                                                        D.091002
004200*****READ   TC-M     INVALID  KEY                                 D.091002
004210*****                PERFORM  WRT2-RTN  THRU  WRT2-RTN-EXIT       D.091002
004220*****                GO TO UPD2-RTN-EXIT.                         D.091002
004230*****IF  KOLRF2-12  =  3                                          D.091002
004240*****                PERFORM  DLT2-RTN  THRU  DLT2-RTN-EXIT       D.091002
004250*****ELSE            PERFORM  REW2-RTN  THRU  REW2-RTN-EXIT.      D.091002
004260*UPD2-RTN-EXIT.                                                   D.091002
004270*****EXIT.                                                        D.091002
004280*====<  U P D 3  -  R T N  >====*
004290*UPD3-RTN.                                                        D.091002
004300*****READ   HI2-M    INVALID  KEY                                 D.091002
004310*****                PERFORM  WRT3-RTN  THRU  WRT3-RTN-EXIT       D.091002
004320*****                GO TO UPD3-RTN-EXIT.                         D.091002
004330*****IF  KOLRF3-10  =  3                                          D.091002
004340*****                PERFORM  DLT3-RTN  THRU  DLT3-RTN-EXIT       D.091002
004350*****ELSE            PERFORM  REW3-RTN  THRU  REW3-RTN-EXIT.      D.091002
004360*UPD3-RTN-EXIT.                                                   D.091002
004370*****EXIT.                                                        D.091002
004380*====<  U P D 4  -  R T N  >====*
004390*UPD4-RTN.                                                        D.091002
004400*****READ   WTNAF    INVALID  KEY                                 D.091002
004410*****                PERFORM  WRT4-RTN  THRU  WRT4-RTN-EXIT       D.091002
004420*****                GO TO UPD4-RTN-EXIT.                         D.091002
004430*****IF  KOLRF4-10  =  3                                          D.091002
004440*****                PERFORM  DLT4-RTN  THRU  DLT4-RTN-EXIT       D.091002
004450*****ELSE            PERFORM  REW4-RTN  THRU  REW4-RTN-EXIT.      D.091002
004460*UPD4-RTN-EXIT.                                                   D.091002
004470*****EXIT.                                                        D.091002
004480*====<  U P D 5  -  R T N  >====*
004490 UPD5-RTN.
004500     READ   JSTR     INVALID  KEY
004510                     PERFORM  WRT5-RTN  THRU  WRT5-RTN-EXIT.
004520 UPD5-RTN-EXIT.
004530     EXIT.
004540*====<  U P D 6  -  R T N  >====*
004550 UPD6-RTN.
004560     READ   JNIF     INVALID  KEY
004570                     PERFORM  WRT6-RTN  THRU  WRT6-RTN-EXIT.
004580*****IF  KOLRF121-21  =  ZERO  OR  SPACE                          D.091124
004590     IF  JOLSF121-21  =  ZERO  OR  SPACE                          I.091124
004600                         GO TO UPD6-RTN-EXIT.
004610*****MOVE  KOLRF121-21  TO  JNIF1-01.                             D.091124
004620*****MOVE  KOLRF121-22  TO  JNIF1-02.                             D.091124
004630     MOVE  JOLSF121-21  TO  JNIF1-01.                             I.091124
004640     MOVE  JOLSF121-22  TO  JNIF1-02.                             I.091124
004650     READ   JNIF     INVALID  KEY
004660                     PERFORM  WRT6-RTN2 THRU  WRT6-RTN2-EXIT.
004670 UPD6-RTN-EXIT.
004680     EXIT.
004690*====<  U P D 7  -  R T N  >====*
004700 UPD7-RTN.
004710*****IF  KOLRF13-02(NN)  =  ZERO  OR  SPACE                       D.091002
004720     IF  JOLSF13-02(NN)  =  ZERO  OR  SPACE                       I.091002
004730                               GO TO UPD7-RTN-EXIT.
004740*****MOVE   KOLRF13-02(NN)  TO  OKJF-01.                          D.091002
004750     MOVE   JOLSF13-02(NN)  TO  OKJF-01.                          I.091002
004760     READ   OKJF     INVALID  KEY
004770                     PERFORM  WRT7-RTN  THRU  WRT7-RTN-EXIT.
004780 UPD7-RTN-EXIT.
004790     EXIT.
004800*====<  U P D 8  -  R T N  >====*
004810 UPD8-RTN.
004820     READ   TDNWF    INVALID  KEY
004830                     PERFORM  WRT8-RTN  THRU  WRT8-RTN-EXIT.
004840 UPD8-RTN-EXIT.
004850     EXIT.
004860*====<  U P D 9  -  R T N  >====*
004870 UPD9-RTN.
004880     READ   TDNNF    INVALID  KEY
004890                     PERFORM  WRT9-RTN  THRU  WRT9-RTN-EXIT.
004900 UPD9-RTN-EXIT.
004910     EXIT.
004920*====<  U P D 10 -  R T N  >====*
004930 UPD10-RTN.                                                       I.080407
004940     READ   TDIF     INVALID  KEY                                 I.080407
004950                     PERFORM  WRT10-RTN THRU  WRT10-RTN-EXIT.     I.080407
004960 UPD10-RTN-EXIT.                                                  I.080407
004970     EXIT.                                                        I.080407
004980*====<  U P D 11 -  R T N  >====*
004990 UPD11-RTN.                                                       I.091222
005000     READ   TDNAF    INVALID  KEY                                 I.091222
005010                     PERFORM  WRT11-RTN THRU  WRT11-RTN-EXIT.     I.091222
005020 UPD11-RTN-EXIT.                                                  I.091222
005030     EXIT.                                                        I.091222
005040*--------------------------------------------------------------*
005050*WRT1-RTN.                                                        D.091002
005060*****MOVE  SPACE       TO  JCON1-R.                               D.091002
005070*****INITIALIZE            JCON1-R.                               D.091002
005080*****MOVE  KOLRF1-02   TO  JCON1-01.                              D.091002
005090*****MOVE  KOLRF1-03   TO  JCON1-02.                              D.091002
005100*****MOVE  KOLRF1-04   TO  JCON2-03.                              D.091002
005110*****WRITE  JCON1-R    INVALID  KEY                               D.091002
005120*****                  MOVE  "JCON"       TO    ERR-F             D.091002
005130*****                  MOVE  "W"          TO    ERR-M             D.091002
005140*****                  MOVE   JCON1-KEY   TO    ERR-K             D.091002
005150*****                  MOVE   0           TO    ERR-LIN           D.091002
005160*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
005170*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
005180***********************MOVE  255    TO    COMPLETION-CODE
005190*****                  STOP  RUN.                                 D.091002
005200*WRT1-RTN-EXIT.                                                   D.091002
005210*****EXIT.                                                        D.091002
005220*--------------------------------------------------------------*
005230*WRT2-RTN.                                                        D.091002
005240*****IF  KOLRF2-12  =  3     GO TO WRT2-RTN-EXIT.                 D.091002
005250*****MOVE  SPACE       TO  TC-R.                                  D.091002
005260*****INITIALIZE            TC-R.                                  D.091002
005270*****MOVE  KOLRF2-02   TO  TC-TCD.                                D.091002
005280*****MOVE  KOLRF2-03   TO  TC-CCD.                                D.091002
005290*****MOVE  KOLRF2-04   TO  TC-NAME.                               D.091002
005300*****MOVE  KOLRF2-05   TO  TC-JSU.                                D.091002
005310*****MOVE  KOLRF2-06   TO  TC-JSS.                                D.091002
005320*****MOVE  KOLRF2-07   TO  TC-UNO.                                D.091002
005330*****MOVE  KOLRF2-08   TO  TC-TEL.                                D.091002
005340*****MOVE  KOLRF2-09   TO  TC-FKC.                                D.091002
005350*****MOVE  KOLRF2-10   TO  TC-UCD.                                D.091002
005360*****WRITE   TC-R      INVALID  KEY                               D.091002
005370*****                  MOVE  "TC-M"       TO    ERR-F             D.091002
005380*****                  MOVE  "W"          TO    ERR-M             D.091002
005390*****                  MOVE   TC-KEY      TO    ERR-K             D.091002
005400*****                  MOVE   0           TO    ERR-LIN           D.091002
005410*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
005420*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
005430***********************MOVE  255    TO    COMPLETION-CODE
005440*****                  STOP  RUN.                                 D.091002
005450*WRT2-RTN-EXIT.                                                   D.091002
005460*****EXIT.                                                        D.091002
005470*--------------------------------------------------------------*
005480*WRT3-RTN.                                                        D.091002
005490*****IF  KOLRF3-10  =  3     GO TO WRT3-RTN-EXIT.                 D.091002
005500*****MOVE  SPACE       TO  HI-R.                                  D.091002
005510*****INITIALIZE            HI-R.                                  D.091002
005520*****MOVE  KOLRF3-MHCD TO  HI-MHCD.                               D.091002
005530*****MOVE  KOLRF3-HCD  TO  HI-HCD.                                D.091002
005540*****MOVE  KOLRF3-NAME TO  HI-NAME.                               D.091002
005550*****MOVE  KOLRF3-BC   TO  HI-BC.                                 D.091002
005560*****MOVE  KOLRF3-ISU  TO  HI-ISU.                                D.091002
005570*****MOVE  KOLRF3-SB   TO  HI-SB.                                 D.091002
005580*****MOVE  KOLRF3-FT   TO  HI-FT.                                 D.091002
005590*****MOVE  KOLRF3-KT   TO  HI-KT.                                 D.091002
005600*****MOVE  KOLRF3-TCD  TO  HI-TCD.                                D.091002
005610*****MOVE  KOLRF3-ISU  TO  HI-ISU.                                D.091002
005620*****MOVE  KOLRF3-SCC  TO  HI-SCC.                                D.091002
005630*****MOVE  KOLRF3-BMC  TO  HI-BMC.                                D.091002
005640*****MOVE  KOLRF3-BMNO TO  HI-BMNO.                               D.091002
005650*****MOVE  KOLRF3-YG   TO  HI-YG.                                 D.091002
005660*****MOVE  KOLRF3-HKB  TO  HI-HKB.                                D.091002
005670*****MOVE  KOLRF3-HPV  TO  HI-HPV.                                D.091002
005680*****MOVE  KOLRF3-BC4  TO  HI-BC4.                                D.091002
005690*****MOVE  KOLRF3-SMS  TO  HI-SMS.                                D.091002
005700*****MOVE  KOLRF3-UNG  TO  HI-UNG.                                D.091002
005710*****MOVE  KOLRF3-NNG  TO  HI-NNG.                                D.091002
005720*****MOVE  KOLRF3-CS   TO  HI-CS.                                 D.091002
005730*****MOVE  KOLRF3-DNG  TO  HI-DNG.                                D.091002
005740*****MOVE  KOLRF3-SNG  TO  HI-SNG.                                D.091002
005750*****MOVE  KOLRF3-ENG  TO  HI-ENG.                                D.091002
005760*****PERFORM  MV31-RTN  THRU  MV31-RTN-EXIT                       D.091002
005770*****    VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10.           D.091002
005780*****WRITE   HI-R      INVALID  KEY                               D.091002
005790*****                  MOVE  "HIM2"       TO    ERR-F             D.091002
005800*****                  MOVE  "W"          TO    ERR-M             D.091002
005810*****                  MOVE   HI-KEY2     TO    ERR-K             D.091002
005820*****                  MOVE   0           TO    ERR-LIN           D.091002
005830*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
005840*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
005850***********************MOVE  255    TO    COMPLETION-CODE
005860*****                  STOP  RUN.                                 D.091002
005870*WRT3-RTN-EXIT.                                                   D.091002
005880*****EXIT.                                                        D.091002
005890*--------------------------------------------------------------*
005900*WRT4-RTN.                                                        D.091002
005910*****IF  KOLRF4-10  =  3     GO TO WRT4-RTN-EXIT.                 D.091002
005920*****MOVE  SPACE       TO  WTNA-R.                                D.091002
005930*****INITIALIZE            WTNA-R.                                D.091002
005940*****MOVE  KOLRF4-02   TO  WTNA-TNC.                              D.091002
005950*****MOVE  KOLRF4-03   TO  WTNA-NAME.                             D.091002
005960*****MOVE  KOLRF4-04   TO  WTNA-BSC.                              D.091002
005970*****WRITE   WTNA-R    INVALID  KEY                               D.091002
005980*****                  MOVE  "WTNAF"      TO    ERR-F             D.091002
005990*****                  MOVE  "W"          TO    ERR-M             D.091002
006000*****                  MOVE   WTNA-KEY    TO    ERR-K             D.091002
006010*****                  MOVE   0           TO    ERR-LIN           D.091002
006020*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
006030*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
006040*****                  STOP  RUN.                                 D.091002
006050*WRT4-RTN-EXIT.                                                   D.091002
006060*****EXIT.                                                        D.091002
006070*--------------------------------------------------------------*
006080 WRT5-RTN.
006090     MOVE  SPACE       TO  JSTR-R.
006100     INITIALIZE            JSTR-R.
006110     MOVE  JOLSF11-02   TO  JSTR-01.                              I.091002
006120     MOVE  JOLSF11-03   TO  JSTR-02.                              I.091002
006130     MOVE  JOLSF11-04   TO  JSTR-03.                              I.091002
006140     MOVE  JOLSF11-05   TO  JSTR-04.                              I.091002
006150     MOVE  JOLSF11-06   TO  JSTR-05.                              I.091002
006160     MOVE  JOLSF11-07   TO  JSTR-06.                              I.091002
006170     MOVE  JOLSF11-08   TO  JSTR-07.                              I.091002
006180     MOVE  JOLSF11-09   TO  JSTR-08.                              I.091002
006190     MOVE  JOLSF11-10   TO  JSTR-09.                              I.091002
006200     MOVE  JOLSF11-11   TO  JSTR-10.                              I.091002
006210     MOVE  JOLSF11-12   TO  JSTR-11.                              I.091002
006220     MOVE  JOLSF11-13   TO  JSTR-12.                              I.091002
006230     MOVE  JOLSF11-14   TO  JSTR-13.                              I.091002
006240     MOVE  JOLSF11-15   TO  JSTR-14.                              I.091002
006250     MOVE  JOLSF11-15A  TO  JSTR-14A.                             I.091002
006260     MOVE  JOLSF11-15B  TO  JSTR-14B.                             I.091002
006270     MOVE  JOLSF11-15C  TO  JSTR-14C.                             I.091002
006280     MOVE  JOLSF11-15D  TO  JSTR-14D.                             I.091002
006290     MOVE  JOLSF11-16   TO  JSTR-15.                              I.091002
006300     MOVE  JOLSF11-20   TO  JSTR-20.                              I.091002
006310     MOVE  JOLSF11-16A  TO  JSTR-15A.                             I.091002
006320     MOVE  JOLSF11-19   TO  JSTR-19.                              I.091002
006330     MOVE  JOLSF11-168  TO  JSTR-158.                             I.091002
006340     MOVE  JOLSF11-17   TO  JSTR-16.                              I.091002
006350     MOVE  JOLSF11-18   TO  JSTR-17.                              I.091002
006360*****MOVE  KOLRF11-02   TO  JSTR-01.                              D.091002
006370*****MOVE  KOLRF11-03   TO  JSTR-02.                              D.091002
006380*****MOVE  KOLRF11-04   TO  JSTR-03.                              D.091002
006390*****MOVE  KOLRF11-05   TO  JSTR-04.                              D.091002
006400*****MOVE  KOLRF11-06   TO  JSTR-05.                              D.091002
006410*****MOVE  KOLRF11-07   TO  JSTR-06.                              D.091002
006420*****MOVE  KOLRF11-08   TO  JSTR-07.                              D.091002
006430*****MOVE  KOLRF11-09   TO  JSTR-08.                              D.091002
006440*****MOVE  KOLRF11-10   TO  JSTR-09.                              D.091002
006450*****MOVE  KOLRF11-11   TO  JSTR-10.                              D.091002
006460*****MOVE  KOLRF11-12   TO  JSTR-11.                              D.091002
006470*****MOVE  KOLRF11-13   TO  JSTR-12.                              D.091002
006480*****MOVE  KOLRF11-14   TO  JSTR-13.                              D.091002
006490*****MOVE  KOLRF11-15   TO  JSTR-14.                              D.091002
006500*****MOVE  KOLRF11-15A  TO  JSTR-14A.                             D.091002
006510*****MOVE  KOLRF11-15B  TO  JSTR-14B.                             D.091002
006520*****MOVE  KOLRF11-15C  TO  JSTR-14C.                             D.091002
006530*****MOVE  KOLRF11-99   TO  JSTR-99.                              D.981111
006540*****MOVE  KOLRF11-15D  TO  JSTR-14D.                             D.091002
006550*****MOVE  KOLRF11-16   TO  JSTR-15.                              D.091002
006560*****MOVE  KOLRF11-20   TO  JSTR-20.                              D.091002
006570*****MOVE  KOLRF11-16A  TO  JSTR-15A.                             D.091002
006580*****MOVE  KOLRF11-18A  TO  JSTR-18.                              D.981111
006590*****MOVE  KOLRF11-19   TO  JSTR-19.                              D.091002
006600*****MOVE  KOLRF11-168  TO  JSTR-158.                             D.091002
006610*****MOVE  KOLRF11-17   TO  JSTR-16.                              D.091002
006620*****MOVE  KOLRF11-18   TO  JSTR-17.                              D.091002
006630     WRITE   JSTR-R     INVALID  KEY
006640                       MOVE  "JSTR"       TO    ERR-F
006650                       MOVE  "W"          TO    ERR-M
006660                       MOVE   JSTR-KEY    TO    ERR-K
006670                       MOVE   0           TO    ERR-LIN
006680                       PERFORM  ERR-RTN   THRU  ERR-EX
006690                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006700***********************MOVE  255    TO    COMPLETION-CODE
006710                       STOP  RUN.
006720 WRT5-RTN-EXIT.
006730     EXIT.
006740*--------------------------------------------------------------*
006750 WRT6-RTN.
006760     IF  JNIF1-02  =  7       GO TO WRT6-010.
006770     MOVE  SPACE        TO  JNIF1-R.
006780     INITIALIZE             JNIF1-R.
006790     MOVE  JOLSF121-01  TO  JNIF1-01.                             I.091002
006800     MOVE  JOLSF121-02  TO  JNIF1-02.                             I.091002
006810     MOVE  JOLSF121-03  TO  JNIF1-03.                             I.091002
006820     MOVE  JOLSF121-04  TO  JNIF1-04.                             I.091002
006830     MOVE  JOLSF121-05  TO  JNIF1-05.                             I.091002
006840     MOVE  JOLSF121-06  TO  JNIF1-06.                             I.091002
006850     MOVE  JOLSF121-07  TO  JNIF1-07.                             I.091002
006860     MOVE  JOLSF121-08  TO  JNIF1-08.                             I.091002
006870*****MOVE  KOLRF121-01  TO  JNIF1-01.                             D.091002
006880*****MOVE  KOLRF121-02  TO  JNIF1-02.                             D.091002
006890*****MOVE  KOLRF121-03  TO  JNIF1-03.                             D.091002
006900*****MOVE  KOLRF121-04  TO  JNIF1-04.                             D.091002
006910*****MOVE  KOLRF121-05  TO  JNIF1-05.                             D.091002
006920*****MOVE  KOLRF121-06  TO  JNIF1-06.                             D.091002
006930*****MOVE  KOLRF121-07  TO  JNIF1-07.                             D.091002
006940*****MOVE  KOLRF121-08  TO  JNIF1-08.                             D.091002
006950     PERFORM  MV61-RTN  THRU  MV61-RTN-EXIT
006960         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  27.
006970     MOVE  JOLSF121-10  TO  JNIF1-10.                             I.091002
006980     MOVE  JOLSF121-11  TO  JNIF1-11.                             I.091002
006990     MOVE  JOLSF121-12  TO  JNIF1-12.                             I.091002
007000     MOVE  JOLSF121-13  TO  JNIF1-13.                             I.091002
007010     MOVE  JOLSF121-14  TO  JNIF1-14.                             I.091002
007020*****MOVE  KOLRF121-10  TO  JNIF1-10.                             D.091002
007030*****MOVE  KOLRF121-11  TO  JNIF1-11.                             D.091002
007040*****MOVE  KOLRF121-12  TO  JNIF1-12.                             D.091002
007050*****MOVE  KOLRF121-13  TO  JNIF1-13.                             D.091002
007060*****MOVE  KOLRF121-14  TO  JNIF1-14.                             D.091002
007070     WRITE   JNIF1-R   INVALID  KEY
007080                       MOVE  "JNIF"       TO    ERR-F
007090                       MOVE  "W"          TO    ERR-M
007100                       MOVE   JNIF1-KEY   TO    ERR-K
007110                       MOVE   0           TO    ERR-LIN
007120                       PERFORM  ERR-RTN   THRU  ERR-EX
007130                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007140***********************MOVE  255    TO    COMPLETION-CODE
007150                       STOP  RUN.
007160     GO TO WRT6-RTN-EXIT.
007170 WRT6-010.
007180     MOVE  SPACE        TO  JNIF2-R.
007190     INITIALIZE             JNIF2-R.
007200     MOVE  JOLSF122-01  TO  JNIF2-01.                             I.091002
007210     MOVE  JOLSF122-02  TO  JNIF2-02.                             I.091002
007220     MOVE  JOLSF122-02A TO  JNIF2-02A.                            I.091002
007230     MOVE  JOLSF122-03  TO  JNIF2-03.                             I.091002
007240     MOVE  JOLSF122-04  TO  JNIF2-04.                             I.091002
007250     MOVE  JOLSF122-05  TO  JNIF2-05.                             I.091002
007260     MOVE  JOLSF122-06  TO  JNIF2-06.                             I.091002
007270     MOVE  JOLSF122-07  TO  JNIF2-07.                             I.091002
007280     MOVE  JOLSF122-08  TO  JNIF2-08.                             I.091002
007290*****MOVE  KOLRF122-01  TO  JNIF2-01.                             D.091002
007300*****MOVE  KOLRF122-02  TO  JNIF2-02.                             D.091002
007310*****MOVE  KOLRF122-02A TO  JNIF2-02A.                            D.091002
007320*****MOVE  KOLRF122-03  TO  JNIF2-03.                             D.091002
007330*****MOVE  KOLRF122-04  TO  JNIF2-04.                             D.091002
007340*****MOVE  KOLRF122-05  TO  JNIF2-05.                             D.091002
007350*****MOVE  KOLRF122-06  TO  JNIF2-06.                             D.091002
007360*****MOVE  KOLRF122-07  TO  JNIF2-07.                             D.091002
007370*****MOVE  KOLRF122-08  TO  JNIF2-08.                             D.091002
007380     WRITE   JNIF2-R   INVALID  KEY
007390                       MOVE  "JNIF"       TO    ERR-F
007400                       MOVE  "W"          TO    ERR-M
007410                       MOVE   JNIF2-KEY   TO    ERR-K
007420                       MOVE   0           TO    ERR-LIN
007430                       PERFORM  ERR-RTN   THRU  ERR-EX
007440                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007450***********************MOVE  255    TO    COMPLETION-CODE
007460                       STOP  RUN.
007470 WRT6-RTN-EXIT.
007480     EXIT.
007490*--------------------------------------------------------------*
007500 WRT6-RTN2.
007510     IF  JNIF1-02  =  7       GO TO WRT62-010.
007520     MOVE  SPACE        TO  JNIF1-R.
007530     INITIALIZE             JNIF1-R.
007540     MOVE  JOLSF121-21  TO  JNIF1-01.                             I.091002
007550     MOVE  JOLSF121-22  TO  JNIF1-02.                             I.091002
007560     MOVE  JOLSF121-23  TO  JNIF1-03.                             I.091002
007570     MOVE  JOLSF121-24  TO  JNIF1-04.                             I.091002
007580     MOVE  JOLSF121-25  TO  JNIF1-05.                             I.091002
007590     MOVE  JOLSF121-26  TO  JNIF1-06.                             I.091002
007600     MOVE  JOLSF121-27  TO  JNIF1-07.                             I.091002
007610     MOVE  JOLSF121-28  TO  JNIF1-08.                             I.091002
007620*****MOVE  KOLRF121-21  TO  JNIF1-01.                             D.091002
007630*****MOVE  KOLRF121-22  TO  JNIF1-02.                             D.091002
007640*****MOVE  KOLRF121-23  TO  JNIF1-03.                             D.091002
007650*****MOVE  KOLRF121-24  TO  JNIF1-04.                             D.091002
007660*****MOVE  KOLRF121-25  TO  JNIF1-05.                             D.091002
007670*****MOVE  KOLRF121-26  TO  JNIF1-06.                             D.091002
007680*****MOVE  KOLRF121-27  TO  JNIF1-07.                             D.091002
007690*****MOVE  KOLRF121-28  TO  JNIF1-08.                             D.091002
007700     PERFORM  MV61-RTN2 THRU  MV61-RTN2-EXIT
007710         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  27.
007720     MOVE  JOLSF121-30  TO  JNIF1-10.                             I.091002
007730     MOVE  JOLSF121-31  TO  JNIF1-11.                             I.091002
007740     MOVE  JOLSF121-32  TO  JNIF1-12.                             I.091002
007750     MOVE  JOLSF121-33  TO  JNIF1-13.                             I.091002
007760     MOVE  JOLSF121-34  TO  JNIF1-14.                             I.091002
007770*****MOVE  KOLRF121-30  TO  JNIF1-10.                             D.091002
007780*****MOVE  KOLRF121-31  TO  JNIF1-11.                             D.091002
007790*****MOVE  KOLRF121-32  TO  JNIF1-12.                             D.091002
007800*****MOVE  KOLRF121-33  TO  JNIF1-13.                             D.091002
007810*****MOVE  KOLRF121-34  TO  JNIF1-14.                             D.091002
007820     WRITE   JNIF1-R   INVALID  KEY
007830                       MOVE  "JNIF"       TO    ERR-F
007840                       MOVE  "W"          TO    ERR-M
007850                       MOVE   JNIF1-KEY   TO    ERR-K
007860                       MOVE   0           TO    ERR-LIN
007870                       PERFORM  ERR-RTN   THRU  ERR-EX
007880                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007890***********************MOVE  255    TO    COMPLETION-CODE
007900                       STOP  RUN.
007910     GO TO WRT6-RTN2-EXIT.
007920 WRT62-010.
007930     MOVE  SPACE        TO  JNIF2-R.
007940     INITIALIZE             JNIF2-R.
007950     MOVE  JOLSF122-21  TO  JNIF2-01.                             I.091002
007960     MOVE  JOLSF122-22  TO  JNIF2-02.                             I.091002
007970     MOVE  JOLSF122-22A TO  JNIF2-02A.                            I.091002
007980     MOVE  JOLSF122-23  TO  JNIF2-03.                             I.091002
007990     MOVE  JOLSF122-24  TO  JNIF2-04.                             I.091002
008000     MOVE  JOLSF122-25  TO  JNIF2-05.                             I.091002
008010     MOVE  JOLSF122-26  TO  JNIF2-06.                             I.091002
008020     MOVE  JOLSF122-27  TO  JNIF2-07.                             I.091002
008030     MOVE  JOLSF122-28  TO  JNIF2-08.                             I.091002
008040*****MOVE  KOLRF122-21  TO  JNIF2-01.                             D.091002
008050*****MOVE  KOLRF122-22  TO  JNIF2-02.                             D.091002
008060*****MOVE  KOLRF122-22A TO  JNIF2-02A.                            D.091002
008070*****MOVE  KOLRF122-23  TO  JNIF2-03.                             D.091002
008080*****MOVE  KOLRF122-24  TO  JNIF2-04.                             D.091002
008090*****MOVE  KOLRF122-25  TO  JNIF2-05.                             D.091002
008100*****MOVE  KOLRF122-26  TO  JNIF2-06.                             D.091002
008110*****MOVE  KOLRF122-27  TO  JNIF2-07.                             D.091002
008120*****MOVE  KOLRF122-28  TO  JNIF2-08.                             D.091002
008130     WRITE   JNIF2-R   INVALID  KEY
008140                       MOVE  "JNIF"       TO    ERR-F
008150                       MOVE  "W"          TO    ERR-M
008160                       MOVE   JNIF2-KEY   TO    ERR-K
008170                       MOVE   0           TO    ERR-LIN
008180                       PERFORM  ERR-RTN   THRU  ERR-EX
008190                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
008200***********************MOVE  255    TO    COMPLETION-CODE
008210                       STOP  RUN.
008220 WRT6-RTN2-EXIT.
008230     EXIT.
008240*--------------------------------------------------------------*
008250 WRT7-RTN.
008260     MOVE  SPACE           TO  OKJF-R.
008270     INITIALIZE                OKJF-R.
008280     MOVE  JOLSF13-02(NN)  TO  OKJF-01.                           I.091002
008290     MOVE  JOLSF13-03(NN)  TO  OKJF-02.                           I.091002
008300     MOVE  JOLSF13-04(NN)  TO  OKJF-03.                           I.091002
008310     MOVE  JOLSF13-05(NN)  TO  OKJF-04.                           I.091002
008320     MOVE  JOLSF13-06(NN)  TO  OKJF-05.                           I.091002
008330     MOVE  JOLSF13-07(NN)  TO  OKJF-06.                           I.091002
008340     MOVE  JOLSF13-08(NN)  TO  OKJF-07.                           I.091002
008350     MOVE  JOLSF13-09(NN)  TO  OKJF-08.                           I.091002
008360     MOVE  JOLSF13-10(NN)  TO  OKJF-09.                           I.091002
008370     MOVE  JOLSF13-11(NN)  TO  OKJF-10.                           I.091002
008380     MOVE  JOLSF13-12(NN)  TO  OKJF-11.                           I.091002
008390     MOVE  JOLSF13-13(NN)  TO  OKJF-12.                           I.091002
008400*****MOVE  KOLRF13-02(NN)  TO  OKJF-01.                           D.091002
008410*****MOVE  KOLRF13-03(NN)  TO  OKJF-02.                           D.091002
008420*****MOVE  KOLRF13-04(NN)  TO  OKJF-03.                           D.091002
008430*****MOVE  KOLRF13-05(NN)  TO  OKJF-04.                           D.091002
008440*****MOVE  KOLRF13-06(NN)  TO  OKJF-05.                           D.091002
008450*****MOVE  KOLRF13-07(NN)  TO  OKJF-06.                           D.091002
008460*****MOVE  KOLRF13-08(NN)  TO  OKJF-07.                           D.091002
008470*****MOVE  KOLRF13-09(NN)  TO  OKJF-08.                           D.091002
008480*****MOVE  KOLRF13-10(NN)  TO  OKJF-09.                           D.091002
008490*****MOVE  KOLRF13-11(NN)  TO  OKJF-10.                           D.091002
008500*****MOVE  KOLRF13-12(NN)  TO  OKJF-11.                           D.091002
008510*****MOVE  KOLRF13-13(NN)  TO  OKJF-12.                           D.091002
008520     WRITE   OKJF-R    INVALID  KEY
008530                       MOVE  "OKJF"       TO    ERR-F
008540                       MOVE  "W"          TO    ERR-M
008550                       MOVE   OKJF-KEY    TO    ERR-K
008560                       MOVE   0           TO    ERR-LIN
008570                       PERFORM  ERR-RTN   THRU  ERR-EX
008580                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
008590***********************MOVE  255    TO    COMPLETION-CODE
008600                       STOP  RUN.
008610 WRT7-RTN-EXIT.
008620     EXIT.
008630*--------------------------------------------------------------*
008640 WRT8-RTN.
008650*****IF  KOLRF141-DGN   =  ZERO                                   D.091002
008660     IF  JOLSF141-DGN   =  ZERO                                   I.091002
008670         MOVE  SPACE           TO  TDNW-R1
008680         INITIALIZE                TDNW-R1
008690         MOVE  JOLSF141-KEY    TO  TDNW1-KEY                      I.091002
008700         MOVE  JOLSF141-BC     TO  TDNW1-BC                       I.091002
008710         MOVE  JOLSF141-SHC    TO  TDNW1-SHC                      I.091002
008720         MOVE  JOLSF141-DPC    TO  TDNW1-DPC                      I.091002
008730         MOVE  JOLSF141-HNGP   TO  TDNW1-HNGP                     I.091002
008740         MOVE  JOLSF141-NNGP   TO  TDNW1-NNGP                     I.091002
008750         MOVE  JOLSF141-THC    TO  TDNW1-THC                      I.091002
008760         MOVE  JOLSF141-MHC    TO  TDNW1-MHC                      I.091002
008770         MOVE  JOLSF141-SNA    TO  TDNW1-SNA                      I.091002
008780         MOVE  JOLSF141-TNA    TO  TDNW1-TNA                      I.091002
008790         MOVE  JOLSF141-HCC    TO  TDNW1-HCC                      I.091002
008800         MOVE  JOLSF141-HSP    TO  TDNW1-HSP                      I.091002
008810         MOVE  JOLSF141-DHC    TO  TDNW1-DHC                      I.091002
008820         MOVE  JOLSF141-KHC    TO  TDNW1-KHC                      I.091002
008830         MOVE  JOLSF141-KCC    TO  TDNW1-KCC                      I.091002
008840         MOVE  JOLSF141-UBC    TO  TDNW1-UBC                      I.091002
008850         MOVE  JOLSF141-NCC    TO  TDNW1-NCC                      I.091002
008860         MOVE  JOLSF141-EDI    TO  TDNW1-EDI                      I.091002
008870         MOVE  JOLSF141-NKC    TO  TDNW1-NKC                      I.091002
008880         MOVE  JOLSF141-ZAC    TO  TDNW1-ZAC                      I.091002
008890         MOVE  9               TO  TDNW1-PC                       I.150318
008900*****    MOVE  JOLSF141-PC     TO  TDNW1-PC                       D.150318
008910*****    MOVE  KOLRF141-KEY    TO  TDNW1-KEY                      D.091002
008920*****    MOVE  KOLRF141-BC     TO  TDNW1-BC                       D.091002
008930*****    MOVE  KOLRF141-SHC    TO  TDNW1-SHC                      D.091002
008940*****    MOVE  KOLRF141-DPC    TO  TDNW1-DPC                      D.091002
008950*****    MOVE  KOLRF141-HNGP   TO  TDNW1-HNGP                     D.091002
008960*****    MOVE  KOLRF141-NNGP   TO  TDNW1-NNGP                     D.091002
008970*****    MOVE  KOLRF141-THC    TO  TDNW1-THC                      D.091002
008980*****    MOVE  KOLRF141-MHC    TO  TDNW1-MHC                      D.091002
008990*****    MOVE  KOLRF141-SNA    TO  TDNW1-SNA                      D.091002
009000*****    MOVE  KOLRF141-TNA    TO  TDNW1-TNA                      D.091002
009010*****    MOVE  KOLRF141-HCC    TO  TDNW1-HCC                      D.091002
009020*****    MOVE  KOLRF141-HSP    TO  TDNW1-HSP                      D.091002
009030*****    MOVE  KOLRF141-DHC    TO  TDNW1-DHC                      D.091002
009040*****    MOVE  KOLRF141-KHC    TO  TDNW1-KHC                      D.091002
009050*****    MOVE  KOLRF141-KCC    TO  TDNW1-KCC                      D.091002
009060*****    MOVE  KOLRF141-UBC    TO  TDNW1-UBC                      D.091002
009070*****    MOVE  KOLRF141-NCC    TO  TDNW1-NCC                      D.091002
009080*****    MOVE  KOLRF141-EDI    TO  TDNW1-EDI                      D.091002
009090*****    MOVE  KOLRF141-NKC    TO  TDNW1-NKC                      D.091002
009100*****    MOVE  KOLRF141-ZAC    TO  TDNW1-ZAC                      D.091002
009110*****    MOVE  KOLRF141-PC     TO  TDNW1-PC                       D.091002
009120     ELSE
009130         MOVE  SPACE           TO  TDNW-R2
009140         INITIALIZE                TDNW-R2
009150         MOVE  JOLSF142-KEY    TO  TDNW2-KEY                      I.091002
009160         MOVE  JOLSF142-HCD    TO  TDNW2-HCD                      I.091002
009170         MOVE  JOLSF142-ISU    TO  TDNW2-ISU                      I.091002
009180         MOVE  JOLSF142-KSU    TO  TDNW2-KSU                      I.091002
009190         MOVE  JOLSF142-HTC    TO  TDNW2-HTC                      I.091002
009200         MOVE  JOLSF142-SU     TO  TDNW2-SU                       I.091002
009210         MOVE  JOLSF142-GTN    TO  TDNW2-GTN                      I.091002
009220         MOVE  JOLSF142-UTN    TO  TDNW2-UTN                      I.091002
009230         MOVE  JOLSF142-GKIN   TO  TDNW2-GKIN                     I.091002
009240         MOVE  JOLSF142-UKIN   TO  TDNW2-UKIN                     I.091002
009250         MOVE  JOLSF142-GCN    TO  TDNW2-GCN                      I.091002
009260         MOVE  JOLSF142-CCD    TO  TDNW2-CCD                      I.091002
009270         MOVE  JOLSF142-SHN    TO  TDNW2-SHN                      I.091002
009280         MOVE  JOLSF142-JAN    TO  TDNW2-JAN                      I.091002
009290         MOVE  JOLSF142-TSH    TO  TDNW2-TSH                      I.091002
009300         MOVE  JOLSF142-TKC    TO  TDNW2-TKC                      I.091002
009310         MOVE  9               TO  TDNW2-PC.                      I.150318
009320*****    MOVE  JOLSF142-PC     TO  TDNW2-PC.                      D.150318
009330*****    MOVE  KOLRF142-KEY    TO  TDNW2-KEY                      D.091002
009340*****    MOVE  KOLRF142-HCD    TO  TDNW2-HCD                      D.091002
009350*****    MOVE  KOLRF142-ISU    TO  TDNW2-ISU                      D.091002
009360*****    MOVE  KOLRF142-KSU    TO  TDNW2-KSU                      D.091002
009370*****    MOVE  KOLRF142-HTC    TO  TDNW2-HTC                      D.091002
009380*****    MOVE  KOLRF142-SU     TO  TDNW2-SU                       D.091002
009390*****    MOVE  KOLRF142-GTN    TO  TDNW2-GTN                      D.091002
009400*****    MOVE  KOLRF142-UTN    TO  TDNW2-UTN                      D.091002
009410*****    MOVE  KOLRF142-GKIN   TO  TDNW2-GKIN                     D.091002
009420*****    MOVE  KOLRF142-UKIN   TO  TDNW2-UKIN                     D.091002
009430*****    MOVE  KOLRF142-GCN    TO  TDNW2-GCN                      D.091002
009440*****    MOVE  KOLRF142-CCD    TO  TDNW2-CCD                      D.091002
009450*****    MOVE  KOLRF142-SHN    TO  TDNW2-SHN                      D.091002
009460*****    MOVE  KOLRF142-JAN    TO  TDNW2-JAN                      D.091002
009470*****    MOVE  KOLRF142-TSH    TO  TDNW2-TSH                      D.091002
009480*****    MOVE  KOLRF142-TKC    TO  TDNW2-TKC                      D.091002
009490*****    MOVE  KOLRF142-PC     TO  TDNW2-PC.                      D.091002
009500     WRITE   TDNW-R1   INVALID  KEY
009510                       MOVE  "TDNWF"      TO    ERR-F
009520                       MOVE  "W"          TO    ERR-M
009530                       MOVE   TDNW1-KEY   TO    ERR-K
009540                       MOVE   0           TO    ERR-LIN
009550                       PERFORM  ERR-RTN   THRU  ERR-EX
009560                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
009570                       STOP  RUN.
009580 WRT8-RTN-EXIT.
009590     EXIT.
009600*--------------------------------------------------------------*
009610 WRT9-RTN.
009620*****IF  KOLRF151-DGN   =  ZERO                                   D.091002
009630     IF  JOLSF151-DGN   =  ZERO                                   I.091002
009640         MOVE  SPACE        TO TDNN-R1
009650         INITIALIZE            TDNN-R1
009660         MOVE JOLSF151-KEY  TO TDNN1-KEY                          I.091002
009670         MOVE JOLSF151-BCD  TO TDNN1-BCD                          I.091002
009680         MOVE JOLSF151-DPC  TO TDNN1-DPC                          I.091002
009690         MOVE JOLSF151-HNGP TO TDNN1-HNGP                         I.091002
009700         MOVE JOLSF151-NNGP TO TDNN1-NNGP                         I.091002
009710         MOVE JOLSF151-THC  TO TDNN1-THC                          I.091002
009720         MOVE JOLSF151-STA  TO TDNN1-STA                          I.091002
009730         MOVE JOLSF151-SNA  TO TDNN1-SNA                          I.091002
009740         MOVE JOLSF151-TNA  TO TDNN1-TNA                          I.091002
009750         MOVE JOLSF151-TSN  TO TDNN1-TSN                          I.091002
009760         MOVE JOLSF151-TST  TO TDNN1-TST                          I.091002
009770         MOVE JOLSF151-HCC  TO TDNN1-HCC                          I.091002
009780         MOVE JOLSF151-AR   TO TDNN1-AR                           I.091002
009790         MOVE JOLSF151-DUR  TO TDNN1-DUR                          I.091002
009800         MOVE JOLSF151-DSHR TO TDNN1-DSHR                         I.091002
009810         MOVE JOLSF151-DSMR TO TDNN1-DSMR                         I.091002
009820         MOVE JOLSF151-ER   TO TDNN1-ER                           I.091002
009830         MOVE JOLSF151-FSR  TO TDNN1-FSR                          I.091002
009840         MOVE JOLSF151-FUR  TO TDNN1-FUR                          I.091002
009850         MOVE JOLSF151-LCR  TO TDNN1-LCR                          I.091002
009860         MOVE JOLSF151-LUR  TO TDNN1-LUR                          I.091002
009870         MOVE JOLSF151-LSR  TO TDNN1-LSR                          I.091002
009880         MOVE 9             TO TDNN1-PC                           I.140911
009890*****    MOVE JOLSF151-PC   TO TDNN1-PC                           D.140911
009900*****    MOVE KOLRF151-KEY  TO TDNN1-KEY                          D.091002
009910*****    MOVE KOLRF151-BCD  TO TDNN1-BCD                          D.091002
009920*****    MOVE KOLRF151-DPC  TO TDNN1-DPC                          D.091002
009930*****    MOVE KOLRF151-HNGP TO TDNN1-HNGP                         D.091002
009940*****    MOVE KOLRF151-NNGP TO TDNN1-NNGP                         D.091002
009950*****    MOVE KOLRF151-THC  TO TDNN1-THC                          D.091002
009960*****    MOVE KOLRF151-STA  TO TDNN1-STA                          D.091002
009970*****    MOVE KOLRF151-SNA  TO TDNN1-SNA                          D.091002
009980*****    MOVE KOLRF151-TNA  TO TDNN1-TNA                          D.091002
009990*****    MOVE KOLRF151-TSN  TO TDNN1-TSN                          D.091002
010000*****    MOVE KOLRF151-TST  TO TDNN1-TST                          D.091002
010010*****    MOVE KOLRF151-HCC  TO TDNN1-HCC                          D.091002
010020*****    MOVE KOLRF151-AR   TO TDNN1-AR                           D.091002
010030*****    MOVE KOLRF151-DUR  TO TDNN1-DUR                          D.091002
010040*****    MOVE KOLRF151-DSHR TO TDNN1-DSHR                         D.091002
010050*****    MOVE KOLRF151-DSMR TO TDNN1-DSMR                         D.091002
010060*****    MOVE KOLRF151-ER   TO TDNN1-ER                           D.091002
010070*****    MOVE KOLRF151-FSR  TO TDNN1-FSR                          D.091002
010080*****    MOVE KOLRF151-FUR  TO TDNN1-FUR                          D.091002
010090*****    MOVE KOLRF151-LCR  TO TDNN1-LCR                          D.091002
010100*****    MOVE KOLRF151-LUR  TO TDNN1-LUR                          D.091002
010110*****    MOVE KOLRF151-LSR  TO TDNN1-LSR                          D.091002
010120*****    MOVE KOLRF151-PC   TO TDNN1-PC                           D.091002
010130     ELSE
010140         MOVE  SPACE        TO TDNN-R2
010150         INITIALIZE            TDNN-R2
010160         MOVE JOLSF152-KEY  TO TDNN2-KEY                          I.091002
010170         MOVE JOLSF152-JAN  TO TDNN2-JAN                          I.091002
010180         MOVE JOLSF152-GAR  TO TDNN2-GAR                          I.091002
010190         MOVE JOLSF152-TNI  TO TDNN2-TNI                          I.091002
010200         MOVE JOLSF152-SU   TO TDNN2-SU                           I.091002
010210         MOVE JOLSF152-GTN  TO TDNN2-GTN                          I.091002
010220         MOVE JOLSF152-UTN  TO TDNN2-UTN                          I.091002
010230         MOVE JOLSF152-GKIN TO TDNN2-GKIN                         I.091002
010240         MOVE JOLSF152-UKIN TO TDNN2-UKIN                         I.091002
010250         MOVE JOLSF152-SHN  TO TDNN2-SHN                          I.091002
010260         MOVE JOLSF152-HSC  TO TDNN2-HSC                          I.091002
010270         MOVE JOLSF152-COR  TO TDNN2-COR                          I.091002
010280         MOVE JOLSF152-SIZ  TO TDNN2-SIZ                          I.091002
010290         MOVE JOLSF152-KKK  TO TDNN2-KKK                          I.091002
010300         MOVE JOLSF152-PCH  TO TDNN2-PCH                          I.091002
010310         MOVE JOLSF152-PSI  TO TDNN2-PSI                          I.091002
010320         MOVE JOLSF152-PBM  TO TDNN2-PBM                          I.091002
010330         MOVE JOLSF152-PJAN TO TDNN2-PJAN                         I.091002
010340         MOVE JOLSF152-PSHN TO TDNN2-PSHN                         I.091002
010350         MOVE JOLSF152-PKKK TO TDNN2-PKKK                         I.091002
010360         MOVE JOLSF152-PUTN TO TDNN2-PUTN                         I.091002
010370         MOVE JOLSF152-PMS  TO TDNN2-PMS                          I.091002
010380         MOVE 9             TO TDNN2-PC.                          I.140911
010390*****    MOVE JOLSF152-PC   TO TDNN2-PC.                          D.140911
010400*****    MOVE KOLRF152-KEY  TO TDNN2-KEY                          D.091002
010410*****    MOVE KOLRF152-JAN  TO TDNN2-JAN                          D.091002
010420*****    MOVE KOLRF152-GAR  TO TDNN2-GAR                          D.091002
010430*****    MOVE KOLRF152-TNI  TO TDNN2-TNI                          D.091002
010440*****    MOVE KOLRF152-SU   TO TDNN2-SU                           D.091002
010450*****    MOVE KOLRF152-GTN  TO TDNN2-GTN                          D.091002
010460*****    MOVE KOLRF152-UTN  TO TDNN2-UTN                          D.091002
010470*****    MOVE KOLRF152-GKIN TO TDNN2-GKIN                         D.091002
010480*****    MOVE KOLRF152-UKIN TO TDNN2-UKIN                         D.091002
010490*****    MOVE KOLRF152-SHN  TO TDNN2-SHN                          D.091002
010500*****    MOVE KOLRF152-HSC  TO TDNN2-HSC                          D.091002
010510*****    MOVE KOLRF152-COR  TO TDNN2-COR                          D.091002
010520*****    MOVE KOLRF152-SIZ  TO TDNN2-SIZ                          D.091002
010530*****    MOVE KOLRF152-KKK  TO TDNN2-KKK                          D.091002
010540*****    MOVE KOLRF152-PCH  TO TDNN2-PCH                          D.091002
010550*****    MOVE KOLRF152-PSI  TO TDNN2-PSI                          D.091002
010560*****    MOVE KOLRF152-PBM  TO TDNN2-PBM                          D.091002
010570*****    MOVE KOLRF152-PJAN TO TDNN2-PJAN                         D.091002
010580*****    MOVE KOLRF152-PSHN TO TDNN2-PSHN                         D.091002
010590*****    MOVE KOLRF152-PKKK TO TDNN2-PKKK                         D.091002
010600*****    MOVE KOLRF152-PUTN TO TDNN2-PUTN                         D.091002
010610*****    MOVE KOLRF152-PMS  TO TDNN2-PMS                          D.091002
010620*****    MOVE KOLRF152-PC   TO TDNN2-PC.                          D.091002
010630     WRITE   TDNN-R1   INVALID  KEY
010640                       MOVE  "TDNNF"      TO    ERR-F
010650                       MOVE  "W"          TO    ERR-M
010660                       MOVE   TDNN1-KEY   TO    ERR-K
010670                       MOVE   0           TO    ERR-LIN
010680                       PERFORM  ERR-RTN   THRU  ERR-EX
010690                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
010700                       STOP  RUN.
010710 WRT9-RTN-EXIT.
010720     EXIT.
010730*--------------------------------------------------------------*
010740 WRT10-RTN.                                                       I.080407
010750     MOVE  SPACE       TO  TDI-R.                                 I.080407
010760     INITIALIZE            TDI-R.                                 I.080407
010770     MOVE  JOLSF16-DNO  TO  TDI-DNO.                              I.091002
010780     MOVE  JOLSF16-GNO  TO  TDI-GNO.                              I.091002
010790     MOVE  JOLSF16-DATE TO  TDI-DATE.                             I.091002
010800     MOVE  JOLSF16-TCD  TO  TDI-TCD.                              I.091002
010810     MOVE  JOLSF16-CCD  TO  TDI-CCD.                              I.091002
010820     MOVE  JOLSF16-TPC  TO  TDI-TPC.                              I.091002
010830     MOVE  JOLSF16-HCD  TO  TDI-HCD.                              I.091002
010840     MOVE  JOLSF16-SIZ  TO  TDI-SIZ.                              I.091002
010850     MOVE  JOLSF16-SKB  TO  TDI-SKB.                              I.091002
010860     MOVE  JOLSF16-SNO  TO  TDI-SNO.                              I.091002
010870     MOVE  JOLSF16-SU   TO  TDI-SU.                               I.091002
010880     MOVE  JOLSF16-GT   TO  TDI-GT.                               I.091002
010890     MOVE  JOLSF16-UT   TO  TDI-UT.                               I.091002
010900     MOVE  JOLSF16-GKIN TO  TDI-GKIN.                             I.091002
010910     MOVE  JOLSF16-UKIN TO  TDI-UKIN.                             I.091002
010920     MOVE  JOLSF16-JNO  TO  TDI-JNO.                              I.091002
010930     MOVE  JOLSF16-JGN  TO  TDI-JGN.                              I.091002
010940     MOVE  JOLSF16-SOK  TO  TDI-SOK.                              I.091002
010950     MOVE  JOLSF16-UNS  TO  TDI-UNS.                              I.091002
010960     MOVE  JOLSF16-ISU  TO  TDI-ISU.                              I.091002
010970     MOVE  JOLSF16-HNO  TO  TDI-HNO.                              I.091002
010980     MOVE  JOLSF16-THT  TO  TDI-THT.                              I.091002
010990     MOVE  JOLSF16-TTE  TO  TDI-TTE.                              I.091002
011000     MOVE  JOLSF16-TRN  TO  TDI-TRN.                              I.091002
011010     IF  JOLSF16-TCD  =  5000                                     I.140911
011020         MOVE  9            TO  TDI-PRC                           I.140911
011030       ELSE                                                       I.140911
011040         MOVE  JOLSF16-PRC  TO  TDI-PRC.                          I.091002
011050     MOVE  JOLSF16-UPC  TO  TDI-UPC.                              I.091002
011060     MOVE  JOLSF16-JAN  TO  TDI-JAN.                              I.120515
011070*****MOVE  KOLRF16-DNO  TO  TDI-DNO.                              D.091002
011080*****MOVE  KOLRF16-GNO  TO  TDI-GNO.                              D.091002
011090*****MOVE  KOLRF16-DATE TO  TDI-DATE.                             D.091002
011100*****MOVE  KOLRF16-TCD  TO  TDI-TCD.                              D.091002
011110*****MOVE  KOLRF16-CCD  TO  TDI-CCD.                              D.091002
011120*****MOVE  KOLRF16-TPC  TO  TDI-TPC.                              D.091002
011130*****MOVE  KOLRF16-HCD  TO  TDI-HCD.                              D.091002
011140*****MOVE  KOLRF16-SIZ  TO  TDI-SIZ.                              D.091002
011150*****MOVE  KOLRF16-SKB  TO  TDI-SKB.                              D.091002
011160*****MOVE  KOLRF16-SNO  TO  TDI-SNO.                              D.091002
011170*****MOVE  KOLRF16-SU   TO  TDI-SU.                               D.091002
011180*****MOVE  KOLRF16-GT   TO  TDI-GT.                               D.091002
011190*****MOVE  KOLRF16-UT   TO  TDI-UT.                               D.091002
011200*****MOVE  KOLRF16-GKIN TO  TDI-GKIN.                             D.091002
011210*****MOVE  KOLRF16-UKIN TO  TDI-UKIN.                             D.091002
011220*****MOVE  KOLRF16-JNO  TO  TDI-JNO.                              D.091002
011230*****MOVE  KOLRF16-JGN  TO  TDI-JGN.                              D.091002
011240*****MOVE  KOLRF16-SOK  TO  TDI-SOK.                              D.091002
011250*****MOVE  KOLRF16-UNS  TO  TDI-UNS.                              D.091002
011260*****MOVE  KOLRF16-ISU  TO  TDI-ISU.                              D.091002
011270*****MOVE  KOLRF16-HNO  TO  TDI-HNO.                              D.091002
011280*****MOVE  KOLRF16-THT  TO  TDI-THT.                              D.091002
011290*****MOVE  KOLRF16-TTE  TO  TDI-TTE.                              D.091002
011300*****MOVE  KOLRF16-TRN  TO  TDI-TRN.                              D.091002
011310*****MOVE  KOLRF16-PRC  TO  TDI-PRC.                              D.091002
011320*****MOVE  KOLRF16-UPC  TO  TDI-UPC.                              D.091002
011330     WRITE   TDI-R      INVALID  KEY                              I.080407
011340                       MOVE  "TDIF"       TO    ERR-F             I.080407
011350                       MOVE  "W"          TO    ERR-M             I.080407
011360                       MOVE   TDI-KEY     TO    ERR-K             I.080407
011370                       MOVE   0           TO    ERR-LIN           I.080407
011380                       PERFORM  ERR-RTN   THRU  ERR-EX            I.080407
011390                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     I.080407
011400                       STOP  RUN.                                 I.080407
011410 WRT10-RTN-EXIT.                                                  I.080407
011420     EXIT.                                                        I.080407
011430*--------------------------------------------------------------*
011440 WRT11-RTN.                                                       I.091222
011450     MOVE  SPACE       TO  TDNA-R.                                I.091222
011460     INITIALIZE            TDNA-R.                                I.091222
011470     MOVE  JOLSF17-KEY  TO  TDNA-KEY.                             I.091222
011480     MOVE  JOLSF17-JAN  TO  TDNA-JAN.                             I.091222
011490     MOVE  JOLSF17-SU   TO  TDNA-SU.                              I.091222
011500     MOVE  JOLSF17-GTN  TO  TDNA-GTN.                             I.091222
011510     MOVE  JOLSF17-UTN  TO  TDNA-UTN.                             I.091222
011520     MOVE  JOLSF17-GKIN TO  TDNA-GKIN.                            I.091222
011530     MOVE  JOLSF17-UKIN TO  TDNA-UKIN.                            I.091222
011540     MOVE  JOLSF17-DPM  TO  TDNA-DPM.                             I.091222
011550     MOVE  JOLSF17-CLS  TO  TDNA-CLS.                             I.091222
011560     MOVE  JOLSF17-SHM  TO  TDNA-SHM.                             I.091222
011570     MOVE  JOLSF17-MKH  TO  TDNA-MKH.                             I.091222
011580     MOVE  JOLSF17-MSB  TO  TDNA-MSB.                             I.091222
011590     MOVE  JOLSF17-TY   TO  TDNA-TY.                              I.091222
011600     MOVE  JOLSF17-HCD  TO  TDNA-HCD.                             I.091222
011610     MOVE  JOLSF17-COR  TO  TDNA-COR.                             I.091222
011620     MOVE  JOLSF17-SIZ  TO  TDNA-SIZ.                             I.091222
011630     MOVE  JOLSF17-NSU  TO  TDNA-NSU.                             I.091222
011640     MOVE  JOLSF17-TSC  TO  TDNA-TSC.                             I.091222
011650     MOVE  JOLSF17-CCD  TO  TDNA-CCD.                             I.091222
011660     MOVE  JOLSF17-TNA  TO  TDNA-TNA.                             I.091222
011670     MOVE  JOLSF17-HNO  TO  TDNA-HNO.                             I.091222
011680     MOVE  JOLSF17-HNGP TO  TDNA-HNGP.                            I.091222
011690     MOVE  JOLSF17-NNGP TO  TDNA-NNGP.                            I.091222
011700     MOVE  JOLSF17-THC  TO  TDNA-THC.                             I.091222
011710     MOVE  JOLSF17-BI   TO  TDNA-BI.                              I.091222
011720     MOVE  JOLSF17-SNGP TO  TDNA-SNGP.                            I.091222
011730     MOVE  JOLSF17-HNA  TO  TDNA-HNA.                             I.091222
011740     MOVE  JOLSF17-ZON  TO  TDNA-ZON.                             I.091222
011750     MOVE  JOLSF17-DC   TO  TDNA-DC.                              I.091222
011760     MOVE  JOLSF17-DNGP TO  TDNA-DNGP.                            I.091222
011770     MOVE  JOLSF17-NRC  TO  TDNA-NRC.                             I.091222
011780     MOVE  JOLSF17-PC   TO  TDNA-PC.                              I.091222
011790     MOVE  JOLSF17-RC   TO  TDNA-RC.                              I.091222
011800     WRITE   TDNA-R     INVALID  KEY                              I.091222
011810                       MOVE  "TDNAF"      TO    ERR-F             I.091222
011820                       MOVE  "W"          TO    ERR-M             I.091222
011830                       MOVE   TDNA-KEY    TO    ERR-K             I.091222
011840                       MOVE   0           TO    ERR-LIN           I.091222
011850                       PERFORM  ERR-RTN   THRU  ERR-EX            I.091222
011860                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     I.091222
011870                       STOP  RUN.                                 I.091222
011880 WRT11-RTN-EXIT.                                                  I.091222
011890     EXIT.                                                        I.091222
011900*--------------------------------------------------------------*
011910*REW1-RTN.                                                        D.091002
011920*****MOVE  KOLRF1-04   TO  JCON2-03.                              D.091002
011930*****REWRITE  JCON1-R    INVALID  KEY                             D.091002
011940*****                  MOVE  "JCON"       TO    ERR-F             D.091002
011950*****                  MOVE  "R"          TO    ERR-M             D.091002
011960*****                  MOVE   JCON1-KEY   TO    ERR-K             D.091002
011970*****                  MOVE   0           TO    ERR-LIN           D.091002
011980*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
011990*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012000***********************MOVE  255    TO    COMPLETION-CODE
012010*****                  STOP  RUN.                                 D.091002
012020*REW1-RTN-EXIT.                                                   D.091002
012030*****EXIT.                                                        D.091002
012040*--------------------------------------------------------------*
012050*REW2-RTN.                                                        D.091002
012060*****MOVE  KOLRF2-04   TO  TC-NAME.                               D.091002
012070*****MOVE  KOLRF2-05   TO  TC-JSU.                                D.091002
012080*****MOVE  KOLRF2-06   TO  TC-JSS.                                D.091002
012090*****MOVE  KOLRF2-07   TO  TC-UNO.                                D.091002
012100*****MOVE  KOLRF2-08   TO  TC-TEL.                                D.091002
012110*****MOVE  KOLRF2-09   TO  TC-FKC.                                D.091002
012120*****MOVE  KOLRF2-10   TO  TC-UCD.                                D.091002
012130*****REWRITE   TC-R    INVALID  KEY                               D.091002
012140*****                  MOVE  "TC-M"       TO    ERR-F             D.091002
012150*****                  MOVE  "R"          TO    ERR-M             D.091002
012160*****                  MOVE   TC-KEY      TO    ERR-K             D.091002
012170*****                  MOVE   0           TO    ERR-LIN           D.091002
012180*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
012190*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012200***********************MOVE  255    TO    COMPLETION-CODE
012210*****                  STOP  RUN.                                 D.091002
012220*REW2-RTN-EXIT.                                                   D.091002
012230*****EXIT.                                                        D.091002
012240*--------------------------------------------------------------*
012250*REW3-RTN.                                                        D.091002
012260*****MOVE  KOLRF3-NAME TO  HI-NAME.                               D.091002
012270*****MOVE  KOLRF3-BC   TO  HI-BC.                                 D.091002
012280*****MOVE  KOLRF3-ISU  TO  HI-ISU.                                D.091002
012290*****MOVE  KOLRF3-SB   TO  HI-SB.                                 D.091002
012300*****MOVE  KOLRF3-FT   TO  HI-FT.                                 D.091002
012310*****MOVE  KOLRF3-KT   TO  HI-KT.                                 D.091002
012320*****MOVE  KOLRF3-TCD  TO  HI-TCD.                                D.091002
012330*****MOVE  KOLRF3-ISU  TO  HI-ISU.                                D.091002
012340*****MOVE  KOLRF3-SCC  TO  HI-SCC.                                D.091002
012350*****MOVE  KOLRF3-BMC  TO  HI-BMC.                                D.091002
012360*****MOVE  KOLRF3-BMNO TO  HI-BMNO.                               D.091002
012370*****MOVE  KOLRF3-YG   TO  HI-YG.                                 D.091002
012380*****MOVE  KOLRF3-HKB  TO  HI-HKB.                                D.091002
012390*****MOVE  KOLRF3-HPV  TO  HI-HPV.                                D.091002
012400*****MOVE  KOLRF3-BC4  TO  HI-BC4.                                D.091002
012410*****MOVE  KOLRF3-SMS  TO  HI-SMS.                                D.091002
012420*****MOVE  KOLRF3-UNG  TO  HI-UNG.                                D.091002
012430*****MOVE  KOLRF3-NNG  TO  HI-NNG.                                D.091002
012440*****MOVE  KOLRF3-CS   TO  HI-CS.                                 D.091002
012450*****MOVE  KOLRF3-DNG  TO  HI-DNG.                                D.091002
012460*****MOVE  KOLRF3-SNG  TO  HI-SNG.                                D.091002
012470*****MOVE  KOLRF3-ENG  TO  HI-ENG.                                D.091002
012480*****PERFORM  MV31-RTN  THRU  MV31-RTN-EXIT                       D.091002
012490*****    VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10.           D.091002
012500*****REWRITE   HI-R    INVALID  KEY                               D.091002
012510*****                  MOVE  "HIM2"       TO    ERR-F             D.091002
012520*****                  MOVE  "R"          TO    ERR-M             D.091002
012530*****                  MOVE   HI-KEY2     TO    ERR-K             D.091002
012540*****                  MOVE   0           TO    ERR-LIN           D.091002
012550*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
012560*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012570***********************MOVE  255    TO    COMPLETION-CODE
012580*****                  STOP  RUN.                                 D.091002
012590*REW3-RTN-EXIT.                                                   D.091002
012600*****EXIT.                                                        D.091002
012610*--------------------------------------------------------------*
012620*REW4-RTN.                                                        D.091002
012630*****MOVE  KOLRF4-03   TO  WTNA-NAME.                             D.091002
012640*****MOVE  KOLRF4-04   TO  WTNA-BSC.                              D.091002
012650*****REWRITE   WTNA-R  INVALID  KEY                               D.091002
012660*****                  MOVE  "WTNAF"      TO    ERR-F             D.091002
012670*****                  MOVE  "R"          TO    ERR-M             D.091002
012680*****                  MOVE   WTNA-KEY    TO    ERR-K             D.091002
012690*****                  MOVE   0           TO    ERR-LIN           D.091002
012700*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
012710*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012720*****                  STOP  RUN.                                 D.091002
012730*REW4-RTN-EXIT.                                                   D.091002
012740*****EXIT.                                                        D.091002
012750*--------------------------------------------------------------*
012760*DLT2-RTN.                                                        D.091002
012770*****DELETE   TC-M     INVALID  KEY                               D.091002
012780*****                  MOVE  "TC-M"       TO    ERR-F             D.091002
012790*****                  MOVE  "D"          TO    ERR-M             D.091002
012800*****                  MOVE   TC-KEY      TO    ERR-K             D.091002
012810*****                  MOVE   0           TO    ERR-LIN           D.091002
012820*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
012830*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012840***********************MOVE  255    TO    COMPLETION-CODE
012850*****                  STOP  RUN.                                 D.091002
012860*DLT2-RTN-EXIT.                                                   D.091002
012870*****EXIT.                                                        D.091002
012880*--------------------------------------------------------------*
012890*DLT3-RTN.                                                        D.091002
012900*****DELETE   HI2-M    INVALID  KEY                               D.091002
012910*****                  MOVE  "HIM2"       TO    ERR-F             D.091002
012920*****                  MOVE  "D"          TO    ERR-M             D.091002
012930*****                  MOVE   HI-KEY2     TO    ERR-K             D.091002
012940*****                  MOVE   0           TO    ERR-LIN           D.091002
012950*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
012960*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
012970***********************MOVE  255    TO    COMPLETION-CODE
012980*****                  STOP  RUN.                                 D.091002
012990*DLT3-RTN-EXIT.                                                   D.091002
013000*****D.IT.                                                        D.091002
013010*--------------------------------------------------------------*
013020*DLT4-RTN.                                                        D.091002
013030*****DELETE   WTNAF    INVALID  KEY                               D.091002
013040*****                  MOVE  "WTNAF"      TO    ERR-F             D.091002
013050*****                  MOVE  "D"          TO    ERR-M             D.091002
013060*****                  MOVE   WTNA-KEY    TO    ERR-K             D.091002
013070*****                  MOVE   0           TO    ERR-LIN           D.091002
013080*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
013090*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
013100*****                  STOP  RUN.                                 D.091002
013110*DLT4-RTN-EXIT.                                                   D.091002
013120*****EXIT.                                                        D.091002
013130*--------------------------------------------------------------*
013140*MV31-RTN.                                                        D.091002
013150*****MOVE  KOLRF3-S1(NN)    TO  HI-S1(NN).                        D.091002
013160*****MOVE  KOLRF3-S2(NN)    TO  HI-S2(NN).                        D.091002
013170*****MOVE  KOLRF3-S3(NN)    TO  HI-S3(NN).                        D.091002
013180*****MOVE  KOLRF3-S4(NN)    TO  HI-S4(NN).                        D.091002
013190*MV31-RTN-EXIT.                                                   D.091002
013200*****EXIT.                                                        D.091002
013210*--------------------------------------------------------------*
013220 MV61-RTN.
013230     MOVE  JOLSF121-091(NN)  TO  JNIF1-091(NN).                   I.091002
013240*****MOVE  KOLRF121-091(NN)  TO  JNIF1-091(NN).                   D.091002
013250 MV61-RTN-EXIT.
013260     EXIT.
013270 MV61-RTN2.
013280     MOVE  JOLSF121-291(NN)  TO  JNIF1-091(NN).                   I.091002
013290*****MOVE  KOLRF121-291(NN)  TO  JNIF1-091(NN).                   D.091002
013300 MV61-RTN2-EXIT.
013310     EXIT.
013320*--------------------------------------------------------------*
013330*    E N D R  -  R T N                                         *
013340*--------------------------------------------------------------*
013350 ENDR-RTN.
013360*****OPEN   I-O    JOJF.                                          D.091002
013370*****MOVE   2      TO   JOJF-01.                                  D.091002
013380*****READ   JOJF        INVALID  KEY                              D.091002
013390*****                   GO TO ENDR-100.                           D.091002
013400*****MOVE  SPACE   TO   JOJF-REC.                                 D.091002
013410*****INITIALIZE         JOJF-REC.                                 D.091002
013420*****MOVE   2      TO   JOJF-01.                                  D.091002
013430*****REWRITE  JOJF-REC  INVALID  KEY                              D.091002
013440*****                  MOVE  "JOJF"       TO    ERR-F             D.091002
013450*****                  MOVE  "R"          TO    ERR-M             D.091002
013460*****                  MOVE   JOJF-KEY    TO    ERR-K             D.091002
013470*****                  MOVE   0           TO    ERR-LIN           D.091002
013480*****                  PERFORM  ERR-RTN   THRU  ERR-EX            D.091002
013490*****                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT     D.091002
013500***********************MOVE  255    TO    COMPLETION-CODE
013510*****                  STOP  RUN.                                 D.091002
013520*ENDR-100.                                                        D.091002
013530*****CLOSE         JOJF.                                          D.091002
013540*
013550*****OPEN  OUTPUT  KOLRF.                                         D.091002
013560*****CLOSE         KOLRF.                                         D.091002
013570     OPEN  OUTPUT  JOLSF.                                         I.091002
013580     CLOSE         JOLSF.                                         I.091002
013590*
013600 ENDR-RTN-EXIT.
013610     EXIT.
013620*--------------------------------------------------------------*
013630*    O P E N  -  R T N                                         *
013640*--------------------------------------------------------------*
013650 OPEN-RTN.
013660     OPEN   INPUT  JOLSF.                                         I.091002
013670*****OPEN   INPUT  KOLRF.                                         D.091002
013680*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013690*****    MOVE    "KOLRF"        TO    ERR-F                       D.091002
013700*****    MOVE    "O"            TO    ERR-M                       D.091002
013710*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
013720**
013730*****OPEN   I-O    JCON.                                          D.091002
013740*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013750*****    MOVE    "JCON"         TO    ERR-F                       D.091002
013760*****    MOVE    "O"            TO    ERR-M                       D.091002
013770*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
013780**
013790*****OPEN   I-O    TC-M.                                          D.091002
013800*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013810*****    MOVE    "TC-M"         TO    ERR-F                       D.091002
013820*****    MOVE    "O"            TO    ERR-M                       D.091002
013830*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
013840**
013850*****OPEN   I-O    HI2-M.                                         D.091002
013860*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013870*****    MOVE    "HI2-M"        TO    ERR-F                       D.091002
013880*****    MOVE    "O"            TO    ERR-M                       D.091002
013890*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
013900**
013910*****OPEN   I-O    WTNAF.                                         D.091002
013920*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013930*****    MOVE    "WTNAF"        TO    ERR-F                       D.091002
013940*****    MOVE    "O"            TO    ERR-M                       D.091002
013950******   PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
013960**
013970     OPEN   I-O    OKJF.
013980*****IF  ERR-STAT      NOT  =  "00"                               D.091002
013990*****    MOVE    "OKJF"         TO    ERR-F                       D.091002
014000*****    MOVE    "O"            TO    ERR-M                       D.091002
014010******   PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014020**
014030     OPEN   I-O    JNIF.
014040*****IF  ERR-STAT      NOT  =  "00"                               D.091002
014050*****    MOVE    "JNIF"         TO    ERR-F                       D.091002
014060*****    MOVE    "O"            TO    ERR-M                       D.091002
014070*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014080**
014090*****OPEN   I-O    TDNWF.                                         D.091002
014100*****IF  ERR-STAT      NOT  =  "00"                               D.091002
014110*****    MOVE    "TDNWF"        TO    ERR-F                       D.091002
014120*****    MOVE    "O"            TO    ERR-M                       D.091002
014130*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014140**
014150*****OPEN   I-O    TDNNF.                                         D.091002
014160*****IF  ERR-STAT      NOT  =  "00"                               D.091002
014170*****    MOVE    "TDNNF"        TO    ERR-F                       D.091002
014180*****    MOVE    "O"            TO    ERR-M                       D.091002
014190*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014200**
014210     IF  JS-SIGN      =  0                                        I.091002
014220         OPEN   I-O    TDNNF                                      I.091002
014230         OPEN   I-O    TDNWF                                      I.091002
014240         OPEN   I-O    TDIF                                       I.091222
014250     ELSE                                                         I.091222
014260         OPEN   I-O    TDNAF.                                     I.091222
014270*****    OPEN   I-O    TDIF.                                      D.091222
014280*****IF  ERR-STAT      NOT  =  "00"                               D.091002
014290*****    MOVE    "TDIF"         TO    ERR-F                       D.091002
014300*****    MOVE    "O"            TO    ERR-M                       D.091002
014310*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014320**
014330     OPEN   I-O    JSTR.
014340*****IF  ERR-STAT      NOT  =  "00"                               D.091002
014350*****    MOVE    "JSTR"         TO    ERR-F                       D.091002
014360*****    MOVE    "O"            TO    ERR-M                       D.091002
014370*****    PERFORM ERR-RTN        THRU  ERR-EX.                     D.091002
014380 OPEN-RTN-EXIT.
014390     EXIT.
014400*--------------------------------------------------------------*
014410*    C L S E  -  R T N                                         *
014420*--------------------------------------------------------------*
014430 CLSE-RTN.
014440     CLOSE  JOLSF JSTR  JNIF  OKJF.                               I.091002
014450     IF  JS-SIGN      =  0                                        I.091002
014460         CLOSE  TDNWF TDNNF TDIF.                                 I.091002
014470     IF  JS-SIGN      =  1                                        I.091222
014480         CLOSE  TDNAF.                                            I.091222
014490*****CLOSE  KOLRF JCON TC-M HI2-M WTNAF                           D.091002
014500*****       OKJF JNIF JSTR TDNWF TDNNF TDIF.                      D.091002
014510*****CLOSE  KOLRF JCON TC-M HI2-M OKJF JNIF JSTR TDNWF TDNNF.     D.080407
014520     OPEN    EXTEND     CHKF.                                     ++++++++
014530     ACCEPT  W-TIM      FROM  TIME.                               ++++++++
014540     INITIALIZE  CHKF-R.                                          ++++++++
014550     ACCEPT  CHKF-DATE  FROM  DATE.                               ++++++++
014560     MOVE    W-TIME     TO    CHKF-TIME.                          ++++++++
014570     MOVE    JS-SIGN    TO    CHKF-SIGN.                          ++++++++
014580     MOVE    9          TO    CHKF-SEN.                           ++++++++
014590     MOVE    "20U"      TO    CHKF-PRG.                           ++++++++
014600     WRITE   CHKF-R.                                              ++++++++
014610     CLOSE              CHKF.                                     ++++++++
014620 CLSE-RTN-EXIT.
014630     EXIT.
014640*--------------------------------------------------------------*
014650     COPY    LPERR.
