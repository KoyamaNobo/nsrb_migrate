000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JV010U.
000030************************************************************
000040*    PROGRAM         :  â◊éDïœä∑ópÉèÅ[ÉNçÏê¨               *
000050*    PRINTER TYPE    :  JIPS                               *
000060*    SCREEN          :  ______                             *
000070*    COMPILE TYPE    :  COBOL                              *
000080*    JS-W            :  0=ñ{é– , 2=ã ìá , 3=ëÅìá           *
000090************************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT WJNIF ASSIGN TO WJNIF-MSD.
000170     SELECT WKEIF ASSIGN TO WKEIF-MSD.
000180     SELECT JNIF ASSIGN TO JNIF-MSD
000190         ORGANIZATION INDEXED
000200         ACCESS MODE DYNAMIC
000210         RECORD KEY JNIF1-KEY
000220         FILE STATUS IS ERR-STAT.
000230     SELECT JCON ASSIGN TO JCON-MSD
000240         ORGANIZATION INDEXED
000250         ACCESS MODE RANDOM
000260         RECORD KEY JCON1-KEY
000270         FILE STATUS IS ERR-STAT.
000280     SELECT TC-M ASSIGN TO TC-MSD
000290         ORGANIZATION INDEXED
000300         ACCESS MODE RANDOM
000310         RECORD KEY TC-KEY
000320         FILE STATUS IS ERR-STAT.
000330     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000340         ORGANIZATION INDEXED
000350         ACCESS MODE RANDOM
000360         RECORD KEY HI-KEY
000370         ALTERNATE RECORD KEY HI-KEY2
000380         FILE STATUS IS ERR-STAT.
000390     SELECT CODEF ASSIGN TO CODEF-MSD CODEF2-MSD
000400         ORGANIZATION INDEXED
000410         ACCESS MODE DYNAMIC
000420         RECORD KEY CODE-KEY
000430         ALTERNATE RECORD KEY CODE-KEY2
000440         FILE STATUS IS ERR-STAT.
000450 I-O-CONTROL.
000460     APPLY SHARED-MODE ON JCON
000470     APPLY SHARED-MODE ON TC-M
000480     APPLY SHARED-MODE ON HI-M
000490     APPLY SHARED-MODE ON CODEF
000500     APPLY SHARED-MODE ON JNIF.
000510 DATA DIVISION.
000520 FILE SECTION.
000530     COPY L-JCON.
000540     COPY LITCM.
000550     COPY LIHIM.
000560     COPY L-JNIF.
000570     COPY LICODE.
000580 FD  WJNIF                                                        ∆Ã¿ﬁƒ◊›
000590     BLOCK    1     RECORDS
000600     LABEL    RECORD   STANDARD
000610     VALUE    OF  IDENTIFICATION  "NIFUDAW".
000620 01  WJNIF-R.
000630     02  WJNIF-KEY.                                               KEY
000640         03  WJNIF-01   PIC 9(6).                                 √ﬁ›ÀﬂÆ≥N
000650         03  WJNIF-02   PIC 9(1).                                 ∑ﬁÆ≥
000660     02  WJNIF-03       PIC 9(6).                                 À›∫∞ƒﬁ
000670     02  WJNIF-04       PIC 9(6).                                 À¬ﬁπ
000680     02  WJNIF-05       PIC 9(7).
000690     02  WJNIF-06       PIC 9(1).                                 ≥›ø≥
000700     02  WJNIF-07       PIC 9(1).                                 ø≥∫∞ƒﬁ
000710     02  WJNIF-08       PIC 9(3).                                 ∫Ω≥
000720     02  WJNIF-09       PIC 9(3).                                 ª≤ΩﬁÕﬁ¬
000730     02  WJNIF-SIZ      PIC X(4).                                 ª≤Ωﬁ
000740     02  WJNIF-JAN      PIC X(13).                                JAN
000750     02  WJNIF-10       PIC 9(1).                                 ≤›ºﬁª≤›
000760     02  WJNIF-11       PIC 9(1).                                 ∆≠≥ÿÆ∏
000770     02  WJNIF-12       PIC 9(1).                                 º≠Ø∂ª≤›
000780     02  WJNIF-13       PIC 9(3).                                 œ≤Ω≥
000790     02  WJNIF-13A      PIC 9(1).                                 àÍî ã≥àÁ
000800     02  WJNIF-15       PIC 9(2).
000810     02  WJNIF-14       PIC 9(6).                                 µ∏ÿºﬁÆ≥
000820     02  WJNIF-SUNO     PIC X(8).                                 Åß
000830     02  WJNIF-SJSU     PIC N(20).                                ºﬁ≠≥ºÆ≥¥
000840     02  WJNIF-SJSS     PIC N(20).                                ºﬁ≠≥ºÆº¿
000850     02  WJNIF-SNA      PIC N(26).                                µ∏ÿª∑“≤
000860     02  WJNIF-STEL     PIC X(14).                                TEL
000870     02  WJNIF-UNA      PIC N(6).
000880     02  WJNIF-MUNO     PIC X(8).                                 Åß
000890     02  WJNIF-MJSU     PIC N(20).                                ºﬁ≠≥ºÆ≥¥
000900     02  WJNIF-MJSS     PIC N(20).                                ºﬁ≠≥ºÆº¿
000910     02  WJNIF-MNA      PIC N(26).                                µ∏ÿª∑“≤
000920     02  WJNIF-MTEL     PIC X(14).                                TEL
000930     02  WJNIF-SOK      PIC N(6).
000940     02  WJNIF-HNA      PIC N(24).                                À›∫∞ƒﬁ
000950     02  WJNIF-TEK      PIC N(32).                                √∑÷≥
000960     02  WJNIF-BAN      PIC 9(6).                                 NEW NO
000970     02  WJNIF-GYO      PIC 9(3).                                 NEW NO
000980 FD  WKEIF                                                        ∆Ã¿ﬁƒ◊›
000990     BLOCK    4     RECORDS
001000     LABEL    RECORD   STANDARD
001010     VALUE    OF  IDENTIFICATION  WK0064ID.
001020 01  WKEIF-R.
001030     02  WKEIF-BAN      PIC 9(6).                                 NEW NO
001040     02  WKEIF-KEI      PIC 9(4).
001050     02  F              PIC X(54).
001060 WORKING-STORAGE  SECTION.
001070 77  ERR-STAT           PIC  X(002).
001080 77  W-FILE             PIC  X(013).
001090 77  W-END              PIC  9(001) VALUE 0.
001100 77  JS-SIGN                   PIC X(01).
001110 77  JS-W                      PIC X(01).
001120 77  WK0064ID           PIC  X(009) VALUE SPACE.
001130 01  STN-NO.
001140     02  STN-NO1        PIC  X(003).
001150     02  STN-NO2        PIC  X(003).
001160 01  W-FID2.
001170     02  W-FID21        PIC  X(006) VALUE "WK0064".
001180     02  W-FID22        PIC  X(003).
001190 01  W-DATA.
001200     02  W-SEN                 PIC 9(01).
001210     02  W-SDNO                PIC 9(06).
001220     02  W-EDNO                PIC 9(06).
001230     02  W-NGP.
001240       03  F                   PIC 9(02).
001250       03  W-NGPS              PIC 9(06).
001260     02  W-NGPL              REDEFINES  W-NGP.
001270       03  W-NEN               PIC 9(04).
001280       03  W-NENL            REDEFINES  W-NEN.
001290         04  W-NEN1            PIC 9(02).
001300         04  W-NEN2            PIC 9(02).
001310       03  F                   PIC 9(04).
001320     02  W-SDATE               PIC 9(08).
001330     02  W-EDATE               PIC 9(08).
001340     02  W-SNGP.
001350       03  W-SNEN              PIC 9(04).
001360       03  W-SNENL           REDEFINES  W-SNEN.
001370         04  W-SNEN1           PIC 9(02).
001380         04  W-SNEN2           PIC 9(02).
001390       03  W-SGET              PIC 9(02).
001400       03  W-SPEY              PIC 9(02).
001410     02  W-ENGP.
001420       03  W-ENEN              PIC 9(04).
001430       03  W-ENENL           REDEFINES  W-ENEN.
001440         04  W-ENEN1           PIC 9(02).
001450         04  W-ENEN2           PIC 9(02).
001460       03  W-EGET              PIC 9(02).
001470       03  W-EPEY              PIC 9(02).
001480     02  W-DMM          PIC  X(01).
001490     02  W-OKJ          PIC  9(06).
001500     02  W-BAN          PIC  9(06).
001510     02  W-KSU          PIC  9(04).                               I.110124
001520     02  W-KEI          PIC  9(04).
001530     02  W-GYO          PIC  9(03).
001540     02  W-NNO.
001550       03  W-NNO1       PIC 9(6).
001560       03  W-NNO2       PIC 9(1).
001570     02  W-KEY.
001580       03  W-NO         PIC 9(06).
001590       03  W-GNO        PIC 9(01).
001600     02  W-SET          PIC 9(01).                                I.110124
001610     02  W-MAI          PIC 9(03).                                I.110124
001620     02  W-MAIC         PIC 9(03).                                I.110124
001630     02  W-UNA          PIC  N(06).
001640     02  W-SOK          PIC  N(06).
001650     02  W-TEK          PIC N(32).                                √∑÷≥
001660     02  W-TEKD   REDEFINES W-TEK.
001670       03  W-TEK1       PIC N(09).
001680       03  W-TEK2       PIC N(23).
001690     02  W-TEKI.                                                  I.100804
001700       03  F            PIC N(04).                                I.100804
001710       03  W-TEKI2      PIC N(19).                                I.100804
001720     02  W-UNOM.
001730       03  W-UNM   OCCURS  8.
001740         04  W-UM       PIC X(01).
001750     02  W-UNOD.
001760       03  W-UND   OCCURS  8.
001770         04  W-UD       PIC X(01).
001780     02  W-TELM.
001790       03  W-TEM   OCCURS 14.
001800         04  W-TM       PIC X(01).
001810     02  W-TELD.
001820       03  W-TED   OCCURS 14.
001830         04  W-TD       PIC X(01).
001840*
001850     02  W-HCD          PIC  9(06).
001860     02  W-SIZN         PIC  X(04).
001870     02  W-SIZND REDEFINES W-SIZN.
001880       03  W-SIZF       PIC  X(03).
001890       03  W-SIZR       PIC  X(01).
001900     02  W-JAN          PIC  X(13).
001910     02  CNT            PIC  9(02).
001920     02  W-SCC          PIC  9(001).
001930     02  W-SC           PIC  9(001).
001940     02  W-C            PIC  9(002).
001950     02  W-CC           PIC  9(002).
001960     02  W-ASID.
001970       03  W-ASI   OCCURS   5.
001980         04  W-SID   OCCURS  10.
001990           05  W-SI     PIC  X(004).
002000     02  W-MSI.
002010       03  F            PIC  X(040) VALUE
002020            "          SS   S   M   L  LL  XL XXL    ".
002030       03  F            PIC  X(040) VALUE
002040            "                            28.029.030.0".
002050       03  F            PIC  X(040) VALUE
002060            "12.513.013.514.015.016.017.018.019.020.0".
002070       03  F            PIC  X(040) VALUE
002080            "21.021.522.022.523.023.524.024.525.0    ".
002090       03  F            PIC  X(040) VALUE
002100            "24.024.525.025.526.026.527.027.5        ".
002110     02  W-ASIZD.
002120       03  W-ASIZ  OCCURS   2.
002130         04  W-SIZD  OCCURS  27.
002140           05  W-SIZ    PIC  X(004).
002150     02  W-MSIZ.
002160       03  F            PIC  X(040) VALUE
002170            "12.513.013.514.015.016.017.018.019.020.0".
002180       03  F            PIC  X(040) VALUE
002190            "21.021.522.022.523.023.524.024.525.025.5".
002200       03  F            PIC  X(028) VALUE
002210            "26.026.527.027.528.029.030.0".
002220       03  F            PIC  X(040) VALUE
002230            "          SS   S   M   L  LL            ".
002240       03  F            PIC  X(040) VALUE
002250            "                                        ".
002260       03  F            PIC  X(028) VALUE
002270            "                  XL XXL    ".
002280     COPY LSTAT.
002290 SCREEN SECTION.
002300 SD  C-CRT
002310     END STATUS IS ESTAT.
002320 01  C-CLEAR.
002330     02  C-CL    LINE   1  CLEAR SCREEN.
002340 01  C-MID.
002350     02  LINE   1  COLUMN  16  PIC  N(020) VALUE
002360          NC"ÅñÅñÅñÅ@Å@â◊éDïœä∑ópÉèÅ[ÉNçÏê¨Å@Å@ÅñÅñÅñ".
002370     02  LINE   7.
002380         03  COLUMN  25  VALUE  NC"ÇPÅ@î≠Å@çs".
002390     02  LINE   9.
002400         03  COLUMN  25  VALUE  NC"ÇQÅ@çƒî≠çsÅ@Å@ëIë".
002410         03  COLUMN  44  VALUE  "[ ]".
002420     02  LINE  14.
002430         03  COLUMN  21  VALUE  NC"ÇeÇqÇnÇl".
002440     02  LINE  16.
002450         03  COLUMN  21  VALUE  NC"ÇsÇn".
002460     02  LINE  23.
002470         03  COLUMN  41  VALUE  NC"ämîFÅi".
002480         03  COLUMN  47  VALUE  "OK=1,NO=9".
002490         03  COLUMN  56  VALUE  NC"Åj".
002500         03  COLUMN  58  VALUE  "---> ÿ¿∞›".
002510 01  C-DSP.
002520     02  D-DNOM.
002530       03  LINE  12    COLUMN  31    VALUE  NC"ì`ï[áÇ".
002540       03  LINE  14    COLUMN  31    VALUE  "        ".
002550       03  LINE  16    COLUMN  31    VALUE  "        ".
002560     02  D-DATM.
002570       03  LINE  12    COLUMN  31    VALUE  NC"ì˙Å@ït".
002580       03  LINE  14    COLUMN  31    VALUE  "  /  /  ".
002590       03  LINE  16    COLUMN  31    VALUE  "  /  /  ".
002600 01  C-ACP.
002610     02  A-SEN     LINE 9  COLUMN  45  PIC 9(01)
002620                 USING  W-SEN     CHECK  OVERFLOW  NO  IFC.
002630     02  A-SDNO    LINE 14 COLUMN  31  PIC 9(06)
002640                 USING  W-SDNO    CHECK  OVERFLOW  NO  IFC.
002650     02  A-EDNO    LINE 16 COLUMN  31  PIC 9(06)
002660                 USING  W-EDNO    CHECK  OVERFLOW  NO  IFC.
002670     02  A-SNGP  LINE  14.
002680       03  A-SNEN  COLUMN  31    PIC 9(02)
002690             USING  W-SNEN2  NO  IFC.
002700       03  A-SGET  COLUMN  34    PIC 9(02)
002710             USING  W-SGET   NO  IFC.
002720       03  A-SPEY  COLUMN  37    PIC 9(02)
002730             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.
002740     02  A-ENGP  LINE  16.
002750       03  A-ENEN  COLUMN  31    PIC 9(02)
002760             USING  W-ENEN2  NO  IFC.
002770       03  A-EGET  COLUMN  34    PIC 9(02)
002780             USING  W-EGET   NO  IFC.
002790       03  A-EPEY  COLUMN  37    PIC 9(02)
002800             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.
002810     02  A-DMM   LINE  23  COLUMN  62  PIC  9(001)
002820          USING W-DMM   CHECK OVERFLOW NO IFC.
002830 01  C-ERR.
002840     02  LINE  24.
002850       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002860            "***  DATA ≈º  ***".
002870       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
002880            "***  DATA ¥◊∞  ***".
002890       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
002900            "***  HIM ≈º  ***".
002910       03  E-ME4   COLUMN  15  PIC  X(016) VALUE
002920            "***  TCM ≈º  ***".
002930       03  E-ME5   COLUMN  15  PIC  X(021) VALUE
002940            "***  JCON ø≥∫ ≈º  ***".
002950       03  E-ME6   COLUMN  15  PIC  X(022) VALUE
002960            "***  JCON ≥›ø≥ ≈º  ***".
002970       03  E-ME7   COLUMN  15  PIC  X(017) VALUE
002980            "***  √∑÷≥ ≈º  ***".
002990       03  E-ME8   COLUMN  15  PIC  X(017) VALUE
003000            "***  ª≤Ωﬁ ≈º  ***".
003010       03  E-ME9   COLUMN  15  PIC  X(021) VALUE
003020            "***   ∞Ãª≤Ωﬁ ¥◊∞  ***".
003030       03  E-ME10  COLUMN  15  PIC  X(027) VALUE                  I.110124
003040            "***  JCON √ﬁ›ÀﬂÆ≥NO ≈º  ***".                        I.110124
003050       03  E-ME11  COLUMN  15  PIC  X(026) VALUE                  I.110124
003060            "***  JCON REWRITE ¥◊∞  ***".                         I.110124
003070       03  E-TCD   COLUMN  40  PIC  X(007) FROM  JNIF1-05.
003080       03  E-HCD   COLUMN  49  PIC  X(006) FROM  JNIF1-03.
003090       03  E-KEY   COLUMN  57  PIC  X(007) FROM  JNIF1-KEY.
003100     COPY LSSEM.
003110 PROCEDURE DIVISION.
003120 M-05.
003130     ACCEPT        JS-W.
003140     IF  JS-W       >  3
003150         MOVE 255 TO COMPLETION-CODE
003160         STOP RUN.
003170     IF  JS-W       =  0            MOVE  0       TO  JS-SIGN.
003180     IF  JS-W       =  2            MOVE  1       TO  JS-SIGN.
003190     IF  JS-W       =  3            MOVE  3       TO  JS-SIGN.
003200*
003210     DISPLAY C-CLEAR.
003220     DISPLAY C-MID.
003230*
003240     PERFORM ACP-RTN THRU ACP-EX.
003250     IF COMPLETION-CODE = 255
003260         GO TO M-95.
003270     MOVE W-MSIZ TO W-ASIZD.
003280     MOVE W-MSI TO W-ASID.
003290*
003300     CALL "CBLSTNNO" USING STN-NO.
003310     MOVE STN-NO2 TO W-FID22.
003320     MOVE W-FID2 TO WK0064ID.
003330     OPEN INPUT JNIF.
003340     OPEN INPUT CODEF.
003350*****OPEN INPUT JCON TC-M HI-M.                                   D.110124
003360     OPEN INPUT TC-M HI-M.                                        I.110124
003370     OPEN I-O JCON.                                               I.110124
003380     OPEN OUTPUT WJNIF WKEIF.
003390 M-10.
003400     READ JNIF NEXT RECORD WITH UNLOCK AT END
003410         GO TO M-90.                                              D.110201
003420*****    GO TO M-50.                                              D.110201
003430     IF JNIF1-02 = 7
003440         GO TO M-10.
003450     IF  W-SEN = 1
003460         IF  JNIF1-10  = 1
003470             GO TO M-10.
003480     IF  W-SEN = 2
003490         IF  JNIF1-10  = 0
003500             GO TO M-10.
003510     IF JNIF1-01 < W-SDNO OR > W-EDNO                             I.100802
003520         GO TO M-10.                                              I.100802
003530     IF  JS-SIGN  =  0
003540         IF   JNIF1-07    NOT =  1              GO  TO  M-10.
003550     IF  JS-SIGN  =  1
003560         IF   JNIF1-07    NOT =  6              GO  TO  M-10.
003570     IF  JS-SIGN  =  2
003580         IF   JNIF1-07    NOT =  7              GO  TO  M-10.
003590     IF  JS-SIGN  =  3
003600         IF   JNIF1-07    NOT =  4              GO  TO  M-10.
003610     MOVE ZERO TO W-NGP.
003620     MOVE 20 TO W-NEN1.
003630     MOVE JNIF1-04 TO W-NGPS.
003640     IF W-NGP < W-SNGP OR > W-ENGP
003650         GO TO M-10.
003660 M-15.
003670     MOVE JNIF1-KEY TO W-NNO.                                     I.110124
003680     MOVE JNIF1-14 TO W-OKJ.
003690     MOVE JNIF1-08 TO W-KSU.                                      I.110124
003700     MOVE JNIF1-13 TO W-MAI.                                      I.110124
003710     MOVE ZERO TO W-MAIC.                                         I.110124
003720*****MOVE ZERO TO W-GYO.                                          D.110124
003730*
003740     MOVE JNIF1-05 TO TC-KEY.
003750     READ TC-M WITH UNLOCK INVALID KEY
003760         MOVE SPACE TO TC-NAME TC-JSU TC-JSS TC-UNO TC-TEL
003770         DISPLAY E-ME4 E-TCD E-KEY E-ME99
003780         DISPLAY E-CL.
003790     PERFORM SPC-RTN THRU SPC-EX.
003800*
003810     MOVE 2 TO JCON2-01.
003820     MOVE JNIF1-06 TO JCON2-02.
003830     READ JCON WITH UNLOCK INVALID KEY
003840         MOVE SPACE TO JCON2-03
003850         DISPLAY E-ME6 E-KEY E-ME99
003860         DISPLAY E-CL.
003870     MOVE JCON2-03 TO W-UNA.
003880*
003890     MOVE 3 TO JCON3-01.
003900     MOVE JNIF1-07 TO JCON3-02.
003910     READ JCON WITH UNLOCK INVALID KEY
003920         MOVE SPACE TO JCON3-03
003930         DISPLAY E-ME5 E-KEY E-ME99
003940         DISPLAY E-CL.
003950     MOVE JCON3-03 TO W-SOK.
003960     IF  JNIF1-07    =   1
003970         IF  JNIF1-051   =   2654  OR  2656  OR  2657  OR  4038
003980                                   OR  4054  OR  4056  OR  4057
003990             MOVE      NC"ïxÅ@émÅ@Å@Å@"  TO       W-SOK.
004000*****MOVE JNIF1-KEY TO W-NNO.                                     D.110124
004010     MOVE W-NNO TO JNIF2-KEY.
004020     MOVE 7 TO JNIF2-02.
004030     READ JNIF WITH UNLOCK INVALID KEY
004040         MOVE SPACE TO JNIF2-02A JNIF2-03
004050         DISPLAY E-ME7 E-KEY E-ME99
004060         DISPLAY E-CL.
004070     MOVE JNIF2-02A TO W-TEK1.
004080     MOVE JNIF2-03 TO W-TEKI.                                     I.100803
004090     MOVE SPACE TO W-TEK2.                                        I.100803
004100     MOVE W-TEKI2 TO W-TEK2.                                      I.100803
004110*****MOVE JNIF2-03 TO W-TEK2.                                     D.100803
004120*
004130     MOVE W-NNO TO JNIF1-KEY.
004140     READ JNIF WITH UNLOCK INVALID KEY
004150         MOVE 255 TO COMPLETION-CODE
004160         DISPLAY E-ME2 E-KEY E-ME99
004170         GO TO M-90.                                              I.110201
004180*****    GO TO M-50.                                              D.110201
004190*****MOVE W-NNO1 TO W-BAN.                                        D.110124
004200     IF JNIF1-13 = 1                                              I.110124
004210         MOVE W-NNO1 TO W-BAN                                     I.110124
004220         MOVE ZERO TO W-GYO W-KEI                                 I.110124
004230         MOVE 0 TO W-SET                                          I.110124
004240         GO TO M-25.                                              I.110124
004250     MOVE 1 TO W-SET.                                             I.110124
004260 M-20.                                                            I.110124
004270     MOVE 13 TO JCON1-KEY.                                        I.110124
004280     READ JCON INVALID KEY                                        I.110124
004290         MOVE 255 TO COMPLETION-CODE                              I.110124
004300         DISPLAY E-ME10 E-KEY E-ME99                              I.110124
004310         GO TO M-90.                                              D.110201
004320*****    GO TO M-50.                                              D.110201
004330     MOVE JCON1-06 TO W-BAN.                                      I.110124
004340     ADD 1 TO W-BAN.                                              I.110124
004350     IF W-BAN = ZERO                                              I.110124
004360         MOVE 900001 TO W-BAN.                                    I.110124
004370     MOVE W-BAN TO JCON1-06.                                      I.110124
004380     REWRITE JCON1-R INVALID KEY                                  I.110124
004390         MOVE 255 TO COMPLETION-CODE                              I.110124
004400         DISPLAY E-ME11 E-KEY E-ME99                              I.110124
004410         GO TO M-90.                                              D.110201
004420*****    GO TO M-50.                                              D.110201
004430     MOVE ZERO TO W-GYO W-KEI.                                    I.110124
004440*****MOVE ZERO TO W-KEI.                                          D.110124
004450 M-25.
004460     MOVE JNIF1-KEY TO W-KEY.
004470     MOVE JNIF1-03 TO HI-KEY.
004480     READ HI-M WITH UNLOCK INVALID KEY
004490         MOVE SPACE TO HI-NAME HI-SMS
004500         MOVE 0 TO HI-HKB
004510         DISPLAY E-ME3 E-ME99
004520         DISPLAY E-CL.
004530*
004540     MOVE ZERO TO CNT.
004550 M-30.
004560     ADD 1 TO CNT.
004570     IF CNT > 27
004580         GO TO M-40.
004590     IF JNIF1-091(CNT) = ZERO
004600         GO TO M-30.
004610     IF HI-SSC = 0
004620         MOVE W-SIZ(1,CNT) TO W-SIZN
004630       ELSE
004640         MOVE W-SIZ(2,CNT) TO W-SIZN.
004650     PERFORM JAN-RTN THRU JAN-EX.
004660     IF COMPLETION-CODE = 255
004670         GO TO M-90.                                              I.110201
004680*****    GO TO M-50.                                              D.110201
004690     IF HI-HKB = 1
004700         IF W-SC = 2 OR 3
004710             MOVE 5 TO W-SIZR.
004720*
004730     INITIALIZE WJNIF-R.
004740     MOVE SPACE TO WJNIF-MJSU WJNIF-MJSS WJNIF-MNA.
004750     MOVE W-BAN TO WJNIF-BAN.
004760     ADD 1 TO W-GYO.
004770     MOVE W-GYO TO WJNIF-GYO.
004780     MOVE W-NO TO WJNIF-01.                                       KEY
004790     MOVE JNIF1-02  TO WJNIF-02.                                  KEY
004800     MOVE JNIF1-03 TO WJNIF-03.                                   À›∫∞ƒﬁ
004810     MOVE JNIF1-04 TO WJNIF-04.                                   À¬ﬁπ
004820     MOVE JNIF1-05 TO WJNIF-05.
004830     MOVE JNIF1-06 TO WJNIF-06.                                   ≥›ø≥
004840     MOVE JNIF1-07 TO WJNIF-07.                                   ø≥∫∞ƒﬁ
004850     MOVE W-KSU TO WJNIF-08.                                      I.110124
004860*****MOVE JNIF1-08 TO WJNIF-08.                                   D.110124
004870     MOVE JNIF1-091(CNT) TO WJNIF-09.                             ºØ∂Ω≥
004880     MOVE W-SIZN TO WJNIF-SIZ.                                    ª≤Ωﬁ
004890     MOVE W-JAN TO WJNIF-JAN.                                     JAN
004900     MOVE JNIF1-10 TO WJNIF-10.                                   ≤›ºﬁª≤›
004910     MOVE JNIF1-11 TO WJNIF-11.                                   ∆≠≥ÿÆ∏
004920     MOVE JNIF1-12 TO WJNIF-12.                                   º≠Ø∂ª≤›
004930     MOVE JNIF1-13 TO WJNIF-13.                                   œ≤Ω≥
004940     MOVE JNIF1-13A TO WJNIF-13A.                                 àÍî ã≥àÁ
004950     MOVE JNIF1-15 TO WJNIF-15.
004960     MOVE JNIF1-14 TO WJNIF-14.                                   µ∏ÿºﬁÆ≥
004970     MOVE W-UNOD TO WJNIF-SUNO.                                   Åß
004980     MOVE TC-JSU TO WJNIF-SJSU.                                   ºﬁ≠≥ºÆ≥¥
004990     MOVE TC-JSS TO WJNIF-SJSS.                                   ºﬁ≠≥ºÆº¿
005000     MOVE TC-NAME TO WJNIF-SNA.                                   µ∏ÿª∑“≤
005010     MOVE W-TELD TO WJNIF-STEL.                                   TEL
005020     MOVE W-UNA TO WJNIF-UNA.
005030     MOVE W-SOK TO WJNIF-SOK.
005040     IF HI-SMS = SPACE
005050         MOVE HI-NAME TO WJNIF-HNA
005060       ELSE
005070         MOVE HI-SMS TO WJNIF-HNA.                                À›∫∞ƒﬁ
005080     MOVE W-TEK TO WJNIF-TEK.                                     √∑÷≥
005090     IF  JNIF1-051       =  4038  OR  4054  OR  4056  OR  4057
005100         MOVE  "542-0081"       TO  WJNIF-MUNO
005110         MOVE  NC"ëÂç„ésíÜâõãÊìÏëDèÍÇPí¨ñ⁄ÇPÇPÅ|ÇXÅ@Å@Å@Å@"
005120                                                   TO WJNIF-MJSU
005130         MOVE NC"êÁã»éYã∆äîéÆâÔé–Å@Å@Å@Å@Å@Å@Å@Å@" TO WJNIF-MNA
005140         MOVE  "  06-6268-4561" TO  WJNIF-MTEL
005150         GO  TO M-35.
005160     IF  JNIF1-051       =  2654  OR  2656  OR  2657
005170         MOVE  "520-2132"       TO  WJNIF-MUNO
005180         MOVE  NC"é†âÍåßëÂí√ésê_óÃÇPÅ|ÇXÅ|ÇRÅ@" TO  WJNIF-MJSU
005190         MOVE  NC"äîéÆâÔé–êVì˙ñ{ã≥àÁÉVÉÖÅ[ÉYÅ@" TO  WJNIF-MNA
005200         MOVE  "  077-543-1331" TO  WJNIF-MTEL
005210         GO  TO M-35.
005220     IF  JNIF1-052   NOT =  001
005230         IF  JNIF1-051       =  0459
005240             MOVE  "663-8033"       TO  WJNIF-MUNO
005250             MOVE  NC"ï∫å…åßêºã{ésçÇñÿìåí¨ÇPÇTÅ|ÇP" TO  WJNIF-MJSU
005260             MOVE  NC"äîéÆâÔé–è„éRõâã∆Å@Å@" TO  WJNIF-MNA
005270             MOVE  "  0798-64-5111" TO  WJNIF-MTEL
005280             GO  TO M-35.
005290     IF  JNIF1-052   NOT =  001
005300         IF  JNIF1-051       =  0460
005310             MOVE  "663-8033"       TO  WJNIF-MUNO
005320             MOVE  NC"ï∫å…åßêºã{ésçÇñÿìåí¨ÇPÇTÅ|ÇP" TO  WJNIF-MJSU
005330             MOVE  NC"äîéÆâÔé–ÉEÉGÉÑÉ}Å@Å@" TO  WJNIF-MNA
005340             MOVE  "  0798-67-0810" TO  WJNIF-MTEL
005350             GO  TO M-35.
005360     IF  JNIF1-051       =  3015                                  I.110804
005370         MOVE  "114-0034"       TO  WJNIF-MUNO                    I.110804
005380         MOVE  NC"ìåãûìsñkãÊè„è\èÇSÅ|ÇPÅ|ÇTÅ@" TO  WJNIF-MJSU    I.110804
005390         MOVE  NC"äîéÆâÔé–ÉXÉMÉÑÉ}Å@Å@" TO  WJNIF-MNA             I.110804
005400         MOVE  "  03-3909-8883" TO  WJNIF-MTEL                    I.110804
005410         GO  TO M-35.                                             I.110804
005420     IF  JS-SIGN         =  0
005430         MOVE  "700-0975"       TO  WJNIF-MUNO
005440         MOVE  NC"â™éRésñkãÊç°ÇWíöñ⁄ÇPÇUÅ|ÇPÇV" TO  WJNIF-MJSU
005450         MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–Å@Å@" TO  WJNIF-MNA
005460     ELSE  IF  JS-SIGN         =  1
005470               MOVE  "713-8103"       TO  WJNIF-MUNO
005480               MOVE  NC"â™éRåßëqï~ésã ìáâ≥ìáéöêVñ©ÇWÇQÇUÇQÅ|ÇP"
005490                                                  TO  WJNIF-MJSU
005500               MOVE  NC"Å@Å@Å@Å@Å@êÖìáç`çëç€ï®ó¨ÉZÉìÉ^Å[ì‡"
005510                                                  TO  WJNIF-MJSS
005520               MOVE  NC"ì˙êiÉSÉÄáäÅ@ã ìáï®ó¨ÉZÉìÉ^Å["
005530                                                  TO  WJNIF-MNA
005540     ELSE  IF  JS-SIGN         =  2
005550               MOVE  "709-3717"       TO  WJNIF-MUNO
005560               MOVE  NC"â™éRåßãvïƒåSÅ@î¸çÁí¨å¥ìcÇRÇQÇQÇVÅ|ÇPÅ@"
005570                                                  TO  WJNIF-MJSU
005580               MOVE  NC"ì˙êiÉSÉÄáäÅ@í√éRï®ó¨ÉZÉìÉ^Å["
005590                                                  TO  WJNIF-MNA
005600     ELSE  IF  JS-SIGN         =  3
005610               MOVE  "701-0304"       TO  WJNIF-MUNO
005620               MOVE  NC"â™éRåßìsåEåSÅ@ëÅìáí¨ëÅìáÇSÇTÇOÇVÅ|ÇRÇV"
005630                                                  TO  WJNIF-MJSU
005640               MOVE  NC"Å@Å@Å@óºîıÇgÇcáäÅ@íÜélçëï®ó¨ÉZÉìÉ^Å[ì‡"
005650                                                  TO  WJNIF-MJSS
005660               MOVE  NC"ì˙êiÉSÉÄáäÅ@ëÅìáîzëóÉZÉìÉ^Å[Å@"
005670                                                  TO  WJNIF-MNA.
005680     MOVE  "  086-243-2456" TO  WJNIF-MTEL.
005690 M-35.
005700     WRITE WJNIF-R.
005710     ADD JNIF1-091(CNT) TO W-KEI.                                 ºØ∂Ω≥
005720     GO TO M-30.
005730 M-40.
005740     READ JNIF NEXT RECORD WITH UNLOCK AT END
005750         GO TO M-50.
005760     IF JNIF1-02 = 7
005770         GO TO M-40.
005780*
005790     IF  W-SEN = 1
005800         IF  JNIF1-10  = 1
005810             GO TO M-40.
005820     IF  W-SEN = 2
005830         IF  JNIF1-10  = 0
005840             GO TO M-40.
005850     IF JNIF1-01 < W-SDNO OR > W-EDNO                             I.100802
005860         GO TO M-40.                                              I.100802
005870     IF  JS-SIGN  =  0
005880         IF   JNIF1-07    NOT =  1              GO  TO  M-40.
005890     IF  JS-SIGN  =  1
005900         IF   JNIF1-07    NOT =  6              GO  TO  M-40.
005910     IF  JS-SIGN  =  2
005920         IF   JNIF1-07    NOT =  7              GO  TO  M-40.
005930     IF  JS-SIGN  =  3
005940         IF   JNIF1-07    NOT =  4              GO  TO  M-40.
005950     MOVE ZERO TO W-NGP.
005960     MOVE 20 TO W-NEN1.
005970     MOVE JNIF1-04 TO W-NGPS.
005980     IF W-NGP < W-SNGP OR > W-ENGP
005990         GO TO M-40.
006000*
006010     IF JNIF1-01 = W-NO
006020         GO TO M-25.
006030     IF JNIF1-14 = W-OKJ
006040*****    IF JNIF1-08 < 2                                          D.110124
006050         IF W-KSU < 2                                             I.110124
006060             GO TO M-25.
006070     MOVE SPACE TO WKEIF-R.
006080     MOVE W-BAN TO WKEIF-BAN.
006090     MOVE W-KEI TO WKEIF-KEI.
006100     WRITE WKEIF-R.
006110     IF W-SET = 0                                                 I.110124
006120         GO TO M-15.
006130*                                                                 æØƒ
006140     ADD 1 TO W-MAIC.                                             I.110124
006150     IF W-MAI NOT > W-MAIC                                        I.110124
006160         GO TO M-15.                                              I.110124
006170     MOVE W-NNO TO JNIF1-KEY.                                     I.110124
006180     READ JNIF WITH UNLOCK INVALID KEY                            I.110124
006190         MOVE 255 TO COMPLETION-CODE                              I.110124
006200         DISPLAY E-ME2 E-KEY E-ME99                               I.110124
006210         GO TO M-90.                                              I.110201
006220*****    GO TO M-50.                                              D.110201
006230     GO TO M-20.                                                  I.110124
006240 M-50.
006250     MOVE SPACE TO WKEIF-R.
006260     MOVE W-BAN TO WKEIF-BAN.
006270     MOVE W-KEI TO WKEIF-KEI.
006280     WRITE WKEIF-R.
006290     IF W-SET = 0                                                 I.110201
006300         GO TO M-90.                                              I.110201
006310*                                                                 æØƒ
006320     ADD 1 TO W-MAIC.                                             I.110201
006330     IF W-MAI NOT > W-MAIC                                        I.110201
006340         GO TO M-90.                                              I.110201
006350     MOVE W-NNO TO JNIF1-KEY.                                     I.110201
006360     READ JNIF WITH UNLOCK INVALID KEY                            I.110201
006370         MOVE 255 TO COMPLETION-CODE                              I.110201
006380         DISPLAY E-ME2 E-KEY E-ME99                               I.110201
006390         GO TO M-90.                                              I.110201
006400     GO TO M-20.                                                  I.110201
006410 M-90.                                                            I.110201
006420     CLOSE JNIF.
006430     CLOSE CODEF.
006440     CLOSE HI-M TC-M JCON.
006450     CLOSE WJNIF WKEIF.
006460 M-95.
006470     DISPLAY C-CLEAR.
006480     STOP RUN.
006490 ACP-RTN.
006500     ACCEPT A-SEN.
006510     DISPLAY E-CL.
006520     IF ESTAT = PF9
006530         MOVE 255 TO COMPLETION-CODE
006540         GO TO ACP-EX.
006550     IF ESTAT NOT = HTB AND SKP
006560         GO TO ACP-RTN.
006570     IF W-SEN NOT = 1 AND 2
006580         GO TO ACP-RTN.
006590     IF W-SEN = 2
006600         MOVE ZERO TO W-SNGP
006610         MOVE 99999999 TO W-ENGP
006620         DISPLAY D-DNOM
006630         GO TO ACP-100.
006640     PERFORM SEL-RTN THRU SEL-EX.
006650     IF W-SNGP = ZERO
006660         DISPLAY E-ME1
006670         GO TO ACP-RTN.
006680     DISPLAY D-DATM.
006690     MOVE ZERO TO W-SDNO.
006700     MOVE 999999 TO W-EDNO.
006710     GO TO ACP-900.
006720 ACP-100.
006730     ACCEPT A-SDNO.
006740     DISPLAY E-CL.
006750     IF ESTAT = PF9
006760         MOVE 255 TO COMPLETION-CODE
006770         GO TO ACP-EX.
006780     IF ESTAT = BTB
006790         GO TO ACP-RTN.
006800     IF ESTAT NOT = HTB AND SKP
006810         GO TO ACP-100.
006820 ACP-120.
006830     ACCEPT A-EDNO.
006840     DISPLAY E-CL.
006850     IF ESTAT = BTB
006860         GO TO ACP-RTN.
006870     IF ESTAT NOT = HTB AND SKP
006880         GO TO ACP-120.
006890     IF W-SDNO > W-EDNO
006900         GO TO ACP-120.
006910     GO TO ACP-900.
006920 ACP-200.
006930     ACCEPT A-SNEN.
006940     DISPLAY E-CL.
006950     IF ESTAT = PF9
006960         MOVE 255 TO COMPLETION-CODE
006970         GO TO ACP-EX.
006980     IF ESTAT = BTB
006990         GO TO ACP-RTN.
007000     IF ESTAT NOT = NOC AND HTB AND SKP
007010         GO TO ACP-200.
007020     MOVE 20 TO W-SNEN1.
007030 ACP-220.
007040     ACCEPT A-SGET.
007050     DISPLAY E-CL.
007060     IF ESTAT = BTB
007070         GO TO ACP-200.
007080     IF ESTAT NOT = NOC AND HTB AND SKP
007090         GO TO ACP-220.
007100     IF W-SGET < 1 OR > 12
007110         GO TO ACP-220.
007120 ACP-240.
007130     ACCEPT A-SPEY.
007140     DISPLAY E-CL.
007150     IF ESTAT = BTB
007160         GO TO ACP-220.
007170     IF ESTAT NOT = NOC AND HTB AND SKP
007180         GO TO ACP-240.
007190     IF W-SPEY < 1 OR > 31
007200         GO TO ACP-240.
007210     IF W-SNGP < W-SDATE OR > W-EDATE
007220         GO TO ACP-200.
007230 ACP-260.
007240     ACCEPT A-ENEN.
007250     DISPLAY E-CL.
007260     IF ESTAT = BTB
007270         GO TO ACP-240.
007280     IF ESTAT NOT = NOC AND HTB AND SKP
007290         GO TO ACP-260.
007300     MOVE 20 TO W-ENEN1.
007310 ACP-280.
007320     ACCEPT A-EGET.
007330     DISPLAY E-CL.
007340     IF ESTAT = BTB
007350         GO TO ACP-260.
007360     IF ESTAT NOT = NOC AND HTB AND SKP
007370         GO TO ACP-280.
007380     IF W-EGET < 1 OR > 12
007390         GO TO ACP-280.
007400 ACP-300.
007410     ACCEPT A-EPEY.
007420     DISPLAY E-CL.
007430     IF ESTAT = BTB
007440         GO TO ACP-280.
007450     IF ESTAT NOT = NOC AND HTB AND SKP
007460         GO TO ACP-300.
007470     IF W-EPEY < 1 OR > 31
007480         GO TO ACP-300.
007490     IF W-SNGP > W-ENGP
007500         GO TO ACP-260.
007510     IF W-ENGP < W-SDATE OR > W-EDATE
007520         GO TO ACP-260.
007530 ACP-900.
007540     ACCEPT A-DMM.
007550     IF ESTAT = PF9
007560         MOVE 255 TO COMPLETION-CODE
007570         GO TO ACP-EX.
007580     IF ESTAT = BTB
007590         IF W-SEN = 1
007600             GO TO ACP-200
007610           ELSE
007620             GO TO ACP-120.
007630     IF ESTAT NOT = HTB AND SKP
007640         GO TO ACP-900.
007650     IF W-DMM = 9
007660         MOVE 255 TO COMPLETION-CODE
007670         GO TO ACP-EX.
007680     IF W-DMM NOT = 1
007690         GO TO ACP-900.
007700 ACP-EX.
007710     EXIT.
007720 SEL-RTN.
007730     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.
007740     OPEN  INPUT  JNIF.
007750 SEL-010.
007760     READ  JNIF  NEXT  RECORD  WITH UNLOCK AT  END
007770         GO  TO  SEL-090.
007780     IF  JNIF1-10 = 1
007790         GO  TO  SEL-010.
007800     IF  JNIF1-02    =    7                     GO  TO  SEL-010.
007810     IF  JS-SIGN  =  0
007820         IF   JNIF1-07    NOT =  1              GO  TO  SEL-010.
007830     IF  JS-SIGN  =  1
007840         IF   JNIF1-07    NOT =  6              GO  TO  SEL-010.
007850     IF  JS-SIGN  =  2
007860         IF   JNIF1-07    NOT =  7              GO  TO  SEL-010.
007870     IF  JS-SIGN  =  3
007880         IF   JNIF1-07    NOT =  4              GO  TO  SEL-010.
007890     MOVE  ZERO     TO  W-NGP.
007900     MOVE  JNIF1-04  TO  W-NGPS.
007910     MOVE  20       TO  W-NEN1.
007920     IF  W-SDATE = ZERO
007930         MOVE  W-NGP  TO  W-SDATE.
007940     IF  W-SDATE > W-NGP
007950         MOVE  W-NGP  TO  W-SDATE.
007960     IF  W-EDATE < W-NGP
007970         MOVE  W-NGP  TO  W-EDATE.
007980     GO  TO  SEL-010.
007990 SEL-090.
008000     CLOSE  JNIF.
008010     MOVE  W-SDATE  TO  W-SNGP.
008020     MOVE  W-EDATE  TO  W-ENGP.
008030 SEL-EX.
008040     EXIT.
008050 JAN-RTN.
008060     MOVE ZERO TO W-SC W-JAN.
008070 JAN-020.
008080     ADD 1 TO W-SC.
008090     IF W-SC > 5
008100         MOVE 255 TO COMPLETION-CODE
008110         DISPLAY E-ME8 E-HCD E-KEY E-ME99
008120         GO TO JAN-EX.
008130     MOVE ZERO TO W-C.
008140 JAN-030.
008150     ADD 1 TO W-C.
008160     IF W-C > 10
008170         GO TO JAN-020.
008180     IF W-SIZN NOT = W-SI(W-SC,W-C)
008190         GO TO JAN-030.
008200     IF W-SC > 1
008210         COMPUTE W-SCC = W-SC - 1
008220       ELSE
008230         MOVE W-SC TO W-SCC.
008240     IF HI-S(W-SCC,W-C) = 0
008250         GO TO JAN-030.
008260     MOVE SPACE TO CODE-KEY2.
008270     MOVE JNIF1-03 TO CODE-HCD20.
008280     MOVE W-SCC TO CODE-SIZ2.
008290     MOVE W-C TO CODE-SNO2.
008300     START CODEF KEY NOT < CODE-KEY2 INVALID KEY
008310         MOVE ZERO TO CODE-JAN
008320         GO TO JAN-090.
008330 JAN-040.
008340     READ CODEF NEXT RECORD WITH UNLOCK AT END
008350         MOVE ZERO TO CODE-JAN
008360         GO TO JAN-090.
008370     IF CODE-TCD NOT = ZERO
008380         GO TO JAN-040.
008390     IF (JNIF1-03 NOT = CODE-HCD20) OR
008400        (W-SCC NOT = CODE-SIZ2) OR
008410        (W-C NOT = CODE-SNO2)
008420         MOVE ZERO TO CODE-JAN
008430         GO TO JAN-090.
008440 JAN-090.
008450     MOVE CODE-JAN TO W-JAN.
008460 JAN-EX.
008470     EXIT.
008480 SPC-RTN.
008490     MOVE SPACE TO W-UNOM W-UNOD.
008500     MOVE TC-UNO TO W-UNOM.
008510     IF W-UNOM = SPACE
008520         GO TO SPC-110.
008530     IF W-UM(8) NOT = SPACE
008540         MOVE W-UNOM TO W-UNOD
008550         GO TO SPC-110.
008560     MOVE 9 TO W-C W-CC.
008570 SPC-010.
008580     SUBTRACT 1 FROM W-C.
008590     IF W-C = ZERO
008600         GO TO SPC-110.
008610     IF W-UM(W-C) = SPACE
008620         GO TO SPC-010.
008630     SUBTRACT 1 FROM W-CC.
008640 SPC-020.
008650     MOVE W-UM(W-C) TO W-UD(W-CC).
008660     SUBTRACT 1 FROM W-C W-CC.
008670     IF W-C NOT = ZERO
008680         GO TO SPC-020.
008690 SPC-110.
008700     MOVE SPACE TO W-TELM W-TELD.
008710     MOVE TC-TEL TO W-TELM.
008720     IF W-TELM = SPACE
008730         GO TO SPC-EX.
008740     IF W-TM(14) NOT = SPACE
008750         MOVE W-TELM TO W-TELD
008760         GO TO SPC-EX.
008770     MOVE 15 TO W-C W-CC.
008780 SPC-120.
008790     SUBTRACT 1 FROM W-C.
008800     IF W-C = ZERO
008810         GO TO SPC-EX.
008820     IF W-TM(W-C) = SPACE
008830         GO TO SPC-120.
008840     SUBTRACT 1 FROM W-CC.
008850 SPC-130.
008860     MOVE W-TM(W-C) TO W-TD(W-CC).
008870     SUBTRACT 1 FROM W-C W-CC.
008880     IF W-C NOT = ZERO
008890         GO TO SPC-130.
008900 SPC-EX.
008910     EXIT.
