000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JK044R.
000030*********************************************************
000040*    PROGRAM         :  ìùàÍì`ï[Å@ñ‚çáÇπÅiê‘ÇøÇ·ÇÒñ{ï‹Åj*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SJK044                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT TDNAF ASSIGN TO TDNA-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE DYNAMIC
000180         RECORD KEY TDNA-KEY
000190         FILE STATUS IS ERR-STAT.
000200 I-O-CONTROL.
000210     APPLY SHARED-MODE ON TDNAF.
000220 DATA DIVISION.
000230 FILE SECTION.
000240     COPY LITDNA.
000250 WORKING-STORAGE  SECTION.
000260 77  ERR-STAT           PIC  X(002).
000270 77  W-FILE             PIC  X(013).
000280 01  W-DATA.
000290     02  W-SED.
000300       03  W-SSTC       PIC  9(007).
000310       03  W-ESTC       PIC  9(007).
000320*****  03  W-SDNO       PIC  9(006).                              D.100901
000330*****  03  W-EDNO       PIC  9(006).                              D.100901
000340       03  W-SDNO       PIC  9(007).                              I.100901
000350       03  W-EDNO       PIC  9(007).                              I.100901
000360     02  W-DMM          PIC  9(001).
000370     02  W-KEY.
000380       04  W-STC        PIC  9(007).
000390*****  04  W-DNO        PIC  9(006).                              D.100901
000400       04  W-DNO        PIC  9(007).                              I.100901
000410     02  W-DC           PIC  9(001).
000420     02  W-L            PIC  9(002).
000430     02  W-NRC          PIC  N(002).
000440     02  W-PC           PIC  N(001).
000450     COPY LSTAT.
000460 SCREEN SECTION.
000470 SD  C-CRT
000480     END STATUS IS ESTAT.
000490 01  C-CLEAR.
000500     02  C-CL    LINE   1  CLEAR SCREEN.
000510 01  C-MID.
000520     02  LINE   1  COLUMN  24  PIC  N(016) VALUE
000530          NC"ê‘ÇøÇ·ÇÒñ{ï‹Å@ìùàÍì`ï[áÇÅ@ñ‚çáÇπ".
000540     02  LINE  23  COLUMN  43  PIC  X(028) VALUE
000550          "ämîF (OK=1,NO=9) --->   ÿ¿∞›".
000560 01  C-ACP.
000570     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
000580          USING W-DMM   CHECK OVERFLOW NO IFC.
000590 01  C-DSP.
000600     02  D-MEI   LINE W-L.
000610       03  COLUMN   1  PIC  9(007)   FROM  TDNA-STC.
000620       03  COLUMN   9  PIC  N(014)   FROM  TDNA-TNA.
000630*****  03  COLUMN  38  PIC  9(006)   FROM  TDNA-DNO.              D.100901
000640       03  COLUMN  37  PIC  9(007)   FROM  TDNA-DNO.              I.100901
000650       03  COLUMN  45  PIC  9(009)   FROM  TDNA-HNO.
000660       03  COLUMN  55  PIC 99/99/99  FROM  TDNA-HNGP.
000670       03  COLUMN  64  PIC 99/99/99  FROM  TDNA-NNGP.
000680       03  COLUMN  73  PIC  N(002)   FROM  W-NRC.
000690       03  COLUMN  78  PIC  N(001)   FROM  W-PC.
000700     02  E-END   LINE  23  COLUMN  41  PIC  N(011) VALUE
000710          NC"ÇdÇmÇcÅ@ÇcÇ`ÇsÇ`".
000720 01  C-ERR.
000730     02  LINE  24.
000740       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
000750            "***  DATA ≈º  ***".
000760     COPY LSSEM.
000770 PROCEDURE DIVISION.
000780 M-05.
000790     DISPLAY C-CLEAR.
000800     CALL "SJK044".
000810     MOVE 0 TO W-DC.
000820     MOVE 3 TO W-L.
000830     OPEN INPUT TDNAF.
000840     READ TDNAF NEXT RECORD WITH UNLOCK AT END
000850         GO TO M-90.
000860 M-50.
000870     MOVE TDNA-STC TO W-STC.
000880     MOVE TDNA-DNO TO W-DNO.
000890     MOVE SPACE TO W-NRC W-PC.
000900     IF TDNA-NRC = 0
000910         MOVE NC"éÛêM" TO W-NRC.
000920     IF TDNA-NRC = 1
000930         MOVE NC"ì¸óÕ" TO W-NRC.
000940     IF TDNA-PC = 9
000950         MOVE NC"çœ" TO W-PC
000960       ELSE
000970         MOVE NC"ñ¢" TO W-PC.
000980     IF W-DC = 0
000990         MOVE 1 TO W-DC.
001000 M-55.
001010     ADD 1 TO W-L.
001020     IF W-L NOT = 23
001030         DISPLAY D-MEI
001040         GO TO M-65.
001050 M-60.
001060     ACCEPT A-DMM.
001070     IF ESTAT NOT = HTB AND SKP
001080         GO TO M-60.
001090     IF W-DMM = 9
001100         GO TO M-90.
001110     IF W-DMM = 1
001120         DISPLAY C-CLEAR
001130         CALL "SJK044"
001140         MOVE 3 TO W-L
001150         GO TO M-55.
001160     GO TO M-60.
001170 M-65.
001180     READ TDNAF NEXT RECORD WITH UNLOCK AT END
001190         GO TO M-90.
001200     IF (TDNA-STC = W-STC) AND (TDNA-DNO = W-DNO)
001210         GO TO M-65.
001220     GO TO M-50.
001230 M-90.
001240     IF W-DC = 0
001250         DISPLAY E-ME1.
001260     DISPLAY E-END.
001270     ACCEPT A-DMM.
001280     CLOSE TDNAF.
001290 M-95.
001300     DISPLAY C-CLEAR.
001310     STOP RUN.
