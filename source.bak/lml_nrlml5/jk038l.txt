000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JK038L.
000030******************************************************************
000040*    ã ìáÅ@ì¸â◊ïiñºèWåvï\                                        *
000050*****JS-SIGN : ëSïî=0 , ‹∞∏œ›=1 , ≈Ã∫=2                          *
000060******************************************************************
000070*
000080 ENVIRONMENT       DIVISION.
000090 CONFIGURATION     SECTION.
000100 SOURCE-COMPUTER.  SYSTEM3100.
000110 OBJECT-COMPUTER.  SYSTEM3100.
000120 INPUT-OUTPUT      SECTION.
000130 FILE-CONTROL.
000140     SELECT  JNSRF   ASSIGN  JNSR-MSD.                            I.090928
000150     SELECT  HI2-M  ASSIGN  HI2-MSD                               I.090928
000160                    ORGANIZATION  INDEXED
000170                    ACCESS  MODE  RANDOM
000180                    RECORD  KEY   HI-KEY2.
000190     SELECT  PRN-F  ASSIGN  PRF-PRN999.
000200 I-O-CONTROL.
000210     APPLY  SHARED-MODE  ON  HI2-M                                I.090928
000220     APPLY  SHIFT-CODE   ON  PRN-F.
000230
000240 DATA              DIVISION.
000250 FILE              SECTION.
000260     COPY  LIHIM2.
000270 FD  JNSRF                                                        I.090928
000280     BLOCK    1     RECORDS                                       I.090928
000290     LABEL    RECORD   STANDARD                                   I.090928
000300     VALUE    OF  IDENTIFICATION  WK0256ID.                       I.090928
000310 01  JNSR-R.                                                      I.090928
000320     02   JNSR-01               PIC 9(6)  COMP-3.                 ïiñº
000330     02   JNSR-02               PIC 9(8)  COMP-3.                 ì˙ït
000340     02   F                     PIC X(7).
000350     02   JNSR-06               PIC 9(1).                         ëq
000360     02   JNSR-07               PIC 9(1).                         ª≤Ωﬁ
000370     02   JNSR-08.
000380          03  JNSR-080    OCCURS  10.
000390              04  JNSR-081      PIC S9(4)  COMP-3.
000400     02   F                     PIC X(208).
000410 FD  PRN-F
000420     LABEL  RECORD  OMITTED
000430     LINAGE  66.
000440 01  PRN-R                 PIC X(256).
000450 WORKING-STORAGE   SECTION.
000460*77  JS-SIGN            PIC  9(1).                                I.100914
000470 77  WK0256ID           PIC  X(009) VALUE SPACE.                  I.090928
000480 01  STN-NO.                                                      I.090928
000490     02  STN-NO1        PIC  X(003).                              I.090928
000500     02  STN-NO2        PIC  X(003).                              I.090928
000510 01  W-FID.                                                       I.090928
000520     02  W-FID1         PIC  X(006) VALUE "WK0256".               I.090928
000530     02  W-FID2         PIC  X(003).                              I.090928
000540 01  END-SW                PIC 9      VALUE 0.
000550 01  RED-SW                PIC 9      VALUE 0.
000560 01  DAT-SW                PIC 9      VALUE 0.
000570 01  MID1-R.
000580     02  W-20K             PIC X(5)   VALUE ""3FE04FE080"".       I.090928
000590     02  M1-SAI            PIC N(1).
000600     02  F                 PIC X(02)  VALUE SPACE.
000610     02  M1-SNGP           PIC 99/99/99.
000620     02  F                 PIC N(1)   VALUE NC"Å`".
000630     02  M1-ENGP           PIC 99/99/99.
000640     02  F                 PIC X(13)  VALUE SPACE.
000650     02  F                 PIC N(20)  VALUE                       I.100914
000660          NC"ÅñÅñÅñÅ@Å@ã ìáÅ@ì¸â◊ïiñºèWåvï\Å@Å@ÅñÅñÅñ".           I.100914
000670     02  F                 PIC X(16)  VALUE SPACE.
000680     02  F                 PIC X(5)   VALUE "DATE ".
000690     02  M1-DATE           PIC 99/99/99.
000700     02  F                 PIC X(7)   VALUE "     P.".
000710     02  M1-PAGE           PIC Z9.
000720 01  MID2-R.
000730     02  W-15K             PIC X(5)   VALUE ""3FE04F40A0"".       I.090928
000740     02  F                 PIC X(7)   VALUE " ∫∞ƒﬁ  ".
000750     02  F                 PIC N(8)   VALUE
000760          NC"ïiÅ@Å@Å@Å@Å@ñºÅ@".
000770     02  F                 PIC X(25)  VALUE SPACE.
000780     02  F                 PIC X(1)   VALUE "1".
000790     02  F                 PIC X(16)  VALUE SPACE.
000800     02  F                 PIC X(2)   VALUE "SS".
000810     02  F                 PIC X(5)   VALUE SPACE.
000820     02  F                 PIC X(1)   VALUE "S".
000830     02  F                 PIC X(5)   VALUE SPACE.
000840     02  F                 PIC X(1)   VALUE "M".
000850     02  F                 PIC X(5)   VALUE SPACE.
000860     02  F                 PIC X(1)   VALUE "L".
000870     02  F                 PIC X(4)   VALUE SPACE.
000880     02  F                 PIC X(2)   VALUE "LL".
000890     02  F                 PIC X(2)   VALUE SPACE.
000900     02  F                 PIC X(4)   VALUE "28.0".
000910     02  F                 PIC X(2)   VALUE SPACE.
000920     02  F                 PIC X(4)   VALUE "29.0".
000930     02  F                 PIC X(2)   VALUE SPACE.
000940     02  F                 PIC X(4)   VALUE "30.0".
000950     02  F                 PIC X(8)   VALUE SPACE.
000960 01  MID3-R.
000970     02  F                 PIC X(44)  VALUE SPACE.
000980     02  F                 PIC X(1)   VALUE "2".
000990     02  F                 PIC X(2)   VALUE SPACE.
001000     02  F                 PIC X(4)   VALUE "12.5".
001010     02  F                 PIC X(2)   VALUE SPACE.
001020     02  F                 PIC X(4)   VALUE "13.0".
001030     02  F                 PIC X(2)   VALUE SPACE.
001040     02  F                 PIC X(4)   VALUE "13.5".
001050     02  F                 PIC X(2)   VALUE SPACE.
001060     02  F                 PIC X(4)   VALUE "14.0".
001070     02  F                 PIC X(2)   VALUE SPACE.
001080     02  F                 PIC X(4)   VALUE "15.0".
001090     02  F                 PIC X(2)   VALUE SPACE.
001100     02  F                 PIC X(4)   VALUE "16.0".
001110     02  F                 PIC X(2)   VALUE SPACE.
001120     02  F                 PIC X(4)   VALUE "17.0".
001130     02  F                 PIC X(2)   VALUE SPACE.
001140     02  F                 PIC X(4)   VALUE "18.0".
001150     02  F                 PIC X(2)   VALUE SPACE.
001160     02  F                 PIC X(4)   VALUE "19.0".
001170     02  F                 PIC X(2)   VALUE SPACE.
001180     02  F                 PIC X(4)   VALUE "20.0".
001190     02  F                 PIC X(8)   VALUE SPACE.
001200 01  MID4-R.
001210     02  F                 PIC X(44)  VALUE SPACE.
001220     02  F                 PIC X(1)   VALUE "3".
001230     02  F                 PIC X(2)   VALUE SPACE.
001240     02  F                 PIC X(4)   VALUE "21.0".
001250     02  F                 PIC X(2)   VALUE SPACE.
001260     02  F                 PIC X(4)   VALUE "21.5".
001270     02  F                 PIC X(2)   VALUE SPACE.
001280     02  F                 PIC X(4)   VALUE "22.0".
001290     02  F                 PIC X(2)   VALUE SPACE.
001300     02  F                 PIC X(4)   VALUE "22.5".
001310     02  F                 PIC X(2)   VALUE SPACE.
001320     02  F                 PIC X(4)   VALUE "23.0".
001330     02  F                 PIC X(2)   VALUE SPACE.
001340     02  F                 PIC X(4)   VALUE "23.5".
001350     02  F                 PIC X(2)   VALUE SPACE.
001360     02  F                 PIC X(4)   VALUE "24.0".
001370     02  F                 PIC X(2)   VALUE SPACE.
001380     02  F                 PIC X(4)   VALUE "24.5".
001390     02  F                 PIC X(2)   VALUE SPACE.
001400     02  F                 PIC X(4)   VALUE "25.0".
001410     02  F                 PIC X(14)  VALUE SPACE.
001420 01  MID5-R.
001430     02  F                 PIC X(44)  VALUE SPACE.
001440     02  F                 PIC X(1)   VALUE "4".
001450     02  F                 PIC X(2)   VALUE SPACE.
001460     02  F                 PIC X(4)   VALUE "24.0".
001470     02  F                 PIC X(2)   VALUE SPACE.
001480     02  F                 PIC X(4)   VALUE "24.5".
001490     02  F                 PIC X(2)   VALUE SPACE.
001500     02  F                 PIC X(4)   VALUE "25.0".
001510     02  F                 PIC X(2)   VALUE SPACE.
001520     02  F                 PIC X(4)   VALUE "25.5".
001530     02  F                 PIC X(2)   VALUE SPACE.
001540     02  F                 PIC X(4)   VALUE "26.0".
001550     02  F                 PIC X(2)   VALUE SPACE.
001560     02  F                 PIC X(4)   VALUE "26.5".
001570     02  F                 PIC X(2)   VALUE SPACE.
001580     02  F                 PIC X(4)   VALUE "27.0".
001590     02  F                 PIC X(2)   VALUE SPACE.
001600     02  F                 PIC X(4)   VALUE "27.5".
001610     02  F                 PIC X(17)  VALUE SPACE.
001620     02  F                 PIC N(2)   VALUE NC"çáåv".
001630 01  WR-R.
001640     02  WR-K1             PIC X(05).
001650     02  WR-HCD            PIC 9(06).
001660     02  F                 PIC X(01).
001670     02  WR-HNA            PIC N(24).
001680     02  F                 PIC X(01).
001690     02  WR-SIZ            PIC 9(01).
001700     02  WR-SU01           PIC -(06).
001710     02  WR-SU02           PIC -(06).
001720     02  WR-SU03           PIC -(06).
001730     02  WR-SU04           PIC -(06).
001740     02  WR-SU05           PIC -(06).
001750     02  WR-SU06           PIC -(06).
001760     02  WR-SU07           PIC -(06).
001770     02  WR-SU08           PIC -(06).
001780     02  WR-SU09           PIC -(06).
001790     02  WR-SU10           PIC -(06).
001800     02  WR-SUT            PIC ----,--9.
001810     02  WR-K2             PIC X(05).
001820 01  W-ASU.
001830     02  W-SUD       OCCURS   10.
001840       03  W-SU            PIC S9(5).
001850     02  W-SUT             PIC S9(6).
001860 01  WD-R.
001870     02   JNSW-01               PIC 9(6).                         ïiñº
001880     02   JNSW-02               PIC 9(8).                         ì˙ït
001890     02   JNSW-06               PIC 9(1).                         ëq
001900     02   JNSW-07               PIC 9(1).                         ª≤Ωﬁ
001910     02   JNSW-08.                                                êîó 
001920          03  JNSW-080    OCCURS  10.
001930              04  JNSW-081      PIC S9(4).
001940 01  W-KEI                 PIC S9(6).                             I.111221
001950 01  LCNT                  PIC 9(2).
001960 01  PAGE-C                PIC 9(2).
001970*01  SEN-W                 PIC 9.                                 ëIë-W
001980*01  DEN-WF                PIC 9(6).                              ì`ï[(FR)
001990*01  DEN-WT                PIC 9(6).                               ÅV (TO)
002000 01  KAKU-W                PIC 9.                                 ämîF-W
002010 01  ERR-STAT              PIC X(2).
002020 01  W-DATA.
002030     02  W-DATE            PIC 9(06).
002040     02  W-NGP    REDEFINES  W-DATE.
002050         03  W-NEN         PIC 9(02).
002060         03  W-GET         PIC 9(02).
002070         03  W-PEY         PIC 9(02).
002080     02  W-SDATE           PIC 9(08).
002090     02  W-EDATE           PIC 9(08).
002100     02  W-SNGP.
002110         03  W-SNEN        PIC 9(04).
002120         03  W-SNENL  REDEFINES W-SNEN.
002130             04  W-SNEN1   PIC 9(02).
002140             04  W-SNEN2   PIC 9(02).
002150         03  W-SGET        PIC 9(02).
002160         03  W-SPEY        PIC 9(02).
002170     02  W-SNGPD   REDEFINES W-SNGP.
002180       03  F               PIC 9(02).
002190       03  W-SNGPS         PIC 9(06).
002200     02  W-ENGP.
002210         03  W-ENEN        PIC 9(04).
002220         03  W-ENENL  REDEFINES W-ENEN.
002230             04  W-ENEN1   PIC 9(02).
002240             04  W-ENEN2   PIC 9(02).
002250         03  W-EGET        PIC 9(02).
002260         03  W-EPEY        PIC 9(02).
002270     02  W-ENGPD   REDEFINES W-ENGP.
002280       03  F               PIC 9(02).
002290       03  W-ENGPS         PIC 9(06).
002300     02  W-HCD.
002310       03  W-HCD1          PIC 9(4).
002320       03  W-HCD2          PIC 9(2).
002330     02  OLD-HCD.
002340       03  OLD-HCD1        PIC 9(4).
002350       03  OLD-HCD2        PIC 9(2).
002360     02  OLD-SIZ           PIC 9(1).
002370     COPY  LWMSG.
002380 SCREEN            SECTION.
002390 SD  GAMEN  END  STATUS  END-STS.
002400 01  ACP-NYURYOKU.
002410*****02  ACP-SEN   LINE   7.
002420*****    03  COLUMN  47  PIC 9     INTO  SEN-W
002430*****                              CHECK  OVERFLOW  NO  IFC.
002440     02  ACP-SNGP  LINE  17.
002450         03  ACP-SNEN  COLUMN  31  PIC 9(02) USING W-SNEN2
002460                                                    NO  IFC.
002470         03  ACP-SGET  COLUMN  34  PIC 9(02) USING W-SGET
002480                                                    NO  IFC.
002490         03  ACP-SPEY  COLUMN  37  PIC 9(02) USING W-SPEY
002500                                   CHECK  OVERFLOW  NO  IFC.
002510     02  ACP-ENGP  LINE  19.
002520         03  ACP-ENEN  COLUMN  31  PIC 9(02) USING W-ENEN2
002530                                                    NO  IFC.
002540         03  ACP-EGET  COLUMN  34  PIC 9(02) USING W-EGET
002550                                                    NO  IFC.
002560         03  ACP-EPEY  COLUMN  37  PIC 9(02) USING W-EPEY
002570                                   CHECK  OVERFLOW  NO  IFC.
002580*****02  ACP-DENF  LINE  17.
002590*****    03  COLUMN  41  PIC 9(6)  INTO  DEN-WF                   I.071205
002600*****                              CHECK  OVERFLOW  NO  IFC.
002610*****02  ACP-DENT  LINE  19.
002620*****    03  COLUMN  41  PIC 9(6)  INTO  DEN-WT                   I.071205
002630*****                              CHECK  OVERFLOW  NO  IFC.
002640     02  ACP-KAKU  LINE  24.
002650         03  COLUMN  63  PIC 9     INTO  KAKU-W
002660                                   CHECK  OVERFLOW  NO  IFC.
002670 01  DSP-GAMEN.
002680     02  LINE   1  COLUMN  30  VALUE                              I.100914
002690         NC"ã ìáÅ@ì¸â◊ïiñºèWåvï\" REVERSE.                        I.100914
002700     02  LINE   3.
002710         03  COLUMN   63  PIC 9(02)  FROM  W-NEN.
002720         03  COLUMN   65  PIC  N(01) VALUE NC"îN".
002730         03  COLUMN   67  PIC  9(02) FROM  W-GET.
002740         03  COLUMN   69  PIC  N(01) VALUE NC"åé".
002750         03  COLUMN   71  PIC  9(02) FROM  W-PEY.
002760         03  COLUMN   73  PIC  N(01) VALUE NC"ì˙".
002770*****02  LINE   5  COLUMN  23  VALUE  NC"ÇPÅ@éwê}ñ¢î≠çsï™".
002780*****02  LINE   7.
002790*****    03  COLUMN  23  VALUE NC"ÇQÅ@Å@Å@î≠çsçœï™Å@ëIë".
002800*****    03  COLUMN  46  VALUE   "[".
002810*****    03  COLUMN  48  VALUE   "]".
002820     02  LINE  15  COLUMN  31  VALUE  NC"ì˙Å@ït".                 I.071205
002830     02  LINE  17.                                                I.071205
002840         03  COLUMN  21  VALUE  NC"ÇeÇqÇnÇl".                     I.071205
002850         03  COLUMN  31  VALUE  "  /  /  ".                       I.071205
002860     02  LINE  19.                                                I.071205
002870         03  COLUMN  21  VALUE  NC"ÇsÇn".                         I.071205
002880         03  COLUMN  31  VALUE  "  /  /  ".                       I.071205
002890     02  LINE  24.
002900         03  COLUMN  41  VALUE  NC"ämîFÅi".
002910         03  COLUMN  47  VALUE    "OK=1,NO=9".
002920         03  COLUMN  56  VALUE  NC"Åj".
002930         03  COLUMN  58  VALUE    "--->  ÿ¿∞›".
002940*01  DSP-GAMEN0.                                                  I.111221
002950*****02  LINE   5  COLUMN  23  VALUE    "                ".       I.111221
002960*****02  LINE   7.                                                I.111221
002970*****    03  COLUMN  23  VALUE   "                      ".        I.111221
002980*****    03  COLUMN  46  VALUE   " ".                             I.111221
002990*****    03  COLUMN  48  VALUE   " ".                             I.111221
003000*01  DSP-GAMEN1.
003010*****02  DSP-MID0   LINE   1  COLUMN  20  VALUE                   I.111221
003020*****    NC"Å@ã Å@ìáÅ@" REVERSE.                                  I.111221
003030*****02  DSP-MID1   LINE   1  COLUMN  20  VALUE                   I.100914
003040*****    NC"ÉèÅ[ÉNÉ}Éì" REVERSE.                                  I.100914
003050*****02  DSP-MID2   LINE   1  COLUMN  20  VALUE                   I.100914
003060*****    NC"ÉiÅ@ÉtÅ@ÉR" REVERSE.                                  I.100914
003070*****02  DSP-DNOM   LINE  15  COLUMN  41  VALUE  NC"ì`ï[áÇ".      I.071205
003080*****02  DSP-DNOC   LINE  15  COLUMN  41  VALUE    "      ".      I.071205
003090 01  DSP-CLER  LINE   1.
003100     02  CLEAR  SCREEN.
003110 01  DSP-CLER2.
003120     02  LINE  17  COLUMN  41  PIC X(6)  VALUE "      ".          I.071205
003130     02  LINE  19  COLUMN  41  PIC X(6)  VALUE "      ".          I.071205
003140*01  DSP-MI.
003150*****02  LINE  24  COLUMN   1  VALUE
003160*****    NC"ÅñÅñèoâ◊éwê}ÉgÉâÉìÅ@ñ¢ìoò^".
003170     COPY  LSERR.
003180 PROCEDURE         DIVISION.
003190 MAINLINE-ROUTINE.
003200     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
003210     IF  END-STS  =  "P9"  STOP  RUN.                             I.100914
003220     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
003230     IF  END-STS  =  "P9"  STOP  RUN.
003240*****IF  SEN-W    =  2
003250*****    MOVE  NC"çƒ"     TO M1-SAI.
003260     MOVE  W-SNGPS TO  M1-SNGP.
003270     MOVE  W-ENGPS TO  M1-ENGP.
003280     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
003290     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
003300              UNTIL  NOT  (END-SW  NOT  =  9).
003310     PERFORM  GKEI-RTN  THRU  GKEI-RTN-EXIT                       I.111221
003320*
003330     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
003340 MAINLINE-END.
003350     STOP  RUN.
003360******************************************************************
003370*    ÉÅÉCÉìèàóù  ÅiÇoÇqÇnÇbÅ|ÇqÇsÇmÅj                            *
003380******************************************************************
003390 PROC-RTN.
003400     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003410     PERFORM  GENT-RTN   THRU  GENT-RTN-EXIT
003420              UNTIL  NOT  (END-SW  =  0  AND  RED-SW  =  1).
003430 PROC-RTN-EXIT.
003440     EXIT.
003450******************************************************************
003460*    ÅiÇfÇdÇmÇsÅ|ÇqÇsÇmÅj                                        *
003470******************************************************************
003480 GENT-RTN.
003490     PERFORM  READ2-RTN  THRU  READ2-RTN-EXIT.
003500     PERFORM  DETL-RTN   THRU  DETL-RTN-EXIT.
003510     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003520     PERFORM  TOTL-RTN   THRU  TOTL-RTN-EXIT.
003530 GENT-RTN-EXIT.
003540     EXIT.
003550******************************************************************
003560*    èâä˙ê›íËèàóù  ÅiÇhÇmÇhÇsÅ|ÇqÇsÇmÅj                          *
003570******************************************************************
003580 INIT-RTN.
003590*****ACCEPT   JS-SIGN.                                            I.100914
003600*****IF  JS-SIGN    NOT  =  0  AND  1 AND  2                      I.111221
003610*****    MOVE  "P9"   TO  END-STS                                 I.100914
003620*****    GO TO INIT-RTN-EXIT.                                     I.100914
003630*****IF  JS-SIGN       =  0                                       I.111221
003640*****    MOVE  NC"ã Å@ìáÅ@Å@"  TO  M1-MID                         I.111221
003650*****  ELSE                                                       I.111221
003660*****  IF  JS-SIGN       =  2                                     I.100914
003670*****      MOVE  NC"ÉiÅ@ÉtÅ@ÉR"  TO  M1-MID.                      I.100914
003680*
003690     MOVE  SPACE  TO  WR-R.
003700     MOVE  W-15K  TO  WR-K1.
003710     MOVE  W-20K  TO  WR-K2.
003720     MOVE  ZERO   TO  W-DATA  W-ASU  W-KEI  PAGE-C.               I.111221
003730     MOVE  90     TO  LCNT.
003740     ACCEPT W-DATE FROM DATE.
003750     MOVE  W-DATE TO  M1-DATE.
003760*
003770     CALL "CBLSTNNO" USING STN-NO.                                I.090928
003780     MOVE STN-NO2 TO W-FID2.                                      I.090928
003790     MOVE W-FID TO WK0256ID.                                      I.090928
003800 INIT-RTN-EXIT.
003810     EXIT.
003820******************************************************************
003830*    ëIëèàóù  ÅiÇrÇkÇbÇsÅ|ÇqÇsÇmÅj                              *
003840******************************************************************
003850 SLCT-RTN.
003860 SLCT-010.
003870     DISPLAY  DSP-CLER.
003880     DISPLAY  DSP-GAMEN.
003890*****IF  JS-SIGN       =  0                                       I.111221
003900*****    DISPLAY  DSP-MID0  DSP-GAMEN0.                           I.111221
003910*****IF  JS-SIGN       =  1                                       I.100914
003920*****    DISPLAY  DSP-MID1                                        I.100914
003930*****ELSE  IF  JS-SIGN       =  2                                 I.100914
003940*****          DISPLAY  DSP-MID2.                                 I.100914
003950*****IF  JS-SIGN   NOT =  0                                       I.111221
003960*****    GO  TO  SLCT-020.                                        I.111221
003970     MOVE  W-DATE      TO  W-SNGPS.                               I.111221
003980     MOVE  20          TO  W-SNEN1.                               I.111221
003990     MOVE W-SNGP       TO  W-ENGP.                                I.111221
004000     DISPLAY  ACP-SNGP  ACP-ENGP.                                 I.111221
004010     GO  TO  SLCT-200.                                            I.111221
004020*SLCT-020.
004030*****ACCEPT   ACP-SEN.
004040*****DISPLAY  DISP-MSG-SPACE.
004050*****IF  END-STS       =  "P9"  MOVE  9  TO  END-SW
004060*****                           GO  TO  SLCT-RTN-EXIT.
004070*****IF  END-STS  NOT  =  "01"  GO  TO  SLCT-020.
004080*****IF  SEN-W    NOT  =  1  AND  2     GO  TO  SLCT-020.
004090*****DISPLAY  DSP-CLER2.
004100*****PERFORM  SEL-RTN     THRU  SEL-EX.
004110*****IF  W-SNGP        =  ZERO          DISPLAY  ERR-02
004120*****                                            DISP-BUZ-J
004130*****                                   GO  TO  SLCT-020.
004140*****IF  SEN-W         =  2             DISPLAY  DSP-DNOM         I.071205
004150*****                         ELSE  DISPLAY  DSP-DNOC  DSP-CLER2. I.071205
004160*****DISPLAY  ACP-SNGP  ACP-ENGP.                                 I.071205
004170 SLCT-052.
004180     ACCEPT   ACP-SNEN.
004190     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW               I.111221
004200                                GO  TO  SLCT-RTN-EXIT.            I.111221
004210*****IF  JS-SIGN   NOT =  0                                       I.111221
004220*****    IF  END-STS       =  "09"  GO  TO  SLCT-020.
004230     IF  END-STS   NOT =  "00" AND "01" AND "06"
004240                                GO  TO  SLCT-052.
004250     MOVE  ZERO        TO  W-SNEN1.
004260     IF  W-SNEN2       >  90    ADD  1900   TO  W-SNEN
004270                          ELSE  ADD  2000   TO  W-SNEN.
004280 SLCT-053.
004290     ACCEPT   ACP-SGET.
004300     IF  END-STS       =  "09"  GO  TO  SLCT-052.
004310     IF  END-STS   NOT =  "00" AND "01" AND "06"
004320                                GO  TO  SLCT-053.
004330     IF  W-SGET        <  1  OR  >  12
004340                                GO  TO  SLCT-053.
004350 SLCT-054.
004360     ACCEPT   ACP-SPEY.
004370     IF  END-STS       =  "09"  GO  TO  SLCT-053.
004380     IF  END-STS   NOT =  "00" AND "01" AND "06"
004390                                GO  TO  SLCT-054.
004400     IF  W-SPEY        <  1  OR  >  31
004410                                GO  TO  SLCT-054.
004420*****IF  JS-SIGN   NOT =  0                                       I.111221
004430*****    IF  W-SNGP        <  W-SDATE  OR  >  W-EDATE
004440*****                           GO  TO  SLCT-052.
004450 SLCT-056.
004460     ACCEPT   ACP-ENEN.
004470     IF  END-STS       =  "09"  GO  TO  SLCT-054.
004480     IF  END-STS   NOT =  "00" AND "01" AND "06"
004490                                GO  TO  SLCT-056.
004500     MOVE  ZERO        TO  W-ENEN1.
004510     IF  W-ENEN2       >  90    ADD  1900   TO  W-ENEN
004520                          ELSE  ADD  2000   TO  W-ENEN.
004530 SLCT-057.
004540     ACCEPT   ACP-EGET.
004550     IF  END-STS       =  "09"  GO  TO  SLCT-056.
004560     IF  END-STS   NOT =  "00" AND "01" AND "06"
004570                                GO  TO  SLCT-057.
004580     IF  W-EGET        <  1  OR  >  12
004590                                GO  TO  SLCT-057.
004600 SLCT-058.
004610     ACCEPT   ACP-EPEY.
004620     IF  END-STS       =  "09"  GO  TO  SLCT-057.
004630     IF  END-STS   NOT =  "00" AND "01" AND "06"
004640                                GO  TO  SLCT-058.
004650     IF  W-EPEY        <  1  OR  >  31
004660                                GO  TO  SLCT-058.
004670     IF  W-SNGP        >  W-ENGP
004680                                GO  TO  SLCT-056.
004690*****IF  JS-SIGN   NOT =  0                                       I.111221
004700*****    IF  W-ENGP        <  W-SDATE  OR  >  W-EDATE
004710*****                           GO  TO  SLCT-056.
004720*****IF  JS-SIGN       =  0     GO  TO  SLCT-200.                 I.111221
004730*SLCT-100.                                                        I.071205
004740*****IF  SEN-W    =  1          GO  TO  SLCT-200.                 I.071205
004750*****ACCEPT   ACP-DENF.                                           I.071205
004760*****IF  END-STS       =  "09"  DISPLAY  DSP-CLER2                I.071205
004770*****                           GO  TO  SLCT-058.                 I.071205
004780*****IF  END-STS  NOT  =  "01"  GO  TO  SLCT-100.                 I.071205
004790*SLCT-110.                                                        I.071205
004800*****ACCEPT   ACP-DENT.                                           I.071205
004810*****IF  END-STS       =  "09"  GO  TO  SLCT-100.                 I.071205
004820*****IF  END-STS  NOT  =  "01"  GO  TO  SLCT-110.                 I.071205
004830*****IF  DEN-WF  >  DEN-WT      GO  TO  SLCT-110.                 I.071205
004840 SLCT-200.
004850     ACCEPT  ACP-KAKU.
004860     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW               I.111221
004870                                GO  TO  SLCT-RTN-EXIT.            I.111221
004880     IF  END-STS       =  "09"
004890                                GO  TO  SLCT-052.                 I.111221
004900*****    IF  JS-SIGN  =  0      GO  TO  SLCT-052                  I.111221
004910*****    ELSE                                                     I.111221
004920*****    IF  SEN-W  =  1        GO  TO  SLCT-058                  I.071205
004930*****    ELSE                   GO  TO  SLCT-110.                 I.071205
004940     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-200.
004950     IF  KAKU-W  =  1           GO  TO  SLCT-RTN-EXIT.
004960     IF  KAKU-W  =  9           GO  TO  SLCT-010
004970     ELSE                       GO  TO  SLCT-200.
004980 SLCT-RTN-EXIT.
004990     EXIT.
005000******************************************************************
005010*    ÇqÇdÇ`ÇcèàóùÅiÇPÅj  ÅiÇqÇdÇ`ÇcÇPÅ|ÇqÇsÇmÅj                  *
005020******************************************************************
005030 READ1-RTN.
005040*****IF  JS-SIGN       =  0     GO  TO  READ1-030.                I.111221
005050*****IF  SEN-W   =  1  GO  TO  READ1-010
005060*****ELSE              GO  TO  READ1-030.
005070*READ1-010.
005080*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ ( Ø∫≥))
005090*****IF  RED-SW  =  1  GO  TO  READ1-020.
005100*****READ  JNSRF        AT  END                                   I.090928
005110*****            MOVE  24  TO  ERR-LIN
005120*****            DISPLAY  DISP-MSG-SPACE
005130*****            DISPLAY  DSP-MI
005140*****            DISPLAY  DISP-BUZ-B
005150*****            PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005160*****            STOP  RUN.
005170*****IF  JNSR-158  NOT =  0               GO  TO  READ1-020.
005180*****IF  JNSR-17   NOT =  9               GO  TO  READ1-020.
005190*****IF  JS-SIGN       =  1                                       I.100914
005200*****    IF  JNSR-061  NOT =  9850        GO  TO  READ1-020.
005210*****IF  JS-SIGN       =  2                                       I.100914
005220*****    IF  JNSR-061  NOT =  5000        GO  TO  READ1-020.      I.100914
005230*****IF  JNSR-09       =  000000          GO  TO  READ1-020.
005240*****IF  JNSR-07  NOT =  5  AND  6        GO  TO  READ1-020.
005250*****IF  JNSR-03   NOT  =  0              GO  TO  READ1-020.
005260*****IF  JNSR-04        <  W-SNGP  OR  > W-ENGP
005270*****                                     GO  TO  READ1-020.
005280*****MOVE  1  TO  RED-SW.
005290*****GO  TO  READ1-RTN-EXIT.
005300*READ1-020.
005310*****READ  JNSRF        AT  END                                   I.090928
005320*****            MOVE  9  TO  END-SW
005330*****            GO  TO  READ1-RTN-EXIT.
005340*****IF  JNSR-158  NOT =  0               GO  TO  READ1-020.
005350*****IF  JNSR-17   NOT =  9               GO  TO  READ1-020.
005360*****IF  JS-SIGN       =  1                                       I.100914
005370*****    IF  JNSR-061  NOT =  9850        GO  TO  READ1-020.
005380*****IF  JS-SIGN       =  2                                       I.100914
005390*****    IF  JNSR-061  NOT =  5000        GO  TO  READ1-020.      I.100914
005400*****IF  JNSR-09       =  000000          GO  TO  READ1-020.
005410*****IF  JNSR-07  NOT =  5  AND  6        GO  TO  READ1-020.
005420*****IF  JNSR-03   NOT  =  0              GO  TO  READ1-020.
005430*****IF  JNSR-04        <  W-SNGP  OR  > W-ENGP
005440*****                                     GO  TO  READ1-020.
005450*****MOVE  1  TO  RED-SW.
005460*****GO  TO  READ1-RTN-EXIT.
005470 READ1-030.
005480*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ (ª≤ Ø∫≥))
005490     IF  RED-SW  =  1  GO  TO  READ1-040.
005500 READ1-040.
005510     READ  JNSRF        AT  END                                   I.090928
005520                 MOVE  9  TO  END-SW
005530                 GO  TO  READ1-RTN-EXIT.
005540     MOVE  ZERO     TO  WD-R.
005550     MOVE  JNSR-01  TO  JNSW-01.
005560     MOVE  JNSR-02  TO  JNSW-02.
005570     MOVE  JNSR-06  TO  JNSW-06.
005580     MOVE  JNSR-07  TO  JNSW-07.
005590     MOVE  JNSR-081(01) TO  JNSW-081(01).
005600     MOVE  JNSR-081(02) TO  JNSW-081(02).
005610     MOVE  JNSR-081(03) TO  JNSW-081(03).
005620     MOVE  JNSR-081(04) TO  JNSW-081(04).
005630     MOVE  JNSR-081(05) TO  JNSW-081(05).
005640     MOVE  JNSR-081(06) TO  JNSW-081(06).
005650     MOVE  JNSR-081(07) TO  JNSW-081(07).
005660     MOVE  JNSR-081(08) TO  JNSW-081(08).
005670     MOVE  JNSR-081(09) TO  JNSW-081(09).
005680     MOVE  JNSR-081(10) TO  JNSW-081(10).
005690*****IF  JNSR-158  NOT =  1               GO  TO  READ1-040.
005700*****IF  JNSR-17       =  0               GO  TO  READ1-040.
005710*****IF  JS-SIGN       =  0                                       I.111228
005720*****    IF  JNSR-061      =  2150  OR  2157  OR  2158  OR  2160  I.111228
005730*****                     OR  2170  OR  2180  OR  5349  OR  5350  I.111228
005740*****                     OR  5353  OR  5357  OR  5358            I.111228
005750*****                                     GO  TO  READ1-040.      I.111228
005760*****IF  JS-SIGN       =  1                                       I.100914
005770*****    IF  JNSR-061  NOT =  9850        GO  TO  READ1-040.
005780*****IF  JS-SIGN       =  2                                       I.100914
005790*****    IF  JNSR-061  NOT =  5000        GO  TO  READ1-040.      I.100914
005800*****IF  JNSR-09       =  000000          GO  TO  READ1-040.
005810*****IF  JS-SIGN   NOT =  0                                       I.111221
005820*****    IF  JNSR-01     < DEN-WF  OR    > DEN-WT
005830*****                                     GO  TO  READ1-040.
005840*****IF  JNSR-07  NOT =  5  AND  6        GO  TO  READ1-040.
005850*****IF  JNSR-03   NOT  =  0              GO  TO  READ1-040.
005860*****IF  JS-SIGN   NOT =  0                                       I.111221
005870*****    IF  JNSR-04        <  W-SNGP  OR  > W-ENGP               I.071205
005880*****                                     GO  TO  READ1-040.      I.071205
005890*****IF  JS-SIGN       =  0                                       I.111221
005900     IF  JNSW-01        >  999899                                 I.111221
005910                                          GO  TO  READ1-040.      I.111221
005920*****IF  JS-SIGN       =  0                                       I.111221
005930         IF  JNSW-02        <  W-SNGP  OR  > W-ENGP               I.111221
005940                                          GO  TO  READ1-040.      I.111221
005950     MOVE  1  TO  RED-SW.
005960 READ1-RTN-EXIT.
005970     EXIT.
005980******************************************************************
005990*    ÇqÇdÇ`ÇcèàóùÅiÇQÅj  ÅiÇqÇdÇ`ÇcÇQÅ|ÇqÇsÇmÅj                  *
006000******************************************************************
006010 READ2-RTN.
006020     MOVE  JNSW-01  TO  WR-HCD.
006030     MOVE  JNSW-01  TO  HI-MHCD HI-HCD.
006040     READ  HI2-M  UNLOCK  INVALID  KEY
006050                        MOVE  SPACE  TO  WR-HNA
006060                        GO  TO  READ2-RTN-EXIT.
006070     MOVE  HI-NAME TO  WR-HNA.
006080 READ2-RTN-EXIT.
006090     EXIT.
006100 DETL-RTN.
006110     IF JNSW-01  NOT  =  OLD-HCD
006120         IF OLD-HCD NOT = ZERO
006130             MOVE  SPACE  TO  PRN-R
006140             WRITE  PRN-R  AFTER  1
006150             ADD  1  TO  LCNT.
006160     PERFORM  ADD-RTN   THRU  ADD-RTN-EXIT.
006170     MOVE  JNSW-01           TO  OLD-HCD.
006180     MOVE  JNSW-07           TO  OLD-SIZ.
006190 DETL-RTN-EXIT.
006200     EXIT.
006210 TOTL-RTN.
006220     IF  ZERO         =  W-SU(01)  AND  W-SU(02)  AND  W-SU(03)
006230                    AND  W-SU(04)  AND  W-SU(05)  AND  W-SU(06)
006240                    AND  W-SU(07)  AND  W-SU(08)  AND  W-SU(09)
006250                    AND  W-SU(10)
006260         GO  TO  TOTL-RTN-EXIT.
006270     IF  END-SW  =  9
006280         PERFORM  MEI2-RTN  THRU  MEI2-RTN-EXIT
006290         GO  TO  TOTL-RTN-EXIT.
006300     IF (JNSW-01  NOT  =  OLD-HCD)  OR
006310        (JNSW-07  NOT  =  OLD-SIZ)
006320         PERFORM  MEI2-RTN  THRU  MEI2-RTN-EXIT.
006330 TOTL-RTN-EXIT.
006340     EXIT.
006350 MID-RTN.
006360     IF  LCNT    NOT  =  90
006370         MOVE  SPACE  TO  PRN-R
006380         WRITE  PRN-R  AFTER  PAGE.
006390     ADD   1         TO  PAGE-C.
006400     MOVE  PAGE-C          TO  M1-PAGE.
006410     MOVE  SPACE           TO  PRN-R.
006420     WRITE  PRN-R  FROM  MID1-R  AFTER  1.
006430     MOVE  SPACE           TO  PRN-R.
006440     WRITE  PRN-R  FROM  MID2-R  AFTER  2.
006450     MOVE  SPACE           TO  PRN-R.
006460     WRITE  PRN-R  FROM  MID3-R  AFTER  1.
006470     MOVE  SPACE           TO  PRN-R.
006480     WRITE  PRN-R  FROM  MID4-R  AFTER  1.
006490     MOVE  SPACE           TO  PRN-R.
006500     WRITE  PRN-R  FROM  MID5-R  AFTER  1.
006510     MOVE  SPACE           TO  PRN-R.
006520     MOVE  6  TO  LCNT.
006530 MID-RTN-EX.
006540     EXIT.
006550 ADD-RTN.
006560*****IF  JS-SIGN      =  0                                        I.111221
006570*****    ADD   JNSR-1211(1)  TO  W-SU(01)                         I.111221
006580*****    ADD   JNSR-1211(2)  TO  W-SU(02)                         I.111221
006590*****    ADD   JNSR-1211(3)  TO  W-SU(03)                         I.111221
006600*****    ADD   JNSR-1211(4)  TO  W-SU(04)                         I.111221
006610*****    ADD   JNSR-1211(5)  TO  W-SU(05)                         I.111221
006620*****    ADD   JNSR-1211(6)  TO  W-SU(06)                         I.111221
006630*****    ADD   JNSR-1211(7)  TO  W-SU(07)                         I.111221
006640*****    ADD   JNSR-1211(8)  TO  W-SU(08)                         I.111221
006650*****    ADD   JNSR-1211(9)  TO  W-SU(09)                         I.111221
006660*****    ADD   JNSR-1211(10) TO  W-SU(10)                         I.111221
006670*****    COMPUTE  W-SUT   =  W-SUT + JNSR-1211(1) + JNSR-1211(2)  I.111221
006680*****                              + JNSR-1211(3) + JNSR-1211(4)  I.111221
006690*****                              + JNSR-1211(5) + JNSR-1211(6)  I.111221
006700*****                              + JNSR-1211(7) + JNSR-1211(8)  I.111221
006710*****                              + JNSR-1211(9) + JNSR-1211(10) I.111221
006720*****    GO  TO  ADD-RTN-EXIT.                                    I.111221
006730     ADD   JNSW-081(1)   TO  W-SU(01).
006740     ADD   JNSW-081(2)   TO  W-SU(02).
006750     ADD   JNSW-081(3)   TO  W-SU(03).
006760     ADD   JNSW-081(4)   TO  W-SU(04).
006770     ADD   JNSW-081(5)   TO  W-SU(05).
006780     ADD   JNSW-081(6)   TO  W-SU(06).
006790     ADD   JNSW-081(7)   TO  W-SU(07).
006800     ADD   JNSW-081(8)   TO  W-SU(08).
006810     ADD   JNSW-081(9)   TO  W-SU(09).
006820     ADD   JNSW-081(10)  TO  W-SU(10).
006830     COMPUTE  W-SUT   =  W-SUT  +  JNSW-081(1)  +  JNSW-081(2)
006840                                +  JNSW-081(3)  +  JNSW-081(4)
006850                                +  JNSW-081(5)  +  JNSW-081(6)
006860                                +  JNSW-081(7)  +  JNSW-081(8)
006870                                +  JNSW-081(9)  +  JNSW-081(10).
006880 ADD-RTN-EXIT.
006890     EXIT.
006900******************************************************************
006910*    ÇvÇqÇhÇsÇdèàóù  ÅiÇvÇqÇhÇsÇdÅ|ÇqÇsÇmÅj                      *
006920******************************************************************
006930 MEI2-RTN.
006940 MEI2-010.
006950     IF  LCNT    NOT  <  62
006960         PERFORM  MID-RTN    THRU  MID-RTN-EX.
006970     MOVE  OLD-SIZ   TO  WR-SIZ.
006980     MOVE  W-SU(1)   TO  WR-SU01.
006990     MOVE  W-SU(2)   TO  WR-SU02.
007000     MOVE  W-SU(3)   TO  WR-SU03.
007010     MOVE  W-SU(4)   TO  WR-SU04.
007020     MOVE  W-SU(5)   TO  WR-SU05.
007030     MOVE  W-SU(6)   TO  WR-SU06.
007040     MOVE  W-SU(7)   TO  WR-SU07.
007050     MOVE  W-SU(8)   TO  WR-SU08.
007060     MOVE  W-SU(9)   TO  WR-SU09.
007070     MOVE  W-SU(10)  TO  WR-SU10.
007080     MOVE  W-SUT     TO  WR-SUT.
007090     WRITE  PRN-R  FROM  WR-R    AFTER  1.
007100     ADD   W-SUT       TO  W-KEI.                                 I.111221
007110     MOVE  ZERO      TO  W-ASU.
007120     ADD  1  TO  LCNT.
007130 MEI2-RTN-EXIT.
007140     EXIT.
007150 GKEI-RTN.                                                        I.111221
007160 GKEI-010.                                                        I.111221
007170     IF  LCNT    NOT  <  62                                       I.111221
007180         PERFORM  MID-RTN    THRU  MID-RTN-EX.                    I.111221
007190     MOVE  SPACE  TO  WR-R.                                       I.111221
007200     MOVE  W-15K  TO  WR-K1.                                      I.111221
007210     MOVE  W-20K  TO  WR-K2.                                      I.111221
007220     MOVE  NC"Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅiÅ@çáÅ@åvÅ@ÅjÅ@Å@" TO  WR-HNA. I.111221
007230     MOVE  W-KEI     TO  WR-SUT.                                  I.111221
007240     WRITE  PRN-R  FROM  WR-R    AFTER  1.                        I.111221
007250 GKEI-RTN-EXIT.                                                   I.111221
007260     EXIT.                                                        I.111221
007270*SEL-RTN.
007280*****MOVE  ZERO    TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.
007290*****OPEN  INPUT   JNSRF.
007300*SEL-010.
007310*****READ  JNSRF                 AT END                           I.090928
007320*****              GO  TO  SEL-090.
007330*****IF  JNSR-17   NOT =  9             GO  TO  SEL-010.
007340*****IF  JS-SIGN       =  1                                       I.100914
007350*****    IF  JNSR-061  NOT =  9850      GO  TO  SEL-010.
007360*****IF  JS-SIGN       =  2                                       I.100914
007370*****    IF  JNSR-061  NOT =  5000      GO  TO  SEL-010.          I.100914
007380*****IF  JNSR-09       =  000000        GO  TO  SEL-010.
007390*****IF  SEN-W         =  1
007400*****    IF  JNSR-158       =  1        GO  TO  SEL-010.
007410*****IF  SEN-W         =  2
007420*****    IF  JNSR-158       =  0        GO  TO  SEL-010.
007430*****IF  W-SDATE        =  ZERO
007440*****              MOVE  JNSR-04      TO  W-SDATE.
007450*****IF  W-SDATE        >  JNSR-04
007460*****              MOVE  JNSR-04      TO  W-SDATE.
007470*****IF  W-EDATE        <  JNSR-04
007480*****              MOVE  JNSR-04      TO  W-EDATE.
007490*****GO  TO  SEL-010.
007500*SEL-090.
007510*****CLOSE  JNSRF.
007520*****MOVE  W-SDATE TO  W-SNGP.
007530*****MOVE  W-EDATE TO  W-ENGP.
007540*SEL-EX.
007550*****EXIT.
007560 OPEN-RTN.
007570     OPEN  INPUT   JNSRF
007580                   HI2-M
007590           OUTPUT  PRN-F.
007600 OPEN-RTN-EXIT.
007610     EXIT.
007620 CLSE-RTN.
007630     CLOSE  JNSRF
007640            HI2-M
007650            PRN-F.
007660 CLSE-RTN-EXIT.
007670     EXIT.
007680     COPY  LPERR.
