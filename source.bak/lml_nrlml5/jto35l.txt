000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JTO35L.
000030******************************************************************
000040*            出荷指図書当日以前再発行  （出荷実績Ｆ）            *
000050******************************************************************
000060 ENVIRONMENT       DIVISION.
000070 CONFIGURATION     SECTION.
000080 SOURCE-COMPUTER.  SYSTEM3100.
000090 OBJECT-COMPUTER.  SYSTEM3100.
000100 INPUT-OUTPUT      SECTION.
000110 FILE-CONTROL.
000120     SELECT  JSJDRF ASSIGN  JSJDR-MSD.
000130     SELECT  JCON   ASSIGN  JCON-MSD
000140                    ORGANIZATION  INDEXED
000150                    ACCESS  MODE  RANDOM
000160                    RECORD  KEY   JCON2-KEY.
000170     SELECT  TC-M   ASSIGN  TCM-MSD
000180                    ORGANIZATION  INDEXED
000190                    ACCESS  MODE  RANDOM
000200                    RECORD  KEY   TC-KEY.
000210     SELECT  HI2-M  ASSIGN  HI2-MSD
000220                    ORGANIZATION  INDEXED
000230                    ACCESS  MODE  RANDOM
000240                    RECORD  KEY   HI-KEY2.
000250     SELECT  T-M    ASSIGN  T1-MSD T2-MSD
000260                    ORGANIZATION  INDEXED
000270                    ACCESS  MODE  RANDOM
000280                    RECORD  KEY   T-KEY
000290         ALTERNATE  RECORD  KEY   T-KEY2.
000300     SELECT  THTM   ASSIGN  THT1-MSD THT2-MSD
000310                    ORGANIZATION  INDEXED
000320                    ACCESS  MODE  RANDOM
000330                    RECORD  KEY   THT-KEY
000340         ALTERNATE  RECORD  KEY   THT-KEY2.
000350     SELECT       JMSTD      ASSIGN   TO F7-MSD F7A-MSD F7B-MSD   I.130802
000360                  ORGANIZATION        INDEXED                     I.130802
000370                  ACCESS     MODE     DYNAMIC                     I.130802
000380                  RECORD     KEY      JMSTD-KEY1                  I.130802
000390                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY2     I.130802
000400                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY3     I.130802
000410                  FILE       STATUS   IS    ERR-STAT.             I.130802
000420     SELECT  PRN-F  ASSIGN  PRF-PRN999.
000430 I-O-CONTROL.
000440     APPLY  SHARED-MODE  ON  JCON
000450                             TC-M
000460                             HI2-M
000470                             T-M
000480                             THTM
000490                             JMSTD                                I.130802
000500     APPLY  SHIFT-CODE   ON  PRN-F.
000510 DATA              DIVISION.
000520 FILE              SECTION.
000530 FD  JSJDRF
000540     BLOCK 1 RECORDS
000550     LABEL RECORD IS STANDARD
000560     VALUE    OF  IDENTIFICATION  "JSJDRF".
000570 01  JSJD-REC.
000580     02  JSJD-KEY.
000590         03  JSJD-01        PIC 9(01).                            倉ｺｰﾄﾞ
000600         03  JSJD-02.                                             直送先
000610             04  JSJD-021   PIC 9(04).                            得意先CD
000620             04  JSJD-022   PIC 9(03).                            直送先CD
000630         03  JSJD-KEY2.
000640             04  JSJD-03    PIC 9(06).                            指図№
000650             04  JSJD-04    PIC 9(01).                            行№
000660     02  JSJD-05            PIC 9(01).                            伝区
000670     02  JSJD-06.                                                 指図日
000680         03  JSJD-061       PIC 9(04).
000690         03  JSJD-061L  REDEFINES  JSJD-061.
000700             04  JSJD-061   PIC 9(02).
000710             04  JSJD-062   PIC 9(02).
000720         03  JSJD-062       PIC 9(02).                            　　月
000730         03  JSJD-063       PIC 9(02).                            　　日
000740     02  JSJD-06L   REDEFINES  JSJD-06.
000750         03  F              PIC 9(02).
000760         03  JSJD-06S       PIC 9(06).
000770     02  JSJD-07.                                                 出荷日
000780         03  JSJD-071       PIC 9(04).
000790         03  JSJD-071L  REDEFINES  JSJD-071.
000800             04  JSJD-0711  PIC 9(02).
000810             04  JSJD-0712  PIC 9(02).
000820         03  JSJD-072       PIC 9(02).                            　　月
000830         03  JSJD-073       PIC 9(02).                            　　日
000840     02  JSJD-07L   REDEFINES  JSJD-07.
000850         03  F              PIC 9(02).
000860         03  JSJD-07S       PIC 9(06).
000870     02  JSJD-08.                                                 受注
000880         03  JSJD-081       PIC 9(06).                            受注№
000890         03  JSJD-082       PIC 9(01).                            行№
000900     02  JSJD-09            PIC 9(06).                            品名ｺｰﾄﾞ
000910     02  JSJD-10            PIC 9(01).                            ｻｲｽﾞ区分
000920     02  JSJD-11.                                                 出荷指図
000930         03  JSJD-111   OCCURS  10.                               ｻｲｽﾞ別数
000940             04  JSJD-1111      PIC S9(04).                       出荷数
000950         03  JSJD-112       PIC S9(05).
000960     02  JSJD-12.                                                 出荷実績
000970         03  JSJD-121   OCCURS  10.                               ｻｲｽﾞ別数
000980             04  JSJD-1211      PIC S9(04).                       実績数
000990         03  JSJD-122       PIC S9(05).
001000     02  JSJD-13            PIC 9(01).                            預り区分
001010     02  JSJD-14            PIC 9(01).                            運送ｺｰﾄﾞ
001020     02  JSJD-14A           PIC 9(03).                            セット数
001030     02  JSJD-14B           PIC 9(06).                            送り状№
001040     02  JSJD-14C           PIC 9(02).                            枝番
001050     02  JSJD-14D           PIC N(09).                            配達
001060     02  JSJD-15            PIC N(23).                            摘要
001070     02  JSJD-20            PIC X(10).
001080     02  JSJD-15A           PIC S9(03).                           個数
001090     02  FILLER             PIC X(18).
001100     02  JSJD-NGP           PIC 9(08).
001110     02  JSJD-19            PIC X(01).                            処理部署
001120     02  JSJD-158           PIC 9(01).                            印字ｻｲﾝ
001130     02  JSJD-16            PIC 9(01).                            一／般区
001140     02  JSJD-17            PIC 9(01).                            更新ｻｲﾝ
001150       COPY  L-JCON.
001160       COPY  LITCM.
001170       COPY  LIHIM2.
001180       COPY  LITM.
001190       COPY  LITHTM.
001200       COPY  LJMSTD.                                              I.130802
001210 FD  PRN-F
001220     LABEL  RECORD  OMITTED
001230     LINAGE  33.
001240 01  PRN-R                 PIC X(180).
001250 WORKING-STORAGE   SECTION.
001260 01  W-JS                  PIC 9.
001270 01  END-SW                PIC 9      VALUE 0.
001280 01  RED-SW                PIC 9      VALUE 0.
001290 01  TCM-SW                PIC 9      VALUE 0.
001300 01  WORK-1.
001310     02  F                 PIC X(102).
001320     02  WORK-11           PIC 9(6).                               伝票№
001330 01  WORK-2.
001340     02  F                 PIC X(33).
001350     02  WORK-M1           PIC N(02).                             "＝＝"
001360     02  WORK-M2           PIC X(01).                             "'"
001370     02  WORK-21.                                                  出荷日
001380         03  WORK-211      PIC 9(2).
001390         03  F             PIC X(4).
001400         03  WORK-212      PIC ZZ.                                   月
001410         03  F             PIC X(4).
001420         03  WORK-213      PIC ZZ.                                   日
001430     02  F                 PIC X(09).
001440     02  WORK-22           PIC N(2).                                伝区
001450     02  F                 PIC X(4).
001460     02  WORK-23           PIC N(06).                             倉庫名
001470 01  WORK-3.
001480     02  F                 PIC X(60).
001490     02  WORK-31           PIC 9(6).                              送り状№
001500     02  F                 PIC X(37).
001510     02  WORK-33           PIC X(6).
001520 01  WORK-3A.
001530     02  F                 PIC X(04).
001540     02  WORK-34A.
001550       03  WORK-34F        PIC X(1).
001560       03  WORK-341        PIC 9(1).
001570       03  WORK-342        PIC X(1).
001580       03  WORK-343        PIC 9(1).
001590       03  WORK-34R        PIC X(1).
001600     02  F                 PIC X(94).
001610     02  WORK-32           PIC X(6).
001620 01  WORK-4.
001630     02  F                 PIC X(05).
001640     02  WORK-41           PIC 9(4).                              得意先CD
001650     02  F                 PIC X(4).
001660     02  ST-CD1            PIC X(5).                              1.5BYTE
001670     02  WORK-42           PIC N(26).
001680     02  F                 PIC X(5).
001690     02  WORK-43           PIC X(3).                              直送先CD
001700     02  F                 PIC X(4).
001710     02  WORK-44           PIC N(26).
001720     02  ED-CD1            PIC X(5).                              2BYTE
001730 01  WORK-5.
001740     02  F                 PIC X(06).
001750     02  ED-CD2            PIC X(5).                              2BYTE
001760*****02  F                 PIC X(31).                             D.130802
001770     02  F                 PIC X(18).                             I.130802
001780     02  WORK-NGP          PIC 99/99/99.                          I.130802
001790     02  WORK-NGPD  REDEFINES WORK-NGP.                           I.130802
001800         03  F             PIC X(08).                             I.130802
001810     02  F                 PIC X(05).                             I.130802
001820     02  WORK-51F          PIC X(01).
001830     02  WORK-51           PIC X(10).
001840     02  WORK-51R          PIC X(01).
001850     02  F                 PIC X(02).
001860     02  WORK-52           OCCURS  10.
001870         03  WORK-521      PIC ----B.                             1ｾｯﾄ足数
001880     02  WORK-53           PIC ----.                                 計
001890     02  WORK-54           PIC X(01).
001900     02  WORK-55           PIC ZZZ.
001910 01  WORK-6.
001920     02  F                 PIC X(06).
001930     02  WORK-61           PIC 9(6).                               品名CD
001940     02  F                 PIC X.
001950     02  ST-CD3            PIC X(5).                              1.5BYTE
001960     02  WORK-62           PIC N(24).                               品名
001970     02  ED-CD3            PIC X(5).                              2BYTE
001980     02  F                 PIC X.
001990     02  WORK-63           PIC 9.                                 ｻｲｽﾞ区分
002000     02  F                 PIC X.
002010     02  WORK-64           OCCURS  10.
002020         03  WORK-641      PIC -----.                              指図数
002030     02  WORK-65           PIC -------.                             合計
002040     02  WORK-65R  REDEFINES  WORK-65.
002050         03  WORK-651      PIC X(01).
002060         03  WORK-652      PIC ------.
002070     02  WORK-66           PIC X(01).
002080     02  WORK-67           PIC X.
002090 01  WORK-6A.
002100     02  F                 PIC X(101).
002110     02  WORK-61A          PIC ----.
002120     02  F                 PIC X(01).
002130     02  WORK-62A          PIC X(03).
002140 01  WORK-7.
002150     02  F                 PIC X(22).
002160     02  WORK-70           PIC ZZ9.
002170     02  WORK-70R  REDEFINES   WORK-70  PIC X(03).
002180     02  F                 PIC X(09).
002190     02  ST-CD4            PIC X(5).                              1.5BYTE
002200     02  WORK-71.
002210         03  WORK-711      PIC N(5).                              運送会社
002220         03  WORK-712      PIC N.
002230     02  F                 PIC X(4).
002240     02  WORK-72.
002250         03  WORK-721      PIC N(23).                               摘要
002260         03  WORK-722      PIC N(9).                               配達日
002270     02  ED-CD4            PIC X(5).                              2BYTE
002280     02  F                 PIC X(7).
002290     02  WORK-73           PIC -------.                             合計
002300 01  WORK-8.
002310     02  WORK-81           OCCURS  10.
002320         03  WORK-811      PIC S9(2).
002330     02  WORK-82           PIC S9(6).
002340 01  WORK-9.
002350     02  WORK-91           OCCURS  10.
002360         03  WORK-911      PIC S9(4).
002370     02  WORK-92           PIC S9(6).
002380 01  I                     PIC 9.
002390 01  J                     PIC 9(2).
002400 01  PAGE-C                PIC 9(3).
002410 01  GOKEI                 PIC S9(6).
002420 01  W-DATE.
002430     02  W-NGP             PIC 9(8).
002440     02  W-NGPD  REDEFINES  W-NGP.
002450         03  W-NEN1        PIC 9(2).
002460         03  W-NEN2        PIC 9(2).
002470         03  W-GET         PIC 9(2).
002480         03  W-PEY         PIC 9(2).
002490 01  TEST-W                PIC 9.                                 ﾃｽﾄ印字W
002500 01  DEN-W                 PIC 9(6).                               伝票-W
002510 01  W-TCD                 PIC 9(4).
002520 01  W-TAN                 PIC 9(5).
002530 01  FROM-WK.
002540     02  KURA-W1           PIC 9(1).                              倉CD(FR)
002550     02  TKU-W1.                                                  直送(FR)
002560         03  TKU-W11       PIC 9(4).                              得CD(FR)
002570         03  TKU-W12       PIC 9(3).                              直CD(FR)
002580     02  DEN-W1            PIC 9(6).                              伝票(FR)
002590 01  TO-WK.
002600     02  KURA-W2           PIC 9(1).                              倉CD(TO)
002610     02  TKU-W2.                                                  直送(TO)
002620         03  TKU-W21       PIC 9(4).                              得CD(TO)
002630         03  TKU-W22       PIC 9(3).                              直CD(TO)
002640     02  DEN-W2            PIC 9(6).                              伝票(TO)
002650 01  KAKU-W                PIC 9.                                  確認-W
002660 01  ERR-STAT              PIC X(2).
002670 01  WYMD                  PIC 9(6).
002680 01  KEY-WK.
002690     02  KEY-W1            PIC 9(1).                              倉ｺｰﾄﾞ
002700     02  KEY-W2            PIC X(7).                              直送先CD
002710     02  KEY-W3            PIC 9(6).                              伝票№
002720 01  OLD-OKNO              PIC 9(6)  VALUE 0.
002730 01  SETSU                 PIC S9(3).
002740**********************
002750     COPY  LWMSG.
002760**********************
002770 SCREEN            SECTION.
002780 SD  GAMEN  END  STATUS  END-STS.
002790 01  ACP-NYURYOKU.
002800     02  ACP-JS    LINE   4.
002810         03  COLUMN  45  PIC 9     INTO  W-JS
002820                                   CHECK  OVERFLOW  NO  IFC.
002830     02  LINE   8.
002840         03  ACP-NEN2  COLUMN  24  PIC 9(2)  USING  W-NEN2
002850                                                    NO  IFC.
002860         03  ACP-GET   COLUMN  29  PIC 9(2)  USING  W-GET
002870                                                    NO  IFC.
002880         03  ACP-PEY   COLUMN  34  PIC 9(2)  USING  W-PEY
002890                                   CHECK  OVERFLOW  NO  IFC.
002900     02  ACP-TEST  LINE  12.
002910         03  COLUMN  45  PIC 9     INTO  TEST-W
002920                                   CHECK  OVERFLOW  NO  IFC.
002930     02  ACP-KURA1 LINE  16.
002940         03  COLUMN  33  PIC 9(1)  INTO  KURA-W1
002950                                   CHECK  OVERFLOW  NO  IFC.
002960     02  ACP-KURA2 LINE  17.
002970         03  COLUMN  33  PIC 9(1)  INTO  KURA-W2
002980                                   CHECK  OVERFLOW  NO  IFC.
002990     02  ACP-TKU1  LINE  16.
003000         03  ACP-TKU11   COLUMN  39      PIC 9(4)
003010                   INTO  TKU-W11                    NO  IFC.
003020         03  ACP-TKU12   COLUMN  44      PIC 9(3)
003030                   INTO  TKU-W12   CHECK  OVERFLOW  NO  IFC.
003040     02  ACP-TKU2  LINE  17.
003050         03  ACP-TKU21   COLUMN  39      PIC 9(4)
003060                   INTO  TKU-W21                    NO  IFC.
003070         03  ACP-TKU22   COLUMN  44      PIC 9(3)
003080                   INTO  TKU-W22   CHECK  OVERFLOW  NO  IFC.
003090     02  ACP-DEN1  LINE  16.
003100         03  COLUMN  50  PIC 9(6)  INTO  DEN-W1
003110                                   CHECK  OVERFLOW  NO  IFC.
003120     02  ACP-DEN2  LINE  17.
003130         03  COLUMN  50  PIC 9(6)  INTO  DEN-W2
003140                                   CHECK  OVERFLOW  NO  IFC.
003150     02  ACP-KAKU  LINE  24.
003160         03  COLUMN  63  PIC 9     INTO  KAKU-W
003170                                   CHECK  OVERFLOW  NO  IFC.
003180 01  DSP-GAMEN.
003190     02  LINE   1  COLUMN  26  VALUE
003200           " 出荷指図書（実績） " REVERSE.
003210     02  LINE   4.
003220         03  COLUMN  21  VALUE  "教　育=0 , 一　般=1 ...  ".
003230     02  LINE   8  COLUMN  23  VALUE "'  年   月   日 分".
003240     02  LINE  11  COLUMN  21  VALUE  NC"テストプリント印字".
003250     02  LINE  12.
003260         03  COLUMN  31  VALUE   "(YES=1,NO=2) [".
003270         03  COLUMN  46  VALUE   "]".
003280     02  LINE  15  COLUMN  31  VALUE    "倉ｺｰﾄﾞ".
003290     02  LINE  15  COLUMN  39  VALUE  NC"直送先".
003300     02  LINE  15  COLUMN  50  VALUE  NC"伝票№".
003310     02  LINE  16  COLUMN  21  VALUE  NC"ＦＲＯＭ".
003320     02  LINE  16  COLUMN  43  VALUE    "-".
003330     02  LINE  17  COLUMN  21  VALUE  NC"ＴＯ".
003340     02  LINE  17  COLUMN  43  VALUE    "-".
003350     02  LINE  24.
003360         03  COLUMN  41  VALUE  NC"確認（".
003370         03  COLUMN  47  VALUE    "OK=1,NO=9".
003380         03  COLUMN  56  VALUE  NC"）".
003390         03  COLUMN  58  VALUE    "--->  ﾘﾀｰﾝ".
003400 01  DSP-CLER  LINE   1.
003410     02  CLEAR  SCREEN.
003420 01  DSP-CLER2.
003430     02  LINE  16  COLUMN  33  PIC X(23)  VALUE "  ".
003440     02  LINE  16  COLUMN  43  VALUE    "-".
003450     02  LINE  17  COLUMN  33  PIC X(23)  VALUE "  ".
003460     02  LINE  17  COLUMN  43  VALUE    "-".
003470     COPY  LSERR.
003480*
003490 PROCEDURE         DIVISION.
003500 MAINLINE-ROUTINE.
003510     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
003520     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
003530     IF  END-STS  =  "P9"  STOP  RUN.
003540     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
003550     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
003560              UNTIL  NOT  (END-SW  NOT  =  9).
003570     IF  PAGE-C  NOT =  1
003580         MOVE     SPACE     TO    PRN-R
003590         WRITE    PRN-R     AFTER     PAGE.
003600*
003610     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
003620 MAINLINE-END.
003630     STOP  RUN.
003640******************************************************************
003650*    メイン処理  （ＰＲＯＣ－ＲＴＮ）                            *
003660******************************************************************
003670 PROC-RTN.
003680     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003690     PERFORM  GENT-RTN   THRU  GENT-RTN-EXIT
003700              UNTIL  NOT  (END-SW  =  0  AND  RED-SW  =  1).
003710 PROC-RTN-EXIT.
003720     EXIT.
003730******************************************************************
003740*    （ＧＥＮＴ－ＲＴＮ）                                        *
003750******************************************************************
003760 GENT-RTN.
003770     PERFORM  READ2-RTN  THRU  READ2-RTN-EXIT.
003780     PERFORM  DETL-RTN   THRU  DETL-RTN-EXIT.
003790     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003800     PERFORM  TOTL-RTN   THRU  TOTL-RTN-EXIT.
003810 GENT-RTN-EXIT.
003820     EXIT.
003830******************************************************************
003840*    初期設定処理  （ＩＮＩＴ－ＲＴＮ）                          *
003850******************************************************************
003860 INIT-RTN.
003870     ACCEPT   WYMD    FROM    DATE.
003880     MOVE  1  TO  PAGE-C.
003890     MOVE  0  TO  GOKEI.
003900     MOVE  0  TO  SETSU.
003910 INIT-RTN-EXIT.
003920     EXIT.
003930******************************************************************
003940*    選択処理  （ＳＬＣＴ－ＲＴＮ）                              *
003950******************************************************************
003960 SLCT-RTN.
003970 SLCT-010.
003980     DISPLAY  DSP-CLER.
003990     DISPLAY  DSP-GAMEN.
004000 SLCT-015.
004010     ACCEPT   ACP-JS.
004020     IF  END-STS       =  "P9"            MOVE  9  TO  END-SW
004030                                          GO  TO  SLCT-RTN-EXIT.
004040     IF  END-STS  NOT  =  "01"            GO  TO  SLCT-015.
004050     IF  W-JS     NOT  =  0  AND  1
004060                                          GO  TO  SLCT-015.
004070 SLCT-020.
004080     ACCEPT   ACP-NEN2.
004090     IF  END-STS       =  "P9"            MOVE  9  TO  END-SW
004100                                          GO  TO  SLCT-RTN-EXIT.
004110     IF  END-STS       =  "09"            GO  TO  SLCT-015.
004120     IF  END-STS  NOT  =  "00"  AND  "01"  AND  "06"
004130                                          GO  TO  SLCT-020.
004140     MOVE  20       TO  W-NEN1.
004150 SLCT-022.
004160     ACCEPT   ACP-GET.
004170     IF  END-STS       =  "09"            GO  TO  SLCT-020.
004180     IF  END-STS  NOT  =  "00"  AND  "01"  AND  "06"
004190                                          GO  TO  SLCT-022.
004200     IF  W-GET         <   1  OR  >  12   GO  TO  SLCT-022.
004210 SLCT-024.
004220     ACCEPT   ACP-PEY.
004230     IF  END-STS       =  "09"            GO  TO  SLCT-022.
004240     IF  END-STS  NOT  =  "01"  AND  "06"
004250                                          GO  TO  SLCT-024.
004260     IF  W-PEY         <   1  OR  >  31   GO  TO  SLCT-024.
004270 SLCT-030.
004280     ACCEPT   ACP-TEST.
004290     IF  END-STS       =  "09"  GO  TO  SLCT-020.
004300     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-030.
004310     IF  TEST-W  =  1
004320         PERFORM  TEST-RTN  THRU  TEST-RTN-EXIT
004330         GO  TO  SLCT-030.
004340     IF  TEST-W  =  2           GO  TO  SLCT-040
004350     ELSE                       GO  TO  SLCT-030.
004360 SLCT-040.
004370     ACCEPT   ACP-KURA1.
004380     IF  END-STS       =  "09"  DISPLAY  DSP-CLER2
004390     IF  END-STS       =  "09"  GO  TO  SLCT-030.
004400     IF  END-STS  NOT  =  "01"  AND  "06"
004410                                GO  TO  SLCT-040.
004420 SLCT-050.
004430     ACCEPT   ACP-TKU11.
004440     IF  END-STS       =  "09"  GO  TO  SLCT-040.
004450 SLCT-055.
004460     ACCEPT   ACP-TKU12.
004470     IF  END-STS       =  "09"  GO  TO  SLCT-050.
004480     IF  END-STS  NOT  =  "01"  AND  "06"
004490                                GO  TO  SLCT-055.
004500 SLCT-060.
004510     ACCEPT   ACP-DEN1.
004520     IF  END-STS       =  "09"  GO  TO  SLCT-050.
004530     IF  END-STS  NOT  =  "01"  AND  "06"
004540                                GO  TO  SLCT-060.
004550 SLCT-070.
004560     ACCEPT   ACP-KURA2.
004570     IF  END-STS       =  "09"  GO  TO  SLCT-060.
004580     IF  END-STS  NOT  =  "01"  AND  "06"
004590                                GO  TO  SLCT-070.
004600 SLCT-080.
004610     ACCEPT   ACP-TKU21.
004620     IF  END-STS       =  "09"  GO  TO  SLCT-070.
004630 SLCT-085.
004640     ACCEPT   ACP-TKU22.
004650     IF  END-STS       =  "09"  GO  TO  SLCT-080.
004660     IF  END-STS  NOT  =  "01"  AND  "06"
004670                                GO  TO  SLCT-085.
004680 SLCT-090.
004690     ACCEPT   ACP-DEN2.
004700     IF  END-STS       =  "09"  GO  TO  SLCT-080.
004710     IF  END-STS  NOT  =  "01"  AND  "06"
004720                                GO  TO  SLCT-090.
004730     IF  FROM-WK >  TO-WK       GO  TO  SLCT-040.
004740 SLCT-100.
004750     ACCEPT  ACP-KAKU.
004760     IF  END-STS       =  "09"  GO  TO  SLCT-090.
004770     IF  END-STS  NOT  =  "01"  AND  "06"
004780                                GO  TO  SLCT-100.
004790     IF  KAKU-W  =  1           GO  TO  SLCT-RTN-EXIT.
004800     IF  KAKU-W  =  9           GO  TO  SLCT-010
004810     ELSE                       GO  TO  SLCT-100.
004820 SLCT-RTN-EXIT.
004830     EXIT.
004840******************************************************************
004850*    ＲＥＡＤ処理（１）  （ＲＥＡＤ１－ＲＴＮ）                  *
004860******************************************************************
004870 READ1-RTN.
004880 READ1-030.
004890*    (ｼｭｯｶ･ｻｼｽﾞ･ﾄﾗﾝ ﾉ ﾘｰﾄﾞ (ｻｲﾊｯｺｳ))
004900 READ1-040.
004910     READ  JSJDRF  AT  END
004920                 MOVE  9  TO  END-SW
004930                 GO  TO  READ1-RTN-EXIT.
004940     IF  JSJD-NGP   NOT =  W-NGP            GO  TO  READ1-040.
004950     MOVE  JSJD-01  TO  KEY-W1.
004960     MOVE  JSJD-02  TO  KEY-W2.
004970     MOVE  JSJD-03  TO  KEY-W3.
004980     IF  FROM-WK  >  KEY-WK                 GO  TO  READ1-040.
004990     IF  TO-WK    <  KEY-WK   MOVE  9  TO  END-SW
005000                              GO  TO  READ1-RTN-EXIT.
005010     IF  JSJD-16 NOT = W-JS                 GO  TO  READ1-040.
005020     IF  JSJD-021    = 5000  OR  9850       GO  TO  READ1-040.
005030     IF  JSJD-158  NOT  =  1  GO  TO  READ1-040.
005040     IF  JSJD-1211(1)  =  ZERO  AND  JSJD-1211(2)  =  ZERO  AND
005050         JSJD-1211(3)  =  ZERO  AND  JSJD-1211(4)  =  ZERO  AND
005060         JSJD-1211(5)  =  ZERO  AND  JSJD-1211(6)  =  ZERO  AND
005070         JSJD-1211(7)  =  ZERO  AND  JSJD-1211(8)  =  ZERO  AND
005080         JSJD-1211(9)  =  ZERO  AND  JSJD-1211(10) =  ZERO
005090         GO  TO  READ1-040.
005100     MOVE  1  TO  RED-SW.
005110 READ1-RTN-EXIT.
005120     EXIT.
005130******************************************************************
005140*    ＲＥＡＤ処理（２）  （ＲＥＡＤ２－ＲＴＮ）                  *
005150******************************************************************
005160 READ2-RTN.
005170     MOVE  0         TO  TCM-SW.
005180 READ2-010.
005190     MOVE  JSJD-021  TO  T-KEY.
005200     READ  T-M   UNLOCK  INVALID  KEY
005210                         MOVE  ZERO      TO  T-TNC1  T-DCC.
005220*    (ﾁｮｸｿｳｻｷ･ﾏｽﾀ ﾉ ﾘｰﾄﾞ)
005230     MOVE  JSJD-021  TO  TC-TCD.
005240     MOVE  1         TO  TC-CCD.
005250     READ  TC-M  UNLOCK  INVALID  KEY
005260                         MOVE  JSJD-021  TO  WORK-41
005270                         MOVE  SPACE     TO  WORK-42
005280                         GO  TO  READ2-020.
005290     MOVE  JSJD-021  TO  WORK-41.
005300     MOVE  TC-NAME   TO  WORK-42.
005310 READ2-020.
005320     IF  JSJD-022  =  1
005330         MOVE  SPACE  TO  WORK-43
005340         MOVE  SPACE  TO  WORK-44
005350         GO  TO  READ2-030
005360     ELSE
005370         MOVE  JSJD-021  TO  TC-TCD
005380         MOVE  JSJD-022  TO  TC-CCD
005390         READ  TC-M  UNLOCK  INVALID  KEY
005400                             MOVE  JSJD-022  TO  WORK-43
005410                             MOVE  SPACE     TO  WORK-44
005420                             GO  TO  READ2-030.
005430     MOVE  JSJD-022  TO  WORK-43.
005440     MOVE  TC-NAME   TO  WORK-44.
005450 READ2-030.
005460*    (ﾋﾝﾒｲ･ﾏｽﾀ ﾉ ﾘｰﾄﾞ)
005470     MOVE  SPACE    TO  WORK-67.
005480     MOVE  JSJD-09  TO  HI-MHCD HI-HCD.
005490     READ  HI2-M  UNLOCK  INVALID  KEY
005500                        MOVE  SPACE  TO  WORK-62
005510                        GO  TO  READ2-040.
005520     MOVE  HI-NAME TO  WORK-62.
005530 READ2-040.
005540     IF  JSJD-09     <  999900
005550         PERFORM  TAN-RTN  THRU  TAN-EX.
005560*    (ｺﾝﾄﾛｰﾙ･ﾌｧｲﾙ ﾉ ﾘｰﾄﾞ)
005570     MOVE  2        TO  JCON2-01.
005580     MOVE  JSJD-14  TO  JCON2-02.
005590     READ  JCON  UNLOCK  INVALID  KEY
005600                         MOVE  SPACE  TO  WORK-711  WORK-712
005610                         GO  TO  READ2-RTN-EXIT.
005620     MOVE  JCON2-03  TO  WORK-711.
005630     MOVE  SPACE     TO  WORK-712.
005640 READ2-RTN-EXIT.
005650     EXIT.
005660******************************************************************
005670*    明細出力処理  （ＤＥＴＬ－ＲＴＮ）                          *
005680******************************************************************
005690 DETL-RTN.
005700     IF  TCM-SW  =  1
005710         GO  TO  DETL-010.
005720     IF  DEN-W  NOT  =  JSJD-03
005730         PERFORM  HEAD-RTN  THRU  HEAD-RTN-EXIT.
005740     PERFORM  WRITE-RTN  THRU  WRITE-RTN-EXIT.
005750 DETL-010.
005760     MOVE  JSJD-03           TO  DEN-W.
005770     IF    JSJD-09  <  999900
005780           ADD   WORK-92           TO  GOKEI.
005790     ADD   WORK-82           TO  SETSU.
005800 DETL-RTN-EXIT.
005810     EXIT.
005820******************************************************************
005830*    合計出力処理  （ＴＯＴＬ－ＲＴＮ）                          *
005840******************************************************************
005850 TOTL-RTN.
005860     IF  TCM-SW  NOT  =  0
005870         MOVE  0  TO  GOKEI
005880         GO  TO  TOTL-RTN-EXIT.
005890     IF  END-SW  =  9
005900         COMPUTE  J  =  16  -  (I  *  2)
005910         MOVE   GOKEI           TO  WORK-73
005920         MOVE   ""3FE04F40A0""  TO  ST-CD4
005930         MOVE   ""3FE04FE080""  TO  ED-CD4
005940         WRITE  PRN-R  FROM  WORK-7  AFTER  J
005950         GO  TO  TOTL-RTN-EXIT.
005960     IF  JSJD-03  NOT  =  DEN-W
005970         COMPUTE  J  =  16  -  (I  *  2)
005980         MOVE   GOKEI           TO  WORK-73
005990         MOVE   ""3FE04F40A0""  TO  ST-CD4
006000         MOVE   ""3FE04FE080""  TO  ED-CD4
006010         WRITE  PRN-R  FROM  WORK-7  AFTER  J
006020         MOVE  0  TO  GOKEI.
006030 TOTL-RTN-EXIT.
006040     EXIT.
006050******************************************************************
006060*    セット数出力処理  （ＴＯＴＬ１－ＲＴＮ）                    *
006070******************************************************************
006080 TOTL1-RTN.
006090     COMPUTE  J  =  16  -  (I  *  2)  -  1.
006100     IF  SETSU  NOT  =  0
006110         MOVE  SETSU    TO  WORK-61A
006120         MOVE  "ｾｯﾄ"    TO  WORK-62A
006130         WRITE  PRN-R   FROM  WORK-6A  AFTER J
006140     ELSE
006150         MOVE  SPACE    TO  PRN-R
006160         WRITE  PRN-R   AFTER J.
006170     MOVE  0    TO  SETSU.
006180 TOTL1-EX.
006190******************************************************************
006200*    見出し出力処理  （ＨＥＡＤ－ＲＴＮ）                        *
006210******************************************************************
006220 HEAD-RTN.
006230     IF  PAGE-C  NOT  =  1
006240         MOVE  SPACE  TO  PRN-R
006250         WRITE  PRN-R  AFTER  PAGE.
006260     MOVE  ""3FE04F40A0""  TO  ST-CD1.
006270     MOVE  ""3FE04FE080""  TO  ED-CD1.
006280     MOVE  JSJD-03         TO  WORK-11.
006290     MOVE    "'"           TO  WORK-M2.
006300     MOVE  JSJD-0712       TO  WORK-211.
006310     MOVE  JSJD-072        TO  WORK-212.
006320     MOVE  JSJD-073        TO  WORK-213.
006330     IF  JSJD-05  =  0  MOVE  NC"出荷"  TO  WORK-22.
006340     IF  JSJD-05  =  3  MOVE  NC"訂正"  TO  WORK-22.
006350     IF  JSJD-05  =  7  MOVE  NC"サ出"  TO  WORK-22.
006360     MOVE  3         TO  JCON3-01.
006370     MOVE  JSJD-01   TO  JCON3-02.
006380     READ  JCON      UNLOCK  INVALID
006390                             MOVE ALL NX"2121"  TO  JCON3-03.
006400     MOVE  JCON3-03  TO  WORK-23.
006410     MOVE  JSJD-14B  TO  WORK-31.
006420     MOVE  SPACE     TO  WORK-34A.
006430     MOVE  "("       TO  WORK-34F.
006440     MOVE  T-TNC1    TO  WORK-341.
006450     MOVE  "-"       TO  WORK-342.
006460     MOVE  T-DCC     TO  WORK-343.
006470     MOVE  ")"       TO  WORK-34R.
006480     MOVE  WYMD      TO  WORK-32.
006490     MOVE  JSJD-06S  TO  WORK-33.
006500     MOVE  1         TO  I.
006510     ADD   1         TO  PAGE-C.
006520     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
006530     WRITE  PRN-R  FROM  WORK-2  AFTER  4.
006540     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
006550     WRITE  PRN-R  FROM  WORK-3A AFTER  2.
006560     WRITE  PRN-R  FROM  WORK-4  AFTER  4.
006570     IF  JSJD-14B  =  OLD-OKNO
006580           MOVE  SPACE     TO  WORK-70R
006590     ELSE  MOVE  JSJD-15A  TO  WORK-70.
006600     MOVE  JSJD-15   TO  WORK-721.
006610     MOVE  JSJD-14D  TO  WORK-722.
006620     MOVE  JSJD-14B  TO  OLD-OKNO.
006630 HEAD-RTN-EXIT.
006640     EXIT.
006650******************************************************************
006660*    ＷＲＩＴＥ処理  （ＷＲＩＴＥ－ＲＴＮ）                      *
006670******************************************************************
006680 WRITE-RTN.
006690     INITIALIZE  WORK-5  WORK-8  WORK-9.
006700     MOVE  ""3FE04F40A0""  TO          ST-CD3.
006710     MOVE  ""3FE04FE080""  TO  ED-CD2  ED-CD3.
006720     MOVE  SPACE         TO  WORK-NGPD.                           I.130802
006730     IF (JSJD-14A  NOT  >  1)  AND  (JSJD-20    =  SPACE)
006740                               AND  (JSJD-08    =  ZERO)          I.130802
006750         IF  I  =  1
006760             WRITE  PRN-R  FROM  WORK-5  AFTER  5
006770             GO  TO  WRITE-010
006780         ELSE
006790             WRITE  PRN-R  FROM  WORK-5  AFTER  1
006800             GO  TO  WRITE-010.
006810     IF  JSJD-14A       >  1
006820         COMPUTE WORK-811(1)  = JSJD-1211(1)  / JSJD-14A
006830         COMPUTE WORK-811(2)  = JSJD-1211(2)  / JSJD-14A
006840         COMPUTE WORK-811(3)  = JSJD-1211(3)  / JSJD-14A
006850         COMPUTE WORK-811(4)  = JSJD-1211(4)  / JSJD-14A
006860         COMPUTE WORK-811(5)  = JSJD-1211(5)  / JSJD-14A
006870         COMPUTE WORK-811(6)  = JSJD-1211(6)  / JSJD-14A
006880         COMPUTE WORK-811(7)  = JSJD-1211(7)  / JSJD-14A
006890         COMPUTE WORK-811(8)  = JSJD-1211(8)  / JSJD-14A
006900         COMPUTE WORK-811(9)  = JSJD-1211(9)  / JSJD-14A
006910         COMPUTE WORK-811(10) = JSJD-1211(10) / JSJD-14A
006920         COMPUTE WORK-82      = JSJD-1211(1)  + JSJD-1211(2)
006930                              + JSJD-1211(3)  + JSJD-1211(4)
006940                              + JSJD-1211(5)  + JSJD-1211(6)
006950                              + JSJD-1211(7)  + JSJD-1211(8)
006960                              + JSJD-1211(9)  + JSJD-1211(10)
006970         COMPUTE WORK-82      = WORK-82       / JSJD-14A
006980         MOVE  WORK-811(1)   TO  WORK-521(1)
006990         MOVE  WORK-811(2)   TO  WORK-521(2)
007000         MOVE  WORK-811(3)   TO  WORK-521(3)
007010         MOVE  WORK-811(4)   TO  WORK-521(4)
007020         MOVE  WORK-811(5)   TO  WORK-521(5)
007030         MOVE  WORK-811(6)   TO  WORK-521(6)
007040         MOVE  WORK-811(7)   TO  WORK-521(7)
007050         MOVE  WORK-811(8)   TO  WORK-521(8)
007060         MOVE  WORK-811(9)   TO  WORK-521(9)
007070         MOVE  WORK-811(10)  TO  WORK-521(10)
007080         MOVE  WORK-82       TO  WORK-53
007090         MOVE  "X"           TO  WORK-54
007100         MOVE  JSJD-14A      TO  WORK-55.
007110     IF  JSJD-20    NOT =  SPACE
007120         MOVE  "["           TO  WORK-51F
007130         MOVE  JSJD-20       TO  WORK-51
007140         MOVE  "]"           TO  WORK-51R.
007150     IF (JSJD-081    =  ZERO)   AND  (JSJD-082    = ZERO)         I.130802
007160         MOVE  SPACE         TO  WORK-NGPD                        I.130802
007170         GO  TO  WRITE-005.                                       I.130802
007180     MOVE  JSJD-08       TO  JMSTD-KEY1.                          I.130802
007190     READ  JMSTD  UNLOCK  INVALID  KEY                            I.130802
007200         MOVE  999999        TO  WORK-NGP                         I.130802
007210         GO  TO  WRITE-005.                                       I.130802
007220     MOVE  JMSTD-02S     TO  WORK-NGP.                            I.130802
007230 WRITE-005.                                                       I.130802
007240     IF  I  =  1
007250         WRITE  PRN-R  FROM  WORK-5  AFTER  5
007260     ELSE
007270         WRITE  PRN-R  FROM  WORK-5  AFTER  1.
007280 WRITE-010.
007290     MOVE  JSJD-09       TO  WORK-61.
007300     MOVE  JSJD-10       TO  WORK-63.
007310     MOVE  JSJD-1211(1)   TO  WORK-641(1).
007320     MOVE  JSJD-1211(2)   TO  WORK-641(2).
007330     MOVE  JSJD-1211(3)   TO  WORK-641(3).
007340     MOVE  JSJD-1211(4)   TO  WORK-641(4).
007350     MOVE  JSJD-1211(5)   TO  WORK-641(5).
007360     MOVE  JSJD-1211(6)   TO  WORK-641(6).
007370     MOVE  JSJD-1211(7)   TO  WORK-641(7).
007380     MOVE  JSJD-1211(8)   TO  WORK-641(8).
007390     MOVE  JSJD-1211(9)   TO  WORK-641(9).
007400     MOVE  JSJD-1211(10)  TO  WORK-641(10).
007410     COMPUTE  WORK-92  =  JSJD-1211(1)  +  JSJD-1211(2)
007420                       +  JSJD-1211(3)  +  JSJD-1211(4)
007430                       +  JSJD-1211(5)  +  JSJD-1211(6)
007440                       +  JSJD-1211(7)  +  JSJD-1211(8)
007450                       +  JSJD-1211(9)  +  JSJD-1211(10).
007460 WRITE-020.
007470     IF  JSJD-13  =  5 OR 4
007480         MOVE  "("       TO  WORK-651
007490         MOVE  WORK-92   TO  WORK-652
007500         MOVE  ")"       TO  WORK-66
007510      ELSE
007520         MOVE  WORK-92   TO  WORK-65
007530         MOVE  SPACE     TO  WORK-66.
007540     WRITE  PRN-R  FROM  WORK-6  AFTER  1.
007550     ADD  1  TO  I.
007560 WRITE-RTN-EXIT.
007570     EXIT.
007580******************************************************************
007590*    単価検出処理  （ＴＡＮ－ＲＴＮ）                            *
007600******************************************************************
007610 TAN-RTN.
007620     MOVE JSJD-021 TO W-TCD.
007630     IF W-TCD = 0460
007640         MOVE 0458 TO W-TCD.
007650     MOVE 0 TO W-TAN.
007660     MOVE W-TCD TO THT-TCD.
007670     MOVE JSJD-09 TO THT-HCD.
007680     MOVE JSJD-10 TO THT-SIZ.
007690     READ THTM UNLOCK INVALID
007700         MOVE ZERO TO THT-T.
007710     MOVE THT-T TO W-TAN.
007720     IF W-TAN NOT = ZERO
007730         GO TO TAN-EX.
007740     MOVE W-TCD TO THT-TCD.
007750     MOVE JSJD-09 TO THT-HCD.
007760     MOVE 9 TO THT-SIZ.
007770     READ THTM UNLOCK INVALID
007780         MOVE ZERO TO THT-T.
007790     MOVE THT-T TO W-TAN.
007800     IF  W-TAN    =  ZERO
007810        MOVE  "･"      TO  WORK-67.
007820 TAN-EX.
007830     EXIT.
007840******************************************************************
007850*    テスト印字処理  （ＴＥＳＴ－ＲＴＮ）                        *
007860******************************************************************
007870 TEST-RTN.
007880     OPEN  OUTPUT  PRN-F.
007890     MOVE ""3FE04F40A0"" TO  ST-CD1.
007900     MOVE ""3FE04FE080"" TO  ED-CD1.
007910     MOVE  ALL    "9"    TO  WORK-11.
007920     MOVE  "'"           TO  WORK-M2.
007930     MOVE  ALL    "9"    TO  WORK-211  WORK-212  WORK-213.
007940     MOVE  ALL  NC"Ｎ"   TO  WORK-23.
007950     MOVE  ALL    "9"    TO  WORK-31  WORK-32  WORK-33.
007960     MOVE  ALL    "9"    TO  WORK-41  WORK-43.
007970     MOVE  ALL  NC"９"   TO  WORK-42  WORK-44.
007980     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
007990     WRITE  PRN-R  FROM  WORK-2  AFTER  4.
008000     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
008010     WRITE  PRN-R  FROM  WORK-3A AFTER  2.
008020     WRITE  PRN-R  FROM  WORK-4  AFTER  4.
008030     MOVE  1  TO  I.
008040 TEST-010.
008050     MOVE ""3FE04F40A0"" TO          ST-CD3.
008060     MOVE ""3FE04FE080"" TO  ED-CD2  ED-CD3.
008070     MOVE         99     TO  WORK-521(1)  WORK-521(2)
008080                             WORK-521(3)  WORK-521(4)
008090                             WORK-521(5)  WORK-521(6)
008100                             WORK-521(7)  WORK-521(8)
008110                             WORK-521(9)  WORK-521(10).
008120     MOVE         999    TO  WORK-53.
008130     MOVE         "X"    TO  WORK-54.
008140     MOVE         999    TO  WORK-55.
008150     MOVE  ALL    "9"    TO  WORK-61.
008160     MOVE  ALL  NC"９"   TO  WORK-62.
008170     MOVE  ALL    "9"    TO  WORK-63.
008180     MOVE  ALL    "9"    TO  WORK-641(1)  WORK-641(2)
008190                             WORK-641(3)  WORK-641(4)
008200                             WORK-641(5)  WORK-641(6)
008210                             WORK-641(7)  WORK-641(8)
008220                             WORK-641(9)  WORK-641(10).
008230     MOVE  ALL    "9"    TO  WORK-65.
008240     IF  I  =  1
008250         WRITE  PRN-R  FROM  WORK-5  AFTER  5
008260         WRITE  PRN-R  FROM  WORK-6  AFTER  1
008270     ELSE
008280         WRITE  PRN-R  FROM  WORK-5  AFTER  1
008290         WRITE  PRN-R  FROM  WORK-6  AFTER  1.
008300     IF  I  =  6  GO  TO  TEST-020
008310     ELSE         ADD  1  TO  I
008320                  GO  TO  TEST-010.
008330 TEST-020.
008340     MOVE ""3FE04F40A0"" TO  ST-CD4.
008350     MOVE ""3FE04FE080"" TO  ED-CD4.
008360     WRITE  PRN-R  FROM  WORK-6A  AFTER  1.
008370     MOVE  ALL  NC"９"   TO  WORK-711  WORK-712
008380                             WORK-721  WORK-722.
008390     MOVE  ALL    "9"    TO  WORK-73  WORK-70.
008400     WRITE  PRN-R  FROM  WORK-7  AFTER  1.
008410     CLOSE  PRN-F.
008420 TEST-RTN-EXIT.
008430     EXIT.
008440******************************************************************
008450*    ＯＰＥＮ処理  （ＯＰＥＮ－ＲＴＮ）                        *
008460******************************************************************
008470 OPEN-RTN.
008480     OPEN  INPUT   JSJDRF
008490           INPUT   JCON
008500                   TC-M
008510                   HI2-M
008520                   T-M
008530                   THTM
008540                   JMSTD                                          I.130802
008550           OUTPUT  PRN-F.
008560 OPEN-RTN-EXIT.
008570     EXIT.
008580******************************************************************
008590*    ＣＬＯＳＥ処理  （ＣＬＳＥ－ＲＴＮ）                        *
008600******************************************************************
008610 CLSE-RTN.
008620     CLOSE  JSJDRF
008630            JCON
008640            TC-M
008650            HI2-M
008660            T-M
008670            THTM
008680            JMSTD                                                 I.130802
008690            PRN-F.
008700 CLSE-RTN-EXIT.
008710     EXIT.
008720*****
008730     COPY  LPERR.
008740     COPY  LPACPT.
