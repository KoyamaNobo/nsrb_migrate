000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JTO33L.
000030******************************************************************
000040*            èoâ◊éwê}èë  Åièoâ◊é¿ê—ÇeÅj                          *
000050*    DATE. 90.05.10            BY. IKUMI.N                       *
000060******************************************************************
000070 ENVIRONMENT       DIVISION.
000080 CONFIGURATION     SECTION.
000090 SOURCE-COMPUTER.  SYSTEM3100.
000100 OBJECT-COMPUTER.  SYSTEM3100.
000110 INPUT-OUTPUT      SECTION.
000120 FILE-CONTROL.
000130     SELECT  JSJD   ASSIGN  JSJD-MSD  JSJD2-MSD
000140                    ORGANIZATION  INDEXED
000150                    ACCESS  MODE  DYNAMIC
000160                    RECORD  KEY   JSJD-KEY
000170                    ALTERNATE  RECORD  KEY   JSJD-KEY2
000180                    FILE  STATUS  ERR-STAT.
000190     SELECT  JCON   ASSIGN  JCON-MSD
000200                    ORGANIZATION  INDEXED
000210                    ACCESS  MODE  RANDOM
000220                    RECORD  KEY   JCON2-KEY.
000230     SELECT  TC-M   ASSIGN  TCM-MSD
000240                    ORGANIZATION  INDEXED
000250                    ACCESS  MODE  RANDOM
000260                    RECORD  KEY   TC-KEY.
000270*****SELECT  SHM    ASSIGN  SHM-MSD                               D.010808
000280     SELECT  HI2-M  ASSIGN  HI2-MSD                               I.010808
000290                    ORGANIZATION  INDEXED
000300                    ACCESS  MODE  RANDOM
000310                    RECORD  KEY   HI-KEY2.                        I.010808
000320*****               RECORD  KEY   SHM-KEY.                        D.010808
000330     SELECT  T-M    ASSIGN  T1-MSD T2-MSD                         I.010221
000340                    ORGANIZATION  INDEXED                         I.010221
000350                    ACCESS  MODE  RANDOM                          I.010221
000360                    RECORD  KEY   T-KEY                           I.010221
000370         ALTERNATE  RECORD  KEY   T-KEY2.                         I.010221
000380     SELECT  THTM   ASSIGN  THT1-MSD THT2-MSD                     I.070926
000390                    ORGANIZATION  INDEXED                         I.070926
000400                    ACCESS  MODE  RANDOM                          I.070926
000410                    RECORD  KEY   THT-KEY                         I.070926
000420         ALTERNATE  RECORD  KEY   THT-KEY2.                       I.070926
000430     SELECT       JMSTD      ASSIGN   TO F7-MSD F7A-MSD F7B-MSD   I.130802
000440                  ORGANIZATION        INDEXED                     I.130802
000450                  ACCESS     MODE     DYNAMIC                     I.130802
000460                  RECORD     KEY      JMSTD-KEY1                  I.130802
000470                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY2     I.130802
000480                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY3     I.130802
000490                  FILE       STATUS   IS    ERR-STAT.             I.130802
000500     SELECT  PRN-F  ASSIGN  PRF-PRN999.
000510 I-O-CONTROL.
000520     APPLY  SHARED-MODE  ON  JSJD
000530                             JCON
000540                             TC-M
000550                             HI2-M                                I.010808
000560*****                        SHM                                  D.010808
000570                             T-M                                  I.010221
000580                             THTM                                 I.070926
000590                             JMSTD                                I.130802
000600     APPLY  SHIFT-CODE   ON  PRN-F.
000610 DATA              DIVISION.
000620 FILE              SECTION.
000630       COPY  L-JSJD.
000640       COPY  L-JCON.
000650       COPY  LITCM.
000660       COPY  LIHIM2.                                              I.010808
000670*****  COPY  L-SHM.                                               D.010808
000680       COPY  LITM.                                                I.010221
000690       COPY  LITHTM.                                              I.070926
000700       COPY   LJMSTD.                                             I.130802
000710 FD  PRN-F
000720     LABEL  RECORD  OMITTED
000730     LINAGE  33.
000740 01  PRN-R                 PIC X(180).
000750 WORKING-STORAGE   SECTION.
000760 01  W-JS                  PIC 9.                                 I.030723
000770 01  END-SW                PIC 9      VALUE 0.
000780 01  RED-SW                PIC 9      VALUE 0.
000790 01  TCM-SW                PIC 9      VALUE 0.                    A 911003
000800 01  WORK-1.
000810*****02  F                 PIC X(104).                            D.980825
000820*****02  F                 PIC X(100).                            D.990922
000830*****02  F                 PIC X(103).                            D.041015
000840     02  F                 PIC X(102).                            I.041015
000850     02  WORK-11           PIC 9(6).                               ì`ï[áÇ
000860 01  WORK-2.
000870*****02  F                 PIC X(35).                             D.980825
000880*****02  F                 PIC X(31).                             D.990922
000890*****02  F                 PIC X(34).                             D.041015
000900     02  F                 PIC X(33).                             I.041015
000910     02  WORK-M1           PIC N(02).                             "ÅÅÅÅ"
000920     02  WORK-M2           PIC X(01).                             "'"
000930     02  WORK-21.                                                  èoâ◊ì˙
000940*****    03  WORK-211      PIC ZZ.                                D.000106
000950         03  WORK-211      PIC 9(2).                              I.000106
000960         03  F             PIC X(4).
000970         03  WORK-212      PIC ZZ.                                   åé
000980         03  F             PIC X(4).
000990         03  WORK-213      PIC ZZ.                                   ì˙
001000     02  F                 PIC X(09).
001010     02  WORK-22           PIC N(2).                                ì`ãÊ
001020     02  F                 PIC X(4).
001030     02  WORK-23           PIC N(06).                             ëqå…ñº
001040 01  WORK-3.
001050*****02  F                 PIC X(7).                              I.910701
001060*****02  WORK-32           PIC 9(6).                              ºΩ√—ì˙ït
001070*****02  F                 PIC X(62).                             D.980825
001080*****02  F                 PIC X(58).                             D.990922
001090*****02  F                 PIC X(61).                             D.041015
001100     02  F                 PIC X(60).                             I.041015
001110     02  WORK-31           PIC 9(6).                              ëóÇËèÛáÇ
001120     02  F                 PIC X(37).                             C.910701
001130     02  WORK-33           PIC X(6).                              I.910701
001140 01  WORK-3A.                                                     I.910703
001150*****02  F                 PIC X(105).                            D.980825
001160*****02  F                 PIC X(104).                            D.000126
001170*****02  F                 PIC X(101).                            D.990922
001180*****02  F                 PIC X(05).                             D.041015
001190     02  F                 PIC X(04).                             I.041015
001200     02  WORK-34A.                                                I.000126
001210       03  WORK-34F        PIC X(1).                              I.000126
001220       03  WORK-341        PIC 9(1).                              I.010221
001230       03  WORK-342        PIC X(1).                              I.010221
001240       03  WORK-343        PIC 9(1).                              I.010221
001250*****  03  WORK-34         PIC Z(3).                              D.010221
001260       03  WORK-34R        PIC X(1).                              I.000126
001270     02  F                 PIC X(94).                             I.000126
001280     02  WORK-32           PIC X(6).                              I.910703
001290 01  WORK-4.
001300*****02  F                 PIC X(07).                             D.980825
001310*****02  F                 PIC X(03).                             D.990922
001320*****02  F                 PIC X(06).                             D.041015
001330     02  F                 PIC X(05).                             I.041015
001340     02  WORK-41           PIC 9(4).                              ìæà”êÊCD
001350     02  F                 PIC X(4).
001360     02  ST-CD1            PIC X(5).                              1.5BYTE
001370*****02  WORK-42           PIC N(24).                             D.020418
001380*****02  F                 PIC X(8).                              D.020418
001390     02  WORK-42           PIC N(26).                             I.020418
001400     02  F                 PIC X(5).                              I.020418
001410     02  WORK-43           PIC X(3).                              íºëóêÊCD
001420     02  F                 PIC X(4).
001430     02  WORK-44           PIC N(26).                             I.020418
001440*****02  WORK-44           PIC N(24).                             D.020418
001450     02  ED-CD1            PIC X(5).                              2BYTE
001460 01  WORK-5.
001470*****02  F                 PIC X(08).                             D.980825
001480*****02  ST-CD2            PIC X(5).                              D 911003
001490*****02  WORK-51           PIC N(4).                              D 911003
001500*****02  F                 PIC X(04).                             D.990922
001510*****02  F                 PIC X(07).                             D.041015
001520     02  F                 PIC X(06).                             I.041015
001530     02  ED-CD2            PIC X(5).                              2BYTE
001540*****02  F                 PIC X(31).                             D.130802
001550     02  F                 PIC X(18).                             I.130802
001560     02  WORK-NGP          PIC 99/99/99.                          I.130802
001570     02  WORK-NGPD  REDEFINES  WORK-NGP.                          I.130802
001580         03  F             PIC X(08).                             I.130802
001590     02  F                 PIC X(05).                             I.130802
001600     02  WORK-51F          PIC X(01).                             I.981019
001610     02  WORK-51           PIC X(10).                             I.981019
001620     02  WORK-51R          PIC X(01).                             I.981019
001630*****02  F                 PIC X(40).                             D 911003
001640*****02  F                 PIC X(37).                             D.981019
001650*****02  WORK-51A          PIC 9(06).                             D.981019
001660*****02  WORK-51AR  REDEFINES  WORK-51A  PIC X(06).               D.981019
001670     02  F                 PIC X(02).                             A 911003
001680     02  WORK-52           OCCURS  10.
001690         03  WORK-521      PIC ----B.                             1æØƒë´êî
001700*****02  F                 PIC X.                                 D.920826
001710     02  WORK-53           PIC ----.                                 åv
001720     02  WORK-54           PIC X(01).                             I.920826
001730     02  WORK-55           PIC ZZZ.                               I.920826
001740 01  WORK-6.
001750*****02  F                 PIC X(08).                             D.980825
001760*****02  F                 PIC X(04).                             D.990922
001770*****02  F                 PIC X(07).                             D.041015
001780     02  F                 PIC X(06).                             I.041015
001790     02  WORK-61           PIC 9(6).                               ïiñºCD
001800     02  F                 PIC X.
001810     02  ST-CD3            PIC X(5).                              1.5BYTE
001820     02  WORK-62           PIC N(24).                               ïiñº
001830     02  ED-CD3            PIC X(5).                              2BYTE
001840     02  F                 PIC X.
001850     02  WORK-63           PIC 9.                                 ª≤ΩﬁãÊï™
001860     02  F                 PIC X.
001870     02  WORK-64           OCCURS  10.
001880         03  WORK-641      PIC -----.                              éwê}êî
001890     02  WORK-65           PIC -------.                             çáåv
001900     02  WORK-65R  REDEFINES  WORK-65.                            A 911003
001910         03  WORK-651      PIC X(01).                             A 911003
001920         03  WORK-652      PIC ------.                            A 911003
001930     02  WORK-66           PIC X(01).                             A 911003
001940     02  WORK-67           PIC X.                                 I.070926
001950 01  WORK-6A.                                                     A 911003
001960*****02  F                 PIC X(103).                            D.980825
001970*****02  F                 PIC X(99).                             D.990922
001980*****02  F                 PIC X(102).                            D.041015
001990     02  F                 PIC X(101).                            I.041015
002000     02  WORK-61A          PIC ----.                              A 911003
002010     02  F                 PIC X(01).                             A 911003
002020     02  WORK-62A          PIC X(03).                             A 911003
002030 01  WORK-7.
002040*****02  F                 PIC X(24).                             D.980825
002050*****02  F                 PIC X(20).                             D.990922
002060*****02  F                 PIC X(23).                             D.041015
002070     02  F                 PIC X(22).                             I.041015
002080     02  WORK-70           PIC ZZ9.
002090     02  WORK-70R  REDEFINES   WORK-70  PIC X(03).                I.900618
002100     02  F                 PIC X(09).
002110     02  ST-CD4            PIC X(5).                              1.5BYTE
002120     02  WORK-71.
002130         03  WORK-711      PIC N(5).                              â^ëóâÔé–
002140         03  WORK-712      PIC N.
002150     02  F                 PIC X(4).
002160     02  WORK-72.
002170         03  WORK-721      PIC N(23).                               ìEóv
002180         03  WORK-722      PIC N(9).                               îzíBì˙
002190     02  ED-CD4            PIC X(5).                              2BYTE
002200     02  F                 PIC X(7).
002210     02  WORK-73           PIC -------.                             çáåv
002220 01  WORK-8.
002230     02  WORK-81           OCCURS  10.
002240         03  WORK-811      PIC S9(2).
002250     02  WORK-82           PIC S9(6).
002260 01  WORK-9.
002270     02  WORK-91           OCCURS  10.
002280         03  WORK-911      PIC S9(4).
002290     02  WORK-92           PIC S9(6).
002300 01  I                     PIC 9.
002310 01  J                     PIC 9(2).
002320 01  PAGE-C                PIC 9(3).
002330 01  GOKEI                 PIC S9(6).
002340 01  SEN-W                 PIC 9.                                  ëIë-W
002350 01  TEST-W                PIC 9.                                 √ΩƒàÛéöW
002360 01  DEN-W                 PIC 9(6).                               ì`ï[-W
002370 01  W-TCD                 PIC 9(4).                              I.070926
002380 01  W-TAN                 PIC 9(5).                              I.070926
002390 01  FROM-WK.
002400     02  KURA-W1           PIC 9(1).                              ëqCD(FR)
002410     02  TKU-W1.                                                  íºëó(FR)
002420         03  TKU-W11       PIC 9(4).                              ìæCD(FR)
002430         03  TKU-W12       PIC 9(3).                              íºCD(FR)
002440     02  DEN-W1            PIC 9(6).                              ì`ï[(FR)
002450 01  TO-WK.
002460     02  KURA-W2           PIC 9(1).                              ëqCD(TO)
002470     02  TKU-W2.                                                  íºëó(TO)
002480         03  TKU-W21       PIC 9(4).                              ìæCD(TO)
002490         03  TKU-W22       PIC 9(3).                              íºCD(TO)
002500     02  DEN-W2            PIC 9(6).                              ì`ï[(TO)
002510 01  KAKU-W                PIC 9.                                  ämîF-W
002520 01  ERR-STAT              PIC X(2).
002530 01  WYMD                  PIC 9(6).                              I.900411
002540 01  KEY-WK.
002550     02  KEY-W1            PIC 9(1).                              ëq∫∞ƒﬁ
002560     02  KEY-W2            PIC X(7).                              íºëóêÊCD
002570     02  KEY-W3            PIC 9(6).                              ì`ï[áÇ
002580 01  OLD-OKNO              PIC 9(6)  VALUE 0.                     I.900618
002590 01  SETSU                 PIC S9(3).                             A 911003
002600**********************
002610     COPY  LWMSG.
002620**********************
002630 SCREEN            SECTION.
002640 SD  GAMEN  END  STATUS  END-STS.
002650 01  ACP-NYURYOKU.
002660     02  ACP-JS    LINE   4.                                      I.030723
002670*****    03  COLUMN  71  PIC 9     INTO  W-JS                     D.040329
002680*****    03  COLUMN  60  PIC 9     INTO  W-JS                     D.070411
002690         03  COLUMN  45  PIC 9     INTO  W-JS                     I.070411
002700                                   CHECK  OVERFLOW  NO  IFC.      I.030723
002710*****02  ACP-SEN   LINE   7.                                      D.030723
002720     02  ACP-SEN   LINE   8.                                      I.030723
002730         03  COLUMN  45  PIC 9     INTO  SEN-W
002740                                   CHECK  OVERFLOW  NO  IFC.
002750     02  ACP-TEST  LINE  12.
002760         03  COLUMN  45  PIC 9     INTO  TEST-W
002770                                   CHECK  OVERFLOW  NO  IFC.
002780*****02  ACP-KURA1 LINE  17.                                      D.030723
002790     02  ACP-KURA1 LINE  16.                                      I.030723
002800         03  COLUMN  33  PIC 9(1)  INTO  KURA-W1
002810                                   CHECK  OVERFLOW  NO  IFC.
002820*****02  ACP-KURA2 LINE  19.                                      D.030723
002830     02  ACP-KURA2 LINE  17.                                      I.030723
002840         03  COLUMN  33  PIC 9(1)  INTO  KURA-W2
002850                                   CHECK  OVERFLOW  NO  IFC.
002860*****02  ACP-TKU1  LINE  17.                                      D.030723
002870     02  ACP-TKU1  LINE  16.                                      I.030723
002880         03  ACP-TKU11   COLUMN  39      PIC 9(4)
002890                   INTO  TKU-W11                    NO  IFC.
002900         03  ACP-TKU12   COLUMN  44      PIC 9(3)
002910                   INTO  TKU-W12   CHECK  OVERFLOW  NO  IFC.
002920*****02  ACP-TKU2  LINE  19.                                      D.030723
002930     02  ACP-TKU2  LINE  17.                                      I.030723
002940         03  ACP-TKU21   COLUMN  39      PIC 9(4)
002950                   INTO  TKU-W21                    NO  IFC.
002960         03  ACP-TKU22   COLUMN  44      PIC 9(3)
002970                   INTO  TKU-W22   CHECK  OVERFLOW  NO  IFC.
002980*****02  ACP-DEN1  LINE  17.                                      D.030723
002990     02  ACP-DEN1  LINE  16.                                      I.030723
003000         03  COLUMN  50  PIC 9(6)  INTO  DEN-W1
003010                                   CHECK  OVERFLOW  NO  IFC.
003020*****02  ACP-DEN2  LINE  19.                                      D.030723
003030     02  ACP-DEN2  LINE  17.                                      I.030723
003040         03  COLUMN  50  PIC 9(6)  INTO  DEN-W2
003050                                   CHECK  OVERFLOW  NO  IFC.
003060     02  ACP-KAKU  LINE  24.
003070         03  COLUMN  63  PIC 9     INTO  KAKU-W
003080                                   CHECK  OVERFLOW  NO  IFC.
003090 01  DSP-GAMEN.
003100     02  LINE   1  COLUMN  26  VALUE
003110           " èoâ◊éwê}èëÅié¿ê—Åj " REVERSE.
003120     02  LINE   4.                                                I.030723
003130         03  COLUMN  21  VALUE  "ã≥Å@àÁ=0 , àÍÅ@î =1 ...  ".      I.070411
003140*****    03  COLUMN  21  VALUE  "ã≥Å@àÁ=0 , ÉèÅ[ÉN=1 , ".         D.070411
003150*****    03  COLUMN  43  VALUE  NC"ÉJÉWÉÖÉAÉã".                   D.070411
003160*****    03  COLUMN  53  VALUE  "=2 ...  ".                       D.070411
003170*****    03  COLUMN  53  VALUE  "=2 , Ç`ÇkÇk=9 ...  ".            D.040329
003180*****02  LINE   5  COLUMN  25  VALUE  NC"ÇPÅ@î≠Å@çs".             D.030723
003190*****02  LINE   7.                                                D.030723
003200     02  LINE   7  COLUMN  25  VALUE  NC"ÇPÅ@î≠Å@çs".             I.030723
003210     02  LINE   8.                                                D.030723
003220         03  COLUMN  25  VALUE NC"ÇQÅ@çƒî≠çsÅ@Å@ëIë".
003230         03  COLUMN  44  VALUE   "[".
003240         03  COLUMN  46  VALUE   "]".
003250*****02  LINE  10  COLUMN  21  VALUE  NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".     D.030723
003260     02  LINE  11  COLUMN  21  VALUE  NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".     I.030723
003270     02  LINE  12.
003280         03  COLUMN  31  VALUE   "(YES=1,NO=2) [".
003290         03  COLUMN  46  VALUE   "]".
003300     02  LINE  15  COLUMN  31  VALUE    "ëq∫∞ƒﬁ".
003310     02  LINE  15  COLUMN  39  VALUE  NC"íºëóêÊ".
003320     02  LINE  15  COLUMN  50  VALUE  NC"ì`ï[áÇ".
003330     02  LINE  16  COLUMN  21  VALUE  NC"ÇeÇqÇnÇl".               I.030723
003340     02  LINE  16  COLUMN  43  VALUE    "-".                      I.030723
003350     02  LINE  17  COLUMN  21  VALUE  NC"ÇsÇn".                   I.030723
003360     02  LINE  17  COLUMN  43  VALUE    "-".                      I.030723
003370*****02  LINE  17  COLUMN  21  VALUE  NC"ÇeÇqÇnÇl".               D.030723
003380*****02  LINE  17  COLUMN  43  VALUE    "-".                      D.030723
003390*****02  LINE  19  COLUMN  21  VALUE  NC"ÇsÇn".                   D.030723
003400*****02  LINE  19  COLUMN  43  VALUE    "-".                      D.030723
003410     02  LINE  24.
003420         03  COLUMN  41  VALUE  NC"ämîFÅi".
003430         03  COLUMN  47  VALUE    "OK=1,NO=9".
003440         03  COLUMN  56  VALUE  NC"Åj".
003450         03  COLUMN  58  VALUE    "--->  ÿ¿∞›".
003460 01  DSP-CLER  LINE   1.
003470     02  CLEAR  SCREEN.
003480 01  DSP-CLER2.
003490     02  LINE  16  COLUMN  33  PIC X(23)  VALUE "  ".             I.030723
003500     02  LINE  16  COLUMN  43  VALUE    "-".                      I.030723
003510     02  LINE  17  COLUMN  33  PIC X(23)  VALUE "  ".             I.030723
003520     02  LINE  17  COLUMN  43  VALUE    "-".                      I.030723
003530*****02  LINE  17  COLUMN  33  PIC X(23)  VALUE "  ".             D.030723
003540*****02  LINE  17  COLUMN  43  VALUE    "-".                      D.030723
003550*****02  LINE  19  COLUMN  33  PIC X(23)  VALUE "  ".             D.030723
003560*****02  LINE  19  COLUMN  43  VALUE    "-".                      D.030723
003570*01  DSP-KYO.                                                     D.030723
003580*****03  LINE 01 COLUMN 01 PIC N(05) VALUE NC"Åkã≥Å@àÁÅl".        D.030723
003590*****03  LINE 01 COLUMN 01 PIC N(04) VALUE NC"Åkã≥àÁÅl".          D.030707
003600*01  DSP-IPN.                                                     D.030723
003610*****03  LINE 01 COLUMN 01 PIC N(05) VALUE NC"ÅkÉèÅ[ÉNÅl".        D.030723
003620*01  DSP-CAS.                                                     D.030723
003630*****03  LINE 01 COLUMN 01 PIC N(05) VALUE NC"ÅkÉJÉWÉÖÅl".        D.030723
003640*****03  LINE 01 COLUMN 01 PIC N(04) VALUE NC"ÅkàÍî Ål".          D.030707
003650     COPY  LSERR.                                                 R.900411
003660*
003670 PROCEDURE         DIVISION.
003680 MAINLINE-ROUTINE.
003690*****PERFORM  JS-ACP-RTN  THRU  JS-ACP-EX.                        D.030723
003700     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
003710     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
003720     IF  END-STS  =  "P9"  STOP  RUN.
003730     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
003740     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
003750              UNTIL  NOT  (END-SW  NOT  =  9).
003760     IF  PAGE-C  NOT =  1
003770         MOVE     SPACE     TO    PRN-R
003780         WRITE    PRN-R     AFTER     PAGE.
003790*
003800     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
003810 MAINLINE-END.
003820     STOP  RUN.
003830******************************************************************
003840*    ÉÅÉCÉìèàóù  ÅiÇoÇqÇnÇbÅ|ÇqÇsÇmÅj                            *
003850******************************************************************
003860 PROC-RTN.
003870     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003880     PERFORM  GENT-RTN   THRU  GENT-RTN-EXIT
003890              UNTIL  NOT  (END-SW  =  0  AND  RED-SW  =  1).
003900 PROC-RTN-EXIT.
003910     EXIT.
003920******************************************************************
003930*    ÅiÇfÇdÇmÇsÅ|ÇqÇsÇmÅj                                        *
003940******************************************************************
003950 GENT-RTN.
003960     PERFORM  READ2-RTN  THRU  READ2-RTN-EXIT.
003970     PERFORM  DETL-RTN   THRU  DETL-RTN-EXIT.
003980     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
003990     PERFORM  TOTL-RTN   THRU  TOTL-RTN-EXIT.
004000 GENT-RTN-EXIT.
004010     EXIT.
004020******************************************************************
004030*    èâä˙ê›íËèàóù  ÅiÇhÇmÇhÇsÅ|ÇqÇsÇmÅj                          *
004040******************************************************************
004050 INIT-RTN.
004060     ACCEPT   WYMD    FROM    DATE.                               I.900411
004070     MOVE  1  TO  PAGE-C.
004080     MOVE  0  TO  GOKEI.
004090     MOVE  0  TO  SETSU.                                          A 911003
004100 INIT-RTN-EXIT.
004110     EXIT.
004120******************************************************************
004130*    ëIëèàóù  ÅiÇrÇkÇbÇsÅ|ÇqÇsÇmÅj                              *
004140******************************************************************
004150 SLCT-RTN.
004160 SLCT-010.
004170     DISPLAY  DSP-CLER.
004180     DISPLAY  DSP-GAMEN.
004190*****IF IPN-KYO-KBN = 0    DISPLAY DSP-KYO                        D.030723
004200*****ELSE           IF IPN-KYO-KBN = 1    DISPLAY DSP-IPN         D.030723
004210*****               ELSE                  DISPLAY DSP-CAS.        D.030723
004220*****ELSE                  DISPLAY DSP-IPN.                       D.030707
004230 SLCT-015.                                                        I.030723
004240     ACCEPT   ACP-JS.                                             I.030723
004250     IF  END-STS       =  "P9"            MOVE  9  TO  END-SW     I.030723
004260                                          GO  TO  SLCT-RTN-EXIT.  I.030723
004270     IF  END-STS  NOT  =  "01"            GO  TO  SLCT-015.       I.030723
004280*****IF  W-JS     NOT  =  0  AND  1  AND  2  AND 9                D.040329
004290*****IF  W-JS     NOT  =  0  AND  1  AND  2                       D.070411
004300     IF  W-JS     NOT  =  0  AND  1                               I.070411
004310                                          GO  TO  SLCT-015.       I.030723
004320 SLCT-020.
004330     ACCEPT   ACP-SEN.
004340     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW
004350                                GO  TO  SLCT-RTN-EXIT.
004360     IF  END-STS       =  "09"  GO  TO  SLCT-015.                 I.030723
004370     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-020.
004380     IF  SEN-W   =  1  OR  2    GO  TO  SLCT-030
004390     ELSE                       GO  TO  SLCT-020.
004400 SLCT-030.
004410     ACCEPT   ACP-TEST.
004420     IF  END-STS       =  "09"  GO  TO  SLCT-020.
004430     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-030.
004440     IF  TEST-W  =  1
004450         PERFORM  TEST-RTN  THRU  TEST-RTN-EXIT
004460         GO  TO  SLCT-030.
004470     IF  TEST-W  =  2           GO  TO  SLCT-040
004480     ELSE                       GO  TO  SLCT-030.
004490 SLCT-040.
004500     IF  SEN-W    =  1          GO  TO  SLCT-100.
004510     ACCEPT   ACP-KURA1.
004520     IF  END-STS       =  "09"  DISPLAY  DSP-CLER2
004530     IF  END-STS       =  "09"  GO  TO  SLCT-030.
004540     IF  END-STS  NOT  =  "01"  AND  "06"
004550                                GO  TO  SLCT-040.
004560 SLCT-050.
004570     ACCEPT   ACP-TKU11.
004580     IF  END-STS       =  "09"  GO  TO  SLCT-040.
004590 SLCT-055.
004600     ACCEPT   ACP-TKU12.
004610     IF  END-STS       =  "09"  GO  TO  SLCT-050.
004620     IF  END-STS  NOT  =  "01"  AND  "06"
004630                                GO  TO  SLCT-055.
004640 SLCT-060.
004650     ACCEPT   ACP-DEN1.
004660     IF  END-STS       =  "09"  GO  TO  SLCT-050.
004670     IF  END-STS  NOT  =  "01"  AND  "06"
004680                                GO  TO  SLCT-060.
004690 SLCT-070.
004700     ACCEPT   ACP-KURA2.
004710     IF  END-STS       =  "09"  GO  TO  SLCT-060.
004720     IF  END-STS  NOT  =  "01"  AND  "06"
004730                                GO  TO  SLCT-070.
004740*****IF  KURA-W1  >  KURA-W2    GO  TO  SLCT-070.                 D.930601
004750 SLCT-080.
004760     ACCEPT   ACP-TKU21.
004770     IF  END-STS       =  "09"  GO  TO  SLCT-070.
004780 SLCT-085.
004790     ACCEPT   ACP-TKU22.
004800     IF  END-STS       =  "09"  GO  TO  SLCT-080.
004810     IF  END-STS  NOT  =  "01"  AND  "06"
004820                                GO  TO  SLCT-085.
004830*****IF  TKU-W1   >  TKU-W2     GO  TO  SLCT-080.                 D.930601
004840 SLCT-090.
004850     ACCEPT   ACP-DEN2.
004860     IF  END-STS       =  "09"  GO  TO  SLCT-080.
004870     IF  END-STS  NOT  =  "01"  AND  "06"
004880                                GO  TO  SLCT-090.
004890     IF  FROM-WK >  TO-WK       GO  TO  SLCT-040.                 I.930601
004900*****IF  DEN-W1  >  DEN-W2      GO  TO  SLCT-090.                 D.930601
004910 SLCT-100.
004920     ACCEPT  ACP-KAKU.
004930     IF  END-STS       =  "09"
004940         IF  SEN-W  =  1        DISPLAY  DSP-CLER2
004950                                GO  TO  SLCT-030
004960         ELSE                   GO  TO  SLCT-090.
004970     IF  END-STS  NOT  =  "01"  AND  "06"
004980                                GO  TO  SLCT-100.
004990     IF  KAKU-W  =  1           GO  TO  SLCT-RTN-EXIT.
005000     IF  KAKU-W  =  9           GO  TO  SLCT-010
005010     ELSE                       GO  TO  SLCT-100.
005020 SLCT-RTN-EXIT.
005030     EXIT.
005040******************************************************************
005050*    ÇqÇdÇ`ÇcèàóùÅiÇPÅj  ÅiÇqÇdÇ`ÇcÇPÅ|ÇqÇsÇmÅj                  *
005060******************************************************************
005070 READ1-RTN.
005080     IF  SEN-W   =  1  GO  TO  READ1-010
005090     ELSE              GO  TO  READ1-030.
005100 READ1-010.
005110*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ ( Ø∫≥))
005120     IF  RED-SW  =  1  GO  TO  READ1-020.
005130     READ  JSJD  NEXT  AT  END
005140                 MOVE   9  TO  END-SW
005150                 GO  TO  READ1-RTN-EXIT.
005160*****IF  W-JS    NOT = 9                                          D.040329
005170*****IF  JSJD-16 NOT = IPN-KYO-KBN          GO  TO  READ1-010.    D.030723
005180     IF  JSJD-16 NOT = W-JS                 GO  TO  READ1-010.    I.030723
005190     IF  JSJD-021    = 5000  OR  9850       GO  TO  READ1-010.    I.080709
005200     IF  JSJD-158  NOT  =  0  GO  TO  READ1-020.
005210     IF  JSJD-1211(1)  =  ZERO  AND  JSJD-1211(2)  =  ZERO  AND
005220         JSJD-1211(3)  =  ZERO  AND  JSJD-1211(4)  =  ZERO  AND
005230         JSJD-1211(5)  =  ZERO  AND  JSJD-1211(6)  =  ZERO  AND
005240         JSJD-1211(7)  =  ZERO  AND  JSJD-1211(8)  =  ZERO  AND
005250         JSJD-1211(9)  =  ZERO  AND  JSJD-1211(10) =  ZERO
005260         GO  TO  READ1-010.
005270     MOVE  1  TO  RED-SW.
005280     GO  TO  READ1-RTN-EXIT.
005290 READ1-020.
005300     READ  JSJD  NEXT  AT  END
005310                 MOVE  9  TO  END-SW
005320                 GO  TO  READ1-RTN-EXIT.
005330*****IF  W-JS    NOT = 9                                          D.040329
005340     IF  JSJD-16 NOT = W-JS                 GO  TO  READ1-010.    I.030723
005350     IF  JSJD-021    = 5000  OR  9850       GO  TO  READ1-010.    I.080709
005360*****IF  JSJD-16 NOT = IPN-KYO-KBN          GO  TO  READ1-010.    D.030728
005370     IF  JSJD-158  NOT  =  0  GO  TO  READ1-020.
005380     IF  JSJD-1211(1)  =  ZERO  AND  JSJD-1211(2)  =  ZERO  AND
005390         JSJD-1211(3)  =  ZERO  AND  JSJD-1211(4)  =  ZERO  AND
005400         JSJD-1211(5)  =  ZERO  AND  JSJD-1211(6)  =  ZERO  AND
005410         JSJD-1211(7)  =  ZERO  AND  JSJD-1211(8)  =  ZERO  AND
005420         JSJD-1211(9)  =  ZERO  AND  JSJD-1211(10) =  ZERO
005430         GO  TO  READ1-020.
005440     MOVE  1  TO  RED-SW.
005450     GO  TO  READ1-RTN-EXIT.
005460 READ1-030.
005470*    (º≠Ø∂•ªºΩﬁ•ƒ◊› … ÿ∞ƒﬁ (ª≤ Ø∫≥))
005480     IF  RED-SW  =  1  GO  TO  READ1-040.
005490     MOVE  KURA-W1  TO  JSJD-01.
005500     MOVE  TKU-W1   TO  JSJD-02.
005510     MOVE  DEN-W1   TO  JSJD-03.
005520     MOVE  0        TO  JSJD-04.
005530     START  JSJD  KEY  IS  NOT  <  JSJD-KEY  INVALID  KEY
005540                  MOVE  9  TO  END-SW
005550                  GO  TO  READ1-RTN-EXIT.
005560 READ1-040.
005570     READ  JSJD  NEXT  AT  END
005580                 MOVE  9  TO  END-SW
005590                 GO  TO  READ1-RTN-EXIT.
005600     MOVE  JSJD-01  TO  KEY-W1.
005610     MOVE  JSJD-02  TO  KEY-W2.
005620     MOVE  JSJD-03  TO  KEY-W3.
005630     IF  TO-WK    <  KEY-WK   MOVE  9  TO  END-SW
005640                              GO  TO  READ1-RTN-EXIT.
005650*****IF  JSJD-16 NOT = IPN-KYO-KBN          GO  TO  READ1-010.    D.930601
005660*****IF  JSJD-16 NOT = IPN-KYO-KBN          GO  TO  READ1-040.    D.030723
005670*****IF  W-JS    NOT = 9                                          D.040329
005680     IF  JSJD-16 NOT = W-JS                 GO  TO  READ1-040.    I.030723
005690     IF  JSJD-021    = 5000  OR  9850       GO  TO  READ1-040.    I.080709
005700     IF  JSJD-158  NOT  =  1  GO  TO  READ1-040.
005710     IF  JSJD-1211(1)  =  ZERO  AND  JSJD-1211(2)  =  ZERO  AND
005720         JSJD-1211(3)  =  ZERO  AND  JSJD-1211(4)  =  ZERO  AND
005730         JSJD-1211(5)  =  ZERO  AND  JSJD-1211(6)  =  ZERO  AND
005740         JSJD-1211(7)  =  ZERO  AND  JSJD-1211(8)  =  ZERO  AND
005750         JSJD-1211(9)  =  ZERO  AND  JSJD-1211(10) =  ZERO
005760         GO  TO  READ1-040.
005770     MOVE  1  TO  RED-SW.
005780 READ1-RTN-EXIT.
005790     EXIT.
005800******************************************************************
005810*    ÇqÇdÇ`ÇcèàóùÅiÇQÅj  ÅiÇqÇdÇ`ÇcÇQÅ|ÇqÇsÇmÅj                  *
005820******************************************************************
005830 READ2-RTN.
005840     MOVE  0         TO  TCM-SW.                                  A 911003
005850 READ2-010.
005860     MOVE  JSJD-021  TO  T-KEY.                                   I.010221
005870     READ  T-M   UNLOCK  INVALID  KEY                             I.010221
005880                         MOVE  ZERO      TO  T-TNC1  T-DCC.       I.010221
005890*    (¡Æ∏ø≥ª∑•œΩ¿ … ÿ∞ƒﬁ)
005900     MOVE  JSJD-021  TO  TC-TCD.
005910     MOVE  1         TO  TC-CCD.
005920     READ  TC-M  UNLOCK  INVALID  KEY
005930                         MOVE  JSJD-021  TO  WORK-41
005940                         MOVE  SPACE     TO  WORK-42
005950*****                    MOVE  ZERO      TO  TC-DNO               D.010221
005960                         GO  TO  READ2-020.
005970*****IF  ( TC-STK  NOT  =  0 )  AND  ( JSJD-022  =  1 )           D.971002
005980*****    MOVE  1     TO  TCM-SW                                   D.971002
005990*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
006000     MOVE  JSJD-021  TO  WORK-41.
006010     MOVE  TC-NAME   TO  WORK-42.
006020 READ2-020.
006030     IF  JSJD-022  =  1
006040         MOVE  SPACE  TO  WORK-43
006050         MOVE  SPACE  TO  WORK-44
006060         GO  TO  READ2-030
006070     ELSE
006080         MOVE  JSJD-021  TO  TC-TCD
006090         MOVE  JSJD-022  TO  TC-CCD
006100         READ  TC-M  UNLOCK  INVALID  KEY
006110                             MOVE  JSJD-022  TO  WORK-43
006120                             MOVE  SPACE     TO  WORK-44
006130*****                        MOVE  ZERO      TO  TC-DNO           D.010221
006140                             GO  TO  READ2-030.
006150*****IF  TC-STK  NOT  =  0                                        D.971002
006160*****    MOVE  1     TO  TCM-SW                                   D.971002
006170*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
006180     MOVE  JSJD-022  TO  WORK-43.
006190     MOVE  TC-NAME   TO  WORK-44.
006200 READ2-030.
006210*    (À›“≤•œΩ¿ … ÿ∞ƒﬁ)
006220*****MOVE  JSJD-09  TO  SHM-01.                                   D.010808
006230*****READ  SHM  UNLOCK  INVALID  KEY                              D.010808
006240     MOVE  SPACE    TO  WORK-67.                                  I.070926
006250     MOVE  JSJD-09  TO  HI-MHCD HI-HCD.                           I.010808
006260     READ  HI2-M  UNLOCK  INVALID  KEY                            I.010808
006270                        MOVE  SPACE  TO  WORK-62
006280                        GO  TO  READ2-040.
006290     MOVE  HI-NAME TO  WORK-62.                                   I.010808
006300*****MOVE  SHM-02  TO  WORK-62.                                   D.010808
006310 READ2-040.
006320     IF  JSJD-09     <  999900                                    I.070926
006330         PERFORM  TAN-RTN  THRU  TAN-EX.                          I.070926
006340*    (∫›ƒ€∞Ÿ•Ãß≤Ÿ … ÿ∞ƒﬁ)
006350     MOVE  2        TO  JCON2-01.
006360     MOVE  JSJD-14  TO  JCON2-02.
006370     READ  JCON  UNLOCK  INVALID  KEY
006380                         MOVE  SPACE  TO  WORK-711  WORK-712
006390                         GO  TO  READ2-RTN-EXIT.
006400     MOVE  JCON2-03  TO  WORK-711.
006410     MOVE  SPACE     TO  WORK-712.
006420 READ2-RTN-EXIT.
006430     EXIT.
006440******************************************************************
006450*    ñæç◊èoóÕèàóù  ÅiÇcÇdÇsÇkÅ|ÇqÇsÇmÅj                          *
006460******************************************************************
006470 DETL-RTN.
006480     IF  TCM-SW  =  1                                             A 911003
006490         GO  TO  DETL-010.                                        A 911003
006500     IF  DEN-W  NOT  =  JSJD-03
006510         PERFORM  HEAD-RTN  THRU  HEAD-RTN-EXIT.
006520     PERFORM  WRITE-RTN  THRU  WRITE-RTN-EXIT.
006530 DETL-010.                                                        A 911003
006540     IF  SEN-W  =  1
006550         MOVE  1  TO  JSJD-158
006560         REWRITE  JSJD-REC  INVALID  KEY
006570                            MOVE  JSJD-KEY  TO  ERR-K
006580                            MOVE  "JSJD"    TO  ERR-F
006590                            MOVE  "R"       TO  ERR-M
006600                            MOVE   0        TO  ERR-LIN
006610                            PERFORM  ERR-RTN   THRU  ERR-EX
006620                            PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006630                            STOP  RUN.
006640     MOVE  JSJD-03           TO  DEN-W.
006650     IF    JSJD-09  <  999900                                     *I920303
006660           ADD   WORK-92           TO  GOKEI.
006670     ADD   WORK-82           TO  SETSU.                           A 911003
006680 DETL-RTN-EXIT.
006690     EXIT.
006700******************************************************************
006710*    çáåvèoóÕèàóù  ÅiÇsÇnÇsÇkÅ|ÇqÇsÇmÅj                          *
006720******************************************************************
006730 TOTL-RTN.
006740     IF  TCM-SW  NOT  =  0                                        A 911004
006750         MOVE  0  TO  GOKEI                                       I.960410
006760         GO  TO  TOTL-RTN-EXIT.                                   A 911004
006770     IF  END-SW  =  9
006780***      PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
006790         COMPUTE  J  =  16  -  (I  *  2)                          *R 92/07
006800         MOVE   GOKEI           TO  WORK-73
006810         MOVE   ""3FE04F40A0""  TO  ST-CD4
006820         MOVE   ""3FE04FE080""  TO  ED-CD4
006830         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
006840         GO  TO  TOTL-RTN-EXIT.
006850     IF  JSJD-03  NOT  =  DEN-W
006860***      PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
006870         COMPUTE  J  =  16  -  (I  *  2)                          *I 92/07
006880         MOVE   GOKEI           TO  WORK-73
006890         MOVE   ""3FE04F40A0""  TO  ST-CD4
006900         MOVE   ""3FE04FE080""  TO  ED-CD4
006910         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
006920         MOVE  0  TO  GOKEI.
006930 TOTL-RTN-EXIT.
006940     EXIT.
006950******************************************************************
006960*    ÉZÉbÉgêîèoóÕèàóù  ÅiÇsÇnÇsÇkÇPÅ|ÇqÇsÇmÅj                    *
006970******************************************************************
006980 TOTL1-RTN.                                                       A 911003
006990     COMPUTE  J  =  16  -  (I  *  2)  -  1.                       A 911003
007000     IF  SETSU  NOT  =  0                                         A 911003
007010         MOVE  SETSU    TO  WORK-61A                              A 911003
007020         MOVE  "æØƒ"    TO  WORK-62A                              A 911003
007030         WRITE  PRN-R   FROM  WORK-6A  AFTER J                    A 911003
007040     ELSE                                                         A 911003
007050         MOVE  SPACE    TO  PRN-R                                 A 911003
007060         WRITE  PRN-R   AFTER J.                                  A 911003
007070     MOVE  0    TO  SETSU.                                        A 911003
007080 TOTL1-EX.                                                        A 911003
007090******************************************************************
007100*    å©èoÇµèoóÕèàóù  ÅiÇgÇdÇ`ÇcÅ|ÇqÇsÇmÅj                        *
007110******************************************************************
007120 HEAD-RTN.
007130     IF  PAGE-C  NOT  =  1
007140         MOVE  SPACE  TO  PRN-R
007150         WRITE  PRN-R  AFTER  PAGE.
007160     MOVE  ""3FE04F40A0""  TO  ST-CD1.
007170     MOVE  ""3FE04FE080""  TO  ED-CD1.
007180     MOVE  JSJD-03         TO  WORK-11.
007190*****MOVE  NC"ÅÅÅÅ"        TO  WORK-M1.                           D.900917
007200     MOVE    "'"           TO  WORK-M2.
007210*****MOVE  JSJD-071        TO  WORK-211.                          D.980519
007220     MOVE  JSJD-0712       TO  WORK-211.                          I.980519
007230     MOVE  JSJD-072        TO  WORK-212.
007240     MOVE  JSJD-073        TO  WORK-213.
007250     IF  JSJD-05  =  0  MOVE  NC"èoâ◊"  TO  WORK-22.
007260*****IF  JSJD-05  =  1  MOVE  NC"ï‘ïi"  TO  WORK-22.              D 911003
007270*****IF  JSJD-05  =  2  MOVE  NC"ïsó«"  TO  WORK-22.              D 911003
007280     IF  JSJD-05  =  3  MOVE  NC"í˘ê≥"  TO  WORK-22.
007290     IF  JSJD-05  =  7  MOVE  NC"ÉTèo"  TO  WORK-22.              A 911003
007300     MOVE  3         TO  JCON3-01.
007310     MOVE  JSJD-01   TO  JCON3-02.
007320     READ  JCON      UNLOCK  INVALID
007330                             MOVE ALL NX"2121"  TO  JCON3-03.
007340     MOVE  JCON3-03  TO  WORK-23.
007350     MOVE  JSJD-14B  TO  WORK-31.
007360     MOVE  SPACE     TO  WORK-34A.                                I.000126
007370*****IF  TC-DNO  NOT =  000  AND  900                             D.010221
007380*****    MOVE  "("       TO  WORK-34F                             D.010221
007390*****    MOVE  TC-DNO    TO  WORK-34                              D.010221
007400     MOVE  "("       TO  WORK-34F.                                I.010221
007410     MOVE  T-TNC1    TO  WORK-341.                                I.010221
007420     MOVE  "-"       TO  WORK-342.                                I.000126
007430     MOVE  T-DCC     TO  WORK-343.                                I.010221
007440     MOVE  ")"       TO  WORK-34R.                                I.000126
007450     MOVE  WYMD      TO  WORK-32.
007460*****MOVE  JSJD-06   TO  WORK-33.                                 D.980519
007470     MOVE  JSJD-06S  TO  WORK-33.                                 I.980519
007480     MOVE  1         TO  I.
007490     ADD   1         TO  PAGE-C.
007500     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
007510     WRITE  PRN-R  FROM  WORK-2  AFTER  4.
007520     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
007530     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
007540     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
007550     IF  JSJD-14B  =  OLD-OKNO                                    I.900618
007560           MOVE  SPACE     TO  WORK-70R                           I.900618
007570     ELSE  MOVE  JSJD-15A  TO  WORK-70.
007580     MOVE  JSJD-15   TO  WORK-721.
007590     MOVE  JSJD-14D  TO  WORK-722.
007600     MOVE  JSJD-14B  TO  OLD-OKNO.                                I.900618
007610 HEAD-RTN-EXIT.
007620     EXIT.
007630******************************************************************
007640*    ÇvÇqÇhÇsÇdèàóù  ÅiÇvÇqÇhÇsÇdÅ|ÇqÇsÇmÅj                      *
007650******************************************************************
007660 WRITE-RTN.
007670     INITIALIZE  WORK-5  WORK-8  WORK-9.
007680     MOVE  ""3FE04F40A0""  TO          ST-CD3.                    R 911003
007690     MOVE  ""3FE04FE080""  TO  ED-CD2  ED-CD3.
007700     MOVE  SPACE       TO  WORK-NGPD.                             I.130802
007710*****IF  JSJD-13  =  1                                            D 911003
007720*********MOVE  NC"óaÇËèoâ◊"  TO  WORK-51                          D 911003
007730*****ELSE                                                         D 911003
007740*********MOVE  SPACE         TO  WORK-51.                         D 911003
007750*****IF  JSJD-13  =  2                                            D.960626
007760*****    MOVE  JSJD-081      TO  WORK-51A                         D.960626
007770*****ELSE                                                         D.960626
007780*****MOVE  SPACE         TO  WORK-51AR.                           D.981019
007790*****IF  JSJD-14A  NOT  >  1                                      D.981019
007800     IF (JSJD-14A  NOT  >  1)  AND  (JSJD-20    =  SPACE)         I.981019
007810                               AND  (JSJD-08    =  ZERO)          I.130802
007820         IF  I  =  1
007830             WRITE  PRN-R  FROM  WORK-5  AFTER  5
007840             GO  TO  WRITE-010
007850         ELSE
007860*****        MOVE   SPACE  TO   PRN-R                             D 920629
007870*****        WRITE  PRN-R  AFTER  1                               D 920629
007880             WRITE  PRN-R  FROM  WORK-5  AFTER  1                 A 920629
007890             GO  TO  WRITE-010.
007900*****IF  JSJD-05   NOT  =  0
007910*****    COMPUTE WORK-811(1)  = JSJD-1211(1)  *  -1  / JSJD-14A
007920*****    COMPUTE WORK-811(2)  = JSJD-1211(2)  *  -1  / JSJD-14A
007930*****    COMPUTE WORK-811(3)  = JSJD-1211(3)  *  -1  / JSJD-14A
007940*****    COMPUTE WORK-811(4)  = JSJD-1211(4)  *  -1  / JSJD-14A
007950*****    COMPUTE WORK-811(5)  = JSJD-1211(5)  *  -1  / JSJD-14A
007960*****    COMPUTE WORK-811(6)  = JSJD-1211(6)  *  -1  / JSJD-14A
007970*****    COMPUTE WORK-811(7)  = JSJD-1211(7)  *  -1  / JSJD-14A
007980*****    COMPUTE WORK-811(8)  = JSJD-1211(8)  *  -1  / JSJD-14A
007990*****    COMPUTE WORK-811(9)  = JSJD-1211(9)  *  -1  / JSJD-14A
008000*****    COMPUTE WORK-811(10) = JSJD-1211(10) *  -1  / JSJD-14A
008010*****    COMPUTE WORK-82      = JSJD-1211(1)  +  JSJD-1211(2)
008020*****                         + JSJD-1211(3)  +  JSJD-1211(4)
008030*****                         + JSJD-1211(5)  +  JSJD-1211(6)
008040*****                         + JSJD-1211(7)  +  JSJD-1211(8)
008050*****                         + JSJD-1211(9)  +  JSJD-1211(10)
008060*****    COMPUTE WORK-82      = WORK-82       *  -1  / JSJD-14A
008070*****ELSE
008080*****COMPUTE WORK-811(1)  = JSJD-1211(1)  / JSJD-14A.             D.981019
008090*****COMPUTE WORK-811(2)  = JSJD-1211(2)  / JSJD-14A.             D.981019
008100*****COMPUTE WORK-811(3)  = JSJD-1211(3)  / JSJD-14A.             D.981019
008110*****COMPUTE WORK-811(4)  = JSJD-1211(4)  / JSJD-14A.             D.981019
008120*****COMPUTE WORK-811(5)  = JSJD-1211(5)  / JSJD-14A.             D.981019
008130*****COMPUTE WORK-811(6)  = JSJD-1211(6)  / JSJD-14A.             D.981019
008140*****COMPUTE WORK-811(7)  = JSJD-1211(7)  / JSJD-14A.             D.981019
008150*****COMPUTE WORK-811(8)  = JSJD-1211(8)  / JSJD-14A.             D.981019
008160*****COMPUTE WORK-811(9)  = JSJD-1211(9)  / JSJD-14A.             D.981019
008170*****COMPUTE WORK-811(10) = JSJD-1211(10) / JSJD-14A.             D.981019
008180*****COMPUTE WORK-82      = JSJD-1211(1)  + JSJD-1211(2)          D.981019
008190*****                     + JSJD-1211(3)  + JSJD-1211(4)          D.981019
008200*****                     + JSJD-1211(5)  + JSJD-1211(6)          D.981019
008210*****                     + JSJD-1211(7)  + JSJD-1211(8)          D.981019
008220*****                     + JSJD-1211(9)  + JSJD-1211(10)         D.981019
008230*****COMPUTE WORK-82      = WORK-82       / JSJD-14A.             D.981019
008240*****MOVE  WORK-811(1)   TO  WORK-521(1).                         D.981019
008250*****MOVE  WORK-811(2)   TO  WORK-521(2).                         D.981019
008260*****MOVE  WORK-811(3)   TO  WORK-521(3).                         D.981019
008270*****MOVE  WORK-811(4)   TO  WORK-521(4).                         D.981019
008280*****MOVE  WORK-811(5)   TO  WORK-521(5).                         D.981019
008290*****MOVE  WORK-811(6)   TO  WORK-521(6).                         D.981019
008300*****MOVE  WORK-811(7)   TO  WORK-521(7).                         D.981019
008310*****MOVE  WORK-811(8)   TO  WORK-521(8).                         D.981019
008320*****MOVE  WORK-811(9)   TO  WORK-521(9).                         D.981019
008330*****MOVE  WORK-811(10)  TO  WORK-521(10).                        D.981019
008340*****MOVE  WORK-82       TO  WORK-53.
008350*****MOVE  WORK-82       TO  WORK-53.                             D.981019
008360*****MOVE  "X"           TO  WORK-54.                             D.981019
008370*****MOVE  JSJD-14A      TO  WORK-55.                             D.981019
008380     IF  JSJD-14A       >  1                                      I.981019
008390         COMPUTE WORK-811(1)  = JSJD-1211(1)  / JSJD-14A          I.981019
008400         COMPUTE WORK-811(2)  = JSJD-1211(2)  / JSJD-14A          I.981019
008410         COMPUTE WORK-811(3)  = JSJD-1211(3)  / JSJD-14A          I.981019
008420         COMPUTE WORK-811(4)  = JSJD-1211(4)  / JSJD-14A          I.981019
008430         COMPUTE WORK-811(5)  = JSJD-1211(5)  / JSJD-14A          I.981019
008440         COMPUTE WORK-811(6)  = JSJD-1211(6)  / JSJD-14A          I.981019
008450         COMPUTE WORK-811(7)  = JSJD-1211(7)  / JSJD-14A          I.981019
008460         COMPUTE WORK-811(8)  = JSJD-1211(8)  / JSJD-14A          I.981019
008470         COMPUTE WORK-811(9)  = JSJD-1211(9)  / JSJD-14A          I.981019
008480         COMPUTE WORK-811(10) = JSJD-1211(10) / JSJD-14A          I.981019
008490         COMPUTE WORK-82      = JSJD-1211(1)  + JSJD-1211(2)      I.981019
008500                              + JSJD-1211(3)  + JSJD-1211(4)      I.981019
008510                              + JSJD-1211(5)  + JSJD-1211(6)      I.981019
008520                              + JSJD-1211(7)  + JSJD-1211(8)      I.981019
008530                              + JSJD-1211(9)  + JSJD-1211(10)     I.981019
008540         COMPUTE WORK-82      = WORK-82       / JSJD-14A          I.981019
008550         MOVE  WORK-811(1)   TO  WORK-521(1)                      I.981019
008560         MOVE  WORK-811(2)   TO  WORK-521(2)                      I.981019
008570         MOVE  WORK-811(3)   TO  WORK-521(3)                      I.981019
008580         MOVE  WORK-811(4)   TO  WORK-521(4)                      I.981019
008590         MOVE  WORK-811(5)   TO  WORK-521(5)                      I.981019
008600         MOVE  WORK-811(6)   TO  WORK-521(6)                      I.981019
008610         MOVE  WORK-811(7)   TO  WORK-521(7)                      I.981019
008620         MOVE  WORK-811(8)   TO  WORK-521(8)                      I.981019
008630         MOVE  WORK-811(9)   TO  WORK-521(9)                      I.981019
008640         MOVE  WORK-811(10)  TO  WORK-521(10)                     I.981019
008650         MOVE  WORK-82       TO  WORK-53                          I.981019
008660         MOVE  "X"           TO  WORK-54                          I.981019
008670         MOVE  JSJD-14A      TO  WORK-55.                         I.981019
008680     IF  JSJD-20    NOT =  SPACE                                  I.981019
008690         MOVE  "["           TO  WORK-51F                         I.981019
008700         MOVE  JSJD-20       TO  WORK-51                          I.981019
008710         MOVE  "]"           TO  WORK-51R.                        I.981019
008720     IF (JSJD-081    =  ZERO)   AND  (JSJD-082    =  ZERO)        I.130802
008730         MOVE  SPACE        TO  WORK-NGPD                         I.130802
008740         GO  TO  WRITE-005.                                       I.130802
008750     MOVE  JSJD-08       TO  JMSTD-KEY1.                          I.130802
008760     READ  JMSTD  UNLOCK  INVALID  KEY                            I.130802
008770         MOVE  999999        TO  WORK-NGP                         I.130802
008780         GO  TO  WRITE-005.                                       I.130802
008790     IF  JMSTD-01    NOT =  6                                     I.140428
008800         MOVE  JMSTD-02S     TO  WORK-NGP.                        I.130802
008810 WRITE-005.                                                       I.130802
008820     IF  I  =  1
008830*****    MOVE  JSJD-14A      TO  WORK-53                          D.920826
008840         WRITE  PRN-R  FROM  WORK-5  AFTER  5
008850     ELSE
008860*****    MOVE  ZERO          TO  WORK-53                          D.920826
008870         WRITE  PRN-R  FROM  WORK-5  AFTER  1.
008880 WRITE-010.
008890     MOVE  JSJD-09       TO  WORK-61.
008900     MOVE  JSJD-10       TO  WORK-63.
008910*****IF  JSJD-05  NOT  =  0
008920*****    COMPUTE  WORK-911(1)   =  JSJD-1211(1)   *   -1
008930*****    COMPUTE  WORK-911(2)   =  JSJD-1211(2)   *   -1
008940*****    COMPUTE  WORK-911(3)   =  JSJD-1211(3)   *   -1
008950*****    COMPUTE  WORK-911(4)   =  JSJD-1211(4)   *   -1
008960*****    COMPUTE  WORK-911(5)   =  JSJD-1211(5)   *   -1
008970*****    COMPUTE  WORK-911(6)   =  JSJD-1211(6)   *   -1
008980*****    COMPUTE  WORK-911(7)   =  JSJD-1211(7)   *   -1
008990*****    COMPUTE  WORK-911(8)   =  JSJD-1211(8)   *   -1
009000*****    COMPUTE  WORK-911(9)   =  JSJD-1211(9)   *   -1
009010*****    COMPUTE  WORK-911(10)  =  JSJD-1211(10)  *   -1
009020*****    COMPUTE  WORK-92       =  JSJD-1211(1)  +  JSJD-1211(2)
009030*****                           +  JSJD-1211(3)  +  JSJD-1211(4)
009040*****                           +  JSJD-1211(5)  +  JSJD-1211(6)
009050*****                           +  JSJD-1211(7)  +  JSJD-1211(8)
009060*****                           +  JSJD-1211(9)  +  JSJD-1211(10)
009070*****    COMPUTE  WORK-92       =  WORK-92        *   -1
009080*****    MOVE  WORK-911(1)   TO  WORK-641(1)
009090*****    MOVE  WORK-911(2)   TO  WORK-641(2)
009100*****    MOVE  WORK-911(3)   TO  WORK-641(3)
009110*****    MOVE  WORK-911(4)   TO  WORK-641(4)
009120*****    MOVE  WORK-911(5)   TO  WORK-641(5)
009130*****    MOVE  WORK-911(6)   TO  WORK-641(6)
009140*****    MOVE  WORK-911(7)   TO  WORK-641(7)
009150*****    MOVE  WORK-911(8)   TO  WORK-641(8)
009160*****    MOVE  WORK-911(9)   TO  WORK-641(9)
009170*****    MOVE  WORK-911(10)  TO  WORK-641(10)
009180*********MOVE  WORK-92       TO  WORK-65                          D 911003
009190*****    GO  TO  WRITE-020                                        A 911003
009200*****ELSE
009210     MOVE  JSJD-1211(1)   TO  WORK-641(1).
009220     MOVE  JSJD-1211(2)   TO  WORK-641(2).
009230     MOVE  JSJD-1211(3)   TO  WORK-641(3).
009240     MOVE  JSJD-1211(4)   TO  WORK-641(4).
009250     MOVE  JSJD-1211(5)   TO  WORK-641(5).
009260     MOVE  JSJD-1211(6)   TO  WORK-641(6).
009270     MOVE  JSJD-1211(7)   TO  WORK-641(7).
009280     MOVE  JSJD-1211(8)   TO  WORK-641(8).
009290     MOVE  JSJD-1211(9)   TO  WORK-641(9).
009300     MOVE  JSJD-1211(10)  TO  WORK-641(10).
009310     COMPUTE  WORK-92  =  JSJD-1211(1)  +  JSJD-1211(2)
009320                       +  JSJD-1211(3)  +  JSJD-1211(4)
009330                       +  JSJD-1211(5)  +  JSJD-1211(6)
009340                       +  JSJD-1211(7)  +  JSJD-1211(8)
009350                       +  JSJD-1211(9)  +  JSJD-1211(10).         R 911003
009360*********MOVE  WORK-92  TO  WORK-65.                              D 911003
009370 WRITE-020.                                                       A 911003
009380*****IF  JSJD-13  =  2                                            D.941114
009390*****IF  JSJD-13  =  5                                            D.960626
009400     IF  JSJD-13  =  5 OR 4                                       I.960626
009410         MOVE  "("       TO  WORK-651                             A 911003
009420         MOVE  WORK-92   TO  WORK-652                             A 911003
009430         MOVE  ")"       TO  WORK-66                              A 911003
009440      ELSE                                                        A 911003
009450         MOVE  WORK-92   TO  WORK-65                              A 911003
009460         MOVE  SPACE     TO  WORK-66.                             A 911003
009470     WRITE  PRN-R  FROM  WORK-6  AFTER  1.
009480     ADD  1  TO  I.
009490 WRITE-RTN-EXIT.
009500     EXIT.
009510******************************************************************
009520*    íPâøåüèoèàóù  ÅiÇsÇ`ÇmÅ|ÇqÇsÇmÅj                            *
009530******************************************************************
009540 TAN-RTN.                                                         I.070926
009550     MOVE JSJD-021 TO W-TCD.                                      I.070926
009560     IF W-TCD = 0460                                              I.070926
009570         MOVE 0458 TO W-TCD.                                      I.070926
009580     MOVE 0 TO W-TAN.                                             I.070926
009590     MOVE W-TCD TO THT-TCD.                                       I.070926
009600     MOVE JSJD-09 TO THT-HCD.                                     I.070926
009610     MOVE JSJD-10 TO THT-SIZ.                                     I.070926
009620     READ THTM UNLOCK INVALID                                     I.070926
009630         MOVE ZERO TO THT-T.                                      I.070926
009640     MOVE THT-T TO W-TAN.                                         I.070926
009650     IF W-TAN NOT = ZERO                                          I.070926
009660         GO TO TAN-EX.                                            I.070926
009670     MOVE W-TCD TO THT-TCD.                                       I.070926
009680     MOVE JSJD-09 TO THT-HCD.                                     I.070926
009690     MOVE 9 TO THT-SIZ.                                           I.070926
009700     READ THTM UNLOCK INVALID                                     I.070926
009710         MOVE ZERO TO THT-T.                                      I.070926
009720     MOVE THT-T TO W-TAN.                                         I.070926
009730     IF W-TAN = ZERO                                              I.070926
009740        MOVE  "•"      TO  WORK-67.                               I.070926
009750 TAN-EX.                                                          I.070926
009760     EXIT.                                                        I.070926
009770******************************************************************
009780*    ÉeÉXÉgàÛéöèàóù  ÅiÇsÇdÇrÇsÅ|ÇqÇsÇmÅj                        *
009790******************************************************************
009800 TEST-RTN.
009810     OPEN  OUTPUT  PRN-F.
009820     MOVE ""3FE04F40A0"" TO  ST-CD1.
009830     MOVE ""3FE04FE080"" TO  ED-CD1.
009840     MOVE  ALL    "9"    TO  WORK-11.
009850*****MOVE  NC"ÅÅÅÅ"      TO  WORK-M1.                             D.900917
009860     MOVE  "'"           TO  WORK-M2.
009870     MOVE  ALL    "9"    TO  WORK-211  WORK-212  WORK-213.
009880     MOVE  ALL  NC"Çm"   TO  WORK-23.
009890     MOVE  ALL    "9"    TO  WORK-31  WORK-32  WORK-33.           C.910701
009900     MOVE  ALL    "9"    TO  WORK-41  WORK-43.
009910     MOVE  ALL  NC"ÇX"   TO  WORK-42  WORK-44.
009920     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
009930     WRITE  PRN-R  FROM  WORK-2  AFTER  4.
009940     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
009950     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
009960     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
009970     MOVE  1  TO  I.
009980 TEST-010.
009990     MOVE ""3FE04F40A0"" TO          ST-CD3.                      R 911003
010000     MOVE ""3FE04FE080"" TO  ED-CD2  ED-CD3.
010010*****MOVE  ALL  NC"ÇX"   TO  WORK-51.                             D 911003
010020*****MOVE  ALL    "9"    TO  WORK-51A.                            D.960626
010030     MOVE         99     TO  WORK-521(1)  WORK-521(2)
010040                             WORK-521(3)  WORK-521(4)
010050                             WORK-521(5)  WORK-521(6)
010060                             WORK-521(7)  WORK-521(8)
010070                             WORK-521(9)  WORK-521(10).
010080     MOVE         999    TO  WORK-53.
010090     MOVE         "X"    TO  WORK-54.                             I.920826
010100     MOVE         999    TO  WORK-55.                             I.920826
010110     MOVE  ALL    "9"    TO  WORK-61.
010120     MOVE  ALL  NC"ÇX"   TO  WORK-62.
010130     MOVE  ALL    "9"    TO  WORK-63.
010140     MOVE  ALL    "9"    TO  WORK-641(1)  WORK-641(2)
010150                             WORK-641(3)  WORK-641(4)
010160                             WORK-641(5)  WORK-641(6)
010170                             WORK-641(7)  WORK-641(8)
010180                             WORK-641(9)  WORK-641(10).
010190     MOVE  ALL    "9"    TO  WORK-65.
010200     IF  I  =  1
010210         WRITE  PRN-R  FROM  WORK-5  AFTER  5
010220         WRITE  PRN-R  FROM  WORK-6  AFTER  1
010230     ELSE
010240         WRITE  PRN-R  FROM  WORK-5  AFTER  1
010250         WRITE  PRN-R  FROM  WORK-6  AFTER  1.
010260     IF  I  =  6  GO  TO  TEST-020
010270     ELSE         ADD  1  TO  I
010280                  GO  TO  TEST-010.
010290 TEST-020.
010300     MOVE ""3FE04F40A0"" TO  ST-CD4.
010310     MOVE ""3FE04FE080"" TO  ED-CD4.
010320*****MOVE       "999"    TO  WORK-61A.                            *D 92/07
010330*****MOVE       "æØƒ"    TO  WORK-62A.                            *D 92/07
010340     WRITE  PRN-R  FROM  WORK-6A  AFTER  1.                       A 911003
010350     MOVE  ALL  NC"ÇX"   TO  WORK-711  WORK-712
010360                             WORK-721  WORK-722.
010370     MOVE  ALL    "9"    TO  WORK-73  WORK-70.
010380     WRITE  PRN-R  FROM  WORK-7  AFTER  1.                        R 911003
010390     CLOSE  PRN-F.
010400 TEST-RTN-EXIT.
010410     EXIT.
010420******************************************************************
010430*    ÇnÇoÇdÇmèàóù  ÅiÇnÇoÇdÇmÅ|ÇqÇsÇmÅj                        *
010440******************************************************************
010450 OPEN-RTN.
010460     OPEN  I-O     JSJD
010470           INPUT   JCON
010480                   TC-M
010490                   HI2-M                                          I.010808
010500*****              SHM                                            D.010808
010510                   T-M                                            I.010221
010520                   THTM                                           I.070926
010530                   JMSTD                                          I.130802
010540           OUTPUT  PRN-F.
010550 OPEN-RTN-EXIT.
010560     EXIT.
010570******************************************************************
010580*    ÇbÇkÇnÇrÇdèàóù  ÅiÇbÇkÇrÇdÅ|ÇqÇsÇmÅj                        *
010590******************************************************************
010600 CLSE-RTN.
010610     CLOSE  JSJD
010620            JCON
010630            TC-M
010640            HI2-M                                                 I.010808
010650*****       SHM                                                   D.010808
010660            T-M                                                   I.010221
010670            THTM                                                  I.070926
010680            JMSTD                                                 I.130802
010690            PRN-F.
010700 CLSE-RTN-EXIT.
010710     EXIT.
010720*****
010730     COPY  LPERR.                                                 R.900411
010740     COPY  LPACPT.                                                A 911128
