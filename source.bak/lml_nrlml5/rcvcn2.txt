000010 IDENTIFICATION   DIVISION.
000020******************************************************************
000030*    “úi‘¤@@‘—Mƒf[ƒ^@Š¿ŽšƒR[ƒh•ÏŠ·iVƒVƒXƒeƒ€Œü‚¯j      *
000040*                                ‚O‚T^‚O‚X^‚O‚P@              *
000050*    [RCVCN2]                    TADASHI.I                       *
000060******************************************************************
000070 PROGRAM-ID.            RCVCNV.
000080 ENVIRONMENT            DIVISION.
000090 CONFIGURATION          SECTION.
000100 SOURCE-COMPUTER.       SYSTEM3100.
000110 OBJECT-COMPUTER.       SYSTEM3100.
000120 INPUT-OUTPUT           SECTION.
000130 FILE-CONTROL.
000140*----‚n^‚kŽóM‚s
000150     SELECT   JOLJT     ASSIGN  F1-MSD
000160                        ORGANIZATION  RELATIVE
000170                        ACCESS        SEQUENTIAL
000180                        FILE  STATUS  ERR-STAT.
000190*----‚n^‚kŽóM‚c
000200     SELECT   JOLJF     ASSIGN  F2-MSD
000210                        ORGANIZATION  SEQUENTIAL
000220                        ACCESS        SEQUENTIAL
000230                        FILE  STATUS  ERR-STAT.
000240 I-O-CONTROL.
000250 DATA                DIVISION.
000260 FILE                SECTION.
000270     COPY LJOLJT.
000280     COPY LJOLJF.
000290**
000300 WORKING-STORAGE  SECTION.
000310 01  ERR-STAT     PIC  X(02).
000320 01  HM           PIC  X(01).
000330 01  HR           PIC  9(04).
000340 01  HD           PIC  X(1024).
000350 01  II           PIC  9(02).
000360*
000370     COPY LWMSG.
000380**
000390 SCREEN             SECTION.
000400 SD  CRT-X
000410     END STATUS     ESTAT.
000420*
000430 01  DSP-AREA.
000440     02  DSP-ER1    LINE  01   COLUMN   20
000450             VALUE  NC"––@Š¿Žš•ÏŠ·’†@––".
000460*
000470     COPY LSMSG.
000480***
000490 PROCEDURE        DIVISION.
000500******************************************************************
000510*    ‚l‚`‚h‚m@‚q‚n‚t‚s‚h‚m‚d@@@@@@                        *
000520******************************************************************
000530 MAIN.
000540     OPEN   INPUT       JOLJT.
000550     OPEN   EXTEND      JOLJF.
000560 M01.
000570     READ  JOLJT  NEXT  AT  END
000580           GO  TO  M99.
000590*
000600     MOVE  "E"          TO  HM.
000610     MOVE  256          TO  HR.
000620     MOVE  JOLJT11-REC  TO  HD.
000630     CALL  "SJISS100"   USING  HM  HR  HD.
000640*
000650     MOVE  HD(1:256)    TO  JOLJT11-REC.
000660*
000670     MOVE  SPACE        TO  JOLJF11-REC.
000680     INITIALIZE             JOLJF11-REC.
000690     MOVE  JOLJT11-01   TO  JOLJF11-01.
000700     MOVE  JOLJT11-02   TO  JOLJF11-02.
000710     MOVE  JOLJT11-03   TO  JOLJF11-03.
000720     MOVE  JOLJT11-04   TO  JOLJF11-04.
000730     MOVE  JOLJT11-05   TO  JOLJF11-05.
000740     MOVE  JOLJT11-06   TO  JOLJF11-06.
000750     MOVE  JOLJT11-07   TO  JOLJF11-07.
000760     MOVE  JOLJT11-08   TO  JOLJF11-08.
000770     MOVE  JOLJT11-09   TO  JOLJF11-09.
000780     MOVE  JOLJT11-10   TO  JOLJF11-10.
000790     MOVE  JOLJT11-11   TO  JOLJF11-11.
000800     PERFORM VARYING II FROM 1 BY 1 UNTIL II > 10
000810             IF JOLJT11-1211S(II) = ZERO
000820                MOVE  JOLJT11-1211(II) TO  JOLJF11-1211(II)
000830             ELSE
000840                COMPUTE JOLJF11-1211(II) = JOLJT11-1211(II) * -1
000850             END-IF
000860     END-PERFORM.
000870     IF JOLJT11-122S = ZERO
000880        MOVE  JOLJT11-122     TO  JOLJF11-122
000890     ELSE
000900        COMPUTE JOLJF11-122 = JOLJT11-122 * -1.
000910     PERFORM VARYING II FROM 1 BY 1 UNTIL II > 10
000920             IF JOLJT11-1311S(II) = ZERO
000930                MOVE  JOLJT11-1311(II) TO  JOLJF11-1311(II)
000940             ELSE
000950                COMPUTE JOLJF11-1311(II) = JOLJT11-1311(II) * -1
000960             END-IF
000970     END-PERFORM.
000980     IF JOLJT11-132S = ZERO
000990        MOVE  JOLJT11-132     TO  JOLJF11-132
001000     ELSE
001010        COMPUTE JOLJF11-132 = JOLJT11-132 * -1.
001020     MOVE  JOLJT11-14   TO  JOLJF11-14.
001030     MOVE  JOLJT11-15   TO  JOLJF11-15.
001040     MOVE  JOLJT11-15A  TO  JOLJF11-15A.
001050     MOVE  JOLJT11-15B  TO  JOLJF11-15B.
001060     MOVE  JOLJT11-15C  TO  JOLJF11-15C.
001070     MOVE  JOLJT11-15D  TO  JOLJF11-15D.
001080     MOVE  JOLJT11-16   TO  JOLJF11-16.
001090     MOVE  JOLJT11-20   TO  JOLJF11-20.
001100     IF JOLJT11-16AS = ZERO
001110        MOVE  JOLJT11-16A     TO  JOLJF11-16A
001120     ELSE
001130        COMPUTE JOLJF11-16A = JOLJT11-16A * -1.
001140     MOVE  JOLJT11-19   TO  JOLJF11-19.
001150     MOVE  JOLJT11-168  TO  JOLJF11-168.
001160     MOVE  JOLJT11-17   TO  JOLJF11-17.
001170     MOVE  JOLJT11-18   TO  JOLJF11-18.
001180*
001190     WRITE JOLJF11-REC.
001200     IF ERR-STAT NOT = "00"
001210        MOVE "W"               TO ERR-M
001220        MOVE "JOLJF"           TO ERR-F
001230        MOVE JOLJF11-REC(1:30) TO ERR-K
001240        PERFORM ERR-RTN THRU ERR-EX.
001250*
001260     GO  TO  M01.
001270 M99.
001280     PERFORM END-RTN THRU END-EX.
001290     STOP  RUN.
001300*
001310 END-RTN.
001320     CLOSE JOLJF.
001330 END-EX.
001340     EXIT.
001350*
001360     COPY LPMSG.
