000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JSS70L.
000030***************************************************
000040*    PROGRAM        : ê∂ã¶â◊éDÅEì¸ì˙ãLÅ@Å@Å@Å@    *
000050*    DATA WRITTEN   : 04/04/12                    *
000060*    SCREEN USED    : UNUSED                      *
000070*    FORM   USED    : UNUSED                      *
000080*    PRINTER TYPE   : JIPS                        *
000090*    COMPILE TYPE   : COBOL                       *
000100*    BASE PROGRAM   : JT050L                      *
000110***************************************************
000120 ENVIRONMENT                    DIVISION.
000130 CONFIGURATION                  SECTION.
000140 SOURCE-COMPUTER.               SYSTEM150.
000150 OBJECT-COMPUTER.               SYSTEM150.
000160 INPUT-OUTPUT                   SECTION.
000170 FILE-CONTROL.
000180*****COPY  LIBCSE.                                                D.041203
000190     SELECT   SNFWR      ASSIGN  F1-MSD.
000200     SELECT   HI2-M     ASSIGN  F2-MSD
000210                        ORGANIZATION  INDEXED
000220                        ACCESS MODE   RANDOM
000230                        RECORD KEY    HI-KEY2.
000240     SELECT   TC-M      ASSIGN  F3-MSD
000250                        ORGANIZATION  INDEXED
000260                        ACCESS MODE   RANDOM
000270                        RECORD KEY    TC-KEY.
000280     SELECT   JCON      ASSIGN  F4-MSD
000290                        ORGANIZATION  INDEXED
000300                        ACCESS MODE   RANDOM
000310                        RECORD KEY    JCON2-KEY.
000320     SELECT  P-F        ASSIGN  P1-PRN999.
000330 I-O-CONTROL.
000340     APPLY   SHARED-MODE ON  SNFWR   HI2-M  TC-M   JCON
000350*****                        M-DATE                               D.041203
000360     APPLY   SHIFT-CODE  ON  P-F.
000370*
000380 DATA                       DIVISION.
000390 FILE                       SECTION.
000400*****COPY  LIBFDD.                                                D.041203
000410 COPY  LSNFWR.
000420 COPY  LIHIM2.
000430 COPY  LITCM.
000440 COPY  L-JCON.
000450 FD  P-F
000460     LABEL  RECORD   OMITTED   LINAGE    29.
000470 01  P-R                       PIC X(180).
000480 WORKING-STORAGE            SECTION.
000490 77  ERR-STAT                  PIC X(02)    VALUE SPACE.
000500 77  STR-SW                    PIC X(02).
000510 01  W-P                       PIC X(175).
000520 01  R1-R.
000530     02  R1-K1                 PIC X(05).
000540     02  FILLER                PIC X(01).
000550     02  R1-01                 PIC N(14).
000560     02  R1-K2                 PIC X(05).
000570 01  R2-R.
000580     02  R2-K1                 PIC X(05).
000590     02  FILLER                PIC X(01).
000600     02  R2-01                 PIC N(14).
000610     02  FILLER                PIC X(01).
000620*****02  R2-02        OCCURS   25.                                D.060822
000630*****    03  R2-021            PIC ZZZ.                           D.060822
000640     02  R2-02A.                                                  I.060822
000650       03  R2-02        OCCURS   25.                              I.060822
000660           04  R2-021          PIC ZZZ.                           I.060822
000670     02  R2-02B   REDEFINES R2-02A.                               I.060822
000680       03  R2-B02       OCCURS   25.                              I.060822
000690           04  R2-B020         PIC X.                             I.060822
000700           04  R2-B021         PIC ZZ.                            I.060822
000710     02  R2-03                 PIC ZZZZ.
000720     02  R2-K2                 PIC X(05).
000730 01  MID1-R.
000740     02  M1-K2                 PIC X(05)  VALUE ""3FE04FE080"".
000750     02  FILLER                PIC X(08)    VALUE   SPACE.
000760     02  M1-01                 PIC X(08).
000770     02  FILLER                PIC X(31)    VALUE   SPACE.
000780     02  M1-S                  PIC N(01)    VALUE   SPACE.
000790     02  FILLER                PIC X(08)    VALUE   SPACE.
000800     02  M1-06                 PIC 9(06).
000810     02  FILLER                PIC X(09)    VALUE   SPACE.
000820     02  M1-03                 PIC 9(02).
000830     02  FILLER                PIC X(03)    VALUE   SPACE.
000840     02  M1-04                 PIC Z9.
000850     02  FILLER                PIC X(03)    VALUE   SPACE.
000860     02  M1-05                 PIC Z9.
000870     02  FILLER                PIC X(14)    VALUE   SPACE.
000880     02  M1-02                 PIC 9(03).
000890 01  MID2-R.
000900     02  M2-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
000910     02  FILLER                PIC X(06)    VALUE   SPACE.
000920     02  M2-01                 PIC N(20).
000930     02  M2-K2                 PIC X(05)  VALUE ""3FE04FE080"".
000940     02  F                     PIC X(17)    VALUE   SPACE.
000950     02  M2-UM                 PIC N(01)    VALUE   SPACE.
000960     02  M2-UNO                PIC X(08)    VALUE   SPACE.
000970     02  F                     PIC X(35)    VALUE   SPACE.
000980     02  M2-02                 PIC ZZZ.
000990 01  MID3-R.
001000     02  M3-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001010     02  FILLER                PIC X(12)    VALUE   SPACE.
001020     02  M3-01                 PIC N(20).
001030     02  F                     PIC X(11)    VALUE   SPACE.
001040     02  M3-JS                 PIC N(14)    VALUE   SPACE.
001050     02  F                     PIC X(26)    VALUE   SPACE.
001060     02  M3-K2                 PIC X(05)  VALUE ""3FE04FE080"".
001070 01  MID4-R.
001080     02  FILLER                PIC X(08)    VALUE   SPACE.
001090     02  M5-K1                 PIC X(05)  VALUE ""3FE04F40A0"".
001100     02  M5-01                 PIC N(26).
001110     02  M5-K2                 PIC X(05)  VALUE ""3FE04FE080"".
001120     02  FILLER                PIC X(06)    VALUE   SPACE.
001130     02  M5-K2            PIC X(08) VALUE  ""3F507F4F654F40A0"".
001140     02  M4-NA                 PIC N(10)    VALUE   SPACE.
001150     02  F                     PIC X(02)    VALUE   SPACE.
001160     02  M5-02                 PIC N(06).
001170     02  M4-K4            PIC X(08) VALUE  ""3F504F40674F40A0"".
001180     02  FILLER                PIC X(03)   VALUE   SPACE.
001190     02  M4-K3            PIC X(08) VALUE  ""3F507F4F657F4F9B"".
001200     02  M4-01                 PIC N(03).
001210     02  M4-K5            PIC X(08) VALUE  ""3F504F40674F40A0"".
001220 01  MID5-R.
001230     02  F                     PIC X(53)   VALUE   SPACE.
001240     02  M5-TM                 PIC X(03)   VALUE   SPACE.
001250     02  F                     PIC X(01)   VALUE   SPACE.
001260     02  M5-TEL                PIC X(14)   VALUE   SPACE.
001270 01  MEI                           PIC X(1080).
001280 01  MEIR      REDEFINES       MEI.
001290     02  MEI-R      OCCURS            6.
001300         03  MEI1-R                PIC X(50).
001310         03  MEI2-R                PIC X(130).
001320 01  R3-R.
001330     02  R3-K1                 PIC X(05).
001340     02  FILLER                PIC X(24).
001350     02  R3-01                 PIC N(28).
001360     02  F                     PIC X(26).
001370     02  R3-02                 PIC N(06).
001380     02  R3-K2                 PIC X(05).
001390 01  ACT-WORK.
001400     02  W-ONO                 PIC 9(06).
001410     02  W-SEN                 PIC 9(01).                         I.060919
001420     02  W-TST                 PIC 9(01).
001430     02  W-OK                  PIC 9(01).
001440     02  I                     PIC 9(02).
001450     02  W-T                   PIC S9(03).
001460     02  OLD1                  PIC 9(06).                         I.060919
001470     02  OLD2                  PIC 9(03).
001480     02  A                     PIC X(03).
001490     02  AR     REDEFINES      A.
001500         03  AAR               PIC ZZ9.
001510     02  W-TEKI.
001520         03  W-TEKI1           PIC N(04).
001530         03  W-TEKI2           PIC N(19).
001540     02  P-TEKI.
001550         03  P-TEKI1           PIC N(19).
001560         03  P-TEKI2           PIC N(09).
001570*****02  W-OKNO                PIC 9(06).                         D.060919
001580*****02  W-NO                  PIC 9(03).                         D.060919
001590     02  W-ANAME.
001600       03  W-NNA               PIC N(24).
001610       03  W-NNMD  REDEFINES  W-NNA.
001620         04  W-NNM             PIC N(01)  OCCURS  24.
001630       03  W-PNA   REDEFINES  W-NNA.
001640         04  W-PNA1            PIC N(14).
001650         04  W-PNA2            PIC N(10).
001660       03  W-ONA               PIC N(14).
001670       03  W-ONMD  REDEFINES  W-ONA.
001680         04  W-ONM             PIC N(01)  OCCURS  14.
001690       03  W-UNA               PIC N(14).
001700       03  W-UNMD  REDEFINES  W-UNA.
001710         04  W-UNM             PIC N(01)  OCCURS  14.
001720     02  W-C.
001730       03  W-C1                PIC 9(02).
001740       03  W-C2                PIC 9(02).
001750       03  W-C3                PIC 9(02).
001760       03  W-C4                PIC 9(02).
001770     02  W-POC                 PIC 9(01).
001780     02  W-FOC                 PIC 9(01).
001790 01  W-AREA.
001800     02  LCNT                  PIC 9(02)   VALUE  90.
001810 01  SOUKO                   PIC N(06).
001820 01  K-1                     PIC X(05)  VALUE  ""3FE04F40A0"".
001830 01  K-2                     PIC X(05)  VALUE  ""3FE04FE080"".
001840 COPY    LWMSG.
001850*
001860 SCREEN                  SECTION.
001870 SD  CRT-X
001880     END STATUS  IS  ESTAT.
001890 01  CLE-01          LINE  1.
001900     02  CLEAR   SCREEN.
001910 01  DSP-AREA.
001920     02  DSP-01       LINE 1.
001930         03  COLUMN  30  VALUE  "                  "  REVERSE.
001940         03  COLUMN  31  VALUE  NC"ê∂ã¶â◊éDÅEì¸ì˙ãL".
001950     02  DSP-02      LINE  10.
001960         03  COLUMN  21  VALUE  NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".
001970         03  COLUMN  41  VALUE  "(YES=1,NO=2) [ ]".
001980     02  DSP-03      LINE  13.                                    I.060919
001990         03  COLUMN  21  VALUE    "êVãKî≠çs=1 ,çƒî≠çs=2 ...  ".   I.060919
002000*****02  DSP-03      LINE  15.                                    D.060919
002010*****    03  COLUMN  31  VALUE  NC"ëóÇËèÛáÇ".                     D.060919
002020*****    03  COLUMN  50  VALUE    "èIóπ=ÇÜ•9".                    D.060919
002030     02  DSP-09      LINE  23.
002040         03  COLUMN  41  VALUE  NC"ämîFÅi".
002050         03  COLUMN  47  VALUE  "OK=1,NO=9".
002060         03  COLUMN  56  VALUE  NC"Åj".
002070         03  COLUMN  58  VALUE  "---> ÿ¿∞›".
002080 01  DSP-AREA1.
002090     02  DSP-03      LINE  16.                                    I.060919
002100         03  COLUMN  31  VALUE  NC"ëóÇËèÛáÇ".                     I.060919
002110         03  COLUMN  50  VALUE    "èIóπ=ÇÜ•9".                    I.060919
002120 01  ACP-AREA.
002130     02  ACP-TST     LINE 10 COLUMN  55  PIC 9(01)
002140                 USING  W-TST     CHECK  OVERFLOW  NO  IFC.
002150     02  ACP-SEN     LINE 13 COLUMN  46  PIC 9(01)                I.060919
002160                 USING  W-SEN     CHECK  OVERFLOW  NO  IFC.       I.060919
002170*****02  ACP-ONO     LINE 15 COLUMN  42  PIC 9(06)                D.060919
002180     02  ACP-ONO     LINE 16 COLUMN  42  PIC 9(06)                I.060919
002190                 USING  W-ONO     CHECK  OVERFLOW  NO  IFC.
002200     02  ACP-OK      LINE 23 COLUMN  62  PIC 9(01)
002210                 INTO  W-OK      CHECK  OVERFLOW  NO  IFC.
002220 01  CLE-02.
002230     02  CLE-TST   LINE 10   COLUMN 55   VALUE " ".
002240     02  CLE-SEN   LINE 13   COLUMN 46   VALUE " ".               I.060919
002250*****02  CLE-ONO   LINE 15   COLUMN 42   VALUE "      ".          D.060919
002260     02  CLE-SHM   LINE 16   COLUMN 31   VALUE                    I.060919
002270          "                            ".                         I.060919
002280     02  CLE-ONO   LINE 16   COLUMN 42   VALUE "      ".          I.060919
002290     02  CLE-OK    LINE 23   COLUMN 62   VALUE " ".
002300 COPY    LSMSG.
002310*****COPY  LIBSCR.                                                D.041203
002320*
002330 PROCEDURE               DIVISION.
002340************************************
002350*    ÉÅÉCÉìÅ@ÉãÅ[É`Éì              *
002360************************************
002370 HAJIME.
002380     PERFORM   INT-RTN   THRU  INT-EX.
002390 MR005.
002400     DISPLAY        CLE-01      DSP-AREA.
002410 MR020.
002420     ACCEPT       ACP-TST.
002430     DISPLAY      DISP-MSG-SPACE.
002440     IF  ESTAT  =  "P9"
002450         GO  TO  MR999.
002460     IF  ESTAT  NOT  =  "01"   AND    "06"
002470         GO  TO  MR020.
002480     DISPLAY      ACP-TST.
002490     IF  W-TST  NOT  =  1   AND    2
002500         GO  TO  MR020.
002510     IF  W-TST    =  1
002520         PERFORM    TST-RTN   THRU     TST-EX
002530         GO  TO  MR020.
002540 MR025.                                                           I.060919
002550     ACCEPT        ACP-SEN.                                       I.060919
002560     DISPLAY       DISP-MSG-SPACE.                                I.060919
002570     IF  ESTAT  =  "P9"                                           I.060919
002580         GO  TO  MR999.                                           I.060919
002590     IF ESTAT  =  "09"                                            I.060919
002600        GO  TO  MR020.                                            I.060919
002610     IF ESTAT  NOT  =  "01"   AND    "06"                         I.060919
002620        GO  TO  MR030.                                            I.060919
002630     DISPLAY       ACP-SEN.                                       I.060919
002640     IF  W-SEN  NOT  =  1   AND    2                              I.060919
002650         GO  TO  MR025.                                           I.060919
002660     IF  W-SEN       =  1                                         I.060919
002670         DISPLAY CLE-SHM                                          I.060919
002680         GO  TO  MR050.                                           I.060919
002690     DISPLAY DSP-AREA1.                                           I.060919
002700 MR030.
002710     ACCEPT        ACP-ONO.
002720     DISPLAY       DISP-MSG-SPACE.
002730     IF  ESTAT  =  "P9"
002740         GO  TO  MR999.
002750     IF ESTAT  =  "09"
002760        GO  TO  MR025.                                            I.060919
002770*****   GO  TO  MR020.                                            D.060919
002780     IF ESTAT  NOT  =  "01"   AND    "06"
002790        GO  TO  MR030.
002800     DISPLAY       ACP-ONO.
002810 MR050.
002820     ACCEPT     ACP-OK.
002830     DISPLAY    DISP-MSG-SPACE.
002840     IF  ESTAT  =  "09"
002850         GO  TO  MR030.
002860     IF  ESTAT  NOT  =  "01"
002870         GO  TO  MR050.
002880     IF  W-OK   NOT  =  "1"   AND      "9"
002890         GO  TO  MR050.
002900     IF  W-OK        =  "9"
002910         DISPLAY  CLE-ONO
002920         GO  TO  MR030.
002930*
002940     IF  W-FOC     =  0
002950         MOVE  1       TO  W-FOC
002960         OPEN  INPUT   HI2-M   TC-M      JCON.
002970*****OPEN  INPUT   SNFWR.                                         D.060919
002980     OPEN  I-O     SNFWR.                                         I.060919
002990     MOVE   ZERO        TO      OLD1  OLD2.                       I.060919
003000*****MOVE   ZERO        TO      OLD2.                             D.060919
003010 MR055.
003020     READ    SNFWR     AT   END
003030         GO  TO  MR990.
003040     IF  W-SEN        =    1                                      I.060919
003050         IF  SNR1-97  NOT =    0             GO  TO  MR055.       I.060919
003060     IF  W-SEN        =    2                                      I.060919
003070         IF  SNR1-97      =    0             GO  TO  MR055.       I.060919
003080     IF  W-SEN        =    2                                      I.060919
003090         IF  SNR1-01      <    W-ONO         GO  TO  MR055.
003100     IF  W-SEN        =    2                                      I.060919
003110         IF  SNR1-01      >    W-ONO         GO  TO  MR990.
003120     MOVE   "OF"      TO         STR-SW.
003130 MR066.
003140*****IF  SNR1-03       =    1                                     D.060919
003150*****    MOVE   SNR1-01     TO   W-OKNO                           D.060919
003160*****    MOVE   SNR1-02     TO   W-NO.                            D.060919
003170*****IF  SNR1-02  NOT  =    OLD2                                  D.060919
003180     IF  (SNR1-01  NOT  =    OLD1)  OR  (SNR1-02  NOT  =    OLD2) I.060919
003190         PERFORM  HED-RTN  THRU   HED-EX
003200         MOVE   SNR1-01     TO      OLD1                          I.060919
003210         MOVE   SNR1-02     TO      OLD2.
003220     IF  SNR1-03        =   7
003230         GO  TO  MR080.
003240     PERFORM     MOV-RTN    THRU   MOV-EX.
003250     GO  TO  MR055.
003260 MR080.
003270     MOVE  SPACE     TO     R3-R.
003280     MOVE     K-1    TO     R3-K1.
003290*****MOVE  SNR2-05  TO     W-TEKI.                                D.040420
003300*****MOVE  W-TEKI2   TO     P-TEKI1.                              D.040420
003310     MOVE  SNR2-05  TO     P-TEKI1.                               I.040420
003320     MOVE  SNR2-04  TO     P-TEKI2.
003330     MOVE  P-TEKI    TO     R3-01.
003340     MOVE   SOUKO    TO     R3-02.
003350     MOVE     K-2    TO     R3-K2.
003360     IF  W-SEN               =  1                                 I.060919
003370         MOVE    1               TO   SNR2-97                     I.060919
003380         REWRITE   SNFWR-R2.                                      I.060919
003390     PERFORM     PRI-RTN    THRU     PRI-EX.
003400     INITIALIZE  R1-R     R2-R      MEI.
003410     GO  TO  MR055.
003420 MR990.
003430     IF  STR-SW  =  "ON"                    GO  TO  MR999.
003440     CLOSE  SNFWR.
003450     INITIALIZE  R1-R     R2-R      MEI.
003460     IF  W-SEN        =    2                                      I.060919
003470         GO TO MR030.
003480 MR999.
003490     PERFORM     END-RTN    THRU   END-EX.
003500     STOP  RUN.
003510*********************************************
003520*    ÇhÇmÇsÅ|ÇqÇsÇm                         *
003530*********************************************
003540 INT-RTN.
003550     INITIALIZE     ACT-WORK.
003560     DISPLAY        CLE-01      DSP-AREA.
003570***
003580     MOVE  NC"Åß"        TO  M2-UM.
003590     MOVE    "TEL"       TO  M5-TM.
003600 INT-EX.
003610     EXIT.
003620*********************************************
003630*    ÇdÇmÇcÅ|ÇqÇsÇm                         *
003640*********************************************
003650 END-RTN.
003660     IF  W-FOC     =  1
003670         CLOSE  HI2-M   TC-M    JCON.
003680     DISPLAY CLE-01.
003690 END-EX.
003700     EXIT.
003710**********************************************
003720*    ÇgÇdÇcÅ|ÇqÇsÇm                          *
003730**********************************************
003740 HED-RTN.
003750     MOVE    SNR1-06    TO  TC-KEY.
003760     READ    TC-M    WITH UNLOCK     INVALID
003770         MOVE   SPACE   TO  TC-UNO
003780         MOVE  ALL NX"2121"  TO  TC-NAME
003790         MOVE  ALL NX"2121"  TO  TC-JSU
003800         MOVE  ALL NX"2121"  TO  TC-JSS.
003810     MOVE   TC-UNO   TO  M1-01.
003820     MOVE   SNR1-02  TO  M1-02.
003830     MOVE   SNR1-051 TO  M1-03.
003840     MOVE   SNR1-052 TO  M1-04.
003850     MOVE   SNR1-053 TO  M1-05.
003860     MOVE   SNR1-01  TO  M1-06.
003870     MOVE   TC-JSU   TO  M2-01.
003880     MOVE   TC-JSS   TO  M3-01.
003890     MOVE   SNR1-09  TO  AAR.
003900     MOVE   A        TO  M4-01.
003910     MOVE   TC-NAME  TO  M5-01.
003920     MOVE   SNR1-07  TO  JCON2-02.
003930     MOVE   "2"      TO  JCON2-01.
003940     READ   JCON     WITH UNLOCK  INVALID
003950         MOVE   ALL NX"2121"  TO  JCON2-03.
003960     MOVE   JCON2-03 TO  M5-02.
003970     MOVE   SNR1-08  TO  JCON3-02.
003980     MOVE   "3"      TO  JCON3-01.
003990     READ   JCON     WITH UNLOCK  INVALID
004000         MOVE   ALL NX"2121"  TO  JCON3-03.
004010     MOVE   JCON3-03 TO  SOUKO.
004020*****MOVE  "700-0034"       TO  M2-UNO.                           D.060106
004030*****MOVE  NC"â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇUÅ@Å@" TO  M3-JS.            D.060106
004040     MOVE  "700-0975"       TO  M2-UNO.                           I.060106
004050     MOVE  NC"â™éRésç°ÇWíöñ⁄ÇPÇUÅ|ÇPÇVÅ@Å@" TO  M3-JS.            I.060106
004060     MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–Å@Å@" TO  M4-NA.
004070     MOVE  "086-243-2456  " TO  M5-TEL.                           I.060317
004080*****MOVE  "086-252-2456  " TO  M5-TEL.                           D.060317
004090 HED-EX.
004100     EXIT.
004110**********************************************
004120*    ÇoÇqÇhÅ|ÇqÇsÇm                          *
004130**********************************************
004140 PRI-RTN.
004150     IF  W-POC     =  0
004160         MOVE  1       TO  W-POC
004170         OPEN  OUTPUT  P-F.
004180     MOVE SPACE  TO  P-R.
004190     IF  LCNT    NOT =  90
004200         WRITE  P-R  AFTER  PAGE.
004210     MOVE    SPACE  TO  W-P.
004220     MOVE    MID1-R TO  W-P.
004230     MOVE    W-P    TO  P-R.
004240     WRITE   P-R  AFTER 5.
004250     MOVE    SPACE TO  P-R.
004260     MOVE    OLD2  TO  M2-02.                                     I.060919
004270*****MOVE    W-NO  TO  M2-02.                                     D.060919
004280 PRI-005.
004290     MOVE    SPACE   TO  W-P.
004300     MOVE    MID2-R  TO  W-P.
004310     MOVE    W-P     TO  P-R.
004320     WRITE   P-R  AFTER 2.
004330     MOVE    SPACE TO  P-R.
004340     MOVE    SPACE   TO  W-P.
004350     MOVE    MID3-R  TO  W-P.
004360     MOVE    W-P     TO  P-R.
004370     WRITE   P-R  AFTER 1.
004380     MOVE    SPACE TO  P-R.
004390     MOVE    SPACE   TO  W-P.
004400     MOVE    MID4-R  TO  W-P.
004410     MOVE    W-P     TO  P-R.
004420     WRITE   P-R  AFTER 1.
004430     MOVE    SPACE TO  P-R.
004440     MOVE    SPACE   TO  W-P.
004450     MOVE  MID5-R        TO  W-P.
004460     MOVE  W-P           TO  P-R.
004470     WRITE  P-R     AFTER  1.
004480     MOVE  SPACE         TO  P-R.
004490     MOVE  SPACE         TO  W-P.
004500     WRITE   P-R  AFTER 2.
004510     MOVE    0    TO    I.
004520 PRI-010.
004530     ADD     1    TO    I.
004540     IF      I     >    6
004550         GO  TO  PRI-020.
004560     MOVE    MEI1-R(I)     TO    P-R.
004570     WRITE   P-R  AFTER 1.
004580     MOVE    SPACE TO  P-R.
004590     MOVE    MEI2-R(I)     TO    P-R.
004600     WRITE   P-R  AFTER 1.
004610     MOVE    SPACE TO  P-R.
004620     GO  TO  PRI-010.
004630 PRI-020.
004640     MOVE    SPACE         TO    W-P.
004650     MOVE    R3-R          TO    W-P.
004660     MOVE    W-P           TO    P-R.
004670     WRITE   P-R  AFTER 2.
004680     MOVE    SPACE TO  P-R.
004690     MOVE    7     TO  LCNT.
004700 PRI-EX.
004710     EXIT.
004720***************************************************
004730*    ÇsÇrÇsÅ|ÇqÇsÇm                               *
004740***************************************************
004750 TST-RTN.
004760     IF  W-POC     =  0
004770         MOVE  1       TO  W-POC
004780         OPEN  OUTPUT  P-F.
004790     MOVE    SPACE   TO  P-R.
004800     IF   LCNT   NOT   =     90
004810         WRITE   P-R     AFTER    PAGE.
004820     MOVE   ALL "X" TO  M1-01.
004830     MOVE   ALL "9" TO  M1-02.
004840     MOVE   "99"    TO  M1-03.
004850     MOVE   "99"    TO  M1-04.
004860     MOVE   "99"    TO  M1-05.
004870     MOVE   ALL "9" TO  M1-06.
004880     MOVE   SPACE   TO  W-P.
004890     MOVE   MID1-R  TO  W-P.
004900     MOVE   W-P     TO  P-R.
004910     WRITE  P-R     AFTER   5.
004920     MOVE   SPACE   TO  P-R.
004930     MOVE  ALL NC"Çm"   TO    M2-01.
004940     MOVE   ALL "X" TO  M2-UNO.
004950     MOVE    SPACE   TO    W-P.
004960     MOVE    MID2-R  TO    W-P.
004970     MOVE    W-P     TO    P-R.
004980     WRITE   P-R     AFTER     2.
004990     MOVE    SPACE   TO    P-R.
005000     MOVE  ALL NC"Çm"   TO    M3-01.
005010     MOVE  ALL NC"Çm"   TO    M3-JS.
005020     MOVE  SPACE       TO    W-P.
005030     MOVE  MID3-R      TO    W-P.
005040     MOVE  W-P         TO    P-R.
005050     WRITE   P-R       AFTER   1.
005060     MOVE  SPACE       TO    P-R.
005070     MOVE  ALL NC"Çm"   TO    M4-01.
005080     MOVE  ALL NC"Çm"   TO    M5-01.
005090     MOVE  ALL NC"Çm"   TO    M5-02.
005100     MOVE  ALL NC"Çm"   TO    M4-NA.
005110     MOVE  SPACE       TO    W-P.
005120     MOVE  MID4-R      TO    W-P.
005130     MOVE  W-P         TO    P-R.
005140     WRITE   P-R   AFTER 1.
005150     MOVE   SPACE      TO    P-R.
005160     MOVE  ALL "X"       TO  M5-TEL.
005170     MOVE  MID5-R        TO  W-P.
005180     MOVE  W-P           TO  P-R.
005190     WRITE  P-R     AFTER  1.
005200     MOVE  SPACE         TO  P-R.
005210     WRITE  P-R     AFTER  2.
005220     MOVE    0         TO    LCNT.
005230 TST-010.
005240     MOVE    K-1     TO    R1-K1.
005250     MOVE  ALL NC"Çm" TO    R1-01.
005260     MOVE    K-2     TO    R1-K2.
005270     MOVE    SPACE   TO    W-P.
005280     MOVE    R1-R    TO    W-P.
005290     MOVE    W-P     TO    P-R.
005300     WRITE   P-R     AFTER     1.
005310     MOVE    SPACE   TO    P-R.
005320     MOVE    K-1     TO    R2-K1.
005330     MOVE  ALL NC"Çm" TO    R2-01.
005340     MOVE    0       TO    I.
005350 TST-020.
005360     ADD     1       TO    I.
005370     IF      I       >     25
005380         GO  TO  TST-030.
005390     MOVE  ALL "9"   TO    R2-021(I).
005400     GO  TO  TST-020.
005410 TST-030.
005420     MOVE  ALL "9"   TO    R2-03.
005430     MOVE  SPACE     TO    W-P.
005440     MOVE  R2-R      TO    W-P.
005450     MOVE  W-P       TO    P-R.
005460     WRITE   P-R     AFTER     1.
005470     MOVE SPACE      TO  P-R.
005480     ADD     1       TO  LCNT.
005490     IF    LCNT   NOT   =    6
005500         GO  TO  TST-010.
005510     MOVE    K-1     TO   R3-K1.
005520     MOVE  ALL NC"Çm" TO   R3-01.
005530     MOVE  ALL NC"Çm" TO   R3-02.
005540     MOVE    K-2     TO   R3-K2.
005550     MOVE    SPACE   TO   W-P.
005560     MOVE    R3-R    TO   W-P.
005570     MOVE    W-P     TO   P-R.
005580     WRITE   P-R     AFTER     2.
005590     MOVE SPACE      TO  P-R.
005600     ADD     1       TO  LCNT.
005610 TST-EX.
005620     EXIT.
005630***************************************************
005640*    ÇlÇnÇuÅ|ÇqÇsÇm                               *
005650***************************************************
005660 MOV-RTN.
005670     MOVE   SPACE    TO  R1-R  R2-R  MEI1-R(SNR1-03)
005680                                     MEI2-R(SNR1-03).
005690     MOVE   K-1      TO  R1-K1.
005700     MOVE   SNR1-04 TO  HI-MHCD HI-HCD.
005710     READ   HI2-M    WITH UNLOCK  INVALID
005720         MOVE   ZERO          TO  HI-ASSD
005730         MOVE   ZERO          TO  HI-HKB                          I.060822
005740         MOVE   ALL NX"2121"  TO  HI-NAME.
005750     MOVE   ALL NX"2121"     TO  W-NNA  W-ONA  W-UNA.
005760     IF    HI-NAME       =   SPACE
005770                         GO  TO  MOV-008.
005780     MOVE   HI-NAME TO  W-NNA.
005790     MOVE   25      TO  W-C1.
005800 MOV-001.
005810     SUBTRACT    1    FROM   W-C1.
005820     IF    W-C1          =    ZERO
005830                         GO  TO  MOV-008.
005840     IF    W-NNM(W-C1)   =   SPACE
005850                         GO  TO  MOV-001.
005860     IF    W-C1          <   15
005870                         MOVE   W-NNA      TO  W-UNA
005880                         GO  TO  MOV-008.
005890     MOVE   ZERO    TO  W-C2.
005900 MOV-002.
005910     ADD         1    TO     W-C2.
005920     IF    W-C2    >    14
005930                        MOVE   W-PNA1         TO  W-ONA
005940                        MOVE   W-PNA2         TO  W-UNA
005950                        GO  TO  MOV-006.
005960     MOVE  W-NNM(W-C2)  TO   W-ONM(W-C2).
005970     IF    W-NNM(W-C2)  NOT =    SPACE
005980                        GO  TO  MOV-002.
005990     COMPUTE  W-C3   =  W-C1      -     W-C2.
006000     IF    W-C3    >    14
006010                        GO  TO  MOV-002.
006020*
006030     MOVE  14           TO   W-C4.
006040 MOV-003.
006050     IF    W-C4          =    ZERO
006060                         MOVE  NC"ÇcÇ`ÇsÇ`Å@ÉGÉâÅ["  TO  ERR-MSGN
006070                         DISPLAY  DISP-MSG-01  DISP-BUZ-B
006080                         DISPLAY  DISP-MSG-SPACE
006090                         GO  TO  MOV-006.
006100     MOVE  W-NNM(W-C1)  TO   W-UNM(W-C4).
006110     SUBTRACT    1    FROM   W-C1  W-C4.
006120     IF    W-C1     NOT  =    W-C2
006130                         GO  TO  MOV-003.
006140 MOV-006.
006150     IF    W-ONA         =    SPACE
006160                         GO  TO  MOV-008.
006170     IF    W-UNA         =    SPACE
006180                         GO  TO  MOV-008.
006190     IF    W-UNM(14) NOT =    SPACE
006200                         GO  TO  MOV-008.
006210     MOVE   15      TO  W-C1.
006220     MOVE   14      TO  W-C2.
006230 MOV-007.
006240     SUBTRACT    1    FROM   W-C1  W-C2.
006250     IF    W-C2     NOT  =    ZERO
006260                         MOVE  W-UNM(W-C2)   TO  W-UNM(W-C1)
006270                         GO  TO  MOV-007.
006280     MOVE  SPACE         TO  W-UNM(W-C1).
006290     IF    W-UNM(14)     =    SPACE
006300                         GO  TO  MOV-006.
006310 MOV-008.
006320     MOVE   W-ONA   TO  R1-01.
006330     MOVE   K-2     TO  R1-K2.
006340     MOVE   SPACE   TO  W-P.
006350     MOVE   R1-R    TO  W-P.
006360     MOVE   W-P     TO  MEI1-R(SNR1-03).
006370     MOVE   K-1     TO  R2-K1.
006380     MOVE   W-UNA   TO  R2-01.
006390 MOV-010.
006400     COMPUTE W-T  = SNR1-101(01) + SNR1-101(02) + SNR1-101(03)
006410                  + SNR1-101(04) + SNR1-101(05) + SNR1-101(06)
006420                  + SNR1-101(07) + SNR1-101(08) + SNR1-101(09)
006430                  + SNR1-101(10) + SNR1-101(11) + SNR1-101(12)
006440                  + SNR1-101(13) + SNR1-101(14) + SNR1-101(15)
006450                  + SNR1-101(16) + SNR1-101(17) + SNR1-101(18)
006460                  + SNR1-101(19) + SNR1-101(20) + SNR1-101(21)
006470                  + SNR1-101(22) + SNR1-101(23) + SNR1-101(24)
006480                  + SNR1-101(25) + SNR1-101(26) + SNR1-101(27).
006490*****IF  0        =    HI-S1(01)  AND  HI-S1(02)                  D.060822
006500*****             AND  HI-S1(03)  AND  HI-S1(04)                  D.060822
006510*****             AND  HI-S1(05)  AND  HI-S1(06)                  D.060822
006520*****             AND  HI-S1(07)                                  D.060822
006530     IF  (HI-S1(01) NOT = 0)  OR  (HI-S1(02) NOT = 0)  OR         I.060822
006540         (HI-S1(03) NOT = 0)  OR  (HI-S1(04) NOT = 0)  OR         I.060822
006550         (HI-S1(05) NOT = 0)  OR  (HI-S1(06) NOT = 0)  OR         I.060822
006560         (HI-S1(07) NOT = 0)                                      I.060822
006570         GO  TO  MOV-015.                                         I.060822
006580     IF   HI-HKB        = 0                                       I.060822
006590                MOVE    SNR1-101(02)    TO   R2-021(01)
006600                MOVE    SNR1-101(04)    TO   R2-021(02)
006610                MOVE    SNR1-101(05)    TO   R2-021(03)
006620                MOVE    SNR1-101(06)    TO   R2-021(04)
006630                MOVE    SNR1-101(07)    TO   R2-021(05)
006640                MOVE    SNR1-101(08)    TO   R2-021(06)
006650                MOVE    SNR1-101(09)    TO   R2-021(07)
006660                MOVE    SNR1-101(10)    TO   R2-021(08)
006670                MOVE    SNR1-101(11)    TO   R2-021(09)
006680                MOVE    SNR1-101(12)    TO   R2-021(10)
006690                MOVE    SNR1-101(13)    TO   R2-021(11)
006700                MOVE    SNR1-101(14)    TO   R2-021(12)
006710                MOVE    SNR1-101(15)    TO   R2-021(13)
006720                MOVE    SNR1-101(16)    TO   R2-021(14)
006730                MOVE    SNR1-101(17)    TO   R2-021(15)
006740                MOVE    SNR1-101(18)    TO   R2-021(16)
006750                MOVE    SNR1-101(19)    TO   R2-021(17)
006760                MOVE    SNR1-101(20)    TO   R2-021(18)
006770                MOVE    SNR1-101(21)    TO   R2-021(19)
006780                MOVE    SNR1-101(22)    TO   R2-021(20)
006790                MOVE    SNR1-101(23)    TO   R2-021(21)
006800                MOVE    SNR1-101(24)    TO   R2-021(22)
006810                MOVE    SNR1-101(25)    TO   R2-021(23)
006820                MOVE    SNR1-101(26)    TO   R2-021(24)
006830                MOVE    SNR1-101(27)    TO   R2-021(25)
006840                GO  TO  MOV-020.                                  I.060822
006850     MOVE    SNR1-101(02)    TO   R2-B021(01).                    I.060822
006860     MOVE    SNR1-101(04)    TO   R2-B021(02).                    I.060822
006870     MOVE    SNR1-101(05)    TO   R2-B021(03).                    I.060822
006880     MOVE    SNR1-101(06)    TO   R2-B021(04).                    I.060822
006890     MOVE    SNR1-101(07)    TO   R2-B021(05).                    I.060822
006900     MOVE    SNR1-101(08)    TO   R2-B021(06).                    I.060822
006910     MOVE    SNR1-101(09)    TO   R2-B021(07).                    I.060822
006920     MOVE    SNR1-101(10)    TO   R2-B021(08).                    I.060822
006930     MOVE    SNR1-101(11)    TO   R2-B021(09).                    I.060822
006940     MOVE    SNR1-101(12)    TO   R2-B021(10).                    I.060822
006950     MOVE    SNR1-101(13)    TO   R2-B021(11).                    I.060822
006960     MOVE    SNR1-101(14)    TO   R2-B021(12).                    I.060822
006970     MOVE    SNR1-101(15)    TO   R2-B021(13).                    I.060822
006980     MOVE    SNR1-101(16)    TO   R2-B021(14).                    I.060822
006990     MOVE    SNR1-101(17)    TO   R2-B021(15).                    I.060822
007000     MOVE    SNR1-101(18)    TO   R2-B021(16).                    I.060822
007010     MOVE    SNR1-101(19)    TO   R2-B021(17).                    I.060822
007020     MOVE    SNR1-101(20)    TO   R2-B021(18).                    I.060822
007030     MOVE    SNR1-101(21)    TO   R2-B021(19).                    I.060822
007040     MOVE    SNR1-101(22)    TO   R2-B021(20).                    I.060822
007050     MOVE    SNR1-101(23)    TO   R2-B021(21).                    I.060822
007060     MOVE    SNR1-101(24)    TO   R2-B021(22).                    I.060822
007070     MOVE    SNR1-101(25)    TO   R2-B021(23).                    I.060822
007080     MOVE    SNR1-101(26)    TO   R2-B021(24).                    I.060822
007090     MOVE    SNR1-101(27)    TO   R2-B021(25).                    I.060822
007100     IF  SNR1-101(02)    NOT =  ZERO                              I.060822
007110         MOVE    "*"             TO   R2-B020(01).                I.060822
007120     IF  SNR1-101(04)    NOT =  ZERO                              I.060822
007130         MOVE    "*"             TO   R2-B020(02).                I.060822
007140     IF  SNR1-101(05)    NOT =  ZERO                              I.060822
007150         MOVE    "*"             TO   R2-B020(03).                I.060822
007160     IF  SNR1-101(06)    NOT =  ZERO                              I.060822
007170         MOVE    "*"             TO   R2-B020(04).                I.060822
007180     IF  SNR1-101(07)    NOT =  ZERO                              I.060822
007190         MOVE    "*"             TO   R2-B020(05).                I.060822
007200     IF  SNR1-101(08)    NOT =  ZERO                              I.060822
007210         MOVE    "*"             TO   R2-B020(06).                I.060822
007220     IF  SNR1-101(09)    NOT =  ZERO                              I.060822
007230         MOVE    "*"             TO   R2-B020(07).                I.060822
007240     IF  SNR1-101(10)    NOT =  ZERO                              I.060822
007250         MOVE    "*"             TO   R2-B020(08).                I.060822
007260     IF  SNR1-101(11)    NOT =  ZERO                              I.060822
007270         MOVE    "*"             TO   R2-B020(09).                I.060822
007280     IF  SNR1-101(12)    NOT =  ZERO                              I.060822
007290         MOVE    "*"             TO   R2-B020(10).                I.060822
007300     IF  SNR1-101(13)    NOT =  ZERO                              I.060822
007310         MOVE    "*"             TO   R2-B020(11).                I.060822
007320     IF  SNR1-101(14)    NOT =  ZERO                              I.060822
007330         MOVE    "*"             TO   R2-B020(12).                I.060822
007340     IF  SNR1-101(15)    NOT =  ZERO                              I.060822
007350         MOVE    "*"             TO   R2-B020(13).                I.060822
007360     IF  SNR1-101(16)    NOT =  ZERO                              I.060822
007370         MOVE    "*"             TO   R2-B020(14).                I.060822
007380     IF  SNR1-101(17)    NOT =  ZERO                              I.060822
007390         MOVE    "*"             TO   R2-B020(15).                I.060822
007400     IF  SNR1-101(18)    NOT =  ZERO                              I.060822
007410         MOVE    "*"             TO   R2-B020(16).                I.060822
007420     IF  SNR1-101(19)    NOT =  ZERO                              I.060822
007430         MOVE    "*"             TO   R2-B020(17).                I.060822
007440     IF  SNR1-101(20)    NOT =  ZERO                              I.060822
007450         MOVE    "*"             TO   R2-B020(18).                I.060822
007460     IF  SNR1-101(21)    NOT =  ZERO                              I.060822
007470         MOVE    "*"             TO   R2-B020(19).                I.060822
007480     IF  SNR1-101(22)    NOT =  ZERO                              I.060822
007490         MOVE    "*"             TO   R2-B020(20).                I.060822
007500     IF  SNR1-101(23)    NOT =  ZERO                              I.060822
007510         MOVE    "*"             TO   R2-B020(21).                I.060822
007520     IF  SNR1-101(24)    NOT =  ZERO                              I.060822
007530         MOVE    "*"             TO   R2-B020(22).                I.060822
007540     IF  SNR1-101(25)    NOT =  ZERO                              I.060822
007550         MOVE    "*"             TO   R2-B020(23).                I.060822
007560     IF  SNR1-101(26)    NOT =  ZERO                              I.060822
007570         MOVE    "*"             TO   R2-B020(24).                I.060822
007580     IF  SNR1-101(27)    NOT =  ZERO                              I.060822
007590         MOVE    "*"             TO   R2-B020(25).                I.060822
007600     GO  TO  MOV-020.                                             I.060822
007610*****  ELSE     MOVE    SNR1-101(01)    TO   R2-021(01)           D.060822
007620*****           MOVE    SNR1-101(02)    TO   R2-021(02)           D.060822
007630*****           MOVE    SNR1-101(03)    TO   R2-021(03)           D.060822
007640*****           MOVE    SNR1-101(04)    TO   R2-021(04)           D.060822
007650*****           MOVE    SNR1-101(05)    TO   R2-021(05)           D.060822
007660*****           MOVE    SNR1-101(06)    TO   R2-021(06)           D.060822
007670*****           MOVE    SNR1-101(07)    TO   R2-021(07)           D.060822
007680*****           MOVE    SNR1-101(25)    TO   R2-021(23)           D.060822
007690*****           MOVE    SNR1-101(26)    TO   R2-021(24)           D.060822
007700 MOV-015.                                                         I.060822
007710     MOVE    SNR1-101(01)    TO   R2-021(01).                     I.060822
007720     MOVE    SNR1-101(02)    TO   R2-021(02).                     I.060822
007730     MOVE    SNR1-101(03)    TO   R2-021(03).                     I.060822
007740     MOVE    SNR1-101(04)    TO   R2-021(04).                     I.060822
007750     MOVE    SNR1-101(05)    TO   R2-021(05).                     I.060822
007760     MOVE    SNR1-101(06)    TO   R2-021(06).                     I.060822
007770     MOVE    SNR1-101(07)    TO   R2-021(07).                     I.060822
007780     MOVE    SNR1-101(25)    TO   R2-021(23).                     I.060822
007790     MOVE    SNR1-101(26)    TO   R2-021(24).                     I.060822
007800     MOVE    SNR1-101(27)    TO   R2-021(25).
007810 MOV-020.
007820     MOVE    W-T     TO    R2-03.
007830     MOVE    SPACE   TO    W-P.
007840     MOVE    R2-R    TO    W-P.
007850     MOVE    W-P     TO    MEI2-R(SNR1-03).
007860     MOVE    0       TO  W-T.
007870     IF  W-SEN               =  1                                 I.060919
007880         MOVE    1               TO   SNR1-97                     I.060919
007890         REWRITE   SNFWR-R1.                                      I.060919
007900 MOV-EX.
007910     EXIT.
007920 COPY    LPMSG.
