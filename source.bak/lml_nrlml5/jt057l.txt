000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         JT057L.
000030**************************************************
000040**************************************************
000050**                                              **
000060**     ëóÇËèÛî≠çsÅiÉgÉiÉ~â^óAópÅj               **
000070**                                              **
000080**        USER  NAME : ì˙êiÉSÉÄ.                **
000090**        DATE       : 1988•07•24               **
000100**        TYPE       : COBOL                    **
000110**        PROGRAM-ID : JT057L                   **
000120**        SCREEN-ID  : ------.                  **
000130**        AUTHOR     : HAJIME  MIZUNO           **
000140**************************************************
000150**************************************************
000160 ENVIRONMENT         DIVISION.
000170 CONFIGURATION       SECTION.
000180 SOURCE-COMPUTER.    SYSTEM150.
000190 OBJECT-COMPUTER.    SYSTEM150.
000200 INPUT-OUTPUT        SECTION.
000210 FILE-CONTROL.
000220     COPY  LIBCSE.                                                I.981027
000230*****SELECT  GDMM   ASSIGN  GDMM-MSD                              D.011018
000240*****               ORGANIZATION  INDEXED                         D.011018
000250*****               ACCESS  MODE  RANDOM                          D.011018
000260*****               RECORD  KEY   GDMM-KEY                        D.011018
000270*****               FILE  STATUS  ERR-STAT.                       D.011018
000280     SELECT  OKJF     ASSIGN  TO  F1-MSD                          ëóÇËèÛÇe
000290         ORGANIZATION         INDEXED
000300         ACCESS               DYNAMIC
000310         RECORD               OKJF-KEY
000320         FILE STATUS          IS  ERR-STAT.
000330     SELECT  TC-M     ASSIGN  TO  F2-MSD                          íºëóêÊÇl
000340         ORGANIZATION         INDEXED
000350         ACCESS               DYNAMIC
000360         RECORD               TC-KEY
000370         FILE STATUS          IS  ERR-STAT.
000380     SELECT  JCON     ASSIGN  TO  F3-MSD                          ÇbÇmÇsÇe
000390         ORGANIZATION         INDEXED
000400         ACCESS               DYNAMIC
000410         RECORD               JCON3-KEY
000420         FILE STATUS          IS  ERR-STAT.
000430     SELECT  P-F      ASSIGN  TO  P-PRN999.
000440 I-O-CONTROL.
000450     APPLY  SHARED-MODE  ON  OKJF  TC-M  JCON
000460*****                        GDMM                                 D.011018
000470                             M-DATE                               I.981027
000480     APPLY   SHIFT-CODE ON P-F.
000490*********************************************
000500**                                          *
000510**        DATA             DIVISION         *
000520**                                          *
000530*********************************************
000540 DATA                DIVISION.
000550 FILE                SECTION.
000560     COPY  LIBFDD.                                                I.981027
000570*****COPY  L-GDMM.                                                D.011018
000580     COPY  LOKJF.
000590     COPY  L-JCON.
000600     COPY  LITCM.
000610*
000620 FD  P-F
000630     LABEL       RECORD  OMITTED
000640     LINAGE          IS       24.
000650 01  P-R                     PIC     X(136).
000660*
000670 01  P-R1.                                                        5 LINE
000680     03  CODEK1              PIC     X(05).                       2.0 BYTE
000690*****03  F                   PIC     X(44).                       D.930614
000700*****03  F                   PIC     X(12).                       D.980826
000710*****03  F                   PIC     X(11).                       D.950202
000720*****03  R1-C                PIC     X(01).                       D.950202
000730     03  F                   PIC     X(07).                       I.980826
000740     03  R1-01A              PIC         N.                       YY
000750*****03  F                   PIC         X.                       D.890825
000760     03  R1-01B              PIC         N.                       YY
000770     03  F                   PIC         X.
000780     03  R1-02A              PIC         N.                       MM
000790     03  R1-02B              PIC         N.                       MM
000800     03  F                   PIC         X.
000810     03  R1-03A              PIC         N.                       DD
000820     03  R1-03B              PIC         N.                       DD
000830 01  P-R2.                                                        10-12 L
000840     03  CODEK2              PIC     X(05).                       2.0 BYTE
000850*****03  F                   PIC     X(15).                       D.980826
000860     03  F                   PIC     X(10).                       I.980826
000870     03  R2-01               PIC     N(09).
000880     03  F                   PIC     X(01).
000890     03  R2-02               PIC     N(02).
000900     03  F                   PIC     X(01).
000910     03  R2-03               PIC     N(03).
000920 01  P-R3.                                                        13 LINE
000930     03  CODEK3              PIC     X(05).                       2.0 BYTE
000940*****03  F                   PIC     X(15).                       D.980826
000950     03  F                   PIC     X(10).                       I.980826
000960     03  R3-01               PIC     N(08).
000970     03  F                   PIC     X(03).
000980     03  R3-02               PIC     N(02).
000990 01  P-R31.                                                       16 LINE
001000*****03  F                   PIC     X(34).                       D.980826
001010     03  F                   PIC     X(29).                       I.980826
001020     03  R5-03               PIC     9(06).                       ëóÇËèÛáÇ
001030     03  F                   PIC     X(01).                       I.950202
001040     03  R3-05               PIC     N(01).                       I.950202
001050 01  P-R4.                                                        18-19 L
001060     03  CODEK4              PIC     X(05).                       1.5 BYTE
001070*****03  F                   PIC     X(18).                       D.930614
001080*****03  F                   PIC     X(13).                       D.980826
001090     03  F                   PIC     X(08).                       I.980826
001100     03  R4-01               PIC     N(12).
001110*****03  F                   PIC     X(02).                       D.930614
001120     03  F                   PIC     X(11).                       I.930614
001130     03  R4-02               PIC     N(12).
001140 01  P-R5.                                                        20 LINE
001150     03  CODEK5              PIC     X(05).                       1.5 BYTE
001160*****03  F                   PIC     X(18).                       D.930614
001170*****03  F                   PIC     X(16).                       D.980826
001180*****03  R5-01               PIC     N(12).                       D.940218
001190*****03  R5-01               PIC     X(12).                       D.970129
001200*****03  F                   PIC     X(05).                       D.930614
001210*****03  F                   PIC     X(17).                       D.970129
001220     03  F                   PIC     X(11).                       I.970129
001230     03  R5-01               PIC     X(14).                       I.970129
001240     03  F                   PIC     X(15).                       I.970129
001250     03  R5-02               PIC     X(14).                       I.970129
001260*****03  R5-02               PIC     X(12).                       D.970129
001270*****03  F                   PIC     X(10).                       D.890825
001280*****03  R5-03               PIC     9(06).                       ëóÇËèÛáÇ
001290 01  P-R6.                                                        22-23 L
001300     03  CODEK6A             PIC     X(05).                       1.5 BYTE
001310*****03  F                   PIC     X(18).                       D.930614
001320*****03  F                   PIC     X(13).                       D.980826
001330     03  F                   PIC     X(08).                       I.980826
001340     03  R6-01               PIC     N(12).
001350     03  CODEK6B             PIC     X(05).                       2.0 BYTE
001360*****03  F                   PIC     X(04).                       D.930614
001370     03  F                   PIC     X(13).                       D.930614
001380     03  R6-02               PIC     N(08).                       R.890825
001390*****03  F                   PIC     X(01).                       D.940223
001400*****03  R6-04               PIC     X(01).                       D.940223
001410*****03  F                   PIC     X(02).                       D.940223
001420     03  F                   PIC     X(04).                       I.940223
001430*****03  F                   PIC     X(04).                       D.930607
001440     03  R6-03               PIC       ZZ9.
001450*********************************************
001460**                                          *
001470**        WORKING  STORAGE  SECTION         *
001480**                                          *
001490*********************************************
001500 WORKING-STORAGE     SECTION.
001510 01  ERR-STAT        PIC X(02).                                   FILE ERR
001520 01  JS-SIGN         PIC X(01).                                   I.890825
001530 01  W-JS            PIC X(01).                                   I.930610
001540*01  W-JS-MEI        PIC N(05).                                   D.030718
001550******************************
001560*     WORK         AREA      *
001570******************************
001580 01  WORK-AREA.
001590     03  ENDFLG        PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001600     03  ENDFLG2       PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001610     03  ACT1          PIC     9.                                 TEST
001620     03  ACT2          PIC     9.
001630     03  ACT3          PIC     9(06).                             áÇ
001640     03  ACTK          PIC     9(01).                             ∂∏∆›
001650     03  LCNT          PIC     9(02).                             ◊≤›∂≥›¿∞
001660     03  DSW           PIC     9(01).                             DATAóLñ≥
001670     03  DATE-WORK.
001680         05  YY.
001690             07  YYA   PIC     9.
001700             07  YYB   PIC     9.
001710         05  MM.
001720             07  MMA   PIC     9.
001730             07  MMB   PIC     9.
001740         05  DD.
001750             07  DDA   PIC     9.
001760             07  DDB   PIC     9.
001770     03  JSUX.
001780         05  JSU1      PIC     N(12).
001790         05  JSU2      PIC     N(12).
001800     03  NAMEX.
001810         05  N1        PIC     N(12).
001820         05  N2        PIC     N(12).
001830     03  W-NGP.                                                   I.981026
001840       04  F              PIC 9(02).                              I.981026
001850       04  W-NGPS         PIC 9(06).                              I.981026
001860     03  W-NGPL         REDEFINES  W-NGP.                         I.981026
001870       04  W-NEN          PIC 9(04).                              I.981026
001880       04  W-NENL       REDEFINES  W-NEN.                         I.981026
001890         05  W-NEN1       PIC 9(02).                              I.981026
001900         05  W-NEN2       PIC 9(02).                              I.981026
001910       04  F              PIC 9(04).                              I.981026
001920     03  W-SDATE          PIC 9(08).                              I.981026
001930     03  W-EDATE          PIC 9(08).                              I.981026
001940     03  W-SNGP.                                                  I.981026
001950       04  W-SNEN       PIC 9(04).                                I.981026
001960       04  W-SNENL      REDEFINES  W-SNEN.                        I.981026
001970         05  W-SNEN1      PIC 9(02).                              I.981026
001980         05  W-SNEN2      PIC 9(02).                              I.981026
001990       04  W-SGET         PIC 9(02).                              I.981026
002000       04  W-SPEY         PIC 9(02).                              I.981026
002010     03  W-ENGP.                                                  I.981026
002020       04  W-ENEN       PIC 9(04).                                I.981026
002030       04  W-ENENL      REDEFINES  W-ENEN.                        I.981026
002040         05  W-ENEN1      PIC 9(02).                              I.981026
002050         05  W-ENEN2      PIC 9(02).                              I.981026
002060       04  W-EGET         PIC 9(02).                              I.981026
002070       04  W-EPEY         PIC 9(02).                              I.981026
002080     03  W-POC            PIC 9(01).                              I.030718
002090     03  W-FOC            PIC 9(01).                              I.030718
002100 01  SOM.                                                         ëqÅ@ñº
002110     03  F1        PIC     N(01)     VALUE    NC"Åi".
002120     03  F2        PIC     N(06).
002130     03  F3        PIC     N(01)     VALUE    NC"Åj".
002140     COPY    LWMSG.                                               COPYLIB.
002150*********************************************
002160**                                          *
002170**        SCREEN            SECTION         *
002180**                                          *
002190*********************************************
002200 SCREEN             SECTION.
002210 SD  CRT-X
002220     END  STATUS    IS   ESTAT.
002230 01  DISP-CLEAR.
002240     03  CLE-01     LINE   1     CLEAR  SCREEN.
002250******************************
002260*     DISPLAY      SECTION.  *
002270******************************
002280 01  DISP-AREA1.
002290*****03  DSP-JS   LINE  1  COLUMN   1  PIC  N(05)  FROM  W-JS-MEI.D.030718
002300     03  DSP-RVE  LINE  1  COLUMN  20  PIC  X(12)  VALUE
002310                                           " "  REVERSE.
002320     03  DISP-01  LINE  1  COLUMN  21  PIC  N(05)  VALUE
002330                                         NC"ëóÇËèÛî≠çs".
002340     03  DISP-02  LINE  3  COLUMN  11  PIC  N(05)  VALUE
002350                                     NC"ÉgÉiÉ~â^óA".
002360     03  DISP-03  LINE  6  COLUMN  13  PIC  N(09)  VALUE
002370                                 NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".
002380     03  DISP-04  LINE  6  COLUMN  32  PIC  X(12)  VALUE
002390                                       "(YES=1,NO=2)".
002400     03  DISP-04A LINE  9.                                        I.030718
002410         04  COLUMN  13  PIC  N(03)  VALUE  NC"ã≥Å@àÁ".           I.030718
002420         04  COLUMN  19  PIC  X(05)  VALUE    "=0 , ".            I.030718
002430         04  COLUMN  24  PIC  N(03)  VALUE  NC"ÉèÅ[ÉN".           I.030718
002440         04  COLUMN  30  PIC  X(05)  VALUE    "=1 , ".            I.030718
002450         04  COLUMN  35  PIC  N(05)  VALUE  NC"ÉJÉWÉÖÉAÉã".       I.030718
002460         04  COLUMN  45  PIC  X(05)  VALUE    "=2 , ".            I.030718
002470         04  COLUMN  50  PIC  N(03)  VALUE  NC"Ç`ÇkÇk".           I.030718
002480         04  COLUMN  56  PIC  X(06)  VALUE    "=9    ".           I.030718
002490*****03  DISP-05  LINE  9  COLUMN  13  PIC  N(06)  VALUE          D.030718
002500     03  DISP-05  LINE 11  COLUMN  13  PIC  N(06)  VALUE          I.030718
002510                                       NC"ÇPÅDêVãKî≠çs".
002520*****03  DISP-06  LINE 11  COLUMN  13  PIC  N(05)  VALUE          D.030718
002530     03  DISP-06  LINE 13  COLUMN  13  PIC  N(05)  VALUE          I.030718
002540                                       NC"ÇQÅDçƒî≠çs".
002550*****03  DISP-07  LINE 13  COLUMN  17  PIC  N(02)  VALUE          D.030718
002560     03  DISP-07  LINE 13  COLUMN  30  PIC  N(02)  VALUE          I.030718
002570                                       NC"ëIë".
002580*****03  DISP-08  LINE 13  COLUMN  22  PIC  X(03)  VALUE          D.030718
002590     03  DISP-08  LINE 13  COLUMN  35  PIC  X(03)  VALUE          I.030718
002600                                       "[ ]".
002610     03  DISP-09  LINE 23  COLUMN  41  PIC  N(03)  VALUE
002620                                       NC"ämîFÅi".
002630     03  DISP-10  LINE 23  COLUMN  47  PIC  X(09)  VALUE
002640                                       "OK=1,NO=9".
002650     03  DISP-11  LINE 23  COLUMN  56  PIC  N(01)  VALUE
002660                                       NC"Åj".
002670     03  DISP-12  LINE 23  COLUMN  58  PIC  X(08)  VALUE
002680                                       "--> ÿ¿∞›".
002690 01  DISP-AREA2.
002700     03  DISP-21  LINE 16  COLUMN  15  PIC  X(09)  VALUE
002710                                       "ëóÇËèÛNO:".
002720     03  DISP-DATM.                                               I.981026
002730       04  LINE  15    COLUMN  31    VALUE  NC"ì˙Å@ït".           I.981026
002740       04  LINE  17.                                              I.981026
002750         05  COLUMN  21    VALUE  NC"ÇeÇqÇnÇl".                   I.981026
002760         05  COLUMN  31    VALUE  "  /  /  ".                     I.981026
002770       04  LINE  19.                                              I.981026
002780         05  COLUMN  21    VALUE  NC"ÇsÇn".                       I.981026
002790         05  COLUMN  31    VALUE  "  /  /  ".                     I.981026
002800 01  DISP-AREA3.
002810     03  DISP-22  LINE 24  COLUMN  01  PIC  N(09)  VALUE
002820                                       NC"äYìñÉfÅ[É^ñ≥".
002830******************************
002840*     ACCEPT       SECTION.  *
002850******************************
002860 01  ACT-AREA.
002870     03  ACT-01  LINE    6 COLUMN  46  PIC  9
002880                 INTO      ACT1      CHECK  OVERFLOW  NO IFC.
002890     03  ACT-JS  LINE    9 COLUMN  61  PIC  9                     I.030718
002900                 INTO      W-JS      CHECK  OVERFLOW  NO IFC.     I.030718
002910*****03  ACT-02  LINE   13 COLUMN  23  PIC  9                     D.030718
002920     03  ACT-02  LINE   13 COLUMN  36  PIC  9                     I.030718
002930                 INTO      ACT2      CHECK  OVERFLOW  NO IFC.
002940     03  ACT-03  LINE   16 COLUMN  24  PIC  9(06)
002950                 INTO      ACT3      CHECK  OVERFLOW  NO IFC.
002960     03  ACP-SNGP  LINE  17.                                      I.981026
002970       04  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981026
002980             USING  W-SNEN2  NO  IFC.                             I.981026
002990       04  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981026
003000             USING  W-SGET   NO  IFC.                             I.981026
003010       04  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981026
003020             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.            I.981026
003030     03  ACP-ENGP  LINE  19.                                      I.981026
003040       04  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981026
003050             USING  W-ENEN2  NO  IFC.                             I.981026
003060       04  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981026
003070             USING  W-EGET   NO  IFC.                             I.981026
003080       04  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981026
003090             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.            I.981026
003100     03  ACT-04  LINE   23 COLUMN  61  PIC  9(01)
003110                 INTO      ACTK      CHECK  OVERFLOW  NO IFC.
003120*
003130******************************
003140*     CLEAR        SECTION.  *
003150******************************
003160 01  CLR-AREA.
003170     03  CLR-01  LINE    6 COLUMN  46  PIC  X     VALUE   " ".
003180     03  CLR-JS  LINE    9 COLUMN  61  PIC  X     VALUE   " ".    I.030718
003190*****03  CLR-02  LINE   13 COLUMN  23  PIC  X     VALUE   " ".    D.030718
003200     03  CLR-02  LINE   13 COLUMN  36  PIC  X     VALUE   " ".    I.030718
003210     03  CLR-03  LINE   16 COLUMN  24  PIC  X(06) VALUE   " ".
003220     03  CLR-04  LINE   23 COLUMN  61  PIC  X     VALUE   " ".
003230     03  CLR-05  LINE   16 COLUMN  15  PIC  X(15) VALUE   " ".
003240     03  CLR-DATM.                                                I.981026
003250       04  LINE  15    COLUMN  31    PIC X(06)    VALUE  " ".     I.981026
003260       04  LINE  17.                                              I.981026
003270         05  COLUMN  21    PIC X(08)    VALUE  " ".               I.981026
003280         05  COLUMN  31    PIC X(08)    VALUE  " ".               I.981026
003290       04  LINE  19.                                              I.981026
003300         05  COLUMN  21    PIC X(04)    VALUE  " ".               I.981026
003310         05  COLUMN  31    PIC X(08)    VALUE  " ".               I.981026
003320*
003330*01  DSP-GDMM.                                                    D.011018
003340*****02  LINE  24  COLUMN   1  VALUE                              D.011018
003350*****    NC"ÅñÅñÉ_É~Å[ÇeÅ@Ç»Çµ".                                  D.011018
003360     COPY  LSMSG.                                                 COPYLIB.
003370     COPY  LIBSCR.                                                I.981027
003380**
003390*********************************************
003400**                                          *
003410**        PROCEDURE        DIVISION         *
003420**                                          *
003430*********************************************
003440 PROCEDURE           DIVISION.
003450 MAIN-LOGIC.
003460     PERFORM   INITIAL-RTN  THRU  INITIAL-EXT.                    START
003470               PERFORM      MAIN-RTN  THRU  MAIN-EXT              PROCES
003480                            UNTIL     ENDFLG = "END".
003490                       PERFORM     END-RTN THRU    END-EX.        END
003500     STOP     RUN.
003510*********************************************
003520**                                          *
003530**        INITIAL            ROUTIN         *
003540**                                          *
003550*********************************************
003560 INITIAL-RTN.
003570     ACCEPT  JS-SIGN.                                             I.890825
003580*****ACCEPT  W-JS.                                                D.030718
003590*****IF  W-JS  =  ZERO                                            D.030718
003600*****    MOVE  NC"Åkã≥Å@àÁÅl"    TO  W-JS-MEI.                    D.030718
003610*****IF  W-JS  =  1                                               D.030718
003620*****    MOVE  NC"ÅkÉèÅ[ÉNÅl"    TO  W-JS-MEI.                    D.030718
003630*****IF  W-JS  =  2                                               D.030718
003640*****    MOVE  NC"ÅkÉJÉWÉÖÅl"    TO  W-JS-MEI.                    D.030718
003650*****    MOVE  NC"ÅkàÍÅ@î Ål"    TO  W-JS-MEI.                    D.030707
003660*
003670     MOVE    SPACE      TO    WORK-AREA.
003680     INITIALIZE               WORK-AREA.
003690*
003700     DISPLAY  DISP-CLEAR.
003710     DISPLAY  DISP-AREA1.
003720     COPY  LIBCPR.                                                I.981028
003730*****PERFORM  SEL-RTN  THRU  SEL-EX.                              D.030718
003740*****IF  JS-SIGN      =  4                                        D.011018
003750*****    OPEN  I-O      GDMM                                      D.011018
003760*****    MOVE  "0"      TO  GDMM-KEY                              D.011018
003770*****    READ  GDMM     INVALID  KEY                              D.011018
003780*****          CLOSE    GDMM                                      D.011018
003790*****          DISPLAY  DSP-GDMM   DISP-BUZ-B                     D.011018
003800*****          STOP  RUN.                                         D.011018
003810*****OPEN     INPUT   TC-M  JCON.                                 D.030718
003820*****OPEN     I-O     OKJF.                                       D.030718
003830*****OPEN    OUTPUT   P-F.                                        D.030718
003840 INITIAL-EXT.
003850     EXIT.
003860*********************************************
003870**                                          *
003880**        MAIN               ROUTIN         *
003890**                                          *
003900*********************************************
003910 MAIN-RTN.
003920 MAIN-10.                                                         TESTàÛéö
003930     ACCEPT    ACT-01.
003940     DISPLAY   DISP-MSG-SPACE.
003950              IF  ESTAT   =   "P9"                                PF9
003960                               MOVE  "END"  TO  ENDFLG
003970                               GO     TO        MAIN-EXT.
003980              IF  ESTAT   =   "01"  OR  "06"
003990                               NEXT   SENTENCE
004000                  ELSE
004010                               GO     TO  MAIN-10.
004020              IF  ACT1  NOT =   1  AND 2
004030                               GO     TO  MAIN-10.
004040              IF  ACT1      =   1
004050                        PERFORM    TEST-RTN    THRU    TEST-EXT
004060                        GO   TO    MAIN-10.
004070 MAIN-15.                                                         I.030718
004080     ACCEPT    ACT-JS.                                            I.030718
004090     DISPLAY   DISP-MSG-SPACE.                                    I.030718
004100     IF  ESTAT   =   "09"                                         I.030718
004110                     GO     TO  MAIN-10.                          I.030718
004120     IF  ESTAT   =   "01"  OR  "06"                               I.030718
004130                     NEXT   SENTENCE                              I.030718
004140         ELSE                                                     I.030718
004150                     GO     TO  MAIN-15.                          I.030718
004160     IF  W-JS  NOT =   0  AND  1  AND 2  AND  9                   I.030718
004170                     GO     TO  MAIN-15.                          I.030718
004180 MAIN-20.                                                         î≠çsëIë
004190     ACCEPT    ACT-02.
004200     DISPLAY   DISP-MSG-SPACE.
004210              IF  ESTAT   =   "09"
004220                               GO     TO  MAIN-15.                I.030718
004230*****                          GO     TO  MAIN-10.                D.030718
004240              IF  ESTAT   =   "01"  OR  "06"
004250                               NEXT   SENTENCE
004260                  ELSE
004270                               GO     TO  MAIN-20.
004280              IF  ACT2  NOT =   1  AND 2
004290                               GO     TO  MAIN-20.
004300     IF  ACT2 = 2                                                 I.981026
004310         DISPLAY  CLR-DATM                                        I.981026
004320         GO  TO  MAIN-30.                                         I.981026
004330     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.030718
004340     DISPLAY  CLR-05  DISP-DATM  ACP-SNGP  ACP-ENGP.              I.981026
004350     IF  W-SNGP = ZERO                                            I.981026
004360         DISPLAY  DISP-22                                         I.981026
004370         GO  TO  MAIN-20.                                         I.981026
004380     GO  TO  MAIN-40.                                             I.981026
004390*****IF  ACT2 = 1                                                 D.981026
004400*****    DISPLAY  CLR-05                                          D.981026
004410*****    GO  TO  MAIN-40.                                         D.981026
004420 MAIN-30.                                                         áÇ
004430*****DISPLAY  DISP-AREA2.                                         D.981026
004440     DISPLAY  DISP-21.                                            I.981026
004450     ACCEPT   ACT-03.
004460     DISPLAY   DISP-MSG-SPACE.
004470     IF  ESTAT = "P9"                                             PF9
004480         MOVE  "END"  TO  ENDFLG
004490         GO  TO  MAIN-EXT.
004500     IF  ESTAT = "09"
004510         GO  TO  MAIN-20.
004520     IF  ESTAT = "01"  OR  "06"
004530*****    NEXT  SENTENCE                                           D.981026
004540         GO  TO  MAIN-40                                          I.981026
004550       ELSE
004560         GO  TO  MAIN-30.
004570 MAIN-32.                                                         I.981026
004580     ACCEPT  ACP-SNEN.                                            I.981026
004590     IF  ESTAT = "09"                                             I.981026
004600         GO  TO  MAIN-20.                                         I.981026
004610     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
004620         GO  TO  MAIN-32.                                         I.981026
004630     MOVE  ZERO  TO  W-SNEN1.                                     I.981026
004640     IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
004650         ADD  DATE-NC1  TO  W-SNEN.                               I.981027
004660     IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
004670         ADD  DATE-NC2  TO  W-SNEN.                               I.981027
004680*****IF  W-SNEN2 > 90                                             D.981027
004690*****    ADD  1900  TO  W-SNEN                                    D.981027
004700*****  ELSE                                                       D.981027
004710*****    ADD  2000  TO  W-SNEN.                                   D.981027
004720 MAIN-33.                                                         I.981026
004730     ACCEPT  ACP-SGET.                                            I.981026
004740     IF  ESTAT = "09"                                             I.981026
004750         GO  TO  MAIN-32.                                         I.981026
004760     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
004770         GO  TO  MAIN-33.                                         I.981026
004780     IF  W-SGET < 1  OR  > 12                                     I.981026
004790         GO  TO  MAIN-33.                                         I.981026
004800 MAIN-34.                                                         I.981026
004810     ACCEPT  ACP-SPEY.                                            I.981026
004820     IF  ESTAT = "09"                                             I.981026
004830         GO  TO  MAIN-33.                                         I.981026
004840     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
004850         GO  TO  MAIN-34.                                         I.981026
004860     IF  W-SGET < 1  OR  > 31                                     I.981026
004870         GO  TO  MAIN-34.                                         I.981026
004880     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981026
004890         GO  TO  MAIN-32.                                         I.981026
004900 MAIN-36.                                                         I.981026
004910     ACCEPT  ACP-ENEN.                                            I.981026
004920     IF  ESTAT = "09"                                             I.981026
004930         GO  TO  MAIN-34.                                         I.981026
004940     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
004950         GO  TO  MAIN-36.                                         I.981026
004960     MOVE  ZERO  TO  W-ENEN1.                                     I.981026
004970     IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1                    I.981027
004980         ADD  DATE-NC1  TO  W-ENEN.                               I.981027
004990     IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2                    I.981027
005000         ADD  DATE-NC2  TO  W-ENEN.                               I.981027
005010*****IF  W-ENEN2 > 90                                             D.981027
005020*****    ADD  1900  TO  W-ENEN                                    D.981027
005030*****  ELSE                                                       D.981027
005040*****    ADD  2000  TO  W-ENEN.                                   D.981027
005050 MAIN-37.                                                         I.981026
005060     ACCEPT  ACP-EGET.                                            I.981026
005070     IF  ESTAT = "09"                                             I.981026
005080         GO  TO  MAIN-36.                                         I.981026
005090     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
005100         GO  TO  MAIN-37.                                         I.981026
005110     IF  W-EGET < 1  OR  > 12                                     I.981026
005120         GO  TO  MAIN-37.                                         I.981026
005130 MAIN-38.                                                         I.981026
005140     ACCEPT  ACP-EPEY.                                            I.981026
005150     IF  ESTAT = "09"                                             I.981026
005160         GO  TO  MAIN-37.                                         I.981026
005170     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"                   I.981026
005180         GO  TO  MAIN-38.                                         I.981026
005190     IF  W-SGET < 1  OR  > 31                                     I.981026
005200         GO  TO  MAIN-38.                                         I.981026
005210     IF  W-SNGP > W-ENGP                                          I.981026
005220         GO  TO  MAIN-36.                                         I.981026
005230     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981026
005240         GO  TO  MAIN-36.                                         I.981026
005250 MAIN-40.                                                         ämÅ@îF
005260     ACCEPT    ACT-04.
005270     DISPLAY   DISP-MSG-SPACE.
005280              IF  ESTAT   =   "09"
005290                  IF  ACT2    =   1
005300*****                          GO     TO  MAIN-20                 D.981026
005310                               GO     TO  MAIN-32                 I.981026
005320                      ELSE
005330                               GO     TO  MAIN-30.
005340              IF  ESTAT   =   "01"  OR  "06"
005350                               NEXT   SENTENCE
005360                  ELSE
005370                               GO     TO  MAIN-40.
005380              IF  ACTK  NOT =   1  AND 9
005390                               GO     TO  MAIN-40.
005400*
005410              IF  ACTK      =   1
005420                        MOVE       ZERO         TO     DSW
005430                        PERFORM    PRINT-RTN    THRU   PRINT-EXT
005440                  ELSE
005450                        DISPLAY    CLR-05
005460                        DISPLAY    CLR-01
005470                        DISPLAY    CLR-02
005480                        DISPLAY    CLR-04
005490                        GO   TO    MAIN-10.
005500*****         IF  ACT2      =   1                                 D.960326
005510*****                   GO   TO    MAIN-20                        D.960326
005520*****             ELSE                                            D.960326
005530              IF  ACT2      =   2                                 I.960326
005540                        GO   TO    MAIN-30.
005550              IF  DSW       =   0                                 I.960326
005560                        GO   TO    MAIN-20.                       I.960326
005570              MOVE  "END"  TO  ENDFLG.                            I.960326
005580 MAIN-EXT.
005590     EXIT.
005600*********************************************
005610**                                          *
005620**        FAINAL             ROUTIN         *
005630**                                          *
005640*********************************************
005650 END-RTN.
005660*****CLOSE     OKJF.                                              D.030718
005670*****CLOSE     TC-M.                                              D.030718
005680     IF  W-FOC      =  1                                          I.030718
005690         CLOSE     OKJF                                           I.030718
005700         CLOSE     TC-M                                           I.030718
005710         CLOSE     JCON.
005720     IF  W-POC      =  1                                          I.030718
005730         CLOSE     P-F.
005740*****IF  JS-SIGN      =  4              CLOSE  GDMM.              D.011018
005750 END-EX.
005760     EXIT.
005770*********************************************
005780**                                          *
005790**        SUB    ROUTIN     SECTION         *
005800**                                          *
005810*********************************************
005820*
005830******************************
005840*     TEST         ROUTIN    *
005850******************************
005860 TEST-RTN.
005870     IF  W-POC     =   0                                          I.030718
005880         MOVE  1        TO  W-POC                                 I.030718
005890         OPEN  OUTPUT   P-F.                                      I.030718
005900     IF     LCNT  =  23
005910                  MOVE       ZERO     TO        LCNT
005920                  MOVE       SPACE    TO        P-R
005930                  WRITE      P-R      AFTER     PAGE.
005940     MOVE       SPACE    TO        P-R.                           I.930615
005950     MOVE        ""3FE04FE080""  TO               CODEK1.         2.0BYTE
005960     MOVE       9        TO  R1-01A R1-02A R1-03A.
005970     MOVE       9        TO  R1-01B R1-02B R1-03B.
005980*****WRITE      P-R      AFTER     4.                             D.940615
005990     WRITE      P-R      AFTER     3.                             I.940615
006000     MOVE       SPACE    TO        P-R.
006010*
006020     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
006030     MOVE      NC"ínâ∫"  TO        R2-02.
006040     MOVE      NC"ÉPÅ[ÉX"   TO     R2-03.
006050*****WRITE      P-R      AFTER     5.                             D.930614
006060     WRITE      P-R      AFTER     2.                             I.930614
006070     MOVE       SPACE    TO        P-R.
006080*
006090     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
006100     MOVE  ALL NC"Çm"    TO        R2-01.
006110     MOVE      NC"ïzåC"  TO        R2-02.                         C63.10.6
006120     MOVE      NC"éÜÅ@ïÔ"   TO     R2-03.
006130     WRITE      P-R      AFTER     1.
006140     MOVE       SPACE    TO        P-R.
006150*
006160     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
006170     MOVE      NC"í∑åC"  TO        R2-02.
006180     MOVE      NC"ñÿÅ@î†"   TO     R2-03.
006190     WRITE      P-R      AFTER     1.
006200     MOVE       SPACE    TO        P-R.
006210*
006220     MOVE        ""3FE04FE080""  TO               CODEK3.         2.0BYTE
006230     MOVE  ALL NC"Çm"    TO        F2.
006240     MOVE       SOM      TO        R3-01.
006250     MOVE      NC"ë¥ëº"  TO        R3-02.
006260     WRITE      P-R      AFTER     1.
006270     MOVE       SPACE    TO        P-R.
006280*
006290     MOVE  ALL  "9"      TO        R5-03.                         I.890825
006300*****WRITE      P-R      AFTER     3.                             D.930614
006310     WRITE      P-R      AFTER     2.                             D.930614
006320     MOVE       SPACE    TO        P-R.                           I.890825
006330*
006340     MOVE        ""3FE04F40A0""  TO              CODEK4.          1.5BYTE
006350     MOVE  ALL NC"Çm"    TO        R4-01.
006360*****WRITE      P-R      AFTER     2.                             D.930614
006370     WRITE      P-R      AFTER     3.                             I.930614
006380     MOVE       SPACE    TO        P-R.
006390*
006400     MOVE        ""3FE04F40A0""  TO              CODEK4.          1.5BYTE
006410     MOVE  ALL NC"Çm"    TO        R4-01  R4-02.                  R.900414
006420*****MOVE      NC"â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇU"  TO  R4-02.           D.900416
006430     WRITE      P-R      AFTER     1.
006440     MOVE       SPACE    TO        P-R.
006450*
006460     MOVE        ""3FE04F40A0""  TO              CODEK4.          I.940218
006470     MOVE  ALL NC"Çm"    TO        R4-01.                         I.940218
006480     WRITE      P-R      AFTER     1.                             I.940218
006490     MOVE       SPACE    TO        P-R.                           I.940218
006500*
006510     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
006520*****MOVE  ALL NC"Çm"    TO        R5-01.                         D.940218
006530*****MOVE  "0862-52-2456"  TO      R5-02.                         D.900416
006540*****MOVE  "9999-99-9999"  TO      R5-02.                         D.930623
006550     MOVE  ALL  "X"      TO        R5-01  R5-02.                  C.940218
006560*****MOVE  ALL  "9"      TO        R5-03.                         D.890825
006570*****WRITE      P-R      AFTER     2.                             D.940218
006580     WRITE      P-R      AFTER     1.                             I.940218
006590     MOVE       SPACE    TO        P-R.
006600*
006610     MOVE        ""3FE04F40A0""  TO              CODEK6A.         1.5BYTE
006620     MOVE  ALL NC"Çm"    TO        R6-01.
006630*****WRITE      P-R      AFTER     2.                             D.930614
006640     WRITE      P-R      AFTER     4.                             I.930614
006650     MOVE       SPACE    TO        P-R.
006660*
006670     MOVE        ""3FE04F40A0""  TO              CODEK6A.         1.5BYTE
006680     MOVE        ""3FE04FE080""  TO              CODEK6B.         2.0BYTE
006690     MOVE  ALL NC"Çm"    TO        R6-01  R6-02.                  R.900414
006700*****MOVE      NC"ì˙êiÉSÉÄäîéÆâÔé–"  TO  R6-02.                   D.900414
006710     MOVE        "999"   TO        R6-03.
006720     WRITE      P-R      AFTER     1.
006730     MOVE       SPACE    TO        P-R.
006740*
006750     MOVE       23       TO        LCNT.
006760 TEST-EXT.
006770     EXIT.
006780*********************************************
006790**                                          *
006800**        PRINT              ROUTIN         *
006810**                                          *
006820*********************************************
006830 PRINT-RTN.
006840     IF  W-POC     =   0                                          I.030718
006850         MOVE  1        TO  W-POC                                 I.030718
006860     IF  W-FOC     =   0                                          I.030718
006870         MOVE  1        TO  W-FOC                                 I.030718
006880         OPEN  INPUT    TC-M  JCON                                I.030718
006890         OPEN  I-O      OKJF.                                     I.030718
006900     IF     LCNT  =  23
006910                  MOVE       ZERO     TO        LCNT
006920                  MOVE       SPACE    TO        P-R
006930                  WRITE      P-R      AFTER     PAGE.
006940*********  ñæ  ç◊  ïî  ********
006950     IF  ACT2      =   1                                          êVãKî≠çs
006960                   NEXT  SENTENCE
006970         ELSE
006980                   GO   TO    PRT-20.                             çƒî≠çs
006990 PRT-10.                                                          ëóÇËèÛÇe
007000     IF      ENDFLG2  =  "END"   GO   TO  PRT-15.
007010     READ    OKJF  NEXT          AT  END
007020                                 MOVE      "END"  TO  ENDFLG2
007030                                 GO  TO    PRT-15.
007040*****IF      W-JS  =  ZERO                                        D.030707
007050*****    IF      OKJF-09  NOT =  ZERO                             D.030707
007060*****                 GO   TO  PRT-10.                            D.030707
007070*****IF      W-JS  =  1                                           D.030707
007080*****    IF      OKJF-09  NOT =  1                                D.030707
007090     IF      W-JS     NOT =  9                                    I.030718
007100             IF      OKJF-09  NOT =  W-JS                         I.030707
007110                     GO   TO  PRT-10.                             I.930610
007120     IF      OKJF-08  =  1                                        àÛéöª≤›
007130                      GO   TO  PRT-10.
007140     IF      OKJF-02  NOT = 4                                     â^ëóã∆CD
007150                      GO   TO  PRT-10.
007160     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
007170                         NEXT   SENTENCE
007180             ELSE
007190                         GO  TO  PRT-10.
007200     IF      JS-SIGN  =  0                                        I.890825
007210*****        IF  OKJF-04    =    2 OR 3 OR 5 OR 6 OR 7            D.051216
007220             IF  OKJF-04    =    2 OR 3 OR 4 OR 5 OR 6 OR 7       I.051216
007230                                               GO  TO  PRT-10.    I.980116
007240*****        IF  OKJF-04    =    2 OR 3 OR 6   GO  TO  PRT-10.    D.920428
007250*****   IF  OKJF-04    =    2 OR 3 OR 5 OR 6   GO  TO  PRT-10.    D.980116
007260     IF      JS-SIGN  =  1                                        I.890825
007270             IF   OKJF-04    NOT =   2  AND  3 GO  TO  PRT-10.    I.890825
007280     IF      JS-SIGN  =  2                                        I.900410
007290             IF   OKJF-04    NOT =   5  AND  6 GO  TO  PRT-10.    I.920428
007300*****        IF   OKJF-04    NOT =   6         GO  TO  PRT-10.    D.920428
007310     IF      JS-SIGN  =  3                                        I.950203
007320             IF   OKJF-04    NOT =   2  AND  3  AND  5  AND  6    I.950203
007330                                               GO  TO  PRT-10.    I.950203
007340     IF      JS-SIGN  =  4                                        I.980116
007350             IF   OKJF-04    NOT =   7         GO  TO  PRT-10.    I.980116
007360     MOVE  ZERO     TO  W-NGP.                                    I.981026
007370     MOVE  OKJF-03  TO  W-NGPS.                                   I.981026
007380     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     I.981028
007390         ADD  DATE-NC1  TO  W-NEN.                                I.981028
007400     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     I.981028
007410         ADD  DATE-NC2  TO  W-NEN.                                I.981028
007420*****IF  W-NEN2 > 90                                              D.981028
007430*****    ADD  1900  TO  W-NEN                                     D.981028
007440*****  ELSE                                                       D.981028
007450*****    ADD  2000  TO  W-NEN.                                    D.981028
007460     IF  W-NGP < W-SNGP  OR  > W-ENGP                             I.981026
007470         GO  TO  PRT-10.                                          I.981026
007480     GO      TO   PRT-30.
007490 PRT-15.
007500     IF      DSW  =  ZERO
007510                         DISPLAY    DISP-AREA3
007520                         GO   TO    PRINT-EXT
007530             ELSE
007540                         GO   TO    PRINT-EXT.
007550 PRT-20.
007560     MOVE    ACT3     TO  OKJF-01.
007570     READ    OKJF                   INVALID
007580                         DISPLAY    DISP-AREA3
007590                         GO   TO    PRINT-EXT.
007600     IF      OKJF-02  NOT = 4                                     â^ëóã∆CD
007610                         DISPLAY    DISP-AREA3
007620                         GO   TO    PRINT-EXT.
007630     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
007640                         NEXT   SENTENCE
007650             ELSE
007660                         DISPLAY    DISP-AREA3
007670                         GO   TO    PRINT-EXT.
007680*****IF      W-JS  =  ZERO                                        D.030707
007690*****    IF      OKJF-09  NOT =  ZERO                             D.030707
007700*****                    DISPLAY    DISP-AREA3                    D.030707
007710*****                    GO   TO    PRINT-EXT.                    D.030707
007720*****IF      W-JS  =  1                                           D.030707
007730*****    IF      OKJF-09  NOT =  1                                D.030707
007740     IF      W-JS     NOT =  9                                    I.030718
007750             IF      OKJF-09  NOT =  W-JS                         I.030707
007760                     DISPLAY    DISP-AREA3                        I.930610
007770                     GO   TO    PRINT-EXT.                        I.930610
007780     IF      JS-SIGN  =  0                                        I.890825
007790*****        IF       OKJF-04    =     2   OR  3  OR  6           D.920428
007800*****        IF       OKJF-04    =     2   OR  3  OR  5  OR  6    D.980116
007810*****        IF       OKJF-04    =  2  OR  3  OR  5  OR  6  OR  7 D.051216
007820             IF       OKJF-04    =  2 OR 3 OR 4 OR 5 OR 6 OR 7    I.980116
007830                         DISPLAY    DISP-AREA3                    I.890825
007840                         GO   TO    PRINT-EXT.                    I.890825
007850     IF      JS-SIGN  =  1                                        I.890825
007860             IF       OKJF-04    NOT =   2  AND  3                I.890825
007870                         DISPLAY    DISP-AREA3                    I.890825
007880                         GO   TO    PRINT-EXT.                    I.890825
007890     IF      JS-SIGN  =  2                                        I.900410
007900*****        IF       OKJF-04    NOT =   6                        D.920428
007910             IF       OKJF-04    NOT =   5  AND  6                I.920428
007920                         DISPLAY    DISP-AREA3                    I.900410
007930                         GO   TO    PRINT-EXT.                    I.900410
007940     IF      JS-SIGN  =  3                                        I.950203
007950             IF       OKJF-04    NOT =  2  AND  3  AND  5  AND  6 I.950203
007960                         DISPLAY    DISP-AREA3                    I.950203
007970                         GO   TO    PRINT-EXT.                    I.950203
007980     IF      JS-SIGN  =  4                                        I.980116
007990             IF       OKJF-04    NOT =  7                         I.980116
008000                         DISPLAY    DISP-AREA3                    I.980116
008010                         GO   TO    PRINT-EXT.                    I.980116
008020 PRT-30.                                                          íºëóêÊÇl
008030     MOVE    OKJF-05  TO  TC-KEY.
008040     READ    TC-M        UNLOCK     INVALID
008050                         MOVE       SPACE  TO  TC-R
008060                         INITIALIZE            TC-R.
008070 PRT-40.                                                          ÇbÇmÇsÇe
008080     MOVE    3        TO  JCON3-01.
008090     MOVE    OKJF-04  TO  JCON3-02.
008100     READ    JCON        UNLOCK     INVALID
008110                         MOVE       SPACE  TO  JCON3-R
008120                         INITIALIZE            JCON3-R.
008130     MOVE       1        TO  DSW.                                 DATAóLñ≥
008140 PRT-50.
008150*
008160*
008170     MOVE       SPACE    TO        P-R.                           I.930615
008180     MOVE        ""3FE04FE080""  TO               CODEK1.         2.0BYTE
008190*****IF    ACT2          =   2     MOVE  "#"      TO   R1-C.      D.950202
008200     MOVE       OKJF-03  TO  DATE-WORK.
008210*****IF         YYA   NOT =  ZERO                                 D.000107
008220     MOVE       YYA      TO  R1-01A.
008230     MOVE       YYB      TO  R1-01B.
008240     IF         MMA   NOT =  ZERO
008250                MOVE       MMA      TO  R1-02A.
008260     MOVE       MMB      TO  R1-02B.
008270     IF         DDA   NOT =  ZERO
008280                MOVE       DDA      TO  R1-03A.
008290     MOVE       DDB      TO  R1-03B.
008300*****WRITE      P-R      AFTER     4.                             D.940615
008310     WRITE      P-R      AFTER     3.                             I.940615
008320     MOVE       SPACE    TO        P-R.
008330*
008340     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
008350     MOVE      NC"ínâ∫"  TO        R2-02.
008360     MOVE      NC"ÉPÅ[ÉX"   TO     R2-03.
008370*****WRITE      P-R      AFTER     5.                             D.930614
008380     WRITE      P-R      AFTER     2.                             I.930614
008390     MOVE       SPACE    TO        P-R.
008400*
008410     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
008420     MOVE  OKJF-06       TO        R2-01.
008430     MOVE      NC"ïzåC"  TO        R2-02.
008440     MOVE      NC"éÜÅ@ïÔ"   TO     R2-03.
008450     WRITE      P-R      AFTER     1.
008460     MOVE       SPACE    TO        P-R.
008470*
008480     MOVE        ""3FE04FE080""  TO               CODEK2.         2.0BYTE
008490     MOVE      NC"í∑åC"  TO        R2-02.
008500     MOVE      NC"ñÿÅ@î†"   TO     R2-03.
008510     WRITE      P-R      AFTER     1.
008520     MOVE       SPACE    TO        P-R.
008530*
008540     MOVE        ""3FE04FE080""  TO               CODEK3.         2.0BYTE
008550     MOVE       JCON3-03 TO        F2.
008560     MOVE       SOM      TO        R3-01.
008570     MOVE      NC"ë¥ëº"  TO        R3-02.
008580     WRITE      P-R      AFTER     1.
008590     MOVE       SPACE    TO        P-R.
008600*
008610     MOVE       OKJF-01    TO      R5-03.                         I.890825
008620     IF    ACT2          =   2     MOVE  NC"çƒ"     TO   R3-05.   I.950202
008630*****WRITE      P-R      AFTER     3.                             D.930614
008640     WRITE      P-R      AFTER     2.                             I.930614
008650     MOVE       SPACE    TO        P-R.                           I.890825
008660*
008670     MOVE        ""3FE04F40A0""  TO              CODEK4.          1.5BYTE
008680     MOVE       TC-JSU   TO        JSUX.
008690     MOVE       JSU1     TO        R4-01.
008700     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)           I.900414
008710           OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     I.900414
008720*****          MOVE   NC"ï∫å…åßêºã{ésÅ@Å@Å@Å@Å@Å@"  TO  R4-02     D.940809
008730               MOVE   NC"ï∫å…åßêºã{ésÅ@Å@Å@Å@Å@Å@"  TO  R4-02     I.940809
008740     ELSE                                                         I.900416
008750          IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)      I.010306
008760               MOVE   NC"ìåãûìsíÜñÏãÊä€éRÅ@Å@Å@Å@"  TO  R4-02     I.010306
008770          ELSE                                                    I.010306
008780               MOVE   NC"â™éRésç°ÇWíöñ⁄ÇPÇUÅ|ÇPÇV"  TO  R4-02.    I.051202
008790*****          MOVE   NC"â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇU"  TO  R4-02.    D.051202
008800*****WRITE      P-R      AFTER     2.                             D.930614
008810     WRITE      P-R      AFTER     3.                             I.930614
008820     MOVE       SPACE    TO        P-R.
008830*
008840     MOVE        ""3FE04F40A0""  TO              CODEK4.          1.5BYTE
008850     MOVE       JSU2     TO        R4-01.
008860     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)           I.900414
008870           OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     I.900414
008880               MOVE  NC"Å@Å@Å@Å@çÇñÿìåí¨ÇPÇTÅ|ÇP"  TO  R4-02      I.010306
008890     ELSE                                                         I.010306
008900               IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999) I.010306
008910                    MOVE  NC"Å@Å@Å@Å@Å@Å@ÇQÅ|ÇTÅ|ÇPÇX"  TO  R4-02.I.010306
008920*****          MOVE  NC"Å@Å@Å@Å@çÇñÿìåí¨ÇPÇTÅ|ÇP"  TO  R4-02.     D.010306
008930*****          MOVE  NC"Å@Å@îÛÉmå˚í¨ÇPÅ|ÇPÇQÅ|ÇQ"  TO  R4-02.     D.940809
008940     WRITE      P-R      AFTER     1.
008950     MOVE       SPACE    TO        P-R.
008960*
008970     MOVE        ""3FE04F40A0""  TO              CODEK4.          I.940218
008980     MOVE  TC-JSS        TO        R4-01.                         I.940218
008990     WRITE      P-R      AFTER     1.                             I.940218
009000     MOVE       SPACE    TO        P-R.                           I.940218
009010*
009020     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
009030*****MOVE  TC-JSS        TO        R5-01.                         D.940218
009040     MOVE  TC-TEL        TO        R5-01.                         I.940218
009050     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)           I.900414
009060*****      OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     D.940809
009070*****           MOVE  "0798-64-5111"  TO      R5-02               D.970129
009080                MOVE  "0798-64-5111  " TO      R5-02              I.970129
009090     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     I.940809
009100                MOVE  "0798-67-0810"  TO      R5-02               I.940809
009110     ELSE  IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)     I.010306
009120                MOVE  "03-5373-6711"  TO      R5-02               I.010306
009130     ELSE                                                         I.900416
009140                MOVE  "086-243-2456  " TO      R5-02.             I.051202
009150*****           MOVE  "086-252-2456  " TO      R5-02.             D.051202
009160*****           MOVE  "0862-52-2456"  TO      R5-02.              D.930623
009170*****           MOVE  "086-252-2456"  TO      R5-02.              D.970129
009180*****MOVE       OKJF-01    TO      R5-03.                         D.890825
009190*****WRITE      P-R      AFTER     2.                             D.940218
009200     WRITE      P-R      AFTER     1.                             I.940218
009210     MOVE       SPACE    TO        P-R.
009220*
009230     MOVE        ""3FE04F40A0""  TO              CODEK6A.         1.5BYTE
009240     MOVE       TC-NAME  TO        NAMEX.
009250     MOVE       N1       TO        R6-01.
009260*****WRITE      P-R      AFTER     2.                             D.930614
009270     WRITE      P-R      AFTER     4.                             I.930614
009280     MOVE       SPACE    TO        P-R.
009290*
009300     MOVE        ""3FE04F40A0""  TO              CODEK6A.         1.5BYTE
009310     MOVE        ""3FE04FE080""  TO              CODEK6B.         2.0BYTE
009320     MOVE       N2       TO        R6-01.
009330     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)           I.900414
009340          MOVE      NC"äîéÆâÔé–è„éRõâã∆"  TO  R6-02               I.010306
009350*****     MOVE      NC"áäè„éRõâã∆Å@Å@Å@"  TO  R6-02               D.010306
009360     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)     I.900414
009370                MOVE      NC"äîéÆâÔé–ÉEÉGÉÑÉ}"  TO  R6-02         I.010306
009380     ELSE  IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)     I.010306
009390                MOVE      NC"ëΩî‰ó«äîéÆâÔé–Å@"  TO  R6-02         I.010306
009400*****           MOVE      NC"áäÉEÉGÉÑÉ}Å@Å@Å@"  TO  R6-02         D.010306
009410           ELSE MOVE      NC"ì˙êiÉSÉÄäîéÆâÔé–"  TO  R6-02.        R.900416
009420*****IF    ACT2          =   2     MOVE  "#"      TO   R6-04.     D.940223
009430     MOVE       OKJF-07  TO        R6-03.
009440     WRITE      P-R      AFTER     1.
009450     MOVE       SPACE    TO        P-R.
009460*
009470     MOVE       23       TO        LCNT.
009480*
009490*
009500 PRT-60.
009510     MOVE          1     TO        OKJF-08.
009520     REWRITE  OKJF-R  INVALID
009530              MOVE    "OKJF"     TO    ERR-F
009540              MOVE    "R"        TO    ERR-M
009550              MOVE     OKJF-KEY  TO    ERR-K
009560              PERFORM  ERR-RTN   THRU  ERR-EX.
009570     IF       ACT2  =  1         GO    TO    PRINT-RTN.
009580 PRINT-EXT.
009590     EXIT.
009600 SEL-RTN.                                                         I.981026
009610     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981026
009620     IF  W-FOC     =   1                                          I.030718
009630         CLOSE  OKJF.                                             I.030718
009640     OPEN  INPUT  OKJF.                                           I.981026
009650 SEL-010.                                                         I.981026
009660     READ  OKJF  NEXT  RECORD  AT  END                            I.981026
009670         GO  TO  SEL-090.                                         I.981026
009680*****IF  W-JS = ZERO                                              D.030707
009690*****    IF  OKJF-09 NOT = ZERO                                   D.030707
009700*****        GO  TO  SEL-010.                                     D.030707
009710*****IF  W-JS = 1                                                 D.030707
009720*****    IF  OKJF-09 NOT = 1                                      D.030707
009730     IF  W-JS    NOT = 9                                          I.030718
009740         IF  OKJF-09 NOT = W-JS                                   I.030707
009750             GO  TO  SEL-010.                                     I.981026
009760     IF  OKJF-08 = 1                                              I.981026
009770         GO  TO  SEL-010.                                         I.981026
009780     IF  OKJF-02 NOT = 4                                          I.981026
009790         GO  TO  SEL-010.                                         I.981026
009800     IF  (OKJF-07 > ZERO)  AND  (OKJF-10 = 1)                     I.981026
009810         NEXT  SENTENCE                                           I.981026
009820       ELSE                                                       I.981026
009830         GO  TO  SEL-010.                                         I.981026
009840     IF  JS-SIGN = 0                                              I.981026
009850*****    IF  OKJF-04 = 2  OR  3  OR  5  OR  6                     D.051216
009860         IF  OKJF-04 = 2  OR  3  OR  4  OR  5  OR  6  OR  7       I.051216
009870             GO  TO  SEL-010.                                     I.981026
009880     IF  JS-SIGN = 1                                              I.981026
009890         IF  OKJF-04 NOT = 2  AND  3                              I.981026
009900             GO  TO  SEL-010.                                     I.981026
009910     IF  JS-SIGN = 2                                              I.981026
009920         IF  OKJF-04 NOT = 5  AND  6                              I.981026
009930             GO  TO  SEL-010.                                     I.981026
009940     IF  JS-SIGN = 3                                              I.981026
009950         IF  OKJF-04 NOT = 2  AND  3  AND  5  AND  6              I.981026
009960             GO  TO  SEL-010.                                     I.981026
009970     MOVE  ZERO  TO  W-NGP.                                       I.981026
009980     MOVE  OKJF-03  TO  W-NGPS.                                   I.981026
009990     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1                     I.981027
010000         ADD  DATE-NC1  TO  W-NEN.                                I.981027
010010     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2                     I.981027
010020         ADD  DATE-NC2  TO  W-NEN.                                I.981027
010030*****IF  W-NEN2 > 90                                              D.981027
010040*****    ADD  1900  TO  W-NEN                                     D.981027
010050*****  ELSE                                                       D.981027
010060*****    ADD  2000  TO  W-NEN.                                    D.981026
010070     IF  W-SDATE = ZERO                                           I.981026
010080         MOVE  W-NGP  TO  W-SDATE.                                I.981026
010090     IF  W-SDATE > W-NGP                                          I.981026
010100         MOVE  W-NGP  TO  W-SDATE.                                I.981026
010110     IF  W-EDATE < W-NGP                                          I.981026
010120         MOVE  W-NGP  TO  W-EDATE.                                I.981026
010130     GO  TO  SEL-010.                                             I.981026
010140 SEL-090.                                                         I.981026
010150     CLOSE  OKJF.                                                 I.981026
010160     IF  W-FOC     =   1                                          I.030718
010170         OPEN  I-O   OKJF.                                        I.030718
010180     MOVE  W-SDATE  TO  W-SNGP.                                   I.981026
010190     MOVE  W-EDATE  TO  W-ENGP.                                   I.981026
010200 SEL-EX.                                                          I.981026
010210     EXIT.                                                        I.981026
010220     COPY    LPMSG.                                               COPYLIB.
010230*********************  ÇoÇqÇnÇfÇqÇ`ÇlÅ@Å@ÇdÇmÇcÅ@*************************
