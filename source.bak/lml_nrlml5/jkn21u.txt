000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JK020U.
000030****************************************************************
000040*    ÇnÅ^ÇkéÛêMÉfÅ[É^çXêV                                      *
000050*                              89/ 8/18   NO.175  N.HARA       *
000060****************************************************************
000070 ENVIRONMENT       DIVISION.
000080 CONFIGURATION     SECTION.
000090 SOURCE-COMPUTER.  SYSTEM3100.
000100 OBJECT-COMPUTER.  SYSTEM3100.
000110 INPUT-OUTPUT      SECTION.
000120 FILE-CONTROL.
000130     SELECT  GDMM   ASSIGN  GDMM-MSD                              I.980317
000140                    ORGANIZATION  INDEXED                         I.980317
000150                    ACCESS  MODE  RANDOM                          I.980317
000160                    RECORD  KEY   GDMM-KEY                        I.980317
000170                    FILE  STATUS  ERR-STAT.                       I.980317
000180*----<ÇnÅ^ÇkéÛêMÇe>----*
000190     SELECT    KOLRF     ASSIGN    TO    KOL-MSD
000200                         ORGANIZATION    SEQUENTIAL
000210                         FILE  STATUS    ERR-STAT.
000220*----<ÇnÅ^ÇkèÛãµÇe>----*
000230     SELECT    JOJF      ASSIGN    TO    JOJ-MSD
000240                         ORGANIZATION    INDEXED
000250                         ACCESS  MODE    RANDOM
000260                         RECORD   KEY    JOJF-KEY
000270                         FILE  STATUS    ERR-STAT.
000280*----<ÉRÉìÉgÉçÅ[ÉãÇe>----*
000290     SELECT    JCON      ASSIGN    TO    CON-MSD
000300                         ORGANIZATION    INDEXED
000310                         ACCESS  MODE    RANDOM
000320                         RECORD   KEY    JCON1-KEY
000330                         FILE  STATUS    ERR-STAT.
000340*----<íºëóêÊÉ}ÉXÉ^>----*
000350     SELECT    TC-M      ASSIGN    TO    TCM-MSD
000360                         ORGANIZATION    INDEXED
000370                         ACCESS  MODE    RANDOM
000380                         RECORD   KEY    TC-KEY
000390                         FILE  STATUS    ERR-STAT.
000400*----<èoâ◊ïiñºÉ}ÉXÉ^>----*
000410     SELECT    SHM       ASSIGN    TO    SHM-MSD
000420                         ORGANIZATION    INDEXED
000430                         ACCESS  MODE    RANDOM
000440                         RECORD   KEY    SHM-KEY
000450                         FILE  STATUS    ERR-STAT.
000460*----<èoâ◊éwê}ÉgÉâÉì>----*
000470     SELECT    JSTR      ASSIGN    TO    JST-MSD
000480                         ORGANIZATION    INDEXED
000490                         ACCESS  MODE    RANDOM
000500                         RECORD   KEY    JSTR-KEY
000510                         FILE  STATUS    ERR-STAT.
000520*----<â◊éDÉgÉâÉì>----*
000530     SELECT    JNIF      ASSIGN    TO    JNI-MSD
000540                         ORGANIZATION    INDEXED
000550                         ACCESS  MODE    RANDOM
000560                         RECORD   KEY    JNIF1-KEY
000570                         FILE  STATUS    ERR-STAT.
000580*----<ëóÇËèÛÇe>----*
000590     SELECT    OKJF      ASSIGN    TO    OKJ-MSD
000600                         ORGANIZATION    INDEXED
000610                         ACCESS  MODE    RANDOM
000620                         RECORD   KEY    OKJF-KEY
000630                         FILE  STATUS    ERR-STAT.
000640*----<ÇnÅ^ÇkéÛêMó›êœÇe>----*
000650     SELECT  JT-OMSD     ASSIGN    TO    OMSD-MSD                 I.980123
000660                         FILE  STATUS IS ERR-STAT.                I.980123
000670*----<ÇnÅ^Çkê⁄ë±ÉtÉ@ÉCÉã >----*                                   A.901015
000680*****SELECT    JT-OSZK   ASSIGN    TO    OSZ-MSD                  D.980114
000690*****                    ORGANIZATION    SEQUENTIAL               D.980114
000700*****                    ACCESS  MODE    SEQUENTIAL               D.980114
000710*****                    FILE STATUS     ERR-STAT.                D.980114
000720 I-O-CONTROL.
000730     APPLY  SHARED-MODE  ON  JOJF  JCON  TC-M  SHM
000740                             GDMM                                 I.980317
000750                             JSTR  OKJF  JNIF.
000760*
000770 DATA              DIVISION.
000780*
000790 FILE              SECTION.
000800     COPY  L-GDMM.                                                I.980317
000810     COPY    L-KORF.
000820     COPY    L-JOJF.
000830     COPY    L-JCON.
000840     COPY    LITCM.
000850     COPY    L-SHM.
000860     COPY    L-JSTR.
000870     COPY    L-JNIF.
000880     COPY    LOKJF.
000890*****COPY    LTOSZK.                                              D.980114
000900***********************************************
000910*****     äOïîëqå…ÇnÅ^ÇkéÛêMó›êœÇeÇc      *****
000920*****         ( JT-OMSD )  256/1          *****
000930***********************************************
000940 FD  JT-OMSD                                                      I.980123
000950     BLOCK  1 RECORDS                                             I.980123
000960     LABEL RECORD IS STANDARD                                     I.980123
000970     VALUE OF IDENTIFICATION "JT-OMSD".                           I.980123
000980 01  OMSD-REC      PIC X(256).                                    I.980123
000990*
001000 WORKING-STORAGE   SECTION.
001010*----< ‹∞∏ ¥ÿ± >----*
001020 01  END-STS-WK.
001030   02  PF9         PIC X(02)   VALUE "P9".
001040   02  HTAB        PIC X(02)   VALUE "01".
001050 77  KAKU-W        PIC X(01).
001060 77  NN            PIC 9(02).
001070 77  NN-W          PIC 9(02).
001080 77  ERR-STAT      PIC X(02).
001090 77  END-SW        PIC 9(01)   VALUE  0.
001100 01  NC-WK.
001110   02  NC-01       PIC N(08)   VALUE  NC"éÛêMÉfÅ[É^Å@ÉiÉV".
001120   02  NC-02       PIC N(03)   VALUE  NC"éÛêMíÜ".
001130 01  ERR-WK        PIC N(20).
001140 01  JS-SIGN       PIC 9(01).                                     I.900411
001150*-------------------*
001160     COPY    LWMSG.
001170*
001180 SCREEN            SECTION.
001190 SD  GAMEN    END  STATUS  END-STS.
001200 01  DSP-CLR  LINE  1.
001210   02  CLEAR  SCREEN.
001220 01  DSP-HYOJI.
001230   02  LINE  1     COLUMN 20   PIC N(16)  VALUE
001240           NC"ÅñÅñÅ@ÇnÅ^ÇkéÛêMÉfÅ[É^çXêVÅ@ÅñÅñ".
001250   02  LINE 24.
001260     03            COLUMN 42   PIC N(02)  VALUE NC"ämîF".
001270     03            COLUMN 52   PIC X(01)  VALUE "(".
001280     03            COLUMN 54   PIC X(01)  VALUE ")".
001290***02  LINE 04     COLUMN 15  VALUE                               D.961015
001300***    "***************************************************".     D.961015
001310***02  LINE 05     COLUMN 15  PIC X(01)  VALUE "*".               D.961015
001320***02  LINE 05     COLUMN 65  PIC X(01)  VALUE "*".               D.961015
001330***02  LINE 06     COLUMN 15  PIC X(01)  VALUE "*".               D.961015
001340***02  LINE 06     COLUMN 65  PIC X(01)  VALUE "*".               D.961015
001350***02  LINE 07     COLUMN 15  PIC X(01)  VALUE "*".               D.961015
001360***02  LINE 07     COLUMN 65  PIC X(01)  VALUE "*".               D.961015
001370***02  LINE 07     COLUMN 18  PIC N(23)  VALUE                    D.961015
001380***    NC"ÅwÉIÉìÉâÉCÉìê⁄ë±ÇeÇcÅEê≥ÅxÇÉZÉbÉgÇµÇƒâ∫Ç≥Ç¢ÅB".        D.961015
001390***02  LINE 08     COLUMN 15  PIC X(01)  VALUE "*".               D.961015
001400***02  LINE 08     COLUMN 65  PIC X(01)  VALUE "*".               D.961015
001410***02  LINE 09     COLUMN 15  PIC X(01)  VALUE "*".               D.961015
001420***02  LINE 09     COLUMN 65  PIC X(01)  VALUE "*".               D.961015
001430***02  LINE 10     COLUMN 15  VALUE                               D.961015
001440***    "***************************************************".     D.961015
001450 01  ACP-KAKU.
001460   02  LINE 24     COLUMN 53   PIC X(01)  INTO  KAKU-W
001470                            CHECK  OVERFLOW  NO  IFC.
001480 01  DSP-ERRMSG    LINE 24.
001490   02              COLUMN  1   PIC N(20)  FROM  ERR-WK.
001500   02              COLUMN  1   PIC X(05)  VALUE ""27"B"10"".
001510   02              COLUMN  1   PIC X(40)  VALUE " ".
001520 01  DSP-GDMM.                                                    I.980317
001530     02  LINE  24  COLUMN   1  VALUE                              I.980317
001540         NC"ÅñÅñÉ_É~Å[ÇeÅ@Ç»Çµ".                                  I.980317
001550*-------------------*
001560     COPY    LSERR.                                               R.900411
001570*
001580*==============================================================*
001590 PROCEDURE         DIVISION.
001600*--------------------------------------------------------------*
001610*    “ ≤ ›  Ÿ ∞ ¡ ›                                            *
001620*--------------------------------------------------------------*
001630 MAINLINE-ROUTINE.
001640     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
001650     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
001660     PERFORM  READ-RTN  THRU  READ-RTN-EXIT.
001670     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
001680         UNTIL  END-SW  =  9.
001690     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
001700     PERFORM  ENDR-RTN  THRU  ENDR-RTN-EXIT.
001710*
001720 MAINLINE-END.
001730     STOP RUN.
001740*--------------------------------------------------------------*
001750*    P R O C  -  R T N                                         *
001760*--------------------------------------------------------------*
001770 PROC-RTN.
001780*----< O/Lºﬁ≠º›Ÿ≤æ∑F ∫≥º›ºÆÿ >----*                               A.911015
001790     PERFORM  UPD7-RTN  THRU  UPD7-EX.                            I.980123
001800*****IF  KOLRF1-01  =  1      PERFORM  UPD7-RTN  THRU  UPD7-EX.   D.980114
001810*****IF  KOLRF2-01  =  2      PERFORM  UPD7-RTN  THRU  UPD7-EX.   D.980114
001820*****IF  KOLRF3-01  =  3      PERFORM  UPD7-RTN  THRU  UPD7-EX.   D.980114
001830*****IF  KOLRF12-01 =  12     PERFORM  UPD7-RTN  THRU  UPD7-EX.   D.980114
001840 PROC-010.
001850     IF  KOLRF1-01  =  1
001860*----< ∫›ƒ€∞ŸF ∫≥º›ºÆÿ >----*
001870         MOVE  KOLRF1-02  TO  JCON1-01
001880         MOVE  KOLRF1-03  TO  JCON1-02
001890         PERFORM  UPD1-RTN  THRU  UPD1-RTN-EXIT.
001900     IF  KOLRF2-01  =  2
001910*----< ¡Æ∏ø≥ª∑M ∫≥º›ºÆÿ >----*
001920         MOVE  KOLRF2-02  TO  TC-TCD
001930         MOVE  KOLRF2-03  TO  TC-CCD
001940         PERFORM  UPD2-RTN  THRU  UPD2-RTN-EXIT.
001950     IF  KOLRF3-01  =  3
001960*----< º≠Ø∂À›“≤M ∫≥º›ºÆÿ >----*
001970         MOVE  KOLRF3-02  TO  SHM-01
001980         PERFORM  UPD3-RTN  THRU  UPD3-RTN-EXIT.
001990     IF  KOLRF11-01  =  11
002000*----< º≠Ø∂ªºΩﬁT ∫≥º›ºÆÿ >----*
002010         MOVE  KOLRF11-02  TO  JSTR-01
002020         MOVE  KOLRF11-03  TO  JSTR-02
002030         PERFORM  UPD4-RTN  THRU  UPD4-RTN-EXIT.
002040     IF  KOLRF12-01  =  12
002050*----< ∆Ã¿ﬁT ∫≥º›ºÆÿ >----*
002060         MOVE  KOLRF121-01  TO  JNIF1-01
002070         MOVE  KOLRF121-02  TO  JNIF1-02
002080         PERFORM  UPD5-RTN  THRU  UPD5-RTN-EXIT.
002090     IF  KOLRF13-01  =  13
002100*----< µ∏ÿºﬁÆ≥F ∫≥º›ºÆÿ >----*
002110         PERFORM  UPD6-RTN  THRU  UPD6-RTN-EXIT
002120             VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  4.
002130     PERFORM  READ-RTN  THRU  READ-RTN-EXIT.
002140 PROC-RTN-EXIT.
002150     EXIT.
002160*--------------------------------------------------------------*
002170*    I N I T  -  R T N                                         *
002180*--------------------------------------------------------------*
002190 INIT-RTN.
002200     ACCEPT   JS-SIGN.                                            I.900411
002210*
002220     DISPLAY  DSP-CLR    BYPASS.                                  I.980316
002230     DISPLAY  DSP-HYOJI  BYPASS.                                  I.980316
002240     OPEN  I-O      GDMM.                                         I.980317
002250     MOVE  "0"      TO  GDMM-KEY.                                 I.980317
002260     READ  GDMM     INVALID  KEY                                  I.980317
002270           CLOSE    GDMM                                          I.980317
002280           DISPLAY  DSP-GDMM   DISP-BUZ-B                         I.980317
002290           STOP  RUN.                                             I.980317
002300*****DISPLAY  DSP-CLR.                                            D.980316
002310*****DISPLAY  DSP-HYOJI.                                          D.980316
002320 INIT-010.
002330     ACCEPT   ACP-KAKU.
002340     IF  END-STS      =  PF9   STOP  RUN.
002350     IF  END-STS  NOT =  HTAB  GO TO INIT-010.
002360*----< O/LºﬁÆ≥∑Æ≥F OPEN & READ >----*
002370     IF  JS-SIGN  =  1                   GO  TO  INIT-RTN-EXIT.   I.900411
002380     OPEN  I-O  JOJF.
002390     MOVE  "0002"  TO  JOJF-01.
002400     READ   JOJF   UNLOCK  INVALID  KEY
002410                   MOVE  NC-01  TO  ERR-WK
002420                   DISPLAY  DSP-ERRMSG  BYPASS                    I.980316
002430*****              DISPLAY  DSP-ERRMSG                            D.980316
002440                   CLOSE    GDMM                                  I.980317
002450                   CLOSE   JOJF
002460                   STOP    RUN.
002470     IF  JOJF-061  =  0
002480         MOVE  ZERO  TO  NN-W
002490         PERFORM  ZERO-RTN  THRU  ZERO-RTN-EXIT
002500             VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10
002510         IF  NN-W  =  0
002520                   MOVE  NC-01  TO  ERR-WK
002530*****              DISPLAY  DSP-ERRMSG                            D.980316
002540                   DISPLAY  DSP-ERRMSG  BYPASS                    I.980316
002550                   CLOSE    GDMM                                  I.980317
002560                   CLOSE   JOJF
002570                   STOP    RUN.
002580     IF  JOJF-061  =  6
002590                   MOVE  NC-02  TO  ERR-WK
002600                   DISPLAY  DSP-ERRMSG  BYPASS                    I.980316
002610*****              DISPLAY  DSP-ERRMSG                            D.980316
002620                   CLOSE    GDMM                                  I.980317
002630                   CLOSE   JOJF
002640                   STOP    RUN.
002650     CLOSE      JOJF.
002660 INIT-RTN-EXIT.
002670     EXIT.
002680*--------------------------------------------------------------*
002690 ZERO-RTN.
002700     IF  JOJF-10(NN)  NOT =  ZERO
002710         MOVE   1  TO  NN-W
002720         MOVE  10  TO  NN.
002730 ZERO-RTN-EXIT.
002740     EXIT.
002750*--------------------------------------------------------------*
002760*    R E A D  -  R T N                                         *
002770*--------------------------------------------------------------*
002780 READ-RTN.
002790     READ    KOLRF     AT  END   MOVE  9  TO  END-SW.
002800*
002810 READ-RTN-EXIT.
002820     EXIT.
002830*--------------------------------------------------------------*
002840*    Ã ß ≤ Ÿ  ∫ ≥ º ›  º Æ ÿ                                   *
002850*--------------------------------------------------------------*
002860*====<  U P D 1  -  R T N  >====*
002870 UPD1-RTN.
002880     READ   JCON     INVALID  KEY
002890                     PERFORM  WRT1-RTN  THRU  WRT1-RTN-EXIT
002900                     GO TO UPD1-RTN-EXIT.
002910     PERFORM  REW1-RTN  THRU  REW1-RTN-EXIT.
002920 UPD1-RTN-EXIT.
002930     EXIT.
002940*====<  U P D 2  -  R T N  >====*
002950 UPD2-RTN.
002960     READ   TC-M     INVALID  KEY
002970                     PERFORM  WRT2-RTN  THRU  WRT2-RTN-EXIT
002980                     GO TO UPD2-RTN-EXIT.
002990     IF  KOLRF2-12  =  3
003000                     PERFORM  DLT2-RTN  THRU  DLT2-RTN-EXIT
003010     ELSE            PERFORM  REW2-RTN  THRU  REW2-RTN-EXIT.
003020 UPD2-RTN-EXIT.
003030     EXIT.
003040*====<  U P D 3  -  R T N  >====*
003050 UPD3-RTN.
003060     READ   SHM      INVALID  KEY
003070                     PERFORM  WRT3-RTN  THRU  WRT3-RTN-EXIT
003080                     GO TO UPD3-RTN-EXIT.
003090     IF  KOLRF3-10  =  3
003100                     PERFORM  DLT3-RTN  THRU  DLT3-RTN-EXIT
003110     ELSE            PERFORM  REW3-RTN  THRU  REW3-RTN-EXIT.
003120 UPD3-RTN-EXIT.
003130     EXIT.
003140*====<  U P D 4  -  R T N  >====*
003150 UPD4-RTN.
003160     READ   JSTR     INVALID  KEY
003170                     PERFORM  WRT4-RTN  THRU  WRT4-RTN-EXIT.
003180 UPD4-RTN-EXIT.
003190     EXIT.
003200*====<  U P D 5  -  R T N  >====*
003210 UPD5-RTN.
003220     READ   JNIF     INVALID  KEY
003230                     PERFORM  WRT5-RTN  THRU  WRT5-RTN-EXIT.
003240     IF  KOLRF121-21  =  ZERO  OR  SPACE
003250                         GO TO UPD5-RTN-EXIT.
003260     MOVE  KOLRF121-21  TO  JNIF1-01.
003270     MOVE  KOLRF121-22  TO  JNIF1-02.
003280     READ   JNIF     INVALID  KEY
003290                     PERFORM  WRT5-RTN2 THRU  WRT5-RTN2-EXIT.
003300 UPD5-RTN-EXIT.
003310     EXIT.
003320*====<  U P D 6  -  R T N  >====*
003330 UPD6-RTN.
003340     IF  KOLRF13-02(NN)  =  ZERO  OR  SPACE
003350                               GO TO UPD6-RTN-EXIT.
003360     MOVE   KOLRF13-02(NN)  TO  OKJF-01.
003370     READ   OKJF     INVALID  KEY
003380                     PERFORM  WRT6-RTN  THRU  WRT6-RTN-EXIT.
003390 UPD6-RTN-EXIT.
003400     EXIT.
003410*====<  U P D 7  -  R T N  >====*                                 A.911015
003420 UPD7-RTN.
003430     PERFORM  WW1-RTN  THRU  WW1-EX.                              I.980123
003440*****IF  KOLRF1-01  =  1   PERFORM  WW1-RTN  THRU  WW1-EX.        D.980114
003450*****IF  KOLRF2-01  =  2   PERFORM  WW2-RTN  THRU  WW2-EX.        D.980114
003460*****IF  KOLRF3-01  =  3   PERFORM  WW3-RTN  THRU  WW3-EX.        D.980114
003470*****IF  KOLRF12-01 =  12  PERFORM  WW12-RTN  THRU  WW12-EX.      D.980114
003480 UPD7-EX.
003490     EXIT.
003500*--------------------------------------------------------------*
003510 WRT1-RTN.
003520     INITIALIZE   JCON1-R.
003530     MOVE  KOLRF1-02   TO  JCON1-01.
003540     MOVE  KOLRF1-03   TO  JCON1-02.
003550     MOVE  KOLRF1-04   TO  JCON2-03.
003560     WRITE  JCON1-R    INVALID  KEY
003570                       MOVE  "JCON"       TO    ERR-F
003580                       MOVE  "W"          TO    ERR-M
003590                       MOVE   JCON1-KEY   TO    ERR-K
003600                       MOVE   0           TO    ERR-LIN
003610                       PERFORM  ERR-RTN   THRU  ERR-EX
003620                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
003630                       MOVE  255    TO    COMPLETION-CODE
003640                       STOP  RUN.
003650 WRT1-RTN-EXIT.
003660     EXIT.
003670*--------------------------------------------------------------*
003680 WRT2-RTN.
003690     IF  KOLRF2-12  =  3     GO TO WRT2-RTN-EXIT.
003700     INITIALIZE   TC-R.
003710     MOVE  KOLRF2-02   TO  TC-TCD.
003720     MOVE  KOLRF2-03   TO  TC-CCD.
003730     MOVE  KOLRF2-04   TO  TC-NAME.
003740     MOVE  KOLRF2-05   TO  TC-JSU.
003750     MOVE  KOLRF2-06   TO  TC-JSS.
003760     MOVE  KOLRF2-07   TO  TC-UNO.
003770     MOVE  KOLRF2-08   TO  TC-TEL.
003780     MOVE  KOLRF2-09   TO  TC-FKC.
003790     MOVE  KOLRF2-10   TO  TC-UCD.
003800     WRITE   TC-R      INVALID  KEY
003810                       MOVE  "TC-M"       TO    ERR-F
003820                       MOVE  "W"          TO    ERR-M
003830                       MOVE   TC-KEY      TO    ERR-K
003840                       MOVE   0           TO    ERR-LIN
003850                       PERFORM  ERR-RTN   THRU  ERR-EX
003860                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
003870                       MOVE  255    TO    COMPLETION-CODE
003880                       STOP  RUN.
003890 WRT2-RTN-EXIT.
003900     EXIT.
003910*--------------------------------------------------------------*
003920 WRT3-RTN.
003930     IF  KOLRF3-10  =  3     GO TO WRT3-RTN-EXIT.
003940     INITIALIZE   SHM-R.
003950     MOVE  KOLRF3-02   TO  SHM-01.
003960     MOVE  KOLRF3-03   TO  SHM-02.
003970     MOVE  KOLRF3-04   TO  SHM-03.
003980     MOVE  KOLRF3-06   TO  SHM-05.
003990     MOVE  KOLRF3-07   TO  SHM-06.
004000     MOVE  KOLRF3-08   TO  SHM-07.
004010     MOVE  KOLRF3-11   TO  SHM-09.                                I.970130
004020     PERFORM  MV31-RTN  THRU  MV31-RTN-EXIT
004030         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10.
004040     WRITE   SHM-R     INVALID  KEY
004050                       MOVE  "SHM"        TO    ERR-F
004060                       MOVE  "W"          TO    ERR-M
004070                       MOVE   SHM-KEY     TO    ERR-K
004080                       MOVE   0           TO    ERR-LIN
004090                       PERFORM  ERR-RTN   THRU  ERR-EX
004100                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
004110                       MOVE  255    TO    COMPLETION-CODE
004120                       STOP  RUN.
004130 WRT3-RTN-EXIT.
004140     EXIT.
004150*--------------------------------------------------------------*
004160 WRT4-RTN.
004170     INITIALIZE   JSTR-R.
004180     MOVE  KOLRF11-02   TO  JSTR-01.
004190     MOVE  KOLRF11-03   TO  JSTR-02.
004200     MOVE  KOLRF11-04   TO  JSTR-03.
004210     MOVE  KOLRF11-05   TO  JSTR-04.
004220     MOVE  KOLRF11-06   TO  JSTR-05.
004230     MOVE  KOLRF11-07   TO  JSTR-06.
004240     MOVE  KOLRF11-08   TO  JSTR-07.
004250     MOVE  KOLRF11-09   TO  JSTR-08.
004260     MOVE  KOLRF11-10   TO  JSTR-09.
004270     MOVE  KOLRF11-11   TO  JSTR-10.
004280     MOVE  KOLRF11-12   TO  JSTR-11.
004290     MOVE  KOLRF11-13   TO  JSTR-12.
004300     MOVE  KOLRF11-14   TO  JSTR-13.
004310     MOVE  KOLRF11-15   TO  JSTR-14.
004320     MOVE  KOLRF11-15A  TO  JSTR-14A.
004330     MOVE  KOLRF11-15B  TO  JSTR-14B.
004340     MOVE  KOLRF11-15C  TO  JSTR-14C.
004350*****MOVE  KOLRF11-99   TO  JSTR-99.                              D.981001
004360     MOVE  KOLRF11-15D  TO  JSTR-14D.
004370     MOVE  KOLRF11-16   TO  JSTR-15.
004380     MOVE  KOLRF11-20   TO  JSTR-20.                              I.981020
004390     MOVE  KOLRF11-16A  TO  JSTR-15A.
004400*****MOVE  KOLRF11-18A  TO  JSTR-18.                              D.981001
004410     MOVE  KOLRF11-19   TO  JSTR-19.                              *I 92/05
004420     MOVE  KOLRF11-168  TO  JSTR-158.
004430     MOVE  KOLRF11-17   TO  JSTR-16.
004440     MOVE  KOLRF11-18   TO  JSTR-17.
004450     WRITE   JSTR-R     INVALID  KEY
004460                       MOVE  "JSTR"       TO    ERR-F
004470                       MOVE  "W"          TO    ERR-M
004480                       MOVE   JSTR-KEY    TO    ERR-K
004490                       MOVE   0           TO    ERR-LIN
004500                       PERFORM  ERR-RTN   THRU  ERR-EX
004510                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
004520                       MOVE  255    TO    COMPLETION-CODE
004530                       STOP  RUN.
004540 WRT4-RTN-EXIT.
004550     EXIT.
004560*--------------------------------------------------------------*
004570 WRT5-RTN.
004580     IF  JNIF1-02  =  7       GO TO WRT5-010.
004590     INITIALIZE  JNIF1-R.
004600     MOVE  KOLRF121-01  TO  JNIF1-01.
004610     MOVE  KOLRF121-02  TO  JNIF1-02.
004620     MOVE  KOLRF121-03  TO  JNIF1-03.
004630     MOVE  KOLRF121-04  TO  JNIF1-04.
004640     MOVE  KOLRF121-05  TO  JNIF1-05.
004650     MOVE  KOLRF121-06  TO  JNIF1-06.
004660     MOVE  KOLRF121-07  TO  JNIF1-07.
004670     MOVE  KOLRF121-08  TO  JNIF1-08.
004680     PERFORM  MV51-RTN  THRU  MV51-RTN-EXIT
004690         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  27.
004700     MOVE  KOLRF121-10  TO  JNIF1-10.
004710     MOVE  KOLRF121-11  TO  JNIF1-11.
004720     MOVE  KOLRF121-12  TO  JNIF1-12.
004730     MOVE  KOLRF121-13  TO  JNIF1-13.
004740     MOVE  KOLRF121-14  TO  JNIF1-14.
004750     WRITE   JNIF1-R   INVALID  KEY
004760                       MOVE  "JNIF"       TO    ERR-F
004770                       MOVE  "W"          TO    ERR-M
004780                       MOVE   JNIF1-KEY   TO    ERR-K
004790                       MOVE   0           TO    ERR-LIN
004800                       PERFORM  ERR-RTN   THRU  ERR-EX
004810                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
004820                       MOVE  255    TO    COMPLETION-CODE
004830                       STOP  RUN.
004840     GO TO WRT5-RTN-EXIT.
004850 WRT5-010.
004860     INITIALIZE  JNIF2-R.
004870     MOVE  KOLRF122-01  TO  JNIF2-01.
004880     MOVE  KOLRF122-02  TO  JNIF2-02.
004890     MOVE  KOLRF122-02A TO  JNIF2-02A.
004900     MOVE  KOLRF122-03  TO  JNIF2-03.
004910     MOVE  KOLRF122-04  TO  JNIF2-04.
004920     MOVE  KOLRF122-05  TO  JNIF2-05.
004930     MOVE  KOLRF122-06  TO  JNIF2-06.
004940     MOVE  KOLRF122-07  TO  JNIF2-07.
004950     MOVE  KOLRF122-08  TO  JNIF2-08.
004960     WRITE   JNIF2-R   INVALID  KEY
004970                       MOVE  "JNIF"       TO    ERR-F
004980                       MOVE  "W"          TO    ERR-M
004990                       MOVE   JNIF2-KEY   TO    ERR-K
005000                       MOVE   0           TO    ERR-LIN
005010                       PERFORM  ERR-RTN   THRU  ERR-EX
005020                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005030                       MOVE  255    TO    COMPLETION-CODE
005040                       STOP  RUN.
005050 WRT5-RTN-EXIT.
005060     EXIT.
005070*--------------------------------------------------------------*
005080 WRT5-RTN2.
005090     IF  JNIF1-02  =  7       GO TO WRT52-010.
005100     INITIALIZE  JNIF1-R.
005110     MOVE  KOLRF121-21  TO  JNIF1-01.
005120     MOVE  KOLRF121-22  TO  JNIF1-02.
005130     MOVE  KOLRF121-23  TO  JNIF1-03.
005140     MOVE  KOLRF121-24  TO  JNIF1-04.
005150     MOVE  KOLRF121-25  TO  JNIF1-05.
005160     MOVE  KOLRF121-26  TO  JNIF1-06.
005170     MOVE  KOLRF121-27  TO  JNIF1-07.
005180     MOVE  KOLRF121-28  TO  JNIF1-08.
005190     PERFORM  MV51-RTN2 THRU  MV51-RTN2-EXIT
005200         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  27.
005210     MOVE  KOLRF121-30  TO  JNIF1-10.
005220     MOVE  KOLRF121-31  TO  JNIF1-11.
005230     MOVE  KOLRF121-32  TO  JNIF1-12.
005240     MOVE  KOLRF121-33  TO  JNIF1-13.
005250     MOVE  KOLRF121-34  TO  JNIF1-14.
005260     WRITE   JNIF1-R   INVALID  KEY
005270                       MOVE  "JNIF"       TO    ERR-F
005280                       MOVE  "W"          TO    ERR-M
005290                       MOVE   JNIF1-KEY   TO    ERR-K
005300                       MOVE   0           TO    ERR-LIN
005310                       PERFORM  ERR-RTN   THRU  ERR-EX
005320                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005330                       MOVE  255    TO    COMPLETION-CODE
005340                       STOP  RUN.
005350     GO TO WRT5-RTN2-EXIT.
005360 WRT52-010.
005370     INITIALIZE  JNIF2-R.
005380     MOVE  KOLRF122-21  TO  JNIF2-01.
005390     MOVE  KOLRF122-22  TO  JNIF2-02.
005400     MOVE  KOLRF122-22A TO  JNIF2-02A.
005410     MOVE  KOLRF122-23  TO  JNIF2-03.
005420     MOVE  KOLRF122-24  TO  JNIF2-04.
005430     MOVE  KOLRF122-25  TO  JNIF2-05.
005440     MOVE  KOLRF122-26  TO  JNIF2-06.
005450     MOVE  KOLRF122-27  TO  JNIF2-07.
005460     MOVE  KOLRF122-28  TO  JNIF2-08.
005470     WRITE   JNIF2-R   INVALID  KEY
005480                       MOVE  "JNIF"       TO    ERR-F
005490                       MOVE  "W"          TO    ERR-M
005500                       MOVE   JNIF2-KEY   TO    ERR-K
005510                       MOVE   0           TO    ERR-LIN
005520                       PERFORM  ERR-RTN   THRU  ERR-EX
005530                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005540                       MOVE  255    TO    COMPLETION-CODE
005550                       STOP  RUN.
005560 WRT5-RTN2-EXIT.
005570     EXIT.
005580*--------------------------------------------------------------*
005590 WRT6-RTN.
005600     INITIALIZE   OKJF-R.
005610     MOVE  KOLRF13-02(NN)  TO  OKJF-01.
005620     MOVE  KOLRF13-03(NN)  TO  OKJF-02.
005630     MOVE  KOLRF13-04(NN)  TO  OKJF-03.
005640     MOVE  KOLRF13-05(NN)  TO  OKJF-04.
005650     MOVE  KOLRF13-06(NN)  TO  OKJF-05.
005660     MOVE  KOLRF13-07(NN)  TO  OKJF-06.
005670     MOVE  KOLRF13-08(NN)  TO  OKJF-07.
005680     MOVE  KOLRF13-09(NN)  TO  OKJF-08.
005690     MOVE  KOLRF13-10(NN)  TO  OKJF-09.
005700     MOVE  KOLRF13-11(NN)  TO  OKJF-10.
005710     MOVE  KOLRF13-12(NN)  TO  OKJF-11.                           I.960829
005720     WRITE   OKJF-R    INVALID  KEY
005730                       MOVE  "OKJF"       TO    ERR-F
005740                       MOVE  "W"          TO    ERR-M
005750                       MOVE   OKJF-KEY    TO    ERR-K
005760                       MOVE   0           TO    ERR-LIN
005770                       PERFORM  ERR-RTN   THRU  ERR-EX
005780                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
005790                       MOVE  255    TO    COMPLETION-CODE
005800                       STOP  RUN.
005810 WRT6-RTN-EXIT.
005820     EXIT.
005830*-------------------------------------------*
005840*    O/Lºﬁ≠º›Ÿ≤æ∑F ∫≥º›ºÆÿ
005850*-------------------------------------------*
005860 WW1-RTN.                                                         I.980123
005870     INITIALIZE  OMSD-REC.                                        I.980123
005880     MOVE  KOLRF1-REC  TO  OMSD-REC.                              I.980123
005890     WRITE  OMSD-REC.                                             I.980123
005900     IF  ERR-STAT  NOT  =  "00"                                   I.980123
005910         MOVE  "JT-OMSD"  TO  ERR-F                               I.980123
005920         MOVE  "W"        TO  ERR-M                               I.980123
005930         PERFORM  ERR-RTN  THRU  ERR-EX.                          I.980123
005940 WW1-EX.                                                          I.980123
005950     EXIT.                                                        I.980123
005960*-------------------------------------------*
005970*    O/Læ¬øﬁ∏F ∫≥º›ºÆÿ                                            A.911015
005980*-------------------------------------------*
005990*WW1-RTN.                                                         D.980114
006000*****INITIALIZE  OSZK1-REC.                                       D.980114
006010*****MOVE  KOLRF1-REC  TO  OSZK1-REC.                             D.980114
006020*****WRITE  OSZK1-REC.                                            D.980114
006030*****IF  ERR-STAT  NOT  =  "00"                                   D.980114
006040*****    MOVE  "JT-OSZK"  TO  ERR-F                               D.980114
006050*****    MOVE  "W"        TO  ERR-M                               D.980114
006060*****    PERFORM  ERR-RTN  THRU  ERR-EX.                          D.980114
006070***  CALL  "CBLTCLS"  USING  JT-OSZK.                             D 911022
006080*WW1-EX.                                                          D.980114
006090*****EXIT.                                                        D.980114
006100*--------------------------------------------------------------*
006110*WW2-RTN.                                                         D.980114
006120*****INITIALIZE  OSZK2-REC.                                       D.980114
006130*****MOVE  KOLRF2-REC  TO  OSZK2-REC.                             D.980114
006140*****WRITE  OSZK2-REC.                                            D.980114
006150*****IF  ERR-STAT  NOT  =  "00"                                   D.980114
006160*****    MOVE  "JT-OSZK"  TO  ERR-F                               D.980114
006170*****    MOVE  "W"        TO  ERR-M                               D.980114
006180*****    PERFORM  ERR-RTN  THRU  ERR-EX.                          D.980114
006190***  CALL  "CBLTCLS"  USING  JT-OSZK.                             D 911022
006200*WW2-EX.                                                          D.980114
006210*****EXIT.                                                        D.980114
006220*--------------------------------------------------------------*
006230*WW3-RTN.                                                         D.980114
006240*****INITIALIZE  OSZK3-REC.                                       D.980114
006250*****MOVE  KOLRF3-REC  TO  OSZK3-REC.                             D.980114
006260*****WRITE  OSZK3-REC.                                            D.980114
006270*****IF  ERR-STAT  NOT  =  "00"                                   D.980114
006280*****    MOVE  "JT-OSZK"  TO  ERR-F                               D.980114
006290*****    MOVE  "W"        TO  ERR-M                               D.980114
006300*****    PERFORM  ERR-RTN  THRU  ERR-EX.                          D.980114
006310***  CALL  "CBLTCLS"  USING  JT-OSZK.                             D 911022
006320*WW3-EX.                                                          D.980114
006330*****EXIT.                                                        D.980114
006340*--------------------------------------------------------------*
006350*WW12-RTN.                                                        D.980114
006360*****INITIALIZE  OSZK12-REC.                                      D.980114
006370*****MOVE  KOLRF12-REC  TO  OSZK12-REC.                           D.980114
006380*****WRITE  OSZK12-REC.                                           D.980114
006390*****IF  ERR-STAT  NOT  =  "00"                                   D.980114
006400*****    MOVE  "JT-OSZK"  TO  ERR-F                               D.980114
006410*****    MOVE  "W"        TO  ERR-M                               D.980114
006420*****    PERFORM  ERR-RTN  THRU  ERR-EX.                          D.980114
006430***  CALL  "CBLTCLS"  USING  JT-OSZK.                             D 911022
006440*WW12-EX.                                                         D.980114
006450*****EXIT.                                                        D.980114
006460*--------------------------------------------------------------*
006470 REW1-RTN.
006480     MOVE  KOLRF1-04   TO  JCON2-03.
006490     REWRITE  JCON1-R    INVALID  KEY
006500                       MOVE  "JCON"       TO    ERR-F
006510                       MOVE  "R"          TO    ERR-M
006520                       MOVE   JCON1-KEY   TO    ERR-K
006530                       MOVE   0           TO    ERR-LIN
006540                       PERFORM  ERR-RTN   THRU  ERR-EX
006550                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006560                       MOVE  255    TO    COMPLETION-CODE
006570                       STOP  RUN.
006580 REW1-RTN-EXIT.
006590     EXIT.
006600*--------------------------------------------------------------*
006610 REW2-RTN.
006620     MOVE  KOLRF2-04   TO  TC-NAME.
006630     MOVE  KOLRF2-05   TO  TC-JSU.
006640     MOVE  KOLRF2-06   TO  TC-JSS.
006650     MOVE  KOLRF2-07   TO  TC-UNO.
006660     MOVE  KOLRF2-08   TO  TC-TEL.
006670     MOVE  KOLRF2-09   TO  TC-FKC.
006680     MOVE  KOLRF2-10   TO  TC-UCD.
006690     REWRITE   TC-R    INVALID  KEY
006700                       MOVE  "TC-M"       TO    ERR-F
006710                       MOVE  "R"          TO    ERR-M
006720                       MOVE   TC-KEY      TO    ERR-K
006730                       MOVE   0           TO    ERR-LIN
006740                       PERFORM  ERR-RTN   THRU  ERR-EX
006750                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006760                       MOVE  255    TO    COMPLETION-CODE
006770                       STOP  RUN.
006780 REW2-RTN-EXIT.
006790     EXIT.
006800*--------------------------------------------------------------*
006810 REW3-RTN.
006820     MOVE  KOLRF3-03   TO  SHM-02.
006830     MOVE  KOLRF3-04   TO  SHM-03.
006840     MOVE  KOLRF3-06   TO  SHM-05.
006850     MOVE  KOLRF3-07   TO  SHM-06.
006860     MOVE  KOLRF3-08   TO  SHM-07.
006870     MOVE  KOLRF3-11   TO  SHM-09.                                I.970130
006880     PERFORM  MV31-RTN  THRU  MV31-RTN-EXIT
006890         VARYING  NN  FROM  1  BY  1  UNTIL  NN  >  10.
006900     REWRITE   SHM-R   INVALID  KEY
006910                       MOVE  "SHM"        TO    ERR-F
006920                       MOVE  "R"          TO    ERR-M
006930                       MOVE   SHM-KEY     TO    ERR-K
006940                       MOVE   0           TO    ERR-LIN
006950                       PERFORM  ERR-RTN   THRU  ERR-EX
006960                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
006970                       MOVE  255    TO    COMPLETION-CODE
006980                       STOP  RUN.
006990 REW3-RTN-EXIT.
007000     EXIT.
007010*--------------------------------------------------------------*
007020 DLT2-RTN.
007030     DELETE   TC-M     INVALID  KEY
007040                       MOVE  "TC-M"       TO    ERR-F
007050                       MOVE  "D"          TO    ERR-M
007060                       MOVE   TC-KEY      TO    ERR-K
007070                       MOVE   0           TO    ERR-LIN
007080                       PERFORM  ERR-RTN   THRU  ERR-EX
007090                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007100                       MOVE  255    TO    COMPLETION-CODE
007110                       STOP  RUN.
007120 DLT2-RTN-EXIT.
007130     EXIT.
007140*--------------------------------------------------------------*
007150 DLT3-RTN.
007160     DELETE   SHM      INVALID  KEY
007170                       MOVE  "SHM"        TO    ERR-F
007180                       MOVE  "D"          TO    ERR-M
007190                       MOVE   SHM-KEY     TO    ERR-K
007200                       MOVE   0           TO    ERR-LIN
007210                       PERFORM  ERR-RTN   THRU  ERR-EX
007220                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007230                       MOVE  255    TO    COMPLETION-CODE
007240                       STOP  RUN.
007250 DLT3-RTN-EXIT.
007260     EXIT.
007270*--------------------------------------------------------------*
007280 MV31-RTN.
007290     MOVE  KOLRF3-0511(NN)  TO  SHM-0411(NN).
007300     MOVE  KOLRF3-0521(NN)  TO  SHM-0421(NN).
007310     MOVE  KOLRF3-0531(NN)  TO  SHM-0431(NN).
007320     MOVE  KOLRF3-0541(NN)  TO  SHM-0441(NN).
007330     MOVE  KOLRF3-0911(NN)  TO  SHM-0811(NN).
007340     MOVE  KOLRF3-0921(NN)  TO  SHM-0821(NN).
007350     MOVE  KOLRF3-0931(NN)  TO  SHM-0831(NN).
007360     MOVE  KOLRF3-0941(NN)  TO  SHM-0841(NN).
007370 MV31-RTN-EXIT.
007380     EXIT.
007390*--------------------------------------------------------------*
007400 MV51-RTN.
007410     MOVE  KOLRF121-091(NN)  TO  JNIF1-091(NN).
007420 MV51-RTN-EXIT.
007430     EXIT.
007440 MV51-RTN2.
007450     MOVE  KOLRF121-291(NN)  TO  JNIF1-091(NN).
007460 MV51-RTN2-EXIT.
007470     EXIT.
007480*--------------------------------------------------------------*
007490*    E N D R  -  R T N                                         *
007500*--------------------------------------------------------------*
007510 ENDR-RTN.
007520     OPEN   I-O    JOJF.
007530     MOVE   2      TO   JOJF-01.
007540     READ   JOJF        INVALID  KEY
007550                        GO TO ENDR-100.
007560     INITIALIZE  JOJF-REC.
007570     MOVE   2    TO     JOJF-01.
007580     REWRITE  JOJF-REC  INVALID  KEY
007590                       MOVE  "JOJF"       TO    ERR-F
007600                       MOVE  "R"          TO    ERR-M
007610                       MOVE   JOJF-KEY    TO    ERR-K
007620                       MOVE   0           TO    ERR-LIN
007630                       PERFORM  ERR-RTN   THRU  ERR-EX
007640                       PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007650                       MOVE  255    TO    COMPLETION-CODE
007660                       STOP  RUN.
007670 ENDR-100.
007680     CLOSE         JOJF.
007690     OPEN  OUTPUT  KOLRF.
007700     CLOSE         KOLRF.
007710*
007720 ENDR-RTN-EXIT.
007730     EXIT.
007740*--------------------------------------------------------------*
007750*    O P E N  -  R T N                                         *
007760*--------------------------------------------------------------*
007770 OPEN-RTN.
007780     OPEN   INPUT  KOLRF
007790            I-O    JCON  TC-M  SHM  JSTR  OKJF  JNIF
007800            EXTEND  JT-OMSD.                                      I.980114
007810*****       EXTEND  JT-OSZK.                                      D.980114
007820 OPEN-RTN-EXIT.
007830     EXIT.
007840*--------------------------------------------------------------*
007850*    C L S E  -  R T N                                         *
007860*--------------------------------------------------------------*
007870 CLSE-RTN.
007880     CLOSE  KOLRF  JCON  TC-M  SHM  JSTR  JT-OMSD  OKJF  JNIF.    I.980123
007890     CLOSE  GDMM.                                                 I.980317
007900*****CLOSE  KOLRF  JCON  TC-M  SHM  JSTR  JT-OSZK  OKJF  JNIF.    D.980114
007910 CLSE-RTN-EXIT.
007920     EXIT.
007930*--------------------------------------------------------------*
007940     COPY    LPERR.                                               R.900411
