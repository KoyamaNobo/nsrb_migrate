000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JTN05I.
000030************************************************************
000040*    PROGRAM         :  統一伝票入力（トラスコ他ＦＡＸ分） *
000050*    PRINTER TYPE    :  JIPS                               *
000060*    SCREEN          :  SJN05I                             *
000070*    COMPILE TYPE    :  COBOL                              *
000080************************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT TDIF ASSIGN TO TDI-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE DYNAMIC
000180         RECORD KEY TDI-KEY
000190         FILE STATUS IS ERR-STAT.
000200     SELECT JCON ASSIGN TO JCON-MSD
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY JCON1-KEY
000240         FILE STATUS IS ERR-STAT.
000250     SELECT TC-M ASSIGN TO TC-MSD
000260         ORGANIZATION INDEXED
000270         ACCESS MODE RANDOM
000280         RECORD KEY TC-KEY
000290         FILE STATUS IS ERR-STAT.
000300     SELECT HI2-M ASSIGN TO HI2-MSD
000310         ORGANIZATION INDEXED
000320         ACCESS MODE RANDOM
000330         RECORD KEY HI-KEY2
000340         FILE STATUS IS ERR-STAT.
000350     SELECT WTNAF ASSIGN TO WTNA-MSD
000360         ORGANIZATION INDEXED
000370         ACCESS MODE RANDOM
000380         RECORD KEY WTNA-KEY
000390         FILE STATUS IS ERR-STAT.
000400     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD
000410         ORGANIZATION INDEXED
000420         ACCESS MODE DYNAMIC
000430         RECORD KEY THT-KEY
000440         ALTERNATE RECORD KEY THT-KEY2
000450         FILE STATUS IS ERR-STAT.
000460     SELECT JMSTD ASSIGN TO JMSTD1-MSD JMSTD2-MSD JMSTD3-MSD
000470         ORGANIZATION INDEXED
000480         ACCESS MODE DYNAMIC
000490         RECORD KEY JMSTD-KEY1
000500         ALTERNATE RECORD KEY JMSTD-KEY2
000510         ALTERNATE RECORD KEY JMSTD-KEY3
000520         FILE STATUS IS ERR-STAT.
000530     SELECT JT-RUIJ ASSIGN TO RUIJ-MSD
000540         ORGANIZATION INDEXED
000550         ACCESS MODE RANDOM
000560         RECORD KEY RUIJ-KEY
000570         FILE STATUS IS ERR-STAT.
000580     SELECT NJZAI ASSIGN TO NJZAI-MSD
000590         ORGANIZATION INDEXED
000600         ACCESS MODE DYNAMIC
000610         RECORD KEY NJZAI-KEY
000620         FILE STATUS IS ERR-STAT.
000630     SELECT CODEF ASSIGN TO CODEF-RDB
000640         FILE STATUS IS ERR-STAT.
000650     SELECT SP-F ASSIGN TO P-PRN999.
000660 I-O-CONTROL.
000670     APPLY SHARED-MODE ON TDIF
000680     APPLY SHARED-MODE ON JCON
000690     APPLY SHARED-MODE ON NJZAI
000700     APPLY SHARED-MODE ON JMSTD
000710     APPLY SHARED-MODE ON JT-RUIJ
000720     APPLY SHARED-MODE ON THTM
000730     APPLY SHARED-MODE ON WTNAF
000740     APPLY SHARED-MODE ON CODEF
000750     APPLY SHARED-MODE ON TC-M
000760     APPLY SHARED-MODE ON HI2-M
000770     APPLY SHIFT-CODE  ON SP-F.
000780 DATA DIVISION.
000790 FILE SECTION.
000800     COPY L-TDIF.
000810     COPY L-JCON.
000820     COPY LIDTHT.
000830     COPY LITCM.
000840     COPY LWTNAF.
000850     COPY LIHIM2.
000860     COPY LJMSTD.
000870     COPY LTRUIJ.
000880     COPY LNJZAI.
000890     COPY LRCODE.
000900     COPY LSPF.
000910 WORKING-STORAGE  SECTION.
000920 77  ERR-STAT           PIC  X(002).
000930 77  W-FILE             PIC  X(013).
000940 77  W-END              PIC  9(001) VALUE 0.
000950 01  W-DATEA.                                                     I.110622
000960     02  W-NNGP         PIC  9(006).                              I.110622
000970     02  W-TIMED        PIC  9(008).                              I.110622
000980     02  W-TIMEW REDEFINES W-TIMED.                               I.110622
000990       03  W-TIME       PIC  9(006).                              I.110622
001000       03  F            PIC  9(002).                              I.110622
001010 01  HEAD1.
001020     02  F              PIC  X(005) VALUE ""3FE04FE080"".
001030     02  H-FNGP         PIC  99/99/99.
001040     02  F              PIC  X(004) VALUE " ～ ".
001050     02  H-TNGP         PIC  99/99/99.
001060     02  F              PIC  X(024) VALUE SPACE.
001070     02  F              PIC  N(020) VALUE
001080          NC"＊＊＊　　統一伝票　入力リスト　　＊＊＊".
001090     02  F              PIC  X(029) VALUE SPACE.
001100     02  F              PIC  X(005) VALUE "DATE ".
001110     02  H-DATE         PIC 99B99B99.
001120     02  F              PIC  X(007) VALUE "     P.".
001130     02  H-PAGE         PIC ZZ9.
001140 01  HEAD2.
001150     02  F              PIC  X(005) VALUE ""3FE04F40A0"".
001160     02  F              PIC  N(004) VALUE NC"　伝票№".
001170     02  F              PIC  X(003) VALUE SPACE.
001180     02  F              PIC  N(004) VALUE NC"日　　付".
001190     02  F              PIC  X(007) VALUE "  ｺｰﾄﾞ ".
001200     02  F              PIC  N(008) VALUE NC"得　意　先　名　".
001210     02  F              PIC  X(028) VALUE SPACE.
001220     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".
001230     02  F              PIC  N(014) VALUE
001240          NC"直　送　先　名　・　店　名　".
001250     02  F              PIC  X(019) VALUE SPACE.
001260     02  F              PIC  N(004) VALUE NC"倉　庫　".
001270     02  F              PIC  X(004) VALUE SPACE.
001280     02  F              PIC  N(004) VALUE NC"運　送　".
001290     02  F              PIC  X(004) VALUE SPACE.
001300     02  F              PIC  N(004) VALUE NC"発注№　".
001310     02  F              PIC  X(004) VALUE SPACE.
001320 01  HEAD3.
001330     02  F              PIC  X(006) VALUE SPACE.
001340     02  F              PIC  X(001) VALUE "-".
001350     02  F              PIC  N(002) VALUE NC"行　".
001360     02  F              PIC  X(007) VALUE SPACE.
001370     02  F              PIC  N(004) VALUE NC"　受注№".
001380     02  F              PIC  X(001) VALUE "-".
001390     02  F              PIC  N(002) VALUE NC"行　".
001400     02  F              PIC  X(006) VALUE "ｺｰﾄﾞ  ".
001410     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
001420     02  F              PIC  X(025) VALUE SPACE.
001430     02  F              PIC  X(006) VALUE "ｻｲｽﾞ  ".
001440     02  F              PIC  N(002) VALUE NC"名称".
001450     02  F              PIC  X(006) VALUE "(ﾄﾗｽｺ)".
001460     02  F              PIC  X(014) VALUE SPACE.
001470     02  F              PIC  N(002) VALUE NC"数量".
001480     02  F              PIC  X(001) VALUE SPACE.
001490     02  F              PIC  N(004) VALUE NC"　原単価".
001500     02  F              PIC  X(004) VALUE SPACE.
001510     02  F              PIC  N(004) VALUE NC"原価金額".
001520     02  F              PIC  X(001) VALUE SPACE.
001530     02  F              PIC  N(004) VALUE NC"　売単価".
001540     02  F              PIC  X(004) VALUE SPACE.
001550     02  F              PIC  N(004) VALUE NC"売価金額".
001560 01  W-P1.
001570     02  P-DNO          PIC  9(006).
001580     02  F              PIC  X(002).
001590     02  P-DATE         PIC  99/99/99.
001600     02  F              PIC  X(001).
001610     02  P-TCD          PIC  9(004).
001620     02  F              PIC  X(001).
001630     02  P-TNA          PIC  N(026).
001640     02  F              PIC  X(001).
001650     02  P-TPC          PIC  9(004).                              I.100921
001660     02  P-CCDD  REDEFINES P-TPC.                                 I.100921
001670       03  P-CCD        PIC  9(003).                              I.100921
001680       03  F            PIC  X(001).                              I.100921
001690*****02  P-CCD          PIC  9(003).                              D.100921
001700*****02  F              PIC  X(001).                              D.100921
001710     02  P-CNA          PIC  N(026).
001720     02  F              PIC  X(001).
001730     02  P-SNA          PIC  N(006).
001740     02  F              PIC  X(001).
001750     02  P-UNA          PIC  N(006).
001760     02  F              PIC  X(001).
001770     02  P-HNO          PIC  X(010).
001780 01  W-P2.
001790     02  F              PIC  X(006).
001800     02  P-V1           PIC  X(001).
001810     02  P-GNO          PIC  9.
001820     02  F              PIC  X(009).
001830     02  P-JNO          PIC  9(006).
001840     02  P-V2           PIC  X(001).
001850     02  P-JGN          PIC  9.
001860     02  F              PIC  X(001).
001870     02  P-HCD          PIC  9(006).
001880     02  F              PIC  X(001).
001890     02  P-HNA          PIC  N(024).
001900     02  F              PIC  X(001).
001910     02  P-SIZ          PIC  X(004).
001920     02  F              PIC  X(002).
001930     02  P-TMS          PIC  X(020).
001940     02  P-SU           PIC ------.
001950     02  P-GT           PIC ZZZ,ZZZ.
001960     02  P-GKIN         PIC --,---,---.
001970     02  P-UT           PIC ZZZ,ZZZ.
001980     02  P-UKIN         PIC --,---,---.
001990 01  W-P3.
002000     02  F              PIC  X(037) VALUE SPACE.
002010     02  F              PIC  N(002) VALUE NC"配達".
002020     02  F              PIC  X(001) VALUE ":".
002030     02  P-THT          PIC  N(010).
002040     02  F              PIC  N(002) VALUE NC"摘要".
002050     02  F              PIC  X(001) VALUE ":".
002060     02  P-TTE          PIC  N(020).
002070     02  F              PIC  X(002).
002080     02  F              PIC  N(002) VALUE NC"合計".
002090     02  F              PIC  X(001) VALUE ":".
002100     02  P-TSU          PIC ------.
002110     02  F              PIC  X(007).
002120     02  P-TGKIN        PIC --,---,---.
002130     02  F              PIC  X(007).
002140     02  P-TUKIN        PIC --,---,---.
002150 01  W-DATA.
002160     02  W-CRT.
002170       03  W-ACT        PIC  9(001).
002180       03  W-JCN        PIC  9(006).                              I.060804
002190       03  W-DNO        PIC  9(006).
002200       03  W-TCD        PIC  9(004).
002210       03  W-CCD        PIC  9(003).
002220*****  03  W-TPC        PIC  9(003).                              D.100921
002230       03  W-TPC        PIC  9(004).                              I.100921
002240       03  W-DATE       PIC  9(006).
002250       03  W-NGPD REDEFINES W-DATE.
002260         04  W-NEN      PIC  9(002).
002270         04  W-GET      PIC  9(002).
002280         04  W-PEY      PIC  9(002).
002290       03  W-HNO        PIC  X(010).
002300       03  W-SOK        PIC  9(001).
002310       03  W-UNS        PIC  9(001).
002320       03  W-TEKI       PIC  N(028).
002330       03  W-TEKD  REDEFINES W-TEKI.
002340         04  W-THT      PIC  N(009).
002350         04  W-TTE      PIC  N(019).
002360         04  W-TTED  REDEFINES W-TTE.                             I.170728
002370           05  W-TTE1   PIC  N(012).                              I.170728
002380           05  W-TTE2   PIC  N(007).                              I.170728
002390       03  W-PRC        PIC  9(001).
002400       03  W-UPC        PIC  9(001).
002410       03  W-MEI.
002420         04  W-MEID  OCCURS    6.
002430           05  W-JNOD.
002440             06  W-JNO  PIC  9(006).
002450             06  W-JGN  PIC  9(001).
002460           05  W-HCD    PIC  9(006).
002470           05  W-SZN    PIC  X(003).
002480           05  W-SKB    PIC  9(001).
002490           05  W-SNO    PIC  9(002).
002500           05  W-SU     PIC S9(005).
002510           05  W-GT     PIC  9(007).
002520           05  W-UT     PIC  9(007).
002530           05  W-GKIN   PIC S9(008).
002540           05  W-UKIN   PIC S9(008).
002550           05  W-ISU    PIC  9(003).
002560           05  W-TRN    PIC  X(020).
002570           05  W-JAN    PIC  X(013).                              I.100921
002580*****      05  W-TRND  REDEFINES W-TRN.                           D.100921
002590*****        06  W-JAN  PIC  X(013).                              D.100921
002600*****        06  W-JANS PIC  X(007).                              D.100921
002610       03  W-DMM        PIC  9(001).
002620       03  W-SEN        PIC  9(001).
002630       03  W-FNGP       PIC  9(006).
002640       03  W-FNGPD REDEFINES W-FNGP.
002650         04  W-FNEN     PIC  9(002).
002660         04  W-FGET     PIC  9(002).
002670         04  W-FPEY     PIC  9(002).
002680*****  03  W-TNGP       PIC  9(006).                              D.151106
002690       03  W-TNGP       PIC  9(006) VALUE 999999.                 I.151106
002700       03  W-TNGPD REDEFINES W-TNGP.
002710         04  W-TNEN     PIC  9(002).
002720         04  W-TGET     PIC  9(002).
002730         04  W-TPEY     PIC  9(002).
002740       03  W-DNOF       PIC  9(006).
002750       03  W-DNOT       PIC  9(006) VALUE 999999.                 I.151106
002760*****  03  W-DNOT       PIC  9(006).                              D.151106
002770*
002780     02  W-PAGE         PIC  9(003).
002790     02  W-SNGP         PIC  9(006).
002800     02  W-ENGP         PIC  9(006).
002810     02  W-NGP          PIC  9(006).
002820     02  W-INV          PIC  9(001).
002830     02  W-LC1          PIC  9(002).
002840     02  W-LC2          PIC  9(002).
002850     02  W-GN           PIC  9(001).
002860     02  W-GND          PIC  9(001).
002870     02  W-DC           PIC  9(001).
002880     02  W-SUC          PIC  9(001).
002890*****02  W-MDNO         PIC  9(006).                              D.091202
002900     02  W-FHCD         PIC  9(006).
002910     02  W-TNA          PIC  N(026).
002920     02  W-SNA          PIC  N(006).
002930     02  W-UNA          PIC  N(006).
002940     02  W-SIZM         PIC  X(003).
002950     02  W-SIZN         PIC  X(004).
002960     02  WT-D.
002970       03  WT-SU        PIC  9(006).
002980       03  WT-GKIN      PIC  9(009).
002990       03  WT-UKIN      PIC  9(009).
003000     02  CNT            PIC  9(002).
003010     02  W-UCHK         PIC  9(001).                              I.110907
003020     02  W-SCC          PIC  9(001).
003030     02  W-SC           PIC  9(001).
003040     02  W-C            PIC  9(002).
003050     02  W-ASZD.
003060       03  W-ASZ   OCCURS   5.
003070         04  W-SZD   OCCURS  10.
003080           05  W-SZ     PIC  X(003).
003090     02  W-MSZ.
003100       03  F            PIC  X(030) VALUE
003110            "000   SS S  M  L  LL XL XXL   ".
003120       03  F            PIC  X(030) VALUE
003130            "                     280290300".
003140       03  F            PIC  X(030) VALUE
003150            "125130135140150160170180190200".
003160       03  F            PIC  X(030) VALUE
003170            "210215220225230235240245250   ".
003180       03  F            PIC  X(030) VALUE
003190            "240245250255260265270275      ".
003200     02  W-ASIZD.
003210       03  W-ASIZ  OCCURS   5.
003220         04  W-SIZD  OCCURS  10.
003230           05  W-SIZ    PIC  X(004).
003240     02  W-MSIZ.
003250       03  F            PIC  X(040) VALUE
003260            "----      SS   S   M   L  LL  XL XXL    ".
003270       03  F            PIC  X(040) VALUE
003280            "                            28.029.030.0".
003290       03  F            PIC  X(040) VALUE
003300            "12.513.013.514.015.016.017.018.019.020.0".
003310       03  F            PIC  X(040) VALUE
003320            "21.021.522.022.523.023.524.024.525.0    ".
003330       03  F            PIC  X(040) VALUE
003340            "24.024.525.025.526.026.527.027.5    ----".
003350     02  W-ATYD.                                                  I.080604
003360       03  W-TYD   OCCURS  56.                                    I.080604
003370         04  W-TY       PIC  X(001).                              I.080604
003380     COPY LSTAT.
003390 SCREEN SECTION.
003400 SD  C-CRT
003410     END STATUS IS ESTAT.
003420 01  C-CLEAR.
003430     02  C-CL    LINE   1  CLEAR SCREEN.
003440 01  C-ACP.
003450     02  A-ACT   LINE   2  COLUMN  53  PIC  9(001)
003460          USING W-ACT   CHECK OVERFLOW NO IFC.
003470*****02  A-TCD   LINE   3  COLUMN  08  PIC  9(004)                D.080604
003480     02  LINE   3.                                                I.080604
003490       03  A-TCD   COLUMN  08  PIC  9(004)                        I.080604
003500            USING W-TCD   CHECK OVERFLOW NO IFC.
003510       03  A-JCN   COLUMN  75  PIC  9(006)                        I.080604
003520            USING W-JCN   CHECK OVERFLOW NO IFC.                  I.080604
003530     02  LINE   4.
003540*****  03  A-TPC   COLUMN  09  PIC  9(003)                        D.100921
003550       03  A-TPC   COLUMN  08  PIC  9(004)                        I.100921
003560            USING W-TPC   CHECK OVERFLOW NO IFC.
003570       03  A-DNO   COLUMN  75  PIC  9(006)
003580            USING W-DNO   CHECK OVERFLOW NO IFC.
003590     02  LINE   5.
003600       03  A-CCD   COLUMN  09  PIC  9(003)
003610            USING W-CCD   CHECK OVERFLOW NO IFC.
003620       03  A-DATE  COLUMN  75  PIC  9(006)
003630            USING W-DATE  CHECK OVERFLOW NO IFC.
003640     02  LINE   6.
003650       03  A-HNO   COLUMN  08  PIC  X(010)
003660            USING W-HNO   CHECK OVERFLOW NO IFC.
003670       03  A-SOK   COLUMN  24  PIC  9(001)
003680            USING W-SOK   CHECK OVERFLOW NO IFC.
003690       03  A-UNS   COLUMN  44  PIC  9(001)
003700            USING W-UNS   CHECK OVERFLOW NO IFC.
003710     02  A-HM    LINE  W-LC1.
003720       03  A-JNO   COLUMN   1  PIC  9(006)
003730            USING  W-JNO(W-GN) CHECK OVERFLOW NO IFC.
003740       03  A-JGN   COLUMN   8  PIC  9(001)
003750            USING  W-JGN(W-GN) CHECK OVERFLOW NO IFC.
003760       03  A-SZN   COLUMN  60  PIC  X(003)
003770            USING  W-SZN(W-GN) CHECK OVERFLOW NO IFC.
003780     02  LINE  W-LC2.
003790       03  A-HCD   COLUMN   2  PIC  9(006)
003800            USING  W-HCD(W-GN) CHECK OVERFLOW NO IFC.
003810       03  A-SU    COLUMN  38  PIC  9(005)
003820            USING  W-SU(W-GN)  CHECK OVERFLOW NO IFC.
003830       03  A-GT    COLUMN  44  PIC  9(007)
003840            USING  W-GT(W-GN)  CHECK OVERFLOW NO IFC.
003850       03  A-GKIN  COLUMN  52  PIC  9(008)
003860            USING  W-GKIN(W-GN) CHECK OVERFLOW NO IFC.
003870       03  A-UT    COLUMN  63  PIC  9(007)
003880            USING  W-UT(W-GN)  CHECK OVERFLOW NO IFC.
003890     02  LINE  22.
003900       03  A-THT   COLUMN  06  PIC  N(009)
003910            USING W-THT   CHECK OVERFLOW NO IFC.
003920       03  A-TTE   COLUMN  30  PIC  N(019)
003930            USING W-TTE   CHECK OVERFLOW NO IFC.
003940*
003950     02  A-SEN   LINE   8  COLUMN  43  PIC  9(001)
003960          USING W-SEN   CHECK OVERFLOW NO IFC.
003970     02  LINE  11.
003980       03  A-FNEN  COLUMN  26  PIC  9(002)
003990            USING W-FNEN  CHECK OVERFLOW NO IFC.
004000       03  A-FGET  COLUMN  30  PIC  9(002)
004010            USING W-FGET  CHECK OVERFLOW NO IFC.
004020       03  A-FPEY  COLUMN  34  PIC  9(002)
004030            USING W-FPEY  CHECK OVERFLOW NO IFC.
004040       03  A-TNEN  COLUMN  44  PIC  9(002)
004050            USING W-TNEN  CHECK OVERFLOW NO IFC.
004060       03  A-TGET  COLUMN  48  PIC  9(002)
004070            USING W-TGET  CHECK OVERFLOW NO IFC.
004080       03  A-TPEY  COLUMN  52  PIC  9(002)
004090            USING W-TPEY  CHECK OVERFLOW NO IFC.
004100     02  LINE  13.
004110       03  A-DNOF  COLUMN  36  PIC  9(006)
004120            USING W-DNOF  CHECK OVERFLOW NO IFC.
004130       03  A-DNOT  COLUMN  46  PIC  9(006)
004140            USING W-DNOT  CHECK OVERFLOW NO IFC.
004150*
004160     02  A-DMM   LINE  23  COLUMN  65  PIC  9(001)
004170          USING W-DMM   CHECK OVERFLOW NO IFC.
004180 01  C-DSP.
004190*****02  D-TNA   LINE   3  COLUMN  13  PIC  N(026) FROM  W-TNA.   D.080604
004200     02  LINE   3.                                                I.080604
004210       03  D-TNA   COLUMN  13  PIC  N(026) FROM  W-TNA.           I.080604
004220       03  D-JCNC  COLUMN  75  PIC  X(006) VALUE "      ".        I.080604
004230     02  LINE   4.
004240       03  D-MNA   COLUMN  13  PIC  N(026) FROM  WTNA-NAME.
004250       03  D-TPCC.
004260*****    04  COLUMN   9  PIC  X(040) VALUE                        D.100921
004270*****         "                                        ".         D.100921
004280         04  COLUMN   8  PIC  X(041) VALUE                        I.100921
004290              "                                         ".        I.100921
004300         04  COLUMN  49  PIC  X(016) VALUE
004310              "                ".
004320       03  D-DNOC  COLUMN  75  PIC  X(006) VALUE "      ".        I.080604
004330     02  LINE   5.
004340       03  D-CNA   COLUMN  13  PIC  N(026) FROM  TC-NAME.
004350       03  D-CNAC.
004360         04  COLUMN  13  PIC  X(040) VALUE
004370              "                                        ".
004380         04  COLUMN  53  PIC  X(012) VALUE
004390              "            ".
004400     02  LINE   6.
004410       03  D-HNOC  COLUMN  08  PIC  X(010) VALUE "          ".
004420       03  D-SNA   COLUMN  26  PIC  N(006) FROM  W-SNA.
004430       03  D-UNA   COLUMN  46  PIC  N(006) FROM  W-UNA.
004440     02  LINE W-LC1.
004450       03  D-JNOC  COLUMN   1  PIC  X(008) VALUE "        ".
004460       03  D-JNOV  COLUMN   7  PIC  X(001) VALUE "-".
004470       03  D-HNA   COLUMN  10  PIC  N(024) FROM  HI-NAME.
004480       03  D-SIZD  COLUMN  64  PIC  X(004) FROM  W-SIZN.
004490     02  LINE W-LC2.
004500       03  D-TRN   COLUMN  13  PIC  X(020) FROM  W-TRN(W-GN).
004510       03  D-TRNC  COLUMN  13  PIC  X(020) VALUE
004520            "                    ".
004530     02  D-MEI   LINE W-LC2.
004540       03  D-SU    COLUMN  37  PIC -----9      FROM  W-SU(W-GN).
004550       03  D-GT    COLUMN  44  PIC ZZZZZZZ     FROM  W-GT(W-GN).
004560       03  D-GKIN  COLUMN  52  PIC --,---,---  FROM  W-GKIN(W-GN).
004570       03  D-UT    COLUMN  63  PIC ZZZZZZZ     FROM  W-UT(W-GN).
004580       03  D-UKIN  COLUMN  71  PIC --,---,---  FROM  W-UKIN(W-GN).
004590     02  D-KEI   LINE  21.
004600       03          COLUMN  37  PIC -----9      FROM  WT-SU.
004610       03          COLUMN  52  PIC --,---,---  FROM  WT-GKIN.
004620       03          COLUMN  71  PIC --,---,---  FROM  WT-UKIN.
004630*****02  D-DNOC  LINE   4  COLUMN  75  PIC  X(006) VALUE "      ".D.080604
004640     02  D-BDNO  LINE  23  COLUMN  75  PIC  9(006) FROM  W-DNO.   I.080513
004650     02  D-MEIC.
004660       03  LINE W-LC1.
004670         04  COLUMN   1  PIC  X(040) VALUE
004680              "                                        ".
004690         04  COLUMN  41  PIC  X(040) VALUE
004700              "                                        ".
004710       03  LINE W-LC2.
004720         04  COLUMN   1  PIC  X(040) VALUE
004730              "                                        ".
004740         04  COLUMN  41  PIC  X(040) VALUE
004750              "                                        ".
004760     02  D-PRM.
004770       03  LINE   1  COLUMN  16  PIC  N(024) VALUE
004780            NC"＊＊＊　　統一伝票入力　チェックリスト　　＊＊＊".
004790       03  LINE   6  COLUMN  26  PIC  X(012) VALUE
004800            "未印字分 = 1".
004810       03  LINE   8  COLUMN  26  PIC  X(018) VALUE
004820            "印字済分 = 2 ...  ".
004830       03  LINE  11  COLUMN  24  PIC  X(032) VALUE
004840            "’00年00月00日 ～ ’99年99月99日".
004850       03  LINE  23.
004860         04  COLUMN  43  PIC  N(002) VALUE NC"確認".
004870         04  COLUMN  47  PIC  X(023) VALUE
004880              "(OK=1,NO=9) --->   ﾘﾀｰﾝ".
004890     02  LINE  13.
004900       03  D-DNM   COLUMN  28  PIC  X(024) VALUE
004910            "伝票№  000000 ～ 999999".
004920       03  D-DNC   COLUMN  28  PIC  X(024) VALUE
004930            "                        ".
004940 01  C-ERR.
004950     02  LINE  24.
004960       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
004970            "***  DATA ﾅｼ  ***".
004980       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
004990            "***  DATA ｴﾗｰ  ***".
005000       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
005010            "***  ﾄｸｲｻｷ ﾅｼ  ***".
005020       03  E-ME4   COLUMN  15  PIC  X(018) VALUE
005030            "***  ﾁｮｸｿｳ ﾅｼ  ***".
005040       03  E-ME5   COLUMN  15  PIC  X(017) VALUE
005050            "***  ﾋﾝﾒｲ ﾅｼ  ***".
005060       03  E-ME6   COLUMN  15  PIC  X(017) VALUE
005070            "***  ｻｲｽﾞ ﾅｼ  ***".
005080       03  E-ME7   COLUMN  15  PIC  N(005) VALUE
005090            NC"キャンセル".
005100       03  E-ME8   COLUMN  15  PIC  X(018) VALUE
005110            "***  JCON ﾅｼ   ***".
005120       03  E-ME9   COLUMN  15  PIC  X(027) VALUE
005130            "***  JCON REWRITE ｴﾗｰ   ***".
005140       03  E-ME10  COLUMN  15  PIC  X(023) VALUE
005150            "***  TDIF DATA ｴﾗｰ  ***".
005160       03  E-ME11  COLUMN  15  PIC  X(024) VALUE
005170            "***  TDIF WRITE ｴﾗｰ  ***".
005180       03  E-ME12  COLUMN  15  PIC  X(026) VALUE
005190            "***  TDIF REWRITE ｴﾗｰ  ***".
005200       03  E-ME13  COLUMN  15  PIC  X(025) VALUE
005210            "***  TDIF DELETE ｴﾗｰ  ***".
005220       03  E-ME14  COLUMN  15  PIC  X(018) VALUE
005230            "***  JMSTD ﾅｼ  ***".
005240       03  E-ME15  COLUMN  15  PIC  X(019) VALUE
005250            "***  ｱｽﾞｶﾘ ｴﾗｰ  ***".
005260       03  E-ME16  COLUMN  15  PIC  X(018) VALUE
005270            "***  ﾋﾝﾒｲ ｴﾗｰ  ***".
005280       03  E-ME17  COLUMN  15  PIC  X(022) VALUE
005290            "***  ﾄﾗｽｺ ﾋﾝﾒｲ ﾅｼ  ***".
005300       03  E-ME18  COLUMN  15  PIC  X(022) VALUE
005310            "***  ｻｲｽﾞｸﾌﾞﾝ ｴﾗｰ  ***".
005320       03  E-ME19  COLUMN  15  PIC  X(021) VALUE
005330            "***  ﾁｮｸｿｳｻｷ ｴﾗｰ  ***".
005340       03  E-ME20  COLUMN  15  PIC  X(019) VALUE
005350            "***  ﾄｸｲｻｷ ｴﾗｰ  ***".
005360       03  E-ME21  COLUMN  15  PIC  X(026) VALUE
005370            "***  ｺｳｼﾝｽﾞﾐ ｼｭｳｾｲ ﾌｶ  ***".
005380       03  E-ME22  COLUMN  15  PIC  X(018) VALUE
005390            "***  NJZAI ﾅｼ  ***".
005400       03  E-ME23  COLUMN  15  PIC  X(019) VALUE
005410            "***  ﾀﾝｶ ﾐﾄｳﾛｸ  ***".
005420       03  E-ME24  COLUMN  15  PIC  X(019) VALUE
005430            "***  ｽｳﾘｮｳ ｴﾗｰ  ***".
005440       03  E-ME25  COLUMN  15  PIC  X(027) VALUE
005450            "***  JMSTD REWRITE ｴﾗｰ  ***".
005460       03  E-ME26  COLUMN  15  PIC  X(027) VALUE
005470            "***  NJZAI REWRITE ｴﾗｰ  ***".
005480       03  E-ME27  COLUMN  15  PIC  X(025) VALUE
005490            "***  NJZAI WRITE ｴﾗｰ  ***".
005500       03  E-ME28  COLUMN  15  PIC  X(022) VALUE                  I.080604
005510            "***  ｼﾞｭﾁｭｳNO ｴﾗｰ  ***".                             I.080604
005520       03  E-ME29  COLUMN  15  PIC  X(020) VALUE                  I.080605
005530            "***  JANｺｰﾄﾞ ﾅｼ  ***".                               I.080605
005540       03  E-ME30  COLUMN  15  PIC  X(018) VALUE                  I.100511
005550            "***  ﾀﾝｶ ﾁｪｯｸ  ***".                                 I.100511
005560       03  E-KEY   COLUMN  45  PIC  X(007) FROM  TDI-KEY.
005570       03  E-NJZAI COLUMN  53  PIC  X(008) FROM  NJZAI-KEY.
005580       03  E-JMST  COLUMN  62  PIC  X(007) FROM  JMSTD-KEY1.
005590     COPY LSSEM.
005600 PROCEDURE DIVISION.
005610 M-020.
005620     DISPLAY C-CLEAR.
005630     CALL "SJN05I".
005640     MOVE ZERO TO W-CRT W-FHCD.
005650     MOVE SPACE TO W-TEKI W-TNA W-SNA W-UNA.
005660     DISPLAY A-THT A-TTE.
005670*
005680     OPEN I-O JCON.
005690*****MOVE "19" TO JCON1-KEY.                                      D.091202
005700*****READ JCON UNLOCK INVALID                                     D.091202
005710*****    CLOSE JCON                                               D.091202
005720*****    DISPLAY E-ME8 E-ME99                                     D.091202
005730*****    GO TO M-980.                                             D.091202
005740*****MOVE JCON1-03 TO W-MDNO.                                     D.091202
005750*
005760     OPEN I-O TDIF.
005770     OPEN INPUT TC-M HI2-M WTNAF THTM CODEF JT-RUIJ.
005780     OPEN I-O JMSTD NJZAI.
005790     MOVE W-MSZ TO W-ASZD.
005800     MOVE W-MSIZ TO W-ASIZD.
005810     ACCEPT W-NGP FROM DATE.
005820     MOVE W-NGP TO W-NNGP.                                        I.110622
005830     MOVE W-NGP TO W-DATE.
005840     SUBTRACT 1 FROM W-GET.
005850     IF W-GET = ZERO
005860         MOVE 12 TO W-GET
005870         SUBTRACT 1 FROM W-NEN.
005880     MOVE W-DATE TO W-SNGP.
005890     MOVE W-NGP TO W-DATE.
005900     ADD 1 TO W-GET.
005910     IF W-GET = 13
005920         MOVE 1 TO W-GET
005930         ADD 1 TO W-NEN.
005940     MOVE W-DATE TO W-ENGP.
005950 M-040.
005960     ACCEPT A-ACT.
005970     IF ESTAT = PF9
005980         GO TO M-420.
005990     IF ESTAT NOT = HTB AND SKP
006000         GO TO M-040.
006010     IF W-ACT = 9
006020         GO TO M-420.
006030     IF W-ACT NOT = 1 AND 2 AND 3
006040         GO TO M-040.
006050     IF W-ACT NOT = 1                                             I.080604
006060         MOVE ZERO TO W-JCN                                       I.080604
006070         DISPLAY D-JCNC                                           I.080604
006080         GO TO M-060.                                             I.080604
006090 M-050.                                                           I.080604
006100     ACCEPT A-JCN.                                                I.080604
006110     DISPLAY E-CL.                                                I.080604
006120     IF ESTAT = BTB                                               I.080604
006130         GO TO M-040.                                             I.080604
006140     IF ESTAT NOT = HTB AND SKP                                   I.080604
006150         GO TO M-050.                                             I.080604
006160     IF W-JCN = ZERO                                              I.080604
006170         DISPLAY D-JCNC                                           I.080604
006180         GO TO M-080.                                             I.080604
006190*
006200     MOVE SPACE TO JMSTD-KEY1.                                    I.080604
006210     MOVE W-JCN TO JMSTD-07.                                      I.080604
006220     START JMSTD KEY NOT < JMSTD-KEY1 INVALID KEY                 I.080604
006230         DISPLAY E-ME14 E-ME98                                    I.080604
006240         GO TO M-050.                                             I.080604
006250     READ JMSTD NEXT RECORD WITH UNLOCK AT END                    I.080604
006260         DISPLAY E-ME14 E-ME98                                    I.080604
006270         GO TO M-050.                                             I.080604
006280     IF W-JCN NOT = JMSTD-07                                      I.080604
006290         DISPLAY E-ME14 E-ME98                                    I.080604
006300         GO TO M-050.                                             I.080604
006310     IF JMSTD-01 NOT = 0 AND 6                                    I.080604
006320         DISPLAY E-ME28 E-ME98                                    I.080604
006330         GO TO M-050.                                             I.080604
006340*****IF JMSTD-04 NOT = 4990 AND 9850                              D.080605
006350*****IF JMSTD-04 NOT = 4990 AND 5000 AND 9850                     D.120203
006360*****IF JMSTD-04 NOT = 4990 AND 5000 AND 9850 AND 6010            D.141007
006370     IF JMSTD-04 NOT = 4990 AND 9850 AND 6010                     I.141007
006380         DISPLAY E-ME28 E-ME98                                    I.080604
006390         GO TO M-050.                                             I.080604
006400     PERFORM JCS-RTN THRU JCS-EX.                                 I.080604
006410     IF W-TCD NOT = 9850                                          I.080604
006420         MOVE ZERO TO W-TPC                                       I.080604
006430         DISPLAY D-TPCC                                           I.080604
006440         GO TO M-120.                                             I.080604
006450     DISPLAY D-DNOC.                                              I.080604
006460     GO TO M-100.                                                 I.080604
006470*****IF W-ACT = 1                                                 D.080604
006480*****    DISPLAY D-DNOC                                           D.080604
006490*****GO TO M-080.                                                 D.080604
006500 M-060.
006510     ACCEPT A-DNO.
006520     DISPLAY E-CL.
006530     IF ESTAT = BTB
006540         GO TO M-040.
006550     IF ESTAT NOT = HTB AND SKP
006560         GO TO M-060.
006570     IF W-DNO = ZERO
006580         GO TO M-060.
006590*
006600     PERFORM SET-RTN THRU SET-EX.
006610*
006620     IF W-INV NOT = 0
006630         GO TO M-060.
006640     IF W-UPC NOT = 0
006650         DISPLAY E-ME21 E-ME98
006660         GO TO M-060.
006670     IF W-ACT = 3
006680         GO TO M-340.
006690 M-080.
006700     ACCEPT A-TCD.
006710     DISPLAY E-CL.
006720     IF ESTAT = BTB
006730         IF W-ACT = 1
006740             GO TO M-050                                          I.080604
006750*****        GO TO M-040                                          D.080604
006760           ELSE
006770             GO TO M-060.
006780     IF ESTAT NOT = HTB AND SKP
006790         GO TO M-080.
006800*
006810*****IF W-TCD NOT = 4990 AND 9850                                 D.080605
006820*****IF W-TCD NOT = 4990 AND 5000 AND 9850                        D.120203
006830*****IF W-TCD NOT = 4990 AND 5000 AND 9850 AND 6010               D.141007
006840     IF W-TCD NOT = 4990 AND 9850 AND 6010                        I.141007
006850         GO TO M-080.
006860     MOVE W-TCD TO TC-TCD.
006870     MOVE 001 TO TC-CCD.
006880     READ TC-M WITH UNLOCK INVALID KEY
006890         DISPLAY E-ME3 E-ME98
006900         GO TO M-080.
006910     MOVE TC-NAME TO W-TNA.
006920     DISPLAY D-TNA.
006930     IF W-TCD NOT = 9850
006940         MOVE ZERO TO W-TPC
006950         DISPLAY D-TPCC
006960         GO TO M-120.
006970 M-100.
006980     ACCEPT A-TPC.
006990     DISPLAY E-CL.
007000     IF ESTAT = BTB
007010         IF W-JCN NOT = ZERO                                      I.080604
007020             GO TO M-050                                          I.080604
007030           ELSE                                                   I.080604
007040             GO TO M-080.
007050     IF ESTAT NOT = HTB AND SKP
007060         GO TO M-100.
007070     IF W-TPC = ZERO
007080         DISPLAY D-TPCC
007090         GO TO M-120.
007100*
007110     MOVE W-TPC TO WTNA-KEY.
007120     READ WTNAF WITH UNLOCK INVALID KEY
007130         DISPLAY E-ME4 E-ME98
007140         GO TO M-100.
007150     DISPLAY D-MNA.
007160     IF WTNA-OSN = 9                                              I.091215
007170         GO TO M-120.                                             I.091215
007180     IF WTNA-OSN = 0
007190         MOVE 002 TO W-CCD
007200       ELSE
007210         IF WTNA-OSN = 1
007220             MOVE 003 TO W-CCD
007230           ELSE
007240             MOVE 000 TO W-CCD.
007250     MOVE W-TCD TO TC-TCD.
007260     MOVE W-CCD TO TC-CCD.
007270     READ TC-M WITH UNLOCK INVALID KEY
007280         DISPLAY E-ME3 E-ME98
007290         GO TO M-100.
007300     DISPLAY A-CCD D-CNA.
007310     GO TO M-140.
007320 M-120.
007330     ACCEPT A-CCD.
007340     DISPLAY E-CL.
007350     IF ESTAT = BTB
007360         IF W-TCD = 9850
007370             GO TO M-100
007380           ELSE
007390             IF W-JCN NOT = ZERO                                  I.080604
007400                 GO TO M-050                                      I.080604
007410               ELSE                                               I.080604
007420                 GO TO M-080.
007430     IF ESTAT NOT = HTB AND SKP
007440         GO TO M-120.
007450     IF W-TCD NOT = 6010                                          I.120217
007460         IF W-CCD = 001
007470             GO TO M-120.
007480     IF W-TCD NOT = 6010                                          I.120217
007490         IF W-CCD = ZERO
007500             DISPLAY D-CNAC
007510             GO TO M-140.
007520     MOVE W-TCD TO TC-TCD.
007530     MOVE W-CCD TO TC-CCD.
007540     READ TC-M WITH UNLOCK INVALID KEY
007550         DISPLAY E-ME3 E-ME98
007560         GO TO M-120.
007570     DISPLAY D-CNA.
007580 M-140.
007590     ACCEPT A-DATE.
007600     DISPLAY E-CL.
007610     IF ESTAT = BTB
007620         GO TO M-120.
007630     IF ESTAT NOT = HTB AND SKP
007640         GO TO M-140.
007650     IF W-DATE = ZERO
007660         MOVE W-NGP TO W-DATE
007670         DISPLAY A-DATE.
007680     IF (W-NEN < 08) OR (W-GET < 01 OR > 12)
007690                     OR (W-PEY < 01 OR > 31)
007700         GO TO M-140.
007710     IF W-DATE < W-SNGP OR > W-ENGP                               I.081226
007720         GO TO M-140.                                             I.081226
007730     IF W-TCD NOT = 4990
007740         MOVE SPACE TO W-HNO
007750         DISPLAY A-HNO
007760         GO TO M-150.
007770 M-145.
007780     ACCEPT A-HNO.
007790     DISPLAY E-CL.
007800     IF ESTAT = BTB
007810         GO TO M-140.
007820     IF ESTAT NOT = HTB AND SKP
007830         GO TO M-145.
007840 M-150.
007850     ACCEPT A-SOK.
007860     DISPLAY E-CL.
007870     IF ESTAT = BTB
007880         IF W-TCD NOT = 4990
007890             GO TO M-140
007900           ELSE
007910             GO TO M-145.
007920     IF ESTAT NOT = HTB AND SKP
007930         GO TO M-150.
007940*
007950     MOVE 3 TO JCON3-01.
007960     MOVE W-SOK TO JCON3-02.
007970     READ JCON WITH UNLOCK INVALID KEY
007980         MOVE NC"倉庫　なし　" TO JCON3-03.
007990     MOVE JCON3-03 TO W-SNA.
008000     DISPLAY D-SNA.
008010 M-155.
008020     ACCEPT A-UNS.
008030     DISPLAY E-CL.
008040     IF ESTAT = BTB
008050         GO TO M-150.
008060     IF ESTAT NOT = HTB AND SKP
008070         GO TO M-155.
008080*
008090     MOVE 2 TO JCON2-01.
008100     MOVE W-UNS TO JCON2-02.
008110     READ JCON WITH UNLOCK INVALID KEY
008120         MOVE NC"運送　なし　" TO JCON2-03.
008130     MOVE JCON2-03 TO W-UNA.
008140     DISPLAY D-UNA.
008150*
008160     MOVE ZERO TO W-GN W-DC.
008170     MOVE 7 TO W-LC1.
008180     MOVE 8 TO W-LC2.
008190 M-160.
008200     ADD 1 TO W-GN.
008210     ADD 2 TO W-LC1 W-LC2.
008220     IF W-GN = 7
008230         GO TO M-300.
008240     IF W-DC NOT = 0
008250         MOVE ZERO TO W-MEID(W-GN)
008260         DISPLAY D-MEIC
008270         GO TO M-160.
008280 M-165.
008290     ACCEPT A-JNO.
008300     DISPLAY E-CL.
008310     IF W-GN > 1
008320         IF ESTAT = ADV
008330             MOVE ZERO TO W-MEID(W-GN)
008340             DISPLAY D-MEIC
008350             MOVE 1 TO W-DC
008360             GO TO M-160.
008370     IF ESTAT = BTB
008380         GO TO M-280.
008390     IF ESTAT NOT = HTB AND SKP
008400         GO TO M-165.
008410     IF W-JNO(W-GN) = ZERO
008420         MOVE ZERO TO W-JGN(W-GN)                                 I.080724
008430         DISPLAY D-JNOC
008440         GO TO M-175.
008450     DISPLAY D-JNOV.
008460     MOVE SPACE TO JMSTD-KEY1.
008470     MOVE W-JNO(W-GN) TO JMSTD-07.
008480     START JMSTD KEY NOT < JMSTD-KEY1 INVALID KEY
008490         DISPLAY E-ME14 E-ME99
008500         GO TO M-165.
008510     READ JMSTD NEXT RECORD WITH UNLOCK AT END
008520         DISPLAY E-ME14 E-ME99
008530         GO TO M-165.
008540     IF W-JNO(W-GN) NOT = JMSTD-07
008550         DISPLAY E-ME14 E-ME99
008560         GO TO M-165.
008570     IF JMSTD-01 NOT = 0 AND 6
008580         DISPLAY E-ME14 E-ME99
008590         GO TO M-165.
008600     IF JMSTD-04 NOT = W-TCD
008610         DISPLAY E-ME20 E-ME98
008620         GO TO M-165.
008630 M-170.
008640     ACCEPT A-JGN.
008650     DISPLAY E-CL.
008660     IF ESTAT = BTB
008670         GO TO M-165.
008680     IF ESTAT NOT = HTB AND SKP
008690         GO TO M-170.
008700     MOVE SPACE TO JMSTD-KEY1.
008710     MOVE W-JNO(W-GN) TO JMSTD-07.
008720     MOVE W-JGN(W-GN) TO JMSTD-08.
008730     READ JMSTD WITH UNLOCK INVALID KEY
008740         DISPLAY E-ME14 E-ME99
008750         GO TO M-165.
008760     IF JMSTD-01 NOT = 0 AND 6
008770         DISPLAY E-ME15 E-ME99
008780         GO TO M-165.
008790     MOVE JMSTD-03 TO W-HCD(W-GN).
008800     MOVE W-HCD(W-GN) TO HI-MHCD HI-HCD.
008810     READ HI2-M WITH UNLOCK INVALID KEY
008820         MOVE SPACE TO HI-NAME.
008830     MOVE 0 TO HI-S(4,10).                                        I.091002
008840     DISPLAY A-HCD D-HNA.
008850     IF JMSTD-10 NOT = 001
008860         IF JMSTD-10 NOT = W-CCD
008870             DISPLAY E-ME19 E-ME98.
008880     IF W-ACT = 1                                                 I.080508
008890         MOVE JMSTD-13 TO W-TEKI                                  I.080508
008900         DISPLAY A-THT A-TTE.                                     I.080508
008910     GO TO M-180.
008920 M-175.
008930     IF W-ACT = 1
008940         IF W-FHCD NOT = ZERO
008950             MOVE W-FHCD TO W-HCD(W-GN)
008960             DISPLAY A-HCD.
008970 M-180.
008980     ACCEPT A-HCD.
008990     DISPLAY E-CL.
009000     IF ESTAT = BTB
009010         GO TO M-165.
009020     IF ESTAT NOT = HTB AND SKP
009030         GO TO M-180.
009040     IF W-HCD(W-GN) = ZERO
009050         MOVE W-FHCD TO W-HCD(W-GN)
009060         DISPLAY A-HCD.
009070*
009080     MOVE W-HCD(W-GN) TO HI-MHCD HI-HCD.
009090     READ HI2-M WITH UNLOCK INVALID KEY
009100         DISPLAY E-ME5 E-ME98
009110         GO TO M-180.
009120     MOVE HI-ISU TO W-ISU(W-GN).
009130     MOVE 0 TO HI-S(4,10).
009140     DISPLAY D-HNA.
009150*****IF W-TCD NOT = 4990                                          D.120203
009160     IF W-TCD NOT = 4990 AND 6010                                 I.120203
009170         IF W-HCD(W-GN) = 999999
009180             GO TO M-180.
009190*
009200     IF W-JNO(W-GN) = ZERO
009210         GO TO M-200.
009220     IF JMSTD-03 = W-HCD(W-GN)
009230         GO TO M-200.
009240     MOVE 20 TO RUIJ-01.
009250     MOVE JMSTD-03 TO RUIJ-02.
009260     MOVE W-HCD(W-GN) TO RUIJ-03.
009270     READ JT-RUIJ WITH UNLOCK INVALID KEY
009280         DISPLAY E-ME16 E-ME98
009290         GO TO M-165.
009300 M-200.
009310     ACCEPT A-SZN.
009320     DISPLAY E-CL.
009330     IF ESTAT = BTB
009340         GO TO M-180.
009350     IF ESTAT NOT = HTB AND SKP
009360         GO TO M-200.
009370*
009380     MOVE W-SZN(W-GN) TO W-SIZM.
009390     PERFORM SIZ-RTN THRU SIZ-EX.
009400     DISPLAY D-SIZD.
009410     IF W-INV NOT = 0
009420         GO TO M-200.
009430     MOVE W-SCC TO W-SKB(W-GN).
009440     MOVE W-C TO W-SNO(W-GN).
009450     IF W-ACT = 1
009460         IF W-JNO(W-GN) NOT = ZERO
009470             PERFORM JMS-RTN THRU JMS-EX
009480           ELSE
009490             PERFORM NJS-RTN THRU NJS-EX.
009500     IF W-INV NOT = 0
009510         GO TO M-200.
009520     IF (W-ACT = 1) OR ((W-ACT = 2) AND (W-GT(W-GN) = ZERO))
009530         PERFORM TAN-RTN THRU TAN-EX.
009540*****IF W-TCD NOT = 4990                                          D.080605
009550     IF W-TCD = 9850                                              I.080605
009560         MOVE SPACE TO W-TRN(W-GN)
009570         DISPLAY D-TRNC
009580         GO TO M-220.
009590     CLOSE CODEF.
009600     OPEN INPUT CODEF.
009610     SELECT CODEF WHERE 0000 = CODE-TCD AND
009620                        W-HCD(W-GN) = CODE-HCD AND
009630                        W-SCC = CODE-SIZ AND W-C = CODE-SNO.
009640     READ CODEF AT END SCRATCH CODEF
009650         MOVE SPACE TO CODE-JAN CODE-NAME.                        I.080605
009660*****    MOVE SPACE TO CODE-NAME.                                 D.080605
009670     MOVE CODE-JAN  TO W-JAN(W-GN).                               I.100921
009680     MOVE CODE-NAME TO W-TRN(W-GN).                               I.100921
009690     IF W-TCD NOT = 4990                                          I.080605
009700*****    MOVE CODE-JAN  TO W-JAN(W-GN)                            D.100921
009710*****    MOVE SPACE TO W-JANS(W-GN)                               D.100921
009720         DISPLAY D-TRNC                                           I.080605
009730       ELSE                                                       I.080605
009740*****    MOVE CODE-NAME TO W-TRN(W-GN).                           D.080605
009750*****    MOVE CODE-NAME TO W-TRN(W-GN)                            D.100921
009760         DISPLAY D-TRN.
009770     IF W-TCD = 4990                                              I.080605
009780         IF CODE-NAME = SPACE
009790             DISPLAY E-ME17 E-ME98
009800             GO TO M-200.
009810*****IF W-TCD = 4990                                              D.120203
009820     IF W-TCD = 4990 OR 6010                                      I.120203
009830         IF W-HCD(W-GN) = 999999
009840             MOVE ZERO TO W-SU(W-GN) W-GT(W-GN)
009850             DISPLAY D-SU D-GT
009860             GO TO M-250.
009870 M-220.
009880     ACCEPT A-SU.
009890     DISPLAY E-CL.
009900     IF ESTAT = BTB
009910         GO TO M-200.
009920     IF ESTAT NOT = HTB AND SKP
009930         GO TO M-220.
009940     IF W-SU(W-GN) <= ZERO
009950         GO TO M-220.
009960     DISPLAY D-SU.
009970 M-240.
009980     ACCEPT A-GT.
009990     DISPLAY E-CL.
010000     IF ESTAT = BTB
010010         GO TO M-220.
010020     IF ESTAT NOT = HTB AND SKP
010030         GO TO M-240.
010040     IF W-GT(W-GN) = ZERO
010050         DISPLAY E-ME30 E-ME99                                    I.101015
010060         DISPLAY E-CL.                                            I.110609
010070*****    DISPLAY E-CL                                             D.110609
010080*****    GO TO M-240.                                             D.110609
010090     COMPUTE W-GKIN(W-GN) = W-SU(W-GN) * W-GT(W-GN).
010100     DISPLAY D-GT D-GKIN.
010110*****IF W-TCD = 4990                                              D.120203
010120     IF W-TCD = 4990 OR 6010                                      I.120203
010130         MOVE ZERO TO W-UT(W-GN) W-UKIN(W-GN)
010140         DISPLAY D-UT D-UKIN
010150         GO TO M-270.
010160     GO TO M-260.
010170 M-250.
010180     DISPLAY A-GKIN.
010190     ACCEPT A-GKIN.
010200     DISPLAY E-CL.
010210     IF ESTAT = BTB
010220         GO TO M-200.
010230     IF ESTAT NOT = HTB AND SKP
010240         GO TO M-250.
010250     MOVE ZERO TO W-UT(W-GN) W-UKIN(W-GN)
010260     DISPLAY D-GKIN D-UT D-UKIN
010270     GO TO M-270.
010280 M-260.
010290     ACCEPT A-UT.
010300     DISPLAY E-CL.
010310     IF ESTAT = BTB
010320         GO TO M-240.
010330     IF ESTAT NOT = HTB AND SKP
010340         GO TO M-260.
010350     IF W-UT(W-GN) = ZERO
010360         DISPLAY E-ME30 E-ME99                                    I.100511
010370         DISPLAY E-CL.                                            I.100511
010380*****    GO TO M-260.                                             D.100511
010390     COMPUTE W-UKIN(W-GN) = W-SU(W-GN) * W-UT(W-GN).
010400     DISPLAY D-UT D-UKIN.
010410 M-270.
010420     MOVE W-HCD(W-GN) TO W-FHCD.
010430     GO TO M-160.
010440 M-280.
010450     SUBTRACT 1 FROM W-GN.
010460     SUBTRACT 2 FROM W-LC1 W-LC2.
010470     IF W-GN = 0
010480         GO TO M-140.
010490     IF W-HCD(W-GN) = ZERO
010500         GO TO M-280.
010510*****IF W-TCD = 4990                                              D.120203
010520     IF W-TCD = 4990 OR 6010                                      I.120203
010530         IF W-HCD(W-GN) = 999999
010540             GO TO M-250
010550           ELSE
010560             GO TO M-240.
010570     GO TO M-260.
010580 M-300.
010590*****MOVE ZERO TO W-GN WT-D W-SUC.                                D.110907
010600     MOVE ZERO TO W-GN WT-D W-SUC W-UCHK.                         I.110907
010610 M-310.
010620     ADD 1 TO W-GN.
010630     IF W-GN = 7
010640         GO TO M-320.
010650     IF W-HCD(1) = 999999                                         I.110906
010660         MOVE 1 TO W-UCHK.                                        I.110906
010670     IF W-UCHK = 1                                                I.110906
010680         IF W-GN NOT = 1                                          I.110906
010690             IF W-HCD(W-GN) NOT = 000000 AND 999999               I.110906
010700                 MOVE 0 TO W-UCHK.                                I.110906
010710     ADD W-SU(W-GN) TO WT-SU
010720     ADD W-GKIN(W-GN) TO WT-GKIN
010730     ADD W-UKIN(W-GN) TO WT-UKIN
010740     IF W-GN = 1
010750         IF W-SU(W-GN) < ZERO
010760             MOVE 1 TO W-SUC
010770           ELSE
010780             MOVE 0 TO W-SUC.
010790     IF W-SU(W-GN) < ZERO
010800         IF W-SUC = 0
010810             DISPLAY E-ME24 E-ME98
010820             MOVE 7 TO W-GN
010830             GO TO M-280.
010840     IF W-SU(W-GN) >= ZERO
010850         IF W-SUC = 1
010860             DISPLAY E-ME24 E-ME98
010870             MOVE 7 TO W-GN
010880             GO TO M-280.
010890     GO TO M-310.
010900 M-320.
010910     DISPLAY D-KEI.
010920     IF W-JCN NOT = ZERO                                          I.080604
010930         IF (W-JCN NOT = W-JNO(1)) AND (W-JCN NOT = W-JNO(2)) AND I.080604
010940            (W-JCN NOT = W-JNO(3)) AND (W-JCN NOT = W-JNO(4)) AND I.080604
010950            (W-JCN NOT = W-JNO(5)) AND (W-JCN NOT = W-JNO(6))     I.080604
010960             DISPLAY E-ME28 E-ME98                                I.080604
010970             GO TO M-280.                                         I.080604
010980     IF W-ACT = 1                                                 I.170728
010990         IF W-CCD > 001                                           I.170728
011000             IF TC-MZC = 1                                        I.170728
011010                 IF W-TTE2 = SPACE                                I.170728
011020                     MOVE NC"発送明細書在中" TO W-TTE2            I.170728
011030                         DISPLAY A-TTE.                           I.170728
011040     MOVE 0 TO W-DC.
011050 M-325.
011060     ACCEPT A-THT.
011070     DISPLAY E-CL.
011080     IF ESTAT = BTB
011090         GO TO M-280.
011100     IF ESTAT NOT = HTB AND SKP
011110         GO TO M-325.
011120     MOVE W-TEKI TO W-ATYD.                                       I.080604
011130     IF SPACE = W-TY(01) OR W-TY(03) OR W-TY(05) OR W-TY(07)      I.080604
011140             OR W-TY(09) OR W-TY(11) OR W-TY(13) OR W-TY(15)      I.080604
011150             OR W-TY(17)                                          I.080604
011160         GO TO M-325.
011170 M-330.
011180     ACCEPT A-TTE.
011190     DISPLAY E-CL.
011200     IF ESTAT = BTB
011210         GO TO M-325.
011220     IF ESTAT NOT = HTB AND SKP
011230         GO TO M-330.
011240     MOVE W-TEKI TO W-ATYD.                                       I.080604
011250     IF SPACE = W-TY(19) OR W-TY(21) OR W-TY(23) OR W-TY(25)      I.080604
011260             OR W-TY(27) OR W-TY(29) OR W-TY(31) OR W-TY(33)      I.080604
011270             OR W-TY(35) OR W-TY(37) OR W-TY(39) OR W-TY(41)      I.080604
011280             OR W-TY(43) OR W-TY(45) OR W-TY(47) OR W-TY(49)      I.080604
011290             OR W-TY(51) OR W-TY(53) OR W-TY(55)                  I.080604
011300         GO TO M-330.
011310 M-340.
011320     ACCEPT A-DMM.
011330     DISPLAY E-CL.
011340     IF ESTAT = BTB
011350         IF W-ACT = 3
011360             GO TO M-060
011370           ELSE
011380             GO TO M-330.
011390     IF ESTAT NOT = HTB AND SKP
011400         GO TO M-340.
011410     IF W-DMM = 9
011420         DISPLAY E-ME7 E-ME98
011430         GO TO M-080.
011440     IF W-DMM NOT = 1
011450         GO TO M-340.
011460*
011470     ACCEPT W-TIMED FROM TIME.                                    I.110622
011480     MOVE ZERO TO W-GN.
011490     IF W-ACT NOT = 1                                             I.091202
011500         GO TO M-350.                                             I.091202
011510*****IF W-ACT = 1                                                 D.091202
011520*****    ADD 1 TO W-MDNO                                          D.091202
011530*****    MOVE W-MDNO TO W-DNO                                     D.091202
011540     MOVE "19" TO JCON1-KEY.                                      I.091202
011550     READ JCON INVALID KEY                                        I.091202
011560         DISPLAY E-ME8 E-ME99                                     I.091202
011570         GO TO M-420.                                             I.091202
011580     ADD 1 TO JCON1-04.                                           I.091202
011590     IF JCON1-04 = ZERO                                           I.121128
011600         ADD 1 TO JCON1-04.                                       I.121128
011610     REWRITE JCON1-R INVALID KEY                                  I.091202
011620         DISPLAY E-ME9 E-ME99                                     I.091202
011630         GO TO M-420.                                             I.091202
011640     MOVE JCON1-04 TO W-DNO.                                      I.091202
011650     GO TO M-380.
011660 M-350.                                                           I.091202
011670     MOVE ZERO TO TDI-KEY.
011680     MOVE W-DNO TO TDI-DNO.
011690     START TDIF KEY NOT < TDI-KEY INVALID KEY
011700         DISPLAY E-ME1 E-ME98
011710         DISPLAY E-CL
011720         GO TO M-380.
011730 M-360.
011740     READ TDIF NEXT RECORD AT END
011750         GO TO M-380.
011760     IF W-DNO NOT = TDI-DNO
011770         GO TO M-380.
011780     IF TDI-JNO NOT = ZERO
011790         PERFORM JMD-RTN THRU JMD-EX.
011800     IF W-END NOT = 0
011810         GO TO M-420.
011820     IF TDI-HCD < 999900
011830         PERFORM NJD-RTN THRU NJD-EX.
011840     IF W-END NOT = 0
011850         GO TO M-420.
011860     DELETE TDIF INVALID KEY
011870         DISPLAY E-STAT E-ME13 E-KEY E-ME99
011880         GO TO M-420.
011890     GO TO M-360.
011900 M-380.
011910     IF W-ACT = 3
011920         GO TO M-400.
011930     ADD 1 TO W-GN.
011940     IF W-GN = 7
011950         GO TO M-400.
011960     IF W-HCD(W-GN) = ZERO
011970         GO TO M-400.
011980*
011990     IF W-JNO(W-GN) NOT = ZERO
012000         PERFORM JMW-RTN THRU JMW-EX.
012010     IF W-END NOT = 0
012020         GO TO M-420.
012030     IF W-HCD(W-GN) < 999900
012040         PERFORM NJW-RTN THRU NJW-EX.
012050     IF W-END NOT = 0
012060         GO TO M-420.
012070 M-385.
012080     INITIALIZE TDI-R.
012090     MOVE W-DNO TO TDI-DNO.
012100     MOVE W-GN TO TDI-GNO.
012110     MOVE W-DATE TO TDI-DATE.
012120     MOVE W-TCD TO TDI-TCD.
012130     MOVE W-CCD TO TDI-CCD.
012140     MOVE W-TPC TO TDI-TPC.
012150     MOVE W-SOK TO TDI-SOK.
012160     MOVE W-UNS TO TDI-UNS.
012170     MOVE W-HNO TO TDI-HNO.
012180     MOVE W-THT TO TDI-THT.
012190     MOVE W-TTE TO TDI-TTE.
012200     IF W-ACT NOT = 1
012210         MOVE W-PRC TO TDI-PRC
012220         MOVE W-UPC TO TDI-UPC
012230       ELSE
012240         MOVE 0 TO TDI-PRC TDI-UPC.
012250     MOVE W-JNO(W-GN) TO TDI-JNO.
012260     MOVE W-JGN(W-GN) TO TDI-JGN.
012270     MOVE W-HCD(W-GN) TO TDI-HCD.
012280     MOVE W-SZN(W-GN) TO TDI-SIZ.
012290     MOVE W-SKB(W-GN) TO TDI-SKB.
012300     MOVE W-SNO(W-GN) TO TDI-SNO.
012310     MOVE W-SU(W-GN) TO TDI-SU.
012320     MOVE W-GT(W-GN) TO TDI-GT.
012330     MOVE W-UT(W-GN) TO TDI-UT.
012340     MOVE W-GKIN(W-GN) TO TDI-GKIN.
012350     MOVE W-UKIN(W-GN) TO TDI-UKIN.
012360     MOVE W-ISU(W-GN) TO TDI-ISU.
012370     MOVE W-TRN(W-GN) TO TDI-TRN.
012380     MOVE W-JAN(W-GN) TO TDI-JAN.                                 I.100921
012390     MOVE W-NNGP TO TDI-NNGP.                                     I.110622
012400     MOVE W-TIME TO TDI-NHMS.                                     I.110622
012410     IF W-UCHK = 1                                                I.110906
012420         MOVE 1 TO TDI-UPC.                                       I.110906
012430     IF W-TCD = 4990                                              I.160216
012440         IF 999999 = W-HCD(1) OR W-HCD(2) OR W-HCD(3) OR W-HCD(4) I.160216
012450                                          OR W-HCD(5) OR W-HCD(6) I.160216
012460             MOVE 1 TO TDI-UTC.                                   I.160216
012470     WRITE TDI-R INVALID KEY
012480         GO TO M-390.
012490     GO TO M-380.
012500 M-390.
012510     DISPLAY E-STAT E-ME11 E-KEY E-ME99
012520     IF ERR-STAT NOT = 24
012530         DISPLAY E-ME78 E-ME99
012540         GO TO M-420.
012550     CLOSE TDIF.
012560     MOVE "TDIF         " TO W-FILE.
012570     DISPLAY E-CL.
012580     DISPLAY E-ME71 E-ME98.
012590     STOP " ".
012600     DISPLAY E-CL.
012610     OPEN I-O TDIF.
012620     GO TO M-385.
012630 M-400.
012640     DISPLAY C-CLEAR.
012650     CALL "SJN05I".
012660     DISPLAY A-ACT D-BDNO.
012670     IF W-ACT NOT = 1
012680         GO TO M-060.
012690     DISPLAY A-TCD D-TNA A-CCD A-DATE A-SOK A-UNS
012700                                            A-THT A-TTE.
012710     IF W-TCD = 4990
012720         DISPLAY A-HNO.
012730     IF W-CCD NOT = ZERO
012740         DISPLAY D-CNA.
012750     IF W-TPC NOT = ZERO
012760         DISPLAY A-TPC D-MNA.
012770     GO TO M-050.                                                 I.080604
012780*****GO TO M-080.                                                 D.080604
012790 M-420.
012800     CLOSE TDIF.
012810     CLOSE TC-M HI2-M WTNAF THTM CODEF JT-RUIJ.
012820     CLOSE JMSTD NJZAI.
012830*****MOVE "19" TO JCON1-KEY.                                      D.091202
012840*****READ JCON INVALID KEY                                        D.091202
012850*****    CLOSE JCON                                               D.091202
012860*****    DISPLAY E-ME8 E-ME99                                     D.091202
012870*****    GO TO M-980.                                             D.091202
012880*****MOVE W-MDNO TO JCON1-03.                                     D.091202
012890*****REWRITE JCON1-R INVALID KEY                                  D.091202
012900*****    DISPLAY E-ME9 E-ME99.                                    D.091202
012910     CLOSE JCON.
012920*
012930     DISPLAY C-CLEAR.
012940     DISPLAY D-PRM.
012950     MOVE ZERO TO W-FNGP W-DNOF.
012960     MOVE 999999 TO W-TNGP W-DNOT.
012970 M-520.
012980     ACCEPT A-SEN.
012990     IF ESTAT = PF9
013000         GO TO M-980.
013010     IF ESTAT NOT = HTB AND SKP
013020         GO TO M-520.
013030     IF W-SEN NOT = 1 AND 2
013040         GO TO M-520.
013050 M-522.
013060     ACCEPT A-FNEN.
013070     IF ESTAT = BTB
013080         GO TO M-520.
013090     IF ESTAT NOT = HTB AND SKP
013100         GO TO M-522.
013110 M-524.
013120     ACCEPT A-FGET.
013130     IF ESTAT = BTB
013140         GO TO M-522.
013150     IF ESTAT NOT = HTB AND SKP
013160         GO TO M-524.
013170 M-526.
013180     ACCEPT A-FPEY.
013190     IF ESTAT = BTB
013200         GO TO M-524.
013210     IF ESTAT NOT = HTB AND SKP
013220         GO TO M-526.
013230 M-528.
013240     ACCEPT A-TNEN.
013250     IF ESTAT = BTB
013260         GO TO M-526.
013270     IF ESTAT NOT = HTB AND SKP
013280         GO TO M-528.
013290     IF W-FNEN > W-TNEN
013300         GO TO M-528.
013310 M-530.
013320     ACCEPT A-TGET.
013330     IF ESTAT = BTB
013340         GO TO M-528.
013350     IF ESTAT NOT = HTB AND SKP
013360         GO TO M-530.
013370 M-532.
013380     ACCEPT A-TPEY.
013390     IF ESTAT = BTB
013400         GO TO M-530.
013410     IF ESTAT NOT = HTB AND SKP
013420         GO TO M-532.
013430     IF W-FNGP > W-TNGP
013440         GO TO M-528.
013450     IF W-SEN = 1
013460         DISPLAY D-DNC
013470         GO TO M-580.
013480     DISPLAY D-DNM.
013490 M-540.
013500     ACCEPT A-DNOF.
013510     IF ESTAT = BTB
013520         GO TO M-532.
013530     IF ESTAT NOT = HTB AND SKP
013540         GO TO M-540.
013550 M-560.
013560     ACCEPT A-DNOT.
013570     IF ESTAT = BTB
013580         GO TO M-540.
013590     IF ESTAT NOT = HTB AND SKP
013600         GO TO M-560.
013610     IF W-DNOF > W-DNOT
013620         GO TO M-540.
013630 M-580.
013640     ACCEPT A-DMM.
013650     IF ESTAT = BTB
013660         IF W-SEN = 1
013670             GO TO M-532
013680           ELSE
013690             GO TO M-560.
013700     IF ESTAT NOT = HTB AND SKP
013710         GO TO M-580.
013720     IF W-DMM = 9
013730         GO TO M-520.
013740     IF W-DMM NOT = 1
013750         GO TO M-580.
013760*
013770     OPEN I-O TDIF.
013780 M-600.
013790     READ TDIF NEXT RECORD AT END
013800         CLOSE TDIF
013810         DISPLAY E-ME1 E-ME99
013820         GO TO M-980.
013830     IF TDI-DATE < W-FNGP OR > W-TNGP
013840         GO TO M-600.
013850     IF W-SEN = 1
013860         IF TDI-PRC NOT = 0
013870             GO TO M-600.
013880     IF W-SEN = 2
013890         IF TDI-PRC = 0
013900             GO TO M-600
013910           ELSE
013920             IF TDI-DNO < W-DNOF OR > W-DNOT
013930                 GO TO M-600
013940               ELSE
013950                 IF TDI-UPC NOT = 0
013960                     GO TO M-600.
013970     OPEN INPUT JCON TC-M HI2-M WTNAF CODEF.
013980     OPEN OUTPUT SP-F.
013990     MOVE ZERO TO W-PAGE.
014000     MOVE W-FNGP TO H-FNGP.
014010     MOVE W-TNGP TO H-TNGP.
014020     ACCEPT H-DATE FROM DATE.
014030     PERFORM MID-10 THRU MID-EX.
014040 M-620.
014050     MOVE TDI-DNO TO W-DNO.
014060     MOVE ZERO TO WT-D.
014070*
014080     MOVE SPACE TO W-P1.
014090     MOVE SPACE TO P-TNA P-CNA P-SNA P-UNA P-THT P-TTE.
014100     MOVE W-DNO TO P-DNO.
014110     MOVE TDI-DATE TO P-DATE.
014120     MOVE TDI-TCD TO P-TCD.
014130     IF TDI-TPC NOT = ZERO
014140         IF TDI-CCD = 2 OR 3
014150             MOVE TDI-TPC TO P-TPC                                I.100921
014160*****        MOVE TDI-TPC TO P-CCD                                D.100921
014170           ELSE
014180             IF TDI-CCD NOT = ZERO AND 001
014190                 MOVE TDI-CCD TO P-CCD.
014200     IF TDI-TPC = ZERO
014210         IF TDI-CCD NOT = ZERO AND 001
014220             MOVE TDI-CCD TO P-CCD.
014230     IF TDI-HNO NOT = SPACE AND ZERO
014240         MOVE TDI-HNO TO P-HNO.
014250     MOVE TDI-THT TO P-THT.
014260     MOVE TDI-TTE TO P-TTE.
014270*
014280     MOVE 2 TO JCON2-01.
014290     MOVE TDI-UNS TO JCON2-02.
014300     READ JCON WITH UNLOCK INVALID KEY
014310         MOVE NC"運送　なし　" TO JCON2-03.
014320     MOVE JCON2-03 TO P-UNA.
014330*
014340     MOVE 3 TO JCON3-01.
014350     MOVE TDI-SOK TO JCON3-02.
014360     READ JCON WITH UNLOCK INVALID KEY
014370         MOVE NC"倉庫　なし　" TO JCON3-03.
014380     MOVE JCON3-03 TO P-SNA.
014390*
014400     MOVE TDI-TCD TO TC-TCD.
014410     MOVE 1 TO TC-CCD.
014420     READ TC-M WITH UNLOCK INVALID KEY
014430         MOVE SPACE TO TC-NAME
014440         MOVE NC"＊　得意先なし　＊" TO TC-NAME.
014450     MOVE TC-NAME TO P-TNA.
014460*
014470*****IF TDI-TPC NOT = ZERO AND 999                                D.100921
014480     IF TDI-TPC NOT = ZERO AND 9998 AND 9999                      I.100921
014490         IF TDI-CCD = 2 OR 3
014500             GO TO M-640.
014510     IF TDI-CCD = ZERO OR 001
014520         GO TO M-660.
014530     MOVE TDI-TCD TO TC-TCD.
014540     MOVE TDI-CCD TO TC-CCD.
014550     READ TC-M WITH UNLOCK INVALID KEY
014560         MOVE SPACE TO TC-NAME
014570         MOVE NC"＊　直送先なし　＊" TO TC-NAME.
014580     MOVE TC-NAME TO P-CNA.
014590     GO TO M-660.
014600 M-640.
014610     MOVE TDI-TPC TO WTNA-KEY.
014620     READ WTNAF WITH UNLOCK INVALID KEY
014630         MOVE SPACE TO WTNA-NAME
014640         MOVE NC"＊　店名　なし　＊" TO WTNA-NAME.
014650     MOVE WTNA-NAME TO P-CNA.
014660 M-660.
014670     PERFORM PR2-RTN THRU PR2-EX.
014680     IF W-SEN = 2
014690         GO TO M-680.
014700     MOVE 1 TO TDI-PRC.
014710     REWRITE TDI-R INVALID KEY
014720         DISPLAY E-STAT E-ME12 E-KEY E-ME99
014730         DISPLAY E-CL.
014740 M-680.
014750     READ TDIF NEXT RECORD AT END
014760         GO TO M-700.
014770     IF TDI-DATE < W-FNGP OR > W-TNGP
014780         GO TO M-680.
014790     IF W-SEN = 1
014800         IF TDI-PRC NOT = 0
014810             GO TO M-680.
014820     IF W-SEN = 2
014830         IF TDI-PRC = 0
014840             GO TO M-680
014850           ELSE
014860             IF TDI-DNO < W-DNOF OR > W-DNOT
014870                 GO TO M-680
014880               ELSE
014890                 IF TDI-UPC NOT = 0
014900                     GO TO M-680.
014910     IF TDI-DNO = W-DNO
014920         GO TO M-660.
014930     PERFORM PR3-RTN THRU PR3-EX.
014940     GO TO M-620.
014950 M-700.
014960     PERFORM PR3-RTN THRU PR3-EX.
014970     CLOSE SP-F.
014980     CLOSE TDIF.
014990     CLOSE JCON TC-M HI2-M WTNAF CODEF.
015000 M-980.
015010     DISPLAY C-CLEAR.
015020     STOP RUN.
015030**************************************************************************
015040 JCS-RTN.                                                         I.080604
015050     MOVE JMSTD-04 TO W-TCD.                                      I.080604
015060     MOVE JMSTD-10 TO W-CCD.                                      I.080604
015070     MOVE JMSTD-23 TO W-TPC.                                      I.080604
015080     MOVE JMSTD-13 TO W-TEKI.                                     I.080604
015090     MOVE W-JCN TO W-JNO(1).                                      I.080604
015100     MOVE W-TCD TO TC-TCD.                                        I.080604
015110     MOVE 001 TO TC-CCD.                                          I.080604
015120     READ TC-M WITH UNLOCK INVALID KEY                            I.080604
015130         MOVE SPACE TO TC-NAME                                    I.080604
015140         MOVE NC"得意先　なし" TO TC-NAME.                        I.080604
015150     MOVE TC-NAME TO W-TNA.                                       I.080604
015160*
015170     IF W-TPC = ZERO                                              I.080604
015180         GO TO JCS-10.                                            I.080604
015190     MOVE W-TPC TO WTNA-KEY.                                      I.080604
015200     READ WTNAF WITH UNLOCK INVALID KEY                           I.080604
015210         MOVE SPACE TO WTNA-NAME                                  I.080604
015220         MOVE 9 TO WTNA-OSN                                       I.080604
015230         MOVE NC"店名　なし" TO WTNA-NAME.                        I.080604
015240 JCS-10.                                                          I.080604
015250     MOVE W-TCD TO TC-TCD.                                        I.080604
015260     MOVE W-CCD TO TC-CCD.                                        I.080604
015270     READ TC-M WITH UNLOCK INVALID KEY                            I.080604
015280         MOVE SPACE TO TC-NAME                                    I.080604
015290         MOVE NC"直送先　なし" TO TC-NAME.                        I.080604
015300     DISPLAY A-TCD D-TNA A-CCD D-CNA A-THT A-TTE.                 I.080604
015310     IF W-TPC = ZERO                                              I.080604
015320         DISPLAY D-TPCC                                           I.080604
015330       ELSE                                                       I.080604
015340         DISPLAY A-TPC D-MNA.                                     I.080604
015350     IF W-CCD = ZERO OR 001                                       I.080604
015360         DISPLAY D-CNAC                                           I.080604
015370       ELSE                                                       I.080604
015380         DISPLAY D-CNA.                                           I.080604
015390*****IF W-TCD = 9850                                              D.080605
015400     IF W-TCD NOT = 4990                                          I.080605
015410         DISPLAY D-HNOC.                                          I.080604
015420     MOVE 1 TO W-GN.                                              I.080604
015430     MOVE 9 TO W-LC1.                                             I.080604
015440     DISPLAY A-JNO.                                               I.080604
015450 JCS-EX.                                                          I.080604
015460     EXIT.                                                        I.080604
015470 SET-RTN.
015480     MOVE ZERO TO TDI-KEY W-INV.
015490     MOVE W-DNO TO TDI-DNO.
015500     START TDIF KEY NOT < TDI-KEY INVALID KEY
015510         MOVE 1 TO W-INV
015520         DISPLAY E-ME1 E-ME98
015530         GO TO SET-EX.
015540     READ TDIF NEXT RECORD AT END
015550         MOVE 1 TO W-INV
015560         DISPLAY E-ME1 E-ME98
015570         GO TO SET-EX.
015580     IF W-DNO NOT = TDI-DNO
015590         MOVE 1 TO W-INV
015600         DISPLAY E-ME1 E-ME98
015610         GO TO SET-EX.
015620*
015630     MOVE TDI-TCD TO W-TCD.
015640     MOVE TDI-CCD TO W-CCD.
015650     MOVE TDI-TPC TO W-TPC.
015660     MOVE TDI-DATE TO W-DATE.
015670     MOVE TDI-SOK TO W-SOK.
015680     MOVE TDI-UNS TO W-UNS.
015690     MOVE TDI-HNO TO W-HNO.
015700     MOVE TDI-THT TO W-THT.
015710     MOVE TDI-TTE TO W-TTE.
015720     MOVE TDI-PRC TO W-PRC.
015730     MOVE TDI-UPC TO W-UPC.
015740     MOVE ZERO TO W-MEI W-GN.
015750 SET-10.
015760     ADD 1 TO W-GN.
015770     IF W-GN > 6
015780         MOVE 1 TO W-INV
015790         DISPLAY E-ME2 E-ME9
015800         GO TO SET-EX.
015810     IF W-GN NOT = TDI-GNO
015820         DISPLAY E-ME2 E-ME9
015830         GO TO SET-EX.
015840     MOVE TDI-JNO TO W-JNO(W-GN).
015850     MOVE TDI-JGN TO W-JGN(W-GN).
015860     MOVE TDI-HCD TO W-HCD(W-GN).
015870     MOVE TDI-SIZ TO W-SZN(W-GN).
015880     MOVE TDI-SKB TO W-SKB(W-GN).
015890     MOVE TDI-SNO TO W-SNO(W-GN).
015900     MOVE TDI-SU TO W-SU(W-GN).
015910     MOVE TDI-GT TO W-GT(W-GN).
015920     MOVE TDI-UT TO W-UT(W-GN).
015930     MOVE TDI-GKIN TO W-GKIN(W-GN).
015940     MOVE TDI-UKIN TO W-UKIN(W-GN).
015950     MOVE TDI-ISU TO W-ISU(W-GN).
015960     MOVE TDI-TRN TO W-TRN(W-GN).
015970     MOVE TDI-JAN TO W-JAN(W-GN).                                 I.100921
015980*
015990     READ TDIF NEXT RECORD AT END
016000         GO TO SET-20.
016010     IF W-DNO NOT = TDI-DNO
016020         GO TO SET-20.
016030     IF (TDI-TCD NOT = W-TCD) OR (TDI-TPC NOT = W-TPC) OR
016040        (TDI-DATE NOT = W-DATE) OR (TDI-CCD NOT = W-CCD) OR
016050        (TDI-HNO NOT = W-HNO)
016060         MOVE 1 TO W-INV
016070         DISPLAY E-ME2 E-ME9
016080         GO TO SET-EX.
016090     GO TO SET-10.
016100 SET-20.
016110     MOVE W-TCD TO TC-TCD.
016120     MOVE 001 TO TC-CCD.
016130     READ TC-M WITH UNLOCK INVALID KEY
016140         MOVE SPACE TO TC-NAME
016150         MOVE NC"得意先　なし" TO TC-NAME.
016160     MOVE TC-NAME TO W-TNA.
016170*
016180     IF W-TPC = ZERO
016190         GO TO SET-30.
016200     MOVE W-TPC TO WTNA-KEY.
016210     READ WTNAF WITH UNLOCK INVALID KEY
016220         MOVE SPACE TO WTNA-NAME
016230         MOVE 9 TO WTNA-OSN
016240         MOVE NC"店名　なし" TO WTNA-NAME.
016250*****IF WTNA-OSN = 0                                              D.080604
016260*****    MOVE 002 TO W-CCD                                        D.080604
016270*****  ELSE                                                       D.080604
016280*****    IF WTNA-OSN = 1                                          D.080604
016290*****        MOVE 003 TO W-CCD                                    D.080604
016300*****      ELSE                                                   D.080604
016310*****        MOVE 000 TO W-CCD.                                   D.080604
016320 SET-30.
016330     IF W-CCD = ZERO
016340         GO TO SET-40.
016350     MOVE W-TCD TO TC-TCD.
016360     MOVE W-CCD TO TC-CCD.
016370     READ TC-M WITH UNLOCK INVALID KEY
016380         MOVE SPACE TO TC-NAME
016390         MOVE NC"直送先　なし" TO TC-NAME.
016400 SET-40.
016410     MOVE 2 TO JCON2-01.
016420     MOVE W-UNS TO JCON2-02.
016430     READ JCON WITH UNLOCK INVALID KEY
016440         MOVE NC"運送　なし　" TO JCON2-03.
016450     MOVE JCON2-03 TO W-UNA.
016460*
016470     MOVE 3 TO JCON3-01.
016480     MOVE W-SOK TO JCON3-02.
016490     READ JCON WITH UNLOCK INVALID KEY
016500         MOVE NC"倉庫　なし　" TO JCON3-03.
016510     MOVE JCON3-03 TO W-SNA.
016520*
016530     DISPLAY A-TCD D-TNA A-CCD D-CNA A-DATE
016540             A-SOK D-SNA A-UNS D-UNA A-THT A-TTE.
016550     IF W-TPC = ZERO
016560         DISPLAY D-TPCC
016570       ELSE
016580         DISPLAY A-TPC D-MNA.
016590     IF W-CCD = ZERO OR 001
016600         DISPLAY D-CNAC
016610       ELSE
016620         DISPLAY D-CNA.
016630*****IF W-TCD = 9850                                              D.080605
016640     IF W-TCD NOT = 4990                                          I.080605
016650         DISPLAY D-HNOC
016660       ELSE
016670         DISPLAY A-HNO.
016680     MOVE ZERO TO W-GN WT-D.
016690     MOVE 7 TO W-LC1.
016700     MOVE 8 TO W-LC2.
016710 SET-50.
016720     ADD 1 TO W-GN.
016730     IF W-GN = 7
016740         DISPLAY D-KEI
016750         GO TO SET-EX.
016760     ADD 2 TO W-LC1 W-LC2.
016770     IF W-HCD(W-GN) = ZERO
016780         DISPLAY D-MEIC
016790         GO TO SET-50.
016800     IF W-JNO(W-GN) = ZERO
016810         DISPLAY D-JNOC
016820       ELSE
016830         DISPLAY A-JNO A-JGN.
016840*
016850     MOVE W-HCD(W-GN) TO HI-MHCD HI-HCD.
016860     READ HI2-M WITH UNLOCK INVALID KEY
016870         MOVE SPACE TO HI-NAME
016880         MOVE NC"品名　なし" TO HI-NAME.
016890     MOVE 0 TO HI-S(4,10).                                        I.091002
016900*
016910     MOVE W-SZN(W-GN) TO W-SIZM.
016920     PERFORM SIZ-RTN THRU SIZ-EX.
016930*
016940     DISPLAY A-HCD D-HNA A-SZN D-SIZD D-MEI.
016950     IF W-INV = 1
016960         DISPLAY E-ME99.
016970     IF W-TCD = 4990
016980         DISPLAY D-TRN
016990       ELSE
017000         DISPLAY D-TRNC.
017010*
017020     ADD W-SU(W-GN) TO WT-SU.
017030     ADD W-GKIN(W-GN) TO WT-GKIN.
017040     ADD W-UKIN(W-GN) TO WT-UKIN.
017050     GO TO SET-50.
017060 SET-EX.
017070     EXIT.
017080 SIZ-RTN.
017090     MOVE SPACE TO W-SIZN.
017100     MOVE ZERO TO W-SC W-INV.
017110 SIZ-10.
017120     ADD 1 TO W-SC.
017130     IF W-SC = 6
017140         MOVE 5 TO W-SC
017150         MOVE 10 TO W-C
017160         GO TO SIZ-30.
017170     MOVE ZERO TO W-C.
017180 SIZ-20.
017190     ADD 1 TO W-C.
017200     IF W-C = 11
017210         GO TO SIZ-10.
017220     IF W-SIZM NOT = W-SZ(W-SC,W-C)
017230         GO TO SIZ-20.
017240 SIZ-30.
017250     COMPUTE W-SCC = W-SC - 1.
017260     IF W-SCC = 0
017270         MOVE 1 TO W-SCC.
017280     IF HI-S(W-SCC,W-C) = 0
017290         IF (W-SIZM = 240 OR 245 OR 250) AND (W-SCC = 3)
017300             GO TO SIZ-10
017310           ELSE
017320             MOVE 1 TO W-INV
017330             DISPLAY E-ME6 E-ME98
017340             GO TO SIZ-EX.
017350     MOVE W-SIZ(W-SC,W-C) TO W-SIZN.
017360     IF W-SC = 1
017370         IF (HI-SS2 NOT = ZERO) OR (HI-SS3 NOT = ZERO)
017380                                OR (HI-SS4 NOT = ZERO)
017390         MOVE 1 TO W-INV
017400         DISPLAY E-ME6 E-ME98
017410         GO TO SIZ-EX.
017420     IF W-SC = 2
017430         IF (HI-SS2 = ZERO) AND (HI-SS3 = ZERO)
017440                            AND (HI-SS4 = ZERO)
017450         MOVE 1 TO W-INV
017460         DISPLAY E-ME6 E-ME98
017470         GO TO SIZ-EX.
017480 SIZ-EX.
017490     EXIT.
017500 TAN-RTN.
017510     MOVE W-TCD TO THT-TCD.
017520     MOVE W-HCD(W-GN) TO THT-HCD.
017530     MOVE W-SCC TO THT-SIZ.
017540     READ THTM WITH UNLOCK INVALID KEY
017550         GO TO TAN-10.
017560     GO TO TAN-20.
017570 TAN-10.
017580     MOVE W-TCD TO THT-TCD.
017590     MOVE W-HCD(W-GN) TO THT-HCD.
017600     MOVE 9 TO THT-SIZ.
017610     READ THTM WITH UNLOCK INVALID KEY
017620         DISPLAY E-ME23 E-ME98
017630         MOVE ZERO TO THT-T THT-TT.
017640 TAN-20.
017650     MOVE THT-T TO W-GT(W-GN).
017660     MOVE THT-TT TO W-UT(W-GN).
017670     IF W-JCN NOT = ZERO                                          I.080604
017680         IF JMSTD-17 NOT = ZERO                                   I.080604
017690             MOVE JMSTD-17 TO W-GT(W-GN).                         I.080604
017700     DISPLAY D-GT D-UT.
017710 TAN-EX.
017720     EXIT.
017730 JMS-RTN.
017740     MOVE 0 TO W-INV.
017750     IF W-SCC NOT = JMSTD-09
017760         DISPLAY E-ME18 E-ME98
017770         MOVE 1 TO W-INV
017780       ELSE
017790         COMPUTE W-SU(W-GN) = JMSTD-1111(W-C) - JMSTD-1211(W-C)
017800                            - JMSTD-141(W-C)  - JMSTD-151(W-C)
017810         DISPLAY D-SU.
017820 JMS-EX.
017830     EXIT.
017840 NJS-RTN.
017850     MOVE 0 TO W-INV.
017860     MOVE SPACE TO NJZAI-KEY.
017870     MOVE W-SOK TO NJZAI-01.
017880     MOVE W-HCD(W-GN) TO NJZAI-02.
017890     MOVE W-SKB(W-GN) TO NJZAI-03.
017900     READ NJZAI WITH UNLOCK INVALID KEY
017910         MOVE ZERO TO NJZAI-0411(W-C) NJZAI-0511(W-C)
017920                      NJZAI-0611(W-C) NJZAI-0711(W-C)
017930                      NJZAI-0811(W-C) NJZAI-0911(W-C)
017940                      NJZAI-1111(W-C).
017950     COMPUTE W-SU(W-GN) = NJZAI-0411(W-C) - NJZAI-0511(W-C)
017960                        + NJZAI-0611(W-C) + NJZAI-0711(W-C)
017970                        - NJZAI-0811(W-C) - NJZAI-0911(W-C)
017980                        + NJZAI-1111(W-C).
017990     DISPLAY D-SU.
018000 NJS-EX.
018010     EXIT.
018020 JMW-RTN.
018030     MOVE SPACE TO JMSTD-KEY1.
018040     MOVE W-JNO(W-GN) TO JMSTD-07.
018050     MOVE W-JGN(W-GN) TO JMSTD-08.
018060     READ JMSTD INVALID KEY
018070         DISPLAY E-ME14 E-JMST E-ME99
018080         GO TO JMW-EX.
018090     MOVE W-SNO(W-GN) TO CNT.
018100     ADD W-SU(W-GN) TO JMSTD-151(CNT).
018110     REWRITE JMSTD-R INVALID KEY
018120         MOVE 1 TO W-END
018130         DISPLAY E-STAT E-ME25 E-JMST E-ME99.
018140 JMW-EX.
018150     EXIT.
018160 JMD-RTN.
018170     MOVE SPACE TO JMSTD-KEY1.
018180     MOVE TDI-JNO TO JMSTD-07.
018190     MOVE TDI-JGN TO JMSTD-08.
018200     READ JMSTD INVALID KEY
018210         DISPLAY E-ME14 E-JMST E-ME99
018220         GO TO JMD-EX.
018230     SUBTRACT TDI-SU FROM JMSTD-151(TDI-SNO).
018240     REWRITE JMSTD-R INVALID KEY
018250         MOVE 1 TO W-END
018260         DISPLAY E-STAT E-ME25 E-JMST E-ME99.
018270 JMD-EX.
018280     EXIT.
018290 NJW-RTN.
018300     INITIALIZE NJZAI-R.
018310     MOVE W-SOK TO NJZAI-01.
018320     MOVE W-HCD(W-GN) TO NJZAI-02.
018330     MOVE W-SKB(W-GN) TO NJZAI-03.
018340     READ NJZAI INVALID KEY
018350         DISPLAY E-ME22 E-NJZAI E-ME99
018360         GO TO NJW-10.
018370     MOVE W-SNO(W-GN) TO CNT.
018380     ADD W-SU(W-GN) TO NJZAI-0911(CNT).
018390     REWRITE NJZAI-R INVALID KEY
018400         MOVE 1 TO W-END
018410         DISPLAY E-STAT E-ME26 E-NJZAI E-ME99
018420         GO TO NJW-EX.
018430     GO TO NJW-30.
018440 NJW-10.
018450     MOVE W-SNO(W-GN) TO CNT.
018460     ADD W-SU(W-GN) TO NJZAI-0911(CNT).
018470     WRITE NJZAI-R INVALID KEY
018480         GO TO NJW-20.
018490     GO TO NJW-30.
018500 NJW-20.
018510     DISPLAY E-STAT E-ME27 E-NJZAI E-ME99
018520     IF ERR-STAT NOT = 24
018530         MOVE 1 TO W-END
018540         DISPLAY E-ME78 E-ME99
018550         GO TO NJW-EX.
018560     CLOSE NJZAI.
018570     MOVE "NJZAI        " TO W-FILE.
018580     DISPLAY E-CL.
018590     DISPLAY E-ME71 E-ME98.
018600     STOP " ".
018610     DISPLAY E-CL.
018620     OPEN I-O NJZAI
018630     GO TO NJW-RTN.
018640 NJW-30.
018650     INITIALIZE NJZAI-R.
018660     MOVE 9 TO NJZAI-01.
018670     MOVE W-HCD(W-GN) TO NJZAI-02.
018680     MOVE W-SKB(W-GN) TO NJZAI-03.
018690     READ NJZAI INVALID KEY
018700         DISPLAY E-ME22 E-NJZAI E-ME99
018710         GO TO NJW-40.
018720     MOVE W-SNO(W-GN) TO CNT.
018730     ADD W-SU(W-GN) TO NJZAI-0911(CNT).
018740     REWRITE NJZAI-R INVALID KEY
018750         MOVE 1 TO W-END
018760         DISPLAY E-STAT E-ME26 E-NJZAI E-ME99.
018770     GO TO NJW-EX.
018780 NJW-40.
018790     MOVE W-SNO(W-GN) TO CNT.
018800     ADD W-SU(W-GN) TO NJZAI-0911(CNT).
018810     WRITE NJZAI-R INVALID KEY
018820         GO TO NJW-50.
018830     GO TO NJW-EX.
018840 NJW-50.
018850     DISPLAY E-STAT E-ME27 E-NJZAI E-ME99
018860     IF ERR-STAT NOT = 24
018870         MOVE 1 TO W-END
018880         DISPLAY E-ME78 E-ME99
018890         GO TO NJW-EX.
018900     CLOSE NJZAI.
018910     MOVE "NJZAI        " TO W-FILE.
018920     DISPLAY E-CL.
018930     DISPLAY E-ME71 E-ME98.
018940     STOP " ".
018950     DISPLAY E-CL.
018960     OPEN I-O NJZAI
018970     GO TO NJW-30.
018980 NJW-EX.
018990     EXIT.
019000 NJD-RTN.
019010     MOVE SPACE TO NJZAI-KEY.
019020     MOVE TDI-SOK TO NJZAI-01.
019030     MOVE TDI-HCD TO NJZAI-02.
019040     MOVE TDI-SKB TO NJZAI-03.
019050     READ NJZAI INVALID KEY
019060         DISPLAY E-ME22 E-NJZAI E-ME99
019070         GO TO NJD-EX.
019080     SUBTRACT TDI-SU FROM NJZAI-0911(TDI-SNO).
019090     REWRITE NJZAI-R INVALID KEY
019100         MOVE 1 TO W-END
019110         DISPLAY E-STAT E-ME26 E-NJZAI E-ME99
019120         GO TO NJD-EX.
019130*
019140     MOVE SPACE TO NJZAI-KEY.
019150     MOVE 9 TO NJZAI-01.
019160     MOVE TDI-HCD TO NJZAI-02.
019170     MOVE TDI-SKB TO NJZAI-03.
019180     READ NJZAI INVALID KEY
019190         DISPLAY E-ME22 E-NJZAI E-ME99
019200         GO TO NJD-EX.
019210     SUBTRACT TDI-SU FROM NJZAI-0911(TDI-SNO).
019220     REWRITE NJZAI-R INVALID KEY
019230         MOVE 1 TO W-END
019240         DISPLAY E-STAT E-ME26 E-NJZAI E-ME99
019250         GO TO NJD-EX.
019260 NJD-EX.
019270     EXIT.
019280 MID-RTN.
019290     MOVE SPACE TO SP-R.
019300     WRITE SP-R AFTER PAGE.
019310 MID-10.
019320     ADD 1 TO W-PAGE.
019330     MOVE W-PAGE TO H-PAGE.
019340     MOVE SPACE TO SP-R.
019350     MOVE HEAD1 TO SP-R.
019360     WRITE SP-R.
019370     MOVE SPACE TO SP-R.
019380     MOVE HEAD2 TO SP-R.
019390     WRITE SP-R AFTER 2.
019400     MOVE SPACE TO SP-R.
019410     MOVE HEAD3 TO SP-R.
019420     WRITE SP-R.
019430     MOVE SPACE TO SP-R.
019440 MID-EX.
019450     EXIT.
019460 PR1-RTN.
019470     IF LINAGE-COUNTER > 63
019480         PERFORM MID-RTN THRU MID-EX.
019490     MOVE SPACE TO SP-R.
019500     MOVE W-P1 TO SP-R.
019510     WRITE SP-R.
019520     MOVE SPACE TO SP-R.
019530 PR1-EX.
019540     EXIT.
019550 PR2-RTN.
019560     MOVE TDI-HCD TO HI-MHCD HI-HCD.
019570     READ HI2-M WITH UNLOCK INVALID KEY
019580         MOVE SPACE TO HI-NAME
019590         MOVE NC"＊　品名なし　＊" TO HI-NAME.
019600     MOVE 0 TO HI-S(4,10).                                        I.091002
019610     IF TDI-GNO = 1
019620         PERFORM PR1-RTN THRU PR1-EX.
019630     MOVE SPACE TO W-P2.
019640     MOVE SPACE TO P-HNA
019650     MOVE "-" TO P-V1.
019660     MOVE TDI-GNO TO P-GNO.
019670     IF TDI-JNO NOT = ZERO
019680         MOVE TDI-JNO TO P-JNO
019690         MOVE "-" TO P-V2
019700         MOVE TDI-JGN TO P-JGN.
019710     MOVE TDI-HCD TO P-HCD.
019720     MOVE HI-NAME TO P-HNA.
019730     MOVE TDI-SIZ TO W-SIZM.
019740     PERFORM SIZ-RTN THRU SIZ-EX.
019750     MOVE W-SIZN TO P-SIZ.
019760     MOVE TDI-SU TO P-SU.
019770     MOVE TDI-GT TO P-GT.
019780     MOVE TDI-GKIN TO P-GKIN.
019790     IF ZERO NOT = TDI-UT AND TDI-UKIN
019800         MOVE TDI-UT TO P-UT
019810         MOVE TDI-UKIN TO P-UKIN.
019820     IF TDI-TCD = 4990
019830         MOVE TDI-TRN TO P-TMS.
019840     IF LINAGE-COUNTER > 64
019850         PERFORM MID-RTN THRU MID-EX.
019860     MOVE SPACE TO SP-R.
019870     MOVE W-P2 TO SP-R.
019880     WRITE SP-R.
019890     MOVE SPACE TO SP-R.
019900*
019910     ADD TDI-SU TO WT-SU.
019920     ADD TDI-GKIN TO WT-GKIN.
019930     ADD TDI-UKIN TO WT-UKIN.
019940 PR2-EX.
019950     EXIT.
019960 PR3-RTN.
019970     MOVE WT-SU TO P-TSU.
019980     MOVE WT-GKIN TO P-TGKIN.
019990     MOVE WT-UKIN TO P-TUKIN.
020000     IF LINAGE-COUNTER > 63
020010         PERFORM MID-RTN THRU MID-EX.
020020     MOVE SPACE TO SP-R.
020030     MOVE W-P3 TO SP-R.
020040     WRITE SP-R.
020050     MOVE SPACE TO SP-R.
020060 PR3-EX.
020070     EXIT.
