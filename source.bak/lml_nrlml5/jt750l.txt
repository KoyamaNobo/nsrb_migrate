000010 IDENTIFICATION                 DIVISION.
000020 PROGRAM-ID.                    JT750L.
000030***************************************************
000040*    PROGRAM        : 受注数合計表（得意先品名別）*
000050*    DATA WRITTEN   : 98/02/12                    *
000060*    SCREEN USED    : UNUSED                      *
000070***************************************************
000080 ENVIRONMENT                    DIVISION.
000090 CONFIGURATION                  SECTION.
000100 SOURCE-COMPUTER.               SYSTEM150.
000110 OBJECT-COMPUTER.               SYSTEM150.
000120 INPUT-OUTPUT                   SECTION.
000130 FILE-CONTROL.
000140     SELECT   JT-WK07   ASSIGN  F1-MSD.
000150     SELECT   TC-M      ASSIGN  F2-MSD
000160                        ORGANIZATION  INDEXED
000170                        ACCESS MODE   RANDOM
000180                        RECORD KEY    TC-KEY.
000190*****SELECT   SHM       ASSIGN  F3-MSD                            D.010818
000200     SELECT   HI2-M     ASSIGN  F3-MSD                            I.010818
000210                        ORGANIZATION  INDEXED
000220                        ACCESS MODE   RANDOM
000230                        RECORD KEY    HI-KEY2.                    I.010818
000240*****                   RECORD KEY    SHM-KEY.                    D.010818
000250     SELECT   SP-F      ASSIGN  P1-PRN999.
000260 I-O-CONTROL.
000270*****APPLY   SHARED-MODE ON  TC-M    SHM                          D.010818
000280     APPLY   SHARED-MODE ON  TC-M    HI2-M                        I.010818
000290     APPLY   SHIFT-CODE  ON  SP-F.
000300 DATA                       DIVISION.
000310 FILE                       SECTION.
000320     COPY  LTWK07.
000330     COPY  LITCM.
000340     COPY  LIHIM2.                                                I.010818
000350*****COPY  L-SHM.                                                 D.010818
000360 FD  SP-F
000370     LABEL  RECORD   OMITTED   LINAGE    66.
000380 01  SP-R               PIC X(256).
000390 WORKING-STORAGE            SECTION.
000400 77  ERR-STAT           PIC X(02)    VALUE SPACE.
000410 77  WK0128ID           PIC  X(009) VALUE SPACE.
000420 01  STN-NO.
000430     02  STN-NO1        PIC  X(003).
000440     02  STN-NO2        PIC  X(003).
000450 01  W-FID.
000460     02  W-FID1         PIC  X(006) VALUE "WK0128".
000470     02  W-FID2         PIC  X(003).
000480 01  HEAD1.
000490     02  W-20K          PIC X(05)  VALUE  ""3FE04FE080"".
000500     02  F              PIC X(35)  VALUE   SPACE.
000510     02  FILLER         PIC N(05)  VALUE  NC"＊＊＊　　".
000520     02  FILLER         PIC X(01)  VALUE  "'".
000530     02  H-NEN          PIC 9(02).
000540     02  FILLER         PIC N(01)  VALUE  NC"年".
000550     02  H-GET          PIC Z9.
000560     02  FILLER         PIC N(02)  VALUE  NC"月分".
000570     02  FILLER         PIC N(18)  VALUE
000580          NC"　得意先品名別　受注合計表　　＊＊＊".
000590     02  F              PIC X(22)  VALUE   SPACE.
000600     02  H-YY           PIC 9(02).
000610     02  FILLER         PIC N(01)  VALUE  NC"年".
000620     02  H-MM           PIC Z9.
000630     02  FILLER         PIC N(01)  VALUE  NC"月".
000640     02  H-DD           PIC Z9.
000650     02  FILLER         PIC N(01)  VALUE  NC"日".
000660     02  FILLER         PIC X(07)  VALUE  "     P.".
000670     02  H-PAGE         PIC ZZ9.
000680 01  HEAD2.
000690     02  W-15K          PIC X(05)  VALUE  ""3FE04F40A0"".
000700     02  FILLER         PIC X(05)  VALUE  "ｺｰﾄﾞ ".
000710     02  FILLER         PIC N(08)  VALUE   NC"得　意　先　名　".
000720     02  FILLER         PIC X(119) VALUE  SPACE.
000730 01  HEAD3.
000740     02  FILLER         PIC X(08)  VALUE  "  ｺｰﾄﾞ  ".
000750     02  FILLER         PIC N(06)  VALUE  NC"品　　　名　".
000760     02  FILLER         PIC X(28)  VALUE  SPACE.
000770     02  FILLER         PIC X(01)  VALUE  "1".
000780     02  FILLER         PIC X(05)  VALUE  SPACE.
000790     02  FILLER         PIC N(02)  VALUE  NC"３号".
000800     02  FILLER         PIC X(05)  VALUE  SPACE.
000810     02  FILLER         PIC N(02)  VALUE  NC"２号".
000820     02  FILLER         PIC X(05)  VALUE  SPACE.
000830     02  FILLER         PIC N(02)  VALUE  NC"１号".
000840     02  FILLER         PIC X(05)  VALUE  SPACE.
000850     02  FILLER         PIC N(02)  VALUE  NC"０号".
000860     02  FILLER         PIC X(05)  VALUE  SPACE.
000870     02  FILLER         PIC N(02)  VALUE  NC"　中".
000880     02  FILLER         PIC X(05)  VALUE  SPACE.
000890     02  FILLER         PIC N(02)  VALUE  NC"　大".
000900     02  FILLER         PIC X(05)  VALUE  SPACE.
000910     02  FILLER         PIC N(02)  VALUE  NC"特大".
000920     02  FILLER         PIC X(04)  VALUE  SPACE.
000930     02  FILLER         PIC X(04)  VALUE  "28.0".
000940     02  FILLER         PIC X(04)  VALUE  SPACE.
000950     02  FILLER         PIC X(04)  VALUE  "29.0".
000960     02  FILLER         PIC X(04)  VALUE  SPACE.
000970     02  FILLER         PIC X(04)  VALUE  "30.0".
000980     02  FILLER         PIC X(10)  VALUE  SPACE.
000990 01  HEAD4.
001000     02  FILLER         PIC X(45)  VALUE  SPACE.
001010     02  FILLER         PIC X(01)  VALUE  "2".
001020     02  FILLER         PIC X(04)  VALUE  SPACE.
001030     02  FILLER         PIC X(04)  VALUE  "12.5".
001040     02  FILLER         PIC X(04)  VALUE  SPACE.
001050     02  FILLER         PIC X(04)  VALUE  "13.0".
001060     02  FILLER         PIC X(04)  VALUE  SPACE.
001070     02  FILLER         PIC X(04)  VALUE  "13.5".
001080     02  FILLER         PIC X(04)  VALUE  SPACE.
001090     02  FILLER         PIC X(04)  VALUE  "14.0".
001100     02  FILLER         PIC X(04)  VALUE  SPACE.
001110     02  FILLER         PIC X(04)  VALUE  "15.0".
001120     02  FILLER         PIC X(04)  VALUE  SPACE.
001130     02  FILLER         PIC X(04)  VALUE  "16.0".
001140     02  FILLER         PIC X(04)  VALUE  SPACE.
001150     02  FILLER         PIC X(04)  VALUE  "17.0".
001160     02  FILLER         PIC X(04)  VALUE  SPACE.
001170     02  FILLER         PIC X(04)  VALUE  "18.0".
001180     02  FILLER         PIC X(04)  VALUE  SPACE.
001190     02  FILLER         PIC X(04)  VALUE  "19.0".
001200     02  FILLER         PIC X(04)  VALUE  SPACE.
001210     02  FILLER         PIC X(04)  VALUE  "20.0".
001220     02  FILLER         PIC X(10)  VALUE  SPACE.
001230 01  HEAD5.
001240     02  FILLER         PIC X(45)  VALUE  SPACE.
001250     02  FILLER         PIC X(01)  VALUE  "3".
001260     02  FILLER         PIC X(04)  VALUE  SPACE.
001270     02  FILLER         PIC X(04)  VALUE  "21.0".
001280     02  FILLER         PIC X(04)  VALUE  SPACE.
001290     02  FILLER         PIC X(04)  VALUE  "21.5".
001300     02  FILLER         PIC X(04)  VALUE  SPACE.
001310     02  FILLER         PIC X(04)  VALUE  "22.0".
001320     02  FILLER         PIC X(04)  VALUE  SPACE.
001330     02  FILLER         PIC X(04)  VALUE  "22.5".
001340     02  FILLER         PIC X(04)  VALUE  SPACE.
001350     02  FILLER         PIC X(04)  VALUE  "23.0".
001360     02  FILLER         PIC X(04)  VALUE  SPACE.
001370     02  FILLER         PIC X(04)  VALUE  "23.5".
001380     02  FILLER         PIC X(04)  VALUE  SPACE.
001390     02  FILLER         PIC X(04)  VALUE  "24.0".
001400     02  FILLER         PIC X(04)  VALUE  SPACE.
001410     02  FILLER         PIC X(04)  VALUE  "24.5".
001420     02  FILLER         PIC X(04)  VALUE  SPACE.
001430     02  FILLER         PIC X(04)  VALUE  "25.0".
001440     02  FILLER         PIC X(18)  VALUE  SPACE.
001450 01  HEAD6.
001460     02  FILLER         PIC X(45)  VALUE  SPACE.
001470     02  FILLER         PIC X(01)  VALUE  "4".
001480     02  FILLER         PIC X(04)  VALUE  SPACE.
001490     02  FILLER         PIC X(04)  VALUE  "24.0".
001500     02  FILLER         PIC X(04)  VALUE  SPACE.
001510     02  FILLER         PIC X(04)  VALUE  "24.5".
001520     02  FILLER         PIC X(04)  VALUE  SPACE.
001530     02  FILLER         PIC X(04)  VALUE  "25.0".
001540     02  FILLER         PIC X(04)  VALUE  SPACE.
001550     02  FILLER         PIC X(04)  VALUE  "25.5".
001560     02  FILLER         PIC X(04)  VALUE  SPACE.
001570     02  FILLER         PIC X(04)  VALUE  "26.0".
001580     02  FILLER         PIC X(04)  VALUE  SPACE.
001590     02  FILLER         PIC X(04)  VALUE  "26.5".
001600     02  FILLER         PIC X(04)  VALUE  SPACE.
001610     02  FILLER         PIC X(04)  VALUE  "27.0".
001620     02  FILLER         PIC X(04)  VALUE  SPACE.
001630     02  FILLER         PIC X(04)  VALUE  "27.5".
001640     02  FILLER         PIC X(23)  VALUE  SPACE.
001650     02  FILLER         PIC N(02)  VALUE  NC"合計".
001660 01  W-P1.
001670     02  P1-01          PIC 9(4).
001680     02  F              PIC X.
001690     02  P1-02          PIC N(26).                                I.020418
001700*****02  P1-02          PIC N(24).                                D.020418
001710 01  W-P2.
001720     02  F              PIC X(01).
001730     02  P2-01          PIC 9(06).
001740     02  F              PIC X.
001750     02  P2-02          PIC N(24).
001760     02  F              PIC X.
001770     02  P2-03          PIC 9(01).
001780     02  P2-04        OCCURS   10.
001790       03  P2-041       PIC ----,---.
001800     02  P2-05          PIC --,---,--9.
001810 01  W-DATA.
001820     02  W-YMD.
001830       03  W-YY         PIC 9(02).
001840       03  W-MM         PIC 9(02).
001850       03  W-DD         PIC 9(02).
001860     02  W-PAGE         PIC 9(02).
001870     02  W-C.
001880       03  W-C1         PIC 9(01).
001890       03  W-C2         PIC 9(01).
001900     02  CNT            PIC 9(02).
001910     02  W-KEI          PIC S9(07).
001920     02  W-TCD          PIC 9(04).
001930     02  W-HCD          PIC 9(06).
001940     02  W-ASUD.
001950       03  W-ASU       OCCURS         4.
001960         04  W-SU       PIC  S9(06)  OCCURS 10.
001970     02  CHK.
001980       03  CHK1         PIC 9(01).
001990       03  CHK2         PIC 9(01).
002000       03  CHK3         PIC 9(01).
002010     02  W-ZCD.
002020       03  W-ZC         PIC 9(01)  OCCURS  4.
002030 COPY    LWMSG.
002040 SCREEN                  SECTION.
002050 SD  C-CRT
002060     END STATUS  IS  ESTAT.
002070 01  C-CLEAR         LINE  1.
002080     02  CLEAR   SCREEN.
002090 01  C-MID.
002100     02  DSP-01       LINE 1.
002110         03  COLUMN  23  VALUE
002120               "                          " REVERSE.
002130         03  COLUMN  24  VALUE
002140              NC"得意先品名別　受注合計表".
002150 COPY    LSMSG.
002160 PROCEDURE               DIVISION.
002170 M-05.
002180     DISPLAY C-CLEAR.
002190     DISPLAY C-MID.
002200     CALL "CBLSTNNO" USING STN-NO.
002210     MOVE STN-NO2 TO W-FID2.
002220     MOVE W-FID TO WK0128ID.
002230     OPEN INPUT JT-WK07.
002240 M-10.
002250     READ JT-WK07 AT END
002260         CLOSE JT-WK07
002270         DISPLAY C-CLEAR
002280         STOP RUN.
002290     IF ZERO = WK07-0511(01) AND WK07-0511(02) AND WK07-0511(03)
002300           AND WK07-0511(04) AND WK07-0511(05) AND WK07-0511(06)
002310           AND WK07-0511(07) AND WK07-0511(08) AND WK07-0511(09)
002320           AND WK07-0511(10)
002330         GO TO M-10.
002340     MOVE WK07-011 TO H-NEN.
002350     MOVE WK07-012 TO H-GET.
002360*
002370     ACCEPT W-YMD FROM DATE.
002380     MOVE W-YY TO H-YY.
002390     MOVE W-MM TO H-MM.
002400     MOVE W-DD TO H-DD.
002410     MOVE ZERO TO W-PAGE.
002420*****OPEN INPUT TC-M SHM.                                         D.010818
002430     OPEN INPUT TC-M HI2-M.                                       I.010818
002440     OPEN OUTPUT SP-F.
002450     PERFORM S-10 THRU S-15.
002460 M-15.
002470     MOVE WK07-02 TO W-TCD.
002480     MOVE WK07-02 TO TC-TCD.
002490     MOVE 001 TO TC-CCD.
002500     READ   TC-M    UNLOCK   INVALID
002510         MOVE   ALL NX"2121"  TO    TC-NAME.
002520     MOVE 0 TO CHK1.
002530 M-20.
002540     MOVE WK07-03 TO W-HCD.
002550*****MOVE WK07-03 TO SHM-01.                                      D.010818
002560*****READ   SHM    UNLOCK   INVALID                               D.010818
002570*****    MOVE   ALL NX"2121"  TO    SHM-02.                       D.010818
002580     MOVE WK07-03 TO HI-MHCD HI-HCD.                              I.010818
002590     READ   HI2-M  UNLOCK   INVALID                               I.010818
002600         MOVE   ALL NX"2121"  TO    HI-NAME.                      I.010818
002610*
002620     MOVE ZERO TO W-ASUD W-KEI W-ZCD.
002630 M-25.
002640     MOVE 1 TO W-ZC(WK07-04).
002650     MOVE ZERO TO CNT.
002660 M-30.
002670     ADD 1 TO CNT.
002680     IF CNT NOT = 11
002690         MOVE WK07-0511(CNT) TO W-SU(WK07-04,CNT)
002700         ADD WK07-0511(CNT) TO W-KEI
002710         GO TO M-30.
002720 M-35.
002730     READ JT-WK07 AT END
002740         GO TO M-60.
002750     IF (WK07-02 = W-TCD) AND (WK07-03 = W-HCD)
002760         GO TO M-25.
002770     PERFORM S-30 THRU S-45.
002780     IF WK07-02 NOT = W-TCD
002790         GO TO M-15.
002800     GO TO M-20.
002810 M-60.
002820     PERFORM S-30 THRU S-45.
002830 M-95.
002840*****CLOSE TC-M SHM.                                              D.010818
002850     CLOSE TC-M HI2-M.                                            I.010818
002860     CLOSE SP-F.
002870     CLOSE JT-WK07.
002880     DISPLAY C-CLEAR.
002890     STOP RUN.
002900 S-05.
002910     MOVE SPACE TO SP-R.
002920     WRITE SP-R AFTER PAGE.
002930 S-10.
002940     ADD 1 TO W-PAGE.
002950     MOVE W-PAGE TO H-PAGE.
002960     MOVE SPACE TO SP-R.
002970     MOVE HEAD1 TO SP-R.
002980     WRITE SP-R.
002990     MOVE SPACE TO SP-R.
003000     MOVE HEAD2 TO SP-R.
003010     WRITE SP-R.
003020     MOVE SPACE TO SP-R.
003030     MOVE HEAD3 TO SP-R.
003040     WRITE SP-R.
003050     MOVE SPACE TO SP-R.
003060     MOVE HEAD4 TO SP-R.
003070     WRITE SP-R.
003080     MOVE SPACE TO SP-R.
003090     MOVE HEAD5 TO SP-R.
003100     WRITE SP-R.
003110     MOVE SPACE TO SP-R.
003120     MOVE HEAD6 TO SP-R.
003130     WRITE SP-R.
003140 S-15.
003150     EXIT.
003160 S-20.
003170     MOVE SPACE TO W-P1.
003180     MOVE W-TCD TO P1-01.
003190     MOVE TC-NAME TO P1-02.
003200     IF LINAGE-COUNTER > 57
003210         PERFORM S-05 THRU S-15.
003220     MOVE SPACE TO SP-R.
003230     MOVE W-P1 TO SP-R.
003240     WRITE SP-R.
003250 S-25.
003260     EXIT.
003270 S-30.
003280     IF W-ZCD = ZERO
003290         GO TO S-45.
003300     IF W-ZC(2) = 1
003310         MOVE 2 TO CHK3.
003320     IF W-ZC(3) = 1
003330         MOVE 3 TO CHK3.
003340     IF W-ZC(4) = 1
003350         MOVE 4 TO CHK3.
003360     IF W-ZC(1) = 1
003370         MOVE 1 TO CHK3.
003380     IF CHK1 = 0
003390         MOVE 1 TO CHK1
003400         PERFORM S-20 THRU S-25.
003410     MOVE 0 TO W-C1 CHK2.
003420 S-35.
003430     ADD 1 TO W-C1.
003440     IF W-C1 = 5
003450         GO TO S-45.
003460     IF W-C1 = 1
003470         MOVE 4 TO W-C2.
003480     IF W-C1 = 2
003490         MOVE 1 TO W-C2.
003500     IF W-C1 = 3
003510         MOVE 2 TO W-C2.
003520     IF W-C1 = 4
003530         MOVE 3 TO W-C2.
003540     IF W-ZC(W-C2) = 0
003550         GO TO S-35.
003560     MOVE SPACE TO W-P2.
003570     MOVE SPACE TO P2-02.
003580     IF CHK2 = 0
003590         MOVE 1 TO CHK2
003600         MOVE W-HCD TO P2-01
003610         MOVE HI-NAME TO P2-02.                                   I.010818
003620*****    MOVE SHM-02 TO P2-02.                                    D.010818
003630     MOVE W-C2 TO P2-03.
003640     MOVE ZERO TO CNT.
003650 S-40.
003660     ADD 1 TO CNT.
003670     IF CNT NOT = 11
003680         MOVE W-SU(W-C2,CNT) TO P2-041(CNT)
003690         GO TO S-40.
003700     IF CHK3 = W-C2
003710         MOVE W-KEI TO P2-05.
003720     IF LINAGE-COUNTER > 58
003730         MOVE W-HCD TO P2-01
003740         MOVE HI-NAME TO P2-02                                    I.010818
003750*****    MOVE SHM-02 TO P2-02                                     D.010818
003760         PERFORM S-05 THRU S-15
003770         PERFORM S-20 THRU S-25.
003780     MOVE SPACE TO SP-R.
003790     MOVE W-P2 TO SP-R.
003800     WRITE SP-R.
003810     MOVE SPACE TO SP-R.
003820     IF CHK3 NOT = W-C2
003830         GO TO S-35.
003840 S-45.
003850     EXIT.
