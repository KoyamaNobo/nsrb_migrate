000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         JT060L.
000030**************************************************
000040**************************************************
000050**                                              **
000060**     ëóÇËèÛî≠çsÅiâ™éRåßâ›ï®ópÅj               **
000070**                                              **
000080**        USER  NAME : ì˙êiÉSÉÄ.                **
000090**        DATE       : 2001•01•23               **
000100**        TYPE       : COBOL                    **
000110**        PROGRAM-ID : JT060L                   **
000120**        SCREEN-ID  : ------.                  **
000130**        AUTHOR     :                          **
000140**        JS-SIGN    :  ñ{é–=0 , ëIë=1         **
000150**************************************************
000160**************************************************
000170 ENVIRONMENT         DIVISION.
000180 CONFIGURATION       SECTION.
000190 SOURCE-COMPUTER.    SYSTEM150.
000200 OBJECT-COMPUTER.    SYSTEM150.
000210 INPUT-OUTPUT        SECTION.
000220 FILE-CONTROL.
000230     COPY  LIBCSE.
000240*****SELECT  GDMM   ASSIGN  GDMM-MSD                              D.011018
000250*****               ORGANIZATION  INDEXED                         D.011018
000260*****               ACCESS  MODE  RANDOM                          D.011018
000270*****               RECORD  KEY   GDMM-KEY                        D.011018
000280*****               FILE  STATUS  ERR-STAT.                       D.011018
000290     SELECT  OKJF     ASSIGN  TO  F1-MSD                          ëóÇËèÛÇe
000300         ORGANIZATION         INDEXED
000310         ACCESS               DYNAMIC
000320         RECORD               OKJF-KEY
000330         FILE STATUS          IS  ERR-STAT.
000340     SELECT  TC-M     ASSIGN  TO  F2-MSD                          íºëóêÊÇl
000350         ORGANIZATION         INDEXED
000360         ACCESS               DYNAMIC
000370         RECORD               TC-KEY
000380         FILE STATUS          IS  ERR-STAT.
000390     SELECT  JCON     ASSIGN  TO  F3-MSD                          ÇbÇmÇsÇe
000400         ORGANIZATION         INDEXED
000410         ACCESS               DYNAMIC
000420         RECORD               JCON3-KEY
000430         FILE STATUS          IS  ERR-STAT.
000440     SELECT  P-F      ASSIGN  TO  P-PRN999.
000450 I-O-CONTROL.
000460     APPLY  SHARED-MODE  ON  OKJF  TC-M  JCON
000470*****                        GDMM                                 D.011018
000480                             M-DATE
000490     APPLY   SHIFT-CODE ON P-F.
000500*********************************************
000510**                                          *
000520**        DATA             DIVISION         *
000530**                                          *
000540*********************************************
000550 DATA                DIVISION.
000560 FILE                SECTION.
000570     COPY  LIBFDD.
000580*****COPY  L-GDMM.                                                D.011018
000590     COPY  LOKJF.
000600     COPY  L-JCON.
000610     COPY  LITCM.
000620*
000630 FD  P-F
000640     LABEL       RECORD  OMITTED
000650     LINAGE          IS       24.
000660 01  P-R                     PIC     X(136).
000670*
000680 01  P-R1.                                                        5 LINE
000690     03  CODEK1              PIC     X(05).                       2.0 BYTE
000700*****03  F                   PIC     X(15).                       D.041206
000710     03  F                   PIC     X(14).                       I.041206
000720     03  R1-01               PIC     9(02).                       YY
000730*****03  F                   PIC     X(03).                       D.020820
000740     03  F                   PIC     X(02).                       I.020820
000750     03  R1-02               PIC     Z9.                          MM
000760     03  F                   PIC     X(02).
000770     03  R1-03               PIC     Z9.                          DD
000780 01  P-R2.                                                        îzíBéwíË
000790     03  CODEK2              PIC     X(05).                       1.5 BYTE
000800*****03  F                   PIC     X(11).                       D.041206
000810     03  F                   PIC     X(10).                       I.041206
000820     03  R2-01               PIC     N(10).
000830 01  P-R3.                                                        ëqå…
000840     03  CODEK3              PIC     X(05).                       1.5 BYTE
000850*****03  F                   PIC     X(11).                       D.041206
000860     03  F                   PIC     X(10).                       I.041206
000870     03  R3-01               PIC     N(08).
000880 01  P-R4.                                                        16 LINE
000890     03  CODEK4              PIC     X(05).                       1.5 BYTE
000900*****03  F                   PIC     X(18).                       D.041206
000910     03  F                   PIC     X(17).                       I.041206
000920     03  R4-05               PIC     N(02).                       I.020820
000930*****03  R4-05               PIC     N(01).                       D.020820
000940*****03  F                   PIC     X(01).                       D.020820
000950     03  R4-03               PIC     9(06).                       ëóÇËèÛáÇ
000960 01  P-R4A.                                                       I.040917
000970     03  CODEK4A             PIC     X(05).                       I.040917
000980*****03  F                   PIC     X(28).                       D.041206
000990     03  F                   PIC     X(27).                       I.041206
001000     03  R4-99               PIC     N(06).                       I.040917
001010 01  P-R5.                                                        èZèä
001020     03  CODEK5              PIC     X(05).                       1.5 BYTE
001030*****03  F                   PIC     X(06).                       D.041206
001040     03  F                   PIC     X(05).                       I.041206
001050     03  R5-01               PIC     N(14).
001060*****03  R5-010   REDEFINES  R5-01.                               D.020820
001070*****    04  F               PIC     N(02).                       D.020820
001080*****    04  R5-011          PIC     N(12).                       D.020820
001090*****03  F                   PIC     X(05).                       D.060221
001100     03  F                   PIC     X(03).                       I.060221
001110     03  R5-02               PIC     N(14).
001120 01  P-R6.                                                        TEL
001130*****03  F                   PIC     X(11).                       D.041206
001140     03  F                   PIC     X(10).                       I.041206
001150     03  R6-01               PIC     X(14).
001160     03  F                   PIC     X(13).
001170     03  R6-02               PIC     X(14).
001180 01  P-R7.                                                        ñºëO
001190     03  CODEK7A             PIC     X(05).                       1.5 BYTE
001200*****03  F                   PIC     X(07).                       D.020806
001210*****03  R7-01               PIC     N(12).                       D.020806
001220*****03  F                   PIC     X(11).                       D.020806
001230*****03  F                   PIC     X(06).                       D.041206
001240     03  F                   PIC     X(05).                       I.041206
001250     03  R7-01               PIC     N(14).                       I.020806
001260*****03  F                   PIC     X(09).                       D.060221
001270*****03  R7-02               PIC     N(10).                       D.060221
001280*****03  F                   PIC     X(05).                       D.060221
001290     03  F                   PIC     X(03).                       I.060221
001300     03  R7-02               PIC     N(14).                       I.060221
001310     03  F                   PIC     X(04).                       I.060221
001320     03  R7-03               PIC       ZZ9.
001330*********************************************
001340**                                          *
001350**        WORKING  STORAGE  SECTION         *
001360**                                          *
001370*********************************************
001380 WORKING-STORAGE     SECTION.
001390 01  ERR-STAT        PIC X(02).                                   FILE ERR
001400 01  JS-SIGN         PIC X(01).
001410 01  W-JS            PIC X(01).
001420*01  W-JS-MEI        PIC N(05).                                   D.030722
001430******************************
001440*     WORK         AREA      *
001450******************************
001460 01  WORK-AREA.
001470     03  ENDFLG        PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001480     03  ENDFLG2       PIC     X(03).                             ÿ∞ƒﬁÃ◊∏ﬁ
001490     03  ACT1          PIC     9.                                 TEST
001500     03  ACT2          PIC     9.
001510     03  ACT3          PIC     9(06).                             áÇ
001520     03  ACTK          PIC     9(01).                             ∂∏∆›
001530     03  LCNT          PIC     9(02).                             ◊≤›∂≥›¿∞
001540     03  DSW           PIC     9(01).                             DATAóLñ≥
001550     03  DATE-WORK.
001560         05  YY        PIC     9(02).
001570         05  MM        PIC     9(02).
001580         05  DD        PIC     9(02).
001590*****03  JSUX.                                                    D.020820
001600*****    05  JSU1      PIC     N(14).                             D.020820
001610*****    05  JSU2      PIC     N(10).                             D.020820
001620*****03  NAMEX.                                                   D.020820
001630*****    05  N1        PIC     N(12).                             D.020820
001640*****    05  N2        PIC     N(12).                             D.020820
001650     03  W-JU1.                                                   I.020820
001660         05  W-JUFC       PIC    N(14).                           I.020820
001670         05  W-JUR        PIC    N(06).                           I.020820
001680     03  W-JU2   REDEFINES  W-JU1.                                I.020820
001690         05  W-JUF        PIC    N(06).                           I.020820
001700         05  W-JUCR       PIC    N(14).                           I.020820
001710     03  W-JS1.                                                   I.020820
001720         05  W-JSFC       PIC    N(14).                           I.020820
001730         05  W-JSR        PIC    N(06).                           I.020820
001740     03  W-JS2   REDEFINES  W-JS1.                                I.020820
001750         05  W-JSF        PIC    N(06).                           I.020820
001760         05  W-JSCR       PIC    N(14).                           I.020820
001770     03  W-JPC            PIC    9(01).                           I.020820
001780     03  W-JUS1           PIC    N(14).                           I.020820
001790     03  W-JUS2.                                                  I.020820
001800       05  W-JUS2F        PIC    N(06).                           I.020820
001810       05  W-JUS2C        PIC    N(02).                           I.020820
001820       05  W-JUS2R        PIC    N(06).                           I.020820
001830     03  W-JUS3.                                                  I.020820
001840       05  W-JUS3F        PIC    N(06).                           I.020820
001850       05  W-JUS3C        PIC    N(02).                           I.020820
001860       05  W-JUS3R        PIC    N(06).                           I.020820
001870     03  W-NGP.
001880       04  F              PIC 9(02).
001890       04  W-NGPS         PIC 9(06).
001900     03  W-NGPL         REDEFINES  W-NGP.
001910       04  W-NEN          PIC 9(04).
001920       04  W-NENL       REDEFINES  W-NEN.
001930         05  W-NEN1       PIC 9(02).
001940         05  W-NEN2       PIC 9(02).
001950       04  F              PIC 9(04).
001960     03  W-SDATE          PIC 9(08).
001970     03  W-EDATE          PIC 9(08).
001980     03  W-SNGP.
001990       04  W-SNEN       PIC 9(04).
002000       04  W-SNENL      REDEFINES  W-SNEN.
002010         05  W-SNEN1      PIC 9(02).
002020         05  W-SNEN2      PIC 9(02).
002030       04  W-SGET         PIC 9(02).
002040       04  W-SPEY         PIC 9(02).
002050     03  W-ENGP.
002060       04  W-ENEN       PIC 9(04).
002070       04  W-ENENL      REDEFINES  W-ENEN.
002080         05  W-ENEN1      PIC 9(02).
002090         05  W-ENEN2      PIC 9(02).
002100       04  W-EGET         PIC 9(02).
002110       04  W-EPEY         PIC 9(02).
002120     03  W-POC            PIC 9(01).                              I.030722
002130     03  W-FOC            PIC 9(01).                              I.030722
002140     03  W-SOK            PIC 9(01).                              I.060221
002150 01  SOM.                                                         ëqÅ@ñº
002160     03  F1        PIC     N(01)     VALUE    NC"Åi".
002170     03  F2        PIC     N(06).
002180     03  F3        PIC     N(01)     VALUE    NC"Åj".
002190 01  WN-AREA.                                                     I.020820
002200     02  WN-DCHK        PIC  9(001).                              I.020820
002210     02  WN-CNT1        PIC  9(002).                              I.020820
002220     02  WN-CNT2        PIC  9(002).                              I.020820
002230     02  WN-CNT3        PIC  9(002).                              I.020820
002240     02  WN-CNT4        PIC  9(002).                              I.020820
002250     02  WN-NAME        PIC  N(026).                              I.020820
002260     02  WN-ANA   REDEFINES WN-NAME.                              I.020820
002270       03  WN-NAD   OCCURS  26.                                   I.020820
002280         04  WN-NA      PIC  N(001).                              I.020820
002290     02  WN-WNAME       PIC  N(026).                              I.020820
002300     02  WN-WANA   REDEFINES WN-WNAME.                            I.020820
002310       03  WN-WNAD   OCCURS  26.                                  I.020820
002320         04  WN-WNA     PIC  N(001).                              I.020820
002330     02  WN-ONAME       PIC  N(014).                              I.020820
002340     02  WN-AONA  REDEFINES WN-ONAME.                             I.020820
002350       03  WN-ONAD  OCCURS  14.                                   I.020820
002360         04  WN-ONA     PIC  N(001).                              I.020820
002370     02  WN-UNAME       PIC  N(014).                              I.020820
002380     02  WN-AUNA  REDEFINES WN-UNAME.                             I.020820
002390       03  WN-UNAD  OCCURS  14.                                   I.020820
002400         04  WN-UNA     PIC  N(001).                              I.020820
002410     02  WN-KUM         PIC  N(004).                              I.020820
002420     02  WN-AKUM  REDEFINES WN-KUM.                               I.020820
002430       03  WN-KUMD  OCCURS   4.                                   I.020820
002440         04  WN-KU      PIC  N(001).                              I.020820
002450     COPY    LWMSG.                                               COPYLIB.
002460*********************************************
002470**                                          *
002480**        SCREEN            SECTION         *
002490**                                          *
002500*********************************************
002510 SCREEN             SECTION.
002520 SD  CRT-X
002530     END  STATUS    IS   ESTAT.
002540 01  DISP-CLEAR.
002550     03  CLE-01     LINE   1     CLEAR  SCREEN.
002560******************************
002570*     DISPLAY      SECTION.  *
002580******************************
002590 01  DISP-AREA1.
002600*****03  DSP-JS   LINE  1  COLUMN   1  PIC  N(05)  FROM  W-JS-MEI.D.030722
002610     03  DSP-RVE  LINE  1  COLUMN  20  PIC  X(12)  VALUE
002620                                           " "  REVERSE.
002630     03  DISP-01  LINE  1  COLUMN  21  PIC  N(05)  VALUE
002640                                         NC"ëóÇËèÛî≠çs".
002650*****03  DISP-02  LINE  3  COLUMN  11  PIC  N(05)  VALUE          D.060221
002660     03  DISP-02  LINE  1  COLUMN  09  PIC  N(05)  VALUE          I.060221
002670                                     NC"â™éRåßâ›ï®".
002680*****03  DISP-03  LINE  6  COLUMN  13  PIC  N(09)  VALUE          D.060221
002690     03  DISP-03  LINE  5  COLUMN  13  PIC  N(09)  VALUE          I.060221
002700                                 NC"ÉeÉXÉgÉvÉäÉìÉgàÛéö".
002710*****03  DISP-04  LINE  6  COLUMN  32  PIC  X(12)  VALUE          D.060221
002720     03  DISP-04  LINE  5  COLUMN  32  PIC  X(12)  VALUE          I.060221
002730                                       "(YES=1,NO=2)".
002740     03  DISP-04A LINE  9.                                        I.030722
002750         04  COLUMN  13  PIC  N(03)  VALUE  NC"ã≥Å@àÁ".           I.030722
002760         04  COLUMN  19  PIC  X(05)  VALUE    "=0 , ".            I.030722
002770*****    04  COLUMN  24  PIC  N(03)  VALUE  NC"ÉèÅ[ÉN".           D.070411
002780         04  COLUMN  24  PIC  N(03)  VALUE  NC"àÍÅ@î ".           I.070411
002790         04  COLUMN  30  PIC  X(05)  VALUE    "=1 , ".            I.030722
002800         04  COLUMN  35  PIC  N(03)  VALUE  NC"Ç`ÇkÇk".           I.070411
002810         04  COLUMN  41  PIC  X(06)  VALUE    "=9    ".           I.070411
002820*****    04  COLUMN  35  PIC  N(05)  VALUE  NC"ÉJÉWÉÖÉAÉã".       D.070411
002830*****    04  COLUMN  45  PIC  X(05)  VALUE    "=2 , ".            D.070411
002840*****    04  COLUMN  50  PIC  N(03)  VALUE  NC"Ç`ÇkÇk".           D.070411
002850*****    04  COLUMN  56  PIC  X(06)  VALUE    "=9    ".           D.070411
002860*****03  DISP-05  LINE  9  COLUMN  13  PIC  N(06)  VALUE          D.030722
002870     03  DISP-05  LINE 11  COLUMN  13  PIC  N(06)  VALUE          I.030722
002880                                       NC"ÇPÅDêVãKî≠çs".
002890*****03  DISP-06  LINE 11  COLUMN  13  PIC  N(05)  VALUE          D.030722
002900     03  DISP-06  LINE 13  COLUMN  13  PIC  N(05)  VALUE          I.030722
002910                                       NC"ÇQÅDçƒî≠çs".
002920*****03  DISP-07  LINE 13  COLUMN  17  PIC  N(02)  VALUE          D.030722
002930     03  DISP-07  LINE 13  COLUMN  30  PIC  N(02)  VALUE          I.030722
002940                                       NC"ëIë".
002950*****03  DISP-08  LINE 13  COLUMN  22  PIC  X(03)  VALUE          D.030722
002960     03  DISP-08  LINE 13  COLUMN  35  PIC  X(03)  VALUE          I.030722
002970                                       "[ ]".
002980     03  DISP-09  LINE 23  COLUMN  41  PIC  N(03)  VALUE
002990                                       NC"ämîFÅi".
003000     03  DISP-10  LINE 23  COLUMN  47  PIC  X(09)  VALUE
003010                                       "OK=1,NO=9".
003020     03  DISP-11  LINE 23  COLUMN  56  PIC  N(01)  VALUE
003030                                       NC"Åj".
003040     03  DISP-12  LINE 23  COLUMN  58  PIC  X(08)  VALUE
003050                                       "--> ÿ¿∞›".
003060 01  DISP-AREA2.
003070     03  DISP-15  LINE  7  COLUMN  13  PIC  X(39)  VALUE          I.060221
003080          "ñ{é–=0 , ã ìá=1 , í√éR=2 , óºîı=3 ...  ".              I.060927
003090*****     "ñ{é–=0 , ã ìá=1 , í√éR=2 , çÇâÆ=3 ...  ".              D.060927
003100     03  DISP-21  LINE 16  COLUMN  15  PIC  X(09)  VALUE
003110                                       "ëóÇËèÛNO:".
003120     03  DISP-DATM.
003130       04  LINE  15    COLUMN  31    VALUE  NC"ì˙Å@ït".
003140       04  LINE  17.
003150         05  COLUMN  21    VALUE  NC"ÇeÇqÇnÇl".
003160         05  COLUMN  31    VALUE  "  /  /  ".
003170       04  LINE  19.
003180         05  COLUMN  21    VALUE  NC"ÇsÇn".
003190         05  COLUMN  31    VALUE  "  /  /  ".
003200 01  DISP-AREA3.
003210     03  DISP-22  LINE 24  COLUMN  01  PIC  N(09)  VALUE
003220                                       NC"äYìñÉfÅ[É^ñ≥".
003230******************************
003240*     ACCEPT       SECTION.  *
003250******************************
003260 01  ACT-AREA.
003270*****03  ACT-01  LINE    6 COLUMN  46  PIC  9                     D.060221
003280     03  ACT-01  LINE    5 COLUMN  46  PIC  9                     I.060221
003290                 INTO      ACT1      CHECK  OVERFLOW  NO IFC.
003300     03  ACT-SOK LINE    7 COLUMN  51  PIC  9                     I.060221
003310                 INTO      W-SOK     CHECK  OVERFLOW  NO IFC.     I.060221
003320*****03  ACT-JS  LINE    9 COLUMN  61  PIC  9                     D.070411
003330     03  ACT-JS  LINE    9 COLUMN  46  PIC  9                     I.070411
003340                 INTO      W-JS      CHECK  OVERFLOW  NO IFC.     I.030722
003350*****03  ACT-02  LINE   13 COLUMN  23  PIC  9                     D.030722
003360     03  ACT-02  LINE   13 COLUMN  36  PIC  9                     I.030722
003370                 INTO      ACT2      CHECK  OVERFLOW  NO IFC.
003380     03  ACT-03  LINE   16 COLUMN  24  PIC  9(06)
003390                 INTO      ACT3      CHECK  OVERFLOW  NO IFC.
003400     03  ACP-SNGP  LINE  17.
003410       04  ACP-SNEN  COLUMN  31    PIC 9(02)
003420             USING  W-SNEN2  NO  IFC.
003430       04  ACP-SGET  COLUMN  34    PIC 9(02)
003440             USING  W-SGET   NO  IFC.
003450       04  ACP-SPEY  COLUMN  37    PIC 9(02)
003460             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.
003470     03  ACP-ENGP  LINE  19.
003480       04  ACP-ENEN  COLUMN  31    PIC 9(02)
003490             USING  W-ENEN2  NO  IFC.
003500       04  ACP-EGET  COLUMN  34    PIC 9(02)
003510             USING  W-EGET   NO  IFC.
003520       04  ACP-EPEY  COLUMN  37    PIC 9(02)
003530             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.
003540     03  ACT-04  LINE   23 COLUMN  61  PIC  9(01)
003550                 INTO      ACTK      CHECK  OVERFLOW  NO IFC.
003560*
003570******************************
003580*     CLEAR        SECTION.  *
003590******************************
003600 01  CLR-AREA.
003610*****03  CLR-01  LINE    6 COLUMN  46  PIC  X     VALUE   " ".    D.060221
003620     03  CLR-01  LINE    5 COLUMN  46  PIC  X     VALUE   " ".    I.060221
003630     03  CLR-JS  LINE    9 COLUMN  46  PIC  X     VALUE   " ".    I.070411
003640*****03  CLR-JS  LINE    9 COLUMN  61  PIC  X     VALUE   " ".    D.070411
003650*****03  CLR-02  LINE   13 COLUMN  23  PIC  X     VALUE   " ".    D.030722
003660     03  CLR-02  LINE   13 COLUMN  36  PIC  X     VALUE   " ".    I.030722
003670     03  CLR-03  LINE   16 COLUMN  24  PIC  X(06) VALUE   " ".
003680     03  CLR-04  LINE   23 COLUMN  61  PIC  X     VALUE   " ".
003690     03  CLR-05  LINE   16 COLUMN  15  PIC  X(15) VALUE   " ".
003700     03  CLR-DATM.
003710       04  LINE  15    COLUMN  31    PIC X(06)    VALUE  " ".
003720       04  LINE  17.
003730         05  COLUMN  21    PIC X(08)    VALUE  " ".
003740         05  COLUMN  31    PIC X(08)    VALUE  " ".
003750       04  LINE  19.
003760         05  COLUMN  21    PIC X(04)    VALUE  " ".
003770         05  COLUMN  31    PIC X(08)    VALUE  " ".
003780*
003790*01  DSP-GDMM.                                                    D.011018
003800*****02  LINE  24  COLUMN   1  VALUE                              D.011018
003810*****    NC"ÅñÅñÉ_É~Å[ÇeÅ@Ç»Çµ".                                  D.011018
003820     COPY  LSMSG.                                                 COPYLIB.
003830     COPY  LIBSCR.
003840**
003850*********************************************
003860**                                          *
003870**        PROCEDURE        DIVISION         *
003880**                                          *
003890*********************************************
003900 PROCEDURE           DIVISION.
003910 MAIN-LOGIC.
003920     PERFORM   INITIAL-RTN  THRU  INITIAL-EXT.                    START
003930               PERFORM      MAIN-RTN  THRU  MAIN-EXT              PROCES
003940                            UNTIL     ENDFLG = "END".
003950                       PERFORM     END-RTN THRU    END-EX.        END
003960     STOP     RUN.
003970*********************************************
003980**                                          *
003990**        INITIAL            ROUTIN         *
004000**                                          *
004010*********************************************
004020 INITIAL-RTN.
004030     ACCEPT  JS-SIGN.
004040*****ACCEPT  W-JS.                                                D.030722
004050*****IF  W-JS  =  ZERO                                            D.030722
004060*****    MOVE  NC"Åkã≥Å@àÁÅl"    TO  W-JS-MEI.                    D.030722
004070*****IF  W-JS  =  1                                               D.030722
004080*****    MOVE  NC"ÅkÉèÅ[ÉNÅl"    TO  W-JS-MEI.                    D.030722
004090*****IF  W-JS  =  2                                               D.030722
004100*****    MOVE  NC"ÅkÉJÉWÉÖÅl"    TO  W-JS-MEI.                    D.030722
004110*****    MOVE  NC"ÅkàÍÅ@î Ål"    TO  W-JS-MEI.                    D.030707
004120*
004130     MOVE    SPACE      TO    WORK-AREA.
004140     INITIALIZE               WORK-AREA.
004150*
004160     DISPLAY  DISP-CLEAR.
004170     DISPLAY  DISP-AREA1.
004180     IF  JS-SIGN  NOT =  0                                        I.060221
004190         DISPLAY  DISP-15.                                        I.060221
004200     COPY  LIBCPR.
004210*****PERFORM  SEL-RTN  THRU  SEL-EX.                              D.030722
004220*****IF  JS-SIGN      =  4                                        D.011018
004230*****    OPEN  I-O      GDMM                                      D.011018
004240*****    MOVE  "0"      TO  GDMM-KEY                              D.011018
004250*****    READ  GDMM     INVALID  KEY                              D.011018
004260*****          CLOSE    GDMM                                      D.011018
004270*****          DISPLAY  DSP-GDMM   DISP-BUZ-B                     D.011018
004280*****          STOP  RUN.                                         D.011018
004290*****OPEN     INPUT   TC-M  JCON.                                 D.030722
004300*****OPEN     I-O     OKJF.                                       D.030722
004310*****OPEN    OUTPUT   P-F.                                        D.030722
004320 INITIAL-EXT.
004330     EXIT.
004340*********************************************
004350**                                          *
004360**        MAIN               ROUTIN         *
004370**                                          *
004380*********************************************
004390 MAIN-RTN.
004400 MAIN-10.                                                         TESTàÛéö
004410     ACCEPT    ACT-01.
004420     DISPLAY   DISP-MSG-SPACE.
004430              IF  ESTAT   =   "P9"                                PF9
004440                               MOVE  "END"  TO  ENDFLG
004450                               GO     TO        MAIN-EXT.
004460              IF  ESTAT   =   "01"  OR  "06"
004470                               NEXT   SENTENCE
004480                  ELSE
004490                               GO     TO  MAIN-10.
004500              IF  ACT1  NOT =   1  AND 2
004510                               GO     TO  MAIN-10.
004520              IF  ACT1      =   1
004530                        PERFORM    TEST-RTN    THRU    TEST-EXT
004540                        GO   TO    MAIN-10.
004550     IF  JS-SIGN   =   0                                          I.060221
004560                      MOVE  0     TO  W-SOK                       I.060221
004570                      GO     TO  MAIN-15.                         I.060221
004580 MAIN-12.                                                         I.060221
004590     ACCEPT    ACT-SOK.                                           I.060221
004600     DISPLAY   DISP-MSG-SPACE.                                    I.060221
004610     IF  ESTAT   =   "09"                                         I.060221
004620                     GO     TO  MAIN-10.                          I.060221
004630     IF  ESTAT   =   "01"  OR  "06"                               I.060221
004640                      NEXT   SENTENCE                             I.060221
004650         ELSE                                                     I.060221
004660                     GO     TO  MAIN-12.                          I.060221
004670     IF  W-SOK NOT =   0  AND  1  AND  2  AND  3                  I.060221
004680                     GO     TO  MAIN-12.                          I.060221
004690 MAIN-15.                                                         I.030722
004700     ACCEPT    ACT-JS.                                            I.030722
004710     DISPLAY   DISP-MSG-SPACE.                                    I.030722
004720              IF  ESTAT   =   "09"                                I.030722
004730                  IF  JS-SIGN   NOT =   0                         I.060221
004740                      GO     TO  MAIN-12                          I.060221
004750                  ELSE                                            I.060221
004760                      GO     TO  MAIN-10.                         I.030722
004770              IF  ESTAT   =   "01"  OR  "06"                      I.030722
004780                               NEXT   SENTENCE                    I.030722
004790                  ELSE                                            I.030722
004800                               GO     TO  MAIN-15.                I.030722
004810*****         IF  W-JS  NOT =   0  AND  1  AND  2  AND  9         D.070411
004820              IF  W-JS  NOT =   0  AND  1  AND  9                 I.070411
004830                               GO     TO  MAIN-15.                I.030722
004840 MAIN-20.                                                         î≠çsëIë
004850     ACCEPT    ACT-02.
004860     DISPLAY   DISP-MSG-SPACE.
004870              IF  ESTAT   =   "09"
004880                               GO     TO  MAIN-15.                I.030722
004890*****                          GO     TO  MAIN-10.                D.030722
004900              IF  ESTAT   =   "01"  OR  "06"
004910                               NEXT   SENTENCE
004920                  ELSE
004930                               GO     TO  MAIN-20.
004940              IF  ACT2  NOT =   1  AND 2
004950                               GO     TO  MAIN-20.
004960     IF  ACT2 = 2
004970         DISPLAY  CLR-DATM
004980         GO  TO  MAIN-30.
004990     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.030722
005000     DISPLAY  CLR-05  DISP-DATM  ACP-SNGP  ACP-ENGP.
005010     IF  W-SNGP = ZERO
005020         DISPLAY  DISP-22
005030         GO  TO  MAIN-20.
005040     GO  TO  MAIN-40.
005050 MAIN-30.                                                         áÇ
005060     DISPLAY  DISP-21.
005070     ACCEPT   ACT-03.
005080     DISPLAY   DISP-MSG-SPACE.
005090     IF  ESTAT = "P9"                                             PF9
005100         MOVE  "END"  TO  ENDFLG
005110         GO  TO  MAIN-EXT.
005120     IF  ESTAT = "09"
005130         GO  TO  MAIN-20.
005140     IF  ESTAT = "01"  OR  "06"
005150         GO  TO  MAIN-40
005160       ELSE
005170         GO  TO  MAIN-30.
005180 MAIN-32.
005190     ACCEPT  ACP-SNEN.
005200     IF  ESTAT = "09"
005210         GO  TO  MAIN-20.
005220     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005230         GO  TO  MAIN-32.
005240     MOVE  ZERO  TO  W-SNEN1.
005250     IF  W-SNEN2 >= DATE-NF1  AND  <= DATE-NT1
005260         ADD  DATE-NC1  TO  W-SNEN.
005270     IF  W-SNEN2 >= DATE-NF2  AND  <= DATE-NT2
005280         ADD  DATE-NC2  TO  W-SNEN.
005290 MAIN-33.
005300     ACCEPT  ACP-SGET.
005310     IF  ESTAT = "09"
005320         GO  TO  MAIN-32.
005330     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005340         GO  TO  MAIN-33.
005350     IF  W-SGET < 1  OR  > 12
005360         GO  TO  MAIN-33.
005370 MAIN-34.
005380     ACCEPT  ACP-SPEY.
005390     IF  ESTAT = "09"
005400         GO  TO  MAIN-33.
005410     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005420         GO  TO  MAIN-34.
005430     IF  W-SGET < 1  OR  > 31
005440         GO  TO  MAIN-34.
005450     IF  W-SNGP < W-SDATE  OR  > W-EDATE
005460         GO  TO  MAIN-32.
005470 MAIN-36.
005480     ACCEPT  ACP-ENEN.
005490     IF  ESTAT = "09"
005500         GO  TO  MAIN-34.
005510     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005520         GO  TO  MAIN-36.
005530     MOVE  ZERO  TO  W-ENEN1.
005540     IF  W-ENEN2 >= DATE-NF1  AND  <= DATE-NT1
005550         ADD  DATE-NC1  TO  W-ENEN.
005560     IF  W-ENEN2 >= DATE-NF2  AND  <= DATE-NT2
005570         ADD  DATE-NC2  TO  W-ENEN.
005580 MAIN-37.
005590     ACCEPT  ACP-EGET.
005600     IF  ESTAT = "09"
005610         GO  TO  MAIN-36.
005620     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005630         GO  TO  MAIN-37.
005640     IF  W-EGET < 1  OR  > 12
005650         GO  TO  MAIN-37.
005660 MAIN-38.
005670     ACCEPT  ACP-EPEY.
005680     IF  ESTAT = "09"
005690         GO  TO  MAIN-37.
005700     IF  ESTAT NOT = "00"  AND  "01"  AND  "06"
005710         GO  TO  MAIN-38.
005720     IF  W-SGET < 1  OR  > 31
005730         GO  TO  MAIN-38.
005740     IF  W-SNGP > W-ENGP
005750         GO  TO  MAIN-36.
005760     IF  W-SNGP < W-SDATE  OR  > W-EDATE
005770         GO  TO  MAIN-36.
005780 MAIN-40.                                                         ämÅ@îF
005790     ACCEPT    ACT-04.
005800     DISPLAY   DISP-MSG-SPACE.
005810              IF  ESTAT   =   "09"
005820                  IF  ACT2    =   1
005830                               GO     TO  MAIN-32
005840                      ELSE
005850                               GO     TO  MAIN-30.
005860              IF  ESTAT   =   "01"  OR  "06"
005870                               NEXT   SENTENCE
005880                  ELSE
005890                               GO     TO  MAIN-40.
005900              IF  ACTK  NOT =   1  AND 9
005910                               GO     TO  MAIN-40.
005920*
005930              IF  ACTK      =   1
005940                        MOVE       ZERO         TO     DSW
005950                        PERFORM    PRINT-RTN    THRU   PRINT-EXT
005960                  ELSE
005970                        DISPLAY    CLR-05
005980                        DISPLAY    CLR-01
005990                        DISPLAY    CLR-02
006000                        DISPLAY    CLR-04
006010                        GO   TO    MAIN-10.
006020              IF  ACT2      =   2
006030                        GO   TO    MAIN-30.
006040              IF  DSW       =   0
006050                        GO   TO    MAIN-20.
006060              MOVE  "END"  TO  ENDFLG.
006070 MAIN-EXT.
006080     EXIT.
006090*********************************************
006100**                                          *
006110**        FAINAL             ROUTIN         *
006120**                                          *
006130*********************************************
006140 END-RTN.
006150*****CLOSE     OKJF.                                              D.030722
006160*****CLOSE     TC-M.                                              D.030722
006170     IF  W-FOC     =  1                                           I.030722
006180         CLOSE     OKJF                                           I.030722
006190         CLOSE     TC-M                                           I.030722
006200         CLOSE     JCON.
006210     IF  W-POC     =  1                                           I.030722
006220         CLOSE     P-F.
006230*****IF  JS-SIGN      =  4              CLOSE  GDMM.              D.011018
006240 END-EX.
006250     EXIT.
006260*********************************************
006270**                                          *
006280**        SUB    ROUTIN     SECTION         *
006290**                                          *
006300*********************************************
006310*
006320******************************
006330*     TEST         ROUTIN    *
006340******************************
006350 TEST-RTN.
006360     IF  W-POC     =  0                                           I.030722
006370         MOVE  1       TO  W-POC                                  I.030722
006380         OPEN  OUTPUT  P-F.                                       I.030722
006390     IF     LCNT  =  23
006400                  MOVE       ZERO     TO        LCNT
006410                  MOVE       SPACE    TO        P-R
006420                  WRITE      P-R      AFTER     PAGE.
006430     MOVE       SPACE    TO        P-R.
006440     MOVE        ""3FE04FE080""  TO               CODEK1.         2.0BYTE
006450     MOVE       99       TO  R1-01 R1-02 R1-03.
006460     WRITE      P-R      AFTER     4.
006470     MOVE       SPACE    TO        P-R.
006480*
006490     MOVE        ""3FE04F40A0""  TO               CODEK2.         1.5
006500     MOVE       SPACE    TO        R2-01.
006510     MOVE      NC"ÇmÇmÇmÇmÇmÇmÇmÇmÇm"    TO        R2-01.
006520     WRITE      P-R      AFTER     2.
006530     MOVE       SPACE    TO        P-R.
006540*
006550     MOVE        ""3FE04F40A0""  TO               CODEK3.         1.5BYTE
006560     MOVE       SPACE    TO        R3-01.
006570     MOVE  ALL NC"Çm"    TO        F2.
006580     MOVE       SOM      TO        R3-01.
006590     WRITE      P-R      AFTER     2.
006600     MOVE       SPACE    TO        P-R.
006610*
006620*****MOVE        ""3FE04FE080""  TO              CODEK4.          D.020820
006630     MOVE        ""3FE04F40A0""  TO              CODEK4.          I.020820
006640     MOVE       SPACE    TO        R4-05.                         I.020820
006650     MOVE  ALL  "9"      TO        R4-03.
006660     WRITE      P-R      AFTER     1.
006670     MOVE       SPACE    TO        P-R.
006680*
006690*****MOVE        ""3FE04FE080""  TO              CODEK4A.         D.060221
006700*****MOVE  NC"ÇRÇPÇUÇVÇSÇT" TO     R4-99.                         D.060221
006710*****WRITE      P-R      AFTER     6.                             D.060221
006720*****MOVE       SPACE    TO        P-R.                           D.060221
006730*
006740     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
006750     MOVE       SPACE    TO        R5-01  R5-02.
006760     MOVE  ALL NC"Çm"    TO        R5-01.
006770     WRITE      P-R      AFTER     7.                             I.060221
006780*****WRITE      P-R      AFTER     1.                             D.060221
006790*****WRITE      P-R      AFTER     7.                             D.040917
006800     MOVE       SPACE    TO        P-R.
006810*
006820     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
006830     MOVE       SPACE    TO        R5-01  R5-02.
006840     MOVE  ALL NC"Çm"    TO        R5-01.
006850     WRITE      P-R      AFTER     1.
006860     MOVE       SPACE    TO        P-R.
006870*
006880     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
006890     MOVE       SPACE    TO        R5-01  R5-02.
006900     MOVE  ALL NC"Çm"    TO        R5-01  R5-02.
006910     WRITE      P-R      AFTER     1.
006920     MOVE       SPACE    TO        P-R.
006930*
006940*****MOVE        ""3FE04F40A0""  TO              CODEK5.          D.020820
006950*****MOVE       SPACE    TO        R5-01  R5-02.                  D.020820
006960*****MOVE  ALL NC"Çm"    TO        R5-011.                        D.020820
006970*****WRITE      P-R      AFTER     1.                             D.020820
006980*****MOVE       SPACE    TO        P-R.                           D.020820
006990*
007000     MOVE  ALL  "X"      TO        R6-01  R6-02.
007010     WRITE      P-R      AFTER     2.
007020     MOVE       SPACE    TO        P-R.
007030*
007040     MOVE        ""3FE04F40A0""  TO              CODEK7A.         1.5BYTE
007050     MOVE       SPACE    TO        R7-01  R7-02.
007060     MOVE  ALL NC"Çm"    TO        R7-01.
007070     WRITE      P-R      AFTER     1.
007080     MOVE       SPACE    TO        P-R.
007090*
007100     MOVE        ""3FE04F40A0""  TO              CODEK7A.         1.5BYTE
007110     MOVE       SPACE    TO        R7-01  R7-02.
007120     MOVE  ALL NC"Çm"    TO        R7-01  R7-02.
007130     MOVE        "999"   TO        R7-03.
007140     WRITE      P-R      AFTER     1.
007150     MOVE       SPACE    TO        P-R.
007160*
007170     MOVE       23       TO        LCNT.
007180 TEST-EXT.
007190     EXIT.
007200*********************************************
007210**                                          *
007220**        PRINT              ROUTIN         *
007230**                                          *
007240*********************************************
007250 PRINT-RTN.
007260     IF  W-POC     =  0                                           I.030722
007270         MOVE  1       TO  W-POC                                  I.030722
007280         OPEN  OUTPUT  P-F.                                       I.030722
007290     IF  W-FOC     =  0                                           I.030722
007300         MOVE  1       TO  W-FOC                                  I.030722
007310         OPEN  INPUT   TC-M  JCON                                 I.030722
007320         OPEN  I-O     OKJF.                                      I.030722
007330     IF     LCNT  =  23
007340                  MOVE       ZERO     TO        LCNT
007350                  MOVE       SPACE    TO        P-R
007360                  WRITE      P-R      AFTER     PAGE.
007370*********  ñæ  ç◊  ïî  ********
007380     IF  ACT2      =   1                                          êVãKî≠çs
007390                   NEXT  SENTENCE
007400         ELSE
007410                   GO   TO    PRT-20.                             çƒî≠çs
007420 PRT-10.                                                          ëóÇËèÛÇe
007430     IF      ENDFLG2  =  "END"   GO   TO  PRT-15.
007440     READ    OKJF  NEXT          AT  END
007450                                 MOVE      "END"  TO  ENDFLG2
007460                                 GO  TO    PRT-15.
007470*****IF      W-JS  =  ZERO                                        D.030707
007480*****    IF      OKJF-09  NOT =  ZERO                             D.030707
007490*****                 GO   TO  PRT-10.                            D.030707
007500*****IF      W-JS  =  1                                           D.030707
007510*****    IF      OKJF-09  NOT =  1                                D.030707
007520     IF      W-JS     NOT =  9                                    I.030707
007530             IF      OKJF-09  NOT =  W-JS                         I.030707
007540                      GO   TO  PRT-10.
007550     IF      OKJF-08  =  1                                        àÛéöª≤›
007560                      GO   TO  PRT-10.
007570     IF      OKJF-02  NOT = 3                                     â^ëóã∆CD
007580                      GO   TO  PRT-10.
007590     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
007600                         NEXT   SENTENCE
007610             ELSE
007620                         GO  TO  PRT-10.
007630*****IF      JS-SIGN  =  0                                        D.060221
007640*****        IF  OKJF-04    =    2 OR 3 OR 5 OR 6 OR 7            D.051216
007650     IF      W-SOK       =   0                                    I.060221
007660             IF  OKJF-04    =    2 OR 3 OR 4 OR 5 OR 6 OR 7       I.051216
007670                                               GO  TO  PRT-10.
007680*****IF      JS-SIGN  =  1                                        D.060221
007690*****        IF   OKJF-04    NOT =   2  AND  3 GO  TO  PRT-10.    D.060221
007700*****IF      JS-SIGN  =  2                                        D.060221
007710*****        IF   OKJF-04    NOT =   5  AND  6 GO  TO  PRT-10.    D.060221
007720*****IF      JS-SIGN  =  3                                        D.060221
007730*****        IF   OKJF-04    NOT =   2  AND  3  AND  5  AND  6    D.060221
007740*****                                          GO  TO  PRT-10.    D.060221
007750*****IF      JS-SIGN  =  4                                        D.060221
007760     IF      W-SOK       =   1                                    I.060221
007770            IF    OKJF-04    NOT =  6          GO  TO  PRT-10.    I.060221
007780     IF      W-SOK       =   2                                    I.060221
007790             IF   OKJF-04    NOT =   7         GO  TO  PRT-10.
007800     IF      W-SOK       =   3                                    I.060221
007810            IF    OKJF-04    NOT =  4          GO  TO  PRT-10.    I.060221
007820     MOVE  ZERO     TO  W-NGP.
007830     MOVE  OKJF-03  TO  W-NGPS.
007840     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1
007850         ADD  DATE-NC1  TO  W-NEN.
007860     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2
007870         ADD  DATE-NC2  TO  W-NEN.
007880     IF  W-NGP < W-SNGP  OR  > W-ENGP
007890         GO  TO  PRT-10.
007900     GO      TO   PRT-30.
007910 PRT-15.
007920     IF      DSW  =  ZERO
007930                         DISPLAY    DISP-AREA3
007940                         GO   TO    PRINT-EXT
007950             ELSE
007960                         GO   TO    PRINT-EXT.
007970 PRT-20.
007980     MOVE    ACT3     TO  OKJF-01.
007990     READ    OKJF                   INVALID
008000                         DISPLAY    DISP-AREA3
008010                         GO   TO    PRINT-EXT.
008020     IF      OKJF-02  NOT = 3                                     â^ëóã∆CD
008030                         DISPLAY    DISP-AREA3
008040                         GO   TO    PRINT-EXT.
008050     IF     (OKJF-07  >  ZERO)  AND  (OKJF-10  =  1)              å¬Å@êî
008060                         NEXT   SENTENCE
008070             ELSE
008080                         DISPLAY    DISP-AREA3
008090                         GO   TO    PRINT-EXT.
008100*****IF      W-JS  =  ZERO                                        D.030707
008110*****    IF      OKJF-09  NOT =  ZERO                             D.030707
008120*****                    DISPLAY    DISP-AREA3                    D.030707
008130*****                    GO   TO    PRINT-EXT.                    D.030707
008140*****IF      W-JS  =  1                                           D.030707
008150*****    IF      OKJF-09  NOT =  1                                D.030707
008160     IF      W-JS     NOT =  9                                    I.030707
008170             IF      OKJF-09  NOT =  W-JS                         I.030707
008180                         DISPLAY    DISP-AREA3
008190                         GO   TO    PRINT-EXT.
008200*****IF      JS-SIGN  =  0                                        D.060221
008210*****        IF       OKJF-04    =  2  OR  3  OR  5  OR  6  OR  7 D.051216
008220     IF      W-SOK       =   0                                    I.060221
008230             IF       OKJF-04    =  2 OR 3 OR 4 OR 5 OR 6 OR 7    I.051216
008240                         DISPLAY    DISP-AREA3
008250                         GO   TO    PRINT-EXT.
008260*****IF      JS-SIGN  =  1                                        D.060221
008270*****        IF       OKJF-04    NOT =   2  AND  3                D.060221
008280     IF      W-SOK       =   1                                    I.060221
008290            IF    OKJF-04    NOT =  6                             I.060221
008300                         DISPLAY    DISP-AREA3
008310                         GO   TO    PRINT-EXT.
008320*****IF      JS-SIGN  =  2                                        D.060221
008330*****        IF       OKJF-04    NOT =   5  AND  6                D.060221
008340     IF      W-SOK       =   2                                    I.060221
008350            IF    OKJF-04    NOT =  7                             I.060221
008360                         DISPLAY    DISP-AREA3
008370                         GO   TO    PRINT-EXT.
008380*****IF      JS-SIGN  =  3                                        D.060221
008390*****        IF       OKJF-04    NOT =  2  AND  3  AND  5  AND  6 D.060221
008400     IF      W-SOK       =   3                                    I.060221
008410            IF    OKJF-04    NOT =  4                             I.060221
008420                         DISPLAY    DISP-AREA3
008430                         GO   TO    PRINT-EXT.
008440*****IF      JS-SIGN  =  4                                        D.060221
008450*****        IF       OKJF-04    NOT =  7                         D.060221
008460*****                    DISPLAY    DISP-AREA3                    D.060221
008470*****                    GO   TO    PRINT-EXT.                    D.060221
008480 PRT-30.                                                          íºëóêÊÇl
008490     MOVE    OKJF-05  TO  TC-KEY.
008500     READ    TC-M        UNLOCK     INVALID
008510                         MOVE       SPACE  TO  TC-R
008520                         INITIALIZE            TC-R.
008530 PRT-40.                                                          ÇbÇmÇsÇe
008540     MOVE    3        TO  JCON3-01.
008550     MOVE    OKJF-04  TO  JCON3-02.
008560     READ    JCON        UNLOCK     INVALID
008570                         MOVE       SPACE  TO  JCON3-R
008580                         INITIALIZE            JCON3-R.
008590     MOVE       1        TO  DSW.                                 DATAóLñ≥
008600 PRT-50.
008610*
008620     MOVE       SPACE    TO        P-R.
008630     MOVE        ""3FE04FE080""  TO               CODEK1.         2.0BYTE
008640     MOVE       OKJF-03  TO  DATE-WORK.
008650     MOVE       YY       TO  R1-01.
008660     MOVE       MM       TO  R1-02.
008670     MOVE       DD       TO  R1-03.
008680     WRITE      P-R      AFTER     4.
008690     MOVE       SPACE    TO        P-R.
008700*
008710     MOVE        ""3FE04F40A0""  TO               CODEK2.         1.5BYTE
008720     MOVE       SPACE    TO        R2-01.
008730     MOVE  OKJF-06       TO        R2-01.
008740     WRITE      P-R      AFTER     2.
008750     MOVE       SPACE    TO        P-R.
008760*
008770     MOVE        ""3FE04F40A0""  TO               CODEK3.         1.5BYTE
008780     MOVE       SPACE    TO        R3-01.
008790     MOVE       JCON3-03 TO        F2.
008800     MOVE       SOM      TO        R3-01.
008810     WRITE      P-R      AFTER     2.
008820     MOVE       SPACE    TO        P-R.
008830*
008840     MOVE        ""3FE04F40A0""  TO              CODEK4.          1.5BYTE
008850     MOVE       OKJF-01    TO      R4-03.
008860*****IF    ACT2          =   2     MOVE  NC"çƒ"     TO   R4-05.   D.020820
008870     IF    ACT2          =   2     MOVE  NC"çƒÅ@"     TO   R4-05. I.020820
008880     WRITE      P-R      AFTER     1.
008890     MOVE       SPACE    TO        P-R.
008900*
008910*****MOVE        ""3FE04FE080""  TO              CODEK4A.         D.060221
008920*****MOVE  NC"ÇRÇPÇUÇVÇSÇT" TO     R4-99.                         D.060221
008930     MOVE        ""3FE04F40A0""  TO              CODEK5.          I.060221
008940     MOVE       SPACE    TO        R5-01  R5-02.                  I.060221
008950     IF    OKJF-04        =  1                                    I.060221
008960           MOVE  NC"ÇRÇPÇUÇVÇSÇT" TO     R5-02                    I.060221
008970           ELSE  IF    OKJF-04        =  7                        I.060221
008980                       MOVE  NC"ÇVÇOÇQÇOÇSÇR" TO     R5-02.       I.060221
008990     WRITE      P-R      AFTER     6.                             I.040917
009000     MOVE       SPACE    TO        P-R.                           I.040917
009010*
009020     MOVE TC-JSU TO W-JU1.                                        I.020820
009030     MOVE TC-JSS TO W-JS1.                                        I.020820
009040     MOVE ALL NC"Å@" TO W-JUS1 W-JUS2 W-JUS3.                     I.020820
009050     MOVE 0 TO W-JPC.                                             I.020820
009060     IF TC-JSS = SPACE                                            I.020820
009070         IF SPACE NOT = W-JUF AND W-JUR                           I.020820
009080             MOVE W-JUFC TO W-JUS2                                I.020820
009090             MOVE W-JUR TO W-JUS3R                                I.020820
009100           ELSE                                                   I.020820
009110             IF W-JUR = SPACE                                     I.020820
009120                 MOVE W-JUFC TO W-JUS3                            I.020820
009130               ELSE                                               I.020820
009140                 IF W-JUF = SPACE                                 I.020820
009150                     MOVE W-JUCR TO W-JUS3.                       I.020820
009160     IF TC-JSS = SPACE                                            I.020820
009170         GO TO PRT-55.                                            I.020820
009180     IF W-JSF = SPACE                                             I.020820
009190         MOVE W-JSCR TO W-JUS3                                    I.020820
009200       ELSE                                                       I.020820
009210         IF W-JSR = SPACE                                         I.020820
009220             MOVE W-JSFC TO W-JUS3                                I.020820
009230           ELSE                                                   I.020820
009240             MOVE W-JSCR TO W-JUS3                                I.020820
009250             MOVE 1 TO W-JPC.                                     I.020820
009260     IF W-JUF NOT = SPACE                                         I.020820
009270         IF W-JUR NOT = SPACE                                     I.020820
009280             MOVE W-JUFC TO W-JUS1                                I.020820
009290             IF W-JPC = 0                                         I.020820
009300                 MOVE W-JUR TO W-JUS2R                            I.020820
009310               ELSE                                               I.020820
009320                 MOVE W-JUR TO W-JUS2F                            I.020820
009330                 MOVE W-JSF TO W-JUS2R.                           I.020820
009340     IF W-JUR = SPACE                                             I.020820
009350         IF W-JUF NOT = SPACE                                     I.020820
009360             IF W-JPC = 0                                         I.020820
009370                 MOVE W-JUFC TO W-JUS2                            I.020820
009380               ELSE                                               I.020820
009390                 MOVE W-JUFC TO W-JUS1                            I.020820
009400                 MOVE W-JSF TO W-JUS2F.                           I.020820
009410     IF W-JUF = SPACE                                             I.020820
009420         IF W-JUR NOT = SPACE                                     I.020820
009430             IF W-JPC = 0                                         I.020820
009440                 MOVE W-JUCR TO W-JUS2                            I.020820
009450               ELSE                                               I.020820
009460                 MOVE W-JUCR TO W-JUS1                            I.020820
009470                 MOVE W-JSF TO W-JUS2F.                           I.020820
009480 PRT-55.                                                          I.020820
009490*
009500     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
009510     MOVE       SPACE    TO        R5-01  R5-02.
009520*****MOVE       TC-JSU   TO        JSUX.                          D.020820
009530*****MOVE       JSU1     TO        R5-01.                         D.020820
009540     MOVE       W-JUS1   TO        R5-01.                         I.020820
009550     IF   (OKJF-05   <  0459002  OR   >  0459999)                 I.060221
009560      AND (OKJF-05   <  0460002  OR   >  0460999)                 I.060221
009570      AND (OKJF-05   <  3966002  OR   >  3966999)                 I.060221
009580       IF   OKJF-04    =   6                                      I.060221
009590            MOVE  NC"â™éRåßëqï~ésã ìáâ≥ìáéöêVñ©Å@"  TO    R5-02   I.060927
009600       ELSE                                                       I.060927
009610       IF   OKJF-04    =   4                                      I.060927
009620            MOVE  NC"â™éRåßìsåEåSëÅìáí¨ëÅìáÅ@Å@Å@"  TO    R5-02.  I.060927
009630*****       MOVE  NC"â™éRåßëqï~ésã ìáâ≥ìáéöêVñ©Å@"  TO    R5-02.  D.060927
009640     WRITE      P-R      AFTER     1.                             I.040917
009650*****WRITE      P-R      AFTER     7.                             D.040917
009660     MOVE       SPACE    TO        P-R.
009670*
009680     MOVE        ""3FE04F40A0""  TO              CODEK5.
009690     MOVE       SPACE    TO        R5-01  R5-02.
009700*****MOVE  TC-JSS        TO        R5-011.                        D.020820
009710     MOVE       W-JUS2   TO        R5-01.                         I.020820
009720     IF   (OKJF-05   <  0459002  OR   >  0459999)                 I.060221
009730      AND (OKJF-05   <  0460002  OR   >  0460999)                 I.060221
009740      AND (OKJF-05   <  3966002  OR   >  3966999)                 I.060221
009750       IF   OKJF-04    =   4                                      I.060221
009760            MOVE  NC"Å@Å@Å@Å@Å@Å@Å@ÇSÇTÇOÇVÅ|ÇRÇV"  TO    R5-02   I.060927
009770*****       MOVE  NC"â™éRésçÇâÆÇRÇOÇWÅ@Å@Å@Å@Å@Å@"  TO    R5-02   D.060927
009780       ELSE IF   OKJF-04    =   7                                 I.060221
009790            MOVE  NC"â™éRåßãvïƒåSÅ@Å@Å@Å@Å@Å@Å@Å@"  TO    R5-02   I.060221
009800       ELSE IF   OKJF-04    =   6                                 I.060221
009810            MOVE  NC"Å@Å@Å@Å@Å@Å@Å@Å@ÇWÇQÇUÇQÅ|ÇP"  TO    R5-02.  I.060221
009820     WRITE      P-R      AFTER     1.
009830     MOVE       SPACE    TO        P-R.
009840*
009850     MOVE        ""3FE04F40A0""  TO              CODEK5.          1.5BYTE
009860     MOVE       SPACE    TO        R5-01  R5-02.
009870*****MOVE       JSU2     TO        R5-01.                         D.020820
009880     MOVE       W-JUS3   TO        R5-01.                         I.020820
009890     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
009900           OR   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
009910           MOVE      NC"ï∫å…åßêºã{ésçÇñÿìåí¨ÇPÇTÅ|ÇP"  TO  R5-02
009920     ELSE  IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)     I.020820
009930           MOVE      NC"ìåãûìsíÜñÏãÊä€éRÇQÅ|ÇTÅ|ÇPÇX"  TO  R5-02  I.020820
009940     ELSE  IF   OKJF-04    =   4                                  I.060221
009950           MOVE      NC"óºîıâ^óAíÜélçëï®ó¨ÉZÉìÉ^Å[ì‡"  TO  R5-02  I.060927
009960*****      MOVE      NC"Å@Å@Å@Å@Å@óºîıâ^óAáäì‡Å@Å@Å@"  TO  R5-02  D.060927
009970     ELSE  IF   OKJF-04    =   7                                  I.060221
009980           MOVE      NC"Å@Å@Å@î¸çÁí¨å¥ìcÇRÇQÇQÇVÅ|ÇP"  TO  R5-02  I.060221
009990     ELSE  IF   OKJF-04    =   6                                  I.060221
010000           MOVE      NC"Å@Å@êÖìáç`çëç€ï®ó¨ÉZÉìÉ^Å[ì‡"  TO  R5-02  I.060221
010010     ELSE
010020           MOVE      NC"â™éRésç°ÇWíöñ⁄ÇPÇUî‘ÇPÇVçÜÅ@"  TO  R5-02. I.051202
010030*****      MOVE      NC"â™éRésçÇñˆìåí¨ÇPÇRî‘ÇSÇUçÜÅ@"  TO  R5-02. D.051202
010040*****      MOVE      NC"Å@Å@â™éRésçÇñˆìåí¨ÇPÇRÅ|ÇSÇU"  TO  R5-02. D.020820
010050     WRITE      P-R      AFTER     1.
010060     MOVE       SPACE    TO        P-R.
010070*
010080*****MOVE        ""3FE04F40A0""  TO              CODEK5.          D.020820
010090*****MOVE       SPACE    TO        R5-01  R5-02.                  D.020820
010100*****MOVE  TC-JSS        TO        R5-011.                        D.020820
010110*****WRITE      P-R      AFTER     1.                             D.020820
010120*****MOVE       SPACE    TO        P-R.                           D.020820
010130*
010140*
010150     MOVE  TC-TEL        TO        R6-01.
010160     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
010170                MOVE  "0798-64-5111  " TO      R6-02
010180     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
010190                MOVE  "0798-67-0810"  TO      R6-02
010200     ELSE  IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)     I.020820
010210                MOVE  "03-5373-6711"  TO      R6-02               I.020820
010220     ELSE
010230                MOVE  "086-243-2456  " TO      R6-02.             I.051202
010240*****           MOVE  "086-252-2456  " TO      R6-02.             D.051202
010250     WRITE      P-R      AFTER     2.
010260     MOVE       SPACE    TO        P-R.
010270*
010280*****MOVE       TC-NAME  TO        NAMEX.                         D.020820
010290     MOVE       TC-NAME  TO        WN-NAME.                       I.020820
010300     PERFORM    NAM-RTN  THRU      NAM-EX.                        I.020820
010310     MOVE        ""3FE04F40A0""  TO              CODEK7A.         1.5BYTE
010320     MOVE       SPACE    TO        R7-01  R7-02.                  I.020820
010330     MOVE       WN-ONAME TO        R7-01.                         I.020820
010340*****IF  TC-STK       =  5                                        D.040705
010350*****    MOVE  NC"ì˙êiÉSÉÄäîéÆâÔé–Å@Å@"  TO  R7-02.               D.040705
010360*****IF    N2    NOT =  SPACE                                     D.020820
010370*****      MOVE       SPACE    TO        R7-01  R7-02             D.020820
010380*****      MOVE       N1       TO        R7-01.                   D.020820
010390     WRITE      P-R      AFTER     1.
010400     MOVE       SPACE    TO        P-R.
010410*
010420     MOVE        ""3FE04F40A0""  TO              CODEK7A.         1.5BYTE
010430     MOVE       SPACE    TO        R7-01  R7-02.
010440     MOVE       WN-UNAME TO        R7-01.                         I.020820
010450*****IF    N2    =  SPACE                                         D.020820
010460*****            MOVE       N1       TO        R7-01              D.020820
010470*****  ELSE                                                       D.020820
010480*****            MOVE       N2       TO        R7-01.             D.020820
010490     IF   (OKJF-05  NOT <  0459002  AND NOT >  0459999)
010500           MOVE      NC"Å@Å@äîéÆâÔé–è„éRõâã∆Å@Å@Å@Å@"  TO  R7-02  I.060221
010510*****     MOVE      NC"äîéÆâÔé–è„éRõâã∆Å@Å@"  TO  R7-02           D.060221
010520*****     MOVE      NC"áäè„éRõâã∆Å@Å@Å@Å@Å@"  TO  R7-02           D.020820
010530     ELSE  IF   (OKJF-05  NOT <  0460002  AND NOT >  0460999)
010540           MOVE      NC"Å@Å@äîéÆâÔé–ÉEÉGÉÑÉ}Å@Å@Å@Å@"  TO  R7-02  I.060221
010550*****           MOVE      NC"äîéÆâÔé–ÉEÉGÉÑÉ}Å@Å@"  TO  R7-02     D.060221
010560*****           MOVE      NC"áäÉEÉGÉÑÉ}Å@Å@Å@Å@Å@"  TO  R7-02     D.020820
010570     ELSE  IF   (OKJF-05  NOT <  3966002  AND NOT >  3966999)     I.020820
010580           MOVE      NC"Å@Å@ëΩî‰ó«äîéÆâÔé–Å@Å@Å@Å@Å@"  TO  R7-02  I.060221
010590     ELSE  IF   OKJF-04    =   4                                  I.060221
010600           MOVE      NC"ì˙êiÉSÉÄÅ@ëÅìáîzëóÉZÉìÉ^Å[Å@"  TO  R7-02  I.060927
010610*****      MOVE      NC"ì˙êiÉSÉÄáäÅ@çÇâÆîzëóÉZÉìÉ^Å["  TO  R7-02  D.060927
010620     ELSE  IF   OKJF-04    =   7                                  I.060221
010630           MOVE      NC"ì˙êiÉSÉÄáäÅ@í√éRï®ó¨ÉZÉìÉ^Å["  TO  R7-02  I.060221
010640     ELSE  IF   OKJF-04    =   6                                  I.060221
010650           MOVE      NC"ì˙êiÉSÉÄáäÅ@ã ìáï®ó¨ÉZÉìÉ^Å["  TO  R7-02  I.060221
010660     ELSE  MOVE      NC"Å@Å@ì˙êiÉSÉÄäîéÆâÔé–Å@Å@Å@Å@"  TO  R7-02. I.060221
010670*****           MOVE      NC"ëΩî‰ó«äîéÆâÔé–Å@Å@Å@"  TO  R7-02     D.060221
010680*****ELSE  IF  TC-STK       =  5                                  D.040705
010690*****           MOVE      NC"ÉîÉBÉîÉFÉìÉfÉBéñã∆ïî"  TO  R7-02     D.040705
010700*****      ELSE MOVE      NC"ì˙êiÉSÉÄäîéÆâÔé–Å@Å@"  TO  R7-02.    D.060221
010710     MOVE       OKJF-07  TO        R7-03.
010720     WRITE      P-R      AFTER     1.
010730     MOVE       SPACE    TO        P-R.
010740*
010750     MOVE       23       TO        LCNT.
010760*
010770 PRT-60.
010780     MOVE          1     TO        OKJF-08.
010790     REWRITE  OKJF-R  INVALID
010800              MOVE    "OKJF"     TO    ERR-F
010810              MOVE    "R"        TO    ERR-M
010820              MOVE     OKJF-KEY  TO    ERR-K
010830              PERFORM  ERR-RTN   THRU  ERR-EX.
010840     IF       ACT2  =  1         GO    TO    PRINT-RTN.
010850 PRINT-EXT.
010860     EXIT.
010870 SEL-RTN.
010880     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.
010890     IF  W-FOC     =  1                                           I.030722
010900         CLOSE  OKJF.                                             I.030722
010910     OPEN  INPUT  OKJF.
010920 SEL-010.
010930     READ  OKJF  NEXT  RECORD  AT  END
010940         GO  TO  SEL-090.
010950*****IF  W-JS = ZERO                                              D.030707
010960*****    IF  OKJF-09 NOT = ZERO                                   D.030707
010970*****        GO  TO  SEL-010.                                     D.030707
010980*****IF  W-JS = 1                                                 D.030707
010990*****    IF  OKJF-09 NOT = 1                                      D.030707
011000     IF  W-JS    NOT =  9                                         I.030707
011010         IF  OKJF-09 NOT = W-JS                                   I.030707
011020             GO  TO  SEL-010.
011030     IF  OKJF-08 = 1
011040         GO  TO  SEL-010.
011050     IF  OKJF-02 NOT = 3
011060         GO  TO  SEL-010.
011070     IF  (OKJF-07 > ZERO)  AND  (OKJF-10 = 1)
011080         NEXT  SENTENCE
011090       ELSE
011100         GO  TO  SEL-010.
011110*****IF  JS-SIGN = 0                                              D.060221
011120*****    IF  OKJF-04 = 2  OR  3  OR  5  OR  6                     D.051216
011130     IF  W-SOK   = 0                                              I.060221
011140         IF  OKJF-04 = 2  OR  3  OR  4  OR  5  OR  6  OR  7       I.051216
011150             GO  TO  SEL-010.
011160*****IF  JS-SIGN = 1                                              D.060221
011170*****    IF  OKJF-04 NOT = 2  AND  3                              D.060221
011180     IF  W-SOK   = 1                                              I.060221
011190         IF  OKJF-04 NOT = 6                                      I.060221
011200             GO  TO  SEL-010.
011210*****IF  JS-SIGN = 2                                              D.060221
011220*****    IF  OKJF-04 NOT = 5  AND  6                              D.060221
011230     IF  W-SOK   = 2                                              I.060221
011240         IF  OKJF-04 NOT = 7                                      I.060221
011250             GO  TO  SEL-010.
011260*****IF  JS-SIGN = 3                                              D.060221
011270*****    IF  OKJF-04 NOT = 2  AND  3  AND  5  AND  6              D.060221
011280     IF  W-SOK   = 3                                              I.060221
011290         IF  OKJF-04 NOT = 4                                      I.060221
011300             GO  TO  SEL-010.
011310     MOVE  ZERO  TO  W-NGP.
011320     MOVE  OKJF-03  TO  W-NGPS.
011330     IF  W-NEN2 >= DATE-NF1  AND  <= DATE-NT1
011340         ADD  DATE-NC1  TO  W-NEN.
011350     IF  W-NEN2 >= DATE-NF2  AND  <= DATE-NT2
011360         ADD  DATE-NC2  TO  W-NEN.
011370     IF  W-SDATE = ZERO
011380         MOVE  W-NGP  TO  W-SDATE.
011390     IF  W-SDATE > W-NGP
011400         MOVE  W-NGP  TO  W-SDATE.
011410     IF  W-EDATE < W-NGP
011420         MOVE  W-NGP  TO  W-EDATE.
011430     GO  TO  SEL-010.
011440 SEL-090.
011450     CLOSE  OKJF.
011460     IF  W-FOC     =  1                                           I.030722
011470         OPEN  I-O    OKJF.                                       I.030722
011480     MOVE  W-SDATE  TO  W-SNGP.
011490     MOVE  W-EDATE  TO  W-ENGP.
011500 SEL-EX.
011510     EXIT.
011520 NAM-RTN.                                                         I.020820
011530     MOVE 0 TO WN-DCHK.                                           I.020820
011540 NAM-010.                                                         I.020820
011550     MOVE SPACE TO WN-ONAME WN-UNAME.                             I.020820
011560     MOVE 27 TO WN-CNT1.                                          I.020820
011570 NAM-020.                                                         I.020820
011580     SUBTRACT 1 FROM WN-CNT1.                                     I.020820
011590     IF WN-CNT1 = 14                                              I.020820
011600         MOVE SPACE TO WN-ONAME                                   I.020820
011610         MOVE WN-NAME TO WN-UNAME                                 I.020820
011620         GO TO NAM-EX.                                            I.020820
011630     IF WN-NA(WN-CNT1) = SPACE                                    I.020820
011640         GO TO NAM-020.                                           I.020820
011650     IF WN-DCHK = 1                                               I.020820
011660         GO TO NAM-310.                                           I.020820
011670     IF WN-DCHK = 2                                               I.020820
011680         GO TO NAM-410.                                           I.020820
011690 NAM-100.                                                         I.020820
011700     MOVE 15 TO WN-CNT2.                                          I.020820
011710 NAM-110.                                                         I.020820
011720     IF WN-NA(WN-CNT1) = SPACE                                    I.020820
011730         GO TO NAM-120.                                           I.020820
011740     SUBTRACT 1 FROM WN-CNT2.                                     I.020820
011750     IF WN-CNT2 NOT = ZERO                                        I.020820
011760         MOVE WN-NA(WN-CNT1) TO WN-UNA(WN-CNT2)                   I.020820
011770         SUBTRACT 1 FROM WN-CNT1                                  I.020820
011780         GO TO NAM-110.                                           I.020820
011790     GO TO NAM-210.                                               I.020820
011800 NAM-120.                                                         I.020820
011810     IF WN-CNT1 > 15                                              I.020820
011820         SUBTRACT 1 FROM WN-CNT1                                  I.020820
011830         GO TO NAM-110.                                           I.020820
011840*
011850     MOVE ZERO TO WN-CNT3.                                        I.020820
011860 NAM-130.                                                         I.020820
011870     ADD 1 TO WN-CNT3.                                            I.020820
011880     IF WN-CNT1 = WN-CNT3                                         I.020820
011890         GO TO NAM-EX.                                            I.020820
011900     IF WN-CNT3 < 15                                              I.020820
011910         MOVE WN-NA(WN-CNT3) TO WN-ONA(WN-CNT3)                   I.020820
011920         GO TO NAM-130.                                           I.020820
011930 NAM-210.                                                         I.020820
011940     MOVE WN-NAME TO WN-WNAME.                                    I.020820
011950     MOVE SPACE TO WN-NAME.                                       I.020820
011960     MOVE ZERO TO WN-CNT1 WN-CNT2.                                I.020820
011970 NAM-220.                                                         I.020820
011980     ADD 1 TO WN-CNT1.                                            I.020820
011990     IF WN-CNT1 > 26                                              I.020820
012000         MOVE 1 TO WN-DCHK                                        I.020820
012010         GO TO NAM-010.                                           I.020820
012020     IF WN-WNA(WN-CNT1) NOT = SPACE                               I.020820
012030         ADD 1 TO WN-CNT2                                         I.020820
012040         MOVE WN-WNA(WN-CNT1) TO WN-NA(WN-CNT2).                  I.020820
012050     GO TO NAM-220.                                               I.020820
012060 NAM-310.                                                         I.020820
012070     MOVE WN-NAME TO WN-WNAME.                                    I.020820
012080     MOVE SPACE TO WN-NAME.                                       I.020820
012090     MOVE ZERO TO WN-CNT1.                                        I.020820
012100 NAM-320.                                                         I.020820
012110     ADD 1 TO WN-CNT1.                                            I.020820
012120     IF WN-CNT1 > 23                                              I.020820
012130         MOVE SPACE TO WN-NAME                                    I.020820
012140         MOVE WN-WNAME TO WN-NAME                                 I.020820
012150         GO TO NAM-410.                                           I.020820
012160     MOVE WN-WNA(WN-CNT1) TO WN-NA(WN-CNT1).                      I.020820
012170     MOVE SPACE TO WN-KUM.                                        I.020820
012180     MOVE WN-CNT1 TO WN-CNT2.                                     I.020820
012190     MOVE ZERO TO WN-CNT3.                                        I.020820
012200 NAM-330.                                                         I.020820
012210     ADD 1 TO WN-CNT3.                                            I.020820
012220     IF WN-CNT3 NOT = 5                                           I.020820
012230         MOVE WN-WNA(WN-CNT2) TO WN-KU(WN-CNT3)                   I.020820
012240         ADD 1 TO WN-CNT2                                         I.020820
012250         GO TO NAM-330.                                           I.020820
012260     IF WN-KUM NOT = NC"äîéÆâÔé–" AND NC"óLå¿âÔé–"                I.020820
012270         GO TO NAM-320.                                           I.020820
012280*
012290     IF WN-KUM = NC"äîéÆâÔé–"                                     I.020820
012300         MOVE NC"áä" TO WN-NA(WN-CNT1).                           I.020820
012310     IF WN-KUM = NC"óLå¿âÔé–"                                     I.020820
012320         MOVE NC"áã" TO WN-NA(WN-CNT1).                           I.020820
012330     MOVE WN-CNT1 TO WN-CNT2.                                     I.020820
012340     ADD 3 TO WN-CNT2.                                            I.020820
012350 NAM-340.                                                         I.020820
012360     ADD 1 TO WN-CNT1 WN-CNT2.                                    I.020820
012370     IF WN-CNT2 < 27                                              I.020820
012380         MOVE WN-WNA(WN-CNT2) TO WN-NA(WN-CNT1)                   I.020820
012390         GO TO NAM-340.                                           I.020820
012400     MOVE 2 TO WN-DCHK.                                           I.020820
012410     GO TO NAM-010.                                               I.020820
012420 NAM-410.                                                         I.020820
012430     MOVE SPACE TO WN-ONAME WN-UNAME.                             I.020820
012440     MOVE ZERO TO WN-CNT1.                                        I.020820
012450 NAM-420.                                                         I.020820
012460     ADD 1 TO WN-CNT1.                                            I.020820
012470     IF WN-CNT1 > 26                                              I.020820
012480         GO TO NAM-EX.                                            I.020820
012490     IF WN-CNT1 < 15                                              I.020820
012500         MOVE WN-NA(WN-CNT1) TO WN-ONA(WN-CNT1)                   I.020820
012510         GO TO NAM-420.                                           I.020820
012520     IF WN-CNT1 = 15                                              I.020820
012530         MOVE 2 TO WN-CNT2.                                       I.020820
012540     ADD 1 TO WN-CNT2.                                            I.020820
012550     MOVE WN-NA(WN-CNT1) TO WN-UNA(WN-CNT2)                       I.020820
012560     GO TO NAM-420.                                               I.020820
012570 NAM-EX.                                                          I.020820
012580     EXIT.                                                        I.020820
012590     COPY    LPMSG.                                               COPYLIB.
012600*********************  ÇoÇqÇnÇfÇqÇ`ÇlÅ@Å@ÇdÇmÇcÅ@*************************
