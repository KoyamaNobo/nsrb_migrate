000010 IDENTIFICATION    DIVISION.
000020 PROGRAM-ID.       JTN30L.
000030******************************************************************
000040*    “úi  o‰×Žw}‘@i•Ô•i“`•[j                              *
000050*    ‚m‚nD‚P‚X‚S  ”~Š_        ‚g‚O‚PD‚O‚WD‚P‚U                *
000060*    JS-W     : 0=–{ŽÐ , 1=‘I‘ð , 2=‹Ê“‡ , 3=‘“‡ , 9=•Ô•i       *
000070*****JS-SIGN3 : 0=Žw} , 1=•Ô•i                                  *
000080******************************************************************
000090
000100 ENVIRONMENT       DIVISION.
000110 CONFIGURATION     SECTION.
000120 SOURCE-COMPUTER.  SYSTEM3100.
000130 OBJECT-COMPUTER.  SYSTEM3100.
000140 INPUT-OUTPUT      SECTION.
000150 FILE-CONTROL.
000160*****COPY LIBCSE.                                                 D.090919
000170     SELECT  JSTR   ASSIGN  JSTR-MSD
000180                    ORGANIZATION  INDEXED
000190                    ACCESS  MODE  DYNAMIC
000200                    RECORD  KEY   JSTR-KEY
000210                    FILE  STATUS  ERR-STAT.
000220     SELECT  JCON   ASSIGN  JCON-MSD
000230                    ORGANIZATION  INDEXED
000240                    ACCESS  MODE  RANDOM
000250                    RECORD  KEY   JCON2-KEY.
000260     SELECT  TC-M   ASSIGN  TCM-MSD
000270                    ORGANIZATION  INDEXED
000280                    ACCESS  MODE  RANDOM
000290                    RECORD  KEY   TC-KEY.
000300*****SELECT  SHM    ASSIGN  SHM-MSD                               D.010808
000310     SELECT  HI2-M  ASSIGN  HI2-MSD                               I.010808
000320                    ORGANIZATION  INDEXED
000330                    ACCESS  MODE  RANDOM
000340                    RECORD  KEY   HI-KEY2.                        I.010808
000350*****               RECORD  KEY   SHM-KEY.                        D.010808
000360     SELECT  T-M    ASSIGN  T1-MSD T2-MSD                         I.010221
000370                    ORGANIZATION  INDEXED                         I.010221
000380                    ACCESS  MODE  RANDOM                          I.010221
000390                    RECORD  KEY   T-KEY                           I.010221
000400         ALTERNATE  RECORD  KEY   T-KEY2.                         I.010221
000410     SELECT  THTM   ASSIGN  THT1-MSD THT2-MSD                     I.100202
000420                    ORGANIZATION  INDEXED                         I.100202
000430                    ACCESS  MODE  RANDOM                          I.100202
000440                    RECORD  KEY   THT-KEY                         I.100202
000450         ALTERNATE  RECORD  KEY   THT-KEY2.                       I.100202
000460     SELECT       JMSTD      ASSIGN   TO F7-MSD F7A-MSD F7B-MSD   I.150618
000470                  ORGANIZATION        INDEXED                     I.150618
000480                  ACCESS     MODE     DYNAMIC                     I.150618
000490                  RECORD     KEY      JMSTD-KEY1                  I.150618
000500                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY2     I.150618
000510                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY3     I.150618
000520                  FILE       STATUS   IS    ERR-STAT.             I.150618
000530     SELECT  PRN-F  ASSIGN  PRF-PRN999.
000540 I-O-CONTROL.
000550     APPLY  SHARED-MODE  ON  JSTR
000560                             JCON
000570                             TC-M
000580*****                        SHM                                  D.010808
000590                             HI2-M                                I.010808
000600                             T-M                                  I.010221
000610                             THTM                                 I.100202
000620                             JMSTD                                I.150618
000630*****                        M-DATE                               D.090919
000640     APPLY  SHIFT-CODE   ON  PRN-F.
000650
000660 DATA              DIVISION.
000670 FILE              SECTION.
000680*****  COPY  LIBFDD.                                              D.090919
000690       COPY  L-JSTR.
000700       COPY  L-JCON.
000710       COPY  LITCM.
000720*****  COPY  L-SHM.                                               D.010808
000730       COPY  LIHIM2.                                              I.010808
000740       COPY  LITM.                                                I.010221
000750       COPY  LITHTM.                                              I.100202
000760       COPY   LJMSTD.                                             I.150618
000770 FD  PRN-F
000780     LABEL  RECORD  OMITTED
000790     LINAGE  33.
000800 01  PRN-R                 PIC X(180).
000810 WORKING-STORAGE   SECTION.
000820 01  END-SW                PIC 9      VALUE 0.
000830 01  RED-SW                PIC 9      VALUE 0.
000840*01  TCM-SW                PIC 9      VALUE 0.                    D.971002
000850 01  WORK-1.
000860*****02  F                 PIC X(108).                            D.890901
000870*****02  F                 PIC X(104).                            D.940801
000880*****02  F                 PIC X(108).                            D.950202
000890*****02  F                 PIC X(98).                             D.980826
000900     02  F                 PIC X(93).                             I.980826
000910     02  ST-CD0            PIC X(5).                              I.950202
000920     02  WORK-10           PIC N(2).                              I.950202
000930     02  ED-CD0            PIC X(5).                              I.950202
000940     02  F                 PIC X(7).                              I.950202
000950     02  WORK-11           PIC 9(6).                               “`•[‡‚
000960 01  WORK-1A.                                                     I.010306
000970     02  F                 PIC X(85)  VALUE  SPACE.               I.010606
000980     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.010306
000990     02  F                 PIC X(8)   VALUE  ""3F504F40677F4F9B"".I.010306
001000     02  WORK-NA           PIC N(8)   VALUE  SPACE.               I.010306
001010     02  F                 PIC X(8)   VALUE  ""3F504F40674F40A0"".I.010306
001020     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.010306
001030 01  WORK-1B.                                                     I.010306
001040     02  F                 PIC X(87)  VALUE  SPACE.               I.010306
001050     02  F                 PIC N(1)   VALUE  NC"§".              I.010306
001060     02  WORK-UNO          PIC X(8)   VALUE  SPACE.               I.010306
001070 01  WORK-1C.                                                     I.010306
001080     02  F                 PIC X(87)  VALUE  SPACE.               I.010306
001090     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.010306
001100     02  WORK-JS           PIC N(14)  VALUE  SPACE.               I.010306
001110     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.010306
001120 01  WORK-2.
001130*****02  F                 PIC X(38).                             D.890901
001140*****02  F                 PIC X(35).                             D.940801
001150*****02  F                 PIC X(39).                             D.980826
001160*****02  F                 PIC X(34).                             D.010306
001170*****02  WORK-M1           PIC N(02).                             D.010306
001180     02  F                 PIC X(38).                             I.010306
001190     02  WORK-M2           PIC X(01).                             I.890901
001200     02  WORK-21.                                                  o‰×“ú
001210*****    03  WORK-211      PIC ZZ.                                D.000106
001220         03  WORK-211      PIC 9(2).                              I.000106
001230         03  F             PIC X(4).
001240         03  WORK-212      PIC ZZ.                                   ŒŽ
001250         03  F             PIC X(4).
001260         03  WORK-213      PIC ZZ.                                   “ú
001270*****02  F                 PIC X(10).                             D 890920
001280     02  F                 PIC X(09).                             A 890920
001290     02  WORK-22           PIC N(2).                                “`‹æ
001300     02  F                 PIC X(4).
001310     02  WORK-23           PIC N(06).                             A 890920
001320     02  F                 PIC X(5).                              I.010306
001330     02  WORK-TM           PIC X(3).                              I.010306
001340     02  F                 PIC X(1).                              I.010306
001350     02  WORK-TEL          PIC X(14).                             I.010306
001360*****02  WORK-23           PIC 9.                                 D 890920
001370 01  WORK-3.
001380*****02  F                 PIC X(66).                             D.910703
001390*****02  F                 PIC X(07).                             D.910703
001400*****02  WORK-32           PIC 9(6).                              D.910703
001410*****02  F                 PIC X(62).                             D.940801
001420*****02  F                 PIC X(66).                             D.980826
001430     02  F                 PIC X(61).                             I.980826
001440     02  WORK-31           PIC 9(6).                              ‘—‚èó‡‚
001450     02  F                 PIC X(20).                             I.010306
001460     02  WORK-FM           PIC X(3).                              I.010306
001470     02  F                 PIC X(1).                              I.010306
001480     02  WORK-FAX          PIC X(14).                             I.010306
001490*****02  F                 PIC X(36).                             D.910702
001500*----  ŠO•”‘qŒÉ—p  -------------------------------------------------------
001510 01  WORK-1AG.                                                    I.060207
001520     02  F                 PIC X(81)  VALUE  SPACE.               I.060207
001530     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.060207
001540     02  WORK-NAG          PIC N(18)  VALUE  SPACE.               I.060207
001550     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.060207
001560 01  WORK-1BG.                                                    I.060207
001570     02  F                 PIC X(79)  VALUE  SPACE.               I.060207
001580     02  F                 PIC N(2)   VALUE  NC"@§".            I.060207
001590     02  WORK-UNOG         PIC X(8)   VALUE  SPACE.               I.060207
001600 01  WORK-1CG.                                                    I.060207
001610     02  F                 PIC X(81)  VALUE  SPACE.               I.060207
001620     02  F                 PIC X(5)   VALUE  ""3FE04F40A0"".      I.060207
001630     02  WORK-JSG          PIC N(20)  VALUE  SPACE.               I.060207
001640     02  F                 PIC X(5)   VALUE  ""3FE04FE080"".      I.060207
001650 01  WORK-2G.                                                     I.060207
001660     02  F                 PIC X(38).                             I.060207
001670     02  WORK-M2G          PIC X(01).                             I.060207
001680     02  WORK-21G.                                                I.060207
001690         03  WORK-211G     PIC 9(2).                              I.060207
001700         03  F             PIC X(4).                              I.060207
001710         03  WORK-212G     PIC ZZ.                                I.060207
001720         03  F             PIC X(4).                              I.060207
001730         03  WORK-213G     PIC ZZ.                                I.060207
001740     02  F                 PIC X(09).                             I.060207
001750     02  WORK-22G          PIC N(2).                              I.060207
001760     02  F                 PIC X(4).                              I.060207
001770     02  WORK-K1G          PIC X(05).                             I.060207
001780     02  WORK-23G          PIC N(06).                             I.060207
001790     02  F                 PIC X(05).                             I.060926
001800     02  WORK-JSSG         PIC N(16).                             I.060926
001810*****02  F                 PIC X(11).                             D.060926
001820*****02  WORK-JSSG         PIC N(12).                             D.060926
001830     02  WORK-K2G          PIC X(05).                             I.060207
001840 01  WORK-3G.                                                     I.060207
001850     02  F                 PIC X(61).                             I.060207
001860     02  WORK-31G          PIC 9(6).                              I.060207
001870     02  F                 PIC X(14).                             I.060207
001880     02  WORK-TMG          PIC X(3).                              I.060207
001890     02  F                 PIC X(1).                              I.060207
001900     02  WORK-TELG         PIC X(14).                             I.060207
001910*-------------------------------------------------------------------------
001920 01  WORK-3A.                                                     I.910703
001930*****02  F                 PIC X(105).                            D.940801
001940*****02  F                 PIC X(109).                            D.980826
001950*****02  F                 PIC X(104).                            D.000125
001960     02  F                 PIC X(5).                              I.000125
001970     02  WORK-33A.                                                I.000125
001980       03  WORK-33F        PIC X(1).                              I.000125
001990       03  WORK-331        PIC 9(1).                              I.010221
002000       03  WORK-332        PIC X(1).                              I.010221
002010       03  WORK-333        PIC 9(1).                              I.010221
002020*****  03  WORK-33         PIC Z(3).                              D.010221
002030       03  WORK-33R        PIC X(1).                              I.000125
002040     02  F                 PIC X(94).                             I.000125
002050     02  WORK-32           PIC 9(6).                              I.900411
002060 01  WORK-4.
002070*****02  F                 PIC X(11).                             D.890901
002080*****02  F                 PIC X(07).                             D.940801
002090*****02  F                 PIC X(11).                             D.980826
002100     02  F                 PIC X(06).                             I.980826
002110     02  WORK-41           PIC 9(4).                              “¾ˆÓæCD
002120     02  F                 PIC X(4).
002130     02  ST-CD1            PIC X(5).                              1.5BYTE
002140     02  WORK-42           PIC N(26).                             I.020410
002150     02  F                 PIC X(5).                              I.020410
002160     02  WORK-43           PIC X(3).                              I.020410
002170     02  F                 PIC X(4).                              I.020410
002180     02  WORK-44           PIC N(26).                             I.020410
002190*****02  WORK-42           PIC N(24).                             D.020410
002200*****02  F                 PIC X(8).                              D.020410
002210*****02  WORK-43           PIC X(3).                              D.020410
002220*****02  F                 PIC X(4).                              D.020410
002230*****02  WORK-44           PIC N(24).                             D.020410
002240     02  ED-CD1            PIC X(5).                              2BYTE
002250 01  WORK-5.
002260*****02  F                 PIC X(12).                             D.980826
002270*****02  F                 PIC X(12).                             D.890901
002280*****02  F                 PIC X(08).                             D.940801
002290*****02  ST-CD2            PIC X(5).                              D 911002
002300*****02  WORK-51           PIC N(4).                              D 911002
002310*****02  F                 PIC X(07).                             D.030819
002320     02  F                 PIC X(06).                             I.030819
002330     02  ED-CD2            PIC X(5).                              2BYTE
002340*****02  F                 PIC X(31).                             D.150618
002350     02  F                 PIC X(18).                             I.150618
002360     02  WORK-NGP          PIC 99/99/99.                          I.150618
002370     02  WORK-NGPD  REDEFINES  WORK-NGP.                          I.150618
002380         03  F             PIC X(08).                             I.150618
002390     02  F                 PIC X(05).                             I.150618
002400     02  WORK-51F          PIC X(01).                             I.981027
002410     02  WORK-51           PIC X(10).                             I.981027
002420     02  WORK-51R          PIC X(01).                             I.981027
002430*****02  F                 PIC X(40).                             D 911002
002440*****02  F                 PIC X(37).                             D.981027
002450*****02  WORK-51A          PIC 9(06).                             D.981027
002460*****02  WORK-51AR  REDEFINES  WORK-51A  PIC X(06).               D.981027
002470     02  F                 PIC X(02).                             A 911002
002480     02  WORK-52           OCCURS  10.
002490         03  WORK-521      PIC ----B.                             1¾¯Ä‘«”
002500*****02  F                 PIC X.                                 D.920826
002510     02  WORK-53           PIC ----.                                 Œv
002520     02  WORK-54           PIC X(01).                             I.920826
002530     02  WORK-55           PIC ZZZ.                               I.920826
002540 01  WORK-6.
002550*****02  F                 PIC X(12).                             D.890901
002560*****02  F                 PIC X(08).                             D.940801
002570*****02  F                 PIC X(12).                             D.980826
002580*****02  F                 PIC X(07).                             D.030819
002590     02  F                 PIC X(06).                             I.030819
002600     02  WORK-61           PIC 9(6).                               •i–¼CD
002610     02  F                 PIC X.
002620     02  ST-CD3            PIC X(5).                              1.5BYTE
002630     02  WORK-62           PIC N(24).                               •i–¼
002640     02  ED-CD3            PIC X(5).                              2BYTE
002650     02  F                 PIC X.
002660     02  WORK-63           PIC 9.                                 »²½Þ‹æ•ª
002670     02  F                 PIC X.
002680     02  WORK-64           OCCURS  10.
002690         03  WORK-641      PIC -----.                              Žw}”
002700     02  WORK-65           PIC -------.                             ‡Œv
002710     02  WORK-65R  REDEFINES  WORK-65.                            A 911002
002720         03  WORK-651      PIC X(01).                             A 911002
002730         03  WORK-652      PIC ------.                            A 911002
002740     02  WORK-66           PIC X(01).                             A 911002
002750     02  WORK-67           PIC X.                                 I.100202
002760 01  WORK-6A.                                                     A 911002
002770*****02  F                 PIC X(103).                            D.940801
002780*****02  F                 PIC X(107).                            D.980826
002790*****02  F                 PIC X(102).                            D.030819
002800     02  F                 PIC X(101).                            I.030819
002810     02  WORK-61A          PIC ----.                              A 911002
002820     02  F                 PIC X(01).                             A 911002
002830     02  WORK-62A          PIC X(03).                             A 911002
002840 01  WORK-7.
002850*****02  F                 PIC X(40).                             D.890901
002860*****02  F                 PIC X(35).                             D 890920
002870*****02  F                 PIC X(24).                             D.940801
002880*****02  F                 PIC X(28).                             D.980826
002890     02  F                 PIC X(23).                             I.980826
002900*****02  WORK-70           PIC ZZ9.                               D.010314
002910     02  WORK-70           PIC ZZZ.                               I.010314
002920     02  WORK-70R  REDEFINES   WORK-70  PIC X(03).                I.900618
002930     02  F                 PIC X(09).                             I.900411
002940     02  ST-CD4            PIC X(5).                              1.5BYTE
002950     02  WORK-71           PIC N(6).                              I.940728
002960*****02  WORK-71.                                                 D.940728
002970*****    03  WORK-711      PIC N(5).                              D.940728
002980*****    03  WORK-712      PIC N.                                 D.940728
002990     02  F                 PIC X(4).
003000     02  WORK-72.
003010         03  WORK-721      PIC N(23).                               “E—v
003020         03  WORK-722      PIC N(9).                               ”z’B“ú
003030     02  ED-CD4            PIC X(5).                              2BYTE
003040*****02  F                 PIC X(7).                              D.030819
003050     02  F                 PIC X(6).                              I.030819
003060     02  WORK-73           PIC -------.                             ‡Œv
003070 01  WORK-8.
003080     02  WORK-81           OCCURS  10.
003090         03  WORK-811      PIC S9(2).
003100     02  WORK-82           PIC S9(6).
003110 01  WORK-9.
003120     02  WORK-91           OCCURS  10.
003130         03  WORK-911      PIC S9(4).
003140     02  WORK-92           PIC S9(6).
003150 01  I                     PIC 9.
003160 01  J                     PIC 9(2).
003170 01  PAGE-C                PIC 9(3).
003180 01  GOKEI                 PIC S9(6).
003190 01  SEN-W                 PIC 9.                                  ‘I‘ð-W
003200 01  TEST-W                PIC 9.                                 Ã½ÄˆóŽšW
003210 01  DEN-W                 PIC 9(6).                               “`•[-W
003220 01  DEN-W1                PIC 9(6).                              “`•[(FR)
003230 01  DEN-W2                PIC 9(6).                               V (TO)
003240 01  KAKU-W                PIC 9.                                  Šm”F-W
003250 01  ERR-STAT              PIC X(2).
003260 01  W-JS                  PIC 9(1).                              I.030716
003270 01  JS-SIGN               PIC 9(1).                              D.940728
003280 01  JS-W                  PIC 9(1).                              I.091016
003290*01  JS-SIGN3              PIC 9(1)  VALUE  0.                    D.091015
003300*01  JS-SIGN4              PIC 9(1)  VALUE  0.                    D.011109
003310*01  WYMD                  PIC 9(6).                              D.981020
003320 01  OLD-OKNO              PIC 9(6)  VALUE  0.                    I.900618
003330 01  SETSU                 PIC S9(3).                             A 911002
003340 01  W-DEN                 PIC N(9).                              I.010309
003350 01  W-SOUKO               PIC N(4).                              I.940729
003360 01  W-TCD                 PIC 9(4).                              I.100202
003370 01  W-TAN                 PIC 9(5).                              I.100202
003380 01  W-DATA.                                                      I.981020
003390     02  W-DATE            PIC 9(06).                             I.981020
003400     02  W-NGP           REDEFINES  W-DATE.                       I.981020
003410       03  W-NEN           PIC 9(02).                             I.981020
003420       03  W-GET           PIC 9(02).                             I.981020
003430       03  W-PEY           PIC 9(02).                             I.981020
003440     02  W-SDATE           PIC 9(08).                             I.981020
003450     02  W-SNGP.                                                  I.981020
003460       03  W-SNEN          PIC 9(04).                             I.981020
003470       03  W-SNENL       REDEFINES  W-SNEN.                       I.981020
003480         04  W-SNEN1       PIC 9(02).                             I.981020
003490         04  W-SNEN2       PIC 9(02).                             I.981020
003500       03  W-SGET          PIC 9(02).                             I.981020
003510       03  W-SPEY          PIC 9(02).                             I.981020
003520     02  W-EDATE           PIC 9(08).                             I.981020
003530     02  W-ENGP.                                                  I.981020
003540       03  W-ENEN          PIC 9(04).                             I.981020
003550       03  W-ENENL       REDEFINES  W-ENEN.                       I.981020
003560         04  W-ENEN1       PIC 9(02).                             I.981020
003570         04  W-ENEN2       PIC 9(02).                             I.981020
003580       03  W-EGET          PIC 9(02).                             I.981020
003590       03  W-EPEY          PIC 9(02).                             I.981020
003600 01  W-HND.                                                       I.000808
003610     02  W-NAME            PIC N(24).                             I.000808
003620     02  W-NAMED REDEFINES W-NAME.                                I.000808
003630       03  W-NAD   OCCURS  24.                                    I.000808
003640         04  W-NA          PIC N(01).                             I.000808
003650     COPY  LWMSG.
003660 SCREEN            SECTION.
003670 SD  GAMEN  END  STATUS  END-STS.
003680 01  ACP-NYURYOKU.
003690     02  ACP-SIGN  LINE   4.                                      I.060201
003700         03  COLUMN  59  PIC 9     INTO  JS-SIGN                  I.060201
003710                                   CHECK  OVERFLOW  NO  IFC.      I.060201
003720*****02  ACP-JS    LINE   4.                                      D.060201
003730     02  ACP-JS    LINE   7.                                      I.060201
003740*****    03  COLUMN  71  PIC 9     INTO  W-JS                     D.070411
003750*****    03  COLUMN  56  PIC 9     INTO  W-JS                     D.091005
003760         03  COLUMN  56  PIC 9     USING W-JS                     I.091005
003770                                   CHECK  OVERFLOW  NO  IFC.      I.030716
003780*****02  ACP-SEN   LINE   7.                                      D.030716
003790*****02  ACP-SEN   LINE   8.                                      D.060201
003800     02  ACP-SEN   LINE  11.                                      I.060201
003810         03  COLUMN  45  PIC 9     INTO  SEN-W
003820                                   CHECK  OVERFLOW  NO  IFC.
003830*****02  ACP-TEST  LINE  12.                                      D.060201
003840     02  ACP-TEST  LINE  15.                                      I.060201
003850         03  COLUMN  45  PIC 9     INTO  TEST-W
003860                                   CHECK  OVERFLOW  NO  IFC.
003870*****02  ACP-SNGP    LINE  17.                                    D.030716
003880*****02  ACP-SNGP    LINE  16.                                    D.060201
003890     02  ACP-SNGP    LINE  19.                                    I.060201
003900       03  ACP-SNEN  COLUMN  31    PIC 9(02)                      I.981020
003910             USING  W-SNEN2  NO  IFC.                             I.981020
003920       03  ACP-SGET  COLUMN  34    PIC 9(02)                      I.981020
003930             USING  W-SGET   NO  IFC.                             I.981020
003940       03  ACP-SPEY  COLUMN  37    PIC 9(02)                      I.981020
003950             USING  W-SPEY   CHECK  OVERFLOW  NO  IFC.            I.981020
003960*****02  ACP-ENGP    LINE  19.                                    D.030716
003970*****02  ACP-ENGP    LINE  17.                                    D.060201
003980     02  ACP-ENGP    LINE  20.                                    I.060201
003990       03  ACP-ENEN  COLUMN  31    PIC 9(02)                      I.981020
004000             USING  W-ENEN2  NO  IFC.                             I.981020
004010       03  ACP-EGET  COLUMN  34    PIC 9(02)                      I.981020
004020             USING  W-EGET   NO  IFC.                             I.981020
004030       03  ACP-EPEY  COLUMN  37    PIC 9(02)                      I.981020
004040             USING  W-EPEY   CHECK  OVERFLOW  NO  IFC.            I.981020
004050*****02  ACP-DEN1  LINE  17.                                      D.030716
004060*****02  ACP-DEN1  LINE  16.                                      D.060201
004070     02  ACP-DEN1  LINE  19.                                      I.060201
004080         03  COLUMN  31  PIC 9(6)  INTO  DEN-W1
004090                                   CHECK  OVERFLOW  NO  IFC.
004100*****02  ACP-DEN2  LINE  19.                                      D.030716
004110*****02  ACP-DEN2  LINE  17.                                      D.060201
004120     02  ACP-DEN2  LINE  20.                                      I.060201
004130         03  COLUMN  31  PIC 9(6)  INTO  DEN-W2
004140                                   CHECK  OVERFLOW  NO  IFC.
004150     02  ACP-KAKU  LINE  24.
004160         03  COLUMN  63  PIC 9     INTO  KAKU-W
004170                                   CHECK  OVERFLOW  NO  IFC.
004180 01  DSP-GAMEN.
004190     02  LINE   1  COLUMN  26  PIC N(09) FROM  W-DEN   REVERSE.   I.010309
004200     02  DSP-SOUKO  LINE   1  COLUMN  55  PIC N(4)  FROM  W-SOUKO.I.060201
004210*****02  LINE   1  COLUMN  26  VALUE                              D.010309
004220*****    NC"o@‰×@Žw@}@‘" REVERSE.                          D.010309
004230*****02  LINE   1  COLUMN  55  PIC N(4)  FROM  W-SOUKO.           D.060201
004240*****02  LINE   3.                                                D.030716
004250     02  LINE   2.                                                I.030716
004260       03  COLUMN  63    PIC 9(02)    FROM   W-NEN.               I.981020
004270       03  COLUMN  65    PIC N(01)    VALUE  NC"”N".              I.981020
004280       03  COLUMN  67    PIC 9(02)    FROM   W-GET.               I.981020
004290       03  COLUMN  69    PIC N(01)    VALUE  NC"ŒŽ".              I.981020
004300       03  COLUMN  71    PIC 9(02)    FROM   W-PEY.               I.981020
004310       03  COLUMN  73    PIC N(01)    VALUE  NC"“ú".              I.981020
004320*****02  LINE   4.                                                D.060201
004330     02  LINE   7.                                                I.060201
004340       03  COLUMN  21    PIC X(36)    VALUE                       I.070411
004350            "‹³@ˆç=0 , ˆê@”Ê=1 , ‚`‚k‚k=9 ...  ".               I.070411
004360*****  03  COLUMN  21    PIC X(22)    VALUE                       D.070411
004370*****       "‹³@ˆç=0 , ƒ[ƒN=1 , ".                             D.070411
004380*****  03  COLUMN  43    PIC N(05)    VALUE  NC"ƒJƒWƒ…ƒAƒ‹".      D.070411
004390*****  03  COLUMN  53    PIC X(19)    VALUE                       D.070411
004400*****       "=2 , ‚`‚k‚k=9 ...  ".                                D.030716
004410*****02  LINE   5  COLUMN  25  VALUE  NC"‚P@”­@s".             D.030716
004420*****02  LINE   7.                                                D.030716
004430*****02  LINE   7  COLUMN  25  VALUE  NC"‚P@”­@s".             D.060201
004440*****02  LINE   8.                                                D.060201
004450     02  LINE  10  COLUMN  25  VALUE  NC"‚P@”­@s".             I.060201
004460     02  LINE  11.                                                I.060201
004470         03  COLUMN  25  VALUE NC"‚Q@Ä”­s@@‘I‘ð".
004480         03  COLUMN  44  VALUE   "[".
004490         03  COLUMN  46  VALUE   "]".
004500*****02  LINE  10  COLUMN  21  VALUE  NC"ƒeƒXƒgƒvƒŠƒ“ƒgˆóŽš".     D.030716
004510*****02  LINE  11  COLUMN  21  VALUE  NC"ƒeƒXƒgƒvƒŠƒ“ƒgˆóŽš".     D.060201
004520*****02  LINE  12.                                                D.060201
004530     02  LINE  14  COLUMN  21  VALUE  NC"ƒeƒXƒgƒvƒŠƒ“ƒgˆóŽš".     I.060201
004540     02  LINE  15.                                                I.060201
004550         03  COLUMN  31  VALUE   "(YES=1,NO=2) [".
004560         03  COLUMN  46  VALUE   "]".
004570*****02  LINE  15  COLUMN  31  VALUE  NC"“`•[‡‚".                 D.981020
004580*****02  LINE  17  COLUMN  21  VALUE  NC"‚e‚q‚n‚l".               D.030716
004590*****02  LINE  19  COLUMN  21  VALUE  NC"‚s‚n".                   D.030716
004600*****02  LINE  16  COLUMN  21  VALUE  NC"‚e‚q‚n‚l".               D.060201
004610*****02  LINE  17  COLUMN  21  VALUE  NC"‚s‚n".                   D.060201
004620     02  LINE  19  COLUMN  21  VALUE  NC"‚e‚q‚n‚l".               I.060201
004630     02  LINE  20  COLUMN  21  VALUE  NC"‚s‚n".                   I.060201
004640     02  LINE  24.
004650         03  COLUMN  41  VALUE  NC"Šm”Fi".
004660         03  COLUMN  47  VALUE    "OK=1,NO=9".
004670         03  COLUMN  56  VALUE  NC"j".
004680         03  COLUMN  58  VALUE    "--->  ØÀ°Ý".
004690 01  DSP-GAMEN1.                                                  I.981020
004700     02  DSP-SOK   LINE   4.                                      I.060201
004710       03  COLUMN  21    PIC X(39)    VALUE                       I.060201
004720            "–{ŽÐ=0 , ‹Ê“‡=1 , ’ÃŽR=2 , ‘“‡=3 ...  ".            I.091015
004730*****       "–{ŽÐ=0 , ‹Ê“‡=1 , ’ÃŽR=2 , —¼”õ=3 ...  ".            D.091015
004740*****       "–{ŽÐ=0 , ‹Ê“‡=1 , ’ÃŽR=2 , ‚‰®=3 ...  ".            D.060926
004750*****02  DSP-DNOM  LINE  15    COLUMN  31   VALUE  NC"“`•[‡‚".    D.060201
004760     02  DSP-DNOM  LINE  18    COLUMN  31   VALUE  NC"“`•[‡‚".    I.060201
004770     02  DSP-DATM.                                                I.981020
004780       03  LINE  18    COLUMN  31    VALUE  NC"“ú@•t".           I.060201
004790       03  LINE  19    COLUMN  31    VALUE  "  /  /  ".           I.060201
004800       03  LINE  20    COLUMN  31    VALUE  "  /  /  ".           I.060201
004810*****  03  LINE  15    COLUMN  31    VALUE  NC"“ú@•t".           D.060201
004820*****  03  LINE  16    COLUMN  31    VALUE  "  /  /  ".           D.060201
004830*****  03  LINE  17    COLUMN  31    VALUE  "  /  /  ".           D.060201
004840*****  03  LINE  19    COLUMN  31    VALUE  "  /  /  ".           D.030716
004850*01  DSP-MID.                                                     D.030716
004860*****02  DSP-MID0  LINE   1  COLUMN   1   VALUE  NC"ŽÐ–¼‚ ‚è—pŽ†".D.011109
004870*****02  DSP-MID1  LINE   1  COLUMN   1   VALUE  NC"ŽÐ–¼‚È‚µ—pŽ†".D.030716
004880 01  DSP-CLER  LINE   1.
004890     02  CLEAR  SCREEN.
004900 01  DSP-CLER2.
004910     02  LINE 19   COLUMN 31   PIC X(08)   VALUE "        ".      I.060201
004920     02  LINE 20   COLUMN 31   PIC X(08)   VALUE "        ".      I.060201
004930*****02  LINE 16   COLUMN 31   PIC X(08)   VALUE "        ".      D.060201
004940*****02  LINE 17   COLUMN 31   PIC X(08)   VALUE "        ".      D.060201
004950*****02  LINE 19   COLUMN 31   PIC X(08)   VALUE "        ".      D.030716
004960*****02  LINE 17   COLUMN 31   PIC X(06)   VALUE "      ".        D.981020
004970*****02  LINE 19   COLUMN 31   PIC X(06)   VALUE "      ".        D.981020
004980 01  DSP-MI.
004990     02  LINE  24  COLUMN   1  VALUE
005000         NC"––o‰×Žw}ƒgƒ‰ƒ“@–¢“o˜^".
005010     COPY  LSERR.                                                 R.900411
005020*****COPY  LIBSCR.                                                D.090919
005030*
005040 PROCEDURE         DIVISION.
005050 MAINLINE-ROUTINE.
005060*****PERFORM  JS-ACP-RTN  THRU  JS-ACP-EX.                        D.030716
005070     PERFORM  INIT-RTN  THRU  INIT-RTN-EXIT.
005080     PERFORM  SLCT-RTN  THRU  SLCT-RTN-EXIT.
005090     IF  END-STS  =  "P9"  STOP  RUN.
005100     PERFORM  OPEN-RTN  THRU  OPEN-RTN-EXIT.
005110     PERFORM  PROC-RTN  THRU  PROC-RTN-EXIT
005120              UNTIL  NOT  (END-SW  NOT  =  9).
005130     IF  PAGE-C  NOT =  1                                         I.900510
005140         MOVE     SPACE     TO    PRN-R                           I.890915
005150         WRITE    PRN-R     AFTER     PAGE.                       I.890915
005160*
005170     PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT.
005180 MAINLINE-END.
005190     STOP  RUN.
005200
005210******************************************************************
005220*    ƒƒCƒ“ˆ—  i‚o‚q‚n‚b|‚q‚s‚mj                            *
005230******************************************************************
005240 PROC-RTN.
005250     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
005260     PERFORM  GENT-RTN   THRU  GENT-RTN-EXIT
005270              UNTIL  NOT  (END-SW  =  0  AND  RED-SW  =  1).
005280 PROC-RTN-EXIT.
005290     EXIT.
005300
005310******************************************************************
005320*    i‚f‚d‚m‚s|‚q‚s‚mj                                        *
005330******************************************************************
005340 GENT-RTN.
005350     PERFORM  READ2-RTN  THRU  READ2-RTN-EXIT.
005360     PERFORM  DETL-RTN   THRU  DETL-RTN-EXIT.
005370     PERFORM  READ1-RTN  THRU  READ1-RTN-EXIT.
005380     PERFORM  TOTL-RTN   THRU  TOTL-RTN-EXIT.
005390 GENT-RTN-EXIT.
005400     EXIT.
005410
005420******************************************************************
005430*    ‰ŠúÝ’èˆ—  i‚h‚m‚h‚s|‚q‚s‚mj                          *
005440******************************************************************
005450 INIT-RTN.
005460     ACCEPT   JS-W.                                               I.091015
005470*****ACCEPT   JS-SIGN.                                            D.091015
005480*****ACCEPT  JS-SIGN3.                                            D.091015
005490*****IF  JS-SIGN3      =  1                                       D.091015
005500     IF  JS-W          =  9                                       I.091015
005510         MOVE  NC"@•Ô@•i@“`@•[@"  TO  W-DEN                  I.010309
005520         MOVE  9             TO  JS-SIGN                          I.091015
005530     ELSE                                                         I.010309
005540         MOVE  NC"o@‰×@Žw@}@‘"  TO  W-DEN.                 I.010309
005550*****IF  IPN-KYO-KBN   =  1                                       D.011109
005560*****    IF  JS-SIGN       =  1                                   D.011109
005570*****        IF  JS-SIGN3      =  0                               D.011109
005580*****            ACCEPT  JS-SIGN4.                                D.011109
005590*****IF  JS-SIGN       =  1      MOVE  NC"–{@@ŽÐ"  TO  W-SOUKO. D.060201
005600*****IF  JS-SIGN       =  2      MOVE  NC"“úi‰»¬"  TO  W-SOUKO. D.060201
005610*****IF  JS-SIGN       =  3      MOVE  NC"‚@@‰®"  TO  W-SOUKO. D.060201
005620*****ACCEPT   WYMD    FROM    DATE.                               D.981020
005630*****IF  JS-SIGN       =  0      MOVE  NC"–{@@ŽÐ"  TO  W-SOUKO  D.091015
005640     MOVE  NC"@@@@"  TO  W-SOUKO.                             I.091015
005650     IF  JS-W          =  0      MOVE  0             TO  JS-SIGN. I.091015
005660     IF  JS-W          =  2      MOVE  1             TO  JS-SIGN. I.091015
005670     IF  JS-W          =  3      MOVE  3             TO  JS-SIGN. I.091015
005680*****                       ELSE MOVE  NC"@@@@"  TO  W-SOUKO. D.091015
005690     MOVE  1      TO  PAGE-C.
005700     MOVE  0      TO  GOKEI.
005710     MOVE  0      TO  SETSU.                                      A 911002
005720     MOVE  SPACE  TO  WORK-1  WORK-2  WORK-3  WORK-3A             I.981020
005730                      WORK-4  WORK-5  WORK-6  WORK-6A             I.981020
005740                      WORK-7  WORK-8  WORK-9.                     I.981020
005750     MOVE  ZERO   TO  W-DATA.                                     I.981020
005760     ACCEPT  W-DATE  FROM  DATE.                                  I.981020
005770*****COPY LIBCPR.                                                 D.090919
005780 INIT-RTN-EXIT.
005790     EXIT.
005800
005810******************************************************************
005820*    ‘I‘ðˆ—  i‚r‚k‚b‚s|‚q‚s‚mj                              *
005830******************************************************************
005840 SLCT-RTN.
005850 SLCT-010.
005860     DISPLAY  DSP-CLER.
005870     DISPLAY  DSP-GAMEN.
005880*****IF  JS-SIGN       =  0  OR  9   GO  TO  SLCT-015.            D.091015
005890     IF  JS-W          =  9          GO  TO  SLCT-015.            I.091015
005900     IF  JS-W      NOT =  1          GO  TO  SLCT-013.            I.091015
005910     DISPLAY  DSP-SOK.                                            I.060201
005920 SLCT-012.                                                        I.060201
005930     ACCEPT   ACP-SIGN.                                           I.060201
005940     DISPLAY  DISP-MSG-SPACE.                                     I.060201
005950     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW               I.060201
005960                                GO  TO  SLCT-RTN-EXIT.            I.060201
005970     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-012.                 I.060201
005980     IF  JS-SIGN  NOT  = 0  AND  1  AND  2  AND  3                I.060201
005990         GO  TO  SLCT-012.                                        I.060201
006000 SLCT-013.                                                        I.091015
006010     IF  JS-SIGN       =  0      MOVE  NC"–{@@ŽÐ"  TO  W-SOUKO. I.060201
006020     IF  JS-SIGN       =  1      MOVE  NC"‹Ê@@“‡"  TO  W-SOUKO. I.060201
006030     IF  JS-SIGN       =  2      MOVE  NC"’Ã@@ŽR"  TO  W-SOUKO. I.060201
006040     IF  JS-SIGN       =  3      MOVE  NC"‘@@“‡"  TO  W-SOUKO. I.091015
006050*****IF  JS-SIGN       =  3      MOVE  NC"—¼@@”õ"  TO  W-SOUKO. D.091015
006060*****IF  JS-SIGN       =  3      MOVE  NC"‚@@‰®"  TO  W-SOUKO. D.060926
006070     DISPLAY  DSP-SOUKO.                                          I.060201
006080     IF  JS-SIGN   NOT =  0                                       I.091005
006090         MOVE  9        TO  W-JS                                  I.091005
006100         DISPLAY  ACP-JS                                          I.091005
006110         GO  TO  SLCT-020.                                        I.091005
006120 SLCT-015.                                                        I.030716
006130     ACCEPT   ACP-JS.                                             I.030716
006140     DISPLAY  DISP-MSG-SPACE.                                     I.030716
006150     IF  END-STS       =  "09"                                    I.060201
006160         IF  JS-W          =  1           GO  TO  SLCT-012.       I.091015
006170*****    IF  JS-SIGN   NOT =  0  AND  9   GO  TO  SLCT-012.       D.091015
006180*****    IF  JS-SIGN   NOT =  0     GO  TO  SLCT-012.             D.091005
006190     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW               I.030716
006200                                GO  TO  SLCT-RTN-EXIT.            I.030716
006210     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-015.                 I.030716
006220*****IF  W-JS  NOT = 0  AND  1  AND  2  AND  9                    D.070411
006230     IF  W-JS  NOT = 0  AND  1  AND  9                            I.070411
006240         GO  TO  SLCT-015.                                        I.030716
006250*****IF  IPN-KYO-KBN   =  1                                       D.011109
006260*****    IF  JS-SIGN       =  1                                   D.011109
006270*****        IF  JS-SIGN4      =  0                               D.011109
006280*****            DISPLAY       DSP-MID0                           D.011109
006290*****          ELSE                                               D.010109
006300*****            IF  JS-SIGN4      =  1                           D.011109
006310*****IF  JS-SIGN3      =  0                                       D.030716
006320*****    DISPLAY       DSP-MID1.                                  D.030716
006330 SLCT-020.
006340     ACCEPT   ACP-SEN.
006350     DISPLAY  DISP-MSG-SPACE.                                     I.981020
006360     IF  END-STS       =  "P9"  MOVE  9  TO  END-SW
006370                                GO  TO  SLCT-RTN-EXIT.
006380*****IF  END-STS       =  "09"  GO  TO  SLCT-015.                 D.091005
006390     IF  END-STS       =  "09"                                    I.091005
006400         IF (JS-W          =  0  OR  9)  OR                       I.091005
006410           ((JS-W          =  1)  AND  (JS-SIGN       =  0))      I.091005
006420                                        GO  TO  SLCT-015          I.091015
006430         ELSE  IF (JS-W          =  1)  GO  TO  SLCT-012.         I.091005
006440*****    IF  JS-SIGN   NOT =  0  AND 9  GO  TO  SLCT-012          D.091015
006450*****    ELSE                           GO  TO  SLCT-015.         D.091015
006460     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-020.
006470     IF  SEN-W NOT = 1  AND  2                                    I.981020
006480         GO  TO  SLCT-020.                                        I.981020
006490     DISPLAY  DSP-CLER2.                                          I.981020
006500     IF  SEN-W = 2                                                I.981020
006510         DISPLAY  DSP-DNOM                                        I.981020
006520         GO  TO  SLCT-030.                                        I.981020
006530     PERFORM  SEL-RTN  THRU  SEL-EX.                              I.981020
006540     IF  W-SNGP = ZERO                                            I.981020
006550         DISPLAY  ERR-02  DISP-BUZ-J                              I.981020
006560         GO  TO  SLCT-020.                                        I.981020
006570     DISPLAY  DSP-DATM  ACP-SNGP  ACP-ENGP.                       I.981020
006580*****IF  SEN-W   =  1  OR  2    GO  TO  SLCT-030                  D.981020
006590*****ELSE                       GO  TO  SLCT-020.                 D.981020
006600 SLCT-030.
006610     ACCEPT   ACP-TEST.
006620     IF  END-STS       =  "09"  GO  TO  SLCT-020.
006630     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-030.
006640     IF  TEST-W  =  1
006650         PERFORM  TEST-RTN  THRU  TEST-RTN-EXIT
006660         GO  TO  SLCT-030.
006670     IF  TEST-W  =  2           GO  TO  SLCT-040
006680     ELSE                       GO  TO  SLCT-030.
006690 SLCT-040.
006700     IF  SEN-W    =  1          GO  TO  SLCT-060.
006710     ACCEPT   ACP-DEN1.
006720     IF  END-STS       =  "09"  DISPLAY  DSP-CLER2
006730                                GO  TO  SLCT-030.
006740     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-040.
006750 SLCT-050.
006760     ACCEPT   ACP-DEN2.
006770     IF  END-STS       =  "09"  GO  TO  SLCT-040.
006780     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-050.
006790     IF  DEN-W1  >  DEN-W2      GO  TO  SLCT-040.
006800     GO  TO  SLCT-060.                                            I.981020
006810 SLCT-052.                                                        I.981020
006820     ACCEPT  ACP-SNEN.                                            I.981020
006830     IF  END-STS = "09"                                           I.981020
006840         GO  TO  SLCT-030.                                        I.981020
006850     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
006860         GO  TO  SLCT-052.                                        I.981020
006870     MOVE  20    TO  W-SNEN1.                                     I.090919
006880*****MOVE  ZERO  TO  W-SNEN1.                                     D.090919
006890*****IF  W-SNEN2 >= DATE-NF1 AND <= DATE-NT1                      D.090919
006900*****    ADD  DATE-NC1 TO W-SNEN.                                 D.090919
006910*****IF  W-SNEN2 >= DATE-NF2 AND <= DATE-NT2                      D.090919
006920*****    ADD  DATE-NC2 TO W-SNEN.                                 D.090919
006930*****IF  W-SNEN2 > 90                                             D.981027
006940*****    ADD  1900  TO  W-SNEN                                    D.981027
006950*****  ELSE                                                       D.981027
006960*****    ADD  2000  TO  W-SNEN.                                   D.981027
006970 SLCT-053.                                                        I.981020
006980     ACCEPT  ACP-SGET.                                            I.981020
006990     IF  END-STS = "09"                                           I.981020
007000         GO  TO  SLCT-052.                                        I.981020
007010     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
007020         GO  TO  SLCT-053.                                        I.981020
007030     IF  W-SGET < 1  OR  > 12                                     I.981020
007040         GO  TO  SLCT-053.                                        I.981020
007050 SLCT-054.                                                        I.981020
007060     ACCEPT  ACP-SPEY.                                            I.981020
007070     IF  END-STS = "09"                                           I.981020
007080         GO  TO  SLCT-053.                                        I.981020
007090     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
007100         GO  TO  SLCT-054.                                        I.981020
007110     IF  W-SPEY < 1  OR  > 31                                     I.981020
007120         GO  TO  SLCT-054.                                        I.981020
007130     IF  W-SNGP < W-SDATE  OR  > W-EDATE                          I.981020
007140         GO  TO  SLCT-052.                                        I.981020
007150 SLCT-056.                                                        I.981020
007160     ACCEPT  ACP-ENEN.                                            I.981020
007170     IF  END-STS = "09"                                           I.981020
007180         GO TO  SLCT-054.                                         I.981020
007190     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
007200         GO  TO  SLCT-056.                                        I.981020
007210     MOVE  20    TO  W-ENEN1.                                     I.090919
007220*****MOVE  ZERO  TO  W-ENEN1.                                     D.090919
007230*****IF  W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                      D.090919
007240*****    ADD  DATE-NC1 TO W-ENEN.                                 D.090919
007250*****IF  W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                      D.090919
007260*****    ADD  DATE-NC2 TO W-ENEN.                                 D.090919
007270*****IF  W-ENEN2 > 90                                             D.981027
007280*****    ADD  1900  TO  W-ENEN                                    D.981027
007290*****  ELSE                                                       D.981027
007300*****    ADD  2000  TO  W-ENEN.                                   D.981027
007310 SLCT-057.                                                        I.981020
007320     ACCEPT  ACP-EGET.                                            I.981020
007330     IF  END-STS = "09"                                           I.981020
007340         GO  TO  SLCT-056.                                        I.981020
007350     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
007360         GO  TO  SLCT-057.                                        I.981020
007370     IF  W-EGET < 1  OR  > 12                                     I.981020
007380         GO  TO  SLCT-057.                                        I.981020
007390 SLCT-058.                                                        I.981020
007400     ACCEPT  ACP-EPEY.                                            I.981020
007410     IF  END-STS = "09"                                           I.981020
007420         GO  TO  SLCT-057.                                        I.981020
007430     IF  END-STS NOT = "00"  AND  "01"  AND  "06"                 I.981020
007440         GO  TO  SLCT-058.                                        I.981020
007450     IF  W-EPEY < 1  OR  > 31                                     I.981020
007460         GO  TO  SLCT-058.                                        I.981020
007470     IF  W-SNGP > W-ENGP                                          I.981020
007480         GO  TO  SLCT-056.                                        I.981020
007490     IF  W-ENGP < W-SDATE  OR  > W-EDATE                          I.981020
007500         GO  TO  SLCT-056.                                        I.981020
007510 SLCT-060.
007520     ACCEPT  ACP-KAKU.
007530     IF  END-STS       =  "09"
007540*****    IF  SEN-W  =  1        DISPLAY  DSP-CLER2                D.981020
007550*****                           GO  TO  SLCT-030                  D.981020
007560         IF  SEN-W = 1                                            I.981020
007570             GO  TO  SLCT-052                                     I.981020
007580           ELSE
007590             GO  TO  SLCT-040.
007600     IF  END-STS  NOT  =  "01"  GO  TO  SLCT-060.
007610     IF  KAKU-W  =  1           GO  TO  SLCT-RTN-EXIT.
007620     IF  KAKU-W  =  9           GO  TO  SLCT-010
007630     ELSE                       GO  TO  SLCT-060.
007640 SLCT-RTN-EXIT.
007650     EXIT.
007660
007670******************************************************************
007680*    ‚q‚d‚`‚cˆ—i‚Pj  i‚q‚d‚`‚c‚P|‚q‚s‚mj                  *
007690******************************************************************
007700 READ1-RTN.
007710     IF  SEN-W   =  1  GO  TO  READ1-010
007720     ELSE              GO  TO  READ1-030.
007730 READ1-010.
007740*    (¼­¯¶¥»¼½Þ¥Ä×Ý É Ø°ÄÞ (Ê¯º³))
007750     IF  RED-SW  =  1  GO  TO  READ1-020.
007760     READ  JSTR  NEXT  AT  END
007770                 MOVE  24  TO  ERR-LIN
007780                 DISPLAY  DISP-MSG-SPACE
007790                 DISPLAY  DSP-MI
007800                 DISPLAY  DISP-BUZ-B
007810                 PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
007820                 STOP  RUN.
007830     IF  W-JS      NOT =  9                                       I.030716
007840         IF  JSTR-16   NOT =  W-JS        GO  TO  READ1-020.      I.030716
007850*****IF  JSTR-16   NOT =  IPN-KYO-KBN     GO  TO  READ1-020.      D.030716
007860     IF  JSTR-05       =  ZERO            GO  TO  READ1-020.      I.940805
007870     IF  JSTR-17   NOT =  9               GO  TO  READ1-020.      I.930618
007880*****IF  JSTR-07       =  2  OR  3  OR  5  OR 6                   D.990805
007890*****                                     GO  TO  READ1-020.      D.990805
007900*****IF  JS-SIGN  =  1                                            D.060201
007910*****    IF  JS-SIGN3      =  0                                   D.060201
007920     IF  JS-SIGN  =  0                                            I.060201
007930*****    IF  JSTR-07  NOT =  1            GO  TO  READ1-020.      D.121122
007940         IF  JSTR-07  NOT =  1  AND  8    GO  TO  READ1-020.      I.121122
007950     IF  JS-SIGN  =  1                                            I.060201
007960         IF  JSTR-07  NOT =  6            GO  TO  READ1-020.      I.060201
007970*****    IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-020.      D.940728
007980     IF  JS-SIGN  =  2
007990         IF  JSTR-07  NOT =  7            GO  TO  READ1-020.      I.940728
008000     IF  JS-SIGN  =  3                                            I.060107
008010         IF  JSTR-07  NOT =  4            GO  TO  READ1-020.      I.060107
008020*****    IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-020.      D.940728
008030*****IF  JS-SIGN3      =  1                                       D.091015
008040     IF  JS-SIGN       =  9                                       I.091015
008050         IF  JSTR-03     NOT =  5  AND 6                          I.010309
008060                                          GO  TO  READ1-020.      I.010309
008070*****IF  JS-SIGN3      =  0                                       D.091015
008080     IF  JS-SIGN   NOT =  9                                       I.091015
008090         IF  JSTR-03     NOT =  0                                 I.010309
008100                                          GO  TO  READ1-020.      I.010309
008110*****IF  JS-SIGN3      =  0                                       D.091015
008120*****IF  JS-SIGN   NOT =  9                                       D.091127
008130*****IF  JS-SIGN       =  2                                       D.091225
008140     IF  JS-SIGN       =  1                                       I.091225
008150         IF  JSTR-061        =  9850   OR  5000                   I.090919
008160                                          GO  TO  READ1-020.      I.090919
008170*****IF  JS-SIGN3      =  0                                       D.011109
008180*****    IF  JS-SIGN4      =  1                                   D.011109
008190*****        IF  JSTR-061    NOT  =  0459 AND  0460 AND  3966     D.011109
008200*****                                     GO  TO  READ1-020.      D.011109
008210*****IF  JS-SIGN3      =  0                                       D.011109
008220*****    IF  JS-SIGN4      =  0                                   D.011109
008230*****        IF  JSTR-061         =  0459  OR  0460  OR  3966     D.011109
008240*****                                     GO  TO  READ1-020.      D.011109
008250*****IF  JSTR-03   NOT  =  0              GO  TO  READ1-020.      D.010309
008260     IF  JSTR-158  NOT  =  0              GO  TO  READ1-020.
008270     IF  JSTR-04 < W-SNGP  OR  > W-ENGP                           I.981020
008280         GO  TO  READ1-020.                                       I.981020
008290     MOVE  1  TO  RED-SW.
008300     GO  TO  READ1-RTN-EXIT.
008310 READ1-020.
008320     READ  JSTR  NEXT  AT  END
008330                 MOVE  9  TO  END-SW
008340                 GO  TO  READ1-RTN-EXIT.
008350     IF  W-JS      NOT =  9                                       I.030716
008360         IF  JSTR-16   NOT =  W-JS        GO  TO  READ1-020.      I.030716
008370*****IF  JSTR-16   NOT =  IPN-KYO-KBN     GO  TO  READ1-020.      D.030716
008380     IF  JSTR-05       =  ZERO            GO  TO  READ1-020.      I.940805
008390     IF  JSTR-17   NOT =  9               GO  TO  READ1-020.      I.930618
008400*****IF  JSTR-07       =  2  OR  3  OR  5  OR 6                   D.990805
008410*****                                     GO  TO  READ1-020.      D.990805
008420*****IF  JSTR-07   NOT  =  2  AND  3  GO  TO  READ1-020.          D 911001
008430*****IF  JS-SIGN  =  1                                            D.060201
008440*****    IF  JS-SIGN3      =  0                                   D.060201
008450     IF  JS-SIGN  =  0                                            I.060201
008460         IF  JSTR-07  NOT =  1  AND  8    GO  TO  READ1-020.      I.121122
008470*****    IF  JSTR-07  NOT =  1            GO  TO  READ1-020.      D.121122
008480     IF  JS-SIGN  =  1                                            I.060201
008490         IF  JSTR-07  NOT =  6            GO  TO  READ1-020.      I.060201
008500*****    IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-020.      D.940728
008510     IF  JS-SIGN  =  2
008520         IF  JSTR-07  NOT =  7            GO  TO  READ1-020.      I.940728
008530     IF  JS-SIGN  =  3                                            I.060107
008540         IF  JSTR-07  NOT =  4            GO  TO  READ1-020.      I.060107
008550*****    IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-020.      D.940728
008560*****IF  JS-SIGN3      =  1                                       D.091015
008570     IF  JS-SIGN       =  9                                       I.091015
008580         IF  JSTR-03     NOT =  5  AND 6                          I.010309
008590                                          GO  TO  READ1-020.      I.010309
008600*****IF  JS-SIGN3      =  0                                       D.091015
008610     IF  JS-SIGN   NOT =  9                                       I.091015
008620         IF  JSTR-03     NOT =  0                                 I.010309
008630                                          GO  TO  READ1-020.      I.010309
008640*****IF  JS-SIGN3      =  0                                       D.091015
008650*****IF  JS-SIGN   NOT =  9                                       D.091127
008660*****IF  JS-SIGN       =  2                                       D.091225
008670     IF  JS-SIGN       =  1                                       I.091225
008680         IF  JSTR-061        =  9850   OR  5000                   I.090919
008690                                          GO  TO  READ1-020.      I.090919
008700*****IF  JS-SIGN3      =  0                                       D.011109
008710*****    IF  JS-SIGN4      =  1                                   D.011109
008720*****        IF  JSTR-061    NOT  =  0459 AND  0460 AND  3966     D.011109
008730*****                                     GO  TO  READ1-020.      D.011109
008740*****IF  JS-SIGN3      =  0                                       D.011109
008750*****    IF  JS-SIGN4      =  0                                   D.011109
008760*****        IF  JSTR-061         =  0459  OR  0460  OR  3966     D.011109
008770*****                                     GO  TO  READ1-020.      D.011109
008780*****IF  JSTR-03   NOT  =  0  GO  TO  READ1-020.                  D.010309
008790     IF  JSTR-158  NOT  =  0  GO  TO  READ1-020.
008800     IF  JSTR-04 < W-SNGP  OR  > W-ENGP                           I.981020
008810         GO  TO  READ1-020.                                       I.981020
008820     MOVE  1  TO  RED-SW.
008830     GO  TO  READ1-RTN-EXIT.
008840 READ1-030.
008850*    (¼­¯¶¥»¼½Þ¥Ä×Ý É Ø°ÄÞ (»²Ê¯º³))
008860     IF  RED-SW  =  1  GO  TO  READ1-040.
008870     MOVE  DEN-W1  TO  JSTR-01.
008880     MOVE  0       TO  JSTR-02.
008890     START  JSTR  KEY  IS  NOT  <  JSTR-KEY  INVALID  KEY
008900                  MOVE  24  TO  ERR-LIN
008910                  DISPLAY  DISP-MSG-SPACE
008920                  DISPLAY  DSP-MI
008930                  DISPLAY  DISP-BUZ-B
008940                  PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
008950                  STOP  RUN.
008960 READ1-040.
008970     READ  JSTR  NEXT  AT  END
008980                 MOVE  9  TO  END-SW
008990                 GO  TO  READ1-RTN-EXIT.
009000     IF  DEN-W2  <  JSTR-01  MOVE  9  TO  END-SW
009010                             GO  TO  READ1-RTN-EXIT.
009020     IF  W-JS      NOT =  9                                       I.030716
009030         IF  JSTR-16   NOT =  W-JS        GO  TO  READ1-040.      I.030716
009040*****IF  JSTR-16   NOT =  IPN-KYO-KBN     GO  TO  READ1-040.      D.030716
009050*****IF  JSTR-05       =  ZERO            GO  TO  READ1-040.      D.961028
009060*****IF  JSTR-17   NOT =  9               GO  TO  READ1-040.      D.961028
009070     IF  JSTR-17   NOT =  9 AND 8         GO  TO  READ1-040.      I.961028
009080*****IF  JSTR-07       =  2  OR  3  OR  5  OR 6                   D.990805
009090*****                                     GO  TO  READ1-040.      D.990805
009100*****IF  JSTR-07   NOT  =  2  AND  3  GO  TO  READ1-040.          D 911001
009110*****IF  JS-SIGN  =  1                                            D.060201
009120*****    IF  JS-SIGN3      =  0                                   D.060201
009130     IF  JS-SIGN  =  0                                            I.060201
009140         IF  JSTR-07  NOT =  1  AND  8    GO  TO  READ1-040.      I.121122
009150*****    IF  JSTR-07  NOT =  1            GO  TO  READ1-040.      D.121122
009160     IF  JS-SIGN  =  1                                            I.060201
009170         IF  JSTR-07  NOT =  6            GO  TO  READ1-040.      I.060201
009180*****    IF  JSTR-07  NOT =  2  AND  3    GO  TO  READ1-040.      D.940728
009190     IF  JS-SIGN  =  2
009200         IF  JSTR-07  NOT =  7            GO  TO  READ1-040.      I.940728
009210     IF  JS-SIGN  =  3                                            I.060107
009220         IF  JSTR-07  NOT =  4            GO  TO  READ1-040.      I.060107
009230*****    IF  JSTR-07  NOT =  5  AND  6    GO  TO  READ1-040.      D.940728
009240*****IF  JS-SIGN3      =  1                                       D.091015
009250     IF  JS-SIGN       =  9                                       I.091015
009260         IF  JSTR-03     NOT =  5  AND 6                          I.010309
009270                                          GO  TO  READ1-040.      I.010309
009280*****IF  JS-SIGN3      =  0                                       D.091015
009290     IF  JS-SIGN   NOT =  9                                       I.091015
009300         IF  JSTR-03     NOT =  0                                 I.010309
009310                                          GO  TO  READ1-040.      I.010309
009320*****IF  JS-SIGN3      =  0                                       D.091015
009330*****IF  JS-SIGN   NOT =  9                                       D.091127
009340*****IF  JS-SIGN       =  2                                       D.091225
009350*****IF  JS-SIGN       =  1                                       D.100315
009360*****    IF  JSTR-061        =  9850   OR  5000                   D.100315
009370*****                                     GO  TO  READ1-040.      D.100315
009380*****IF  JS-SIGN3      =  0                                       D.011109
009390*****    IF  JS-SIGN4      =  1                                   D.011109
009400*****        IF  JSTR-061    NOT  =  0459 AND  0460 AND  3966     D.011109
009410*****                                     GO  TO  READ1-040.      D.011109
009420*****IF  JS-SIGN3      =  0                                       D.011109
009430*****    IF  JS-SIGN4      =  0                                   D.011109
009440*****        IF  JSTR-061         =  0459  OR  0460  OR  3966     D.011109
009450*****                                     GO  TO  READ1-040.      D.011109
009460*****IF  JSTR-03   NOT  =  0  GO  TO  READ1-040.                  D.010309
009470*****IF  JSTR-158  NOT  =  1  GO  TO  READ1-040.                  D.040324
009480     IF  JSTR-158       =  0  GO  TO  READ1-040.                  I.040324
009490     MOVE  1  TO  RED-SW.
009500 READ1-RTN-EXIT.
009510     EXIT.
009520
009530******************************************************************
009540*    ‚q‚d‚`‚cˆ—i‚Qj  i‚q‚d‚`‚c‚Q|‚q‚s‚mj                  *
009550******************************************************************
009560 READ2-RTN.
009570*****MOVE  0         TO  TCM-SW.                                  D.971002
009580 READ2-010.
009590     MOVE  JSTR-061  TO  T-KEY.                                   I.010221
009600     READ  T-M  UNLOCK  INVALID  KEY                              I.010221
009610                         MOVE  0         TO  T-TNC1  T-DCC.       I.010221
009620*    (Á®¸¿³»·¥Ï½À É Ø°ÄÞ)
009630     MOVE  JSTR-061  TO  TC-TCD.
009640     MOVE  1         TO  TC-CCD.
009650     READ  TC-M  UNLOCK  INVALID  KEY
009660                         MOVE  JSTR-061  TO  WORK-41
009670                         MOVE  SPACE     TO  WORK-42
009680*****                    MOVE  ZERO      TO  TC-DNO               D.010221
009690                         GO  TO  READ2-020.
009700*****IF  ( TC-STK  NOT  =  0 )  AND  ( JSTR-062  =  1 )           D.971002
009710*****    MOVE  1     TO  TCM-SW                                   D.971002
009720*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
009730     MOVE  JSTR-061  TO  WORK-41.
009740     MOVE  TC-NAME   TO  WORK-42.
009750 READ2-020.
009760     IF  JSTR-062  =  1
009770         MOVE  SPACE  TO  WORK-43
009780         MOVE  SPACE  TO  WORK-44
009790         GO  TO  READ2-030
009800     ELSE
009810         MOVE  JSTR-061  TO  TC-TCD
009820         MOVE  JSTR-062  TO  TC-CCD
009830         READ  TC-M  UNLOCK  INVALID  KEY
009840                             MOVE  JSTR-062  TO  WORK-43
009850                             MOVE  SPACE     TO  WORK-44
009860                             GO  TO  READ2-025.                   I.120124
009870*****                    MOVE  ZERO      TO  TC-DNO               D.010221
009880*****                        GO  TO  READ2-030.                   D.120124
009890*****IF  TC-STK  NOT  =  0                                        D.971002
009900*****    MOVE  1     TO  TCM-SW                                   D.971002
009910*****    GO  TO  READ2-RTN-EXIT.                                  D.971002
009920     MOVE  JSTR-062  TO  WORK-43.
009930     MOVE  TC-NAME   TO  WORK-44.
009940 READ2-025.                                                       I.120124
009950     IF  JSTR-061     =  2410                                     I.120124
009960         MOVE  SPACE     TO  WORK-42                              I.120124
009970         MOVE  NC"“ú–{‹³ˆçƒVƒ…[ƒY@•Ÿ‰ªŒ§Ž–‹Æ–{•”" TO   WORK-42. I.120124
009980 READ2-030.
009990*    (¼­¯¶ËÝÒ²¥Ï½À É Ø°ÄÞ)
010000*****MOVE  JSTR-09  TO  SHM-01.                                   D.010808
010010*****READ  SHM  UNLOCK  INVALID  KEY                              D.010808
010020     MOVE  JSTR-09  TO  HI-MHCD HI-HCD.                           I.010808
010030     READ  HI2-M    UNLOCK  INVALID  KEY                          I.010808
010040                        MOVE  SPACE  TO  WORK-62
010050                        GO  TO  READ2-040.
010060*****IF  JSTR-061       =  0459  OR  0460                         D.010709
010070     IF  JSTR-061       =  0013  OR  0459  OR  0460               I.010709
010080*****    MOVE  SHM-02  TO  W-NAME                                 D.010808
010090         MOVE  HI-NAME TO  W-NAME                                 I.010808
010100         MOVE  SPACE   TO  W-NA(24)                               I.000808
010110         MOVE  W-NAME  TO  WORK-62                                I.000808
010120       ELSE                                                       I.000808
010130         MOVE  HI-NAME TO  WORK-62.                               I.010808
010140*****    MOVE  SHM-02  TO  WORK-62.                               D.010808
010150 READ2-040.
010160     MOVE  SPACE    TO  WORK-67.                                  I.100202
010170     IF  JSTR-09     <  999900                                    I.100202
010180         PERFORM  TAN-RTN  THRU  TAN-EX.                          I.100202
010190*    (ºÝÄÛ°Ù¥Ì§²Ù É Ø°ÄÞ)
010200     MOVE  2        TO  JCON2-01.
010210     MOVE  JSTR-14  TO  JCON2-02.
010220     READ  JCON  UNLOCK  INVALID  KEY
010230*****                    MOVE  SPACE  TO  WORK-711  WORK-712      D.940728
010240                         MOVE  SPACE  TO  WORK-71                 I.940728
010250                         GO  TO  READ2-RTN-EXIT.
010260     MOVE  JCON2-03  TO  WORK-71.                                 I.940728
010270*****MOVE  JCON2-03  TO  WORK-711.                                D.940728
010280*****MOVE  SPACE     TO  WORK-712.                                D.940728
010290 READ2-RTN-EXIT.
010300     EXIT.
010310
010320******************************************************************
010330*    –¾×o—Íˆ—  i‚c‚d‚s‚k|‚q‚s‚mj                          *
010340******************************************************************
010350 DETL-RTN.
010360*****IF  TCM-SW  =  1                                             D.971002
010370*****    GO  TO  DETL-010.                                        D.971002
010380     IF  DEN-W  NOT  =  JSTR-01
010390         PERFORM  HEAD-RTN  THRU  HEAD-RTN-EXIT.
010400     PERFORM  WRITE-RTN  THRU  WRITE-RTN-EXIT.
010410 DETL-010.                                                        A 911002
010420     IF  SEN-W  =  1
010430         MOVE  1  TO  JSTR-158
010440         REWRITE  JSTR-R  INVALID  KEY
010450                          MOVE  JSTR-KEY  TO  ERR-K
010460                          MOVE  "JSTR"    TO  ERR-F
010470                          MOVE  "R"       TO  ERR-M
010480                          MOVE   0        TO  ERR-LIN
010490                          PERFORM  ERR-RTN   THRU  ERR-EX
010500                          PERFORM  CLSE-RTN  THRU  CLSE-RTN-EXIT
010510                          STOP  RUN.
010520     MOVE  JSTR-01           TO  DEN-W.
010530*****ADD   WORK-92  WORK-82  TO  GOKEI.                           D 890920
010540     IF    JSTR-09  <  999900                                     *I920303
010550           ADD   WORK-92     TO  GOKEI                            A 890920
010560           ADD   WORK-82     TO  SETSU.                           A 911002
010570 DETL-RTN-EXIT.
010580     EXIT.
010590
010600******************************************************************
010610*    ‡Œvo—Íˆ—  i‚s‚n‚s‚k|‚q‚s‚mj                          *
010620******************************************************************
010630 TOTL-RTN.
010640*****IF  TCM-SW  NOT  =  0                                        D.971002
010650*****    GO  TO  TOTL-RTN-EXIT.                                   D.971002
010660     IF  END-SW  =  9
010670*****    PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
010680         COMPUTE  J  =  16  -  (I  *  2)                          *R 92/07
010690         MOVE   GOKEI           TO  WORK-73
010700         MOVE   ""3FE04F40A0""  TO  ST-CD4
010710         MOVE   ""3FE04FE080""  TO  ED-CD4
010720         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
010730         GO  TO  TOTL-RTN-EXIT.
010740     IF  JSTR-01  NOT  =  DEN-W
010750*****    PERFORM  TOTL1-RTN     THRU  TOTL1-EX                    *D 92/07
010760         COMPUTE  J  =  16  -  (I  *  2)                          *R 92/07
010770         MOVE   GOKEI           TO  WORK-73
010780         MOVE   ""3FE04F40A0""  TO  ST-CD4
010790         MOVE   ""3FE04FE080""  TO  ED-CD4
010800         WRITE  PRN-R  FROM  WORK-7  AFTER  J                     *R 92/07
010810         MOVE  0  TO  GOKEI.
010820 TOTL-RTN-EXIT.
010830     EXIT.
010840
010850******************************************************************
010860*    ƒZƒbƒg”o—Íˆ—  i‚s‚n‚s‚k‚P|‚q‚s‚mj                    *
010870******************************************************************
010880 TOTL1-RTN.                                                       A 911002
010890     COMPUTE  J  =  16  -  (I  *  2)  -  1.                       A 911002
010900     IF  SETSU  NOT  =  0                                         A 911002
010910         MOVE  SETSU    TO  WORK-61A                              A 911002
010920         MOVE  "¾¯Ä"    TO  WORK-62A                              A 911002
010930         WRITE  PRN-R   FROM  WORK-6A  AFTER J                    A 911002
010940     ELSE                                                         A 911002
010950         MOVE  SPACE    TO  PRN-R                                 A 911002
010960         WRITE  PRN-R   AFTER J.                                  A 911002
010970     MOVE  0    TO  SETSU.                                        A 911002
010980 TOTL1-EX.                                                        A 911002
010990******************************************************************
011000*    Œ©o‚µo—Íˆ—  i‚g‚d‚`‚c|‚q‚s‚mj                        *
011010******************************************************************
011020 HEAD-RTN.
011030     IF  PAGE-C  NOT  =  1
011040         MOVE  SPACE  TO  PRN-R
011050         WRITE  PRN-R  AFTER  PAGE.
011060*****MOVE  ""3FE04F40A0""  TO  ST-CD1.                            D.950202
011070*****MOVE  ""3FE04FE080""  TO  ED-CD1.                            D.950202
011080*****MOVE  ""3FE04F40A0""  TO  ST-CD0  ST-CD1.                    D.060207
011090*****MOVE  ""3FE04FE080""  TO  ED-CD0  ED-CD1.                    D.060207
011100     MOVE  ""3FE04F40A0""  TO  ST-CD0  ST-CD1  WORK-K1G.          I.060207
011110     MOVE  ""3FE04FE080""  TO  ED-CD0  ED-CD1  WORK-K2G.          I.060207
011120     IF  SEN-W    =   1            MOVE  SPACE     TO  WORK-10    I.950202
011130                            ELSE   MOVE  NC"Ä@"  TO  WORK-10.   I.950202
011140     MOVE  JSTR-01         TO  WORK-11.
011150     MOVE  "TEL" TO WORK-TM WORK-TMG.                             I.060207
011160     MOVE  "FAX" TO WORK-FM.                                      I.060207
011170     IF  JS-SIGN       =  9        GO  TO  HEAD-020.              I.091015
011180*****IF  JS-SIGN3  NOT =  0        GO  TO  HEAD-020.              D.091015
011190*****IF  JS-SIGN3      =  0                                       D.060207
011200*****    MOVE  "TEL" TO WORK-TM                                   D.060207
011210*****    MOVE  "FAX" TO WORK-FM                                   D.060207
011220*****    IF  JS-SIGN4       =  1                                  D.011109
011230     IF  JSTR-061       =  0459  OR  0460                         I.091215
011240         IF  JSTR-062       =  001                                I.091215
011250             GO  TO  HEAD-010.                                    I.091215
011260     IF  JSTR-061       =  0459                                   I.010306
011270         MOVE  NC"Š”Ž®‰ïŽÐãŽR›‰‹Æ" TO  WORK-NA                   I.010306
011280         MOVE  "663-8033" TO  WORK-UNO                            I.010306
011290         MOVE NC"•ºŒÉŒ§¼‹{Žs‚–Ø“Œ’¬‚P‚T|‚P" TO WORK-JS         I.010306
011300*****        MOVE  "TEL" TO WORK-TM                               D.011109
011310         MOVE  "0798-64-5111  " TO  WORK-TEL                      I.010306
011320         MOVE  "0798-64-3718  " TO  WORK-FAX                      I.011109
011330         GO  TO  HEAD-070                                         I.060207
011340       ELSE                                                       I.011109
011350*****        MOVE  "FAX" TO WORK-FM                               D.011109
011360*****        MOVE  "0798-64-3718  " TO  WORK-FAX.                 D.011109
011370*****IF  JS-SIGN3      =  0                                       D.011109
011380*****    IF  JS-SIGN4       =  1                                  D.011109
011390         IF  JSTR-061       =  0460                               I.010306
011400             MOVE  NC"Š”Ž®‰ïŽÐƒEƒGƒ„ƒ}" TO  WORK-NA               I.010306
011410             MOVE  "663-8033" TO  WORK-UNO                        I.010306
011420             MOVE NC"•ºŒÉŒ§¼‹{Žs‚–Ø“Œ’¬‚P‚T|‚P" TO WORK-JS     I.010306
011430*****            MOVE  "TEL" TO WORK-TM                           D.011109
011440             MOVE  "0798-67-0810  " TO  WORK-TEL                  I.010306
011450             MOVE  "0798-67-0139  " TO  WORK-FAX                  I.011109
011460             GO  TO  HEAD-070.                                    I.090919
011470     IF  JSTR-061       =  3015                                   I.110805
011480         MOVE  NC"Š”Ž®‰ïŽÐƒXƒMƒ„ƒ}" TO  WORK-NA                   I.110805
011490         MOVE  "114-0034" TO  WORK-UNO                            I.110805
011500         MOVE NC"“Œ‹ž“s–k‹æã\ð‚S|‚P|‚T@" TO WORK-JS         I.110805
011510         MOVE  "03-3909-8883  " TO  WORK-TEL                      I.110805
011520         MOVE  "03-3909-8831  " TO  WORK-FAX                      I.110805
011530         GO  TO  HEAD-070.                                        I.090919
011540*****        GO  TO  HEAD-070                                     D.090919
011550*****      ELSE                                                   D.090919
011560*****            MOVE  "FAX" TO WORK-FM                           D.011109
011570*****            MOVE  "0798-67-0139  " TO  WORK-FAX.             D.011109
011580*****IF  JS-SIGN3      =  0                                       D.011109
011590*****    IF  JS-SIGN4       =  1                                  D.011109
011600*****        IF  JSTR-061       =  3966                           D.090919
011610*****            MOVE  NC"‘½”ä—ÇŠ”Ž®‰ïŽÐ@" TO  WORK-NA           D.090919
011620*****            MOVE  "165-0021" TO  WORK-UNO                    D.090919
011630*****            MOVE NC"“Œ‹ž“s’†–ì‹æŠÛŽR‚Q|‚T|‚P‚X" TO         D.090919
011640*****                                                    WORK-JS  D.090919
011650*****                MOVE  "TEL" TO WORK-TM                       D.011109
011660*****            MOVE  "03-5373-6711  " TO  WORK-TEL              D.090919
011670*****            MOVE  "03-5373-0263  " TO  WORK-FAX              D.090919
011680*****            GO  TO  HEAD-070.                                D.090919
011690*****          ELSE                                               D.060207
011700*****                MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ" TO WORK-NA        D.060207
011710*****                MOVE  "700-0034" TO  WORK-UNO                D.051202
011720*****                MOVE NC"‰ªŽRŽs‚–ö“Œ’¬‚P‚R|‚S‚U@@" TO     D.051202
011730*****                MOVE  "700-0975" TO  WORK-UNO                D.060207
011740*****                MOVE NC"‰ªŽRŽs¡‚W’š–Ú‚P‚U|‚P‚V@@" TO     D.060207
011750*****                                                    WORK-JS  D.060207
011760*****                MOVE  "086-243-2456  " TO  WORK-TEL          D.060207
011770     IF  JSTR-061       =  4038  OR  2654  OR  2656  OR  2657     I.090519
011780         GO  TO  HEAD-030.                                        I.090519
011790 HEAD-010.                                                        I.091215
011800*****IF  JSTR-07   NOT =  1        GO  TO  HEAD-030.              D.121122
011810     IF  JSTR-07   NOT =  1 AND 8  GO  TO  HEAD-030.              I.121122
011820 HEAD-020.                                                        I.060207
011830     MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ" TO WORK-NA.                       I.060207
011840     MOVE  "700-0975" TO  WORK-UNO.                               I.060207
011850*****MOVE NC"‰ªŽRŽs¡‚W’š–Ú‚P‚U|‚P‚V@@" TO  WORK-JS.           D.090519
011860     MOVE NC"‰ªŽRŽs–k‹æ¡‚W’š–Ú‚P‚U|‚P‚V" TO  WORK-JS.           I.090519
011870     MOVE  "086-243-2456  " TO  WORK-TEL.                         I.060207
011880     MOVE  "086-242-0550  " TO  WORK-FAX.                         I.051202
011890     GO  TO  HEAD-070.                                            I.060207
011900 HEAD-030.                                                        I.060207
011910*****IF  JSTR-061       =  4038                                   D.091112
011920     IF  JSTR-061       =  4038  OR  4054  OR  4056  OR  4057     I.091112
011930         MOVE  NC"ç‹ÈŽY‹ÆŠ”Ž®‰ïŽÐ@@@@@@@@@@"  TO       I.090519
011940                                                      WORK-NAG    I.090519
011950         MOVE  "542-0081"      TO  WORK-UNOG                      I.090519
011960         MOVE  NC"‘åãŽs’†‰›‹æ“ì‘Dê‚P’š–Ú‚P‚P|‚X@@@@"  TO   I.090519
011970                                                      WORK-JSG    I.090519
011980         MOVE  NC"@@@@@@@@@@@@@@@@" TO  WORK-JSSG I.090519
011990         MOVE  "06-6268-4561"                     TO  WORK-TELG   I.090519
012000         GO  TO  HEAD-070.                                        I.060207
012010     IF  JSTR-061       =  2654  OR  2656  OR  2657               I.090519
012020         MOVE  NC"Š”Ž®‰ïŽÐV“ú–{‹³ˆçƒVƒ…[ƒY@@@@@"  TO       I.090519
012030                                                      WORK-NAG    I.090519
012040         MOVE  "520-2132"      TO  WORK-UNOG                      I.090519
012050         MOVE  NC"Ž ‰êŒ§‘å’ÃŽs_—Ì‚P|‚X|‚R@@@@@@@"  TO   I.090519
012060                                                      WORK-JSG    I.090519
012070         MOVE  NC"@@@@@@@@@@@@@@@@" TO  WORK-JSSG I.090519
012080         MOVE  "077-543-1331"                     TO  WORK-TELG   I.090519
012090         GO  TO  HEAD-070.                                        I.060207
012100     IF  JSTR-07       =  6                                       I.060207
012110         MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ@‹Ê“‡•¨—¬ƒZƒ“ƒ^[@"  TO       I.060207
012120                                                      WORK-NAG    I.060207
012130         MOVE  "713-8103"      TO  WORK-UNOG                      I.060207
012140         MOVE  NC"‰ªŽRŒ§‘q•~Žs‹Ê“‡‰³“‡ŽšV–©‚W‚Q‚U‚Q|‚P@"  TO   I.060207
012150                                                      WORK-JSG    I.060207
012160*****    MOVE  NC"…“‡`‘Û•¨—¬ƒZƒ“ƒ^[“à"       TO  WORK-JSSG   D.060926
012170         MOVE  NC"@@@@…“‡`‘Û•¨—¬ƒZƒ“ƒ^[“à" TO  WORK-JSSG I.060926
012180         MOVE  "086-243-2456"                     TO  WORK-TELG   I.060207
012190     ELSE                                                         I.060207
012200       IF  JSTR-07       =  7                                     I.060207
012210         MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ@’ÃŽR•¨—¬ƒZƒ“ƒ^[@"  TO       I.060207
012220                                                      WORK-NAG    I.060207
012230         MOVE  "709-3717"      TO  WORK-UNOG                      I.060207
012240         MOVE  NC"‰ªŽRŒ§‹v•ÄŒS”üç’¬Œ´“c‚R‚Q‚Q‚V|‚P@@@"  TO   I.060207
012250                                                      WORK-JSG    I.060207
012260         MOVE  "086-243-2456"                     TO  WORK-TEL    I.060207
012270         MOVE  "086-242-0550"                     TO  WORK-FAX    I.060207
012280     ELSE                                                         I.060207
012290       IF  JSTR-07       =  4                                     I.060207
012300*****    MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ@‚‰®”z‘—ƒZƒ“ƒ^[@"  TO       D.060926
012310         MOVE  NC"“úiƒSƒ€@‘“‡”z‘—ƒZƒ“ƒ^[@@@@@"  TO       I.060926
012320                                                      WORK-NAG    I.060207
012330*****    MOVE  "703-8233"      TO  WORK-UNOG                      D.060926
012340*****    MOVE  NC"‰ªŽRŽs‚‰®‚R‚O‚W@—¼”õ‰^—A‡Š“à@@@@@"  TO   D.060926
012350         MOVE  "701-0304"      TO  WORK-UNOG                      I.060926
012360         MOVE  NC"‰ªŽRŒ§“sŒEŒS‘“‡’¬‘“‡‚S‚T‚O‚V|‚R‚V@@"  TO   I.060926
012370                                                      WORK-JSG    I.060207
012380*****    MOVE  NC"@@—¼”õ‰^—A’†Žl‘•¨—¬ƒZƒ“ƒ^[“à" TO  WORK-JSSG D.090919
012390         MOVE  NC"@@—¼”õ‚g‚c’†Žl‘•¨—¬ƒZƒ“ƒ^[“à" TO  WORK-JSSG I.090919
012400         MOVE  "086-243-2456"                     TO  WORK-TELG.  I.060926
012410*****    MOVE  "086-243-2456"                     TO  WORK-TEL    D.060926
012420*****    MOVE  "086-242-0550"                     TO  WORK-FAX.   D.060926
012430*****                MOVE  "086-252-2456  " TO  WORK-TEL          D.051202
012440*****                MOVE  "086-254-8595  " TO  WORK-FAX.         D.051202
012450*****                MOVE  "FAX" TO WORK-FM                       D.011109
012460*****                MOVE  "03-5373-0263  " TO  WORK-FAX.         D.011109
012470*****MOVE  NC""        TO  WORK-M1.                           D.900917
012480 HEAD-070.                                                        I.060207
012490     MOVE    "'"           TO  WORK-M2  WORK-M2G.                 I.060207
012500     MOVE  JSTR-0412       TO  WORK-211  WORK-211G.               I.060207
012510     MOVE  JSTR-042        TO  WORK-212  WORK-212G.               I.060207
012520     MOVE  JSTR-043        TO  WORK-213  WORK-213G.               I.060207
012530     IF  JSTR-03  =  0  MOVE  NC"o‰×"  TO  WORK-22  WORK-22G.    I.060207
012540     IF  JSTR-03  =  5  MOVE  NC"•Ô•i"  TO  WORK-22  WORK-22G.    I.060207
012550     IF  JSTR-03  =  6  MOVE  NC"•s—Ç"  TO  WORK-22  WORK-22G.    I.060207
012560     IF  JSTR-03  =  7  MOVE  NC"ƒTo"  TO  WORK-22  WORK-22G.    I.060207
012570*****MOVE    "'"           TO  WORK-M2.                           D.060207
012580*****MOVE  JSTR-041        TO  WORK-211.                          D.980519
012590*****MOVE  JSTR-0412       TO  WORK-211.                          D.060207
012600*****MOVE  JSTR-042        TO  WORK-212.                          D.060207
012610*****MOVE  JSTR-043        TO  WORK-213.                          D.060207
012620*****IF  JSTR-03  =  0  MOVE  NC"o‰×"  TO  WORK-22.              D.060207
012630*****IF  JSTR-03  =  5  MOVE  NC"•Ô•i"  TO  WORK-22.              D.060207
012640*****IF  JSTR-03  =  6  MOVE  NC"•s—Ç"  TO  WORK-22.              D.060207
012650*****IF  JSTR-03  =  7  MOVE  NC"ƒTo"  TO  WORK-22.              D.060207
012660*****IF  JSTR-03  =  1  MOVE  NC"•Ô•i"  TO  WORK-22.              D 911002
012670*****IF  JSTR-03  =  2  MOVE  NC"•s—Ç"  TO  WORK-22.              D 911002
012680*****MOVE  JSTR-07   TO  WORK-23.                                 D 890920
012690     MOVE  3         TO  JCON3-01.                                A 890920
012700     MOVE  JSTR-07   TO  JCON3-02.                                A 890920
012710     READ  JCON      UNLOCK  INVALID                              A 890920
012720                             MOVE ALL NX"2121"  TO  JCON3-03.     A 890920
012730     MOVE  JCON3-03  TO  WORK-23  WORK-23G.                       I.060207
012740     IF  JSTR-07       =  1                                       I.090519
012750         IF  JSTR-061      =  2654  OR  2656  OR  2657  OR  4038  I.090519
012760                                    OR  4054  OR  4056  OR  4057  I.091112
012770             MOVE  NC"•x@Žm@@@"  TO  WORK-23  WORK-23G.       I.090519
012780*****MOVE  JCON3-03  TO  WORK-23.                                 D.060207
012790*****IF  JS-SIGN3      =  0                                       D.091015
012800     IF  JS-SIGN   NOT =  9                                       I.091015
012810         MOVE  JSTR-14B  TO  WORK-31  WORK-31G.                   I.060207
012820*****    MOVE  JSTR-14B  TO  WORK-31.                             D.060207
012830 HEAD-090.                                                        I.060207
012840     MOVE  SPACE     TO  WORK-33A.                                I.000127
012850*****IF  TC-DNO  NOT =  000  AND  900                             D.010221
012860*****    MOVE  "("       TO  WORK-33F                             D.010221
012870*****    MOVE  TC-DNO    TO  WORK-33                              D.010221
012880     MOVE  "("       TO  WORK-33F.                                I.010221
012890     MOVE  T-TNC1    TO  WORK-331.                                I.010221
012900     MOVE  "-"       TO  WORK-332.                                I.010221
012910     MOVE  T-DCC     TO  WORK-333.                                I.010221
012920     MOVE  ")"       TO  WORK-33R.                                I.000125
012930     MOVE  W-DATE    TO  WORK-32.                                 I.981020
012940*****MOVE  WYMD      TO  WORK-32.                                 D.981020
012950     MOVE  1         TO  I.
012960     ADD   1         TO  PAGE-C.
012970     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
012980     IF  JSTR-061       =  4038  OR  2654  OR  2656  OR  2657     I.090519
012990                                    OR  4054  OR  4056  OR  4057  I.091112
013000         GO  TO  HEAD-100.                                        I.090519
013010*****IF  JS-SIGN4        =   1                                    D.011109
013020*****IF  JS-SIGN3        =   0                                    D.060207
013030*****IF (JS-SIGN3    NOT =   0)  OR  (JSTR-07       =  1)         D.091015
013040*****IF (JS-SIGN         =   9)  OR  (JSTR-07       =  1)         D.091215
013050*****IF (JS-SIGN         =   9)  OR  (JSTR-07       =  1)  OR     D.121122
013060     IF (JS-SIGN         =   9)  OR  (JSTR-07    =  1 OR 8 )  OR  I.121122
013070       ((JSTR-062  NOT  = 001)  AND (JSTR-061  =  0459 OR 0460))  I.091215
013080                                 OR  (JSTR-061      =  3015)      I.110805
013090         WRITE  PRN-R  FROM  WORK-1A AFTER  1                     I.010306
013100         WRITE  PRN-R  FROM  WORK-1B AFTER  1                     I.010306
013110         WRITE  PRN-R  FROM  WORK-1C AFTER  1                     I.010306
013120         WRITE  PRN-R  FROM  WORK-2  AFTER  1                     I.010306
013130         WRITE  PRN-R  FROM  WORK-3  AFTER  1                     I.060207
013140         GO  TO  HEAD-120.                                        I.060207
013150*****  ELSE                                                       D.060207
013160*****    WRITE  PRN-R  FROM  WORK-2  AFTER  4.                    D.060207
013170*****WRITE  PRN-R  FROM  WORK-3  AFTER  1.                        D.060207
013180 HEAD-100.                                                        I.090519
013190     WRITE  PRN-R  FROM  WORK-1AG AFTER  1.                       I.060207
013200     WRITE  PRN-R  FROM  WORK-1BG AFTER  1.                       I.060207
013210     WRITE  PRN-R  FROM  WORK-1CG AFTER  1.                       I.060207
013220*****IF  JSTR-07       =  6                                       D.060926
013230*****IF  JSTR-07       =  4 OR 6                                  D.090519
013240     IF (JSTR-07       =  4 OR 6)  OR                             I.090519
013250        (JSTR-061      =  4038  OR  2654  OR  2656  OR  2657      I.091112
013260                                    OR  4054  OR  4056  OR  4057) I.091112
013270*****   (JSTR-061      =  4038  OR  2654  OR  2656  OR  2657)     D.091112
013280         WRITE  PRN-R  FROM  WORK-2G AFTER  1                     I.010306
013290         WRITE  PRN-R  FROM  WORK-3G AFTER  1                     I.060207
013300     ELSE                                                         I.060207
013310         WRITE  PRN-R  FROM  WORK-2  AFTER  1                     I.010306
013320         WRITE  PRN-R  FROM  WORK-3  AFTER  1.                    I.060207
013330 HEAD-120.                                                        I.060207
013340     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
013350     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
013360*****IF  JS-SIGN3  NOT =  0                                       D.091015
013370     IF  JS-SIGN       =  9                                       I.091015
013380         MOVE  JSTR-15A  TO  WORK-70                              I.010309
013390     ELSE    IF  JSTR-14B  =  OLD-OKNO                            I.900618
013400                 MOVE  SPACE     TO  WORK-70R                     I.900618
013410             ELSE  MOVE  JSTR-15A  TO  WORK-70.                   I.900411
013420     MOVE  JSTR-15   TO  WORK-721.
013430     MOVE  JSTR-14D  TO  WORK-722.
013440*****IF  JS-SIGN3      =  0                                       D.091015
013450     IF  JS-SIGN   NOT =  9                                       I.091015
013460         MOVE  JSTR-14B  TO  OLD-OKNO.                            I.900618
013470 HEAD-RTN-EXIT.
013480     EXIT.
013490
013500******************************************************************
013510*    ‚v‚q‚h‚s‚dˆ—  i‚v‚q‚h‚s‚d|‚q‚s‚mj                      *
013520******************************************************************
013530 WRITE-RTN.
013540     INITIALIZE  WORK-5  WORK-8  WORK-9.
013550     MOVE  ""3FE04F40A0""  TO          ST-CD3.                    R 911002
013560     MOVE  ""3FE04FE080""  TO  ED-CD2  ED-CD3.
013570     MOVE  SPACE       TO  WORK-NGPD.                             I.150618
013580*****IF  JSTR-13  =  1                                            D 911002
013590*********MOVE  NC"—a‚èo‰×"  TO  WORK-51                          D 911002
013600*****ELSE                                                         D 911002
013610*********MOVE  SPACE         TO  WORK-51.                         D 911002
013620*****IF  JSTR-13  =  2                                            D.941024
013630*****IF  JSTR-13  =  5                                            D.960626
013640*****    MOVE  JSTR-081      TO  WORK-51A                         D.960626
013650*****ELSE                                                         D.960626
013660*****MOVE  SPACE         TO  WORK-51AR.                           D.981027
013670*****IF  JSTR-14A  NOT  >  1                                      D.981027
013680     IF (JSTR-14A  NOT  >  1)  AND  (JSTR-20    =  SPACE)         I.981027
013690       AND  ((JSTR-01   >  099999)  AND  (JSTR-08    =  ZERO))    I.150618
013700         IF  I  =  1
013710             WRITE  PRN-R  FROM  WORK-5  AFTER  5
013720             GO  TO  WRITE-010
013730         ELSE
013740*****        MOVE   SPACE  TO   PRN-R                             D 920629
013750*****        WRITE  PRN-R  AFTER  1                               D 920629
013760             WRITE  PRN-R  FROM  WORK-5  AFTER  1
013770             GO  TO  WRITE-010.
013780*****IF  JSTR-03   NOT  =  0                                      *D 92/07
013790*****    COMPUTE WORK-811(1)  = JSTR-1111(1)  *  -1  / JSTR-14A   *
013800*****    COMPUTE WORK-811(2)  = JSTR-1111(2)  *  -1  / JSTR-14A   *
013810*****    COMPUTE WORK-811(3)  = JSTR-1111(3)  *  -1  / JSTR-14A   *
013820*****    COMPUTE WORK-811(4)  = JSTR-1111(4)  *  -1  / JSTR-14A   *
013830*****    COMPUTE WORK-811(5)  = JSTR-1111(5)  *  -1  / JSTR-14A   *
013840*****    COMPUTE WORK-811(6)  = JSTR-1111(6)  *  -1  / JSTR-14A   *
013850*****    COMPUTE WORK-811(7)  = JSTR-1111(7)  *  -1  / JSTR-14A   *
013860*****    COMPUTE WORK-811(8)  = JSTR-1111(8)  *  -1  / JSTR-14A   *
013870*****    COMPUTE WORK-811(9)  = JSTR-1111(9)  *  -1  / JSTR-14A   *
013880*****    COMPUTE WORK-811(10) = JSTR-1111(10) *  -1  / JSTR-14A   *
013890*****    COMPUTE WORK-82      = JSTR-1111(1)  +  JSTR-1111(2)     *
013900*****                         + JSTR-1111(3)  +  JSTR-1111(4)     *
013910*****                         + JSTR-1111(5)  +  JSTR-1111(6)     *
013920*****                         + JSTR-1111(7)  +  JSTR-1111(8)     *
013930*****                         + JSTR-1111(9)  +  JSTR-1111(10)    *
013940*****    COMPUTE WORK-82      = WORK-82       *  -1  / JSTR-14A   *
013950*****ELSE                                                         *
013960*****COMPUTE WORK-811(1)  = JSTR-1111(1)  / JSTR-14A.             D.981027
013970*****COMPUTE WORK-811(2)  = JSTR-1111(2)  / JSTR-14A.             D.981027
013980*****COMPUTE WORK-811(3)  = JSTR-1111(3)  / JSTR-14A.             D.981027
013990*****COMPUTE WORK-811(4)  = JSTR-1111(4)  / JSTR-14A.             D.981027
014000*****COMPUTE WORK-811(5)  = JSTR-1111(5)  / JSTR-14A.             D.981027
014010*****COMPUTE WORK-811(6)  = JSTR-1111(6)  / JSTR-14A.             D.981027
014020*****COMPUTE WORK-811(7)  = JSTR-1111(7)  / JSTR-14A.             D.981027
014030*****COMPUTE WORK-811(8)  = JSTR-1111(8)  / JSTR-14A.             D.981027
014040*****COMPUTE WORK-811(9)  = JSTR-1111(9)  / JSTR-14A.             D.981027
014050*****COMPUTE WORK-811(10) = JSTR-1111(10) / JSTR-14A.             D.981027
014060*****COMPUTE WORK-82      = JSTR-1111(1)  + JSTR-1111(2)          D.981027
014070*****                     + JSTR-1111(3)  + JSTR-1111(4)          D.981027
014080*****                     + JSTR-1111(5)  + JSTR-1111(6)          D.981027
014090*****                     + JSTR-1111(7)  + JSTR-1111(8)          D.981027
014100*****                     + JSTR-1111(9)  + JSTR-1111(10).        D.981027
014110*****COMPUTE WORK-82      = WORK-82       / JSTR-14A.             D.981027
014120*****MOVE  WORK-811(1)   TO  WORK-521(1).                         D.981027
014130*****MOVE  WORK-811(2)   TO  WORK-521(2).                         D.981027
014140*****MOVE  WORK-811(3)   TO  WORK-521(3).                         D.981027
014150*****MOVE  WORK-811(4)   TO  WORK-521(4).                         D.981027
014160*****MOVE  WORK-811(5)   TO  WORK-521(5).                         D.981027
014170*****MOVE  WORK-811(6)   TO  WORK-521(6).                         D.981027
014180*****MOVE  WORK-811(7)   TO  WORK-521(7).                         D.981027
014190*****MOVE  WORK-811(8)   TO  WORK-521(8).                         D.981027
014200*****MOVE  WORK-811(9)   TO  WORK-521(9).                         D.981027
014210*****MOVE  WORK-811(10)  TO  WORK-521(10).                        D.981027
014220*****MOVE  WORK-82       TO  WORK-53.                             *D 92/07
014230*****MOVE  WORK-82       TO  WORK-53.                             D.981027
014240*****MOVE  "X"           TO  WORK-54.                             D.981027
014250*****MOVE  JSTR-14A      TO  WORK-55.                             D.981027
014260     IF  JSTR-14A       >  1                                      I.981027
014270         COMPUTE WORK-811(1)  = JSTR-1111(1)  / JSTR-14A          I.981027
014280         COMPUTE WORK-811(2)  = JSTR-1111(2)  / JSTR-14A          I.981027
014290         COMPUTE WORK-811(3)  = JSTR-1111(3)  / JSTR-14A          I.981027
014300         COMPUTE WORK-811(4)  = JSTR-1111(4)  / JSTR-14A          I.981027
014310         COMPUTE WORK-811(5)  = JSTR-1111(5)  / JSTR-14A          I.981027
014320         COMPUTE WORK-811(6)  = JSTR-1111(6)  / JSTR-14A          I.981027
014330         COMPUTE WORK-811(7)  = JSTR-1111(7)  / JSTR-14A          I.981027
014340         COMPUTE WORK-811(8)  = JSTR-1111(8)  / JSTR-14A          I.981027
014350         COMPUTE WORK-811(9)  = JSTR-1111(9)  / JSTR-14A          I.981027
014360         COMPUTE WORK-811(10) = JSTR-1111(10) / JSTR-14A          I.981027
014370         COMPUTE WORK-82      = JSTR-1111(1)  + JSTR-1111(2)      I.981027
014380                              + JSTR-1111(3)  + JSTR-1111(4)      I.981027
014390                              + JSTR-1111(5)  + JSTR-1111(6)      I.981027
014400                              + JSTR-1111(7)  + JSTR-1111(8)      I.981027
014410                              + JSTR-1111(9)  + JSTR-1111(10)     I.981027
014420         COMPUTE WORK-82      = WORK-82       / JSTR-14A          I.981027
014430         MOVE  WORK-811(1)   TO  WORK-521(1)                      I.981027
014440         MOVE  WORK-811(2)   TO  WORK-521(2)                      I.981027
014450         MOVE  WORK-811(3)   TO  WORK-521(3)                      I.981027
014460         MOVE  WORK-811(4)   TO  WORK-521(4)                      I.981027
014470         MOVE  WORK-811(5)   TO  WORK-521(5)                      I.981027
014480         MOVE  WORK-811(6)   TO  WORK-521(6)                      I.981027
014490         MOVE  WORK-811(7)   TO  WORK-521(7)                      I.981027
014500         MOVE  WORK-811(8)   TO  WORK-521(8)                      I.981027
014510         MOVE  WORK-811(9)   TO  WORK-521(9)                      I.981027
014520         MOVE  WORK-811(10)  TO  WORK-521(10)                     I.981027
014530         MOVE  WORK-82       TO  WORK-53                          I.981027
014540         MOVE  "X"           TO  WORK-54                          I.981027
014550         MOVE  JSTR-14A      TO  WORK-55.                         I.981027
014560     IF  JSTR-20    NOT =  SPACE                                  I.981027
014570         MOVE  "["           TO  WORK-51F                         I.981027
014580         MOVE  JSTR-20       TO  WORK-51                          I.981027
014590         MOVE  "]"           TO  WORK-51R.                        I.981027
014600     IF (JSTR-081   =  ZERO)  AND  (JSTR-082   =  ZERO)           I.150618
014610         MOVE  SPACE         TO  WORK-NGPD                        I.150618
014620         GO  TO  WRITE-005.                                       I.150618
014630     MOVE  JSTR-08       TO  JMSTD-KEY1.                          I.150618
014640     READ  JMSTD  UNLOCK  INVALID KEY                             I.150618
014650         MOVE  ZERO          TO  WORK-NGP                         I.150618
014660         GO  TO  WRITE-005.                                       I.150618
014670     IF  JMSTD-01   NOT =  6                                      I.150618
014680         MOVE  JMSTD-02S     TO  WORK-NGP.                        I.150618
014690 WRITE-005.                                                       I.150618
014700     IF  I  =  1
014710*****    MOVE   JSTR-14A     TO  WORK-53                          D.920826
014720         WRITE  PRN-R  FROM  WORK-5  AFTER  5
014730     ELSE
014740*****    MOVE   ZERO         TO  WORK-53                          D.920826
014750         WRITE  PRN-R  FROM  WORK-5  AFTER  1.
014760 WRITE-010.
014770     MOVE  JSTR-09       TO  WORK-61.
014780     MOVE  JSTR-10       TO  WORK-63.
014790*****IF  JSTR-03  NOT  =  0                                       *D 92/07
014800*****    COMPUTE  WORK-911(1)   =  JSTR-1111(1)   *   -1          *
014810*****    COMPUTE  WORK-911(2)   =  JSTR-1111(2)   *   -1          *
014820*****    COMPUTE  WORK-911(3)   =  JSTR-1111(3)   *   -1          *
014830*****    COMPUTE  WORK-911(4)   =  JSTR-1111(4)   *   -1          *
014840*****    COMPUTE  WORK-911(5)   =  JSTR-1111(5)   *   -1          *
014850*****    COMPUTE  WORK-911(6)   =  JSTR-1111(6)   *   -1          *
014860*****    COMPUTE  WORK-911(7)   =  JSTR-1111(7)   *   -1          *
014870*****    COMPUTE  WORK-911(8)   =  JSTR-1111(8)   *   -1          *
014880*****    COMPUTE  WORK-911(9)   =  JSTR-1111(9)   *   -1          *
014890*****    COMPUTE  WORK-911(10)  =  JSTR-1111(10)  *   -1          *
014900*****    COMPUTE  WORK-92       =  JSTR-1111(1)  +  JSTR-1111(2)  *
014910*****                           +  JSTR-1111(3)  +  JSTR-1111(4)  *
014920*****                           +  JSTR-1111(5)  +  JSTR-1111(6)  *
014930*****                           +  JSTR-1111(7)  +  JSTR-1111(8)  *
014940*****                           +  JSTR-1111(9)  +  JSTR-1111(10) *
014950*****    COMPUTE  WORK-92       =  WORK-92        *   -1          *
014960*****    MOVE  WORK-911(1)   TO  WORK-641(1)                      *
014970*****    MOVE  WORK-911(2)   TO  WORK-641(2)                      *
014980*****    MOVE  WORK-911(3)   TO  WORK-641(3)                      *
014990*****    MOVE  WORK-911(4)   TO  WORK-641(4)                      *
015000*****    MOVE  WORK-911(5)   TO  WORK-641(5)                      *
015010*****    MOVE  WORK-911(6)   TO  WORK-641(6)                      *
015020*****    MOVE  WORK-911(7)   TO  WORK-641(7)                      *
015030*****    MOVE  WORK-911(8)   TO  WORK-641(8)                      *
015040*****    MOVE  WORK-911(9)   TO  WORK-641(9)                      *
015050*****    MOVE  WORK-911(10)  TO  WORK-641(10)                     *
015060*********MOVE  WORK-92       TO  WORK-65                          * 911002
015070*****    GO  TO  WRITE-020                                        * 911002
015080*****ELSE
015090     MOVE  JSTR-1111(1)   TO  WORK-641(1).
015100     MOVE  JSTR-1111(2)   TO  WORK-641(2).
015110     MOVE  JSTR-1111(3)   TO  WORK-641(3).
015120     MOVE  JSTR-1111(4)   TO  WORK-641(4).
015130     MOVE  JSTR-1111(5)   TO  WORK-641(5).
015140     MOVE  JSTR-1111(6)   TO  WORK-641(6).
015150     MOVE  JSTR-1111(7)   TO  WORK-641(7).
015160     MOVE  JSTR-1111(8)   TO  WORK-641(8).
015170     MOVE  JSTR-1111(9)   TO  WORK-641(9).
015180     MOVE  JSTR-1111(10)  TO  WORK-641(10).
015190     COMPUTE  WORK-92  =  JSTR-1111(1)  +  JSTR-1111(2)
015200                       +  JSTR-1111(3)  +  JSTR-1111(4)
015210                       +  JSTR-1111(5)  +  JSTR-1111(6)
015220                       +  JSTR-1111(7)  +  JSTR-1111(8)
015230                       +  JSTR-1111(9)  +  JSTR-1111(10).         R 911002
015240*********MOVE  WORK-92  TO  WORK-65.                              D 911002
015250 WRITE-020.                                                       A 911002
015260*****IF  JSTR-13  =  2                                            D.941024
015270*****IF  JSTR-13  =  5                                            D.960626
015280     IF  JSTR-13  =  5 OR 4                                       I.960626
015290         MOVE  "("       TO  WORK-651                             A 911002
015300         MOVE  WORK-92   TO  WORK-652                             A 911002
015310         MOVE  ")"       TO  WORK-66                              A 911002
015320      ELSE                                                        A 911002
015330         MOVE  WORK-92   TO  WORK-65                              A 911002
015340         MOVE  SPACE     TO  WORK-66.                             A 911002
015350     WRITE  PRN-R  FROM  WORK-6  AFTER  1.
015360     ADD  1  TO  I.
015370 WRITE-RTN-EXIT.
015380     EXIT.
015390
015400******************************************************************
015410*    ’P‰¿ŒŸoˆ—  i‚s‚`‚m|‚q‚s‚mj                            *
015420******************************************************************
015430 TAN-RTN.                                                         I.100202
015440     MOVE JSTR-061 TO W-TCD.                                      I.100202
015450     IF W-TCD = 0460                                              I.100202
015460         MOVE 0458 TO W-TCD.                                      I.100202
015470     MOVE 0 TO W-TAN.                                             I.100202
015480     MOVE W-TCD TO THT-TCD.                                       I.100202
015490     MOVE JSTR-09 TO THT-HCD.                                     I.100202
015500     MOVE JSTR-10 TO THT-SIZ.                                     I.100202
015510     READ THTM UNLOCK INVALID                                     I.100202
015520         MOVE ZERO TO THT-T.                                      I.100202
015530     MOVE THT-T TO W-TAN.                                         I.100202
015540     IF W-TAN NOT = ZERO                                          I.100202
015550         GO TO TAN-EX.                                            I.100202
015560     MOVE W-TCD TO THT-TCD.                                       I.100202
015570     MOVE JSTR-09 TO THT-HCD.                                     I.100202
015580     MOVE 9 TO THT-SIZ.                                           I.100202
015590     READ THTM UNLOCK INVALID                                     I.100202
015600         MOVE ZERO TO THT-T.                                      I.100202
015610     MOVE THT-T TO W-TAN.                                         I.100202
015620     IF W-TAN = ZERO                                              I.100202
015630        MOVE  "¥"      TO  WORK-67.                               I.100202
015640 TAN-EX.                                                          I.100202
015650     EXIT.                                                        I.100202
015660******************************************************************
015670*    ƒeƒXƒgˆóŽšˆ—  i‚s‚d‚r‚s|‚q‚s‚mj                        *
015680******************************************************************
015690 TEST-RTN.
015700     OPEN  OUTPUT  PRN-F.
015710*****MOVE ""3FE04F40A0"" TO  ST-CD1.                              D.950202
015720*****MOVE ""3FE04FE080"" TO  ED-CD1.                              D.950202
015730     MOVE ""3FE04F40A0"" TO  ST-CD0  ST-CD1.                      I.950202
015740     MOVE ""3FE04FE080"" TO  ED-CD0  ED-CD1.                      I.950202
015750     MOVE  SPACE         TO  WORK-10.                             I.950202
015760     MOVE  ALL    "9"    TO  WORK-11.
015770*****MOVE  NC""      TO  WORK-M1.                             D.900917
015780     MOVE  "'"           TO  WORK-M2.                             I.890915
015790     MOVE  ALL    "9"    TO  WORK-211  WORK-212  WORK-213.
015800*****MOVE  ALL  NC"‚X"   TO  WORK-22.                             D 890920
015810     MOVE  ALL  NC"‚m"   TO  WORK-23.                             A 890920
015820     MOVE  ALL    "9"    TO  WORK-31  WORK-32.                    R.900411
015830     MOVE  ALL    "9"    TO  WORK-41  WORK-43.
015840     MOVE  ALL  NC"‚X"   TO  WORK-42  WORK-44.
015850*****IF  JS-SIGN4        =   1                                    D.011109
015860*****IF  JS-SIGN3        =   0                                    D.091015
015870     IF  JS-SIGN     NOT =   9                                    I.091015
015880         MOVE  ALL  NC"‚m"   TO  WORK-NA  WORK-JS                 I.010306
015890         MOVE  "TEL"         TO  WORK-TM                          I.010306
015900         MOVE  "FAX"         TO  WORK-FM                          I.010306
015910         MOVE  ALL    "X"    TO  WORK-UNO WORK-TEL WORK-FAX.      I.010306
015920     WRITE  PRN-R  FROM  WORK-1  AFTER  1.
015930*****IF  JS-SIGN4        =   1                                    D.011109
015940*****IF  JS-SIGN3        =   0                                    D.091015
015950     IF  JS-SIGN     NOT =   9                                    I.091015
015960         WRITE  PRN-R  FROM  WORK-1A AFTER  1                     I.010306
015970         WRITE  PRN-R  FROM  WORK-1B AFTER  1                     I.010306
015980         WRITE  PRN-R  FROM  WORK-1C AFTER  1                     I.010306
015990         WRITE  PRN-R  FROM  WORK-2  AFTER  1                     I.010306
016000       ELSE                                                       I.010306
016010         WRITE  PRN-R  FROM  WORK-2  AFTER  4.
016020     WRITE  PRN-R  FROM  WORK-3  AFTER  1.
016030     WRITE  PRN-R  FROM  WORK-3A AFTER  2.                        I.910703
016040     WRITE  PRN-R  FROM  WORK-4  AFTER  4.                        C.910703
016050     MOVE  1  TO  I.
016060 TEST-010.
016070     MOVE ""3FE04F40A0"" TO          ST-CD3.                      R 911002
016080     MOVE ""3FE04FE080"" TO  ED-CD2  ED-CD3.
016090*****MOVE  ALL  NC"‚X"   TO  WORK-51.                             D 911002
016100*****MOVE  ALL    "9"    TO  WORK-51A.                            D.960626
016110     MOVE         99     TO  WORK-521(1)  WORK-521(2)
016120                             WORK-521(3)  WORK-521(4)
016130                             WORK-521(5)  WORK-521(6)
016140                             WORK-521(7)  WORK-521(8)
016150                             WORK-521(9)  WORK-521(10).
016160     MOVE         999    TO  WORK-53.
016170     MOVE         "X"    TO  WORK-54.                             I.920826
016180     MOVE         999    TO  WORK-55.                             I.920826
016190     MOVE  ALL    "9"    TO  WORK-61.
016200     MOVE  ALL  NC"‚X"   TO  WORK-62.
016210     MOVE  ALL    "9"    TO  WORK-63.
016220     MOVE  ALL    "9"    TO  WORK-641(1)  WORK-641(2)
016230                             WORK-641(3)  WORK-641(4)
016240                             WORK-641(5)  WORK-641(6)
016250                             WORK-641(7)  WORK-641(8)
016260                             WORK-641(9)  WORK-641(10).
016270     MOVE  ALL    "9"    TO  WORK-65.
016280     IF  I  =  1
016290         WRITE  PRN-R  FROM  WORK-5  AFTER  5
016300         WRITE  PRN-R  FROM  WORK-6  AFTER  1
016310     ELSE
016320         WRITE  PRN-R  FROM  WORK-5  AFTER  1
016330         WRITE  PRN-R  FROM  WORK-6  AFTER  1.
016340     IF  I  =  6  GO  TO  TEST-020
016350     ELSE         ADD  1  TO  I
016360                  GO  TO  TEST-010.
016370 TEST-020.
016380     MOVE ""3FE04F40A0"" TO  ST-CD4.
016390     MOVE ""3FE04FE080"" TO  ED-CD4.
016400*****MOVE       "999"    TO  WORK-61A.                            *D 92/07
016410*****MOVE       "¾¯Ä"    TO  WORK-62A.                            *D 92/07
016420     WRITE  PRN-R  FROM  WORK-6A  AFTER  1.                       A 911002
016430*****MOVE  ALL  NC"‚X"   TO  WORK-711  WORK-712                   D.940728
016440     MOVE  ALL  NC"‚X"   TO  WORK-71                              I.940728
016450                             WORK-721  WORK-722.
016460     MOVE  ALL    "9"    TO  WORK-73  WORK-70.                    R.900411
016470     WRITE  PRN-R  FROM  WORK-7  AFTER  1.                        R 911002
016480     CLOSE  PRN-F.
016490 TEST-RTN-EXIT.
016500     EXIT.
016510 SEL-RTN.                                                         I.981020
016520     MOVE  ZERO  TO  W-SDATE  W-EDATE  W-SNGP  W-ENGP.            I.981020
016530     OPEN  INPUT  JSTR.                                           I.981020
016540 SEL-010.                                                         I.981020
016550     READ  JSTR  NEXT  RECORD  AT  END                            I.981020
016560         GO  TO  SEL-090.                                         I.981020
016570     IF  JSTR-158 NOT = 0                                         I.981020
016580         GO  TO  SEL-010.                                         I.981020
016590     IF  JSTR-05       =  ZERO            GO  TO  SEL-010.        I.050607
016600     IF  W-JS      NOT =  9                                       I.030716
016610         IF  JSTR-16   NOT =  W-JS        GO  TO  SEL-010.        I.030716
016620*****IF  JSTR-16   NOT =  IPN-KYO-KBN     GO  TO  SEL-010.        D.030716
016630     IF  JSTR-17   NOT =  9 AND 8         GO  TO  SEL-010.        I.010306
016640*****IF  JS-SIGN  =  1                                            D.060201
016650*****    IF  JS-SIGN3      =  0                                   D.060201
016660     IF  JS-SIGN  =  0                                            I.060201
016670         IF  JSTR-07  NOT =  1  AND  8    GO  TO  SEL-010.        I.121122
016680*****    IF  JSTR-07  NOT =  1            GO  TO  SEL-010.        D.121122
016690     IF  JS-SIGN  =  1                                            I.060201
016700         IF  JSTR-07  NOT =  6            GO  TO  SEL-010.        I.060201
016710     IF  JS-SIGN  =  2                                            I.010306
016720         IF  JSTR-07  NOT =  7            GO  TO  SEL-010.        I.010306
016730     IF  JS-SIGN  =  3                                            I.060107
016740         IF  JSTR-07  NOT =  4            GO  TO  SEL-010.        I.060107
016750*****IF  JS-SIGN3      =  1                                       D.091015
016760     IF  JS-SIGN       =  9                                       I.091015
016770         IF  JSTR-03     NOT =  5  AND 6                          I.010309
016780                                          GO  TO  SEL-010.        I.010309
016790*****IF  JS-SIGN3      =  0                                       D.091015
016800     IF  JS-SIGN   NOT =  9                                       I.091015
016810         IF  JSTR-03     NOT =  0                                 I.010309
016820                                          GO  TO  SEL-010.        I.010309
016830*****IF  JS-SIGN3      =  0                                       D.091015
016840*****IF  JS-SIGN   NOT =  0                                       D.091127
016850*****IF  JS-SIGN       =  2                                       D.091225
016860     IF  JS-SIGN       =  1                                       I.091225
016870         IF  JSTR-061        =  9850   OR  5000                   I.090919
016880                                          GO  TO  SEL-010.        I.090919
016890*****IF  JS-SIGN3      =  0                                       D.011109
016900*****    IF  IPN-KYO-KBN      =  1                                D.011109
016910*****        IF  JS-SIGN         =  1                             D.011109
016920*****            IF  JS-SIGN4       =  0                          D.011109
016930*****                IF  JSTR-061      =  0459  OR  0460  OR  3966D.011109
016940*****                                     GO  TO  SEL-010.        D.011109
016950*****IF  JS-SIGN3      =  0                                       D.011109
016960*****    IF  IPN-KYO-KBN      =  1                                D.011109
016970*****        IF  JS-SIGN         =  1                             D.011109
016980*****            IF  JS-SIGN4       =  1                          D.011109
016990*****                IF  JSTR-061  NOT =  0459 AND  0460 AND  3966D.011109
017000*****                                     GO  TO  SEL-010.        D.011109
017010*****IF  JSTR-03   NOT  =  0              GO  TO  SEL-010.        D.010309
017020     IF  W-SDATE = ZERO                                           I.981020
017030         MOVE  JSTR-04  TO  W-SDATE.                              I.981020
017040     IF  W-SDATE > JSTR-04                                        I.981020
017050         MOVE  JSTR-04  TO  W-SDATE.                              I.981020
017060     IF  W-EDATE < JSTR-04                                        I.981020
017070         MOVE  JSTR-04  TO  W-EDATE.                              I.981020
017080     GO  TO  SEL-010.                                             I.981020
017090 SEL-090.                                                         I.981020
017100     CLOSE  JSTR.                                                 I.981020
017110     MOVE  W-SDATE  TO  W-SNGP.                                   I.981020
017120     MOVE  W-EDATE  TO  W-ENGP.                                   I.981020
017130 SEL-EX.                                                          I.981020
017140     EXIT.                                                        I.981020
017150******************************************************************
017160*    ‚n‚o‚d‚mˆ—  i‚n‚o‚d‚m|‚q‚s‚mj                        *
017170******************************************************************
017180 OPEN-RTN.
017190     OPEN  I-O     JSTR
017200           INPUT   JCON
017210                   TC-M
017220*****              SHM                                            D.010808
017230                   HI2-M                                          I.010808
017240                   T-M                                            I.010221
017250                   THTM                                           I.100202
017260                   JMSTD                                          I.150618
017270           OUTPUT  PRN-F.
017280 OPEN-RTN-EXIT.
017290     EXIT.
017300
017310******************************************************************
017320*    ‚b‚k‚n‚r‚dˆ—  i‚b‚k‚r‚d|‚q‚s‚mj                        *
017330******************************************************************
017340 CLSE-RTN.
017350     CLOSE  JSTR
017360            JCON
017370            TC-M
017380*****       SHM                                                   D.010808
017390            HI2-M                                                 I.010808
017400            T-M                                                   I.010221
017410            THTM                                                  I.100202
017420            JMSTD                                                 I.150618
017430            PRN-F.
017440 CLSE-RTN-EXIT.
017450     EXIT.
017460
017470     COPY  LPERR.                                                 R.900411
017480*****COPY  LPACPT.                                                D.030716
