000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. JHS54L.
000030*********************************************************
000040*    PROGRAM         :  ìùàÍì`ï[î≠çsÅiê‘ÇøÇ·ÇÒñ{ï‹Åj    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT TDNAF ASSIGN TO TDNA-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE DYNAMIC
000180         RECORD KEY TDNA-KEY
000190         FILE STATUS IS ERR-STAT.
000200*****SELECT AHNHF ASSIGN TO AHNH-MSD                              D.090909
000210*****    ORGANIZATION INDEXED                                     D.090909
000220*****    ACCESS MODE DYNAMIC                                      D.090909
000230*****    RECORD KEY AHNH-KEY                                      D.090909
000240*****    FILE STATUS IS ERR-STAT.                                 D.090909
000250*****SELECT CODEF ASSIGN TO CODE-MSD                              D.090909
000260*****    ORGANIZATION INDEXED                                     D.090909
000270*****    ACCESS MODE DYNAMIC                                      D.090909
000280*****    RECORD KEY CODE-KEY                                      D.090909
000290*****    FILE STATUS IS ERR-STAT.                                 D.090909
000300*****SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        D.090909
000310*****    ORGANIZATION INDEXED                                     D.090909
000320*****    ACCESS MODE RANDOM                                       D.090909
000330*****    RECORD KEY HI-KEY                                        D.090909
000340*****    ALTERNATE RECORD KEY HI-KEY2                             D.090909
000350*****    FILE STATUS IS ERR-STAT.                                 D.090909
000360     SELECT TDNARF ASSIGN TO TDNAR-MSD.
000370     SELECT SP-F ASSIGN TO P-PRN999.
000380 I-O-CONTROL.
000390     APPLY SHARED-MODE ON TDNAF
000400*****APPLY SHARED-MODE ON AHNHF                                   D.090909
000410*****APPLY SHARED-MODE ON CODEF                                   D.090909
000420*****APPLY SHARED-MODE ON HI-M                                    D.090909
000430     APPLY SHIFT-CODE  ON SP-F.
000440 DATA DIVISION.
000450 FILE SECTION.
000460     COPY LITDNA.
000470*****COPY LIAHNH.                                                 D.090909
000480*****COPY LICODE.                                                 D.090909
000490*****COPY LIHIM.                                                  D.090909
000500 FD  TDNARF
000510     BLOCK  1 RECORDS
000520     LABEL RECORD IS STANDARD
000530     VALUE OF IDENTIFICATION "TDNARF".
000540 01  TDNAR-R.
000550     02  TDNAR-KEY.
000560       03  TDNAR-STC    PIC  9(007).
000570*****  03  TDNAR-DNO    PIC  9(006).                              D.100720
000580       03  TDNAR-DNO    PIC  9(007).                              I.100720
000590       03  TDNAR-DGN    PIC  9(002).
000600     02  TDNAR-JAN      PIC  X(013).
000610     02  TDNAR-SU       PIC  9(006).
000620     02  TDNAR-GTN      PIC  9(007).
000630     02  TDNAR-UTN      PIC  9(007).
000640     02  TDNAR-GKIN     PIC  9(010).
000650     02  TDNAR-UKIN     PIC  9(010).
000660     02  TDNAR-DPM      PIC  X(002).
000670     02  TDNAR-CLS      PIC  X(003).
000680     02  TDNAR-SHM      PIC  X(013).
000690     02  TDNAR-MKH      PIC  X(010).
000700     02  TDNAR-MSB      PIC  X(010).
000710     02  TDNAR-TY       PIC  X(002).
000720     02  TDNAR-HCD      PIC  9(006).                              I.090909
000730     02  TDNAR-COR      PIC  N(004).                              I.090909
000740     02  TDNAR-SIZ      PIC  X(004).                              I.090909
000750*****02  F              PIC  X(018).                              D.090909
000760     02  TDNAR-NSU      PIC  9(006).
000770     02  TDNAR-TSC      PIC  9(001).
000780     02  F              PIC  X(008).                              I.100720
000790*****02  F              PIC  X(009).                              D.100720
000800*****02  F              PIC  X(018).                              D.090909
000810*****02  F              PIC  X(020).                              D.090526
000820     02  TDNAR-CCD      PIC  9(003).                              I.090909
000830     02  TDNAR-TNA      PIC  N(014).                              I.090909
000840     02  TDNAR-KEY2.
000850       03  TDNAR-HNO    PIC  9(009).
000860       03  TDNAR-HNGP   PIC  9(006).
000870     02  TDNAR-NNGP     PIC  9(006).
000880     02  TDNAR-THC      PIC  9(006).
000890     02  TDNAR-BI       PIC  X(010).
000900     02  TDNAR-SNGP     PIC  9(008).
000910     02  TDNAR-SNGPD REDEFINES TDNAR-SNGP.
000920       03  F            PIC  9(002).
000930       03  TDNAR-NGPS   PIC  9(006).
000940     02  TDNAR-HNA      PIC  X(006).
000950     02  TDNAR-ZON      PIC  X(004).
000960     02  TDNAR-DC       PIC  9(002).
000970*****02  F              PIC  X(035).                              D.090909
000980     02  F              PIC  X(015).
000990     02  TDNAR-NRC      PIC  9(001).
001000     02  TDNAR-RNGP     PIC  9(008).
001010     02  TDNAR-PC       PIC  9(001).
001020     02  TDNAR-RC       PIC  9(001).
001030 FD  SP-F
001040     LABEL RECORD OMITTED
001050     LINAGE IS 30 LINES.
001060 01  SP-R               PIC  X(170).
001070 WORKING-STORAGE  SECTION.
001080 77  ERR-STAT           PIC  X(002).
001090 77  W-FILE             PIC  X(013).
001100 77  W-INV              PIC  9(001).
001110 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
001120 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
001130 01  W-P02.
001140     02  P-15K          PIC  X(005).
001150*****02  F              PIC  X(018).                              D.100308
001160     02  F              PIC  X(019).                              I.100308
001170     02  P-BI           PIC  X(010).
001180     02  F              PIC  X(057).
001190     02  P-NNGP         PIC  9(006).
001200     02  F              PIC  X(018).
001210 01  W-P03.
001220*****02  F              PIC  X(072).                              D.100308
001230     02  F              PIC  X(073).                              I.100308
001240     02  P-NRN          PIC  N(006).
001250     02  F              PIC  X(028).
001260 01  W-P04.
001270*****02  F              PIC  X(006).                              D.100308
001280     02  F              PIC  X(007).                              I.100308
001290     02  P-SNA          PIC  N(008).
001300     02  F              PIC  X(053).
001310     02  P-NRA          PIC  N(014).
001320     02  F              PIC  X(028).
001330 01  W-P05.
001340*****02  F              PIC  X(006).                              D.100308
001350     02  F              PIC  X(007).                              I.100308
001360     02  P-TNA          PIC  N(014).
001370     02  F              PIC  X(004).
001380     02  P-STC          PIC  9(007).
001390     02  F              PIC  X(008).
001400     02  P-DC           PIC  9(002).
001410     02  F              PIC  X(004).
001420*****02  P-DNO          PIC  9(006).                              D.100720
001430*****02  F              PIC  X(003).                              D.100720
001440     02  P-DNO          PIC  9(007).                              I.100720
001450     02  F              PIC  X(002).                              I.100720
001460     02  P-THC          PIC  9(006).
001470     02  F              PIC  X(006).
001480     02  P-NRT          PIC  X(017).
001490*****02  F              PIC  X(009).                              D.100819
001500     02  F              PIC  X(003).                              I.100819
001510     02  P-HNGP         PIC  9(006).                              I.100819
001520     02  P-NGPS         PIC  9(006).
001530     02  F              PIC  X(004).
001540 01  W-PMO.
001550*****02  F              PIC  X(005).                              D.100308
001560     02  F              PIC  X(006).                              I.100308
001570     02  P-DPM          PIC  X(002).
001580     02  P-CLS          PIC  X(003).
001590     02  F              PIC  X(002).
001600     02  P-MKH          PIC  X(010).
001610     02  F              PIC  X(035).
001620     02  P-NSU          PIC ZZZZ9.
001630     02  F              PIC  X(022).
001640     02  P-GKINS        PIC ZZZZZZZZ9.
001650     02  F              PIC  X(006).
001660     02  P-MSB          PIC  X(010).
001670     02  P-MSBD  REDEFINES  P-MSB.
001680       03  P-UKINS      PIC ZZZZZZZZ9B.
001690 01  W-PMU.
001700*****02  F              PIC  X(005).                              D.100308
001710     02  F              PIC  X(006).                              I.100308
001720     02  P-SHM          PIC  X(013).
001730     02  F              PIC  X(011).
001740     02  P-JAN          PIC  X(013).
001750     02  F              PIC  X(001).
001760     02  P-COL          PIC  N(004).
001770     02  F              PIC  X(001).
001780     02  P-SIZ          PIC  X(004).
001790*****02  F              PIC  X(003).                              D.090727
001800     02  F              PIC  X(001).                              I.090727
001810     02  P-TY           PIC  X(002).                              I.090727
001820     02  P-SU           PIC  Z(005).
001830     02  P-SUV   REDEFINES P-SU    PIC  X(005).
001840     02  F              PIC  X(014).
001850     02  P-GTN          PIC  Z(006).
001860     02  F              PIC  X(002).
001870     02  P-GKIN         PIC  Z(009).
001880     02  P-GKINV REDEFINES P-GKIN  PIC  X(009).
001890     02  P-UTN          PIC  Z(006).
001900     02  P-UKIN         PIC  Z(009).
001910     02  P-UKINV REDEFINES P-UKIN  PIC  X(009).
001920     02  F              PIC  X(001).
001930 01  W-P11.
001940*****02  F              PIC  X(007).                              D.100308
001950     02  F              PIC  X(008).                              I.100308
001960     02  P-HNO          PIC  9(009).
001970     02  F              PIC  X(008).
001980     02  P-HNA          PIC  X(006).
001990     02  F              PIC  X(027).
002000     02  P-NSUT         PIC  Z(005).
002010     02  F              PIC  X(047).
002020 01  W-P12.
002030*****02  F              PIC  X(057).                              D.100308
002040     02  F              PIC  X(058).                              I.100308
002050     02  P-SUT          PIC  Z(005).
002060     02  P-SUTV   REDEFINES P-SUT    PIC  X(005).
002070     02  F              PIC  X(022).
002080     02  P-GKINT        PIC  Z(009).
002090     02  P-GKINTV REDEFINES P-GKINT  PIC  X(009).
002100     02  F              PIC  X(006).
002110     02  P-UKINT        PIC  Z(009).
002120     02  P-UKINTV REDEFINES P-UKINT  PIC  X(009).
002130     02  F              PIC  X(001).
002140 01  W-P13.
002150*****02  F              PIC  X(006).                              D.100308
002160     02  F              PIC  X(007).                              I.100308
002170     02  P-ZONM         PIC  N(006).
002180     02  P-ZON          PIC  X(004).
002190     02  F              PIC  X(090).
002200 01  W-P15.
002210     02  P-20K          PIC  X(005).
002220*****02  F              PIC  X(072).                              D.100308
002230     02  F              PIC  X(073).                              I.100308
002240     02  P-TGKIN        PIC  N(009).
002250     02  P-TUKIN        PIC  N(009).
002260     02  F              PIC  X(001).
002270 01  W-DATA.
002280     02  WT-D.
002290       03  W-TSC        PIC  9(001).
002300       03  WT-NSU       PIC  9(006).
002310       03  WT-GKINS     PIC  9(009).
002320       03  WT-UKINS     PIC  9(009).
002330       03  WT-SU        PIC  9(006).
002340       03  WT-GKIN      PIC  9(009).
002350       03  WT-UKIN      PIC  9(009).
002360       03  WT-TGKIN     PIC  9(009).
002370       03  WT-TUKIN     PIC  9(009).
002380     02  W-D.
002390       03  W-POC        PIC  9(001).
002400       03  W-TPC        PIC  9(001).
002410       03  W-FOC        PIC  9(001).
002420       03  W-HKC        PIC  9(001).
002430       03  W-SED.
002440         04  W-SSTC     PIC  9(007).
002450*****    04  W-SDNO     PIC  9(006).                              D.100720
002460         04  W-SDNO     PIC  9(007).                              I.100720
002470         04  W-ESTC     PIC  9(007).
002480*****    04  W-EDNO     PIC  9(006).                              D.100720
002490         04  W-EDNO     PIC  9(007).                              I.100720
002500       03  W-DMM        PIC  9(001).
002510       03  W-RSTC.
002520         04  W-RSCD     PIC  9(002).
002530         04  W-RTCD     PIC  9(003).
002540       03  W-STC        PIC  9(007).
002550*****  03  W-DNO        PIC  9(006).                              D.100720
002560       03  W-DNO        PIC  9(007).                              I.100720
002570       03  W-HCC        PIC  9(001).
002580       03  W-LC         PIC  9(002).
002590     02  W-GKINS        PIC  9(009).
002600     02  W-UKINS        PIC  9(009).
002610     02  W-TGKINZ       PIC  Z(009).
002620     02  W-TUKINZ       PIC  Z(009).
002630     02  CNT            PIC  9(002).
002640     02  CNTD           PIC  9(002).
002650*****02  W-AHNA         PIC  N(024).                              D.090909
002660*****02  W-AHNAD REDEFINES W-AHNA.                                D.090909
002670*****  03  W-HNAD  OCCURS  24.                                    D.090909
002680*****    04  W-HNA      PIC  N(001).                              D.090909
002690*****02  W-COL          PIC  N(004).                              D.090909
002700*****02  W-ANAD  REDEFINES W-COL.                                 D.090909
002710*****  03  W-NAD  OCCURS   4.                                     D.090909
002720*****    04  W-NA       PIC  N(001).                              D.090909
002730*****02  W-MSB          PIC  X(010).                              D.090727
002740*****02  W-AMSBD REDEFINES W-MSB.                                 D.090727
002750*****  03  W-AMSB  OCCURS  10.                                    D.090727
002760*****    04  W-MSBD     PIC  X(001).                              D.090727
002770*****02  W-MB           PIC  X(010).                              D.090727
002780*****02  W-AMBD REDEFINES W-MB.                                   D.090727
002790*****  03  W-AMB  OCCURS  10.                                     D.090727
002800*****    04  W-MBD      PIC  X(001).                              D.090727
002810*****02  W-ASIZD.                                                 D.090909
002820*****  03  W-ASIZ  OCCURS   4.                                    D.090909
002830*****    04  W-SIZD  OCCURS  10.                                  D.090909
002840*****      05  W-SIZ    PIC  X(004).                              D.090909
002850*****02  W-SZ           PIC  X(004).                              D.090909
002860*****02  W-SZD   REDEFINES W-SZ.                                  D.090909
002870*****  03  F            PIC  X(003).                              D.090909
002880*****  03  W-SZH        PIC  X(001).                              D.090909
002890*****02  W-MSIZ.                                                  D.090909
002900*      03  F            PIC  X(040) VALUE
002910*           "----      SS   S   M   L  LL  XL XXL    ".
002920*****  03  F            PIC  X(040) VALUE                         D.090909
002930*****       "                            28.029.030.0".           D.090909
002940*****  03  F            PIC  X(040) VALUE                         D.090909
002950*****       "12.513.013.514.015.016.017.018.019.020.0".           D.090909
002960*****  03  F            PIC  X(040) VALUE                         D.090909
002970*****       "21.021.522.022.523.023.524.024.525.0    ".           D.090909
002980*****  03  F            PIC  X(040) VALUE                         D.090909
002990*****       "24.024.525.025.526.026.527.027.5        ".           D.090909
003000     COPY LSTAT.
003010 SCREEN SECTION.
003020 SD  C-CRT
003030     END STATUS IS ESTAT.
003040 01  C-CLEAR.
003050     02  C-CL    LINE   1  CLEAR SCREEN.
003060 01  C-MID.
003070     02  LINE   1  COLUMN  20  PIC  N(014) VALUE
003080          NC"É`ÉFÅ[ÉìÉXÉgÉAìùàÍì`ï[Å@î≠çs".
003090     02  LINE   2  COLUMN  20  PIC  N(013) VALUE
003100          NC"ÅiÉ^Å[ÉìÉAÉâÉEÉìÉhópÇQå^Åj".
003110     02  LINE   4  COLUMN  10  PIC  N(008) VALUE
003120          NC"Åmê‘ÇøÇ·ÇÒñ{ï‹Ån".
003130     02  LINE   7  COLUMN  22  PIC  X(035) VALUE
003140          "ÉeÉXÉgÉvÉäÉìÉgàÛéö (YES=1,NO=2) [ ]".
003150     02  LINE  10  COLUMN  22  PIC  X(010) VALUE
003160          "ÇPÅDî≠Å@çs".
003170     02  LINE  11  COLUMN  22  PIC  X(018) VALUE
003180          "ÇQÅDçƒî≠çsÅiìñì˙Åj".
003190     02  LINE  12  COLUMN  22  PIC  X(026) VALUE
003200          "ÇRÅDçƒî≠çsÅià»ëOÅj     [ ]".
003210     02  LINE  23  COLUMN  40  PIC  X(028) VALUE
003220          "ämîF (OK=1,NO=9) --->   ÿ¿∞›".
003230 01  C-DSP.
003240     02  D-SHM.
003250       03  LINE  14  COLUMN  33  PIC  X(020) VALUE
003260            " é–ìX∫∞ƒﬁ   ì`ï[î‘çÜ".
003270       03  LINE  15  COLUMN  22  PIC  N(004) VALUE
003280            NC"ÇeÇqÇnÇl".
003290       03  LINE  16  COLUMN  22  PIC  N(002) VALUE
003300            NC"ÇsÇn".
003310     02  D-SHMC.
003320       03  LINE  14  COLUMN  33  PIC  X(020) VALUE
003330            "                  ".
003340       03  LINE  15  COLUMN  22  PIC  X(031) VALUE
003350            "                               ".
003360       03  LINE  16  COLUMN  22  PIC  X(031) VALUE
003370            "                              ".
003380 01  C-ACP.
003390     02  A-TPC   LINE   7  COLUMN  55  PIC  9(001)
003400          USING W-TPC   CHECK OVERFLOW NO IFC.
003410     02  A-HKC   LINE  12  COLUMN  46  PIC  9(001)
003420          USING W-HKC   CHECK OVERFLOW NO IFC.
003430     02  A-DMM   LINE  23  COLUMN  62  PIC  9(001)
003440          USING W-DMM   CHECK OVERFLOW NO IFC.
003450     02  LINE  15.
003460       03  A-SSTC  COLUMN  34  PIC  9(007)
003470            USING W-SSTC  CHECK OVERFLOW NO IFC.
003480*****  03  A-SDNO  COLUMN  46  PIC  9(006)                        D.100720
003490       03  A-SDNO  COLUMN  45  PIC  9(007)                        I.100720
003500            USING W-SDNO  CHECK OVERFLOW NO IFC.
003510     02  LINE  16.
003520       03  A-ESTC  COLUMN  34  PIC  9(007)
003530            USING W-ESTC  CHECK OVERFLOW NO IFC.
003540*****  03  A-EDNO  COLUMN  46  PIC  9(006)                        D.100720
003550       03  A-EDNO  COLUMN  45  PIC  9(007)                        I.100720
003560            USING W-EDNO  CHECK OVERFLOW NO IFC.
003570 01  C-ERR.
003580     02  LINE  24.
003590       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
003600            "***  DATA ≈º  ***".
003610       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
003620            "***  DATA ¥◊∞  ***".
003630*****  03  E-ME5   COLUMN  15  PIC  X(019) VALUE                  D.090909
003640*****       "***  …≥À›ª∑ ≈º  ***".                                D.090909
003650*****  03  E-ME6   COLUMN  15  PIC  X(020) VALUE                  D.090909
003660*****       "***  JAN∫∞ƒﬁ ≈º  ***".                               D.090909
003670*****  03  E-ME7   COLUMN  15  PIC  X(017) VALUE                  D.090909
003680*****       "***  À›“≤ ≈º  ***".                                  D.090909
003690*****  03  E-ME8   COLUMN  15  PIC  X(017) VALUE                  D.090909
003700*****       "***  ª≤Ωﬁ ≈º  ***".                                  D.090909
003710       03  E-ME10  COLUMN  15  PIC  X(027) VALUE
003720            "***  TDNAF DATA ¥◊∞  ***".
003730       03  E-ME11  COLUMN  15  PIC  X(027) VALUE
003740            "***  TDNAF REWRITE ¥◊∞  ***".
003750*****  03  E-STC   COLUMN  45  PIC  X(007) FROM  AHNH-KEY.        D.090909
003760*****  03  E-JAN   COLUMN  53  PIC  X(013) FROM  CODE-JAN.        D.090909
003770*****  03  E-HCD   COLUMN  67  PIC  X(006) FROM  HI-HCD.          D.090909
003780     COPY LSSEM.
003790 PROCEDURE DIVISION.
003800 M-05.
003810     DISPLAY C-CLEAR.
003820     DISPLAY C-MID.
003830     MOVE 000 TO COMPLETION-CODE.
003840*****OPEN INPUT AHNHF CODEF HI-M.                                 D.090909
003850     MOVE ZERO TO W-D.
003860 M-10.
003870     ACCEPT A-TPC.
003880     IF ESTAT = PF9
003890         GO TO M-90.
003900     IF ESTAT NOT = HTB AND SKP
003910         GO TO M-10.
003920     IF W-TPC = 2
003930         GO TO M-15.
003940     IF W-TPC NOT = 1
003950         GO TO M-10.
003960     PERFORM TST-RTN THRU TST-EX.
003970     GO TO M-10.
003980 M-15.
003990     ACCEPT A-HKC.
004000     IF ESTAT = BTB
004010         GO TO M-10.
004020     IF ESTAT NOT = HTB AND SKP
004030         GO TO M-15.
004040     IF W-HKC = 1
004050         DISPLAY D-SHMC
004060         GO TO M-40.
004070     IF W-HKC NOT = 2 AND 3
004080         GO TO M-15.
004090     DISPLAY D-SHM.
004100 M-20.
004110     ACCEPT A-SSTC.
004120     IF ESTAT = BTB
004130         GO TO M-15.
004140     IF ESTAT NOT = HTB AND SKP
004150         GO TO M-20.
004160 M-25.
004170     ACCEPT A-ESTC.
004180     IF ESTAT = BTB
004190         GO TO M-20.
004200     IF ESTAT NOT = HTB AND SKP
004210         GO TO M-25.
004220     IF W-SSTC > W-ESTC
004230         GO TO M-25.
004240 M-30.
004250     ACCEPT A-SDNO.
004260     IF ESTAT = BTB
004270         GO TO M-25.
004280     IF ESTAT NOT = HTB AND SKP
004290         GO TO M-30.
004300 M-35.
004310     ACCEPT A-EDNO.
004320     IF ESTAT = BTB
004330         GO TO M-30.
004340     IF ESTAT NOT = HTB AND SKP
004350         GO TO M-35.
004360     IF W-SDNO > W-EDNO
004370         GO TO M-35.
004380 M-40.
004390     ACCEPT A-DMM.
004400     IF ESTAT = BTB
004410         IF W-HKC = 1
004420             GO TO M-15
004430           ELSE
004440             GO TO M-35.
004450     IF ESTAT NOT = HTB AND SKP
004460         GO TO M-40.
004470     IF W-DMM = 9
004480         GO TO M-15.
004490     IF W-DMM NOT = 1
004500         GO TO M-40.
004510*
004520     IF W-HKC = 1
004530         OPEN I-O TDNAF
004540       ELSE
004550         IF W-HKC = 2
004560             OPEN INPUT TDNAF
004570           ELSE
004580             OPEN INPUT TDNARF.
004590     MOVE 1 TO W-FOC.
004600*****MOVE W-MSIZ TO W-ASIZD.                                      D.090909
004610     IF W-HKC = 3
004620         GO TO M-50.
004630 M-45.
004640     READ TDNAF NEXT RECORD WITH UNLOCK AT END
004650         DISPLAY E-ME1 E-ME99
004660         GO TO M-90.
004670     IF TDNA-RC NOT = 0                                           I.090909
004680         GO TO M-45.                                              I.090909
004690     IF TDNA-PC = 0
004700         GO TO M-45.
004710     IF W-HKC = 1
004720         IF TDNA-PC = 9
004730             GO TO M-45.
004740     IF W-HKC = 2
004750         IF TDNA-PC NOT = 9
004760             GO TO M-45.
004770     IF W-HKC = 2
004780         IF TDNA-STC < W-SSTC OR > W-ESTC
004790             GO TO M-45.
004800     IF W-HKC = 2
004810         IF TDNA-DNO < W-SDNO OR > W-EDNO
004820             GO TO M-45.
004830     IF TDNA-DGN NOT = 1
004840         DISPLAY E-ME78 E-ME2 E-ME99
004850         DISPLAY E-CL
004860         DISPLAY E-ME78
004870         GO TO M-45.
004880     GO TO M-55.
004890 M-50.
004900     READ TDNARF AT END
004910         DISPLAY E-ME1 E-ME99
004920         GO TO M-90.
004930     IF TDNAR-PC = 0
004940         GO TO M-50.
004950     IF W-HKC = 1
004960         IF TDNAR-PC = 9
004970             GO TO M-50.
004980     IF W-HKC = 2
004990         IF TDNAR-PC NOT = 9
005000             GO TO M-50.
005010     IF W-HKC = 2
005020         IF TDNAR-STC < W-SSTC OR > W-ESTC
005030             GO TO M-50.
005040     IF W-HKC = 2
005050         IF TDNAR-DNO < W-SDNO OR > W-EDNO
005060             GO TO M-50.
005070     IF TDNAR-DGN NOT = 1
005080         DISPLAY E-ME78 E-ME2 E-ME99
005090         DISPLAY E-CL
005100         DISPLAY E-ME78
005110         GO TO M-50.
005120 M-55.
005130     IF W-HKC = 1 OR 2
005140         MOVE TDNA-STC TO W-STC
005150         MOVE TDNA-DNO TO W-DNO
005160       ELSE
005170         MOVE TDNAR-STC TO W-STC
005180         MOVE TDNAR-DNO TO W-DNO.
005190     MOVE ZERO TO WT-D.
005200     MOVE SPACE TO W-P02 W-P03 W-P04 W-P05
005210                   W-P11 W-P12 W-P13 W-P15.
005220     MOVE SPACE TO P-TGKIN P-TUKIN.
005230*
005240     MOVE W-15K TO P-15K.
005250     MOVE W-20K TO P-20K.
005260     MOVE NC"áäê‘ÇøÇ·ÇÒñ{ï‹Å@" TO P-SNA.
005270     MOVE NC"ì˙êiÉSÉÄáäÅ@" TO P-NRN.
005280     MOVE NC"â™éRésñkãÊç°î™íöñ⁄ÇPÇUÅ|ÇPÇV" TO P-NRA.
005290     MOVE "TEL (086)243-2456" TO P-NRT.
005300     MOVE NC"î[ïiÉ]Å[Éì" TO P-ZONM.
005310*****MOVE 20 TO P-DC.                                             D.090727
005320     IF W-HKC = 1 OR 2
005330         PERFORM HED1-RTN THRU HED1-EX
005340       ELSE
005350         PERFORM HED2-RTN THRU HED2-EX.
005360     IF W-POC = 0
005370         OPEN OUTPUT SP-F
005380         MOVE 1 TO W-POC
005390       ELSE
005400         MOVE SPACE TO SP-R
005410         WRITE SP-R AFTER PAGE.
005420     MOVE SPACE TO SP-R.
005430     MOVE W-P02 TO SP-R.
005440     WRITE SP-R.
005450     MOVE SPACE TO SP-R.
005460     MOVE W-P03 TO SP-R.
005470     WRITE SP-R.
005480     MOVE SPACE TO SP-R.
005490     MOVE W-P04 TO SP-R.
005500     WRITE SP-R.
005510     MOVE SPACE TO SP-R.
005520     MOVE W-P05 TO SP-R.
005530     WRITE SP-R.
005540     MOVE SPACE TO SP-R.
005550     WRITE SP-R.
005560     MOVE 20 TO W-LC.
005570*****IF W-HKC = 3
005580*****    GO TO M-70.
005590 M-60.
005600*****PERFORM HNM-RTN THRU HNM-EX.                                 D.090909
005610     IF W-HKC = 1 OR 2
005620         PERFORM MEI1-RTN THRU MEI1-EX
005630         GO TO M-65
005640       ELSE
005650         PERFORM MEI2-RTN THRU MEI2-EX.
005660         GO TO M-70.
005670 M-65.
005680     READ TDNAF NEXT RECORD WITH UNLOCK AT END
005690         GO TO M-85.
005700     IF TDNA-RC NOT = 0                                           I.090909
005710         GO TO M-65.                                              I.090909
005720     IF TDNA-PC = 0
005730         GO TO M-65.
005740     IF W-HKC = 1
005750         IF TDNA-PC = 9
005760             GO TO M-65.
005770     IF W-HKC = 2
005780         IF TDNA-PC NOT = 9
005790             GO TO M-65.
005800     IF W-HKC = 2
005810         IF TDNA-STC < W-SSTC OR > W-ESTC
005820             GO TO M-65.
005830     IF W-HKC = 2
005840         IF TDNA-DNO < W-SDNO OR > W-EDNO
005850             GO TO M-65.
005860     IF (TDNA-STC NOT = W-STC) OR (TDNA-DNO NOT = W-DNO)
005870         GO TO M-75.
005880     IF TDNA-DGN = 1
005890         DISPLAY E-ME78 E-ME2 E-ME99
005900         DISPLAY E-CL
005910         DISPLAY E-ME78
005920         GO TO M-55.
005930     GO TO M-60.
005940 M-70.
005950     READ TDNARF AT END
005960         GO TO M-85.
005970     IF TDNAR-STC < W-SSTC OR > W-ESTC
005980         GO TO M-70.
005990     IF TDNAR-DNO < W-SDNO OR > W-EDNO
006000         GO TO M-70.
006010     IF (TDNAR-STC NOT = W-STC) OR (TDNAR-DNO NOT = W-DNO)
006020         GO TO M-75.
006030     IF TDNAR-DGN = 1
006040         DISPLAY E-ME78 E-ME2 E-ME99
006050         DISPLAY E-CL
006060         DISPLAY E-ME78
006070         GO TO M-55.
006080     GO TO M-60.
006090 M-75.
006100     PERFORM KEI-RTN THRU KEI-EX.
006110     IF W-HKC = 1
006120         PERFORM REW-RTN THRU REW-EX.
006130     IF W-HKC = 1 OR 2
006140         IF TDNA-DGN NOT = 1
006150             DISPLAY E-ME78 E-ME2 E-ME99
006160             DISPLAY E-CL
006170             DISPLAY E-ME78
006180             GO TO M-55.
006190     IF W-HKC NOT = 1 AND 2
006200         IF TDNAR-DGN NOT = 1
006210             DISPLAY E-ME78 E-ME2 E-ME99
006220             DISPLAY E-CL
006230             DISPLAY E-ME78
006240             GO TO M-55.
006250     GO TO M-55.
006260 M-85.
006270     PERFORM KEI-RTN THRU KEI-EX.
006280     IF W-HKC = 1
006290         PERFORM REW-RTN THRU REW-EX.
006300 M-90.
006310*****CLOSE AHNHF.                                                 D.090909
006320*****CLOSE CODEF.                                                 D.090909
006330*****CLOSE HI-M.                                                  D.090909
006340     IF W-FOC NOT = 0
006350         IF W-HKC = 1 OR 2
006360             CLOSE TDNAF
006370           ELSE
006380             CLOSE TDNARF.
006390     IF W-POC NOT = 0
006400         CLOSE SP-F.
006410 M-95.
006420     DISPLAY C-CLEAR.
006430     STOP RUN.
006440 HED1-RTN.
006450*****MOVE TDNA-STC TO AHNH-KEY.                                   D.090909
006460*****READ AHNHF WITH UNLOCK INVALID KEY                           D.090909
006470*****    DISPLAY E-ME5 E-STC E-ME99                               D.090909
006480*****    MOVE SPACE TO AHNH-NHSN                                  D.090909
006490*****    MOVE TDNA-STC TO AHNH-NHSN.                              D.090909
006500*
006510     MOVE TDNA-BI TO P-BI.
006520     MOVE TDNA-NNGP TO P-NNGP.
006530     MOVE TDNA-TNA TO P-TNA.                                      I.090909
006540*****MOVE AHNH-NHSN TO P-TNA.                                     D.090909
006550     MOVE TDNA-STC TO P-STC.
006560     MOVE TDNA-DC TO P-DC.                                        I.090727
006570     MOVE TDNA-DNO TO P-DNO.
006580     MOVE TDNA-THC TO P-THC.
006590     MOVE TDNA-HNGP TO P-HNGP.                                    I.100819
006600     MOVE TDNA-NGPS TO P-NGPS.
006610     MOVE TDNA-HNO TO P-HNO.
006620     MOVE TDNA-HNA TO P-HNA.
006630     MOVE TDNA-ZON TO P-ZON.
006640 HED1-EX.
006650     EXIT.
006660 HED2-RTN.
006670*****MOVE TDNAR-STC TO AHNH-KEY.                                  D.090909
006680*****READ AHNHF WITH UNLOCK INVALID KEY                           D.090909
006690*****    DISPLAY E-ME5 E-STC E-ME99                               D.090909
006700*****    MOVE SPACE TO AHNH-NHSN                                  D.090909
006710*****    MOVE TDNAR-STC TO AHNH-NHSN.                             D.090909
006720*
006730     MOVE TDNAR-BI TO P-BI.
006740     MOVE TDNAR-NNGP TO P-NNGP.
006750     MOVE TDNAR-TNA TO P-TNA.                                     I.090909
006760*****MOVE AHNH-NHSN TO P-TNA.                                     D.090909
006770     MOVE TDNAR-STC TO P-STC.
006780     MOVE TDNAR-DC TO P-DC.                                       I.090727
006790     MOVE TDNAR-DNO TO P-DNO.
006800     MOVE TDNAR-THC TO P-THC.
006810     MOVE TDNAR-HNGP TO P-HNGP.                                   I.100819
006820     MOVE TDNAR-NGPS TO P-NGPS.
006830     MOVE TDNAR-HNO TO P-HNO.
006840     MOVE TDNAR-HNA TO P-HNA.
006850     MOVE TDNAR-ZON TO P-ZON.
006860 HED2-EX.
006870     EXIT.
006880*HNM-RTN.                                                         D.090909
006890*****MOVE SPACE TO W-COL.                                         D.090909
006900*****MOVE SPACE TO W-SZ.                                          D.090909
006910*****MOVE SPACE TO CODE-KEY.                                      D.090909
006920*****MOVE ZERO TO CODE-TCD.                                       D.090909
006930*****IF W-HKC = 1 OR 2                                            D.090909
006940*****    MOVE TDNA-JAN TO CODE-JAN                                D.090909
006950*****  ELSE                                                       D.090909
006960*****    MOVE TDNAR-JAN TO CODE-JAN.                              D.090909
006970*****START CODEF KEY NOT < CODE-KEY INVALID KEY                   D.090909
006980*****    DISPLAY E-ME6 E-JAN E-ME99                               D.090909
006990*****    GO TO HNM-090.                                           D.090909
007000*****READ CODEF NEXT RECORD WITH UNLOCK AT END                    D.090909
007010*****    DISPLAY E-ME6 E-JAN E-ME99                               D.090909
007020*****    GO TO HNM-090.                                           D.090909
007030*****IF W-HKC = 1 OR 2                                            D.090909
007040*****    IF TDNA-JAN NOT = CODE-JAN                               D.090909
007050*****        DISPLAY E-ME6 E-JAN E-ME99                           D.090909
007060*****        GO TO HNM-090.                                       D.090909
007070*****IF W-HKC = 3                                                 D.090909
007080*****    IF TDNAR-JAN NOT = CODE-JAN                              D.090909
007090*****        DISPLAY E-ME6 E-JAN E-ME99                           D.090909
007100*****        GO TO HNM-090.                                       D.090909
007110*****MOVE CODE-HCD TO HI-KEY.                                     D.090909
007120*****READ HI-M WITH UNLOCK INVALID KEY                            D.090909
007130*****    DISPLAY E-ME7 E-HCD E-ME99                               D.090909
007140*****    GO TO HNM-090.                                           D.090909
007150*
007160*****MOVE SPACE TO W-AHNA W-COL.                                  D.090909
007170*****MOVE HI-NAME TO W-AHNA.                                      D.090909
007180*****MOVE ZERO TO CNT.                                            D.090909
007190*HNM-010.                                                         D.090909
007200*****ADD 1 TO CNT.                                                D.090909
007210*****IF CNT < 25                                                  D.090909
007220*****    IF W-HNA(CNT) NOT = SPACE                                D.090909
007230*****        GO TO HNM-010.                                       D.090909
007240*****ADD 1 TO CNT.                                                D.090909
007250*****IF CNT < 25                                                  D.090909
007260*****    IF W-HNA(CNT) NOT = SPACE                                D.090909
007270*****        GO TO HNM-010.                                       D.090909
007280*HNM-020.                                                         D.090909
007290*****ADD 1 TO CNT.                                                D.090909
007300*****IF CNT > 24                                                  D.090909
007310*****    GO TO HNM-040.                                           D.090909
007320*****IF W-HNA(CNT) = SPACE                                        D.090909
007330*****    GO TO HNM-020.                                           D.090909
007340*****MOVE ZERO TO CNTD.                                           D.090909
007350*HNM-030.                                                         D.090909
007360*****ADD 1 TO CNTD.                                               D.090909
007370*****IF CNTD > 4                                                  D.090909
007380*****    GO TO HNM-040.                                           D.090909
007390*****MOVE W-HNA(CNT) TO W-NA(CNTD).                               D.090909
007400*****ADD 1 TO CNT.                                                D.090909
007410*****IF CNT < 25                                                  D.090909
007420*****    GO TO HNM-030.                                           D.090909
007430*HNM-040.                                                         D.090909
007440*****MOVE 0 TO HI-S(4,10).                                        D.090909
007450*****IF HI-S(CODE-SIZ,CODE-SNO) = 0                               D.090909
007460*****    DISPLAY E-ME8 E-JAN E-HCD E-ME99                         D.090909
007470*****    GO TO HNM-090.                                           D.090909
007480*****MOVE W-SIZ(CODE-SIZ,CODE-SNO) TO W-SZ.                       D.090909
007490*****IF W-SZ = SPACE                                              D.090909
007500*****    DISPLAY E-ME8 E-JAN E-HCD E-ME99                         D.090909
007510*****    GO TO HNM-090.                                           D.090909
007520*****IF HI-HKB = 1                                                D.090909
007530*****    MOVE 5 TO W-SZH.                                         D.090909
007540*****GO TO HNM-EX.                                                D.090909
007550*HNM-090.                                                         D.090909
007560*****DISPLAY E-CL.                                                D.090909
007570*HNM-EX.                                                          D.090909
007580*****EXIT.                                                        D.090909
007590 MEI1-RTN.
007600     IF TDNA-TSC NOT = 0
007610         MOVE 1 TO W-TSC
007620         COMPUTE W-GKINS = TDNA-NSU * TDNA-GTN
007630         COMPUTE W-UKINS = TDNA-NSU * TDNA-UTN.
007640*
007650     MOVE SPACE TO W-PMO W-PMU.
007660*****MOVE SPACE TO W-MSB W-MB.                                    D.090727
007670     MOVE TDNA-DPM TO P-DPM.
007680     MOVE TDNA-CLS TO P-CLS.
007690     MOVE TDNA-MKH TO P-MKH.
007700     IF TDNA-TSC NOT = 0
007710         MOVE TDNA-NSU TO P-NSU
007720         MOVE W-GKINS TO P-GKINS
007730         MOVE W-UKINS TO P-UKINS
007740       ELSE                                                       I.090727
007750         MOVE TDNA-MSB TO P-MSB.                                  I.090727
007760*****    MOVE P-UKINS TO W-MSB.                                   D.090727
007770*****IF TDNA-MSB = SPACE                                          D.090727
007780*****    GO TO MEI1-030.                                          D.090727
007790*****IF TDNA-TSC = 0                                              D.090727
007800*****    MOVE TDNA-MSB TO P-MSB                                   D.090727
007810*****    GO TO MEI1-030.                                          D.090727
007820*****MOVE TDNA-MSB TO W-MB.                                       D.090727
007830*****MOVE ZERO TO CNT.                                            D.090727
007840*MEI1-010.                                                        D.090727
007850*****ADD 1 TO CNT.                                                D.090727
007860*****IF CNT > 10                                                  D.090727
007870*****    GO TO MEI1-030.                                          D.090727
007880*****IF W-MSBD(CNT) = SPACE                                       D.090727
007890*****    MOVE W-MBD(CNT) TO W-MSBD(CNT)                           D.090727
007900*****    GO TO MEI1-010.                                          D.090727
007910*****MOVE W-MSB TO P-MSB.                                         D.090727
007920*MEI1-030.                                                        D.090727
007930     MOVE TDNA-SHM TO P-SHM.
007940     MOVE TDNA-JAN TO P-JAN.
007950     MOVE TDNA-COR TO P-COL.                                      I.090909
007960     MOVE TDNA-SIZ TO P-SIZ.                                      I.090909
007970*****MOVE W-COL TO P-COL.                                         D.090909
007980*****MOVE W-SZ TO P-SIZ.                                          D.090909
007990     MOVE TDNA-TY TO P-TY.
008000     MOVE TDNA-SU TO P-SU.
008010     MOVE TDNA-GTN TO P-GTN.
008020     MOVE TDNA-GKIN TO P-GKIN.
008030     MOVE TDNA-UTN TO P-UTN.
008040     MOVE TDNA-UKIN TO P-UKIN.
008050*
008060     MOVE SPACE TO SP-R.
008070     MOVE W-PMO TO SP-R.
008080     WRITE SP-R.
008090     MOVE SPACE TO SP-R.
008100     MOVE W-PMU TO SP-R.
008110     WRITE SP-R.
008120     MOVE SPACE TO SP-R.
008130*
008140     SUBTRACT 2 FROM W-LC.
008150     ADD TDNA-SU TO WT-SU.
008160     ADD TDNA-GKIN TO WT-GKIN.
008170     ADD TDNA-UKIN TO WT-UKIN.
008180     IF TDNA-TSC = 0
008190         ADD TDNA-SU TO WT-NSU
008200         ADD TDNA-GKIN TO WT-TGKIN
008210         ADD TDNA-UKIN TO WT-TUKIN
008220         GO TO MEI1-EX.
008230     ADD TDNA-NSU TO WT-NSU.
008240     ADD W-GKINS TO WT-TGKIN.
008250     ADD W-UKINS TO WT-TUKIN.
008260*
008270     MOVE SPACE TO W-PMU.
008280     MOVE SPACE TO P-COL.
008290     IF TDNA-SU < 10
008300         MOVE "    =" TO P-SUV
008310       ELSE
008320         IF TDNA-SU < 100
008330             MOVE "   ==" TO P-SUV
008340           ELSE
008350             IF TDNA-SU < 1000
008360                 MOVE "  ===" TO P-SUV
008370               ELSE
008380                 IF TDNA-SU < 10000
008390                     MOVE " ====" TO P-SUV
008400                   ELSE
008410                     MOVE "=====" TO P-SUV.
008420     IF TDNA-GKIN < 1000
008430         MOVE "      ===" TO P-GKINV
008440       ELSE
008450         IF TDNA-GKIN < 10000
008460             MOVE "     ====" TO P-GKINV
008470           ELSE
008480             IF TDNA-GKIN < 100000
008490                 MOVE "    =====" TO P-GKINV
008500               ELSE
008510                 IF TDNA-GKIN < 1000000
008520                     MOVE "   ======" TO P-GKINV
008530                   ELSE
008540                     IF TDNA-GKIN < 10000000
008550                         MOVE "  =======" TO P-GKINV
008560                       ELSE
008570                         MOVE " ========" TO P-GKINV.
008580     IF TDNA-UKIN < 1000
008590         MOVE "      ===" TO P-UKINV
008600       ELSE
008610         IF TDNA-UKIN < 10000
008620             MOVE "     ====" TO P-UKINV
008630           ELSE
008640             IF TDNA-UKIN < 100000
008650                 MOVE "    =====" TO P-UKINV
008660               ELSE
008670                 IF TDNA-UKIN < 1000000
008680                     MOVE "   ======" TO P-UKINV
008690                   ELSE
008700                     IF TDNA-UKIN < 10000000
008710                         MOVE "  =======" TO P-UKINV
008720                       ELSE
008730                         MOVE " ========" TO P-UKINV.
008740     MOVE SPACE TO SP-R.
008750     MOVE W-PMU TO SP-R.
008760     WRITE SP-R AFTER 0.
008770     MOVE SPACE TO SP-R.
008780 MEI1-EX.
008790     EXIT.
008800 MEI2-RTN.
008810     IF TDNAR-TSC NOT = 0
008820         MOVE 1 TO W-TSC
008830         COMPUTE W-GKINS = TDNAR-NSU * TDNAR-GTN
008840         COMPUTE W-UKINS = TDNAR-NSU * TDNAR-UTN.
008850*
008860     MOVE SPACE TO W-PMO W-PMU.
008870*****MOVE SPACE TO W-MSB W-MB.                                    D.090727
008880     MOVE TDNAR-DPM TO P-DPM.
008890     MOVE TDNAR-CLS TO P-CLS.
008900     MOVE TDNAR-MKH TO P-MKH.
008910     IF TDNAR-TSC NOT = 0
008920         MOVE TDNAR-NSU TO P-NSU
008930         MOVE W-GKINS TO P-GKINS
008940         MOVE W-UKINS TO P-UKINS
008950       ELSE                                                       I.090727
008960         MOVE TDNAR-MSB TO P-MSB.                                 I.090727
008970*****    MOVE P-UKINS TO W-MSB.                                   D.090727
008980*****IF TDNAR-MSB = SPACE                                         D.090727
008990*****    GO TO MEI2-030.                                          D.090727
009000*****IF TDNAR-TSC = 0                                             D.090727
009010*****    MOVE TDNAR-MSB TO P-MSB                                  D.090727
009020*****    GO TO MEI2-030.                                          D.090727
009030*****MOVE TDNAR-MSB TO W-MB.                                      D.090727
009040*****MOVE ZERO TO CNT.                                            D.090727
009050*MEI2-010.                                                        D.090727
009060*****ADD 1 TO CNT.                                                D.090727
009070*****IF CNT > 10                                                  D.090727
009080*****    GO TO MEI2-030.                                          D.090727
009090*****IF W-MSBD(CNT) = SPACE                                       D.090727
009100*****    MOVE W-MBD(CNT) TO W-MSBD(CNT)                           D.090727
009110*****    GO TO MEI2-010.                                          D.090727
009120*****MOVE W-MSB TO P-MSB.                                         D.090727
009130*MEI2-030.                                                        D.090727
009140     MOVE TDNAR-SHM TO P-SHM.
009150     MOVE TDNAR-JAN TO P-JAN.
009160     MOVE TDNAR-COR TO P-COL.                                     I.090909
009170     MOVE TDNAR-SIZ TO P-SIZ.                                     I.090909
009180*****MOVE W-COL TO P-COL.                                         D.090909
009190*****MOVE W-SZ TO P-SIZ.                                          D.090909
009200     MOVE TDNAR-TY TO P-TY.
009210     MOVE TDNAR-SU TO P-SU.
009220     MOVE TDNAR-GTN TO P-GTN.
009230     MOVE TDNAR-GKIN TO P-GKIN.
009240     MOVE TDNAR-UTN TO P-UTN.
009250     MOVE TDNAR-UKIN TO P-UKIN.
009260*
009270     MOVE SPACE TO SP-R.
009280     MOVE W-PMO TO SP-R.
009290     WRITE SP-R.
009300     MOVE SPACE TO SP-R.
009310     MOVE W-PMU TO SP-R.
009320     WRITE SP-R.
009330     MOVE SPACE TO SP-R.
009340*
009350     SUBTRACT 2 FROM W-LC.
009360     ADD TDNAR-SU TO WT-SU.
009370     ADD TDNAR-GKIN TO WT-GKIN.
009380     ADD TDNAR-UKIN TO WT-UKIN.
009390     IF TDNAR-TSC = 0
009400         ADD TDNAR-SU TO WT-NSU
009410         ADD TDNAR-GKIN TO WT-TGKIN
009420         ADD TDNAR-UKIN TO WT-TUKIN
009430         GO TO MEI2-EX.
009440     ADD TDNAR-NSU TO WT-NSU.
009450     ADD W-GKINS TO WT-TGKIN.
009460     ADD W-UKINS TO WT-TUKIN.
009470*
009480     MOVE SPACE TO W-PMU.
009490     MOVE SPACE TO P-COL.
009500     IF TDNAR-SU < 10
009510         MOVE "    =" TO P-SUV
009520       ELSE
009530         IF TDNAR-SU < 100
009540             MOVE "   ==" TO P-SUV
009550           ELSE
009560             IF TDNAR-SU < 1000
009570                 MOVE "  ===" TO P-SUV
009580               ELSE
009590                 IF TDNAR-SU < 10000
009600                     MOVE " ====" TO P-SUV
009610                   ELSE
009620                     MOVE "=====" TO P-SUV.
009630     IF TDNAR-GKIN < 1000
009640         MOVE "      ===" TO P-GKINV
009650       ELSE
009660         IF TDNAR-GKIN < 10000
009670             MOVE "     ====" TO P-GKINV
009680           ELSE
009690             IF TDNAR-GKIN < 100000
009700                 MOVE "    =====" TO P-GKINV
009710               ELSE
009720                 IF TDNAR-GKIN < 1000000
009730                     MOVE "   ======" TO P-GKINV
009740                   ELSE
009750                     IF TDNAR-GKIN < 10000000
009760                         MOVE "  =======" TO P-GKINV
009770                       ELSE
009780                         MOVE " ========" TO P-GKINV.
009790     IF TDNAR-UKIN < 1000
009800         MOVE "      ===" TO P-UKINV
009810       ELSE
009820         IF TDNAR-UKIN < 10000
009830             MOVE "     ====" TO P-UKINV
009840           ELSE
009850             IF TDNAR-UKIN < 100000
009860                 MOVE "    =====" TO P-UKINV
009870               ELSE
009880                 IF TDNAR-UKIN < 1000000
009890                     MOVE "   ======" TO P-UKINV
009900                   ELSE
009910                     IF TDNAR-UKIN < 10000000
009920                         MOVE "  =======" TO P-UKINV
009930                       ELSE
009940                         MOVE " ========" TO P-UKINV.
009950     MOVE SPACE TO SP-R.
009960     MOVE W-PMU TO SP-R.
009970     WRITE SP-R AFTER 0.
009980     MOVE SPACE TO SP-R.
009990 MEI2-EX.
010000     EXIT.
010010 KEI-RTN.
010020     IF W-TSC = 1
010030         MOVE WT-NSU TO P-NSUT.
010040     SUBTRACT 1 FROM W-LC.
010050     MOVE SPACE TO SP-R.
010060     MOVE W-P11 TO SP-R.
010070     WRITE SP-R AFTER W-LC.
010080     MOVE SPACE TO SP-R.
010090*
010100     MOVE WT-SU TO P-SUT.
010110     MOVE WT-GKIN TO P-GKINT.
010120     MOVE WT-UKIN TO P-UKINT.
010130     MOVE SPACE TO SP-R.
010140     MOVE W-P12 TO SP-R.
010150     WRITE SP-R.
010160     MOVE SPACE TO SP-R.
010170     IF W-TSC NOT = 1
010180         GO TO KEI-010.
010190     MOVE SPACE TO W-P12.
010200     IF WT-SU < 10
010210         MOVE "    =" TO P-SUTV
010220       ELSE
010230         IF WT-SU < 100
010240             MOVE "   ==" TO P-SUTV
010250           ELSE
010260             IF WT-SU < 1000
010270                 MOVE "  ===" TO P-SUTV
010280               ELSE
010290                 IF WT-SU < 10000
010300                     MOVE " ====" TO P-SUTV
010310                   ELSE
010320                     MOVE "=====" TO P-SUTV.
010330     IF WT-GKIN < 1000
010340         MOVE "      ===" TO P-GKINTV
010350       ELSE
010360         IF WT-GKIN < 10000
010370             MOVE "     ====" TO P-GKINTV
010380           ELSE
010390             IF WT-GKIN < 100000
010400                 MOVE "    =====" TO P-GKINTV
010410               ELSE
010420                 IF WT-GKIN < 1000000
010430                     MOVE "   ======" TO P-GKINTV
010440                   ELSE
010450                     IF WT-GKIN < 10000000
010460                         MOVE "  =======" TO P-GKINTV
010470                       ELSE
010480                         MOVE " ========" TO P-GKINTV.
010490     IF WT-UKIN < 1000
010500         MOVE "      ===" TO P-UKINTV
010510       ELSE
010520         IF WT-UKIN < 10000
010530             MOVE "     ====" TO P-UKINTV
010540           ELSE
010550             IF WT-UKIN < 100000
010560                 MOVE "    =====" TO P-UKINTV
010570               ELSE
010580                 IF WT-UKIN < 1000000
010590                     MOVE "   ======" TO P-UKINTV
010600                   ELSE
010610                     IF WT-UKIN < 10000000
010620                         MOVE "  =======" TO P-UKINTV
010630                       ELSE
010640                         MOVE " ========" TO P-UKINTV.
010650     MOVE SPACE TO SP-R.
010660     MOVE W-P12 TO SP-R.
010670     WRITE SP-R AFTER 0.
010680     MOVE SPACE TO SP-R.
010690 KEI-010.
010700     MOVE SPACE TO SP-R.
010710     MOVE W-P13 TO SP-R.
010720     WRITE SP-R.
010730     MOVE SPACE TO SP-R.
010740     IF W-TSC = 1
010750         MOVE WT-TGKIN TO W-TGKINZ
010760         MOVE WT-TUKIN TO W-TUKINZ
010770         MOVE W-TGKINZ TO P-TGKIN
010780         MOVE W-TUKINZ TO P-TUKIN.
010790     MOVE W-P15 TO SP-R.
010800     WRITE SP-R AFTER 2.
010810     MOVE SPACE TO SP-R.
010820 KEI-EX.
010830     EXIT.
010840 REW-RTN.
010850     MOVE SPACE TO TDNA-KEY.
010860     MOVE W-STC TO TDNA-STC.
010870     MOVE W-DNO TO TDNA-DNO.
010880     START TDNAF KEY NOT < TDNA-KEY INVALID KEY
010890         MOVE 255 TO COMPLETION-CODE
010900         DISPLAY E-ME78 E-ME10 E-ME99
010910         GO TO REW-EX.
010920 REW-05.
010930     READ TDNAF NEXT RECORD AT END
010940         GO TO REW-EX.
010950     IF (TDNA-STC NOT = W-STC) OR (TDNA-DNO NOT = W-DNO)
010960         GO TO REW-EX.
010970     MOVE 9 TO TDNA-PC.
010980     REWRITE TDNA-R INVALID KEY
010990         MOVE 255 TO COMPLETION-CODE
011000         DISPLAY E-ME78 E-STAT E-ME11 E-ME99
011010         GO TO REW-EX.
011020     GO TO REW-05.
011030 REW-EX.
011040     EXIT.
011050 TST-RTN.
011060     IF W-POC = 0
011070         OPEN OUTPUT SP-F
011080         MOVE 1 TO W-POC
011090         MOVE SPACE TO W-P02 W-P03 W-P04 W-P05 W-PMO W-PMU
011100         MOVE SPACE TO W-P11 W-P12 W-P13 W-P15
011110         MOVE W-15K TO P-15K
011120         MOVE W-20K TO P-20K
011130         MOVE NC"áäê‘ÇøÇ·ÇÒñ{ï‹Å@" TO P-SNA
011140         MOVE NC"ÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÇmÅ@" TO P-TNA
011150         MOVE NC"ì˙êiÉSÉÄáäÅ@" TO P-NRN
011160         MOVE NC"â™éRésñkãÊç°î™íöñ⁄ÇPÇUÅ|ÇPÇV" TO P-NRA
011170         MOVE "TEL (086)243-2456" TO P-NRT
011180         MOVE NC"ÇmÇmÇmÇm" TO P-COL
011190         MOVE NC"î[ïiÉ]Å[ÉìÅ@" TO P-ZONM
011200         MOVE NC"Å@ÇXÇXÇXÇXÇXÇXÇXÇX" TO P-TGKIN P-TUKIN
011210         MOVE ALL "X" TO P-BI P-DPM P-CLS P-MKH P-SHM P-JAN
011220                         P-SIZ P-HNA P-ZON
011230         MOVE 99 TO P-DC
011240         MOVE 99999 TO P-NSU P-SU P-GTN P-UTN
011250*****    MOVE 999999 TO P-NNGP P-DNO P-THC P-NGPS P-SUT P-NSUT    D.100720
011260*****    MOVE 9999999 TO P-STC                                    D.100720
011270*****    MOVE 999999 TO P-NNGP P-THC P-NGPS P-SUT P-NSUT          D.100819
011280         MOVE 999999 TO P-NNGP P-THC P-HNGP P-NGPS P-SUT P-NSUT   I.100819
011290         MOVE 9999999 TO P-STC P-DNO                              I.100720
011300         MOVE 999999999 TO P-GKINS P-UKINS P-GKIN P-UKIN P-HNO
011310                           P-GKINT P-UKINT
011320       ELSE
011330         MOVE SPACE TO SP-R
011340         WRITE SP-R AFTER PAGE.
011350     MOVE SPACE TO SP-R.
011360     MOVE W-P02 TO SP-R.
011370     WRITE SP-R.
011380     MOVE SPACE TO SP-R.
011390     MOVE W-P03 TO SP-R.
011400     WRITE SP-R.
011410     MOVE SPACE TO SP-R.
011420     MOVE W-P04 TO SP-R.
011430     WRITE SP-R.
011440     MOVE SPACE TO SP-R.
011450     MOVE W-P05 TO SP-R.
011460     WRITE SP-R.
011470     MOVE SPACE TO SP-R.
011480     WRITE SP-R.
011490     MOVE ZERO TO W-LC.
011500 TST-05.
011510     MOVE SPACE TO SP-R.
011520     MOVE W-PMO TO SP-R.
011530     WRITE SP-R.
011540     MOVE SPACE TO SP-R.
011550     MOVE W-PMU TO SP-R.
011560     WRITE SP-R.
011570     MOVE SPACE TO SP-R.
011580     ADD 1 TO W-LC.
011590     IF W-LC < 9
011600         GO TO TST-05.
011610     MOVE SPACE TO SP-R.
011620     MOVE W-P11 TO SP-R.
011630     WRITE SP-R.
011640     MOVE SPACE TO SP-R.
011650     MOVE W-P12 TO SP-R.
011660     WRITE SP-R.
011670     MOVE SPACE TO SP-R.
011680     MOVE W-P13 TO SP-R.
011690     WRITE SP-R.
011700     MOVE SPACE TO SP-R.
011710     MOVE W-P15 TO SP-R.
011720     WRITE SP-R AFTER 2.
011730     MOVE SPACE TO SP-R.
011740 TST-EX.
011750     EXIT.
