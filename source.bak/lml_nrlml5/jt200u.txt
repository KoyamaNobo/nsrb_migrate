000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         JT200U.
000030******************************************************************
000040*    <<REMARKS>>                                                 *
000050*    FUNCTION.......  ì˙éüÅ@åJâz                                 *
000060*    AUTHOR.........  Y.KATOH                                    *
000070*    COMPILE MODE...  NORMAL                                     *
000080*    SCREEN.........  XXXXX                                      *
000090*    RELEASE DATE...  62/08/17         (REV.001)                 *
000100******************************************************************
000110 ENVIRONMENT             DIVISION.
000120 CONFIGURATION           SECTION.
000130 SOURCE-COMPUTER.        NEAC-SYSTEM100.
000140 OBJECT-COMPUTER.        NEAC-SYSTEM100.
000150 INPUT-OUTPUT            SECTION.
000160 FILE-CONTROL.
000170     COPY    LIBCSE.                                              I.980521
000180     SELECT  JSTR        ASSIGN        F01-MSD
000190                         ORGANIZATION  INDEXED
000200                         ACCESS        DYNAMIC
000210                         RECORD        JSTR-KEY
000220             FILE        STATUS        ERR-STAT.
000230*****SELECT  JSTF        ASSIGN        F02-MSD                    D.950404
000240*****                    ORGANIZATION  INDEXED                    D.950404
000250*****                    ACCESS        DYNAMIC                    D.950404
000260*****                    RECORD        JSTF-KEY                   D.950404
000270*****        FILE        STATUS        ERR-STAT.                  D.950404
000280*****SELECT  JTRN        ASSIGN        F03-MSD                    D.981126
000290*****                    ORGANIZATION  SEQUENTIAL                 D.981126
000300*****        FILE        STATUS        ERR-STAT.                  D.981126
000310*****SELECT  JNTR        ASSIGN        F04-MSD
000320*****                    ORGANIZATION  SEQUENTIAL
000330*****        FILE        STATUS        ERR-STAT.
000340     SELECT  JNIF        ASSIGN        F05-MSD
000350                         ORGANIZATION  INDEXED
000360                         ACCESS        DYNAMIC
000370                         RECORD        JNIF1-KEY
000380             FILE        STATUS        ERR-STAT.
000390     SELECT  OKJF        ASSIGN        F06-MSD
000400                         ORGANIZATION  INDEXED
000410                         ACCESS        DYNAMIC
000420                         RECORD        OKJF-KEY
000430             FILE        STATUS        ERR-STAT.
000440     SELECT  TDNWF       ASSIGN        F09-MSD                    I.040928
000450                         ORGANIZATION  INDEXED                    I.040928
000460                         ACCESS        DYNAMIC                    I.040928
000470                         RECORD        TDNW1-KEY                  I.040928
000480             FILE        STATUS        ERR-STAT.                  I.040928
000490     SELECT  TDNNF       ASSIGN        F10-MSD                    I.050129
000500                         ORGANIZATION  INDEXED                    I.050129
000510                         ACCESS        DYNAMIC                    I.050129
000520                         RECORD        TDNN1-KEY                  I.050129
000530             FILE        STATUS        ERR-STAT.                  I.050129
000540     SELECT  TDIF        ASSIGN        F16-MSD                    I.080328
000550                         ORGANIZATION  INDEXED                    I.080328
000560                         ACCESS        DYNAMIC                    I.080328
000570                         RECORD        TDI-KEY                    I.080328
000580             FILE        STATUS        ERR-STAT.                  I.080328
000590     SELECT  TDNAF       ASSIGN        F21-MSD                    I.090909
000600                         ORGANIZATION  INDEXED                    I.090909
000610                         ACCESS        DYNAMIC                    I.090909
000620                         RECORD        TDNA-KEY                   I.090909
000630             FILE        STATUS        ERR-STAT.                  I.090909
000640     SELECT  TC-M        ASSIGN        F07-MSD                    I.900515
000650                         ORGANIZATION  INDEXED
000660                         ACCESS        DYNAMIC
000670                         RECORD        TC-KEY
000680             FILE        STATUS        ERR-STAT.
000690     SELECT  JT-DNKN     ASSIGN        F08-MSD                    I.900515
000700                         ORGANIZATION  INDEXED
000710                         ACCESS        DYNAMIC
000720                         RECORD        DNKN-KEY
000730             FILE        STATUS        ERR-STAT.
000740     SELECT   NSURYOF  ASSIGN  TO      NSURYO-MSD                 I.140916
000750                       FILE    STATUS  ERR-STAT.                  I.140916
000760     SELECT   NHAKOF   ASSIGN  TO      NHAKO-MSD                  I.140916
000770                       FILE    STATUS  ERR-STAT.                  I.140916
000780     SELECT   TEISEIF ASSIGN  TO       TEISEI-MSD                 I.150429
000790                       FILE    STATUS  ERR-STAT.                  I.150429
000800     SELECT  JSTRRF      ASSIGN        F11-MSD                    I.970923
000810             FILE        STATUS        ERR-STAT.                  I.970923
000820     SELECT  OKJRF       ASSIGN        F12-MSD                    I.030317
000830             FILE        STATUS        ERR-STAT.                  I.030317
000840     SELECT  JNIRF       ASSIGN        F13-MSD                    I.030317
000850             FILE        STATUS        ERR-STAT.                  I.030317
000860     SELECT  TDNWRF      ASSIGN        F14-MSD                    I.040928
000870             FILE        STATUS        ERR-STAT.                  I.040928
000880     SELECT  TDNNRF      ASSIGN        F15-MSD                    I.050129
000890             FILE        STATUS        ERR-STAT.                  I.050129
000900     SELECT  TDIRF       ASSIGN        F17-MSD                    I.080328
000910             FILE        STATUS        ERR-STAT.                  I.080328
000920     SELECT  TDNARF      ASSIGN        F22-MSD                    I.090909
000930             FILE        STATUS        ERR-STAT.                  I.090909
000940     SELECT   NSURYORF ASSIGN  TO      NSURYOR-MSD                I.140916
000950                       FILE    STATUS  ERR-STAT.                  I.140916
000960     SELECT   NHAKORF  ASSIGN  TO      NHAKOR-MSD                 I.140916
000970                       FILE    STATUS  ERR-STAT.                  I.140916
000980     SELECT   TEISEIRF ASSIGN  TO      TEISEIR-MSD                I.150429
000990                       FILE    STATUS  ERR-STAT.                  I.150429
001000 I-O-CONTROL.
001010*****APPLY  EXCLUSIVE-MODE  ON  JSTR    JTRN  JNIF                D.981126
001020*****APPLY  EXCLUSIVE-MODE  ON  JSTR    JNIF                      D.040928
001030*****APPLY  EXCLUSIVE-MODE  ON  JSTR    JNIF  OKJF  TDNWF         D.050129
001040     APPLY  EXCLUSIVE-MODE  ON  JSTR    JNIF  OKJF  TDNWF  TDNNF  I.050129
001050                                TDIF    TDNAF                     I.090909
001060*****                                                      TDIF   D.090909
001070     APPLY  SHARED-MODE     ON  M-DATE  TC-M  JT-DNKN.            I.980521
001080*****APPLY  EXCLUSIVE-MODE  ON  JSTR  JSTF  JTRN        JNIF      D.950404
001090*****APPLY  SHARED-MODE     ON  TC-M  JT-DNKN.                    D.980612
001100 DATA                DIVISION.
001110 FILE                SECTION.
001120     COPY  LIBFDD.                                                I.980521
001130 COPY  L-JSTR.
001140*COPY  L-JSTF.                                                    D.950404
001150*COPY  LJTRN.                                                     D.981126
001160*COPY  L-JNTR.
001170 COPY  L-JNIF.
001180 COPY  LOKJF.
001190 COPY  LITDNW.                                                    I.040928
001200 COPY  LITDNN.                                                    I.050129
001210 COPY  L-TDIF.                                                    I.080328
001220 COPY  LITDNA.                                                    I.090909
001230 COPY  LITCM.                                                     I.900515
001240 COPY  LTDNKN.
001250 COPY  LJSTRR.                                                    I.970923
001260*****   ÉiÉtÉRêîó ÉtÉ@ÉCÉã 45/5   ****************************************
001270 FD  NSURYOF                                                      I.140916
001280     BLOCK 5 RECORDS                                              I.140916
001290     LABEL RECORD IS STANDARD                                     I.140916
001300     VALUE OF IDENTIFICATION "NSURYOF".                           I.140916
001310 01  NSURYO-R.                                                    I.140916
001320     02  NSURYO-01      PIC 9(06).                                I.140916
001330     02  NSURYO-02      PIC 9(06).                                I.140916
001340     02  NSURYO-03      PIC 9(03).                                I.140916
001350     02  NSURYO-04      PIC 9(08).                                I.140916
001360     02  NSURYO-05      PIC 9(06).                                I.140916
001370     02  NSURYO-06      PIC 9(08).                                I.140916
001380     02  NSURYO-07      PIC 9(04).                                I.140916
001390     02  NSURYO-08      PIC 9(02).                                I.140916
001400     02  NSURYO-09      PIC 9(02).                                I.140916
001410*****   ÉiÉtÉRî†êîÉtÉ@ÉCÉã 36/7   ****************************************
001420 FD  NHAKOF                                                       I.140916
001430     BLOCK 7 RECORDS                                              I.140916
001440     LABEL RECORD IS STANDARD                                     I.140916
001450     VALUE OF IDENTIFICATION "NHAKOF".                            I.140916
001460 01  NHAKO-R.                                                     I.140916
001470     02  NHAKO-01       PIC 9(06).                                I.140916
001480     02  NHAKO-02       PIC 9(06).                                I.140916
001490     02  NHAKO-03       PIC 9(03).                                I.140916
001500     02  NHAKO-04       PIC 9(01).                                I.140916
001510     02  NHAKO-05       PIC 9(06).                                I.140916
001520     02  NHAKO-06       PIC 9(08).                                I.140916
001530     02  NHAKO-07       PIC 9(04).                                I.140916
001540     02  NHAKO-08       PIC 9(02).                                I.140916
001550*****   ÉiÉtÉRêîó í˘ê≥ÉtÉ@ÉCÉã 102/5  ************************************
001560 FD  TEISEIF                                                      I.150429
001570     BLOCK 5 RECORDS                                              I.150429
001580     LABEL RECORD IS STANDARD                                     I.150429
001590     VALUE OF IDENTIFICATION "NTEISEIF".                          I.150429
001600 01  TEISEI-R.                                                    I.150429
001610     02  TEISEI-01      PIC 9(06).                                I.150429
001620     02  TEISEI-02      PIC 9(06).                                I.150429
001630     02  TEISEI-03      PIC 9(03).                                I.150429
001640     02  TEISEI-04      PIC 9(08).                                I.150429
001650     02  TEISEI-05      PIC 9(05).                                I.150429
001660     02  TEISEI-051     PIC 9(01).                                I.150429
001670     02  TEISEI-06      PIC 9(08).                                I.150429
001680     02  TEISEI-07      PIC 9(04).                                I.150429
001690     02  TEISEI-08      PIC 9(02).                                I.150429
001700     02  TEISEI-09      PIC 9(02).                                I.150429
001710     02  TEISEI-21      PIC X(25).                                I.150429
001720     02  TEISEI-22      PIC X(24).                                I.150429
001730     02  TEISEI-23      PIC X(08).                                I.150429
001740 FD  OKJRF                                                        I.030317
001750     BLOCK    4     RECORDS                                       I.030317
001760     LABEL    RECORD   STANDARD                                   I.030317
001770     VALUE    OF  IDENTIFICATION  "OKJRF".                        I.030317
001780 01  OKJR-R.                                                      I.030317
001790     02  OKJR-D                PIC X(56).                         I.041215
001800*****02  OKJR-D                PIC X(51).                         D.041215
001810*****02  F                     PIC X(05).                         D.041215
001820     02  OKJR-DATE             PIC 9(08).                         I.030317
001830 FD  JNIRF                                                        I.030317
001840     BLOCK    3     RECORDS                                       I.030317
001850     LABEL    RECORD   STANDARD                                   I.030317
001860     VALUE    OF  IDENTIFICATION  "JNIRF".                        I.030317
001870 01  JNIR-R.                                                      I.030317
001880     02  JNIR-D                PIC X(128).                        I.030317
001890     02  F                     PIC X(34).                         I.030317
001900     02  JNIR-DATE             PIC 9(08).                         I.030317
001910 FD  TDNWRF                                                       I.040928
001920     BLOCK    1     RECORDS                                       I.040928
001930     LABEL    RECORD   STANDARD                                   I.040928
001940     VALUE    OF  IDENTIFICATION  "TDNWRF".                       I.040928
001950 01  TDNWR-R.                                                     I.040928
001960     02  F                     PIC X(247).                        I.040928
001970     02  TDNWR-DATE            PIC 9(08).                         I.040928
001980     02  F                     PIC X(01).                         I.040928
001990 FD  TDNNRF                                                       I.050129
002000*****BLOCK    1     RECORDS                                       D.070228
002010     BLOCK    3     RECORDS                                       I.070228
002020     LABEL    RECORD   STANDARD                                   I.050129
002030     VALUE    OF  IDENTIFICATION  "TDNNRF".                       I.050129
002040 01  TDNNR-R.                                                     I.050129
002050*****02  F                     PIC X(247).                        D.070228
002060     02  TDNNR-D               PIC X(256).                        I.070228
002070     02  TDNNR-DATE            PIC 9(08).                         I.050129
002080     02  F                     PIC X(77).                         I.070228
002090*****02  F                     PIC X(01).                         D.070228
002100 FD  TDIRF                                                        I.080328
002110*****BLOCK    4     RECORDS                                       D.100922
002120     BLOCK    1     RECORDS                                       D.100922
002130     LABEL    RECORD   STANDARD                                   I.080328
002140     VALUE    OF  IDENTIFICATION  "TDIRF".                        I.080328
002150 01  TDIR-R.                                                      I.080328
002160*****02  TDIR-D                PIC X(170).                        D.100922
002170     02  F                     PIC X(246).                        D.100922
002180     02  TDIR-DATE             PIC 9(08).                         I.080328
002190     02  F                     PIC X(2).                          D.100922
002200*****02  F                     PIC X(14).                         D.100922
002210 FD  TDNARF                                                       I.090909
002220     BLOCK    1     RECORDS                                       I.090909
002230     LABEL    RECORD   STANDARD                                   I.090909
002240     VALUE    OF  IDENTIFICATION  "TDNARF".                       I.090909
002250 01  TDNAR-R.                                                     I.090909
002260     02  F                     PIC X(246).                        I.090909
002270     02  TDNAR-DATE            PIC 9(08).                         I.090909
002280     02  F                     PIC X(02).                         I.090909
002290*****   ÉiÉtÉRêîó ó›êœÉtÉ@ÉCÉã 53/4   ************************************
002300 FD  NSURYORF                                                     I.140916
002310     BLOCK 4 RECORDS                                              I.140916
002320     LABEL RECORD IS STANDARD                                     I.140916
002330     VALUE OF IDENTIFICATION "NSURYORF".                          I.140916
002340 01  NSURYOR-R.                                                   I.140916
002350     02  NSURYOR-01     PIC 9(06).                                I.140916
002360     02  NSURYOR-02     PIC 9(06).                                I.140916
002370     02  NSURYOR-03     PIC 9(03).                                I.140916
002380     02  NSURYOR-04     PIC 9(08).                                I.140916
002390     02  NSURYOR-05     PIC 9(06).                                I.140916
002400     02  NSURYOR-06     PIC 9(08).                                I.140916
002410     02  NSURYOR-07     PIC 9(04).                                I.140916
002420     02  NSURYOR-08     PIC 9(02).                                I.140916
002430     02  NSURYOR-09     PIC 9(02).                                I.140916
002440     02  NSURYOR-10     PIC 9(08).                                I.140916
002450*****   ÉiÉtÉRî†êîó›êœÉtÉ@ÉCÉã 44/5   ************************************
002460 FD  NHAKORF                                                      I.140916
002470     BLOCK 8 RECORDS                                              I.140916
002480     LABEL RECORD IS STANDARD                                     I.140916
002490     VALUE OF IDENTIFICATION "NHAKORF".                           I.140916
002500 01  NHAKOR-R.                                                    I.140916
002510     02  NHAKOR-01      PIC 9(06).                                I.140916
002520     02  NHAKOR-02      PIC 9(06).                                I.140916
002530     02  NHAKOR-03      PIC 9(03).                                I.140916
002540     02  NHAKOR-04      PIC 9(01).                                I.140916
002550     02  NHAKOR-05      PIC 9(06).                                I.140916
002560     02  NHAKOR-06      PIC 9(08).                                I.140916
002570     02  NHAKOR-07      PIC 9(04).                                I.140916
002580     02  NHAKOR-08      PIC 9(02).                                I.140916
002590     02  NHAKOR-10      PIC 9(08).                                I.140916
002600*****   ÉiÉtÉRêîó í˘ê≥ÉtÉ@ÉCÉã 128/2  ************************************
002610 FD  TEISEIRF                                                     I.150429
002620     BLOCK 2 RECORDS                                              I.150429
002630     LABEL RECORD IS STANDARD                                     I.150429
002640     VALUE OF IDENTIFICATION "NTEISEIRF".                         I.150429
002650 01  TEISEIR-R.                                                   I.150429
002660     02  TEISEIR-01     PIC 9(06).                                I.150429
002670     02  TEISEIR-02     PIC 9(06).                                I.150429
002680     02  TEISEIR-03     PIC 9(03).                                I.150429
002690     02  TEISEIR-04     PIC 9(08).                                I.150429
002700     02  TEISEIR-05     PIC 9(05).                                I.150429
002710     02  TEISEIR-051    PIC 9(01).                                I.150429
002720     02  TEISEIR-06     PIC 9(08).                                I.150429
002730     02  TEISEIR-07     PIC 9(04).                                I.150429
002740     02  TEISEIR-08     PIC 9(02).                                I.150429
002750     02  TEISEIR-09     PIC 9(02).                                I.150429
002760     02  TEISEIR-21     PIC X(25).                                I.150429
002770     02  TEISEIR-22     PIC X(24).                                I.150429
002780     02  TEISEIR-23     PIC X(08).                                I.150429
002790     02  F              PIC X(18).                                I.150429
002800     02  TEISEIR-10     PIC 9(08).                                I.150429
002810 WORKING-STORAGE     SECTION.
002820 77  ERR-STAT             PIC  X(02).
002830 77  W-FILE               PIC  X(13).                             I.140916
002840 77  ERR-SW               PIC  9(01)  VALUE  0.                   I.900410
002850 77  WJSTR-KEY            PIC  X(07).
002860 77  WJSTR-01             PIC  X(06).                             A621008
002870 77  SEN-SW               PIC  9(01).                             I.980908
002880 01  W-DATA.                                                      I.980521
002890     02  W-DATE.                                                  I.980521
002900       03  W-NEN          PIC  9(04).                             I.980521
002910       03  W-NENL  REDEFINES W-NEN.                               I.980521
002920         04  W-NEN1       PIC  9(02).                             I.980521
002930         04  W-NEN2       PIC  9(02).                             I.980521
002940       03  W-GP           PIC  9(04).                             I.980521
002950     02  W-DATEL REDEFINES W-DATE.                                I.980521
002960       03  F              PIC  9(02).                             I.980521
002970       03  W-DATES        PIC  9(06).                             I.980521
002980     02  W-NGP            PIC  9(08).                             I.060706
002990*77  W-DATE               PIC  9(06).                             D.980521
003000*77  WJSTF-KEY            PIC  X(09).                             D.970923
003010*
003020 COPY  LWMSG.
003030 SCREEN              SECTION.
003040 SD  CRT-X
003050     END  STATUS     ESTAT.
003060 01  DSP-CLEAR.
003070     02  CLR-GMN     LINE  1   CLEAR  SCREEN.
003080 01  DSP-MIDAS.
003090     02  LINE   1    COLUMN  25       VALUE
003100       " ì˙ éü åJ âz "                REVERSE.
003110 01  C-ERR.                                                       I.140916
003120     02  LINE  24.                                                I.140916
003130       03  E-ME1   COLUMN  10  PIC  X(27) VALUE                   I.140916
003140            "***  NSURYORF WRITE¥◊∞  ***".                        I.140916
003150       03  E-ME2   COLUMN  10  PIC  X(26) VALUE                   I.140916
003160            "***  NHAKORF WRITE¥◊∞  ***".                         I.140916
003170 COPY  LSMSG.
003180     COPY  LIBSCR.                                                I.980521
003190     COPY  LSSEM.                                                 I.140916
003200 PROCEDURE           DIVISION.
003210******************************************************************
003220*                    ÇlÇ`ÇhÇmÅ|ÇqÇsÇm                            *
003230******************************************************************
003240 MAIN-RTN.
003250     DISPLAY   CLR-GMN  DSP-MIDAS.
003260     MOVE  ZERO         TO  W-DATE.                               I.980521
003270     ACCEPT    W-DATES  FROM  DATE.                               I.980521
003280     COPY  LIBCPR.                                                I.980521
003290     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.980521
003300         ADD DATE-NC1 TO W-NEN.                                   I.980521
003310     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.980521
003320         ADD DATE-NC2 TO W-NEN.                                   I.980521
003330     PERFORM   DATE-RTN     THRU         DATE-EX.                 I.060706
003340*****ACCEPT    W-DATE   FROM  DATE.                               D.980521
003350     PERFORM   OPEN-RTN     THRU         OPEN-EX.
003360     PERFORM   JSTR-RTN     THRU         JSTR-EX.
003370*****PERFORM   JSTF-RTN     THRU         JSTF-EX.                 D.950404
003380     PERFORM   OKJF-RTN     THRU         OKJF-EX.
003390     PERFORM   JNIF-RTN     THRU         JNIF-EX.
003400     PERFORM   TDNW-RTN     THRU         TDNW-EX.                 I.040928
003410     PERFORM   TDNN-RTN     THRU         TDNN-EX.                 I.050129
003420     PERFORM   TDI-RTN      THRU         TDI-EX.                  I.080328
003430     PERFORM   TDNA-RTN     THRU         TDNA-EX.                 I.090909
003440     PERFORM   NSUR-RTN     THRU         NSUR-EX.                 I.140916
003450     PERFORM   NHAK-RTN     THRU         NHAK-EX.                 I.140916
003460     PERFORM   NTEI-RTN     THRU         NTEI-EX.                 I.150429
003470     PERFORM   END-RTN      THRU         END-EX.
003480     STOP      RUN.
003490******************************************************************
003500*                    ÇcÇ`ÇsÇdÅ|ÇqÇsÇm                            *
003510******************************************************************
003520 DATE-RTN.                                                        I.060706
003530     MOVE    ZERO      TO  W-NGP.                                 I.060706
003540     OPEN  INPUT       JSTR.                                      I.060706
003550 DATE-010.                                                        I.060706
003560     READ      JSTR         NEXT               AT  END            I.060706
003570               GO    TO     DATE-090.                             I.060706
003580     IF    JSTR-17  NOT =  1                GO  TO  DATE-010.     I.060706
003590     IF    JSTR-05      >  W-NGP                                  I.060706
003600           MOVE    JSTR-05   TO  W-NGP.                           I.060706
003610     GO      TO       DATE-010.                                   I.060706
003620 DATE-090.                                                        I.060706
003630     CLOSE  JSTR.                                                 I.060706
003640     IF    W-NGP    NOT =  ZERO                                   I.060706
003650           MOVE    W-NGP     TO  W-DATE.                          I.060706
003660 DATE-EX.                                                         I.060706
003670     EXIT.                                                        I.060706
003680******************************************************************
003690*                    ÇnÇoÇdÇmÅ|ÇqÇsÇm                            *
003700******************************************************************
003710 OPEN-RTN.
003720*****OPEN  I-O       JSTR  JSTF  OKJF  JNIF                       D.950404
003730*****OPEN  I-O       JSTR        OKJF  JNIF                       D.040928
003740*****OPEN  I-O       JSTR        OKJF  JNIF  TDNWF                D.050129
003750*****OPEN  I-O       JSTR        OKJF  JNIF  TDNWF  TDNNF         D.080328
003760     OPEN  I-O       JSTR        OKJF  JNIF  TDNWF  TDNNF  TDIF   I.080328
003770           I-O       TDNAF TC-M  JT-DNKN                          I.090909
003780*****      INPUT     NSURYOF  NHAKOF                              D.150429
003790           INPUT     NSURYOF  NHAKOF  TEISEIF                     I.150429
003800           EXTEND    JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF  TDIRF  I.090909
003810           EXTEND    TDNARF  NSURYORF  NHAKORF  TEISEIRF.         I.150429
003820*****      EXTEND    TDNARF  NSURYORF  NHAKORF.                   D.150429
003830*****      EXTEND    TDNARF.                                      D.140916
003840*****      I-O       TC-M  JT-DNKN                                D.090909
003850*****      EXTEND    JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF  TDIRF. D.090909
003860*****      EXTEND    JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF.        D.080328
003870*****      EXTEND    JSTRRF  OKJRF  JNIRF  TDNWRF.                D.050129
003880*****      EXTEND    JSTRRF  OKJRF  JNIRF.                        D.040928
003890*****      EXTEND    JSTRRF.                                      D.030317
003900*****      EXTEND    JSTRRF                                       D.981126
003910*****      OUTPUT    JTRN.                                        D.981126
003920 OPEN-EX.
003930     EXIT.
003940******************************************************************
003950*                    ÇiÇrÇsÇqÅ|ÇqÇsÇm                            *
003960******************************************************************
003970 JSTR-RTN.
003980     MOVE  ZERO    TO  WJSTR-01.
003990 JST-010.
004000     READ  JSTR     NEXT  AT  END           GO  TO  JSTR-EX.
004010*****IF    JSTR-17  NOT =  1                GO  TO  JST-010.      D.980629
004020     IF    JSTR-17  NOT =  1                GO  TO  JST-015.      I.980629
004030     IF    JSTR-01      =  WJSTR-01         GO  TO  JST-020.
004040***** íºëóêÊÉ}ÉXÉ^ çXêV
004050     MOVE  JSTR-06  TO  TC-KEY ERR-K.
004060     READ  TC-M     INVALID                 GO  TO  JST-020.
004070*****MOVE  JSTR-05  TO  TC-YMD.                                   D.980521
004080     MOVE  JSTR-05S TO  TC-YMD.                                   I.980521
004090     REWRITE  TC-R  INVALID
004100              MOVE  "R"           TO  ERR-M
004110              MOVE  "TC-M"        TO  ERR-F
004120              PERFORM  ERR-RTN  THRU  ERR-EX.
004130     GO  TO  JST-020.                                             I.980629
004140 JST-015.                                                         I.980629
004150     IF  JSTR-4021   =  SPACE                  GO  TO  JST-010.   I.980629
004160     MOVE    SPACE     TO  JSTR-4021.                             I.980629
004170     MOVE    ZERO      TO  JSTR-4022  JSTR-4023.                  I.980629
004180     REWRITE   JSTR-R  INVALID                                    I.980629
004190             MOVE  "R"           TO  ERR-M                        I.980629
004200             MOVE  "JSTR"        TO  ERR-F                        I.980629
004210             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.980629
004220     GO  TO  JST-010.                                             I.980629
004230 JST-020.
004240***** ì`ï[áÇåüçıÉtÉ@ÉCÉã çXêV
004250     MOVE  JSTR-07  TO  DNKN-01.
004260     MOVE  JSTR-09  TO  DNKN-02.
004270     MOVE  3        TO  DNKN-03.
004280     MOVE  JSTR-01  TO  DNKN-041.
004290     MOVE  JSTR-02  TO  DNKN-042.
004300     READ  JT-DNKN  INVALID                 GO  TO  JST-030.
004310     MOVE  DNKN-KEY TO  ERR-K.
004320     DELETE  JT-DNKN  INVALID
004330             MOVE     "D"        TO  ERR-M
004340             MOVE     "JT-DNKN"  TO  ERR-F
004350             PERFORM  ERR-RTN  THRU  ERR-EX.
004360*****CALL    "CBLTCLS"  USING  JT-DNKN.                           D.970923
004370 JST-030.
004380     INITIALIZE   JSTRR-R.                                        I.970923
004390     MOVE    JSTR-R    TO  JSTRR-R.                               I.970923
004400     MOVE    W-DATE    TO  JSTRR-90.                              I.970923
004410     WRITE   JSTRR-R.                                             I.970923
004420     IF ERR-STAT NOT = "00"                                       I.970923
004430             MOVE  "A"           TO  ERR-M                        I.970923
004440             MOVE  "JSTRRF"      TO  ERR-F                        I.970923
004450             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.970923
004460*
004470     MOVE    JSTR-KEY  TO  ERR-K.
004480     MOVE    JSTR-01   TO  WJSTR-01.
004490     DELETE  JSTR  INVALID
004500             MOVE  "D"           TO  ERR-M
004510             MOVE  "JSTR"        TO  ERR-F
004520             PERFORM  ERR-RTN  THRU  ERR-EX.
004530*****CALL    "CBLTCLS"  USING  JSTR.                              D.970923
004540     GO  TO  JST-010.                                             R621008
004550 JSTR-EX.
004560     EXIT.
004570******************************************************************
004580*                    ÇiÇrÇsÇeÅ|ÇqÇsÇm                            *
004590******************************************************************
004600*JSTF-RTN.                                                        D.950404
004610*****READ      JSTF         NEXT               AT  END            D.950404
004620*****          GO    TO     JSTF-EX.                              D.950404
004630*****MOVE      ZERO         TO   JSTF-041.                        D.950404
004640*****MOVE  JSTF-KEY  TO  WJSTF-KEY.                               D.950404
004650*****REWRITE   JSTF-R              INVALID                        D.950404
004660*****          MOVE  "R"           TO  ERR-M                      D.950404
004670*****          MOVE  "JSTF"        TO  ERR-F                      D.950404
004680*****          MOVE  WJSTF-KEY     TO  ERR-K                      D.950404
004690*****          PERFORM  ERR-RTN    THRU  ERR-EX.                  D.950404
004700*****GO    TO    JSTF-RTN.                                        D.950404
004710*JSTF-EX.                                                         D.950404
004720*****EXIT.                                                        D.950404
004730******************************************************************
004740*                    ÇnÇjÇiÇeÅ|ÇqÇsÇm          1988.09.22        *
004750******************************************************************
004760 OKJF-RTN.
004770     READ      OKJF         NEXT               AT  END
004780               GO    TO     OKJF-EX.
004790*****IF   (OKJF-02        =   9)      AND                         â^ëóã∆é“
004800*****IF   (OKJF-10        =   1)                                  D.930803
004810*****                         GO      TO       OKJF-DEL.          D.930803
004820*
004830*****IF    OKJF-08        =   1                                   D.930803
004840     IF    OKJF-02        =   9                                   I.930803
004850                              GO      TO       OKJF-DEL.
004860     IF   (OKJF-10        =   1)      AND                         I.930803
004870          (OKJF-08        =   1)                                  I.930803
004880                              GO      TO       OKJF-DEL.          I.930803
004890*
004900     IF   (OKJF-07        <   1)      AND                         å¬êî
004910          (OKJF-10        =   1)                                  çXêVª≤›
004920                              GO      TO       OKJF-DEL.
004930*
004940     IF    OKJF-10    NOT =   0                                   I.980908
004950                              GO      TO       OKJF-RTN.          I.980908
004960     PERFORM   SEN-RTN      THRU         SEN-EX.                  I.980908
004970     IF    SEN-SW         =   0                                   I.980908
004980                              GO      TO       OKJF-DEL.          I.980908
004990*
005000     GO      TO       OKJF-RTN.
005010 OKJF-DEL.
005020     INITIALIZE   OKJR-R.                                         I.030317
005030     MOVE    OKJF-R    TO  OKJR-D.                                I.030317
005040     MOVE    W-DATE    TO  OKJR-DATE.                             I.030317
005050     WRITE   OKJR-R.                                              I.030317
005060     IF ERR-STAT NOT = "00"                                       I.030317
005070             MOVE  "A"           TO  ERR-M                        I.030317
005080             MOVE  "OKJRF"       TO  ERR-F                        I.030317
005090             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.030317
005100*
005110     MOVE  OKJF-KEY   TO  ERR-K.
005120     DELETE    OKJF   INVALID
005130               MOVE  "D"           TO  ERR-M
005140               MOVE  "OKJF"        TO  ERR-F
005150               PERFORM  ERR-RTN    THRU  ERR-EX.
005160*****CALL      "CBLTCLS"    USING        OKJF.                    D.970923
005170     GO    TO   OKJF-RTN.
005180 OKJF-EX.
005190     EXIT.
005200******************************************************************
005210*                    ÇiÇmÇhÇeÅ|ÇqÇsÇm          1991.11.11        *
005220******************************************************************
005230 JNIF-RTN.
005240     READ      JNIF         NEXT               AT  END
005250               GO    TO     JNIF-EX.
005260     IF  JNIF1-02     <     7
005270*****    AND  ( JNIF1-10   =   1  AND  JNIF1-12  =  1 )           D.950404
005280         AND    JNIF1-10   =   1                                  I.950404
005290                            GO  TO  JNIF-DEL
005300     ELSE
005310         IF  JNIF1-02     =     7
005320*****        AND  ( JNIF2-04   =   1  AND  JNIF2-06  =  1 )       D.950404
005330             AND    JNIF2-04   =   1                              I.950404
005340                            GO  TO  JNIF-DEL.
005350*
005360     GO      TO       JNIF-RTN.
005370 JNIF-DEL.
005380     INITIALIZE   JNIR-R.                                         I.030317
005390     MOVE    JNIF1-R   TO  JNIR-D.                                I.030317
005400     MOVE    W-DATE    TO  JNIR-DATE.                             I.030317
005410     WRITE   JNIR-R.                                              I.030317
005420     IF ERR-STAT NOT = "00"                                       I.030317
005430             MOVE  "A"           TO  ERR-M                        I.030317
005440             MOVE  "JNIRF"       TO  ERR-F                        I.030317
005450             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.030317
005460*
005470     MOVE  JNIF1-KEY   TO  ERR-K.
005480     DELETE    JNIF   INVALID
005490               MOVE  "D"           TO  ERR-M
005500               MOVE  "JNIF"        TO  ERR-F
005510               PERFORM  ERR-RTN    THRU  ERR-EX.
005520*****CALL      "CBLTCLS"    USING        JNIF.                    D.970923
005530     GO    TO   JNIF-RTN.
005540 JNIF-EX.
005550     EXIT.
005560******************************************************************
005570 TDNW-RTN.                                                        I.040928
005580     READ      TDNWF        NEXT               AT  END            I.040928
005590               GO    TO     TDNW-EX.                              I.040928
005600     IF  TDNW1-PC     =     9                                     I.040928
005610         IF  TDNW1-HC     =     1                                 I.080509
005620                            GO  TO  TDNW-DEL.                     I.040928
005630     GO      TO       TDNW-RTN.                                   I.040928
005640 TDNW-DEL.                                                        I.040928
005650     INITIALIZE   TDNWR-R.                                        I.040928
005660     MOVE    TDNW-R1   TO  TDNWR-R.                               I.040928
005670     MOVE    W-DATE    TO  TDNWR-DATE.                            I.040928
005680     WRITE   TDNWR-R.                                             I.040928
005690     IF ERR-STAT NOT = "00"                                       I.040928
005700             MOVE  "A"           TO  ERR-M                        I.040928
005710             MOVE  "TDNWRF"      TO  ERR-F                        I.040928
005720             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.040928
005730*
005740     MOVE  TDNW1-KEY   TO  ERR-K.                                 I.040928
005750     DELETE    TDNWF  INVALID                                     I.040928
005760               MOVE  "D"           TO  ERR-M                      I.040928
005770               MOVE  "TDNWF"       TO  ERR-F                      I.040928
005780               PERFORM  ERR-RTN    THRU  ERR-EX.                  I.040928
005790     GO    TO   TDNW-RTN.                                         I.040928
005800 TDNW-EX.                                                         I.040928
005810     EXIT.                                                        I.040928
005820 TDNN-RTN.                                                        I.050129
005830     READ      TDNNF        NEXT               AT  END            I.050129
005840               GO    TO     TDNN-EX.                              I.050129
005850     IF  TDNN1-PC     =     9                                     I.050129
005860         IF  TDNN1-HC     =     1                                 I.080509
005870                            GO  TO  TDNN-DEL.                     I.050129
005880     GO      TO       TDNN-RTN.                                   I.050129
005890 TDNN-DEL.                                                        I.050129
005900     INITIALIZE   TDNNR-R.                                        I.050129
005910*****MOVE    TDNN-R1   TO  TDNNR-R.                               D.070228
005920     MOVE    TDNN-R1   TO  TDNNR-D.                               I.070228
005930     MOVE    W-DATE    TO  TDNNR-DATE.                            I.050129
005940     WRITE   TDNNR-R.                                             I.050129
005950     IF ERR-STAT NOT = "00"                                       I.050129
005960             MOVE  "A"           TO  ERR-M                        I.050129
005970             MOVE  "TDNNRF"      TO  ERR-F                        I.050129
005980             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.050129
005990*
006000     MOVE  TDNN1-KEY   TO  ERR-K.                                 I.050129
006010     DELETE    TDNNF  INVALID                                     I.050129
006020               MOVE  "D"           TO  ERR-M                      I.050129
006030               MOVE  "TDNNF"       TO  ERR-F                      I.050129
006040               PERFORM  ERR-RTN    THRU  ERR-EX.                  I.050129
006050     GO    TO   TDNN-RTN.                                         I.050129
006060 TDNN-EX.                                                         I.050129
006070     EXIT.                                                        I.050129
006080 TDI-RTN.                                                         I.080328
006090     READ      TDIF         NEXT               AT  END            I.080328
006100               GO    TO     TDI-EX.                               I.080328
006110     IF  TDI-UPC      =     9                                     I.080328
006120                            GO  TO  TDI-DEL.                      I.080328
006130     IF  TDI-SOK      =     1                                     I.080702
006140         IF  TDI-PRC      =     9                                 I.080702
006150                                GO  TO  TDI-DEL.                  I.080702
006160     IF  TDI-TCD      =     6010                                  I.120314
006170         IF  TDI-PRC      =     9                                 I.120314
006180             IF  TDI-UPC      =     1                             I.120314
006190                                GO  TO  TDI-DEL.                  I.120314
006200     GO      TO       TDI-RTN.                                    I.080328
006210 TDI-DEL.                                                         I.080328
006220     INITIALIZE   TDIR-R.                                         I.080328
006230*****MOVE    TDI-R     TO  TDIR-D.                                D.100922
006240     MOVE    TDI-R     TO  TDIR-R.                                I.100922
006250     MOVE    W-DATE    TO  TDIR-DATE.                             I.080328
006260     WRITE   TDIR-R.                                              I.080328
006270     IF ERR-STAT NOT = "00"                                       I.080328
006280             MOVE  "A"           TO  ERR-M                        I.080328
006290             MOVE  "TDIRF"       TO  ERR-F                        I.080328
006300             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.080328
006310*
006320     MOVE  TDI-KEY     TO  ERR-K.                                 I.080328
006330     DELETE    TDIF   INVALID                                     I.080328
006340               MOVE  "D"           TO  ERR-M                      I.080328
006350               MOVE  "TDIF"        TO  ERR-F                      I.080328
006360               PERFORM  ERR-RTN    THRU  ERR-EX.                  I.080328
006370     GO    TO   TDI-RTN.                                          I.080328
006380 TDI-EX.                                                          I.080328
006390     EXIT.                                                        I.080328
006400 TDNA-RTN.                                                        I.090909
006410     READ      TDNAF        NEXT               AT  END            I.090909
006420               GO    TO     TDNA-EX.                              I.090909
006430     IF  TDNA-PC      =     9                                     I.090909
006440                            GO  TO  TDNA-DEL.                     I.090909
006450     GO      TO       TDNA-RTN.                                   I.090909
006460 TDNA-DEL.                                                        I.090909
006470     INITIALIZE   TDNAR-R.                                        I.090909
006480     MOVE    TDNA-R    TO  TDNAR-R.                               I.090909
006490     MOVE    W-DATE    TO  TDNAR-DATE.                            I.090909
006500     WRITE   TDNAR-R.                                             I.090909
006510     IF ERR-STAT NOT = "00"                                       I.090909
006520             MOVE  "A"           TO  ERR-M                        I.090909
006530             MOVE  "TDNARF"      TO  ERR-F                        I.090909
006540             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.090909
006550*
006560     MOVE  TDNA-KEY    TO  ERR-K.                                 I.090909
006570     DELETE    TDNAF  INVALID                                     I.090909
006580               MOVE  "D"           TO  ERR-M                      I.090909
006590               MOVE  "TDNAF"       TO  ERR-F                      I.090909
006600               PERFORM  ERR-RTN    THRU  ERR-EX.                  I.090909
006610     GO    TO   TDNA-RTN.                                         I.090909
006620 TDNA-EX.                                                         I.090909
006630     EXIT.                                                        I.090909
006640 NSUR-RTN.                                                        I.140916
006650     READ      NSURYOF                         AT  END            I.140916
006660               GO    TO     NSUR-EX.                              I.140916
006670 NSUR-010.                                                        I.140916
006680     INITIALIZE   NSURYOR-R.                                      I.140916
006690     MOVE    NSURYO-R  TO  NSURYOR-R.                             I.140916
006700     MOVE    W-DATE    TO  NSURYOR-10.                            I.140916
006710     WRITE   NSURYOR-R.                                           I.140916
006720     IF ERR-STAT     = "00"                                       I.140916
006730        GO    TO   NSUR-RTN.                                      I.140916
006740     IF ERR-STAT NOT = "34"                                       I.140916
006750             MOVE  "A"           TO  ERR-M                        I.140916
006760             MOVE  "NSURYORF"    TO  ERR-F                        I.140916
006770             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.140916
006780*
006790     DISPLAY E-STAT E-ME1 E-ME99.                                 I.140916
006800     DISPLAY E-CL.                                                I.140916
006810     CLOSE NSURYORF.                                              I.140916
006820     MOVE "NSURYORF     " TO W-FILE.                              I.140916
006830     DISPLAY E-ME71 E-ME98 STOP " ".                              I.140916
006840     DISPLAY E-CL.                                                I.140916
006850     OPEN EXTEND NSURYORF.                                        I.140916
006860     GO TO NSUR-010.                                              I.140916
006870 NSUR-EX.                                                         I.140916
006880     EXIT.                                                        I.140916
006890 NHAK-RTN.                                                        I.140916
006900     READ      NHAKOF                          AT  END            I.140916
006910               GO    TO     NHAK-EX.                              I.140916
006920 NHAK-010.                                                        I.140916
006930     INITIALIZE   NHAKOR-R.                                       I.140916
006940     MOVE    NHAKO-R   TO  NHAKOR-R.                              I.140916
006950     MOVE    W-DATE    TO  NHAKOR-10.                             I.140916
006960     WRITE   NHAKOR-R.                                            I.140916
006970     IF ERR-STAT     = "00"                                       I.140916
006980        GO    TO   NHAK-RTN.                                      I.140916
006990     IF ERR-STAT NOT = "34"                                       I.140916
007000             MOVE  "A"           TO  ERR-M                        I.140916
007010             MOVE  "NHAKORF"     TO  ERR-F                        I.140916
007020             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.140916
007030*
007040     DISPLAY E-STAT E-ME1 E-ME99.                                 I.140916
007050     DISPLAY E-CL.                                                I.140916
007060     CLOSE NHAKORF.                                               I.140916
007070     MOVE "NHAKORF      " TO W-FILE.                              I.140916
007080     DISPLAY E-ME71 E-ME98 STOP " ".                              I.140916
007090     DISPLAY E-CL.                                                I.140916
007100     OPEN EXTEND NHAKORF.                                         I.140916
007110     GO TO NHAK-010.                                              I.140916
007120 NHAK-EX.                                                         I.140916
007130     EXIT.                                                        I.140916
007140 NTEI-RTN.                                                        I.150429
007150     READ      TEISEIF                        AT  END             I.150429
007160               GO    TO     NTEI-EX.                              I.150429
007170 NTEI-010.                                                        I.150429
007180     INITIALIZE   TEISEIR-R.                                      I.150429
007190     MOVE    TEISEI-R TO  TEISEIR-R.                              I.150429
007200     MOVE    W-DATE    TO   TEISEIR-10.                           I.150429
007210     WRITE   TEISEIR-R.                                           I.150429
007220     IF ERR-STAT     = "00"                                       I.150429
007230        GO    TO   NTEI-RTN.                                      I.150429
007240     IF ERR-STAT NOT = "34"                                       I.150429
007250             MOVE  "A"           TO  ERR-M                        I.150429
007260             MOVE  "TEISEIRF"   TO  ERR-F                         I.150429
007270             PERFORM  ERR-RTN  THRU  ERR-EX.                      I.150429
007280*
007290     DISPLAY E-STAT E-ME1 E-ME99.                                 I.150429
007300     DISPLAY E-CL.                                                I.150429
007310     CLOSE  TEISEIRF.                                             I.150429
007320     MOVE "TEISEIRF     " TO W-FILE.                              I.150429
007330     DISPLAY E-ME71 E-ME98 STOP " ".                              I.150429
007340     DISPLAY E-CL.                                                I.150429
007350     OPEN EXTEND TEISEIRF.                                        I.150429
007360     GO TO NTEI-010.                                              I.150429
007370 NTEI-EX.                                                         I.150429
007380     EXIT.                                                        I.150429
007390 SEN-RTN.                                                         I.980908
007400     MOVE  0           TO  SEN-SW.                                I.980908
007410     CLOSE     JSTR.                                              I.980908
007420     OPEN  INPUT  JSTR.                                           I.980908
007430 SEN-010.                                                         I.980908
007440     READ  JSTR     NEXT  AT  END           GO  TO  SEN-EX.       I.980908
007450     IF  OKJF-01      NOT =  JSTR-14B       GO  TO  SEN-010.      I.980908
007460     MOVE  1           TO  SEN-SW.                                I.980908
007470 SEN-EX.                                                          I.980908
007480     EXIT.                                                        I.980908
007490******************************************************************
007500*                    ÇdÇmÇcÅ|ÇqÇsÇm                              *
007510******************************************************************
007520 END-RTN.
007530*****CLOSE      JSTR    JSTF   JTRN            JNIF    OKJF.      D.950404
007540*****CLOSE      JSTR           JTRN            JNIF    OKJF.      D.981126
007550*****CLOSE      JSTR    JNIF    OKJF.                             D.040928
007560*****CLOSE      JSTR    JNIF    OKJF   TDNWF.                     D.050129
007570*****CLOSE      JSTR    JNIF    OKJF   TDNWF  TDNNF.              D.080328
007580*****CLOSE      JSTR    JNIF    OKJF   TDNWF  TDNNF  TDIF.        D.090909
007590     CLOSE      JSTR    JNIF    OKJF   TDNWF  TDNNF  TDIF  TDNAF. I.090909
007600     CLOSE      TC-M    JT-DNKN.
007610     CLOSE      NSURYOF NHAKOF  TEISEIF.                          I.150429
007620*****CLOSE      NSURYOF NHAKOF.                                   D.150429
007630     CLOSE      JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF  TDIRF       I.090909
007640                TDNARF.                                           I.090909
007650     CLOSE      NSURYORF NHAKORF  TEISEIRF.                       I.150429
007660     OPEN    OUTPUT  NSURYOF NHAKOF  TEISEIF.                     I.150429
007670     CLOSE      NSURYOF NHAKOF  TEISEIF.                          I.150429
007680*****CLOSE      NSURYORF NHAKORF.                                 D.150429
007690*****OPEN    OUTPUT  NSURYOF NHAKOF.                              D.150429
007700*****CLOSE      NSURYOF NHAKOF.                                   D.150429
007710*****CLOSE      JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF  TDIRF.      D.090909
007720*****CLOSE      JSTRRF  OKJRF  JNIRF  TDNWRF  TDNNRF.             D.080328
007730*****CLOSE      JSTRRF  OKJRF  JNIRF  TDNWRF.                     D.050129
007740*****CLOSE      JSTRRF  OKJRF  JNIRF.                             D.040928
007750*****CLOSE      JSTRRF.                                           D.030317
007760 END-EX.
007770     EXIT.
007780 COPY  LPMSG.
