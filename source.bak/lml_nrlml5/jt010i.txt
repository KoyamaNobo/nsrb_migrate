000010 IDENTIFICATION         DIVISION.
000020 PROGRAM-ID.            JT010I.
000030*********************************************************
000040*    PROGRAM         :  受注入力　　　　　              *
000050*    PRINTER TYPE    :  ****                            *
000060*    SCREEN          :  SJ010I                          *
000070*    DATE      　　  :  03/09/10                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT            DIVISION.
000110 CONFIGURATION          SECTION.
000120 SOURCE-COMPUTER.       NEAC-SYSTEM100.
000130 OBJECT-COMPUTER.       NEAC-SYSTEM100.
000140 INPUT-OUTPUT           SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.                                                 I.980518
000170     SELECT       TC-M       ASSIGN   TO    F1-MSD                直送先M
000180                  ORGANIZATION        INDEXED
000190                  RECORD     KEY      TC-KEY
000200                  ACCESS     MODE     RANDOM
000210                  FILE       STATUS   IS    ERR-STAT.
000220*****SELECT       SHM        ASSIGN   TO    F2-MSD                D.010808
000230     SELECT       HI2-M      ASSIGN   TO    F2-MSD                I.010808
000240                  ORGANIZATION        INDEXED
000250*****             RECORD     KEY      SHM-KEY                     D.010808
000260                  RECORD     KEY      HI-KEY2                     I.010808
000270                  ACCESS     MODE     RANDOM
000280                  FILE       STATUS   IS    ERR-STAT.
000290*****SELECT       JTKB       ASSIGN   TO    F3-MSD                ＴＫＢM
000300*****             ORGANIZATION        INDEXED
000310*****             RECORD     KEY      JTKB-KEY
000320*****             ACCESS     MODE     RANDOM
000330*****             FILE       STATUS   IS    ERR-STAT.
000340*****SELECT       T-M        ASSIGN   TO    F4-MSD                D.940620
000350*****             ORGANIZATION        INDEXED                     D.940620
000360*****             RECORD     KEY      T-KEY                       D.940620
000370*****             ACCESS     MODE     RANDOM                      D.940620
000380*****             FILE       STATUS   IS    ERR-STAT.             D.940620
000390*****SELECT       JT-THTN    ASSIGN   TO    F5-MSD                D.010516
000400*****             ORGANIZATION        INDEXED                     D.010516
000410*****             RECORD     KEY      THTN-KEY                    D.010516
000420*****             ACCESS     MODE     RANDOM                      D.010516
000430*****             FILE       STATUS   IS    ERR-STAT.             D.010516
000440*****SELECT       HI-M       ASSIGN   TO    F6-MSD                D.940620
000450*****             ORGANIZATION        INDEXED                     D.940620
000460*****             RECORD     KEY      HI-KEY                      D.940620
000470*****             ACCESS     MODE     RANDOM                      D.940620
000480*****             FILE       STATUS   IS    ERR-STAT.             D.940620
000490     SELECT       JMSTD      ASSIGN   TO F7-MSD F7A-MSD F7B-MSD   受注M
000500                  ORGANIZATION        INDEXED
000510                  ACCESS     MODE     DYNAMIC
000520                  RECORD     KEY      JMSTD-KEY1
000530                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY2
000540                  ALTERNATE  RECORD   KEY   IS     JMSTD-KEY3
000550                  FILE       STATUS   IS    ERR-STAT.
000560     SELECT       JT-DNKN    ASSIGN   TO    F8-MSD                伝票検索
000570                  ORGANIZATION        INDEXED
000580                  RECORD     KEY      DNKN-KEY
000590                  ACCESS     MODE     DYNAMIC
000600                  FILE       STATUS   IS    ERR-STAT.
000610*****SELECT       JT-JYTO    ASSIGN   TO    F9-MSD                D.971128
000620*****             ORGANIZATION        INDEXED                     D.971128
000630*****             RECORD     KEY      JYTO-KEY                    D.971128
000640*****             ACCESS     MODE     DYNAMIC                     D.971128
000650*****             FILE       STATUS   IS    ERR-STAT.             D.971128
000660     SELECT       JCON       ASSIGN   TO    F10-MSD               ｺﾝﾄﾛｰﾙF
000670                  ORGANIZATION        INDEXED
000680                  RECORD     KEY      JCON1-KEY
000690                  ACCESS     MODE     RANDOM
000700                  FILE       STATUS   IS    ERR-STAT.
000710     SELECT       JDCON      ASSIGN   TO    F11-MSD               排他制御
000720                  ORGANIZATION        INDEXED
000730                  RECORD     KEY      JDCON-KEY
000740                  ACCESS     MODE     RANDOM
000750                  FILE       STATUS   IS    ERR-STAT.
000760*****SELECT       JTRN       ASSIGN   TO    F12-MSD               D.981125
000770*****             FILE       STATUS   IS    ERR-STAT.             D.981125
000780*****SELECT       JHIZ       ASSIGN   TO    F13-MSD               D.981027
000790*****             ORGANIZATION        INDEXED                     D.981027
000800*****             RECORD     KEY      JHIZ-KEY                    D.981027
000810*****             ACCESS     MODE     DYNAMIC                     D.981027
000820*****             FILE       STATUS   IS    ERR-STAT.             D.981027
000830*****SELECT       T-M        ASSIGN   TO    F14-MSD               D.000224
000840     SELECT       T-M        ASSIGN   TO    F141-MSD  F142-MSD    I.000224
000850                  ORGANIZATION        INDEXED                     I.941005
000860                  RECORD     KEY      T-KEY                       I.941005
000870                  ALTERNATE   RECORD     KEY      T-KEY2          I.000224
000880                  ACCESS     MODE     RANDOM                      I.941005
000890                  FILE       STATUS   IS    ERR-STAT.             I.941005
000900     SELECT       WTNAF      ASSIGN   TO    WTNA-MSD              I.080602
000910                  ORGANIZATION        INDEXED                     I.080602
000920                  RECORD     KEY      WTNA-KEY                    I.080602
000930                  ACCESS     MODE     RANDOM                      I.080602
000940                  FILE       STATUS   IS    ERR-STAT.             I.080602
000950     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD                      I.040802
000960         ORGANIZATION INDEXED                                     I.040802
000970         ACCESS MODE RANDOM                                       I.040802
000980         RECORD KEY THT-KEY                                       I.040802
000990         ALTERNATE RECORD KEY THT-KEY2                            I.040802
001000         FILE STATUS IS ERR-STAT.                                 I.040802
001010 I-O-CONTROL.
001020*****APPLY SHARED-MODE ON TC-M SHM JTKB T-M HI-M JMSTD            D.940620
001030*****APPLY SHARED-MODE ON TC-M SHM JTKB          JMSTD            I.940620
001040*****APPLY SHARED-MODE ON TC-M SHM               JMSTD            D.980518
001050*****APPLY SHARED-MODE ON M-DATE TC-M SHM JMSTD                   D.010808
001060*****APPLY SHARED-MODE ON M-DATE TC-M HI2-M JMSTD                 D.080603
001070     APPLY SHARED-MODE ON M-DATE TC-M WTNAF HI2-M JMSTD           I.080603
001080                          JT-DNKN  JCON JDCON T-M THTM.           I.040802
001090*****                     JT-DNKN  JCON JDCON T-M.                D.040802
001100*****            JT-THTN  JT-DNKN  JCON JDCON T-M.                D.010516
001110*****            JT-THTN  JT-DNKN  JCON JDCON JTRN  T-M.          D.981125
001120*****            JT-THTN  JT-DNKN  JCON JDCON JTRN JHIZ T-M.      D.981027
001130*****            JT-THTN  JT-DNKN JT-JYTO JCON JDCON JTRN JHIZ.   D.941005
001140*****        JT-THTN  JT-DNKN JT-JYTO JCON JDCON JTRN JHIZ T-M.   D.971128
001150 DATA                   DIVISION.
001160 FILE                   SECTION.
001170     COPY   LIBFDD.                                               I.980518
001180     COPY   LITCM.
001190     COPY   LIHIM2.                                               I.010808
001200*****COPY   L-SHM.                                                D.010808
001210*****COPY   L-JTKB.
001220*****COPY   LITM.                                                 D.940620
001230*****COPY   LTHTN.                                                D.010516
001240*****COPY   LIHIM.                                                D.940620
001250     COPY   LJMSTD.
001260     COPY   LTDNKN.
001270*****COPY   LTJYTO.                                               D.971128
001280     COPY   L-JCON.
001290     COPY   LJDCON.
001300*****COPY   LJTRN.                                                D.981125
001310*****COPY   LJHIZ.                                                D.981027
001320     COPY   LITM.                                                 I.941005
001330     COPY   LIDTHT.                                               I.080602
001340     COPY   LWTNAF.                                               I.080602
001350*****COPY LITHTM.                                                 D.080602
001360****
001370 WORKING-STORAGE        SECTION.
001380 77  ERR-STAT             PIC  X(02).                             ｴﾗｰｽﾃｰﾀｽ
001390 77  WJCON1-03            PIC  9(06).                             Ｗ受注№
001400 77  SU-SW                PIC  9(01).
001410*77  JRED-SW              PIC  9(01).                             D.981027
001420*77  HRED-SW              PIC  9(01).                             D.981027
001430*77  SUB-SW               PIC  9(01)  VALUE 0.                    D.981027
001440*77  DEL-FLG              PIC  9(01).                             D.981027
001450 77  CHK-SW               PIC  9(01).
001460*77  URI-KB               PIC  9(01).                             D.981027
001470*77  INV-SW               PIC  9(01).                             D.981027
001480 77  UPD-SW               PIC  9(01).
001490*77  WJHIZ-01             PIC  9(06).                             D.981027
001500*77  WJMSTD-KEY1          PIC X(08).                              D.981027
001510 77  JS-SIGN              PIC 9(01).                              *A871109
001520*77  W-YDATE              PIC 9(06).                              D.980518
001530 77  W-YDATE              PIC 9(08).                              I.980518
001540 77  W-EDATE              PIC 9(08).                              I.150622
001550 77  CHKNO                PIC 9(01).                              I.931225
001560 77  W-KBN                PIC 9(01).                              I.941024
001570 77  W-MID                PIC N(06).                              I.941024
001580 01  GYO.
001590     02  SIZU  OCCURS  4.
001600       03  SU  OCCURS  10   PIC  S9(06).
001610*01  WK-DATE.                                                     D.980518
001620***02  WK-YY              PIC  9(02).                             D.980518
001630***02  WK-MM              PIC  9(02).                             D.980518
001640***02  WK-DD              PIC  9(02).                             D.980518
001650 01  W-DATE.                                                      I.980518
001660     02  WK-DATE.                                                 I.980518
001670       03  WK-YY          PIC  9(04).                             I.980518
001680       03  WK-YYL   REDEFINES WK-YY.                              I.980518
001690         04  WK-YY1       PIC  9(02).                             I.980518
001700         04  WK-YY2       PIC  9(02).                             I.980518
001710       03  WK-MM          PIC  9(02).                             I.980518
001720       03  WK-DD          PIC  9(02).                             I.980518
001730     02  WK-DATEL REDEFINES WK-DATE.                              I.980518
001740       03  F              PIC  9(02).                             I.980518
001750       03  WK-DATES       PIC  9(06).                             I.980518
001760 01  W-TEKID.                                                     I.930925
001770     02  W-HTS            PIC  N(09).                             I.930925
001780     02  W-HTSD   REDEFINES   W-HTS.                              I.930925
001790       03  W-TGET         PIC  N(02).                             I.930925
001800       03  W-TGP          PIC  N(01).                             I.930925
001810       03  W-TPEY         PIC  N(02).                             I.930925
001820       03  W-HTSM         PIC  N(04).                             I.930925
001830 01  W-TEKI.                                                      I.930118
001840     02  W-TEKI1          PIC  N(09).                             I.930118
001850     02  W-TEKI2          PIC  N(19).                             I.951214
001860     02  W-TEKI3          PIC  N(04).                             I.951214
001870*****02  W-TEKI2          PIC  N(23).                             D.951214
001880 01  GMN-ACT              PIC  9(01).                             　　選択
001890 01  GMN-ANAM             PIC  N(02).                             　選択名
001900 01  GMN-AREA.                                                    画面用
001910     02  GMN-NO           PIC  9(06).                             預りＮＯ
001920     02  GMN-JNO          PIC  9(06).                             受注ＮＯ
001930     02  GMN-JNOR   REDEFINES   GMN-JNO.                          *A871109
001940       03  JNO-1          PIC  9(01).                             ﾞ
001950       03  JNO-2          PIC  9(05).                             ﾞ
001960     02  GMN-HEAD.
001970       03  GMN-OKC        PIC  9(01).                             　　確認
001980       03  GMN-SET        PIC S9(03).                                ｾｯﾄ数
001990       03  GMN-JYMD.
002000*****    04  GMN-JYY      PIC  9(02).                             D.980518
002010         04  GMN-JYY      PIC  9(04).                             I.980518
002020         04  GMN-JYYL  REDEFINES GMN-JYY.                         I.980518
002030           05  GMN-JYY1   PIC  9(02).                             I.980518
002040           05  GMN-JYY2   PIC  9(02).                             I.980518
002050         04  GMN-JMM      PIC  9(02).                             　　　月
002060         04  GMN-JDD      PIC  9(02).                             　　　日
002070       03  GMN-TCCD.
002080         04  GMN-TCD      PIC  9(04).                             得意先CD
002090         04  GMN-CCD      PIC  9(03).                             直送先CD
002100       03  GMN-TNAM       PIC  N(24).                             得意先名
002110       03  GMN-CNAM       PIC  N(24).                             直送先名
002120*****  03  GMN-TENC       PIC  9(03).                             D.100921
002130       03  GMN-TENC       PIC  9(04).                             I.100921
002140       03  GMN-TENM       PIC  N(11).                             I.080602
002150     02    GMN-DATA.
002160       03  GMN-TEKI       PIC  N(32).                             R.911210
002170       03  GMN-TEKIR  REDEFINES  GMN-TEKI.                        I.911210
002180         04  GMN-TEKI1    PIC  N(09).                             　配達
002190         04  GMN-TEKI2    PIC  N(19).                             I.951214
002200         04  GMN-TEKI3    PIC  N(04).                             I.951214
002210*****    04  GMN-TEKI2    PIC  N(23).                             D.951214
002220       03  GMN-GKEI       PIC S9(07).                             　数量計
002230       03  GMN-GKIN       PIC S9(08).                               金額計
002240       03  GMN-MEISAI   OCCURS  6.
002250         04  GMN-SIZ      PIC  9(01).                             ｻｲｽﾞ区分
002260         04  GMN-HCD      PIC  9(06).                             品名ＣＤ
002270         04  GMN-HNAM.                                            　　品名
002280           05  GMN-HNAM1  PIC  N(12).
002290           05  GMN-HNAM2  PIC  N(12).
002300         04  GMN-NYMD.                                            　　納期
002310*****      05  GMN-NYY    PIC  9(02).                             D.980518
002320           05  GMN-NYY    PIC  9(04).                             I.980518
002330           05  GMN-NYYL  REDEFINES GMN-NYY.                       I.980518
002340             06  GMN-NYY1 PIC  9(02).                             I.980518
002350             06  GMN-NYY2 PIC  9(02).                             I.980518
002360           05  GMN-NMM    PIC  9(02).                             　　　月
002370           05  GMN-NDD    PIC  9(02).                             　　　日
002380         04  GMN-KEI      PIC S9(06).                             　　合計
002390         04  GMN-SIZE.
002400           05  GMN-SURYO  OCCURS  10.                             　　数量
002410             06  GMN-SU   PIC S9(06).
002420*****    04  GMN-TAN      PIC  9(04).                             D.941227
002430         04  GMN-TAN      PIC  9(05).                             I.941227
002440         04  GMN-KIN      PIC S9(08).                                 金額
002450         04  GMN-BIKHO    PIC  X(10).                             I.980604
002460         04  GMN-BCD1     PIC  9(03).                             I.040601
002470 01  WK-AREA.
002480     02  SAVE-AREA.                                                 SAVE用
002490       03  WS-SEQ         PIC  9(03).                               SEQ-NO
002500*****  03  WS-NO.                                                 D.980929
002510*****    04  WS-NO1       PIC  9(06).                             D.980929
002520*****    04  WS-NO2       PIC  9(01).                             D.980929
002530       03  WS-JYMD.                                               　受注日
002540*****    04  WS-JYY       PIC  9(02).                             D.980518
002550         04  WS-JYY       PIC  9(04).                             I.980518
002560         04  WS-JYYL  REDEFINES WS-JYY.                           I.980518
002570           05  WS-JYY1    PIC  9(02).                             I.980518
002580           05  WS-JYY2    PIC  9(02).                             I.980518
002590         04  WS-JMM       PIC  9(02).                             　　　月
002600         04  WS-JDD       PIC  9(02).                             　　　日
002610       03  WS-GKEI        PIC S9(07).                               数量計
002620       03  WS-GKIN        PIC S9(08).                             　金額計
002630       03  WS-SET         PIC S9(03).                                ｾｯﾄ数
002640       03  WS-KBN         PIC  9(01).
002650       03  WS-DATA        OCCURS  6.
002660         04  WS-SIZ       PIC  9(01).                             ｻｲｽﾞ区分
002670         04  WS-HCD       PIC  9(06).                             品名ＣＤ
002680         04  WS-HNAM.                                             　　品名
002690           05  WS-HNAM1   PIC  N(12).
002700           05  WS-HNAM2   PIC  N(12).
002710         04  WS-NYMD.                                             　　納期
002720*****      05  WS-NYY     PIC  9(02).                             D.980518
002730           05  WS-NYY     PIC  9(04).                             I.980518
002740           05  WS-NYYL  REDEFINES WS-NYY.                         I.980518
002750             06  WS-NYY1  PIC  9(02).                             I.980518
002760             06  WS-NYY2  PIC  9(02).                             I.980518
002770           05  WS-NMM     PIC  9(02).                             　　　月
002780           05  WS-NDD     PIC  9(02).                             　　　日
002790         04  WS-KEI       PIC S9(06).                             　    計
002800         04  WS-CHECK     PIC  X(02).                             ZEROﾁｪｯｸ
002810         04  WS-SIZE.                                             サイズ別
002820           05  WS-SURYO  OCCURS  10.                              　　数量
002830             06  WS-SU    PIC S9(06).
002840             06  WS-ZAN   PIC S9(06).
002850         04  WS-12       OCCURS  10.
002860             06  WS-1211  PIC S9(06).
002870         04  WS-14       OCCURS  10.
002880             06  WS-141   PIC S9(06).
002890         04  WS-15       OCCURS  10.
002900             06  WS-151   PIC S9(06).
002910*****    04  WS-TAN       PIC  9(04).                             D.941227
002920         04  WS-TAN       PIC  9(05).                             I.941227
002930         04  WS-KIN       PIC S9(08).                                 金額
002940         04  WS-BIKHO     PIC  X(10).                             I.980604
002950     02  WK-USE.                                                  　その他
002960       03  WK-SU.
002970         04  WK-SU1       PIC S9(06).
002980         04  WK-SU2       PIC S9(06).
002990         04  WK-SU4       PIC S9(06).
003000         04  WK-SU3       PIC S9(04).
003010       03  AA             PIC  9(02).                              LINE-NO
003020       03  BB             PIC  9(02).                              ｶﾗﾑ  NO
003030       03  SOEJI-AREA.                                            　添え字
003040         04  XXW          PIC  9(01).                             I.941227
003050         04  XX           PIC  9(01).                             　　一次
003060         04  YY           PIC  9(01).                             　　二次
003070         04  ZZ           PIC  9(02).                             　　三次
003080         04  WW           PIC  9(01).                              JTRN 用
003090         04  I            PIC  9(02).
003100         04  P            PIC  9(02).
003110       03  SW-AREA.                                               ｽｲｯﾁ ｴﾘｱ
003120*****    04  SW-TKB       PIC  X(02).                             D.940927
003130         04  SW-INV       PIC  X(02).                             READ ERR
003140         04  SW-ZERO      PIC  X(02).                             ZEROﾁｪｯｸ
003150       03  WK-NAM         PIC  N(24).                             品　　名
003160       03  WK-NAM-R     REDEFINES      WK-NAM.                       〃
003170         04  WK-NAM1      PIC  N(12).                                〃
003180         04  WK-NAM2      PIC  N(12).                                〃
003190*****  03  WK-KEY         PIC  X(08).                             D.980518
003200       03  WK-KEY         PIC  X(07).                             I.980518
003210*****  03  WK-KAK         PIC  9(01).                             D.080602
003220       03  WK-HCD         PIC  9(06).                             品名CODE
003230       03  WK-TCCD        PIC  9(07).                             直送先CD
003240*****  03  WK-TENC        PIC  9(03).                             D.100921
003250       03  WK-TENC        PIC  9(04).                             I.100921
003260       03  WK-SURYO       PIC S9(06).                             数量
003270       03  HINCD.                                                 *A871109
003280         04  HIN-01       PIC  9(01).                             ﾞ
003290         04  HIN-02       PIC  9(01).                             ﾞ
003300       03  WK-ANS         PIC  9(04).
003310       03  WK-AMARI       PIC  9(04).
003320       03  WK-NMD.                                                I.990223
003330         04  WK-NMM       PIC  Z(02).                             I.990223
003340         04  WK-NDD       PIC  Z(02).                             I.990223
003350       03  WK-TAN         PIC  9(05).                             I.040802
003360*01  WJYTO-KEY.                                                   D.971128
003370*****02  WJYTO-01         PIC  9(04).                             D.971128
003380*****02  WJYTO-02         PIC  9(06).                             D.971128
003390*****02  WJYTO-03         PIC  9(01).                             D.971128
003400 01  REV-AREA.                                                    A 630106
003410     02  REV-SW           PIC  X(02).                             A 630106
003420     02  REV-2.                                                   I.131121
003430         03  REV-201          PIC  X(04)  VALUE "12.5".           I.131121
003440         03  REV-202          PIC  X(04)  VALUE "13.0".           I.131121
003450         03  REV-203          PIC  X(04)  VALUE "13.5".           I.131121
003460         03  REV-204          PIC  X(04)  VALUE "14.0".           I.131121
003470         03  REV-205          PIC  X(04)  VALUE "15.0".           I.131121
003480         03  REV-206          PIC  X(04)  VALUE "16.0".           I.131121
003490         03  REV-207          PIC  X(04)  VALUE "17.0".           I.131121
003500         03  REV-208          PIC  X(04)  VALUE "18.0".           I.131121
003510         03  REV-209          PIC  X(04)  VALUE "19.0".           I.131121
003520         03  REV-210          PIC  X(04)  VALUE "20.0".           I.131121
003530     02  REV-3.                                                   I.131121
003540         03  REV-301          PIC  X(04)  VALUE "21.0".           I.131121
003550         03  REV-302          PIC  X(04)  VALUE "21.5".           I.131121
003560         03  REV-303          PIC  X(04)  VALUE "22.0".           I.131121
003570         03  REV-304          PIC  X(04)  VALUE "22.5".           I.131121
003580         03  REV-305          PIC  X(04)  VALUE "23.0".           I.131121
003590         03  REV-306          PIC  X(04)  VALUE "23.5".           I.131121
003600         03  REV-307          PIC  X(04)  VALUE "24.0".           I.131121
003610         03  REV-308          PIC  X(04)  VALUE "24.5".           I.131121
003620         03  REV-309          PIC  X(04)  VALUE "25.0".           I.131121
003630         03  REV-310          PIC  X(04)  VALUE "    ".           I.131121
003640     02  REV-4.                                                   I.131121
003650         03  REV-401          PIC  X(04)  VALUE "24.0".           I.131121
003660         03  REV-402          PIC  X(04)  VALUE "24.5".           I.131121
003670         03  REV-403          PIC  X(04)  VALUE "25.0".           I.131121
003680         03  REV-404          PIC  X(04)  VALUE "25.5".           I.131121
003690         03  REV-405          PIC  X(04)  VALUE "26.0".           I.131121
003700         03  REV-406          PIC  X(04)  VALUE "26.5".           I.131121
003710         03  REV-407          PIC  X(04)  VALUE "27.0".           I.131121
003720         03  REV-408          PIC  X(04)  VALUE "27.5".           I.131121
003730         03  REV-409          PIC  X(04)  VALUE "    ".           I.131121
003740         03  REV-410          PIC  X(04)  VALUE "    ".           I.131121
003750     02  REV-1.                                                   I.131121
003760         03  REV-101          PIC  X(04)  VALUE "    ".           I.131121
003770         03  REV-102          PIC  X(04)  VALUE "    ".           I.131121
003780         03  REV-103          PIC  X(04)  VALUE " SS ".           I.131121
003790         03  REV-104          PIC  X(04)  VALUE "  S ".           I.131121
003800         03  REV-105          PIC  X(04)  VALUE "  M ".           I.131121
003810         03  REV-106          PIC  X(04)  VALUE "  L ".           I.131121
003820         03  REV-107          PIC  X(04)  VALUE " LL ".           I.131121
003830         03  REV-108          PIC  X(04)  VALUE "28.0".           I.131121
003840         03  REV-109          PIC  X(04)  VALUE "29.0".           I.131121
003850         03  REV-110          PIC  X(04)  VALUE "30.0".           I.131121
003860*****02  REV-2            PIC  X(54)  VALUE                       D.131121
003870*****  "2 12.5 13.0 13.5 14.0 15.0 16.0 17.0 18.0 19.0   20.0 ".  D.131121
003880*****02  REV-3            PIC  X(54)  VALUE                       D.131121
003890*****  "3 21.0 21.5 22.0 22.5 23.0 23.5 24.0 24.5 25.0   ---- ".  D.131121
003900*****02  REV-4            PIC  X(54)  VALUE                       D.131121
003910*****  "4 24.0 24.5 25.0 25.5 26.0 26.5 27.0 27.5 ----   ---- ".  D.131121
003920*****  "4 24.0 24.5 25.0 25.5 26.0 26.5 27.0 27.5 ----   預り ".  D.980929
003930*****02  REV-1            PIC  X(54)  VALUE                       D.131121
003940*****  "1 ３号 ２号 １号 ０号  中   大  特大 28.0 29.0   30.0 ".  D.131121
003950     COPY   LWMSG.
003960 SCREEN                 SECTION.
003970 SD  DSP-CRT
003980     END STATUS IS ESTAT.
003990 01  DSP-CLEAR.
004000     02  LINE  1  CLEAR   SCREEN.
004010 01  DSP-MID.                                                     I.941024
004020     02  LINE  1  COLUMN  21  PIC  N(18)  VALUE                   I.941024
004030          NC"［　　受注・預り・取りよけ入力　　］" REVERSE.       I.941024
004040     02  LINE  7.                                                 I.030715
004050       03  COLUMN  21  PIC  N(03)  VALUE NC"教　育".              I.030715
004060       03  COLUMN  27  PIC  X(05)  VALUE "=0 , ".                 I.030715
004070       03  COLUMN  32  PIC  N(03)  VALUE NC"一　般".              I.070410
004080       03  COLUMN  38  PIC  X(13)  VALUE "=1 ....  ﾘﾀ-ﾝ".         I.070410
004090*****  03  COLUMN  32  PIC  N(03)  VALUE NC"ワーク".              D.070410
004100*****  03  COLUMN  38  PIC  X(05)  VALUE "=1 , ".                 D.070410
004110*****  03  COLUMN  43  PIC  N(05)  VALUE NC"カジュアル".          D.070410
004120*****  03  COLUMN  53  PIC  X(13)  VALUE "=2 ....  ﾘﾀ-ﾝ".         D.070410
004130     02  LINE 11  COLUMN  25  PIC  X(16)  VALUE                   I.941024
004140            "受注入力     = 0".                                   I.941024
004150     02  LINE 13  COLUMN  25  PIC  X(16)  VALUE                   I.941024
004160            "預り入力     = 5".                                   I.941024
004170     02  LINE 15  COLUMN  25  PIC  X(27)  VALUE                   I.941024
004180            "取りよけ入力 = 6 ....  ﾘﾀ-ﾝ".                        I.941024
004190     02  LINE 24  COLUMN  41  PIC  X(25)  VALUE                   I.941024
004200          "確認(OK=1,NO=9)-->   ﾘﾀｰﾝ".                            I.941024
004210 01  ACT-AREA.
004220*****02  ACT-SIGN LINE  7  COLUMN  61   PIC  9(01)                D.070410
004230     02  ACT-SIGN LINE  7  COLUMN  46   PIC  9(01)                I.070410
004240         USING  JS-SIGN    CHECK  OVERFLOW     NO IFC.            I.030715
004250     02  ACT-KBN  LINE 15  COLUMN  47   PIC  9(01)                I.941024
004260         USING  W-KBN      CHECK  OVERFLOW     NO IFC.            I.941024
004270     02  ACT-ACT  LINE  1  COLUMN  67   PIC  9(01)                ACT
004280         USING  GMN-ACT    CHECK  OVERFLOW     NO IFC.
004290     02  ACT-JNO  LINE  3  COLUMN   2   PIC  9(06)                預り№
004300         USING  GMN-JNO    CHECK  OVERFLOW     NO IFC.
004310     02  ACT-JYMD LINE  3.                                        預り日
004320       03  ACT-JYY       COLUMN   9   PIC  9(02)
004330           USING  GMN-JYY2                         NO IFC.        I.980518
004340*****      USING  GMN-JYY                           NO IFC.       D.980518
004350       03  ACT-JMM       COLUMN  12   PIC  9(02)
004360           USING  GMN-JMM                           NO IFC.
004370       03  ACT-JDD       COLUMN  15   PIC  9(02)
004380           USING  GMN-JDD       CHECK  OVERFLOW     NO IFC.
004390*****02  ACT-TMAT LINE  3  COLUMN  18   PIC  9(07)                ﾏｯﾄCD
004400*****USING      JTKB-01          INPUT  MAT          NO IFC.
004410     02  ACT-TCCD LINE  3.                                        直送先
004420       03  ACT-TCD       COLUMN  18   PIC  9(04)
004430           USING  GMN-TCD                           NO IFC.
004440       03  ACT-CCD       COLUMN  23   PIC  9(03)
004450           USING  GMN-CCD       CHECK  OVERFLOW     NO IFC.
004460     02  ACT-SET  LINE  3  COLUMN  28   PIC  9(03)                セット数
004470         INTO   GMN-SET       CHECK  OVERFLOW     NO IFC.
004480     02  ACT-TENC LINE  4  COLUMN   6   PIC  9(04)                I.100921
004490         USING  GMN-TENC      CHECK  OVERFLOW     NO IFC.         I.100921
004500*****02  ACT-TENC LINE  4  COLUMN   6   PIC  9(03)                D.100921
004510*****    USING  GMN-TENC      CHECK  OVERFLOW     NO IFC.         D.100921
004520     02  ACT-SIZ  LINE AA PLUS 1 COLUMN   1   PIC  9(01)          ｻｲｽﾞ区分
004530         USING  GMN-SIZ(XX)   CHECK  OVERFLOW     NO IFC.
004540*****02  ACT-HMAT LINE AA  COLUMN   2   PIC  9(07)                ﾏｯﾄCD
004550*****USING      JTKB-01          INPUT  MAT          NO IFC.
004560     02  ACT-HCD  LINE AA  COLUMN   2   PIC  9(06)                品名Ｃ
004570         USING  GMN-HCD(XX)    CHECK  OVERFLOW     NO IFC.
004580     02  ACT-SU   LINE AA  PLUS 1.
004590       03  ACT-SU1         COLUMN  BB   PIC S9(04)                数量
004600           INTO   GMN-SU(XX ZZ)    CHECK  OVERFLOW     NO IFC.
004610*****  03  ACT-SU2         COLUMN  48   PIC S9(06)                D.980929
004620*****      INTO   GMN-SU(XX ZZ)    CHECK  OVERFLOW     NO IFC.    D.980929
004630*****  03  ACT-TAN         COLUMN  64   PIC  9(04)                D.941227
004640       03  ACT-TAN         COLUMN  64   PIC  9(05)                I.941227
004650           INTO   GMN-TAN(XX)      CHECK  OVERFLOW     NO IFC.
004660     02  ACT-END  LINE AA.
004670       03  ACT-NYMD.                                              納期
004680         04  ACT-NYY       COLUMN  59   PIC  9(02)
004690             USING  GMN-NYY2(XX)                         NO IFC.  I.980518
004700*****        USING  GMN-NYY(XX)                          NO IFC.  D.980518
004710         04  ACT-NMM       COLUMN  62   PIC  9(02)
004720             USING  GMN-NMM(XX)                          NO IFC.
004730         04  ACT-NDD       COLUMN  65   PIC  9(02)
004740             USING  GMN-NDD(XX)      CHECK  OVERFLOW     NO IFC.
004750     02  ACT-BIKHO LINE AA  COLUMN  69   PIC  X(10)               I.980604
004760         USING  GMN-BIKHO(XX)    CHECK  OVERFLOW     NO IFC.      I.980604
004770     02  ACT-TEKI1 LINE 22  COLUMN   7   PIC  N(09)               配達
004780         USING  GMN-TEKI1        CHECK  OVERFLOW     NO IFC.
004790*****02  ACT-TEKI2 LINE 23  COLUMN   7   PIC  N(23)               D.951214
004800     02  ACT-TEKI2 LINE 23  COLUMN   7   PIC  N(19)               I.951214
004810         USING  GMN-TEKI2        CHECK  OVERFLOW     NO IFC.
004820     02  ACT-OKC  LINE 24  COLUMN  60   PIC  9(01)
004830         USING  GMN-OKC          CHECK  OVERFLOW     NO IFC.
004840*****02  ACT-SIGN LINE 24  COLUMN   1   PIC  9(01)                D.030715
004850*****    INTO   JS-SIGN.                                          D.030715
004860 01  DSP-AREA.
004870     02  DSP-HED  LINE  1.
004880       03  DSP-S0   COLUMN   2  PIC  N(06) FROM  W-MID.           I.941024
004890       03  DSP-S1   COLUMN  21  VALUE  NC"教　育"  BLINK.         *A871109
004900       03  DSP-S2   COLUMN  21  VALUE  NC"一　般"  BLINK.         I.070410
004910*****  03  DSP-S2   COLUMN  21  VALUE  NC"ワーク"  BLINK.         D.070410
004920*****  03  DSP-S3   COLUMN  21  VALUE  NC"カジュ"  BLINK.         D.070410
004930*****  03  DSP-S2   COLUMN  21  VALUE  NC"一　般"  BLINK.         D.030702
004940       03 DSP-ANAM  COLUMN  69  PIC  N(02) FROM  GMN-ANAM.
004950     02  DSP-HEAD.
004960       03  DSP-BAR  LINE  3  COLUMN  22  VALUE   "-".
004970       03  DSP-SET  LINE  3  COLUMN  28  PIC  ZZZ   FROM GMN-SET.
004980       03  DSP-TNAM LINE  3  COLUMN  33  PIC  N(24) FROM GMN-TNAM.
004990       03  DSP-CNAM LINE  4  COLUMN  33  PIC  N(24) FROM GMN-CNAM.
005000     02  DSP-TEN   LINE  4.                                       I.080602
005010       03  DSP-TENN COLUMN   1  VALUE   "店CD".                   I.080602
005020       03  DSP-TENC COLUMN   6  PIC  9(04) FROM GMN-TENC.         I.100921
005030*****  03  DSP-TENC COLUMN   6  PIC  9(03) FROM GMN-TENC.         D.100921
005040       03  DSP-TENM COLUMN  10  PIC  N(11) FROM GMN-TENM.         I.080602
005050*
005060     02 DSP-HNAM LINE AA  COLUMN   9  PIC N(24) FROM GMN-HNAM(XX).
005070     02  DSP-END  LINE 22.
005080       03 DSP-GKEI     COLUMN  55 PIC ZZZ,ZZZ-    FROM GMN-GKEI.
005090       03 DSP-GKIN     COLUMN  70 PIC ZZ,ZZZ,ZZZ- FROM GMN-GKIN.  I.941227
005100*****  03 DSP-GKIN     COLUMN  69 PIC ZZ,ZZZ,ZZZ- FROM GMN-GKIN.  D.941227
005110     02  DSP-NYMD LINE AA.
005120         04  DSP-NA      COLUMN  61  PIC  X(01) VALUE "-".
005130         04  DSP-NB      COLUMN  64  PIC  X(01) VALUE "-".
005140*****    04  DSP-NYY     COLUMN  59  PIC  ZZ   FROM GMN-NYY(XX).  D.980518
005150*****    04  DSP-NYY     COLUMN  59  PIC  ZZ   FROM GMN-NYY2(XX). D.991112
005160         04  DSP-NYY     COLUMN  59  PIC  99   FROM GMN-NYY2(XX). I.991112
005170         04  DSP-NMM     COLUMN  62  PIC  ZZ   FROM GMN-NMM(XX).
005180         04  DSP-NDD     COLUMN  65  PIC  ZZ   FROM GMN-NDD(XX).
005190***02  DSP-TAN LINE AA PLUS 1 COLUMN 64 PIC ZZZZ FROM GMN-TAN(XX).D.941227
005200*****02  DSP-KIN LINE AA PLUS 1 COLUMN 69 PIC ZZ,ZZZ,ZZZ-         D.941227
005210     02  DSP-TAN LINE AA PLUS 1 COLUMN 64 PIC ZZZZZ               I.941227
005220         FROM GMN-TAN(XX).                                        I.941227
005230     02  DSP-KIN LINE AA PLUS 1 COLUMN 70 PIC ZZ,ZZZ,ZZZ-         I.941227
005240         FROM     GMN-KIN(XX).
005250     02  DSP-SU   LINE AA PLUS 1.
005260       03  DSP-SU1   COLUMN  BB   PIC ZZZZ-    FROM GMN-SU(XX ZZ).
005270*****  03  DSP-SU2   COLUMN  48   PIC ZZZZZZ-  FROM GMN-SU(XX ZZ).D.980929
005280       03  DSP-KEI   COLUMN  55   PIC ZZZ,ZZZ- FROM GMN-KEI(XX).
005290     02 DSP-NO   LINE 23  COLUMN  75  PIC 9(06) FROM GMN-NO.      I.061025
005300     02 CLE-NO   LINE 23  COLUMN  75  PIC X(06) VALUE " ".        I.061025
005310     02  DSP-BIKHO.                                               I.981106
005320       03  LINE  10.                                              I.981106
005330         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005340         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005350       03  LINE  12.                                              I.981106
005360         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005370         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005380       03  LINE  14.                                              I.981106
005390         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005400         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005410       03  LINE  16.                                              I.981106
005420         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005430         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005440       03  LINE  18.                                              I.981106
005450         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005460         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005470       03  LINE  20.                                              I.981106
005480         04  COLUMN  68  PIC  X(01) VALUE "[".                    I.981106
005490         04  COLUMN  79  PIC  X(01) VALUE "]".                    I.981106
005500     02  DSP-BIKHO-CLE.                                           I.981106
005510       03  LINE  10.                                              I.981106
005520         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005530         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005540       03  LINE  12.                                              I.981106
005550         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005560         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005570       03  LINE  14.                                              I.981106
005580         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005590         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005600       03  LINE  16.                                              I.981106
005610         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005620         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005630       03  LINE  18.                                              I.981106
005640         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005650         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005660       03  LINE  20.                                              I.981106
005670         04  COLUMN  68  PIC  X(01) VALUE " ".                    I.981106
005680         04  COLUMN  79  PIC  X(01) VALUE " ".                    I.981106
005690 01  CLR-HEAD1.
005700     02  CLR-JNO  LINE  3  COLUMN   2   PIC  X(06)   VALUE " ".
005710 01  CLR-HEAD.
005720     02  CLR-YY   LINE  3  COLUMN   9   PIC  X(02)   VALUE " ".
005730     02  CLR-MM   LINE  3  COLUMN  12   PIC  X(02)   VALUE " ".
005740     02  CLR-DD   LINE  3  COLUMN  15   PIC  X(02)   VALUE " ".
005750     02  CLR-TCD  LINE  3  COLUMN  18   PIC  X(04)   VALUE " ".
005760     02  CLR-CCD  LINE  3  COLUMN  23   PIC  X(03)   VALUE " ".
005770     02  CLR-TNAM LINE  3  COLUMN  33   PIC  X(48)   VALUE " ".
005780     02  CLR-SET  LINE  3  COLUMN  28   PIC  X(03)   VALUE " ".
005790*****02  CLR-KAK  LINE  4  COLUMN   7   PIC  X(01)   VALUE " ".   D.080602
005800     02  CLR-CNAM LINE  4  COLUMN  33   PIC  X(48)   VALUE " ".
005810     02  CLR-TEN  LINE  4  COLUMN   1   PIC  X(31)   VALUE " ".   I.080602
005820 01  CLR-MEI    LINE  AA.
005830     02  CLEAR  DATA  TO  21.
005840 01  CLR-AREA.
005850     02  CLR-HCD  LINE AA  COLUMN   2   PIC  X(07)   VALUE " ".
005860     02  CLR-SIZ  LINE AA PLUS 1 COLUMN 1 PIC X(07)  VALUE " ".
005870     02  CLR-01.
005880       03  LINE AA         COLUMN   2   PIC  X(56)   VALUE " ".
005890     02  CLR-02   LINE AA.
005900       03  CLR-NA          COLUMN  61   PIC  X(01)   VALUE " ".
005910       03  CLR-NB          COLUMN  64   PIC  X(01)   VALUE " ".
005920       03  CLR-021         COLUMN  59   PIC  X(02)   VALUE " ".
005930       03  CLR-022         COLUMN  62   PIC  X(02)   VALUE " ".
005940       03  CLR-023         COLUMN  65   PIC  X(02)   VALUE " ".
005950     02  CLR-BIKHO LINE AA COLUMN  69   PIC  X(10)   VALUE " ".   I.980604
005960     02  CLR-03   LINE AA  PLUS 1.
005970       03  CLR-031         COLUMN   1   PIC  X(01)   VALUE " ".
005980       03  CLR-032         COLUMN   3   PIC  X(52)   VALUE " ".
005990       03  CLR-033         COLUMN  55   PIC  X(08)   VALUE " ".
006000       03  CLR-034         COLUMN  64   PIC  X(05)   VALUE " ".   I.941227
006010       03  CLR-035         COLUMN  70   PIC  X(11)   VALUE " ".   I.941227
006020*****  03  CLR-034         COLUMN  64   PIC  X(04)   VALUE " ".   D.941227
006030*****  03  CLR-035         COLUMN  69   PIC  X(11)   VALUE " ".   D.941227
006040     02  CLR-GKEI LINE 22.
006050       03  COLUMN  55    PIC X(08)    VALUE " ".
006060       03  COLUMN  70    PIC X(11)    VALUE " ".                  I.941227
006070*****  03  COLUMN  69    PIC X(11)    VALUE " ".                  D.941227
006080 01  CLR-END.
006090     02  CLR-TEKI1 LINE 22  COLUMN   7   PIC  N(09)   VALUE
006100         NC"　　　　　　　　　".
006110     02  CLR-TEKI2 LINE 23  COLUMN   7   PIC  N(23)   VALUE
006120         NC"　　　　　　　　　　　　　　　　　　　　　　　".
006130     02  CLR-OKC   LINE 24  COLUMN  60   PIC  X(01)   VALUE " ".
006140****
006150 01  EMSG-AREA   LINE 24.
006160     02  EMSG-01           COLUMN   1   VALUE
006170         NC"ＪＳ－ＳＩＧＮ　エラー".
006180*****02  EMSG-02           COLUMN   1   VALUE                     D.980929
006190*****    NC"売上計上済　処理不可".                                D.980929
006200***02  EMSG-03           COLUMN   1   VALUE
006210*****    NC"ＴＫＢマスタ　未登録".
006220     02  EMSG-04           COLUMN   1   VALUE
006230         NC"直送先マスタ（得意先）　未登録".
006240     02  EMSG-05           COLUMN   1   VALUE
006250         NC"直送先マスタ（直送先）　未登録".
006260     02  EMSG-06           COLUMN   1   VALUE
006270         NC"品名マスタ　未登録".                                  I.010808
006280*****    NC"出荷品名マスタ　未登録".                              D.010808
006290     02  EMSG-07           COLUMN   1   VALUE
006300         NC"分類　エラー".
006310     02  EMSG-08           COLUMN   1   VALUE
006320         NC"行クリア　不可".
006330     02  EMSG-09           COLUMN   1   VALUE
006340         NC"使用サイズ　無し".
006350*****02  EMSG-10           COLUMN   1   VALUE                     D.980929
006360*****    NC"取消数　オーバー".                                    D.980929
006370*****02  EMSG-11           COLUMN   1   VALUE                     D.980929
006380*****    NC"数量ＺＥＲＯ　エラー".                                D.980929
006390     02  EMSG-12           COLUMN   1   VALUE
006400         NC"セット数量　エラー".
006410     02  EMSG-13           COLUMN   1   VALUE
006420         NC"取消数オーバー".
006430     02  EMSG-14           COLUMN   1   VALUE
006440         NC"数量ゼロ　エラー".
006450***02  EMSG-15           COLUMN   1   VALUE                       D.940620
006460*****    NC"金額ゼロ　エラー".                                    D.940620
006470     02  EMSG-16           COLUMN   1   VALUE                     I.930925
006480         NC"納期　エラー".                                        I.930925
006490     02  EMSG-17           COLUMN   1   VALUE                     I.941024
006500         NC"区分　エラー".                                        I.941024
006510     02  EMSG-18           COLUMN   1   VALUE                     I.080602
006520         NC"店名　未登録".                                        I.080602
006530     02  EMSG-19           COLUMN   1   VALUE                     I.080602
006540         NC"直送　エラー".                                        I.080602
006550     02  EMSG-21           COLUMN   1   VALUE
006560         NC"出荷処理済　削除不可".
006570     02  DEN-ERR           COLUMN   1   VALUE
006580         NC"該当伝票№使用中".
006590     02  MST-ERR           COLUMN   1   VALUE
006600         NC"受注マスタ　未登録".
006610*****02  ACT-ERR           COLUMN   1   VALUE                     D.980929
006620*****    NC"変更　不可".                                          D.980929
006630     02  ADV-ERR           COLUMN   1   VALUE
006640         NC"行クリア　不可".
006650***02  TM-ERR            COLUMN   1   VALUE                       D.940620
006660*****    NC"得意先マスタ　未登録".                                D.940620
006670***02  KL-ERR            COLUMN   1   VALUE                       D.940620
006680*****    NC"価格ランク　エラー".                                  D.940620
006690***02  HIM-ERR           COLUMN   1   VALUE                       D.940620
006700*****    NC"品名マスタ　未登録".                                  D.940620
006710     02  ERR-DNKN.
006720       03  DNK-ERR       COLUMN   1   VALUE
006730           NC"伝票№検索Ｆ未登録".
006740       03  DNK-A         COLUMN   20  VALUE  "KEY=".
006750       03  DNK-KEY       COLUMN   25  PIC X(15) FROM DNKN-KEY.
006760     COPY   LSMSG.
006770     02  DISP-MSG-SPACE-1  COLUMN  1    VALUE
006780       "                                       ".
006790 01  DSP-REV-AREA.
006800     02  DSP-RR-ALL.
006810         03  DSP-RR1    LINE   6.                                 I.131121
006820             04 DSP-RR101   COLUMN   3   PIC  X(04)               I.131121
006830                     USING     REV-101  REVERSE.                  I.131121
006840             04 DSP-RR102   COLUMN   8   PIC  X(04)               I.131121
006850                     USING     REV-102  REVERSE.                  I.131121
006860             04 DSP-RR103   COLUMN  13   PIC  X(04)               I.131121
006870                     USING     REV-103  REVERSE.                  I.131121
006880             04 DSP-RR104   COLUMN  18   PIC  X(04)               I.131121
006890                     USING     REV-104  REVERSE.                  I.131121
006900             04 DSP-RR105   COLUMN  23   PIC  X(04)               I.131121
006910                     USING     REV-105  REVERSE.                  I.131121
006920             04 DSP-RR106   COLUMN  28   PIC  X(04)               I.131121
006930                     USING     REV-106  REVERSE.                  I.131121
006940             04 DSP-RR107   COLUMN  33   PIC  X(04)               I.131121
006950                     USING     REV-107  REVERSE.                  I.131121
006960             04 DSP-RR108   COLUMN  38   PIC  X(04)               I.131121
006970                     USING     REV-108  REVERSE.                  I.131121
006980             04 DSP-RR109   COLUMN  43   PIC  X(04)               I.131121
006990                     USING     REV-109  REVERSE.                  I.131121
007000             04 DSP-RR110   COLUMN  50   PIC  X(04)               I.131121
007010                     USING     REV-110  REVERSE.                  I.131121
007020         03  DSP-RR2    LINE   7.                                 I.131121
007030             04 DSP-RR201   COLUMN   3   PIC  X(04)               I.131121
007040                     USING     REV-201  REVERSE.                  I.131121
007050             04 DSP-RR202   COLUMN   8   PIC  X(04)               I.131121
007060                     USING     REV-202  REVERSE.                  I.131121
007070             04 DSP-RR203   COLUMN  13   PIC  X(04)               I.131121
007080                     USING     REV-203  REVERSE.                  I.131121
007090             04 DSP-RR204   COLUMN  18   PIC  X(04)               I.131121
007100                     USING     REV-204  REVERSE.                  I.131121
007110             04 DSP-RR205   COLUMN  23   PIC  X(04)               I.131121
007120                     USING     REV-205  REVERSE.                  I.131121
007130             04 DSP-RR206   COLUMN  28   PIC  X(04)               I.131121
007140                     USING     REV-206  REVERSE.                  I.131121
007150             04 DSP-RR207   COLUMN  33   PIC  X(04)               I.131121
007160                     USING     REV-207  REVERSE.                  I.131121
007170             04 DSP-RR208   COLUMN  38   PIC  X(04)               I.131121
007180                     USING     REV-208  REVERSE.                  I.131121
007190             04 DSP-RR209   COLUMN  43   PIC  X(04)               I.131121
007200                     USING     REV-209  REVERSE.                  I.131121
007210             04 DSP-RR210   COLUMN  50   PIC  X(04)               I.131121
007220                     USING     REV-210  REVERSE.                  I.131121
007230         03  DSP-RR3    LINE   8.                                 I.131121
007240             04 DSP-RR301   COLUMN   3   PIC  X(04)               I.131121
007250                     USING     REV-301  REVERSE.                  I.131121
007260             04 DSP-RR302   COLUMN   8   PIC  X(04)               I.131121
007270                     USING     REV-302  REVERSE.                  I.131121
007280             04 DSP-RR303   COLUMN  13   PIC  X(04)               I.131121
007290                     USING     REV-303  REVERSE.                  I.131121
007300             04 DSP-RR304   COLUMN  18   PIC  X(04)               I.131121
007310                     USING     REV-304  REVERSE.                  I.131121
007320             04 DSP-RR305   COLUMN  23   PIC  X(04)               I.131121
007330                     USING     REV-305  REVERSE.                  I.131121
007340             04 DSP-RR306   COLUMN  28   PIC  X(04)               I.131121
007350                     USING     REV-306  REVERSE.                  I.131121
007360             04 DSP-RR307   COLUMN  33   PIC  X(04)               I.131121
007370                     USING     REV-307  REVERSE.                  I.131121
007380             04 DSP-RR308   COLUMN  38   PIC  X(04)               I.131121
007390                     USING     REV-308  REVERSE.                  I.131121
007400             04 DSP-RR309   COLUMN  43   PIC  X(04)               I.131121
007410                     USING     REV-309  REVERSE.                  I.131121
007420             04 DSP-RR310   COLUMN  50   PIC  X(04)               I.131121
007430                     USING     REV-310  REVERSE.                  I.131121
007440         03  DSP-RR4    LINE   9.                                 I.131121
007450             04 DSP-RR401   COLUMN   3   PIC  X(04)               I.131121
007460                     USING     REV-401  REVERSE.                  I.131121
007470             04 DSP-RR402   COLUMN   8   PIC  X(04)               I.131121
007480                     USING     REV-402  REVERSE.                  I.131121
007490             04 DSP-RR403   COLUMN  13   PIC  X(04)               I.131121
007500                     USING     REV-403  REVERSE.                  I.131121
007510             04 DSP-RR404   COLUMN  18   PIC  X(04)               I.131121
007520                     USING     REV-404  REVERSE.                  I.131121
007530             04 DSP-RR405   COLUMN  23   PIC  X(04)               I.131121
007540                     USING     REV-405  REVERSE.                  I.131121
007550             04 DSP-RR406   COLUMN  28   PIC  X(04)               I.131121
007560                     USING     REV-406  REVERSE.                  I.131121
007570             04 DSP-RR407   COLUMN  33   PIC  X(04)               I.131121
007580                     USING     REV-407  REVERSE.                  I.131121
007590             04 DSP-RR408   COLUMN  38   PIC  X(04)               I.131121
007600                     USING     REV-408  REVERSE.                  I.131121
007610             04 DSP-RR409   COLUMN  43   PIC  X(04)               I.131121
007620                     USING     REV-409  REVERSE.                  I.131121
007630             04 DSP-RR410   COLUMN  50   PIC  X(04)               I.131121
007640                     USING     REV-410  REVERSE.                  I.131121
007650*****  03 DSP-RR1     LINE   6  COLUMN   1   PIC  X(54)           D.131121
007660*****                USING     REV-1    REVERSE.                  D.131121
007670*****  03 DSP-RR2     LINE   7  COLUMN   1   PIC  X(54)           D.131121
007680*****                USING     REV-2    REVERSE.                  D.131121
007690*****  03 DSP-RR3     LINE   8  COLUMN   1   PIC  X(54)           D.131121
007700*****                USING     REV-3    REVERSE.                  D.131121
007710*****  03 DSP-RR4     LINE   9  COLUMN   1   PIC  X(54)           D.131121
007720*****                USING     REV-4    REVERSE.                  D.131121
007730     02  DSP-RC-ALL.
007740         03  DSP-RC1    LINE   6.                                 I.131121
007750             04  COLUMN   3   PIC  X(04)   USING  REV-101.        I.131121
007760             04  COLUMN   8   PIC  X(04)   USING  REV-102.        I.131121
007770             04  COLUMN  13   PIC  X(04)   USING  REV-103.        I.131121
007780             04  COLUMN  18   PIC  X(04)   USING  REV-104.        I.131121
007790             04  COLUMN  23   PIC  X(04)   USING  REV-105.        I.131121
007800             04  COLUMN  28   PIC  X(04)   USING  REV-106.        I.131121
007810             04  COLUMN  33   PIC  X(04)   USING  REV-107.        I.131121
007820             04  COLUMN  38   PIC  X(04)   USING  REV-108.        I.131121
007830             04  COLUMN  43   PIC  X(04)   USING  REV-109.        I.131121
007840             04  COLUMN  50   PIC  X(04)   USING  REV-110.        I.131121
007850         03  DSP-RC2    LINE   7.                                 I.131121
007860             04  COLUMN   3   PIC  X(04)   USING  REV-201.        I.131121
007870             04  COLUMN   8   PIC  X(04)   USING  REV-202.        I.131121
007880             04  COLUMN  13   PIC  X(04)   USING  REV-203.        I.131121
007890             04  COLUMN  18   PIC  X(04)   USING  REV-204.        I.131121
007900             04  COLUMN  23   PIC  X(04)   USING  REV-205.        I.131121
007910             04  COLUMN  28   PIC  X(04)   USING  REV-206.        I.131121
007920             04  COLUMN  33   PIC  X(04)   USING  REV-207.        I.131121
007930             04  COLUMN  38   PIC  X(04)   USING  REV-208.        I.131121
007940             04  COLUMN  43   PIC  X(04)   USING  REV-209.        I.131121
007950             04  COLUMN  50   PIC  X(04)   USING  REV-210.        I.131121
007960         03  DSP-RC3    LINE   8.                                 I.131121
007970             04  COLUMN   3   PIC  X(04)   USING  REV-301.        I.131121
007980             04  COLUMN   8   PIC  X(04)   USING  REV-302.        I.131121
007990             04  COLUMN  13   PIC  X(04)   USING  REV-303.        I.131121
008000             04  COLUMN  18   PIC  X(04)   USING  REV-304.        I.131121
008010             04  COLUMN  23   PIC  X(04)   USING  REV-305.        I.131121
008020             04  COLUMN  28   PIC  X(04)   USING  REV-306.        I.131121
008030             04  COLUMN  33   PIC  X(04)   USING  REV-307.        I.131121
008040             04  COLUMN  38   PIC  X(04)   USING  REV-308.        I.131121
008050             04  COLUMN  43   PIC  X(04)   USING  REV-309.        I.131121
008060             04  COLUMN  50   PIC  X(04)   USING  REV-310.        I.131121
008070         03  DSP-RC4    LINE   9.                                 I.131121
008080             04  COLUMN   3   PIC  X(04)   USING  REV-401.        I.131121
008090             04  COLUMN   8   PIC  X(04)   USING  REV-402.        I.131121
008100             04  COLUMN  13   PIC  X(04)   USING  REV-403.        I.131121
008110             04  COLUMN  18   PIC  X(04)   USING  REV-404.        I.131121
008120             04  COLUMN  23   PIC  X(04)   USING  REV-405.        I.131121
008130             04  COLUMN  28   PIC  X(04)   USING  REV-406.        I.131121
008140             04  COLUMN  33   PIC  X(04)   USING  REV-407.        I.131121
008150             04  COLUMN  38   PIC  X(04)   USING  REV-408.        I.131121
008160             04  COLUMN  43   PIC  X(04)   USING  REV-409.        I.131121
008170             04  COLUMN  50   PIC  X(04)   USING  REV-410.        I.131121
008180*****  03 DSP-RC1     LINE   6  COLUMN   1   PIC  X(54)           D.131121
008190*****                USING     REV-1.                             D.131121
008200*****  03 DSP-RC2     LINE   7  COLUMN   1   PIC  X(54)           D.131121
008210*****                USING     REV-2.                             D.131121
008220*****  03 DSP-RC3     LINE   8  COLUMN   1   PIC  X(54)           D.131121
008230*****                USING     REV-3.                             D.131121
008240*****  03 DSP-RC4     LINE   9  COLUMN   1   PIC  X(54)           D.131121
008250*****                USING     REV-4.                             D.131121
008260     COPY  LIBSCR.                                                I.980518
008270 PROCEDURE              DIVISION.
008280*************************************************
008290*    ＭＡＩＮ－ＲＴＮ　 （主処理）              *
008300*************************************************
008310 MAIN-RTN.
008320     PERFORM  OPEN-RTN       THRU  OPEN-EX.                       初期処理
008330     PERFORM  ACCEPT-RTN     THRU  ACCEPT-EX.                     画面入力
008340     PERFORM  END-RTN        THRU  END-EX.                        終了処理
008350     STOP     RUN.
008360     COPY   LPMSG.
008370*************************************************
008380*    行ＮＯ・・・・ＸＸ                         *                 添字１
008390*    数量単位・・・ＺＺ                         *                 添字３
008400*************************************************
008410*************************************************
008420*    初期　処理        ＯＰＥＮ－ＲＴＮ         *
008430*************************************************
008440 OPEN-RTN.
008450     DISPLAY DSP-CLEAR.
008460     DISPLAY DSP-MID.                                             I.030715
008470     MOVE    255  TO  COMPLETION-CODE.                            I.030715
008480 OPEN-005.                                                        I.030715
008490     ACCEPT   ACT-SIGN.
008500     IF  ESTAT         =  "P9"                                    I.030715
008510             DISPLAY  DSP-CLEAR                                   I.030715
008520             STOP     RUN.                                        I.030715
008530     IF  ESTAT    NOT  =  "01"  AND  "06"     GO  TO  OPEN-005.   I.030715
008540*****MOVE    255  TO  COMPLETION-CODE.                            D.030715
008550*****CALL    "SJ010I".                                            D.941024
008560*****IF      JS-SIGN  NOT  =   0 AND 1                            D.030702
008570*****IF      JS-SIGN  NOT  =   0 AND 1 AND 2                      D.070410
008580     IF      JS-SIGN  NOT  =   0 AND 1                            I.070410
008590                                              GO  TO  OPEN-005.   I.030715
008600*****        DISPLAY  EMSG-01 DISP-BUZ-B                          D.030715
008610*****        STOP     RUN.                                        D.030715
008620*****DISPLAY DSP-CLEAR.                                           D.030715
008630*****DISPLAY DSP-MID.                                             D.030715
008640 OPEN-010.                                                        I.941024
008650     ACCEPT  ACT-KBN.                                             I.941024
008660     IF  ESTAT         =  "P9"                                    I.941024
008670             DISPLAY  DSP-CLEAR                                   I.941024
008680             STOP     RUN.                                        I.941024
008690     IF  ESTAT         =  "09"                GO  TO  OPEN-005.   I.030715
008700     IF  ESTAT    NOT  =  "01"  AND  "06"     GO  TO  OPEN-010.   I.941024
008710     IF  W-KBN    NOT  =  0  AND  5  AND  6   GO  TO  OPEN-010.   I.941024
008720 OPEN-020.                                                        I.941024
008730     ACCEPT  ACT-OKC.                                             I.941024
008740     IF  ESTAT         =  "09"                GO  TO  OPEN-010.   I.941024
008750     IF  ESTAT    NOT  =  "01"  AND  "06"     GO  TO  OPEN-020.   I.941024
008760     IF  GMN-OKC       =  9                   GO  TO  OPEN-005.   I.030715
008770*****IF  GMN-OKC       =  9                   GO  TO  OPEN-010.   D.030715
008780     IF  GMN-OKC  NOT  =  1                   GO  TO  OPEN-020.   I.941024
008790*
008800     IF  W-KBN         =  0                                       I.941024
008810                  MOVE  NC"　受注入力　"   TO  W-MID.             I.941024
008820     IF  W-KBN         =  5                                       I.941024
008830                  MOVE  NC"　預り入力　"   TO  W-MID.             I.941024
008840     IF  W-KBN         =  6                                       I.941024
008850                  MOVE  NC"取りよけ入力"   TO  W-MID.             I.941024
008860     CALL    "SJ010I".                                            I.941024
008870     DISPLAY DSP-S0.                                              I.941024
008880     IF      JS-SIGN   =  0
008890             DISPLAY   DSP-S1
008900        ELSE                                                      I.030702
008910             DISPLAY   DSP-S2.                                    I.070410
008920*****        IF      JS-SIGN   =  1                               D.070410
008930*****                DISPLAY   DSP-S2                             D.070410
008940*****           ELSE DISPLAY   DSP-S3.                            D.070410
008950*****   ELSE DISPLAY   DSP-S2.                                    D.030702
008960*****OPEN    INPUT     TC-M SHM JTKB T-M HI-M  JT-THTN.           D.940620
008970*****OPEN    INPUT     TC-M SHM JTKB           JT-THTN.           I.940620
008980*****OPEN    INPUT     TC-M SHM                JT-THTN.           D.941005
008990*****OPEN    INPUT     TC-M SHM      T-M       JT-THTN.           D.010516
009000*****OPEN    INPUT     TC-M SHM      T-M.                         D.010808
009010*****OPEN    INPUT     TC-M HI2-M    T-M.                         D.040802
009020*****OPEN    INPUT     TC-M HI2-M    T-M  THTM.                   D.080602
009030     OPEN    INPUT     TC-M HI2-M    T-M  THTM  WTNAF.            I.080602
009040     OPEN    I-O       JMSTD JT-DNKN JCON JDCON.                  I.981027
009050*****OPEN    I-O       JMSTD JT-DNKN JT-JYTO JCON JDCON JHIZ.     D.971128
009060*****OPEN    I-O       JMSTD JT-DNKN JCON JDCON JHIZ.             D.981027
009070*****OPEN    EXTEND    JTRN.                                      D.981125
009080*****INITIALIZE        WK-DATE.                                   D.980518
009090*****ACCEPT  WK-DATE   FROM  DATE.                                D.980518
009100     MOVE    ALL NX"2121"    TO    W-TEKI.                        I.930118
009110     MOVE    ZERO            TO    W-EDATE.                       I.150622
009120     MOVE    11        TO    JCON1-KEY.
009130     READ    JCON      UNLOCK  INVALID
009140             MOVE      "JCON"  TO   ERR-F
009150             MOVE      JCON1-KEY TO ERR-K
009160             MOVE      "A"     TO   ERR-M
009170             PERFORM   ERR-RTN THRU ERR-EX.
009180     INITIALIZE        W-DATE.                                    I.980518
009190     ACCEPT  WK-DATES  FROM  DATE.                                I.980518
009200     COPY  LIBCPR.                                                I.980518
009210     IF WK-YY2 >= DATE-NF1 AND <= DATE-NT1                        I.980518
009220         ADD DATE-NC1 TO WK-YY.                                   I.980518
009230     IF WK-YY2 >= DATE-NF2 AND <= DATE-NT2                        I.980518
009240         ADD DATE-NC2 TO WK-YY.                                   I.980518
009250 OPEN-EX.
009260     EXIT.
009270*************************************************
009280*    画面　入力　　　　ＡＣＣＥＰＴ－ＲＴＮ     *
009290*************************************************
009300 ACCEPT-RTN.
009310     MOVE    10        TO    AA.
009320     PERFORM    CLR-RTN   THRU    CLR-EX.                         画面ｸﾘｱ
009330     IF   GMN-OKC   NOT =  5                                      I.930119
009340          GO  TO  ACC-ACT.                                        I.930119
009350*****IF   GMN-OKC   =  5                                          D.930119
009360*****     DISPLAY           ACT-ACT   DSP-ANAM                    D.930119
009370*****     MOVE  ZERO   TO   GMN-OKC                               D.930119
009380*****     IF    GMN-ACT  =  1              GO  TO  ACC-JYMD       D.930119
009390*****     ELSE                             GO  TO  ACC-JNO.       D.930119
009400     DISPLAY    ACT-ACT  DSP-ANAM.                                I.930119
009410     MOVE  ZERO        TO  GMN-OKC.                               I.930119
009420     IF  GMN-ACT    NOT =  1               GO  TO  ACC-JNO.       I.930119
009430     IF  JS-SIGN        =  0                                      I.930119
009440         DISPLAY       ACT-TEKI2.                                 I.930925
009450     IF  JS-SIGN        =  1                                      I.150622
009460         IF  W-EDATE    NOT =  ZERO                               I.150622
009470             MOVE   W-EDATE      TO  GMN-JYMD                     I.150622
009480             DISPLAY       ACT-JYMD.                              I.150622
009490     GO  TO  ACC-JYMD.                                            I.930119
009500*****    MOVE  W-TEKI      TO  GMN-TEKI                           D.930925
009510*****    DISPLAY       ACT-TEKI1  ACT-TEKI2.                      D.930925
009520*****    MOVE  W-TEKI2     TO  GMN-TEKI2                          D.930925
009530 ACC-ACT.                                                         I.930119
009540     INITIALIZE        GMN-AREA  WK-AREA.
009550     ACCEPT     ACT-ACT.                                          処理選択
009560     DISPLAY    DISP-MSG-SPACE-1.
009570     IF   ESTAT     =  "P9"                GO  TO  ACCEPT-EX.
009580     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACCEPT-RTN.
009590     IF   GMN-ACT NOT = 1 AND 2 AND 3      GO  TO  ACCEPT-RTN.
009600     MOVE       ALL NX"2121"   TO  GMN-TEKI.
009610     DISPLAY    ACT-TEKI1  ACT-TEKI2.
009620     IF   GMN-ACT   =  1
009630          DISPLAY   CLR-JNO
009640          MOVE  SPACE       TO  SW-ZERO
009650          MOVE  NC"追加"    TO  GMN-ANAM
009660     ELSE
009670        IF   GMN-ACT   =  2
009680          MOVE  NC"変更"    TO  GMN-ANAM
009690        ELSE
009700          MOVE  NC"取消"    TO  GMN-ANAM.
009710     DISPLAY    DSP-ANAM.
009720     INITIALIZE             GMN-DATA  WK-HCD.
009730     MOVE ZERO  TO  WS-SEQ.
009740     IF   GMN-ACT   =  1                                          I.061025
009750          DISPLAY   CLE-NO                                        I.061025
009760          GO  TO  ACC-JYMD.                                       I.061025
009770*****IF   GMN-ACT   =  1                   GO  TO  ACC-JYMD.      D.061025
009780 ACC-JNO.
009790     MOVE    ZERO      TO    GMN-NO  GMN-JNO.
009800     MOVE    1       TO     JCON1-01.                             I.061025
009810     MOVE    1       TO     JCON1-02.                             I.061025
009820     READ    JCON    UNLOCK  INVALID KEY                          I.061025
009830             INITIALIZE     JCON1-R.                              I.061025
009840     IF      JS-SIGN     =  0                                     I.061025
009850             MOVE   JCON1-03    TO     GMN-NO                     I.061025
009860     ELSE    MOVE   JCON1-04    TO     GMN-NO.                    I.070410
009870*****ELSE    IF      JS-SIGN     =  1                             D.070410
009880*****                MOVE   JCON1-04    TO     GMN-NO             D.070410
009890*****        ELSE    IF      JS-SIGN     =  2                     D.070410
009900*****                        MOVE   JCON1-05    TO     GMN-NO.    D.070410
009910     DISPLAY    DSP-NO.                                           I.061025
009920     DISPLAY    CLR-JNO.
009930 ACC-JNOR.
009940     MOVE    10        TO    AA.
009950     PERFORM    CLR-001  THRU  CLR-EX.
009960     INITIALIZE   GMN-HEAD GMN-DATA WK-AREA.
009970 ACC-JNO1.
009980     ACCEPT     ACT-JNO.                                          受注ＮＯ
009990     DISPLAY    DISP-MSG-SPACE-1.
010000     IF   ESTAT     =  "09"
010010                                           GO  TO  ACCEPT-RTN.
010020     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-JNO.
010030     MOVE     ZERO          TO  JMSTD-KEY1.
010040     MOVE     GMN-JNO       TO  JMSTD-07.
010050     START    JMSTD    KEY  NOT <     JMSTD-KEY1   INVALID KEY
010060              DISPLAY  INV-D01  DISP-BUZ-J GO  TO  ACC-JNOR.
010070     READ     JMSTD    NEXT UNLOCK    AT  END
010080              DISPLAY  INV-D01  DISP-BUZ-J GO  TO  ACC-JNOR.
010090     MOVE    JMSTD-KEY1     TO  WK-KEY.
010100     IF   GMN-JNO   NOT  =  JMSTD-07
010110              DISPLAY  INV-D01  DISP-BUZ-J GO  TO  ACC-JNOR.
010120     IF   W-KBN     NOT  =  JMSTD-01                              I.941024
010130              DISPLAY  EMSG-17  DISP-BUZ-J GO  TO  ACC-JNOR.      I.941024
010140*****MOVE     JMSTD-18      TO  URI-KB.                           D.981027
010150     PERFORM  HYOJI-RTN      THRU  HYOJI-EX.                      画面表示
010160*****PERFORM  CEK-RTN  THRU CEK-EX.
010170     MOVE     1             TO  JDCON-01.                         排他制御
010180     MOVE     GMN-JNO       TO  JDCON-02.
010190     WRITE    JDCON-R  INVALID
010200              DISPLAY  DEN-ERR  DISP-BUZ-J GO  TO  ACC-JNOR.
010210**
010220     IF       GMN-ACT  =  3  AND  SW-ZERO NOT = SPACE
010230              DISPLAY  EMSG-21 DISP-BUZ-J  GO  TO  ACC-JNOD.
010240     IF       GMN-ACT  = 3                 GO  TO  ACC-OKC.
010250*****IF       URI-KB   =  1                                       D.981027
010260*****    IF   GMN-ACT  =  2                GO  TO  ACC-SET.       D.981027
010270     GO TO  ACC-JYMD.
010280 ACC-JNOD.
010290     PERFORM    JDCON-RTN  THRU  JDCON-EX.
010300     GO  TO     ACC-JNOR.
010310 ACC-JYMD.
010320     ACCEPT     ACT-JYY.                                          受注日
010330     DISPLAY    DISP-MSG-SPACE-1.
010340     IF   ESTAT     =  "09"
010350       IF GMN-ACT   =   1                  GO  TO  ACCEPT-RTN
010360       ELSE                                GO  TO  ACC-JNOD.
010370     IF   ESTAT NOT =  "00" AND "01" AND "06"  GO  TO  ACC-JYMD.
010380*****IF   GMN-JYY   =   ZERO                                      D.980518
010390*****     MOVE  WK-DATE     TO  GMN-JYMD                          D.980518
010400*****     DISPLAY   ACT-JYMD               GO  TO  ACC-TMAT.      D.980518
010410 ACC-JMM.
010420     ACCEPT     ACT-JMM.
010430     DISPLAY    DISP-MSG-SPACE-1.
010440     IF   ESTAT     =  "09"                GO  TO  ACC-JYMD.
010450     IF   ESTAT NOT =  "00" AND "01" AND "06"  GO  TO  ACC-JMM.
010460     IF   GMN-JMM   =  ZERO                                       I.980518
010470          IF   GMN-JYY2     =   ZERO       GO  TO  ACC-JDD.       I.980518
010480     IF   GMN-JMM   <  1    OR       GMN-JMM   >   12
010490          DISPLAY   ERR-01  DISP-BUZ-J     GO  TO  ACC-JMM.
010500 ACC-JDD.
010510     ACCEPT     ACT-JDD.
010520     DISPLAY    DISP-MSG-SPACE-1.
010530     IF   ESTAT     =  "09"                GO  TO  ACC-JMM.
010540     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-JDD.
010550     IF   GMN-JDD   =  ZERO                                       I.980518
010560          IF   GMN-JMM      =   ZERO                              I.980518
010570               MOVE  WK-DATE         TO  GMN-JYMD                 I.980518
010580               DISPLAY   ACT-JYMD                                 I.980518
010590               GO  TO  ACC-TCD.                                   I.980518
010600     IF   GMN-JMM   <  1    OR       GMN-JMM   >   12             I.131004
010610          DISPLAY   ERR-01  DISP-BUZ-J     GO  TO  ACC-JMM.       I.131004
010620     IF   GMN-JDD   <  1    OR       GMN-JDD   >   31
010630          DISPLAY   ERR-01  DISP-BUZ-J     GO  TO  ACC-JDD.
010640     MOVE   ZERO    TO  GMN-JYY1.                                 I.980518
010650     IF GMN-JYY2 >= DATE-NF1 AND <= DATE-NT1                      I.980518
010660         ADD DATE-NC1 TO GMN-JYY.                                 I.980518
010670     IF GMN-JYY2 >= DATE-NF2 AND <= DATE-NT2                      I.980518
010680         ADD DATE-NC2 TO GMN-JYY.                                 I.980518
010690     IF GMN-JYMD <  WK-DATE                                       I.131004
010700*****    DISPLAY   ERR-01  DISP-BUZ-B                             D.150616
010710         DISPLAY   ERR-01  DISP-BUZ-J                             I.150616
010720         DISPLAY    DISP-MSG-SPACE-1.                             I.131004
010730*ACC-TMAT.                                                        D.980518
010740*****MOVE     SPACE         TO  SW-TKB.
010750*****MOVE     GMN-TCCD      TO  WK-TCCD.
010760*****ACCEPT     ACT-TMAT.                                         ＭＡＴ
010770*****DISPLAY    DISP-MSG-SPACE-1.
010780*****IF   ESTAT     =  "09"                GO  TO  ACC-JYMD.
010790*****IF   ESTAT     =  "02"
010800*****     MOVE  WK-TCCD     TO  GMN-TCCD   GO  TO  ACC-TCD.
010810*****IF   ESTAT NOT =  "00"  AND  "01" AND "06"                   *A621001
010820*****                                      GO  TO  ACC-TMAT.      ﾞ
010830*****MOVE     2             TO  JTKB-02.
010840*****READ     JTKB          UNLOCK    INVALID KEY
010850*****         DISPLAY  EMSG-03  DISP-BUZ-J GO  TO  ACC-TMAT.
010860*****MOVE     JTKB-03       TO  GMN-TCCD.
010870*****MOVE     "01"          TO  SW-TKB.
010880*****GO   TO    ACC-TNAM.
010890 ACC-TCD.
010900     DISPLAY    DSP-BAR  ACT-TCCD.
010910     ACCEPT     ACT-TCD.                                          得意先CD
010920     DISPLAY    DISP-MSG-SPACE-1.
010930*****IF   ESTAT     =  "02"                GO  TO  ACC-TMAT.
010940     IF   ESTAT     =  "09"                GO  TO  ACC-JYMD.
010950     IF   ESTAT NOT =  "00" AND "01" AND "06"
010960                                           GO  TO  ACC-TCD.
010970 ACC-TNAM.
010980     MOVE     GMN-TCD       TO  TC-TCD.
010990     MOVE     001           TO  TC-CCD.
011000     READ     TC-M          UNLOCK    INVALID KEY
011010              DISPLAY  EMSG-04  DISP-BUZ-J GO  TO  ACC-TCD.       I.980518
011020*****         DISPLAY  EMSG-04  DISP-BUZ-J GO  TO  ACC-TMAT.      D.980518
011030     MOVE     TC-NAME       TO  GMN-TNAM.
011040     MOVE     GMN-TCD       TO  T-KEY.                            I.941005
011050     READ     T-M           UNLOCK    INVALID KEY                 I.941005
011060              MOVE     ZERO       TO   T-TNC.                     I.941005
011070*****IF   SW-TKB    =  "01"                GO  TO  ACC-CNAM.
011080 ACC-CCD.
011090     ACCEPT     ACT-CCD.                                          直送先CD
011100     DISPLAY    DISP-MSG-SPACE-1.
011110*****IF   ESTAT     =  "09"                GO  TO  ACC-TMAT.      D.980518
011120     IF   ESTAT     =  "09"                GO  TO  ACC-TCD.       I.980518
011130     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-CCD.
011140 ACC-CNAM.
011150     MOVE     GMN-TCD       TO  TC-TCD.
011160     MOVE     GMN-CCD       TO  TC-CCD.
011170     READ     TC-M          UNLOCK    INVALID KEY
011180              DISPLAY  EMSG-05  DISP-BUZ-J GO  TO  ACC-CCD.
011190     MOVE     TC-NAME       TO  GMN-CNAM.
011200     MOVE     GMN-TCCD      TO  WK-TCCD.
011210     DISPLAY  DSP-BAR  ACT-TCCD  DSP-TNAM  DSP-CNAM.
011220     IF  TC-BIK          =  0              DISPLAY  DSP-BIKHO-CLE I.981106
011230                                     ELSE  DISPLAY  DSP-BIKHO.    I.981106
011240     IF    GMN-TCD   NOT = 9850                                   I.080602
011250           MOVE     ZERO      TO  GMN-TENC  WK-TENC               I.080602
011260           MOVE     SPACE     TO  GMN-TENM                        I.080602
011270           DISPLAY  CLR-TEN                                       I.080602
011280           GO  TO  ACC-SSU.                                       I.080602
011290     DISPLAY  DSP-TENN.                                           I.080602
011300 ACC-TEN.                                                         I.080602
011310     ACCEPT     ACT-TENC.                                         I.080602
011320     DISPLAY    DISP-MSG-SPACE-1.                                 I.080602
011330     IF   ESTAT     =  "09"                GO  TO  ACC-CCD.       I.080602
011340     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-TEN.       I.080602
011350     IF   GMN-TENC  =  ZERO                                       I.080602
011360          MOVE   SPACE      TO  WTNA-NAME  GO  TO  ACC-TENA.      I.080602
011370     MOVE     GMN-TENC      TO  WTNA-KEY.                         I.080602
011380     READ     WTNAF         UNLOCK    INVALID KEY                 I.080602
011390              DISPLAY  EMSG-18  DISP-BUZ-J GO  TO  ACC-TEN.       I.080602
011400     IF   WTNA-OSN  =  0                                          I.080602
011410          IF   GMN-CCD       =  003                               I.080602
011420               DISPLAY  EMSG-19  DISP-BUZ-J GO  TO  ACC-TEN.      I.080602
011430     IF   WTNA-OSN  =  1                                          I.080602
011440          IF   GMN-CCD       =  002                               I.080602
011450               DISPLAY  EMSG-19  DISP-BUZ-J GO  TO  ACC-TEN.      I.080602
011460 ACC-TENA.                                                        I.080602
011470     MOVE     WTNA-NAME     TO  GMN-TENM.                         I.080602
011480     MOVE     GMN-TENC      TO  WK-TENC.                          I.080602
011490     DISPLAY  DSP-TEN.                                            I.080602
011500 ACC-SSU.
011510     ACCEPT     ACT-SET.                                          ｾｯﾄ数
011520     DISPLAY    DISP-MSG-SPACE-1.
011530     IF   ESTAT     =  "09"
011540          IF  GMN-TCD   =   9850           GO  TO  ACC-TEN        I.080602
011550          ELSE                             GO  TO  ACC-TCD.       I.080602
011560*****     IF  GMN-ACT   =   3              GO  TO  ACC-JNOD       D.080602
011570*****     ELSE                             GO  TO  ACC-TCD.       D.080602
011580*****     ELSE                             GO  TO  ACC-TMAT.      D.980518
011590     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-SSU.
011600     DISPLAY    DSP-SET.
011610*****IF   GMN-ACT   =   3                                         D.080602
011620*****  IF GMN-SET   >   WK-SU3             GO  TO  ACC-SSU        D.080602
011630*****  ELSE                                GO  TO  ACC-SET.       D.080602
011640*ACC-KAK.                                                         D.980518
011650 ACC-SET.
011660     MOVE     ZERO          TO  W-YDATE.                          I.930925
011670     MOVE     1             TO  CHKNO.                            I.931225
011680     MOVE     10            TO  AA.                               LINE-NO
011690     MOVE     1             TO  XX.                               LINE-NO
011700 ACC-HMAT.                                                        品名
011710     MOVE     GMN-HCD(XX)   TO  WK-HCD.
011720*****IF    (  GMN-ACT  =  3 ) OR ( GMN-ACT = 2 AND URI-KB = 1 )   D.981027
011730*****IF       GMN-ACT  =  3                                       D.080602
011740*****   IF    WK-HCD   =  ZERO             GO  TO  ACC-SEL        D.080602
011750*****   ELSE                               GO  TO  ACC-HRED.      D.080602
011760*****IF    (  GMN-ACT NOT = 1 ) AND ( WK-HCD = ZERO )
011770*****                                      GO  TO  ACC-SEL.
011780*****ACCEPT     ACT-HMAT.                                         ＭＡＴ
011790*****DISPLAY    DISP-MSG-SPACE-1.
011800*****IF   ESTAT     =  "09"                GO  TO  ACC-BACK-R.
011810*****IF   ESTAT     =  "04"
011820*****     IF  XX    =  1
011830*****         MOVE  WK-HCD  TO  GMN-HCD(XX)
011840*****         DISPLAY  CLR-HCD  ACT-HCD    GO  TO  ACC-HMAT
011850*****     ELSE      MOVE    XX  TO  WW     GO  TO  ACC-ADV.
011860*****IF   ESTAT     =  "03"
011870*****               MOVE    XX  TO  WW     GO  TO  ACC-ADV.
011880*****IF   ESTAT     =  "02"                GO  TO  ACC-HCD.
011890*****IF   ESTAT NOT =  "00"  AND   "01"  AND  "06"                *R621001
011900*****                                      GO  TO  ACC-HMAT.      ﾞ
011910*****MOVE     1             TO  JTKB-02.
011920*****READ     JTKB          UNLOCK    INVALID KEY
011930*****         DISPLAY  EMSG-03  DISP-BUZ-J GO  TO  ACC-HMAT.
011940*****MOVE     JTKB-03       TO  GMN-HCD(XX).
011950*****GO   TO    ACC-HNAM.
011960 ACC-HCD.
011970     MOVE     WK-HCD        TO  GMN-HCD(XX).
011980     DISPLAY    CLR-HCD  ACT-HCD.
011990 ACC-HMAT-E.
012000     ACCEPT     ACT-HCD.                                          品名　CD
012010     DISPLAY    DISP-MSG-SPACE-1.
012020     IF   ESTAT     =  "09"                GO  TO  ACC-BACK-R.
012030*****IF   ESTAT     =  "02"                GO  TO  ACC-HMAT.
012040     IF   ESTAT     =  "04"
012050          IF  XX    =  1
012060              MOVE  WK-HCD  TO  GMN-HCD(XX)
012070              DISPLAY  EMSG-08  ACT-HCD    GO  TO  ACC-HMAT-E
012080          ELSE      MOVE    XX  TO  WW     GO  TO  ACC-ADV.
012090     IF   ESTAT     =  "03"
012100                    MOVE    XX  TO  WW     GO  TO  ACC-ADV.
012110     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-HCD.
012120     IF   JS-SIGN   =   0                                         I.941227
012130          IF   ESTAT     =  "01"                                  I.941227
012140               IF   GMN-HCD(XX)     =  ZERO                       I.941227
012150                    IF   XX              >  1                     I.941227
012160*****                    IF   ZERO          =  GMN-SU(ZZ,1)       D.950106
012170*****                                     AND  GMN-SU(ZZ,2)       D.950106
012180*****                                     AND  GMN-SU(ZZ,3)       D.950106
012190*****                                     AND  GMN-SU(ZZ,4)       D.950106
012200*****                                     AND  GMN-SU(ZZ,5)       D.950106
012210*****                                     AND  GMN-SU(ZZ,6)       D.950106
012220*****                                     AND  GMN-SU(ZZ,7)       D.950106
012230*****                                     AND  GMN-SU(ZZ,8)       D.950106
012240*****                                     AND  GMN-SU(ZZ,9)       D.950106
012250*****                                     AND  GMN-SU(ZZ,10)      D.950106
012260                         IF   ZERO          =  GMN-SU(XX,1)       I.950106
012270                                          AND  GMN-SU(XX,2)       I.950106
012280                                          AND  GMN-SU(XX,3)       I.950106
012290                                          AND  GMN-SU(XX,4)       I.950106
012300                                          AND  GMN-SU(XX,5)       I.950106
012310                                          AND  GMN-SU(XX,6)       I.950106
012320                                          AND  GMN-SU(XX,7)       I.950106
012330                                          AND  GMN-SU(XX,8)       I.950106
012340                                          AND  GMN-SU(XX,9)       I.950106
012350                                          AND  GMN-SU(XX,10)      I.950106
012360                            COMPUTE  XXW     =   XX   -   1       I.941227
012370                            MOVE   GMN-HCD(XXW)   TO  GMN-HCD(XX) I.941227
012380                            DISPLAY  ACT-HCD.                     I.941227
012390 ACC-HNAM.
012400     IF   GMN-HCD(XX)  =    ZERO           GO  TO  ACC-HMAT.
012410     IF   GMN-HCD(XX)  >    999899         GO  TO  ACC-HMAT.      I.040728
012420     MOVE     1             TO  WW.                               I.980929
012430*****GO   TO   ACC-HCD-CHECK.                                     D.980929
012440 ACC-HNAM-R.
012450     IF   GMN-HCD(XX)  NOT  =   WK-HCD  AND
012460          WK-HCD       NOT  =   ZERO
012470          MOVE    GMN-HCD(XX)   TO  WK-HCD
012480          INITIALIZE            GMN-MEISAI(XX)
012490          MOVE    WK-HCD        TO  GMN-HCD(XX)
012500          DISPLAY      CLR-01  CLR-02  CLR-BIKHO CLR-03  ACT-HCD. I.980604
012510*****     DISPLAY      CLR-01  CLR-02  CLR-03  ACT-HCD.           D.980604
012520 ACC-HRED.
012530*****MOVE     GMN-HCD(XX)   TO  SHM-01  WK-HCD.                   D.010808
012540*****READ     SHM           UNLOCK    INVALID KEY                 D.010808
012550     MOVE     GMN-HCD(XX)   TO  HI-MHCD HI-HCD WK-HCD.            I.010808
012560     READ     HI2-M         UNLOCK    INVALID KEY                 I.010808
012570              DISPLAY  EMSG-06  DISP-BUZ-J GO  TO  ACC-HMAT.      I.080602
012580*****         DISPLAY  EMSG-06  DISP-BUZ-J GO  TO  ACC-HINV.      D.080602
012590     MOVE     0             TO  HI-S4(10).                        I.010808
012600     MOVE     HI-NAME       TO  WK-NAM.                           I.010808
012610     MOVE     HI-BCD1       TO  GMN-BCD1(XX).                     I.040601
012620     MOVE     HI-BC3        TO  HINCD.                            I.010808
012630*****MOVE     0             TO  SHM-0441(10).                     D.010808
012640*****MOVE     SHM-02        TO  WK-NAM.                           D.010808
012650*****MOVE     SHM-05        TO  HINCD.                            D.010808
012660     MOVE     WK-NAM1       TO  GMN-HNAM1(XX).
012670     MOVE     WK-NAM2       TO  GMN-HNAM2(XX).
012680     DISPLAY  CLR-HCD  ACT-HCD   DSP-HNAM.
012690*****IF    (  JS-SIGN  = 1 AND  HIN-01 = 2 )                      D.010601
012700*****   OR (  JS-SIGN  = 0 AND  HIN-01 NOT = 2 )                  D.010601
012710*****IF    (  JS-SIGN  = 1 AND  HIN-01 = 3 )                      D.030702
012720*****   OR (  JS-SIGN  = 0 AND  HIN-01 NOT = 3 )                  D.030702
012730*****IF    (  JS-SIGN  = 1 AND  HIN-01 NOT = 2 )                  D.030812
012740*****   OR (  JS-SIGN  = 0 AND  HIN-01 NOT = 3 )                  D.030812
012750*****   OR (  JS-SIGN  = 2 AND  HIN-01 NOT = 1 )                  D.030812
012760*****   OR (  JS-SIGN  = 2 AND  HIN-01 NOT = 1 )                  D.030812
012770*****         DISPLAY  EMSG-07  DISP-BUZ-J                        D.030812
012780*****         GO  TO   ACC-HINV.                                  D.030812
012790     IF    JS-SIGN  = 0 AND  HIN-01  = 3                          I.030812
012800         GO  TO   ACC-SIZ.
012810*****IF    JS-SIGN  = 1 AND  HIN-01  = 2  AND  HI-BC1 NOT = 32    D.070410
012820     IF    JS-SIGN  = 1 AND  HIN-01  NOT = 3                      I.070410
012830         GO  TO   ACC-SIZ.                                        I.030812
012840*****IF    JS-SIGN  = 2 AND  (HIN-01 = 1 OR HI-BC1 = 32)          D.070410
012850*****    GO  TO   ACC-SIZ.                                        D.070410
012860     DISPLAY  EMSG-07  DISP-BUZ-J.                                I.030812
012870*ACC-HINV.
012880*****IF  (  GMN-ACT =  3 ) OR ( GMN-ACT = 2 AND URI-KB = 1 )      D.981027
012890*****IF     GMN-ACT =  3                                          D.080602
012900*****           GO  TO  ACC-JNO.                                  D.080602
012910     GO  TO  ACC-HMAT.
012920 ACC-SIZ.
012930*****IF ( GMN-ACT = 2 ) AND ( URI-KB = 1 )                        D.981027
012940*****   OR ( GMN-ACT = 3   )               GO  TO  ACC-SIZ1.      D.981027
012950*****IF      GMN-ACT = 3                   GO  TO  ACC-SIZ1.      D.080602
012960     ACCEPT     ACT-SIZ.
012970     DISPLAY    DISP-MSG-SPACE-1.
012980*****IF   ESTAT     =  "09"                                       D.981027
012990*****  IF GMN-ACT   =   2 AND  URI-KB = 1  GO  TO  ACC-BACK-R     D.981027
013000*****  ELSE                                GO  TO  ACC-HMAT.      D.981027
013010     IF   ESTAT     =  "09"                GO  TO  ACC-HMAT.      I.981027
013020     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-SIZ.
013030     IF   GMN-SIZ(XX) NOT = 1 AND 2 AND 3 AND 4 GO TO  ACC-SIZ.
013040 ACC-SIZ1.
013050     MOVE     GMN-SIZ(XX)   TO  YY.
013060     MOVE    "OF"    TO     REV-SW.
013070     IF   GMN-SIZ(XX) = 1
013080          IF  HI-SS1   = ZERO              GO  TO  ACC-SIZ-ERR.   I.010808
013090*****     IF  SHM-041  = ZERO OR SPACE     GO  TO  ACC-SIZ-ERR.   D.010808
013100     IF   GMN-SIZ(XX) = 2
013110          IF  HI-SS2   = ZERO              GO  TO  ACC-SIZ-ERR.   I.010808
013120*****     IF  SHM-042  = ZERO OR SPACE     GO  TO  ACC-SIZ-ERR.   D.010808
013130     IF   GMN-SIZ(XX) = 3
013140          IF  HI-SS3   = ZERO              GO  TO  ACC-SIZ-ERR.   I.010808
013150*****     IF  SHM-043  = ZERO OR SPACE     GO  TO  ACC-SIZ-ERR.   D.010808
013160     IF   GMN-SIZ(XX) = 4
013170          IF  HI-SS4   = ZERO              GO  TO  ACC-SIZ-ERR.   I.010808
013180*****     IF  SHM-044  = ZERO OR SPACE     GO  TO  ACC-SIZ-ERR.   D.010808
013190*****     IF (SHM-0441(1) = ZERO OR SPACE) AND                    D.980929
013200*****        (SHM-0441(2) = ZERO OR SPACE) AND                    D.980929
013210*****        (SHM-0441(3) = ZERO OR SPACE) AND                    D.980929
013220*****        (SHM-0441(4) = ZERO OR SPACE) AND                    D.980929
013230*****        (SHM-0441(5) = ZERO OR SPACE) AND                    D.980929
013240*****        (SHM-0441(6) = ZERO OR SPACE) AND                    D.980929
013250*****        (SHM-0441(7) = ZERO OR SPACE) AND                    D.980929
013260*****        (SHM-0441(8) = ZERO OR SPACE) AND                    D.980929
013270*****        (SHM-0441(9) = ZERO OR SPACE) GO  TO  ACC-SIZ-ERR.   D.980929
013280*****IF   REV-SW   =   "OF"                                       D.131121
013290*****     PERFORM  REV-DSP-RTN  THRU  REV-DSP-EX                  D.131121
013300*****     MOVE     "ON"    TO   REV-SW.                           D.131121
013310*****IF ( GMN-ACT = 2 ) AND ( URI-KB = 1 ) GO  TO  ACC-NYMD.      D.981027
013320     GO  TO   ACC-SIZE.
013330 ACC-SIZ-ERR.
013340     DISPLAY  EMSG-09  DISP-BUZ-J.
013350*****IF  GMN-ACT = 3                      GO  TO  ACC-SSU.        D.080602
013360     GO  TO   ACC-SIZ.
013370 ACC-SIZE.
013380     MOVE     1             TO  ZZ.
013390     MOVE     3             TO  BB.
013400     IF   YY  =  1                         GO  TO  ACC-S1.
013410     IF   YY  =  2                         GO  TO  ACC-S2.
013420     IF   YY  =  3                         GO  TO  ACC-S3.
013430     IF   YY  =  4                         GO  TO  ACC-S4.
013440 ACC-S1.
013450*****IF   SHM-0411(ZZ)  =   ZERO                                  D.010808
013460     IF   HI-S1(ZZ)     =   ZERO                                  I.010808
013470          MOVE    0  TO     GMN-SU(XX ZZ)
013480          DISPLAY DSP-SU1
013490          IF  ZZ  =  10
013500                                           GO  TO  ACC-KEI        A630703
013510          ELSE    ADD   1   TO  ZZ
013520              IF  ZZ    =   10
013530                  ADD   7   TO  BB         GO  TO  ACC-S1
013540              ELSE
013550                  ADD   5   TO  BB         GO  TO  ACC-S1.
013560     PERFORM  REV-DSP-RTN  THRU  REV-DSP-EX.                      I.131121
013570     MOVE     GMN-SU(XX ZZ)  TO  WK-SURYO.
013580     ACCEPT     ACT-SU1.                                          数量
013590     DISPLAY    DISP-MSG-SPACE-1.
013600     PERFORM  REV-CLE-RTN  THRU  REV-CLE-EX.                      I.131121
013610     IF   ESTAT     =  "09"                GO  TO  ACC-B1.
013620     IF   ESTAT     =  "04"
013630          MOVE  WK-SURYO    TO  GMN-SU(XX ZZ)
013640          DISPLAY   DSP-SU1                GO  TO  ACC-KEI-1.
013650     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-S1.
013660     MOVE     GMN-SU(XX ZZ)  TO  WK-SURYO.
013670     DISPLAY    DSP-SU1.
013680     PERFORM  CHK-SU-RTN  THRU  CHK-SU-EX.
013690     IF   CHK-SW  =  1                     GO  TO  ACC-S1.
013700     IF   ZZ  =     10
013710          GO   TO  ACC-KEI.
013720     ADD      1             TO  ZZ.
013730     IF   ZZ  =  10
013740          COMPUTE    BB  =  BB  +  7
013750     ELSE COMPUTE    BB  =  BB  +  5.
013760     GO   TO    ACC-S1.
013770 ACC-B1.
013780     IF   ZZ  =  1                         GO  TO  ACC-BS.
013790     IF   ZZ  =  10
013800          COMPUTE    BB  =  BB  -  7
013810     ELSE COMPUTE    BB  =  BB  -  5.
013820     COMPUTE     ZZ   =     ZZ  -  1.
013830 ACC-B1-R.
013840*****IF   SHM-0411(ZZ)  =   ZERO           GO  TO  ACC-B1         D.010808
013850     IF   HI-S1(ZZ)     =   ZERO           GO  TO  ACC-B1         I.010808
013860     ELSE                                  GO  TO  ACC-S1.
013870 ACC-S2.
013880*****IF   SHM-0421(ZZ)  =   ZERO                                  D.010808
013890     IF   HI-S2(ZZ)     =   ZERO                                  I.010808
013900          MOVE    0  TO     GMN-SU(XX ZZ)
013910          DISPLAY DSP-SU1
013920          IF  ZZ  =  10
013930                                           GO  TO  ACC-KEI
013940          ELSE    ADD   1   TO  ZZ
013950              IF  ZZ    =   10
013960                  ADD   7   TO  BB         GO  TO  ACC-S2
013970              ELSE
013980                  ADD   5   TO  BB         GO  TO  ACC-S2.
013990     PERFORM  REV-DSP-RTN  THRU  REV-DSP-EX.                      I.131121
014000     MOVE      GMN-SU(XX ZZ) TO  WK-SURYO.
014010     ACCEPT     ACT-SU1.                                          数量
014020     DISPLAY    DISP-MSG-SPACE-1.
014030     PERFORM  REV-CLE-RTN  THRU  REV-CLE-EX.                      I.131121
014040     IF   ESTAT     =  "09"                GO  TO  ACC-B2.
014050     IF   ESTAT     =  "04"
014060          MOVE  WK-SURYO    TO  GMN-SU(XX ZZ)
014070          DISPLAY      DSP-SU1
014080          GO  TO  ACC-KEI-1.
014090     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-S2.
014100     MOVE     GMN-SU(XX ZZ)  TO  WK-SURYO.
014110     DISPLAY    DSP-SU1.
014120     PERFORM  CHK-SU-RTN  THRU  CHK-SU-EX.
014130     IF   CHK-SW  =  1                     GO  TO  ACC-S2.
014140     IF   ZZ  =     10                     GO  TO  ACC-KEI.
014150     ADD      1             TO  ZZ.
014160     IF   ZZ  =  10
014170          COMPUTE    BB  =  BB  +  7
014180     ELSE COMPUTE    BB  =  BB  +  5.
014190     GO   TO    ACC-S2.
014200 ACC-B2.
014210     IF   ZZ  =  1                         GO  TO  ACC-BS.
014220     IF   ZZ  =  10
014230          COMPUTE    BB  =  BB  -  7
014240     ELSE COMPUTE    BB  =  BB  -  5.
014250     COMPUTE     ZZ   =     ZZ  -  1.
014260 ACC-B2-R.
014270*****IF   SHM-0421(ZZ)  =   ZERO           GO  TO  ACC-B2         D.010808
014280     IF   HI-S2(ZZ)     =   ZERO           GO  TO  ACC-B2         I.010808
014290     ELSE                                  GO  TO  ACC-S2.
014300 ACC-S3.
014310*****IF   SHM-0431(ZZ)  =   ZERO                                  D.010808
014320     IF   HI-S3(ZZ)     =   ZERO                                  I.010808
014330          MOVE    0  TO     GMN-SU(XX ZZ)
014340          DISPLAY DSP-SU1
014350          IF  ZZ  =  10
014360                  GO  TO  ACC-KEI
014370          ELSE    ADD   1   TO  ZZ
014380              IF  ZZ    =   10
014390                  ADD   7   TO  BB         GO  TO  ACC-S3
014400              ELSE
014410                  ADD   5   TO  BB         GO  TO  ACC-S3.
014420     PERFORM  REV-DSP-RTN  THRU  REV-DSP-EX.                      I.131121
014430     MOVE      GMN-SU(XX ZZ) TO  WK-SURYO.
014440     ACCEPT     ACT-SU1.                                          数量
014450     DISPLAY    DISP-MSG-SPACE-1.
014460     PERFORM  REV-CLE-RTN  THRU  REV-CLE-EX.                      I.131121
014470     IF   ESTAT     =  "09"                GO  TO  ACC-B3.
014480     IF   ESTAT     =  "04"
014490          MOVE  WK-SURYO    TO  GMN-SU(XX ZZ)
014500          DISPLAY      DSP-SU1
014510          GO  TO  ACC-KEI-1.
014520     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-S3.
014530     MOVE      GMN-SU(XX ZZ) TO  WK-SURYO.
014540     DISPLAY    DSP-SU1.
014550     PERFORM  CHK-SU-RTN  THRU  CHK-SU-EX.
014560     IF   CHK-SW  =  1                     GO  TO  ACC-S3.
014570     IF   ZZ  =     10
014580                                           GO  TO  ACC-KEI.
014590     ADD      1             TO  ZZ.
014600     IF   ZZ  =  10
014610          COMPUTE    BB  =  BB  +  7
014620     ELSE COMPUTE    BB  =  BB  +  5.
014630     GO   TO    ACC-S3.
014640 ACC-B3.
014650     IF   ZZ  =  1                         GO  TO  ACC-BS.
014660     IF   ZZ  =  10
014670          COMPUTE    BB  =  BB  -  7
014680     ELSE COMPUTE    BB  =  BB  -  5.
014690     COMPUTE     ZZ   =     ZZ  -  1.
014700 ACC-B3-R.
014710*****IF   SHM-0431(ZZ)  =   ZERO           GO  TO  ACC-B3         D.010808
014720     IF   HI-S3(ZZ)     =   ZERO           GO  TO  ACC-B3         I.010808
014730     ELSE                                  GO  TO  ACC-S3.
014740 ACC-S4.
014750*****IF   SHM-0441(ZZ)  =   ZERO                                  D.010808
014760     IF   HI-S4(ZZ)     =   ZERO                                  I.010808
014770          MOVE    0  TO     GMN-SU(XX ZZ)
014780          DISPLAY   DSP-SU1                                       I.980929
014790*****     IF  ZZ  =  9                                            D.980929
014800*****         DISPLAY   DSP-SU1                                   D.980929
014810*****         ADD    1      TO  ZZ                                D.980929
014820*****         ADD    5      TO  BB                                D.980929
014830*****         IF  GMN-SU(XX 01) = ZERO   AND                      D.980929
014840*****             GMN-SU(XX 02) = ZERO   AND                      D.980929
014850*****             GMN-SU(XX 03) = ZERO   AND                      D.980929
014860*****             GMN-SU(XX 04) = ZERO   AND                      D.980929
014870*****             GMN-SU(XX 05) = ZERO   AND                      D.980929
014880*****             GMN-SU(XX 06) = ZERO   AND                      D.980929
014890*****             GMN-SU(XX 07) = ZERO   AND                      D.980929
014900*****             GMN-SU(XX 08) = ZERO   AND                      D.980929
014910*****             GMN-SU(XX 09) = ZERO                            D.980929
014920*****             GO  TO  ACC-S4                                  D.980929
014930*****         ELSE                                                D.980929
014940*****             MOVE  ZERO    TO   GMN-SU(XX ZZ)                D.980929
014950*****             DISPLAY   DSP-SU2                               D.980929
014960*****             GO  TO  ACC-KEI                                 D.980929
014970*****     ELSE                                                    D.980929
014980          IF  ZZ    =   10
014990*****             MOVE  ZERO    TO   GMN-SU(XX ZZ)                D.980929
015000*****             DISPLAY   DSP-SU2                               D.980929
015010                  GO  TO  ACC-KEI
015020              ELSE
015030*****             DISPLAY   DSP-SU1                               D.980929
015040                  ADD   1   TO  ZZ
015050                  IF  ZZ    =   10                                I.980929
015060                      ADD   7   TO  BB         GO  TO  ACC-S4     I.980929
015070                  ELSE                                            I.980929
015080                      ADD   5   TO  BB         GO  TO  ACC-S4.
015090     PERFORM  REV-DSP-RTN  THRU  REV-DSP-EX.                      I.131121
015100     MOVE      GMN-SU(XX ZZ) TO  WK-SURYO.
015110*****IF   ZZ  =   10                                              D.980929
015120*****     ACCEPT  ACT-SU2                                         D.980929
015130*****ELSE ACCEPT  ACT-SU1.                                        D.980929
015140     ACCEPT  ACT-SU1.                                             I.980929
015150     DISPLAY    DISP-MSG-SPACE-1.
015160     PERFORM  REV-CLE-RTN  THRU  REV-CLE-EX.                      I.131121
015170     IF   ESTAT     =  "09"                GO  TO  ACC-B4.
015180     IF   ESTAT     =  "04"
015190          MOVE  WK-SURYO    TO  GMN-SU(XX ZZ)
015200*****     IF   ZZ   =  10   DISPLAY   DSP-SU2                     D.980929
015210*****                       GO  TO  ACC-KEI-1                     D.980929
015220*****     ELSE              DISPLAY   DSP-SU1                     D.980929
015230                            DISPLAY   DSP-SU1                     I.980929
015240                            GO  TO  ACC-KEI-1.
015250     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-S4.
015260     MOVE      GMN-SU(XX ZZ) TO  WK-SURYO.
015270*****IF   ZZ  =     10                                            D.980929
015280*****     DISPLAY   DSP-SU2                                       D.980929
015290*****ELSE DISPLAY   DSP-SU1.                                      D.980929
015300     DISPLAY   DSP-SU1.                                           I.980929
015310     PERFORM  CHK-SU-RTN  THRU  CHK-SU-EX.
015320     IF   CHK-SW  =  1                     GO  TO  ACC-S4.
015330*****IF   ZZ  =     9                                             D.980929
015340*****     ADD       1       TO  ZZ                                D.980929
015350*****     ADD       5       TO  BB                                D.980929
015360*****     IF  GMN-SU(XX 01) = ZERO   AND                          D.980929
015370*****         GMN-SU(XX 02) = ZERO   AND                          D.980929
015380*****         GMN-SU(XX 03) = ZERO   AND                          D.980929
015390*****         GMN-SU(XX 04) = ZERO   AND                          D.980929
015400*****         GMN-SU(XX 05) = ZERO   AND                          D.980929
015410*****         GMN-SU(XX 06) = ZERO   AND                          D.980929
015420*****         GMN-SU(XX 07) = ZERO   AND                          D.980929
015430*****         GMN-SU(XX 08) = ZERO   AND                          D.980929
015440*****         GMN-SU(XX 09) = ZERO      GO  TO  ACC-S4            D.980929
015450*****     ELSE                                                    D.980929
015460*****         GO  TO  ACC-KEI                                     D.980929
015470*****ELSE                                                         D.980929
015480     IF  ZZ  =  10
015490         GO  TO  ACC-KEI.
015500     ADD      1             TO  ZZ.
015510*****ADD      5             TO  BB.                               D.980929
015520     IF  ZZ  =  10                                                I.980929
015530             ADD      7             TO  BB                        I.980929
015540     ELSE    ADD      5             TO  BB.                       I.980929
015550     GO   TO    ACC-S4.
015560 ACC-B4.
015570     IF   ZZ  =  1                         GO  TO  ACC-BS.
015580     IF   ZZ  =  10
015590          COMPUTE    BB  =  BB  -  7
015600     ELSE COMPUTE    BB  =  BB  -  5.
015610     COMPUTE     ZZ   =     ZZ  -  1.
015620 ACC-B4-R.
015630*****IF   SHM-0441(ZZ)  =   ZERO           GO  TO  ACC-B4         D.010808
015640     IF   HI-S4(ZZ)     =   ZERO           GO  TO  ACC-B4         I.010808
015650     ELSE                                  GO  TO  ACC-S4.
015660 ACC-BS.
015670*****IF   GMN-ACT  =  3  AND URI-KB = 1    GO  TO  ACC-BACK-R.    D.981027
015680     GO  TO  ACC-SIZ.
015690 ACC-KEI-1.
015700     MOVE     0    TO    CHK-SW.
015710     PERFORM  CHK-SU1-RTN  THRU  CHK-SU1-EX
015720              VARYING   P  FROM  1  BY  1
015730              UNTIL   ( P > 10 ) OR ( CHK-SW = 1 ).
015740     IF       CHK-SW =  1
015750              DISPLAY   EMSG-12 DISP-BUZ-J
015760              GO  TO    ACC-SIZE.
015770 ACC-KEI.
015780     MOVE     ZERO          TO  GMN-KEI(XX).
015790     MOVE     1             TO  ZZ.
015800 ACC-KEI-A.
015810     ADD      GMN-SU(XX  ZZ)    TO     GMN-KEI(XX).
015820     IF   ZZ  =     10
015830                                           GO  TO  ACC-KEI-D
015840     ELSE ADD   1   TO   ZZ                GO  TO  ACC-KEI-A.
015850 ACC-KEI-D.
015860     DISPLAY    DSP-KEI.
015870*****IF  GMN-ACT NOT =   3                                        D.080602
015880     IF   GMN-KEI(XX)     = ZERO
015890                  DISPLAY  EMSG-14 DISP-BUZ-J
015900                  GO  TO  ACC-SIZE.
015910*****IF   GMN-ACT  =  1                                           D.010516
015920*****     PERFORM    TAN-RTN  THRU  TAN-EX.                       D.010516
015930     DISPLAY    DSP-TAN.
015940 ACC-NYMD.
015950     DISPLAY    DSP-NA DSP-NB.
015960     ACCEPT     ACT-NYY.
015970     DISPLAY    DISP-MSG-SPACE-1.
015980*****IF   ESTAT     =  "09"                                       D.981027
015990***** IF ( GMN-ACT = 2 ) AND ( URI-KB = 1 ) GO TO  ACC-BACK-R     D.981027
016000***** ELSE                                  GO  TO  ACC-SIZE-B.   D.981027
016010     IF   ESTAT     =  "09"                 GO  TO  ACC-SIZE-B.   I.981027
016020     IF   ESTAT NOT =  "01" AND "06" AND "00"
016030                                           GO  TO  ACC-NYMD.
016040     MOVE  ZERO        TO  GMN-NYY1(XX).                          I.980518
016050*****IF   GMN-NYY(XX)  =  ZERO                                    D.980518
016060*****           MOVE   ZERO     TO  GMN-NYMD(XX)                  D.980518
016070*****           DISPLAY ACT-NYMD           GO  TO  ACC-TANA.      D.980518
016080     DISPLAY    DSP-NYY.
016090*****IF   GMN-NYY(XX)  =    99                                    D.980518
016100*****     MOVE  999999      TO  GMN-NYMD(XX)                      D.980518
016110*****     DISPLAY   ACT-NYMD               GO  TO  ACC-TANA.      D.980518
016120 ACC-NMM.
016130     ACCEPT     ACT-NMM.
016140     DISPLAY    DISP-MSG-SPACE-1.
016150     IF   ESTAT     =  "09"                GO  TO  ACC-NYMD.
016160     DISPLAY    DSP-NMM.
016170     IF   GMN-NMM(XX)  =  00                                      I.980518
016180          IF   GMN-NYY2(XX)   =  00                               I.980518
016190               GO  TO  ACC-NDD.                                   I.980518
016200     IF   GMN-NMM(XX)  =  99                                      I.980518
016210          IF   GMN-NYY2(XX)   =  99                               I.980518
016220               GO  TO  ACC-NDD.                                   I.980518
016230     IF   GMN-NMM(XX)  <  1 OR   GMN-NMM(XX)   >   12
016240          DISPLAY   ERR-01  DISP-BUZ-J     GO  TO  ACC-NMM.
016250 ACC-NDD.
016260     ACCEPT     ACT-NDD.
016270     DISPLAY    DISP-MSG-SPACE-1.
016280     IF   ESTAT     =  "09"                GO  TO  ACC-NMM.
016290     DISPLAY    DSP-NDD.
016300     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-NDD.
016310     IF   GMN-NDD(XX)  =  00                                      I.980518
016320          IF   GMN-NMM(XX)  =  00                                 I.980518
016330               MOVE   ZERO    TO  GMN-NYY1(XX)                    I.980518
016340               DISPLAY CLR-021                                    I.991112
016350               GO  TO  ACC-TANA.                                  I.980518
016360     IF   GMN-NDD(XX)  =  99                                      I.980518
016370          IF   GMN-NMM(XX)  =  99                                 I.980518
016380               MOVE   99      TO  GMN-NYY1(XX)                    I.980518
016390               GO  TO  ACC-TANA.                                  I.980518
016400     IF   GMN-NDD(XX)  <  1 OR  GMN-NDD(XX)    >   31
016410          DISPLAY   ERR-01  DISP-BUZ-J     GO  TO  ACC-NDD.
016420     MOVE   ZERO    TO  GMN-NYY1(XX).                             I.980518
016430     IF GMN-NYY2(XX) >= DATE-NF1 AND <= DATE-NT1                  I.980518
016440         ADD DATE-NC1 TO GMN-NYY(XX).                             I.980518
016450     IF GMN-NYY2(XX) >= DATE-NF2 AND <= DATE-NT2                  I.980518
016460         ADD DATE-NC2 TO GMN-NYY(XX).                             I.980518
016470 ACC-TANA.
016480     IF    GMN-ACT         =   1                                  I.930925
016490*****      IF     GMN-NYMD(XX)    NOT   =   ZERO   AND   "999999" D.980518
016500           IF     GMN-NYMD(XX)    NOT   =   ZERO  AND  "99999999" I.980518
016510                  IF    W-YDATE         =   ZERO                  I.930925
016520                        MOVE   GMN-NYMD(XX)    TO  W-YDATE        I.930925
016530                        MOVE   XX              TO  CHKNO          I.931225
016540                        MOVE   ALL NX"2121"    TO  W-HTS          I.930925
016550                        MOVE   GMN-NMM(XX)     TO  WK-NMM         I.990223
016560                        MOVE   GMN-NDD(XX)     TO  WK-NDD         I.990223
016570                        MOVE   WK-NMM          TO  W-TGET         I.990223
016580                        MOVE   WK-NDD          TO  W-TPEY         I.990223
016590*****                   MOVE   GMN-NMM(XX)     TO  W-TGET         D.990223
016600*****                   MOVE   GMN-NDD(XX)     TO  W-TPEY         D.990223
016610                        MOVE   NC"／"          TO  W-TGP          I.930925
016620                        MOVE   NC"配達指定"    TO  W-HTSM         I.930925
016630                        MOVE   W-HTS           TO  GMN-TEKI1      I.930925
016640                        DISPLAY      ACT-TEKI1.                   I.930925
016650*****IF     GMN-NYMD(XX)    NOT   =   ZERO   AND   "999999"       D.980518
016660     IF     GMN-NYMD(XX)    NOT   =   ZERO   AND   "99999999"     I.980518
016670            IF    W-YDATE   NOT   =   GMN-NYMD(XX)  AND  ZERO     I.930925
016680                  IF   CHKNO     >=   XX                          I.931225
016690                        MOVE   GMN-NYMD(XX)    TO  W-YDATE        I.931225
016700                        MOVE   XX              TO  CHKNO          I.931225
016710                        MOVE   ALL NX"2121"    TO  W-HTS          I.931225
016720                        MOVE   GMN-NMM(XX)     TO  WK-NMM         I.990223
016730                        MOVE   GMN-NDD(XX)     TO  WK-NDD         I.990223
016740                        MOVE   WK-NMM          TO  W-TGET         I.990223
016750                        MOVE   WK-NDD          TO  W-TPEY         I.990223
016760*****                   MOVE   GMN-NMM(XX)     TO  W-TGET         D.990223
016770*****                   MOVE   GMN-NDD(XX)     TO  W-TPEY         D.990223
016780                        MOVE   NC"／"          TO  W-TGP          I.931225
016790                        MOVE   NC"配達指定"    TO  W-HTSM         I.931225
016800                        MOVE   W-HTS           TO  GMN-TEKI1      I.931225
016810                        DISPLAY      ACT-TEKI1                    I.931225
016820                      ELSE                                        I.931225
016830                        DISPLAY   EMSG-16   DISP-BUZ-J            I.930925
016840                        GO   TO   ACC-NYMD.                       I.930925
016850     IF     GMN-ACT  =  1                                         I.930925
016860*****    IF    (GMN-NYMD(1)      =   ZERO   OR    "999999")  AND  D.980518
016870*****          (GMN-NYMD(2)      =   ZERO   OR    "999999")  AND  D.980518
016880*****          (GMN-NYMD(3)      =   ZERO   OR    "999999")  AND  D.980518
016890*****          (GMN-NYMD(4)      =   ZERO   OR    "999999")  AND  D.980518
016900*****          (GMN-NYMD(5)      =   ZERO   OR    "999999")  AND  D.980518
016910*****          (GMN-NYMD(6)      =   ZERO   OR    "999999")       D.980518
016920         IF    (GMN-NYMD(1)      =   ZERO   OR    "99999999") AND I.980518
016930               (GMN-NYMD(2)      =   ZERO   OR    "99999999") AND I.980518
016940               (GMN-NYMD(3)      =   ZERO   OR    "99999999") AND I.980518
016950               (GMN-NYMD(4)      =   ZERO   OR    "99999999") AND I.980518
016960               (GMN-NYMD(5)      =   ZERO   OR    "99999999") AND I.980518
016970               (GMN-NYMD(6)      =   ZERO   OR    "99999999")     I.980518
016980                          MOVE   ALL NX"2121"    TO  W-HTS        I.930925
016990                          MOVE   W-HTS           TO  GMN-TEKI1    I.930925
017000                          DISPLAY      ACT-TEKI1.                 I.930925
017010     PERFORM  TAN-RTN    THRU  TAN-EX.                            I.040802
017020     DISPLAY    DSP-TAN.                                          I.040802
017030     IF   TC-BIK    NOT =  ZERO            GO  TO  ACC-BIKHO.     I.981012
017040     MOVE  SPACE        TO  GMN-BIKHO(XX).                        I.981012
017050     DISPLAY  ACT-BIKHO.                                          I.981012
017060*****IF   GMN-ACT       =  3               GO  TO  ACC-TAN1.      D.080602
017070     GO  TO  ACC-TAN.                                             I.981012
017080 ACC-BIKHO.                                                       I.980604
017090     ACCEPT     ACT-BIKHO.                                        I.980604
017100     DISPLAY    DISP-MSG-SPACE-1.                                 I.980604
017110     IF   ESTAT     =  "09"                GO  TO  ACC-NYMD.      I.980604
017120     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-BIKHO.     I.980604
017130*****IF     GMN-ACT  =  3                  GO  TO  ACC-TAN1.      D.080602
017140*****IF     GMN-ACT  =  2 AND URI-KB = 1   GO  TO  ACC-TAN1.      D.981027
017150 ACC-TAN.
017160     ACCEPT     ACT-TAN.                                          単価
017170     DISPLAY    DISP-MSG-SPACE-1.
017180*****IF   ESTAT     =  "09"                GO  TO  ACC-NYMD.      D.980604
017190*****IF   ESTAT     =  "09"                GO  TO  ACC-BIKHO.     D.981012
017200     IF   ESTAT     =  "09"                                       I.981012
017210          IF  TC-BIK       =  ZERO         GO  TO  ACC-NYMD       I.981012
017220                                     ELSE  GO  TO  ACC-BIKHO.     I.981012
017230     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-TAN.       I.981012
017240     DISPLAY    DSP-TAN.
017250*****IF   W-KBN     =   5                                         D.980604
017260*****     IF  GMN-TAN(XX)     =   ZERO                            D.980604
017270*****                                      GO  TO  ACC-TAN.       D.980604
017280*****IF   GMN-SET  =    0  AND  GMN-TAN(XX) = 0                   D.940620
017290*****                                      GO  TO  ACC-TAN.       D.940620
017300 ACC-TAN1.
017310     COMPUTE    GMN-KIN(XX) =  GMN-KEI(XX) * GMN-TAN(XX).
017320     DISPLAY    DSP-KIN.
017330 ACC-SEL.
017340     IF   XX    =   6                      GO  TO  ACC-GKEI       D630303
017350     ELSE
017360          ADD   1   TO  XX
017370          ADD   2   TO  AA
017380          MOVE  GMN-HCD(XX) TO  WK-HCD     GO  TO  ACC-HMAT.
017390 ACC-GKEI.
017400     MOVE     ZERO          TO  GMN-GKEI  GMN-GKIN.
017410     MOVE     1             TO  WW.
017420 ACC-GKEI-A.
017430     ADD      GMN-KEI(WW)   TO  GMN-GKEI.
017440     ADD      GMN-KIN(WW)   TO  GMN-GKIN.
017450     IF   WW  =     6                      GO  TO  ACC-GKEI-D
017460     ELSE     ADD   1       TO  WW         GO  TO  ACC-GKEI-A.
017470 ACC-GKEI-D.
017480     DISPLAY  DSP-GKEI DSP-GKIN.
017490*****IF       GMN-GKIN = 0                                        D.940620
017500*****         DISPLAY  EMSG-15 DISP-BUZ-J                         D.940620
017510*****         MOVE  6  TO   XX                                    D.940620
017520*****         COMPUTE  AA = XX * 2 + 8                            D.940620
017530*****     MOVE  GMN-HCD(XX) TO  WK-HCD     GO  TO  ACC-HMAT.      D.940620
017540*****IF   GMN-ACT  =  3                    GO  TO  ACC-OKC.       D.080602
017550 ACC-TEKI.
017560     ACCEPT     ACT-TEKI1.                                        配達
017570     DISPLAY    DISP-MSG-SPACE-1.
017580     IF   ESTAT     =  "09"                GO  TO  ACC-BACK.
017590     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-TEKI.
017600     IF   GMN-TEKI1  =  SPACE
017610                        MOVE  ALL NX"2121"     TO  GMN-TEKI1.
017620 ACC-TEKI2.
017630     ACCEPT     ACT-TEKI2.                                        摘要１
017640     DISPLAY    DISP-MSG-SPACE-1.
017650     IF   ESTAT     =  "09"                GO  TO  ACC-TEKI.
017660     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-TEKI2.
017670     IF   GMN-TEKI2  =  SPACE
017680                        MOVE  ALL NX"2121"     TO  GMN-TEKI2.
017690 ACC-OKC.
017700     ACCEPT     ACT-OKC.                                          確認
017710     DISPLAY    DISP-MSG-SPACE-1.
017720     IF   ESTAT     =  "09"
017730       IF GMN-ACT NOT =  3                 GO  TO  ACC-TEKI2
017740       ELSE                                GO  TO  ACC-JNOD.
017750     IF   ESTAT NOT =  "01" AND "06"       GO  TO  ACC-OKC.
017760     IF   GMN-OKC   NOT  =  1   AND  9     GO  TO  ACC-OKC.
017770     IF   GMN-OKC   =  9
017780          DISPLAY   CAN-01                 GO  TO  ACC-END
017790     ELSE DISPLAY   OK-01.
017800*****ｺｳｼﾝ ｼｮﾘ
017810     PERFORM  UPD-RTN   THRU  UPD-EX.
017820 ACC-END.
017830     PERFORM JDCON-RTN  THRU  JDCON-EX.
017840     IF  JS-SIGN      =  0                                        I.930118
017850         IF  GMN-ACT      =  1                                    I.930118
017860             MOVE  GMN-TEKI2     TO  W-TEKI2.                     I.930925
017870     IF  JS-SIGN      =  1                                        I.150622
017880         IF  GMN-ACT      =  1                                    I.150622
017890             MOVE  GMN-JYMD      TO  W-EDATE                      I.150622
017900         ELSE    MOVE  ZERO          TO  W-EDATE.                 I.150622
017910*****        MOVE  GMN-TEKI      TO  W-TEKI.                      D.930925
017920     DISPLAY DSP-CLEAR.
017930     CALL    "SJ010I".
017940     DISPLAY DSP-S0.                                              I.941024
017950     INITIALIZE        WK-AREA  GMN-AREA.
017960     MOVE     5             TO  GMN-OKC.
017970     IF      JS-SIGN   =  0
017980          DISPLAY     DSP-S1.
017990     IF      JS-SIGN   =  1
018000          DISPLAY     DSP-S2.
018010*****IF      JS-SIGN   =  2                                       D.070410
018020*****     DISPLAY     DSP-S3.                                     D.070410
018030     GO   TO   ACCEPT-RTN.
018040 ACC-SIZE-B.                                                      数量BTAB
018050     MOVE     10            TO  ZZ.
018060     MOVE     50            TO  BB.                               I.980929
018070*****IF        YY  =   4    MOVE    48  TO  BB                    D.980929
018080*****  ELSE                 MOVE    50  TO  BB.                   D.980929
018090 ACC-SIZE-B-R.
018100     IF   YY  =  1
018110*****     IF  SHM-041  =    ZERO           GO  TO  ACC-SIZ        D.010808
018120          IF  HI-SS1   =    ZERO           GO  TO  ACC-SIZ        I.010808
018130          ELSE
018140*****         IF  SHM-0411(ZZ)  NOT =  ZERO                       D.010808
018150              IF  HI-S1(ZZ)     NOT =  ZERO                       I.010808
018160                                           GO  TO  ACC-S1
018170              ELSE
018180*****             COMPUTE  ZZ  =  ZZ  -   1                       *D920608
018190*****             COMPUTE  BB  =  BB  -   5                       *D920608
018200                  PERFORM  SET-CL-RTN  THRU  SET-CL-EX            *I920608
018210                                           GO  TO  ACC-SIZE-B-R.
018220     IF   YY  =  2
018230*****     IF  SHM-042  =    ZERO           GO  TO  ACC-SIZ        D.010808
018240          IF  HI-SS2   =    ZERO           GO  TO  ACC-SIZ        I.010808
018250          ELSE
018260*****         IF  SHM-0421(ZZ)  NOT =  ZERO                       D.010808
018270              IF  HI-S2(ZZ)     NOT =  ZERO                       I.010808
018280                                           GO  TO  ACC-S2
018290              ELSE
018300*****             COMPUTE  ZZ  =  ZZ  -   1                       *D920608
018310*****             COMPUTE  BB  =  BB  -   5                       *D920608
018320                  PERFORM  SET-CL-RTN  THRU  SET-CL-EX            *I920608
018330                                           GO  TO  ACC-SIZE-B-R.
018340     IF   YY  =  3
018350*****     IF  SHM-043  =    ZERO           GO  TO  ACC-SIZ        D.010808
018360          IF  HI-SS3   =    ZERO           GO  TO  ACC-SIZ        I.010808
018370          ELSE
018380*****         IF  SHM-0431(ZZ)  NOT =  ZERO                       D.010808
018390              IF  HI-S3(ZZ)     NOT =  ZERO                       I.010808
018400                                           GO  TO  ACC-S3
018410              ELSE
018420*****             COMPUTE  ZZ  =  ZZ  -   1                       *D920608
018430*****             COMPUTE  BB  =  BB  -   5                       *D920608
018440                  PERFORM  SET-CL-RTN  THRU  SET-CL-EX            *I920608
018450                                           GO  TO  ACC-SIZE-B-R.
018460     IF   YY  NOT =  4                     GO  TO  ACC-SIZE-B-R.
018470*****IF   SHM-044  =    ZERO               GO  TO  ACC-SIZ.       D.010808
018480*****IF   SHM-0441(ZZ)  =  ZERO                                   D.010808
018490     IF   HI-SS4   =    ZERO               GO  TO  ACC-SIZ.       I.010808
018500     IF   HI-S4(ZZ)     =  ZERO                                   I.010808
018510                  PERFORM  SET-CL-RTN  THRU  SET-CL-EX            *I920608
018520                                           GO  TO  ACC-SIZE-B-R.
018530     GO  TO  ACC-S4.                                              I.980929
018540*****IF   ZZ  =  10                                               D.980929
018550*****             PERFORM  SET-CL-RTN  THRU  SET-CL-EX            D.980929
018560*****                                      GO  TO  ACC-SIZE-B-R   D.980929
018570*****  ELSE                                GO  TO  ACC-S4.        D.980929
018580*ACC-HCD-CHECK.                                                   D.980929
018590*****MOVE     1             TO  WW.                               D.980929
018600*****IF   SW-ZERO   =  SPACE               GO  TO  ACC-HCD-C.     D.980929
018610*ACC-HCD-L.                                                       D.980929
018620*****IF   WS-CHECK(WW) = "01"   AND  XX  NOT =  WW
018630*****     IF  GMN-HCD(XX)   =   GMN-HCD(WW)
018640*****         DISPLAY  ACT-ERR  DISP-BUZ-J GO  TO  ACC-HMAT.
018650*****IF   WW  =  6
018660*****     MOVE   1     TO  WW              GO  TO  ACC-HCD-C.
018670*****ADD      1             TO  WW.
018680*****GO   TO   ACC-HCD-L.
018690*ACC-HCD-C.                                                       D.980929
018700*****IF   WW  NOT  =   XX   AND GMN-HCD(WW)    NOT =   ZERO
018710*****     IF  GMN-HCD(XX)   =   GMN-HCD(WW)
018720*****         DISPLAY  ERR-01   DISP-BUZ-J GO  TO  ACC-HMAT.
018730*****IF   WW  NOT  <   XX                  GO  TO  ACC-HNAM-R.
018740*****ADD      1             TO  WW.
018750*****GO   TO   ACC-HCD-C.
018760*****GO   TO   ACC-HNAM-R.                                        D.980929
018770 ACC-ADV.                                                         ADVANCE
018780     MOVE 1   TO    I.
018790     MOVE WW  TO    XX.
018800 ACC-ADV1.
018810     IF   I   NOT = XX
018820          IF  GMN-HCD(I) NOT = ZERO
018830              GO  TO  ACC-ADV-L.
018840     ADD  1   TO  I.
018850     IF   ESTAT     = "03"
018860        IF   I NOT > 6   GO  TO  ACC-ADV1.
018870     IF   ESTAT     = "04"
018880        IF   I NOT > XX  GO  TO  ACC-ADV1.
018890     MOVE   WK-HCD    TO  GMN-HCD(XX).
018900     DISPLAY   ADV-ERR DISP-BUZ-J CLR-HCD ACT-HCD.
018910     GO  TO  ACC-HMAT.
018920 ACC-ADV-L.
018930     IF   SW-ZERO   =  SPACE               GO  TO  ACC-CLR.
018940     IF   WS-CHECK(XX) = "01"
018950          MOVE   WW    TO  XX
018960          MOVE   WK-HCD     TO  GMN-HCD(XX)
018970          DISPLAY   ADV-ERR DISP-BUZ-J CLR-HCD ACT-HCD
018980                                           GO  TO  ACC-HMAT.
018990     IF   ESTAT    =  "03"                 GO  TO  ACC-CLR.
019000     IF   XX  =  6                         GO  TO  ACC-CLR.
019010     ADD      1             TO  XX.
019020     GO   TO   ACC-ADV-L.
019030 ACC-CLR.
019040     MOVE     WW            TO  XX.
019050 ACC-CLR-R.
019060     INITIALIZE             GMN-MEISAI(XX).
019070     IF   ESTAT    =  "03"                 GO  TO  ACC-03.
019080     IF   XX  =    6                       GO  TO  ACC-CLR-D.
019090     ADD      1             TO  XX.
019100     GO  TO   ACC-CLR-R.
019110 ACC-CLR-D.
019120     MOVE WW  TO  XX.
019130 ACC-CLR-D1.
019140     COMPUTE  AA  =  XX * 2 +  8.
019150     DISPLAY  CLR-01  CLR-02  CLR-BIKHO CLR-03.                   I.980604
019160*****DISPLAY  CLR-01  CLR-02  CLR-03.                             D.980604
019170     ADD   1  TO  XX.
019180     IF   XX  NOT >   6     GO  TO  ACC-CLR-D1.
019190     DISPLAY  CLR-GKEI.
019200     COMPUTE  XX   =    WW  -   1.
019210     COMPUTE  AA   =    AA  -   2.
019220     GO   TO  ACC-GKEI.
019230 ACC-03.
019240     MOVE     WW  TO    XX.
019250     COMPUTE  AA  =  XX * 2 +  8.
019260     DISPLAY  CLR-01  CLR-02  CLR-BIKHO CLR-03.                   I.980604
019270*****DISPLAY  CLR-01  CLR-02  CLR-03.                             D.980604
019280     IF   WW  =   6         GO  TO  ACC-GKEI.
019290     ADD  1   TO  WW XX.
019300     COMPUTE  AA  =  XX * 2 +  8.
019310     GO   TO   ACC-HMAT.
019320 ACC-BACK.
019330     MOVE     6   TO XX.
019340 ACC-BACK1.
019350     IF       GMN-HCD(XX) NOT = ZERO
019360              COMPUTE AA  =  XX * 2 + 8
019370              GO  TO  ACC-HMAT.
019380     IF       XX  =  1          GO  TO  ACC-BACK-R.
019390     COMPUTE  XX  =  XX - 1.
019400     GO   TO   ACC-BACK1.
019410 ACC-BACK-R.
019420     IF   XX  =  1
019430*****     IF  GMN-ACT  =  1                GO  TO  ACC-SSU        D.981027
019440*****     ELSE                                                    D.981027
019450*****         IF ( GMN-ACT = 2  AND  URI-KB = 0 )                 D.981027
019460*****         OR ( GMN-ACT = 3  AND  URI-KB = 1 )                 D.981027
019470*****                                      GO  TO  ACC-SSU        D.981027
019480*****         ELSE                                                D.981027
019490*****           IF ( GMN-ACT = 3 AND URI-KB = 0 )                 D.981027
019500*****           OR ( GMN-ACT = 2 AND URI-KB = 1 )                 D.981027
019510*****                                      GO  TO  ACC-JNOD       D.981027
019520          IF  GMN-ACT  =  1  OR  2         GO  TO  ACC-SSU        I.981027
019530          ELSE                                                    I.981027
019540                IF   GMN-ACT  =  3         GO  TO  ACC-JNOD       I.981027
019550                ELSE
019560                                           GO  TO  ACC-TCD        I.980518
019570*****                                      GO  TO  ACC-TMAT       D.980518
019580     ELSE
019590              COMPUTE     XX  =  XX   -   1
019600              COMPUTE     AA  =  AA   -   2.
019610     GO  TO  ACC-HMAT.                                            I.981027
019620*****IF       ( GMN-ACT = 2 AND URI-KB = 1 )                      D.981027
019630*****                                      GO  TO  ACC-NYMD       D.981027
019640*****  ELSE                                GO  TO  ACC-HMAT.      D.981027
019650 ACCEPT-EX.
019660     EXIT.
019670**
019680 SET-CL-RTN.
019690     IF        ZZ  =   10
019700         IF    YY  NOT =   4
019710               COMPUTE BB  =  BB  -  7
019720         ELSE  COMPUTE BB  =  BB  -  5
019730     ELSE      COMPUTE BB  =  BB  -  5.
019740     COMPUTE   ZZ  =   ZZ  -   1.
019750 SET-CL-EX.
019760     EXIT.
019770*************************
019780*    画面クリアー       *
019790*************************
019800 CLR-RTN.
019810     DISPLAY    CLR-JNO.
019820 CLR-001.
019830     DISPLAY    CLR-HEAD.
019840 CLR-005.
019850     PERFORM    REV-CLE-RTN  THRU  REV-CLE-EX.
019860     MOVE       10  TO    AA.
019870     MOVE       1   TO    XX.
019880 CLR-010.
019890     COMPUTE    AA  =   XX * 2 + 8.
019900     DISPLAY    CLR-01  CLR-02  CLR-BIKHO CLR-03.                 I.980604
019910*****DISPLAY    CLR-01  CLR-02  CLR-03.                           D.980604
019920     ADD        1   TO    XX.
019930     IF         XX  NOT > 6     GO  TO  CLR-010.
019940     DISPLAY    CLR-GKEI  CLR-END.
019950 CLR-EX.
019960     EXIT.
019970*************************************************
019980*    数量チェック　　　ＣＨＫ－ＳＵ－ＲＴＮ     *
019990*************************************************
020000 CHK-SU-RTN.
020010     MOVE     0         TO    CHK-SW.
020020     IF       GMN-SET  =    ZERO           GO  TO  CHK-SU-100.
020030*****IF       GMN-ACT  =    1                                     D.981027
020040*****    OR ( GMN-ACT  =    2  AND  URI-KB =   0 )                D.981027
020050     IF       GMN-ACT  =    1  OR  2                              I.981027
020060              NEXT    SENTENCE
020070         ELSE GO  TO  CHK-SU-100.
020080     IF       GMN-ACT  =    1                                     I.931015
020090              DIVIDE   GMN-SET INTO  GMN-SU(XX ZZ)
020100                       GIVING  WK-ANS    REMAINDER  WK-AMARI.
020110     IF       GMN-ACT  =    2                                     I.931015
020120              DIVIDE   GMN-SET INTO  WS-SU(XX ZZ)                 I.931015
020130                       GIVING  WK-ANS    REMAINDER  WK-AMARI.     I.931015
020140     IF       WK-AMARI NOT =  0
020150              DISPLAY  EMSG-12 DISP-BUZ-J
020160              MOVE   1  TO    CHK-SW.
020170     GO  TO   CHK-SU-EX.
020180 CHK-SU-100.
020190     IF       GMN-ACT  NOT =  3            GO  TO  CHK-SU-EX.
020200     IF       GMN-SU(XX ZZ) > WS-ZAN(XX ZZ)
020210              DISPLAY  EMSG-13 DISP-BUZ-J
020220              MOVE   1  TO    CHK-SW.
020230 CHK-SU-EX.
020240     EXIT.
020250**
020260 CHK-SU1-RTN.
020270     IF       GMN-SET  =    ZERO           GO  TO  CHK-SU1-EX.
020280*****IF       GMN-ACT  =    1                                     D.981027
020290*****    OR ( GMN-ACT  =    2  AND  URI-KB =   0 )                D.981027
020300     IF       GMN-ACT  =    1  OR  2                              I.981027
020310              NEXT    SENTENCE
020320         ELSE GO  TO  CHK-SU1-EX.
020330     IF       GMN-ACT  =    1                                     I.931015
020340              DIVIDE   GMN-SET INTO  GMN-SU(XX P)
020350                       GIVING  WK-ANS    REMAINDER  WK-AMARI.
020360     IF       GMN-ACT  =    2                                     I.931015
020370              DIVIDE   GMN-SET INTO  WS-SU(XX P)                  I.931015
020380                       GIVING  WK-ANS    REMAINDER  WK-AMARI.     I.931015
020390     IF       WK-AMARI NOT =  0
020400              MOVE   1  TO    CHK-SW.
020410 CHK-SU1-EX.
020420     EXIT.
020430*************************************************
020440*    画面　表示        ＨＹＯＪＩ－ＲＴＮ       *
020450*************************************************
020460 HYOJI-RTN.
020470     IF   WW    =   7
020480          MOVE  10          TO  AA         GO  TO  HYO-DSP.
020490     INITIALIZE             GMN-HEAD  GMN-DATA  SAVE-AREA.
020500*****MOVE     JMSTD-01      TO  GMN-KBN WS-KBN.
020510     MOVE     JMSTD-02      TO  GMN-JYMD WS-JYMD.
020520     MOVE     JMSTD-04      TO  GMN-TCD.
020530     MOVE     JMSTD-10      TO  GMN-CCD.
020540     MOVE     JMSTD-23      TO  GMN-TENC.                         I.080602
020550*****MOVE     JMSTD-19      TO  WS-NO.                            D.980929
020560     MOVE     JMSTD-20      TO  WS-SEQ.
020570     MOVE     GMN-TCD       TO  TC-TCD.
020580     MOVE     001           TO  TC-CCD.
020590     READ     TC-M          UNLOCK    INVALID KEY
020600              MOVE  SPACE   TO  TC-NAME.                          I.080602
020610*****         MOVE  SPACE   TO  TC-JSU.                           D.080602
020620     MOVE     TC-NAME       TO  GMN-TNAM.
020630     MOVE     GMN-TCD       TO  TC-TCD.
020640     MOVE     GMN-CCD       TO  TC-CCD.
020650     READ     TC-M          UNLOCK    INVALID KEY
020660              MOVE  SPACE   TO  TC-NAME.                          I.080602
020670*****         MOVE  SPACE   TO  TC-JSS.                           D.080602
020680     MOVE     TC-NAME       TO  GMN-CNAM.
020690     IF  GMN-TCD     NOT =  9850           GO  TO  HYO-MID.       I.080602
020700     MOVE     GMN-TENC      TO  WTNA-KEY.                         I.080602
020710     READ     WTNAF         UNLOCK    INVALID KEY                 I.080602
020720              MOVE  SPACE   TO  WTNA-NAME.                        I.080602
020730     MOVE     WTNA-NAME     TO  GMN-TENM.                         I.080602
020740 HYO-MID.                                                         I.080602
020750     DISPLAY  ACT-JYMD   DSP-BAR   ACT-TCCD
020760              DSP-TNAM  DSP-CNAM.
020770     IF  GMN-TCD         =  9850           DISPLAY  DSP-TEN       I.080602
020780                                     ELSE  DISPLAY  CLR-TEN.      I.080602
020790     IF  TC-BIK          =  0              DISPLAY  DSP-BIKHO-CLE I.981106
020800                                     ELSE  DISPLAY  DSP-BIKHO.    I.981106
020810     MOVE     WK-KEY        TO  JMSTD-KEY1.
020820     START    JMSTD    KEY  NOT <     JMSTD-KEY1   INVALID KEY
020830                                           GO  TO  HYO-READ.
020840     MOVE     ZERO          TO  XX  WK-HCD.
020850     MOVE     ZERO          TO  WK-SU.
020860 HYO-READ.
020870     READ     JMSTD    NEXT UNLOCK    AT  END
020880                                           GO  TO  HYO-END.
020890     IF   GMN-JNO   NOT  =  JMSTD-07       GO  TO  HYO-END.
020900     MOVE     JMSTD-08      TO  XX.                               A620920
020910     MOVE     JMSTD-09      TO  YY  GMN-SIZ(XX)  WS-SIZ(XX).
020920*****MOVE     JMSTD-05      TO  WS-HCD(XX)  SHM-01  GMN-HCD(XX)   D.010808
020930*****                           WK-HCD.                           D.010808
020940*****READ     SHM           UNLOCK    INVALID KEY                 D.010808
020950*****         MOVE  SPACE   TO  SHM-02.                           D.010808
020960*****MOVE     SHM-02        TO  WK-NAM.                           D.010808
020970     MOVE     JMSTD-05      TO  WS-HCD(XX)  GMN-HCD(XX)           I.010808
020980                                WK-HCD  HI-MHCD  HI-HCD.          I.010808
020990     READ     HI2-M         UNLOCK    INVALID KEY                 I.010808
021000              MOVE  SPACE   TO  HI-NAME.                          I.010808
021010     MOVE     HI-NAME       TO  WK-NAM.                           I.010808
021020     MOVE     WK-NAM1       TO  WS-HNAM1(XX)  GMN-HNAM1(XX).
021030     MOVE     WK-NAM2       TO  WS-HNAM2(XX)  GMN-HNAM2(XX).
021040     MOVE     JMSTD-06      TO  WS-NYMD(XX)   GMN-NYMD(XX).
021050     MOVE     JMSTD-17      TO  WS-TAN(XX)    GMN-TAN(XX).
021060     MOVE     JMSTD-22      TO  WS-BIKHO(XX)  GMN-BIKHO(XX).      I.980604
021070     MOVE     JMSTD-16      TO  WS-SET        GMN-SET.
021080     MOVE     JMSTD-13      TO  GMN-TEKI.                         S630920
021090     MOVE     1             TO  ZZ.
021100     MOVE     0             TO  WS-KEI(XX).
021110 HYO-LOOP.
021120     IF ( JMSTD-1211(ZZ)  NOT  =    0     )
021130       OR ( JMSTD-141 (ZZ)  NOT  =    0     )
021140         OR ( JMSTD-151 (ZZ)  NOT  =    0     )
021150          MOVE    "01"    TO   WS-CHECK(XX).
021160     MOVE     JMSTD-1111(ZZ)    TO  WS-SU(XX ZZ).
021170     MOVE     JMSTD-1211(ZZ)    TO  WS-1211(XX ZZ).
021180     MOVE     JMSTD-141 (ZZ)    TO  WS-141 (XX ZZ).
021190     MOVE     JMSTD-151 (ZZ)    TO  WS-151 (XX ZZ).
021200*****COMPUTE  GMN-SU(XX ZZ) =  JMSTD-1111(ZZ) - JMSTD-151(ZZ).    D 920804
021210     COMPUTE  GMN-SU(XX ZZ) =  JMSTD-1111(ZZ) - JMSTD-151(ZZ)     A   :
021220                            -  JMSTD-1211(ZZ) - JMSTD-141(ZZ).    A 920804
021230     ADD      GMN-SU(XX ZZ)     TO  WS-KEI(XX)  GMN-KEI(XX)
021240                                    WS-GKEI     GMN-GKEI.
021250     MOVE     GMN-SU(XX ZZ)     TO  WS-ZAN(XX ZZ).
021260     ADD      JMSTD-1111(ZZ)    TO  WK-SU1.
021270     ADD      JMSTD-151(ZZ)     TO  WK-SU2.
021280     IF   ZZ  =  10
021290          COMPUTE   GMN-KIN(XX) =   GMN-KEI(XX) * GMN-TAN(XX)
021300          ADD       GMN-KIN(XX) TO  GMN-GKIN
021310          GO  TO    HYO-READ.
021320     ADD      1             TO  ZZ.
021330     GO   TO   HYO-LOOP.
021340 HYO-END.
021350     COMPUTE   WK-SU4  =  WK-SU1  -  WK-SU2.
021360     IF        GMN-SET =  ZERO
021370               MOVE    ZERO  TO   WK-SU1
021380        ELSE
021390               COMPUTE   WK-SU1  =  WK-SU1  / GMN-SET.
021400     IF        WK-SU1  =  0
021410               MOVE    0  TO   WK-SU3
021420        ELSE
021430               COMPUTE WK-SU3  =  WK-SU4 / WK-SU1.
021440     MOVE     10            TO  AA.
021450     MOVE     1             TO  XX.
021460     DISPLAY  DSP-HEAD.
021470 HYO-DSP.
021480     IF       XX  >   6                    GO  TO  HYO-GOKEI.
021490     IF       GMN-HCD(XX)   =   ZERO
021500*****         DISPLAY CLR-01 CLR-02 CLR-03                        D.980604
021510              DISPLAY CLR-01 CLR-02 CLR-BIKHO CLR-03              I.980604
021520       ELSE   DISPLAY ACT-HCD DSP-HNAM ACT-SIZ.
021530 HYO-SIZE.
021540 HYO-S-R.
021550     MOVE     1             TO  ZZ.
021560     MOVE     3             TO  BB.
021570 HYO-SURYO.
021580*****IF   YY      = 4  AND    ZZ  =  10                           D.980929
021590*****     DISPLAY    DSP-SU2                                      D.980929
021600*****ELSE DISPLAY    DSP-SU1.                                     D.980929
021610     DISPLAY    DSP-SU1.                                          I.980929
021620     IF   ZZ  NOT =  10                    GO  TO  HYO-SURYO1.
021630     IF   GMN-HCD(XX) NOT = ZERO
021640       IF GMN-NYMD(XX) NOT = ZERO
021650          DISPLAY DSP-NYMD
021660       ELSE
021670          DISPLAY DSP-NA DSP-NB ACT-NYMD.
021680     DISPLAY  ACT-BIKHO.                                          I.980604
021690     DISPLAY  DSP-TAN  DSP-KIN  DSP-KEI.
021700     ADD      2      TO  AA.
021710     ADD      1      TO  XX.
021720     GO  TO  HYO-DSP.
021730 HYO-SURYO1.
021740     ADD      1             TO  ZZ.
021750     IF   ZZ  =  10
021760*****     IF  YY  =  4                                            D.980929
021770*****         ADD    5      TO  BB                                D.980929
021780*****     ELSE                                                    D.980929
021790              ADD    7      TO  BB
021800     ELSE     ADD    5      TO  BB.
021810     GO   TO   HYO-SURYO.
021820 HYO-GOKEI.
021830     IF   WS-CHECK(01)  =   SPACE    AND
021840          WS-CHECK(02)  =   SPACE    AND
021850          WS-CHECK(03)  =   SPACE    AND
021860          WS-CHECK(04)  =   SPACE    AND
021870          WS-CHECK(05)  =   SPACE    AND
021880          WS-CHECK(06)  =   SPACE
021890          MOVE    SPACE     TO       SW-ZERO
021900     ELSE MOVE    "01"      TO       SW-ZERO.
021910     DISPLAY  DSP-END.
021920     MOVE     1             TO  XX.
021930     MOVE     10            TO  AA.
021940     DISPLAY  ACT-TEKI1.                                          A631017
021950     DISPLAY  ACT-TEKI2.                                          A631017
021960 HYOJI-EX.
021970     EXIT.
021980************************************************
021990*    排他制御Ｆ　削除  ＪＤＣＯＮ－ＲＴＮ      *
022000************************************************
022010 JDCON-RTN.
022020     IF   GMN-ACT   =  1                   GO  TO  JDCON-EX.
022030     MOVE     1             TO  JDCON-01.
022040     MOVE     GMN-JNO       TO  JDCON-02.
022050     READ     JDCON         INVALID     GO  TO  JDCON-EX.         R620920
022060     DELETE   JDCON                   INVALID KEY
022070              MOVE  "D"         TO  ERR-M
022080              MOVE  "JDCON"     TO  ERR-F
022090              MOVE  JDCON-KEY   TO  ERR-K
022100              PERFORM     ERR-RTN   THRU      ERR-EX.
022110     CALL     "CBLTCLS"   USING     JDCON.
022120 JDCON-EX.
022130     EXIT.
022140*************************************************
022150*    数量（サイズ別）ＺＥＲＯ　チェック         *
022160*************************************************
022170 SUCHK-RTN.
022180     MOVE  0         TO  SU-SW.
022190 SUCHK-010.
022200     IF GMN-SU (XX 1) = ZERO AND GMN-SU (XX 2) = ZERO AND
022210        GMN-SU (XX 3) = ZERO AND GMN-SU (XX 4) = ZERO AND
022220        GMN-SU (XX 5) = ZERO AND GMN-SU (XX 6) = ZERO AND
022230        GMN-SU (XX 7) = ZERO AND GMN-SU (XX 8) = ZERO AND
022240        GMN-SU (XX 9) = ZERO AND GMN-SU (XX 10) = ZERO
022250                          GO  TO  SUCHK-EX.
022260     MOVE  1         TO  SU-SW.
022270 SUCHK-EX.
022280     EXIT.
022290******************
022300*    単価決定    *
022310******************
022320*TAN-RTN.                                                         D.010516
022330*****IF        GMN-TAN(XX) NOT = ZERO       GO  TO  TAN-EX.       D.010516
022340*****MOVE      ZERO         TO  GMN-TAN(XX).                      D.010516
022350*****MOVE      GMN-TCD      TO  THTN-01.                          D.010516
022360*****MOVE      GMN-HCD(XX)  TO  THTN-02.                          D.010516
022370*****MOVE      GMN-SIZ(XX)  TO  THTN-03.                          D.010516
022380*****READ      JT-THTN  UNLOCK  INVALID     GO  TO  TAN-010.      D.010516
022390*****MOVE      THTN-04      TO  GMN-TAN(XX).                      D.010516
022400*TAN-010.                                                         D.010516
022410*****IF        GMN-TAN(XX) NOT = ZERO       GO  TO  TAN-EX.       D.010516
022420*****MOVE      GMN-TCD      TO  THTN-01.                          D.010516
022430*****MOVE      GMN-HCD(XX)  TO  THTN-02.                          D.010516
022440*****MOVE      9            TO  THTN-03.                          D.010516
022450*****READ      JT-THTN  UNLOCK  INVALID     GO  TO  TAN-EX.       D.010516
022460*****READ      JT-THTN  UNLOCK  INVALID     GO  TO  TAN-020.      D.980518
022470*****MOVE      THTN-04      TO  GMN-TAN(XX).                      D.010516
022480*TAN-020.                                                         D.980518
022490*****IF        GMN-TAN(XX) NOT = ZERO       GO  TO  TAN-EX.       D.940620
022500*****MOVE      GMN-TCD      TO  T-TCD.                            D.940620
022510*****READ      T-M      UNLOCK  INVALID                           D.940620
022520*****          DISPLAY  TM-ERR  DISP-BUZ-J                        D.940620
022530*****          GO   TO  TAN-EX.                                   D.940620
022540*****IF       (T-KL  =  0) OR (T-KL > 5)                          D.940620
022550*****          DISPLAY  KL-ERR  DISP-BUZ-J                        D.940620
022560*****          GO   TO  TAN-EX.                                   D.940620
022570*****MOVE      GMN-HCD(XX)  TO  HI-KEY.                           D.940620
022580*****READ      HI-M     UNLOCK  INVALID                           D.940620
022590*****          DISPLAY  HIM-ERR DISP-BUZ-J                        D.940620
022600*****          GO   TO  TAN-EX.                                   D.940620
022610*****IF        T-KL  =  1                                         D.940620
022620*****          MOVE  HI-TS(YY)  TO  GMN-TAN(XX)                   D.940620
022630*****          GO    TO    TAN-EX.                                D.940620
022640*****IF        T-KL  =  2                                         D.940620
022650*****          MOVE  HI-TA(YY)  TO  GMN-TAN(XX)                   D.940620
022660*****          GO    TO    TAN-EX.                                D.940620
022670*****IF        T-KL  =  3                                         D.940620
022680*****          MOVE  HI-TB(YY)  TO  GMN-TAN(XX)                   D.940620
022690*****          GO    TO    TAN-EX.                                D.940620
022700*****IF        T-KL  =  4                                         D.940620
022710*****          MOVE  HI-TC(YY)  TO  GMN-TAN(XX)                   D.940620
022720*****          GO    TO    TAN-EX.                                D.940620
022730*****IF        T-KL  =  5                                         D.940620
022740*****          MOVE  HI-TD(YY)  TO  GMN-TAN(XX)                   D.940620
022750*****          GO    TO    TAN-EX.                                D.940620
022760*TAN-EX.                                                          D.010516
022770*****EXIT.                                                        D.010516
022780*************************************************
022790*    終了　処理　　　　ＥＮＤ－ＲＴＮ           *
022800*************************************************
022810 END-RTN.
022820*****CLOSE             TC-M SHM JTKB T-M HI-M JT-THTN.            D.940620
022830*****CLOSE             TC-M SHM JTKB          JT-THTN.            I.940620
022840*****CLOSE             TC-M SHM               JT-THTN.            D.941005
022850*****CLOSE             TC-M SHM      T-M      JT-THTN.            D.010516
022860*****CLOSE             TC-M SHM      T-M.                         D.010808
022870*****CLOSE             TC-M HI2-M    T-M  THTM.                   D.080602
022880     CLOSE             TC-M HI2-M    T-M  THTM  WTNAF.            I.080602
022890     CLOSE             JMSTD JT-DNKN JCON JDCON.                  I.981125
022900*****CLOSE             JMSTD JT-DNKN JCON JDCON  JTRN.            D.981125
022910*****CLOSE             JMSTD JT-DNKN JT-JYTO JCON JDCON           D.971128
022920*****CLOSE             JMSTD JT-DNKN JCON JDCON                   D.981027
022930*****                  JTRN  JHIZ.                                D.981027
022940 END-EX.
022950     EXIT.
022960**   ﾘﾊﾞｰｽ ﾋｮｳｼﾞ **                                               A 630106
022970 REV-DSP-RTN.                                                     A 630106
022980     DISPLAY  DSP-RC-ALL.                                         A 630106
022990     IF       YY  =  1                                            I.131121
023000              IF       ZZ  =  1       DISPLAY  DSP-RR101          I.131121
023010     ELSE     IF       ZZ  =  2       DISPLAY  DSP-RR102          I.131121
023020     ELSE     IF       ZZ  =  3       DISPLAY  DSP-RR103          I.131121
023030     ELSE     IF       ZZ  =  4       DISPLAY  DSP-RR104          I.131121
023040     ELSE     IF       ZZ  =  5       DISPLAY  DSP-RR105          I.131121
023050     ELSE     IF       ZZ  =  6       DISPLAY  DSP-RR106          I.131121
023060     ELSE     IF       ZZ  =  7       DISPLAY  DSP-RR107          I.131121
023070     ELSE     IF       ZZ  =  8       DISPLAY  DSP-RR108          I.131121
023080     ELSE     IF       ZZ  =  9       DISPLAY  DSP-RR109          I.131121
023090     ELSE     IF       ZZ  =  10      DISPLAY  DSP-RR110.         I.131121
023100     IF       YY  =  2                                            I.131121
023110              IF       ZZ  =  1       DISPLAY  DSP-RR201          I.131121
023120     ELSE     IF       ZZ  =  2       DISPLAY  DSP-RR202          I.131121
023130     ELSE     IF       ZZ  =  3       DISPLAY  DSP-RR203          I.131121
023140     ELSE     IF       ZZ  =  4       DISPLAY  DSP-RR204          I.131121
023150     ELSE     IF       ZZ  =  5       DISPLAY  DSP-RR205          I.131121
023160     ELSE     IF       ZZ  =  6       DISPLAY  DSP-RR206          I.131121
023170     ELSE     IF       ZZ  =  7       DISPLAY  DSP-RR207          I.131121
023180     ELSE     IF       ZZ  =  8       DISPLAY  DSP-RR208          I.131121
023190     ELSE     IF       ZZ  =  9       DISPLAY  DSP-RR209          I.131121
023200     ELSE     IF       ZZ  =  10      DISPLAY  DSP-RR210.         I.131121
023210     IF       YY  =  3                                            I.131121
023220              IF       ZZ  =  1       DISPLAY  DSP-RR301          I.131121
023230     ELSE     IF       ZZ  =  2       DISPLAY  DSP-RR302          I.131121
023240     ELSE     IF       ZZ  =  3       DISPLAY  DSP-RR303          I.131121
023250     ELSE     IF       ZZ  =  4       DISPLAY  DSP-RR304          I.131121
023260     ELSE     IF       ZZ  =  5       DISPLAY  DSP-RR305          I.131121
023270     ELSE     IF       ZZ  =  6       DISPLAY  DSP-RR306          I.131121
023280     ELSE     IF       ZZ  =  7       DISPLAY  DSP-RR307          I.131121
023290     ELSE     IF       ZZ  =  8       DISPLAY  DSP-RR308          I.131121
023300     ELSE     IF       ZZ  =  9       DISPLAY  DSP-RR309          I.131121
023310     ELSE     IF       ZZ  =  10      DISPLAY  DSP-RR310.         I.131121
023320     IF       YY  =  4                                            I.131121
023330              IF       ZZ  =  1       DISPLAY  DSP-RR401          I.131121
023340     ELSE     IF       ZZ  =  2       DISPLAY  DSP-RR402          I.131121
023350     ELSE     IF       ZZ  =  3       DISPLAY  DSP-RR403          I.131121
023360     ELSE     IF       ZZ  =  4       DISPLAY  DSP-RR404          I.131121
023370     ELSE     IF       ZZ  =  5       DISPLAY  DSP-RR405          I.131121
023380     ELSE     IF       ZZ  =  6       DISPLAY  DSP-RR406          I.131121
023390     ELSE     IF       ZZ  =  7       DISPLAY  DSP-RR407          I.131121
023400     ELSE     IF       ZZ  =  8       DISPLAY  DSP-RR408          I.131121
023410     ELSE     IF       ZZ  =  9       DISPLAY  DSP-RR409          I.131121
023420     ELSE     IF       ZZ  =  10      DISPLAY  DSP-RR410.         I.131121
023430*****IF       YY  =  1       DISPLAY  DSP-RR1.                    D.131121
023440*****IF       YY  =  2       DISPLAY  DSP-RR2.                    D.131121
023450*****IF       YY  =  3       DISPLAY  DSP-RR3.                    D.131121
023460*****IF       YY  =  4       DISPLAY  DSP-RR4.                    D.131121
023470 REV-DSP-EX.                                                      A 630106
023480     EXIT.                                                        A 630106
023490 REV-CLE-RTN.                                                     A 630106
023500     DISPLAY  DSP-RC-ALL.                                         A 630106
023510 REV-CLE-EX.                                                      A 630106
023520     EXIT.                                                        A 630106
023530*****更新　処理
023540 UPD-RTN.
023550     IF       GMN-ACT  NOT = 1
023560              ADD   1  TO    WS-SEQ.
023570     PERFORM  UP1-RTN  THRU  UP1-EX.                              ｺﾝﾄﾛｰﾙF
023580     PERFORM  UP2-RTN  THRU  UP2-EX.                              伝番検索
023590*****PERFORM  UP3-RTN  THRU  UP3-EX.                              D.971128
023600*****PERFORM  UP4-RTN  THRU  UP4-EX.                              D.981027
023610*****PERFORM  UP5-RTN  THRU  UP5-EX.                              D.981125
023620     PERFORM  UP6-RTN  THRU  UP6-EX.                              受注ﾏｽﾀ
023630     CLOSE    JMSTD.                                              I.981106
023640     OPEN  I-O  JMSTD.                                            I.981106
023650     MOVE     ZERO     TO    COMPLETION-CODE.
023660 UPD-EX.
023670     EXIT.
023680******************************
023690*    コントロールＦ　更新    *
023700******************************
023710 UP1-RTN.
023720*****  受注№  *****
023730     MOVE    SPACE   TO     SW-INV.
023740     IF      GMN-ACT NOT =  1                  GO  TO  UP1-EX.
023750     MOVE    1       TO     JCON1-01.
023760     MOVE    1       TO     JCON1-02.
023770     READ    JCON    INVALID KEY
023780             INITIALIZE     JCON1-R
023790             MOVE    1  TO  JCON1-01
023800             MOVE    1  TO  JCON1-02
023810             MOVE  "01" TO  SW-INV.
023820 UP1-010.
023830*****IF      JS-SIGN     =  1                  GO  TO  UP1-020.   D.030702
023840     IF      JS-SIGN NOT =  0                  GO  TO  UP1-020.   I.030702
023850     ADD     1       TO     JCON1-03.
023860     IF      JCON1-03    =  200000
023870             MOVE  100001   TO  JCON1-03.
023880     IF      SW-INV    =   "01"                                   I.030702
023890             MOVE  300001   TO  JCON1-04                          I.030702
023900*****        MOVE  500001   TO  JCON1-05.                         D.070410
023910     MOVE    ZERO           TO  JMSTD-KEY1.
023920     MOVE    JCON1-03       TO  JMSTD-07 GMN-JNO.
023930     GO  TO  UP1-030.
023940 UP1-020.
023950*****IF      JS-SIGN NOT =  1                  GO  TO  UP1-025.   D.070410
023960     ADD     1       TO     JCON1-04.
023970*****IF      JCON1-03    =  400000                                D.980615
023980     IF      JCON1-04    =  400000                                I.980615
023990             MOVE  300001   TO  JCON1-04.
024000     IF      SW-INV    =   "01"                                   I.030702
024010             MOVE  100001   TO  JCON1-03                          I.030702
024020*****        MOVE  500001   TO  JCON1-05.                         D.070410
024030     MOVE    ZERO           TO  JMSTD-KEY1.
024040     MOVE    JCON1-04       TO  JMSTD-07 GMN-JNO.
024050*****GO  TO  UP1-030.                                             D.070410
024060*UP1-025.                                                         D.070410
024070*****ADD     1       TO     JCON1-05.                             D.070410
024080*****IF      JCON1-05    =  600000                                D.070410
024090*****        MOVE  500001   TO  JCON1-05.                         D.070410
024100*****IF      SW-INV    =   "01"                                   D.070410
024110*****        MOVE  100001   TO  JCON1-03                          D.070410
024120*****        MOVE  300001   TO  JCON1-04.                         D.070410
024130*****MOVE    ZERO           TO  JMSTD-KEY1.                       D.070410
024140*****MOVE    JCON1-05       TO  JMSTD-07 GMN-JNO.                 D.070410
024150 UP1-030.
024160     START   JMSTD  KEY NOT <   JMSTD-KEY1   INVALID KEY
024170                                             GO  TO  UP1-040.
024180     READ    JMSTD  NEXT UNLOCK AT  END      GO  TO  UP1-040.
024190     IF      JS-SIGN   =    0
024200        IF   JCON1-03  =    JMSTD-07         GO  TO  UP1-010.
024210     IF      JS-SIGN   =    1
024220        IF   JCON1-04  =    JMSTD-07         GO  TO  UP1-020.
024230*****IF      JS-SIGN   =    2                                     D.070410
024240*****   IF   JCON1-05  =    JMSTD-07         GO  TO  UP1-025.     D.070410
024250 UP1-040.
024260     IF      JS-SIGN   =    0
024270             MOVE  JCON1-03    TO   WJCON1-03  GMN-JNO
024280        ELSE
024290             MOVE  JCON1-04    TO   WJCON1-03  GMN-JNO.           I.070410
024300*****        IF      JS-SIGN   =    1                             D.070410
024310*****                MOVE  JCON1-04    TO   WJCON1-03  GMN-JNO    D.070410
024320*****        ELSE                                                 D.070410
024330*****                MOVE  JCON1-05    TO   WJCON1-03  GMN-JNO.   D.070410
024340*****        MOVE  JCON1-04    TO   WJCON1-03  GMN-JNO.           D.030702
024350     IF      SW-INV    =   "01"
024360             MOVE  SPACE       TO   SW-INV   GO  TO  UP1-060.
024370 UP1-050.
024380     PERFORM REW-CON-RTN  THRU  REW-CON-EX.
024390     GO  TO  UP1-EX.
024400 UP1-060.
024410     PERFORM WRI-CON-RTN  THRU  WRI-CON-EX.
024420 UP1-EX.
024430     EXIT.
024440******************************
024450*    伝票№検索Ｆ　更新      *
024460******************************
024470 UP2-RTN.
024480     IF       GMN-ACT =  2 OR 3
024490              NEXT    SENTENCE
024500        ELSE  GO  TO  UP2-050.
024510     PERFORM  SUB-2D-RTN  THRU  SUB-2D-EX
024520              VARYING  I  FROM  1  BY  1
024530              UNTIL    I  >  6.
024540 UP2-050.
024550     IF       GMN-ACT =  1 OR 2
024560              NEXT    SENTENCE
024570        ELSE  GO  TO  UP2-EX.
024580     MOVE     1   TO  UPD-SW.
024590     PERFORM  SUB-2W-RTN  THRU  SUB-2W-EX
024600              VARYING  I  FROM  1  BY  1
024610              UNTIL    I  >  6.
024620 UP2-EX.
024630     EXIT.
024640**
024650 SUB-2D-RTN.
024660     IF       WS-HCD(I) =  ZERO      GO  TO  SUB-2D-EX.
024670     MOVE     1            TO   DNKN-01.
024680     MOVE     WS-HCD(I)    TO   DNKN-02.
024690     MOVE     2            TO   DNKN-03.
024700     MOVE     GMN-JNO      TO   DNKN-041.
024710     MOVE     I            TO   DNKN-042.
024720     READ     JT-DNKN      INVALID
024730              DISPLAY  ERR-DNKN DISP-BUZ-B DISP-MSG-SPACE-1
024740              GO  TO   SUB-2D-EX.
024750     PERFORM  DEL-DNKN-RTN THRU DEL-DNKN-EX.
024760 SUB-2D-EX.
024770     EXIT.
024780**
024790 SUB-2W-RTN.
024800     IF       GMN-HCD(I) = ZERO      GO  TO  SUB-2W-EX.
024810     MOVE     SPACE        TO   DNKN-R.
024820     MOVE     1            TO   DNKN-01.
024830     MOVE     GMN-HCD(I)   TO   DNKN-02.
024840     MOVE     2            TO   DNKN-03.
024850     MOVE     GMN-JNO      TO   DNKN-041.
024860     MOVE     I            TO   DNKN-042.
024870**
024880     PERFORM  WRI-DNKN-RTN THRU WRI-DNKN-EX.
024890 SUB-2W-EX.
024900     EXIT.
024910******************************
024920*    受注統計Ｆ　更新        *
024930******************************
024940*UP3-RTN.                                                         D.971128
024950*****IF       GMN-ACT =  1                  GO  TO  UP3-050.      D.971128
024960*****PERFORM  SUB-3A-RTN  THRU  SUB-3A-EX                         D.971128
024970*****         VARYING  I  FROM  1  BY  1                          D.971128
024980*****         UNTIL    I  >  6.                                   D.971128
024990*UP3-050.                                                         D.971128
025000*****IF       GMN-ACT =  3                  GO  TO  UP3-EX.       D.971128
025010*****PERFORM  SUB-3B-RTN  THRU  SUB-3B-EX                         D.971128
025020*****         VARYING  I  FROM  1  BY  1                          D.971128
025030*****         UNTIL    I  >  6.                                   D.971128
025040*UP3-EX.                                                          D.971128
025050*****EXIT.                                                        D.971128
025060***
025070*SUB-3A-RTN.                                                      D.971128
025080*****MOVE     0          TO  INV-SW.                              D.971128
025090*****IF       WS-HCD(I)  =   ZERO     GO  TO  SUB-3A-EX.          D.971128
025100*****MOVE     ZERO       TO  JYTO-KEY.                            D.971128
025110*****MOVE     WS-JYY     TO  JYTO-011.                            D.971128
025120*****MOVE     WS-JMM     TO  JYTO-012.                            D.971128
025130*****MOVE     WS-HCD(I)  TO  JYTO-02.                             D.971128
025140*****MOVE     WS-SIZ(I)  TO  JYTO-03.                             D.971128
025150*****MOVE     JYTO-KEY   TO  WJYTO-KEY.                           D.971128
025160*****READ     JT-JYTO    INVALID                                  D.971128
025170*****         MOVE       SPACE    TO  JYTO-R                      D.971128
025180*****         INITIALIZE              JYTO-R                      D.971128
025190*****         MOVE       WJYTO-KEY TO JYTO-KEY                    D.971128
025200*****         MOVE  1    TO  INV-SW.                              D.971128
025210*****MOVE     1     TO   P.                                       D.971128
025220*SUB-3A-010.                                                      D.971128
025230*****COMPUTE  JYTO-041(P) =  JYTO-041(P) - WS-SU(I , P).          D.971128
025240*****ADD      1     TO   P.                                       D.971128
025250*****IF       P NOT >    10       GO  TO   SUB-3A-010.            D.971128
025260*****PERFORM  SUB-3C-RTN    THRU  SUB-3C-EX.                      D.971128
025270*****IF       CHK-SW  =  1                                        D.971128
025280*****    IF   INV-SW  =  1        GO  TO   SUB-3A-EX              D.971128
025290*****    ELSE                     GO  TO   SUB-3A-100.            D.971128
025300*****IF       INV-SW  =  1        GO  TO   SUB-3A-050.            D.971128
025310*****PERFORM  REW-JYTO-RTN  THRU  REW-JYTO-EX.                    D.971128
025320*****GO  TO   SUB-3A-EX.                                          D.971128
025330*SUB-3A-050.                                                      D.971128
025340*****PERFORM  WRI-JYTO-RTN  THRU  WRI-JYTO-EX.                    D.971128
025350*****GO  TO   SUB-3A-EX.                                          D.971128
025360*SUB-3A-100.                                                      D.971128
025370*****PERFORM  DEL-JYTO-RTN  THRU  DEL-JYTO-EX.                    D.971128
025380*SUB-3A-EX.                                                       D.971128
025390*****EXIT.                                                        D.971128
025400***
025410*SUB-3B-RTN.                                                      D.971128
025420*****MOVE     0          TO  INV-SW.                              D.971128
025430*****IF       GMN-HCD(I) =   ZERO     GO  TO  SUB-3B-EX.          D.971128
025440*****MOVE     ZERO       TO  JYTO-KEY.                            D.971128
025450*****MOVE     GMN-JYY    TO  JYTO-011.                            D.971128
025460*****MOVE     GMN-JMM    TO  JYTO-012.                            D.971128
025470*****MOVE     GMN-HCD(I) TO  JYTO-02.                             D.971128
025480*****MOVE     GMN-SIZ(I) TO  JYTO-03.                             D.971128
025490*****MOVE     JYTO-KEY   TO  WJYTO-KEY.                           D.971128
025500*****READ     JT-JYTO    INVALID                                  D.971128
025510*****         MOVE       SPACE    TO  JYTO-R                      D.971128
025520*****         INITIALIZE              JYTO-R                      D.971128
025530*****         MOVE       WJYTO-KEY TO JYTO-KEY                    D.971128
025540*****         MOVE  1    TO  INV-SW.                              D.971128
025550*****MOVE     1     TO   P.                                       D.971128
025560*SUB-3B-010.                                                      D.971128
025570*****IF     ( GMN-ACT =  1 ) AND ( P = 10 )                       D.930922
025580*****         NEXT  SENTENCE                                      D.930922
025590*****   ELSE                                                      D.930922
025600***           COMPUTE JYTO-041(P) = JYTO-041(P) + GMN-SU(I , P).  *D 93/01
025610*****         COMPUTE JYTO-041(P) = JYTO-041(P) + (GMN-SU(I  P)   D.971128
025620*****               + WS-1211(I P) + WS-141(I P) + WS-151(I P)).  D.971128
025630*****ADD      1     TO   P.                                       D.971128
025640*****IF       P NOT >    10       GO  TO   SUB-3B-010.            D.971128
025650*****PERFORM  SUB-3C-RTN    THRU  SUB-3C-EX.                      D.971128
025660*****IF       CHK-SW  =  1                                        D.971128
025670*****    IF   INV-SW  =  1        GO  TO   SUB-3B-EX              D.971128
025680*****    ELSE                     GO  TO   SUB-3B-100.            D.971128
025690*****IF       INV-SW  =  1        GO  TO   SUB-3B-050.            D.971128
025700*****PERFORM  REW-JYTO-RTN  THRU  REW-JYTO-EX.                    D.971128
025710*****GO  TO   SUB-3B-EX.                                          D.971128
025720*SUB-3B-050.                                                      D.971128
025730*****PERFORM  WRI-JYTO-RTN  THRU  WRI-JYTO-EX.                    D.971128
025740*****GO  TO   SUB-3B-EX.                                          D.971128
025750*SUB-3B-100.                                                      D.971128
025760*****PERFORM  DEL-JYTO-RTN  THRU  DEL-JYTO-EX.                    D.971128
025770*SUB-3B-EX.                                                       D.971128
025780*****EXIT.                                                        D.971128
025790**
025800*SUB-3C-RTN.                                                      D.971128
025810*****MOVE 0    TO  CHK-SW.                                        D.971128
025820*****IF   JYTO-041(1) = 0  AND  JYTO-041(2) = 0                   D.971128
025830*****  AND JYTO-041(3) = 0  AND  JYTO-041(4) = 0                  D.971128
025840*****   AND JYTO-041(5) = 0  AND  JYTO-041(6) = 0                 D.971128
025850*****    AND JYTO-041(7) = 0  AND  JYTO-041(8) = 0                D.971128
025860*****     AND JYTO-041(9) = 0  AND  JYTO-041(10) = 0              D.971128
025870*****         MOVE 1   TO   CHK-SW.                               D.971128
025880*SUB-3C-EX.                                                       D.971128
025890*****EXIT.                                                        D.971128
025900********************************
025910*    品名別受注残Ｆ　更新      *
025920********************************
025930*UP4-RTN.                                                         D.981027
025940*****IF       GMN-ACT =  1                  GO  TO  UP4-050.      D.981027
025950*****PERFORM  SUB-4A-RTN  THRU  SUB-4A-EX                         D.981027
025960*****         VARYING  I  FROM  1  BY  1                          D.981027
025970*****         UNTIL    I  >  6.                                   D.981027
025980*UP4-050.                                                         D.981027
025990*****IF       GMN-ACT =  3                  GO  TO  UP4-EX.       D.981027
026000*****PERFORM  SUB-4B-RTN  THRU  SUB-4B-EX                         D.981027
026010*****         VARYING  I  FROM  1  BY  1                          D.981027
026020*****         UNTIL    I  >  6.                                   D.981027
026030*UP4-EX.                                                          D.981027
026040*****EXIT.                                                        D.981027
026050**
026060*SUB-4A-RTN.                                                      D.981027
026070*****MOVE     0           TO   INV-SW.                            D.981027
026080*****IF       WS-HCD(I)  =  ZERO    GO  TO  SUB-4A-EX.            D.981027
026090*****MOVE     WS-HCD(I)   TO   JHIZ-KEY.                          D.981027
026100*****READ     JHIZ        INVALID                                 D.981027
026110*****         MOVE       SPACE    TO  JHIZ-R                      D.981027
026120*****         INITIALIZE              JHIZ-R                      D.981027
026130*****         MOVE       WS-HCD(I) TO JHIZ-KEY                    D.981027
026140*****         MOVE  1    TO  INV-SW.                              D.981027
026150*****MOVE     1          TO  P.                                   D.981027
026160*SUB-4A-010.                                                      D.981027
026170*****IF       WS-SIZ(I)  =   1                                    D.981027
026180*****         COMPUTE  JHIZ-0211(P) = JHIZ-0211(P) - (WS-SU(I P)  D.981027
026190*****                               - WS-1211(I P) - WS-141(I P)).D.981027
026200*****IF       WS-SIZ(I)  =   2                                    D.981027
026210*****         COMPUTE  JHIZ-0221(P) = JHIZ-0221(P) - (WS-SU(I P)  D.981027
026220*****                               - WS-1211(I P) - WS-141(I P)).D.981027
026230*****IF       WS-SIZ(I)  =   3                                    D.981027
026240*****         COMPUTE  JHIZ-0231(P) = JHIZ-0231(P) - (WS-SU(I P)  D.981027
026250*****                               - WS-1211(I P) - WS-141(I P)).D.981027
026260*****IF       WS-SIZ(I)  =   4                                    D.981027
026270*****         COMPUTE  JHIZ-0241(P) = JHIZ-0241(P) - (WS-SU(I P)  D.981027
026280*****                               - WS-1211(I P) - WS-141(I P)).D.981027
026290*****COMPUTE  JHIZ-031 = JHIZ-031 - (WS-SU(I P)                   D.981027
026300*****                               - WS-1211(I P) - WS-141(I P)).D.981027
026310*****ADD      1   TO   P.                                         D.981027
026320*****IF       P NOT >  10        GO  TO  SUB-4A-010.              D.981027
026330*****IF       INV-SW   = 1                                        D.981027
026340*****         PERFORM  WRI-JHIZ-RTN  THRU WRI-JHIZ-EX             D.981027
026350*****   ELSE  PERFORM  REW-JHIZ-RTN  THRU REW-JHIZ-EX.            D.981027
026360*****COMPUTE  JHIZ-031 = JHIZ-031 -  WS-KEI(I).                   *D 93/01
026370*****IF       INV-SW   = 1       GO  TO  SUB-4A-050.              D.980929
026380*****PERFORM  REW-JHIZ-RTN  THRU REW-JHIZ-EX.                     D.980929
026390*****GO  TO   SUB-4A-EX.                                          D.980929
026400*SUB-4A-050.                                                      D.980929
026410*****PERFORM  WRI-JHIZ-RTN  THRU WRI-JHIZ-EX.                     D.980929
026420*SUB-4A-EX.                                                       D.981027
026430*****EXIT.                                                        D.981027
026440***
026450*SUB-4B-RTN.                                                      D.981027
026460*****MOVE     0           TO   INV-SW.                            D.981027
026470*****IF       GMN-HCD(I) =  ZERO    GO  TO  SUB-4B-EX.            D.981027
026480*****MOVE     GMN-HCD(I)  TO   JHIZ-KEY.                          D.981027
026490*****READ     JHIZ        INVALID                                 D.981027
026500*****         MOVE       SPACE      TO  JHIZ-R                    D.981027
026510*****         INITIALIZE                JHIZ-R                    D.981027
026520*****         MOVE       GMN-HCD(I) TO  JHIZ-KEY                  D.981027
026530*****         MOVE  1    TO  INV-SW.                              D.981027
026540*****MOVE     1          TO  P.                                   D.981027
026550*SUB-4B-010.                                                      D.981027
026560*****IF     ( P = 10 ) AND ( GMN-SIZ(I) = 4 )                     D.981027
026570*****                                GO  TO   SUB-4B-015.         D.981027
026580*****IF       GMN-SIZ(I)  =   1                                   D.981027
026590*****         COMPUTE JHIZ-0211(P) = JHIZ-0211(P) + (GMN-SU(I P)  D.981027
026600*****                                             + WS-151(I P)). D.981027
026610*****IF       GMN-SIZ(I)  =   2                                   D.981027
026620*****         COMPUTE JHIZ-0221(P) = JHIZ-0221(P) + (GMN-SU(I P)  D.981027
026630*****                                             + WS-151(I P)). D.981027
026640*****IF       GMN-SIZ(I)  =   3                                   D.981027
026650*****         COMPUTE JHIZ-0231(P) = JHIZ-0231(P) + (GMN-SU(I P)  D.981027
026660*****                                             + WS-151(I P)). D.981027
026670*****IF       GMN-SIZ(I)  =   4                                   D.981027
026680*****         COMPUTE JHIZ-0241(P) = JHIZ-0241(P) + (GMN-SU(I P)  D.981027
026690*****                                             + WS-151(I P)). D.981027
026700*****COMPUTE  JHIZ-031 = JHIZ-031  + (GMN-SU(I P) + WS-151(I P)). D.981027
026710*SUB-4B-015.                                                      D.981027
026720*****ADD      1   TO   P.                                         D.981027
026730*****IF       P NOT >  10        GO  TO  SUB-4B-010.              D.981027
026740*****IF       INV-SW   = 1                                        D.981027
026750*****         PERFORM  WRI-JHIZ-RTN  THRU WRI-JHIZ-EX             D.981027
026760*****   ELSE  PERFORM  REW-JHIZ-RTN  THRU REW-JHIZ-EX.            D.981027
026770*****COMPUTE  JHIZ-031 = JHIZ-031  + GMN-KEI(I).                  *D 93/01
026780*****IF       INV-SW   = 1       GO  TO  SUB-4B-050.              D.980929
026790*****PERFORM  REW-JHIZ-RTN  THRU REW-JHIZ-EX.                     D.980929
026800*****GO  TO   SUB-4B-EX.                                          D.980929
026810*SUB-4B-050.                                                      D.980929
026820*****PERFORM  WRI-JHIZ-RTN  THRU WRI-JHIZ-EX.                     D.980929
026830*SUB-4B-EX.                                                       D.981027
026840*****EXIT.                                                        D.981027
026850******************************
026860*    受注トラン　更新        *
026870******************************
026880*UP5-RTN.                                                         D.981125
026890*****PERFORM  SUB-5W-RTN  THRU  SUB-5W-EX                         D.981125
026900*****         VARYING  I  FROM  1  BY  1                          D.981125
026910*****         UNTIL    I  >  6.                                   D.981125
026920*UP5-EX.                                                          D.981125
026930*****EXIT.                                                        D.981125
026940**
026950*SUB-5W-RTN.                                                      D.981125
026960*****IF       GMN-HCD(I)  =  ZERO      GO  TO  SUB-5W-EX.         D.981125
026970*****MOVE     SPACE       TO   JTRN-R.                            D.981125
026980*****MOVE     GMN-JNO     TO   JTRN-01.                           D.981125
026990*****MOVE     I           TO   JTRN-02.                           D.981125
027000*****MOVE     0           TO   JTRN-03.                           D.941024
027010*****MOVE     W-KBN       TO   JTRN-03.                           D.981125
027020*****MOVE     GMN-JYMD    TO   JTRN-04.                           D.981125
027030*****MOVE     GMN-TCCD    TO   JTRN-05.                           D.981125
027040*****MOVE     GMN-HCD(I)  TO   JTRN-06.                           D.981125
027050*****MOVE     GMN-SIZ(I)  TO   JTRN-06A.                          D.981125
027060*****MOVE     1           TO   P.                                 D.981125
027070*SUB-5W-010.                                                      D.981125
027080*****IF     ( GMN-SIZ(I) = 4 ) AND ( P = 10 )                     D.980929
027090*****         MOVE  0     TO   JTRN-0711(P)                       D.980929
027100*****  ELSE                                                       D.980929
027110*****MOVE  GMN-SU(I P) TO  JTRN-0711(P).                          D.981125
027120*****ADD      1      TO   P.                                      D.981125
027130*****IF       P NOT  >    10   GO  TO  SUB-5W-010.                D.981125
027140*****MOVE     GMN-NYMD(I) TO   JTRN-08.                           D.981125
027150*****MOVE     GMN-KEI(I)  TO   JTRN-09.                           D.981125
027160*****MOVE     GMN-ACT     TO   JTRN-10.                           D.981125
027170*****MOVE     GMN-TEKI    TO   JTRN-11.                           D.981125
027180*****MOVE     WS-SEQ      TO   JTRN-12.                           D.981125
027190*****MOVE     ZERO        TO   JTRN-141.                          D.981027
027200*****MOVE     ZERO        TO   JTRN-142.                          D.981027
027210*****MOVE     GMN-TAN(I)  TO   JTRN-15.                           D.981125
027220*****MOVE     GMN-SET     TO   JTRN-16.                           D.981125
027230*****MOVE     GMN-BIKHO(I) TO   JTRN-17.                          D.981125
027240*****MOVE     JS-SIGN     TO   JTRN-90.                           D.981125
027250**
027260*****PERFORM  WRI-JTRN-RTN  THRU  WRI-JTRN-EX.                    D.981125
027270*SUB-5W-EX.                                                       D.981125
027280*****EXIT.                                                        D.981125
027290******************************
027300*    受注マスタ　更新        *
027310******************************
027320 UP6-RTN.
027330     IF       GMN-ACT =  2 OR 3
027340              NEXT    SENTENCE
027350        ELSE  GO  TO  UP6-050.
027360**
027370     MOVE     ZERO    TO  JMSTD-KEY1.
027380     MOVE     GMN-JNO TO  JMSTD-07.
027390     START    JMSTD   KEY NOT <  JMSTD-KEY1 INVALID
027400              GO  TO  UP6-050.
027410 UP6-010.
027420     READ     JMSTD   NEXT AT END
027430              GO  TO  UP6-050.
027440     IF       JMSTD-07 NOT =  GMN-JNO       GO  TO  UP6-050.
027450     PERFORM  DEL-JMSTD-RTN THRU  DEL-JMSTD-EX.
027460     GO  TO   UP6-010.
027470 UP6-050.
027480     IF       GMN-ACT =  1 OR 2
027490              NEXT    SENTENCE
027500        ELSE  GO  TO  UP6-EX.
027510**
027520     PERFORM  SUB-6W-RTN  THRU  SUB-6W-EX
027530              VARYING  I  FROM  1  BY  1
027540              UNTIL I  >  6.
027550 UP6-EX.
027560     EXIT.
027570**
027580 SUB-6W-RTN.
027590     IF       GMN-HCD(I)  =  ZERO      GO  TO  SUB-6W-EX.
027600     PERFORM  SUB-MOV-RTN THRU SUB-MOV-EX.
027610**
027620     PERFORM  WRI-JMSTD-RTN  THRU  WRI-JMSTD-EX.
027630 SUB-6W-EX.
027640     EXIT.
027650**
027660 SUB-MOV-RTN.
027670     MOVE     SPACE       TO   JMSTD-R.
027680     INITIALIZE                JMSTD-R.
027690*****MOVE     0           TO   JMSTD-01.                          D.941024
027700     MOVE     W-KBN       TO   JMSTD-01.                          I.941024
027710     MOVE     GMN-JYMD    TO   JMSTD-02.
027720     MOVE     GMN-HCD(I)  TO   JMSTD-03 JMSTD-05.
027730     MOVE     GMN-TCD     TO   JMSTD-04.
027740     MOVE     GMN-NYMD(I) TO   JMSTD-06.
027750     MOVE     GMN-JNO     TO   JMSTD-07.
027760     MOVE     I           TO   JMSTD-08.
027770     MOVE     GMN-SIZ(I)  TO   JMSTD-09.
027780     MOVE     GMN-CCD     TO   JMSTD-10.
027790     MOVE     GMN-TENC    TO   JMSTD-23.                          I.080602
027800     MOVE     1           TO   P.
027810 SUB-MOV-010.
027820*****MOVE     GMN-SU(I P) TO   JMSTD-1111(P).                     *D 93/01
027830     COMPUTE  JMSTD-1111(P)  = GMN-SU(I P) + WS-1211(I P) +       *I 93/01
027840                               WS-141(I P) + WS-151(I P).         *I 93/01
027850     IF       GMN-ACT =   1
027860              MOVE   0    TO   JMSTD-1211(P) JMSTD-141(P)
027870              MOVE   0    TO   JMSTD-151(P)
027880        ELSE  MOVE   WS-1211(I P) TO JMSTD-1211(P)
027890              MOVE   WS-141 (I P) TO JMSTD-141 (P)
027900              MOVE   WS-151 (I P) TO JMSTD-151 (P).
027910     ADD      1      TO   P.
027920     IF       P NOT  >    10   GO  TO  SUB-MOV-010.
027930     MOVE     GMN-SET     TO   JMSTD-16.
027940     MOVE     GMN-TAN(I)  TO   JMSTD-17.
027950*****MOVE     ZERO        TO   JMSTD-18.                          D.981027
027960*****MOVE     ZERO        TO   JMSTD-191.                         D.981027
027970*****MOVE     ZERO        TO   JMSTD-192.                         D.981027
027980     MOVE     GMN-TEKI    TO   JMSTD-13.
027990     MOVE     WS-SEQ      TO   JMSTD-20.
028000     MOVE     GMN-BIKHO(I) TO   JMSTD-22.                         I.980604
028010     MOVE     GMN-BCD1(I) TO   JMSTD-51.                          I.040601
028020     MOVE     WK-DATE     TO   JMSTD-891.                         I.981125
028030     MOVE     GMN-ACT     TO   JMSTD-892.                         I.981125
028040     MOVE     JS-SIGN     TO   JMSTD-90.                          I.941019
028050     MOVE     T-TNC       TO   JMSTD-91.                          I.941005
028060 SUB-MOV-EX.
028070     EXIT.
028080*************************
028090*    ＪＣＯＮ　更新     *
028100*************************
028110 REW-CON-RTN.
028120     REWRITE  JCON1-R               INVALID KEY
028130              MOVE  "R"         TO  ERR-M
028140              MOVE  "JCON"      TO  ERR-F
028150              MOVE  JCON1-KEY   TO  ERR-K
028160              PERFORM     ERR-RTN   THRU      ERR-EX.
028170 REW-CON-EX.
028180     EXIT.
028190 WRI-CON-RTN.
028200     WRITE    JCON1-R               INVALID KEY
028210              MOVE  "W"         TO  ERR-M
028220              MOVE  "JCON"      TO  ERR-F
028230              MOVE  JCON1-KEY   TO  ERR-K
028240              PERFORM     ERR-RTN   THRU      ERR-EX.
028250     CALL     "CBLTCLS"   USING     JCON.
028260 WRI-CON-EX.
028270     EXIT.
028280*****************************
028290*    伝票№検索Ｆ　更新     *
028300*****************************
028310 DEL-DNKN-RTN.
028320     DELETE   JT-DNKN               INVALID KEY
028330              MOVE  "D"         TO  ERR-M
028340              MOVE  "JT-DNKN"   TO  ERR-F
028350              MOVE  DNKN-KEY    TO  ERR-K
028360              PERFORM     ERR-RTN   THRU      ERR-EX.
028370     CALL     "CBLTCLS"   USING     JT-DNKN.
028380 DEL-DNKN-EX.
028390     EXIT.
028400 WRI-DNKN-RTN.
028410     WRITE    DNKN-R                INVALID KEY
028420              MOVE  "W"         TO  ERR-M
028430              MOVE  "JT-DNKN"   TO  ERR-F
028440              MOVE  DNKN-KEY    TO  ERR-K
028450              PERFORM     ERR-RTN   THRU      ERR-EX.
028460     CALL     "CBLTCLS"   USING     JT-DNKN.
028470 WRI-DNKN-EX.
028480     EXIT.
028490*******************************
028500*    品名別受注残Ｆ　更新     *
028510*******************************
028520*REW-JHIZ-RTN.                                                    D.981027
028530*****REWRITE  JHIZ-R                INVALID KEY                   D.981027
028540*****         MOVE  "R"         TO  ERR-M                         D.981027
028550*****         MOVE  "JHIZ"      TO  ERR-F                         D.981027
028560*****         MOVE  JHIZ-KEY    TO  ERR-K                         D.981027
028570*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.981027
028580*REW-JHIZ-EX.                                                     D.981027
028590*****EXIT.                                                        D.981027
028600*WRI-JHIZ-RTN.                                                    D.981027
028610*****WRITE    JHIZ-R                INVALID KEY                   D.981027
028620*****         MOVE  "W"         TO  ERR-M                         D.981027
028630*****         MOVE  "JHIZ"      TO  ERR-F                         D.981027
028640*****         MOVE  JHIZ-KEY    TO  ERR-K                         D.981027
028650*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.981027
028660*****CALL     "CBLTCLS"   USING     JHIZ.                         D.981027
028670*WRI-JHIZ-EX.                                                     D.981027
028680*****EXIT.                                                        D.981027
028690***************************
028700*    受注統計Ｆ　更新     *
028710***************************
028720*REW-JYTO-RTN.                                                    D.971128
028730*****MOVE     JS-SIGN  TO  JYTO-05.                               D.971128
028740*****REWRITE  JYTO-R                INVALID KEY                   D.971128
028750*****         MOVE  "R"         TO  ERR-M                         D.971128
028760*****         MOVE  "JT-JYTO"   TO  ERR-F                         D.971128
028770*****         MOVE  JYTO-KEY    TO  ERR-K                         D.971128
028780*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.971128
028790*REW-JYTO-EX.                                                     D.971128
028800*****EXIT.                                                        D.971128
028810*WRI-JYTO-RTN.                                                    D.971128
028820*****MOVE     JS-SIGN  TO  JYTO-05.                               D.971128
028830*****WRITE    JYTO-R                INVALID KEY                   D.971128
028840*****         MOVE  "W"         TO  ERR-M                         D.971128
028850*****         MOVE  "JT-JYTO"   TO  ERR-F                         D.971128
028860*****         MOVE  JYTO-KEY    TO  ERR-K                         D.971128
028870*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.971128
028880*****CALL     "CBLTCLS"   USING     JT-JYTO.                      D.971128
028890*WRI-JYTO-EX.                                                     D.971128
028900*****EXIT.                                                        D.971128
028910*DEL-JYTO-RTN.                                                    D.971128
028920*****DELETE   JT-JYTO               INVALID KEY                   D.971128
028930*****         MOVE  "D"         TO  ERR-M                         D.971128
028940*****         MOVE  "JT-JYTO"   TO  ERR-F                         D.971128
028950*****         MOVE  JYTO-KEY    TO  ERR-K                         D.971128
028960*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.971128
028970*****CALL     "CBLTCLS"   USING     JT-JYTO.                      D.971128
028980*DEL-JYTO-EX.                                                     D.971128
028990*****EXIT.                                                        D.971128
029000***************************
029010*    受注トラン　更新     *
029020***************************
029030*WRI-JTRN-RTN.                                                    D.981125
029040*****WRITE    JTRN-R.                                             D.981125
029050*****IF       ERR-STAT  NOT =  "00"                               D.981125
029060*****         MOVE  "W"         TO  ERR-M                         D.981125
029070*****         MOVE  "JTRN"      TO  ERR-F                         D.981125
029080*****         MOVE  JTRN-R      TO  ERR-K                         D.981125
029090*****         PERFORM     ERR-RTN   THRU      ERR-EX.             D.981125
029100*****CALL     "CBLTCLS"   USING     JTRN.                         D.981125
029110*WRI-JTRN-EX.                                                     D.981125
029120*****EXIT.                                                        D.981125
029130***************************
029140*    受注マスタ　更新     *
029150***************************
029160 WRI-JMSTD-RTN.
029170     WRITE    JMSTD-R               INVALID KEY
029180              MOVE  "W"         TO  ERR-M
029190              MOVE  "JMSTD"     TO  ERR-F
029200              MOVE  JMSTD-KEY1  TO  ERR-K
029210              PERFORM     ERR-RTN   THRU      ERR-EX.
029220     CALL     "CBLTCLS"   USING     JMSTD.
029230 WRI-JMSTD-EX.
029240     EXIT.
029250 REW-JMSTD-RTN.
029260     REWRITE  JMSTD-R               INVALID KEY
029270              MOVE  "R"         TO  ERR-M
029280              MOVE  "JMSTD"     TO  ERR-F
029290              MOVE  JMSTD-KEY1  TO  ERR-K
029300              PERFORM     ERR-RTN   THRU      ERR-EX.
029310 REW-JMSTD-EX.
029320     EXIT.
029330 DEL-JMSTD-RTN.
029340     DELETE   JMSTD                 INVALID KEY
029350              MOVE  "D"         TO  ERR-M
029360              MOVE  "JMSTD"     TO  ERR-F
029370              MOVE  JMSTD-KEY1  TO  ERR-K
029380              PERFORM     ERR-RTN   THRU      ERR-EX.
029390     CALL     "CBLTCLS"   USING     JMSTD.
029400 DEL-JMSTD-EX.
029410     EXIT.
029420 TAN-RTN.                                                         I.040802
029430     MOVE 0 TO WK-TAN.                                            I.040802
029440     MOVE GMN-TCD TO THT-TCD.                                     I.040802
029450     MOVE GMN-HCD(XX) TO THT-HCD.                                 I.040802
029460     MOVE GMN-SIZ(XX) TO THT-SIZ.                                 I.040802
029470     READ THTM UNLOCK INVALID                                     I.040802
029480         MOVE ZERO TO THT-T.                                      I.040802
029490     MOVE THT-T TO WK-TAN.                                        I.040802
029500     IF WK-TAN NOT = ZERO                                         I.040802
029510         GO TO TAN-090.                                           I.040802
029520     MOVE GMN-TCD TO THT-TCD.                                     I.040802
029530     MOVE GMN-HCD(XX) TO THT-HCD.                                 I.040802
029540     MOVE 9 TO THT-SIZ.                                           I.040802
029550     READ THTM UNLOCK INVALID                                     I.040802
029560         MOVE ZERO TO THT-T.                                      I.040802
029570     MOVE THT-T TO WK-TAN.                                        I.040802
029580 TAN-090.                                                         I.040802
029590     IF WK-TAN NOT = ZERO                                         I.040802
029600         MOVE WK-TAN TO GMN-TAN(XX)                               I.040802
029610         GO TO TAN-EX.                                            I.040802
029620*****IF HI-BC1 > 19 AND < 30                                      D.080602
029630*****    MOVE HI-SB TO WK-TAN                                     D.080602
029640*****    MOVE WK-TAN TO GMN-TAN(XX).                              D.080602
029650 TAN-EX.                                                          I.040802
029660     EXIT.                                                        I.040802
