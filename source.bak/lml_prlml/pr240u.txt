000010 IDENTIFICATION  DIVISION.
000020***  åoîÔÉ}ÉXÉ^çXêV
000030***  AUTHOR :    MAYUMI.I.
000040***  BASE   :    ZA0118.
000050 PROGRAM-ID.     PR240U.
000060 ENVIRONMENT         DIVISION.
000070 CONFIGURATION       SECTION.
000080 SOURCE-COMPUTER.    NEAC-SYSTEM3100.
000090 OBJECT-COMPUTER.    NEAC-SYSTEM3100.
000100 INPUT-OUTPUT        SECTION.
000110 FILE-CONTROL.
000120     SELECT  SSD  ASSIGN  TO  F1-MSD.
000130     SELECT  FCTL-F  ASSIGN  TO  F2-MSD
000140       ORGANIZATION      INDEXED
000150       ACCESS    MODE    RANDOM
000160       RECORD    KEY     FCTL-KEY.
000170     SELECT  AM  ASSIGN  TO  F3-MSD
000180       ORGANIZATION      INDEXED
000190       ACCESS    MODE    RANDOM
000200       RECORD    KEY     AM-KEY.
000210     SELECT  HH-F  ASSIGN  TO  F4-MSD
000220       ORGANIZATION      INDEXED
000230       ACCESS            RANDOM
000240       RECORD    KEY     HH-KEY
000250       FILE STATUS ERR-STAT.
000260 I-O-CONTROL.
000270     APPLY       EXCLUSIVE-MODE ON   SSD
000280     APPLY       SHARED-MODE ON      FCTL-F  AM  HH-F.
000290 DATA            DIVISION.
000300 FILE            SECTION.
000310 COPY    SIWAKE.
000320 COPY    FCTL.
000330 COPY    ACCUNT.
000340 COPY    KEIHI.
000350 WORKING-STORAGE SECTION.
000360 77  ERR-STAT            PIC X(02).
000370 77  I                   PIC 9(02).                               ìYéö
000380*
000390     COPY  LWMSG.
000400*
000410 SCREEN          SECTION.
000420 SD  SCR-D
000430     END STATUS  IS  ESTAT.
000440 01  DSP-CLR.                                                     I.970120
000450     02  LINE 01  CLEAR  SCREEN.                                  I.970120
000460 01  DISP-BUZZER    LINE    24.
000470     03  DISP-BUZ-Q COLUMN  80  PIC  X(05)  VALUE ""27"J"02"".
000480 01  DSP-AREA.
000490     03  DSP-010    LINE    2.
000500         05  DSP-011    COLUMN    5  PIC  X(12)
000510                        VALUE  "∂”∏ œΩ¿ ∆ ≈º".
000520         05  DSP-013    COLUMN   20  PIC 9(4) FROM ACCNTCD OF SSD.
000530 01  ACP-AREA.
000540     03  ACP-010    LINE    2.
000550         05  ACP-011    COLUMN   40  PIC X(1)
000560                        INTO     I   CHECK OVERFLOW NO IFC.
000570         05  ACP-012    COLUMN   30  PIC X(1)
000580                        INTO     I   CHECK OVERFLOW NO IFC.
000590 01  DSP-AREA2.                                                   I.970120
000600     02  LINE 01  COLUMN 35  VALUE  NC"É}ÉXÉ^çXêVÅ@áD"  REVERSE.  I.970120
000610*
000620     COPY  LSMSG.
000630*
000640 PROCEDURE       DIVISION.
000650 ST.
000660     DISPLAY  DSP-CLR.                                            I.970120
000670     DISPLAY  DSP-AREA2.                                          I.970120
000680     OPEN       INPUT        SSD  AM.
000690     OPEN       I-O          HH-F.
000700*
000710     OPEN       INPUT        FCTL-F.
000720     MOVE  "DATE  "     TO  FCTL-KEY1.
000730     READ  FCTL-F  UNLOCK  INVALID
000740         DISPLAY  INV-MCT  DISP-BUZ-B
000750         CLOSE  FCTL-F
000760         GO  TO  CLSE-ENT.
000770     MOVE  FCTL-REC     TO  Z-R.
000780     CLOSE  FCTL-F.
000790*
000800 ST-10.
000810     READ       SSD           AT END
000820                PERFORM CLSE-ENT THRU CLSE-EXT
000830                STOP       RUN.
000840     MOVE  TRDATE     TO  ZYMD.                                   ì˙ït
000850     PERFORM  Z-RTN     THRU  Z-EXT.
000860     MOVE  ZI         TO  I.                                      ìYéö
000870     IF  I = 99
000880         GO  TO  ST-10.
000890*
000900     MOVE       ACCNTCD OF SSD TO     AM-KEY.                     â»ñ⁄ÇbÇc
000910     READ       AM   UNLOCK  INVALID KEY
000920       DISPLAY  DSP-011  DSP-013  DISP-BUZ-Q
000930       ACCEPT   ACP-011
000940       GO TO    ST-10.
000950     IF         KEIHIKB       NOT =  1           GO TO ST-10.
000960     MOVE       ACCNTCD OF SSD TO    HH-KACD.                     â»ñ⁄ÇbÇc
000970     MOVE       HOACCNT OF SSD TO    HH-HOCD.                     ï‚èïÇbÇc
000980     MOVE       SECTCD OF SSD TO     HH-BUCD.                     ïîñÂÇbÇc
000990     READ       HH-F         INVALID KEY
001000       GO TO    ST-10.
001010     IF         DR-CR  OF  AM =  DR-CR  OF  SSD
001020       ADD      AMOUNT OF SSD TO     HH-GEL(I)
001030     ELSE
001040       SUBTRACT AMOUNT OF SSD FROM   HH-GEL(I).
001050     MOVE HH-KEY     TO ERR-K.
001060     REWRITE    HH-R         INVALID KEY
001070                MOVE "HH-F"     TO ERR-F
001080                MOVE "R"        TO ERR-M
001090                PERFORM ERR-ENT THRU ERR-EXT.
001100     GO TO      ST-10.
001110 CLSE-ENT.
001120     CLOSE      SSD  AM  HH-F.
001130 CLSE-EXT.
001140     EXIT.
001150*
001160     COPY  LPMSG.
001170*
001180 END
