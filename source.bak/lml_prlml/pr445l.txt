000010 IDENTIFICATION              DIVISION.
000020 PROGRAM-ID.                 PR445L.
000030 AUTHOR.                     AKEMI.K.
000040*===============================================================*
000050*    ï‚èïÅ@å≥í†                                                 *
000060*                            --- 91/03/08 ---                   *
000070*===============================================================*
000080 ENVIRONMENT                DIVISION.
000090 CONFIGURATION              SECTION.
000100 SOURCE-COMPUTER.           NEAC-SYSTEM100.
000110 OBJECT-COMPUTER.           NEAC-SYSTEM100.
000120 INPUT-OUTPUT               SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.                                                 I.971113
000150     SELECT      KNG         ASSIGN  TO      F1-MSD
000160                             ORGANIZATION    INDEXED
000170                             ACCESS  MODE    RANDOM
000180                             RECORD  KEY     KNG-KEY.
000190     SELECT      AM          ASSIGN  TO      F2-MSD
000200                             ORGANIZATION    INDEXED
000210                             ACCESS  MODE    DYNAMIC
000220                             RECORD  KEY     AM-KEY.
000230     SELECT      HZM-F       ASSIGN  TO      F3-MSD
000240                             ORGANIZATION    INDEXED
000250                             ACCESS  MODE    DYNAMIC
000260                             RECORD  KEY     HZM-KEY.
000270     SELECT      FCTL-F      ASSIGN  TO      F4-MSD
000280                             ORGANIZATION    INDEXED
000290                             ACCESS  MODE    RANDOM
000300                             RECORD  KEY     FCTL-KEY.
000310     SELECT      SDH         ASSIGN  TO      F5-MSD
000320                             ORGANIZATION    INDEXED
000330                             ACCESS  MODE    DYNAMIC
000340                             RECORD  KEY     SH-KEY3.
000350*****SELECT      TK          ASSIGN  TO      F6-MSD               D.980224
000360*****                        ORGANIZATION    INDEXED              D.980224
000370*****                        ACCESS  MODE    RANDOM               D.980224
000380*****                        RECORD  KEY     TK-KEY.              D.980224
000390     SELECT      P-F         ASSIGN  TO      P-PRN999.
000400 I-O-CONTROL.
000410*****APPLY SHARED-MODE ON KNG AM HZM-F FCTL-F SDH TK              D.971113
000420*****APPLY SHARED-MODE ON M-DATE KNG AM HZM-F FCTL-F SDH TK       D.980224
000430     APPLY SHARED-MODE ON M-DATE KNG AM HZM-F FCTL-F SDH          I.980224
000440     APPLY SHIFT-CODE  ON P-F.
000450*******
000460 DATA                        DIVISION.
000470 FILE                        SECTION.
000480     COPY LIBFDD.                                                 I.971113
000490 COPY KANGEL.
000500 COPY ACCUNT.
000510 COPY LHOZAN.
000520 COPY FCTL.
000530 FD  SDH
000540     BLOCK CONTAINS 3 RECORDS
000550     LABEL RECORD STANDARD
000560     VALUE OF IDENTIFICATION "SIWAKE-H3".
000570 COPY SIWAKH.
000580*COPY TKLIB.                                                      D.980224
000590**
000600 FD  P-F
000610     LABEL RECORD OMITTED
000620     LINAGE IS 66.
000630 01  P-R                 PIC X(200).
000640 01  P1-R.
000650     02  P1-K15          PIC X(05).
000660     02  FILLER          PIC X(02).                               *
000670     02  FILLER          PIC X(01).
000680     02  P1-01.
000690*****  03  P1-01Y        PIC Z9.                                  D.971113
000700       03  P1-01Y        PIC 9(2).                                I.971113
000710       03  P1-01YH       PIC X(01).
000720       03  P1-01M        PIC Z9.
000730       03  P1-01MH       PIC X(01).
000740       03  P1-01D        PIC Z9.
000750     02  FILLER          PIC X(01).
000760     02  FILLER          PIC X(02).                               *
000770     02  FILLER          PIC X(01).
000780     02  P1-02           PIC 9(06).
000790     02  P1-02H          PIC X(01).
000800     02  P1-03           PIC 9(02).
000810     02  FILLER          PIC X(01).
000820     02  FILLER          PIC X(02).                               *
000830     02  FILLER          PIC X(01).
000840     02  P1-04           PIC N(10).
000850*****02  FILLER          PIC X(01).                               D.940809
000860*****02  P1-05F          PIC X(01).                               D.940809
000870*****02  P1-05           PIC 9(05).                               D.940809
000880*****02  P1-05T          PIC X(01).                               D.940809
000890     02  FILLER          PIC X(02).                               I.940809
000900     02  P1-05F          PIC X(01).                               I.940809
000910     02  P1-05           PIC 9(04).                               I.940809
000920     02  P1-05T          PIC X(01).                               I.940809
000930*****02  FILLER          PIC X(01).                               *D910513
000940     02  FILLER          PIC X(02).                               *
000950     02  P1-06           PIC ----,---,---,--9.
000960     02  FILLER          PIC X(01).
000970     02  FILLER          PIC X(02).                               *
000980     02  P1-07           PIC ----,---,---,--9.
000990     02  FILLER          PIC X(01).
001000     02  FILLER          PIC X(02).                               *
001010     02  P1-08           PIC ----,---,---,--9.
001020     02  FILLER          PIC X(01).
001030     02  FILLER          PIC X(02).                               *
001040     02  FILLER          PIC X(01).
001050     02  P1-09           PIC N(20).
001060     02  FILLER          PIC X(01).
001070     02  FILLER          PIC X(02).                               *
001080     02  FILLER          PIC X(02).
001090     02  P1-10           PIC X(01).
001100     02  FILLER          PIC X(01).
001110     02  FILLER          PIC X(02).                               *
001120     02  P1-K20          PIC X(05).
001130 01  P2-R.
001140     02  P2-K15          PIC X(05).
001150     02  FILLER          PIC X(02).                               *
001160     02  FILLER          PIC X(10).
001170     02  FILLER          PIC X(02).                               *
001180     02  FILLER          PIC X(11).
001190     02  FILLER          PIC X(02).                               *
001200     02  FILLER          PIC X(01).
001210     02  P2-04           PIC N(10).
001220     02  FILLER          PIC X(08).
001230     02  FILLER          PIC X(02).                               *
001240     02  P2-06           PIC ----,---,---,--9.
001250     02  FILLER          PIC X(01).
001260     02  FILLER          PIC X(02).                               *
001270     02  P2-07           PIC ----,---,---,--9.
001280     02  FILLER          PIC X(01).
001290     02  FILLER          PIC X(02).                               *
001300     02  P2-08           PIC ----,---,---,--9.
001310     02  FILLER          PIC X(01).
001320     02  FILLER          PIC X(02).                               *
001330     02  FILLER          PIC X(01).
001340     02  P2-09           PIC N(04).
001350     02  FILLER          PIC X(08).
001360     02  P2-99           PIC ----,---,---,--9.
001370     02  FILLER          PIC X(01).
001380     02  FILLER          PIC X(02).                               *
001390     02  FILLER          PIC X(04).
001400     02  FILLER          PIC X(02).                               *
001410     02  P2-K20          PIC X(05).
001420*****
001430 WORKING-STORAGE             SECTION.
001440 77  ERR-STAT            PIC  X(02).
001450 77  PCNT                PIC  9(05).
001460 77  PRINT-CNT           PIC  9(05).
001470 77  K20                 PIC  X(05) VALUE ""3FE04FE080"".
001480 77  K15                 PIC  X(05) VALUE ""3FE04F40A0"".
001490 77  WKZE                PIC  9(10) VALUE ZERO.
001500 77  WKSP                PIC  X(10) VALUE SPACE.
001510 77  WKNSP               PIC  N(20) VALUE SPACE.
001520 01  CRT-WK.
001530*****02  W-01F           PIC  9(04).                              D.950522
001540*****02  W-01T           PIC  9(04).                              D.950522
001550*****02  W-02F           PIC  9(04).                              D.950522
001560*****02  W-02T           PIC  9(04).                              D.950522
001570     02  W-121F.                                                  I.950522
001580         03  W-11F       PIC  9(04).                              I.950522
001590         03  W-21F       PIC  9(04).                              I.950522
001600     02  W-121T.                                                  I.950522
001610         03  W-11T       PIC  9(04).                              I.950522
001620         03  W-21T       PIC  9(04).                              I.950522
001630     02  W-122F.                                                  I.950522
001640         03  W-12F       PIC  9(04).                              I.950522
001650         03  W-22F       PIC  9(04).                              I.950522
001660     02  W-122T.                                                  I.950522
001670         03  W-12T       PIC  9(04).                              I.950522
001680         03  W-22T       PIC  9(04).                              I.950522
001690     02  W-123F.                                                  I.950522
001700         03  W-13F       PIC  9(04).                              I.950522
001710         03  W-23F       PIC  9(04).                              I.950522
001720     02  W-123T.                                                  I.950522
001730         03  W-13T       PIC  9(04).                              I.950522
001740         03  W-23T       PIC  9(04).                              I.950522
001750     02  W-124F.                                                  I.950522
001760         03  W-14F       PIC  9(04).                              I.950522
001770         03  W-24F       PIC  9(04).                              I.950522
001780     02  W-124T.                                                  I.950522
001790         03  W-14T       PIC  9(04).                              I.950522
001800         03  W-24T       PIC  9(04).                              I.950522
001810     02  W-125F.                                                  I.950522
001820         03  W-15F       PIC  9(04).                              I.950522
001830         03  W-25F       PIC  9(04).                              I.950522
001840     02  W-125T.                                                  I.950522
001850         03  W-15T       PIC  9(04).                              I.950522
001860         03  W-25T       PIC  9(04).                              I.950522
001870     02  W-126F.                                                  I.950522
001880         03  W-16F       PIC  9(04).                              I.950522
001890         03  W-26F       PIC  9(04).                              I.950522
001900     02  W-126T.                                                  I.950522
001910         03  W-16T       PIC  9(04).                              I.950522
001920         03  W-26T       PIC  9(04).                              I.950522
001930     02  W-03F.
001940*****  03  W-03FY        PIC  9(02).                              D.971113
001950       03  W-03FY        PIC  9(04).                              I.971113
001960       03  W-03FYL  REDEFINES W-03FY.                             I.971113
001970         04  W-03FY1     PIC  9(02).                              I.971113
001980         04  W-03FY2     PIC  9(02).                              I.971113
001990       03  W-03FM        PIC  9(02).
002000       03  W-03FD        PIC  9(02).
002010     02  W-03FR REDEFINES W-03F     PIC  9(08).                   I.971113
002020*****02  W-03FR REDEFINES W-03F     PIC  9(06).                   D.971113
002030     02  W-03T.
002040*****  03  W-03TY        PIC  9(02).                              D.971113
002050       03  W-03TY        PIC  9(04).                              I.971113
002060       03  W-03TYL  REDEFINES W-03TY.                             I.971113
002070         04  W-03TY1     PIC  9(02).                              I.971113
002080         04  W-03TY2     PIC  9(02).                              I.971113
002090       03  W-03TM        PIC  9(02).
002100       03  W-03TD        PIC  9(02).
002110     02  W-03TR REDEFINES W-03T     PIC  9(08).                   I.971113
002120     02  W-03TL REDEFINES W-03T.                                  I.971113
002130       03  F             PIC  9(02).                              I.971113
002140       03  W-03TS        PIC  9(06).                              I.971113
002150*****02  W-03TR REDEFINES W-03T     PIC  9(06).                   D.971113
002160     02  W-OKC           PIC  X(01).
002170 01  WORK-AREA.
002180     02  I               PIC  9(02).
002190     02  SOE             PIC  9(02).
002200     02  FI              PIC  9(02).
002210     02  TI              PIC  9(02).
002220     02  ERR-SW          PIC  9(01).
002230     02  INV-SW          PIC  9(01).
002240     02  W-ZENKI         PIC S9(11).
002250     02  W-ZAN           PIC S9(11).
002260     02  W-KASI          PIC S9(11).
002270     02  W-KARI          PIC S9(11).
002280**
002290     02  FROM-YMD.
002300       03  FROM-YM.
002310*****    04  FROM-Y      PIC  9(02).                              D.971113
002320         04  FROM-Y      PIC  9(04).                              I.971113
002330         04  FROM-M      PIC  9(02).
002340       03  FROM-D        PIC  9(02).
002350     02  TO-YMD.
002360       03  TO-YM.
002370*****    04  TO-Y        PIC  9(02).                              D.971113
002380         04  TO-Y        PIC  9(04).                              I.971113
002390         04  TO-M        PIC  9(02).
002400       03  TO-D          PIC  9(02).
002410     02  TO-YMD1.
002420       03  TO-YM1.
002430*****    04  TO-Y1       PIC  9(02).                              D.971113
002440         04  TO-Y1       PIC  9(04).                              I.971113
002450         04  TO-M1       PIC  9(02).
002460       03  TO-D1         PIC  9(02).
002470     02  W-YMD.
002480*****  03  W-Y           PIC  9(02).                              D.971113
002490       03  W-Y           PIC  9(04).                              I.971113
002500       03  W-MD.
002510         04  W-M         PIC  9(02).
002520         04  W-D         PIC  9(02).
002530     02  SYSDATE.
002540       03  SYS-YY        PIC  9(02).
002550       03  SYS-MM        PIC  9(02).
002560       03  SYS-DD        PIC  9(02).
002570     02  WK-YMD.
002580*****  03  WK-YY         PIC  9(02).                              D.971113
002590       03  WK-YY         PIC  9(04).                              I.971113
002600       03  WK-YYL  REDEFINES WK-YY.                               I.971113
002610         04  WK-YY1      PIC  9(02).                              I.971113
002620         04  WK-YY2      PIC  9(02).                              I.971113
002630       03  WK-MM         PIC  9(02).
002640       03  WK-DD         PIC  9(02).
002650     02  WK-ZZ           PIC  Z9.
002660     02  WK-ZZZZZ        PIC  ZZZZ9.
002670     02  WK-9999         PIC  9(04).
002680 01  OLD-KEY.
002690     02  OHTRDATE3.
002700*****  03  OHTRDATE3YY   PIC  9(02).                              D.971113
002710       03  OHTRDATE3YY   PIC  9(04).                              I.971113
002720       03  OHTRDATE3MM   PIC  9(02).
002730       03  OHTRDATE3DD   PIC  9(02).
002740     02  OHJUNLNO3       PIC  9(06).
002750     02  OZI             PIC  9(02).
002760 01  TOT-WK.
002770     02  TOT-ITEM OCCURS 3.
002780       03  TOT-KR        PIC S9(12).
002790       03  TOT-KS        PIC S9(12).
002800***
002810 01  MID03.
002820     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
002830     02  FILLER          PIC X(02) VALUE SPACE.
002840     02  M3-YY           PIC N(02).
002850     02  FILLER          PIC N(01) VALUE NC"îN".
002860     02  M3-MM           PIC N(02).
002870     02  FILLER          PIC N(01) VALUE NC"åé".
002880     02  M3-DD           PIC N(02).
002890     02  FILLER          PIC N(03) VALUE NC"ì˙çÏê¨".
002900     02  FILLER          PIC X(23) VALUE SPACE.
002910     02  FILLER          PIC X(02) VALUE ""3F91"".
002920     02  FILLER          PIC X(02) VALUE SPACE.
002930     02  FILLER          PIC N(09)
002940         VALUE NC"ï‚Å@èïÅ@å≥Å@í†".
002950     02  FILLER          PIC X(02) VALUE SPACE.
002960     02  FILLER          PIC X(02) VALUE ""3F92"".
002970     02  FILLER          PIC X(53) VALUE SPACE.
002980     02  M3-PCNT         PIC N(05).
002990     02  FILLER          PIC N(01) VALUE NC"ï≈".
003000 01  MID05.
003010     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
003020     02  FILLER          PIC X(28) VALUE SPACE.
003030     02  FILLER          PIC N(03) VALUE NC"ÅiÅ@é©".
003040     02  FILLER          PIC X(01) VALUE SPACE.
003050     02  M5-YY1          PIC N(02).
003060     02  FILLER          PIC N(01) VALUE NC"îN".
003070     02  FILLER          PIC X(01).
003080     02  M5-MM1          PIC N(02).
003090     02  FILLER          PIC N(01) VALUE NC"åé".
003100     02  FILLER          PIC X(01).
003110     02  M5-DD1          PIC N(02).
003120     02  FILLER          PIC N(04) VALUE NC"ì˙Å@Å@éä".
003130     02  FILLER          PIC X(01) VALUE SPACE.
003140     02  M5-YY2          PIC N(02).
003150     02  FILLER          PIC N(01) VALUE NC"îN".
003160     02  FILLER          PIC X(01) VALUE SPACE.
003170     02  M5-MM2          PIC N(02).
003180     02  FILLER          PIC N(01) VALUE NC"åé".
003190     02  FILLER          PIC X(01) VALUE SPACE.
003200     02  M5-DD2          PIC N(02).
003210     02  FILLER          PIC N(03) VALUE NC"ì˙Å@Åj".
003220 01  MID06.
003230     02  FILLER          PIC X(02) VALUE ""3F91"".
003240     02  FILLER          PIC X(96) VALUE SPACE.
003250     02  FILLER          PIC X(02) VALUE ""3F92"".
003260 01  MID07.
003270     02  FILLER          PIC X(02) VALUE ""3F93"".
003280     02  FILLER          PIC X(10) VALUE SPACE.
003290     02  FILLER          PIC X(02) VALUE ""3F93"".
003300     02  FILLER          PIC X(35) VALUE SPACE.
003310     02  FILLER          PIC X(02) VALUE ""3F93"".
003320     02  FILLER          PIC X(10) VALUE SPACE.
003330     02  FILLER          PIC X(02) VALUE ""3F93"".
003340     02  FILLER          PIC X(35) VALUE SPACE.
003350     02  FILLER          PIC X(02) VALUE ""3F93"".
003360     02  FILLER          PIC X(06) VALUE SPACE.
003370     02  FILLER          PIC X(02) VALUE ""3F93"".
003380 01  MID08.
003390     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
003400     02  FILLER          PIC X(02) VALUE ""3F93"".
003410     02  FILLER          PIC X(01) VALUE SPACE.
003420     02  FILLER          PIC N(04) VALUE NC"ä®íËâ»ñ⁄".
003430     02  FILLER          PIC X(01) VALUE SPACE.
003440     02  FILLER          PIC X(02) VALUE ""3F93"".
003450     02  FILLER          PIC X(01) VALUE SPACE.
003460     02  M8-01           PIC N(10).
003470     02  FILLER          PIC X(01) VALUE SPACE.
003480     02  FILLER          PIC N(01) VALUE NC"Åi".
003490     02  M8-02           PIC N(04).
003500     02  FILLER          PIC N(01) VALUE NC"Åj".
003510     02  FILLER          PIC X(01) VALUE SPACE.
003520     02  FILLER          PIC X(02) VALUE ""3F93"".
003530     02  FILLER          PIC X(01) VALUE SPACE.
003540     02  FILLER          PIC N(04) VALUE NC"ï‚èïâ»ñ⁄".
003550     02  FILLER          PIC X(01) VALUE SPACE.
003560     02  FILLER          PIC X(02) VALUE ""3F93"".
003570     02  FILLER          PIC X(01) VALUE SPACE.
003580     02  M8-03           PIC N(10).
003590     02  FILLER          PIC X(01) VALUE SPACE.
003600     02  FILLER          PIC N(01) VALUE NC"Åi".
003610     02  M8-04           PIC N(04).
003620     02  FILLER          PIC N(01) VALUE NC"Åj".
003630     02  FILLER          PIC X(01) VALUE SPACE.
003640     02  FILLER          PIC X(02) VALUE ""3F93"".
003650     02  FILLER          PIC X(01) VALUE SPACE.
003660     02  M8-05           PIC N(02).
003670     02  FILLER          PIC X(01) VALUE SPACE.
003680     02  FILLER          PIC X(02) VALUE ""3F93"".
003690 01  MID09.
003700     02  FILLER          PIC X(04) VALUE ""3F913F93"".
003710     02  FILLER          PIC X(10) VALUE SPACE.
003720     02  FILLER          PIC X(02) VALUE ""3F93"".
003730     02  FILLER          PIC X(35) VALUE SPACE.
003740     02  FILLER          PIC X(02) VALUE ""3F93"".
003750     02  FILLER          PIC X(10) VALUE SPACE.
003760     02  FILLER          PIC X(02) VALUE ""3F93"".
003770     02  FILLER          PIC X(35) VALUE SPACE.
003780     02  FILLER          PIC X(02) VALUE ""3F93"".
003790     02  FILLER          PIC X(06) VALUE SPACE.
003800     02  FILLER          PIC X(02) VALUE ""3F93"".
003810     02  FILLER          PIC X(36) VALUE SPACE.
003820     02  FILLER          PIC X(04) VALUE ""3F92"".
003830 01  MID10.
003840     02  FILLER          PIC X(02) VALUE ""3F93"".
003850     02  FILLER          PIC X(10) VALUE SPACE.
003860     02  FILLER          PIC X(02) VALUE ""3F93"".
003870     02  FILLER          PIC X(11) VALUE SPACE.
003880     02  FILLER          PIC X(02) VALUE ""3F93"".
003890     02  FILLER          PIC X(24) VALUE SPACE.
003900     02  FILLER          PIC X(02) VALUE ""3F93"".
003910     02  FILLER          PIC X(17) VALUE SPACE.
003920     02  FILLER          PIC X(02) VALUE ""3F93"".
003930     02  FILLER          PIC X(17) VALUE SPACE.
003940     02  FILLER          PIC X(02) VALUE ""3F93"".
003950     02  FILLER          PIC X(17) VALUE SPACE.
003960     02  FILLER          PIC X(02) VALUE ""3F93"".
003970     02  FILLER          PIC X(32) VALUE SPACE.
003980     02  FILLER          PIC X(02) VALUE ""3F93"".
003990     02  FILLER          PIC X(04) VALUE SPACE.
004000     02  FILLER          PIC X(02) VALUE ""3F93"".
004010 01  MID11.
004020     02  FILLER          PIC X(04) VALUE ""3F913F93"".
004030     02  FILLER          PIC X(01) VALUE SPACE.
004040     02  FILLER          PIC N(01) VALUE NC"ì˙".
004050     02  FILLER          PIC X(03) VALUE SPACE.
004060     02  FILLER          PIC N(01) VALUE NC"ït".
004070     02  FILLER          PIC X(02) VALUE SPACE.
004080     02  FILLER          PIC X(02) VALUE ""3F93"".
004090     02  FILLER          PIC X(01) VALUE SPACE.
004100     02  FILLER          PIC N(04) VALUE NC"ì`ï[î‘çÜ".
004110     02  FILLER          PIC X(02) VALUE SPACE.
004120     02  FILLER          PIC X(02) VALUE ""3F93"".
004130     02  FILLER          PIC X(01) VALUE SPACE.
004140     02  FILLER          PIC N(07) VALUE NC"éÊÅ@à¯Å@êÊÅ@ñº".      *C910513
004150*****02  FILLER          PIC X(02) VALUE SPACE.                   D.940809
004160*****02  FILLER          PIC X(07) VALUE "(∫∞ƒﬁ )".               D.940809
004170     02  FILLER          PIC X(03) VALUE SPACE.                   I.940809
004180     02  FILLER          PIC X(06) VALUE "(ïîñÂ)".                I.940809
004190     02  FILLER          PIC X(02) VALUE ""3F93"".
004200     02  FILLER          PIC X(01) VALUE SPACE.
004210     02  FILLER          PIC N(07) VALUE NC"éÿÅ@ï˚Å@ã‡Å@äz".
004220     02  FILLER          PIC X(02) VALUE SPACE.
004230     02  FILLER          PIC X(02) VALUE ""3F93"".
004240     02  FILLER          PIC X(01) VALUE SPACE.
004250     02  FILLER          PIC N(07) VALUE NC"ë›Å@ï˚Å@ã‡Å@äz".
004260     02  FILLER          PIC X(02) VALUE SPACE.
004270     02  FILLER          PIC X(02) VALUE ""3F93"".
004280     02  FILLER          PIC X(01) VALUE SPACE.
004290     02  FILLER          PIC N(07) VALUE NC"écÅ@çÇÅ@ã‡Å@äz".
004300     02  FILLER          PIC X(02) VALUE SPACE.
004310     02  FILLER          PIC X(02) VALUE ""3F93"".
004320     02  FILLER          PIC X(09) VALUE SPACE.
004330     02  FILLER          PIC N(07) VALUE NC"ìEÅ@Å@Å@Å@Å@óv".
004340     02  FILLER          PIC X(09) VALUE SPACE.
004350     02  FILLER          PIC X(02) VALUE ""3F93"".
004360     02  FILLER          PIC X(01) VALUE SPACE.
004370     02  FILLER          PIC N(01) VALUE NC"ê≈".
004380     02  FILLER          PIC X(01) VALUE SPACE.
004390     02  FILLER          PIC X(04) VALUE ""3F923F93"".
004400 01  YOKO.
004410     02  FILLER          PIC X(02) VALUE ""3F91"".                *
004420     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004430     02  FILLER          PIC X(10) VALUE SPACE.
004440     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004450     02  FILLER          PIC X(11) VALUE SPACE.
004460     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004470     02  FILLER          PIC X(24) VALUE SPACE.
004480     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004490     02  FILLER          PIC X(17) VALUE SPACE.
004500     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004510     02  FILLER          PIC X(17) VALUE SPACE.
004520     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004530     02  FILLER          PIC X(17) VALUE SPACE.
004540     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004550     02  FILLER          PIC X(32) VALUE SPACE.
004560     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004570     02  FILLER          PIC X(04) VALUE SPACE.
004580     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004590     02  FILLER          PIC X(02) VALUE ""3F92"".                *
004600 01  TATEP1.
004610     02  FILLER          PIC X(05) VALUE SPACE.
004620     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004630     02  FILLER          PIC X(10) VALUE SPACE.
004640     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004650     02  FILLER          PIC X(11) VALUE SPACE.
004660     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004670     02  FILLER          PIC X(29) VALUE SPACE.
004680     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004690     02  FILLER          PIC X(17) VALUE SPACE.
004700     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004710     02  FILLER          PIC X(17) VALUE SPACE.
004720     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004730     02  FILLER          PIC X(17) VALUE SPACE.
004740     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004750     02  FILLER          PIC X(42) VALUE SPACE.
004760     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004770     02  FILLER          PIC X(04) VALUE SPACE.
004780     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004790 01  TATEP2.
004800     02  FILLER          PIC X(05) VALUE SPACE.
004810     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004820     02  FILLER          PIC X(10) VALUE SPACE.
004830     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004840     02  FILLER          PIC X(11) VALUE SPACE.
004850     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004860     02  FILLER          PIC X(29) VALUE SPACE.
004870     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004880     02  FILLER          PIC X(17) VALUE SPACE.
004890     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004900     02  FILLER          PIC X(17) VALUE SPACE.
004910     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004920     02  FILLER          PIC X(17) VALUE SPACE.
004930     02  FILLER          PIC X(02) VALUE ""3F93"".
004940     02  FILLER          PIC X(34) VALUE SPACE.
004950     02  FILLER          PIC X(02) VALUE ""3F93"".
004960     02  FILLER          PIC X(04) VALUE SPACE.
004970     02  FILLER          PIC X(02) VALUE ""3F93"".
004980     02  FILLER          PIC X(05) VALUE SPACE.
004990*********
005000 COPY LWMSG.
005010*********
005020 SCREEN                  SECTION.
005030 SD  CRT-BF
005040     END  STATUS    IS   ESTAT.
005050 01  DISP-C   LINE 01.
005060     02  DISP-CLE  CLEAR SCREEN.
005070***
005080 01  ACP-AREA.
005090*****02  ACP-W01F    LINE 06   COLUMN 31    PIC 9(04)             D.950522
005100*****    USING W-01F                  CHECK OVERFLOW  NO IFC.     D.950522
005110*****02  ACP-W01T    LINE 06   COLUMN 51    PIC 9(04)             D.950522
005120*****    USING W-01T                  CHECK OVERFLOW  NO IFC.     D.950522
005130*****02  ACP-W02F    LINE 08   COLUMN 31    PIC 9(04)             D.950522
005140*****    USING W-02F                  CHECK OVERFLOW  NO IFC.     D.950522
005150*****02  ACP-W02T    LINE 08   COLUMN 51    PIC 9(04)             D.950522
005160*****    USING W-02T                  CHECK OVERFLOW  NO IFC.     D.950522
005170*****02  ACP-W03F    LINE 10.                                     D.950522
005180     02  LINE 06.                                                 I.950522
005190         03  ACP-W121F.                                           I.950522
005200             04  ACP-W11F          COLUMN 27    PIC 9(04)         I.950522
005210                 USING W-11F                              NO IFC. I.950522
005220             04  ACP-W21F          COLUMN 32    PIC 9(04)         I.950522
005230                 USING W-21F              CHECK OVERFLOW  NO IFC. I.950522
005240         03  ACP-W121T.                                           I.950522
005250             04  ACP-W11T          COLUMN 47    PIC 9(04)         I.950522
005260                 USING W-11T                              NO IFC. I.950522
005270             04  ACP-W21T          COLUMN 52    PIC 9(04)         I.950522
005280                 USING W-21T              CHECK OVERFLOW  NO IFC. I.950522
005290     02  LINE 08.                                                 I.950522
005300         03  ACP-W122F.                                           I.950522
005310             04  ACP-W12F          COLUMN 27    PIC 9(04)         I.950522
005320                 USING W-12F                              NO IFC. I.950522
005330             04  ACP-W22F          COLUMN 32    PIC 9(04)         I.950522
005340                 USING W-22F              CHECK OVERFLOW  NO IFC. I.950522
005350         03  ACP-W122T.                                           I.950522
005360             04  ACP-W12T          COLUMN 47    PIC 9(04)         I.950522
005370                 USING W-12T                              NO IFC. I.950522
005380             04  ACP-W22T          COLUMN 52    PIC 9(04)         I.950522
005390                 USING W-22T              CHECK OVERFLOW  NO IFC. I.950522
005400     02  LINE 10.                                                 I.950522
005410         03  ACP-W123F.                                           I.950522
005420             04  ACP-W13F          COLUMN 27    PIC 9(04)         I.950522
005430                 USING W-13F                              NO IFC. I.950522
005440             04  ACP-W23F          COLUMN 32    PIC 9(04)         I.950522
005450                 USING W-23F              CHECK OVERFLOW  NO IFC. I.950522
005460         03  ACP-W123T.                                           I.950522
005470             04  ACP-W13T          COLUMN 47    PIC 9(04)         I.950522
005480                 USING W-13T                              NO IFC. I.950522
005490             04  ACP-W23T          COLUMN 52    PIC 9(04)         I.950522
005500                 USING W-23T              CHECK OVERFLOW  NO IFC. I.950522
005510     02  LINE 12.                                                 I.950522
005520         03  ACP-W124F.                                           I.950522
005530             04  ACP-W14F          COLUMN 27    PIC 9(04)         I.950522
005540                 USING W-14F                              NO IFC. I.950522
005550             04  ACP-W24F          COLUMN 32    PIC 9(04)         I.950522
005560                 USING W-24F              CHECK OVERFLOW  NO IFC. I.950522
005570         03  ACP-W124T.                                           I.950522
005580             04  ACP-W14T          COLUMN 47    PIC 9(04)         I.950522
005590                 USING W-14T                              NO IFC. I.950522
005600             04  ACP-W24T          COLUMN 52    PIC 9(04)         I.950522
005610                 USING W-24T              CHECK OVERFLOW  NO IFC. I.950522
005620     02  LINE 14.                                                 I.950522
005630         03  ACP-W125F.                                           I.950522
005640             04  ACP-W15F          COLUMN 27    PIC 9(04)         I.950522
005650                 USING W-15F                              NO IFC. I.950522
005660             04  ACP-W25F          COLUMN 32    PIC 9(04)         I.950522
005670                 USING W-25F              CHECK OVERFLOW  NO IFC. I.950522
005680         03  ACP-W125T.                                           I.950522
005690             04  ACP-W15T          COLUMN 47    PIC 9(04)         I.950522
005700                 USING W-15T                              NO IFC. I.950522
005710             04  ACP-W25T          COLUMN 52    PIC 9(04)         I.950522
005720                 USING W-25T              CHECK OVERFLOW  NO IFC. I.950522
005730     02  LINE 16.                                                 I.950522
005740         03  ACP-W126F.                                           I.950522
005750             04  ACP-W16F          COLUMN 27    PIC 9(04)         I.950522
005760                 USING W-16F                              NO IFC. I.950522
005770             04  ACP-W26F          COLUMN 32    PIC 9(04)         I.950522
005780                 USING W-26F              CHECK OVERFLOW  NO IFC. I.950522
005790         03  ACP-W126T.                                           I.950522
005800             04  ACP-W16T          COLUMN 47    PIC 9(04)         I.950522
005810                 USING W-16T                              NO IFC. I.950522
005820             04  ACP-W26T          COLUMN 52    PIC 9(04)         I.950522
005830                 USING W-26T              CHECK OVERFLOW  NO IFC. I.950522
005840*****02  ACP-W03F    LINE 10.                                     D.950522
005850     02  ACP-W03F    LINE 18.                                     I.950522
005860         03  ACP-W03FY         COLUMN 27    PIC 9(02)
005870             USING W-03FY2                            NO IFC.     I.971113
005880*****        USING W-03FY                             NO IFC.     D.971113
005890         03  ACP-W03FM         COLUMN 30    PIC 9(02)
005900             USING W-03FM                             NO IFC.
005910         03  ACP-W03FD         COLUMN 33    PIC 9(02)
005920             USING W-03FD             CHECK OVERFLOW  NO IFC.
005930*****02  ACP-W03T    LINE 10.                                     D.950522
005940     02  ACP-W03T    LINE 18.                                     I.950522
005950         03  ACP-W03TY         COLUMN 47    PIC 9(02)
005960             USING W-03TY2                            NO IFC.     I.971113
005970*****        USING W-03TY                             NO IFC.     D.971113
005980         03  ACP-W03TM         COLUMN 50    PIC 9(02)
005990             USING W-03TM                             NO IFC.
006000         03  ACP-W03TD         COLUMN 53    PIC 9(02)
006010             USING W-03TD             CHECK OVERFLOW  NO IFC.
006020     02  ACP-WOKC    LINE 24   COLUMN 77    PIC X(01)
006030         USING W-OKC                  CHECK OVERFLOW  NO IFC.
006040***
006050 01  DSP-AREA.
006060     02  DSP-01      LINE 01.
006070         03  COLUMN 36    PIC X(10) FROM  WKSP REVERSE.
006080         03  COLUMN 37    PIC N(04) VALUE NC"ï‚èïå≥í†".
006090     02  DSP-04      LINE 04.
006100         03  COLUMN 27    PIC N(04) VALUE NC"ÇeÇqÇnÇl".
006110         03  COLUMN 49    PIC N(02) VALUE NC"ÇsÇn".
006120     02  DSP-06      LINE 06.
006130*****    03  COLUMN 11    PIC N(05) VALUE NC"â»ñ⁄ÉRÅ[Éh".         D.950522
006140*****    03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 D.950522
006150         03  COLUMN 07    PIC N(02) VALUE NC"â»ñ⁄".               I.950522
006160         03  COLUMN 11    PIC X(01) VALUE   "-".                  I.950522
006170         03  COLUMN 12    PIC N(05) VALUE NC"ï‚èïÉRÅ[Éh".         I.950522
006180         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006190         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
006200         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006210     02  DSP-08      LINE 08.
006220*****    03  COLUMN 11    PIC N(05) VALUE NC"ï‚èïÉRÅ[Éh".         D.950522
006230         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006240         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
006250         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006260     02  DSP-10      LINE 10.
006270         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006280         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
006290         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006300     02  DSP-12      LINE 12.                                     I.950522
006310         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006320         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
006330         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006340     02  DSP-14      LINE 14.                                     I.950522
006350         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006360         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
006370         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006380     02  DSP-16      LINE 16.                                     I.950522
006390         03  COLUMN 31    PIC X(01) VALUE   "-".                  I.950522
006400         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
006410         03  COLUMN 51    PIC X(01) VALUE   "-".                  I.950522
006420     02  DSP-18      LINE 18.                                     I.950522
006430         03  COLUMN 11    PIC N(05) VALUE NC"ì˙Å@Å@Å@ït".
006440         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
006450         03  COLUMN 29    PIC X(04) VALUE "/  /".
006460         03  COLUMN 49    PIC X(04) VALUE "/  /".
006470     02  DSP-24      LINE 24.
006480         03  COLUMN 61    PIC X(18) VALUE "ämîF OK=1,NO=9 ( )".
006490***
006500 01  DSP-NEN.
006510     02  DSP-TSUKI   LINE 01.
006520         03      COLUMN  04  PIC  N(01)  VALUE  NC"îN".
006530         03      COLUMN  08  PIC  N(02)  VALUE  NC"åéìx".
006540*****    03      COLUMN  02  PIC  9(02)  FROM  Z-GEMYY.           D.971113
006550         03      COLUMN  02  PIC  9(02)  FROM  Z-GEMYY2.          I.971113
006560         03      COLUMN  06  PIC  9(02)  FROM  Z-GEMMM.
006570 01  MG-AREA.
006580     02  MG-01       LINE 24   COLUMN 02    PIC N(07)
006590         VALUE NC"ì˙ïtä˙ä‘ÉGÉâÅ[".
006600***
006610 01  SP-AREA.
006620     02  SP-06       LINE 06.
006630*****    03  COLUMN 31   PIC Z(04) FROM WKZE.                     D.950522
006640*****    03  COLUMN 51   PIC Z(04) FROM WKZE.                     D.950522
006650         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006660         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006670         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006680         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006690     02  SP-08       LINE 08.
006700*****    03  COLUMN 31   PIC Z(04) FROM WKZE.                     D.950522
006710*****    03  COLUMN 51   PIC Z(04) FROM WKZE.                     D.950522
006720         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006730         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006740         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006750         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006760     02  SP-10       LINE 10.
006770         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006780         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006790         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006800         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006810     02  SP-12       LINE 12.                                     I.950522
006820         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006830         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006840         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006850         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006860     02  SP-14       LINE 14.                                     I.950522
006870         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006880         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006890         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006900         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006910     02  SP-16       LINE 16.                                     I.950522
006920         03  COLUMN 27   PIC Z(04) FROM WKZE.                     I.950522
006930         03  COLUMN 32   PIC Z(04) FROM WKZE.                     I.950522
006940         03  COLUMN 47   PIC Z(04) FROM WKZE.                     I.950522
006950         03  COLUMN 52   PIC Z(04) FROM WKZE.                     I.950522
006960     02  SP-20       LINE 20.                                     I.950522
006970         03  COLUMN 27   PIC Z(02) FROM WKZE.
006980         03  COLUMN 30   PIC Z(02) FROM WKZE.
006990         03  COLUMN 33   PIC Z(02) FROM WKZE.
007000         03  COLUMN 47   PIC Z(02) FROM WKZE.
007010         03  COLUMN 50   PIC Z(02) FROM WKZE.
007020         03  COLUMN 53   PIC Z(02) FROM WKZE.
007030     02  SP-24       LINE 24.
007040         03  COLUMN 77   PIC X(01) FROM WKSP.
007050*********
007060 COPY LSMSG.
007070     COPY LIBSCR.                                                 I.971113
007080**********
007090 PROCEDURE                   DIVISION.
007100 MR000.
007110     PERFORM INI-RTN THRU INI-EX.
007120     IF ERR-SW = 1
007130        GO TO MR999.
007140 MR010.
007150*****PERFORM W01F-RTN THRU W01F-EX.                               D.950522
007160     PERFORM W10-RTN THRU W10-EX.                                 I.950522
007170     IF ESTAT = "P9"
007180        GO TO MR999.
007190     DISPLAY DISP-C.                                              I.010811
007200     DISPLAY DSP-AREA.                                            I.010811
007210     DISPLAY ACP-W121F ACP-W121T.                                 I.010811
007220     IF W-12F NOT = ZERO                                          I.010811
007230         DISPLAY ACP-W122F ACP-W122T.                             I.010811
007240     IF W-13F NOT = ZERO                                          I.010811
007250         DISPLAY ACP-W123F ACP-W123T.                             I.010811
007260     IF W-14F NOT = ZERO                                          I.010811
007270         DISPLAY ACP-W124F ACP-W124T.                             I.010811
007280     IF W-15F NOT = ZERO                                          I.010811
007290         DISPLAY ACP-W125F ACP-W125T.                             I.010811
007300     IF W-16F NOT = ZERO                                          I.010811
007310         DISPLAY ACP-W126F ACP-W126T.                             I.010811
007320*MR020.                                                           D.950522
007330*****PERFORM W01T-RTN THRU W01T-EX.                               D.950522
007340*****IF ESTAT = "09"                                              D.950522
007350*****   GO TO MR010.                                              D.950522
007360*MR030.                                                           D.950522
007370*****PERFORM W02F-RTN THRU W02F-EX.                               D.950522
007380*****IF ESTAT = "09"                                              D.950522
007390*****   GO TO MR020.                                              D.950522
007400*MR040.                                                           D.950522
007410*****PERFORM W02T-RTN THRU W02T-EX.                               D.950522
007420*****IF ESTAT = "09"                                              D.950522
007430*****   GO TO MR030.                                              D.950522
007440 MR050.
007450     PERFORM W03F-RTN THRU W03F-EX.
007460     IF ESTAT = "09"
007470*****   GO TO MR040.                                              D.950522
007480        GO TO MR010.                                              I.950522
007490 MR060.
007500     PERFORM W03T-RTN THRU W03T-EX.
007510     IF ESTAT = "09"
007520        GO TO MR050.
007530 MR090.
007540     PERFORM WOKC-RTN THRU WOKC-EX.
007550     IF ESTAT = "09"
007560        GO TO MR060.
007570     IF W-OKC = "9"
007580        DISPLAY SP-AREA
007590        GO TO MR010.
007600     PERFORM OPEN-RTN THRU OPEN-EX.
007610**
007620*****MOVE W-03FY     TO WK-ZZ.                                    D.971113
007630*****MOVE WK-ZZ      TO M5-YY1.                                   D.971113
007640     MOVE W-03FY2    TO M5-YY1.                                   I.971113
007650     MOVE W-03FM     TO WK-ZZ.
007660     MOVE WK-ZZ      TO M5-MM1.
007670     MOVE W-03FD     TO WK-ZZ.
007680     MOVE WK-ZZ      TO M5-DD1.
007690*
007700*****MOVE W-03TY     TO WK-ZZ.                                    D.971113
007710*****MOVE WK-ZZ      TO M5-YY2.                                   D.971113
007720     MOVE W-03TY2    TO M5-YY2.                                   I.971113
007730     MOVE W-03TM     TO WK-ZZ.
007740     MOVE WK-ZZ      TO M5-MM2.
007750     MOVE W-03TD     TO WK-ZZ.
007760     MOVE WK-ZZ      TO M5-DD2.
007770**
007780*****MOVE W-01F     TO AM-KEY.                                    D.950523
007790     MOVE W-11F     TO AM-KEY.                                    I.950523
007800     START AM KEY NOT LESS AM-KEY INVALID KEY
007810           GO TO MR900.
007820 MR095.
007830     READ AM NEXT UNLOCK AT END
007840          GO TO MR150.
007850*****IF AM-KEY > W-01T                                            D.950523
007860*****   GO TO MR900.                                              D.950523
007870     IF HOJYO  NOT =  1
007880        GO  TO  MR095.
007890     IF AM-KEY >= W-11F AND <= W-11T                              I.950523
007900         GO TO MR110.
007910     IF AM-KEY >= W-12F AND <= W-12T                              I.950523
007920         GO TO MR110.                                             I.950523
007930     IF AM-KEY >= W-13F AND <= W-13T                              I.950523
007940         GO TO MR110.                                             I.950523
007950     IF AM-KEY >= W-14F AND <= W-14T                              I.950523
007960         GO TO MR110.                                             I.950523
007970     IF AM-KEY >= W-15F AND <= W-15T                              I.950523
007980         GO TO MR110.                                             I.950523
007990     IF AM-KEY >= W-16F AND <= W-16T                              I.950523
008000         GO TO MR110.                                             I.950523
008010     GO TO MR095.                                                 I.950523
008020 MR100.
008030     READ AM NEXT UNLOCK AT END
008040          GO TO MR900.
008050*****IF AM-KEY > W-01T                                            D.950523
008060*****   GO TO MR900.                                              D.950523
008070     IF HOJYO  NOT =  1
008080        GO  TO  MR100.
008090     IF AM-KEY >= W-11F AND <= W-11T                              I.950523
008100         GO TO MR110.                                             I.950523
008110     IF AM-KEY >= W-12F AND <= W-12T                              I.950523
008120         GO TO MR110.                                             I.950523
008130     IF AM-KEY >= W-13F AND <= W-13T                              I.950523
008140         GO TO MR110.                                             I.950523
008150     IF AM-KEY >= W-14F AND <= W-14T                              I.950523
008160         GO TO MR110.                                             I.950523
008170     IF AM-KEY >= W-15F AND <= W-15T                              I.950523
008180         GO TO MR110.                                             I.950523
008190     IF AM-KEY >= W-16F AND <= W-16T                              I.950523
008200         GO TO MR110.                                             I.950523
008210     GO TO MR100.                                                 I.950523
008220 MR110.
008230     MOVE AM-KEY     TO HZM-KMCD.
008240*****MOVE W-02F      TO HZM-HOCD.                                 D.950523
008250     MOVE ZERO       TO HZM-HOCD.                                 I.950523
008260     START HZM-F     KEY IS NOT <  HZM-KEY  INVALID
008270           GO  TO    MR100.
008280 MR120.
008290     READ  HZM-F     NEXT  UNLOCK  AT END
008300           GO  TO    MR100.
008310     IF  HZM-KMCD  NOT =  AM-KEY
008320         GO  TO      MR100.
008330*****IF  HZM-HOCD  >  W-02T                                       D.950523
008340*****    GO  TO      MR100.                                       D.950523
008350     IF HZM-KEY >= W-121F AND <= W-121T                           I.950523
008360         GO TO MR130.                                             I.950523
008370     IF HZM-KEY >= W-122F AND <= W-122T                           I.950523
008380         GO TO MR130.                                             I.950523
008390     IF HZM-KEY >= W-123F AND <= W-123T                           I.950523
008400         GO TO MR130.                                             I.950523
008410     IF HZM-KEY >= W-124F AND <= W-124T                           I.950523
008420         GO TO MR130.                                             I.950523
008430     IF HZM-KEY >= W-125F AND <= W-125T                           I.950523
008440         GO TO MR130.                                             I.950523
008450     IF HZM-KEY >= W-126F AND <= W-126T                           I.950523
008460         GO TO MR130.                                             I.950523
008470     GO TO MR120.                                                 I.950523
008480*
008490 MR130.                                                           I.950523
008500     MOVE AM-KEY     TO K-ACCD.
008510     MOVE ZERO       TO K-HOCD.
008520     PERFORM KNGG-RTN THRU KNGG-EX.
008530     MOVE KNGNMN     TO M8-01.
008540     MOVE AM-KEY     TO WK-9999.
008550     MOVE WK-9999    TO M8-02.
008560     MOVE AM-KEY     TO K-ACCD.
008570     MOVE HZM-HOCD   TO K-HOCD.
008580     PERFORM KNGG-RTN THRU KNGG-EX.
008590     MOVE KNGNMN     TO M8-03.
008600     MOVE HZM-HOCD   TO WK-9999.
008610     MOVE WK-9999    TO M8-04.
008620     IF DR-CR = 1
008630        MOVE NC"éÿï˚"     TO M8-05
008640     ELSE
008650        MOVE NC"ë›ï˚"     TO M8-05.
008660*
008670     MOVE ZERO        TO TOT-WK W-ZAN W-KARI W-KASI ERR-SW.
008680     MOVE HZM-ZAN     TO W-ZENKI.
008690     PERFORM ZAN-SET-RTN THRU ZAN-SET-EX.
008700     IF (W-ZAN  = ZERO) AND
008710        (W-KARI = ZERO) AND
008720        (W-KASI = ZERO)
008730        MOVE 1     TO ERR-SW.
008740*
008750     MOVE ZERO         TO SH-KEY3.
008760*****MOVE AM-KEY       TO HACCNTCD3.                              D.980224
008770*****MOVE HZM-HOCD     TO HHOACCNT3.                              D.980224
008780*****MOVE Z-TOUF(TI)   TO HTRDATE3.                               D.980224
008790     MOVE AM-KEY       TO HACCNTCD.                               I.980224
008800     MOVE HZM-HOCD     TO HHOACCNT.                               I.980224
008810     MOVE Z-TOUF(TI)   TO HTRDATE.                                I.980224
008820     START SDH KEY NOT LESS SH-KEY3 INVALID KEY
008830           GO TO MR150.
008840 MR140.
008850     READ SDH NEXT UNLOCK AT END
008860          GO TO MR150.
008870*****IF HZM-KEY NOT = HKACD3                                      D.980224
008880     IF HZM-KEY NOT = HKACD1                                      I.980224
008890        GO TO MR150.
008900*****IF W-03T < HTRDATE3                                          D.980224
008910     IF W-03T < HTRDATE                                           I.980224
008920        GO TO MR150.
008930*****IF W-03F > HTRDATE3                                          D.980224
008940     IF W-03F > HTRDATE                                           I.980224
008950        PERFORM SET-RTN THRU SET-EX
008960        PERFORM ADD-RTN THRU ADD-EX
008970        GO TO MR140.
008980*****MOVE HTRDATE3     TO ZYMD.                                   D.980224
008990     MOVE HTRDATE      TO ZYMD.                                   I.980224
009000     PERFORM Z-RTN THRU Z-EXT.
009010     PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX.
009020     GO TO MR170.
009030 MR150.
009040     IF ERR-SW = 0
009050        PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX
009060        WRITE P-R FROM YOKO AFTER 1
009070        MOVE SPACE     TO P-R
009080        PERFORM TOT2-RTN THRU TOT2-EX.
009090     GO TO MR120.
009100 MR160.
009110     READ SDH NEXT UNLOCK AT END
009120          GO TO MR180.
009130*****IF HZM-KEY NOT = HKACD3                                      D.980224
009140     IF HZM-KEY NOT = HKACD1                                      I.980224
009150        GO TO MR180.
009160*****IF W-03T < HTRDATE3                                          D.980224
009170     IF W-03T < HTRDATE                                           I.980224
009180        GO TO MR180.
009190     MOVE HTRDATE2     TO ZYMD.
009200     PERFORM Z-RTN THRU Z-EXT.
009210     IF ZI NOT = OZI
009220        PERFORM TOT1-RTN THRU TOT1-EX.
009230 MR170.
009240     PERFORM PRI-RTN THRU PRI-EX.
009250     PERFORM ADD-RTN THRU ADD-EX.
009260*****MOVE HTRDATE3     TO OHTRDATE3.                              D.980224
009270*****MOVE HJUNLNO3     TO OHJUNLNO3.                              D.980224
009280     MOVE HTRDATE      TO OHTRDATE3.                              I.980224
009290     MOVE HJUNLNO      TO OHJUNLNO3.                              I.980224
009300     MOVE ZI           TO OZI.
009310     GO TO MR160.
009320 MR180.
009330     PERFORM TOT1-RTN THRU TOT1-EX.
009340     PERFORM TOT2-RTN THRU TOT2-EX.
009350     MOVE ZERO     TO OLD-KEY.
009360     GO TO MR120.
009370 MR900.
009380     PERFORM CLSE-ENT THRU CLSE-EXT.
009390 MR999.
009400     STOP RUN.
009410************************
009420 INI-RTN.
009430     DISPLAY DISP-C.
009440     DISPLAY DSP-AREA.
009450*
009460     ACCEPT SYSDATE     FROM DATE.
009470*****MOVE SYS-YY     TO WK-ZZ.                                    D.971113
009480*****MOVE WK-ZZ      TO M3-YY.                                    D.971113
009490     MOVE SYS-YY     TO M3-YY.                                    I.971113
009500     MOVE SYS-MM     TO WK-ZZ.
009510     MOVE WK-ZZ      TO M3-MM.
009520     MOVE SYS-DD     TO WK-ZZ.
009530     MOVE WK-ZZ      TO M3-DD.
009540*
009550     MOVE 0     TO ERR-SW.
009560     OPEN INPUT FCTL-F.
009570     MOVE "DATE  "     TO FCTL-KEY1 ERR-K.
009580     READ FCTL-F UNLOCK INVALID KEY
009590          MOVE "FCTL-F"     TO ERR-F
009600          MOVE "G"          TO ERR-M
009610          DISPLAY ERR-DIS
009620          DISPLAY DISP-BUZ-B
009630          CLOSE FCTL-F
009640          MOVE 1     TO ERR-SW
009650          GO TO INI-EX.
009660     MOVE FCTL-REC1     TO Z-R.
009670     CLOSE FCTL-F.
009680*
009690     DISPLAY  DSP-NEN.
009700     COPY LIBCPR.
009710*
009720     MOVE Z-TOUT(Z-KSMM)     TO TO-YMD.
009730     MOVE Z-TOUT(15)         TO TO-YMD1.
009740     MOVE Z-UPDYM            TO FROM-YM.
009750     MOVE 01                 TO FROM-D.
009760     MOVE 1     TO I.
009770 INI-000.
009780     IF (Z-TOUF(I) NOT > FROM-YMD) AND
009790        (Z-TOUT(I) NOT < FROM-YMD)
009800        GO TO INI-100.
009810     IF I NOT = 15
009820        ADD 1     TO I
009830        GO TO INI-000.
009840     IF Z-KSMM = 12
009850        MOVE 1     TO I
009860     ELSE
009870        COMPUTE I = Z-KSMM + 1.
009880     MOVE Z-TOUF(I)              TO FROM-YMD.
009890     GO TO INI-EX.
009900 INI-100.
009910     IF I = Z-KSMM
009920        MOVE 13     TO I
009930     ELSE
009940        IF I = 12
009950           MOVE 1     TO I
009960        ELSE
009970           ADD 1     TO I.
009980     IF I > 15
009990        DISPLAY MG-01
010000                DISP-BUZ-B
010010        MOVE 1     TO ERR-SW
010020        GO TO INI-EX.
010030     MOVE Z-TOUF(I)     TO FROM-YMD.
010040 INI-EX.
010050     EXIT.
010060*********
010070 OPEN-RTN.
010080*****OPEN INPUT  KNG AM HZM-F SDH TK.                             D.980224
010090     OPEN INPUT  KNG AM HZM-F SDH.                                I.980224
010100     OPEN OUTPUT P-F.
010110 OPEN-EX.
010120     EXIT.
010130*********
010140*W01F-RTN.                                                        D.950522
010150*****ACCEPT ACP-W01F.                                             D.950522
010160*****DISPLAY DISP-MSG-SPACE.                                      D.950522
010170*****IF ESTAT = "P9"                                              D.950522
010180*****   GO TO W01F-EX.                                            D.950522
010190*****IF ESTAT NOT = "01" AND "06"                                 D.950522
010200*****   GO TO W01F-RTN.                                           D.950522
010210*W01F-EX.                                                         D.950522
010220*****EXIT.                                                        D.950522
010230*********
010240*W01T-RTN.                                                        D.950522
010250*****ACCEPT ACP-W01T.                                             D.950522
010260*****DISPLAY DISP-MSG-SPACE.                                      D.950522
010270*****IF ESTAT = "09"                                              D.950522
010280*****   GO TO W01T-EX.                                            D.950522
010290*****IF ESTAT NOT = "01" AND "06"                                 D.950222
010300*****   GO TO W01T-RTN.                                           D.950522
010310*****IF W-01F > W-01T                                             D.950522
010320*****   DISPLAY ERR-01                                            D.950522
010330*****   GO TO W01T-RTN.                                           D.950522
010340*W01T-EX.                                                         D.950522
010350*****EXIT.                                                        D.950522
010360*********
010370*W02F-RTN.                                                        D.950522
010380*****ACCEPT ACP-W02F.                                             D.950522
010390*****DISPLAY DISP-MSG-SPACE.                                      D.950522
010400*****IF ESTAT = "09"                                              D.950522
010410*****   GO TO W02F-EX.                                            D.950522
010420*****IF ESTAT NOT = "01" AND "06"                                 D.950522
010430*****   GO TO W02F-RTN.                                           D.950522
010440*W02F-EX.                                                         D.950522
010450*****EXIT.                                                        D.950522
010460*********
010470*W02T-RTN.                                                        D.950522
010480*****ACCEPT ACP-W02T.                                             D.950522
010490*****DISPLAY DISP-MSG-SPACE.                                      D.950522
010500*****IF ESTAT = "09"                                              D.950522
010510*****   GO TO W02T-EX.                                            D.950522
010520*****IF ESTAT NOT = "01" AND "06"                                 D.950522
010530*****   GO TO W02T-RTN.                                           D.950522
010540*****IF W-02F > W-02T                                             D.950522
010550*****   DISPLAY ERR-01                                            D.950522
010560*****   GO TO W02T-RTN.                                           D.950522
010570*W02T-EX.                                                         D.950522
010580 W10-RTN.                                                         I.950522
010590 W10-010.                                                         I.950522
010600     ACCEPT ACP-W121F.                                            I.950522
010610     DISPLAY DISP-MSG-SPACE.                                      I.950522
010620     IF ESTAT = "P9"                                              I.950522
010630        GO TO W10-EX.                                             I.950522
010640     IF ESTAT NOT = "01" AND "06"                                 I.950522
010650        GO TO W10-RTN.                                            I.950522
010660 W10-020.                                                         I.950522
010670     ACCEPT ACP-W121T.                                            I.950522
010680     DISPLAY DISP-MSG-SPACE.                                      I.950522
010690     IF ESTAT = "09"                                              I.950522
010700        GO TO W10-010.                                            I.950522
010710     IF ESTAT NOT = "01" AND "06"                                 I.950222
010720        GO TO W10-020.                                            I.950522
010730     IF W-121F > W-121T                                           I.950522
010740        DISPLAY ERR-01                                            I.950522
010750        GO TO W10-020.                                            I.950522
010760 W10-030.                                                         I.950522
010770     ACCEPT ACP-W122F.                                            I.950522
010780     DISPLAY DISP-MSG-SPACE.                                      I.950522
010790     IF ESTAT = "09"                                              I.950522
010800        GO TO W10-020.                                            I.950522
010810     IF ESTAT NOT = "01" AND "06"                                 I.950522
010820        GO TO W10-030.                                            I.950522
010830     IF W-12F = ZERO                                              I.950522
010840        MOVE ZERO TO W-22F W-12T W-22T W-13F W-23F W-13T W-23T    I.950522
010850                           W-14F W-24F W-14T W-24T W-15F W-25F    I.950522
010860                           W-15T W-25T W-16F W-26F W-16T W-26T    I.950522
010870        DISPLAY SP-08 SP-10 SP-12 SP-14 SP-16                     I.950522
010880        GO TO W10-EX.                                             I.950522
010890     IF W-122F < W-121T                                           I.950522
010900        DISPLAY ERR-01                                            I.950522
010910        GO TO W10-030.                                            I.950522
010920 W10-040.                                                         I.950522
010930     ACCEPT ACP-W122T.                                            I.950522
010940     DISPLAY DISP-MSG-SPACE.                                      I.950522
010950     IF ESTAT = "09"                                              I.950522
010960        GO TO W10-030.                                            I.950522
010970     IF ESTAT NOT = "01" AND "06"                                 I.950222
010980        GO TO W10-040.                                            I.950522
010990     IF W-122F > W-122T                                           I.950522
011000        DISPLAY ERR-01                                            I.950522
011010        GO TO W10-040.                                            I.950522
011020 W10-050.                                                         I.950522
011030     ACCEPT ACP-W123F.                                            I.950522
011040     DISPLAY DISP-MSG-SPACE.                                      I.950522
011050     IF ESTAT = "09"                                              I.950522
011060        GO TO W10-040.                                            I.950522
011070     IF ESTAT NOT = "01" AND "06"                                 I.950522
011080        GO TO W10-050.                                            I.950522
011090     IF W-13F = ZERO                                              I.950522
011100        MOVE ZERO TO W-23F W-13T W-23T W-14F W-24F W-14T W-24T    I.950522
011110                           W-15F W-25F W-15T W-25T W-16F W-26F    I.950522
011120                                                   W-16T W-26T    I.950522
011130        DISPLAY SP-10 SP-12 SP-14 SP-16                           I.950522
011140        GO TO W10-EX.                                             I.950522
011150     IF W-123F < W-122T                                           I.950522
011160        DISPLAY ERR-01                                            I.950522
011170        GO TO W10-050.                                            I.950522
011180 W10-060.                                                         I.950522
011190     ACCEPT ACP-W123T.                                            I.950522
011200     DISPLAY DISP-MSG-SPACE.                                      I.950522
011210     IF ESTAT = "09"                                              I.950522
011220        GO TO W10-050.                                            I.950522
011230     IF ESTAT NOT = "01" AND "06"                                 I.950222
011240        GO TO W10-060.                                            I.950522
011250     IF W-123F > W-123T                                           I.950522
011260        DISPLAY ERR-01                                            I.950522
011270        GO TO W10-060.                                            I.950522
011280 W10-070.                                                         I.950522
011290     ACCEPT ACP-W124F.                                            I.950522
011300     DISPLAY DISP-MSG-SPACE.                                      I.950522
011310     IF ESTAT = "09"                                              I.950522
011320        GO TO W10-060.                                            I.950522
011330     IF ESTAT NOT = "01" AND "06"                                 I.950522
011340        GO TO W10-070.                                            I.950522
011350     IF W-14F = ZERO                                              I.950522
011360        MOVE ZERO TO W-24F W-14T W-24T W-15F W-25F W-15T W-25T    I.950522
011370                           W-16F W-26F W-16T W-26T                I.950522
011380        DISPLAY SP-12 SP-14 SP-16                                 I.950522
011390        GO TO W10-EX.                                             I.950522
011400     IF W-124F < W-123T                                           I.950522
011410        DISPLAY ERR-01                                            I.950522
011420        GO TO W10-070.                                            I.950522
011430 W10-080.                                                         I.950522
011440     ACCEPT ACP-W124T.                                            I.950522
011450     DISPLAY DISP-MSG-SPACE.                                      I.950522
011460     IF ESTAT = "09"                                              I.950522
011470        GO TO W10-070.                                            I.950522
011480     IF ESTAT NOT = "01" AND "06"                                 I.950222
011490        GO TO W10-080.                                            I.950522
011500     IF W-124F > W-124T                                           I.950522
011510        DISPLAY ERR-01                                            I.950522
011520        GO TO W10-080.                                            I.950522
011530 W10-090.                                                         I.950522
011540     ACCEPT ACP-W125F.                                            I.950522
011550     DISPLAY DISP-MSG-SPACE.                                      I.950522
011560     IF ESTAT = "09"                                              I.950522
011570        GO TO W10-080.                                            I.950522
011580     IF ESTAT NOT = "01" AND "06"                                 I.950522
011590        GO TO W10-090.                                            I.950522
011600     IF W-15F = ZERO                                              I.950522
011610        MOVE ZERO TO W-25F W-15T W-25T W-16F W-26F W-16T W-26T    I.950522
011620        DISPLAY SP-14 SP-16                                       I.950522
011630        GO TO W10-EX.                                             I.950522
011640     IF W-125F < W-124T                                           I.950522
011650        DISPLAY ERR-01                                            I.950522
011660        GO TO W10-090.                                            I.950522
011670 W10-100.                                                         I.950522
011680     ACCEPT ACP-W125T.                                            I.950522
011690     DISPLAY DISP-MSG-SPACE.                                      I.950522
011700     IF ESTAT = "09"                                              I.950522
011710        GO TO W10-090.                                            I.950522
011720     IF ESTAT NOT = "01" AND "06"                                 I.950222
011730        GO TO W10-100.                                            I.950522
011740     IF W-125F > W-125T                                           I.950522
011750        DISPLAY ERR-01                                            I.950522
011760        GO TO W10-100.                                            I.950522
011770 W10-110.                                                         I.950522
011780     ACCEPT ACP-W126F.                                            I.950522
011790     DISPLAY DISP-MSG-SPACE.                                      I.950522
011800     IF ESTAT = "09"                                              I.950522
011810        GO TO W10-100.                                            I.950522
011820     IF ESTAT NOT = "01" AND "06"                                 I.950522
011830        GO TO W10-110.                                            I.950522
011840     IF W-16F = ZERO                                              I.950522
011850        MOVE ZERO TO W-26F W-16T W-26T                            I.950522
011860        DISPLAY SP-16                                             I.950522
011870        GO TO W10-EX.                                             I.950522
011880     IF W-126F < W-125T                                           I.950522
011890        DISPLAY ERR-01                                            I.950522
011900        GO TO W10-110.                                            I.950522
011910 W10-120.                                                         I.950522
011920     ACCEPT ACP-W126T.                                            I.950522
011930     DISPLAY DISP-MSG-SPACE.                                      I.950522
011940     IF ESTAT = "09"                                              I.950522
011950        GO TO W10-110.                                            I.950522
011960     IF ESTAT NOT = "01" AND "06"                                 I.950222
011970        GO TO W10-120.                                            I.950522
011980     IF W-126F > W-126T                                           I.950522
011990        DISPLAY ERR-01                                            I.950522
012000        GO TO W10-120.                                            I.950522
012010 W10-EX.                                                          I.950522
012020     EXIT.
012030*********
012040 W03F-RTN.
012050     ACCEPT ACP-W03F.
012060     DISPLAY DISP-MSG-SPACE.
012070     IF ESTAT = "09"
012080        GO TO W03F-EX.
012090     IF ESTAT NOT = "01" AND "06"
012100        GO TO W03F-RTN.
012110     MOVE ZERO TO W-03FY1.                                        I.971113
012120     IF W-03F = ZERO
012130        MOVE FROM-YMD     TO W-03F
012140        DISPLAY ACP-W03F                                          I.971113
012150        GO TO W03F-050.                                           I.971113
012160     IF W-03FY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
012170        ADD DATE-NC1 TO W-03FY.                                   I.971113
012180     IF W-03FY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
012190        ADD DATE-NC2 TO W-03FY.                                   I.971113
012200*****   DISPLAY ACP-W03F.                                         D.971113
012210 W03F-050.                                                        I.971113
012220     IF W-03F < FROM-YMD OR > TO-YMD1
012230        DISPLAY MG-01
012240        GO TO W03F-RTN.
012250*W03F-000.                                                        D.971113
012260     MOVE 1     TO I.
012270 W03F-100.
012280     IF (Z-TOUF(I) NOT > W-03F) AND
012290        (Z-TOUT(I) NOT < W-03F)
012300        NEXT SENTENCE
012310     ELSE
012320        IF I NOT = 15
012330           ADD 1     TO I
012340           GO TO W03F-100
012350        ELSE
012360           DISPLAY ERR-01
012370           GO TO W03F-RTN.
012380     MOVE I     TO TI.
012390*
012400     IF Z-KSMM = 12
012410        MOVE 1     TO FI
012420     ELSE
012430        COMPUTE FI = Z-KSMM + 1.
012440     IF TI > 12
012450        MOVE 13     TO FI.
012460 W03F-EX.
012470     EXIT.
012480*********
012490 W03T-RTN.
012500     ACCEPT ACP-W03T.
012510     DISPLAY DISP-MSG-SPACE.
012520     IF ESTAT = "09"
012530        GO TO W03T-EX.
012540     IF ESTAT NOT = "01" AND "06"
012550        GO TO W03T-RTN.
012560     MOVE ZERO TO W-03TY1.                                        I.971113
012570*****IF W-03T = 999999                                            D.971113
012580     IF W-03TS = 999999                                           I.971113
012590        IF TI < 13
012600           MOVE TO-YMD     TO W-03T
012610         ELSE                                                     I.971113
012620           MOVE TO-YMD1    TO W-03T.                              I.971113
012630     IF W-03T = TO-YMD OR TO-YMD1                                 I.971113
012640         GO TO W03T-100.                                          I.971113
012650*****      DISPLAY ACP-W03T.                                      D.971113
012660*****IF W-03T = 999999                                            D.971113
012670*****   IF TI > 12                                                D.971113
012680*****      MOVE TO-YMD1    TO W-03T                               D.971113
012690*****      DISPLAY ACP-W03T.                                      D.971113
012700     IF W-03TY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
012710        ADD DATE-NC1 TO W-03TY.                                   I.971113
012720     IF W-03TY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
012730        ADD DATE-NC2 TO W-03TY.                                   I.971113
012740 W03T-100.                                                        I.971113
012750     IF TI < 13
012760        IF W-03T > TO-YMD
012770           DISPLAY MG-01
012780           GO TO W03T-RTN.
012790     IF TI > 12
012800        IF W-03T > TO-YMD1
012810           DISPLAY MG-01
012820           GO TO W03T-RTN.
012830     IF W-03F > W-03T
012840        DISPLAY ERR-01
012850        GO TO W03T-RTN.
012860 W03T-EX.
012870     EXIT.
012880*********
012890 WOKC-RTN.
012900     ACCEPT ACP-WOKC.
012910     DISPLAY DISP-MSG-SPACE.
012920     IF ESTAT = "09"
012930        GO TO WOKC-EX.
012940     IF ESTAT NOT = "01" AND "06"
012950        GO TO WOKC-RTN.
012960     IF W-OKC NOT = "1" AND "9"
012970        DISPLAY ERR-01
012980        GO TO WOKC-RTN.
012990 WOKC-EX.
013000     EXIT.
013010*********
013020 ZAN-SET-RTN.
013030     IF TI > 12     GO TO ZAN-SET-500.
013040     MOVE FI     TO I.
013050 ZAN-SET-000.
013060     ADD HZM-TJKR(I)     TO W-KARI TOT-KR(3).
013070     ADD HZM-TJKS(I)     TO W-KASI TOT-KS(3).
013080     IF I = TI
013090        SUBTRACT HZM-TJKR(I)     FROM TOT-KR(3)
013100        SUBTRACT HZM-TJKS(I)     FROM TOT-KS(3)
013110        GO TO ZAN-SET-900.
013120     IF I = 12
013130        MOVE 1     TO I
013140        GO TO ZAN-SET-000.
013150     ADD 1     TO I.
013160     GO TO ZAN-SET-000.
013170 ZAN-SET-500.
013180     IF BS-PL = 0
013190        MOVE 1      TO I
013200     ELSE
013210        MOVE 13     TO I.
013220 ZAN-SET-600.
013230*****ADD HZM-TJKR(I)     TO W-KARI.                               D.930804
013240*****ADD HZM-TJKS(I)     TO W-KASI.                               D.930804
013250     ADD HZM-TJKR(I)     TO W-KARI TOT-KR(3).                     I.930804
013260     ADD HZM-TJKS(I)     TO W-KASI TOT-KS(3).                     I.930804
013270     IF I = 12
013280        IF DR-CR = 1
013290           COMPUTE W-ZENKI = HZM-ZAN + W-KARI - W-KASI
013300        ELSE
013310           COMPUTE W-ZENKI = HZM-ZAN + W-KASI - W-KARI.
013320     IF I = 12                                                    I.930804
013330        MOVE W-ZENKI     TO HZM-ZAN                               I.930804
013340        MOVE ZERO        TO W-KARI W-KASI TOT-ITEM(3).            I.930804
013350*****IF BS-PL = 1                                                 D.930804
013360*****   IF I > 12                                                 D.930804
013370*****      ADD HZM-TJKR(I)     TO TOT-KR(3)                       D.930804
013380*****      ADD HZM-TJKS(I)     TO TOT-KS(3).                      D.930804
013390     IF I = TI
013400        SUBTRACT HZM-TJKR(I)     FROM TOT-KR(3)
013410        SUBTRACT HZM-TJKS(I)     FROM TOT-KS(3)
013420        GO TO ZAN-SET-900.
013430     IF I = 15
013440        GO TO ZAN-SET-900.
013450     ADD 1     TO I.
013460     GO TO ZAN-SET-600.
013470 ZAN-SET-900.
013480     IF DR-CR = 1
013490        COMPUTE W-ZAN = HZM-ZAN + (W-KARI - HZM-TJKR(TI)) -
013500                                  ( W-KASI - HZM-TJKS(TI))
013510     ELSE
013520        COMPUTE W-ZAN = HZM-ZAN + (W-KASI - HZM-TJKS(TI)) -
013530                                  ( W-KARI - HZM-TJKR(TI)).
013540 ZAN-SET-EX.
013550     EXIT.
013560*********
013570 SET-RTN.
013580*****IF DR-CR = HDR-CR3                                           D.980224
013590     IF DR-CR = HDR-CR                                            I.980224
013600        COMPUTE W-ZAN = W-ZAN + HAMOUNT
013610     ELSE
013620        COMPUTE W-ZAN = W-ZAN - HAMOUNT.
013630 SET-EX.
013640     EXIT.
013650*********
013660 ZAN-OUT-RTN.
013670     PERFORM MID-RTN THRU MID-EX.
013680*                                                                 ëOéc
013690     MOVE TATEP1           TO P-R.
013700     MOVE K15              TO P1-K15.
013710     MOVE SPACE            TO P1-04.
013720     MOVE W-ZAN            TO P1-08.
013730     MOVE NC"ëOì˙écçÇ"     TO P1-09.
013740     WRITE P-R AFTER 1.
013750     MOVE SPACE     TO P-R.
013760 ZAN-OUT-EX.
013770     EXIT.
013780*********
013790 PRI-RTN.
013800     IF LINAGE-COUNTER > 60
013810        PERFORM MID-RTN THRU MID-EX                               C.920131
013820         MOVE TATEP1       TO P-R                                 I.920131
013830         MOVE K15          TO P1-K15                              I.920131
013840         MOVE K20          TO P1-K20                              I.920131
013850         MOVE HTRDATE      TO WK-YMD                              I.980224
013860*****    MOVE HTRDATE3     TO WK-YMD                              D.980224
013870         GO   TO    PRI-000.                                      I.920131
013880*                                                                 ñæç◊ÇP
013890     MOVE TATEP1       TO P-R.
013900     MOVE K15          TO P1-K15.
013910     MOVE K20          TO P1-K20.
013920     MOVE HTRDATE      TO WK-YMD.                                 I.980224
013930*****MOVE HTRDATE3     TO WK-YMD.                                 D.980224
013940*****IF HTRDATE3 = OHTRDATE3                                      D.980224
013950     IF HTRDATE  = OHTRDATE3                                      I.980224
013960        GO TO PRI-030.
013970     IF WK-YY NOT = OHTRDATE3YY
013980        GO TO PRI-000.
013990     IF WK-MM NOT = OHTRDATE3MM
014000        GO TO PRI-010.
014010     IF WK-DD NOT = OHTRDATE3DD
014020        GO TO PRI-020.
014030 PRI-000.
014040*****MOVE WK-YY    TO P1-01Y.                                     D.971113
014050     MOVE WK-YY2   TO P1-01Y.                                     I.971113
014060     MOVE "."      TO P1-01YH.
014070 PRI-010.
014080     MOVE WK-MM    TO P1-01M.
014090     MOVE "."      TO P1-01MH.
014100 PRI-020.
014110     MOVE WK-DD    TO P1-01D.
014120     GO TO PRI-040.
014130 PRI-030.
014140*****IF HJUNLNO3 = OHJUNLNO3                                      D.980224
014150     IF HJUNLNO  = OHJUNLNO3                                      I.980224
014160        GO TO PRI-050.
014170 PRI-040.
014180*****MOVE HJUNLNO3   TO P1-02.                                    D.980224
014190     MOVE HJUNLNO    TO P1-02.                                    I.980224
014200     MOVE "-"        TO P1-02H.
014210 PRI-050.
014220*****MOVE HLINENO3   TO P1-03.                                    D.980224
014230     MOVE HLINENO    TO P1-03.                                    I.980224
014240     IF HCUSTCD = ZERO                                            *C910513
014250        MOVE SPACE       TO P1-04                                 *C910513
014260     ELSE
014270        MOVE HNAMEN      TO P1-04.                                I.980224
014280*****   MOVE HCUSTCD     TO TK-KEY                                D.980224
014290*****   PERFORM TKG-RTN THRU TKG-EX                               D.980224
014300*****   MOVE TK-NAMEN    TO P1-04.                                D.980224
014310*****IF HCUSTCD NOT = ZERO                                        D.940809
014320     IF HSECTCD NOT = ZERO                                        I.940809
014330        MOVE "("        TO P1-05F
014340*****   MOVE HCUSTCD    TO P1-05                                  D.940809
014350        MOVE HSECTCD    TO P1-05                                  I.940809
014360        MOVE ")"        TO P1-05T.
014370*****IF HDR-CR3 = 1                                               D.980224
014380     IF HDR-CR  = 1                                               I.980224
014390        MOVE HAMOUNT     TO P1-06
014400     ELSE
014410        MOVE HAMOUNT     TO P1-07.
014420     PERFORM SET-RTN THRU SET-EX.
014430     MOVE W-ZAN      TO P1-08.
014440     MOVE HTEKIYO    TO P1-09.
014450*****IF HTAXKB NOT = SPACE                                        D.970218
014460     IF HTAXKB     = "1" OR "5"                                   I.970218
014470        MOVE "*"       TO P1-10.
014480     IF HTAXKB     = "3" OR "7"                                   I.970218
014490        MOVE "#"       TO P1-10.                                  I.970218
014500     IF HTAXKB     = " "                                          I.970729
014510         IF HETAX    = "1" OR "5"                                 I.970729
014520             MOVE "*"       TO P1-10.                             I.970729
014530     IF HTAXKB     = " "                                          I.970729
014540         IF HETAX    = "3" OR "7"                                 I.970729
014550             MOVE "#"       TO P1-10.                             I.970729
014560     WRITE P-R AFTER 1.
014570     MOVE SPACE     TO P-R.
014580 PRI-EX.
014590     EXIT.
014600***
014610 ADD-RTN.
014620     IF HDR-CR2 = 1
014630        ADD HAMOUNT     TO TOT-KR(2) TOT-KR(3)
014640     ELSE
014650        ADD HAMOUNT     TO TOT-KS(2) TOT-KS(3).
014660 ADD-EX.
014670     EXIT.
014680***
014690 MID-RTN.
014700     IF PCNT NOT = ZERO
014710        WRITE P-R AFTER PAGE.
014720     ADD 1     TO PCNT.
014730     MOVE PCNT     TO WK-ZZZZZ.
014740     MOVE WK-ZZZZZ     TO M3-PCNT.
014750     WRITE P-R FROM MID03 AFTER 2.
014760     WRITE P-R FROM MID05 AFTER 1.
014770     WRITE P-R FROM MID06 AFTER 1.
014780     WRITE P-R FROM MID07 AFTER 1.
014790     WRITE P-R FROM MID08 AFTER 1.
014800     WRITE P-R FROM MID09 AFTER 1.
014810     WRITE P-R FROM MID10 AFTER 1.
014820     WRITE P-R FROM MID11 AFTER 1.
014830     MOVE TATEP1     TO P-R.
014840     MOVE K15        TO P1-K15.
014850     MOVE K20        TO P1-K20.
014860     MOVE SPACE      TO P1-04 P1-09.
014870     WRITE P-R AFTER 1.
014880     MOVE SPACE     TO P-R.
014890 MID-EX.
014900     EXIT.
014910***
014920 TOT1-RTN.
014930     IF PCNT = ZERO
014940        GO TO TOT1-EX.
014950     IF LINAGE-COUNTER > 60
014960        PERFORM MID-RTN THRU MID-EX.
014970     MOVE TOT-ITEM(2)     TO TOT-ITEM(1).
014980     MOVE TATEP1     TO P-R.
014990     MOVE K15        TO P1-K15.
015000     MOVE K20        TO P1-K20.
015010     MOVE NC"ìñÅ@åéÅ@çáÅ@åv"     TO P1-04.
015020     MOVE SPACE      TO P1-09.
015030     PERFORM OUT-RTN THRU OUT-EX.
015040     WRITE P-R FROM YOKO AFTER 1.
015050     MOVE SPACE     TO P-R.
015060     MOVE ZERO     TO TOT-KR(2) TOT-KS(2).
015070 TOT1-EX.
015080     EXIT.
015090***
015100 TOT2-RTN.
015110     IF PCNT = ZERO
015120        GO TO TOT2-EX.
015130     PERFORM SPO-RTN THRU SPO-EX.
015140*
015150     MOVE TOT-ITEM(3)     TO TOT-ITEM(1).
015160     MOVE TATEP2     TO P-R.
015170     MOVE K15        TO P2-K15.
015180     MOVE K20        TO P2-K20.
015190     MOVE NC"ìñÅ@ä˙Å@ó›Å@åv"     TO P2-04.
015200     MOVE NC"ëOä˙åJâz"           TO P2-09.
015210     MOVE W-ZENKI                TO P2-99.
015220     PERFORM OUT-RTN THRU OUT-EX.
015230     WRITE P-R FROM YOKO AFTER 1.
015240     MOVE SPACE     TO P-R.
015250*
015260     MOVE ZERO     TO TOT-KR(3) TOT-KS(3).
015270 TOT2-EX.
015280     EXIT.
015290***
015300 OUT-RTN.
015310     MOVE TOT-KR(1)     TO P1-06.
015320     MOVE TOT-KS(1)     TO P1-07.
015330     MOVE W-ZAN         TO P1-08.
015340     WRITE P-R AFTER 1.
015350     MOVE SPACE     TO P-R.
015360 OUT-EX.
015370     EXIT.
015380***
015390 SPO-RTN.
015400     MOVE TATEP1     TO P-R.
015410     MOVE K15        TO P1-K15.
015420     MOVE K20        TO P1-K20.
015430     MOVE SPACE      TO P1-04 P1-09.
015440     WRITE P-R AFTER 1.
015450     MOVE SPACE     TO P-R.
015460 SPO-EX.
015470     EXIT.
015480***
015490 KNGG-RTN.
015500     MOVE 0     TO INV-SW.
015510     READ KNG UNLOCK INVALID KEY
015520          MOVE 1         TO INV-SW
015530          MOVE SPACE     TO KNGNMN.
015540 KNGG-EX.
015550     EXIT.
015560***                                                               *A910513
015570*TKG-RTN.                                                         D.980224
015580*****MOVE 0     TO INV-SW.                                        D.980224
015590*****READ TK UNLOCK INVALID KEY                                   D.980224
015600*****     MOVE 1         TO INV-SW                                D.980224
015610*****     MOVE SPACE     TO TK-NAMEN.                             D.980224
015620*TKG-EX.                                                          D.980224
015630*****EXIT.                                                        D.980224
015640*********
015650 CLSE-ENT.
015660*****CLOSE KNG AM HZM-F SDH P-F TK.                               D.980224
015670     CLOSE KNG AM HZM-F SDH P-F.                                  I.980224
015680     DISPLAY DISP-C.
015690 CLSE-EXT.
015700     EXIT.
015710*********
015720 COPY LPMSG.
015730*********
