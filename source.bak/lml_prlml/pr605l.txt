000010 IDENTIFICATION              DIVISION.
000020 PROGRAM-ID.                 PR615L.
000030 AUTHOR.                     OZAKI.
000040*===============================================================*
000050*    è¡îÔê≈êUë÷ñæç◊èë                                           *
000060*                            --- 91/03/08 ---                   *
000070*===============================================================*
000080 ENVIRONMENT                DIVISION.
000090 CONFIGURATION              SECTION.
000100 SOURCE-COMPUTER.           NEAC-SYSTEM100.
000110 OBJECT-COMPUTER.           NEAC-SYSTEM100.
000120 INPUT-OUTPUT               SECTION.
000130 FILE-CONTROL.
000140     SELECT      KNG         ASSIGN  TO      F1-MSD
000150                             ORGANIZATION    INDEXED
000160                             ACCESS  MODE    RANDOM
000170                             RECORD  KEY     KNG-KEY.
000180     SELECT      AM          ASSIGN  TO      F2-MSD
000190                             ORGANIZATION    INDEXED
000200                             ACCESS  MODE    RANDOM
000210                             RECORD  KEY     AM-KEY.
000220     SELECT      BNM         ASSIGN  TO      F3-MSD
000230                             ORGANIZATION    INDEXED
000240                             ACCESS  MODE    RANDOM
000250                             RECORD  KEY     BNM-KEY.
000260     SELECT      FCTL-F      ASSIGN  TO      F4-MSD
000270                             ORGANIZATION    INDEXED
000280                             ACCESS  MODE    RANDOM
000290                             RECORD  KEY     FCTL-KEY.
000300     SELECT      SDW         ASSIGN  TO      F5-MSD
000310                             ORGANIZATION    SEQUENTIAL
000320                             ACCESS  MODE    SEQUENTIAL.
000330*****SELECT      TK          ASSIGN  TO      F6-MSD               D.980224
000340*****                        ORGANIZATION    INDEXED              D.980224
000350*****                        ACCESS  MODE    RANDOM               D.980224
000360*****                        RECORD  KEY     TK-KEY.              D.980224
000370     SELECT      P-F         ASSIGN  TO      P-PRN999.
000380 I-O-CONTROL.
000390*****APPLY SHARED-MODE    ON KNG AM BNM FCTL-F TK                 D.980224
000400     APPLY SHARED-MODE    ON KNG AM BNM FCTL-F                    I.980224
000410     APPLY EXCLUSIVE-MODE ON SDW
000420     APPLY SHIFT-CODE     ON P-F.
000430*******
000440 DATA                        DIVISION.
000450 FILE                        SECTION.
000460 COPY KANGEL.
000470 COPY ACCUNT.
000480 COPY BUMONF.
000490 COPY FCTL.
000500 COPY SIWAKW.
000510*COPY TKLIB.                                                      D.980224
000520**
000530 FD  P-F
000540     LABEL RECORD OMITTED
000550     LINAGE IS 66.
000560 01  P-R                 PIC X(200).
000570 01  P1-R.
000580     02  P1-K15          PIC X(05).
000590*****02  FILLER          PIC X(02).                               D.940211
000600*****02  FILLER          PIC X(01).                               D.940214
000610     02  FILLER          PIC X(15).                               I.940214
000620     02  P1-01.
000630*****  03  P1-01Y        PIC Z9.                                  D.971113
000640       03  P1-01Y        PIC 9(02).                               I.971113
000650       03  P1-01YH       PIC X(01).
000660       03  P1-01M        PIC Z9.
000670       03  P1-01MH       PIC X(01).
000680       03  P1-01D        PIC Z9.
000690     02  FILLER          PIC X(01).
000700*****02  FILLER          PIC X(02).                               D.940211
000710     02  FILLER          PIC X(01).
000720     02  P1-02           PIC 9(06).
000730     02  P1-02H          PIC X(01).
000740     02  P1-03           PIC 9(02).
000750*****02  FILLER          PIC X(01).                               D.940214
000760*****02  FILLER          PIC X(02).                               D.940211
000770*****02  FILLER          PIC X(01).                               D.940214
000780*****02  P1-04           PIC N(10).                               D.940214
000790     02  FILLER          PIC X(01).
000800*****02  P1-05F          PIC X(01).                               D.940214
000810     02  P1-05           PIC 9(05).                               *C910513
000820*****02  P1-05T          PIC X(01).                               D.940214
000830     02  FILLER          PIC X(01).                               I.940214
000840     02  P1-04           PIC N(10).                               I.940214
000850*****02  FILLER          PIC X(01).                               *D910513
000860*****02  FILLER          PIC X(02).                               D.940211
000870*****02  P1-06           PIC ----,---,---,--9.                    D.940214
000880     02  P1-06           PIC --,---,---,--9.                      I.940214
000890*****02  FILLER          PIC X(01).                               D.940214
000900*****02  FILLER          PIC X(02).                               D.940211
000910*****02  P1-07           PIC ----,---,---,--9.                    D.940214
000920     02  P1-07           PIC --,---,---,--9.                      I.940214
000930*****02  FILLER          PIC X(01).                               D.940214
000940*****02  FILLER          PIC X(02).                               D.940211
000950*****02  P1-08           PIC ----,---,---,--9.                    D.940214
000960     02  P1-08           PIC --,---,---,--9.                      I.940214
000970*****02  FILLER          PIC X(01).                               D.940215
000980     02  P1-08X          PIC X(01).                               I.940215
000990*****02  FILLER          PIC X(02).                               D.940211
001000     02  FILLER          PIC X(01).
001010     02  P1-09           PIC N(20).
001020     02  FILLER          PIC X(01).
001030*****02  FILLER          PIC X(02).                               D.940211
001040*****02  FILLER          PIC X(02).                               D.940214
001050     02  P1-10           PIC X(01).
001060*****02  FILLER          PIC X(01).                               D.940214
001070*****02  FILLER          PIC X(02).                               D.940211
001080     02  P1-K20          PIC X(05).
001090*****
001100 WORKING-STORAGE             SECTION.
001110 77  ERR-STAT            PIC  X(02).
001120 77  PCNT                PIC  9(05).
001130 77  K20                 PIC  X(05) VALUE ""3FE04FE080"".
001140 77  K15                 PIC  X(05) VALUE ""3FE04F40A0"".
001150 77  W-PC                PIC  9(01) VALUE 0.                      I.940215
001160 77  W-MC                PIC  9(01) VALUE 0.                      I.940207
001170 77  W-BMC               PIC  9(01) VALUE 0.                      I.940214
001180*77  WK0170ID           PIC  X(009) VALUE SPACE.                  D.970530
001190 77  WK0256ID           PIC  X(009) VALUE SPACE.                  I.970530
001200 01  STN-NO.                                                      I.960509
001210     02  STN-NO1        PIC  X(003).                              I.960509
001220     02  STN-NO2        PIC  X(003).                              I.960509
001230 01  W-FID.                                                       I.960509
001240*****02  W-FID1         PIC  X(006) VALUE "WK0170".               D.970530
001250     02  W-FID1         PIC  X(006) VALUE "WK0256".               I.970530
001260     02  W-FID2         PIC  X(003).                              I.960509
001270 01  WORK-AREA.
001280     02  I               PIC  9(02).
001290     02  ERR-SW          PIC  9(01).
001300     02  INV-SW          PIC  9(01).
001310     02  W-ZAN           PIC S9(11).
001320     02  WTAX-A          PIC  9(02)V9(02).
001330     02  WTAX-B          PIC  9(03)V9(02).
001340     02  WTAX-C          PIC  9(02)V9(02).                        I.970218
001350     02  WTAX-D          PIC  9(03)V9(02).                        I.970218
001360     02  WSUB5           PIC  9(01).
001370**
001380     02  SYSDATE.
001390       03  SYS-YY        PIC  9(02).
001400       03  SYS-MM        PIC  9(02).
001410       03  SYS-DD        PIC  9(02).
001420     02  WK-YMD.
001430*****  03  WK-YY         PIC  9(02).                              D.971113
001440       03  WK-YY         PIC  9(04).                              I.971113
001450       03  WK-YYL  REDEFINES WK-YY.                               I.971113
001460         04  WK-YY1      PIC  9(02).                              I.971113
001470         04  WK-YY2      PIC  9(02).                              I.971113
001480       03  WK-MM         PIC  9(02).
001490       03  WK-DD         PIC  9(02).
001500     02  WK-ZZ           PIC  Z9.
001510     02  WK-ZZZZZ        PIC  ZZZZ9.
001520 01  NEW-KEY.
001530     02  NWHTAXKB        PIC  X(01).                              *A910530
001540     02  NWHKACD1        PIC  X(08).
001550     02  NWHSECTCD       PIC  9(04).
001560 01  OLD-KEY.
001570     02  OWHTAXKB        PIC  X(01).                              *A910530
001580     02  OWHKACD1        PIC  X(08).
001590     02  OWHSECTCD       PIC  9(04).
001600 01  OLD-AREA.
001610     02  OWHTRDATE3.
001620*****  03  OWHTRDATE3YY  PIC  9(02).                              D.971113
001630       03  OWHTRDATE3YY  PIC  9(04).                              I.971113
001640       03  OWHTRDATE3MM  PIC  9(02).
001650       03  OWHTRDATE3DD  PIC  9(02).
001660     02  OWHJUNLNO3      PIC  9(06).
001670 01  TOT-WK.
001680     02  TOT-KR          PIC S9(12).
001690     02  TOT-KS          PIC S9(12).
001700 01  WK-NAMER.                                                    *A910530
001710     02  FILLER          PIC  N(01) VALUE NC"Åi".                    "
001720     02  WK-NAME1        PIC  N(02).                                 "
001730     02  FILLER          PIC  N(05) VALUE NC"è¡îÔê≈äzÅj".            "
001740 01  WK-NAME REDEFINES WK-NAMER     PIC  N(08).                      "
001750***
001760 01  MID03.
001770     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
001780     02  FILLER          PIC X(02) VALUE SPACE.
001790     02  M3-YY           PIC N(02).
001800     02  FILLER          PIC N(01) VALUE NC"îN".
001810     02  M3-MM           PIC N(02).
001820     02  FILLER          PIC N(01) VALUE NC"åé".
001830     02  M3-DD           PIC N(02).
001840     02  FILLER          PIC N(03) VALUE NC"ì˙çÏê¨".
001850     02  FILLER          PIC X(23) VALUE SPACE.
001860*****02  FILLER          PIC X(02) VALUE ""3F91"".                D.940207
001870     02  FILLER          PIC X(02) VALUE SPACE.
001880     02  FILLER          PIC N(15)
001890         VALUE NC"è¡Å@îÔÅ@ê≈Å@êUÅ@ë÷Å@ñæÅ@ç◊Å@èë".
001900     02  FILLER          PIC X(02) VALUE SPACE.
001910*****02  FILLER          PIC X(02) VALUE ""3F92"".                D.940207
001920     02  FILLER          PIC X(40) VALUE SPACE.
001930     02  M3-PCNT         PIC N(05).
001940     02  FILLER          PIC N(01) VALUE NC"ï≈".
001950*01  MID04.                                                       D.940207
001960*****02  FILLER          PIC X(02) VALUE ""3F91"".                D.940207
001970*****02  FILLER          PIC X(45) VALUE SPACE.                   D.940207
001980*****02  FILLER          PIC X(02) VALUE ""3F92"".                D.940207
001990 01  MID05.
002000*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002010*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940214
002020*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002030     02  FILLER          PIC X(35) VALUE SPACE.
002040*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002050*****02  FILLER          PIC X(04) VALUE SPACE.                   D.940214
002060     02  FILLER          PIC N(03) VALUE NC"ÅiÅ@é©".
002070     02  FILLER          PIC X(01) VALUE SPACE.
002080     02  M5-YY1          PIC N(02).
002090     02  FILLER          PIC N(01) VALUE NC"îN".
002100     02  FILLER          PIC X(01).
002110     02  M5-MM1          PIC N(02).
002120     02  FILLER          PIC N(01) VALUE NC"åé".
002130     02  FILLER          PIC X(01).
002140     02  M5-DD1          PIC N(02).
002150     02  FILLER          PIC N(04) VALUE NC"ì˙Å@Å@éä".
002160     02  FILLER          PIC X(01) VALUE SPACE.
002170     02  M5-YY2          PIC N(02).
002180     02  FILLER          PIC N(01) VALUE NC"îN".
002190     02  FILLER          PIC X(01) VALUE SPACE.
002200     02  M5-MM2          PIC N(02).
002210     02  FILLER          PIC N(01) VALUE NC"åé".
002220     02  FILLER          PIC X(01) VALUE SPACE.
002230     02  M5-DD2          PIC N(02).
002240     02  FILLER          PIC N(03) VALUE NC"ì˙Å@Åj".
002250 01  MID06.
002260     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
002270*****02  FILLER          PIC X(02) VALUE ""3F91"".                D.940207
002280*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002290     02  FILLER          PIC X(01) VALUE SPACE.
002300     02  FILLER          PIC N(01) VALUE NC"ïî".
002310*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940215
002320     02  FILLER          PIC N(01) VALUE NC"ñÂ".
002330*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940215
002340     02  FILLER          PIC N(01) VALUE NC"ñº".
002350*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
002360*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002370     02  FILLER          PIC X(01) VALUE SPACE.
002380     02  M6-01           PIC N(10).
002390     02  FILLER          PIC X(01) VALUE SPACE.
002400     02  FILLER          PIC N(01) VALUE NC"Åi".
002410     02  M6-02           PIC N(04).
002420     02  FILLER          PIC N(01) VALUE NC"Åj".
002430     02  FILLER          PIC X(01) VALUE SPACE.
002440*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002450     02  FILLER          PIC X(51) VALUE SPACE.
002460*****02  FILLER          PIC X(02) VALUE ""3F92"".                D.940207
002470*01  MID07.                                                       D.940207
002480*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002490*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940207
002500*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002510*****02  FILLER          PIC X(35) VALUE SPACE.                   D.940207
002520*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002530*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940207
002540*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002550*****02  FILLER          PIC X(35) VALUE SPACE.                   D.940207
002560*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002570*****02  FILLER          PIC X(06) VALUE SPACE.                   D.940207
002580*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002590 01  MID08.
002600*****02  FILLER          PIC X(02) VALUE ""3F91"".                D.940207
002610*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002620     02  FILLER          PIC X(04) VALUE SPACE.                   I.940214
002630     02  FILLER          PIC X(01) VALUE SPACE.
002640     02  FILLER          PIC N(04) VALUE NC"ä®íËâ»ñ⁄".
002650*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
002660*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002670     02  FILLER          PIC X(01) VALUE SPACE.
002680     02  M8-01           PIC N(10).
002690     02  FILLER          PIC X(01) VALUE SPACE.
002700     02  FILLER          PIC N(01) VALUE NC"Åi".
002710     02  M8-02           PIC N(04).
002720     02  FILLER          PIC N(01) VALUE NC"Åj".
002730     02  FILLER          PIC X(01) VALUE SPACE.
002740*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002750     02  FILLER          PIC X(01) VALUE SPACE.
002760     02  FILLER          PIC N(04) VALUE NC"ï‚èïâ»ñ⁄".
002770*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
002780*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002790     02  FILLER          PIC X(01) VALUE SPACE.
002800     02  M8-03           PIC N(10).
002810     02  FILLER          PIC X(01) VALUE SPACE.
002820     02  FILLER          PIC N(01) VALUE NC"Åi".
002830     02  M8-04           PIC N(04).
002840     02  FILLER          PIC N(01) VALUE NC"Åj".
002850     02  FILLER          PIC X(01) VALUE SPACE.
002860*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002870     02  FILLER          PIC X(01) VALUE SPACE.
002880     02  M8-05           PIC N(02).
002890     02  FILLER          PIC X(01) VALUE SPACE.
002900*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002910     02  FILLER          PIC X(36) VALUE SPACE.
002920*****02  FILLER          PIC X(02) VALUE ""3F92"".                D.940207
002930*01  MID09.                                                       D.940207
002940*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002950*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940207
002960*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002970*****02  FILLER          PIC X(11) VALUE SPACE.                   D.940207
002980*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
002990*****02  FILLER          PIC X(24) VALUE SPACE.                   D.940207
003000*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003010*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003020*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003030*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003040*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003050*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003060*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003070*****02  FILLER          PIC X(32) VALUE SPACE.                   D.940207
003080*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003090*****02  FILLER          PIC X(04) VALUE SPACE.                   D.940207
003100*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003110 01  MID10.
003120     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
003130*****02  FILLER          PIC X(04) VALUE ""3F913F93"".            D.940207
003140*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
003150     02  FILLER          PIC X(16) VALUE SPACE.                   I.940214
003160*****02  FILLER          PIC N(01) VALUE NC"ì˙".                  D.940214
003170*****02  FILLER          PIC X(03) VALUE SPACE.                   D.940214
003180*****02  FILLER          PIC N(01) VALUE NC"ït".                  D.940214
003190     02  FILLER          PIC N(03) VALUE NC"ì˙Å@ït".              I.940214
003200     02  FILLER          PIC X(02) VALUE SPACE.
003210*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003220     02  FILLER          PIC X(01) VALUE SPACE.
003230     02  FILLER          PIC N(04) VALUE NC"ì`ï[î‘çÜ".
003240     02  FILLER          PIC X(02) VALUE SPACE.
003250*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003260     02  FILLER          PIC X(01) VALUE SPACE.
003270     02  F               PIC X(05) VALUE "∫∞ƒﬁ ".                 I.940214
003280*****02  FILLER          PIC N(07) VALUE NC"éÊÅ@à¯Å@êÊÅ@ñº".      D.940214
003290     02  FILLER          PIC N(04) VALUE NC"éÊà¯êÊñº".            I.940214
003300*****02  FILLER          PIC X(02) VALUE SPACE.                   D.940214
003310     02  FILLER          PIC X(13) VALUE SPACE.                   I.940214
003320*****02  FILLER          PIC X(07) VALUE "(∫∞ƒﬁ )".               D.940214
003330*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003340*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
003350*****02  FILLER          PIC N(07) VALUE NC"éÿÅ@ï˚Å@ã‡Å@äz".      D.940214
003360     02  FILLER          PIC N(04) VALUE NC"éÿï˚ã‡äz".            I.940214
003370*****02  FILLER          PIC X(02) VALUE SPACE.                   D.940214
003380     02  FILLER          PIC X(06) VALUE SPACE.                   I.940214
003390*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003400*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
003410*****02  FILLER          PIC N(07) VALUE NC"ë›Å@ï˚Å@ã‡Å@äz".      D.940214
003420     02  FILLER          PIC N(04) VALUE NC"ë›ï˚ã‡äz".            I.940214
003430*****02  FILLER          PIC X(02) VALUE SPACE.                   D.940214
003440*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003450     02  FILLER          PIC X(04) VALUE SPACE.
003460     02  FILLER          PIC N(05) VALUE NC"ìñåéî≠ê∂äz".
003470     02  FILLER          PIC X(02) VALUE SPACE.                   I.940214
003480*****02  FILLER          PIC X(03) VALUE SPACE.                   D.940214
003490*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003500*****02  FILLER          PIC X(09) VALUE SPACE.                   D.940214
003510*****02  FILLER          PIC N(07) VALUE NC"ìEÅ@Å@Å@Å@Å@óv".      D.940214
003520*****02  FILLER          PIC X(09) VALUE SPACE.                   D.940214
003530     02  FILLER          PIC N(05) VALUE NC"ìEÅ@Å@Å@óv".          I.940214
003540     02  FILLER          PIC X(20) VALUE SPACE.                   I.940214
003550*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003560*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
003570     02  FILLER          PIC N(01) VALUE NC"ê≈".
003580*****02  FILLER          PIC X(01) VALUE SPACE.                   D.940214
003590*****02  FILLER          PIC X(04) VALUE ""3F923F93"".            D.940207
003600*01  YOKO.                                                        D.940207
003610*****02  FILLER          PIC X(02) VALUE ""3F91"".                D.940207
003620*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003630*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940207
003640*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003650*****02  FILLER          PIC X(11) VALUE SPACE.                   D.940207
003660*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003670*****02  FILLER          PIC X(24) VALUE SPACE.                   D.940207
003680*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003690*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003700*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003710*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003720*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003730*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003740*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003750*****02  FILLER          PIC X(32) VALUE SPACE.                   D.940207
003760*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003770*****02  FILLER          PIC X(04) VALUE SPACE.                   D.940207
003780*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003790*****02  FILLER          PIC X(02) VALUE ""3F92"".                D.940207
003800*01  TATEP1.                                                      D.940207
003810*****02  FILLER          PIC X(05) VALUE SPACE.                   D.940207
003820*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003830*****02  FILLER          PIC X(10) VALUE SPACE.                   D.940207
003840*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003850*****02  FILLER          PIC X(11) VALUE SPACE.                   D.940207
003860*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003870*****02  FILLER          PIC X(29) VALUE SPACE.                   D.940207
003880*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003890*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003900*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003910*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003920*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003930*****02  FILLER          PIC X(17) VALUE SPACE.                   D.940207
003940*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003950*****02  FILLER          PIC X(42) VALUE SPACE.                   D.940207
003960*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003970*****02  FILLER          PIC X(04) VALUE SPACE.                   D.940207
003980*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.940207
003990*********
004000 COPY LWMSG.
004010*********
004020 SCREEN                  SECTION.
004030 SD  CRT-BF
004040     END  STATUS    IS   ESTAT.
004050 01  DISP-C   LINE 01.
004060     02  DISP-CLE  CLEAR SCREEN.
004070**********
004080 COPY LSMSG.
004090******************************************************************
004100 PROCEDURE                   DIVISION.
004110 MR000.
004120     PERFORM INI-RTN THRU INI-EX.
004130     IF ERR-SW = 1
004140        GO TO MR999.
004150     PERFORM OPEN-RTN THRU OPEN-EX.
004160**
004170*****MOVE Z-GESYY    TO WK-ZZ.                                    D.971113
004180*****MOVE WK-ZZ      TO M5-YY1.                                   D.971113
004190     MOVE Z-GESYY2   TO M5-YY1.                                   I.971113
004200     MOVE Z-GESMM    TO WK-ZZ.
004210     MOVE WK-ZZ      TO M5-MM1.
004220     MOVE Z-GESDD    TO WK-ZZ.
004230     MOVE WK-ZZ      TO M5-DD1.
004240*
004250*****MOVE Z-GEMYY    TO WK-ZZ.                                    D.971113
004260*****MOVE WK-ZZ      TO M5-YY2.                                   D.971113
004270     MOVE Z-GEMYY2   TO M5-YY2.                                   I.971113
004280     MOVE Z-GEMMM    TO WK-ZZ.
004290     MOVE WK-ZZ      TO M5-MM2.
004300     MOVE Z-GEMDD    TO WK-ZZ.
004310     MOVE WK-ZZ      TO M5-DD2.
004320**
004330 MR100.
004340     READ SDW AT END
004350          GO TO MR900.
004360     MOVE WHTAXKB     TO NWHTAXKB.                                *A910530
004370     MOVE WHKACD1     TO NWHKACD1.
004380     MOVE WHSECTCD    TO NWHSECTCD.
004390     MOVE NEW-KEY     TO OLD-KEY.
004400     PERFORM MSET-RTN THRU MSET-EX.
004410     PERFORM MID-RTN  THRU MID-EX.
004420     GO TO MR120.
004430 MR110.
004440     READ SDW AT END
004450          GO TO MR190.
004460     MOVE WHTAXKB     TO NWHTAXKB.                                *A910530
004470     MOVE WHKACD1     TO NWHKACD1.
004480     MOVE WHSECTCD    TO NWHSECTCD.
004490 MR120.
004500     IF NEW-KEY NOT = OLD-KEY
004510        PERFORM TOT1-RTN THRU TOT1-EX
004520        PERFORM TAX-RTN  THRU TAX-EX
004530        PERFORM MSET-RTN THRU MSET-EX
004540        PERFORM MID-RTN  THRU MID-EX
004550        MOVE ZERO     TO OLD-AREA.
004560     PERFORM PRI-RTN THRU PRI-EX.
004570     PERFORM ADD-RTN THRU ADD-EX.
004580     MOVE NEW-KEY      TO OLD-KEY.
004590*****MOVE WHTRDATE3    TO OWHTRDATE3.                             D.980224
004600*****MOVE WHJUNLNO3    TO OWHJUNLNO3.                             D.980224
004610     MOVE WHTRDATE     TO OWHTRDATE3.                             I.980224
004620     MOVE WHJUNLNO     TO OWHJUNLNO3.                             I.980224
004630     GO TO MR110.
004640 MR190.
004650     PERFORM TOT1-RTN THRU TOT1-EX.
004660     PERFORM TAX-RTN  THRU TAX-EX.
004670 MR900.
004680     PERFORM CLSE-ENT THRU CLSE-EXT.
004690 MR999.
004700     STOP RUN.
004710************************
004720 INI-RTN.
004730     ACCEPT SYSDATE     FROM DATE.
004740*****MOVE SYS-YY     TO WK-ZZ.                                    D.971113
004750*****MOVE WK-ZZ      TO M3-YY.                                    D.971113
004760     MOVE SYS-YY     TO M3-YY.                                    I.971113
004770     MOVE SYS-MM     TO WK-ZZ.
004780     MOVE WK-ZZ      TO M3-MM.
004790     MOVE SYS-DD     TO WK-ZZ.
004800     MOVE WK-ZZ      TO M3-DD.
004810*
004820     MOVE 0     TO ERR-SW.
004830     OPEN INPUT FCTL-F.
004840     MOVE "DATE  "     TO FCTL-KEY1 ERR-K.
004850     READ FCTL-F UNLOCK INVALID KEY
004860          MOVE "FCTL-F"     TO ERR-F
004870          MOVE "G"          TO ERR-M
004880          DISPLAY ERR-DIS
004890          DISPLAY DISP-BUZ-B
004900          CLOSE FCTL-F
004910          MOVE 1     TO ERR-SW
004920          GO TO INI-EX.
004930     MOVE FCTL-REC1     TO Z-R.
004940*
004950     MOVE "SUB   "     TO FCTL-KEY1 ERR-K.
004960     READ FCTL-F UNLOCK INVALID KEY
004970          MOVE "FCTL-F"     TO ERR-F
004980          MOVE "G"          TO ERR-M
004990          DISPLAY ERR-DIS
005000          DISPLAY DISP-BUZ-B
005010          CLOSE FCTL-F
005020          MOVE 1     TO ERR-SW
005030          GO TO INI-EX.
005040     MOVE FCTL-SUB5     TO WSUB5.
005050*
005060     MOVE "TAX   "     TO FCTL-KEY1 ERR-K.
005070     READ FCTL-F UNLOCK INVALID KEY
005080          MOVE "FCTL-F"     TO ERR-F
005090          MOVE "G"          TO ERR-M
005100          DISPLAY ERR-DIS
005110          DISPLAY DISP-BUZ-B
005120          CLOSE FCTL-F
005130          MOVE 1     TO ERR-SW
005140          GO TO INI-EX.
005150     MOVE 1     TO I.
005160 INI-000.
005170     IF (TAX-FROM(I) NOT > Z-GEMYMD) AND
005180        (TAX-TO(I)   NOT < Z-GEMYMD)
005190        NEXT SENTENCE
005200     ELSE
005210        IF I NOT = 2
005220           ADD 1     TO I
005230           GO TO INI-000
005240        ELSE
005250          MOVE "TAX???"     TO ERR-F
005260          MOVE "G"          TO ERR-M
005270          DISPLAY ERR-DIS
005280          DISPLAY DISP-BUZ-B
005290          CLOSE FCTL-F
005300          MOVE 1     TO ERR-SW
005310          GO TO INI-EX.
005320     MOVE TAX-RITU(I)     TO WTAX-A.
005330     IF  I          = 2                                           I.970218
005340        MOVE  TAX-RITU(1) TO WTAX-C.                              I.970218
005350     CLOSE FCTL-F.
005360*
005370     COMPUTE WTAX-B = WTAX-A + 100.
005380     IF  I          = 2                                           I.970218
005390         COMPUTE WTAX-D = WTAX-C + 100.                           I.970218
005400 INI-EX.
005410     EXIT.
005420*********
005430 OPEN-RTN.
005440     CALL "CBLSTNNO" USING STN-NO.                                I.960509
005450     MOVE STN-NO2 TO W-FID2.                                      I.960509
005460*****MOVE W-FID TO WK0170ID.                                      D.970530
005470     MOVE W-FID TO WK0256ID.                                      I.970530
005480*****OPEN INPUT  KNG AM BNM SDW TK.                               D.980224
005490     OPEN INPUT  KNG AM BNM SDW.                                  I.980224
005500     OPEN OUTPUT P-F.
005510 OPEN-EX.
005520     EXIT.
005530*********
005540 SET-RTN.
005550     IF DR-CR = WHDR-CR
005560        COMPUTE W-ZAN = W-ZAN + WHAMOUNT
005570     ELSE
005580        COMPUTE W-ZAN = W-ZAN - WHAMOUNT.
005590 SET-EX.
005600     EXIT.
005610*********
005620 PRI-RTN.
005630     IF LINAGE-COUNTER > 60
005640        MOVE   0   TO  W-MC   W-BMC                               I.940214
005650        PERFORM MID-RTN THRU MID-EX.
005660*                                                                 ñæç◊ÇP
005670*****MOVE TATEP1       TO P-R.                                    D.940207
005680     MOVE SPACE        TO P-R.                                    I.940211
005690     MOVE K15          TO P1-K15.
005700     MOVE K20          TO P1-K20.
005710*****MOVE WHTRDATE3    TO WK-YMD.                                 D.980224
005720*****IF WHTRDATE3 = OWHTRDATE3                                    D.980224
005730     MOVE WHTRDATE     TO WK-YMD.                                 I.980224
005740     IF WHTRDATE  = OWHTRDATE3                                    I.980224
005750        GO TO PRI-030.
005760     IF WK-YY NOT = OWHTRDATE3YY
005770        GO TO PRI-000.
005780     IF WK-MM NOT = OWHTRDATE3MM
005790        GO TO PRI-010.
005800     IF WK-DD NOT = OWHTRDATE3DD
005810        GO TO PRI-020.
005820 PRI-000.
005830*****MOVE WK-YY    TO P1-01Y.                                     D.971113
005840     MOVE WK-YY2   TO P1-01Y.                                     I.971113
005850     MOVE "."      TO P1-01YH.
005860 PRI-010.
005870     MOVE WK-MM    TO P1-01M.
005880     MOVE "."      TO P1-01MH.
005890 PRI-020.
005900     MOVE WK-DD    TO P1-01D.
005910     GO TO PRI-040.
005920 PRI-030.
005930*****IF WHJUNLNO3 = OWHJUNLNO3                                    D.980224
005940     IF WHJUNLNO  = OWHJUNLNO3                                    I.980224
005950        GO TO PRI-050.
005960 PRI-040.
005970*****MOVE WHJUNLNO3  TO P1-02.                                    D.980224
005980     MOVE WHJUNLNO   TO P1-02.                                    I.980224
005990     MOVE "-"        TO P1-02H.
006000 PRI-050.
006010*****MOVE WHLINENO3  TO P1-03.                                    D.980224
006020     MOVE WHLINENO   TO P1-03.                                    I.980224
006030     IF WHCUSTCD = ZERO                                           *C910513
006040        MOVE SPACE        TO P1-04                                *C910513
006050     ELSE
006060        MOVE WHNAMEN      TO P1-04.                               I.980224
006070*****   MOVE WHCUSTCD     TO TK-KEY                               D.980224
006080*****   PERFORM TKG-RTN THRU TKG-EX                               D.980224
006090*****   MOVE TK-NAMEN    TO P1-04.                                D.980224
006100     IF WHCUSTCD NOT = ZERO                                       *A910513
006110*****   MOVE "("        TO P1-05F                                 D.940214
006120        MOVE WHCUSTCD   TO P1-05                                  *C910513
006130*****   MOVE ")"        TO P1-05T.                                D.940214
006140     IF WHDR-CR = 1
006150        MOVE WHAMOUNT    TO P1-06
006160     ELSE
006170        MOVE WHAMOUNT    TO P1-07.
006180*
006190     PERFORM SET-RTN THRU SET-EX.
006200*
006210     MOVE W-ZAN      TO P1-08.
006220     MOVE WHTEKIYO   TO P1-09.
006230*****IF WHTAXKB NOT = SPACE                                       D.970218
006240     IF WHTAXKB     = "1" OR "5"                                  I.970218
006250        MOVE "*"       TO P1-10.
006260     IF WHTAXKB     = "3" OR "7"                                  I.970218
006270        MOVE "#"       TO P1-10.                                  I.970218
006280     WRITE P-R AFTER 1.
006290     MOVE SPACE     TO P-R.
006300 PRI-EX.
006310     EXIT.
006320***
006330 ADD-RTN.
006340     IF WHDR-CR = 1
006350        ADD WHAMOUNT     TO TOT-KR
006360     ELSE
006370        ADD WHAMOUNT     TO TOT-KS.
006380 ADD-EX.
006390     EXIT.
006400***
006410 MID-RTN.
006420     IF NWHSECTCD   NOT = OWHSECTCD                               I.940214
006430        MOVE  0      TO  W-MC  W-BMC W-PC                         I.940214
006440        WRITE P-R AFTER PAGE.                                     I.940214
006450     IF LINAGE-COUNTER > 54                                       I.940214
006460        MOVE   0   TO  W-MC   W-BMC   W-PC                        I.940214
006470        WRITE P-R AFTER PAGE.                                     I.940214
006480*****IF PCNT NOT = ZERO                                           D.940215
006490*****   WRITE P-R AFTER PAGE.                                     D.940207
006500     IF W-PC  = 0                                                 I.940215
006510        MOVE  5  TO W-PC                                          I.940215
006520        ELSE   WRITE P-R AFTER 2.                                 I.940207
006530*****ADD 1     TO PCNT.                                           D.940215
006540*****MOVE PCNT     TO WK-ZZZZZ.                                   D.940215
006550*****MOVE WK-ZZZZZ     TO M3-PCNT.                                D.940215
006560     IF W-MC = ZERO                                               I.940207
006570        MOVE  5      TO  W-MC                                     I.940214
006580        ADD 1     TO PCNT                                         I.940215
006590        MOVE PCNT     TO WK-ZZZZZ                                 I.940215
006600        MOVE WK-ZZZZZ     TO M3-PCNT                              I.940215
006610        WRITE P-R FROM MID03 AFTER 2                              I.940207
006620        WRITE P-R FROM MID05 AFTER 2.                             I.940207
006630*****WRITE P-R FROM MID03 AFTER 2.                                D.940207
006640*****WRITE P-R FROM MID04 AFTER 1.                                D.940207
006650*****WRITE P-R FROM MID05 AFTER 1.                                D.940207
006660     IF W-BMC = ZERO                                              I.940214
006670        MOVE  5      TO  W-BMC                                    I.940214
006680        WRITE P-R FROM MID06 AFTER 2.
006690*****WRITE P-R FROM MID07 AFTER 1.                                D.940207
006700*****WRITE P-R FROM MID08 AFTER 1.                                D.940215
006710     WRITE P-R FROM MID08 AFTER 2.                                I.940215
006720*****WRITE P-R FROM MID09 AFTER 1.                                D.940207
006730     WRITE P-R FROM MID10 AFTER 1.
006740*****MOVE TATEP1     TO P-R.                                      D.940207
006750*****MOVE K15        TO P1-K15.                                   D.940214
006760*****MOVE K20        TO P1-K20.                                   D.940214
006770*****MOVE SPACE      TO P1-04 P1-09.                              D.940214
006780*****WRITE P-R AFTER 1.                                           D.940214
006790     MOVE SPACE     TO P-R.
006800 MID-EX.
006810     EXIT.
006820***
006830 MSET-RTN.
006840     MOVE WHACCNTCD     TO AM-KEY.
006850     PERFORM AMG-RTN THRU AMG-EX.
006860*
006870     IF (BS-PL = 1) AND (WSUB5 = 0)
006880        GO TO MSET-000.
006890     IF KEIHI = 1
006900        GO TO MSET-000.
006910     MOVE SPACE     TO M6-01 M6-02.
006920     GO TO MSET-100.
006930 MSET-000.
006940     MOVE WHSECTCD      TO BNM-KEY M6-02.
006950     PERFORM BNMG-RTN THRU BNMG-EX.
006960     MOVE BNMNMN        TO M6-01.
006970 MSET-100.
006980     MOVE WHACCNTCD     TO K-ACCD M8-02.
006990     MOVE ZERO          TO K-HOCD.
007000     PERFORM KNGG-RTN THRU KNGG-EX.
007010     MOVE KNGNMN        TO M8-01.
007020*
007030     IF WHHOACCNT = ZERO
007040        MOVE SPACE     TO M8-03 M8-04
007050     ELSE
007060        MOVE WHKACD1       TO KNG-KEY
007070        PERFORM KNGG-RTN THRU KNGG-EX
007080        MOVE KNGNMN        TO M8-03
007090        MOVE WHHOACCNT     TO M8-04.
007100*
007110     IF DR-CR = 1
007120        MOVE NC"éÿï˚"     TO M8-05
007130     ELSE
007140        MOVE NC"ë›ï˚"     TO M8-05.
007150 MSET-EX.
007160     EXIT.
007170***
007180 TOT1-RTN.
007190     IF PCNT = ZERO
007200        GO TO TOT1-EX.
007210     IF LINAGE-COUNTER > 60                                       I.940215
007220        MOVE   0   TO  W-MC   W-BMC                               I.940215
007230        PERFORM MID-RTN THRU MID-EX.                              I.940215
007240*****MOVE TATEP1             TO P-R.                              D.940207
007250     MOVE SPACE              TO P-R.                              I.940211
007260     MOVE K15                TO P1-K15.
007270     MOVE K20                TO P1-K20.
007280     MOVE NC"ÅiìñåéåvÅj"     TO P1-04.
007290     MOVE TOT-KR             TO P1-06.
007300     MOVE TOT-KS             TO P1-07.
007310     MOVE W-ZAN              TO P1-08.
007320     MOVE SPACE              TO P1-09.
007330     WRITE P-R AFTER 1.
007340     MOVE SPACE     TO P-R.
007350     MOVE ZERO     TO TOT-KR TOT-KS.
007360 TOT1-EX.
007370     EXIT.
007380***
007390 TAX-RTN.
007400     IF PCNT  = ZERO
007410        GO TO TAX-EX.
007420     IF W-ZAN = ZERO
007430        GO TO TAX-999.
007440     IF LINAGE-COUNTER > 60                                       I.940215
007450        MOVE   0   TO  W-MC   W-BMC                               I.940215
007460        PERFORM MID-RTN THRU MID-EX.                              I.940215
007470*****PERFORM SPO-RTN THRU SPO-EX.                                 D.940215
007480*
007490     IF  (I   =  2) AND (OWHTAXKB = "1" OR "5")                   I.970218
007500         COMPUTE W-ZAN ROUNDED = W-ZAN * WTAX-C / WTAX-D          I.970218
007510       ELSE                                                       I.970218
007520         COMPUTE W-ZAN ROUNDED = W-ZAN * WTAX-A / WTAX-B.
007530*****MOVE TATEP1               TO P-R.                            D.940207
007540     MOVE SPACE                TO P-R.                            I.940211
007550     MOVE K15                  TO P1-K15.
007560     MOVE K20                  TO P1-K20.
007570*****IF OWHTAXKB = "1"                                            D.970218
007580     IF OWHTAXKB = "1" OR "3"                                     I.970218
007590        MOVE NC"âºï•"     TO WK-NAME1                                "
007600     ELSE                                                            "
007610        MOVE NC"âºéÛ"     TO WK-NAME1.                               "
007620     MOVE WK-NAME              TO P1-04.                          *C910530
007630     MOVE W-ZAN                TO P1-08.
007640     MOVE ")"                  TO P1-08X.                         I.940215
007650     MOVE SPACE                TO P1-09.
007660     WRITE P-R AFTER 1.
007670     MOVE SPACE     TO P-R.
007680 TAX-999.
007690*****WRITE P-R FROM YOKO AFTER 1.                                 D.940207
007700     MOVE SPACE     TO P-R.
007710*
007720     MOVE ZERO     TO W-ZAN.
007730 TAX-EX.
007740     EXIT.
007750***
007760*SPO-RTN.                                                         D.940215
007770*****MOVE TATEP1     TO P-R.                                      D.940207
007780*****MOVE K15        TO P1-K15.                                   D.940215
007790*****MOVE K20        TO P1-K20.                                   D.940215
007800*****MOVE SPACE      TO P1-04 P1-09.                              D.940215
007810*****WRITE P-R AFTER 1.                                           D.940215
007820*****MOVE SPACE     TO P-R.                                       D.940215
007830*SPO-EX.                                                          D.940215
007840*****EXIT.                                                        D.940215
007850***
007860 AMG-RTN.
007870     MOVE 0     TO INV-SW.
007880     READ AM UNLOCK INVALID KEY
007890          MOVE 1         TO INV-SW
007900          INITIALIZE AM-REC.
007910 AMG-EX.
007920     EXIT.
007930***
007940 KNGG-RTN.
007950     MOVE 0     TO INV-SW.
007960     READ KNG UNLOCK INVALID KEY
007970          MOVE 1         TO INV-SW
007980          MOVE SPACE     TO KNGNMN.
007990 KNGG-EX.
008000     EXIT.
008010***
008020 BNMG-RTN.
008030     MOVE 0     TO INV-SW.
008040     READ BNM UNLOCK INVALID KEY
008050          MOVE 1         TO INV-SW
008060          MOVE SPACE     TO BNMNMN.
008070 BNMG-EX.
008080     EXIT.
008090***
008100*TKG-RTN.                                                         D.980224
008110*****MOVE 0     TO INV-SW.                                        D.980224
008120*****READ TK UNLOCK INVALID KEY                                   D.980224
008130*****     MOVE 1         TO INV-SW                                D.980224
008140*****     MOVE SPACE     TO TK-NAMEN.                             D.980224
008150*TKG-EX.                                                          D.980224
008160*****EXIT.                                                        D.980224
008170*********
008180 CLSE-ENT.
008190*****CLOSE KNG AM BNM SDW P-F TK.                                 D.980224
008200     CLOSE KNG AM BNM SDW P-F.                                    I.980224
008210 CLSE-EXT.
008220     EXIT.
008230*********
008240 COPY LPMSG.
008250*********
