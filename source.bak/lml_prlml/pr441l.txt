000010 IDENTIFICATION              DIVISION.
000020 PROGRAM-ID.                 PR440L.
000030 AUTHOR.                     OZAKI.
000040*===============================================================*
000050*    ëçä®íËå≥í†                                                 *
000060*                            --- 90/01/21 ---                   *
000070*===============================================================*
000080 ENVIRONMENT                DIVISION.
000090 CONFIGURATION              SECTION.
000100 SOURCE-COMPUTER.           NEAC-SYSTEM100.
000110 OBJECT-COMPUTER.           NEAC-SYSTEM100.
000120 INPUT-OUTPUT               SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.                                                 I.971113
000150     SELECT      KNG         ASSIGN  TO      F1-MSD
000160                             ORGANIZATION    INDEXED
000170                             ACCESS  MODE    RANDOM
000180                             RECORD  KEY     KNG-KEY.
000190     SELECT      AM          ASSIGN  TO      F2-MSD
000200                             ORGANIZATION    INDEXED
000210                             ACCESS  MODE    DYNAMIC
000220                             RECORD  KEY     AM-KEY.
000230     SELECT      KZM-F       ASSIGN  TO      F3-MSD
000240                             ORGANIZATION    INDEXED
000250                             ACCESS  MODE    RANDOM
000260                             RECORD  KEY     KZM-KEY.
000270     SELECT      FCTL-F      ASSIGN  TO      F4-MSD
000280                             ORGANIZATION    INDEXED
000290                             ACCESS  MODE    RANDOM
000300                             RECORD  KEY     FCTL-KEY.
000310     SELECT      SDH         ASSIGN  TO      F5-MSD
000320                             ORGANIZATION    INDEXED
000330                             ACCESS  MODE    DYNAMIC
000340                             RECORD  KEY     SH-KEY2.
000350*****SELECT      TK          ASSIGN  TO      F6-MSD               D.980224
000360*****                        ORGANIZATION    INDEXED              D.980224
000370*****                        ACCESS  MODE    RANDOM               D.980224
000380*****                        RECORD  KEY     TK-KEY.              D.980224
000390     SELECT      P-F         ASSIGN  TO      P-PRN999.
000400 I-O-CONTROL.
000410*****APPLY SHARED-MODE ON KNG AM KZM-F FCTL-F SDH TK              D.971113
000420*****APPLY SHARED-MODE ON M-DATE KNG AM KZM-F FCTL-F SDH TK       D.980224
000430     APPLY SHARED-MODE ON M-DATE KNG AM KZM-F FCTL-F SDH          I.980224
000440     APPLY SHIFT-CODE  ON P-F.
000450*******
000460 DATA                        DIVISION.
000470 FILE                        SECTION.
000480     COPY LIBFDD.                                                 I.971113
000490 COPY KANGEL.
000500 COPY ACCUNT.
000510 COPY LKAZAN.
000520 COPY FCTL.
000530 FD  SDH
000540     BLOCK CONTAINS 3 RECORDS
000550     LABEL RECORD STANDARD
000560     VALUE OF IDENTIFICATION "SIWAKE-H2".
000570 COPY SIWAKH.
000580*COPY TKLIB.                                                      D.980224
000590**
000600 FD  P-F
000610     LABEL RECORD OMITTED
000620     LINAGE IS 66.
000630 01  P-R                 PIC X(200).
000640 01  P1-R.
000650     02  P1-K15          PIC X(05).
000660     02  FILLER          PIC X(02).                               *
000670     02  FILLER          PIC X(01).
000680     02  P1-01.
000690*****  03  P1-01Y        PIC Z9.                                  D.971113
000700       03  P1-01Y        PIC 9(02).                               I.971113
000710       03  P1-01YH       PIC X(01).
000720       03  P1-01M        PIC Z9.
000730       03  P1-01MH       PIC X(01).
000740       03  P1-01D        PIC Z9.
000750     02  FILLER          PIC X(01).
000760     02  FILLER          PIC X(02).                               *
000770     02  FILLER          PIC X(01).
000780     02  P1-02           PIC 9(06).
000790     02  P1-02H          PIC X(01).
000800     02  P1-03           PIC 9(02).
000810     02  FILLER          PIC X(01).
000820     02  FILLER          PIC X(02).                               *
000830     02  FILLER          PIC X(01).
000840     02  P1-04           PIC N(10).
000850*****02  FILLER          PIC X(01).                               D.960227
000860     02  FILLER          PIC X(02).                               I.960227
000870     02  P1-05F          PIC X(01).
000880*****02  P1-05           PIC 9(05).                               D.960227
000890     02  P1-05           PIC 9(04).                               I.960227
000900     02  P1-05T          PIC X(01).
000910*****02  FILLER          PIC X(01).                               *D910513
000920     02  FILLER          PIC X(02).                               *
000930     02  P1-06           PIC ----,---,---,--9.
000940     02  FILLER          PIC X(01).
000950     02  FILLER          PIC X(02).                               *
000960     02  P1-07           PIC ----,---,---,--9.
000970     02  FILLER          PIC X(01).
000980     02  FILLER          PIC X(02).                               *
000990     02  P1-08           PIC ----,---,---,--9.
001000     02  FILLER          PIC X(01).
001010     02  FILLER          PIC X(02).                               *
001020     02  FILLER          PIC X(01).
001030     02  P1-09           PIC N(20).
001040     02  FILLER          PIC X(01).
001050     02  FILLER          PIC X(02).                               *
001060     02  FILLER          PIC X(02).
001070     02  P1-10           PIC X(01).
001080     02  FILLER          PIC X(01).
001090     02  FILLER          PIC X(02).                               *
001100     02  P1-K20          PIC X(05).
001110 01  P2-R.
001120     02  P2-K15          PIC X(05).
001130     02  FILLER          PIC X(02).                               *
001140     02  FILLER          PIC X(10).
001150     02  FILLER          PIC X(02).                               *
001160     02  FILLER          PIC X(11).
001170     02  FILLER          PIC X(02).                               *
001180     02  FILLER          PIC X(01).
001190     02  P2-04           PIC N(10).
001200     02  FILLER          PIC X(08).
001210     02  FILLER          PIC X(02).                               *
001220     02  P2-06           PIC ----,---,---,--9.
001230     02  FILLER          PIC X(01).
001240     02  FILLER          PIC X(02).                               *
001250     02  P2-07           PIC ----,---,---,--9.
001260     02  FILLER          PIC X(01).
001270     02  FILLER          PIC X(02).                               *
001280     02  P2-08           PIC ----,---,---,--9.
001290     02  FILLER          PIC X(01).
001300     02  FILLER          PIC X(02).                               *
001310     02  FILLER          PIC X(01).
001320     02  P2-09           PIC N(04).
001330     02  FILLER          PIC X(08).
001340     02  P2-99           PIC ----,---,---,--9.
001350     02  FILLER          PIC X(01).
001360     02  FILLER          PIC X(02).                               *
001370     02  FILLER          PIC X(04).
001380     02  FILLER          PIC X(02).                               *
001390     02  P2-K20          PIC X(05).
001400*****
001410 WORKING-STORAGE             SECTION.
001420 77  ERR-STAT            PIC  X(02).
001430 77  PCNT                PIC  9(05).
001440 77  PRINT-CNT           PIC  9(05).
001450 77  K20                 PIC  X(05) VALUE ""3FE04FE080"".
001460 77  K15                 PIC  X(05) VALUE ""3FE04F40A0"".
001470 77  WKZE                PIC  9(10) VALUE ZERO.
001480 77  WKSP                PIC  X(10) VALUE SPACE.
001490 77  WKNSP               PIC  N(20) VALUE SPACE.
001500 01  CRT-WK.
001510*****02  W-01F           PIC  9(04).                              D.950522
001520*****02  W-01T           PIC  9(04).                              D.950522
001530     02  W-11F           PIC  9(04).                              I.950522
001540     02  W-11T           PIC  9(04).                              I.950522
001550     02  W-12F           PIC  9(04).                              I.950522
001560     02  W-12T           PIC  9(04).                              I.950522
001570     02  W-13F           PIC  9(04).                              I.950522
001580     02  W-13T           PIC  9(04).                              I.950522
001590     02  W-14F           PIC  9(04).                              I.950522
001600     02  W-14T           PIC  9(04).                              I.950522
001610     02  W-15F           PIC  9(04).                              I.950522
001620     02  W-15T           PIC  9(04).                              I.950522
001630     02  W-16F           PIC  9(04).                              I.950522
001640     02  W-16T           PIC  9(04).                              I.950522
001650     02  W-17F           PIC  9(04).                              I.950522
001660     02  W-17T           PIC  9(04).                              I.950522
001670*****02  W-18F           PIC  9(04).                              D.020628
001680*****02  W-18T           PIC  9(04).                              D.020628
001690     02  W-02F.
001700*****  03  W-02FY        PIC  9(02).                              D.971113
001710       03  W-02FY        PIC  9(04).                              I.971113
001720       03  W-02FYL  REDEFINES W-02FY.                             I.971113
001730         04  W-02FY1     PIC  9(02).                              I.971113
001740         04  W-02FY2     PIC  9(02).                              I.971113
001750       03  W-02FM        PIC  9(02).
001760       03  W-02FD        PIC  9(02).
001770     02  W-02FR REDEFINES W-02F     PIC  9(08).                   I.971113
001780*****02  W-02FR REDEFINES W-02F     PIC  9(06).                   D.971113
001790     02  W-02T.
001800*****  03  W-02TY        PIC  9(02).                              D.971113
001810       03  W-02TY        PIC  9(04).                              I.971113
001820       03  W-02TYL  REDEFINES W-02TY.                             I.971113
001830         04  W-02TY1     PIC  9(02).                              I.971113
001840         04  W-02TY2     PIC  9(02).                              I.971113
001850       03  W-02TM        PIC  9(02).
001860       03  W-02TD        PIC  9(02).
001870     02  W-02TR REDEFINES W-02T     PIC  9(08).                   I.971113
001880     02  W-02TL REDEFINES W-02T.                                  I.971113
001890       03  F             PIC  9(02).                              I.971113
001900       03  W-02TS        PIC  9(06).                              I.971113
001910*****02  W-02TR REDEFINES W-02T     PIC  9(06).                   D.971113
001920     02  W-OKC           PIC  X(01).
001930 01  WORK-AREA.
001940     02  I               PIC  9(02).
001950     02  SOE             PIC  9(02).
001960     02  FI              PIC  9(02).
001970     02  TI              PIC  9(02).
001980     02  ERR-SW          PIC  9(01).
001990     02  INV-SW          PIC  9(01).
002000     02  W-ZENKI         PIC S9(11).
002010     02  W-ZAN           PIC S9(11).
002020     02  W-KASI          PIC S9(11).
002030     02  W-KARI          PIC S9(11).
002040**
002050     02  FROM-YMD.
002060       03  FROM-YM.
002070*****    04  FROM-Y      PIC  9(02).                              D.971113
002080         04  FROM-Y      PIC  9(04).                              I.971113
002090         04  FROM-M      PIC  9(02).
002100       03  FROM-D        PIC  9(02).
002110     02  TO-YMD.
002120       03  TO-YM.
002130*****    04  TO-Y        PIC  9(02).                              D.971113
002140         04  TO-Y        PIC  9(04).                              I.971113
002150         04  TO-M        PIC  9(02).
002160       03  TO-D          PIC  9(02).
002170     02  TO-YMD1.
002180       03  TO-YM1.
002190*****    04  TO-Y1       PIC  9(02).                              D.971113
002200         04  TO-Y1       PIC  9(04).                              I.971113
002210         04  TO-M1       PIC  9(02).
002220       03  TO-D1         PIC  9(02).
002230     02  W-YMD.
002240*****  03  W-Y           PIC  9(02).                              D.971113
002250       03  W-Y           PIC  9(04).                              I.971113
002260       03  W-MD.
002270         04  W-M         PIC  9(02).
002280         04  W-D         PIC  9(02).
002290     02  SYSDATE.
002300       03 SYS-YY         PIC  9(02).
002310       03 SYS-MM         PIC  9(02).
002320       03 SYS-DD         PIC  9(02).
002330     02  WK-YMD.
002340*****  03 WK-YY          PIC  9(02).                              D.971113
002350       03 WK-YY          PIC  9(04).                              I.971113
002360       03 WK-YYL  REDEFINES WK-YY.                                I.971113
002370         04 WK-YY1       PIC  9(02).                              I.971113
002380         04 WK-YY2       PIC  9(02).                              I.971113
002390       03 WK-MM          PIC  9(02).
002400       03 WK-DD          PIC  9(02).
002410     02  WK-ZZ           PIC  Z9.
002420     02  WK-ZZZZZ        PIC  ZZZZ9.
002430     02  WK-9999         PIC  9(04).
002440     02  W-TEKIYO        PIC  N(20).                              I.960122
002450     02  W-TEKITOD  REDEFINES W-TEKIYO.                           I.960122
002460       03  W-TEKIYO1     PIC  N(19).                              I.960122
002470       03  W-TEKIYO2     PIC  N(01).                              I.960122
002480 01  OLD-KEY.
002490     02  OHTRDATE2.
002500*****  03  OHTRDATE2YY   PIC  9(02).                              D.971113
002510       03  OHTRDATE2YY   PIC  9(04).                              I.971113
002520       03  OHTRDATE2MM   PIC  9(02).
002530       03  OHTRDATE2DD   PIC  9(02).
002540     02  OHJUNLNO2       PIC  9(06).
002550     02  OZI             PIC  9(02).
002560 01  TOT-WK.
002570     02  TOT-ITEM OCCURS 3.
002580       03  TOT-KR        PIC S9(12).
002590       03  TOT-KS        PIC S9(12).
002600***
002610 01  MID03.
002620     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
002630     02  FILLER          PIC X(02) VALUE SPACE.
002640     02  M1-YY           PIC N(02).
002650     02  FILLER          PIC N(01) VALUE NC"îN".
002660     02  M1-MM           PIC N(02).
002670     02  FILLER          PIC N(01) VALUE NC"åé".
002680     02  M1-DD           PIC N(02).
002690     02  FILLER          PIC N(03) VALUE NC"ì˙çÏê¨".
002700     02  FILLER          PIC X(23) VALUE SPACE.
002710     02  FILLER          PIC X(02) VALUE ""3F91"".
002720     02  FILLER          PIC X(02) VALUE SPACE.
002730     02  FILLER          PIC N(09)
002740         VALUE NC"ëçÅ@ä®Å@íËÅ@å≥Å@í†".
002750     02  FILLER          PIC X(02) VALUE SPACE.
002760     02  FILLER          PIC X(02) VALUE ""3F92"".
002770     02  FILLER          PIC X(49) VALUE SPACE.
002780     02  M1-PCNT         PIC N(05).
002790     02  FILLER          PIC N(01) VALUE NC"ï≈".
002800 01  MID04.
002810     02  FILLER          PIC X(02) VALUE ""3F91"".
002820     02  FILLER          PIC X(51) VALUE SPACE.
002830     02  FILLER          PIC X(02) VALUE ""3F92"".
002840 01  MID05.
002850     02  FILLER          PIC X(02) VALUE ""3F93"".
002860     02  FILLER          PIC X(10) VALUE SPACE.
002870     02  FILLER          PIC X(02) VALUE ""3F93"".
002880     02  FILLER          PIC X(35) VALUE SPACE.
002890     02  FILLER          PIC X(02) VALUE ""3F93"".
002900     02  FILLER          PIC X(06) VALUE SPACE.
002910     02  FILLER          PIC X(02) VALUE ""3F93"".
002920 01  MID06.
002930     02  FILLER          PIC X(02) VALUE ""3F93"".
002940     02  FILLER          PIC X(01) VALUE SPACE.
002950     02  FILLER          PIC N(04) VALUE NC"ä®íËâ»ñ⁄".
002960     02  FILLER          PIC X(01) VALUE SPACE.
002970     02  FILLER          PIC X(02) VALUE ""3F93"".
002980     02  FILLER          PIC X(01) VALUE SPACE.
002990     02  M6-01           PIC N(10).
003000     02  FILLER          PIC X(01) VALUE SPACE.
003010     02  FILLER          PIC N(01) VALUE NC"Åi".
003020     02  M6-02           PIC N(04).
003030     02  FILLER          PIC N(01) VALUE NC"Åj".
003040     02  FILLER          PIC X(01) VALUE SPACE.
003050     02  FILLER          PIC X(02) VALUE ""3F93"".
003060     02  FILLER          PIC X(01) VALUE SPACE.
003070     02  M6-03           PIC N(02).
003080     02  FILLER          PIC X(01) VALUE SPACE.
003090     02  FILLER          PIC X(02) VALUE ""3F93"".
003100     02  FILLER          PIC X(02) VALUE SPACE.
003110     02  FILLER          PIC N(03) VALUE NC"ÅiÅ@é©".
003120     02  FILLER          PIC X(01) VALUE SPACE.
003130     02  M6-YYF          PIC N(02).
003140     02  FILLER          PIC N(01) VALUE NC"îN".
003150     02  FILLER          PIC X(01) VALUE SPACE.
003160     02  M6-MMF          PIC N(02).
003170     02  FILLER          PIC N(01) VALUE NC"åé".
003180     02  FILLER          PIC X(01) VALUE SPACE.
003190     02  M6-DDF          PIC N(02).
003200     02  FILLER          PIC N(01) VALUE NC"ì˙".
003210     02  FILLER          PIC X(05) VALUE SPACE.
003220     02  FILLER          PIC N(01) VALUE NC"éä".
003230     02  FILLER          PIC X(01) VALUE SPACE.
003240     02  M6-YYT          PIC N(02).
003250     02  FILLER          PIC N(01) VALUE NC"îN".
003260     02  FILLER          PIC X(01) VALUE SPACE.
003270     02  M6-MMT          PIC N(02).
003280     02  FILLER          PIC N(01) VALUE NC"åé".
003290     02  FILLER          PIC X(01) VALUE SPACE.
003300     02  M6-DDT          PIC N(02).
003310     02  FILLER          PIC N(01) VALUE NC"ì˙".
003320     02  FILLER          PIC N(02) VALUE NC"Å@Åj".
003330 01  MID07.
003340     02  FILLER          PIC X(04) VALUE ""3F913F93"".
003350     02  FILLER          PIC X(10) VALUE SPACE.
003360     02  FILLER          PIC X(02) VALUE ""3F93"".
003370     02  FILLER          PIC X(35) VALUE SPACE.
003380     02  FILLER          PIC X(02) VALUE ""3F93"".
003390     02  FILLER          PIC X(06) VALUE SPACE.
003400     02  FILLER          PIC X(02) VALUE ""3F93"".
003410     02  FILLER          PIC X(81) VALUE SPACE.
003420     02  FILLER          PIC X(02) VALUE ""3F92"".
003430 01  MID08.
003440     02  FILLER          PIC X(02) VALUE ""3F93"".
003450     02  FILLER          PIC X(10) VALUE SPACE.
003460     02  FILLER          PIC X(02) VALUE ""3F93"".
003470     02  FILLER          PIC X(11) VALUE SPACE.
003480     02  FILLER          PIC X(02) VALUE ""3F93"".
003490     02  FILLER          PIC X(24) VALUE SPACE.
003500     02  FILLER          PIC X(02) VALUE ""3F93"".
003510     02  FILLER          PIC X(17) VALUE SPACE.
003520     02  FILLER          PIC X(02) VALUE ""3F93"".
003530     02  FILLER          PIC X(17) VALUE SPACE.
003540     02  FILLER          PIC X(02) VALUE ""3F93"".
003550     02  FILLER          PIC X(17) VALUE SPACE.
003560     02  FILLER          PIC X(02) VALUE ""3F93"".
003570     02  FILLER          PIC X(32) VALUE SPACE.
003580     02  FILLER          PIC X(02) VALUE ""3F93"".
003590     02  FILLER          PIC X(04) VALUE SPACE.
003600     02  FILLER          PIC X(02) VALUE ""3F93"".
003610 01  MID09.
003620     02  FILLER          PIC X(04) VALUE ""3F913F93"".
003630     02  FILLER          PIC X(01) VALUE SPACE.
003640     02  FILLER          PIC N(04) VALUE NC"ì˙Å@Å@ït".
003650     02  FILLER          PIC X(01) VALUE SPACE.
003660     02  FILLER          PIC X(02) VALUE ""3F93"".
003670     02  FILLER          PIC X(01) VALUE SPACE.
003680     02  FILLER          PIC N(04) VALUE NC"ì`ï[î‘çÜ".
003690     02  FILLER          PIC X(02) VALUE SPACE.
003700     02  FILLER          PIC X(02) VALUE ""3F93"".
003710     02  FILLER          PIC X(01) VALUE SPACE.
003720     02  FILLER          PIC N(07) VALUE NC"éÊÅ@à¯Å@êÊÅ@ñº".      *C910513
003730     02  FILLER          PIC X(02) VALUE SPACE.
003740*****02  FILLER          PIC X(07) VALUE "(∫∞ƒﬁ )".               D.960227
003750     02  FILLER          PIC X(02) VALUE " (".                    I.960227
003760     02  FILLER          PIC N(02) VALUE NC"ïîñÂ".                I.960227
003770     02  FILLER          PIC X(01) VALUE ")".                     I.960227
003780     02  FILLER          PIC X(02) VALUE ""3F93"".
003790     02  FILLER          PIC X(01) VALUE SPACE.
003800     02  FILLER          PIC N(07) VALUE NC"éÿÅ@ï˚Å@ã‡Å@äz".
003810     02  FILLER          PIC X(02) VALUE SPACE.
003820     02  FILLER          PIC X(02) VALUE ""3F93"".
003830     02  FILLER          PIC X(01) VALUE SPACE.
003840     02  FILLER          PIC N(07) VALUE NC"ë›Å@ï˚Å@ã‡Å@äz".
003850     02  FILLER          PIC X(02) VALUE SPACE.
003860     02  FILLER          PIC X(02) VALUE ""3F93"".
003870     02  FILLER          PIC X(01) VALUE SPACE.
003880     02  FILLER          PIC N(07) VALUE NC"écÅ@çÇÅ@ã‡Å@äz".
003890     02  FILLER          PIC X(02) VALUE SPACE.
003900     02  FILLER          PIC X(02) VALUE ""3F93"".
003910     02  FILLER          PIC X(09) VALUE SPACE.
003920     02  FILLER          PIC N(07) VALUE NC"ìEÅ@Å@Å@Å@Å@óv".
003930     02  FILLER          PIC X(09) VALUE SPACE.
003940     02  FILLER          PIC X(02) VALUE ""3F93"".
003950     02  FILLER          PIC X(01) VALUE SPACE.
003960     02  FILLER          PIC N(01) VALUE NC"ê≈".
003970     02  FILLER          PIC X(01) VALUE SPACE.
003980     02  FILLER          PIC X(04) VALUE ""3F923F93"".
003990 01  YOKO.
004000     02  FILLER          PIC X(02) VALUE ""3F91"".                *
004010     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004020     02  FILLER          PIC X(10) VALUE SPACE.
004030     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004040     02  FILLER          PIC X(11) VALUE SPACE.
004050     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004060     02  FILLER          PIC X(24) VALUE SPACE.
004070     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004080     02  FILLER          PIC X(17) VALUE SPACE.
004090     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004100     02  FILLER          PIC X(17) VALUE SPACE.
004110     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004120     02  FILLER          PIC X(17) VALUE SPACE.
004130     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004140     02  FILLER          PIC X(32) VALUE SPACE.
004150     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004160     02  FILLER          PIC X(04) VALUE SPACE.
004170     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004180     02  FILLER          PIC X(02) VALUE ""3F92"".                *
004190 01  TATEP1.
004200     02  FILLER          PIC X(05) VALUE SPACE.
004210     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004220     02  FILLER          PIC X(10) VALUE SPACE.
004230     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004240     02  FILLER          PIC X(11) VALUE SPACE.
004250     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004260     02  FILLER          PIC X(29) VALUE SPACE.
004270     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004280     02  FILLER          PIC X(17) VALUE SPACE.
004290     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004300     02  FILLER          PIC X(17) VALUE SPACE.
004310     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004320     02  FILLER          PIC X(17) VALUE SPACE.
004330     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004340     02  FILLER          PIC X(42) VALUE SPACE.
004350     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004360     02  FILLER          PIC X(04) VALUE SPACE.
004370     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004380 01  TATEP2.
004390     02  FILLER          PIC X(05) VALUE SPACE.
004400     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004410     02  FILLER          PIC X(10) VALUE SPACE.
004420     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004430     02  FILLER          PIC X(11) VALUE SPACE.
004440     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004450     02  FILLER          PIC X(29) VALUE SPACE.
004460     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004470     02  FILLER          PIC X(17) VALUE SPACE.
004480     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004490     02  FILLER          PIC X(17) VALUE SPACE.
004500     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004510     02  FILLER          PIC X(17) VALUE SPACE.
004520     02  FILLER          PIC X(02) VALUE ""3F93"".
004530     02  FILLER          PIC X(34) VALUE SPACE.
004540     02  FILLER          PIC X(02) VALUE ""3F93"".
004550     02  FILLER          PIC X(04) VALUE SPACE.
004560     02  FILLER          PIC X(02) VALUE ""3F93"".
004570     02  FILLER          PIC X(05) VALUE SPACE.
004580*********
004590 COPY LWMSG.
004600*********
004610 SCREEN                  SECTION.
004620 SD  CRT-BF
004630     END  STATUS    IS   ESTAT.
004640 01  DISP-C   LINE 01.
004650     02  DISP-CLE  CLEAR SCREEN.
004660***
004670 01  ACP-AREA.
004680*****02  ACP-W01F    LINE 06   COLUMN 31    PIC 9(04)             D.950522
004690*****    USING W-01F                  CHECK OVERFLOW  NO IFC.     D.950522
004700*****02  ACP-W01T    LINE 06   COLUMN 51    PIC 9(04)             D.950522
004710*****    USING W-01T                  CHECK OVERFLOW  NO IFC.     D.950522
004720     02  ACP-W11     LINE 06.                                     I.950522
004730         03  ACP-W11F          COLUMN 31    PIC 9(04)             I.950522
004740             USING W-11F              CHECK OVERFLOW  NO IFC.     I.950522
004750         03  ACP-W11T          COLUMN 51    PIC 9(04)             I.950522
004760             USING W-11T              CHECK OVERFLOW  NO IFC.     I.950522
004770     02  ACP-W12     LINE 08.                                     I.950522
004780         03  ACP-W12F          COLUMN 31    PIC 9(04)             I.950522
004790             USING W-12F              CHECK OVERFLOW  NO IFC.     I.950522
004800         03  ACP-W12T          COLUMN 51    PIC 9(04)             I.950522
004810             USING W-12T              CHECK OVERFLOW  NO IFC.     I.950522
004820     02  ACP-W13     LINE 10.                                     I.950522
004830         03  ACP-W13F          COLUMN 31    PIC 9(04)             I.950522
004840             USING W-13F              CHECK OVERFLOW  NO IFC.     I.950522
004850         03  ACP-W13T          COLUMN 51    PIC 9(04)             I.950522
004860             USING W-13T              CHECK OVERFLOW  NO IFC.     I.950522
004870     02  ACP-W14     LINE 12.                                     I.950522
004880         03  ACP-W14F          COLUMN 31    PIC 9(04)             I.950522
004890             USING W-14F              CHECK OVERFLOW  NO IFC.     I.950522
004900         03  ACP-W14T          COLUMN 51    PIC 9(04)             I.950522
004910             USING W-14T              CHECK OVERFLOW  NO IFC.     I.950522
004920     02  ACP-W15     LINE 14.                                     I.950522
004930         03  ACP-W15F          COLUMN 31    PIC 9(04)             I.950522
004940             USING W-15F              CHECK OVERFLOW  NO IFC.     I.950522
004950         03  ACP-W15T          COLUMN 51    PIC 9(04)             I.950522
004960             USING W-15T              CHECK OVERFLOW  NO IFC.     I.950522
004970     02  ACP-W16     LINE 16.                                     I.950522
004980         03  ACP-W16F          COLUMN 31    PIC 9(04)             I.950522
004990             USING W-16F              CHECK OVERFLOW  NO IFC.     I.950522
005000         03  ACP-W16T          COLUMN 51    PIC 9(04)             I.950522
005010             USING W-16T              CHECK OVERFLOW  NO IFC.     I.950522
005020     02  ACP-W17     LINE 18.                                     I.020628
005030         03  ACP-W17F          COLUMN 31    PIC 9(04)             I.020628
005040             USING W-17F              CHECK OVERFLOW  NO IFC.     I.020628
005050         03  ACP-W17T          COLUMN 51    PIC 9(04)             I.020628
005060             USING W-17T              CHECK OVERFLOW  NO IFC.     I.020628
005070*****02  ACP-W02F    LINE 08.                                     D.950522
005080*****02  ACP-W02F    LINE 18.                                     D.020628
005090     02  ACP-W02F    LINE 20.                                     I.020628
005100         03  ACP-W02FY         COLUMN 27    PIC 9(02)
005110             USING W-02FY2                            NO IFC.     I.971113
005120*****        USING W-02FY                             NO IFC.     D.971113
005130         03  ACP-W02FM         COLUMN 30    PIC 9(02)
005140             USING W-02FM                             NO IFC.
005150         03  ACP-W02FD         COLUMN 33    PIC 9(02)
005160             USING W-02FD             CHECK OVERFLOW  NO IFC.
005170*****02  ACP-W02T    LINE 08.                                     D.950522
005180*****02  ACP-W02T    LINE 18.                                     D.020628
005190     02  ACP-W02T    LINE 20.                                     I.020628
005200         03  ACP-W02TY         COLUMN 47    PIC 9(02)
005210             USING W-02TY2                            NO IFC.     I.971113
005220*****        USING W-02TY                             NO IFC.     D.971113
005230         03  ACP-W02TM         COLUMN 50    PIC 9(02)
005240             USING W-02TM                             NO IFC.
005250         03  ACP-W02TD         COLUMN 53    PIC 9(02)
005260             USING W-02TD             CHECK OVERFLOW  NO IFC.
005270     02  ACP-WOKC    LINE 24   COLUMN 77    PIC X(01)
005280         USING W-OKC                  CHECK OVERFLOW  NO IFC.
005290***
005300 01  DSP-AREA.
005310     02  DSP-01      LINE 01.
005320         03      COLUMN  04  PIC  N(01)  VALUE  NC"îN".
005330         03      COLUMN  08  PIC  N(02)  VALUE  NC"åéìx".
005340*****    03      COLUMN  02  PIC  9(02)  FROM  Z-GEMYY.           D.971113
005350         03      COLUMN  02  PIC  9(02)  FROM  Z-GEMYY2.          I.971113
005360         03      COLUMN  06  PIC  9(02)  FROM  Z-GEMMM.
005370         03  COLUMN 35    PIC X(12) FROM  WKSP REVERSE.
005380         03  COLUMN 36    PIC N(05) VALUE NC"ëçä®íËå≥í†".
005390     02  DSP-04      LINE 04.
005400         03  COLUMN 27    PIC N(04) VALUE NC"ÇeÇqÇnÇl".
005410         03  COLUMN 49    PIC N(02) VALUE NC"ÇsÇn".
005420     02  DSP-06      LINE 06.
005430         03  COLUMN 11    PIC N(05) VALUE NC"â»ñ⁄ÉRÅ[Éh".
005440         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
005450     02  DSP-06A     LINE 08.                                     I.950522
005460         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
005470     02  DSP-06B     LINE 10.                                     I.950522
005480         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
005490     02  DSP-06C     LINE 12.                                     I.950522
005500         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
005510     02  DSP-06D     LINE 14.                                     I.950522
005520         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
005530     02  DSP-06E     LINE 16.                                     I.950522
005540         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.950522
005550     02  DSP-06F     LINE 18.                                     I.020628
005560         03  COLUMN 40    PIC N(01) VALUE NC"Å`".                 I.020628
005570*****02  DSP-08      LINE 08.                                     D.950522
005580*****02  DSP-08      LINE 18.                                     D.020628
005590     02  DSP-08      LINE 20.                                     I.020628
005600         03  COLUMN 11    PIC N(05) VALUE NC"ì˙Å@Å@Å@ït".
005610         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
005620         03  COLUMN 29    PIC X(04) VALUE "/  /".
005630         03  COLUMN 49    PIC X(04) VALUE "/  /".
005640     02  DSP-24      LINE 24.
005650         03  COLUMN 61    PIC X(18) VALUE "ämîF OK=1,NO=9 ( )".
005660***
005670 01  MG-AREA.
005680     02  MG-01       LINE 24   COLUMN 02    PIC N(07)
005690         VALUE NC"ì˙ïtä˙ä‘ÉGÉâÅ[".
005700***
005710 01  SP-AREA.
005720     02  SP-06       LINE 06.
005730         03  COLUMN 31   PIC Z(04) FROM WKZE.
005740         03  COLUMN 51   PIC Z(04) FROM WKZE.
005750     02  SP-08       LINE 08.                                     I.950522
005760         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.950522
005770         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.950522
005780     02  SP-10       LINE 10.                                     I.950522
005790         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.950522
005800         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.950522
005810     02  SP-12       LINE 12.                                     I.950522
005820         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.950522
005830         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.950522
005840     02  SP-14       LINE 14.                                     I.950522
005850         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.950522
005860         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.950522
005870     02  SP-16       LINE 16.                                     I.950522
005880         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.950522
005890         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.950522
005900     02  SP-18       LINE 18.                                     I.020628
005910         03  COLUMN 31   PIC Z(04) FROM WKZE.                     I.020628
005920         03  COLUMN 51   PIC Z(04) FROM WKZE.                     I.020628
005930*****02  SP-08       LINE 08.                                     D.950522
005940*****02  SP-18       LINE 08.                                     D.020628
005950     02  SP-20       LINE 20.                                     I.020628
005960         03  COLUMN 27   PIC Z(02) FROM WKZE.
005970         03  COLUMN 30   PIC Z(02) FROM WKZE.
005980         03  COLUMN 33   PIC Z(02) FROM WKZE.
005990         03  COLUMN 47   PIC Z(02) FROM WKZE.
006000         03  COLUMN 50   PIC Z(02) FROM WKZE.
006010         03  COLUMN 53   PIC Z(02) FROM WKZE.
006020     02  SP-24       LINE 24.
006030         03  COLUMN 77   PIC X(01) FROM WKSP.
006040*********
006050 COPY LSMSG.
006060     COPY LIBSCR.                                                 I.971113
006070**********
006080 PROCEDURE                   DIVISION.
006090 MR000.
006100     PERFORM INI-RTN THRU INI-EX.
006110     IF ERR-SW = 1
006120        GO TO MR999.
006130 MR010.
006140*****PERFORM W01F-RTN THRU W01F-EX.                               D.950522
006150     PERFORM W10-RTN THRU W10-EX.                                 I.950522
006160     IF ESTAT = "P9"
006170        GO TO MR900.
006180     DISPLAY DISP-C.                                              I.010811
006190     DISPLAY DSP-AREA.                                            I.010811
006200     DISPLAY ACP-W11F ACP-W11T.                                   I.010811
006210     IF W-12F NOT = ZERO                                          I.010811
006220         DISPLAY ACP-W12F ACP-W12T.                               I.010811
006230     IF W-13F NOT = ZERO                                          I.010811
006240         DISPLAY ACP-W13F ACP-W13T.                               I.010811
006250     IF W-14F NOT = ZERO                                          I.010811
006260         DISPLAY ACP-W14F ACP-W14T.                               I.010811
006270     IF W-15F NOT = ZERO                                          I.010811
006280         DISPLAY ACP-W15F ACP-W15T.                               I.010811
006290     IF W-16F NOT = ZERO                                          I.010811
006300         DISPLAY ACP-W16F ACP-W16T.                               I.010811
006310     IF W-17F NOT = ZERO                                          I.020628
006320         DISPLAY ACP-W17F ACP-W17T.                               I.020628
006330*MR020.                                                           D.950522
006340*****PERFORM W01T-RTN THRU W01T-EX.                               D.950522
006350*****IF ESTAT = "09"                                              D.950522
006360*****   GO TO MR010.                                              D.950522
006370 MR030.
006380     PERFORM W02F-RTN THRU W02F-EX.
006390     IF ESTAT = "09"
006400*****   GO TO MR020.                                              D.950522
006410        GO TO MR010.                                              I.950522
006420 MR040.
006430     PERFORM W02T-RTN THRU W02T-EX.
006440     IF ESTAT = "09"
006450        GO TO MR030.
006460 MR090.
006470     PERFORM WOKC-RTN THRU WOKC-EX.
006480     IF ESTAT = "09"
006490        GO TO MR040.
006500     IF W-OKC = "9"
006510        DISPLAY SP-AREA
006520        GO TO MR010.
006530*    KYU-OPEN-ICHI
006540**
006550*****MOVE W-02FY     TO WK-ZZ.                                    D.971113
006560*****MOVE WK-ZZ      TO M6-YYF.                                   D.971113
006570     MOVE W-02FY2    TO M6-YYF.                                   I.971113
006580     MOVE W-02FM     TO WK-ZZ.
006590     MOVE WK-ZZ      TO M6-MMF.
006600     MOVE W-02FD     TO WK-ZZ.
006610     MOVE WK-ZZ      TO M6-DDF.
006620*
006630*****MOVE W-02TY     TO WK-ZZ.                                    D.971113
006640*****MOVE WK-ZZ      TO M6-YYT.                                   D.971113
006650     MOVE W-02TY2    TO M6-YYT.                                   I.971113
006660     MOVE W-02TM     TO WK-ZZ.
006670     MOVE WK-ZZ      TO M6-MMT.
006680     MOVE W-02TD     TO WK-ZZ.
006690     MOVE WK-ZZ      TO M6-DDT.
006700**
006710*****MOVE W-01F     TO AM-KEY.                                    D.950522
006720     MOVE W-11F     TO AM-KEY.                                    I.950522
006730     START AM KEY NOT LESS AM-KEY INVALID KEY
006740           GO TO MR900.
006750     READ AM NEXT UNLOCK AT END
006760          GO TO MR150.
006770*****IF AM-KEY > W-01T                                            D.950522
006780     IF AM-KEY > W-11T                                            I.950522
006790        GO TO MR900.
006800     GO TO MR110.
006810 MR100.
006820     READ AM NEXT UNLOCK AT END
006830          GO TO MR900.
006840*****IF AM-KEY > W-01T                                            D.950522
006850*****   GO TO MR900.                                              D.950522
006860     IF AM-KEY >= W-11F AND <= W-11T                              I.950522
006870        GO TO MR110.                                              I.950522
006880     IF AM-KEY >= W-12F AND <= W-12T                              I.950522
006890        GO TO MR110.                                              I.950522
006900     IF AM-KEY >= W-13F AND <= W-13T                              I.950522
006910        GO TO MR110.                                              I.950522
006920     IF AM-KEY >= W-14F AND <= W-14T                              I.950522
006930        GO TO MR110.                                              I.950522
006940     IF AM-KEY >= W-15F AND <= W-15T                              I.950522
006950        GO TO MR110.                                              I.950522
006960     IF AM-KEY >= W-16F AND <= W-16T                              I.950522
006970        GO TO MR110.                                              I.950522
006980     IF AM-KEY >= W-17F AND <= W-17T                              I.020628
006990        GO TO MR110.                                              I.020628
007000     GO TO MR100.                                                 I.950522
007010 MR110.
007020     PERFORM KZMG-RTN THRU KZMG-EX.
007030     IF INV-SW = 1
007040        GO TO MR100.
007050*
007060     MOVE AM-KEY     TO K-ACCD.
007070     MOVE ZERO       TO K-HOCD.
007080     PERFORM KNGG-RTN THRU KNGG-EX.
007090     MOVE KNGNMN     TO M6-01.
007100     MOVE AM-KEY     TO WK-9999.
007110     MOVE WK-9999    TO M6-02.
007120     IF DR-CR = 1
007130        MOVE NC"éÿï˚"     TO M6-03
007140     ELSE
007150        MOVE NC"ë›ï˚"     TO M6-03.
007160*
007170     MOVE ZERO        TO TOT-WK W-ZAN W-KARI W-KASI ERR-SW.
007180     MOVE KZM-ZAN     TO W-ZENKI.
007190     PERFORM ZAN-SET-RTN THRU ZAN-SET-EX.
007200     IF (W-ZAN  = ZERO) AND
007210        (W-KARI = ZERO) AND
007220        (W-KASI = ZERO)
007230        MOVE 1     TO ERR-SW.
007240*
007250     MOVE ZERO         TO SH-KEY2.
007260     MOVE AM-KEY       TO HACCNTCD2.
007270     MOVE Z-TOUF(TI)   TO HTRDATE2.
007280     START SDH KEY NOT LESS SH-KEY2 INVALID KEY
007290           GO TO MR150.
007300 MR140.
007310     READ SDH NEXT UNLOCK AT END
007320          GO TO MR150.
007330     IF AM-KEY NOT = HACCNTCD2
007340        GO TO MR150.
007350     IF W-02T < HTRDATE2
007360        GO TO MR150.
007370     IF W-02F > HTRDATE2
007380        PERFORM SET-RTN THRU SET-EX
007390        PERFORM ADD-RTN THRU ADD-EX
007400        GO TO MR140.
007410     MOVE HTRDATE2     TO ZYMD.
007420     PERFORM Z-RTN THRU Z-EXT.
007430     PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX.
007440     GO TO MR170.
007450 MR150.
007460     IF ERR-SW = 0
007470        PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX
007480        WRITE P-R FROM YOKO AFTER 1
007490        MOVE SPACE     TO P-R
007500        PERFORM TOT2-RTN THRU TOT2-EX.
007510     GO TO MR100.
007520 MR160.
007530     READ SDH NEXT UNLOCK AT END
007540          GO TO MR180.
007550     IF AM-KEY NOT = HACCNTCD2
007560        GO TO MR180.
007570     IF W-02T < HTRDATE2
007580        GO TO MR180.
007590     MOVE HTRDATE2     TO ZYMD.
007600     PERFORM Z-RTN THRU Z-EXT.
007610     IF ZI NOT = OZI
007620        PERFORM TOT1-RTN THRU TOT1-EX.
007630 MR170.
007640     PERFORM PRI-RTN THRU PRI-EX.
007650     PERFORM ADD-RTN THRU ADD-EX.
007660     MOVE HTRDATE2     TO OHTRDATE2.
007670     MOVE HJUNLNO2     TO OHJUNLNO2.
007680     MOVE ZI           TO OZI.
007690     GO TO MR160.
007700 MR180.
007710     PERFORM TOT1-RTN THRU TOT1-EX.
007720     PERFORM TOT2-RTN THRU TOT2-EX.
007730     MOVE ZERO     TO OLD-KEY.
007740     GO TO MR100.
007750 MR900.
007760     PERFORM CLSE-ENT THRU CLSE-EXT.
007770 MR999.
007780     STOP RUN.
007790************************
007800 INI-RTN.
007810     MOVE 0     TO ERR-SW.
007820     OPEN INPUT FCTL-F.
007830     MOVE "DATE  "     TO FCTL-KEY1 ERR-K.
007840     READ FCTL-F UNLOCK INVALID KEY
007850          MOVE "FCTL-F"     TO ERR-F
007860          MOVE "G"          TO ERR-M
007870          DISPLAY ERR-DIS
007880          DISPLAY DISP-BUZ-B
007890          CLOSE FCTL-F
007900          MOVE 1     TO ERR-SW
007910          GO TO INI-EX.
007920     MOVE FCTL-REC1     TO Z-R.
007930     CLOSE FCTL-F.
007940*
007950     PERFORM OPEN-RTN THRU OPEN-EX.
007960     COPY LIBCPR.                                                 I.971113
007970*
007980     DISPLAY DISP-C.
007990     DISPLAY DSP-AREA.
008000*
008010     ACCEPT SYSDATE     FROM DATE.
008020*****MOVE SYS-YY     TO WK-ZZ.                                    D.971113
008030*****MOVE WK-ZZ      TO M1-YY.                                    D.971113
008040     MOVE SYS-YY     TO M1-YY.                                    I.971113
008050     MOVE SYS-MM     TO WK-ZZ.
008060     MOVE WK-ZZ      TO M1-MM.
008070     MOVE SYS-DD     TO WK-ZZ.
008080     MOVE WK-ZZ      TO M1-DD.
008090***
008100     MOVE Z-TOUT(Z-KSMM)     TO TO-YMD.
008110     MOVE Z-TOUT(15)         TO TO-YMD1.
008120     MOVE Z-UPDYM            TO FROM-YM.
008130     MOVE 01                 TO FROM-D.
008140     MOVE 1     TO I.
008150 INI-000.
008160     IF (Z-TOUF(I) NOT > FROM-YMD) AND
008170        (Z-TOUT(I) NOT < FROM-YMD)
008180        GO TO INI-100.
008190     IF I NOT = 15
008200        ADD 1     TO I
008210        GO TO INI-000.
008220     IF Z-KSMM = 12
008230        MOVE 1     TO I
008240     ELSE
008250        COMPUTE I = Z-KSMM + 1.
008260     MOVE Z-TOUF(I)              TO FROM-YMD.
008270     GO TO INI-EX.
008280 INI-100.
008290     IF I = Z-KSMM
008300        MOVE 13     TO I
008310     ELSE
008320        IF I = 12
008330           MOVE 1     TO I
008340        ELSE
008350           ADD 1     TO I.
008360     IF I > 15
008370        DISPLAY MG-01
008380                DISP-BUZ-B
008390        MOVE 1     TO ERR-SW
008400        GO TO INI-EX.
008410     MOVE Z-TOUF(I)     TO FROM-YMD.
008420 INI-EX.
008430     EXIT.
008440*********
008450 OPEN-RTN.
008460*****OPEN INPUT  KNG AM KZM-F SDH TK.                             D.980224
008470     OPEN INPUT  KNG AM KZM-F SDH.                                I.980224
008480     OPEN OUTPUT P-F.
008490 OPEN-EX.
008500     EXIT.
008510*********
008520*W01F-RTN.                                                        D.950522
008530*****ACCEPT ACP-W01F.                                             D.950522
008540*****DISPLAY DISP-MSG-SPACE.                                      D.950522
008550*****IF ESTAT = "P9"                                              D.950522
008560*****   GO TO W01F-EX.                                            D.950522
008570*****IF ESTAT NOT = "01" AND "06"                                 D.950522
008580*****   GO TO W01F-RTN.                                           D.950522
008590*W01F-EX.                                                         D.950522
008600*****EXIT.                                                        D.950522
008610*********
008620*W01T-RTN.                                                        D.950522
008630*****ACCEPT ACP-W01T.                                             D.950522
008640*****DISPLAY DISP-MSG-SPACE.                                      D.950522
008650*****IF ESTAT = "09"                                              D.950522
008660*****   GO TO W01T-EX.                                            D.950522
008670*****IF ESTAT NOT = "01" AND "06"                                 D.950522
008680*****   GO TO W01T-RTN.                                           D.950522
008690*****IF W-01F > W-01T                                             D.950522
008700*****   DISPLAY ERR-01                                            D.950522
008710*****   GO TO W01T-RTN.                                           D.950522
008720*W01T-EX.                                                         D.950522
008730*****EXIT.                                                        D.950522
008740 W10-RTN.                                                         I.950522
008750     ACCEPT ACP-W11F.                                             I.950522
008760     DISPLAY DISP-MSG-SPACE.                                      I.950522
008770     IF ESTAT = "P9"                                              I.950522
008780        GO TO W10-EX.                                             I.950522
008790     IF ESTAT NOT = "01" AND "06"                                 I.950522
008800        GO TO W10-RTN.                                            I.950522
008810 W10-010.                                                         I.950522
008820     ACCEPT ACP-W11T.                                             I.950522
008830     DISPLAY DISP-MSG-SPACE.                                      I.950522
008840     IF ESTAT = "09"                                              I.950522
008850        GO TO W10-RTN.                                            I.950522
008860     IF ESTAT NOT = "01" AND "06"                                 I.950522
008870        GO TO W10-010.                                            I.950522
008880     IF W-11F > W-11T                                             I.950522
008890        DISPLAY ERR-01                                            I.950522
008900        GO TO W10-010.                                            I.950522
008910 W10-020.                                                         I.950522
008920     ACCEPT ACP-W12F.                                             I.950522
008930     DISPLAY DISP-MSG-SPACE.                                      I.950522
008940     IF ESTAT = "09"                                              I.950522
008950        GO TO W10-010.                                            I.950522
008960     IF ESTAT NOT = "01" AND "06"                                 I.950522
008970        GO TO W10-020.                                            I.950522
008980     IF W-12F = ZERO                                              I.950522
008990        MOVE ZERO TO W-12T W-13F W-13T W-14F W-14T W-15F W-15T    I.950522
009000                                                   W-16F W-16T    I.950522
009010        DISPLAY SP-08 SP-10 SP-12 SP-14 SP-16                     I.950522
009020        GO TO W10-EX.                                             I.950522
009030     IF W-11T > W-12F                                             I.950522
009040        DISPLAY ERR-01                                            I.950522
009050        GO TO W10-020.                                            I.950522
009060 W10-030.                                                         I.950522
009070     ACCEPT ACP-W12T.                                             I.950522
009080     DISPLAY DISP-MSG-SPACE.                                      I.950522
009090     IF ESTAT = "09"                                              I.950522
009100        GO TO W10-020.                                            I.950522
009110     IF ESTAT NOT = "01" AND "06"                                 I.950522
009120        GO TO W10-030.                                            I.950522
009130     IF W-12F > W-12T                                             I.950522
009140        DISPLAY ERR-01                                            I.950522
009150        GO TO W10-030.                                            I.950522
009160 W10-040.                                                         I.950522
009170     ACCEPT ACP-W13F.                                             I.950522
009180     DISPLAY DISP-MSG-SPACE.                                      I.950522
009190     IF ESTAT = "09"                                              I.950522
009200        GO TO W10-030.                                            I.950522
009210     IF ESTAT NOT = "01" AND "06"                                 I.950522
009220        GO TO W10-040.                                            I.950522
009230     IF W-13F = ZERO                                              I.950522
009240        MOVE ZERO TO W-13T W-14F W-14T W-15F W-15T W-16F W-16T    I.950522
009250        DISPLAY SP-10 SP-12 SP-14 SP-16                           I.950522
009260        GO TO W10-EX.                                             I.950522
009270     IF W-12T > W-13F                                             I.950522
009280        DISPLAY ERR-01                                            I.950522
009290        GO TO W10-040.                                            I.950522
009300 W10-050.                                                         I.950522
009310     ACCEPT ACP-W13T.                                             I.950522
009320     DISPLAY DISP-MSG-SPACE.                                      I.950522
009330     IF ESTAT = "09"                                              I.950522
009340        GO TO W10-040.                                            I.950522
009350     IF ESTAT NOT = "01" AND "06"                                 I.950522
009360        GO TO W10-050.                                            I.950522
009370     IF W-13F > W-13T                                             I.950522
009380        DISPLAY ERR-01                                            I.950522
009390        GO TO W10-050.                                            I.950522
009400 W10-060.                                                         I.950522
009410     ACCEPT ACP-W14F.                                             I.950522
009420     DISPLAY DISP-MSG-SPACE.                                      I.950522
009430     IF ESTAT = "09"                                              I.950522
009440        GO TO W10-050.                                            I.950522
009450     IF ESTAT NOT = "01" AND "06"                                 I.950522
009460        GO TO W10-060.                                            I.950522
009470     IF W-14F = ZERO                                              I.950522
009480        MOVE ZERO TO W-14T W-15F W-15T W-16F W-16T                I.950522
009490        DISPLAY SP-12 SP-14 SP-16                                 I.950522
009500        GO TO W10-EX.                                             I.950522
009510     IF W-13T > W-14F                                             I.950522
009520        DISPLAY ERR-01                                            I.950522
009530        GO TO W10-060.                                            I.950522
009540 W10-070.                                                         I.950522
009550     ACCEPT ACP-W14T.                                             I.950522
009560     DISPLAY DISP-MSG-SPACE.                                      I.950522
009570     IF ESTAT = "09"                                              I.950522
009580        GO TO W10-060.                                            I.950522
009590     IF ESTAT NOT = "01" AND "06"                                 I.950522
009600        GO TO W10-070.                                            I.950522
009610     IF W-14F > W-14T                                             I.950522
009620        DISPLAY ERR-01                                            I.950522
009630        GO TO W10-070.                                            I.950522
009640 W10-080.                                                         I.950522
009650     ACCEPT ACP-W15F.                                             I.950522
009660     DISPLAY DISP-MSG-SPACE.                                      I.950522
009670     IF ESTAT = "09"                                              I.950522
009680        GO TO W10-070.                                            I.950522
009690     IF ESTAT NOT = "01" AND "06"                                 I.950522
009700        GO TO W10-080.                                            I.950522
009710     IF W-15F = ZERO                                              I.950522
009720        MOVE ZERO TO W-15T W-16F W-16T                            I.950522
009730        DISPLAY SP-14 SP-16                                       I.950522
009740        GO TO W10-EX.                                             I.950522
009750     IF W-14T > W-15F                                             I.950522
009760        DISPLAY ERR-01                                            I.950522
009770        GO TO W10-080.                                            I.950522
009780 W10-090.                                                         I.950522
009790     ACCEPT ACP-W15T.                                             I.950522
009800     DISPLAY DISP-MSG-SPACE.                                      I.950522
009810     IF ESTAT = "09"                                              I.950522
009820        GO TO W10-080.                                            I.950522
009830     IF ESTAT NOT = "01" AND "06"                                 I.950522
009840        GO TO W10-090.                                            I.950522
009850     IF W-15F > W-15T                                             I.950522
009860        DISPLAY ERR-01                                            I.950522
009870        GO TO W10-090.                                            I.950522
009880 W10-100.                                                         I.950522
009890     ACCEPT ACP-W16F.                                             I.950522
009900     DISPLAY DISP-MSG-SPACE.                                      I.950522
009910     IF ESTAT = "09"                                              I.950522
009920        GO TO W10-090.                                            I.950522
009930     IF ESTAT NOT = "01" AND "06"                                 I.950522
009940        GO TO W10-100.                                            I.950522
009950     IF W-16F = ZERO                                              I.950522
009960        MOVE ZERO TO W-16T W-17F W-17T                            I.020628
009970        DISPLAY SP-16 SP-18                                       I.020628
009980*****   MOVE ZERO TO W-16T                                        D.020628
009990*****   DISPLAY SP-16                                             D.020628
010000        GO TO W10-EX.                                             I.950522
010010     IF W-15T > W-16F                                             I.950522
010020        DISPLAY ERR-01                                            I.950522
010030        GO TO W10-100.                                            I.950522
010040 W10-110.                                                         I.950522
010050     ACCEPT ACP-W16T.                                             I.950522
010060     DISPLAY DISP-MSG-SPACE.                                      I.950522
010070     IF ESTAT = "09"                                              I.950522
010080        GO TO W10-100.                                            I.950522
010090     IF ESTAT NOT = "01" AND "06"                                 I.950522
010100        GO TO W10-110.                                            I.950522
010110     IF W-16F > W-16T                                             I.950522
010120        DISPLAY ERR-01                                            I.950522
010130        GO TO W10-110.                                            I.950522
010140 W10-120.                                                         I.020628
010150     ACCEPT ACP-W17F.                                             I.020628
010160     DISPLAY DISP-MSG-SPACE.                                      I.020628
010170     IF ESTAT = "09"                                              I.020628
010180        GO TO W10-110.                                            I.020628
010190     IF ESTAT NOT = "01" AND "06"                                 I.020628
010200        GO TO W10-120.                                            I.020628
010210     IF W-17F = ZERO                                              I.020628
010220        MOVE ZERO TO W-17T                                        I.020628
010230        DISPLAY SP-18                                             I.020628
010240        GO TO W10-EX.                                             I.020628
010250     IF W-16T > W-17F                                             I.020628
010260        DISPLAY ERR-01                                            I.020628
010270        GO TO W10-120.                                            I.020628
010280 W10-130.                                                         I.020628
010290     ACCEPT ACP-W17T.                                             I.020628
010300     DISPLAY DISP-MSG-SPACE.                                      I.020628
010310     IF ESTAT = "09"                                              I.020628
010320        GO TO W10-120.                                            I.020628
010330     IF ESTAT NOT = "01" AND "06"                                 I.020628
010340        GO TO W10-130.                                            I.020628
010350     IF W-17F > W-17T                                             I.020628
010360        DISPLAY ERR-01                                            I.020628
010370        GO TO W10-130.                                            I.020628
010380 W10-EX.                                                          I.950522
010390     EXIT.                                                        I.950522
010400*********
010410 W02F-RTN.
010420     ACCEPT ACP-W02F.
010430     DISPLAY DISP-MSG-SPACE.
010440     IF ESTAT = "09"
010450        GO TO W02F-EX.
010460     IF ESTAT NOT = "01" AND "06"
010470        GO TO W02F-RTN.
010480     MOVE ZERO TO W-02FY1.                                        I.971113
010490     IF W-02F = ZERO
010500        MOVE FROM-YMD     TO W-02F
010510        DISPLAY ACP-W02F                                          I.971113
010520        GO TO W02F-050.                                           I.971113
010530     IF W-02FY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
010540         ADD DATE-NC1 TO W-02FY.                                  I.971113
010550     IF W-02FY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
010560         ADD DATE-NC2 TO W-02FY.                                  I.971113
010570*****   DISPLAY ACP-W02F.                                         D.971113
010580 W02F-050.                                                        I.971113
010590     IF W-02F < FROM-YMD OR > TO-YMD1
010600        DISPLAY MG-01
010610        GO TO W02F-RTN.
010620*W02F-000.                                                        D.971113
010630     MOVE 1     TO I.
010640 W02F-100.
010650     IF (Z-TOUF(I) NOT > W-02F) AND
010660        (Z-TOUT(I) NOT < W-02F)
010670        NEXT SENTENCE
010680     ELSE
010690        IF I NOT = 15
010700           ADD 1     TO I
010710           GO TO W02F-100
010720        ELSE
010730           DISPLAY ERR-01
010740           GO TO W02F-RTN.
010750     MOVE I     TO TI.
010760*
010770     IF Z-KSMM = 12
010780        MOVE 1     TO FI
010790     ELSE
010800        COMPUTE FI = Z-KSMM + 1.
010810     IF TI > 12
010820        MOVE 13     TO FI.
010830 W02F-EX.
010840     EXIT.
010850*********
010860 W02T-RTN.
010870     ACCEPT ACP-W02T.
010880     DISPLAY DISP-MSG-SPACE.
010890     IF ESTAT = "09"
010900        GO TO W02T-EX.
010910     IF ESTAT NOT = "01" AND "06"
010920        GO TO W02T-RTN.
010930*****IF W-02T = 999999                                            D.971113
010940     MOVE ZERO TO W-02TY1.                                        I.971113
010950     IF W-02TS = 999999                                           I.971113
010960        IF TI < 13
010970           MOVE TO-YMD     TO W-02T
010980         ELSE                                                     I.971113
010990           MOVE TO-YMD1    TO W-02T.                              I.971113
011000     IF W-02T = TO-YMD OR TO-YMD1                                 I.971113
011010         DISPLAY ACP-W02T                                         I.971113
011020         GO TO W02T-100.                                          I.971113
011030*****      DISPLAY ACP-W02T.                                      D.971113
011040*****IF W-02T = 999999                                            D.971113
011050*****   IF TI > 12                                                D.971113
011060*****      MOVE TO-YMD1    TO W-02T                               D.971113
011070*****      DISPLAY ACP-W02T.                                      D.971113
011080     IF W-02TY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
011090         ADD DATE-NC1 TO W-02TY.                                  I.971113
011100     IF W-02TY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
011110         ADD DATE-NC2 TO W-02TY.                                  I.971113
011120 W02T-100.                                                        I.971113
011130     IF TI < 13
011140        IF W-02T > TO-YMD
011150           DISPLAY MG-01
011160           GO TO W02T-RTN.
011170     IF TI > 12
011180        IF W-02T > TO-YMD1
011190           DISPLAY MG-01
011200           GO TO W02T-RTN.
011210     IF W-02F > W-02T
011220        DISPLAY ERR-01
011230        GO TO W02T-RTN.
011240 W02T-EX.
011250     EXIT.
011260*********
011270 WOKC-RTN.
011280     ACCEPT ACP-WOKC.
011290     DISPLAY DISP-MSG-SPACE.
011300     IF ESTAT = "09"
011310        GO TO WOKC-EX.
011320     IF ESTAT NOT = "01" AND "06"
011330        GO TO WOKC-RTN.
011340     IF W-OKC NOT = "1" AND "9"
011350        DISPLAY ERR-01
011360        GO TO WOKC-RTN.
011370 WOKC-EX.
011380     EXIT.
011390*********
011400 KZMG-RTN.
011410     MOVE 0          TO INV-SW.
011420     MOVE AM-KEY     TO KZM-KEY.
011430     READ KZM-F UNLOCK INVALID KEY
011440          MOVE 1     TO INV-SW.
011450 KZMG-EX.
011460     EXIT.
011470*********
011480 ZAN-SET-RTN.
011490     IF TI > 12     GO TO ZAN-SET-500.
011500     MOVE FI     TO I.
011510 ZAN-SET-000.
011520     ADD KZM-TJKR(I)     TO W-KARI TOT-KR(3).
011530     ADD KZM-TJKS(I)     TO W-KASI TOT-KS(3).
011540     IF I = TI
011550        SUBTRACT KZM-TJKR(I)     FROM TOT-KR(3)
011560        SUBTRACT KZM-TJKS(I)     FROM TOT-KS(3)
011570        GO TO ZAN-SET-900.
011580     IF I = 12
011590        MOVE 1     TO I
011600        GO TO ZAN-SET-000.
011610     ADD 1     TO I.
011620     GO TO ZAN-SET-000.
011630 ZAN-SET-500.
011640     IF BS-PL = 0
011650        MOVE 1      TO I
011660     ELSE
011670        MOVE 13     TO I.
011680 ZAN-SET-600.
011690*****ADD KZM-TJKR(I)     TO W-KARI.                               D.930804
011700*****ADD KZM-TJKS(I)     TO W-KASI.                               D.930804
011710     ADD KZM-TJKR(I)     TO W-KARI TOT-KR(3).                     I.930804
011720     ADD KZM-TJKS(I)     TO W-KASI TOT-KS(3).                     I.930804
011730     IF I = 12
011740        IF DR-CR = 1
011750           COMPUTE W-ZENKI = KZM-ZAN + W-KARI - W-KASI
011760        ELSE
011770           COMPUTE W-ZENKI = KZM-ZAN + W-KASI - W-KARI.
011780     IF I = 12                                                    I.930804
011790        MOVE W-ZENKI     TO KZM-ZAN                               I.930804
011800        MOVE ZERO        TO W-KARI W-KASI TOT-ITEM(3).            I.930804
011810*****IF BS-PL = 1                                                 D.930804
011820*****   IF I > 12                                                 D.930804
011830*****      ADD KZM-TJKR(I)     TO TOT-KR(3)                       D.930804
011840*****      ADD KZM-TJKS(I)     TO TOT-KS(3).                      D.930804
011850     IF I = TI
011860        SUBTRACT KZM-TJKR(I)     FROM TOT-KR(3)
011870        SUBTRACT KZM-TJKS(I)     FROM TOT-KS(3)
011880        GO TO ZAN-SET-900.
011890     IF I = 15
011900        GO TO ZAN-SET-900.
011910     ADD 1     TO I.
011920     GO TO ZAN-SET-600.
011930 ZAN-SET-900.
011940     IF DR-CR = 1
011950        COMPUTE W-ZAN = KZM-ZAN + (W-KARI - KZM-TJKR(TI)) -
011960                                  ( W-KASI - KZM-TJKS(TI))
011970     ELSE
011980        COMPUTE W-ZAN = KZM-ZAN + (W-KASI - KZM-TJKS(TI)) -
011990                                  ( W-KARI - KZM-TJKR(TI)).
012000 ZAN-SET-EX.
012010     EXIT.
012020*********
012030 SET-RTN.
012040     IF DR-CR = HDR-CR2
012050        COMPUTE W-ZAN = W-ZAN + HAMOUNT
012060     ELSE
012070        COMPUTE W-ZAN = W-ZAN - HAMOUNT.
012080 SET-EX.
012090     EXIT.
012100*********
012110 ZAN-OUT-RTN.
012120     PERFORM MID-RTN THRU MID-EX.
012130*                                                                 ëOéc
012140     MOVE TATEP1           TO P-R.
012150     MOVE K15              TO P1-K15.
012160     MOVE SPACE            TO P1-04.
012170     MOVE W-ZAN            TO P1-08.
012180     MOVE NC"ëOì˙écçÇ"     TO P1-09.
012190     WRITE P-R AFTER 1.
012200     MOVE SPACE     TO P-R.
012210 ZAN-OUT-EX.
012220     EXIT.
012230*********
012240 PRI-RTN.
012250     IF LINAGE-COUNTER > 60
012260        PERFORM MID-RTN THRU MID-EX                               C.920131
012270         MOVE TATEP1       TO P-R                                 I.920131
012280         MOVE K15          TO P1-K15                              I.920131
012290         MOVE K20          TO P1-K20                              I.920131
012300         MOVE HTRDATE2     TO WK-YMD                              I.920131
012310         GO   TO   PRI-000.                                       I.920131
012320*                                                                 ñæç◊ÇP
012330     MOVE TATEP1       TO P-R.
012340     MOVE K15          TO P1-K15.
012350     MOVE K20          TO P1-K20.
012360     MOVE HTRDATE2     TO WK-YMD.
012370     IF HTRDATE2 = OHTRDATE2
012380        GO TO PRI-030.
012390     IF WK-YY NOT = OHTRDATE2YY
012400        GO TO PRI-000.
012410     IF WK-MM NOT = OHTRDATE2MM
012420        GO TO PRI-010.
012430     IF WK-DD NOT = OHTRDATE2DD
012440        GO TO PRI-020.
012450 PRI-000.
012460*****MOVE WK-YY    TO P1-01Y.                                     D.971113
012470     MOVE WK-YY2   TO P1-01Y.                                     I.971113
012480     MOVE "."      TO P1-01YH.
012490 PRI-010.
012500     MOVE WK-MM    TO P1-01M.
012510     MOVE "."      TO P1-01MH.
012520 PRI-020.
012530     MOVE WK-DD    TO P1-01D.
012540     GO TO PRI-040.
012550 PRI-030.
012560     IF HJUNLNO2 = OHJUNLNO2
012570        GO TO PRI-050.
012580 PRI-040.
012590     MOVE HJUNLNO2   TO P1-02.
012600     MOVE "-"        TO P1-02H.
012610 PRI-050.
012620     MOVE HLINENO2   TO P1-03.
012630     IF HCUSTCD = ZERO                                            *C910513
012640        MOVE SPACE       TO P1-04                                 *C910513
012650     ELSE
012660        MOVE HNAMEN      TO P1-04.                                I.980224
012670*****   MOVE HCUSTCD     TO TK-KEY                                D.980224
012680*****   PERFORM TKG-RTN THRU TKG-EX                               D.980224
012690*****   MOVE TK-NAMEN    TO P1-04.                                D.980224
012700*****IF HCUSTCD NOT = ZERO                                        D.960227
012710     IF HSECTCD NOT = ZERO                                        I.960227
012720        MOVE "("        TO P1-05F
012730*****   MOVE HCUSTCD    TO P1-05                                  D.960227
012740        MOVE HSECTCD    TO P1-05                                  I.960227
012750        MOVE ")"        TO P1-05T.
012760     IF HDR-CR2 = 1
012770        MOVE HAMOUNT     TO P1-06
012780     ELSE
012790        MOVE HAMOUNT     TO P1-07.
012800     PERFORM SET-RTN THRU SET-EX.
012810     MOVE W-ZAN      TO P1-08.
012820*****MOVE HTEKIYO    TO P1-09.                                    D.960122
012830     IF (HACCNTCD2 NOT = 0400) OR (HJUNLNO2 < 300000 OR > 399999) I.960122
012840        MOVE HTEKIYO    TO P1-09                                  I.960122
012850        GO  TO  PRI-090.                                          I.960122
012860     MOVE HTEKIYO    TO W-TEKIYO.                                 I.960122
012870     IF HOPPCD > 5999 AND < 7000                                  I.960122
012880        MOVE NC"êª" TO W-TEKIYO2.                                 I.960122
012890     IF HOPPCD > 6999 AND < 8000                                  I.960122
012900        MOVE NC"àÍ" TO W-TEKIYO2.                                 I.960122
012910     MOVE W-TEKIYO   TO P1-09.                                    I.960122
012920 PRI-090.                                                         I.960122
012930*****IF HTAXKB NOT = SPACE                                        D.970218
012940     IF HTAXKB     = "1" OR "5"                                   I.970218
012950        MOVE "*"       TO P1-10.
012960     IF HTAXKB     = "3" OR "7"                                   I.970218
012970        MOVE "#"       TO P1-10.                                  I.970218
012980     IF HTAXKB     = " "                                          I.970729
012990         IF HETAX    = "1" OR "5"                                 I.970729
013000            MOVE "*"       TO P1-10.                              I.970729
013010     IF HTAXKB     = " "                                          I.970729
013020         IF HETAX    = "3" OR "7"                                 I.970218
013030            MOVE "#"       TO P1-10.                              I.970218
013040     WRITE P-R AFTER 1.
013050     MOVE SPACE     TO P-R.
013060 PRI-EX.
013070     EXIT.
013080***
013090 ADD-RTN.
013100     IF HDR-CR2 = 1
013110        ADD HAMOUNT     TO TOT-KR(2) TOT-KR(3)
013120     ELSE
013130        ADD HAMOUNT     TO TOT-KS(2) TOT-KS(3).
013140 ADD-EX.
013150     EXIT.
013160***
013170 MID-RTN.
013180     IF PCNT NOT = ZERO
013190        WRITE P-R AFTER PAGE.
013200     ADD 1     TO PCNT.
013210     MOVE PCNT     TO WK-ZZZZZ.
013220     MOVE WK-ZZZZZ     TO M1-PCNT.
013230     WRITE P-R FROM MID03 AFTER 2.
013240     WRITE P-R FROM MID04 AFTER 1.
013250     WRITE P-R FROM MID05 AFTER 1.
013260     WRITE P-R FROM MID06 AFTER 1.
013270     WRITE P-R FROM MID07 AFTER 1.
013280     WRITE P-R FROM MID08 AFTER 1.
013290     WRITE P-R FROM MID09 AFTER 1.
013300     MOVE TATEP1     TO P-R.
013310     MOVE K15        TO P1-K15.
013320     MOVE K20        TO P1-K20.
013330     MOVE SPACE      TO P1-04 P1-09.
013340     WRITE P-R AFTER 1.
013350     MOVE SPACE     TO P-R.
013360 MID-EX.
013370     EXIT.
013380***
013390 TOT1-RTN.
013400     IF PCNT = ZERO
013410        GO TO TOT1-EX.
013420     IF LINAGE-COUNTER > 60
013430        PERFORM MID-RTN THRU MID-EX.
013440     MOVE TOT-ITEM(2)     TO TOT-ITEM(1).
013450     MOVE TATEP1     TO P-R.
013460     MOVE K15        TO P1-K15.
013470     MOVE K20        TO P1-K20.
013480     MOVE NC"ìñÅ@åéÅ@çáÅ@åv"     TO P1-04.
013490     MOVE SPACE      TO P1-09.
013500     PERFORM OUT-RTN THRU OUT-EX.
013510     WRITE P-R FROM YOKO AFTER 1.
013520     MOVE SPACE     TO P-R.
013530     MOVE ZERO     TO TOT-KR(2) TOT-KS(2).
013540 TOT1-EX.
013550     EXIT.
013560***
013570 TOT2-RTN.
013580     IF PCNT = ZERO
013590        GO TO TOT2-EX.
013600     PERFORM SPO-RTN THRU SPO-EX.
013610*
013620     MOVE TOT-ITEM(3)     TO TOT-ITEM(1).
013630     MOVE TATEP2     TO P-R.
013640     MOVE K15        TO P2-K15.
013650     MOVE K20        TO P2-K20.
013660     MOVE NC"ìñÅ@ä˙Å@ó›Å@åv"     TO P2-04.
013670     MOVE NC"ëOä˙åJâz"           TO P2-09.
013680     MOVE W-ZENKI                TO P2-99.
013690     PERFORM OUT-RTN THRU OUT-EX.
013700     WRITE P-R FROM YOKO AFTER 1.
013710     MOVE SPACE     TO P-R.
013720*
013730     MOVE ZERO     TO TOT-KR(3) TOT-KS(3).
013740 TOT2-EX.
013750     EXIT.
013760***
013770 OUT-RTN.
013780     MOVE TOT-KR(1)     TO P1-06.
013790     MOVE TOT-KS(1)     TO P1-07.
013800     MOVE W-ZAN         TO P1-08.
013810     WRITE P-R AFTER 1.
013820     MOVE SPACE     TO P-R.
013830 OUT-EX.
013840     EXIT.
013850***
013860 SPO-RTN.
013870     MOVE TATEP1     TO P-R.
013880     MOVE K15        TO P1-K15.
013890     MOVE K20        TO P1-K20.
013900     MOVE SPACE      TO P1-04 P1-09.
013910     WRITE P-R AFTER 1.
013920     MOVE SPACE     TO P-R.
013930 SPO-EX.
013940     EXIT.
013950***
013960 KNGG-RTN.
013970     MOVE 0     TO INV-SW.
013980     READ KNG UNLOCK INVALID KEY
013990          MOVE 1         TO INV-SW
014000          MOVE SPACE     TO KNGNMN.
014010 KNGG-EX.
014020     EXIT.
014030***                                                               *A910513
014040*TKG-RTN.                                                         D.980224
014050*****MOVE 0     TO INV-SW.                                        D.980224
014060*****READ TK UNLOCK INVALID KEY                                   D.980224
014070*****     MOVE 1         TO INV-SW                                D.980224
014080*****     MOVE SPACE     TO TK-NAMEN.                             D.980224
014090*TKG-EX.                                                          D.980224
014100*****EXIT.                                                        D.980224
014110*********
014120 CLSE-ENT.
014130*****CLOSE KNG AM KZM-F SDH P-F TK.                               D.980224
014140     CLOSE KNG AM KZM-F SDH P-F.                                  I.980224
014150     DISPLAY DISP-C.
014160 CLSE-EXT.
014170     EXIT.
014180*********
014190 COPY LPMSG.
014200*********
