000010 IDENTIFICATION              DIVISION.
000020 PROGRAM-ID.                 PR440L.
000030 AUTHOR.                     OZAKI.
000040*===============================================================*
000050*    ä®íËâ»ñ⁄ï Å@ì˙åvï\                                         *
000060*                            --- 90/01/21 ---                   *
000070*===============================================================*
000080 ENVIRONMENT                DIVISION.
000090 CONFIGURATION              SECTION.
000100 SOURCE-COMPUTER.           NEAC-SYSTEM100.
000110 OBJECT-COMPUTER.           NEAC-SYSTEM100.
000120 INPUT-OUTPUT               SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.                                                 I.971113
000150     SELECT      KNG         ASSIGN  TO      F1-MSD               ∂›ºﬁ∂”∏
000160                             ORGANIZATION    INDEXED
000170                             ACCESS  MODE    RANDOM
000180                             RECORD  KEY     KNG-KEY.
000190     SELECT      AM          ASSIGN  TO      F2-MSD               ∂”∏
000200                             ORGANIZATION    INDEXED
000210                             ACCESS  MODE    DYNAMIC
000220                             RECORD  KEY     AM-KEY.
000230     SELECT      KZM-F       ASSIGN  TO      F3-MSD               ∂”∏ªﬁ›
000240                             ORGANIZATION    INDEXED
000250                             ACCESS  MODE    RANDOM
000260                             RECORD  KEY     KZM-KEY.
000270     SELECT      FCTL-F      ASSIGN  TO      F4-MSD               ∫›ƒ€∞Ÿ
000280                             ORGANIZATION    INDEXED
000290                             ACCESS  MODE    RANDOM
000300                             RECORD  KEY     FCTL-KEY.
000310     SELECT      SDH         ASSIGN  TO      F5-MSD               º‹πÀΩƒÿ
000320                             ORGANIZATION    INDEXED
000330                             ACCESS  MODE    DYNAMIC
000340                             RECORD  KEY     SH-KEY2.
000350*****SELECT      TK          ASSIGN  TO      F6-MSD               D.950126
000360*****                        ORGANIZATION    INDEXED              D.950126
000370*****                        ACCESS  MODE    RANDOM               D.950126
000380*****                        RECORD  KEY     TK-KEY.              D.950126
000390     SELECT      P-F         ASSIGN  TO      P-PRN999.
000400 I-O-CONTROL.
000410*****APPLY SHARED-MODE ON KNG AM KZM-F FCTL-F SDH TK              D.950126
000420*****APPLY SHARED-MODE ON KNG AM KZM-F FCTL-F SDH                 D.971113
000430     APPLY SHARED-MODE ON M-DATE KNG AM KZM-F FCTL-F SDH          I.971113
000440     APPLY SHIFT-CODE  ON P-F.
000450*******
000460 DATA                        DIVISION.
000470 FILE                        SECTION.
000480     COPY LIBFDD.                                                 I.971113
000490 COPY KANGEL.
000500 COPY ACCUNT.
000510 COPY LKAZAN.
000520 COPY FCTL.
000530 FD  SDH
000540     BLOCK CONTAINS 3 RECORDS
000550     LABEL RECORD STANDARD
000560     VALUE OF IDENTIFICATION "SIWAKE-H2".
000570 COPY SIWAKH.
000580*COPY TKLIB.                                                      D.950126
000590**
000600 FD  P-F
000610     LABEL RECORD OMITTED
000620     LINAGE IS 66.
000630 01  P-R                 PIC X(200).
000640 01  P1-R.
000650     02  P1-K15          PIC X(05).
000660*****02  FILLER          PIC X(02).                               D.950126
000670     02  P1-T1           PIC X(02).                               I.950126
000680     02  FILLER          PIC X(01).
000690     02  P1-01.
000700*****  03  P1-01Y        PIC Z9.                                  D.971113
000710       03  P1-01Y        PIC 9(2).                                I.971113
000720       03  P1-01YH       PIC X(01).
000730       03  P1-01M        PIC Z9.
000740       03  P1-01MH       PIC X(01).
000750       03  P1-01D        PIC Z9.
000760     02  FILLER          PIC X(01).
000770*****02  FILLER          PIC X(02).                               D.950126
000780*****02  FILLER          PIC X(01).                               D.950126
000790*****02  P1-02           PIC 9(06).                               D.950126
000800*****02  P1-02H          PIC X(01).                               D.950126
000810*****02  P1-03           PIC 9(02).                               D.950126
000820*****02  FILLER          PIC X(01).                               D.950126
000830*****02  FILLER          PIC X(02).                               D.950126
000840*****02  FILLER          PIC X(01).                               D.950126
000850*****02  P1-04           PIC N(10).                               D.950126
000860*****02  FILLER          PIC X(01).                               D.950126
000870*****02  P1-05F          PIC X(01).                               D.950126
000880*****02  P1-05           PIC 9(05).                               D.950126
000890*****02  P1-05T          PIC X(01).                               D.950126
000900*****02  FILLER          PIC X(01).                               *D910513
000910*****02  FILLER          PIC X(02).                               D.950126
000920     02  P1-T2           PIC X(02).                               I.950126
000930     02  P1-06           PIC ----,---,---,--9.
000940     02  FILLER          PIC X(01).
000950*****02  FILLER          PIC X(02).                               D.950126
000960     02  P1-T3           PIC X(02).                               I.950126
000970     02  P1-07           PIC ----,---,---,--9.
000980     02  FILLER          PIC X(01).
000990*****02  FILLER          PIC X(02).                               D.950126
001000     02  P1-T4           PIC X(02).                               I.950126
001010     02  P1-08           PIC ----,---,---,--9.
001020     02  FILLER          PIC X(01).
001030     02  P1-T5           PIC X(02).                               I.950126
001040*****02  FILLER          PIC X(02).                               D.950126
001050*****02  FILLER          PIC X(01).                               D.950126
001060*****02  P1-09           PIC N(20).                               D.950126
001070*****02  FILLER          PIC X(01).                               D.950126
001080*****02  FILLER          PIC X(02).                               D.950126
001090*****02  FILLER          PIC X(02).                               D.950126
001100*****02  P1-10           PIC X(01).                               D.950126
001110*****02  FILLER          PIC X(01).                               D.950126
001120*****02  FILLER          PIC X(02).                               D.950126
001130     02  P1-K20          PIC X(05).
001140 01  P2-R.
001150     02  P2-K15          PIC X(05).
001160*****02  FILLER          PIC X(02).                               D.950126
001170*****02  FILLER          PIC X(10).                               D.950126
001180*****02  FILLER          PIC X(02).                               D.950126
001190*****02  FILLER          PIC X(11).                               D.950126
001200*****02  FILLER          PIC X(02).                               D.950126
001210*****02  FILLER          PIC X(01).                               D.950126
001220*****02  P2-04           PIC N(10).                               D.950126
001230*****02  FILLER          PIC X(08).                               D.950126
001240*****02  FILLER          PIC X(02).                               D.950126
001250     02  P2-T1           PIC X(02).                               I.950126
001260     02  FILLER          PIC X(01).                               I.950126
001270     02  P2-01           PIC N(06).                               I.950126
001280     02  P2-T2           PIC X(02).                               I.950126
001290     02  P2-06           PIC ----,---,---,--9.
001300     02  FILLER          PIC X(01).
001310*****02  FILLER          PIC X(02).                               D.950126
001320     02  P2-T3           PIC X(02).                               I.950126
001330     02  P2-07           PIC ----,---,---,--9.
001340     02  FILLER          PIC X(01).
001350*****02  FILLER          PIC X(02).                               D.950126
001360     02  P2-T4           PIC X(02).                               I.950126
001370     02  P2-08           PIC ----,---,---,--9.
001380     02  FILLER          PIC X(01).
001390     02  P2-T5           PIC X(02).                               I.950126
001400*****02  FILLER          PIC X(02).                               D.950126
001410*****02  FILLER          PIC X(01).                               D.950126
001420*****02  P2-09           PIC N(04).                               D.950126
001430*****02  FILLER          PIC X(08).                               D.950126
001440*****02  P2-99           PIC ----,---,---,--9.                    D.950126
001450*****02  FILLER          PIC X(01).                               D.950126
001460*****02  FILLER          PIC X(02).                               D.950126
001470*****02  FILLER          PIC X(04).                               D.950126
001480*****02  FILLER          PIC X(02).                               D.950126
001490     02  P2-K20          PIC X(05).
001500*****
001510 WORKING-STORAGE             SECTION.
001520 77  ERR-STAT            PIC  X(02).
001530 77  PCNT                PIC  9(05).
001540 77  PRINT-CNT           PIC  9(05).
001550 77  K20                 PIC  X(05) VALUE ""3FE04FE080"".
001560 77  K15                 PIC  X(05) VALUE ""3FE04F40A0"".
001570 77  WKZE                PIC  9(10) VALUE ZERO.
001580*77  WKSP                PIC  X(10) VALUE SPACE.                  D.950126
001590 77  WKSP                PIC  X(20) VALUE SPACE.                  I.950126
001600 77  WKNSP               PIC  N(20) VALUE SPACE.
001610 01  CRT-WK.
001620     02  W-01F           PIC  9(04).
001630     02  W-01T           PIC  9(04).
001640     02  W-02F.
001650*****  03  W-02FY        PIC  9(02).                              D.971113
001660       03  W-02FY        PIC  9(04).                              I.971113
001670       03  W-02FYL  REDEFINES W-02FY.                             I.971113
001680         04  W-02FY1     PIC  9(02).                              I.971113
001690         04  W-02FY2     PIC  9(02).                              I.971113
001700       03  W-02FM        PIC  9(02).
001710       03  W-02FD        PIC  9(02).
001720     02  W-02FR REDEFINES W-02F     PIC  9(08).                   I.971113
001730*****02  W-02FR REDEFINES W-02F     PIC  9(06).                   D.971113
001740     02  W-02T.
001750*****  03  W-02TY        PIC  9(02).                              D.971113
001760       03  W-02TY        PIC  9(04).                              I.971113
001770       03  W-02TYL  REDEFINES W-02TY.                             I.971113
001780         04  W-02TY1     PIC  9(02).                              I.971113
001790         04  W-02TY2     PIC  9(02).                              I.971113
001800       03  W-02TM        PIC  9(02).
001810       03  W-02TD        PIC  9(02).
001820     02  W-02TR REDEFINES W-02T     PIC  9(08).                   I.971113
001830     02  W-02TL REDEFINES W-02T.                                  I.971113
001840       03  F             PIC  X(02).                              I.971113
001850       03  W-02TS        PIC  9(06).                              I.971113
001860*****02  W-02TR REDEFINES W-02T     PIC  9(06).                   D.971113
001870     02  W-OKC           PIC  X(01).
001880 01  WORK-AREA.
001890     02  I               PIC  9(02).
001900     02  SOE             PIC  9(02).
001910     02  FI              PIC  9(02).
001920     02  TI              PIC  9(02).
001930     02  ERR-SW          PIC  9(01).
001940     02  INV-SW          PIC  9(01).
001950     02  W-ZENKI         PIC S9(11).
001960     02  W-ZAN           PIC S9(11).
001970     02  W-KASI          PIC S9(11).
001980     02  W-KARI          PIC S9(11).
001990**
002000     02  FROM-YMD.
002010       03  FROM-YM.
002020*****    04  FROM-Y      PIC  9(02).                              D.971113
002030         04  FROM-Y      PIC  9(04).                              I.971113
002040         04  FROM-M      PIC  9(02).
002050       03  FROM-D        PIC  9(02).
002060     02  TO-YMD.
002070       03  TO-YM.
002080*****    04  TO-Y        PIC  9(02).                              D.971113
002090         04  TO-Y        PIC  9(04).                              I.971113
002100         04  TO-M        PIC  9(02).
002110       03  TO-D          PIC  9(02).
002120     02  TO-YMD1.
002130       03  TO-YM1.
002140*****    04  TO-Y1       PIC  9(02).                              D.971113
002150         04  TO-Y1       PIC  9(04).                              I.971113
002160         04  TO-M1       PIC  9(02).
002170       03  TO-D1         PIC  9(02).
002180     02  W-YMD.
002190       03  W-Y           PIC  9(04).                              I.971113
002200       03  W-YL  REDEFINES W-Y.                                   I.971113
002210         04  W-Y1        PIC  9(02).                              I.971113
002220         04  W-Y2        PIC  9(02).                              I.971113
002230       03  W-M           PIC  9(02).                              I.971113
002240       03  W-D           PIC  9(02).                              I.971113
002250*****  03  W-Y           PIC  9(02).                              D.971113
002260*****  03  W-MD.                                                  D.971113
002270*****    04  W-M         PIC  9(02).                              D.971113
002280*****    04  W-D         PIC  9(02).                              D.971113
002290     02  SYSDATE.
002300       03  SYS-YY         PIC  9(02).
002310       03  SYS-MM         PIC  9(02).
002320       03  SYS-DD         PIC  9(02).
002330     02  WK-YMD.
002340*****  03  WK-YY         PIC  9(02).                              D.971113
002350       03  WK-YY         PIC  9(04).                              I.971113
002360       03  WK-YYL  REDEFINES WK-YY.                               I.971113
002370         04  WK-YY1      PIC  9(02).                              I.971113
002380         04  WK-YY2      PIC  9(02).                              I.971113
002390       03  WK-MM         PIC  9(02).
002400       03  WK-DD         PIC  9(02).
002410     02  WK-ZZ           PIC  Z9.
002420     02  WK-ZZZZZ        PIC  ZZZZ9.
002430     02  WK-9999         PIC  9(04).
002440     02  W-NGP.                                                   I.950126
002450*****  03  W-NEN         PIC  9(02).                              D.971113
002460       03  W-NEN         PIC  9(04).                              I.971113
002470       03  W-GET         PIC  9(02).                              I.950126
002480       03  W-PEY         PIC  9(02).                              I.950126
002490     02  W-NGPD.                                                  I.950126
002500*****  03  W-NEND        PIC  9(02).                              D.971113
002510       03  W-NEND        PIC  9(04).                              I.971113
002520       03  W-GETD        PIC  9(02).                              I.950126
002530       03  W-PEYD        PIC  9(02).                              I.950126
002540*01  OLD-KEY.                                                     D.950126
002550*****02  OHTRDATE2.                                               D.950126
002560*****  03  OHTRDATE2YY   PIC  9(02).                              D.950126
002570*****  03  OHTRDATE2MM   PIC  9(02).                              D.950126
002580*****  03  OHTRDATE2DD   PIC  9(02).                              D.950126
002590*****02  OHJUNLNO2       PIC  9(06).                              D.950126
002600     02  OZI             PIC  9(02).
002610 01  NTO-WK.                                                      I.950126
002620     02  NTO-KR          PIC S9(12).                              I.950126
002630     02  NTO-KS          PIC S9(12).                              I.950126
002640 01  TOT-WK.
002650     02  TOT-ITEM OCCURS 3.
002660       03  TOT-KR        PIC S9(12).
002670       03  TOT-KS        PIC S9(12).
002680***
002690 01  MID03.
002700     02  FILLER          PIC X(05) VALUE ""3FE04FE080"".
002710     02  FILLER          PIC X(02) VALUE SPACE.
002720     02  M1-YY           PIC N(02).
002730     02  FILLER          PIC N(01) VALUE NC"îN".
002740     02  M1-MM           PIC N(02).
002750     02  FILLER          PIC N(01) VALUE NC"åé".
002760     02  M1-DD           PIC N(02).
002770     02  FILLER          PIC N(03) VALUE NC"ì˙çÏê¨".
002780     02  FILLER          PIC X(23) VALUE SPACE.
002790     02  FILLER          PIC X(02) VALUE ""3F91"".
002800     02  FILLER          PIC X(02) VALUE SPACE.
002810     02  FILLER          PIC N(09)
002820         VALUE NC"ä®íËâ»ñ⁄ï Å@ì˙åvï\".
002830     02  FILLER          PIC X(02) VALUE SPACE.
002840     02  FILLER          PIC X(02) VALUE ""3F92"".
002850     02  FILLER          PIC X(49) VALUE SPACE.
002860     02  M1-PCNT         PIC N(05).
002870     02  FILLER          PIC N(01) VALUE NC"ï≈".
002880 01  MID04.
002890     02  FILLER          PIC X(02) VALUE ""3F91"".
002900     02  FILLER          PIC X(51) VALUE SPACE.
002910     02  FILLER          PIC X(02) VALUE ""3F92"".
002920 01  MID05.
002930     02  FILLER          PIC X(02) VALUE ""3F93"".
002940     02  FILLER          PIC X(10) VALUE SPACE.
002950     02  FILLER          PIC X(02) VALUE ""3F93"".
002960     02  FILLER          PIC X(35) VALUE SPACE.
002970     02  FILLER          PIC X(02) VALUE ""3F93"".
002980     02  FILLER          PIC X(06) VALUE SPACE.
002990     02  FILLER          PIC X(02) VALUE ""3F93"".
003000 01  MID06.
003010     02  FILLER          PIC X(02) VALUE ""3F93"".
003020     02  FILLER          PIC X(01) VALUE SPACE.
003030     02  FILLER          PIC N(04) VALUE NC"ä®íËâ»ñ⁄".
003040     02  FILLER          PIC X(01) VALUE SPACE.
003050     02  FILLER          PIC X(02) VALUE ""3F93"".
003060     02  FILLER          PIC X(01) VALUE SPACE.
003070     02  M6-01           PIC N(10).
003080     02  FILLER          PIC X(01) VALUE SPACE.
003090     02  FILLER          PIC N(01) VALUE NC"Åi".
003100     02  M6-02           PIC N(04).
003110     02  FILLER          PIC N(01) VALUE NC"Åj".
003120     02  FILLER          PIC X(01) VALUE SPACE.
003130     02  FILLER          PIC X(02) VALUE ""3F93"".
003140     02  FILLER          PIC X(01) VALUE SPACE.
003150     02  M6-03           PIC N(02).
003160     02  FILLER          PIC X(01) VALUE SPACE.
003170     02  FILLER          PIC X(02) VALUE ""3F93"".
003180     02  FILLER          PIC X(02) VALUE SPACE.
003190     02  FILLER          PIC N(03) VALUE NC"ÅiÅ@é©".
003200     02  FILLER          PIC X(01) VALUE SPACE.
003210     02  M6-YYF          PIC N(02).
003220     02  FILLER          PIC N(01) VALUE NC"îN".
003230     02  FILLER          PIC X(01) VALUE SPACE.
003240     02  M6-MMF          PIC N(02).
003250     02  FILLER          PIC N(01) VALUE NC"åé".
003260     02  FILLER          PIC X(01) VALUE SPACE.
003270     02  M6-DDF          PIC N(02).
003280     02  FILLER          PIC N(01) VALUE NC"ì˙".
003290     02  FILLER          PIC X(05) VALUE SPACE.
003300     02  FILLER          PIC N(01) VALUE NC"éä".
003310     02  FILLER          PIC X(01) VALUE SPACE.
003320     02  M6-YYT          PIC N(02).
003330     02  FILLER          PIC N(01) VALUE NC"îN".
003340     02  FILLER          PIC X(01) VALUE SPACE.
003350     02  M6-MMT          PIC N(02).
003360     02  FILLER          PIC N(01) VALUE NC"åé".
003370     02  FILLER          PIC X(01) VALUE SPACE.
003380     02  M6-DDT          PIC N(02).
003390     02  FILLER          PIC N(01) VALUE NC"ì˙".
003400     02  FILLER          PIC N(02) VALUE NC"Å@Åj".
003410 01  MID07.
003420     02  FILLER          PIC X(04) VALUE ""3F913F93"".
003430     02  FILLER          PIC X(10) VALUE SPACE.
003440     02  FILLER          PIC X(02) VALUE ""3F93"".
003450     02  FILLER          PIC X(35) VALUE SPACE.
003460     02  FILLER          PIC X(02) VALUE ""3F93"".
003470     02  FILLER          PIC X(06) VALUE SPACE.
003480     02  FILLER          PIC X(02) VALUE ""3F93"".
003490*****02  FILLER          PIC X(81) VALUE SPACE.                   D.950126
003500     02  FILLER          PIC X(10) VALUE SPACE.                   I.950126
003510     02  FILLER          PIC X(02) VALUE ""3F92"".
003520 01  MID08.
003530     02  FILLER          PIC X(02) VALUE ""3F93"".
003540     02  FILLER          PIC X(10) VALUE SPACE.
003550*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003560*****02  FILLER          PIC X(11) VALUE SPACE.                   D.950126
003570*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003580*****02  FILLER          PIC X(24) VALUE SPACE.                   D.950126
003590     02  FILLER          PIC X(02) VALUE ""3F93"".
003600     02  FILLER          PIC X(17) VALUE SPACE.
003610     02  FILLER          PIC X(02) VALUE ""3F93"".
003620     02  FILLER          PIC X(17) VALUE SPACE.
003630     02  FILLER          PIC X(02) VALUE ""3F93"".
003640     02  FILLER          PIC X(17) VALUE SPACE.
003650     02  FILLER          PIC X(02) VALUE ""3F93"".
003660*****02  FILLER          PIC X(32) VALUE SPACE.                   D.950126
003670*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003680*****02  FILLER          PIC X(04) VALUE SPACE.                   D.950126
003690*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003700 01  MID09.
003710     02  FILLER          PIC X(04) VALUE ""3F913F93"".
003720     02  FILLER          PIC X(01) VALUE SPACE.
003730     02  FILLER          PIC N(04) VALUE NC"ì˙Å@Å@ït".
003740     02  FILLER          PIC X(01) VALUE SPACE.
003750*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003760*****02  FILLER          PIC X(01) VALUE SPACE.                   D.950126
003770*****02  FILLER          PIC N(04) VALUE NC"ì`ï[î‘çÜ".            D.950126
003780*****02  FILLER          PIC X(02) VALUE SPACE.                   D.950126
003790*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003800*****02  FILLER          PIC X(01) VALUE SPACE.                   D.950126
003810*****02  FILLER          PIC N(07) VALUE NC"éÊÅ@à¯Å@êÊÅ@ñº".      D.950126
003820*****02  FILLER          PIC X(02) VALUE SPACE.                   D.950126
003830*****02  FILLER          PIC X(07) VALUE "(∫∞ƒﬁ )".               D.950126
003840     02  FILLER          PIC X(02) VALUE ""3F93"".
003850     02  FILLER          PIC X(01) VALUE SPACE.
003860     02  FILLER          PIC N(07) VALUE NC"éÿÅ@ï˚Å@ã‡Å@äz".
003870     02  FILLER          PIC X(02) VALUE SPACE.
003880     02  FILLER          PIC X(02) VALUE ""3F93"".
003890     02  FILLER          PIC X(01) VALUE SPACE.
003900     02  FILLER          PIC N(07) VALUE NC"ë›Å@ï˚Å@ã‡Å@äz".
003910     02  FILLER          PIC X(02) VALUE SPACE.
003920     02  FILLER          PIC X(02) VALUE ""3F93"".
003930     02  FILLER          PIC X(01) VALUE SPACE.
003940     02  FILLER          PIC N(07) VALUE NC"écÅ@çÇÅ@ã‡Å@äz".
003950     02  FILLER          PIC X(02) VALUE SPACE.
003960*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
003970*****02  FILLER          PIC X(09) VALUE SPACE.                   D.950126
003980*****02  FILLER          PIC N(07) VALUE NC"ìEÅ@Å@Å@Å@Å@óv".      D.950126
003990*****02  FILLER          PIC X(09) VALUE SPACE.                   D.950126
004000*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004010*****02  FILLER          PIC X(01) VALUE SPACE.                   D.950126
004020*****02  FILLER          PIC N(01) VALUE NC"ê≈".                  D.950126
004030*****02  FILLER          PIC X(01) VALUE SPACE.                   D.950126
004040     02  FILLER          PIC X(04) VALUE ""3F923F93"".
004050 01  YOKO.
004060     02  FILLER          PIC X(02) VALUE ""3F91"".                *
004070     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004080     02  FILLER          PIC X(10) VALUE SPACE.
004090*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004100*****02  FILLER          PIC X(11) VALUE SPACE.                   D.950126
004110*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004120*****02  FILLER          PIC X(24) VALUE SPACE.                   D.950126
004130     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004140     02  FILLER          PIC X(17) VALUE SPACE.
004150     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004160     02  FILLER          PIC X(17) VALUE SPACE.
004170     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004180     02  FILLER          PIC X(17) VALUE SPACE.
004190     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004200*****02  FILLER          PIC X(32) VALUE SPACE.                   D.950126
004210*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004220*****02  FILLER          PIC X(04) VALUE SPACE.                   D.950126
004230*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004240     02  FILLER          PIC X(02) VALUE ""3F92"".                *
004250 01  TATEP1.
004260     02  FILLER          PIC X(05) VALUE SPACE.
004270     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004280     02  FILLER          PIC X(10) VALUE SPACE.
004290*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004300*****02  FILLER          PIC X(11) VALUE SPACE.                   D.950126
004310*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004320*****02  FILLER          PIC X(29) VALUE SPACE.                   D.950126
004330     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004340     02  FILLER          PIC X(17) VALUE SPACE.
004350     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004360     02  FILLER          PIC X(17) VALUE SPACE.
004370     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004380     02  FILLER          PIC X(17) VALUE SPACE.
004390     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004400*****02  FILLER          PIC X(42) VALUE SPACE.                   D.950126
004410*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004420*****02  FILLER          PIC X(04) VALUE SPACE.                   D.950126
004430*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004440 01  TATEP2.
004450     02  FILLER          PIC X(05) VALUE SPACE.
004460     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004470     02  FILLER          PIC X(10) VALUE SPACE.
004480*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004490*****02  FILLER          PIC X(11) VALUE SPACE.                   D.950126
004500*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004510*****02  FILLER          PIC X(29) VALUE SPACE.                   D.950126
004520     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004530     02  FILLER          PIC X(17) VALUE SPACE.
004540     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004550     02  FILLER          PIC X(17) VALUE SPACE.
004560     02  FILLER          PIC X(02) VALUE ""3F93"".                *
004570     02  FILLER          PIC X(17) VALUE SPACE.
004580     02  FILLER          PIC X(02) VALUE ""3F93"".
004590*****02  FILLER          PIC X(34) VALUE SPACE.                   D.950126
004600*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004610*****02  FILLER          PIC X(04) VALUE SPACE.                   D.950126
004620*****02  FILLER          PIC X(02) VALUE ""3F93"".                D.950126
004630     02  FILLER          PIC X(05) VALUE SPACE.
004640*********
004650 COPY LWMSG.
004660*********
004670 SCREEN                  SECTION.
004680 SD  CRT-BF
004690     END  STATUS    IS   ESTAT.
004700 01  DISP-C   LINE 01.
004710     02  DISP-CLE  CLEAR SCREEN.
004720***
004730 01  ACP-AREA.
004740     02  ACP-W01F    LINE 06   COLUMN 31    PIC 9(04)
004750         USING W-01F                  CHECK OVERFLOW  NO IFC.
004760     02  ACP-W01T    LINE 06   COLUMN 51    PIC 9(04)
004770         USING W-01T                  CHECK OVERFLOW  NO IFC.
004780     02  ACP-W02F    LINE 08.
004790         03  ACP-W02FY         COLUMN 27    PIC 9(02)
004800             USING W-02FY2                            NO IFC.     I.971113
004810*****        USING W-02FY                             NO IFC.     D.971113
004820         03  ACP-W02FM         COLUMN 30    PIC 9(02)
004830             USING W-02FM                             NO IFC.
004840         03  ACP-W02FD         COLUMN 33    PIC 9(02)
004850             USING W-02FD             CHECK OVERFLOW  NO IFC.
004860     02  ACP-W02T    LINE 08.
004870         03  ACP-W02TY         COLUMN 47    PIC 9(02)
004880             USING W-02TY2                            NO IFC.     I.971113
004890*****        USING W-02TY                             NO IFC.     D.971113
004900         03  ACP-W02TM         COLUMN 50    PIC 9(02)
004910             USING W-02TM                             NO IFC.
004920         03  ACP-W02TD         COLUMN 53    PIC 9(02)
004930             USING W-02TD             CHECK OVERFLOW  NO IFC.
004940     02  ACP-WOKC    LINE 24   COLUMN 77    PIC X(01)
004950         USING W-OKC                  CHECK OVERFLOW  NO IFC.
004960***
004970 01  DSP-AREA.
004980     02  DSP-01      LINE 01.
004990         03      COLUMN  04  PIC  N(01)  VALUE  NC"îN".
005000         03      COLUMN  08  PIC  N(02)  VALUE  NC"åéìx".
005010         03      COLUMN  02  PIC  9(02)  FROM  W-Y2.              I.971113
005020         03      COLUMN  06  PIC  9(02)  FROM  W-M.               I.971113
005030*****    03      COLUMN  02  PIC  9(02)  FROM  Z-GEMYY.           D.971113
005040*****    03      COLUMN  06  PIC  9(02)  FROM  Z-GEMMM.           D.971113
005050*****    03  COLUMN 35    PIC X(12) FROM  WKSP REVERSE.           D.950126
005060*****    03  COLUMN 36    PIC N(05) VALUE NC"ëçä®íËå≥í†".         D.950126
005070         03  COLUMN 21    PIC X(20) FROM  WKSP REVERSE.           I.950126
005080         03  COLUMN 22    PIC N(09) VALUE NC"ä®íËâ»ñ⁄ï Å@ì˙åvï\". I.950126
005090     02  DSP-04      LINE 04.
005100         03  COLUMN 27    PIC N(04) VALUE NC"ÇeÇqÇnÇl".
005110         03  COLUMN 49    PIC N(02) VALUE NC"ÇsÇn".
005120     02  DSP-06      LINE 06.
005130         03  COLUMN 11    PIC N(05) VALUE NC"â»ñ⁄ÉRÅ[Éh".
005140         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
005150     02  DSP-08      LINE 08.
005160         03  COLUMN 11    PIC N(05) VALUE NC"ì˙Å@Å@Å@ït".
005170         03  COLUMN 40    PIC N(01) VALUE NC"Å`".
005180         03  COLUMN 29    PIC X(04) VALUE "/  /".
005190         03  COLUMN 49    PIC X(04) VALUE "/  /".
005200     02  DSP-24      LINE 24.
005210         03  COLUMN 61    PIC X(18) VALUE "ämîF OK=1,NO=9 ( )".
005220***
005230 01  MG-AREA.
005240     02  MG-01       LINE 24   COLUMN 02    PIC N(07)
005250         VALUE NC"ì˙ïtä˙ä‘ÉGÉâÅ[".
005260***
005270 01  SP-AREA.
005280     02  SP-06       LINE 06.
005290         03  COLUMN 31   PIC Z(04) FROM WKZE.
005300         03  COLUMN 51   PIC Z(04) FROM WKZE.
005310     02  SP-08       LINE 08.
005320         03  COLUMN 27   PIC Z(02) FROM WKZE.
005330         03  COLUMN 30   PIC Z(02) FROM WKZE.
005340         03  COLUMN 33   PIC Z(02) FROM WKZE.
005350         03  COLUMN 47   PIC Z(02) FROM WKZE.
005360         03  COLUMN 50   PIC Z(02) FROM WKZE.
005370         03  COLUMN 53   PIC Z(02) FROM WKZE.
005380     02  SP-24       LINE 24.
005390         03  COLUMN 77   PIC X(01) FROM WKSP.
005400*********
005410 COPY LSMSG.
005420     COPY LIBSCR.                                                 I.971113
005430**********
005440 PROCEDURE                   DIVISION.
005450 MR000.
005460     PERFORM INI-RTN THRU INI-EX.
005470     IF ERR-SW = 1
005480        GO TO MR999.
005490 MR010.
005500     PERFORM W01F-RTN THRU W01F-EX.
005510     IF ESTAT = "P9"
005520        GO TO MR900.
005530 MR020.
005540     PERFORM W01T-RTN THRU W01T-EX.
005550     IF ESTAT = "09"
005560        GO TO MR010.
005570 MR030.
005580     PERFORM W02F-RTN THRU W02F-EX.
005590     IF ESTAT = "09"
005600        GO TO MR020.
005610 MR040.
005620     PERFORM W02T-RTN THRU W02T-EX.
005630     IF ESTAT = "09"
005640        GO TO MR030.
005650 MR090.
005660     PERFORM WOKC-RTN THRU WOKC-EX.
005670     IF ESTAT = "09"
005680        GO TO MR040.
005690     IF W-OKC = "9"
005700        DISPLAY SP-AREA
005710        GO TO MR010.
005720*    KYU-OPEN-ICHI
005730**
005740*****MOVE W-02FY     TO WK-ZZ.                                    D.971113
005750*****MOVE WK-ZZ      TO M6-YYF.                                   D.971113
005760     MOVE W-02FY2    TO M6-YYF.                                   I.971113
005770     MOVE W-02FM     TO WK-ZZ.
005780     MOVE WK-ZZ      TO M6-MMF.
005790     MOVE W-02FD     TO WK-ZZ.
005800     MOVE WK-ZZ      TO M6-DDF.
005810*
005820*****MOVE W-02TY     TO WK-ZZ.                                    D.971113
005830*****MOVE WK-ZZ      TO M6-YYT.                                   D.971113
005840     MOVE W-02TY2    TO M6-YYT.                                   I.971113
005850     MOVE W-02TM     TO WK-ZZ.
005860     MOVE WK-ZZ      TO M6-MMT.
005870     MOVE W-02TD     TO WK-ZZ.
005880     MOVE WK-ZZ      TO M6-DDT.
005890**
005900     MOVE W-01F     TO AM-KEY.
005910     START AM KEY NOT LESS AM-KEY INVALID KEY
005920           GO TO MR900.
005930     READ AM NEXT UNLOCK AT END
005940          GO TO MR150.
005950     IF AM-KEY > W-01T
005960        GO TO MR900.
005970     GO TO MR110.
005980 MR100.
005990     READ AM NEXT UNLOCK AT END
006000          GO TO MR900.
006010     IF AM-KEY > W-01T
006020        GO TO MR900.
006030 MR110.
006040     PERFORM KZMG-RTN THRU KZMG-EX.
006050     IF INV-SW = 1
006060        GO TO MR100.
006070*
006080     MOVE AM-KEY     TO K-ACCD.
006090     MOVE ZERO       TO K-HOCD.
006100     PERFORM KNGG-RTN THRU KNGG-EX.
006110     MOVE KNGNMN     TO M6-01.
006120     MOVE AM-KEY     TO WK-9999.
006130     MOVE WK-9999    TO M6-02.
006140     IF DR-CR = 1
006150        MOVE NC"éÿï˚"     TO M6-03
006160     ELSE
006170        MOVE NC"ë›ï˚"     TO M6-03.
006180*
006190     MOVE ZERO        TO TOT-WK W-ZAN W-KARI W-KASI ERR-SW.
006200     MOVE KZM-ZAN     TO W-ZENKI.
006210     PERFORM ZAN-SET-RTN THRU ZAN-SET-EX.
006220     IF (W-ZAN  = ZERO) AND
006230        (W-KARI = ZERO) AND
006240        (W-KASI = ZERO)
006250        MOVE 1     TO ERR-SW.
006260*
006270     MOVE ZERO         TO SH-KEY2.
006280     MOVE AM-KEY       TO HACCNTCD2.
006290     MOVE Z-TOUF(TI)   TO HTRDATE2.
006300     START SDH KEY NOT LESS SH-KEY2 INVALID KEY
006310           GO TO MR150.
006320 MR140.
006330     READ SDH NEXT UNLOCK AT END
006340          GO TO MR150.
006350     IF AM-KEY NOT = HACCNTCD2
006360        GO TO MR150.
006370     IF W-02T < HTRDATE2
006380        GO TO MR150.
006390     IF W-02F > HTRDATE2
006400        PERFORM SET-RTN THRU SET-EX
006410        PERFORM ADD-RTN THRU ADD-EX
006420        GO TO MR140.
006430     MOVE HTRDATE2     TO ZYMD.
006440     PERFORM Z-RTN THRU Z-EXT.
006450     PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX.
006460     MOVE ZERO         TO W-NGPD NTO-WK.                          I.950126
006470     GO TO MR170.
006480 MR150.
006490     IF ERR-SW = 0
006500        PERFORM ZAN-OUT-RTN THRU ZAN-OUT-EX
006510        WRITE P-R FROM YOKO AFTER 1
006520        MOVE SPACE     TO P-R.                                    I.950126
006530*****   MOVE SPACE     TO P-R                                     D.950126
006540*****   PERFORM TOT2-RTN THRU TOT2-EX.                            D.950126
006550     GO TO MR100.
006560 MR160.
006570     READ SDH NEXT UNLOCK AT END
006580          GO TO MR180.
006590     IF AM-KEY NOT = HACCNTCD2
006600        GO TO MR180.
006610     IF W-02T < HTRDATE2
006620        GO TO MR180.
006630     MOVE HTRDATE2     TO ZYMD.
006640     PERFORM Z-RTN THRU Z-EXT.
006650*****IF ZI NOT = OZI                                              D.950126
006660     IF ZI     = OZI                                              I.950126
006670         GO TO MR170.                                             I.950126
006680     PERFORM PRI-RTN THRU PRI-EX.                                 I.950126
006690     PERFORM TOT1-RTN THRU TOT1-EX.
006700     MOVE ZERO         TO W-NGPD NTO-WK.                          I.950126
006710 MR170.
006720     IF  W-NGPD  =  ZERO                                          I.950126
006730         MOVE ZI           TO OZI                                 I.950126
006740         MOVE HTRDATE2     TO  W-NGPD.                            I.950126
006750     IF  W-NGPD  =  HTRDATE2                                      I.950126
006760         PERFORM SET-RTN THRU SET-EX                              I.950126
006770         PERFORM ADD-RTN   THRU  ADD-EX                           I.950126
006780         GO  TO  MR160.                                           I.950126
006790     PERFORM PRI-RTN THRU PRI-EX.
006800     MOVE W-NGPD       TO  W-NGP.                                 I.950126
006810     MOVE HTRDATE2     TO  W-NGPD.                                I.950126
006820     MOVE ZERO         TO  NTO-WK.                                I.950126
006830     PERFORM SET-RTN THRU SET-EX                                  I.950126
006840     PERFORM ADD-RTN THRU ADD-EX.
006850*****MOVE HTRDATE2     TO OHTRDATE2.                              D.950126
006860*****MOVE HJUNLNO2     TO OHJUNLNO2.                              D.950126
006870     MOVE ZI           TO OZI.
006880     GO TO MR160.
006890 MR180.
006900     PERFORM PRI-RTN THRU PRI-EX.                                 I.940126
006910     PERFORM TOT1-RTN THRU TOT1-EX.
006920*****PERFORM TOT2-RTN THRU TOT2-EX.                               D.950126
006930*****MOVE ZERO     TO OLD-KEY.                                    D.950126
006940     MOVE ZERO     TO OZI.                                        I.950126
006950     GO TO MR100.
006960 MR900.
006970     PERFORM CLSE-ENT THRU CLSE-EXT.
006980 MR999.
006990     STOP RUN.
007000************************
007010 INI-RTN.
007020     MOVE 0     TO ERR-SW.
007030     OPEN INPUT FCTL-F.
007040     MOVE "DATE  "     TO FCTL-KEY1 ERR-K.
007050     READ FCTL-F UNLOCK INVALID KEY
007060          MOVE "FCTL-F"     TO ERR-F
007070          MOVE "G"          TO ERR-M
007080          DISPLAY ERR-DIS
007090          DISPLAY DISP-BUZ-B
007100          CLOSE FCTL-F
007110          MOVE 1     TO ERR-SW
007120          GO TO INI-EX.
007130     MOVE FCTL-REC1     TO Z-R.
007140     CLOSE FCTL-F.
007150*
007160     PERFORM OPEN-RTN THRU OPEN-EX.
007170     COPY LIBCPR.                                                 I.971113
007180*
007190     DISPLAY DISP-C.
007200     MOVE Z-GEMYMD TO W-YMD.                                      I.971113
007210     DISPLAY DSP-AREA.
007220*
007230     ACCEPT SYSDATE     FROM DATE.
007240*****MOVE SYS-YY     TO WK-ZZ.                                    D.971113
007250*****MOVE WK-ZZ      TO M1-YY.                                    D.971113
007260     MOVE SYS-YY     TO M1-YY.                                    I.971113
007270     MOVE SYS-MM     TO WK-ZZ.
007280     MOVE WK-ZZ      TO M1-MM.
007290     MOVE SYS-DD     TO WK-ZZ.
007300     MOVE WK-ZZ      TO M1-DD.
007310***
007320     MOVE Z-TOUT(Z-KSMM)     TO TO-YMD.
007330     MOVE Z-TOUT(15)         TO TO-YMD1.
007340     MOVE Z-UPDYM            TO FROM-YM.
007350     MOVE 01                 TO FROM-D.
007360     MOVE 1     TO I.
007370 INI-000.
007380     IF (Z-TOUF(I) NOT > FROM-YMD) AND
007390        (Z-TOUT(I) NOT < FROM-YMD)
007400        GO TO INI-100.
007410     IF I NOT = 15
007420        ADD 1     TO I
007430        GO TO INI-000.
007440     IF Z-KSMM = 12
007450        MOVE 1     TO I
007460     ELSE
007470        COMPUTE I = Z-KSMM + 1.
007480     MOVE Z-TOUF(I)              TO FROM-YMD.
007490     GO TO INI-EX.
007500 INI-100.
007510     IF I = Z-KSMM
007520        MOVE 13     TO I
007530     ELSE
007540        IF I = 12
007550           MOVE 1     TO I
007560        ELSE
007570           ADD 1     TO I.
007580     IF I > 15
007590        DISPLAY MG-01
007600                DISP-BUZ-B
007610        MOVE 1     TO ERR-SW
007620        GO TO INI-EX.
007630     MOVE Z-TOUF(I)     TO FROM-YMD.
007640 INI-EX.
007650     EXIT.
007660*********
007670 OPEN-RTN.
007680*****OPEN INPUT  KNG AM KZM-F SDH TK.                             D.950126
007690     OPEN INPUT  KNG AM KZM-F SDH.                                I.950126
007700     OPEN OUTPUT P-F.
007710 OPEN-EX.
007720     EXIT.
007730*********
007740 W01F-RTN.
007750     ACCEPT ACP-W01F.
007760     DISPLAY DISP-MSG-SPACE.
007770     IF ESTAT = "P9"
007780        GO TO W01F-EX.
007790     IF ESTAT NOT = "01" AND "06"
007800        GO TO W01F-RTN.
007810 W01F-EX.
007820     EXIT.
007830*********
007840 W01T-RTN.
007850     ACCEPT ACP-W01T.
007860     DISPLAY DISP-MSG-SPACE.
007870     IF ESTAT = "09"
007880        GO TO W01T-EX.
007890     IF ESTAT NOT = "01" AND "06"
007900        GO TO W01T-RTN.
007910     IF W-01F > W-01T
007920        DISPLAY ERR-01
007930        GO TO W01T-RTN.
007940 W01T-EX.
007950     EXIT.
007960*********
007970 W02F-RTN.
007980     ACCEPT ACP-W02F.
007990     DISPLAY DISP-MSG-SPACE.
008000     IF ESTAT = "09"
008010        GO TO W02F-EX.
008020     IF ESTAT NOT = "01" AND "06"
008030        GO TO W02F-RTN.
008040     MOVE ZERO TO W-02FY1.                                        I.971113
008050     IF W-02F = ZERO
008060        MOVE FROM-YMD     TO W-02F
008070        DISPLAY ACP-W02F                                          I.971113
008080        GO TO W02F-050.                                           I.971113
008090*****   DISPLAY ACP-W02F.                                         D.971113
008100     IF W-02FY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
008110         ADD DATE-NC1 TO W-02FY.                                  I.971113
008120     IF W-02FY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
008130         ADD DATE-NC2 TO W-02FY.                                  I.971113
008140 W02F-050.                                                        I.971113
008150     IF W-02F < FROM-YMD OR > TO-YMD1
008160        DISPLAY MG-01
008170        GO TO W02F-RTN.
008180*W02F-050.                                                        D.971113
008190     MOVE 1     TO I.
008200 W02F-100.
008210     IF (Z-TOUF(I) NOT > W-02F) AND
008220        (Z-TOUT(I) NOT < W-02F)
008230        NEXT SENTENCE
008240     ELSE
008250        IF I NOT = 15
008260           ADD 1     TO I
008270           GO TO W02F-100
008280        ELSE
008290           DISPLAY ERR-01
008300           GO TO W02F-RTN.
008310     MOVE I     TO TI.
008320*
008330     IF Z-KSMM = 12
008340        MOVE 1     TO FI
008350     ELSE
008360        COMPUTE FI = Z-KSMM + 1.
008370     IF TI > 12
008380        MOVE 13     TO FI.
008390 W02F-EX.
008400     EXIT.
008410*********
008420 W02T-RTN.
008430     ACCEPT ACP-W02T.
008440     DISPLAY DISP-MSG-SPACE.
008450     IF ESTAT = "09"
008460        GO TO W02T-EX.
008470     IF ESTAT NOT = "01" AND "06"
008480        GO TO W02T-RTN.
008490*****IF W-02T = 999999                                            D.971113
008500     MOVE ZERO TO W-02TY1.                                        I.971113
008510     IF W-02TS = 999999                                           I.971113
008520         IF TI < 13
008530             MOVE TO-YMD     TO W-02T
008540           ELSE                                                   I.971113
008550             MOVE TO-YMD1    TO W-02T.                            I.971113
008560     IF W-02T = TO-YMD OR TO-YMD1                                 I.971113
008570         DISPLAY ACP-W02T                                         I.971113
008580         GO TO W02T-100.                                          I.971113
008590*****      DISPLAY ACP-W02T.                                      D.971113
008600*****IF W-02T = 999999                                            D.971113
008610*****   IF TI > 12                                                D.971113
008620*****      MOVE TO-YMD1    TO W-02T                               D.971113
008630*****      DISPLAY ACP-W02T.                                      D.971113
008640     IF W-02TY2 >= DATE-NF1 AND <= DATE-NT1                       I.971113
008650         ADD DATE-NC1 TO W-02TY.                                  I.971113
008660     IF W-02TY2 >= DATE-NF2 AND <= DATE-NT2                       I.971113
008670         ADD DATE-NC2 TO W-02TY.                                  I.971113
008680 W02T-100.                                                        I.971113
008690     IF TI < 13
008700        IF W-02T > TO-YMD
008710           DISPLAY MG-01
008720           GO TO W02T-RTN.
008730     IF TI > 12
008740        IF W-02T > TO-YMD1
008750           DISPLAY MG-01
008760           GO TO W02T-RTN.
008770     IF W-02F > W-02T
008780        DISPLAY ERR-01
008790        GO TO W02T-RTN.
008800 W02T-EX.
008810     EXIT.
008820*********
008830 WOKC-RTN.
008840     ACCEPT ACP-WOKC.
008850     DISPLAY DISP-MSG-SPACE.
008860     IF ESTAT = "09"
008870        GO TO WOKC-EX.
008880     IF ESTAT NOT = "01" AND "06"
008890        GO TO WOKC-RTN.
008900     IF W-OKC NOT = "1" AND "9"
008910        DISPLAY ERR-01
008920        GO TO WOKC-RTN.
008930 WOKC-EX.
008940     EXIT.
008950*********
008960 KZMG-RTN.
008970     MOVE 0          TO INV-SW.
008980     MOVE AM-KEY     TO KZM-KEY.
008990     READ KZM-F UNLOCK INVALID KEY
009000          MOVE 1     TO INV-SW.
009010 KZMG-EX.
009020     EXIT.
009030*********
009040 ZAN-SET-RTN.
009050     IF TI > 12     GO TO ZAN-SET-500.
009060     MOVE FI     TO I.
009070 ZAN-SET-000.
009080     ADD KZM-TJKR(I)     TO W-KARI TOT-KR(3).
009090     ADD KZM-TJKS(I)     TO W-KASI TOT-KS(3).
009100     IF I = TI
009110        SUBTRACT KZM-TJKR(I)     FROM TOT-KR(3)
009120        SUBTRACT KZM-TJKS(I)     FROM TOT-KS(3)
009130        GO TO ZAN-SET-900.
009140     IF I = 12
009150        MOVE 1     TO I
009160        GO TO ZAN-SET-000.
009170     ADD 1     TO I.
009180     GO TO ZAN-SET-000.
009190 ZAN-SET-500.
009200     IF BS-PL = 0
009210        MOVE 1      TO I
009220     ELSE
009230        MOVE 13     TO I.
009240 ZAN-SET-600.
009250*****ADD KZM-TJKR(I)     TO W-KARI.                               D.930804
009260*****ADD KZM-TJKS(I)     TO W-KASI.                               D.930804
009270     ADD KZM-TJKR(I)     TO W-KARI TOT-KR(3).                     I.930804
009280     ADD KZM-TJKS(I)     TO W-KASI TOT-KS(3).                     I.930804
009290     IF I = 12
009300        IF DR-CR = 1
009310           COMPUTE W-ZENKI = KZM-ZAN + W-KARI - W-KASI
009320        ELSE
009330           COMPUTE W-ZENKI = KZM-ZAN + W-KASI - W-KARI.
009340     IF I = 12                                                    I.930804
009350        MOVE W-ZENKI     TO KZM-ZAN                               I.930804
009360        MOVE ZERO        TO W-KARI W-KASI TOT-ITEM(3).            I.930804
009370*****IF BS-PL = 1                                                 D.930804
009380*****   IF I > 12                                                 D.930804
009390*****      ADD KZM-TJKR(I)     TO TOT-KR(3)                       D.930804
009400*****      ADD KZM-TJKS(I)     TO TOT-KS(3).                      D.930804
009410     IF I = TI
009420        SUBTRACT KZM-TJKR(I)     FROM TOT-KR(3)
009430        SUBTRACT KZM-TJKS(I)     FROM TOT-KS(3)
009440        GO TO ZAN-SET-900.
009450     IF I = 15
009460        GO TO ZAN-SET-900.
009470     ADD 1     TO I.
009480     GO TO ZAN-SET-600.
009490 ZAN-SET-900.
009500     IF DR-CR = 1
009510        COMPUTE W-ZAN = KZM-ZAN + (W-KARI - KZM-TJKR(TI)) -
009520                                       ( W-KASI - KZM-TJKS(TI))
009530     ELSE
009540        COMPUTE W-ZAN = KZM-ZAN + (W-KASI - KZM-TJKS(TI)) -
009550                                       ( W-KARI - KZM-TJKR(TI)).
009560 ZAN-SET-EX.
009570     EXIT.
009580*********
009590 SET-RTN.
009600     IF DR-CR = HDR-CR2
009610        COMPUTE W-ZAN = W-ZAN + HAMOUNT
009620     ELSE
009630        COMPUTE W-ZAN = W-ZAN - HAMOUNT.
009640 SET-EX.
009650     EXIT.
009660*********
009670 ZAN-OUT-RTN.
009680     PERFORM MID-RTN THRU MID-EX.
009690*                                                                 ëOéc
009700*****MOVE TATEP1           TO P-R.                                D.950126
009710*****MOVE K15              TO P1-K15.                             D.950126
009720*****MOVE SPACE            TO P1-04.                              D.950126
009730*****MOVE W-ZAN            TO P1-08.                              D.950126
009740*****MOVE NC"ëOì˙écçÇ"     TO P1-09.                              D.950126
009750     MOVE SPACE            TO P-R.                                I.950126
009760     MOVE K15              TO P2-K15.                             I.950126
009770     MOVE K20              TO P2-K20.                             I.950126
009780     MOVE W-ZAN            TO P2-08.                              I.950126
009790     MOVE NC"Å@ëOì˙écçÇÅ@"     TO P2-01.                          I.950126
009800     MOVE ""3F93""         TO P2-T1 P2-T2 P2-T3 P2-T4 P2-T5.      I.950126
009810     WRITE P-R AFTER 1.
009820     MOVE SPACE     TO P-R.
009830 ZAN-OUT-EX.
009840     EXIT.
009850*********
009860 PRI-RTN.
009870     IF LINAGE-COUNTER > 60
009880        PERFORM MID-RTN THRU MID-EX                               C.920131
009890         MOVE TATEP1       TO P-R                                 I.920131
009900         MOVE K15          TO P1-K15                              I.920131
009910         MOVE K20          TO P1-K20                              I.920131
009920*****    MOVE HTRDATE2     TO WK-YMD                              D.950126
009930         MOVE W-NGPD       TO WK-YMD                              I.950126
009940         GO   TO   PRI-000.                                       I.920131
009950*                                                                 ñæç◊ÇP
009960     MOVE TATEP1       TO P-R.
009970     MOVE K15          TO P1-K15.
009980     MOVE K20          TO P1-K20.
009990*****MOVE HTRDATE2     TO WK-YMD.                                 D.950126
010000*****IF HTRDATE2 = OHTRDATE2                                      D.950126
010010*****   GO TO PRI-030.                                            D.950126
010020*****IF WK-YY NOT = OHTRDATE2YY                                   D.950126
010030     MOVE W-NGPD       TO WK-YMD.                                 I.950126
010040     IF WK-YY NOT = W-NEN                                         I.950126
010050        GO TO PRI-000.
010060*****IF WK-MM NOT = OHTRDATE2MM                                   D.950126
010070     IF WK-MM NOT = W-GET                                         I.950126
010080        GO TO PRI-010.
010090*****IF WK-DD NOT = OHTRDATE2DD                                   D.950126
010100     GO TO PRI-020.
010110 PRI-000.
010120*****MOVE WK-YY    TO P1-01Y.                                     D.971113
010130     MOVE WK-YY2   TO P1-01Y.                                     I.971113
010140     MOVE "."      TO P1-01YH.
010150 PRI-010.
010160     MOVE WK-MM    TO P1-01M.
010170     MOVE "."      TO P1-01MH.
010180 PRI-020.
010190     MOVE WK-DD    TO P1-01D.
010200*****GO TO PRI-040.                                               D.950126
010210 PRI-030.
010220*****IF HJUNLNO2 = OHJUNLNO2                                      D.950126
010230*****   GO TO PRI-050.                                            D.950126
010240*PRI-040.                                                         D.950126
010250*****MOVE HJUNLNO2   TO P1-02.                                    D.950126
010260*****MOVE "-"        TO P1-02H.                                   D.950126
010270*PRI-050.                                                         D.950126
010280*****MOVE HLINENO2   TO P1-03.                                    D.950126
010290*****IF HCUSTCD = ZERO                                            D.950126
010300*****   MOVE SPACE       TO P1-04                                 D.950126
010310*****ELSE                                                         D.950126
010320*****   MOVE HCUSTCD     TO TK-KEY                                D.950126
010330*****   PERFORM TKG-RTN THRU TKG-EX                               D.950126
010340*****   MOVE TK-NAMEN    TO P1-04.                                D.950126
010350*****IF HCUSTCD NOT = ZERO                                        D.950126
010360*****   MOVE "("        TO P1-05F                                 D.950126
010370*****   MOVE HCUSTCD    TO P1-05                                  D.950126
010380*****   MOVE ")"        TO P1-05T.                                D.950126
010390*****IF HDR-CR2 = 1                                               D.950126
010400*****   MOVE HAMOUNT     TO P1-06                                 D.950126
010410*****ELSE                                                         D.950126
010420*****   MOVE HAMOUNT     TO P1-07.                                D.950126
010430*****PERFORM SET-RTN THRU SET-EX.                                 D.950126
010440     MOVE NTO-KR     TO P1-06.                                    I.950126
010450     MOVE NTO-KS     TO P1-07.                                    I.950126
010460     MOVE W-ZAN      TO P1-08.
010470*****MOVE HTEKIYO    TO P1-09.                                    D.950126
010480*****IF HTAXKB NOT = SPACE                                        D.950126
010490*****   MOVE "*"       TO P1-10.                                  D.950126
010500     WRITE P-R AFTER 1.
010510     MOVE SPACE     TO P-R.
010520 PRI-EX.
010530     EXIT.
010540***
010550 ADD-RTN.
010560     IF HDR-CR2 = 1
010570*****   ADD HAMOUNT     TO TOT-KR(2) TOT-KR(3)                    D.950126
010580        ADD HAMOUNT     TO TOT-KR(2) TOT-KR(3) NTO-KR             I.950126
010590     ELSE
010600        ADD HAMOUNT     TO TOT-KS(2) TOT-KS(3) NTO-KS.            I.950126
010610*****   ADD HAMOUNT     TO TOT-KS(2) TOT-KS(3).                   D.950126
010620 ADD-EX.
010630     EXIT.
010640***
010650 MID-RTN.
010660     IF PCNT NOT = ZERO
010670        WRITE P-R AFTER PAGE.
010680     ADD 1     TO PCNT.
010690     MOVE PCNT     TO WK-ZZZZZ.
010700     MOVE WK-ZZZZZ     TO M1-PCNT.
010710     WRITE P-R FROM MID03 AFTER 2.
010720     WRITE P-R FROM MID04 AFTER 1.
010730     WRITE P-R FROM MID05 AFTER 1.
010740     WRITE P-R FROM MID06 AFTER 1.
010750     WRITE P-R FROM MID07 AFTER 1.
010760     WRITE P-R FROM MID08 AFTER 1.
010770     WRITE P-R FROM MID09 AFTER 1.
010780     MOVE TATEP1     TO P-R.
010790     MOVE K15        TO P1-K15.
010800     MOVE K20        TO P1-K20.
010810*****MOVE SPACE      TO P1-04 P1-09.                              D.950126
010820     WRITE P-R AFTER 1.
010830     MOVE SPACE     TO P-R.
010840 MID-EX.
010850     EXIT.
010860***
010870 TOT1-RTN.
010880     IF PCNT = ZERO
010890        GO TO TOT1-EX.
010900     IF LINAGE-COUNTER > 60
010910        PERFORM MID-RTN THRU MID-EX.
010920     WRITE P-R FROM YOKO AFTER 1.                                 I.950126
010930     MOVE SPACE     TO P-R.                                       I.950126
010940     PERFORM SPO-RTN THRU SPO-EX.                                 I.950126
010950     MOVE TOT-ITEM(2)     TO TOT-ITEM(1).
010960*****MOVE TATEP1     TO P-R.                                      D.950126
010970*****MOVE K15        TO P1-K15.                                   D.950126
010980*****MOVE K20        TO P1-K20.                                   D.950126
010990*****MOVE NC"ìñÅ@åéÅ@çáÅ@åv"     TO P1-04.                        D.950126
011000*****MOVE SPACE      TO P1-09.                                    D.950126
011010*****PERFORM OUT-RTN THRU OUT-EX.                                 D.950126
011020     MOVE SPACE      TO P-R.                                      I.950126
011030     MOVE K15        TO P2-K15.                                   I.950126
011040     MOVE K20        TO P2-K20.                                   I.950126
011050     MOVE NC"Å@ìñåéçáåvÅ@"       TO P2-01.                        I.950126
011060     MOVE TOT-KR(1)     TO P2-06.                                 I.950126
011070     MOVE TOT-KS(1)     TO P2-07.                                 I.950126
011080     MOVE ""3F93""         TO P2-T1 P2-T2 P2-T3 P2-T4 P2-T5.      I.950126
011090     WRITE P-R AFTER 1.                                           I.950126
011100     MOVE SPACE     TO P-R.                                       I.950126
011110     WRITE P-R FROM YOKO AFTER 1.
011120     MOVE SPACE     TO P-R.
011130     MOVE ZERO     TO TOT-KR(2) TOT-KS(2).
011140 TOT1-EX.
011150     EXIT.
011160***
011170*TOT2-RTN.                                                        D.950126
011180*****IF PCNT = ZERO                                               D.950126
011190*****   GO TO TOT2-EX.                                            D.950126
011200*****PERFORM SPO-RTN THRU SPO-EX.                                 D.950126
011210*
011220*****MOVE TOT-ITEM(3)     TO TOT-ITEM(1).                         D.950126
011230*****MOVE TATEP2     TO P-R.                                      D.950126
011240*****MOVE K15        TO P2-K15.                                   D.950126
011250*****MOVE K20        TO P2-K20.                                   D.950126
011260*****MOVE NC"ìñÅ@ä˙Å@ó›Å@åv"     TO P2-04.                        D.950126
011270*****MOVE NC"ëOä˙åJâz"           TO P2-09.                        D.950126
011280*****MOVE W-ZENKI                TO P2-99.                        D.950126
011290*****PERFORM OUT-RTN THRU OUT-EX.                                 D.950126
011300*****WRITE P-R FROM YOKO AFTER 1.                                 D.950126
011310*****MOVE SPACE     TO P-R.                                       D.950126
011320*
011330*****MOVE ZERO     TO TOT-KR(3) TOT-KS(3).                        D.950126
011340 TOT2-EX.
011350     EXIT.
011360***
011370 OUT-RTN.
011380     MOVE TOT-KR(1)     TO P1-06.
011390     MOVE TOT-KS(1)     TO P1-07.
011400     MOVE W-ZAN         TO P1-08.
011410     WRITE P-R AFTER 1.
011420     MOVE SPACE     TO P-R.
011430 OUT-EX.
011440     EXIT.
011450***
011460 SPO-RTN.
011470     MOVE TATEP1     TO P-R.
011480     MOVE K15        TO P1-K15.
011490     MOVE K20        TO P1-K20.
011500*****MOVE SPACE      TO P1-04 P1-09.                              D.950126
011510     WRITE P-R AFTER 1.
011520     MOVE SPACE     TO P-R.
011530 SPO-EX.
011540     EXIT.
011550***
011560 KNGG-RTN.
011570     MOVE 0     TO INV-SW.
011580     READ KNG UNLOCK INVALID KEY
011590          MOVE 1         TO INV-SW
011600          MOVE SPACE     TO KNGNMN.
011610 KNGG-EX.
011620     EXIT.
011630***                                                               *A910513
011640*TKG-RTN.                                                         D.950126
011650*****MOVE 0     TO INV-SW.                                        D.950126
011660*****READ TK UNLOCK INVALID KEY                                   D.950126
011670*****     MOVE 1         TO INV-SW                                D.950126
011680*****     MOVE SPACE     TO TK-NAMEN.                             D.950126
011690*TKG-EX.                                                          D.950126
011700*****EXIT.                                                        D.950126
011710*********
011720 CLSE-ENT.
011730*****CLOSE KNG AM KZM-F SDH P-F TK.                               D.950126
011740     CLOSE KNG AM KZM-F SDH P-F.                                  I.950126
011750     DISPLAY DISP-C.
011760 CLSE-EXT.
011770     EXIT.
011780*********
011790 COPY LPMSG.
011800*********
