000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHG010.
000030*********************************************************
000040*    PROGRAM         :  用途区分別製品受払表(原価)      *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  62/04/06                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT KH-M ASSIGN TO KH-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY KH-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT KKB-M ASSIGN TO KKB-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE DYNAMIC
000250         RECORD KEY KKB-KEY
000260         FILE STATUS IS ERR-STAT.
000270     SELECT KHT-M ASSIGN TO KHT-MSD
000280         ORGANIZATION INDEXED                                     I.021008
000290         ACCESS MODE DYNAMIC                                      I.021008
000300         RECORD KEY KHT-KEYD                                      I.021008
000310*****    ORGANIZATION INDEXED                                     D.020910
000320*****    ACCESS MODE DYNAMIC                                      D.020910
000330*****    RECORD KEY KHT-KEYD                                      D.020910
000340         FILE STATUS IS ERR-STAT.
000350     SELECT SP-F ASSIGN TO P-PRN999.
000360 I-O-CONTROL.
000370     APPLY SHARED-MODE ON M-DATE
000380     APPLY SHARED-MODE ON KH-M
000390*****APPLY SHARED-MODE ON KHT-M                                   D.020910
000400     APPLY SHARED-MODE ON KHT-M                                   I.021008
000410     APPLY SHARED-MODE ON KKB-M
000420     APPLY SHIFT-CODE  ON SP-F.                                   A 62/04
000430 DATA DIVISION.
000440 FILE SECTION.
000450     COPY LIBFDD.
000460     COPY LIKHM.
000470     COPY LIKKBM.
000480*****COPY LSKHTM.                                                 D.021008
000490*****COPY LIKHT2.                                                 D.020910
000500     COPY LIKHT2.                                                 I.021008
000510     COPY LSPF.
000520 WORKING-STORAGE SECTION.
000530*77  WK0256ID           PIC  X(009) VALUE SPACE.                  D.021008
000540*01  STN-NO.                                                      D.021008
000550*****02  STN-NO1        PIC  X(003).                              D.021008
000560*****02  STN-NO2        PIC  X(003).                              D.021008
000570*01  W-FID.                                                       D.021008
000580*****02  W-FID1         PIC  X(006) VALUE "WK0256".               D.021008
000590*****02  W-FID2         PIC  X(003).                              D.021008
000600*77  JS-SIGN            PIC  9(001).                              D.020828
000610*01  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".         D.020910
000620 01  HEAD1.
000630     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000640     02  F              PIC  X(042) VALUE SPACE.                  I.020828
000650*****02  F              PIC  X(035) VALUE SPACE.                  D.020828
000660*****02  F              PIC  X(041) VALUE SPACE.                  D.010501
000670*****02  F              PIC  N(024) VALUE                         D.010501
000680*****     NC"＊＊＊　　工品　用途区分別　販売実績表　　＊＊＊".   D.010501
000690*****02  F              PIC  X(034) VALUE SPACE.                  D.010501
000700     02  F              PIC  N(020) VALUE                         I.010501
000710          NC"＊＊＊　　工品　用途区分別　製品受払表　".           I.020719
000720*****     NC"＊＊＊　　工品　用途区分別　販売実績表　".           D.020719
000730*****02  H-MID          PIC  N(007).                              D.020828
000740     02  F              PIC  N(005) VALUE NC"　　＊＊＊".         I.010501
000750     02  F              PIC  X(031) VALUE SPACE.                  I.020828
000760*****02  F              PIC  X(024) VALUE SPACE.                  D.020828
000770     02  F              PIC  X(005) VALUE "DATE ".
000780     02  H-DATE         PIC 99B99B99.
000790 01  HEAD2.
000800     02  F              PIC  X(025) VALUE SPACE.
000810     02  F              PIC  X(046) VALUE
000820          "I---  前月繰越　--I I------  当月入庫  -----I ".
000830     02  F              PIC  X(046) VALUE
000840          "I------  当月出庫  -----I I---  次月繰越  --I ".
000850     02  F              PIC  X(019) VALUE "I----  増 減  ----I".
000860 01  HEAD3.
000870     02  F              PIC  X(044) VALUE
000880          "用　途　区　分　名         数　量　 金　　額".
000890     02  F              PIC  X(052) VALUE
000900          "        数　量　　金　　額　　    数　量　　金　　額".
000910     02  F              PIC  X(040) VALUE
000920          "   数　量　 金　　額　 数　量　 金　　額".
000930     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".         I.020910
000940*01  W-P1.                                                        D.120516
000950*****02  P-YCN          PIC  N(016).                              D.120516
000960 01  W-P.                                                         I.120516
000970     02  P-YCN          PIC  N(012).                              I.120516
000980*****02  F              PIC  X(112).                              D.120516
000990*01  W-P2.                                                        D.120516
001000*****02  P-15K          PIC  X(005).                              D.020910
001010*****02  P-M            PIC  N(016).                              D.120516
001020*****02  P-MD    REDEFINES P-M.                                   D.120516
001030*****  03  F            PIC  N(012).                              D.120516
001040*****  03  P-NM         PIC  N(004).                              D.120516
001050     02  P-NM           PIC  N(004).                              I.120516
001060     02  P-ZS           PIC -----,--9.
001070     02  P-ZK           PIC ---,---,--9.
001080     02  P-NS           PIC ---,---,--9.99.
001090     02  P-NK           PIC ----,---,--9.
001100     02  P-SS           PIC ---,---,--9.99.
001110     02  P-SK           PIC ----,---,--9.
001120     02  P-YS           PIC -----,--9.
001130     02  P-YK           PIC ---,---,--9.
001140     02  P-HS           PIC -----,--9.
001150     02  P-HK           PIC ---,---,--9.
001160*****02  P-20K          PIC  X(005).                              D.120516
001170 01  W-DATA.
001180     02  W-BCD          PIC  9(001).                              I.100602
001190     02  W-BC           PIC  9(001).                              I.100602
001200*****02  W-YC           PIC  9(002).                              D.120516
001210     02  W-YC.                                                    I.120516
001220       03  W-YC1        PIC  9(001).                              I.120516
001230       03  W-YC2        PIC  9(001).                              I.120516
001240     02  W-NC           PIC  9(001).                              I.020910
001250     02  W-C            PIC  9(001).                              I.020910
001260     02  W-CD           PIC  9(001).                              I.120516
001270*****02  W-ZK           PIC S9(008).                              D.020828
001280     02  W-NS           PIC S9(006)V9(02).
001290*****02  W-NK           PIC S9(008).                              D.020828
001300*****02  W-SK           PIC S9(008).                              D.020828
001310     02  W-YS           PIC S9(006)V9(02).
001320     02  W-YK           PIC S9(008).
001330     02  W-HS           PIC S9(006)V9(02).
001340     02  W-HK           PIC S9(008).
001350 01  W-NT.
001360     02  WN-ZS          PIC S9(006)V9(02).
001370     02  WN-ZK          PIC S9(008).
001380     02  WN-NS          PIC S9(007)V9(02).
001390     02  WN-NK          PIC S9(009).
001400     02  WN-SS          PIC S9(007)V9(02).
001410     02  WN-SK          PIC S9(009).
001420     02  WN-YS          PIC S9(006)V9(02).
001430     02  WN-YK          PIC S9(008).
001440     02  WN-HS          PIC S9(006)V9(02).
001450     02  WN-HK          PIC S9(008).
001460 01  W-ST.                                                        I.020910
001470     02  WS-ZS          PIC S9(006)V9(02).                        I.020910
001480     02  WS-ZK          PIC S9(008).                              I.020910
001490     02  WS-NS          PIC S9(007)V9(02).                        I.020910
001500     02  WS-NK          PIC S9(009).                              I.020910
001510     02  WS-SS          PIC S9(007)V9(02).                        I.020910
001520     02  WS-SK          PIC S9(009).                              I.020910
001530     02  WS-YS          PIC S9(006)V9(02).                        I.020910
001540     02  WS-YK          PIC S9(008).                              I.020910
001550     02  WS-HS          PIC S9(006)V9(02).                        I.020910
001560     02  WS-HK          PIC S9(008).                              I.020910
001570 01  W-KT.                                                        I.120516
001580     02  WK-ZK          PIC S9(008).                              I.120516
001590     02  WK-NK          PIC S9(009).                              I.120516
001600     02  WK-SK          PIC S9(009).                              I.120516
001610     02  WK-YK          PIC S9(008).                              I.120516
001620     02  WK-HK          PIC S9(008).                              I.120516
001630 01  W-TT.                                                        I.100602
001640     02  WT-ZK          PIC S9(008).                              I.100602
001650     02  WT-NK          PIC S9(009).                              I.100602
001660     02  WT-SK          PIC S9(009).                              I.100602
001670     02  WT-YK          PIC S9(008).                              I.100602
001680     02  WT-HK          PIC S9(008).                              I.100602
001690 01  W-GT.                                                        I.020910
001700     02  W-GTD   OCCURS  2.                                       I.020910
001710       03  WG-ZK        PIC S9(008).                              I.020910
001720       03  WG-NK        PIC S9(009).                              I.020910
001730       03  WG-SK        PIC S9(009).                              I.020910
001740       03  WG-YK        PIC S9(008).                              I.020910
001750       03  WG-HK        PIC S9(008).                              I.020910
001760 01  W-AT.
001770     02  WA-ZK          PIC S9(008).
001780     02  WA-NK          PIC S9(009).
001790     02  WA-SK          PIC S9(009).
001800     02  WA-YK          PIC S9(008).
001810     02  WA-HK          PIC S9(008).
001820*01  W-DMM              PIC  9(001).                              D.020911
001830 01  ERR-STAT           PIC  X(002).
001840*****COPY LSTAT.                                                  D.020911
001850 SCREEN SECTION.
001860 SD  C-CRT
001870     END STATUS IS ESTAT.
001880 01  C-CLEAR.
001890     02  C-CL    LINE   1  CLEAR SCREEN.
001900 01  C-MID.
001910     02  LINE   3  COLUMN  10  PIC  N(022) VALUE
001920          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001930     02  LINE   4  COLUMN  10  PIC  N(022) VALUE
001940          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001950     02  LINE   5  COLUMN  10  PIC  N(022) VALUE
001960          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
001970     02  LINE   6  COLUMN  10  PIC  N(022) VALUE
001980          NC"＊＊＊　　工品用途区分別製品受払表　　＊＊＊".       I.020719
001990*****     NC"＊＊＊　　工品用途区分別販売実績表　　＊＊＊".       D.020719
002000     02  LINE   7  COLUMN  10  PIC  N(022) VALUE
002010          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
002020     02  LINE   8  COLUMN  10  PIC  N(022) VALUE
002030          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002040     02  LINE   9  COLUMN  10  PIC  N(022) VALUE
002050          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002060*****02  LINE  12  COLUMN  13  PIC  X(038) VALUE                  D.020911
002070*****     "< 打出し する = 0 しない = 9    ﾘﾀｰﾝ >".               D.020911
002080*01  C-ACP.                                                       D.020911
002090*****02  A-DMM   LINE  12  COLUMN  44  PIC  9(001)                D.020911
002100*****     USING W-DMM   CHECK OVERFLOW NO IFC.                    D.020911
002110*01  C-DSP.                                                       D.020828
002120*****02  D-MID   LINE   7  COLUMN  26  PIC  N(007) FROM  H-MID.   D.020828
002130 01  C-ERR.
002140     02  LINE  24.
002150       03  E-ME1   COLUMN  15  PIC  X(030) VALUE
002160            "***  DATA ﾅｼ  ***             ".
002170       03  E-ME2   COLUMN  15  PIC  X(030) VALUE
002180            "***  KHM ﾅｼ  ***              ".
002190       03  E-KEY   COLUMN  35  PIC  X(005) FROM  KHT-KEY.
002200       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002210       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002220     COPY LIBSCR.
002230 PROCEDURE DIVISION.
002240 M-05.
002250*****ACCEPT JS-SIGN.                                              D.020828
002260*****IF JS-SIGN > 1                                               D.020828
002270*****    MOVE 255 TO COMPLETION-CODE                              D.020828
002280*****    STOP RUN.                                                D.020828
002290     COPY LIBCPR.
002300     DISPLAY C-CLEAR.
002310     DISPLAY C-MID.
002320*****IF JS-SIGN = 0                                               D.020828
002330*****    MOVE NC"（売価ベース）" TO H-MID                         D.020828
002340*****  ELSE                                                       D.020828
002350*****    MOVE NC"（原価ベース）" TO H-MID.                        D.020828
002360*****DISPLAY D-MID.                                               D.020828
002370*M-06.                                                            D.020911
002380*****ACCEPT A-DMM.                                                D.020911
002390*****IF ESTAT NOT = HTB AND SKP                                   D.020911
002400*****    GO TO M-06.                                              D.020911
002410*****IF W-DMM = 9                                                 D.020911
002420*****    STOP RUN.                                                D.020911
002430*****IF W-DMM NOT = ZERO                                          D.020911
002440*****    GO TO M-06.                                              D.020911
002450*
002460     MOVE DATE-03R TO H-DATE.
002470     OPEN INPUT KH-M.
002480     OPEN INPUT KKB-M.
002490*****CALL "CBLSTNNO" USING STN-NO.                                D.021008
002500*****MOVE STN-NO2 TO W-FID2.                                      D.021008
002510*****MOVE W-FID TO WK0256ID.                                      D.021008
002520     OPEN INPUT KHT-M.
002530     OPEN OUTPUT SP-F.                                            A 62/04
002540 M-10.
002550*****READ KHT-M NEXT RECORD WITH UNLOCK AT END                    D.020910
002560*****READ KHT-M AT END                                            D.021008
002570     READ KHT-M NEXT RECORD WITH UNLOCK AT END                    I.021008
002580         DISPLAY E-ME1 E-ME99
002590         GO TO M-95.
002600     IF KHT-YC = ZERO
002610         GO TO M-10.
002620     IF KHT-YC < 20                                               I.100602
002630         MOVE 0 TO W-BCD                                          I.100602
002640       ELSE                                                       I.100602
002650         MOVE 1 TO W-BCD.                                         I.100602
002660     PERFORM S-10 THRU S-15.
002670     MOVE ZERO TO W-AT W-GT.                                      I.020910
002680*****MOVE ZERO TO W-AT.                                           D.020910
002690 M-15.                                                            I.100602
002700     MOVE W-BCD TO W-BC.                                          I.100602
002710     MOVE ZERO TO W-TT.                                           I.100602
002720 M-20.
002730*****MOVE ZERO TO W-NT.                                           D.020910
002740*****MOVE ZERO TO W-ST W-C.                                       D.120516
002750*****MOVE ZERO TO W-ST.                                           D.120516
002760     MOVE ZERO TO W-KT W-CD.                                      I.120516
002770     MOVE KHT-YC TO W-YC.
002780 M-25.                                                            I.120516
002790     MOVE ZERO TO W-ST W-C.                                       I.120516
002800     MOVE KHT-YC2 TO W-YC2.                                       I.120516
002810*
002820     MOVE SPACE TO KKB-KEY.
002830     MOVE 01 TO KKB-NO.
002840     MOVE W-YC TO KKB-YC.
002850     READ KKB-M WITH UNLOCK INVALID KEY
002860         MOVE SPACE TO KKB-YCN.
002870 M-30.                                                            I.020910
002880     MOVE ZERO TO W-NT.                                           I.020910
002890     MOVE KHT-NC TO W-NC.                                         I.020910
002900 M-35.
002910     MOVE KHT-KEY TO KH-KEY.
002920     READ KH-M WITH UNLOCK INVALID KEY
002930         DISPLAY E-ME2 E-KEY E-ME99
002940         GO TO M-95.
002950     IF KHT-YC NOT = 10 AND 11                                    I.021001
002960*****    IF KH-T2 = ZERO                                          D.090428
002970         IF KH-GT1 = ZERO                                         I.090428
002980             MOVE ZERO TO KHT-SSU.                                I.021001
002990*
003000*****COMPUTE W-NS = KHT-KSU - KHT-HSU.                            D.021008
003010*****COMPUTE W-SK = KHT-UKIN - KHT-NKIN.                          D.010501
003020     COMPUTE W-NS = KHT-KSU - KHT-HSU + KHT-ISU.                  I.021008
003030     COMPUTE W-YS = KHT-ZSU + W-NS - KHT-SSU.
003040     COMPUTE W-YK = W-YS * KH-GT1.                                I.090428
003050*****IF (JS-SIGN = 1) AND (KHT-YC NOT = 10 AND 11)                D.020828
003060*****    COMPUTE W-ZK = KHT-ZSU * KH-T2                           D.020828
003070*****    COMPUTE W-NK = W-NS * KH-T2                              D.020828
003080*****    COMPUTE W-SK = KHT-SSU * KH-T2                           D.020828
003090*****IF KHT-YC NOT = 10 AND 11                                    D.090428
003100*****    COMPUTE W-YK = W-YS * KH-T2                              D.090428
003110*****  ELSE                                                       D.090428
003120*****    MOVE KHT-ZKIN TO W-ZK                                    D.020828
003130*****    MOVE KHT-KKIN TO W-NK                                    D.020828
003140*****    COMPUTE W-SK = KHT-UKIN - KHT-NKIN                       D.020828
003150*****    COMPUTE W-YK = W-YS * KH-T1.                             D.090428
003160     COMPUTE W-HS = W-YS - KHT-ZSU.                               I.020715
003170     COMPUTE W-HK = W-YK - KHT-ZKIN.                              I.020828
003180*****COMPUTE W-HK = W-YK - W-ZK.                                  D.020828
003190*****COMPUTE W-HS = W-YS - KHT-ZSU.                               D.010501
003200*****COMPUTE W-HK = W-YK - KHT-ZKIN.                              D.010501
003210*
003220     ADD KHT-ZSU TO WN-ZS
003230     ADD KHT-ZKIN TO WN-ZK.                                       I.020828
003240*****ADD W-ZK TO WN-ZK.                                           D.020828
003250*****ADD KHT-ZKIN TO WN-ZK.                                       D.010501
003260     ADD W-NS TO WN-NS.
003270     ADD KHT-KKIN TO WN-NK.                                       I.020828
003280*****ADD W-NK TO WN-NK.                                           D.020828
003290*****ADD KHT-KKIN TO WN-NK.                                       D.010501
003300     ADD KHT-SSU TO WN-SS.
003310     ADD KHT-GKIN TO WN-SK.                                       I.020828
003320*****ADD W-SK TO WN-SK.                                           D.020828
003330     ADD W-YS TO WN-YS.
003340     ADD W-YK TO WN-YK.
003350     ADD W-HS TO WN-HS.
003360     ADD W-HK TO WN-HK.
003370 M-40.
003380*****READ KHT-M NEXT RECORD WITH UNLOCK AT END                    D.020910
003390*****READ KHT-M AT END                                            D.021008
003400     READ KHT-M NEXT RECORD WITH UNLOCK AT END                    I.021008
003410         GO TO M-90.
003420     IF KHT-YC < 20                                               I.100602
003430         MOVE 0 TO W-BCD                                          I.100602
003440       ELSE                                                       I.100602
003450         MOVE 1 TO W-BCD.                                         I.100602
003460     IF W-BCD NOT = W-BC                                          I.100602
003470         GO TO M-55.                                              D.100602
003480*****IF KHT-YC = W-YC                                             D.020910
003490*****IF KHT-YC NOT = W-YC                                         D.120516
003500     IF KHT-YC1 NOT = W-YC1                                       I.120516
003510         GO TO M-50.                                              I.120516
003520     IF KHT-YC2 NOT = W-YC2                                       I.120516
003530         GO TO M-45.                                              I.020910
003540     IF KHT-NC = W-NC                                             I.020910
003550         GO TO M-35.
003560     PERFORM S-20 THRU S-25.                                      I.020910
003570     GO TO M-30.                                                  I.020910
003580 M-45.
003590     PERFORM S-20 THRU S-25.
003600     PERFORM S-40 THRU S-50.                                      I.020910
003610     GO TO M-25.                                                  I.120516
003620*****GO TO M-20.                                                  D.120516
003630 M-50.                                                            I.120516
003640     PERFORM S-20 THRU S-25.                                      I.120516
003650     PERFORM S-40 THRU S-50.                                      I.120516
003660     PERFORM S-55 THRU S-60.                                      I.120516
003670     GO TO M-20.                                                  I.120516
003680 M-55.                                                            I.100602
003690     PERFORM S-20 THRU S-25.                                      I.100602
003700     PERFORM S-40 THRU S-50.                                      I.100602
003710     PERFORM S-55 THRU S-60.                                      I.120516
003720     PERFORM S-65 THRU S-70.                                      I.100602
003730     GO TO M-15.                                                  I.100602
003740 M-90.
003750     PERFORM S-20 THRU S-25.
003760     PERFORM S-40 THRU S-50.                                      I.020910
003770     PERFORM S-55 THRU S-60.                                      I.120516
003780     PERFORM S-65 THRU S-70.                                      I.100602
003790     PERFORM S-75 THRU S-80.
003800 M-95.
003810     CLOSE KH-M.
003820     CLOSE KKB-M.
003830     CLOSE KHT-M.
003840     CLOSE SP-F.
003850     DISPLAY C-CLEAR.
003860     STOP RUN.
003870 S-05.
003880     MOVE SPACE TO SP-R.
003890     WRITE SP-R AFTER PAGE.
003900 S-10.
003910     MOVE SPACE TO SP-R.
003920     MOVE HEAD1 TO SP-R.
003930     WRITE SP-R.
003940     MOVE SPACE TO SP-R.
003950     MOVE HEAD2 TO SP-R.
003960     WRITE SP-R AFTER 2.
003970     MOVE SPACE TO SP-R.
003980     MOVE HEAD3 TO SP-R.
003990     WRITE SP-R.
004000     MOVE SPACE TO SP-R.
004010     WRITE SP-R.
004020 S-15.
004030     EXIT.
004040 S-20.
004050     IF ZERO = WN-ZS AND WN-ZK AND WN-NS AND WN-NK AND            I.950302
004060               WN-SS AND WN-SK AND WN-YS AND WN-YK                I.950302
004070         GO TO S-25.                                              I.950302
004080     MOVE SPACE TO W-P.                                           I.120516
004090     MOVE SPACE TO P-YCN P-NM.                                    I.120516
004100     MOVE 1 TO W-CD.                                              I.120516
004110     ADD 1 TO W-C.                                                I.020910
004120     IF W-C = 1                                                   I.020910
004130         MOVE KKB-YCN TO P-YCN.                                   I.120516
004140*****    PERFORM S-30 THRU S-35.                                  D.120516
004150*****IF LINAGE-COUNTER > 60                                       D.020910
004160*****    PERFORM S-05 THRU S-15.                                  D.020910
004170*****MOVE SPACE TO SP-R W-P2.                                     D.020910
004180*****MOVE W-15K TO P-15K.                                         D.020910
004190*****MOVE W-20K TO P-20K.                                         D.020910
004200*****MOVE KKB-YCN TO P-M.                                         D.020910
004210*****MOVE SPACE TO W-P2.                                          D.120516
004220*****MOVE SPACE TO P-M.                                           D.120516
004230     IF W-NC = 0                                                  I.020910
004240         MOVE NC"内　作　" TO P-NM.                               I.020910
004250     IF W-NC = 1                                                  I.020910
004260         MOVE NC"仕　入　" TO P-NM.                               I.020910
004270     MOVE WN-ZS TO P-ZS.
004280     MOVE WN-ZK TO P-ZK.
004290     MOVE WN-NS TO P-NS.
004300     MOVE WN-NK TO P-NK.
004310     MOVE WN-SS TO P-SS.
004320     MOVE WN-SK TO P-SK.
004330     MOVE WN-YS TO P-YS.
004340     MOVE WN-YK TO P-YK.
004350     MOVE WN-HS TO P-HS.
004360     MOVE WN-HK TO P-HK.
004370*****IF LINAGE-COUNTER > 60                                       D.120512
004380     IF LINAGE-COUNTER > 61                                       I.120512
004390         MOVE KKB-YCN TO P-YCN                                    I.120516
004400         PERFORM S-05 THRU S-15.                                  I.120516
004410*****    PERFORM S-05 THRU S-15                                   D.120516
004420*****    PERFORM S-30 THRU S-35.                                  D.120516
004430     MOVE SPACE TO SP-R.                                          I.020910
004440     MOVE W-P TO SP-R.                                            I.120516
004450*****MOVE W-P2 TO SP-R.                                           D.120516
004460     WRITE SP-R.
004470     MOVE SPACE TO SP-R.
004480*****WRITE SP-R.                                                  D.020910
004490*
004500     ADD WN-ZS TO WS-ZS.                                          I.020910
004510     ADD WN-ZK TO WS-ZK.                                          I.020910
004520     ADD WN-NS TO WS-NS.                                          I.020910
004530     ADD WN-NK TO WS-NK.                                          I.020910
004540     ADD WN-SS TO WS-SS.                                          I.020910
004550     ADD WN-SK TO WS-SK.                                          I.020910
004560     ADD WN-YS TO WS-YS.                                          I.020910
004570     ADD WN-YK TO WS-YK.                                          I.020910
004580     ADD WN-HS TO WS-HS.                                          I.020910
004590     ADD WN-HK TO WS-HK.                                          I.020910
004600     IF W-NC = 0                                                  I.020910
004610         ADD WN-ZK TO WG-ZK(1)                                    I.020910
004620         ADD WN-NK TO WG-NK(1)                                    I.020910
004630         ADD WN-SK TO WG-SK(1)                                    I.020910
004640         ADD WN-YK TO WG-YK(1)                                    I.020910
004650         ADD WN-HK TO WG-HK(1).                                   I.020910
004660     IF W-NC = 1                                                  I.020910
004670         ADD WN-ZK TO WG-ZK(2)                                    I.020910
004680         ADD WN-NK TO WG-NK(2)                                    I.020910
004690         ADD WN-SK TO WG-SK(2)                                    I.020910
004700         ADD WN-YK TO WG-YK(2)                                    I.020910
004710         ADD WN-HK TO WG-HK(2).                                   I.020910
004720*****ADD WN-ZK TO WA-ZK.                                          D.020910
004730*****ADD WN-NK TO WA-NK.                                          D.020910
004740*****ADD WN-SK TO WA-SK.                                          D.020910
004750*****ADD WN-YK TO WA-YK.                                          D.020910
004760*****ADD WN-HK TO WA-HK.                                          D.020910
004770 S-25.
004780     EXIT.
004790*S-30.                                                            D.120516
004800*****MOVE SPACE TO W-P1.                                          D.120516
004810*****MOVE KKB-YCN TO P-YCN.                                       D.120516
004820*****IF LINAGE-COUNTER > 59                                       D.120512
004830*****IF LINAGE-COUNTER > 60                                       D.120516
004840*****    PERFORM S-05 THRU S-15.                                  D.120516
004850*****MOVE SPACE TO SP-R.                                          D.120516
004860*****MOVE W-P1 TO SP-R.                                           D.120516
004870*****WRITE SP-R.                                                  D.120516
004880*****MOVE SPACE TO SP-R.                                          D.120516
004890*S-35.                                                            D.120516
004900*****EXIT.                                                        D.120516
004910 S-40.                                                            I.020910
004920     IF W-C < 2                                                   I.020910
004930         GO TO S-45.                                              I.020910
004940*****MOVE SPACE TO W-P2.                                          D.120516
004950*****MOVE SPACE TO P-M.                                           D.120516
004960*****MOVE NC"　　　　　　　　（　小　計　）　" TO P-M.            D.120516
004970     MOVE SPACE TO W-P.                                           I.120516
004980     MOVE SPACE TO P-YCN P-NM.                                    I.120516
004990     MOVE NC"　　　　　　　（　計　）" TO P-YCN.                  I.120516
005000     MOVE WS-ZS TO P-ZS.                                          I.020910
005010     MOVE WS-ZK TO P-ZK.                                          I.020910
005020     MOVE WS-NS TO P-NS.                                          I.020910
005030     MOVE WS-NK TO P-NK.                                          I.020910
005040     MOVE WS-SS TO P-SS.                                          I.020910
005050     MOVE WS-SK TO P-SK.                                          I.020910
005060     MOVE WS-YS TO P-YS.                                          I.020910
005070     MOVE WS-YK TO P-YK.                                          I.020910
005080     MOVE WS-HS TO P-HS.                                          I.020910
005090     MOVE WS-HK TO P-HK.                                          I.020910
005100*****IF LINAGE-COUNTER > 60                                       D.120512
005110     IF LINAGE-COUNTER > 61                                       I.120512
005120         PERFORM S-05 THRU S-15.                                  I.120516
005130*****    PERFORM S-05 THRU S-15                                   D.120516
005140*****    PERFORM S-30 THRU S-35.                                  D.120516
005150     MOVE SPACE TO SP-R.                                          I.020910
005160     MOVE W-P TO SP-R.                                            I.120516
005170*****MOVE W-P2 TO SP-R.                                           D.120516
005180     WRITE SP-R.                                                  I.020910
005190     MOVE SPACE TO SP-R.                                          I.020910
005200 S-45.                                                            I.020910
005210*****ADD WS-ZK TO WA-ZK.                                          D.100602
005220*****ADD WS-NK TO WA-NK.                                          D.100602
005230*****ADD WS-SK TO WA-SK.                                          D.100602
005240*****ADD WS-YK TO WA-YK.                                          D.100602
005250*****ADD WS-HK TO WA-HK.                                          D.100602
005260*****ADD WS-ZK TO WT-ZK.                                          D.120516
005270*****ADD WS-NK TO WT-NK.                                          D.120516
005280*****ADD WS-SK TO WT-SK.                                          D.120516
005290*****ADD WS-YK TO WT-YK.                                          D.120516
005300*****ADD WS-HK TO WT-HK.                                          D.120516
005310     ADD WS-ZK TO WK-ZK.                                          I.120516
005320     ADD WS-NK TO WK-NK.                                          I.120516
005330     ADD WS-SK TO WK-SK.                                          I.120516
005340     ADD WS-YK TO WK-YK.                                          I.120516
005350     ADD WS-HK TO WK-HK.                                          I.120516
005360 S-50.                                                            I.020910
005370     EXIT.                                                        I.020910
005380 S-55.                                                            I.120516
005390     IF W-CD = 0                                                  I.120516
005400         GO TO S-60.                                              I.120516
005410     MOVE SPACE TO W-P.                                           I.120516
005420     MOVE SPACE TO P-YCN P-NM.                                    I.120516
005430     MOVE NC"　　　　＜　小　計　＞　" TO P-YCN.                  I.120516
005440     MOVE WK-ZK TO P-ZK.                                          I.120516
005450     MOVE WK-NK TO P-NK.                                          I.120516
005460     MOVE WK-SK TO P-SK.                                          I.120516
005470     MOVE WK-YK TO P-YK.                                          I.120516
005480     MOVE WK-HK TO P-HK.                                          I.120516
005490     IF LINAGE-COUNTER > 61                                       I.120512
005500         PERFORM S-05 THRU S-15.                                  I.120516
005510     MOVE SPACE TO SP-R.                                          I.120516
005520     MOVE W-P TO SP-R.                                            I.120516
005530     WRITE SP-R.                                                  I.120516
005540     MOVE SPACE TO SP-R.                                          I.120516
005550     WRITE SP-R.                                                  I.120516
005560*
005570     ADD WK-ZK TO WT-ZK.                                          I.120516
005580     ADD WK-NK TO WT-NK.                                          I.120516
005590     ADD WK-SK TO WT-SK.                                          I.120516
005600     ADD WK-YK TO WT-YK.                                          I.120516
005610     ADD WK-HK TO WT-HK.                                          I.120516
005620 S-60.                                                            I.020910
005630     EXIT.                                                        I.020910
005640 S-65.                                                            I.100602
005650     MOVE SPACE TO W-P.                                           I.120516
005660     MOVE SPACE TO P-YCN P-NM.                                    I.120516
005670*****MOVE SPACE TO W-P2.                                          D.120516
005680*****MOVE NC"　　　　　［　合　計　］　　" TO P-M.                D.120516
005690     MOVE NC"　　［　合　計　］　　　" TO P-YCN.                  I.120516
005700     MOVE WT-ZK TO P-ZK.
005710     MOVE WT-NK TO P-NK.
005720     MOVE WT-SK TO P-SK.
005730     MOVE WT-YK TO P-YK.
005740     MOVE WT-HK TO P-HK.
005750*****IF LINAGE-COUNTER > 60                                       D.120512
005760     IF LINAGE-COUNTER > 61                                       I.120512
005770         PERFORM S-05 THRU S-15.                                  I.020910
005780     MOVE SPACE TO SP-R.                                          I.020910
005790*****MOVE W-P2 TO SP-R.                                           D.120516
005800     MOVE W-P TO SP-R.                                            I.120516
005810     WRITE SP-R.                                                  I.120516
005820*****WRITE SP-R AFTER 2.                                          D.120516
005830     MOVE SPACE TO SP-R.                                          I.020910
005840     WRITE SP-R.                                                  I.020910
005850*
005860     ADD WT-ZK TO WA-ZK.                                          I.100602
005870     ADD WT-NK TO WA-NK.                                          I.100602
005880     ADD WT-SK TO WA-SK.                                          I.100602
005890     ADD WT-YK TO WA-YK.                                          I.100602
005900     ADD WT-HK TO WA-HK.                                          I.100602
005910 S-70.
005920     EXIT.
005930 S-75.
005940*****IF LINAGE-COUNTER > 60                                       D.020910
005950*****    PERFORM S-05 THRU S-15.                                  D.020910
005960*****MOVE SPACE TO SP-R W-P2.                                     D.020910
005970*****MOVE W-15K TO P-15K.                                         D.020910
005980*****MOVE W-20K TO P-20K.                                         D.020910
005990*****MOVE SPACE TO W-P2.                                          D.120516
006000*****MOVE NC"　　　【　　総　合　計　　】　　" TO P-M.            D.120516
006010     MOVE SPACE TO W-P.                                           I.120516
006020     MOVE SPACE TO P-YCN P-NM.                                    I.120516
006030     MOVE NC"【　　総　合　計　　】　" TO P-YCN.                  I.120516
006040     MOVE WA-ZK TO P-ZK.
006050     MOVE WA-NK TO P-NK.
006060     MOVE WA-SK TO P-SK.
006070     MOVE WA-YK TO P-YK.
006080     MOVE WA-HK TO P-HK.
006090*****IF LINAGE-COUNTER > 60                                       D.120512
006100     IF LINAGE-COUNTER > 61                                       I.120512
006110         PERFORM S-05 THRU S-15.                                  I.020910
006120     MOVE SPACE TO SP-R.                                          I.020910
006130     MOVE W-P TO SP-R.                                            I.120516
006140*****MOVE W-P2 TO SP-R.                                           D.120516
006150*****WRITE SP-R AFTER 2.                                          D.120512
006160     WRITE SP-R.                                                  I.120512
006170     MOVE SPACE TO SP-R.                                          I.020910
006180*                                                                 I.020910
006190*****MOVE SPACE TO W-P2.                                          D.120516
006200*****MOVE SPACE TO P-M.                                           D.120516
006210     MOVE SPACE TO W-P.                                           I.120516
006220     MOVE SPACE TO P-YCN P-NM.                                    I.120516
006230     MOVE NC"内　作　" TO P-NM.                                   I.020910
006240     MOVE WG-ZK(1) TO P-ZK.                                       I.020910
006250     MOVE WG-NK(1) TO P-NK.                                       I.020910
006260     MOVE WG-SK(1) TO P-SK.                                       I.020910
006270     MOVE WG-YK(1) TO P-YK.                                       I.020910
006280     MOVE WG-HK(1) TO P-HK.                                       I.020910
006290*****IF LINAGE-COUNTER > 60                                       D.120512
006300     IF LINAGE-COUNTER > 61                                       I.120512
006310         PERFORM S-05 THRU S-15.                                  I.020910
006320     MOVE SPACE TO SP-R.                                          I.020910
006330*****MOVE W-P2 TO SP-R.                                           D.120516
006340     MOVE W-P TO SP-R.                                            D.120516
006350     WRITE SP-R.                                                  I.020910
006360     MOVE SPACE TO SP-R.                                          I.020910
006370*                                                                 I.020910
006380*****MOVE SPACE TO W-P2.                                          D.120516
006390*****MOVE SPACE TO P-M.                                           D.120516
006400     MOVE SPACE TO W-P.                                           I.120516
006410     MOVE SPACE TO P-YCN P-NM.                                    I.120516
006420     MOVE NC"仕　入　" TO P-NM.                                   I.020910
006430     MOVE WG-ZK(2) TO P-ZK.                                       I.020910
006440     MOVE WG-NK(2) TO P-NK.                                       I.020910
006450     MOVE WG-SK(2) TO P-SK.                                       I.020910
006460     MOVE WG-YK(2) TO P-YK.                                       I.020910
006470     MOVE WG-HK(2) TO P-HK.                                       I.020910
006480*****IF LINAGE-COUNTER > 60                                       D.120512
006490     IF LINAGE-COUNTER > 61                                       I.120512
006500         PERFORM S-05 THRU S-15.                                  I.020910
006510     MOVE SPACE TO SP-R.                                          I.020910
006520*****MOVE W-P2 TO SP-R.                                           D.120516
006530     MOVE W-P TO SP-R.                                            I.120516
006540     WRITE SP-R.                                                  I.020910
006550 S-80.
006560     EXIT.
