000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHD610.
000030 AUTHOR. S-NAKAO.
000040*********************************************************
000050*    PROGRAM         :  工品他日計表　　　　　　　　　　*
000060*    PRINTER TYPE    :  JIPS                            *
000070*    SCREEN          :  NO                              *
000080*    DATA WRITTN     :  1974-05-15.                     *
000090*        変更　　　  :  87/04/02                        *
000100*    COMPILE TYPE    :  COBOL                           *
000110*********************************************************
000120 ENVIRONMENT DIVISION.
000130 CONFIGURATION SECTION.
000140 SOURCE-COMPUTER. SYSTEM3100.
000150 OBJECT-COMPUTER. SYSTEM3100.
000160 INPUT-OUTPUT SECTION.
000170 FILE-CONTROL.
000180     COPY LIBCSE.
000190*****SELECT KT-M ASSIGN TO KT-MSD                                 D.000224
000200     SELECT TT-M ASSIGN TO TT-MSD                                 I.000224
000210         ORGANIZATION IS INDEXED
000220         ACCESS MODE IS SEQUENTIAL
000230         RECORD KEY IS TT-KEY                                     I.000224
000240*****    RECORD KEY IS KT-KEY                                     D.000224
000250         FILE STATUS IS ERR-STAT.
000260     SELECT CALNM ASSIGN TO CALN-MSD
000270         ORGANIZATION IS INDEXED
000280         ACCESS MODE IS DYNAMIC
000290         RECORD KEY IS CL-KEY
000300         FILE STATUS IS ERR-STAT.
000310     SELECT BNM ASSIGN TO BNM-MSD                                 I.000620
000320         ORGANIZATION IS INDEXED                                  I.000620
000330         ACCESS MODE IS RANDOM                                    I.000620
000340         RECORD KEY IS BNM-KEY                                    I.000620
000350         FILE STATUS IS ERR-STAT.                                 I.000620
000360*
000370     SELECT URI-F ASSIGN TO URI-MSD.
000380     SELECT NYU-F ASSIGN TO NYU-MSD                               I.991203
000390         ORGANIZATION INDEXED                                     I.991203
000400         ACCESS MODE DYNAMIC                                      I.991203
000410         RECORD KEY NYU-KEY.                                      I.991203
000420*****SELECT KNB-F ASSIGN TO KNB-MSD.                              D.970325
000430*****SELECT KNYU-F ASSIGN TO KNYU-MSD.                            D.991203
000440*
000450     SELECT URIR-F ASSIGN TO URIR-MSD.
000460*****SELECT KNBR-F ASSIGN TO KNBR-MSD.                            D.910702
000470     SELECT NYUR-F ASSIGN TO NYUR-MSD.
000480     SELECT SP-F ASSIGN TO P-PRN999.
000490 I-O-CONTROL.
000500*****APPLY SHARED-MODE ON KT-M                                    D.000224
000510     APPLY SHARED-MODE ON TT-M                                    I.000224
000520     APPLY SHARED-MODE ON CALNM
000530     APPLY SHARED-MODE ON BNM                                     I.000620
000540     APPLY SHARED-MODE ON M-DATE
000550     APPLY SHIFT-CODE  ON SP-F.                                   A 62/04
000560 DATA DIVISION.
000570 FILE SECTION.
000580     COPY LIBFDD.
000590     COPY LITTM.                                                  I.000224
000600*****COPY LIKTM.                                                  D.000224
000610*****COPY LICALN.                                                 D.971013
000620     COPY LICAL.                                                  I.971013
000630     COPY BUMONF.                                                 I.000620
000640     COPY LSNYUR.
000650     COPY LSPF.
000660 FD  URI-F
000670*****BLOCK  4 RECORDS                                             D.001101
000680*****BLOCK  3 RECORDS                                             D.010907
000690     BLOCK  2 RECORDS                                             I.010907
000700     LABEL RECORD IS STANDARD
000710     VALUE OF IDENTIFICATION "URIF".
000720 01  URI-R              PIC  X(128).                              I.010907
000730*01  URI-R              PIC  X(085).                              D.010907
000740*01  URI-R              PIC  X(064).                              D.001101
000750*FD  KNB-F                                                        D.970325
000760*****BLOCK  6 RECORDS                                             D.970325
000770*****LABEL RECORD IS STANDARD                                     D.970325
000780*****VALUE OF IDENTIFICATION "KNBF".                              D.970325
000790*01  KNB-R              PIC  X(042).                              D.970325
000800*FD  KNYU-F                                                       D.991203
000810*****BLOCK  6 RECORDS                                             D.970901
000820*****BLOCK  5 RECORDS                                             D.991203
000830 FD  NYU-F                                                        I.991203
000840*****BLOCK  4 RECORDS                                             D.991214
000850*****BLOCK  3 RECORDS                                             D.000825
000860     BLOCK  5 RECORDS                                             I.000825
000870     LABEL RECORD IS STANDARD
000880     VALUE OF IDENTIFICATION "NYUF".                              I.991203
000890 01  NYU-R.                                                       I.991203
000900*****02  F              PIC  X(036).                              D.991214
000910     02  F              PIC  X(037).                              I.991214
000920     02  NYU-BC         PIC  9(001).                              I.991203
000930     02  F              PIC  X(005).                              I.991203
000940     02  NYU-KEY        PIC  X(007).                              I.991203
000950*****02  F              PIC  X(010).                              D.000825
000960     02  F              PIC  X(031).                              I.000825
000970     02  NYU-RSC        PIC  9(001).                              I.991214
000980     02  NYU-DPC        PIC  9(001).                              I.991214
000990     02  F              PIC  X(019).                              I.000825
001000*****02  F              PIC  X(023).                              D.000825
001010*****02  F              PIC  X(015).                              D.991214
001020*****VALUE OF IDENTIFICATION "KNYUF".                             D.991203
001030*01  KNYU-R             PIC  X(051).                              D.991203
001040*01  KNYU-R             PIC  X(042).                              D.970901
001050 FD  URIR-F
001060*****BLOCK  4 RECORDS                                             D.001101
001070*****BLOCK  3 RECORDS                                             D.010907
001080     BLOCK  2 RECORDS                                             I.010907
001090     LABEL RECORD IS STANDARD
001100     VALUE OF IDENTIFICATION "URIRF".
001110 01  URIR-R.
001120     02  UR-DC          PIC  9(001).
001130*****02  F              PIC  X(004).                              D.970820
001140     02  F              PIC  X(006).                              I.970820
001150     02  UR-PEY         PIC  9(002).
001160     02  F              PIC  X(004).
001170     02  UR-HCD         PIC  X(005).
001180     02  F              PIC  X(016).
001190     02  UR-KIN         PIC S9(008).
001200     02  UR-YC          PIC  9(002).                              I.980326
001210*****02  F              PIC  X(015).                              D.001101
001220     02  F              PIC  X(012).                              I.001101
001230     02  UR-BKC         PIC  9(002).                              I.000620
001240     02  F              PIC  X(070).                              I.010907
001250*****02  F              PIC  X(027).                              D.010907
001260*****02  F              PIC  X(003).                              D.001101
001270*****02  F              PIC  X(020).                              D.000620
001280*****02  F              PIC  X(022).                              D.980326
001290*****02  F              PIC  X(024).                              D.970820
001300*FD  KNBR-F                                                       D.910702
001310*****BLOCK 6 RECORDS                                              D.910702
001320*****LABEL RECORD IS STANDARD                                     D.910702
001330*****VALUE OF IDENTIFICATION "KNBRF".                             D.910702
001340*01  KNBR-R.                                                      D.910702
001350*****02  F          PIC X(4).                                     D.910702
001360*****02  NB-PEY     PIC 9(2).                                     D.910702
001370*****02  F          PIC X(4).                                     D.910702
001380*****02  NB-HCD     PIC X(5).                                     D.910702
001390*****02  NB-KIN     PIC S9(8).                                    D.910702
001400*****02  F          PIC X(10).                                    D.910702
001410*****02  NB-DC      PIC 9(1).                                     D.910702
001420*****02  F          PIC X(8).                                     D.910702
001430 WORKING-STORAGE SECTION.
001440 01  HEAD1.
001450     02  F              PIC  X(005) VALUE ""3FE04FE080"".           A 62/0
001460     02  F              PIC  X(036) VALUE SPACE.                    C 62/0
001470     02  F              PIC  N(019) VALUE                           C 62/0
001480          NC"＊＊＊　　工品・材料　日計表　　＊＊＊".             C 62/04
001490     02  F              PIC  X(028) VALUE SPACE.
001500     02  F              PIC  X(005) VALUE "DATE ".
001510     02  H-DATE         PIC 99B99B99.
001520 01  HEAD2.
001530     02  F              PIC  X(008) VALUE SPACE.
001540     02  F              PIC  X(024) VALUE                           C 62/0
001550           "I-----------------------".                              C 62/0
001560     02  F              PIC  N(006) VALUE NC"　売　　上　".
001570     02  F              PIC  X(031) VALUE
001580          "----------------------I I------".                      C 62/04
001590     02  F              PIC  N(005) VALUE NC"　入　金　".
001600     02  F              PIC  X(012) VALUE "-----I I----".
001610     02  F              PIC  N(007) VALUE NC"　売　掛　残　".
001620     02  F              PIC  X(004) VALUE "---I".
001630 01  HEAD3.
001640     02  F              PIC  X(001) VALUE SPACE.
001650     02  F              PIC  N(003) VALUE NC"日　付".               C 62/0
001660     02  F              PIC  X(005) VALUE SPACE.
001670     02  F              PIC  N(022) VALUE
001680          NC"　防　振　　　その他　　工品合計　　　材　料".       I.060908
001690*****     NC"自動車用　　　産業用　　工品合計　　　材　料".       D.060908
001700     02  F              PIC  X(005) VALUE SPACE.
001710     02  F              PIC  N(003) VALUE NC"消費税".               C 62/0
001720     02  F              PIC  X(007) VALUE SPACE.
001730     02  F              PIC  N(003) VALUE NC"売　上".               C 62/0
001740     02  F              PIC  X(005) VALUE SPACE.
001750     02  F              PIC  N(003) VALUE NC"消費税".               C 62/0
001760     02  F              PIC  X(007) VALUE SPACE.
001770     02  F              PIC  N(003) VALUE NC"売　上".               C 62/0
001780     02  F              PIC  X(005) VALUE SPACE.
001790     02  F              PIC  N(003) VALUE NC"消費税".               C 62/0
001800 01  W-P.
001810     02  P-DATE         PIC 99/99/99.
001820     02  P-TM    REDEFINES P-DATE  PIC  N(004).
001830     02  P-KGU          PIC ----,---,--9.
001840     02  P-KSU          PIC ----,---,--9.
001850     02  P-KTO          PIC ----,---,--9.
001860     02  P-BND   REDEFINES P-KTO.                                 I.000620
001870       03  P-BN         PIC  N(006).                              I.000620
001880     02  P-ZRU          PIC ----,---,--9.
001890     02  P-USZ          PIC ---,---,--9.
001900     02  P-NKU          PIC -----,---,--9.
001910     02  P-NKZ          PIC ---,---,--9.
001920     02  P-UZU          PIC -----,---,--9.
001930     02  P-UZZ          PIC ---,---,--9.
001940 01  W-D.
001950     02  W-KGU   OCCURS 31  PIC S9(009).
001960     02  W-KSU   OCCURS 31  PIC S9(009).
001970     02  W-KTO   OCCURS 31  PIC S9(009).
001980     02  W-ZRU   OCCURS 31  PIC S9(009).
001990     02  W-USZ   OCCURS 31  PIC S9(008).
002000     02  W-NKU   OCCURS 31  PIC S9(009).
002010     02  W-NKZ   OCCURS 31  PIC S9(008).
002020 01  WT-D.
002030     02  WT-KGU         PIC S9(009).
002040     02  WT-KSU         PIC S9(009).
002050     02  WT-KTO         PIC S9(009).
002060     02  WT-ZRU         PIC S9(009).
002070     02  WT-USZ         PIC S9(008).
002080     02  WT-NKU         PIC S9(009).
002090     02  WT-NKZ         PIC S9(008).
002100*
002110*****02  WT-20          PIC S9(009).                              D.030811
002120     02  WT-21          PIC S9(009).                              I.000620
002130     02  WT-22          PIC S9(009).                              I.000620
002140     02  WT-23          PIC S9(009).                              I.000620
002150     02  WT-24          PIC S9(009).                              I.000620
002160     02  WT-25          PIC S9(009).                              I.000620
002170     02  WT-26          PIC S9(009).                              I.030811
002180     02  WT-27          PIC S9(009).                              I.030811
002190     02  WT-28          PIC S9(009).                              I.030811
002200     02  WT-29          PIC S9(009).                              I.030811
002210*****02  WT-30          PIC S9(009).                              D.030811
002220     02  WT-31          PIC S9(009).                              I.000620
002230     02  WT-32          PIC S9(009).                              I.000620
002240     02  WT-33          PIC S9(009).                              I.000620
002250     02  WT-41          PIC S9(009).                              I.030811
002260 01  W-DATA.
002270*****02  W-DATE         PIC  9(006).                              D.971013
002280     02  W-DATE         PIC  9(008).                              I.971013
002290     02  W-NGP   REDEFINES W-DATE.
002300       03  W-NG.
002310*****    04  W-NEN      PIC  9(002).                              D.971013
002320         04  W-NEN      PIC  9(004).                              I.971013
002330         04  W-NENL  REDEFINES W-NEN.                             I.971013
002340           05  W-NEN1   PIC  9(002).                              I.971013
002350           05  W-NEN2   PIC  9(002).                              I.971013
002360         04  W-GET      PIC  9(002).
002370       03  W-NGL   REDEFINES W-NG.                                I.971013
002380         04  F          PIC  9(002).                              I.971013
002390         04  W-NGS      PIC  9(004).                              I.971013
002400       03  W-PEY        PIC  9(002).
002410     02  W-NGPL  REDEFINES W-DATE.                                I.971013
002420       03  F            PIC  9(002).                              I.971013
002430       03  W-NGPS       PIC  9(006).                              I.971013
002440*****02  W-YMD          PIC  9(006).                              D.971013
002450     02  W-YMD          PIC  9(008).                              I.971013
002460     02  W-YMDD  REDEFINES W-YMD.
002470       03  W-YM.
002480*****    04  W-YD       PIC  9(002).                              D.971013
002490         04  W-YD       PIC  9(004).                              I.971013
002500         04  W-MD       PIC  9(002).
002510       03  W-DD         PIC  9(002).
002520     02  W-UZ.
002530       03  W-UZU        PIC S9(009).
002540       03  W-UZZ        PIC S9(008).
002550     02  WC-UZ.
002560       03  WC-UZU       PIC S9(009).
002570       03  WC-UZZ       PIC S9(008).
002580     02  W-DMM          PIC  9(001).
002590     02  W-KIN          PIC S9(009).                              I.000620
002600 01  ERR-STAT           PIC  X(002).
002610 SCREEN SECTION.
002620 SD  C-CRT
002630     END STATUS IS ESTAT.
002640 01  C-CLEAR.
002650     02  C-CL   LINE  1  CLEAR SCREEN.
002660 01  C-MID.
002670     02  LINE   3  COLUMN  10  PIC  N(019) VALUE
002680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002690     02  LINE   4  COLUMN  10  PIC  N(019) VALUE
002700          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002710     02  LINE   5  COLUMN  10  PIC  N(019) VALUE
002720          NC"＊＊＊　　　　　　　　　　　　　＊＊＊".
002730     02  LINE   6  COLUMN  10  PIC  N(019) VALUE
002740          NC"＊＊＊　　工品・材料　日計表　　＊＊＊".
002750     02  LINE   7  COLUMN  10  PIC  N(019) VALUE
002760          NC"＊＊＊　　　　　　　　　　　　　＊＊＊".
002770     02  LINE   8  COLUMN  10  PIC  N(019) VALUE
002780          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002790     02  LINE   9  COLUMN  10  PIC  N(019) VALUE
002800          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002810 01  C-DSP.
002820     02  D-NN.
002830       03  LINE  11  COLUMN  10  PIC  N(013) VALUE
002840            NC"日計更新をやってない".
002850       03  LINE  13  COLUMN  10  PIC  N(021) VALUE
002860            NC"実行＝ＲＥＳＥＴ　終了＝プログラム放棄".
002870     02  D-UZ.
002880       03  LINE  15  COLUMN  16  PIC  N(013) VALUE
002890            NC"［　マスターの売掛残高　］" REVERSE.
002900       03  LINE  17  COLUMN  15  PIC  N(014) VALUE
002910            NC"　　　　売　上　　　　消費税".
002920       03  LINE  18.
002930         04  COLUMN  15  PIC --,---,---,--9  FROM  WC-UZU.
002940         04  COLUMN  29  PIC --,---,---,--9  FROM  WC-UZZ.
002950 01  C-ACP.
002960     02  A-DMM   LINE  20  COLUMN  43  PIC  9(001)
002970          USING W-DMM   CHECK OVERFLOW NO IFC.
002980 01  E-ERR.
002990     02  LINE  24.
003000       03  E-ME1   COLUMN  15  PIC  X(024) VALUE
003010            "***  ｳﾘｶｹｻﾞﾝﾀﾞｶ ｴﾗｰ  ***".
003020       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
003030            "***  CALNM ﾅｼ  ***".
003040       03  E-ME3   COLUMN  15  PIC  X(024) VALUE                  I.991214
003050            "***  ﾆｭｳｷﾝ ﾐﾊｯｺｳ ｱﾘ  ***".                           I.991214
003060*****  03  E-KEY   COLUMN  35  PIC  X(006) FROM  CL-KEY.          D.971013
003070       03  E-KEY   COLUMN  35  PIC  X(008) FROM  CL-KEY.          I.971013
003080       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003090       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003100       03  E-CL    COLUMN  10  PIC  X(050) VALUE
003110            "                                                  ".
003120     COPY LIBSCR.
003130 PROCEDURE DIVISION.
003140 M-05.
003150     MOVE ZERO TO W-DATA.
003160     COPY LIBCPR.
003170*****MOVE D-NKNG TO W-NG.                                         D.971013
003180     MOVE DATE-03R TO H-DATE.
003190     MOVE D-NKNG TO W-NGS.                                        I.971013
003200     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.971013
003210         ADD DATE-NC1 TO W-NEN.                                   I.971013
003220     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.971013
003230         ADD DATE-NC2 TO W-NEN.                                   I.971013
003240     DISPLAY C-CLEAR.
003250     DISPLAY C-MID.
003260     PERFORM S-25 THRU S-50.
003270*****OPEN INPUT KT-M.                                             D.000224
003280     OPEN INPUT TT-M.                                             I.000224
003290 M-10.
003300*****READ KT-M AT END                                             D.000224
003310     READ TT-M AT END                                             I.000224
003320         GO TO M-15.
003330     IF TT-BC = 0                                                 I.000224
003340         GO TO M-10.                                              I.000224
003350*****ADD KT-TZZ TO W-UZU.                                         D.000224
003360*****ADD KT-TZZZ TO W-UZZ.                                        D.000224
003370*****ADD KT-TUZ TO WC-UZU.                                        D.000224
003380*****ADD KT-TUZZ TO WC-UZZ.                                       D.000224
003390     ADD TT-TZZ TO W-UZU.                                         I.000224
003400     ADD TT-TZZZ TO W-UZZ.                                        I.000224
003410     ADD TT-TUZ TO WC-UZU.                                        I.000224
003420     ADD TT-TUZZ TO WC-UZZ.                                       I.000224
003430     GO TO M-10.
003440 M-15.
003450     CLOSE TT-M.                                                  I.000224
003460*****CLOSE KT-M.                                                  D.000224
003470     MOVE ZERO TO W-D WT-D.
003480     MOVE W-DATE TO W-YMD.
003490     OPEN INPUT CALNM.
003500     OPEN INPUT URIR-F.
003510 M-20.
003520     READ URIR-F AT END
003530         GO TO M-40.
003540     IF UR-KIN = ZERO
003550         GO TO M-20.
003560     MOVE UR-PEY TO W-DD.
003570     PERFORM S-15 THRU S-20.
003580     IF UR-DC > 7                                                 I.910702
003590         GO TO M-30.                                              I.910702
003600     IF UR-YC NOT = 00                                            I.000620
003610         GO TO M-25.                                              I.000620
003620     IF UR-DC = 5 OR 9                                            I.000620
003630         GO TO M-25.                                              I.000620
003640*****IF UR-HCD = "00800"                                          D.980326
003650*****IF UR-YC = 00                                                D.000620
003660*****    IF UR-DC NOT = 5 AND 9                                   D.000620
003670*****        ADD UR-KIN TO W-ZRU(W-DD)                            D.000620
003680     ADD UR-KIN TO W-ZRU(W-DD).                                   I.000620
003690*****IF UR-BKC = 20                                               D.030811
003700*****    ADD UR-KIN TO WT-20.                                     D.030811
003710     IF UR-BKC = 21                                               I.000620
003720         ADD UR-KIN TO WT-21.                                     I.000620
003730     IF UR-BKC = 22                                               I.000620
003740         ADD UR-KIN TO WT-22.                                     I.000620
003750     IF UR-BKC = 23                                               I.000620
003760         ADD UR-KIN TO WT-23.                                     I.000620
003770     IF UR-BKC = 24                                               I.000620
003780         ADD UR-KIN TO WT-24.                                     I.000620
003790     IF UR-BKC = 25                                               I.000620
003800         ADD UR-KIN TO WT-25.                                     I.000620
003810     IF UR-BKC = 26                                               I.030811
003820         ADD UR-KIN TO WT-26.                                     I.030811
003830     IF UR-BKC = 27                                               I.030811
003840         ADD UR-KIN TO WT-27.                                     I.030811
003850     IF UR-BKC = 28                                               I.030811
003860         ADD UR-KIN TO WT-28.                                     I.030811
003870     IF UR-BKC = 29                                               I.030811
003880         ADD UR-KIN TO WT-29.                                     I.030811
003890*****IF UR-BKC = 30                                               D.030811
003900*****    ADD UR-KIN TO WT-30.                                     D.030811
003910     IF UR-BKC = 31                                               I.000620
003920         ADD UR-KIN TO WT-31.                                     I.000620
003930     IF UR-BKC = 32                                               I.000620
003940         ADD UR-KIN TO WT-32.                                     I.000620
003950     IF UR-BKC = 33                                               I.000620
003960         ADD UR-KIN TO WT-33.                                     I.000620
003970     IF UR-BKC = 41                                               I.030811
003980         ADD UR-KIN TO WT-41.                                     I.030811
003990     GO TO M-20.
004000 M-25.                                                            I.000620
004010*****IF UR-HCD > "00000" AND < "01000"                            D.060907
004020*****    ADD UR-KIN TO W-KSU(W-DD) W-KTO(W-DD)                    D.060907
004030*****    GO TO M-20.                                              D.060907
004040     IF UR-DC = 5
004050         ADD UR-KIN TO W-USZ(W-DD)
004060         GO TO M-20.
004070     IF UR-YC NOT = 10 AND 11                                     I.060907
004080         ADD UR-KIN TO W-KSU(W-DD) W-KTO(W-DD)                    I.060907
004090       ELSE                                                       I.060907
004100         ADD UR-KIN TO W-KGU(W-DD) W-KTO(W-DD).
004110     GO TO M-20.
004120 M-30.
004130*****IF UR-HCD = "00800"                                          D.980326
004140*****IF UR-YC = 00                                                D.000620
004150*****    IF UR-DC NOT = 5 AND 9                                   D.000620
004160*****        SUBTRACT UR-KIN FROM W-ZRU(W-DD)                     D.000620
004170     IF UR-YC NOT = 00                                            I.000620
004180         GO TO M-35.                                              I.000620
004190     IF UR-DC = 5 OR 9                                            I.000620
004200         GO TO M-35.                                              I.000620
004210     SUBTRACT UR-KIN FROM W-ZRU(W-DD).                            I.000620
004220*****IF UR-BKC = 20                                               D.030811
004230*****    SUBTRACT UR-KIN FROM WT-20.                              D.030811
004240     IF UR-BKC = 21                                               I.000620
004250         SUBTRACT UR-KIN FROM WT-21.                              I.000620
004260     IF UR-BKC = 22                                               I.000620
004270         SUBTRACT UR-KIN FROM WT-22.                              I.000620
004280     IF UR-BKC = 23                                               I.000620
004290         SUBTRACT UR-KIN FROM WT-23.                              I.000620
004300     IF UR-BKC = 24                                               I.000620
004310         SUBTRACT UR-KIN FROM WT-24.                              I.000620
004320     IF UR-BKC = 25                                               I.000620
004330         SUBTRACT UR-KIN FROM WT-25.                              I.000620
004340     IF UR-BKC = 26                                               I.030811
004350         SUBTRACT UR-KIN FROM WT-26.                              I.030811
004360     IF UR-BKC = 27                                               I.030811
004370         SUBTRACT UR-KIN FROM WT-27.                              I.030811
004380     IF UR-BKC = 28                                               I.030811
004390         SUBTRACT UR-KIN FROM WT-28.                              I.030811
004400     IF UR-BKC = 29                                               I.030811
004410         SUBTRACT UR-KIN FROM WT-29.                              I.030811
004420*****IF UR-BKC = 30                                               D.030811
004430*****    SUBTRACT UR-KIN FROM WT-30.                              D.030811
004440     IF UR-BKC = 31                                               I.000620
004450         SUBTRACT UR-KIN FROM WT-31.                              I.000620
004460     IF UR-BKC = 32                                               I.000620
004470         SUBTRACT UR-KIN FROM WT-32.                              I.000620
004480     IF UR-BKC = 33                                               I.000620
004490         SUBTRACT UR-KIN FROM WT-33.                              I.000620
004500     IF UR-BKC = 41                                               I.030811
004510         SUBTRACT UR-KIN FROM WT-41.                              I.030811
004520     GO TO M-20.                                                  I.910702
004530 M-35.                                                            I.000620
004540*****IF UR-HCD > "00000" AND < "01000"                            D.060907
004550*****    SUBTRACT UR-KIN FROM W-KSU(W-DD) W-KTO(W-DD)             D.060907
004560*****    GO TO M-20.                                              D.060907
004570     IF UR-DC = 9                                                 I.910702
004580         SUBTRACT UR-KIN FROM W-USZ(W-DD)                         I.910702
004590         GO TO M-20.                                              I.910702
004600     IF UR-YC NOT = 10 AND 11                                     I.060907
004610         SUBTRACT UR-KIN FROM W-KSU(W-DD) W-KTO(W-DD)             I.060907
004620       ELSE                                                       I.060907
004630         SUBTRACT UR-KIN FROM W-KGU(W-DD) W-KTO(W-DD).            I.910702
004640     GO TO M-20.                                                  I.910702
004650 M-40.
004660     CLOSE CALNM.
004670     CLOSE URIR-F.
004680*****OPEN INPUT KNBR-F.                                           D.910702
004690*M-43.                                                            D.910702
004700*****READ KNBR-F AT END                                           D.910702
004710*****    GO TO M-44.                                              D.910702
004720*****IF NB-KIN = ZERO                                             D.910702
004730*****    GO TO M-43.                                              D.910702
004740*****IF NB-HCD = "00800"                                          D.910702
004750*****    SUBTRACT NB-KIN FROM W-ZRU(NB-PEY)                       D.910702
004760*****    GO TO M-43.                                              D.910702
004770*****IF NB-HCD > "00000" AND < "01000"                            D.910702
004780*****    SUBTRACT NB-KIN FROM W-KSU(NB-PEY)                       D.910702
004790*****    SUBTRACT NB-KIN FROM W-KTO(NB-PEY)                       D.910702
004800*****    GO TO M-43.                                              D.910702
004810*****IF NB-DC = 5                                                 D.910702
004820*****    SUBTRACT NB-KIN FROM W-USZ(NB-PEY)                       D.910702
004830*****    GO TO M-43.                                              D.910702
004840*****SUBTRACT NB-KIN FROM W-KGU(NB-PEY).                          D.910702
004850*****SUBTRACT NB-KIN FROM W-KTO(NB-PEY).                          D.910702
004860*****GO TO M-43.                                                  D.910702
004870*M-44.                                                            D.910702
004880*****CLOSE KNBR-F.                                                D.910702
004890     OPEN INPUT NYUR-F.
004900 M-45.
004910     READ NYUR-F AT END
004920         GO TO M-50.
004930*****IF W-NG NOT = NUR-NGS                                        D.971013
004940     IF W-NG NOT = NUR-NG                                         I.971013
004950         GO TO M-45.
004960     IF NUR-KIN = ZERO
004970         GO TO M-45.
004980     IF NUR-BC = ZERO
004990         GO TO M-45.
005000     IF NUR-NC2 > 7
005010         ADD NUR-KIN TO W-NKZ(NUR-PEY)
005020       ELSE
005030         ADD NUR-KIN TO W-NKU(NUR-PEY).
005040     GO TO M-45.
005050 M-50.
005060     CLOSE NYUR-F.
005070     OPEN OUTPUT SP-F.
005080     MOVE SPACE TO SP-R.
005090     MOVE HEAD1 TO SP-R.
005100     WRITE SP-R.
005110     MOVE SPACE TO SP-R.
005120     MOVE HEAD2 TO SP-R.
005130     WRITE SP-R AFTER 2.
005140     MOVE SPACE TO SP-R.
005150     MOVE HEAD3 TO SP-R.
005160     WRITE SP-R.
005170     MOVE SPACE TO SP-R W-P.
005180     MOVE W-UZU TO P-UZU.
005190     MOVE W-UZZ TO P-UZZ.
005200     MOVE W-P TO SP-R.
005210     WRITE SP-R.
005220 M-55.
005230     ADD 1 TO W-PEY.
005240     IF W-PEY = 32
005250         GO TO M-60.
005260     PERFORM S-05 THRU S-10.
005270     GO TO M-55.
005280 M-60.
005290     MOVE SPACE TO SP-R W-P.
005300     MOVE NC"合　　計" TO P-TM.
005310     MOVE WT-KGU TO P-KGU.
005320     MOVE WT-KSU TO P-KSU.
005330     MOVE WT-KTO TO P-KTO.
005340     MOVE WT-ZRU TO P-ZRU.
005350     MOVE WT-USZ TO P-USZ.
005360     MOVE WT-NKU TO P-NKU.
005370     MOVE WT-NKZ TO P-NKZ.
005380     MOVE W-P TO SP-R.
005390     WRITE SP-R.
005400*
005410*****IF ZERO = WT-20 AND WT-21 AND WT-22 AND WT-23 AND WT-24 AND  D.030811
005420*****          WT-25 AND WT-30 AND WT-32 AND WT-32 AND WT-33      D.030811
005430     IF ZERO = WT-21 AND WT-22 AND WT-23 AND WT-24 AND WT-25 AND  I.030811
005440               WT-26 AND WT-27 AND WT-28 AND WT-29 AND            I.030811
005450               WT-31 AND WT-32 AND WT-33 AND WT-41                I.030811
005460         GO TO M-65.                                              I.000620
005470     MOVE SPACE TO SP-R.                                          I.000620
005480     WRITE SP-R AFTER 2.                                          I.000620
005490     OPEN INPUT BNM.                                              I.000620
005500*****IF WT-20 NOT = ZERO                                          D.030811
005510*****    MOVE WT-20 TO W-KIN                                      D.030811
005520*****    MOVE ZERO TO BNM-KEY                                     D.030811
005530*****    MOVE 20 TO BNM-BU                                        D.030811
005540*****    PERFORM S-55 THRU S-60.                                  D.030810
005550     IF WT-21 NOT = ZERO                                          I.000620
005560         MOVE WT-21 TO W-KIN                                      I.000620
005570         MOVE ZERO TO BNM-KEY                                     I.000620
005580         MOVE 21 TO BNM-BU                                        I.000620
005590         PERFORM S-55 THRU S-60.                                  I.000620
005600     IF WT-22 NOT = ZERO                                          I.000620
005610         MOVE WT-22 TO W-KIN                                      I.000620
005620         MOVE ZERO TO BNM-KEY                                     I.000620
005630         MOVE 22 TO BNM-BU                                        I.000620
005640         PERFORM S-55 THRU S-60.                                  I.000620
005650     IF WT-23 NOT = ZERO                                          I.000620
005660         MOVE WT-23 TO W-KIN                                      I.000620
005670         MOVE ZERO TO BNM-KEY                                     I.000620
005680         MOVE 23 TO BNM-BU                                        I.000620
005690         PERFORM S-55 THRU S-60.                                  I.000620
005700     IF WT-24 NOT = ZERO                                          I.000620
005710         MOVE WT-24 TO W-KIN                                      I.000620
005720         MOVE ZERO TO BNM-KEY                                     I.000620
005730         MOVE 24 TO BNM-BU                                        I.000620
005740         PERFORM S-55 THRU S-60.                                  I.000620
005750     IF WT-25 NOT = ZERO                                          I.000620
005760         MOVE WT-25 TO W-KIN                                      I.000620
005770         MOVE ZERO TO BNM-KEY                                     I.000620
005780         MOVE 25 TO BNM-BU                                        I.000620
005790         PERFORM S-55 THRU S-60.                                  I.000620
005800     IF WT-26 NOT = ZERO                                          I.030811
005810         MOVE WT-26 TO W-KIN                                      I.030811
005820         MOVE ZERO TO BNM-KEY                                     I.030811
005830         MOVE 26 TO BNM-BU                                        I.030811
005840         PERFORM S-55 THRU S-60.                                  I.030811
005850     IF WT-27 NOT = ZERO                                          I.030811
005860         MOVE WT-27 TO W-KIN                                      I.030811
005870         MOVE ZERO TO BNM-KEY                                     I.030811
005880         MOVE 27 TO BNM-BU                                        I.030811
005890         PERFORM S-55 THRU S-60.                                  I.030811
005900     IF WT-28 NOT = ZERO                                          I.030811
005910         MOVE WT-28 TO W-KIN                                      I.030811
005920         MOVE ZERO TO BNM-KEY                                     I.030811
005930         MOVE 28 TO BNM-BU                                        I.030811
005940         PERFORM S-55 THRU S-60.                                  I.030811
005950     IF WT-29 NOT = ZERO                                          I.030811
005960         MOVE WT-29 TO W-KIN                                      I.030811
005970         MOVE ZERO TO BNM-KEY                                     I.030811
005980         MOVE 29 TO BNM-BU                                        I.030811
005990         PERFORM S-55 THRU S-60.                                  I.030811
006000*****IF WT-30 NOT = ZERO                                          D.030811
006010*****    MOVE WT-30 TO W-KIN                                      D.030811
006020*****    MOVE ZERO TO BNM-KEY                                     D.030811
006030*****    MOVE 30 TO BNM-BU                                        D.030811
006040*****    PERFORM S-55 THRU S-60.                                  D.030811
006050     IF WT-31 NOT = ZERO                                          I.000620
006060         MOVE WT-31 TO W-KIN                                      I.000620
006070         MOVE ZERO TO BNM-KEY                                     I.000620
006080         MOVE 31 TO BNM-BU                                        I.000620
006090         PERFORM S-55 THRU S-60.                                  I.000620
006100     IF WT-32 NOT = ZERO                                          I.000620
006110         MOVE WT-32 TO W-KIN                                      I.000620
006120         MOVE ZERO TO BNM-KEY                                     I.000620
006130         MOVE 32 TO BNM-BU                                        I.000620
006140         PERFORM S-55 THRU S-60.                                  I.000620
006150     IF WT-33 NOT = ZERO                                          I.000620
006160         MOVE WT-33 TO W-KIN                                      I.000620
006170         MOVE ZERO TO BNM-KEY                                     I.000620
006180         MOVE 33 TO BNM-BU                                        I.000620
006190         PERFORM S-55 THRU S-60.                                  I.000620
006200     IF WT-41 NOT = ZERO                                          I.030811
006210         MOVE WT-41 TO W-KIN                                      I.030811
006220         MOVE ZERO TO BNM-KEY                                     I.030811
006230         MOVE 41 TO BNM-BU                                        I.030811
006240         PERFORM S-55 THRU S-60.                                  I.030811
006250     CLOSE BNM.                                                   I.000620
006260 M-65.
006270     CLOSE SP-F.
006280     IF W-UZU NOT = WC-UZU
006290         GO TO M-90.
006300     IF W-UZZ NOT = WC-UZZ
006310         GO TO M-90.
006320     GO TO M-95.
006330 M-90.
006340     DISPLAY D-UZ E-ME1 E-ME98.
006350     ACCEPT A-DMM.
006360 M-95.
006370     DISPLAY C-CLEAR.
006380     STOP RUN.
006390 S-05.
006400     IF ZERO = W-KGU(W-PEY) AND W-KSU(W-PEY) AND W-ZRU(W-PEY)
006410           AND W-USZ(W-PEY) AND W-NKU(W-PEY) AND W-NKZ(W-PEY)
006420         GO TO S-10.
006430     COMPUTE W-UZU = W-UZU + W-KTO(W-PEY) + W-ZRU(W-PEY)
006440                                          - W-NKU(W-PEY).
006450     COMPUTE W-UZZ = W-UZZ + W-USZ(W-PEY) - W-NKZ(W-PEY).
006460*
006470     MOVE SPACE TO SP-R W-P.
006480*****MOVE W-DATE TO P-DATE.                                       D.971013
006490     MOVE W-NGPS TO P-DATE.                                       I.971013
006500     MOVE W-KGU(W-PEY) TO P-KGU.
006510     MOVE W-KSU(W-PEY) TO P-KSU.
006520     MOVE W-KTO(W-PEY) TO P-KTO.
006530     MOVE W-ZRU(W-PEY) TO P-ZRU.
006540     MOVE W-USZ(W-PEY) TO P-USZ.
006550     MOVE W-NKU(W-PEY) TO P-NKU.
006560     MOVE W-NKZ(W-PEY) TO P-NKZ.
006570     MOVE W-UZU TO P-UZU.
006580     MOVE W-UZZ TO P-UZZ.
006590     MOVE W-P TO SP-R.
006600     WRITE SP-R.
006610     MOVE SPACE TO SP-R.
006620*
006630     ADD W-KGU(W-PEY) TO WT-KGU.
006640     ADD W-KSU(W-PEY) TO WT-KSU.
006650     ADD W-KTO(W-PEY) TO WT-KTO.
006660     ADD W-ZRU(W-PEY) TO WT-ZRU.
006670     ADD W-USZ(W-PEY) TO WT-USZ.
006680     ADD W-NKU(W-PEY) TO WT-NKU.
006690     ADD W-NKZ(W-PEY) TO WT-NKZ.
006700 S-10.
006710     EXIT.
006720 S-15.
006730     MOVE W-YMD TO CL-KEY.
006740     READ CALNM INVALID KEY
006750         DISPLAY E-ME2 E-KEY E-ME99
006760         MOVE ZERO TO CL-YB
006770         DISPLAY E-CL.
006780     IF CL-YB = 1
006790         SUBTRACT 1 FROM W-DD.
006800     IF W-DD = ZERO
006810         MOVE 2 TO W-DD.
006820 S-20.
006830     EXIT.
006840 S-25.
006850     OPEN INPUT URI-F.
006860     READ URI-F AT END
006870         GO TO S-30.
006880     CLOSE URI-F.
006890     GO TO S-45.
006900 S-30.
006910     CLOSE URI-F.
006920*****OPEN INPUT KNB-F.                                            D.970325
006930*****READ KNB-F AT END                                            D.970325
006940*****    GO TO S-32.                                              D.970325
006950*****CLOSE KNB-F.                                                 D.970325
006960*****GO TO S-45.                                                  D.970325
006970*S-32.                                                            D.970325
006980*****CLOSE KNB-F.                                                 D.970325
006990*****OPEN INPUT KNYU-F.                                           D.991203
007000*****READ KNYU-F AT END                                           D.991203
007010     OPEN INPUT NYU-F.                                            I.991203
007020 S-35.                                                            I.991203
007030     READ NYU-F NEXT RECORD AT END                                I.991203
007040         GO TO S-40.
007050     IF NYU-BC = 0                                                I.991203
007060         GO TO S-35.                                              I.991203
007070     IF NYU-DPC = 0                                               I.991214
007080         DISPLAY E-ME3 E-ME99                                     I.991214
007090         DISPLAY E-CL                                             I.991214
007100         GO TO S-35.                                              I.991214
007110*****CLOSE KNYU-F.                                                D.991203
007120     CLOSE NYU-F.                                                 I.991203
007130     GO TO S-45.
007140 S-40.
007150*****CLOSE KNYU-F.                                                D.991203
007160     CLOSE NYU-F.                                                 I.991203
007170     GO TO S-50.
007180 S-45.
007190     DISPLAY D-NN E-ME99.
007200 S-50.
007210     EXIT.
007220 S-55.                                                            I.000620
007230     READ BNM WITH UNLOCK INVALID KEY                             I.000620
007240         MOVE SPACE TO BNMNMN.                                    I.000620
007250     MOVE SPACE TO W-P.                                           I.000620
007260     MOVE BNMNMN TO P-BN.                                         I.000620
007270     MOVE W-KIN TO P-ZRU.                                         I.000620
007280     MOVE SPACE TO SP-R.                                          I.000620
007290     MOVE W-P TO SP-R.                                            I.000620
007300     WRITE SP-R.                                                  I.000620
007310     MOVE SPACE TO SP-R.                                          I.000620
007320 S-60.                                                            I.000620
007330     EXIT.                                                        I.000620
