000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHG930.
000030**********************************
000040*****     工品　月次更新     *****
000050**********************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     COPY LIBCSE.
000130*****SELECT KKB-M ASSIGN TO KKB-MSD                               D.000324
000140*****    ORGANIZATION INDEXED                                     D.000324
000150*****    ACCESS MODE IS RANDOM                                    D.000324
000160*****    RECORD KEY KKB-KEY                                       D.000324
000170*****    FILE STATUS IS ERR-STAT.                                 D.000324
000180*****SELECT KJ-M ASSIGN TO KJ-MSD                                 D.160127
000190*****    ORGANIZATION INDEXED                                     D.160127
000200*****    ACCESS MODE IS SEQUENTIAL                                D.160127
000210*****    RECORD KEY KJ-KEY                                        D.160127
000220*****    FILE STATUS IS ERR-STAT.                                 D.160127
000230     SELECT KH-M ASSIGN TO KH-MSD
000240         ORGANIZATION INDEXED
000250         ACCESS MODE IS RANDOM
000260         RECORD KEY KH-KEY
000270         FILE STATUS IS ERR-STAT.
000280     SELECT KHT-M ASSIGN TO KHT1-MSD KHT2-MSD
000290         ORGANIZATION INDEXED
000300         ACCESS MODE IS SEQUENTIAL
000310         RECORD KEY KHT-KEY
000320         ALTERNATE RECORD KEY KHT-KEYD
000330         FILE STATUS IS ERR-STAT.
000340*****SELECT KT-M ASSIGN TO KT-MSD                                 D.000224
000350*****SELECT TT-M ASSIGN TO TT-MSD                                 D.000324
000360*****    ORGANIZATION INDEXED                                     D.000324
000370*****    ACCESS MODE IS SEQUENTIAL                                D.000324
000380*****    RECORD KEY TT-KEY                                        D.000324
000390*****    RECORD KEY KT-KEY                                        D.000224
000400*****    FILE STATUS IS ERR-STAT.                                 D.000324
000410     SELECT KNHR-F ASSIGN TO KNHR-MSD.
000420*****SELECT KSR-F ASSIGN TO KSR-MSD.                              D.160127
000430     SELECT URIR-F ASSIGN TO URIR-MSD.
000440*****SELECT KAZR-F ASSIGN TO KAZR-MSD.                            D.970226
000450*****SELECT KKUH-F ASSIGN TO KKUH-MSD.                            D.961024
000460*****SELECT KHUH-F ASSIGN TO KHUH-MSD.                            D.961018
000470*****SELECT KKHR-F ASSIGN TO KKHR-MSD.                            D.160127
000480*****SELECT KST-F ASSIGN TO KST-MSD                               D.020829
000490*****     ORGANIZATION IS INDEXED                                 D.020829
000500*****     ACCESS MODE IS DYNAMIC                                  D.020829
000510*****     RECORD KEY IS KST-KEY                                   D.020829
000520*****     FILE STATUS IS ERR-STAT.                                D.020829
000530*****SELECT KKY-F ASSIGN TO KKY-MSD                               D.990526
000540*****    ORGANIZATION INDEXED                                     D.990526
000550*****    ACCESS MODE IS SEQUENTIAL                                D.990526
000560*****    RECORD KEY KKY-KEY                                       D.990526
000570*****    FILE STATUS IS ERR-STAT.                                 D.990526
000580*****SELECT TMS-F ASSIGN TO TMS-MSD                               D.000324
000590*****    FILE STATUS IS ERR-STAT.                                 D.000324
000600*****SELECT CALNM ASSIGN TO CALN-MSD                              D.000324
000610*****    ORGANIZATION INDEXED                                     D.000324
000620*****    ACCESS MODE IS DYNAMIC                                   D.000324
000630*****    RECORD KEY CL-KEY                                        D.000324
000640*****    FILE STATUS IS ERR-STAT.                                 D.000324
000650*****SELECT TZNT-M ASSIGN TO TZNT-MSD                             D.000324
000660*****    ORGANIZATION INDEXED                                     D.000324
000670*****    ACCESS MODE DYNAMIC                                      D.000324
000680*****    RECORD KEY TZNT-KEY                                      D.000324
000690*****    FILE STATUS ERR-STAT.                                    D.000324
000700*****SELECT HKBM ASSIGN TO HKB-MSD                                D.000324
000710*****    ORGANIZATION IS INDEXED                                  D.000324
000720*****    ACCESS MODE IS RANDOM                                    D.000324
000730*****    RECORD KEY IS HKB-KEY                                    D.000324
000740*****    FILE STATUS IS ERR-STAT.                                 D.000324
000750*****SELECT TUKF ASSIGN TO TUK-MSD                                D.000324
000760*****    ORGANIZATION INDEXED                                     D.000324
000770*****    RECORD KEY TUK-KEY                                       D.000324
000780*****    ACCESS MODE RANDOM                                       D.000324
000790*****    FILE STATUS IS ERR-STAT.                                 D.000324
000800 I-O-CONTROL.
000810     APPLY SHARED-MODE ON M-DATE
000820*****APPLY SHARED-MODE ON CALNM                                   D.000324
000830*****APPLY SHARED-MODE ON KKB-M                                   D.000324
000840*****APPLY SHARED-MODE ON TZNT-M                                  D.000324
000850*****APPLY SHARED-MODE ON HKBM                                    D.000324
000860*****APPLY SHARED-MODE ON TUKF                                    D.000324
000870     APPLY SHARED-MODE ON KH-M.
000880 DATA DIVISION.
000890 FILE SECTION.
000900     COPY LIBFDD.
000910*****COPY LIKKBM.                                                 D.000324
000920     COPY LIKHM.
000930     COPY LIKHTM.
000940*****COPY LIKJM.                                                  D.160127
000950*****COPY LITTM.                                                  D.000324
000960*****COPY LIKTM.                                                  D.000224
000970*****COPY LICAL.                                                  D.000324
000980*****COPY LIHKBM.                                                 D.000324
000990*****COPY LITUKF.                                                 D.000324
001000D****COPY LICALN.                                                 D.971014
001010 FD  KNHR-F
001020*****BLOCK  5 RECORDS                                             D.981210
001030     BLOCK  4 RECORDS                                             I.981210
001040     LABEL RECORD IS STANDARD
001050     VALUE OF IDENTIFICATION "KNHRF".                             C 62/04
001060 01  KNHR-R             PIC  X(064).                              I.981210
001070*01  KNHR-R             PIC  X(051).                              D.981210
001080*FD  KSR-F                                                        D.160127
001090*****BLOCK  4 RECORDS                                             D.160127
001100*****LABEL RECORD IS STANDARD                                     D.160127
001110*****VALUE OF IDENTIFICATION "KSRF".                              D.160127
001120*01  KSR-R              PIC  X(064).                              D.160127
001130 FD  URIR-F
001140*****BLOCK  4 RECORDS                                             D.001101
001150*****BLOCK  3 RECORDS                                             D.010910
001160     BLOCK  2 RECORDS                                             I.010910
001170     LABEL RECORD STANDARD
001180     VALUE OF IDENTIFICATION "URIRF".                             C 62/04
001190 01  URIR-R             PIC  X(128).                              I.010910
001200*01  URIR-R             PIC  X(085).                              D.010910
001210*01  URIR-R             PIC  X(064).                              D.001101
001220*FD  KAZR-F                                                       D.970226
001230*****BLOCK  8 RECORDS                                             D.970226
001240*****LABEL RECORD STANDARD                                        D.970226
001250*****VALUE OF IDENTIFICATION "KAZRF".                             D.970226
001260*01  KAZR-R             PIC  X(032).                              D.970226
001270*FD  KKUH-F                                                       D.961024
001280*****BLOCK  8 RECORDS                                             D.961024
001290*****LABEL RECORD STANDARD                                        D.961024
001300*****VALUE OF IDENTIFICATION "KKUHF".                             D.961024
001310*01  KKUH-R             PIC  X(032).                              D.961024
001320*FD  KHUH-F                                                       D.961018
001330*****BLOCK  6 RECORDS                                             D.961018
001340*****LABEL RECORD STANDARD                                        D.961018
001350*****VALUE OF IDENTIFICATION "KHUHF".                             D.961018
001360*01  KHUH-R.                                                      D.961018
001370*****02  UH-CO          PIC  X(005).                              D.961018
001380*****02  F              PIC  X(021).                              D.961018
001390*****02  UH-ZS          PIC S9(006).                              D.961018
001400*****02  F              PIC  X(001).                              D.961018
001410*****02  UH-YC          PIC  9(002).                              D.961018
001420*****02  F              PIC  X(007).                              D.961018
001430*FD  YG-F                                                         D.910909
001440*****BLOCK 16 RECORDS                                             D.910909
001450*****LABEL RECORD STANDARD                                        D.910909
001460*****VALUE OF IDENTIFICATION "YGF".                               D.910909
001470*01  YG-R.                                                        D.910909
001480*****02  YG-TCD       PIC  9(004).                                D.910909
001490*****02  YG-KIN       PIC S9(006).                                D.910909
001500*****02  YG-ZC        PIC  9(001).                                D.910909
001510*****02  F            PIC  X(005).                                D.910909
001520*FD  KKHR-F                                                       D.160127
001530*****BLOCK  8 RECORDS                                             D.160127
001540*****LABEL RECORD STANDARD                                        D.160127
001550*****VALUE OF IDENTIFICATION "KKHRF".                             D.160127
001560*01  KKHR-R             PIC  X(032).                              D.160127
001570*FD  KST-F                                                        D.020829
001580*****BLOCK  5 RECORDS                                             D.020829
001590*****LABEL RECORD IS STANDARD                                     D.020829
001600*****VALUE OF IDENTIFICATION "KSTF".                              D.020829
001610*01  KST-R.                                                       D.020829
001620*****02  KST-KEY.                                                 D.020829
001630*****  03  KST-NG       PIC  9(006).                              D.020829
001640*****  03  KST-NGD   REDEFINES KST-NG.                            D.020829
001650*****    04  F          PIC  9(002).                              D.020829
001660*****    04  KST-NGS    PIC  9(004).                              D.020829
001670*****  03  KST-HCD      PIC  X(005).                              D.020829
001680*****02  KST-ATS        PIC S9(006).                              D.020829
001690*****02  KST-AYS        PIC S9(006).                              D.020829
001700*****02  KST-AYY        PIC S9(006).                              D.020829
001710*****02  KST-BTS        PIC S9(006).                              D.020829
001720*****02  KST-BYS        PIC S9(006).                              D.020829
001730*****02  KST-BYY        PIC S9(006).                              D.020829
001740*****02  F              PIC  X(004).                              D.020829
001750*FD  KKY-F                                                        D.990526
001760*****BLOCK  3 RECORDS                                             D.961128
001770*****BLOCK  2 RECORDS                                             D.990526
001780*****LABEL RECORD STANDARD                                        D.990526
001790*****VALUE OF IDENTIFICATION "KKYF".                              D.990526
001800*01  KKY-R.                                                       D.990526
001810*****02  KKY-KEY        PIC  X(005).                              D.990526
001820*****02  KKY-D1         PIC  X(030).                              D.961128
001830*****02  KKY-D2         PIC  X(030).                              D.961128
001840*****02  KKY-D1         PIC  X(048).                              D.990526
001850*****02  KKY-D2         PIC  X(048).                              D.990526
001860*****02  KKY-YC         PIC  9(002).                              D.990526
001870*****02  KKY-KIS        PIC  9(001).                              D.990526
001880*****02  KKY-KIST       PIC  9(001).                              D.961128
001890*****02  KKY-KISY       PIC  9(001).                              D.961128
001900*****02  F              PIC  X(020).                              D.961119
001910*****02  F              PIC  X(015).                              D.961128
001920*****02  F              PIC  X(024).                              D.990526
001930*FD  TMS-F                                                        D.000324
001940*****BLOCK  6 RECORDS                                             D.970820
001950*****BLOCK  5 RECORDS                                             D.000324
001960*****LABEL RECORD STANDARD                                        D.000324
001970*****VALUE OF IDENTIFICATION "TMSF".                              D.000324
001980*01  TMS-R.                                                       D.000324
001990*****02  TMS-TCD        PIC  9(004).                              D.000324
002000*****02  TMS-SP         PIC  9(002).                              D.000324
002010*****02  TMS-SK         PIC  9(001).                              D.000324
002020*****02  TMS-DATE       PIC  9(006).                              D.970820
002030*****02  TMS-DATE       PIC  9(008).                              D.000324
002040*****02  TMS-KIN        PIC S9(009).                              D.000324
002050*****02  TMS-SHZ        PIC S9(007).                              D.000324
002060*****02  TMS-KBN        PIC  9(001).                              D.000324
002070*****02  F              PIC  X(019).                              D.000324
002080*****02  F              PIC  X(012).                              D.970820
002090*FD  TZNT-M                                                       D.000324
002100*****BLOCK  1 RECORDS                                             D.000324
002110*****LABEL RECORD IS STANDARD                                     D.000324
002120*****VALUE OF IDENTIFICATION "TZNTM".                             D.000324
002130*01  TZNT-R.                                                      D.000324
002140*****02  TZNT-KEY.                                                D.000324
002150*****  03  TZNT-TCD     PIC  9(004).                              D.000324
002160*****  03  TZNT-IKC     PIC  9(001).                              D.000324
002170*****02  TZNT-OUD       PIC  X(108).                              D.000324
002180*****02  TZNT-NUD.                                                D.000324
002190*****  03  TZNT-NU05    PIC S9(009).                              D.000324
002200*****  03  TZNT-NU06    PIC S9(009).                              D.000324
002210*****  03  TZNT-NU07    PIC S9(009).                              D.000324
002220*****  03  TZNT-NU08    PIC S9(009).                              D.000324
002230*****  03  TZNT-NU09    PIC S9(009).                              D.000324
002240*****  03  TZNT-NU10    PIC S9(009).                              D.000324
002250*****  03  TZNT-NU11    PIC S9(009).                              D.000324
002260*****  03  TZNT-NU12    PIC S9(009).                              D.000324
002270*****  03  TZNT-NU01    PIC S9(009).                              D.000324
002280*****  03  TZNT-NU02    PIC S9(009).                              D.000324
002290*****  03  TZNT-NU03    PIC S9(009).                              D.000324
002300*****  03  TZNT-NU04    PIC S9(009).                              D.000324
002310*****02  TZNT-TUD.                                                D.000324
002320*****  03  TZNT-OTU     PIC S9(010).                              D.000324
002330*****  03  TZNT-NTU     PIC S9(010).                              D.000324
002340*****02  TZNT-OAD       PIC  X(108).                              D.000324
002350*****02  TZNT-NAD.                                                D.000324
002360*****  03  TZNT-NA05    PIC S9(009).                              D.000324
002370*****  03  TZNT-NA06    PIC S9(009).                              D.000324
002380*****  03  TZNT-NA07    PIC S9(009).                              D.000324
002390*****  03  TZNT-NA08    PIC S9(009).                              D.000324
002400*****  03  TZNT-NA09    PIC S9(009).                              D.000324
002410*****  03  TZNT-NA10    PIC S9(009).                              D.000324
002420*****  03  TZNT-NA11    PIC S9(009).                              D.000324
002430*****  03  TZNT-NA12    PIC S9(009).                              D.000324
002440*****  03  TZNT-NA01    PIC S9(009).                              D.000324
002450*****  03  TZNT-NA02    PIC S9(009).                              D.000324
002460*****  03  TZNT-NA03    PIC S9(009).                              D.000324
002470*****  03  TZNT-NA04    PIC S9(009).                              D.000324
002480*****02  TZNT-TAD.                                                D.000324
002490*****  03  TZNT-OTA     PIC S9(010).                              D.000324
002500*****  03  TZNT-NTA     PIC S9(010).                              D.000324
002510*****02  TZNT-NG.                                                 D.000324
002520*****  03  TZNT-NEN     PIC  9(002).                              D.970820
002530*****  03  TZNT-NEN     PIC  9(004).                              D.000324
002540*****  03  TZNT-GET     PIC  9(002).                              D.000324
002550*****02  TZNT-TNC       PIC  9(002).                              D.000324
002560*****02  TZNT-BC        PIC  9(001).                              D.000324
002570*****02  F              PIC  X(026).                              D.000324
002580*****02  F              PIC  X(028).                              D.970820
002590 WORKING-STORAGE SECTION.
002600 77  W-FILE             PIC  X(013).                              I.940602
002610 01  W-DATA.
002620     02  W-JZS          PIC S9(007).
002630     02  W-HZS          PIC S9(006)V9(02).
002640     02  W-HZK          PIC S9(008).
002650     02  W-NG           PIC  9(004).                              I.000329
002660*****02  W-ERR          PIC  9(001) VALUE 0.                      D.000324
002670*****02  W-KIN          PIC S9(009).                              D.000324
002680*****02  W-SHZ          PIC S9(007).                              D.000324
002690*****02  W-DATE         PIC  9(006).                              D.971014
002700*****02  W-NGP   REDEFINES W-DATE.                                D.971014
002710*****02  W-NGP.                                                   D.000324
002720*****  03  W-NG.                                                  D.000324
002730*****    04  W-NEN      PIC  9(002).                              D.971014
002740*****    04  W-NEN      PIC  9(004).                              D.000324
002750*****    04  W-NENL  REDEFINES W-NEN.                             D.000324
002760*****      05  W-NEN1   PIC  9(002).                              D.000324
002770*****      05  W-NEN2   PIC  9(002).                              D.000324
002780*****    04  W-GET      PIC  9(002).                              D.000324
002790*****  03  W-NGL   REDEFINES W-NG.                                D.000324
002800*****    04  F          PIC  9(002).                              D.000324
002810*****    04  W-NGS      PIC  9(004).                              D.000324
002820*****  03  W-PEY        PIC  9(002).                              D.000324
002830*****02  W-NGPL  REDEFINES W-NGP.                                 D.000324
002840*****  03  F            PIC  9(002).                              D.000324
002850*****  03  W-NGPS       PIC  9(006).                              D.000324
002860*****02  W-NGPD.                                                  D.000324
002870*****  03  W-NGD        PIC  9(006).                              D.000324
002880*****  03  W-PEYD       PIC  9(002).                              D.000324
002890*****02  W-UKIN         PIC S9(009).                              D.000324
002900*****02  W-AKIN         PIC S9(009).                              D.000324
002910*01  W-YD.                                                        D.910909
002920*****02  W-UZ         PIC S9(006).                                D.910909
002930*****02  W-UZ1        PIC S9(006)V9(03).                          D.910909
002940*****02  W-UZ2   REDEFINES W-UZ1   PIC S9(009).                   D.910909
002950 01  ERR-STAT           PIC  X(002).
002960*****COPY LDAIW.                                                  D.000324
002970 SCREEN SECTION.
002980 SD  C-CRT
002990     END STATUS IS ESTAT.
003000 01  C-CLEAR.
003010     02  C-CL   LINE   1  CLEAR SCREEN.
003020 01  C-MID.
003030     02  LINE   3  COLUMN  10  PIC  N(023) VALUE                  I.000324
003040          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.000324
003050     02  LINE   4  COLUMN  10  PIC  N(023) VALUE                  I.000324
003060          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.000324
003070     02  LINE   5  COLUMN  10  PIC  N(023) VALUE                  I.000324
003080          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.000324
003090     02  LINE   6  COLUMN  10  PIC  N(023) VALUE                  I.000324
003100          NC"＊＊＊　　工品他　月次　更新・クリア　　＊＊＊".     I.000324
003110     02  LINE   7  COLUMN  10  PIC  N(023) VALUE                  I.000324
003120          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.000324
003130     02  LINE   8  COLUMN  10  PIC  N(023) VALUE                  I.000324
003140          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.000324
003150     02  LINE   9  COLUMN  10  PIC  N(023) VALUE                  I.000324
003160          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.000324
003170*****02  LINE   3  COLUMN  10  PIC  N(024) VALUE                  D.000324
003180*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.000324
003190*****02  LINE   4  COLUMN  10  PIC  N(024) VALUE                  D.000324
003200*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.000324
003210*****02  LINE   5  COLUMN  10  PIC  N(024) VALUE                  D.000324
003220*****     NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".   D.000324
003230*****02  LINE   6  COLUMN  10  PIC  N(024) VALUE                  D.000324
003240*****     NC"＊＊＊　　工品月次　更新・累積・クリア　　＊＊＊".   D.000324
003250*****02  LINE   7  COLUMN  10  PIC  N(024) VALUE                  D.000324
003260*****     NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".   D.000324
003270*****02  LINE   8  COLUMN  10  PIC  N(024) VALUE                  D.000324
003280*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.000324
003290*****02  LINE   9  COLUMN  10  PIC  N(024) VALUE                  D.000324
003300*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.000324
003310 01  C-ERR.
003320     02  LINE  24.
003330       03  E-ME1   COLUMN  15  PIC  X(025) VALUE
003340            "***  KJM REWRITE ｴﾗｰ  ***".
003350       03  E-ME2   COLUMN  15  PIC  X(026) VALUE
003360            "***  KHTM REWRITE ｴﾗｰ  ***".
003370*****  03  E-ME3   COLUMN  15  PIC  X(025) VALUE                  D.000324
003380*****       "***  TTM REWRITE ｴﾗｰ  ***".                          D.000324
003390*****       "***  KTM REWRITE ｴﾗｰ  ***".                          D.000224
003400       03  E-ME4   COLUMN  15  PIC  X(016) VALUE
003410            "***  KHM ﾅｼ  ***".
003420*****  03  E-ME5   COLUMN  15  PIC  X(026) VALUE                  D.970109
003430*****       "***  KKYF REWRITE ｴﾗｰ  ***".                         D.970109
003440       03  E-ME6   COLUMN  15  PIC  X(018) VALUE
003450            "***  DATEM ﾅｼ  ***".
003460       03  E-ME7   COLUMN  15  PIC  X(027) VALUE
003470            "***  DATEM REWRITE ｴﾗｰ  ***".
003480*****  03  E-ME15  COLUMN  15  PIC  X(025) VALUE                  D.020829
003490*****       "***  KSTF DELETE ｴﾗｰ  ***".                          D.020829
003500*****  03  E-ME8   COLUMN  15  PIC  X(017) VALUE                  D.000324
003510*****       "***  KKBM ﾅｼ  ***".                                  D.000324
003520*****  03  E-ME9   COLUMN  15  PIC  X(026) VALUE                  D.000324
003530*****       "***  KKBM REWRITE ｴﾗｰ  ***".                         D.000324
003540*****  03  E-ME10  COLUMN  15  PIC  X(024) VALUE                  D.000324
003550*****       "***  TMSF WRITE ｴﾗｰ  ***".                           D.000324
003560*****  03  E-ME11.                                                D.000324
003570*****    04  COLUMN  15  PIC  X(027) VALUE                        D.000324
003580*****         "***  CALNM ﾅｼ (      )  ***".                      D.000324
003590*****    04  COLUMN  30  PIC  X(006) FROM  W-NG.                  D.000324
003600*****    04  COLUMN  15  PIC  X(025) VALUE                        D.971014
003610*****         "***  CALNM ﾅｼ (    )  ***".                        D.971014
003620*****    04  COLUMN  30  PIC  X(004) FROM  W-NG.                  D.971014
003630*****  03  E-ME12  COLUMN  15  PIC  X(025) VALUE                  D.000324
003640*****       "***  TZNTM WRITE ｴﾗｰ  ***".                          D.000324
003650*****  03  E-ME13  COLUMN  15  PIC  X(027) VALUE                  D.000324
003660*****       "***  TZNTM REWRITE ｴﾗｰ  ***".                        D.000324
003670*****  03  E-ME14  COLUMN  15  PIC  X(026) VALUE                  D.000324
003680*****       "***  TZNTM DELETE ｴﾗｰ  ***".                         D.000324
003690*****  03  E-ME21  COLUMN  15  PIC  X(017) VALUE                  D.000324
003700*****       "***  HKBM ﾅｼ  ***".                                  D.000324
003710*****  03  E-ME22  COLUMN  15  PIC  X(026) VALUE                  D.000324
003720*****       "***  HKBM REWRITE ｴﾗｰ  ***".                         D.000324
003730*****  03  E-ME23  COLUMN  15  PIC  X(024) VALUE                  D.000324
003740*****       "***  HKBM WRITE ｴﾗｰ  ***".                           D.000324
003750*****  03  E-ME28  COLUMN  15  PIC  X(026) VALUE                  D.000324
003760*****       "***   TUKF WRITE ｴﾗｰ   ***".                         D.000324
003770*****  03  E-ME50  COLUMN  15  PIC  X(026) VALUE                  D.000324
003780*****       "***   ﾀﾞｲﾁｮｳNO ｵｰﾊﾞｰ   ***".                         D.000324
003790*****  03  E-KEY   COLUMN  50  PIC  X(005) FROM  TZNT-KEY.        D.000324
003800*****  03  E-ME90  COLUMN  15  PIC  N(022) VALUE                  D.000324
003810*****       NC"【　　工品区分マスターを修正して下さい　　】".     D.000324
003820*****  03  E-KJM   COLUMN  50  PIC  X(006) FROM  KJ-KEY.          D.940520
003830*****  03  E-KJM   COLUMN  50  PIC  X(007) FROM  KJ-KEY.          D.160127
003840       03  E-KHM   COLUMN  50  PIC  X(005) FROM  KHT-KEY.
003850*****  03  E-TTM   COLUMN  50  PIC  X(004) FROM  TT-KEY.          D.000324
003860*****  03  E-KTM   COLUMN  50  PIC  X(004) FROM  KT-KEY.          D.000224
003870*****  03  E-KKYF  COLUMN  50  PIC  X(005) FROM  KKY-KEY.         D.970109
003880*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.940602
003890*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.940602
003900*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.940602
003910     COPY LIBSCR.                                                 I.950302
003920     COPY LSSEM.                                                  I.940602
003930 PROCEDURE DIVISION.
003940 M-05.
003950     DISPLAY C-CLEAR.
003960     DISPLAY C-MID.
003970     COPY LIBCPR.                                                 I.950302
003980     MOVE D-NKNG TO W-NG.                                         I.000329
003990*****MOVE DATE-03R TO W-DATE.                                     D.950510
004000*****PERFORM S-20 THRU S-30.                                      D.000325
004010     OPEN INPUT KH-M.
004020     OPEN I-O KHT-M.                                              I.160127
004030*****OPEN I-O KJ-M KHT-M.                                         D.160127
004040*****OPEN I-O KJ-M KHT-M KT-M KKY-F.                              D.970109
004050*****OPEN I-O KJ-M KHT-M KT-M.                                    D.000224
004060*****OPEN I-O KJ-M KHT-M TT-M.                                    D.000324
004070*****OPEN I-O TZNT-M.                                             D.000324
004080*****OPEN EXTEND YG-F.                                            D.910909
004090*****OPEN OUTPUT KHUH-F.                                          D.961018
004100*****OPEN EXTEND TMS-F.                                           D.000324
004110*****IF W-GET = 5                                                 D.000324
004120*****    PERFORM S-35 THRU S-45.                                  D.000324
004130*****IF COMPLETION-CODE = 255                                     D.000324
004140*****    CLOSE TZNT-M                                             D.000324
004150*****    CLOSE KH-M                                               D.000324
004160*****    CLOSE KJ-M KHT-M TT-M                                    D.000324
004170*****    CLOSE KJ-M KHT-M KT-M                                    D.000224
004180*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
004190*****    CLOSE KHUH-F                                             D.961018
004200*****    CLOSE TMS-F                                              D.000324
004210*****    GO TO M-95.                                              D.000324
004220*M-20.                                                            D.160127
004230*****READ KJ-M AT END                                             D.160127
004240*****    GO TO M-30.                                              D.160127
004250*****IF KJ-KEY = "999998"                                         D.940520
004260*****IF KJ-KEY = "999998 "                                        D.021010
004270*****IF KJ-SC > 3                                                 D.160127
004280*****    MOVE ZERO TO W-JZS                                       D.160127
004290*****  ELSE                                                       D.160127
004300*****    COMPUTE W-JZS = KJ-ZSU + KJ-SSU + KJ-KSU - KJ-HSU.       D.160127
004310*****MOVE ZERO TO KJ-SSU KJ-KSU KJ-HSU.                           D.160127
004320*****MOVE W-JZS TO KJ-ZSU.                                        D.931101
004330*****MOVE W-JZS TO KJ-ZSU KJ-TTS.                                 D.160127
004340*****REWRITE KJ-R INVALID KEY                                     D.160127
004350*****    MOVE 255 TO COMPLETION-CODE                              D.160127
004360*****    DISPLAY E-ME78 E-STAT E-ME1 E-KJM E-ME99                 D.160127
004370*****    CLOSE KH-M                                               D.160127
004380*****    CLOSE KJ-M KHT-M                                         D.160127
004390*****    CLOSE KJ-M KHT-M TT-M                                    D.000324
004400*****    CLOSE KJ-M KHT-M KT-M                                    D.000224
004410*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
004420*****    CLOSE KHUH-F                                             D.961018
004430*****    CLOSE TMS-F                                              D.000324
004440*****    CLOSE TZNT-M                                             D.000324
004450*****    GO TO M-95.                                              D.160127
004460*****GO TO M-20.                                                  D.160127
004470 M-30.
004480     READ KHT-M AT END
004490         GO TO M-80.                                              I.000324
004500*****    GO TO M-40.                                              D.000324
004510     MOVE KHT-KEY TO KH-KEY.
004520     READ KH-M WITH UNLOCK INVALID KEY
004530         DISPLAY E-ME4 E-KHM E-ME99
004540         GO TO M-30.
004550     COMPUTE W-HZS =                                              I.021010
004560                KHT-KSU + KHT-ZSU - KHT-HSU + KHT-ISU - KHT-SSU.  I.021010
004570*****COMPUTE W-HZS = KHT-KSU + KHT-ZSU - KHT-HSU - KHT-SSU.       D.021010
004580*****IF KHT-YC = 00 OR 99                                         D.021001
004590*****IF (KHT-YC = 00 OR 99) OR                                    D.100805
004600*****   ((KHT-YC NOT = 10 AND 11) AND (KH-GT1 = ZERO))            D.100805
004610*****   ((KHT-YC NOT = 10 AND 11) AND (KH-T2 = ZERO))             D.090430
004620     IF (KHT-YC = 00 OR 99)                                       I.100805
004630         MOVE ZERO TO W-HZS.                                      I.020905
004640*****MOVE W-HZS TO KHT-ZSU.                                       D.931101
004650     MOVE W-HZS TO KHT-ZSU KHT-TTS.                               I.931101
004660*****IF KH-YC NOT = 10 AND 11                                     D.090430
004670*****    COMPUTE W-HZK = KHT-ZSU * KH-T2                          D.090430
004680*****  ELSE                                                       D.090430
004690*****    COMPUTE W-HZK = KHT-ZSU * KH-T1.                         D.090430
004700     COMPUTE W-HZK = KHT-ZSU * KH-GT1.                            I.090430
004710     MOVE W-HZK TO KHT-ZKIN.
004720*****MOVE ZERO TO KHT-KKIN KHT-KSU KHT-HSU                        D.021010
004730     MOVE ZERO TO KHT-KKIN KHT-KSU KHT-HSU KHT-ISU                I.021010
004740                  KHT-SSU KHT-UKIN KHT-NKIN KHT-GKIN.             I.020829
004750*****             KHT-SSU KHT-UKIN KHT-NKIN.                      D.020829
004760     MOVE KHT-AAS TO KHT-AZS.
004770     MOVE ZERO TO KHT-AUS KHT-ASS KHT-AC.                         I.090430
004780*****MOVE ZERO TO KHT-AUS KHT-ASS KHT-AC KHT-TSY.                 D.090430
004790*****MOVE ZERO TO KHT-AUS KHT-ASS KHT-AC.                         D.021010
004800*****MOVE KHT-YSY TO KHT-TSY.                                     D.021010
004810*****MOVE ZERO TO KHT-YSY.                                        D.021010
004820     REWRITE KHT-R INVALID KEY
004830         MOVE 255 TO COMPLETION-CODE                              I.000324
004840         DISPLAY E-ME78 E-STAT E-ME2 E-KHM E-ME99                 C.940602
004850         CLOSE KH-M
004860         CLOSE KHT-M                                              I.160127
004870*****    CLOSE KJ-M KHT-M                                         D.160127
004880*****    CLOSE KJ-M KHT-M TT-M                                    D.000324
004890*****    CLOSE KJ-M KHT-M KT-M                                    D.000224
004900*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
004910*****    CLOSE KHUH-F                                             D.961018
004920*****    CLOSE TMS-F                                              D.000324
004930*****    CLOSE TZNT-M                                             D.000324
004940         GO TO M-95.
004950*****IF KHT-ZSU = ZERO                                            D.961018
004960*****    GO TO M-30.                                              D.961018
004970*M-35.                                                            D.961018
004980*****MOVE ZERO TO KHUH-R.                                         D.961018
004990*****MOVE KHT-KEY TO UH-CO.                                       D.961018
005000*****MOVE KHT-ZSU TO UH-ZS.                                       D.961018
005010*****MOVE KHT-YC TO UH-YC.                                        D.961018
005020*****WRITE KHUH-R.                                                D.961018
005030     GO TO M-30.
005040*M-40.                                                            D.000324
005050*****OPEN I-O TUKF.                                               D.000324
005060*M-45.                                                            D.000324
005070*****READ KT-M AT END                                             D.000224
005080*****READ TT-M AT END                                             D.000324
005090*****    GO TO M-80.                                              D.000324
005100*****IF TT-BC = 0                                                 D.000324
005110*****    GO TO M-45.                                              D.000324
005120*****    GO TO M-60.                                              D.970109
005130*****PERFORM S-05 THRU S-15.                                      D.000324
005140*****PERFORM S-50 THRU S-65.                                      D.000324
005150*****IF COMPLETION-CODE = 255                                     D.000324
005160*****    GO TO M-50.                                              D.000324
005170*****    CLOSE TZNT-M                                             D.991007
005180*****    CLOSE KH-M                                               D.991007
005190*****    CLOSE KJ-M KHT-M KT-M                                    D.991007
005200*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
005210*****    CLOSE KHUH-F                                             D.961018
005220*****    CLOSE TMS-F                                              D.991007
005230*****    GO TO M-95.                                              D.991007
005240*****MOVE KT-TUZ TO KT-TZZ.                                       D.000224
005250*****MOVE KT-TUZZ TO KT-TZZZ.                                     D.000224
005260*****MOVE ZERO TO KT-TUA KT-TNB KT-TNK KT-TUG                     D.000224
005270*****             KT-TUAZ KT-TNBZ KT-TNKZ.                        D.000224
005280*****MOVE ZERO TO KT-SP KT-SK.                                    D.000224
005290*****REWRITE KT-R INVALID KEY                                     D.000224
005300*****    DISPLAY E-ME78 E-STAT E-ME3 E-KTM E-ME99                 D.000224
005310*****MOVE TT-TUZ TO TT-TZZ.                                       D.000324
005320*****MOVE TT-TUZZ TO TT-TZZZ.                                     D.000324
005330*****MOVE ZERO TO TT-TUA TT-TNB TT-TNK TT-TUG                     D.000324
005340*****             TT-TUAZ TT-TNBZ TT-TNKZ.                        D.000324
005350*****MOVE ZERO TO TT-SP TT-SK.                                    D.000324
005360*****REWRITE TT-R INVALID KEY                                     D.000324
005370*****    DISPLAY E-ME78 E-STAT E-ME3 E-TTM E-ME99                 D.000324
005380*****    GO TO M-50.                                              D.000324
005390*****    CLOSE KH-M                                               D.991007
005400*****    CLOSE KJ-M KHT-M KT-M                                    D.991007
005410*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
005420*****    CLOSE KHUH-F                                             D.961018
005430*****    CLOSE TMS-F                                              D.991007
005440*****    CLOSE TZNT-M                                             D.991007
005450*****    GO TO M-95.                                              D.991007
005460*****IF ZERO = KT-TZZ AND KT-TZZZ                                 D.000224
005470*****IF ZERO = TT-TZZ AND TT-TZZZ                                 D.000324
005480*****    GO TO M-45.                                              D.000324
005490*****PERFORM HKB-RTN THRU HKB-EX.                                 D.000324
005500*****IF COMPLETION-CODE = 255                                     D.000324
005510*****    GO TO M-50.                                              D.000324
005520*****PERFORM TUK-RTN THRU TUK-EX.                                 D.000324
005530*****IF COMPLETION-CODE = 255                                     D.000324
005540*****    GO TO M-50.                                              D.000324
005550*****GO TO M-45.                                                  D.000324
005560*M-50.                                                            D.000324
005570*****CLOSE KH-M.                                                  D.000324
005580*****CLOSE KJ-M KHT-M TT-M.                                       D.000324
005590*****CLOSE KJ-M KHT-M KT-M.                                       D.000224
005600*****CLOSE TMS-F.                                                 D.000324
005610*****CLOSE TZNT-M.                                                D.000324
005620*****CLOSE TUKF.                                                  D.000324
005630*****GO TO M-95.                                                  D.000324
005640*****COMPUTE W-UZ2 = KT-TUZ + KT-TUZZ.                            D.910909
005650*****COMPUTE W-UZ ROUNDED = W-UZ1 * 1.                            D.910909
005660*****IF W-UZ = ZERO                                               D.910909
005670*****    GO TO M-40.                                              D.910909
005680*****MOVE ZERO TO YG-R.                                           D.910909
005690*****MOVE KT-KEY TO YG-TCD.                                       D.910909
005700*****MOVE W-UZ TO YG-KIN.                                         D.910909
005710*****MOVE 2 TO YG-ZC.                                             D.910909
005720*****WRITE YG-R.                                                  D.910909
005730*****COMPUTE W-UKIN = KT-TUA - KT-TNB.                            D.951005
005740*****COMPUTE W-AKIN = W-UKIN - KT-TUG.                            D.951005
005750*****IF ZERO = W-UKIN AND W-AKIN                                  D.951005
005760*****    GO TO M-40.                                              D.951005
005770*****PERFORM S-50 THRU S-65.                                      D.951005
005780*****IF COMPLETION-CODE = 255                                     D.951005
005790*****    CLOSE TZNT-M                                             D.951005
005800*****    CLOSE KH-M                                               D.951005
005810*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.951005
005820*****    CLOSE KHUH-F                                             D.951005
005830*****    CLOSE TMS-F                                              D.951005
005840*****    GO TO M-95.                                              D.951005
005850*****GO TO M-40.                                                  D.991007
005860*M-60.                                                            D.970109
005870*****READ KKY-F AT END                                            D.970109
005880*****    GO TO M-80.                                              D.970109
005890*****MOVE KKY-D2 TO KKY-D1.                                       D.970109
005900*****MOVE ZERO TO KKY-D2.                                         D.970109
005910*****MOVE KKY-KISY TO KKY-KIST.                                   D.961128
005920*****MOVE KKY-KIS TO KKY-KISY.                                    D.961128
005930*****REWRITE KKY-R INVALID KEY                                    D.970109
005940*****    DISPLAY E-ME78 E-STAT E-ME5 E-KKYF E-ME99                D.970109
005950*****    CLOSE KH-M                                               D.970109
005960*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
005970*****    CLOSE KHUH-F                                             D.961018
005980*****    CLOSE TMS-F                                              D.970109
005990*****    CLOSE TZNT-M                                             D.970109
006000*****    GO TO M-95.                                              D.970109
006010*****GO TO M-60.                                                  D.970109
006020 M-80.
006030*****OPEN I-O KST-F.                                              D.020829
006040*M-85.                                                            D.020829
006050*****READ KST-F NEXT RECORD AT END                                D.020829
006060*****    GO TO M-90.                                              D.020829
006070*****IF KST-NGS NOT = W-NG                                        D.020829
006080*****    GO TO M-85.                                              D.020829
006090*****DELETE KST-F INVALID KEY                                     D.020829
006100*****    MOVE 255 TO COMPLETION-CODE                              D.020829
006110*****    DISPLAY E-STAT E-ME15 E-ME99                             D.020829
006120*****    GO TO M-90.                                              D.020829
006130*****GO TO M-85.                                                  D.020829
006140*M-90.                                                            D.020829
006150*****CLOSE KST-F.                                                 D.020829
006160*
006170     OPEN I-O M-DATE.
006180     MOVE "01" TO DATE-KEY.
006190     READ M-DATE INVALID KEY
006200         MOVE 255 TO COMPLETION-CODE                              I.000324
006210         DISPLAY E-ME78 E-ME6 E-ME99                              C.940602
006220         CLOSE KH-M
006230         CLOSE KHT-M                                              I.160127
006240*****    CLOSE KJ-M KHT-M                                         D.160127
006250*****    CLOSE KJ-M KHT-M TT-M                                    D.000324
006260*****    CLOSE KJ-M KHT-M KT-M                                    D.000224
006270*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
006280*****    CLOSE KHUH-F                                             D.961018
006290*****    CLOSE TMS-F                                              D.000324
006300*****    CLOSE TZNT-M                                             D.000324
006310         CLOSE M-DATE
006320         GO TO M-95.
006330     MOVE D-KTNG2 TO D-KTNG1.
006340     MOVE ZERO TO D-KTNG2.
006350     REWRITE DATE-R INVALID KEY
006360         MOVE 255 TO COMPLETION-CODE                              I.000324
006370         DISPLAY E-ME78 E-STAT E-ME7 E-ME99                       C.940602
006380         CLOSE KH-M
006390         CLOSE KHT-M                                              I.160127
006400*****    CLOSE KJ-M KHT-M                                         D.160127
006410*****    CLOSE KJ-M KHT-M TT-M                                    D.000324
006420*****    CLOSE KJ-M KHT-M KT-M                                    D.000224
006430*****    CLOSE KJ-M KHT-M KT-M KKY-F                              D.970109
006440*****    CLOSE KHUH-F                                             D.961018
006450*****    CLOSE TMS-F                                              D.000324
006460*****    CLOSE TZNT-M                                             D.000324
006470         CLOSE M-DATE
006480         GO TO M-95.
006490     CLOSE M-DATE.
006500*
006510     CLOSE KH-M.
006520     CLOSE KHT-M.                                                 I.160127
006530     OPEN OUTPUT KNHR-F URIR-F.                                   I.160127
006540     CLOSE KNHR-F URIR-F.                                         I.160127
006550*****CLOSE KJ-M KHT-M.                                            D.160127
006560*****CLOSE KJ-M KHT-M TT-M.                                       D.000324
006570*****CLOSE KJ-M KHT-M KT-M.                                       D.000224
006580*****CLOSE KJ-M KHT-M KT-M KKY-F.                                 D.970109
006590*****CLOSE KHUH-F.                                                D.961018
006600*****CLOSE YG-F.                                                  D.910909
006610*****CLOSE TMS-F.                                                 D.000324
006620*****CLOSE TZNT-M.                                                D.000324
006630*****OPEN OUTPUT KNHR-F KSR-F URIR-F.                             D.160127
006640*****OPEN OUTPUT KKHR-F.                                          D.160127
006650*****OPEN OUTPUT KAZR-F KKUH-F KKHR-F.                            D.961024
006660*****OPEN OUTPUT KAZR-F KKHR-F.                                   D.970226
006670*****OPEN OUTPUT KKY-F.                                           D.990526
006680*****CLOSE KNHR-F KSR-F URIR-F.                                   D.160127
006690*****CLOSE KKHR-F.                                                D.160127
006700*****CLOSE KAZR-F KKUH-F KKHR-F.                                  D.961024
006710*****CLOSE KAZR-F KKHR-F.                                         D.970226
006720*****CLOSE KKY-F.                                                 D.990526
006730*M-92.                                                            D.000324
006740*****OPEN I-O KKB-M.                                              D.000324
006750*****MOVE SPACE TO KKB-KEY.                                       D.000324
006760*****MOVE 90 TO KKB-NO.                                           D.000324
006770*****READ KKB-M INVALID KEY                                       D.000324
006780*****    DISPLAY E-ME78 E-ME8 E-ME99                              D.000324
006790*****    CLOSE KKB-M                                              D.000324
006800*****    GO TO M-95.                                              D.000324
006810*****MOVE 0 TO KKB-SC15.                                          D.000324
006820*****REWRITE KKB-R INVALID KEY                                    D.000324
006830*****    DISPLAY E-ME78 E-STAT E-ME9 E-ME99                       D.000324
006840*****    DISPLAY E-ME90 E-ME99.                                   D.000324
006850*****CLOSE KKB-M.                                                 D.000324
006860 M-95.
006870     DISPLAY C-CLEAR.
006880     STOP RUN.
006890*S-05.                                                            D.000324
006900*****IF ZERO = KT-TZZ AND KT-TZZZ                                 D.000224
006910*****IF ZERO = TT-TZZ AND TT-TZZZ                                 D.000324
006920*****    GO TO S-10.                                              D.000324
006930*****MOVE ZERO TO TMS-R.                                          D.000324
006940*****MOVE KT-TCD TO TMS-TCD.                                      D.000224
006950*****MOVE KT-TZZ TO TMS-KIN.                                      D.000224
006960*****MOVE KT-TZZZ TO TMS-SHZ.                                     D.000224
006970*****MOVE TT-TCD TO TMS-TCD.                                      D.000324
006980*****MOVE TT-TZZ TO TMS-KIN.                                      D.000324
006990*****MOVE TT-TZZZ TO TMS-SHZ.                                     D.000324
007000*****WRITE TMS-R.                                                 D.000324
007010*****IF ERR-STAT = "00"                                           D.000324
007020*****    CALL "CBLTCLS" USING TMS-F                               D.000324
007030*****    GO TO S-10.                                              D.000324
007040*****DISPLAY E-STAT E-ME10 E-ME99.                                D.000324
007050*****IF ERR-STAT NOT = "34"                                       D.000324
007060*****    DISPLAY E-ME78 E-ME99                                    D.000324
007070*****    GO TO S-05.                                              D.000324
007080*****DISPLAY E-CL.                                                D.000324
007090*****CLOSE TMS-F.                                                 D.000324
007100*****MOVE "TMSF         " TO W-FILE.                              D.000324
007110*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000324
007120*****DISPLAY E-CL.                                                D.000324
007130*****OPEN EXTEND TMS-F.                                           D.000324
007140*****GO TO S-05.                                                  D.000324
007150*S-10.                                                            D.000324
007160*****IF KT-SP = ZERO                                              D.000224
007170*****    COMPUTE W-KIN = KT-TUA - KT-TNB                          D.000224
007180*****    COMPUTE W-SHZ = KT-TUAZ - KT-TNBZ                        D.000224
007190*****IF TT-SP = ZERO                                              D.000324
007200*****    COMPUTE W-KIN = TT-TUA - TT-TNB                          D.000324
007210*****    COMPUTE W-SHZ = TT-TUAZ - TT-TNBZ                        D.000324
007220*****  ELSE                                                       D.000324
007230*****    COMPUTE W-KIN = TT-SUA + TT-STS                          D.000324
007240*****    COMPUTE W-SHZ = TT-SUAZ + TT-STSZ.                       D.000324
007250*****    COMPUTE W-KIN = KT-SUA + KT-STS                          D.000224
007260*****    COMPUTE W-SHZ = KT-SUAZ + KT-STSZ.                       D.000224
007270*****IF ZERO = W-KIN AND W-SHZ                                    D.000324
007280*****    GO TO S-15.                                              D.000324
007290*****MOVE ZERO TO TMS-R.                                          D.000324
007300*****MOVE KT-TCD TO TMS-TCD.                                      D.000224
007310*****MOVE TT-TCD TO TMS-TCD.                                      D.000324
007320*****MOVE 99 TO TMS-SP.                                           D.000324
007330*****MOVE 9 TO TMS-SK TMS-KBN.                                    D.000324
007340*****MOVE W-DATE TO TMS-DATE.                                     D.971014
007350*****MOVE W-NGPS TO TMS-DATE.                                     D.000324
007360*****MOVE W-KIN TO TMS-KIN.                                       D.000324
007370*****MOVE W-SHZ TO TMS-SHZ.                                       D.000324
007380*****WRITE TMS-R.                                                 D.000324
007390*****IF ERR-STAT = "00"                                           D.000324
007400*****    CALL "CBLTCLS" USING TMS-F                               D.000324
007410*****    GO TO S-15.                                              D.000324
007420*****DISPLAY E-STAT E-ME10 E-ME99.                                D.000324
007430*****IF ERR-STAT NOT = "34"                                       D.000324
007440*****    DISPLAY E-ME78 E-ME99                                    D.000324
007450*****    GO TO S-10.                                              D.000324
007460*****DISPLAY E-CL.                                                D.000324
007470*****CLOSE TMS-F.                                                 D.000324
007480*****MOVE "TMSF         " TO W-FILE.                              D.000324
007490*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000324
007500*****DISPLAY E-CL.                                                D.000324
007510*****OPEN EXTEND TMS-F.                                           D.000324
007520*****GO TO S-10.                                                  D.000324
007530*S-15.                                                            D.000324
007540*****EXIT.                                                        D.000324
007550*S-20.                                                            D.000324
007560*****MOVE D-NKNG TO W-NG.                                         D.971014
007570*****MOVE ZERO TO W-NG.                                           D.991007
007580*****MOVE ZERO TO W-NG W-NGPD.                                    D.000324
007590*****MOVE D-NKNG TO W-NGS.                                        D.000324
007600*****IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        D.000324
007610*****    ADD DATE-NC1 TO W-NEN.                                   D.000324
007620*****IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        D.000324
007630*****    ADD DATE-NC2 TO W-NEN.                                   D.000324
007640*****MOVE W-NG TO W-NGD.                                          D.000324
007650*****ADD 1 TO W-PEYD.                                             D.000324
007660*****SUBTRACT 1 FROM W-GET.                                       D.000324
007670*****IF W-GET = ZERO                                              D.000324
007680*****    SUBTRACT 1 FROM W-NEN                                    D.000324
007690*****    MOVE 12 TO W-GET.                                        D.000324
007700*****OPEN INPUT CALNM.                                            D.000324
007710*****MOVE ZERO TO CL-KEY.                                         D.000324
007720*****MOVE W-NG TO CL-NG.                                          D.000324
007730*****START CALNM KEY NOT < CL-KEY INVALID KEY                     D.000324
007740*****    CLOSE CALNM                                              D.000324
007750*****    DISPLAY E-ME11 E-ME99                                    D.000324
007760*****    DISPLAY E-CL                                             D.000324
007770*****    GO TO S-20.                                              D.000324
007780*****READ CALNM NEXT RECORD WITH UNLOCK AT END                    D.000324
007790*****    CLOSE CALNM                                              D.000324
007800*****    DISPLAY E-ME11 E-ME99                                    D.000324
007810*****    DISPLAY E-CL                                             D.000324
007820*****    GO TO S-20.                                              D.000324
007830*****IF W-NG NOT = CL-NG                                          D.000324
007840*****    CLOSE CALNM                                              D.000324
007850*****    DISPLAY E-ME11 E-ME99                                    D.000324
007860*****    DISPLAY E-CL                                             D.000324
007870*****    GO TO S-20.                                              D.000324
007880*S-25.                                                            D.000324
007890*****MOVE CL-KEY TO W-DATE.                                       D.971014
007900*****MOVE CL-KEY TO W-NGP.                                        D.000324
007910*****READ CALNM NEXT RECORD WITH UNLOCK AT END                    D.000324
007920*****    CLOSE CALNM                                              D.000324
007930*****    GO TO S-30.                                              D.000324
007940*****IF W-NG = CL-NG                                              D.000324
007950*****    GO TO S-25.                                              D.000324
007960*S-30.                                                            D.000324
007970*****EXIT.                                                        D.000324
007980*S-35.                                                            D.000324
007990*****READ TZNT-M NEXT RECORD AT END                               D.000324
008000*****    GO TO S-45.                                              D.000324
008010*****IF TZNT-BC = 0                                               D.000324
008020*****    GO TO S-35.                                              D.000324
008030*****IF ZERO = TZNT-NU05 AND TZNT-NU06 AND TZNT-NU07 AND          D.000324
008040*****          TZNT-NU08 AND TZNT-NU09 AND TZNT-NU10 AND          D.000324
008050*****          TZNT-NU11 AND TZNT-NU12 AND TZNT-NU01 AND          D.000324
008060*****          TZNT-NU02 AND TZNT-NU03 AND TZNT-NU04 AND          D.000324
008070*****          TZNT-NA05 AND TZNT-NA06 AND TZNT-NA07 AND          D.000324
008080*****          TZNT-NA08 AND TZNT-NA09 AND TZNT-NA10 AND          D.000324
008090*****          TZNT-NA11 AND TZNT-NA12 AND TZNT-NA01 AND          D.000324
008100*****          TZNT-NA02 AND TZNT-NA03 AND TZNT-NA04              D.000324
008110*****    GO TO S-40.                                              D.000324
008120*****MOVE TZNT-NUD TO TZNT-OUD.                                   D.000324
008130*****MOVE TZNT-NTU TO TZNT-OTU.                                   D.000324
008140*****MOVE TZNT-NAD TO TZNT-OAD.                                   D.000324
008150*****MOVE TZNT-NTA TO TZNT-OTA.                                   D.000324
008160*****MOVE ZERO TO TZNT-NUD TZNT-NTU TZNT-NAD TZNT-NTA.            D.000324
008170*****MOVE W-NGS TO TZNT-NG.                                       D.000324
008180*****MOVE W-NG TO TZNT-NG.                                        D.971014
008190*
008200*****REWRITE TZNT-R INVALID KEY                                   D.000324
008210*****    MOVE 255 TO COMPLETION-CODE                              D.000324
008220*****    DISPLAY E-ME78 E-STAT E-ME13 E-KEY E-ME99                D.000324
008230*****    DISPLAY E-CL                                             D.000324
008240*****    GO TO S-45.                                              D.000324
008250*****GO TO S-35.                                                  D.000324
008260*S-40.                                                            D.000324
008270*****DELETE TZNT-M INVALID KEY                                    D.000324
008280*****    MOVE 255 TO COMPLETION-CODE                              D.000324
008290*****    DISPLAY E-ME78 E-STAT E-ME14 E-KEY E-ME99                D.000324
008300*****    DISPLAY E-CL                                             D.000324
008310*****    GO TO S-45.                                              D.000324
008320*****CALL "CBLTCLS" USING TZNT-M.                                 D.000324
008330*****GO TO S-35.                                                  D.000324
008340*S-45.                                                            D.000324
008350*****EXIT.                                                        D.000324
008360*S-50.                                                            D.000324
008370*****COMPUTE W-UKIN = KT-TUA - KT-TNB.                            D.000224
008380*****COMPUTE W-AKIN = W-UKIN - KT-TUG.                            D.000224
008390*****COMPUTE W-UKIN = TT-TUA - TT-TNB.                            D.000324
008400*****COMPUTE W-AKIN = W-UKIN - TT-TUG.                            D.000324
008410*****IF ZERO = W-UKIN AND W-AKIN                                  D.000324
008420*****    GO TO S-65.                                              D.000324
008430*****MOVE ZERO TO TZNT-R.                                         D.000324
008440*****MOVE KT-TCD TO TZNT-TCD.                                     D.000224
008450*****MOVE TT-TCD TO TZNT-TCD.                                     D.000324
008460*****READ TZNT-M INVALID KEY                                      D.000324
008470*****    GO TO S-55.                                              D.000324
008480*****PERFORM S-70 THRU S-75.                                      D.000324
008490*****REWRITE TZNT-R INVALID KEY                                   D.000324
008500*****    MOVE 255 TO COMPLETION-CODE                              D.000324
008510*****    DISPLAY E-ME78 E-STAT E-ME13 E-KEY E-ME99                D.000324
008520*****    DISPLAY E-CL.                                            D.000324
008530*****GO TO S-65.                                                  D.000324
008540*S-55.                                                            D.000324
008550*****PERFORM S-70 THRU S-75.                                      D.000324
008560*****WRITE TZNT-R INVALID KEY                                     D.000324
008570*****    DISPLAY E-STAT E-ME12 E-KEY E-ME99                       D.000324
008580*****    GO TO S-60.                                              D.000324
008590*****CALL "CBLTCLS" USING TZNT-M.                                 D.000324
008600*****GO TO S-65.                                                  D.000324
008610*S-60.                                                            D.000324
008620*****IF ERR-STAT NOT = "24"                                       D.000324
008630*****    MOVE 255 TO COMPLETION-CODE                              D.000324
008640*****    DISPLAY E-ME78 E-ME99                                    D.000324
008650*****    GO TO S-65.                                              D.000324
008660*****DISPLAY E-CL.                                                D.000324
008670*****CLOSE TZNT-M.                                                D.000324
008680*****MOVE "TZNTM        " TO W-FILE.                              D.000324
008690*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000324
008700*****DISPLAY E-CL.                                                D.000324
008710*****OPEN I-O TZNT-M.                                             D.000324
008720*****MOVE ZERO TO TZNT-R.                                         D.000324
008730*****MOVE TT-TCD TO TZNT-TCD.                                     D.000324
008740*****MOVE KT-TCD TO TZNT-TCD.                                     D.000224
008750*****GO TO S-55.                                                  D.000324
008760*S-65.                                                            D.000324
008770*****EXIT.                                                        D.000324
008780*S-70.                                                            D.000324
008790*****IF W-GET = 5                                                 D.000324
008800*****    MOVE W-UKIN TO TZNT-NU05                                 D.000324
008810*****    MOVE W-AKIN TO TZNT-NA05.                                D.000324
008820*****IF W-GET = 6                                                 D.000324
008830*****    MOVE W-UKIN TO TZNT-NU06                                 D.000324
008840*****    MOVE W-AKIN TO TZNT-NA06.                                D.000324
008850*****IF W-GET = 7                                                 D.000324
008860*****    MOVE W-UKIN TO TZNT-NU07                                 D.000324
008870*****    MOVE W-AKIN TO TZNT-NA07.                                D.000324
008880*****IF W-GET = 8                                                 D.000324
008890*****    MOVE W-UKIN TO TZNT-NU08                                 D.000324
008900*****    MOVE W-AKIN TO TZNT-NA08.                                D.000324
008910*****IF W-GET = 9                                                 D.000324
008920*****    MOVE W-UKIN TO TZNT-NU09                                 D.000324
008930*****    MOVE W-AKIN TO TZNT-NA09.                                D.000324
008940*****IF W-GET = 10                                                D.000324
008950*****    MOVE W-UKIN TO TZNT-NU10                                 D.000324
008960*****    MOVE W-AKIN TO TZNT-NA10.                                D.000324
008970*****IF W-GET = 11                                                D.000324
008980*****    MOVE W-UKIN TO TZNT-NU11                                 D.000324
008990*****    MOVE W-AKIN TO TZNT-NA11.                                D.000324
009000*****IF W-GET = 12                                                D.000324
009010*****    MOVE W-UKIN TO TZNT-NU12                                 D.000324
009020*****    MOVE W-AKIN TO TZNT-NA12.                                D.000324
009030*****IF W-GET = 1                                                 D.000324
009040*****    MOVE W-UKIN TO TZNT-NU01                                 D.000324
009050*****    MOVE W-AKIN TO TZNT-NA01.                                D.000324
009060*****IF W-GET = 2                                                 D.000324
009070*****    MOVE W-UKIN TO TZNT-NU02                                 D.000324
009080*****    MOVE W-AKIN TO TZNT-NA02.                                D.000324
009090*****IF W-GET = 3                                                 D.000324
009100*****    MOVE W-UKIN TO TZNT-NU03                                 D.000324
009110*****    MOVE W-AKIN TO TZNT-NA03.                                D.000324
009120*****IF W-GET = 4                                                 D.000324
009130*****    MOVE W-UKIN TO TZNT-NU04                                 D.000324
009140*****    MOVE W-AKIN TO TZNT-NA04.                                D.000324
009150*****ADD W-UKIN TO TZNT-NTU.                                      D.000324
009160*****ADD W-AKIN TO TZNT-NTA.                                      D.000324
009170*****MOVE W-NG TO TZNT-NG.                                        D.971014
009180*****MOVE W-NGS TO TZNT-NG.                                       D.000324
009190*****MOVE TT-TNC TO TZNT-TNC.                                     D.000324
009200*****MOVE TT-BC TO TZNT-BC.                                       D.000324
009210*****MOVE KT-TNC TO TZNT-TNC.                                     D.000224
009220*****MOVE KT-BC TO TZNT-BC.                                       D.000224
009230*S-75.                                                            D.000324
009240*****EXIT.                                                        D.000324
009250*HKB-RTN.                                                         D.000324
009260*****OPEN I-O HKBM.                                               D.000324
009270*****MOVE SPACE TO HKB-KEY.                                       D.000324
009280*****MOVE "05" TO HKB-NO.                                         D.000324
009290*****READ HKBM INVALID KEY                                        D.000324
009300*****    DISPLAY E-ME21 E-ME99                                    D.000324
009310*****    GO TO HKB-010.                                           D.000324
009320*****MOVE HKB-DAI TO W-DAI.                                       D.000324
009330*****GO TO HKB-EX.                                                D.000324
009340*HKB-010.                                                         D.000324
009350*****INITIALIZE HKB-R.                                            D.000324
009360*****MOVE SPACE TO HKB-KEY.                                       D.000324
009370*****MOVE "05" TO HKB-NO.                                         D.000324
009380*****WRITE HKB-R INVALID KEY                                      D.000324
009390*****    DISPLAY E-ME78 E-STAT E-ME23 E-ME99                      D.000324
009400*****    MOVE 255 TO COMPLETION-CODE.                             D.000324
009410*****INITIALIZE W-DAI.                                            D.000324
009420*HKB-EX.                                                          D.000324
009430*****EXIT.                                                        D.000324
009440*TUK-RTN.                                                         D.000324
009450*****COPY LDAIP.                                                  D.000324
009460*****IF W-DAI1 = "999"                                            D.000324
009470*****    DISPLAY E-ME78 E-ME50 E-ME99                             D.000324
009480*****    DISPLAY E-CL.                                            D.000324
009490*****MOVE W-DAI TO HKB-DAI.                                       D.000324
009500*****REWRITE HKB-R INVALID KEY                                    D.000324
009510*****    CLOSE HKBM                                               D.000324
009520*****    MOVE 255 TO COMPLETION-CODE                              D.000324
009530*****    DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      D.000324
009540*****    GO TO TUK-EX.                                            D.000324
009550*****CLOSE HKBM.                                                  D.000324
009560*TUK-010.                                                         D.000324
009570*****INITIALIZE TUK-R.                                            D.000324
009580*****MOVE KT-KEY TO TUK-TCD.                                      D.000224
009590*****MOVE TT-KEY TO TUK-TCD.                                      D.000324
009600*****MOVE W-DAI TO TUK-DAI.                                       D.000324
009610*****MOVE W-NGPD TO TUK-DATE.                                     D.000324
009620*****MOVE 0 TO TUK-DC.                                            D.000324
009630*****MOVE KT-TZZ TO TUK-KIN.                                      D.000224
009640*****MOVE KT-TZZZ TO TUK-SHZ.                                     D.000224
009650*****MOVE KT-BC TO TUK-BMC.                                       D.000224
009660*****MOVE TT-TZZ TO TUK-KIN.                                      D.000324
009670*****MOVE TT-TZZZ TO TUK-SHZ.                                     D.000324
009680*****MOVE TT-BC TO TUK-BMC.                                       D.000324
009690*****WRITE TUK-R INVALID KEY                                      D.000324
009700*****    DISPLAY E-STAT E-ME28 E-ME99                             D.000324
009710*****    GO TO TUK-020.                                           D.000324
009720*****GO TO TUK-EX.                                                D.000324
009730*TUK-020.                                                         D.000324
009740*****IF ERR-STAT NOT = "24"                                       D.000324
009750*****    MOVE 255 TO COMPLETION-CODE                              D.000324
009760*****    DISPLAY E-ME78 E-ME99                                    D.000324
009770*****    GO TO TUK-EX.                                            D.000324
009780*****DISPLAY E-CL.                                                D.000324
009790*****CLOSE TUKF.                                                  D.000324
009800*****MOVE "TUKF         " TO W-FILE.                              D.000324
009810*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000324
009820*****DISPLAY E-CL.                                                D.000324
009830*****OPEN I-O TUKF.                                               D.000324
009840*****GO TO TUK-010.                                               D.000324
009850*TUK-EX.                                                          D.000324
009860*****EXIT.                                                        D.000324
