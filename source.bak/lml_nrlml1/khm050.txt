000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHM050.
000030*********************************************************
000040*    PROGRAM         :  防振材料マスターメンテナンス　  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCKM05                          *
000070*        変更　　　  :  62/03/25                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT KJ-M ASSIGN TO KJ-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY KJ-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT KH-M ASSIGN TO KH-MSD                                 I.021008
000230         ORGANIZATION INDEXED                                     I.021008
000240         ACCESS MODE RANDOM                                       I.021008
000250         RECORD KEY KH-KEY                                        I.021008
000260         FILE STATUS IS ERR-STAT.                                 I.021008
000270     SELECT SP-F ASSIGN TO P-PRN999.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON M-DATE
000300     APPLY SHARED-MODE ON KJ-M
000310     APPLY SHARED-MODE ON KH-M                                    I.021008
000320     APPLY SHIFT-CODE  ON SP-F.                                   A 62/03
000330 DATA DIVISION.
000340 FILE SECTION.
000350     COPY LIBFDD.
000360     COPY LIKJM.
000370     COPY LIKHM.                                                  I.021008
000380     COPY LSPF.
000390 WORKING-STORAGE SECTION.
000400 01  HEAD1.
000410     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".           A 62/0
000420*****02  F              PIC  X(035) VALUE SPACE.                  D.021008
000430     02  F              PIC  X(027) VALUE SPACE.                  I.021008
000440     02  F              PIC  N(021) VALUE                           C 62/0
000450          NC"＊＊＊　　防振材料マスター　プルーフリスト".         I.021008
000460*****     NC"＊＊＊　　工品材料マスター　プルーフリスト".         D.021008
000470     02  F              PIC  N(005) VALUE NC"　　＊＊＊".           A 62/0
000480     02  F              PIC  X(014) VALUE SPACE.                  I.021008
000490*****02  F              PIC  X(026) VALUE SPACE.                  D.021008
000500     02  F              PIC  X(005) VALUE "DATE ".
000510     02  H-DATE         PIC 99B99B99.
000520     02  F              PIC  X(007) VALUE "     P.".
000530     02  H-PAGE         PIC Z9.
000540 01  HEAD2.                                                       C 62/03
000550     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".           A 62/0
000560*****02  F              PIC  X(049) VALUE SPACE.                  D.021008
000570*****02  F              PIC  N(004) VALUE NC"　仕入先".           D.021008
000580*****02  F              PIC  N(002) VALUE NC"　在".               D.021008
000590*****02  F              PIC  X(003) VALUE "ﾏｯ ".                  D.021008
000600*****02  F              PIC  N(002) VALUE NC"最終".               D.021008
000610*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
000620*****02  F              PIC  X(001) VALUE ":".                    D.021008
000630*****02  F              PIC  X(050) VALUE SPACE.                  D.021008
000640*****02  F              PIC  N(004) VALUE NC"　仕入先".           D.021008
000650*****02  F              PIC  N(002) VALUE NC"　在".               D.021008
000660*****02  F              PIC  X(003) VALUE "ﾏｯ ".                  D.021008
000670*****02  F              PIC  N(002) VALUE NC"最終".               D.021008
000680*****02  F              PIC  X(002) VALUE SPACE.                  D.021008
000690*01  HEAD3.                                                       D.021008
000700*****02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              D.940510
000710*****02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             D.980213
000720*****02  F              PIC  X(008) VALUE " ｺｰﾄﾞ   ".             D.021008
000730     02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             I.021008
000740     02  F              PIC  N(006) VALUE NC"材　料　名　".
000750*****02  F              PIC  X(010) VALUE SPACE.                  D.940314
000760*****02  F              PIC  X(012) VALUE SPACE.                  D.980213
000770*****02  F              PIC  N(004) VALUE NC"素材区分".           D.940314
000780*****02  F              PIC  X(011) VALUE SPACE.                  D.021008
000790     02  F              PIC  X(010) VALUE SPACE.                  I.021008
000800     02  F              PIC  N(002) VALUE NC"素材".               I.940314
000810     02  F              PIC  X(004) VALUE SPACE.                  I.021008
000820     02  F              PIC  N(004) VALUE NC"単　　価".           I.021008
000830*****02  F              PIC  X(002) VALUE SPACE.                  D.940314
000840*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
000850*****02  F              PIC  N(004) VALUE NC"東海単価".           D.021008
000860*****02  F              PIC  X(001) VALUE SPACE.                  D.940314
000870*****02  F              PIC  X(004) VALUE SPACE.                  D.980213
000880*****02  F              PIC  N(004) VALUE NC"　他単価".           D.980213
000890*****02  F              PIC  N(006) VALUE NC"　その他単価".       D.021008
000900*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
000910*****02  F              PIC  N(002) VALUE NC"　№".               D.021008
000920*****02  F              PIC  N(002) VALUE NC"　庫".               D.021008
000930*****02  F              PIC  X(002) VALUE " ﾄ".                   D.021008
000940*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
000950     02  F              PIC  X(001) VALUE SPACE.                  I.021008
000960     02  F              PIC  N(002) VALUE NC"品名".               I.021008
000970     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".                 I.021008
000980     02  F              PIC  X(002) VALUE SPACE.                  I.021008
000990     02  F              PIC  N(002) VALUE NC"年月".               I.980213
001000     02  F              PIC  X(001) VALUE SPACE.                  I.021008
001010     02  F              PIC  X(007) VALUE "   :   ".              I.021008
001020*****02  F              PIC  X(001) VALUE SPACE.                  D.980213
001030*****02  F              PIC  N(004) VALUE NC"仕入先№".           D.980213
001040*****02  F              PIC  X(001) VALUE SPACE.                  D.980213
001050*****02  F              PIC  N(004) VALUE NC"在庫区分".           D.940314
001060*****02  F              PIC  N(002) VALUE NC"在庫".               D.980213
001070*****02  F              PIC  X(004) VALUE " ﾏｯﾄ".                 D.980213
001080*****02  F              PIC  X(007) VALUE "   :   ".              D.940314
001090*****02  F              PIC  X(005) VALUE "  :  ".                D.940510
001100*****02  F              PIC  X(003) VALUE " : ".                  D.021008
001110*****02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              D.940510
001120*****02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             D.980213
001130*****02  F              PIC  X(008) VALUE " ｺｰﾄﾞ   ".             D.021008
001140     02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             I.021008
001150     02  F              PIC  N(006) VALUE NC"材　料　名　".
001160*****02  F              PIC  X(010) VALUE SPACE.                  D.940314
001170*****02  F              PIC  X(012) VALUE SPACE.                  D.980213
001180*****02  F              PIC  N(004) VALUE NC"素材区分".           D.940314
001190*****02  F              PIC  X(011) VALUE SPACE.                  D.021008
001200     02  F              PIC  X(010) VALUE SPACE.                  I.021008
001210     02  F              PIC  N(002) VALUE NC"素材".               I.940314
001220     02  F              PIC  X(004) VALUE SPACE.                  I.021008
001230     02  F              PIC  N(004) VALUE NC"単　　価".           I.021008
001240*****02  F              PIC  X(002) VALUE SPACE.                  D.940314
001250*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
001260*****02  F              PIC  N(004) VALUE NC"東海単価".           D.021008
001270*****02  F              PIC  X(001) VALUE SPACE.                  D.940314
001280*****02  F              PIC  X(004) VALUE SPACE.                  D.980213
001290*****02  F              PIC  N(004) VALUE NC"　他単価".           D.980213
001300*****02  F              PIC  X(001) VALUE SPACE.                  D.980213
001310*****02  F              PIC  N(004) VALUE NC"仕入先№".           D.980213
001320*****02  F              PIC  N(006) VALUE NC"　その他単価".       D.021008
001330*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
001340*****02  F              PIC  N(002) VALUE NC"　№".               D.021008
001350*****02  F              PIC  N(002) VALUE NC"　庫".               D.021008
001360*****02  F              PIC  X(002) VALUE " ﾄ".                   D.021008
001370*****02  F              PIC  X(003) VALUE SPACE.                  D.021008
001380     02  F              PIC  X(001) VALUE SPACE.                  I.021008
001390     02  F              PIC  N(002) VALUE NC"品名".               I.021008
001400     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".                 I.021008
001410     02  F              PIC  X(002) VALUE SPACE.                  I.021008
001420     02  F              PIC  N(002) VALUE NC"年月".               I.980213
001430     02  F              PIC  X(001) VALUE SPACE.                  I.021008
001440*****02  F              PIC  X(001) VALUE SPACE.                  D.980213
001450*****02  F              PIC  N(004) VALUE NC"在庫区分".           D.940314
001460*****02  F              PIC  N(002) VALUE NC"在庫".               D.980213
001470*****02  F              PIC  X(004) VALUE " ﾏｯﾄ".                 D.980213
001480 01  W-P.
001490*****02  W-PD    OCCURS  58.                                      D.021008
001500*****  03  P-KEY1       PIC  X(006).                              D.940510
001510     02  W-PD    OCCURS  59.                                      I.021008
001520       03  P-KEY1       PIC  X(007).                              I.940510
001530       03  F            PIC  X(001).
001540       03  P-NAME1      PIC  X(020).
001550*****  03  F            PIC  X(002).                              D.980213
001560       03  F            PIC  X(001).                              I.980213
001570       03  P-SC1        PIC  9(001).
001580       03  P-T1         PIC ZZZ,ZZ9.99.                           C.930805
001590*****  03  P-TN1        PIC ZZ,ZZ9.99.                            D.021008
001600*****  03  P-TN1        PIC ZZZ,ZZ9.99.                           D.980213
001610*****  03  F            PIC  X(002).                              D.980213
001620*****  03  F            PIC  X(001).                              D.021008
001630*****  03  P-SNO1       PIC  X(005).                              D.021008
001640*****  03  F            PIC  X(005).                              D.940314
001650       03  F            PIC  X(002).                              I.940314
001660       03  P-HCD1       PIC  X(005).                              I.021008
001670       03  F            PIC  X(002).                              I.021008
001680*****  03  P-ZC1        PIC  Z(001).                              D.021008
001690*****  03  F            PIC  X(003).                              D.980213
001700*****  03  F            PIC  X(001).                              D.021008
001710*****  03  P-MC1        PIC  Z(001).                              D.021008
001720*****  03  F            PIC  X(001).                              D.021008
001730       03  P-ENG1       PIC 99/99.                                I.980213
001740*****  03  F            PIC  X(004).                              D.940314
001750*****  03  F            PIC  X(003).                              D.940510
001760*****  03  F            PIC  X(002).                              D.980213
001770*****  03  F            PIC  X(001).                              D.021008
001780       03  F            PIC  X(003).                              I.021008
001790       03  P-X          PIC  X(001).
001800*****  03  F            PIC  X(003).                              D.940314
001810*****  03  F            PIC  X(002).                              D.940510
001820*****  03  F            PIC  X(001).                              D.021008
001830*****  03  P-KEY2       PIC  X(006).                              D.940510
001840       03  F            PIC  X(003).                              I.021008
001850       03  P-KEY2       PIC  X(007).                              I.940510
001860       03  F            PIC  X(001).
001870       03  P-NAME2      PIC  X(020).
001880*****  03  F            PIC  X(002).                              D.980213
001890       03  F            PIC  X(001).                              I.980213
001900       03  P-SC2        PIC  9(001).
001910       03  P-T2         PIC ZZZ,ZZ9.99.                           C.930805
001920*****  03  P-TN2        PIC ZZ,ZZ9.99.                            D.021008
001930*****  03  P-TN2        PIC ZZZ,ZZ9.99.                           D.980213
001940*****  03  F            PIC  X(002).                              D.980213
001950*****  03  F            PIC  X(001).                              D.021008
001960*****  03  P-SNO2       PIC  X(005).                              D.021008
001970*****  03  F            PIC  X(005).                              D.940314
001980       03  F            PIC  X(002).                              I.940314
001990       03  P-HCD2       PIC  X(005).                              I.021008
002000       03  F            PIC  X(002).                              I.021008
002010*****  03  P-ZC2        PIC  Z(001).                              D.021008
002020*****  03  F            PIC  X(003).                              D.980213
002030*****  03  F            PIC  X(001).                              D.021008
002040*****  03  P-MC2        PIC  Z(001).                              D.021008
002050*****  03  F            PIC  X(001).                              D.021008
002060       03  P-ENG2       PIC 99/99.                                I.980213
002070 01  W-R.
002080*****02  W-KEY          PIC  X(006).                              D.940510
002090     02  W-KEY          PIC  X(007).                              I.940510
002100     02  W-NAME         PIC  X(020).
002110     02  W-SC           PIC  9(001).
002120     02  W-T            PIC  9(005)V9(02).
002130*****02  W-TN           PIC  9(005)V9(02).                        D.021008
002140     02  W-SSU          PIC S9(007).
002150     02  W-KSU          PIC S9(005).
002160     02  W-HSU          PIC S9(007).
002170     02  W-ZSU          PIC S9(007).
002180*****02  W-SNO          PIC  X(005).                              D.021008
002190*****02  W-SYS          PIC S9(006).                              D.021008
002200     02  W-JTS          PIC S9(007).
002210     02  W-TTS          PIC S9(007).
002220     02  W-HCD          PIC  X(005).                              I.021008
002230*****02  W-ZC           PIC  9(001).                              D.021008
002240*****02  W-MC           PIC  9(001).                              D.021008
002250*****02  F              PIC  X(029).                              D.021008
002260     02  F              PIC  X(044).                              I.021008
002270     02  W-ENG          PIC  9(004).                              I.980213
002280*****02  F              PIC  X(035).                              D.940314
002290*****02  F              PIC  X(034).                              D.940510
002300*****02  F              PIC  X(033).                              D.980213
002310*****02  W-TN           PIC  9(005)V9(02).                        D.940510
002320 01  W-DATA.
002330     02  W-ACT          PIC  9(001).
002340     02  W-DMM          PIC  9(001).
002350     02  W-PC           PIC  9(001).
002360     02  CNT            PIC  9(001).
002370     02  W-L            PIC  9(002).
002380     02  W-PAGE         PIC  9(002).
002390     02  W-SECO.
002400       03  W-SCO        PIC  X(007).                              I.940510
002410       03  W-ECO        PIC  X(007).                              I.940510
002420*****  03  W-SCO        PIC  X(006).                              D.940510
002430*****  03  W-ECO        PIC  X(006).                              D.940510
002440     02  W-LD           PIC  9(002).
002450     02  W-CD           PIC  9(001).
002460     02  W-FILE         PIC  X(013).                              I.940318
002470 01  ERR-STAT           PIC  X(002).
002480     COPY LSTAT.
002490 SCREEN SECTION.
002500 SD  C-CRT
002510     END STATUS IS ESTAT.
002520 01  C-CLEAR.
002530     02  C-CL    LINE   1  CLEAR SCREEN.
002540 01  C-ACP.
002550     02  LINE W-L.
002560*****  03  A-ACT   COLUMN   3  PIC  9(001)                        D.021008
002570       03  A-ACT   COLUMN  14  PIC  9(001)                        I.021008
002580            USING W-ACT   CHECK OVERFLOW NO IFC.
002590*****  03  A-KEY   COLUMN   6  PIC  X(007)                        D.021008
002600       03  A-KEY   COLUMN  17  PIC  X(007)                        I.021008
002610            USING W-KEY   CHECK OVERFLOW NO IFC.
002620*****  03  A-NAME  COLUMN  14  PIC  X(020)                        D.021008
002630       03  A-NAME  COLUMN  25  PIC  X(020)                        I.021008
002640            USING W-NAME  CHECK OVERFLOW NO IFC.
002650*****  03  A-SC    COLUMN  37  PIC  9(001)                        D.021008
002660       03  A-SC    COLUMN  48  PIC  9(001)                        I.021008
002670            USING W-SC    CHECK OVERFLOW NO IFC.
002680*****  03  A-T     COLUMN  40  PIC  9(005)V9(02)                  D.021008
002690       03  A-T     COLUMN  51  PIC  9(005)V9(02)                  I.021008
002700            USING W-T     CHECK OVERFLOW NO IFC.
002710       03  A-HCD   COLUMN  60  PIC  X(005)                        I.021008
002720            USING W-HCD   CHECK OVERFLOW NO IFC.                  I.021008
002730*****  03  A-TN    COLUMN  49  PIC  9(005)V9(02)                  D.021008
002740*****       USING W-TN    CHECK OVERFLOW NO IFC.                  D.021008
002750*****  03  A-SNO   COLUMN  59  PIC  X(005)                        D.021008
002760*****       USING W-SNO   CHECK OVERFLOW NO IFC.                  D.021008
002770*****  03  A-ZC    COLUMN  67  PIC  9(001)                        D.021008
002780*****       USING W-ZC    CHECK OVERFLOW NO IFC.                  D.021008
002790*****  03  A-MC    COLUMN  73  PIC  9(001)                        D.021008
002800*****       USING W-MC    CHECK OVERFLOW NO IFC.                  D.021008
002810*****  03  A-DMM1  COLUMN  78  PIC  9(001)                        D.021008
002820       03  A-DMM1  COLUMN  67  PIC  9(001)                        I.021008
002830            USING W-DMM   CHECK OVERFLOW NO IFC.
002840*****02  LINE   4.                                                D.940510
002850     02  LINE  22.                                                I.940510
002860*****  03  A-SCO   COLUMN  44  PIC  X(006)                        D.940510
002870       03  A-SCO   COLUMN  31  PIC  X(007)                        I.940510
002880            USING W-SCO   CHECK OVERFLOW NO IFC.
002890*****  03  A-ECO   COLUMN  54  PIC  X(006)                        D.940510
002900       03  A-ECO   COLUMN  42  PIC  X(007)                        I.940510
002910            USING W-ECO   CHECK OVERFLOW NO IFC.
002920       03  A-DMM2  COLUMN  51  PIC  9(001)                        C.940510
002930            USING W-DMM   CHECK OVERFLOW NO IFC.
002940 01  C-DSP.
002950     02  LINE W-L.
002960       03  D-T     COLUMN  51  PIC ZZZZ9.99  FROM  W-T.           I.021008
002970*****  03  D-T     COLUMN  40  PIC ZZZZ9.99  FROM  W-T.           D.021008
002980*****  03  D-TN    COLUMN  49  PIC ZZZZ9.99  FROM  W-TN.          D.021008
002990       03  D-CL.
003000         04  S-KEY   COLUMN  17  PIC  X(007) VALUE "       ".     I.021008
003010         04  S-NAME  COLUMN  25  PIC  X(020) VALUE                I.021008
003020              "                    ".                             I.021008
003030         04  S-SC    COLUMN  48  PIC  X(001) VALUE " ".           I.021008
003040         04  S-T     COLUMN  51  PIC  X(008) VALUE "        ".    I.021008
003050         04  S-HCD   COLUMN  60  PIC  X(005) VALUE "     ".       I.021008
003060*****    04  S-KEY   COLUMN   6  PIC  X(007) VALUE "       ".     D.021008
003070*****    04  S-NAME  COLUMN  14  PIC  X(020) VALUE                D.021008
003080*****         "                    ".                             D.021008
003090*****    04  S-SC    COLUMN  37  PIC  X(001) VALUE " ".           D.021008
003100*****    04  S-T     COLUMN  40  PIC  X(008) VALUE "        ".    D.021008
003110*****    04  S-TN    COLUMN  49  PIC  X(008) VALUE "        ".    D.021008
003120*****    04  S-SNO   COLUMN  59  PIC  X(005) VALUE "     ".       D.021008
003130*****    04  S-ZC    COLUMN  67  PIC  X(001) VALUE " ".           D.021008
003140*****    04  S-MC    COLUMN  73  PIC  X(001) VALUE " ".           D.021008
003150*****02  LINE   4.                                                D.940510
003160*****  03  D-PM    COLUMN  33  PIC  X(040) VALUE                  D.940510
003170*****       "< 材料ｺｰﾄﾞ        ～ 999999 まで  ﾘﾀｰﾝ >".           D.940510
003180*****  03  S-PM    COLUMN  33  PIC  X(040) VALUE                  D.940510
003190*****       "                                        ".           D.940510
003200     02  LINE  22.                                                I.940510
003210       03  D-PM    COLUMN  20  PIC  X(038) VALUE                  I.940510
003220            "< 材料ｺｰﾄﾞ         ～ 9999999   ﾘﾀｰﾝ >".             I.940510
003230       03  S-PM    COLUMN  20  PIC  X(038) VALUE                  I.940510
003240            "                                      ".             I.940510
003250 01  C-ERR.
003260     02  LINE  24.
003270*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.940606
003280       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
003290            "***  ﾄｳﾛｸ ｽﾞﾐ  ***".
003300       03  E-ME2   COLUMN  15  PIC  X(017) VALUE
003310            "***  ﾏｽﾀｰ ﾅｼ  ***".
003320       03  E-ME3   COLUMN  15  PIC  N(013) VALUE
003330            NC"＊＊＊　キャンセル　＊＊＊".
003340       03  E-ME4   COLUMN  15  PIC  X(033) VALUE
003350            "***  ﾄｳｹｲ ｺｳﾓｸ ｶﾞ ZERO ﾃﾞ ﾅｲ  ***".
003360       03  E-ME5   COLUMN  15  PIC  X(021) VALUE                  I.021008
003370            "***  ﾋﾝﾒｲﾏｽﾀｰ ﾅｼ  ***".                              I.021008
003380       03  E-ME11  COLUMN  15  PIC  X(019) VALUE
003390            "***  WRITE ｴﾗｰ  ***".
003400       03  E-ME12  COLUMN  15  PIC  X(021) VALUE
003410            "***  REWRITE ｴﾗｰ  ***".
003420       03  E-ME13  COLUMN  15  PIC  X(020) VALUE
003430            "***  DELETE ｴﾗｰ  ***".
003440*****  03  E-ME71.                                                D.940606
003450*****    04  COLUMN   1  PIC  X(013) FROM  W-FILE.                D.940606
003460*****    04  COLUMN  15  PIC  N(021) VALUE                        D.940606
003470*****         NC"オーバーフロー、領域を拡張し、ＦＮＣ＋再開".     D.940606
003480*****  03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        D.940606
003490*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.940606
003500*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.940606
003510*****  03  E-CL.                                                  D.940606
003520*****    04  COLUMN   1  PIC  X(040) VALUE                        D.940606
003530*****         "                                        ".         D.940606
003540*****    04  COLUMN  41  PIC  X(040) VALUE                        D.940606
003550*****         "                                        ".         D.940606
003560     COPY LSSEM.                                                  I.940606
003570     COPY LIBSCR.
003580 PROCEDURE DIVISION.
003590 M-020.
003600     COPY LIBCPR.
003610     MOVE DATE-03R TO H-DATE.
003620     DISPLAY C-CLEAR.
003630     CALL "SCKM05".
003640     OPEN I-O KJ-M.
003650     OPEN INPUT KH-M.                                             I.021008
003660     INITIALIZE W-DATA.
003670     MOVE 9999999 TO W-ECO.                                       I.151106
003680*****MOVE 6 TO W-L.                                               D.940510
003690     MOVE 5 TO W-L.                                               I.940510
003700 M-040.
003710     ADD 1 TO W-L.
003720*****IF W-L = 22                                                  D.940510
003730     IF W-L = 21                                                  I.940510
003740         DISPLAY C-CLEAR
003750         CALL "SCKM05"
003760*****    MOVE 7 TO W-L.                                           D.940510
003770         MOVE 6 TO W-L.                                           I.940510
003780 M-060.
003790     INITIALIZE W-R.
003800     ACCEPT A-ACT.
003810     IF ESTAT NOT = HTB AND SKP
003820         GO TO M-060.
003830     IF W-ACT = 9
003840         GO TO M-980.
003850     IF W-ACT = 4
003860         DISPLAY D-CL D-PM
003870         GO TO M-500.
003880     IF W-ACT NOT = 1 AND 2 AND 3
003890         GO TO M-060.
003900 M-100.
003910     ACCEPT A-KEY.
003920     DISPLAY E-CL.
003930     IF ESTAT = BTB
003940         GO TO M-060.
003950     IF ESTAT NOT = HTB AND SKP
003960         GO TO M-100.
003970     IF W-KEY = ZERO OR SPACE
003980         GO TO M-100.
003990     MOVE W-KEY TO KJ-KEY.
004000     READ KJ-M INVALID KEY
004010         GO TO M-120.
004020     IF W-ACT = 1
004030         DISPLAY E-ME1 E-ME98
004040         GO TO M-100.
004050     MOVE KJ-R TO W-R.
004060*****DISPLAY A-NAME A-SC D-T.                                     D.940523
004070*****DISPLAY A-NAME A-SC D-T A-MC.                                D.021008
004080*****IF W-SC = 2 OR 3                                             D.021008
004090*****    DISPLAY D-TN A-SNO                                       D.021008
004100*****  ELSE                                                       D.021008
004110*****    DISPLAY S-TN S-SNO.                                      D.021008
004120*****IF W-SC = 1                                                  D.021008
004130*****    DISPLAY A-ZC                                             D.021008
004140*****  ELSE                                                       D.021008
004150*****    DISPLAY S-ZC.                                            D.021008
004160     DISPLAY A-NAME A-SC D-T.                                     I.021008
004170     IF W-SC = 5                                                  I.021008
004180         DISPLAY A-HCD                                            I.021008
004190       ELSE                                                       I.021008
004200         DISPLAY S-HCD.                                           I.021008
004210     IF W-ACT NOT = 3
004220         GO TO M-140.
004230     IF KJ-SC NOT = 4                                             I.000516
004240         IF ZERO NOT = KJ-SSU OR KJ-KSU OR KJ-HSU OR KJ-ZSU       I.021008
004250*****    IF ZERO NOT = KJ-SSU OR KJ-KSU OR KJ-HSU OR              D.021008
004260*****                            KJ-ZSU OR KJ-SYS                 D.021008
004270         DISPLAY E-ME4 E-ME98.
004280     GO TO M-280.
004290 M-120.
004300     IF W-ACT NOT = 1
004310         DISPLAY E-ME2 E-ME98
004320         GO TO M-100.
004330 M-140.
004340     ACCEPT A-NAME.
004350     IF ESTAT = BTB
004360         GO TO M-100.
004370     IF ESTAT NOT = HTB AND SKP
004380         GO TO M-140.
004390 M-160.
004400     ACCEPT A-SC.
004410     IF ESTAT = BTB
004420         GO TO M-140.
004430     IF ESTAT NOT = HTB AND SKP
004440         GO TO M-160.
004450*****IF W-SC NOT = 1 AND 2 AND 3 AND 4                            D.021008
004460*****IF W-SC NOT = 1 AND 2 AND 3 AND 4 AND 5                      D.021217
004470     IF W-SC NOT = 0 AND 1 AND 2 AND 3 AND 4 AND 5                I.021217
004480         GO TO M-160.
004490 M-180.
004500     ACCEPT A-T.
004510     IF ESTAT = BTB
004520         GO TO M-160.
004530     IF ESTAT NOT = HTB AND SKP
004540         GO TO M-180.
004550     DISPLAY D-T.
004560     IF W-SC NOT = 5                                              I.021008
004570         MOVE SPACE TO W-HCD                                      I.021008
004580         DISPLAY S-HCD                                            I.021008
004590         GO TO M-280.                                             I.021008
004600*****IF W-SC = 1 OR 4                                             D.930805
004610*****IF W-SC = 1                                                  D.021008
004620*****    MOVE ZERO TO W-TN                                        D.021008
004630*****    MOVE SPACE TO W-SNO                                      D.021008
004640*****    DISPLAY S-TN S-SNO                                       D.021008
004650*****    GO TO M-240.                                             D.021008
004660*****IF W-SC = 4                                                  D.021008
004670*****    MOVE ZERO TO W-TN W-ZC                                   D.021008
004680*****    MOVE SPACE TO W-SNO                                      D.021008
004690*****    DISPLAY S-TN S-SNO S-ZC                                  D.021008
004700*****    GO TO M-280.                                             D.940314
004710*****    GO TO M-260.                                             D.021008
004720 M-200.
004730*****ACCEPT A-TN.                                                 D.021008
004740     ACCEPT A-HCD.                                                I.021008
004750     DISPLAY E-CL.                                                I.021008
004760     IF ESTAT = BTB
004770         GO TO M-180.
004780     IF ESTAT NOT = HTB AND SKP
004790         GO TO M-200.
004800     MOVE W-HCD TO KH-KEY.                                        I.021008
004810     READ KH-M WITH UNLOCK INVALID KEY                            I.021008
004820         DISPLAY E-ME5 E-ME98                                     I.021008
004830         GO TO M-200.                                             I.021008
004840*****DISPLAY D-TN.                                                D.021008
004850*M-220.                                                           D.021008
004860*****ACCEPT A-SNO.                                                D.021008
004870*****IF ESTAT = BTB                                               D.021008
004880*****    GO TO M-200.                                             D.021008
004890*****IF ESTAT NOT = HTB AND SKP                                   D.021008
004900*****    GO TO M-220.                                             D.021008
004910*****MOVE 0 TO W-ZC.                                              D.021008
004920*****DISPLAY S-ZC.                                                D.021008
004930*****GO TO M-280.                                                 D.940314
004940*****GO TO M-260.                                                 D.021008
004950*M-240.                                                           D.021008
004960*****ACCEPT A-ZC.                                                 D.021008
004970*****IF ESTAT = BTB                                               D.021008
004980*****    GO TO M-180.                                             D.021008
004990*****IF ESTAT NOT = HTB AND SKP                                   D.021008
005000*****    GO TO M-240.                                             D.021008
005010*****IF W-ZC > 1                                                  D.021008
005020*****    GO TO M-240.                                             D.021008
005030*M-260.                                                           D.021008
005040*****ACCEPT A-MC.                                                 D.021008
005050*****IF ESTAT = BTB                                               D.021008
005060*****    IF W-SC = 2 OR 3                                         D.021008
005070*****        GO TO M-220.                                         D.021008
005080*****IF ESTAT = BTB                                               D.021008
005090*****    IF W-SC = 1                                              D.021008
005100*****        GO TO M-240                                          D.021008
005110*****      ELSE                                                   D.021008
005120*****        GO TO M-180.                                         D.021008
005130*****IF ESTAT NOT = HTB AND SKP                                   D.021008
005140*****    GO TO M-260.                                             D.021008
005150*****IF W-MC > 1                                                  D.021008
005160*****    GO TO M-260.                                             D.021008
005170 M-280.
005180     ACCEPT A-DMM1.
005190     IF ESTAT = BTB
005200         IF W-ACT = 3
005210             GO TO M-100                                          I.940314
005220*****        GO TO M-100.                                         D.940314
005230           ELSE                                                   I.940314
005240             IF W-SC NOT = 5                                      I.021008
005250                 GO TO M-180                                      I.021008
005260               ELSE                                               I.021008
005270                 GO TO M-200.                                     I.021008
005280*****        GO TO M-260.                                         D.021008
005290*****IF ESTAT = BTB                                               D.940314
005300*****    IF W-SC = 2 OR 3                                         D.940314
005310*****        GO TO M-220                                          D.930805
005320*****        GO TO M-220.                                         D.940314
005330*****IF ESTAT = BTB                                               D.940314
005340*****    IF W-SC = 1                                              D.940314
005350*****        GO TO M-240                                          D.940314
005360*****      ELSE                                                   D.940314
005370*****        GO TO M-180.                                         D.940314
005380*****IF ESTAT = BTB                                               D.940314
005390*****    IF W-SC = 2 OR 3                                         D.940314
005400*****        GO TO M-220                                          D.930805
005410*****        GO TO M-220.                                         D.940314
005420*****IF ESTAT = BTB                                               D.940314
005430*****    IF W-SC = 1                                              D.940314
005440*****        GO TO M-240                                          D.940314
005450*****      ELSE                                                   D.940314
005460*****        GO TO M-180.                                         D.940314
005470     IF ESTAT NOT = HTB AND SKP
005480         GO TO M-280.
005490     IF W-DMM = 9
005500         DISPLAY E-ME3 E-ME98
005510         GO TO M-100.
005520     IF W-DMM NOT = 1
005530         GO TO M-280.
005540*
005550     IF W-ACT = 3
005560         GO TO M-360.
005570 M-300.                                                           I.940318
005580     INITIALIZE KJ-R.
005590     MOVE W-R TO KJ-R.
005600     IF W-ACT = 2
005610         GO TO M-340.
005620     WRITE KJ-R INVALID KEY
005630         DISPLAY E-STAT E-ME11 E-ME99
005640*****    GO TO M-980.                                             D.940318
005650         GO TO M-320.                                             I.940318
005660     CALL "CBLTCLS" USING KJ-M.                                   I.920211
005670     GO TO M-040.
005680 M-320.                                                           I.940318
005690     IF ERR-STAT NOT = "24"                                       I.940318
005700         DISPLAY E-ME78 E-ME99                                    I.940318
005710         GO TO M-980.                                             I.940318
005720     DISPLAY E-CL.                                                I.940318
005730     CLOSE KJ-M.                                                  I.940318
005740     MOVE "KJM          " TO W-FILE.                              I.940318
005750     DISPLAY E-ME71 E-ME98 STOP " ".                              I.940318
005760     DISPLAY E-CL.                                                I.940318
005770     OPEN I-O KJ-M.                                               I.940318
005780     GO TO M-300.                                                 I.940318
005790 M-340.
005800     REWRITE KJ-R INVALID KEY
005810         DISPLAY E-ME78 E-STAT E-ME12 E-ME99                      C.940318
005820         GO TO M-980.
005830     GO TO M-040.
005840 M-360.
005850     DELETE KJ-M INVALID KEY
005860         DISPLAY E-ME78 E-STAT E-ME13 E-ME99                      C.940318
005870         GO TO M-980.
005880     CALL "CBLTCLS" USING KJ-M.                                   I.920211
005890     IF COMPLETION-CODE = 000                                     I.980130
005900         MOVE 150 TO COMPLETION-CODE.                             I.980130
005910     GO TO M-040.
005920*****---------------------------------------------------------------------
005930 M-500.
005940     ACCEPT A-SCO.
005950     DISPLAY E-CL.
005960     IF ESTAT = BTB
005970         DISPLAY S-PM
005980         GO TO M-060.
005990     IF ESTAT NOT = HTB AND SKP
006000         GO TO M-500.
006010 M-520.
006020     ACCEPT A-ECO.
006030     IF ESTAT = BTB
006040         GO TO M-500.
006050     IF ESTAT NOT = HTB AND SKP
006060         GO TO M-520.
006070     IF W-SCO > W-ECO
006080         GO TO M-520.
006090 M-540.
006100     ACCEPT A-DMM2.
006110     IF ESTAT = BTB
006120         GO TO M-520.
006130     IF ESTAT NOT = HTB AND SKP
006140         GO TO M-540.
006150     IF W-DMM NOT = 1
006160         GO TO M-540.
006170*
006180     MOVE W-SCO TO KJ-KEY.
006190     START KJ-M KEY NOT < KJ-KEY INVALID KEY
006200         DISPLAY E-ME2 E-ME98
006210         GO TO M-500.
006220     READ KJ-M NEXT RECORD AT END
006230         DISPLAY E-ME2 E-ME98
006240         GO TO M-500.
006250     IF KJ-KEY > W-ECO
006260         DISPLAY E-ME2 E-ME98
006270         GO TO M-500.
006280*
006290     PERFORM S-20 THRU S-50.
006300*
006310     GO TO M-040.
006320 M-980.
006330     CLOSE KJ-M.
006340     CLOSE KH-M.                                                  I.021008
006350     DISPLAY C-CLEAR.
006360     STOP RUN.
006370 S-05.
006380     MOVE SPACE TO SP-R.
006390     WRITE SP-R AFTER PAGE.
006400 S-10.
006410     ADD 1 TO W-PAGE.
006420     MOVE W-PAGE TO H-PAGE.
006430     MOVE SPACE TO SP-R.
006440     MOVE HEAD1 TO SP-R.
006450     WRITE SP-R.
006460     MOVE SPACE TO SP-R.
006470     MOVE HEAD2 TO SP-R.
006480     WRITE SP-R AFTER 2.
006490     MOVE SPACE TO SP-R.
006500*****MOVE HEAD3 TO SP-R.                                          D.021008
006510*****WRITE SP-R.                                                  D.021008
006520*****MOVE SPACE TO SP-R.                                          D.021008
006530 S-15.
006540     EXIT.
006550 S-20.
006560     MOVE SPACE TO W-P.
006570     MOVE ZERO TO W-LD W-CD W-PC.
006580 S-25.
006590     ADD 1 TO W-LD.
006600*****IF W-LD NOT = 59                                             D.021008
006610     IF W-LD NOT = 60                                             I.021008
006620         GO TO S-30.
006630     IF W-CD = 0
006640         MOVE 5 TO W-CD
006650         MOVE ZERO TO W-LD
006660         GO TO S-25.
006670     PERFORM S-55 THRU S-65.
006680     MOVE SPACE TO W-P.
006690     MOVE ZERO TO W-LD W-CD.
006700     GO TO S-25.
006710 S-30.
006720*****IF W-CD = 0                                                  D.980213
006730*****    MOVE KJ-KEY TO P-KEY1(W-LD)                              D.980213
006740*****    MOVE KJ-NAME TO P-NAME1(W-LD)                            D.980213
006750*****    MOVE KJ-SC TO P-SC1(W-LD)                                D.980213
006760*****    MOVE KJ-T TO P-T1(W-LD)                                  D.980213
006770*****    MOVE KJ-SNO TO P-SNO1(W-LD)                              D.980213
006780*****    MOVE KJ-ZC TO P-ZC1(W-LD)                                D.980213
006790*****    MOVE KJ-MC TO P-MC1(W-LD)                                D.980213
006800*****    MOVE ":" TO P-X(W-LD)                                    D.980213
006810     IF W-CD NOT = 0                                              I.980213
006820         GO TO S-35.                                              I.980213
006830     MOVE KJ-KEY TO P-KEY1(W-LD).                                 I.980213
006840     MOVE KJ-NAME TO P-NAME1(W-LD).                               I.980213
006850     MOVE KJ-SC TO P-SC1(W-LD).                                   I.980213
006860     MOVE KJ-T TO P-T1(W-LD).                                     I.980213
006870     MOVE KJ-HCD TO P-HCD1(W-LD).                                 I.021008
006880*****MOVE KJ-SNO TO P-SNO1(W-LD).                                 D.021008
006890*****MOVE KJ-ZC TO P-ZC1(W-LD).                                   D.021008
006900*****MOVE KJ-MC TO P-MC1(W-LD).                                   D.021008
006910     MOVE ":" TO P-X(W-LD).                                       I.980213
006920*****IF KJ-TN NOT = ZERO                                          D.021008
006930*****    MOVE KJ-TN TO P-TN1(W-LD).                               D.021008
006940     IF KJ-ENG NOT = ZERO                                         I.980213
006950         MOVE KJ-ENG TO P-ENG1(W-LD).                             I.980213
006960     GO TO S-40.                                                  I.980213
006970 S-35.                                                            I.980213
006980*****IF W-CD NOT = 0                                              D.980213
006990*****    MOVE KJ-KEY TO P-KEY2(W-LD)                              D.980213
007000*****    MOVE KJ-NAME TO P-NAME2(W-LD)                            D.980213
007010*****    MOVE KJ-SC TO P-SC2(W-LD)                                D.980213
007020*****    MOVE KJ-T TO P-T2(W-LD)                                  D.980213
007030*****    MOVE KJ-SNO TO P-SNO2(W-LD)                              D.980213
007040*****    MOVE KJ-ZC TO P-ZC2(W-LD)                                D.980213
007050*****    MOVE KJ-MC TO P-MC2(W-LD)                                D.980213
007060     MOVE KJ-KEY TO P-KEY2(W-LD).                                 I.980213
007070     MOVE KJ-NAME TO P-NAME2(W-LD).                               I.980213
007080     MOVE KJ-SC TO P-SC2(W-LD).                                   I.980213
007090     MOVE KJ-T TO P-T2(W-LD).                                     I.980213
007100     MOVE KJ-HCD TO P-HCD2(W-LD).                                 I.021008
007110*****MOVE KJ-SNO TO P-SNO2(W-LD).                                 D.021008
007120*****MOVE KJ-ZC TO P-ZC2(W-LD).                                   D.021008
007130*****MOVE KJ-MC TO P-MC2(W-LD).                                   D.021008
007140*****IF KJ-TN NOT = ZERO                                          D.021008
007150*****    MOVE KJ-TN TO P-TN2(W-LD).                               D.021008
007160     IF KJ-ENG NOT = ZERO                                         I.980213
007170         MOVE KJ-ENG TO P-ENG2(W-LD).                             I.980213
007180 S-40.                                                            I.980213
007190     READ KJ-M NEXT RECORD AT END
007200         GO TO S-45.
007210     IF KJ-KEY > W-ECO
007220         GO TO S-45.
007230     GO TO S-25.
007240 S-45.
007250     PERFORM S-55 THRU S-65.
007260     CLOSE SP-F.
007270     DISPLAY S-PM.
007280 S-50.
007290     EXIT.
007300 S-55.
007310     IF W-PC = 0
007320         MOVE 5 TO W-PC
007330         OPEN OUTPUT SP-F
007340         PERFORM S-10 THRU S-15
007350       ELSE
007360         PERFORM S-05 THRU S-15.
007370     MOVE ZERO TO W-LD.
007380 S-60.
007390     ADD 1 TO W-LD.
007400*****IF W-LD NOT = 59                                             D.021008
007410     IF W-LD NOT = 60                                             I.021008
007420         IF P-X(W-LD) NOT = SPACE
007430             MOVE SPACE TO SP-R
007440             MOVE W-PD(W-LD) TO SP-R
007450             WRITE SP-R
007460             MOVE SPACE TO SP-R
007470             GO TO S-60.
007480 S-65.
007490     EXIT.
