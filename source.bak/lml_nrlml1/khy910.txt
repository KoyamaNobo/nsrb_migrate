000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHY910.
000030*********************************************************
000040*    PROGRAM         :  工品品名統計マスター　廃棄セット*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*        変更　　　  :  62/04/10                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT KHT-M ASSIGN TO KHT1-MSD  KHT2-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE IS DYNAMIC
000190         RECORD KEY KHT-KEY
000200         ALTERNATE RECORD KEY KHT-KEYD
000210         FILE STATUS IS ERR-STAT.
000220     SELECT HAIKI ASSIGN TO HAIKI-MSD.
000230 I-O-CONTROL.
000240     APPLY SHARED-MODE ON KHT-M.
000250 DATA DIVISION.
000260 FILE SECTION.
000270     COPY LIKHTM.
000280 FD  HAIKI
000290     BLOCK 12 RECORDS
000300     LABEL RECORD IS STANDARD
000310     VALUE OF IDENTIFICATION "HAIK-K".
000320 01  HAIK-R.
000330     02  HAIK-HCD       PIC  X(005).
000340     02  HAIK-SU        PIC  9(006)V9(02).
000350     02  F              PIC  X(008).
000360 WORKING-STORAGE SECTION.
000370 77  W-FILE             PIC  X(013).
000380 01  ERR-STAT           PIC  X(002).
000390 01  W-DATA.
000400     02  CHK            PIC  9(001).
000410     02  W-DMM          PIC  9(001).
000420     COPY LSTAT.
000430 SCREEN SECTION.
000440 SD  C-CRT
000450     END STATUS IS ESTAT.
000460 01  C-CLEAR.
000470     02  LINE   1  CLEAR SCREEN.
000480 01  C-MID.
000490     02  LINE   1  COLUMN  15  PIC  N(026) VALUE
000500         NC"＊＊＊　　工品品名統計マスター　廃棄セット　　＊＊＊".
000510     02  LINE  20  COLUMN  29  PIC  X(022) VALUE
000520          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
000530 01  C-ACP.
000540     02  A-DMM   LINE  20  COLUMN  46  PIC  9(001)
000550          USING W-DMM   CHECK OVERFLOW NO IFC.
000560 01  C-DSP.
000570     02  D-FCM   LINE  10  COLUMN  31  PIC  N(009) VALUE
000580          NC"ＺＥＲＯ　セット中"  REVERSE.
000590     02  D-FSM   LINE  10  COLUMN  31  PIC  N(009) VALUE
000600          NC"　廃棄　セット中　"  REVERSE.
000610     02  D-MC    LINE  10  COLUMN  31  PIC  X(018) VALUE
000620            "                  ".
000630 01  C-ERR.
000640     02  LINE  24.
000650       03  E-ME1   COLUMN  15  PIC  X(026) VALUE
000660            "***  KHTM REWRITE ｴﾗｰ  ***".
000670       03  E-ME2   COLUMN  15  PIC  X(017) VALUE
000680            "***  KHTM ﾅｼ  ***".
000690       03  E-HCD   COLUMN  50  PIC  X(005) FROM  KHT-KEY.
000700     COPY LSSEM.                                                  I.940603
000710     COPY LIBSCR.
000720 PROCEDURE DIVISION.
000730 M-05.
000740     DISPLAY C-CLEAR.
000750     DISPLAY C-MID.
000760 M-10.
000770     ACCEPT A-DMM.
000780     IF ESTAT = PF9
000790         GO TO M-95.
000800     IF ESTAT NOT = HTB AND SKP
000810         GO TO M-10.
000820     IF W-DMM = 9
000830         GO TO M-95.
000840     IF W-DMM NOT = 1
000850         GO TO M-10.
000860*
000870     DISPLAY D-FCM.
000880     OPEN I-O KHT-M.
000890 M-15.
000900     READ KHT-M NEXT RECORD AT END
000910         GO TO M-20.
000920     MOVE ZERO TO KHT-HKS.
000930     REWRITE KHT-R INVALID KEY
000940         DISPLAY E-ME78 E-STAT E-ME1 E-HCD E-ME99
000950         CLOSE KHT-M
000960         GO TO M-95.
000970     GO TO M-15.
000980 M-20.
000990     DISPLAY D-FSM.
001000     OPEN INPUT HAIKI.
001010 M-25.
001020     READ HAIKI AT END
001030         GO TO M-90.
001040     IF HAIK-SU = ZERO
001050         GO TO M-25.
001060     MOVE HAIK-HCD TO KHT-KEY.
001070     READ KHT-M INVALID KEY
001080         DISPLAY E-ME2 E-HCD E-ME99
001090         GO TO M-90.
001100     ADD HAIK-SU TO KHT-HKS.
001110     REWRITE KHT-R INVALID KEY
001120         DISPLAY E-ME78 E-STAT E-ME1 E-HCD E-ME99
001130         GO TO M-90.
001140     GO TO M-25.
001150 M-90.
001160     CLOSE KHT-M.
001170     CLOSE HAIKI.
001180 M-95.
001190     DISPLAY C-CLEAR.
001200     STOP RUN.
