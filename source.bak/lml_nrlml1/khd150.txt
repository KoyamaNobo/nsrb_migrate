000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHD150.
000030*********************************************************
000040*    PROGRAM         :  工品加硫伝票インプット　　　　  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCKD15                          *
000070*        変更　　　  :  62/04/01                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*    JS-SIGN         :  入力=0 , 変換=1                 *
000100*********************************************************
000110 ENVIRONMENT DIVISION.
000120 CONFIGURATION SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.
000180     SELECT KKB-M ASSIGN TO KKB-MSD
000190         ORGANIZATION INDEXED
000200         ACCESS MODE DYNAMIC
000210         RECORD KEY KKB-KEY
000220         FILE STATUS IS ERR-STAT.
000230*****SELECT KHJ-M ASSIGN TO KHJ-MSD                               D.160129
000240*****    ORGANIZATION INDEXED                                     D.160129
000250*****    ACCESS MODE DYNAMIC                                      D.160129
000260*****    RECORD KEY KHJ-KEY                                       D.160129
000270*****    FILE STATUS IS ERR-STAT.                                 D.160129
000280     SELECT KNH-F ASSIGN TO KNH-MSD.
000290     SELECT KH-M ASSIGN TO KH-MSD
000300         ORGANIZATION INDEXED
000310         ACCESS MODE DYNAMIC
000320         RECORD KEY KH-KEY
000330         FILE STATUS IS ERR-STAT.
000340     SELECT JSS-F ASSIGN TO JSS-MSD                               I.020326
000350         ORGANIZATION INDEXED                                     I.020326
000360         ACCESS MODE DYNAMIC                                      I.020326
000370         RECORD KEY JS-KEY                                        I.020326
000380         FILE STATUS IS ERR-STAT.                                 I.020326
000390     SELECT SP-F ASSIGN TO P-PRN999.
000400 I-O-CONTROL.
000410     APPLY SHARED-MODE ON M-DATE
000420     APPLY SHARED-MODE ON KKB-M
000430*****APPLY SHARED-MODE ON KHJ-M                                   D.160129
000440     APPLY SHARED-MODE ON KH-M
000450     APPLY SHARED-MODE ON JSS-F                                   I.020326
000460     APPLY SHIFT-CODE  ON SP-F.                                   A 62/04
000470 DATA DIVISION.
000480 FILE SECTION.
000490     COPY LIBFDD.
000500     COPY LIKKBM.
000510*****COPY LIKHJM.                                                 D.160129
000520     COPY LIKHM.
000530     COPY LSPF.
000540 FD  KNH-F
000550*****BLOCK  5 RECORDS                                             D.981210
000560     BLOCK  4 RECORDS                                             I.981210
000570     LABEL RECORD IS STANDARD
000580     VALUE OF IDENTIFICATION "KNHF".                              C 62/04
000590 01  KNH-R.
000600     02  NH-NHK         PIC  9(002).
000610*****02  NH-DATE        PIC  9(006).                              D.970819
000620*****02  NH-DATE        PIC  9(008).                              D.981210
000630     02  NH-DATE.                                                 I.981210
000640       03  F            PIC  9(002).                              I.981210
000650       03  NH-NGPS      PIC  9(006).                              I.981210
000660     02  NH-KEY         PIC  X(005).
000670     02  NH-TS          PIC  9(002).
000680     02  NH-KS          PIC S9(005).
000690     02  NH-SU          PIC S9(006)V9(02).
000700     02  NH-TN          PIC  9(006)V9(02).                        I.981210
000710     02  NH-KN          PIC S9(008).
000720     02  NH-YC          PIC  9(002).
000730     02  F              PIC  X(001).
000740     02  NH-BS          PIC  9(002).
000750     02  F              PIC  X(002).                              I.090325
000760*****02  NH-GO          PIC  9(002).                              D.090325
000770*****02  F              PIC  X(005).                              D.981210
000780*****02  F              PIC  X(010).                              D.020326
000790*****02  F              PIC  X(009).                              D.021009
000800     02  NH-NC          PIC  9(001).                              I.021009
000810     02  F              PIC  X(008).                              I.021009
000820     02  NH-NRC         PIC  9(001).                              I.020326
000830     02  NH-PRC         PIC  9(001).                              I.981210
000840*****02  F              PIC  X(006).                              D.981210
000850*****02  F              PIC  X(008).                              D.970819
000860 FD  JSS-F                                                        I.020326
000870     BLOCK  5 RECORDS                                             I.020326
000880     LABEL RECORD IS STANDARD                                     I.020326
000890     VALUE OF IDENTIFICATION "JSSF".                              I.020326
000900 01  JSS-R.                                                       I.020326
000910     02  JS-DC          PIC  9(002).                              I.020326
000920     02  JS-DATE        PIC  9(008).                              I.020326
000930     02  JS-NGP   REDEFINES JS-DATE.                              I.020326
000940       03  F            PIC  9(002).                              I.020326
000950       03  JS-NGS       PIC  9(004).                              I.020326
000960       03  F            PIC  9(002).                              I.020326
000970     02  JS-SCD         PIC  9(004).                              I.020326
000980     02  JS-JCD         PIC  9(006).                              I.020326
000990     02  JS-SU          PIC S9(007)V9(02).                        I.020326
001000     02  JS-T           PIC S9(006)V9(02).                        I.020326
001010     02  JS-KIN         PIC S9(008).                              I.020326
001020     02  JS-SHZ         PIC S9(007).                              I.020326
001030     02  JS-CD          PIC  9(006).                              I.020326
001040     02  JS-SJCD        PIC  9(006).                              I.020326
001050     02  JS-NNO         PIC  9(006).                              I.020326
001060     02  JS-FC          PIC  9(001).                              I.020326
001070     02  JS-YC          PIC  9(001).                              I.020326
001080     02  JS-TC          PIC  9(001).                              I.020326
001090     02  JS-SEC         PIC  9(001).                              I.020326
001100     02  JS-SC          PIC  9(001).                              I.020326
001110     02  JS-BSC         PIC  9(001).                              I.020326
001120     02  JS-BKC         PIC  9(002).                              I.020326
001130     02  JS-KCO         PIC  X(005).                              I.020326
001140     02  JS-KHC         PIC  9(001).                              I.020326
001150     02  F              PIC  X(010).                              I.020326
001160     02  JS-KEY.                                                  I.020326
001170       03  JS-DNO       PIC  X(006).                              I.020326
001180       03  JS-GNO       PIC  9(001).                              I.020326
001190     02  JS-PCNT        PIC  9(001).                              I.020326
001200 WORKING-STORAGE SECTION.
001210 77  JS-SIGN            PIC  9(001).                              I.020326
001220 01  HEAD1.
001230     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
001240     02  F              PIC  X(017) VALUE SPACE.                  I.090325
001250*****02  F              PIC  X(019) VALUE SPACE.                  D.090325
001260*****02  F              PIC  N(022) VALUE                         D.020326
001270     02  H-MID          PIC  N(022) VALUE                         I.020326
001280          NC"＊＊＊　　加硫入力　プルーフリスト　　＊＊＊".
001290*****02  F              PIC  X(010) VALUE SPACE.                  D.090325
001300     02  F              PIC  X(007) VALUE SPACE.                  I.090325
001310     02  F              PIC  X(005) VALUE "DATE ".
001320     02  H-DATE         PIC 99B99B99.
001330     02  F              PIC  X(007) VALUE "     P.".
001340     02  H-PAGE         PIC  Z(002).
001350 01  HEAD2.
001360     02  F              PIC  X(049) VALUE
001370          " 日　付　　ｺ-ﾄﾞ 品　　　　名　　　　取ｺ数　　回数".    I.981210
001380     02  F              PIC  X(042) VALUE                         I.090325
001390          "       数　量　　 単　価　　　 金　額 場所".           I.090325
001400*****     " 日　付　　ｺ-ﾄﾞ 品　　　　名　　　　取ｺ数　回　数".    D.981210
001410*****02  F              PIC  X(047) VALUE                         D.090325
001420*****     "       数　量　　 単　価　　　 金　額 機種   号".      D.090325
001430 01  W-P.
001440     02  P-DATE         PIC 99/99/99.
001450     02  F              PIC  X(002).
001460     02  P-KEY          PIC  X(005).
001470     02  F              PIC  X(001).
001480     02  P-NA           PIC  X(020).
001490     02  P-NAR   REDEFINES P-NA.
001500       03  P-NAN        PIC  N(010).
001510     02  P-TS           PIC  Z(005).
001520     02  P-KS           PIC ----,---.                             I.981210
001530*****02  P-KS           PIC ----,--9.                             D.981210
001540     02  P-SU           PIC --,---,--9.99.
001550     02  P-TN           PIC ----,--9.99.
001560     02  P-KN           PIC -----,---,--9.
001570     02  F              PIC  X(001).                                     A
001580     02  P-BS           PIC ZZZ9.
001590*****02  P-GO           PIC ZZZZ9.                                D.090325
001600 01  W-R.
001610     02  W-NHK          PIC  9(002).
001620*****02  W-DATE         PIC  9(006).                              D.970819
001630     02  W-DATE         PIC  9(008).                              I.970819
001640     02  W-NGPD  REDEFINES W-DATE.
001650       03  W-NG.
001660*****    04  W-NEN      PIC  9(002).                              D.970819
001670         04  W-NEN      PIC  9(004).                              I.970819
001680         04  W-NENL  REDEFINES W-NEN.                             I.970819
001690           05  W-NEN1   PIC  9(002).                              I.970819
001700           05  W-NEN2   PIC  9(002).                              I.970819
001710         04  W-GET      PIC  9(002).
001720       03  W-NGL   REDEFINES W-NG.                                I.970819
001730         04  F          PIC  9(002).                              I.970819
001740         04  W-NGS      PIC  9(004).                              I.970819
001750       03  W-PEY        PIC  9(002).
001760     02  W-NGPL  REDEFINES W-DATE.                                I.970819
001770       03  F            PIC  9(002).                              I.970819
001780       03  W-NGPS       PIC  9(006).                              I.970819
001790     02  W-KEY          PIC  X(005).
001800     02  W-TS           PIC  9(002).
001810     02  W-KS           PIC S9(005).
001820     02  W-SU           PIC S9(006)V9(02).
001830     02  W-TN           PIC  9(006)V9(02).                        I.981210
001840     02  W-KN           PIC S9(008).
001850     02  W-YC           PIC  9(002).
001860     02  F              PIC  X(001).
001870     02  W-BS           PIC  9(002).
001880     02  F              PIC  X(002).                              I.090325
001890*****02  W-GO           PIC  9(002).                              D.090325
001900*****02  F              PIC  X(010).                              D.021009
001910     02  W-NC           PIC  9(001).                              I.021009
001920     02  F              PIC  X(009).                              I.021009
001930     02  W-PRC          PIC  9(001).                              I.981210
001940*****02  F              PIC  X(006).                              D.981210
001950*****02  F              PIC  X(008).                              D.970819
001960 01  WT-D.
001970     02  WT-KS          PIC S9(006).
001980     02  WT-SU          PIC S9(007)V9(02).
001990     02  WT-KN          PIC S9(010).
002000 01  W-DATA.
002010*****02  W-TN           PIC  9(006)V9(02).                        D.981210
002020*****02  W-NGP          PIC  9(006) VALUE ZERO.                   D.970819
002030     02  W-NGP          PIC  9(008) VALUE ZERO.                   I.970819
002040     02  W-CO           PIC  X(005).
002050     02  W-DMM          PIC  9(001).
002060     02  W-CHK          PIC  9(001).
002070     02  W-SPACE        PIC  X(078) VALUE SPACE.
002080     02  W-PAGE         PIC  9(002) VALUE ZERO.
002090     02  W-KNG          PIC  9(004).
002100     02  W-KNGD  REDEFINES W-KNG.                                 I.921006
002110       03  W-KNEN       PIC  9(002).                              I.921006
002120       03  W-KGET       PIC  9(002).                              I.921006
002130     02  W-L            PIC  9(002) VALUE ZERO.                          A
002140     02  W-BSM          PIC  X(005).
002150     02  CNT            PIC  9(004).                              I.981210
002160 01  ERR-STAT           PIC  X(002).
002170     COPY LSTAT.
002180 SCREEN SECTION.
002190 SD  C-CRT
002200     END STATUS IS ESTAT.
002210 01  C-CLEAR.
002220     02  C-CL    LINE   1  CLEAR SCREEN.
002230 01  C-MID.                                                       I.020326
002240     02  LINE   3  COLUMN  10  PIC  N(020) VALUE                  I.020326
002250          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.020326
002260     02  LINE   4  COLUMN  10  PIC  N(020) VALUE                  I.020326
002270          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.020326
002280     02  LINE   5  COLUMN  10  PIC  N(020) VALUE                  I.020326
002290          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.020326
002300     02  LINE   6  COLUMN  10  PIC  N(020) VALUE                  I.020326
002310          NC"＊＊＊　　工品　製品仕入　変換　　＊＊＊".           I.020326
002320     02  LINE   7  COLUMN  10  PIC  N(020) VALUE                  I.020326
002330          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.020326
002340     02  LINE   8  COLUMN  10  PIC  N(020) VALUE                  I.020326
002350          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.020326
002360     02  LINE   9  COLUMN  10  PIC  N(020) VALUE                  I.020326
002370          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.020326
002380     02  LINE  22  COLUMN  20  PIC  X(022) VALUE                  I.020326
002390          "確認  OK=1 NO=9   ﾘﾀｰﾝ".                               I.020326
002400*01  C-ACP   LINE W-L.                                            D.020326
002410*****02  A-PEY   COLUMN   2  PIC  9(002)                          D.020326
002420 01  C-ACP.                                                       I.020326
002430     02  LINE W-L.                                                I.020326
002440       03  A-PEY   COLUMN   2  PIC  9(002)                        I.020326
002450            USING W-PEY   CHECK OVERFLOW NO IFC.
002460*****02  A-KEY   COLUMN   5  PIC  X(005)                          D.020326
002470       03  A-KEY   COLUMN   5  PIC  X(005)                        I.020326
002480            USING W-KEY   CHECK OVERFLOW NO IFC.
002490*****02  A-TS    COLUMN  34  PIC  9(002)                          D.020326
002500       03  A-TS    COLUMN  34  PIC  9(002)                        I.020326
002510            USING W-TS    CHECK OVERFLOW NO IFC.
002520*****02  A-KS    COLUMN  37  PIC S9(004)                          D.020326
002530       03  A-KS    COLUMN  37  PIC S9(004)                        I.020326
002540            USING W-KS    CHECK OVERFLOW NO IFC.
002550*****02  A-SU    COLUMN  43  PIC S9(006)V9(02)                    D.020326
002560       03  A-SU    COLUMN  43  PIC S9(006)V9(02)                  I.020326
002570            USING W-SU    CHECK OVERFLOW NO IFC.
002580*****02  A-TN    COLUMN  54  PIC  9(006)V9(02)                    D.020326
002590*****  03  A-TN    COLUMN  54  PIC  9(006)V9(02)                  D.020823
002600*****       USING W-TN    CHECK OVERFLOW NO IFC.                  D.020823
002610*****02  A-BS    COLUMN  64  PIC  9(002)                          D.020326
002620       03  A-BS    COLUMN  64  PIC  9(002)                        I.020326
002630            USING W-BS    CHECK OVERFLOW NO IFC.
002640*****02  A-GO    COLUMN  73  PIC  9(002)                          D.020326
002650*****  03  A-GO    COLUMN  73  PIC  9(002)                        D.090325
002660*****       USING W-GO    CHECK OVERFLOW NO IFC.                  D.090325
002670*****02  A-DMM   COLUMN  78  PIC  9(001)                          D.020326
002680*****  03  A-DMM   COLUMN  78  PIC  9(001)                        D.090325
002690       03  A-DMM   COLUMN  75  PIC  9(001)                        I.090325
002700            USING W-DMM   CHECK OVERFLOW NO IFC.
002710     02  A-DMMC  LINE  22  COLUMN  37  PIC  9(001)                I.020326
002720          USING W-DMM   CHECK OVERFLOW NO IFC.                    I.020326
002730 01  C-DSP.
002740     02  D-NG    LINE   2.                                        I.921006
002750       03  COLUMN   2  PIC Z9      FROM  W-KNEN.                  I.921006
002760       03  COLUMN   6  PIC Z9      FROM  W-KGET.                  I.921006
002770     02  LINE W-L.
002780       03  D-NA    COLUMN  11  PIC  X(020)     FROM  KH-NAME.
002790       03  D-TS    COLUMN  34  PIC Z9          FROM  W-TS.
002800       03  D-KS    COLUMN  37  PIC ZZZ9-       FROM  W-KS.
002810       03  D-SU    COLUMN  43  PIC ZZZZZ9.99-  FROM  W-SU.
002820       03  D-TN    COLUMN  54  PIC ZZZZZ9.99   FROM  W-TN.
002830       03  D-BSM   COLUMN  67  PIC  X(005)     FROM  W-BSM.
002840     02  D-PRN1  LINE   1  COLUMN  20  PIC  N(020) VALUE          I.981210
002850          NC"＊＊＊　　加硫伝票　入力リスト　　＊＊＊".           I.981210
002860     02  D-PRN2  LINE   1  COLUMN  20  PIC  N(020) VALUE          I.020326
002870          NC"＊＊＊　　製品仕入　変換リスト　　＊＊＊".           I.020326
002880     02  LINE  15.
002890       03  D-SME05 COLUMN  18  PIC  N(017) VALUE
002900            NC"＊＊＊　　他で加硫入力中　　＊＊＊" BLINK.
002910       03  D-SME06 COLUMN  18  PIC  N(017) VALUE
002920            NC"＊＊＊　　他で廃却入力中　　＊＊＊" BLINK.
002930       03  D-SME13 COLUMN  18  PIC  N(017) VALUE
002940            NC"＊＊＊　　他で日次更新中　　＊＊＊" BLINK.
002950       03  D-SME15 COLUMN  18  PIC  N(017) VALUE
002960            NC"＊＊＊　　他で月次更新中　　＊＊＊" BLINK.
002970 01  C-ERR.
002980     02  LINE  24.
002990       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
003000       03  E-ME1   COLUMN  15  PIC  X(016) VALUE
003010            "***  KHM ﾅｼ  ***".
003020       03  E-ME2   COLUMN  15  PIC  X(014) VALUE
003030            "(  LTI ｶｸﾆﾝ  )".
003040       03  E-ME3   COLUMN  15  PIC  X(026) VALUE                  I.020326
003050            "***  JSSF REWRITE ｴﾗｰ  ***".                         I.020326
003060       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
003070            "***  KKBM ﾅｼ  ***".
003080       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
003090            "***  KKBM REWRITE ｴﾗｰ  ***".
003100       03  E-ME6.                                                 I.020326
003110         04  COLUMN  15  PIC  X(018) VALUE                        I.020326
003120              "***  ﾋﾂﾞｹ ｴﾗｰ  ***".                               I.020326
003130         04  COLUMN  35  PIC 99/99   FROM  JS-NGS.                I.020326
003140       03  E-ME7   COLUMN  15  PIC  X(023) VALUE                  I.020806
003150            "***  ﾀﾝｶ ｶﾞ ﾊｲｯﾃﾅｲ  ***".                            I.020806
003160*****  03  E-ME8   COLUMN  15  PIC  N(022) VALUE                  D.160129
003170*****       NC"材料使用マスターなし　（チェックして下さい）".     D.160129
003180       03  E-ME9   COLUMN  15  PIC  X(022) VALUE                  I.021009
003190            "***  ｾﾝﾋﾝｼｲﾚ ﾁｪｯｸ  ***".                             I.021009
003200       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        I.940319
003210       03  E-ME90  COLUMN  15  PIC  N(022) VALUE
003220            NC"【　　工品区分マスターを修正して下さい　　】".
003230       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003240       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003250       03  E-KEY   COLUMN  40  PIC  X(005) FROM  KH-KEY.          I.020326
003260       03  E-CL.
003270         04  COLUMN   1  PIC  X(040) VALUE
003280              "                                        ".
003290         04  COLUMN  41  PIC  X(040) VALUE
003300              "                                        ".
003310     COPY LIBSCR.
003320 PROCEDURE DIVISION.
003330 M-05.
003340     ACCEPT JS-SIGN.                                              I.020326
003350     IF JS-SIGN > 1                                               I.020326
003360         STOP RUN.                                                I.020326
003370     COPY LIBCPR.
003380     MOVE D-NKNG TO W-KNG.
003390     DISPLAY C-CLEAR.
003400*
003410     OPEN I-O KKB-M.
003420     MOVE SPACE TO KKB-KEY.
003430     MOVE 90 TO KKB-NO.
003440     READ KKB-M INVALID KEY
003450         CLOSE KKB-M
003460         DISPLAY E-ME78 E-ME4 E-ME99                              C.940319
003470         DISPLAY C-CLEAR
003480         STOP RUN.
003490     IF KKB-SC15 = 1
003500         CLOSE KKB-M
003510         DISPLAY D-SME15 E-ME99
003520         DISPLAY C-CLEAR
003530         STOP RUN.
003540     IF KKB-SC13 = 1
003550         CLOSE KKB-M
003560         DISPLAY D-SME13 E-ME99
003570         DISPLAY C-CLEAR
003580         STOP RUN.
003590     IF KKB-SC05 = 1
003600         CLOSE KKB-M
003610         DISPLAY D-SME05 E-ME99
003620         DISPLAY C-CLEAR
003630         STOP RUN.
003640     IF KKB-SC06 = 1
003650         CLOSE KKB-M
003660         DISPLAY D-SME06 E-ME99
003670         DISPLAY C-CLEAR
003680         STOP RUN.
003690     MOVE 1 TO KKB-SC05.
003700     REWRITE KKB-R INVALID KEY
003710         DISPLAY E-ME78 E-STAT E-ME5 E-ME99                       C.940319
003720         CLOSE KKB-M
003730         DISPLAY C-CLEAR
003740         STOP RUN.
003750     CLOSE KKB-M.
003760*
003770     IF JS-SIGN = 0                                               I.020326
003780         GO TO M-15.                                              I.020326
003790     DISPLAY C-MID.                                               I.020326
003800 M-10.                                                            I.020326
003810     ACCEPT A-DMMC.                                               I.020326
003820     IF ESTAT = PF9                                               I.020326
003830         GO TO M-95.                                              I.020326
003840     IF ESTAT NOT = HTB AND SKP                                   I.020326
003850         GO TO M-10.                                              I.020326
003860     IF W-DMM = 9                                                 I.020326
003870         GO TO M-95.                                              I.020326
003880     IF W-DMM NOT = 1                                             I.020326
003890         GO TO M-10.                                              I.020326
003900 M-15.                                                            I.020326
003910     OPEN INPUT KH-M.
003920*****OPEN INPUT KKB-M.                                            D.020326
003930*****OPEN INPUT KHJ-M.                                            D.020326
003940     OPEN EXTEND KNH-F.
003950     MOVE DATE-03R TO H-DATE.
003960     MOVE 5 TO W-CHK.
003970     IF JS-SIGN = 1                                               I.020326
003980         OPEN I-O JSS-F                                           I.020326
003990         GO TO M-40.                                              I.020326
004000     OPEN INPUT KKB-M.                                            I.020326
004010*****OPEN INPUT KHJ-M.                                            D.160129
004020 M-20.
004030     PERFORM ACP-RTN THRU ACP-EX.                                 I.020326
004040     CLOSE KKB-M.                                                 I.020326
004050*****CLOSE KHJ-M.                                                 D.160129
004060     GO TO M-50.                                                  I.020326
004070*****CALL "SCKD15".                                               D.020326
004080*****DISPLAY D-NG.                                                D.020326
004090*****MOVE 4 TO W-L.                                               D.020326
004100*****MOVE ZERO TO W-R.                                            D.020326
004110*****MOVE W-KNG TO W-NGS.                                         D.020326
004120*****IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        D.020326
004130*****    ADD DATE-NC1 TO W-NEN.                                   D.020326
004140*****IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        D.020326
004150*****    ADD DATE-NC2 TO W-NEN.                                   D.020326
004160*****MOVE W-KNG TO W-NG.                                          D.970819
004170*M-22A.                                                           D.020326
004180*****IF W-NGP NOT = ZERO                                          D.020326
004190*****    MOVE W-NGP TO W-DATE                                     D.020326
004200*****    MOVE W-CO TO W-KEY                                       D.020326
004210*****    DISPLAY A-PEY A-KEY.                                     D.020326
004220*****ACCEPT A-PEY.                                                D.020326
004230*****IF ESTAT = C2 OR PF9                                         D.020326
004240*****    GO TO M-22M.                                             D.020326
004250*****    GO TO M-52C.                                             D.981210
004260*****IF ESTAT NOT = HTB AND SKP                                   D.020326
004270*****    GO TO M-22A.                                             D.020326
004280*****IF W-GET < 1 OR > 12                                         D.921006
004290*****    GO TO M-22A.                                             D.921006
004300*****IF W-PEY < 1 OR > 31                                         D.020326
004310*****    GO TO M-22A.                                             D.020326
004320*****IF W-NG NOT = W-KNG                                          D.921006
004330*****    GO TO M-22A.                                             D.921006
004340*****IF W-NGP = W-DATE                                            D.020326
004350*****    GO TO M-22B.                                             D.020326
004360*****IF W-CHK = ZERO                                              D.981210
004370*****    PERFORM TOT-RTN THRU TOT-EX.                             D.981210
004380*****MOVE ZERO TO WT-D.                                           D.981210
004390*****MOVE W-DATE TO W-NGP.                                        D.020326
004400*M-22B.                                                           D.020326
004410*****ACCEPT A-KEY.                                                D.020326
004420*****DISPLAY E-CL.                                                D.020326
004430*****IF ESTAT = BTB                                               D.020326
004440*****    GO TO M-22A.                                             D.020326
004450*****IF ESTAT NOT = HTB AND SKP                                   D.020326
004460*****    GO TO M-22B.                                             D.020326
004470*****MOVE W-KEY TO KH-KEY.                                        D.020326
004480*****READ KH-M WITH UNLOCK INVALID KEY                            D.020326
004490*****    DISPLAY E-ME1 E-ME98                                     D.020326
004500*****    GO TO M-22B.                                             D.020326
004510*****DISPLAY D-NA.                                                D.020326
004520*****MOVE W-KEY TO W-CO.                                          D.020326
004530*****MOVE KH-TRS TO W-TS.                                         D.020326
004540*****MOVE KH-T1 TO W-TN.                                          D.020326
004550*****IF KH-YC = 10 OR 11                                          D.940523
004560*****    GO TO M-22D.                                             D.940523
004570*****MOVE ZERO TO W-TS W-KS.                                      D.940523
004580*****DISPLAY D-TS D-KS.                                           D.940523
004590*****IF KH-YC NOT = 10 AND 11                                     D.020326
004600*****    MOVE ZERO TO W-TS W-KS                                   D.020326
004610*****    DISPLAY D-TS D-KS                                        D.020326
004620*****    GO TO M-22C.                                             D.020326
004630*****MOVE SPACE TO KHJ-KEY.                                       D.020326
004640*****MOVE W-KEY TO KHJ-HCD.                                       D.020326
004650*****START KHJ-M KEY NOT < KHJ-KEY INVALID KEY                    D.020326
004660*****    DISPLAY E-ME8 E-ME98                                     D.020326
004670*****    GO TO M-22D.                                             D.020326
004680*****READ KHJ-M NEXT RECORD WITH UNLOCK AT END                    D.020326
004690*****    DISPLAY E-ME8 E-ME98                                     D.020326
004700*****    GO TO M-22D.                                             D.020326
004710*****IF KHJ-HCD NOT = W-KEY                                       D.020326
004720*****    DISPLAY E-ME8 E-ME98.                                    D.020326
004730*****GO TO M-22D.                                                 D.020326
004740*M-22C.                                                           D.020326
004750*****ACCEPT A-SU.                                                 D.020326
004760*****IF ESTAT = BTB                                               D.020326
004770*****    GO TO M-22B.                                             D.020326
004780*****IF ESTAT NOT = HTB AND SKP                                   D.020326
004790*****    GO TO M-22C.                                             D.020326
004800*****DISPLAY D-SU.                                                D.020326
004810*****IF W-SU = ZERO                                               D.020326
004820*****    GO TO M-22C.                                             D.020326
004830*****IF W-TN NOT = ZERO                                           D.020326
004840*****    GO TO M-22G.                                             D.020326
004850*****GO TO M-22F.                                                 D.020326
004860*M-22D.                                                           D.020326
004870*****DISPLAY D-TS.                                                D.020326
004880*****ACCEPT A-TS.                                                 D.020326
004890*****DISPLAY E-CL.                                                D.020326
004900*****IF ESTAT = BTB                                               D.020326
004910*****    GO TO M-22B.                                             D.020326
004920*****IF ESTAT NOT = HTB AND SKP                                   D.020326
004930*****    GO TO M-22D.                                             D.020326
004940*****DISPLAY D-TS.                                                D.020326
004950*M-22E.                                                           D.020326
004960*****ACCEPT A-KS.                                                 D.020326
004970*****IF ESTAT = BTB                                               D.020326
004980*****    GO TO M-22D.                                             D.020326
004990*****IF ESTAT NOT = HTB AND SKP                                   D.020326
005000*****    GO TO M-22E.                                             D.020326
005010*****DISPLAY D-KS.                                                D.020326
005020*****COMPUTE W-SU = W-TS * W-KS.                                  D.020326
005030*****DISPLAY D-SU.                                                D.020326
005040*****IF W-SU = ZERO                                               D.020326
005050*****    GO TO M-22D.                                             D.020326
005060*****GO TO M-22G.                                                 D.020326
005070*M-22F.                                                           D.020326
005080*****ACCEPT A-TN.                                                 D.020326
005090*****IF ESTAT = BTB                                               D.020326
005100*****    GO TO M-22C.                                             D.020326
005110*****IF ESTAT NOT = HTB AND SKP                                   D.020326
005120*****    GO TO M-22F.                                             D.020326
005130*****IF W-TN = ZERO                                               D.020326
005140*****    GO TO M-22F.                                             D.020326
005150*M-22G.                                                           D.020326
005160*****COMPUTE W-KN = W-SU * W-TN.                                  D.020326
005170*****DISPLAY D-TN.                                                D.020326
005180*****IF KH-YC = 10 OR 11                                          D.020326
005190*****    GO TO M-22H.                                             D.020326
005200*****MOVE ZERO TO W-BS W-GO.                                      D.020326
005210*****DISPLAY A-BS A-GO.                                           D.020326
005220*****GO TO M-22J.                                                 D.020326
005230*M-22H.                                                           D.020326
005240*****ACCEPT A-BS.                                                 D.020326
005250*****DISPLAY E-CL.                                                D.020326
005260*****IF ESTAT = BTB                                               D.020326
005270*****    GO TO M-22E.                                             D.020326
005280*****IF ESTAT NOT = HTB AND SKP                                   D.020326
005290*****    GO TO M-22H.                                             D.020326
005300*****MOVE SPACE TO KKB-KEY.                                       D.020326
005310*****MOVE "04" TO KKB-NO.                                         D.020326
005320*****MOVE W-BS TO KKB-KS2.                                        D.020326
005330*****READ KKB-M WITH UNLOCK INVALID KEY                           D.020326
005340*****    DISPLAY E-ME4 E-ME98                                     D.020326
005350*****    GO TO M-22H.                                             D.020326
005360*****MOVE KKB-KSN2 TO W-BSM.                                      D.020326
005370*****DISPLAY D-BSM.                                               D.020326
005380*****IF W-BS < 1 OR > 39                                          D.921102
005390*****    GO TO M-22H.                                             D.921102
005400*****IF W-BS = 11                                                 D.960314
005410*****    IF KH-KIS NOT = 6                                        D.921006
005420*****    IF KH-KIS NOT = 4                                        D.960314
005430*****        DISPLAY E-ME2 E-ME98.                                D.960314
005440*M-22I.                                                           D.020326
005450*****ACCEPT A-GO.                                                 D.020326
005460*****DISPLAY E-CL.                                                D.020326
005470*****IF ESTAT = BTB                                               D.020326
005480*****    GO TO M-22H.                                             D.020326
005490*****IF ESTAT NOT = HTB AND SKP                                   D.020326
005500*****    GO TO M-22I.                                             D.020326
005510*M-22J.                                                           D.020326
005520*****ACCEPT A-DMM.                                                D.020326
005530*****IF ESTAT NOT = BTB                                           D.981210
005540*****    GO TO M-22K.                                             D.981210
005550*****IF KH-YC = 10 OR 11                                          D.981210
005560*****    GO TO M-22I.                                             D.981210
005570*****IF KH-T1 = ZERO                                              D.981210
005580*****    GO TO M-22F.                                             D.981210
005590*****IF ESTAT = BTB                                               D.020326
005600*****    IF KH-YC = 10 OR 11                                      D.020326
005610*****        GO TO M-22I                                          D.020326
005620*****      ELSE                                                   D.020326
005630*****        IF KH-T1 = ZERO                                      D.020326
005640*****            GO TO M-22F                                      D.020326
005650*****          ELSE                                               D.020326
005660*****            GO TO M-22A.                                     D.020326
005670*M-22K.                                                           D.981210
005680*****IF ESTAT NOT = HTB AND SKP                                   D.020326
005690*****    GO TO M-22J.                                             D.020326
005700*****IF W-DMM = 9                                                 D.020326
005710*****    GO TO M-22A.                                             D.020326
005720*****IF W-DMM NOT = 1                                             D.020326
005730*****    GO TO M-22J.                                             D.020326
005740*
005750*****ADD 1 TO W-L.                                                D.981210
005760*****MOVE ZERO TO W-NHK.                                          D.020326
005770*****MOVE KH-YC TO W-YC.                                          D.020326
005780*M-22L.                                                           D.981210
005790*****MOVE ZERO TO KNH-R.                                          D.020326
005800*****MOVE W-R TO KNH-R.                                           D.020326
005810*****WRITE KNH-R.                                                 D.020326
005820*****CALL "CBLTCLS" USING KNH-F.                                  D.020326
005830*****ADD 1 TO W-L.                                                D.020326
005840*****IF W-L > 20                                                  D.020326
005850*****    GO TO M-20                                               D.020326
005860*****  ELSE                                                       D.020326
005870*****    GO TO M-22A.                                             D.020326
005880*M-22M.                                                           D.020326
005890*****CLOSE KNH-F.                                                 D.020326
005900*****DISPLAY C-CLEAR.                                             D.020326
005910*****DISPLAY D-PRN1.                                              D.020326
005920*****OPEN I-O KNH-F.                                              D.020326
005930 M-40.                                                            I.981210
005940     READ JSS-F NEXT RECORD AT END                                I.020326
005950         CLOSE JSS-F                                              I.020326
005960         GO TO M-50.                                              I.020326
005970     IF JS-KHC NOT = 1                                            I.020326
005980         GO TO M-40.                                              I.020326
005990     IF JS-KCO = ZERO OR SPACE                                    I.020326
006000         GO TO M-40.                                              I.020326
006010     IF JS-JCD < 490000 OR > 498999                               I.020326
006020         GO TO M-40.                                              I.020326
006030     IF JS-NGS > W-KNG                                            I.020326
006040         GO TO M-40.                                              I.020326
006050     IF JS-NGS < W-KNG                                            I.020326
006060         DISPLAY E-ME6 E-ME99                                     I.020326
006070         DISPLAY E-CL                                             I.020326
006080         GO TO M-40.                                              I.020326
006090*
006100     MOVE JS-KCO TO KH-KEY.                                       I.020326
006110     READ KH-M WITH UNLOCK INVALID KEY                            I.020326
006120         DISPLAY E-ME1 E-KEY E-ME99                               I.020326
006130         DISPLAY E-CL                                             I.020326
006140         GO TO M-40.                                              I.020326
006150     IF KH-YC NOT = 10 AND 11                                     I.020806
006160         IF KH-GT1 = ZERO                                         I.090428
006170*****    IF KH-T2 = ZERO                                          D.090428
006180             DISPLAY E-ME7 E-KEY E-ME99.                          I.020806
006190     MOVE ZERO TO KNH-R.                                          I.020326
006200     MOVE JS-DATE TO NH-DATE.                                     I.020326
006210     MOVE JS-KCO TO NH-KEY.                                       I.020326
006220     MOVE JS-SU TO NH-SU.                                         I.020326
006230     MOVE KH-GT1 TO NH-TN.                                        I.090428
006240*****MOVE KH-T2 TO NH-TN.                                         D.090428
006250*****MOVE KH-T1 TO NH-TN.                                         D.020823
006260     COMPUTE NH-KN = NH-SU * NH-TN.                               I.020326
006270     MOVE KH-YC TO NH-YC.                                         I.020326
006280     MOVE KH-NC TO NH-NC.                                         I.021009
006290     MOVE 1 TO NH-NRC.                                            I.020326
006300     WRITE KNH-R.                                                 I.020326
006310*
006320     MOVE 2 TO JS-KHC.                                            I.020326
006330     REWRITE JSS-R INVALID KEY                                    I.020326
006340         CLOSE JSS-F                                              I.020326
006350         DISPLAY E-ME2 E-STAT E-ME99                              I.020326
006360         GO TO M-50.                                              I.020326
006370     GO TO M-40.                                                  I.020326
006380*****READ KNH-F AT END                                            D.020326
006390*****    GO TO M-52C.                                             D.020326
006400*****IF NH-NHK NOT = ZERO                                         D.020326
006410*****    GO TO M-40.                                              D.020326
006420*****IF NH-PRC = 9                                                D.020326
006430*****    GO TO M-40.                                              D.020326
006440 M-50.                                                            I.981210
006450     CLOSE KNH-F.                                                 I.020326
006460     PERFORM LST-RTN THRU LST-EX.                                 I.020326
006470*****MOVE NH-DATE TO W-DATE.                                      D.020326
006480*****MOVE ZERO TO WT-D CNT.                                       D.020326
006490*M-52A.                                                           D.020326
006500*****IF W-CHK = 5                                                 D.020326
006510*****    MOVE ZERO TO W-CHK                                       D.020326
006520*****    OPEN OUTPUT SP-F                                         D.020326
006530*****    PERFORM MID-020 THRU MID-EX.                             D.020326
006540*
006550*****MOVE NH-KEY TO KH-KEY.                                       D.020326
006560*****READ KH-M WITH UNLOCK INVALID KEY                            D.020326
006570*****    MOVE " **  ﾏｽﾀｰ ﾅｼ  **    " TO KH-NAME.                  D.020326
006580*
006590*****MOVE SPACE TO SP-R W-P.                                      D.020326
006600*****MOVE W-DATE TO P-DATE.                                       D.970819
006610*****MOVE W-NGPS TO P-DATE.                                       D.981210
006620*****MOVE W-KEY TO P-KEY.                                         D.981210
006630*****IF CNT = ZERO                                                D.020326
006640*****    MOVE NH-NGPS TO P-DATE.                                  D.020326
006650*****MOVE NH-KEY TO P-KEY.                                        D.020326
006660*****MOVE KH-NAME TO P-NA.                                        D.020326
006670*****MOVE NH-TS TO P-TS.                                          D.020326
006680*****MOVE NH-KS TO P-KS.                                          D.020326
006690*****MOVE NH-SU TO P-SU.                                          D.020326
006700*****MOVE NH-TN TO P-TN.                                          D.020326
006710*****MOVE NH-KN TO P-KN.                                          D.020326
006720*****IF NH-BS NOT = ZERO                                          D.020326
006730*****    MOVE NH-BS TO P-BS.                                      D.020326
006740*****IF NH-GO NOT = ZERO                                          D.020326
006750*****    MOVE NH-GO TO P-GO.                                      D.020326
006760*****MOVE W-TS TO P-TS.                                           D.981210
006770*****MOVE W-KS TO P-KS.                                           D.981210
006780*****MOVE W-SU TO P-SU.                                           D.981210
006790*****MOVE W-TN TO P-TN.                                           D.981210
006800*****MOVE W-KN TO P-KN.                                           D.981210
006810*****IF W-BS NOT = ZERO                                           D.981210
006820*****    MOVE W-BS TO P-BS.                                       D.981210
006830*****IF W-GO NOT = ZERO                                           D.981210
006840*****    MOVE W-GO TO P-GO.                                       D.981210
006850*****IF LINAGE-COUNTER > 60                                       D.020326
006860*****    MOVE NH-NGPS TO P-DATE                                   D.020326
006870*****    PERFORM MID-RTN THRU MID-EX.                             D.020326
006880*****MOVE W-P TO SP-R.                                            D.020326
006890*****WRITE SP-R.                                                  D.020326
006900*****MOVE SPACE TO SP-R.                                          D.020326
006910*
006920*****MOVE 9 TO NH-PRC.                                            D.020326
006930*****REWRITE KNH-R.                                               D.020326
006940*
006950*****ADD NH-KS TO WT-KS.                                          D.020326
006960*****ADD NH-SU TO WT-SU.                                          D.020326
006970*****ADD NH-KN TO WT-KN.                                          D.020326
006980*M-52B.                                                           D.020326
006990*****READ KNH-F AT END                                            D.020326
007000*****    GO TO M-52C.                                             D.020326
007010*****IF NH-NHK NOT = ZERO                                         D.020326
007020*****    GO TO M-52B.                                             D.020326
007030*****IF NH-PRC = 9                                                D.020326
007040*****    GO TO M-52B.                                             D.020326
007050*****IF NH-DATE = W-DATE                                          D.020326
007060*****    GO TO M-52A.                                             D.020326
007070*****PERFORM TOT-RTN THRU TOT-EX                                  D.020326
007080*****GO TO M-50.                                                  D.020326
007090*****ADD W-KS TO WT-KS.                                           D.981210
007100*****ADD W-SU TO WT-SU.                                           D.981210
007110*****ADD W-KN TO WT-KN.                                           D.981210
007120*****IF W-L > 20                                                  D.981210
007130*****    GO TO M-20                                               D.981210
007140*****  ELSE                                                       D.981210
007150*****    GO TO M-22A.                                             D.981210
007160*M-52C.                                                           D.020326
007170*****CLOSE KKB-M.                                                 D.020326
007180*****OPEN I-O KKB-M.                                              D.020326
007190*****MOVE SPACE TO KKB-KEY.                                       D.020326
007200*****MOVE 90 TO KKB-NO.                                           D.020326
007210*****READ KKB-M INVALID KEY                                       D.020326
007220*****    DISPLAY E-ME78 E-ME4 E-ME99                              D.020326
007230*****    GO TO M-90.                                              D.020326
007240*****MOVE 0 TO KKB-SC05.                                          D.020326
007250*****REWRITE KKB-R INVALID KEY                                    D.020326
007260*****    DISPLAY E-ME78 E-STAT E-ME5 E-ME99                       D.020326
007270*****    DISPLAY E-ME90 E-ME99.                                   D.020326
007280 M-90.
007290*****CLOSE KKB-M.                                                 D.020326
007300*****CLOSE KHJ-M.                                                 D.020326
007310     IF W-CHK = ZERO
007320         PERFORM TOT-RTN THRU TOT-EX
007330         CLOSE SP-F.
007340     CLOSE KH-M.
007350     CLOSE KNH-F.
007360 M-95.                                                            I.020326
007370     PERFORM KKB-RTN THRU KKB-EX.                                 I.020326
007380     DISPLAY C-CLEAR.
007390     STOP RUN.
007400 ACP-RTN.                                                         I.020326
007410     CALL "SCKD15".                                               I.020326
007420     DISPLAY D-NG.                                                I.020326
007430     MOVE 4 TO W-L.                                               I.020326
007440     MOVE ZERO TO W-R.                                            I.020326
007450     MOVE W-KNG TO W-NGS.                                         I.020326
007460     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.020326
007470         ADD DATE-NC1 TO W-NEN.                                   I.020326
007480     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.020326
007490         ADD DATE-NC2 TO W-NEN.                                   I.020326
007500 ACP-020.                                                         I.020326
007510     IF W-NGP NOT = ZERO                                          I.020326
007520         MOVE W-NGP TO W-DATE                                     I.020326
007530         MOVE W-CO TO W-KEY                                       I.020326
007540         DISPLAY A-PEY A-KEY.                                     I.020326
007550     ACCEPT A-PEY.                                                I.020326
007560     IF ESTAT = C2 OR PF9                                         I.020326
007570         GO TO ACP-EX.                                            I.020326
007580     IF ESTAT NOT = HTB AND SKP                                   I.020326
007590         GO TO ACP-020.                                           I.020326
007600     IF W-PEY < 1 OR > 31                                         I.020326
007610         GO TO ACP-020.                                           I.020326
007620     IF W-NGP = W-DATE                                            I.020326
007630         GO TO ACP-040.                                           I.020326
007640     MOVE W-DATE TO W-NGP.                                        I.020326
007650 ACP-040.                                                         I.020326
007660     ACCEPT A-KEY.                                                I.020326
007670     DISPLAY E-CL.                                                I.020326
007680     IF ESTAT = BTB                                               I.020326
007690         GO TO ACP-020.                                           I.020326
007700     IF ESTAT NOT = HTB AND SKP                                   I.020326
007710         GO TO ACP-040.                                           I.020326
007720     MOVE W-KEY TO KH-KEY.                                        I.020326
007730     READ KH-M WITH UNLOCK INVALID KEY                            I.020326
007740         DISPLAY E-ME1 E-ME98                                     I.020326
007750         GO TO ACP-040.                                           I.020326
007760     DISPLAY D-NA.                                                I.020326
007770     MOVE W-KEY TO W-CO.                                          I.020326
007780     MOVE KH-TRS TO W-TS.                                         I.020326
007790     MOVE KH-GT1 TO W-TN.                                         I.090428
007800*****MOVE KH-T1 TO W-TN.                                          D.020823
007810*****IF KH-YC NOT = 10 AND 11                                     D.020823
007820*****IF KH-YC = 10 OR 11                                          D.090428
007830*****    MOVE KH-T1 TO W-TN                                       D.090428
007840*****  ELSE                                                       D.090428
007850*****    IF KH-T2 = ZERO                                          D.020823
007860*****        DISPLAY E-ME7 E-ME98                                 D.020823
007870*****        GO TO ACP-040                                        D.020823
007880*****      ELSE                                                   D.020823
007890*****    MOVE KH-T2 TO W-TN                                       D.090428
007900     IF KH-YC NOT = 10 AND 11                                     I.090428
007910         MOVE ZERO TO W-TS W-KS                                   I.020326
007920         DISPLAY D-TS D-KS.                                       I.020823
007930*****        DISPLAY D-TS D-KS                                    D.020823
007940*****        GO TO ACP-060.                                       D.020823
007950     IF W-TN = ZERO                                               I.020823
007960         DISPLAY E-ME7 E-ME98                                     I.020823
007970         GO TO ACP-040.                                           I.020823
007980     IF KH-NC = 1                                                 I.021009
007990         DISPLAY E-ME9 E-ME98.                                    I.021009
008000*****IF KH-YC NOT = 10 AND 11                                     D.160129
008010*****    GO TO ACP-060.                                           D.160129
008020*****MOVE SPACE TO KHJ-KEY.                                       D.160129
008030*****MOVE W-KEY TO KHJ-HCD.                                       D.160129
008040*****START KHJ-M KEY NOT < KHJ-KEY INVALID KEY                    D.160129
008050*****    DISPLAY E-ME8 E-ME98                                     D.160129
008060*****    GO TO ACP-080.                                           D.160129
008070*****READ KHJ-M NEXT RECORD WITH UNLOCK AT END                    D.160129
008080*****    DISPLAY E-ME8 E-ME98                                     D.160129
008090*****    GO TO ACP-080.                                           D.160129
008100*****IF KHJ-HCD NOT = W-KEY                                       D.160129
008110*****    DISPLAY E-ME8 E-ME98.                                    D.160129
008120*****GO TO ACP-080.                                               D.160129
008130 ACP-060.                                                         I.020326
008140     ACCEPT A-SU.                                                 I.020326
008150     DISPLAY E-CL.                                                I.021009
008160     IF ESTAT = BTB                                               I.020326
008170         GO TO ACP-040.                                           I.020326
008180     IF ESTAT NOT = HTB AND SKP                                   I.020326
008190         GO TO ACP-060.                                           I.020326
008200     DISPLAY D-SU.                                                I.020326
008210     IF W-SU = ZERO                                               I.020326
008220         GO TO ACP-060.                                           I.020326
008230*****IF W-TN NOT = ZERO                                           D.020823
008240     GO TO ACP-140.                                               I.020326
008250*****GO TO ACP-120.                                               D.020823
008260 ACP-080.                                                         I.020326
008270     DISPLAY D-TS.                                                I.020326
008280     ACCEPT A-TS.                                                 I.020326
008290     DISPLAY E-CL.                                                I.020326
008300     IF ESTAT = BTB                                               I.020326
008310         GO TO ACP-040.                                           I.020326
008320     IF ESTAT NOT = HTB AND SKP                                   I.020326
008330         GO TO ACP-080.                                           I.020326
008340     DISPLAY D-TS.                                                I.020326
008350 ACP-100.                                                         I.020326
008360     ACCEPT A-KS.                                                 I.020326
008370     IF ESTAT = BTB                                               I.020326
008380         GO TO ACP-080.                                           I.020326
008390     IF ESTAT NOT = HTB AND SKP                                   I.020326
008400         GO TO ACP-100.                                           I.020326
008410     DISPLAY D-KS.                                                I.020326
008420     COMPUTE W-SU = W-TS * W-KS.                                  I.020326
008430     DISPLAY D-SU.                                                I.020326
008440     IF W-SU = ZERO                                               I.020326
008450         GO TO ACP-080.                                           I.020326
008460*****GO TO ACP-140.                                               D.020823
008470*ACP-120.                                                         D.020823
008480*****ACCEPT A-TN.                                                 D.020823
008490*****IF ESTAT = BTB                                               D.020823
008500*****    GO TO ACP-060.                                           D.020823
008510*****IF ESTAT NOT = HTB AND SKP                                   D.020823
008520*****    GO TO ACP-120.                                           D.020823
008530*****IF W-TN = ZERO                                               D.020823
008540*****    GO TO ACP-120.                                           D.020823
008550 ACP-140.                                                         I.020326
008560     COMPUTE W-KN = W-SU * W-TN.                                  I.020326
008570     DISPLAY D-TN.                                                I.020326
008580*****IF KH-YC = 10 OR 11                                          D.090428
008590*****    GO TO ACP-160.                                           D.090428
008600*****MOVE ZERO TO W-BS W-GO.                                      D.090325
008610*****DISPLAY A-BS A-GO.                                           D.090325
008620*****MOVE ZERO TO W-BS.                                           D.090428
008630*****DISPLAY A-BS.                                                D.090428
008640*****GO TO ACP-200.                                               D.090428
008650 ACP-160.                                                         I.020326
008660     ACCEPT A-BS.                                                 I.020326
008670     DISPLAY E-CL.                                                I.020326
008680     IF ESTAT = BTB                                               I.020326
008690         IF KH-YC NOT = 10 AND 11                                 I.090428
008700             GO TO ACP-060                                        I.090428
008710           ELSE                                                   I.090428
008720             GO TO ACP-100.                                       I.020326
008730     IF ESTAT NOT = HTB AND SKP                                   I.020326
008740         GO TO ACP-160.                                           I.020326
008750     MOVE SPACE TO KKB-KEY.                                       I.020326
008760     MOVE "04" TO KKB-NO.                                         I.020326
008770     MOVE W-BS TO KKB-KS2.                                        I.020326
008780     READ KKB-M WITH UNLOCK INVALID KEY                           I.020326
008790         DISPLAY E-ME4 E-ME98                                     I.020326
008800         GO TO ACP-160.                                           I.020326
008810     MOVE KKB-KSN2 TO W-BSM.                                      I.020326
008820     DISPLAY D-BSM.                                               I.020326
008830*ACP-180.                                                         D.090325
008840*****ACCEPT A-GO.                                                 D.090325
008850*****DISPLAY E-CL.                                                D.090325
008860*****IF ESTAT = BTB                                               D.090325
008870*****    GO TO ACP-160.                                           D.090325
008880*****IF ESTAT NOT = HTB AND SKP                                   D.090325
008890*****    GO TO ACP-180.                                           D.090325
008900 ACP-200.                                                         I.020326
008910     ACCEPT A-DMM.                                                I.020326
008920     IF ESTAT = BTB                                               I.020326
008930         GO TO ACP-160.                                           I.090428
008940*****    IF KH-YC = 10 OR 11                                      D.090428
008950*****        GO TO ACP-160                                        D.090428
008960*****        GO TO ACP-180                                        D.090325
008970*****      ELSE                                                   D.090428
008980*****        GO TO ACP-060.                                       D.090428
008990*****        IF KH-T1 = ZERO                                      D.020823
009000*****            GO TO ACP-120                                    D.020823
009010*****          ELSE                                               D.020823
009020*****            GO TO ACP-020.                                   D.020823
009030     IF ESTAT NOT = HTB AND SKP                                   I.020326
009040         GO TO ACP-200.                                           I.020326
009050     IF W-DMM = 9                                                 I.020326
009060         GO TO ACP-020.                                           I.020326
009070     IF W-DMM NOT = 1                                             I.020326
009080         GO TO ACP-200.                                           I.020326
009090*
009100     MOVE ZERO TO W-NHK.                                          I.020326
009110     MOVE KH-YC TO W-YC.                                          I.020326
009120     MOVE KH-NC TO W-NC.                                          I.021009
009130     MOVE ZERO TO KNH-R.                                          I.020326
009140     MOVE W-R TO KNH-R.                                           I.020326
009150     WRITE KNH-R.                                                 I.020326
009160     CALL "CBLTCLS" USING KNH-F.                                  I.020326
009170     ADD 1 TO W-L.                                                I.020326
009180     IF W-L > 20                                                  I.020326
009190         GO TO ACP-RTN                                            I.020326
009200       ELSE                                                       I.020326
009210         GO TO ACP-020.                                           I.020326
009220 ACP-EX.                                                          I.020326
009230     EXIT.                                                        I.020326
009240 LST-RTN.                                                         I.020326
009250     DISPLAY C-CLEAR.                                             I.020326
009260     IF JS-SIGN = 0                                               I.020326
009270         DISPLAY D-PRN1                                           I.020326
009280       ELSE                                                       I.020326
009290         DISPLAY D-PRN2                                           I.020326
009300         MOVE  NC"＊＊＊　　工品製品仕入　変換リスト　　＊＊＊"   I.020326
009310                                                       TO H-MID.  I.020326
009320     OPEN I-O KNH-F.                                              I.020326
009330 LST-020.                                                         I.020326
009340     READ KNH-F AT END                                            I.020326
009350         GO TO LST-EX.                                            I.020326
009360     IF NH-NHK NOT = ZERO                                         I.020326
009370         GO TO LST-020.                                           I.020326
009380     IF NH-PRC = 9                                                I.020326
009390         GO TO LST-020.                                           I.020326
009400 LST-040.                                                         I.020326
009410     MOVE NH-DATE TO W-DATE.                                      I.020326
009420     MOVE ZERO TO WT-D CNT.                                       I.020326
009430 LST-060.                                                         I.020326
009440     IF W-CHK = 5                                                 I.020326
009450         MOVE ZERO TO W-CHK                                       I.020326
009460         OPEN OUTPUT SP-F                                         I.020326
009470         PERFORM MID-020 THRU MID-EX.                             I.020326
009480*
009490     MOVE NH-KEY TO KH-KEY.                                       I.020326
009500     READ KH-M WITH UNLOCK INVALID KEY                            I.020326
009510         MOVE " **  ﾏｽﾀｰ ﾅｼ  **    " TO KH-NAME.                  I.020326
009520*
009530     MOVE SPACE TO SP-R W-P.                                      I.020326
009540     IF CNT = ZERO                                                I.020326
009550         MOVE NH-NGPS TO P-DATE.                                  I.020326
009560     MOVE NH-KEY TO P-KEY.                                        I.020326
009570     MOVE KH-NAME TO P-NA.                                        I.020326
009580     MOVE NH-TS TO P-TS.                                          I.020326
009590     MOVE NH-KS TO P-KS.                                          I.020326
009600     MOVE NH-SU TO P-SU.                                          I.020326
009610     MOVE NH-TN TO P-TN.                                          I.020326
009620     MOVE NH-KN TO P-KN.                                          I.020326
009630     IF NH-BS NOT = ZERO                                          I.020326
009640         MOVE NH-BS TO P-BS.                                      I.020326
009650*****IF NH-GO NOT = ZERO                                          D.090325
009660*****    MOVE NH-GO TO P-GO.                                      D.090325
009670*****IF LINAGE-COUNTER > 60                                       D.090428
009680     IF LINAGE-COUNTER > 63                                       I.090428
009690         MOVE NH-NGPS TO P-DATE                                   I.020326
009700         PERFORM MID-RTN THRU MID-EX.                             I.020326
009710     MOVE W-P TO SP-R.                                            I.020326
009720     WRITE SP-R.                                                  I.020326
009730     MOVE SPACE TO SP-R.                                          I.020326
009740*
009750     MOVE 9 TO NH-PRC.                                            I.020326
009760     REWRITE KNH-R.                                               I.020326
009770*
009780     ADD NH-KS TO WT-KS.                                          I.020326
009790     ADD NH-SU TO WT-SU.                                          I.020326
009800     ADD NH-KN TO WT-KN.                                          I.020326
009810 LST-080.                                                         I.020326
009820     READ KNH-F AT END                                            I.020326
009830         GO TO LST-EX.                                            I.020326
009840     IF NH-NHK NOT = ZERO                                         I.020326
009850         GO TO LST-080.                                           I.020326
009860     IF NH-PRC = 9                                                I.020326
009870         GO TO LST-080.                                           I.020326
009880     IF NH-DATE = W-DATE                                          I.020326
009890         GO TO LST-060.                                           I.020326
009900     PERFORM TOT-RTN THRU TOT-EX                                  I.020326
009910     GO TO LST-040.                                               I.020326
009920 LST-EX.                                                          I.020326
009930     EXIT.                                                        I.020326
009940 MID-RTN.
009950     MOVE SPACE TO SP-R.
009960     WRITE SP-R AFTER PAGE.
009970 MID-020.
009980     MOVE SPACE TO SP-R.
009990     ADD 1 TO W-PAGE.
010000     MOVE W-PAGE TO H-PAGE.
010010     MOVE HEAD1 TO SP-R.
010020     WRITE SP-R.
010030     MOVE SPACE TO SP-R.
010040     MOVE HEAD2 TO SP-R.
010050     WRITE SP-R AFTER 2.
010060     MOVE SPACE TO SP-R.
010070 MID-EX.
010080     EXIT.
010090 TOT-RTN.
010100     MOVE SPACE TO SP-R W-P.
010110     MOVE NC"　［　ＴＯＴＡＬ　］" TO P-NAN.                      A 62/04
010120     MOVE WT-KS TO P-KS.
010130     MOVE WT-SU TO P-SU.
010140     MOVE WT-KN TO P-KN.
010150*****IF LINAGE-COUNTER > 58                                       D.981210
010160*****IF LINAGE-COUNTER > 59                                       D.090428
010170     IF LINAGE-COUNTER > 63                                       I.090428
010180         PERFORM MID-RTN THRU MID-EX.
010190     MOVE W-P TO SP-R.
010200     WRITE SP-R.
010210     MOVE SPACE TO SP-R.
010220*****WRITE SP-R.                                                  D.981210
010230 TOT-EX.
010240     EXIT.
010250 KKB-RTN.                                                         I.020326
010260     OPEN I-O KKB-M.                                              I.020326
010270     MOVE SPACE TO KKB-KEY.                                       I.020326
010280     MOVE 90 TO KKB-NO.                                           I.020326
010290     READ KKB-M INVALID KEY                                       I.020326
010300         CLOSE KKB-M                                              I.020326
010310         DISPLAY E-ME78 E-ME4 E-ME99                              I.020326
010320         GO TO KKB-EX.                                            I.020326
010330     MOVE 0 TO KKB-SC05.                                          I.020326
010340     REWRITE KKB-R INVALID KEY                                    I.020326
010350         DISPLAY E-ME78 E-STAT E-ME5 E-ME99                       I.020326
010360         DISPLAY E-ME90 E-ME99.                                   I.020326
010370     CLOSE KKB-M.                                                 I.020326
010380 KKB-EX.                                                          I.020326
010390     EXIT.                                                        I.020326
