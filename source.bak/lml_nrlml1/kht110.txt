000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.  KHT110.
000030*********************************************************
000040*    PROGRAM         :  çHïió˚ÇËÉSÉÄì˙ïtï éÛï•ñ‚çáÇπÅ@  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCKT11                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT KJ-M ASSIGN TO KJ-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE IS RANDOM
000180         RECORD KEY KJ-KEY
000190         FILE STATUS IS ERR-STAT.
000200     SELECT KUH-F ASSIGN TO KUH-MSD
000210         FILE STATUS IS ERR-STAT.
000220 I-O-CONTROL.
000230     APPLY SHARED-MODE ON KJ-M.
000240 DATA DIVISION.
000250 FILE SECTION.
000260     COPY LIKJM.
000270 FD  KUH-F
000280     BLOCK  4 RECORDS
000290     LABEL RECORD IS STANDARD
000300     VALUE OF IDENTIFICATION WK0064ID.
000310 01  K-R.
000320     02  K-JCD          PIC  X(007).
000330     02  K-NGP.
000340       03  K-NG         PIC  9(004).
000350       03  K-PEY        PIC  9(002).
000360     02  K-SS           PIC S9(006).
000370     02  K-KS           PIC S9(006).
000380     02  K-HS           PIC S9(006).
000390     02  K-ZS           PIC S9(007).
000400     02  K-DNO          PIC  X(005).
000410     02  K-SC           PIC  9(001).
000420     02  F              PIC  X(020).
000430 WORKING-STORAGE SECTION.
000440 77  WK0064ID           PIC  X(009) VALUE SPACE.
000450 01  STN-NO.
000460     02  STN-NO1        PIC  X(003).
000470     02  STN-NO2        PIC  X(003).
000480 01  W-FID.
000490     02  W-FID1         PIC  X(006) VALUE "WK0064".
000500     02  W-FID2         PIC  X(003).
000510 01  W-DATA.
000520     02  W-JCD          PIC  X(007).
000530     02  W-DMM          PIC  9(001).
000540     02  W-L            PIC  9(002).
000550     02  W-C1           PIC  9(002).
000560     02  W-C2           PIC  9(002).
000570     02  W-C3           PIC  9(002).
000580     02  W-C4           PIC  9(002).
000590     02  W-C5           PIC  9(002).
000600     02  W-ZS           PIC S9(006).
000610     02  WT-D.
000620       03  WT-SS        PIC S9(006).
000630       03  WT-KS        PIC S9(006).
000640       03  WT-HS        PIC S9(006).
000650       03  WT-ZS        PIC S9(006).
000660 01  ERR-STAT           PIC  X(002).
000670     COPY LSTAT.
000680 SCREEN SECTION.
000690 SD  C-CRT
000700     END STATUS IS ESTAT.
000710 01  C-CLEAR.
000720     02  C-CL    LINE   1  CLEAR SCREEN.
000730 01  C-ACP.
000740     02  A-JCD   LINE   2  COLUMN  10  PIC  X(007)
000750          USING W-JCD   CHECK OVERFLOW NO IFC.
000760     02  A-DMM   LINE  23  COLUMN  70  PIC  9(001)
000770          USING W-DMM   CHECK OVERFLOW NO IFC.
000780 01  C-DSP.
000790     02  D-NAME  LINE   2  COLUMN  25  PIC  X(020) FROM  KJ-NAME.
000800     02  D-MD    LINE W-L.
000810       03  COLUMN W-C1 PIC  Z(002)  FROM  K-PEY.
000820       03  COLUMN W-C2 PIC ----,--- FROM  K-SS.
000830       03  COLUMN W-C3 PIC ----,--- FROM  K-KS.
000840       03  COLUMN W-C4 PIC ----,--- FROM  K-HS.
000850       03  COLUMN W-C5 PIC ----,--- FROM  W-ZS.
000860     02  D-TD    LINE  20.
000870       03  COLUMN  43  PIC ----,--- FROM  WT-SS.
000880       03  COLUMN  51  PIC ----,--- FROM  WT-KS.
000890       03  COLUMN  59  PIC ----,--- FROM  WT-HS.
000900       03  COLUMN  67  PIC ----,--- FROM  WT-ZS.
000910 01  C-ERR.
000920     02  LINE  24.
000930       03  E-ME1   COLUMN  15  PIC  X(020) VALUE
000940            "***  DATA µ∞ ﬁ∞  ***".
000950       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000960       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000970       03  E-CL    COLUMN  10  PIC  X(050) VALUE
000980            "                                                  ".
000990 PROCEDURE DIVISION.
001000 M-05.
001010     DISPLAY C-CLEAR.
001020     CALL "SCKT11".
001030     OPEN INPUT KJ-M.
001040     CALL "CBLSTNNO" USING STN-NO.
001050     MOVE STN-NO2 TO W-FID2.
001060     MOVE W-FID TO WK0064ID.
001070 M-10.
001080     ACCEPT A-JCD.
001090     IF ESTAT = PF9
001100         GO TO M-90.
001110     IF ESTAT NOT = HTB AND SKP
001120         GO TO M-10.
001130     MOVE W-JCD TO KJ-KEY.
001140     READ KJ-M WITH UNLOCK INVALID KEY
001150         MOVE ZERO TO KJ-T
001160         MOVE "    **  KJM ≈º  **  " TO KJ-NAME.
001170     DISPLAY D-NAME.
001180*****MOVE ZERO TO WT-D.                                           D.110520
001190     MOVE ZERO TO WT-D W-ZS.                                      I.110520
001200     IF KJ-SC < 4
001210         COMPUTE WT-ZS = KJ-ZSU + KJ-SSU - KJ-HSU + KJ-KSU.
001220     MOVE 3 TO W-L.
001230     MOVE 5 TO W-C1.
001240     MOVE 7 TO W-C2.
001250     MOVE 15 TO W-C3.
001260     MOVE 23 TO W-C4.
001270     MOVE 31 TO W-C5.
001280     OPEN INPUT KUH-F.
001290 M-15.
001300     READ KUH-F AT END
001310         GO TO M-20.
001320     IF K-JCD < W-JCD
001330         GO TO M-15.
001340     IF K-JCD > W-JCD
001350         GO TO M-20.
001360     IF ZERO = K-SS AND K-KS AND K-HS AND K-ZS
001370         GO TO M-15.
001380     ADD 1 TO W-L.
001390     IF W-L = 20
001400         IF W-C1 NOT = 5
001410             CLOSE KUH-F
001420             DISPLAY E-ME1 E-ME99
001430             GO TO M-90
001440           ELSE
001450             MOVE 4 TO W-L
001460             MOVE 41 TO W-C1
001470             MOVE 43 TO W-C2
001480             MOVE 51 TO W-C3
001490             MOVE 59 TO W-C4
001500             MOVE 67 TO W-C5.
001510     IF K-ZS NOT = ZERO
001520         MOVE K-ZS TO W-ZS
001530       ELSE
001540         COMPUTE W-ZS = W-ZS + K-SS - K-HS - K-KS.
001550     DISPLAY D-MD.
001560     ADD K-SS TO WT-SS.
001570     ADD K-HS TO WT-HS.
001580     ADD K-KS TO WT-KS.
001590     GO TO M-15.
001600 M-20.
001610     CLOSE KUH-F.
001620     DISPLAY D-TD.
001630     ACCEPT A-DMM.
001640     DISPLAY C-CLEAR.
001650     CALL "SCKT11".
001660     GO TO M-10.
001670 M-90.
001680     CLOSE KJ-M.
001690 M-95.
001700     DISPLAY C-CLEAR.
001710     STOP RUN.
