000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KHD510.
000030*********************************************************
000040*    PROGRAM         :  工品他　日次　マスター更新　　  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  NO                              *
000070*    DATA WRITTN     :  49/04/25                        *
000080*        変更　　　  :  62/04/01                        *
000090*    COMPILE TYPE    :  COBOL                           *
000100*********************************************************
000110 ENVIRONMENT DIVISION.
000120 CONFIGURATION SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.                                                 I.980210
000180     SELECT KH-M ASSIGN TO KH-MSD                                 I.940606
000190         ORGANIZATION IS INDEXED                                  I.940606
000200         ACCESS MODE IS RANDOM                                    I.940606
000210         RECORD KEY IS KH-KEY                                     I.940606
000220         FILE STATUS IS ERR-STAT.                                 I.940606
000230     SELECT KKB-M ASSIGN TO KKB-MSD
000240         ORGANIZATION IS INDEXED
000250         ACCESS MODE IS DYNAMIC
000260         RECORD KEY IS KKB-KEY
000270         FILE STATUS IS ERR-STAT.
000280     SELECT URI-F ASSIGN TO URI-MSD.
000290*****SELECT KAZ-F ASSIGN TO KAZ-MSD.                              D.970226
000300*****SELECT KNBK-F ASSIGN TO KNBK-MSD.                            D.970325
000310     SELECT KNH-F ASSIGN TO KNH-MSD.
000320*****SELECT KS-F ASSIGN TO KS-MSD.                                D.151221
000330*****SELECT KKH-F ASSIGN TO KKH-MSD.                              D.151221
000340     SELECT NYU-F ASSIGN TO NYU-MSD                               I.070130
000350         ORGANIZATION IS INDEXED                                  I.070130
000360         ACCESS MODE IS DYNAMIC                                   I.070130
000370         RECORD KEY IS NYU-KEY                                    I.070130
000380         FILE STATUS IS ERR-STAT.                                 I.070130
000390*****SELECT KT-M ASSIGN TO KT-MSD                                 D.000224
000400     SELECT TT-M ASSIGN TO TT-MSD                                 I.000224
000410         ORGANIZATION IS INDEXED
000420         ACCESS MODE IS DYNAMIC
000430         RECORD KEY IS TT-KEY                                     I.000224
000440*****    RECORD KEY IS KT-KEY                                     D.000224
000450         FILE STATUS IS ERR-STAT.
000460     SELECT KHT-M ASSIGN TO KHT1-MSD KHT2-MSD
000470         ORGANIZATION IS INDEXED
000480         ACCESS MODE IS DYNAMIC
000490         RECORD KEY IS KHT-KEY
000500         ALTERNATE RECORD KEY IS KHT-KEYD
000510         FILE STATUS IS ERR-STAT.
000520*****SELECT KJ-M ASSIGN TO KJ-MSD                                 D.151221
000530*****    ORGANIZATION IS INDEXED                                  D.151221
000540*****    ACCESS MODE IS DYNAMIC                                   D.151221
000550*****    RECORD KEY IS KJ-KEY                                     D.151221
000560*****    FILE STATUS IS ERR-STAT.                                 D.151221
000570*****SELECT KHJ-M ASSIGN TO KHJ-MSD                               D.151221
000580*****    ORGANIZATION IS INDEXED                                  D.151221
000590*****    ACCESS MODE IS DYNAMIC                                   D.151221
000600*****    RECORD KEY IS KHJ-KEY                                    D.151221
000610*****    FILE STATUS IS ERR-STAT.                                 D.151221
000620*****SELECT SP-F ASSIGN TO P-PRN999.                              D.970325
000630 I-O-CONTROL.                                                     I.940606
000640     APPLY SHARED-MODE ON M-DATE                                  I.980210
000650*****APPLY SHARED-MODE ON KHJ-M                                   D.151221
000660     APPLY SHARED-MODE ON KH-M.                                   I.940606
000670 DATA DIVISION.
000680 FILE SECTION.
000690     COPY LIBFDD.                                                 I.980210
000700     COPY LIKHM.                                                  I.940606
000710     COPY LIKKBM.
000720*****COPY LIKTM.                                                  D.000224
000730     COPY LITTM.                                                  I.000224
000740     COPY LIKHTM.
000750*****COPY LIKJM.                                                  D.151221
000760*****COPY LIKHJM.                                                 D.151221
000770*****COPY LSPF.                                                   D.970325
000780 FD  URI-F
000790*****BLOCK  4 RECORDS                                             D.001031
000800*****BLOCK  3 RECORDS                                             D.010907
000810     BLOCK  2 RECORDS                                             I.010907
000820     LABEL RECORD IS STANDARD
000830     VALUE OF IDENTIFICATION "URIF".                              C 62/04
000840 01  URI-R.
000850     02  U-DC           PIC  9(001).
000860*****02  U-DATE         PIC  9(006).                              D.970820
000870     02  U-DATE         PIC  9(008).                              I.970820
000880     02  U-TCD          PIC  9(004).
000890     02  U-HCD          PIC  X(005).
000900     02  U-SU           PIC S9(006)V9(02).
000910     02  U-T            PIC S9(006)V9(02).
000920     02  U-KI           PIC S9(008).
000930     02  U-YC           PIC  9(002).                              I.940606
000940     02  F              PIC  X(011).                              I.001031
000950*****02  F              PIC  X(014).                              D.001031
000960*****02  F              PIC  X(016).                              D.940606
000970     02  U-CSC          PIC  9(001).
000980     02  F              PIC  X(023).                              I.020823
000990     02  U-GT           PIC  9(006)V9(02).                        I.020823
001000     02  F              PIC  X(040).                              I.020823
001010*****02  F              PIC  X(071).                              D.020823
001020*****02  F              PIC  X(028).                              D.010907
001030*****02  F              PIC  X(003).                              D.001031
001040*****02  U-NRC          PIC  9(001).                              D.001031
001050     02  U-PRC          PIC  9(001).                              I.981214
001060*****02  F              PIC  X(005).                              D.981214
001070*****02  F              PIC  X(007).                              D.970820
001080*FD  KAZ-F                                                        D.970226
001090*****BLOCK  8 RECORDS                                             D.970226
001100*****LABEL RECORD IS STANDARD                                     D.970226
001110*****VALUE OF IDENTIFICATION "KAZF".                              D.970226
001120*01  KAZ-R.                                                       D.970226
001130*****02  A-DATE         PIC  9(006).                              D.970226
001140*****02  A-TCD          PIC  9(004).                              D.970226
001150*****02  A-HCD          PIC  X(005).                              D.970226
001160*****02  A-AC           PIC  9(001).                              D.970226
001170*****02  A-AS           PIC S9(006).                              D.970226
001180*****02  F              PIC  X(010).                              D.970226
001190*FD  KNBK-F                                                       D.970325
001200*****BLOCK  6 RECORDS                                             D.970325
001210*****LABEL RECORD IS STANDARD                                     D.970325
001220*****VALUE OF IDENTIFICATION "KNBF".                              D.970325
001230*01  KNBK-R.                                                      D.970325
001240*****02  KB-DATE        PIC  9(006).                              D.970325
001250*****02  KB-TCD         PIC  9(004).                              D.970325
001260*****02  KB-HCD         PIC  X(005).                              D.970325
001270*****02  KB-KI          PIC S9(008).                              D.970325
001280*****02  F              PIC  X(010).                              D.970325
001290*****02  KB-DC          PIC  9(001).                              D.970325
001300*****02  F              PIC  X(008).                              D.970325
001310 FD  KNH-F
001320*****BLOCK  5 RECORDS                                             D.981210
001330     BLOCK  4 RECORDS                                             I.981210
001340     LABEL RECORD IS STANDARD
001350     VALUE OF IDENTIFICATION "KNHF".
001360 01  KNH-R.
001370     02  NH-NHC         PIC  9(002).
001380*****02  NH-DATE        PIC  9(006).                              D.970820
001390     02  NH-DATE        PIC  9(008).                              I.970820
001400     02  NH-HCD         PIC  X(005).
001410     02  NH-TS          PIC  9(002).
001420     02  NH-KS          PIC S9(005).
001430     02  NH-SU          PIC S9(006)V9(02).
001440     02  F              PIC  9(008).                              I.981210
001450     02  NH-KIN         PIC S9(008).
001460     02  NH-YC          PIC  9(002).
001470*****02  F              PIC  X(015).                              D.021009
001480     02  F              PIC  X(005).                              D.021009
001490     02  NH-NC          PIC  9(001).                              I.021009
001500     02  F              PIC  X(009).                              I.021009
001510     02  NH-PRC         PIC  9(001).                              I.981214
001520*****02  F              PIC  X(016).                              D.981214
001530*****02  F              PIC  X(011).                              D.981210
001540*****02  F              PIC  X(013).                              D.970820
001550*FD  KS-F                                                         D.151221
001560*****BLOCK  4 RECORDS                                             D.151221
001570*****LABEL RECORD IS STANDARD                                     D.151221
001580*****VALUE OF IDENTIFICATION "KSF".                               D.151221
001590*01  KS-R.                                                        D.151221
001600*****02  KS-NGP         PIC  9(006).                              D.970820
001610*****02  KS-CO          PIC  X(006).                              D.940518
001620*****02  KS-NGP         PIC  9(008).                              D.151221
001630*****02  KS-CO          PIC  X(007).                              D.151221
001640*****02  KS-DK          PIC  9(001).                              D.151221
001650*****02  KS-KU          PIC  9(001).                              D.151221
001660*****02  KS-SU          PIC S9(006)V9(02).                        D.151221
001670*****02  KS-TN          PIC  9(005)V9(02).                        D.151221
001680*****02  KS-KN          PIC S9(009).                              D.151221
001690*****02  KS-TI          PIC  9(004).                              D.151221
001700*****02  F              PIC  X(016).                              D.151221
001710*****02  KS-PRC         PIC  9(001).                              D.151221
001720*****02  F              PIC  X(002).                              D.151221
001730*****02  F              PIC  X(019).                              D.981214
001740*****02  F              PIC  X(022).                              D.940518
001750*****02  F              PIC  X(021).                              D.970820
001760*FD  KKH-F                                                        D.151221
001770*****BLOCK  8 RECORDS                                             D.151221
001780*****LABEL RECORD IS STANDARD                                     D.151221
001790*****VALUE OF IDENTIFICATION "KKHF".                              D.151221
001800*01  KKH-R.                                                       D.151221
001810*****02  KKH-DATE       PIC  9(006).                              D.970820
001820*****02  KKH-CO         PIC  X(006).                              D.940518
001830*****02  KKH-DATE       PIC  9(008).                              D.151221
001840*****02  KKH-CO         PIC  X(007).                              D.151221
001850*****02  KKH-SU         PIC S9(006).                              D.151221
001860*****02  KKH-HKC        PIC  9(001).                              D.151221
001870*****02  KKH-SC         PIC  9(001).                              D.151221
001880*****02  F              PIC  X(007).                              D.151221
001890*****02  KKH-PRC        PIC  9(001).                              D.151221
001900*****02  F              PIC  X(001).                              D.151221
001910*****02  F              PIC  X(009).                              D.981214
001920*****02  F              PIC  X(012).                              D.940518
001930*****02  F              PIC  X(011).                              D.970820
001940 FD  NYU-F                                                        I.070130
001950     BLOCK  5 RECORDS                                             I.070130
001960     LABEL RECORD IS STANDARD                                     I.070130
001970     VALUE OF IDENTIFICATION "NYUF".                              I.070130
001980 01  NYUR-R.                                                      I.070130
001990     02  NYU-DATE       PIC  9(008).                              I.070130
002000     02  NYU-TCD        PIC  9(004).                              I.070130
002010     02  NYU-KIN        PIC S9(008).                              I.070130
002020     02  NYU-NC.                                                  I.070130
002030       03  NYU-NC1      PIC  9(001).                              I.070130
002040       03  NYU-NC2      PIC  9(001).                              I.070130
002050     02  NYU-NSC        PIC  9(001).                              I.070130
002060     02  NYU-TGK        PIC  9(008).                              I.070130
002070     02  NYU-SS.                                                  I.070130
002080       03  NYU-SSN      PIC  9(004).                              I.070130
002090       03  NYU-SSG      PIC  9(002).                              I.070130
002100     02  NYU-BC         PIC  9(001).                              I.070130
002110     02  NYU-TC         PIC  9(002).                              I.070130
002120     02  NYU-SP         PIC  9(002).                              I.070130
002130     02  NYU-SK         PIC  9(001).                              I.070130
002140     02  NYU-KEY.                                                 I.070130
002150       03  NYU-DNO      PIC  9(006).                              I.070130
002160       03  NYU-GNO      PIC  9(001).                              I.070130
002170     02  NYU-FDNO.                                                I.070130
002180       03  NYU-FNO      PIC  9(006).                              I.070130
002190       03  NYU-FGNO     PIC  9(002).                              I.070130
002200     02  NYU-SKD        PIC  9(008).                              I.070130
002210     02  F              PIC  X(016).                              I.070130
002220     02  NYU-DPC        PIC  9(001).                              I.070130
002230     02  F              PIC  X(019).                              I.070130
002240 WORKING-STORAGE SECTION.
002250 01  ERR-STAT           PIC  X(002).
002260*01  W-P.                                                         D.970325
002270*****02  P-FILE         PIC  X(008).                              D.970325
002280*****02  P-ME           PIC  X(030).                              D.970325
002290*****02  P-DATA         PIC  X(098).                              D.970325
002300 01  W-DATA.
002310     02  W-DMM          PIC  9(001).
002320     02  W-KEY          PIC  X(005).                              I.980210
002330     02  W-DATE         PIC  9(006).                              I.980210
002340     02  W-NG           PIC  9(006).                              I.980210
002350     02  W-NGD   REDEFINES W-NG.                                  I.980210
002360       03  W-NEN        PIC  9(004).                              I.980210
002370       03  W-NENL  REDEFINES W-NEN.                               I.980210
002380         04  W-NEN1     PIC  9(002).                              I.980210
002390         04  W-NEN2     PIC  9(002).                              I.980210
002400       03  W-GET        PIC  9(002).                              I.980210
002410     02  W-NGL   REDEFINES W-NG.                                  I.980210
002420       03  F            PIC  9(002).                              I.980210
002430       03  W-NGS        PIC  9(004).                              I.980210
002440     02  W-PC           PIC  9(001) VALUE 0.
002450     02  W-ERR          PIC  9(001) VALUE 0.
002460     02  W-SU           PIC S9(007)V9(02).
002470     02  W-D.                                                     I.070130
002480       03  W-TCD        PIC  9(004).                              I.070130
002490       03  W-DNO        PIC  9(006).                              I.070130
002500       03  W-KIN        PIC S9(009).                              I.070130
002510       03  W-SHZ        PIC S9(007).                              I.070130
002520     02  WT-D.                                                    I.070130
002530       03  WT-TZZ       PIC S9(009).                              I.070130
002540       03  WT-TUA       PIC S9(009).                              I.070130
002550       03  WT-TNB       PIC S9(009).                              I.070130
002560       03  WT-TNK       PIC S9(009).                              I.070130
002570       03  WT-TUZ       PIC S9(009).                              I.070130
002580       03  WT-TUZW      PIC S9(009).                              I.070130
002590     02  W-FILE         PIC  X(004).                              I.981214
002600     02  W-ME           PIC  X(040).
002610     02  W-EME.
002620       03  W-ME1        PIC  X(016) VALUE
002630            "***  TTM ﾅｼ  ***".                                   I.000224
002640*****       "***  KTM ﾅｼ  ***".                                   D.000224
002650       03  W-ME2        PIC  X(025) VALUE
002660            "***  TTM REWRITE ｴﾗｰ  ***".                          I.000224
002670*****       "***  KTM REWRITE ｴﾗｰ  ***".                          D.000224
002680       03  W-ME3        PIC  X(017) VALUE
002690            "***  KHTM ﾅｼ  ***".
002700       03  W-ME4        PIC  X(026) VALUE
002710            "***  KHTM REWRITE ｴﾗｰ  ***".
002720*****  03  W-ME5        PIC  X(016) VALUE                         D.151221
002730*****       "***  KJM ﾅｼ  ***".                                   D.151221
002740*****  03  W-ME6        PIC  X(025) VALUE                         D.151221
002750*****       "***  KJM REWRITE ｴﾗｰ  ***".                          D.151221
002760       03  W-ME7        PIC  X(017) VALUE
002770            "***  KKBM ﾅｼ  ***".
002780       03  W-ME8        PIC  X(026) VALUE
002790            "***  KKBM REWRITE ｴﾗｰ  ***".
002800       03  W-ME9        PIC  X(016) VALUE                         I.940606
002810            "***  KHM ﾅｼ  ***".                                   I.940606
002820       03  W-ME10       PIC  X(025) VALUE                         I.980210
002830            "***  KHM REWRITE ｴﾗｰ  ***".                          I.980210
002840     COPY LSTAT.
002850 SCREEN SECTION.
002860 SD  C-CRT
002870     END STATUS IS ESTAT.
002880 01  C-CLEAR.
002890     02  C-CL    LINE   1  CLEAR SCREEN.
002900 01  C-MID.
002910     02  LINE   3  COLUMN  10  PIC  N(018) VALUE
002920          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002930     02  LINE   4  COLUMN  10  PIC  N(018) VALUE
002940          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002950     02  LINE   5  COLUMN  10  PIC  N(018) VALUE
002960          NC"＊＊＊　　　　　　　　　　　　＊＊＊".
002970     02  LINE   6  COLUMN  10  PIC  N(018) VALUE
002980          NC"＊＊＊　　工品他　日次更新　　＊＊＊".
002990     02  LINE   7  COLUMN  10  PIC  N(018) VALUE
003000          NC"＊＊＊　　　　　　　　　　　　＊＊＊".
003010     02  LINE   8  COLUMN  10  PIC  N(018) VALUE
003020          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003030     02  LINE   9  COLUMN  10  PIC  N(018) VALUE
003040          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003050     02  LINE  20  COLUMN  17  PIC  X(022) VALUE
003060          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003070 01  C-MIDD.
003080     02  LINE   6.
003090       03  C-MID1  COLUMN  10  PIC  N(018) VALUE
003100            NC"＊＊＊　　工品他　売上更新　　＊＊＊".
003110*****  03  C-MID2  COLUMN  10  PIC  N(018) VALUE                  D.970325
003120*****       NC"＊＊＊　　工品他　預り更新　　＊＊＊".             D.970325
003130*****  03  C-MID3  COLUMN  10  PIC  N(018) VALUE                  D.970325
003140*****       NC"＊＊＊　　工品他　値引更新　　＊＊＊".             D.970325
003150       03  C-MID4  COLUMN  10  PIC  N(018) VALUE
003160            NC"＊＊＊　　加硫・廃却　更新　　＊＊＊".
003170*****  03  C-MID5  COLUMN  10  PIC  N(018) VALUE                  D.151221
003180*****       NC"＊＊＊　　仕入・支払　更新　　＊＊＊".             D.151221
003190*****  03  C-MID6  COLUMN  10  PIC  N(018) VALUE                  D.151221
003200*****       NC"＊＊＊　　回収・払出　更新　　＊＊＊".             D.151221
003210       03  C-MID7  COLUMN  10  PIC  N(018) VALUE                  I.070130
003220            NC"＊＊＊　　　入金　　更新　　　＊＊＊".             I.070130
003230 01  C-ACP.
003240     02  A-DMM   LINE  20  COLUMN  34  PIC  9(001)
003250          USING W-DMM   CHECK OVERFLOW NO IFC.
003260 01  C-DSP.
003270     02  LINE  15.
003280       03  D-SME01 COLUMN  18  PIC  N(017) VALUE
003290            NC"＊＊＊　　他で売上入力中　　＊＊＊" BLINK.
003300       03  D-SME02 COLUMN  18  PIC  N(017) VALUE
003310            NC"＊＊＊　　他で売上変換中　　＊＊＊" BLINK.
003320       03  D-SME03 COLUMN  18  PIC  N(017) VALUE
003330            NC"＊＊＊　　他で値引入力中　　＊＊＊" BLINK.
003340       03  D-SME04 COLUMN  18  PIC  N(017) VALUE
003350            NC"＊＊＊　　他で入金入力中　　＊＊＊" BLINK.
003360       03  D-SME05 COLUMN  18  PIC  N(017) VALUE
003370            NC"＊＊＊　　他で加硫入力中　　＊＊＊" BLINK.
003380       03  D-SME06 COLUMN  18  PIC  N(017) VALUE
003390            NC"＊＊＊　　他で廃却入力中　　＊＊＊" BLINK.
003400*****  03  D-SME07 COLUMN  18  PIC  N(019) VALUE                  D.151221
003410*****       NC"＊＊＊　　他で払出回収入力中　　＊＊＊" BLINK.     D.151221
003420*****  03  D-SME08 COLUMN  18  PIC  N(019) VALUE                  D.151221
003430*****       NC"＊＊＊　　他で東海仕入入力中　　＊＊＊" BLINK.     D.151221
003440       03  D-SME13 COLUMN  18  PIC  N(017) VALUE
003450            NC"＊＊＊　　他で日次更新中　　＊＊＊" BLINK.
003460       03  D-SME14 COLUMN  18  PIC  N(017) VALUE
003470            NC"＊＊＊　　他で手配変換中　　＊＊＊" BLINK.
003480       03  D-SME15 COLUMN  18  PIC  N(017) VALUE
003490            NC"＊＊＊　　他で月次更新中　　＊＊＊" BLINK.
003500       03  D-SME99 COLUMN  18  PIC  N(015) VALUE
003510            NC"＊＊＊　　他で使用中　　＊＊＊" BLINK.
003520     02  D-ZM.                                                    I.070130
003530       03  LINE  14.                                              I.070130
003540         04  COLUMN  08  PIC  X(004) VALUE "ｺｰﾄﾞ".                I.070130
003550         04  COLUMN  13  PIC  9(004) FROM  TT-TCD.                I.070130
003560       03  LINE  15.                                              I.070130
003570         04  COLUMN  14  PIC  N(006) VALUE NC"　　　前月残".      I.070130
003580         04  COLUMN  26  PIC  N(006) VALUE NC"　　　売　上".      I.070130
003590         04  COLUMN  38  PIC  N(006) VALUE NC"　　　値　引".      I.070130
003600         04  COLUMN  50  PIC  N(006) VALUE NC"　　　入　金".      I.070130
003610         04  COLUMN  62  PIC  N(006) VALUE NC"　　　売掛残".      I.070130
003620       03  LINE  16.                                              I.070130
003630         04  COLUMN  08  PIC  N(003) VALUE NC"本　体".            I.070130
003640         04  COLUMN  14  PIC ----,---,--9  FROM TT-TZZ.           I.070130
003650         04  COLUMN  26  PIC ----,---,--9  FROM TT-TUA.           I.070130
003660         04  COLUMN  38  PIC ----,---,--9  FROM TT-TNB.           I.070130
003670         04  COLUMN  50  PIC ----,---,--9  FROM TT-TNK.           I.070130
003680         04  COLUMN  62  PIC ----,---,--9  FROM TT-TUZ.           I.070130
003690       03  LINE  17.                                              I.070130
003700         04  COLUMN  08  PIC  N(003) VALUE NC"消費税".            I.070130
003710         04  COLUMN  14  PIC ----,---,--9  FROM TT-TZZZ.          I.070130
003720         04  COLUMN  26  PIC ----,---,--9  FROM TT-TUAZ.          I.070130
003730         04  COLUMN  38  PIC ----,---,--9  FROM TT-TNBZ.          I.070130
003740         04  COLUMN  50  PIC ----,---,--9  FROM TT-TNKZ.          I.070130
003750         04  COLUMN  62  PIC ----,---,--9  FROM TT-TUZZ.          I.070130
003760       03  LINE  18.                                              I.070130
003770         04  COLUMN  08  PIC  N(003) VALUE NC"合　計".            I.070130
003780         04  COLUMN  14  PIC ----,---,--9  FROM WT-TZZ.           I.070130
003790         04  COLUMN  26  PIC ----,---,--9  FROM WT-TUA.           I.070130
003800         04  COLUMN  38  PIC ----,---,--9  FROM WT-TNB.           I.070130
003810         04  COLUMN  50  PIC ----,---,--9  FROM WT-TNK.           I.070130
003820         04  COLUMN  62  PIC ----,---,--9  FROM WT-TUZ.           I.070130
003830     02  D-ZMC.                                                   I.070130
003840       03  LINE  14.                                              I.070130
003850         04  COLUMN  08  PIC  X(004) VALUE "    ".                I.070130
003860         04  COLUMN  13  PIC  X(004) VALUE "    ".                I.070130
003870       03  LINE  15.                                              I.070130
003880         04  COLUMN  14  PIC  X(012) VALUE "            ".        I.070130
003890         04  COLUMN  26  PIC  X(012) VALUE "            ".        I.070130
003900         04  COLUMN  38  PIC  X(012) VALUE "            ".        I.070130
003910         04  COLUMN  50  PIC  X(012) VALUE "            ".        I.070130
003920         04  COLUMN  62  PIC  X(012) VALUE "            ".        I.070130
003930       03  LINE  16.                                              I.070130
003940         04  COLUMN  14  PIC  X(012) VALUE "            ".        I.070130
003950         04  COLUMN  26  PIC  X(012) VALUE "            ".        I.070130
003960         04  COLUMN  38  PIC  X(012) VALUE "            ".        I.070130
003970         04  COLUMN  50  PIC  X(012) VALUE "            ".        I.070130
003980         04  COLUMN  62  PIC  X(012) VALUE "            ".        I.070130
003990       03  LINE  17.                                              I.070130
004000         04  COLUMN  14  PIC  X(012) VALUE "            ".        I.070130
004010         04  COLUMN  26  PIC  X(012) VALUE "            ".        I.070130
004020         04  COLUMN  38  PIC  X(012) VALUE "            ".        I.070130
004030         04  COLUMN  50  PIC  X(012) VALUE "            ".        I.070130
004040         04  COLUMN  62  PIC  X(012) VALUE "            ".        I.070130
004050       03  LINE  18.                                              I.070130
004060         04  COLUMN  14  PIC  X(012) VALUE "            ".        I.070130
004070         04  COLUMN  26  PIC  X(012) VALUE "            ".        I.070130
004080         04  COLUMN  38  PIC  X(012) VALUE "            ".        I.070130
004090         04  COLUMN  50  PIC  X(012) VALUE "            ".        I.070130
004100         04  COLUMN  62  PIC  X(012) VALUE "            ".        I.070130
004110 01  C-ERR.
004120     02  LINE  24.
004130       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
004140       03  E-ME    COLUMN  15  PIC  X(040) FROM  W-ME.
004150       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        I.940319
004160       03  E-ME90  COLUMN  15  PIC  N(022) VALUE
004170            NC"【　　工品区分マスターを修正して下さい　　】".
004180       03  E-TCD   COLUMN  60  PIC  X(004) FROM  TT-KEY.          I.000224
004190*****  03  E-TCD   COLUMN  60  PIC  X(004) FROM  KT-KEY.          D.000224
004200       03  E-KEY   COLUMN  60  PIC  X(005) FROM  KH-HCD.          I.940606
004210       03  E-HCD   COLUMN  60  PIC  X(005) FROM  KHT-KEY.
004220*****  03  E-JCD   COLUMN  60  PIC  X(006) FROM  KJ-KEY.          D.940518
004230*****  03  E-JCD   COLUMN  60  PIC  X(007) FROM  KJ-KEY.          D.151221
004240       03  E-ME61.                                                I.981214
004250         04  COLUMN  15  PIC  X(034) VALUE                        I.981214
004260              "***  入力リスト未印字  (    )  ***".               I.981214
004270         04  COLUMN  39  PIC  X(004) FROM  W-FILE.                I.981214
004280       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
004290       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
004300       03  E-CL.
004310         04  COLUMN   1  PIC  X(040) VALUE
004320              "                                        ".
004330         04  COLUMN  41  PIC  X(040) VALUE
004340              "                                        ".
004350     COPY LIBSCR.                                                 I.980210
004360 PROCEDURE DIVISION.
004370 M-05.
004380     DISPLAY C-CLEAR.
004390     DISPLAY C-MID.
004400 M-10.
004410     ACCEPT A-DMM.
004420     IF ESTAT NOT = HTB AND SKP
004430         GO TO M-10.
004440     IF W-DMM = 9
004450         MOVE 255 TO COMPLETION-CODE
004460         GO TO M-95.
004470     IF W-DMM NOT = 1
004480         GO TO M-10.
004490*
004500     OPEN I-O KKB-M.
004510     MOVE SPACE TO KKB-KEY.
004520     MOVE 90 TO KKB-NO.
004530     READ KKB-M INVALID KEY
004540         CLOSE KKB-M
004550*****    MOVE SPACE TO W-ME W-P                                   D.970325
004560*****    MOVE W-ME7 TO W-ME P-ME                                  D.970325
004570         MOVE SPACE TO W-ME                                       I.970325
004580         MOVE W-ME7 TO W-ME                                       I.970325
004590         DISPLAY E-ME78 E-ME E-ME99                               C.940319
004600         MOVE 255 TO COMPLETION-CODE
004610         GO TO M-95.
004620     IF KKB-SC15 = 1
004630         CLOSE KKB-M
004640         DISPLAY D-SME15 E-ME99
004650         MOVE 255 TO COMPLETION-CODE
004660         GO TO M-95.
004670     IF KKB-SC14 = 1
004680         CLOSE KKB-M
004690         DISPLAY D-SME14 E-ME99
004700         MOVE 255 TO COMPLETION-CODE
004710         GO TO M-95.
004720     IF 1 = KKB-SC13 OR KKB-SC12
004730         CLOSE KKB-M
004740         DISPLAY D-SME13 E-ME99
004750         MOVE 255 TO COMPLETION-CODE
004760         GO TO M-95.
004770     IF 1 = KKB-SC11 OR KKB-SC10 OR KKB-SC09
004780         CLOSE KKB-M
004790         DISPLAY D-SME99 E-ME99
004800         MOVE 255 TO COMPLETION-CODE
004810         GO TO M-95.
004820*****IF KKB-SC08 = 1                                              D.151221
004830*****    CLOSE KKB-M                                              D.151221
004840*****    DISPLAY D-SME08 E-ME99                                   D.151221
004850*****    MOVE 255 TO COMPLETION-CODE                              D.151221
004860*****    GO TO M-95.                                              D.151221
004870*****IF KKB-SC07 = 1                                              D.151221
004880*****    CLOSE KKB-M                                              D.151221
004890*****    DISPLAY D-SME07 E-ME99                                   D.151221
004900*****    MOVE 255 TO COMPLETION-CODE                              D.151221
004910*****    GO TO M-95.                                              D.151221
004920     IF KKB-SC06 = 1
004930         CLOSE KKB-M
004940         DISPLAY D-SME06 E-ME99
004950         MOVE 255 TO COMPLETION-CODE
004960         GO TO M-95.
004970     IF KKB-SC05 = 1
004980         CLOSE KKB-M
004990         DISPLAY D-SME05 E-ME99
005000         MOVE 255 TO COMPLETION-CODE
005010         GO TO M-95.
005020     IF KKB-SC04 = 1
005030         CLOSE KKB-M
005040         DISPLAY D-SME04 E-ME99
005050         MOVE 255 TO COMPLETION-CODE
005060         GO TO M-95.
005070     IF KKB-SC03 = 1
005080         CLOSE KKB-M
005090         DISPLAY D-SME03 E-ME99
005100         MOVE 255 TO COMPLETION-CODE
005110         GO TO M-95.
005120     IF KKB-SC02 = 1
005130         CLOSE KKB-M
005140         DISPLAY D-SME02 E-ME99
005150         MOVE 255 TO COMPLETION-CODE
005160         GO TO M-95.
005170     IF KKB-SC01 = 1
005180         CLOSE KKB-M
005190         DISPLAY D-SME01 E-ME99
005200         MOVE 255 TO COMPLETION-CODE
005210         GO TO M-95.
005220     PERFORM CHK-RTN THRU CHK-EX.                                 I.981214
005230     IF W-ERR = 1                                                 I.981214
005240         CLOSE KKB-M                                              I.981214
005250         MOVE 255 TO COMPLETION-CODE                              I.981214
005260         DISPLAY E-ME61 E-ME99                                    I.981214
005270         GO TO M-95.                                              I.981214
005280     MOVE 1 TO KKB-SC13.
005290     REWRITE KKB-R INVALID KEY
005300*****    MOVE SPACE TO W-ME W-P                                   D.970325
005310*****    MOVE W-ME8 TO W-ME P-ME                                  D.970325
005320         MOVE SPACE TO W-ME                                       I.970325
005330         MOVE W-ME8 TO W-ME                                       I.970325
005340         DISPLAY E-ME78 E-STAT E-ME E-ME99                        C.940319
005350         CLOSE KKB-M
005360         MOVE 255 TO COMPLETION-CODE
005370         GO TO M-95.
005380     CLOSE KKB-M.
005390*
005400*M-11.                                                            D.970224
005410     DISPLAY C-MID1.
005420*
005430     COPY LIBCPR.                                                 I.980210
005440     MOVE ZERO TO W-NG.                                           I.980210
005450     MOVE D-NKNG TO W-NGS.                                        I.980210
005460     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.980210
005470         ADD DATE-NC1 TO W-NEN.                                   I.980210
005480     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.980210
005490         ADD DATE-NC2 TO W-NEN.                                   I.980210
005500     MOVE W-NG TO W-DATE.                                         I.980210
005510*
005520     OPEN INPUT URI-F.
005530*****OPEN INPUT KAZ-F.                                            D.970226
005540*****OPEN INPUT KNBK-F.                                           D.970326
005550     OPEN INPUT KNH-F.
005560*****OPEN INPUT KS-F.                                             D.151221
005570*****OPEN INPUT KKH-F.                                            D.151221
005580     OPEN INPUT NYU-F.                                            I.070130
005590     OPEN I-O TT-M.                                               I.000224
005600*****OPEN I-O KT-M.                                               D.000224
005610     OPEN I-O KHT-M.
005620*****OPEN I-O KJ-M.                                               D.151221
005630     OPEN I-O KH-M.                                               I.980210
005640*****OPEN INPUT KHJ-M.                                            D.151221
005650*****OPEN INPUT KH-M.                                             D.980210
005660 M-15.
005670     READ URI-F AT END
005680         DISPLAY C-MID4                                           I.970325
005690         GO TO M-35.                                              I.970325
005700*****    DISPLAY C-MID2                                           D.970325
005710*****    GO TO M-31.                                              D.970226
005720*****    GO TO M-33.                                              D.970325
005730     IF U-HCD NOT = SPACE AND ZERO                                I.980210
005740         MOVE U-HCD TO W-KEY                                      I.980210
005750         PERFORM KHM-RTN THRU KHM-EX.                             I.980210
005760     IF U-DC = 4                                                  I.970226
005770         GO TO M-25.                                              I.970226
005780*****MOVE U-TCD TO KT-KEY.                                        D.000224
005790*****READ KT-M INVALID KEY                                        D.000224
005800*****    MOVE SPACE TO W-ME W-P                                   D.970325
005810*****    MOVE W-ME1 TO W-ME P-ME                                  D.970325
005820     MOVE U-TCD TO TT-KEY.                                        I.000224
005830     READ TT-M INVALID KEY                                        I.000224
005840         MOVE SPACE TO W-ME                                       I.970325
005850         MOVE W-ME1 TO W-ME                                       I.970325
005860         DISPLAY E-ME78 E-ME E-TCD E-ME99                         C.940319
005870*****    MOVE "URIF" TO P-FILE                                    D.970325
005880*****    MOVE URI-R TO P-DATA                                     D.970325
005890         MOVE 255 TO COMPLETION-CODE
005900         MOVE 9 TO W-ERR
005910         GO TO M-90.
005920     IF U-DC = 8                                                  I.970325
005930*****    COMPUTE KT-TUZ = KT-TUZ - U-KI                           D.000224
005940*****    COMPUTE KT-TNB = KT-TNB + U-KI                           D.000224
005950*****    COMPUTE KT-SUA = KT-SUA - U-KI                           D.000224
005960         COMPUTE TT-TUZ = TT-TUZ - U-KI                           I.000224
005970         COMPUTE TT-TNB = TT-TNB + U-KI                           I.000224
005980*****    COMPUTE TT-SUA = TT-SUA - U-KI                           D.001127
005990         GO TO M-20.                                              I.970325
006000     IF U-DC = 9                                                  I.970325
006010*****    COMPUTE KT-TUZZ = KT-TUZZ - U-KI                         D.000224
006020*****    COMPUTE KT-TNBZ = KT-TNBZ + U-KI                         D.000224
006030*****    COMPUTE KT-SUAZ = KT-SUAZ - U-KI                         D.000224
006040         COMPUTE TT-TUZZ = TT-TUZZ - U-KI                         I.000224
006050         COMPUTE TT-TNBZ = TT-TNBZ + U-KI                         I.000224
006060*****    COMPUTE TT-SUAZ = TT-SUAZ - U-KI                         D.001127
006070         GO TO M-20.                                              I.970325
006080     IF U-DC = 5
006090*****    IF U-CSC = 0                                             D.020822
006100*****        COMPUTE KT-TUZZ = KT-TUZZ + U-KI                     D.000224
006110*****        COMPUTE KT-TUAZ = KT-TUAZ + U-KI                     D.000224
006120*****        COMPUTE KT-SUAZ = KT-SUAZ + U-KI                     D.000224
006130         COMPUTE TT-TUZZ = TT-TUZZ + U-KI                         I.000224
006140         COMPUTE TT-TUAZ = TT-TUAZ + U-KI                         I.000224
006150*****        COMPUTE TT-SUAZ = TT-SUAZ + U-KI                     D.001127
006160*****      ELSE                                                   D.020822
006170*****        COMPUTE TT-TUZZ = TT-TUZZ + U-KI                     D.020822
006180*****        COMPUTE TT-TUAZ = TT-TUAZ + U-KI.                    D.020822
006190*****        COMPUTE TT-TUAZ = TT-TUAZ + U-KI                     D.001127
006200*****        COMPUTE TT-STSZ = TT-STSZ + U-KI.                    D.001127
006210*****        COMPUTE KT-TUZZ = KT-TUZZ + U-KI                     D.000224
006220*****        COMPUTE KT-TUAZ = KT-TUAZ + U-KI                     D.000224
006230*****        COMPUTE KT-STSZ = KT-STSZ + U-KI.                    D.000224
006240*****IF U-DC NOT = 5                                              D.020822
006250*****    IF U-CSC = 0                                             D.020822
006260*****        COMPUTE KT-TUZ = KT-TUZ + U-KI                       D.000224
006270*****        COMPUTE KT-TUA = KT-TUA + U-KI                       D.000224
006280*****        COMPUTE KT-SUA = KT-SUA + U-KI                       D.000224
006290*****        COMPUTE TT-TUZ = TT-TUZ + U-KI                       D.020822
006300*****        COMPUTE TT-TUA = TT-TUA + U-KI                       D.020822
006310*****        COMPUTE TT-SUA = TT-SUA + U-KI                       D.001127
006320       ELSE
006330         COMPUTE TT-TUZ = TT-TUZ + U-KI                           I.000224
006340         COMPUTE TT-TUA = TT-TUA + U-KI.                          I.001127
006350*****        COMPUTE TT-TUA = TT-TUA + U-KI                       D.001127
006360*****        COMPUTE TT-STS = TT-STS + U-KI.                      D.001127
006370*****        COMPUTE KT-TUZ = KT-TUZ + U-KI                       D.000224
006380*****        COMPUTE KT-TUA = KT-TUA + U-KI                       D.000224
006390*****        COMPUTE KT-STS = KT-STS + U-KI.                      D.000224
006400*****IF U-HCD = "00700" OR "00800"                                D.980326
006410     IF U-YC = 00                                                 I.980326
006420         GO TO M-20.                                              I.940606
006430     IF U-DC = 5                                                  I.940606
006440         GO TO M-20.                                              I.940606
006450     COMPUTE TT-TUG ROUNDED = TT-TUG + (U-SU * U-GT).             I.030311
006460*****IF U-SU > ZERO                                               D.030311
006470*****    COMPUTE TT-TUG = TT-TUG + ((U-SU * U-GT) + 0.99)         D.030311
006480*****  ELSE                                                       D.030311
006490*****    COMPUTE TT-TUG = TT-TUG + ((U-SU * U-GT) - 0.99).        D.030311
006500*****IF U-YC = 10 OR 11                                           D.020823
006510*****    IF U-DC NOT = 2                                          D.020823
006520*****    ADD U-KI TO TT-TUG.                                      D.020823
006530*****        ADD U-KI TO KT-TUG.                                  D.000224
006540*****IF U-YC = 10 OR 11                                           D.020823
006550*****    GO TO M-20.                                              D.020823
006560*****MOVE U-HCD TO KH-KEY.                                        D.020823
006570*****READ KH-M WITH UNLOCK INVALID KEY                            D.020823
006580*****    MOVE SPACE TO W-ME                                       D.020823
006590*****    MOVE W-ME9 TO W-ME                                       D.020823
006600*****    DISPLAY E-ME E-KEY E-ME99                                D.020823
006610*****    MOVE ZERO TO KH-T2.                                      D.020823
006620*****COMPUTE TT-TUG = TT-TUG + (U-SU * KH-T2).                    D.020823
006630*****COMPUTE KT-TUG = KT-TUG + (U-SU * KH-T2).                    D.000224
006640*****IF U-DC NOT = 2 AND 5                                        D.940606
006650*****    IF U-HCD NOT = "00700" AND "00800"                       D.940606
006660*****        ADD U-KI TO KT-TUG.                                  D.940606
006670 M-20.                                                            I.940606
006680*****REWRITE KT-R INVALID KEY                                     D.000224
006690*****    MOVE SPACE TO W-ME W-P                                   D.970325
006700*****    MOVE W-ME2 TO W-ME P-ME                                  D.970325
006710     PERFORM TTMC-RTN THRU TTMC-EX.                               I.070130
006720     REWRITE TT-R INVALID KEY                                     I.000224
006730         MOVE SPACE TO W-ME                                       I.970325
006740         MOVE W-ME2 TO W-ME                                       I.970325
006750         DISPLAY E-ME78 E-STAT E-ME E-TCD E-ME99                  C.940319
006760*****    MOVE "URIF" TO P-FILE                                    D.970325
006770*****    MOVE KT-R TO P-DATA                                      D.970325
006780         MOVE 255 TO COMPLETION-CODE
006790         MOVE 9 TO W-ERR
006800         GO TO M-90.
006810*****IF U-DC = 5                                                  D.970325
006820     IF U-DC = 5 OR 9                                             I.970325
006830         GO TO M-15.
006840 M-25.                                                            I.970226
006850     MOVE U-HCD TO KHT-KEY.
006860     READ KHT-M INVALID KEY
006870*****    MOVE SPACE TO W-ME W-P                                   D.970325
006880*****    MOVE W-ME3 TO W-ME P-ME                                  D.970325
006890         MOVE SPACE TO W-ME                                       I.970325
006900         MOVE W-ME3 TO W-ME                                       I.970325
006910         DISPLAY E-ME78 E-ME E-HCD E-ME99                         C.940319
006920*****    MOVE "URIF" TO P-FILE                                    D.970325
006930*****    MOVE URI-R TO P-DATA                                     D.970325
006940         MOVE 255 TO COMPLETION-CODE
006950         MOVE 9 TO W-ERR
006960         GO TO M-90.
006970*****COMPUTE KHT-UKIN = U-KI + KHT-UKIN.                          D.970226
006980*****IF U-DC NOT = 4                                              D.970325
006990     IF U-DC NOT = 4 AND 8                                        I.970325
007000         COMPUTE KHT-UKIN = U-KI + KHT-UKIN                       I.970226
007010*****    IF U-YC = 10 OR 11                                       D.090429
007020*****        COMPUTE KHT-GKIN = U-KI + KHT-GKIN                   D.090429
007030*****      ELSE                                                   D.090429
007040         COMPUTE KHT-GKIN = (U-SU * U-GT) + KHT-GKIN.             I.030311
007050*****        IF U-SU > ZERO                                       D.030311
007060*****            COMPUTE KHT-GKIN =                               D.030311
007070*****                         ((U-SU * U-GT) + 0.99) + KHT-GKIN   D.030311
007080*****          ELSE                                               D.030311
007090*****            COMPUTE KHT-GKIN =                               D.030311
007100*****                         ((U-SU * U-GT) - 0.99) + KHT-GKIN.  D.030311
007110*****    COMPUTE KHT-GKIN = (U-SU * U-GT) + KHT-GKIN              D.020911
007120     IF U-DC NOT = 4 AND 8                                        I.020911
007130         IF U-DC NOT = 2
007140             COMPUTE KHT-SSU = U-SU + KHT-SSU.
007150     IF U-DC = 8                                                  I.970325
007160         COMPUTE KHT-NKIN = KHT-NKIN + U-KI.                      I.970325
007170     IF U-DC = 3                                                  I.970226
007180         MOVE 5 TO KHT-AC                                         I.970226
007190         ADD U-SU TO KHT-AUS KHT-AAS.                             I.970226
007200     IF U-DC = 4                                                  I.970226
007210         MOVE 5 TO KHT-AC                                         I.970226
007220         ADD U-SU TO KHT-ASS                                      I.970226
007230         SUBTRACT U-SU FROM KHT-AAS.                              I.970226
007240*M-26.                                                            D.970224
007250     REWRITE KHT-R INVALID KEY
007260*****    MOVE SPACE TO W-ME W-P                                   D.970325
007270*****    MOVE W-ME4 TO W-ME P-ME                                  D.970325
007280         MOVE SPACE TO W-ME                                       I.970325
007290         MOVE W-ME4 TO W-ME                                       I.970325
007300         DISPLAY E-ME78 E-STAT E-ME E-HCD E-ME99                  C.940319
007310*****    MOVE "URIF" TO P-FILE                                    D.970325
007320*****    MOVE KHT-R TO P-DATA                                     D.970325
007330         MOVE 255 TO COMPLETION-CODE
007340         MOVE 9 TO W-ERR
007350         GO TO M-90.
007360*****IF U-YC NOT = 10 AND 11                                      D.151221
007370*****    GO TO M-15.                                              D.151221
007380*****IF U-DC = 2 OR 4 OR 8                                        D.151221
007390*****    GO TO M-15.                                              D.151221
007400*****IF U-SU = ZERO                                               D.151221
007410     GO TO M-15.                                                  I.000705
007420*
007430*****MOVE SPACE TO KHJ-KEY.                                       D.151221
007440*****MOVE U-HCD TO KHJ-HCD.                                       D.151221
007450*****START KHJ-M KEY NOT < KHJ-KEY INVALID KEY                    D.151221
007460*****    GO TO M-15.                                              D.151221
007470*M-30.                                                            D.151221
007480*****READ KHJ-M NEXT RECORD WITH UNLOCK AT END                    D.151221
007490*****    GO TO M-15.                                              D.151221
007500*****IF U-HCD NOT = KHJ-HCD                                       D.151221
007510*****    GO TO M-15.                                              D.151221
007520*****IF (KHJ-SU = 0) OR (KHJ-KSC NOT = 2)                         D.151221
007530*****    GO TO M-30.                                              D.151221
007540*
007550*****MOVE KHJ-JCD TO KJ-KEY.                                      D.151221
007560*****READ KJ-M INVALID KEY                                        D.151221
007570*****    MOVE SPACE TO W-ME                                       D.151221
007580*****    MOVE W-ME5 TO W-ME                                       D.151221
007590*****    DISPLAY E-ME78 E-ME E-JCD E-ME99                         D.151221
007600*****    MOVE 255 TO COMPLETION-CODE                              D.151221
007610*****    MOVE 9 TO W-ERR                                          D.151221
007620*****    GO TO M-90.                                              D.151221
007630*****COMPUTE KJ-HSU = KJ-HSU + (U-SU * KHJ-SU).                   D.151221
007640*****REWRITE KJ-R INVALID KEY                                     D.151221
007650*****    MOVE SPACE TO W-ME                                       D.151221
007660*****    MOVE W-ME6 TO W-ME                                       D.151221
007670*****    DISPLAY E-ME78 E-STAT E-ME E-JCD E-ME99                  D.151221
007680*****    MOVE 255 TO COMPLETION-CODE                              D.151221
007690*****    MOVE 9 TO W-ERR                                          D.151221
007700*****    GO TO M-90.                                              D.151221
007710*****GO TO M-15.                                                  D.151221
007720*M-31.                                                            D.970226
007730*****READ KAZ-F AT END                                            D.970226
007740*****    DISPLAY C-MID3                                           D.970226
007750*****    GO TO M-33.                                              D.970226
007760*****MOVE A-HCD TO KHT-KEY.                                       D.970226
007770*****READ KHT-M INVALID KEY                                       D.970226
007780*****    MOVE SPACE TO W-ME W-P                                   D.970226
007790*****    MOVE W-ME3 TO W-ME P-ME                                  D.970226
007800*****    DISPLAY E-ME78 E-ME E-HCD E-ME99                         D.970226
007810*****    MOVE "KAZF" TO P-FILE                                    D.970226
007820*****    MOVE KAZ-R TO P-DATA                                     D.970226
007830*****    MOVE 255 TO COMPLETION-CODE                              D.970226
007840*****    MOVE 9 TO W-ERR                                          D.970226
007850*****    GO TO M-90.                                              D.970226
007860*****IF A-AC = 4                                                  D.970226
007870*****    COMPUTE KHT-ASS = KHT-ASS + A-AS                         D.970226
007880*****    COMPUTE KHT-AAS = KHT-AAS - A-AS                         D.970226
007890*****  ELSE                                                       D.970226
007900*****    COMPUTE KHT-AUS = KHT-AUS + A-AS                         D.970226
007910*****    COMPUTE KHT-AAS = KHT-AAS + A-AS.                        D.970226
007920*M-32.                                                            D.970224
007930*****MOVE 5 TO KHT-AC.                                            D.970226
007940*****REWRITE KHT-R INVALID KEY                                    D.970226
007950*****    MOVE SPACE TO W-ME W-P                                   D.970226
007960*****    MOVE W-ME4 TO W-ME P-ME                                  D.970226
007970*****    DISPLAY E-ME78 E-STAT E-ME E-HCD E-ME99                  D.970226
007980*****    MOVE "KAZF" TO P-FILE                                    D.970226
007990*****    MOVE KHT-R TO P-DATA                                     D.970226
008000*****    MOVE 255 TO COMPLETION-CODE                              D.970226
008010*****    MOVE 9 TO W-ERR                                          D.970226
008020*****    GO TO M-90.                                              D.970226
008030*****GO TO M-31.                                                  D.970226
008040*M-33.                                                            D.970325
008050*****READ KNBK-F AT END                                           D.970325
008060*****    DISPLAY C-MID4                                           D.970325
008070*****    GO TO M-35.                                              D.970325
008080*****MOVE KB-TCD TO KT-KEY.                                       D.970325
008090*****READ KT-M INVALID KEY                                        D.970325
008100*****    MOVE SPACE TO W-ME W-P                                   D.970325
008110*****    MOVE W-ME1 TO W-ME P-ME                                  D.970325
008120*****    DISPLAY E-ME78 E-ME E-TCD E-ME99                         D.970325
008130*****    MOVE "KNBKF" TO P-FILE                                   D.970325
008140*****    MOVE KNBK-R TO P-DATA                                    D.970325
008150*****    MOVE 255 TO COMPLETION-CODE                              D.970325
008160*****    MOVE 9 TO W-ERR                                          D.970325
008170*****    GO TO M-90.                                              D.970325
008180*****IF KB-DC = 5                                                 D.970325
008190*****    COMPUTE KT-TUZZ = KT-TUZZ - KB-KI                        D.970325
008200*****    COMPUTE KT-TNBZ = KT-TNBZ + KB-KI                        D.970325
008210*****    COMPUTE KT-SUAZ = KT-SUAZ - KB-KI                        D.970325
008220*****  ELSE                                                       D.970325
008230*****    COMPUTE KT-TUZ = KT-TUZ - KB-KI                          D.970325
008240*****    COMPUTE KT-TNB = KT-TNB + KB-KI                          D.970325
008250*****    COMPUTE KT-SUA = KT-SUA - KB-KI.                         D.970325
008260*****REWRITE KT-R INVALID KEY                                     D.970325
008270*****    MOVE SPACE TO W-ME W-P                                   D.970325
008280*****    MOVE W-ME2 TO W-ME P-ME                                  D.970325
008290*****    DISPLAY E-ME78 E-STAT E-ME E-TCD E-ME99                  D.970325
008300*****    MOVE "KNBKF" TO P-FILE                                   D.970325
008310*****    MOVE KT-R TO P-DATA                                      D.970325
008320*****    MOVE 255 TO COMPLETION-CODE                              D.970325
008330*****    MOVE 9 TO W-ERR                                          D.970325
008340*****    GO TO M-90.                                              D.970325
008350*****IF KB-DC = 5                                                 D.970325
008360*****    GO TO M-33.                                              D.970325
008370*****MOVE KB-HCD TO KHT-KEY.                                      D.970325
008380*****READ KHT-M INVALID KEY                                       D.970325
008390*****    MOVE SPACE TO W-ME W-P                                   D.970325
008400*****    MOVE W-ME2 TO W-ME P-ME                                  D.970325
008410*****    DISPLAY E-ME78 E-ME E-HCD E-ME99                         D.970325
008420*****    MOVE "KNBKF" TO P-FILE                                   D.970325
008430*****    MOVE KNBK-R TO P-DATA                                    D.970325
008440*****    MOVE 255 TO COMPLETION-CODE                              D.970325
008450*****    MOVE 9 TO W-ERR                                          D.970325
008460*****    GO TO M-90.                                              D.970325
008470*****COMPUTE KHT-NKIN = KHT-NKIN + KB-KI.                         D.970325
008480*****REWRITE KHT-R INVALID KEY                                    D.970325
008490*****    MOVE SPACE TO W-ME W-P                                   D.970325
008500*****    MOVE W-ME4 TO W-ME P-ME                                  D.970325
008510*****    DISPLAY E-ME78 E-STAT E-ME E-HCD E-ME99                  D.970325
008520*****    MOVE "KNBKF" TO P-FILE                                   D.970325
008530*****    MOVE KHT-R TO P-DATA                                     D.970325
008540*****    MOVE 255 TO COMPLETION-CODE                              D.970325
008550*****    MOVE 9 TO W-ERR                                          D.970325
008560*****    GO TO M-90.                                              D.970325
008570*****GO TO M-33.                                                  D.970325
008580 M-35.
008590     READ KNH-F AT END
008600         DISPLAY C-MID7                                           I.151221
008610         MOVE ZERO TO W-D                                         I.151221
008620         GO TO M-60.                                              I.151221
008630*****    DISPLAY C-MID5                                           D.151221
008640*****    GO TO M-45.                                              D.151221
008650     IF NH-HCD NOT = SPACE AND ZERO                               I.980210
008660         MOVE NH-HCD TO W-KEY                                     I.980210
008670         PERFORM KHM-RTN THRU KHM-EX.                             I.980210
008680     MOVE NH-HCD TO KHT-KEY.
008690     READ KHT-M INVALID KEY
008700*****    MOVE SPACE TO W-ME W-P                                   D.970325
008710*****    MOVE W-ME3 TO W-ME P-ME                                  D.970325
008720         MOVE SPACE TO W-ME                                       I.970325
008730         MOVE W-ME3 TO W-ME                                       I.970325
008740         DISPLAY E-ME78 E-ME E-HCD E-ME99                         C.940319
008750*****    MOVE "KNHF" TO P-FILE                                    D.970325
008760*****    MOVE KNH-R TO P-DATA                                     D.970325
008770         MOVE 255 TO COMPLETION-CODE
008780         MOVE 9 TO W-ERR
008790         GO TO M-90.
008800*****IF NH-NHC = ZERO                                             D.021009
008810*****    ADD NH-SU TO KHT-KSU                                     D.021009
008820*****    COMPUTE KHT-KKIN = NH-KIN + KHT-KKIN                     D.021009
008830*****  ELSE                                                       D.021009
008840*****    ADD NH-SU TO KHT-HSU                                     D.021009
008850*****    COMPUTE KHT-KKIN = KHT-KKIN - NH-KIN.                    D.021009
008860     IF NH-NHC NOT = ZERO                                         I.021009
008870         ADD NH-SU TO KHT-HSU                                     I.021009
008880         COMPUTE KHT-KKIN = KHT-KKIN - NH-KIN                     I.021009
008890       ELSE                                                       I.021009
008900         COMPUTE KHT-KKIN = NH-KIN + KHT-KKIN                     I.021009
008910         IF NH-NC = 0                                             I.021009
008920             ADD NH-SU TO KHT-KSU                                 I.021009
008930           ELSE                                                   I.021009
008940             ADD NH-SU TO KHT-ISU.                                I.021009
008950     REWRITE KHT-R INVALID KEY
008960*****    MOVE SPACE TO W-ME W-P                                   D.970325
008970*****    MOVE W-ME4 TO W-ME P-ME                                  D.970325
008980         MOVE SPACE TO W-ME                                       I.970325
008990         MOVE W-ME4 TO W-ME                                       I.970325
009000         DISPLAY E-ME78 E-STAT E-ME E-HCD E-ME99                  C.940319
009010*****    MOVE "KNHF" TO P-FILE                                    D.970325
009020*****    MOVE KHT-R TO P-DATA                                     D.970325
009030         MOVE 255 TO COMPLETION-CODE
009040         MOVE 9 TO W-ERR
009050         GO TO M-90.
009060*****IF NH-NHC NOT = ZERO                                         D.151221
009070     GO TO M-35.                                                  I.000705
009080*****IF NH-YC NOT = 10 AND 11                                     D.021217
009090*****IF NH-YC NOT = 10 AND 11 AND 30                              D.100602
009100*****IF NH-YC NOT = 10 AND 11                                     D.151221
009110*****    GO TO M-35.                                              D.151221
009120*
009130*****MOVE SPACE TO KHJ-KEY.                                       D.151221
009140*****MOVE NH-HCD TO KHJ-HCD.                                      D.151221
009150*****START KHJ-M KEY NOT < KHJ-KEY INVALID KEY                    D.151221
009160*****    GO TO M-35.                                              D.151221
009170*M-40.                                                            D.151221
009180*****READ KHJ-M NEXT RECORD WITH UNLOCK AT END                    D.151221
009190*****    GO TO M-35.                                              D.151221
009200*****IF NH-HCD NOT = KHJ-HCD                                      D.151221
009210*****    GO TO M-35.                                              D.151221
009220*****IF ZERO = KHJ-SGRD AND KHJ-SU                                D.151221
009230*****    GO TO M-40.                                              D.151221
009240*****IF KHJ-SU NOT = ZERO                                         D.151221
009250*****    IF KHJ-KSC NOT = 1                                       D.151221
009260*****        GO TO M-40.                                          D.151221
009270*
009280*****MOVE KHJ-JCD TO KJ-KEY.                                      D.151221
009290*****READ KJ-M INVALID KEY                                        D.151221
009300*****    MOVE SPACE TO W-ME                                       D.151221
009310*****    MOVE W-ME5 TO W-ME                                       D.151221
009320*****    DISPLAY E-ME78 E-ME E-JCD E-ME99                         D.151221
009330*****    MOVE 255 TO COMPLETION-CODE                              D.151221
009340*****    MOVE 9 TO W-ERR                                          D.151221
009350*****    GO TO M-90.                                              D.151221
009360*****IF KHJ-SGRD NOT = ZERO                                       D.151221
009370*****    COMPUTE KJ-HSU = KJ-HSU + (NH-SU * KHJ-SGRD) + 0.9.      D.151221
009380*****IF KHJ-SU NOT = ZERO                                         D.151221
009390*****    COMPUTE KJ-HSU = KJ-HSU + (NH-SU * KHJ-SU).              D.151221
009400*****REWRITE KJ-R INVALID KEY                                     D.151221
009410*****    MOVE SPACE TO W-ME                                       D.151221
009420*****    MOVE W-ME6 TO W-ME                                       D.151221
009430*****    DISPLAY E-ME78 E-STAT E-ME E-JCD E-ME99                  D.151221
009440*****    MOVE 255 TO COMPLETION-CODE                              D.151221
009450*****    MOVE 9 TO W-ERR                                          D.151221
009460*****    GO TO M-90.                                              D.151221
009470*****GO TO M-35.                                                  D.151221
009480*M-45.                                                            D.151221
009490*****READ KS-F AT END                                             D.151221
009500*****    DISPLAY C-MID6                                           D.151221
009510*****    GO TO M-50.                                              D.151221
009520*****IF KS-DK NOT = ZERO                                          D.151221
009530*****    GO TO M-45.                                              D.151221
009540*****MOVE KS-CO TO KJ-KEY.                                        D.151221
009550*****READ KJ-M INVALID KEY                                        D.151221
009560*****    MOVE SPACE TO W-ME W-P                                   D.970325
009570*****    MOVE W-ME5 TO W-ME P-ME                                  D.970325
009580*****    MOVE SPACE TO W-ME                                       D.151221
009590*****    MOVE W-ME5 TO W-ME                                       D.151221
009600*****    DISPLAY E-ME78 E-ME E-JCD E-ME99                         D.151221
009610*****    MOVE "KSF" TO P-FILE                                     D.970325
009620*****    MOVE KS-R TO P-DATA                                      D.970325
009630*****    MOVE 255 TO COMPLETION-CODE                              D.151221
009640*****    MOVE 9 TO W-ERR                                          D.151221
009650*****    GO TO M-90.                                              D.151221
009660*****COMPUTE KJ-SSU = KS-SU + KJ-SSU.                             D.151221
009670*****PERFORM KJM-RTN THRU KJM-EX.                                 D.151221
009680*****REWRITE KJ-R INVALID KEY                                     D.151221
009690*****    MOVE SPACE TO W-ME W-P                                   D.970325
009700*****    MOVE W-ME6 TO W-ME P-ME                                  D.970325
009710*****    MOVE SPACE TO W-ME                                       D.151221
009720*****    MOVE W-ME6 TO W-ME                                       D.151221
009730*****    DISPLAY E-ME78 E-STAT E-ME E-JCD E-ME99                  D.151221
009740*****    MOVE "KSF" TO P-FILE                                     D.970325
009750*****    MOVE KJ-R TO P-DATA                                      D.970325
009760*****    MOVE 255 TO COMPLETION-CODE                              D.151221
009770*****    MOVE 9 TO W-ERR                                          D.151221
009780*****    GO TO M-90.                                              D.151221
009790*****IF KS-KU NOT = 5                                             D.151221
009800*****    GO TO M-45.                                              D.151221
009810*
009820*****MOVE KJ-HCD TO W-KEY.                                        D.151221
009830*****PERFORM KHM-RTN THRU KHM-EX.                                 D.151221
009840*****MOVE KJ-HCD TO KHT-KEY.                                      D.151221
009850*****READ KHT-M INVALID KEY                                       D.151221
009860*****    MOVE SPACE TO W-ME                                       D.151221
009870*****    MOVE W-ME3 TO W-ME                                       D.151221
009880*****    DISPLAY E-ME78 E-ME E-HCD E-ME99                         D.151221
009890*****    MOVE 255 TO COMPLETION-CODE                              D.151221
009900*****    MOVE 9 TO W-ERR                                          D.151221
009910*****    GO TO M-90.                                              D.151221
009920*****ADD KS-SU TO KHT-ISU.                                        D.151221
009930*****COMPUTE KHT-KKIN = KHT-KKIN + (KS-SU * KH-GT1).              D.151221
009940*****COMPUTE KHT-KKIN = KHT-KKIN + (KS-SU * KH-T1).               D.090428
009950*****REWRITE KHT-R INVALID KEY                                    D.151221
009960*****    MOVE SPACE TO W-ME                                       D.151221
009970*****    MOVE W-ME4 TO W-ME                                       D.151221
009980*****    DISPLAY E-ME78 E-STAT E-ME E-HCD E-ME99                  D.151221
009990*****    MOVE 255 TO COMPLETION-CODE                              D.151221
010000*****    MOVE 9 TO W-ERR                                          D.151221
010010*****    GO TO M-90.                                              D.151221
010020*****GO TO M-45.                                                  D.151221
010030*M-50.                                                            D.151221
010040*****READ KKH-F AT END                                            D.151221
010050*****    DISPLAY C-MID7                                           D.151221
010060*****    MOVE ZERO TO W-D                                         D.151221
010070*****    GO TO M-60.                                              D.151221
010080*****    GO TO M-90.                                              D.070130
010090*****IF KKH-SC = 1 OR 4                                           D.941109
010100*****    GO TO M-51.                                              D.941109
010110*****IF KKH-HKC = ZERO                                            D.000705
010120*****    GO TO M-50.                                              D.000705
010130*M-51.                                                            D.941109
010140*****MOVE KKH-CO TO KJ-KEY.                                       D.151221
010150*****READ KJ-M INVALID KEY                                        D.151221
010160*****    MOVE SPACE TO W-ME W-P                                   D.970325
010170*****    MOVE W-ME5 TO W-ME P-ME                                  D.970325
010180*****    MOVE SPACE TO W-ME                                       D.151221
010190*****    MOVE W-ME5 TO W-ME                                       D.151221
010200*****    DISPLAY E-ME78 E-ME E-JCD E-ME99                         D.151221
010210*****    MOVE "KKHF" TO P-FILE                                    D.970325
010220*****    MOVE KKH-R TO P-DATA                                     D.970325
010230*****    MOVE 255 TO COMPLETION-CODE                              D.151221
010240*****    MOVE 9 TO W-ERR                                          D.151221
010250*****    GO TO M-90.                                              D.151221
010260*****IF KKH-HKC = 1                                               D.941109
010270*****    COMPUTE W-SU = KKH-SU + KJ-KSU                           D.941109
010280*****    MOVE W-SU TO KJ-KSU                                      D.941109
010290*****  ELSE                                                       D.941109
010300*****    COMPUTE W-SU = KKH-SU + KJ-HSU                           D.941109
010310*****    MOVE W-SU TO KJ-HSU.                                     D.941109
010320*****COMPUTE W-SU = KKH-SU + KJ-KSU.                              D.000705
010330*****MOVE W-SU TO KJ-KSU.                                         D.000705
010340*****IF KKH-HKC = ZERO                                            D.151221
010350*****    ADD KKH-SU TO KJ-HSU                                     D.151221
010360*****  ELSE                                                       D.151221
010370*****    ADD KKH-SU TO KJ-KSU.                                    D.151221
010380*****PERFORM KJM-RTN THRU KJM-EX.                                 D.151221
010390*****REWRITE KJ-R INVALID KEY                                     D.151221
010400*****    MOVE SPACE TO W-ME W-P                                   D.970325
010410*****    MOVE W-ME6 TO W-ME P-ME                                  D.970325
010420*****    MOVE SPACE TO W-ME                                       D.151221
010430*****    MOVE W-ME6 TO W-ME                                       D.151221
010440*****    DISPLAY E-ME78 E-STAT E-ME E-JCD E-ME99                  D.151221
010450*****    MOVE "KKHF" TO P-FILE                                    D.970325
010460*****    MOVE KJ-R TO P-DATA                                      D.970325
010470*****    MOVE 255 TO COMPLETION-CODE                              D.151221
010480*****    MOVE 9 TO W-ERR                                          D.151221
010490*****    GO TO M-90.                                              D.151221
010500*****GO TO M-50.                                                  D.151221
010510 M-60.                                                            I.070130
010520     READ NYU-F NEXT RECORD AT END                                I.070130
010530         GO TO M-75.                                              I.070130
010540     IF NYU-BC = 0                                                I.070130
010550         GO TO M-60.                                              I.070130
010560     IF NYU-DPC = 0                                               I.070130
010570         GO TO M-60.                                              I.070130
010580 M-65.                                                            I.070130
010590     IF W-TCD = ZERO                                              I.070130
010600         MOVE NYU-TCD TO W-TCD                                    I.070130
010610         MOVE NYU-DNO TO W-DNO                                    I.070130
010620       ELSE                                                       I.070130
010630         IF W-DNO NOT = NYU-DNO                                   I.070130
010640             GO TO M-70.                                          I.070130
010650     IF NYU-NC2 > 7                                               I.070130
010660         ADD NYU-KIN TO W-SHZ                                     I.070130
010670       ELSE                                                       I.070130
010680         ADD NYU-KIN TO W-KIN.                                    I.070130
010690     GO TO M-60.                                                  I.070130
010700 M-70.                                                            I.070130
010710     PERFORM TTM-RTN THRU TTM-EX.                                 I.070130
010720     MOVE ZERO TO W-D.                                            I.070130
010730     GO TO M-65.                                                  I.070130
010740 M-75.                                                            I.070130
010750     IF W-TCD NOT = ZERO                                          I.070130
010760         PERFORM TTM-RTN THRU TTM-EX.                             I.070130
010770 M-90.
010780     IF W-ERR = 0
010790         IF COMPLETION-CODE = 255
010800             GO TO M-95.
010810     CLOSE KH-M.                                                  I.940606
010820     CLOSE URI-F.
010830*****CLOSE KNBK-F.                                                D.970325
010840*****CLOSE KAZ-F.                                                 D.970226
010850     CLOSE KNH-F.
010860*****CLOSE KS-F.                                                  D.151221
010870*****CLOSE KKH-F.                                                 D.151221
010880     CLOSE NYU-F.                                                 I.070130
010890*****CLOSE KT-M.                                                  D.000224
010900     CLOSE TT-M.                                                  I.000224
010910     CLOSE KHT-M.
010920*****CLOSE KJ-M.                                                  D.151221
010930 M-95.
010940*****IF W-ERR = 9                                                 D.970325
010950*****    OPEN OUTPUT SP-F                                         D.970325
010960*****    MOVE SPACE TO SP-R                                       D.970325
010970*****    MOVE W-P TO SP-R                                         D.970325
010980*****    WRITE SP-R                                               D.970325
010990*****    CLOSE SP-F.                                              D.970325
011000     DISPLAY C-CLEAR.
011010     STOP RUN.
011020 KHM-RTN.                                                         I.980210
011030     MOVE W-KEY TO KH-KEY.                                        I.980210
011040     READ KH-M INVALID KEY                                        I.980210
011050         MOVE ZERO TO KH-T1                                       I.021009
011060         MOVE SPACE TO W-ME                                       I.021009
011070         MOVE W-ME9 TO W-ME                                       I.021009
011080         DISPLAY E-ME E-KEY E-ME99                                I.021009
011090         DISPLAY E-CL                                             I.021009
011100         GO TO KHM-EX.                                            I.980210
011110     IF KH-ENG = ZERO                                             I.980210
011120         GO TO KHM-010.                                           I.980210
011130     MOVE ZERO TO W-NG.                                           I.980210
011140     MOVE KH-ENG TO W-NGS.                                        I.980210
011150     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.980210
011160         ADD DATE-NC1 TO W-NEN.                                   I.980210
011170     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.980210
011180         ADD DATE-NC2 TO W-NEN.                                   I.980210
011190     IF W-NG >= W-DATE                                            I.980210
011200         GO TO KHM-EX.                                            I.980210
011210 KHM-010.                                                         I.980210
011220     MOVE W-DATE TO W-NG.                                         I.980210
011230     MOVE W-NGS TO KH-ENG.                                        I.980210
011240     REWRITE KH-R INVALID KEY                                     I.980210
011250         MOVE SPACE TO W-ME                                       I.980210
011260         MOVE W-ME10 TO W-ME                                      I.980210
011270         DISPLAY E-STAT E-ME E-KEY E-ME99                         I.980210
011280         DISPLAY E-CL.                                            I.980210
011290 KHM-EX.                                                          I.980210
011300     EXIT.                                                        I.980210
011310*KJM-RTN.                                                         D.151221
011320*****IF KJ-ENG = ZERO                                             D.151221
011330*****    MOVE W-DATE TO W-NG                                      D.151221
011340*****    MOVE W-NGS TO KJ-ENG                                     D.151221
011350*****    GO TO KJM-EX.                                            D.151221
011360*****MOVE ZERO TO W-NG.                                           D.151221
011370*****MOVE KJ-ENG TO W-NGS.                                        D.151221
011380*****IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        D.151221
011390*****    ADD DATE-NC1 TO W-NEN.                                   D.151221
011400*****IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        D.151221
011410*****    ADD DATE-NC2 TO W-NEN.                                   D.151221
011420*****IF W-NG < W-DATE                                             D.151221
011430*****    MOVE W-DATE TO W-NG                                      D.151221
011440*****    MOVE W-NGS TO KJ-ENG.                                    D.151221
011450*KJM-EX.                                                          D.151221
011460*****EXIT.                                                        D.151221
011470 TTM-RTN.                                                         I.070130
011480     MOVE W-TCD TO TT-KEY.                                        I.070130
011490     READ TT-M INVALID KEY                                        I.070130
011500         MOVE SPACE TO W-ME                                       I.070130
011510         MOVE W-ME1 TO W-ME                                       I.070130
011520         DISPLAY E-ME78 E-ME E-TCD E-ME99                         I.070130
011530         MOVE 255 TO COMPLETION-CODE                              I.070130
011540         MOVE 9 TO W-ERR                                          I.070130
011550         GO TO TTM-EX.                                            I.070130
011560     ADD W-KIN TO TT-TNK.                                         I.070130
011570     ADD W-SHZ TO TT-TNKZ.                                        I.070130
011580     SUBTRACT W-KIN FROM TT-TUZ.                                  I.070130
011590     SUBTRACT W-SHZ FROM TT-TUZZ.                                 I.070130
011600     PERFORM TTMC-RTN THRU TTMC-EX.                               I.070130
011610     REWRITE TT-R INVALID KEY                                     I.070130
011620         MOVE SPACE TO W-ME                                       I.070130
011630         MOVE W-ME2 TO W-ME                                       I.070130
011640         DISPLAY E-ME78 E-STAT E-ME E-TCD E-ME99                  I.070130
011650         MOVE 255 TO COMPLETION-CODE                              I.070130
011660         MOVE 9 TO W-ERR.                                         I.070130
011670 TTM-EX.                                                          I.070130
011680     EXIT.                                                        I.070130
011690 CHK-RTN.                                                         I.981214
011700     OPEN INPUT URI-F.                                            I.981214
011710 CHK-010.                                                         I.981214
011720     READ URI-F AT END                                            I.981214
011730         GO TO CHK-020.                                           I.981214
011740*****IF U-NRC = "H"                                               D.001031
011750*****    GO TO CHK-010.                                           D.001031
011760     IF U-PRC = 9                                                 I.981214
011770         GO TO CHK-010.                                           I.981214
011780     CLOSE URI-F.                                                 I.981214
011790     MOVE 1 TO W-ERR.                                             I.981214
011800     MOVE "URIF" TO W-FILE.                                       I.981214
011810     GO TO CHK-EX.                                                I.981214
011820 CHK-020.                                                         I.981214
011830     CLOSE URI-F.                                                 I.981214
011840     OPEN INPUT KNH-F.                                            I.981214
011850 CHK-030.                                                         I.981214
011860     READ KNH-F AT END                                            I.981214
011870         GO TO CHK-040.                                           I.981214
011880     IF NH-PRC = 9                                                I.981214
011890         GO TO CHK-030.                                           I.981214
011900     CLOSE KNH-F.                                                 I.981214
011910     MOVE 1 TO W-ERR.                                             I.981214
011920     MOVE "KNHF" TO W-FILE.                                       I.981214
011930     GO TO CHK-EX.                                                I.981214
011940 CHK-040.                                                         I.981214
011950     CLOSE KNH-F.                                                 I.981214
011960*****OPEN INPUT KS-F.                                             D.151221
011970*CHK-050.                                                         D.151221
011980*****READ KS-F AT END                                             D.151221
011990*****    GO TO CHK-060.                                           D.151221
012000*****IF KS-PRC = 9                                                D.151221
012010*****    GO TO CHK-050.                                           D.151221
012020*****CLOSE KS-F.                                                  D.151221
012030*****MOVE 1 TO W-ERR.                                             D.151221
012040*****MOVE "KSF " TO W-FILE.                                       D.151221
012050*****GO TO CHK-EX.                                                D.151221
012060*CHK-060.                                                         D.151221
012070*****CLOSE KS-F.                                                  D.151221
012080*****OPEN INPUT KKH-F.                                            D.151221
012090*CHK-070.                                                         D.151221
012100*****READ KKH-F AT END                                            D.151221
012110*****    GO TO CHK-080.                                           D.151221
012120*****IF KKH-PRC = 9                                               D.151221
012130*****    GO TO CHK-070.                                           D.151221
012140*****CLOSE KKH-F.                                                 D.151221
012150*****MOVE 1 TO W-ERR.                                             D.151221
012160*****MOVE "KKHF" TO W-FILE.                                       D.151221
012170*CHK-080.                                                         D.151221
012180*****CLOSE KKH-F.                                                 D.151221
012190 CHK-EX.                                                          I.070130
012200     EXIT.                                                        I.070130
012210 TTMC-RTN.                                                        I.070130
012220     COMPUTE WT-TZZ = TT-TZZ + TT-TZZZ.                           I.070130
012230     COMPUTE WT-TUA = TT-TUA + TT-TUAZ.                           I.070130
012240     COMPUTE WT-TNB = TT-TNB + TT-TNBZ.                           I.070130
012250     COMPUTE WT-TNK = TT-TNK + TT-TNKZ.                           I.070130
012260     COMPUTE WT-TUZ = TT-TUZ + TT-TUZZ.                           I.070130
012270     COMPUTE WT-TUZW = WT-TZZ + WT-TUA - WT-TNB - WT-TNK.         I.070130
012280     IF WT-TUZ NOT = WT-TUZW                                      I.070130
012290         DISPLAY D-ZM E-ME99                                      I.070130
012300         DISPLAY D-ZMC.                                           I.070130
012310 TTMC-EX.                                                         I.070130
012320     EXIT.                                                        I.070130
