000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD210.
000030*********************************************************
000040*    PROGRAM         :  履物売上・値引入力              *
000050*    SCREEN          :  SCHD01,SCHD11                   *
000060*    COMPILE TYPE    :  COBOL                           *
000070*********************************************************
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.
000150     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE RANDOM
000180         RECORD KEY T-KEY
000190         ALTERNATE RECORD KEY T-KEY2.
000200*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000210     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY HI-KEY                                        I.010802
000250         ALTERNATE RECORD KEY HI-KEY2.                            I.010802
000260*****    RECORD KEY HI-KEY.                                       D.010802
000270*****SELECT TAZ-M ASSIGN TO TAZ-MSD                               D.070124
000280*****    ACCESS MODE RANDOM                                       D.070124
000290*****    ORGANIZATION INDEXED                                     D.070124
000300*****    RECORD KEY TAZ-KEY                                       D.070124
000310*****    FILE STATUS IS ERR-STAT.                                 D.070124
000320     SELECT TC-M ASSIGN TO TC-MSD
000330         ORGANIZATION INDEXED
000340         ACCESS MODE RANDOM
000350         RECORD KEY TC-KEY.
000360     SELECT S-TRAN ASSIGN TO S-MSD
000370         FILE STATUS IS ERR-STAT.
000380     SELECT JCON ASSIGN TO F4-MSD
000390         ORGANIZATION INDEXED
000400         ACCESS MODE RANDOM
000410         RECORD KEY JCON3-KEY
000420         FILE STATUS IS ERR-STAT.
000430*****SELECT JT-THTN ASSIGN TO F5-MSD                              D.010419
000440     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD                      I.010419
000450         ORGANIZATION INDEXED
000460         ACCESS MODE RANDOM
000470         RECORD KEY THT-KEY                                       I.010419
000480         ALTERNATE RECORD KEY THT-KEY2                            I.010419
000490*****    RECORD KEY THTN-KEY                                      D.010419
000500         FILE STATUS IS ERR-STAT.
000510     SELECT OTHTM ASSIGN TO OTHT1-MSD OTHT2-MSD                   I.110407
000520         ORGANIZATION INDEXED                                     I.110407
000530         ACCESS MODE RANDOM                                       I.110407
000540         RECORD KEY OTHT-KEY                                      I.110407
000550         ALTERNATE RECORD KEY OTHT-KEY2                           I.110407
000560         FILE STATUS IS ERR-STAT.                                 I.110407
000570     SELECT HSMSF ASSIGN TO HSMS-MSD
000580         ORGANIZATION INDEXED
000590         ACCESS MODE DYNAMIC
000600         RECORD KEY HSMS-KEY
000610         FILE STATUS IS ERR-STAT.
000620     SELECT HKBM  ASSIGN TO HKB-MSD
000630         ORGANIZATION INDEXED
000640         ACCESS MODE RANDOM
000650         RECORD KEY HKB-KEY
000660         FILE STATUS IS ERR-STAT.
000670     SELECT TSKF  ASSIGN TO TSK-MSD                               I.000922
000680         ORGANIZATION INDEXED                                     I.000922
000690         ACCESS MODE RANDOM                                       I.000922
000700         RECORD KEY TSK-KEY                                       I.000922
000710         FILE STATUS IS ERR-STAT.                                 I.000922
000720     SELECT HUH-M ASSIGN TO HUH-MSD                               I.020215
000730         ORGANIZATION INDEXED                                     I.020215
000740         ACCESS MODE RANDOM                                       I.020215
000750         RECORD KEY HUH-KEY                                       I.020215
000760         FILE STATUS IS ERR-STAT.                                 I.020215
000770 I-O-CONTROL.
000780     APPLY SHARED-MODE ON T-M
000790     APPLY SHARED-MODE ON JCON
000800*****APPLY SHARED-MODE ON JT-THTN                                 D.010419
000810     APPLY SHARED-MODE ON THTM                                    I.010419
000820     APPLY SHARED-MODE ON OTHTM                                   I.110407
000830     APPLY SHARED-MODE ON HI-M
000840*****APPLY SHARED-MODE ON TAZ-M                                   D.070124
000850     APPLY SHARED-MODE ON TC-M
000860     APPLY SHARED-MODE ON HSMSF
000870     APPLY SHARED-MODE ON HKBM
000880     APPLY SHARED-MODE ON TSKF                                    I.000922
000890     APPLY SHARED-MODE ON HUH-M                                   I.020215
000900     APPLY SHARED-MODE ON M-DATE.
000910 DATA DIVISION.
000920 FILE SECTION.
000930     COPY LIBFDD.
000940     COPY LITM.
000950     COPY LIHIM.
000960     COPY LITCM.
000970     COPY LIHSMS.
000980     COPY LIHKBM.
000990*****COPY LTHTN.                                                  D.010419
001000     COPY LITHTM.                                                 I.010419
001010     COPY LIOTHT.                                                 I.110407
001020     COPY L-JCON.
001030     COPY LITSKF.                                                 I.000922
001040     COPY LIHUHM.                                                 I.020215
001050*FD  TAZ-M                                                        D.070124
001060*****BLOCK  8 RECORDS                                             D.020821
001070*****BLOCK  6 RECORDS                                             D.070124
001080*****LABEL RECORD IS STANDARD                                     D.070124
001090*****VALUE OF IDENTIFICATION "TAZM".                              D.070124
001100*01  TAZ-R.                                                       D.070124
001110*****02  TAZ-KEY.                                                 D.070124
001120*****  03  TAZ-TCD      PIC  9(004).                              D.070124
001130*****  03  TAZ-HCD      PIC  9(006).                              D.070124
001140*****02  TAZ-ZS         PIC S9(005).                              D.020821
001150*****02  TAZ-AS         PIC S9(005).                              D.020821
001160*****02  F              PIC  X(006).                              D.020821
001170*****02  F              PIC  X(026).                              D.070124
001180*****02  TAZ-NG         PIC  9(006).                              D.070124
001190 FD  S-TRAN
001200     BLOCK  2 RECORDS
001210     LABEL RECORD IS STANDARD
001220     VALUE OF IDENTIFICATION "STRAN".
001230 01  S-R.
001240     02  S-DNO          PIC  9(006).
001250     02  S-GNO          PIC  9(001).
001260     02  S-DATE         PIC  9(008).
001270     02  S-TCD          PIC  9(004).
001280     02  F              PIC  X(107).
001290     02  S-DHC          PIC  9(001).
001300     02  S-SNC          PIC  9(001).
001310 WORKING-STORAGE SECTION.
001320 77  W-FILE             PIC  X(013).
001330 77  W-END              PIC  9(001) VALUE 0.
001340 77  CHK                PIC  9(001) VALUE 0.
001350 77  W-INV              PIC  9(001) VALUE 0.
001360 77  W-ADV              PIC  9(001) VALUE 0.
001370 01  ERR-STAT           PIC  X(002).
001380 01  W-SR.
001390     02  W-DNO          PIC  9(006).
001400     02  W-GNO          PIC  9(001).
001410     02  W-DATE         PIC  9(008).
001420     02  W-TCD          PIC  9(004).
001430     02  W-DT1          PIC  X(107).
001440     02  W-DT2   REDEFINES W-DT1.
001450       03  W-ZD1.
001460         04  W-HCD      PIC  9(006).
001470         04  W-SIZ      PIC  9(001).
001480         04  W-SUS.
001490           05  W-SUSD  OCCURS  10.
001500             06  W-SU   PIC S9(004)  COMP-3.
001510         04  W-SUT      PIC S9(005).
001520         04  W-BT       PIC S9(005).
001530       03  W-KIN        PIC S9(008).
001540       03  W-CSC        PIC  9(001).
001550       03  W-DC         PIC  9(001).
001560       03  W-FT         PIC  9(005).
001570       03  W-CCD        PIC  9(003).
001580       03  W-ZD2.
001590         04  W-BC1      PIC  9(002).
001600         04  W-BC2.
001610           05  W-BC21   PIC  9(001).
001620           05  W-BC22   PIC  9(001).
001630         04  W-BC3      PIC  9(002).
001640         04  W-SOK      PIC  9(001).
001650       03  W-TC2        PIC  9(002).
001660       03  W-FKC        PIC  9(002).
001670       03  W-HSC        PIC  9(001).
001680       03  W-KOSU       PIC  9(003).
001690       03  W-FRC        PIC  9(001).
001700       03  W-TCD2       PIC  9(004).
001710       03  W-BIK        PIC  X(010).
001720       03  W-SDT        PIC  9(008).
001730       03  W-BMC        PIC  9(002).                              I.020517
001740       03  W-BMNO       PIC  9(001).                              I.020517
001750       03  W-USC        PIC  9(001).                              I.040324
001760*****  03  F            PIC  X(001).                              D.040324
001770*****  03  F            PIC  X(004).                              D.020517
001780     02  W-DHC          PIC  9(001).
001790     02  W-UNC          PIC  9(001).
001800 01  W-ASR.
001810     02  W-AS    OCCURS   6  PIC  X(128).
001820 01  W-BR.
001830     02  W-BI           PIC  N(024).
001840     02  W-HANO         PIC  9(006).                              I.081222
001850     02  F              PIC  X(030).                              I.081222
001860*****02  W-HANO.                                                  D.081222
001870*****  03  W-HA    OCCURS   6  PIC  9(006).                       D.081222
001880     02  W-TAX          PIC S9(007).
001890     02  W-UZZ          PIC S9(007).
001900     02  W-UZ           PIC S9(009).
001910 01  W-ASD.
001920     02  W-SD    OCCURS  10  PIC  9(001).
001930 01  W-DATA.
001940     02  W-L.
001950       03  W-L1         PIC  9(002).
001960       03  W-L2         PIC  9(002).
001970       03  W-L3         PIC  9(002).
001980     02  W-C            PIC S9(002).
001990     02  W-GSUT         PIC S9(006).
002000     02  W-UNCD         PIC  9(001).
002010     02  W-RC           PIC  9(001).
002020     02  W-SC           PIC  9(002).
002030     02  W-DMM          PIC  9(001).
002040     02  W-DNOD         PIC  9(006).
002050     02  W-DNOO         PIC  9(006).
002060     02  W-NGP          PIC  9(008).
002070     02  W-NGPD  REDEFINES W-NGP.
002080       03  W-NGD.
002090         04  W-ND       PIC  9(004).
002100         04  W-NDD   REDEFINES W-ND.
002110           05  W-ND1    PIC  9(002).
002120           05  W-ND2    PIC  9(002).
002130         04  W-GD       PIC  9(002).
002140       03  W-PD         PIC  9(002).
002150     02  W-NGPSD REDEFINES W-NGP.
002160       03  F            PIC  9(002).
002170       03  W-NGPS       PIC  9(006).
002180     02  W-TCDD         PIC  9(004).
002190     02  W-TCDN         PIC  9(004).
002200     02  W-CCDD         PIC  9(003).
002210     02  W-HCDD         PIC  9(006).
002220     02  W-HCDO         PIC  9(006).                              I.010419
002230     02  W-CSCD         PIC  9(001).
002240     02  W-HNOD         PIC  9(006).                              I.081222
002250*****02  W-HNOD.                                                  D.081222
002260*****  03  W-HN1        PIC  9(006).                              D.081222
002270*****  03  W-HN2        PIC  9(006).                              D.081222
002280*****  03  W-HN3        PIC  9(006).                              D.081222
002290*****  03  W-HN4        PIC  9(006).                              D.081222
002300*****  03  W-HN5        PIC  9(006).                              D.081222
002310*****  03  W-HN6        PIC  9(006).                              D.081222
002320     02  W-DCD          PIC  9(001).
002330     02  W-DCC          PIC  9(001).
002340     02  W-ZC           PIC  9(001).
002350*****02  W-CNA          PIC  N(024).                              D.020425
002360     02  W-CNG.
002370       03  W-CN         PIC  9(004).
002380       03  W-CND   REDEFINES W-CN.
002390         04  W-CN1      PIC  9(002).
002400         04  W-CN2      PIC  9(002).
002410       03  W-CG         PIC  9(002).
002420     02  W-SNGD  REDEFINES W-CNG.
002430       03  F            PIC  9(002).
002440       03  W-CNGS       PIC  9(004).
002450     02  W-HSCD         PIC  9(001).
002460     02  W-HNC          PIC  9(001).
002470     02  W-HNCD         PIC  9(001).
002480     02  W-SCD          PIC  9(001).
002490     02  W-KOSUR        PIC  9(003).
002500     02  WK-TAN         PIC S9(005).
002510     02  W-FRCD         PIC  9(001).
002520     02  W-DTW1         PIC  9(003).
002530     02  W-DTW2         PIC  9(001).
002540     02  W-SDTD         PIC  9(008).
002550     02  W-SDTM  REDEFINES W-SDTD.
002560       03  W-SDTNG.
002570         04  W-SDTN     PIC  9(004).
002580         04  W-SDTG     PIC  9(002).
002590       03  W-SDTP       PIC  9(002).
002600     02  W-HMN          PIC  9(006).
002610     02  WK-SCD         PIC  9(001).
002620     02  WK-DC          PIC  9(001).
002630     02  WK-BI          PIC  N(024).
002640     02  W-EC           PIC  9(001).
002650     02  W-DEL          PIC  9(001).
002660     02  W-RCD          PIC  9(001).
002670     02  CNT            PIC  9(001).
002680     02  W-HC           PIC  9(001).                              I.011012
002690     02  W-LD           PIC  9(006).                              I.020404
002700     02  W-RCB          PIC  9(001).                              I.020404
002710     02  W-LB           PIC  9(006).                              I.020404
002720     02  W-DSPC         PIC  9(001).                              I.020404
002730*****02  W-LD.                                                    D.020404
002740*****  03  W-L1D        PIC  9(002).                              D.020404
002750*****  03  W-L2D        PIC  9(002).                              D.020404
002760*****  03  W-L3D        PIC  9(002).                              D.020404
002770*****02  W-CSN          PIC  N(003).                              D.020405
002780     02  W-DKIN         PIC S9(008).
002790     02  W-SDATE        PIC  9(008).                              I.000922
002800     02  W-HIC          PIC  9(001).                              I.020214
002810     02  W-FTD          PIC  9(005).                              I.020215
002820     02  W-TCHK         PIC  9(001).                              I.110407
002830     COPY LSTAT.
002840 SCREEN SECTION.
002850 SD  C-CRT
002860     END STATUS IS ESTAT.
002870 01  C-CLEAR.
002880     02  LINE   1  CLEAR SCREEN.
002890 01  C-MID.
002900     02  LINE   3  COLUMN  15  PIC  N(022) VALUE
002910          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002920     02  LINE   4  COLUMN  15  PIC  N(022) VALUE
002930          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002940     02  LINE   5  COLUMN  15  PIC  N(022) VALUE
002950          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
002960     02  LINE   6  COLUMN  15  PIC  N(022) VALUE
002970          NC"＊＊＊　　履物売上・値引伝票　入力　　＊＊＊".
002980     02  LINE   7  COLUMN  15  PIC  N(022) VALUE
002990          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003000     02  LINE   8  COLUMN  15  PIC  N(022) VALUE
003010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003020     02  LINE   9  COLUMN  15  PIC  N(022) VALUE
003030          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003040     02  LINE  15  COLUMN  26  PIC  X(022) VALUE
003050          "売上=0 , 値引=1   ﾘﾀｰﾝ".
003060 01  C-ACP.
003070     02  A-UNC   LINE  15  COLUMN  43  PIC  9(001)
003080          USING W-UNCD  CHECK OVERFLOW NO IFC.
003090*
003100     02  LINE   1.
003110       03  AU-NGP   COLUMN  16  PIC  9(006)
003120            USING W-NGPS  CHECK OVERFLOW NO IFC.
003130       03  AU-HMN   COLUMN  30  PIC  9(006)
003140            USING W-HMN   CHECK OVERFLOW NO IFC.
003150       03  AU-SOK   COLUMN  42  PIC  9(001)
003160            USING W-SCD   CHECK OVERFLOW NO IFC.
003170*****  03  AU-HN1   COLUMN  68  PIC  9(006)                       D.081222
003180*****       USING W-HN1   CHECK OVERFLOW NO IFC.                  D.081222
003190*****  03  AU-HN2   COLUMN  75  PIC  9(006)                       D.081222
003200*****       USING W-HN2   CHECK OVERFLOW NO IFC.                  D.081222
003210     02  LINE   2.
003220*****  03  AU-TCD   COLUMN   8  PIC  9(004)                       D.020405
003230       03  AU-TCD   COLUMN   6  PIC  9(004)                       I.020405
003240            USING W-TCDD  CHECK OVERFLOW NO IFC.
003250*****  03  AU-HN3   COLUMN  68  PIC  9(006)                       D.081222
003260*****       USING W-HN3   CHECK OVERFLOW NO IFC.                  D.081222
003270*****  03  AU-HN4   COLUMN  75  PIC  9(006)                       D.081222
003280*****       USING W-HN4   CHECK OVERFLOW NO IFC.                  D.081222
003290     02  LINE   3.
003300*****  03  AU-CCD   COLUMN   8  PIC  9(003)                       D.020405
003310       03  AU-CCD   COLUMN   6  PIC  9(003)                       I.020405
003320            USING W-CCDD  CHECK OVERFLOW NO IFC.
003330*****  03  AU-CSC   COLUMN  64  PIC  9(001)                       D.020405
003340       03  AU-CSC   COLUMN  65  PIC  9(001)                       I.020405
003350            USING W-CSCD  CHECK OVERFLOW NO IFC.
003360*****  03  AU-HN5   COLUMN  68  PIC  9(006)                       D.081222
003370*****       USING W-HN5   CHECK OVERFLOW NO IFC.                  D.081222
003380*****  03  AU-HN6   COLUMN  75  PIC  9(006)                       D.081222
003390*****       USING W-HN6   CHECK OVERFLOW NO IFC.                  D.081222
003400     02  LINE W-L1.
003410       03  AU-DC    COLUMN   4  PIC  9(001)
003420            USING W-DC    CHECK OVERFLOW NO IFC.
003430       03  AU-HCD   COLUMN  11  PIC  9(006)
003440            USING W-HCD   CHECK OVERFLOW NO IFC.
003450       03  AU-BIK   COLUMN  71  PIC  X(010)
003460            USING W-BIK   CHECK OVERFLOW NO IFC.
003470     02  LINE W-L3.
003480       03  AU-SIZ   COLUMN   1  PIC  9(001)
003490            USING W-SIZ   CHECK OVERFLOW NO IFC.
003500       03  AU-SU    COLUMN W-C  PIC S9(004)
003510            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003520       03  AU-SU1   COLUMN W-C  PIC S9(003)
003530            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003540       03  AU-SUT   COLUMN  60  PIC S9(005)
003550            USING W-SUT   CHECK OVERFLOW NO IFC.
003560       03  AU-BT    COLUMN  67  PIC  9(005)
003570            USING W-BT    CHECK OVERFLOW NO IFC.
003580       03  AU-KIN   COLUMN  73  PIC S9(007)
003590            USING W-KIN   CHECK OVERFLOW NO IFC.
003600     02  AU-BI    LINE  22  COLUMN   6  PIC  N(024)
003610          USING W-BI    CHECK OVERFLOW NO IFC.
003620     02  LINE  23.
003630       03  AU-KOSU  COLUMN   6  PIC  9(003)
003640            USING W-KOSUR CHECK OVERFLOW NO IFC.
003650       03  AU-HSC   COLUMN  17  PIC  9(001)
003660            USING W-HSCD  CHECK OVERFLOW NO IFC.
003670       03  AU-FRC   COLUMN  24  PIC  9(001)
003680            USING W-FRCD  CHECK OVERFLOW NO IFC.
003690       03  AU-SDT   COLUMN  33  PIC  9(008)
003700            USING W-SDTD  CHECK OVERFLOW NO IFC.
003710       03  AU-DMM   COLUMN  63  PIC  9(001)
003720            USING W-DMM   CHECK OVERFLOW NO IFC.
003730*
003740     02  AN-NGP   LINE   4  COLUMN   8  PIC  9(006)
003750          USING W-NGPS  CHECK OVERFLOW NO IFC.
003760     02  AN-TCD   LINE   5  COLUMN   8  PIC  9(004)
003770          USING W-TCDD  CHECK OVERFLOW NO IFC.
003780*****02  AN-CSC   LINE   5  COLUMN  71  PIC  9(001)               D.020405
003790     02  AN-CSC   LINE   5  COLUMN  75  PIC  9(001)               I.020405
003800          USING W-CSCD  CHECK OVERFLOW NO IFC.
003810     02  LINE W-L1.
003820       03  AN-HCD   COLUMN  01  PIC  9(006)
003830            USING W-HCD  CHECK OVERFLOW NO IFC.
003840       03  AN-SUT   COLUMN  58  PIC S9(005)
003850            USING W-SUT  CHECK OVERFLOW NO IFC.
003860       03  AN-BT    COLUMN  65  PIC S9(004)
003870            USING W-BT   CHECK OVERFLOW NO IFC.
003880       03  AN-KIN   COLUMN  71  PIC S9(008)
003890            USING W-KIN   CHECK OVERFLOW NO IFC.
003900     02  AN-BI    LINE  15  COLUMN  08  PIC  N(024)
003910          USING W-BI    CHECK OVERFLOW NO IFC.
003920     02  AN-HSC   LINE  16  COLUMN  12  PIC  9(001)
003930          USING W-HSCD  CHECK OVERFLOW NO IFC.
003940     02  AN-SDT   LINE  17  COLUMN   8  PIC  9(008)
003950            USING W-SDTD  CHECK OVERFLOW NO IFC.
003960     02  AN-DMM   LINE  20  COLUMN  46  PIC  9(001)
003970          USING W-DMM   CHECK OVERFLOW NO IFC.
003980*
003990     02  A-CHK   LINE  24  COLUMN  55  PIC  9(001)
004000          USING CHK     CHECK OVERFLOW NO IFC.
004010 01  C-DSP.
004020     02  DU-SNA   LINE   1  COLUMN  44  PIC  N(006) FROM
004030          JCON3-03.
004040     02  DU-TNA   LINE   2  COLUMN  11  PIC  N(026) FROM  T-NAME. I.020405
004050     02  DU-CNA   LINE   3  COLUMN  11  PIC  N(026) FROM  TC-NAME.I.020405
004060*****02  DU-TNA   LINE   2  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004070*****02  DU-CNA   LINE   3  COLUMN  13  PIC  N(024) FROM  TC-NAME.D.020405
004080     02  LINE W-L1.
004090       03  DU-HNA   COLUMN  18  PIC  N(024)    FROM  HI-NAME.
004100       03  DU-SZM   COLUMN  18  PIC  N(006)    VALUE
004110            NC"消費税調整分".
004120     02  LINE W-L2.
004130       03  DU-S1.
004140*****    04  COLUMN   3  PIC  X(005) VALUE "３号 ".               D.081222
004150*****    04  COLUMN   9  PIC  X(005) VALUE "２号 ".               D.081222
004160*****    04  COLUMN  15  PIC  X(005) VALUE "１号 ".               D.081222
004170*****    04  COLUMN  21  PIC  X(005) VALUE "０号 ".               D.081222
004180*****    04  COLUMN  27  PIC  X(005) VALUE " 中　".               D.081222
004190*****    04  COLUMN  33  PIC  X(005) VALUE " 大　".               D.081222
004200*****    04  COLUMN  39  PIC  X(005) VALUE "特大 ".               D.081222
004210         04  COLUMN   3  PIC  X(005) VALUE "     ".               I.081222
004220         04  COLUMN   9  PIC  X(005) VALUE "     ".               I.081222
004230         04  COLUMN  15  PIC  X(005) VALUE " SS  ".               I.081222
004240         04  COLUMN  21  PIC  X(005) VALUE "  S  ".               I.081222
004250         04  COLUMN  27  PIC  X(005) VALUE "  M  ".               I.081222
004260         04  COLUMN  33  PIC  X(005) VALUE "  L  ".               I.081222
004270         04  COLUMN  39  PIC  X(005) VALUE " LL  ".               I.081222
004280         04  COLUMN  45  PIC  X(004) VALUE "28.0".
004290         04  COLUMN  50  PIC  X(004) VALUE "29.0".
004300         04  COLUMN  55  PIC  X(004) VALUE "30.0".
004310       03  DU-S2.
004320         04  COLUMN   3  PIC  X(005) VALUE "12.5 ".
004330         04  COLUMN   9  PIC  X(005) VALUE "13.0 ".
004340         04  COLUMN  15  PIC  X(005) VALUE "13.5 ".
004350         04  COLUMN  21  PIC  X(005) VALUE "14.0 ".
004360         04  COLUMN  27  PIC  X(005) VALUE "15.0 ".
004370         04  COLUMN  33  PIC  X(005) VALUE "16.0 ".
004380         04  COLUMN  39  PIC  X(005) VALUE "17.0 ".
004390         04  COLUMN  45  PIC  X(004) VALUE "18.0".
004400         04  COLUMN  50  PIC  X(004) VALUE "19.0".
004410         04  COLUMN  55  PIC  X(004) VALUE "20.0".
004420       03  DU-S3.
004430         04  COLUMN   3  PIC  X(005) VALUE "21.0 ".
004440         04  COLUMN   9  PIC  X(005) VALUE "21.5 ".
004450         04  COLUMN  15  PIC  X(005) VALUE "22.0 ".
004460         04  COLUMN  21  PIC  X(005) VALUE "22.5 ".
004470         04  COLUMN  27  PIC  X(005) VALUE "23.0 ".
004480         04  COLUMN  33  PIC  X(005) VALUE "23.5 ".
004490         04  COLUMN  39  PIC  X(005) VALUE "24.0 ".
004500         04  COLUMN  45  PIC  X(004) VALUE "24.5".
004510         04  COLUMN  50  PIC  X(004) VALUE "25.0".
004520         04  COLUMN  55  PIC  X(004) VALUE "    ".
004530       03  DU-S4.
004540         04  COLUMN   3  PIC  X(005) VALUE "24.0 ".
004550         04  COLUMN   9  PIC  X(005) VALUE "24.5 ".
004560         04  COLUMN  15  PIC  X(005) VALUE "25.0 ".
004570         04  COLUMN  21  PIC  X(005) VALUE "25.5 ".
004580         04  COLUMN  27  PIC  X(005) VALUE "26.0 ".
004590         04  COLUMN  33  PIC  X(005) VALUE "26.5 ".
004600         04  COLUMN  39  PIC  X(005) VALUE "27.0 ".
004610         04  COLUMN  45  PIC  X(004) VALUE "27.5".
004620         04  COLUMN  50  PIC  X(004) VALUE "    ".
004630         04  COLUMN  55  PIC  X(004) VALUE "    ".
004640     02  LINE W-L3.
004650       03  DU-SU    COLUMN W-C  PIC ZZZZ-     FROM  W-SU(W-SC).
004660       03  DU-SU1   COLUMN W-C  PIC ZZZ-      FROM  W-SU(W-SC).
004670       03  DU-SUT   COLUMN  60  PIC ZZZZZ-    FROM  W-SUT.
004680       03  DU-BT    COLUMN  67  PIC ZZZZZ     FROM  W-BT.
004690       03  DU-KIN   COLUMN  73  PIC ZZZZZZZ-  FROM  W-KIN.
004700     02  LINE  22.
004710       03  DU-GSUT  COLUMN  58  PIC ZZZ,ZZZ-  FROM  W-GSUT.
004720     02  LINE  23.
004730       03  DU-KOSU  COLUMN   6  PIC ZZ9       FROM  W-KOSUR.
004740*
004750*****02  DN-TNA   LINE   5  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004760*****02  DN-CSN   LINE   5  COLUMN  73  PIC  N(003) FROM  W-CSN.  D.020405
004770     02  DN-TNA   LINE   5  COLUMN  13  PIC  N(026) FROM  T-NAME. I.020405
004780     02  LINE W-L1.
004790       03  DN-HNA   COLUMN   8  PIC  N(024)    FROM  HI-NAME.
004800       03  DN-SUT   COLUMN  57  PIC ZZZZZZ-    FROM  W-SUT.
004810       03  DN-BT    COLUMN  65  PIC ZZZZ-      FROM  W-BT.
004820       03  DN-KIN   COLUMN  71  PIC ZZZZZZZZ-  FROM  W-KIN.
004830     02  DN-DKIN.
004840       03  LINE  14  COLUMN  69  PIC ZZ,ZZZ,ZZ9-  FROM  W-DKIN.
004850 01  C-SPC.
004860     02  SU-HNO.
004870       03  LINE   1.
004880         04  SU-DATE  COLUMN  16  PIC  X(006) VALUE "      ".
004890         04  SU-HMN   COLUMN  30  PIC  X(006) VALUE "      ".
004900         04  SU-SOK   COLUMN  42  PIC  X(014) VALUE
004910              "            ".
004920         04  SU-HNM   COLUMN  56  PIC  X(010) VALUE "          ".
004930*****    04  SU-HN1   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
004940*****    04  SU-HN2   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
004950*****  03  LINE  2.                                               D.081222
004960*****    04  SU-HN3   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
004970*****    04  SU-HN4   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
004980*****  03  LINE  3.                                               D.081222
004990*****    04  SU-HN5   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
005000*****    04  SU-HN6   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
005010     02  SU-CNA   LINE   3.
005020       03  COLUMN   6  PIC  X(003) VALUE "   ".                   I.020405
005030       03  COLUMN  11  PIC  X(052) VALUE                          I.020405
005040           "                                                    ".I.020405
005050*****  03  COLUMN   8  PIC  X(003) VALUE "   ".                   D.020405
005060*****  03  COLUMN  13  PIC  X(048) VALUE                          D.020405
005070*****       "                                                ".   D.020405
005080     02  SU-D1    LINE W-L1.
005090       03  COLUMN   4  PIC  X(001) VALUE " ".
005100       03  COLUMN  11  PIC  X(006) VALUE "     ".
005110       03  COLUMN  18  PIC  X(048) VALUE
005120            "                                                ".
005130       03  SU-BIK   COLUMN  71  PIC  X(010) VALUE "          ".
005140     02  SU-D2    LINE W-L2.
005150       03  COLUMN   3  PIC  X(005) VALUE "     ".
005160       03  COLUMN   9  PIC  X(005) VALUE "     ".
005170       03  COLUMN  15  PIC  X(005) VALUE "     ".
005180       03  COLUMN  21  PIC  X(005) VALUE "     ".
005190       03  COLUMN  27  PIC  X(005) VALUE "     ".
005200       03  COLUMN  33  PIC  X(005) VALUE "     ".
005210       03  COLUMN  39  PIC  X(005) VALUE "     ".
005220       03  COLUMN  45  PIC  X(004) VALUE "    ".
005230       03  COLUMN  50  PIC  X(004) VALUE "    ".
005240       03  COLUMN  55  PIC  X(004) VALUE "    ".
005250     02  SU-D3    LINE W-L3.
005260       03  SU-D31.
005270         04  COLUMN   1  PIC  X(001) VALUE " ".
005280         04  COLUMN   3  PIC  X(005) VALUE "     ".
005290         04  COLUMN   9  PIC  X(005) VALUE "     ".
005300         04  COLUMN  15  PIC  X(005) VALUE "     ".
005310         04  COLUMN  21  PIC  X(005) VALUE "     ".
005320         04  COLUMN  27  PIC  X(005) VALUE "     ".
005330         04  COLUMN  33  PIC  X(005) VALUE "     ".
005340         04  COLUMN  39  PIC  X(005) VALUE "     ".
005350         04  COLUMN  45  PIC  X(004) VALUE "    ".
005360         04  COLUMN  50  PIC  X(004) VALUE "    ".
005370         04  COLUMN  55  PIC  X(004) VALUE "    ".
005380       03          COLUMN  60  PIC  X(006) VALUE "      ".
005390       03  SU-BT    COLUMN  67  PIC  X(005) VALUE "     ".
005400       03  SU-KIN   COLUMN  73  PIC  X(008) VALUE "        ".
005410     02  LINE  23.
005420       03  SU-KOSU  COLUMN   6  PIC  X(003) VALUE "   ".
005430       03  SU-HSC   COLUMN  17  PIC  X(001) VALUE " ".
005440       03  SU-FRC   COLUMN  24  PIC  X(001) VALUE " ".
005450*
005460     02  SN-DS    LINE W-L1.
005470       03  COLUMN  01  PIC  X(006) VALUE "      ".
005480       03  COLUMN   8  PIC  X(048) VALUE
005490            "                                                ".
005500       03  COLUMN  57  PIC  X(007) VALUE "       ".
005510       03  COLUMN  65  PIC  X(005) VALUE "     ".
005520       03  COLUMN  71  PIC  X(009) VALUE "         ".
005530 01  C-ERR.
005540     02  LINE  24.
005550       03  E-ME1   COLUMN  15  PIC  X(015) VALUE
005560            "***  TM ﾅｼ  ***".
005570       03  E-ME2   COLUMN  15  PIC  X(016) VALUE
005580            "***  TCM ﾅｼ  ***".
005590       03  E-ME3   COLUMN  15  PIC  X(021) VALUE
005600            "***  PROGRAM ｴﾗｰ  ***".
005610       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
005620            "***  区分エラー  ***".
005630       03  E-ME5   COLUMN  15  PIC  X(020) VALUE
005640            "***  直送エラー ***".
005650       03  E-ME6.                                                 I.020214
005660         04  COLUMN  15  PIC  X(016) VALUE                        I.020214
005670              "***  HIM ﾅｼ  ***".                                 I.020214
005680         04  COLUMN  34  PIC  9(006) FROM  W-HCD.                 I.020214
005690       03  E-ME7.                                                 I.020214
005700         04  COLUMN  15  PIC  X(022) VALUE                        I.020214
005710              "***  振替単価無し  ***".                           I.020214
005720         04  COLUMN  40  PIC  9(006) FROM  W-HCD.                 I.020214
005730*****  03  E-ME6   COLUMN  15  PIC  X(016) VALUE                  D.020214
005740*****       "***  HIM ﾅｼ  ***".                                   D.020214
005750*****  03  E-ME7   COLUMN  15  PIC  X(022) VALUE                  D.020214
005760*****       "***  振替単価無し  ***".                             D.020214
005770       03  E-ME8   COLUMN  15  PIC  X(024) VALUE
005780            "***  預りサイズ無し  ***".
005790       03  E-ME9   COLUMN  15  PIC  X(020) VALUE
005800            "***  サイズ無し  ***".
005810*****  03  E-ME10  COLUMN  15  PIC  X(025) VALUE                  D.070124
005820*****       "***  TAZ-M WRITE ｴﾗｰ  ***".                          D.070124
005830*****  03  E-ME11  COLUMN  15  PIC  X(022) VALUE                  D.070124
005840*****       "***  預りチェック  ***".                             D.070124
005850       03  E-ME12  COLUMN  15  PIC  X(020) VALUE
005860            "***  日付エラー ***".
005870*****  03  E-ME13  COLUMN  15  PIC  X(025) VALUE                  D.010531
005880*****       "***  価格ランクエラー ***".                          D.010531
005890       03  E-ME14  COLUMN  15  PIC  X(025) VALUE
005900            "***  発送明細№ CHECK ***".
005910       03  E-ME15  COLUMN  15  PIC  X(025) VALUE
005920            "***  単価  ZERO CHECK ***".
005930       03  E-ME16  COLUMN  15  PIC  X(025) VALUE
005940            "***  STRAN WRITE ｴﾗｰ  ***".
005950       03  E-ME17  COLUMN  15  PIC  X(027) VALUE
005960            "***  STRAN REWRITE ｴﾗｰ  ***".
005970       03  E-ME19  COLUMN  15  PIC  X(028) VALUE
005980            "***  未更新データ　有り  ***".
005990       03  E-ME20  COLUMN  15  PIC  X(041) VALUE
006000            "伝票未発行データ有り   消す  OK=1 NO=5   ".          I.050226
006010*****       "未更新データ　有り     消す  OK=1 NO=5   ".          D.050226
006020       03  E-ME21  COLUMN  15  PIC  X(017) VALUE
006030            "***  ﾃﾞｰﾀ ﾅｼ  ***".
006040       03  E-ME22  COLUMN  15  PIC  X(027) VALUE
006050            "***  HSMSF REWRITE ｴﾗｰ  ***".
006060       03  E-ME23  COLUMN  15  PIC  X(017) VALUE
006070            "***  HKBM ﾅｼ  ***".
006080       03  E-ME24  COLUMN  15  PIC  X(026) VALUE
006090            "***  HKBM REWRITE ｴﾗｰ  ***".
006100       03  E-ME25.                                                I.000922
006110         04  COLUMN  15  PIC  N(008) VALUE                        I.000922
006120              NC"請求書　発行済み".                               I.000922
006130         04  COLUMN  34  PIC 9999/99/99  FROM  W-SDATE.           I.000922
006140       03  E-ME26  COLUMN  15  PIC  X(024) VALUE                  I.010419
006150            "***  THTM WRITE ｴﾗｰ  ***".                           I.010419
006160       03  E-ME27  COLUMN  15  PIC  X(026) VALUE                  I.010419
006170            "***  THTM REWRITE ｴﾗｰ  ***".                         I.010419
006180       03  E-ME28  COLUMN  15  PIC  X(017) VALUE                  I.020215
006190            "***  HUHM ﾅｼ  ***".                                  I.020215
006200       03  E-ME29  COLUMN  15  PIC  X(030) VALUE                  I.020215
006210            "***  マスター　単価エラー  ***".                     I.020215
006220       03  E-ME30  COLUMN  15  PIC  X(030) VALUE                  I.050706
006230            "***  データが入っていない  ***".                     I.050706
006240       03  E-ME90  COLUMN  15  PIC  X(021) VALUE
006250            "---   キャンセル  ---".
006260       03  MG-03   COLUMN  15  PIC  X(024) VALUE
006270            "***  ｺﾝﾄﾛｰﾙＦ未登録  ***".
006280       03  MG-05   COLUMN  15  PIC  X(022) VALUE
006290            "***  倉庫省略不可  ***".
006300     COPY LSSEM.
006310     COPY LIBSCR.
006320 PROCEDURE DIVISION.
006330 M-05.
006340     COPY LIBCPR.
006350     MOVE ZERO TO W-CNG.
006360     MOVE D-NHNG TO W-CNGS.
006370     IF W-CN2 >= DATE-NF1 AND <= DATE-NT1
006380         ADD DATE-NC1 TO W-CN.
006390     IF W-CN2 >= DATE-NF2 AND <= DATE-NT2
006400         ADD DATE-NC2 TO W-CN.
006410*
006420     DISPLAY C-CLEAR.
006430     DISPLAY C-MID.
006440*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN.                       D.000922
006450*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN TSKF.                  D.010419
006460*****OPEN INPUT T-M HI-M TC-M JCON TSKF.                          D.020215
006470     OPEN INPUT T-M HI-M TC-M JCON TSKF HUH-M.                    I.020215
006480     OPEN INPUT OTHTM.                                            I.110407
006490*****OPEN I-O TAZ-M.                                              D.070124
006500     OPEN I-O HSMSF.
006510     OPEN I-O THTM.                                               I.010419
006520     OPEN INPUT S-TRAN.
006530     READ S-TRAN AT END
006540         GO TO M-20.
006550 M-10.
006560     IF S-DHC NOT = 0
006570         DISPLAY E-ME19 E-ME99
006580         MOVE 255 TO COMPLETION-CODE
006590         GO TO M-95.
006600     READ S-TRAN AT END
006610         DISPLAY E-ME20 E-ME99
006620         GO TO M-15.
006630     GO TO M-10.
006640 M-15.
006650     ACCEPT A-CHK.
006660     IF ESTAT NOT = HTB AND SKP
006670         GO TO M-15.
006680     IF CHK = 1
006690         GO TO M-20.
006700     IF CHK = 5
006710         MOVE 255 TO COMPLETION-CODE
006720         GO TO M-95.
006730     GO TO M-15.
006740 M-20.
006750     CLOSE S-TRAN.
006760     OPEN INPUT HKBM.
006770     MOVE SPACE TO HKB-KEY.
006780     MOVE "05" TO HKB-NO.
006790     READ HKBM WITH UNLOCK INVALID KEY
006800         CLOSE HKBM
006810         DISPLAY E-ME78 E-ME23 E-ME99
006820         MOVE 255 TO COMPLETION-CODE
006830         GO TO M-95.
006840     MOVE HKB-UNN TO W-DNOD W-DNOO.
006850     CLOSE HKBM.
006860     OPEN OUTPUT S-TRAN.
006870 M-25.
006880     ACCEPT A-UNC.
006890     IF ESTAT = C2 OR PF9
006900         GO TO M-95.
006910     IF ESTAT NOT = HTB AND SKP
006920         GO TO M-25.
006930*
006940     MOVE ZERO TO W-NGP.
006950     IF W-UNCD > 1
006960         GO TO M-25.
006970 M-30.
006980     IF W-UNCD = 1
006990         GO TO M-35.
007000*
007010     PERFORM UAC-RTN THRU UAC-EX.
007020     IF ESTAT = BTB
007030         DISPLAY C-CLEAR
007040         DISPLAY C-MID
007050         GO TO M-25.
007060     IF W-END NOT = 0
007070         GO TO M-95.
007080     GO TO M-80.
007090 M-35.
007100     PERFORM NAC-RTN THRU NAC-EX.
007110     IF ESTAT = BTB
007120         DISPLAY C-CLEAR
007130         DISPLAY C-MID
007140         GO TO M-25.
007150     IF W-END NOT = 0
007160         GO TO M-95.
007170 M-80.
007180     PERFORM UPD-RTN THRU UPD-EX.
007190     IF W-END = 0
007200         GO TO M-30.
007210 M-95.
007220*****CLOSE T-M HI-M TC-M JCON JT-THTN.                            D.000922
007230*****CLOSE T-M HI-M TC-M JCON JT-THTN TSKF.                       D.010419
007240*****CLOSE T-M HI-M TC-M JCON TSKF.                               D.020215
007250     CLOSE T-M HI-M TC-M JCON TSKF HUH-M.                         I.020215
007260*****CLOSE TAZ-M.                                                 D.070124
007270     CLOSE HSMSF.
007280     CLOSE OTHTM.                                                 I.110407
007290     CLOSE THTM.                                                  I.010419
007300     CLOSE S-TRAN.
007310     DISPLAY C-CLEAR.
007320     STOP RUN.
007330*----------  出荷　入力  -------------------------------------------------
007340 UAC-RTN.
007350     IF W-NGP NOT = ZERO
007360         GO TO UAC-040.
007370     MOVE ZERO TO W-TCDD W-CSCD W-HNOD.
007380     MOVE ZERO TO W-NGP.
007390     MOVE DATE-02R TO W-NGPS.
007400 UAC-020.
007410     CALL "SCHD01".
007420     DISPLAY AU-NGP.
007430     ACCEPT AU-NGP.
007440     DISPLAY E-CL.
007450     IF ESTAT = C2 OR PF9
007460         MOVE 1 TO W-END
007470         GO TO UAC-EX.
007480     IF ESTAT = BTB
007490         GO TO UAC-EX.
007500     IF ESTAT NOT = HTB AND SKP
007510         GO TO UAC-020.
007520     IF W-NGPS = ZERO
007530         MOVE DATE-02R TO W-NGPS
007540         DISPLAY AU-NGP.
007550 UAC-040.
007560     CALL "SCHD01".
007570     DISPLAY AU-NGP.
007580     MOVE ZERO TO W-ND1.
007590     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
007600         ADD DATE-NC1 TO W-ND.
007610     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
007620         ADD DATE-NC2 TO W-ND.
007630     IF W-NGD NOT = W-CNG
007640         DISPLAY E-ME12 E-ME98
007650         GO TO UAC-020.
007660     IF W-PD < 1 OR > 31
007670         GO TO UAC-020.
007680     MOVE ZERO TO W-HNOD W-HNC W-CSCD.
007690 UAC-060.
007700     ACCEPT AU-HMN.
007710     DISPLAY E-CL.
007720     IF ESTAT = BTB
007730         GO TO UAC-020.
007740     IF ESTAT NOT = HTB AND SKP
007750         GO TO UAC-060.
007760     IF W-HMN = ZERO
007770         DISPLAY SU-HMN
007780         GO TO UAC-080.
007790     MOVE SPACE TO HSMS-KEY.
007800     MOVE W-HMN TO HSMS-01.
007810     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
007820         DISPLAY E-ME21 E-ME98
007830         MOVE 1 TO W-HNC                                          I.081222
007840         MOVE W-HMN TO W-HNOD                                     I.081222
007850         GO TO UAC-080.                                           I.081222
007860*****    GO TO UAC-060.                                           D.081222
007870     READ HSMSF NEXT RECORD AT END
007880         DISPLAY E-ME21 E-ME98
007890         MOVE 1 TO W-HNC                                          I.081222
007900         MOVE W-HMN TO W-HNOD                                     I.081222
007910         GO TO UAC-080.                                           I.081222
007920*****    GO TO UAC-060.                                           D.081222
007930     IF W-HMN NOT = HSMS-01
007940         DISPLAY E-ME21 E-ME98
007950         MOVE 1 TO W-HNC                                          I.081222
007960         MOVE W-HMN TO W-HNOD                                     I.081222
007970         GO TO UAC-080.                                           I.081222
007980*****    GO TO UAC-060.                                           D.081222
007990     IF HSMS-02 = 7
008000         DISPLAY E-ME21 E-ME98
008010         GO TO UAC-060.
008020     PERFORM HMN-RTN THRU HMN-EX.
008030     IF W-INV = 1                                                 I.001031
008040         GO TO UAC-060.                                           I.001031
008050     IF W-EC NOT = 0                                              I.020215
008060         MOVE 0 TO W-EC                                           I.020215
008070         GO TO UAC-060.                                           I.001031
008080     IF T-BC NOT = ZERO                                           I.001031
008090         DISPLAY E-ME1 E-ME98                                     I.001031
008100         GO TO UAC-060.                                           I.001031
008110*****IF T-KL < 1 OR > 5                                           D.010419
008120*****    DISPLAY E-ME13 E-ME98                                    D.010419
008130*****    GO TO UAC-060.                                           D.010419
008140     MOVE 1 TO W-DSPC.                                            I.020404
008150     PERFORM DSP-RTN THRU DSP-EX.
008160     MOVE 0 TO W-RC.                                              I.020214
008170     MOVE 1 TO W-L1.                                              I.020214
008180     MOVE 2 TO W-L2.                                              I.020214
008190     MOVE 3 TO W-L3.                                              I.020214
008200 UAC-070.                                                         I.020214
008210     ADD 1 TO W-RC.                                               I.020214
008220     ADD 3 TO W-L1 W-L2 W-L3.                                     I.020214
008230     IF W-RC > 6                                                  I.020214
008240         GO TO UAC-800.                                           I.020214
008250     MOVE W-AS(W-RC) TO W-SR.                                     I.020214
008260     IF W-GNO = 0                                                 I.020404
008270         GO TO UAC-360.                                           I.020404
008280*****IF W-GNO NOT = 0                                             D.020404
008290     IF W-RCB = ZERO                                              I.020404
008300         GO TO UAC-070.                                           I.020214
008310     IF W-RC NOT = W-RCB                                          I.020404
008320         GO TO UAC-070.                                           I.020404
008330     MOVE W-RCB TO W-RC.                                          I.020404
008340     MOVE W-LB TO W-L.                                            I.020404
008350     GO TO UAC-360.                                               I.020214
008360 UAC-080.
008370     MOVE W-SCD TO WK-SCD.
008380     ACCEPT AU-SOK.
008390     DISPLAY E-CL.
008400     IF ESTAT = BTB
008410         GO TO UAC-060.
008420     IF W-HMN NOT = ZERO
008430         IF W-HNC = 0                                             I.081222
008440             IF ESTAT = ADV
008450                 MOVE WK-SCD TO W-SCD
008460                 MOVE 1 TO W-ADV
008470                 GO TO UAC-090.
008480     IF ESTAT NOT = HTB AND SKP
008490         GO TO UAC-080.
008500 UAC-090.
008510     IF W-SCD = ZERO
008520         MOVE W-SCD TO W-SOK
008530         DISPLAY SU-SOK
008540         GO TO UAC-100.
008550     MOVE 3 TO JCON3-01.
008560     MOVE W-SCD TO JCON3-02.
008570     READ JCON UNLOCK INVALID
008580         MOVE  SPACE TO JCON3-03
008590         DISPLAY DU-SNA MG-03 E-ME98
008600         GO TO UAC-080.
008610     MOVE W-SCD TO W-SOK.
008620     DISPLAY AU-SOK DU-SNA.
008630 UAC-100.
008640     IF W-HMN NOT = ZERO
008650         IF W-HNC = 0                                             I.081222
008660             IF ESTAT = ADV
008670                 GO TO UAC-280.
008680 UAC-120.
008690     ACCEPT AU-TCD.
008700     DISPLAY E-CL.
008710     IF ESTAT = BTB
008720         GO TO UAC-080.
008730     IF ESTAT NOT = HTB AND SKP
008740         GO TO UAC-120.
008750     PERFORM TM-RTN THRU TM-EX.
008760     IF W-INV = 1
008770         DISPLAY E-ME1 E-ME98
008780         GO TO UAC-120.
008790     IF T-BC NOT = ZERO
008800         DISPLAY E-ME1 E-ME98
008810         GO TO UAC-120.
008820*****IF T-KL < 1 OR > 5                                           D.010531
008830*****    DISPLAY E-ME13 E-ME98                                    D.010531
008840*****    GO TO UAC-120.                                           D.010531
008850*UAC-140.                                                         D.081222
008860*****ACCEPT AU-HN1.                                               D.081222
008870*****IF ESTAT = BTB                                               D.081222
008880*****    GO TO UAC-080.                                           D.081222
008890*****IF ESTAT NOT = HTB AND SKP                                   D.081222
008900*****    GO TO UAC-140.                                           D.081222
008910*****IF W-HN1 = ZERO                                              D.081222
008920*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
008930*****    DISPLAY SU-HN1 SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6        D.081222
008940*****    GO TO UAC-260.                                           D.081222
008950*UAC-160.                                                         D.081222
008960*****ACCEPT AU-HN2.                                               D.081222
008970*****IF ESTAT = BTB                                               D.081222
008980*****    GO TO UAC-140.                                           D.081222
008990*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009000*****    GO TO UAC-160.                                           D.081222
009010*****IF ESTAT = ADV                                               D.081222
009020*****    COMPUTE W-HN2 = W-HN1 + 1                                D.081222
009030*****    DISPLAY AU-HN2.                                          D.081222
009040*****IF W-HN2 = ZERO                                              D.081222
009050*****    MOVE 1 TO W-HNC                                          D.081222
009060*****    MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                     D.081222
009070*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6               D.081222
009080*****    GO TO UAC-260.                                           D.081222
009090*UAC-180.                                                         D.081222
009100*****ACCEPT AU-HN3.                                               D.081222
009110*****IF ESTAT = BTB                                               D.081222
009120*****    GO TO UAC-160.                                           D.081222
009130*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009140*****    GO TO UAC-180.                                           D.081222
009150*****IF ESTAT = ADV                                               D.081222
009160*****    COMPUTE W-HN3 = W-HN2 + 1                                D.081222
009170*****    DISPLAY AU-HN3.                                          D.081222
009180*****IF W-HN3 = ZERO                                              D.081222
009190*****    MOVE 2 TO W-HNC                                          D.081222
009200*****    MOVE ZERO TO W-HN4 W-HN5 W-HN6                           D.081222
009210*****    DISPLAY SU-HN3 SU-HN4 SU-HN5 SU-HN6                      D.081222
009220*****    GO TO UAC-260.                                           D.081222
009230*UAC-200.                                                         D.081222
009240*****ACCEPT AU-HN4.                                               D.081222
009250*****IF ESTAT = BTB                                               D.081222
009260*****    GO TO UAC-180.                                           D.081222
009270*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009280*****    GO TO UAC-200.                                           D.081222
009290*****IF ESTAT = ADV                                               D.081222
009300*****    COMPUTE W-HN4 = W-HN3 + 1                                D.081222
009310*****    DISPLAY AU-HN4.                                          D.081222
009320*****IF W-HN4 = ZERO                                              D.081222
009330*****    MOVE 3 TO W-HNC                                          D.081222
009340*****    MOVE ZERO TO W-HN5 W-HN6                                 D.081222
009350*****    DISPLAY SU-HN4 SU-HN5 SU-HN6                             D.081222
009360*****    GO TO UAC-260.                                           D.081222
009370*UAC-220.                                                         D.081222
009380*****ACCEPT AU-HN5.                                               D.081222
009390*****IF ESTAT = BTB                                               D.081222
009400*****    GO TO UAC-200.                                           D.081222
009410*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009420*****    GO TO UAC-220.                                           D.081222
009430*****IF ESTAT = ADV                                               D.081222
009440*****    COMPUTE W-HN5 = W-HN4 + 1                                D.081222
009450*****    DISPLAY AU-HN5.                                          D.081222
009460*****IF W-HN5 = ZERO                                              D.081222
009470*****    MOVE 4 TO W-HNC                                          D.081222
009480*****    MOVE ZERO TO W-HN6                                       D.081222
009490*****    DISPLAY SU-HN5 SU-HN6                                    D.081222
009500*****    GO TO UAC-260.                                           D.081222
009510*UAC-240.                                                         D.081222
009520*****ACCEPT AU-HN6.                                               D.081222
009530*****IF ESTAT = BTB                                               D.081222
009540*****    GO TO UAC-220.                                           D.081222
009550*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009560*****    GO TO UAC-240.                                           D.081222
009570*****IF ESTAT = ADV                                               D.081222
009580*****    COMPUTE W-HN6 = W-HN5 + 1                                D.081222
009590*****    DISPLAY AU-HN6.                                          D.081222
009600*****IF W-HN6 = ZERO                                              D.081222
009610*****    MOVE 5 TO W-HNC                                          D.081222
009620*****    DISPLAY SU-HN6                                           D.081222
009630*****  ELSE                                                       D.081222
009640*****    MOVE 6 TO W-HNC.                                         D.081222
009650 UAC-260.
009660     ACCEPT AU-CCD.
009670     DISPLAY E-CL.
009680     IF ESTAT = BTB
009690         GO TO UAC-120.                                           I.081222
009700*****    IF W-HNC > 4                                             D.081222
009710*****        GO TO UAC-240.                                       D.081222
009720*****IF ESTAT = BTB                                               D.081222
009730*****    IF W-HNC = 4                                             D.081222
009740*****        GO TO UAC-220.                                       D.081222
009750*****IF ESTAT = BTB                                               D.081222
009760*****    IF W-HNC = 3                                             D.081222
009770*****        GO TO UAC-200.                                       D.081222
009780*****IF ESTAT = BTB                                               D.081222
009790*****    IF W-HNC = 2                                             D.081222
009800*****        GO TO UAC-180.                                       D.081222
009810*****IF ESTAT = BTB                                               D.081222
009820*****    IF W-HNC = 1                                             D.081222
009830*****        GO TO UAC-160.                                       D.081222
009840*****IF ESTAT = BTB                                               D.081222
009850*****    GO TO UAC-140.                                           D.081222
009860     IF ESTAT NOT = HTB AND SKP
009870         GO TO UAC-260.
009880     PERFORM TCM-RTN THRU TCM-EX.
009890     IF W-INV = 1
009900         DISPLAY E-ME2 E-ME98
009910         GO TO UAC-260.
009920     IF W-INV = 9
009930         DISPLAY E-ME3 E-ME99
009940         MOVE 1 TO W-END
009950         GO TO UAC-EX.
009960 UAC-280.
009970     DISPLAY AU-CSC.
009980     IF W-CSCD = ZERO
009990         GO TO UAC-320.
010000 UAC-300.
010010     ACCEPT AU-CSC.
010020     IF ESTAT = BTB
010030         GO TO UAC-260.
010040     IF ESTAT NOT = HTB AND SKP
010050         GO TO UAC-300.
010060     IF W-CSCD NOT = 0 AND 9
010070         GO TO UAC-300.
010080 UAC-320.
010090     MOVE 1 TO W-L1.
010100     MOVE 2 TO W-L2.
010110     MOVE 3 TO W-L3.
010120     MOVE ZERO TO W-RC W-DCD W-ZC.                                I.131228
010130*****IF W-CNGS < 1404                                             D.140328
010140*****    MOVE 5 TO W-HSCD                                         D.141328
010150*****  ELSE                                                       D.141328
010160     MOVE 8 TO W-HSCD.                                            I.131228
010170*****MOVE ZERO TO W-RC W-DCD W-ZC W-HSCD.                         D.131228
010180*****IF W-HMN = ZERO                                              D.081222
010190     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
010200         INITIALIZE W-ASR W-BR
010210         MOVE ALL NX"2121" TO W-BI.
010220 UAC-340.
010230     MOVE 0 TO W-DEL.
010240     ADD 1 TO W-RC.
010250     ADD 3 TO W-L1 W-L2 W-L3.
010260     IF W-RC > 6
010270         GO TO UAC-760.
010280     IF W-RC = 2
010290         IF W-DC = 8
010300             MOVE 5 TO W-ZC.
010310     IF W-ZC = 5
010320         GO TO UAC-420.
010330 UAC-360.
010340     MOVE W-AS(W-RC) TO W-SR.
010350     MOVE W-SCD TO W-SOK.
010360     MOVE W-NGP TO W-DATE.
010370     MOVE W-TCDN TO W-TCD.
010380     MOVE W-TCDD TO W-TCD2.
010390     MOVE W-CSCD TO W-CSC.
010400     MOVE T-TNC TO W-TC2.
010410     MOVE T-FKC TO W-FKC.
010420     MOVE W-CCDD TO W-CCD.
010430 UAC-380.
010440     IF W-DEL = 9
010450         MOVE 0 TO W-DEL
010460         GO TO UAC-400.
010470     IF W-HMN NOT = ZERO
010480         IF W-HNC = 0                                             I.081222
010490             IF W-HCD NOT = ZERO
010500                 GO TO UAC-400.
010510     MOVE W-DCD TO W-DC.
010520     DISPLAY AU-DC.
010530 UAC-400.
010540     MOVE W-DC TO WK-DC.
010550     MOVE 0 TO W-ADV.
010560     ACCEPT AU-DC.
010570     DISPLAY E-CL.
010580     IF ESTAT = PF21
010590         MOVE W-RC TO W-RCD
010600         MOVE W-L TO W-LD
010610         GO TO UAC-430.
010620*****IF ESTAT = C1                                                D.001205
010630     IF ESTAT = C1 OR PF6                                         I.001205
010640         MOVE 5 TO W-ZC
010650         GO TO UAC-420.
010660*****IF ESTAT = FUK                                               D.081222
010670*****    GO TO UAC-760.                                           D.081222
010680     IF ESTAT = ADV
010690         IF W-HCD NOT = ZERO
010700             MOVE WK-DC TO W-DC
010710             DISPLAY AU-DC
010720             MOVE 1 TO W-ADV
010730             GO TO UAC-440.
010740     IF ESTAT NOT = BTB
010750         GO TO UAC-440.
010760*****IF W-HMN = ZERO                                              D.081222
010770     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
010780         IF W-GNO = ZERO
010790             MOVE ZERO TO W-SR
010800                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
010810                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
010820             MOVE W-SR TO W-AS(W-RC)
010830             DISPLAY SU-D1 SU-D2 SU-D3.
010840 UAC-410.
010850     SUBTRACT 1 FROM W-RC.
010860     SUBTRACT 3 FROM W-L1 W-L2 W-L3.
010870     IF W-RC = ZERO
010880         GO TO UAC-300.
010890     MOVE W-AS(W-RC) TO W-SR.
010900     IF W-GNO = ZERO
010910         GO TO UAC-410.
010920     GO TO UAC-400.
010930 UAC-420.
010940     IF W-RC = 1
010950*****    MOVE ZERO TO W-HCD W-SIZ W-SUS W-SUT W-BT W-KIN W-DC     D.000822
010960         MOVE ZERO TO W-HCD W-SIZ W-SUT W-BT W-KIN W-DC           I.000822
010970                      W-FT W-BC1 W-BC2 W-BC3 W-SOK
010980                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
010990                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
011000         MOVE SPACE TO W-BIK
011010         MOVE W-RC TO W-GNO
011020         MOVE W-SR TO W-AS(W-RC)
011030         DISPLAY SU-D1 SU-D2 SU-D3
011040         GO TO UAC-340.
011050     MOVE ZERO TO W-SR.
011060     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
011070                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
011080     MOVE SPACE TO W-BIK.
011090     MOVE W-SR TO W-AS(W-RC).
011100     DISPLAY SU-D1 SU-D2 SU-D3.
011110     GO TO UAC-340.
011120 UAC-430.
011130     IF W-RC NOT = 6
011140         COMPUTE CNT = W-RC + 1
011150         MOVE W-AS(CNT) TO W-AS(W-RC)
011160         ADD 1 TO W-RC
011170         GO TO UAC-430.
011180     MOVE ZERO TO W-AS(W-RC).
011190     MOVE 0 TO W-DSPC.                                            I.020404
011200     PERFORM DSP-RTN THRU DSP-EX.
011210     MOVE W-RCD TO W-RC.
011220     MOVE W-LD TO W-L.
011230     MOVE 9 TO W-DEL.
011240     GO TO UAC-360.
011250 UAC-440.
011260     IF ESTAT NOT = HTB AND SKP AND ADV
011270         GO TO UAC-380.
011280     IF W-CSCD = 9                                                I.131227
011290         IF W-DC NOT = 8                                          I.131227
011300             GO TO UAC-380.                                       I.070126
011310     IF W-DC = 8                                                  I.131227
011320         IF W-CSCD NOT = 9                                        I.131227
011330             GO TO UAC-380.                                       I.070126
011340     IF W-DC = 6 OR 9                                             I.070126
011350         GO TO UAC-380.                                           I.070126
011360     IF W-DC NOT = 2 AND 3 AND 6 AND 8 AND 9
011370         IF W-SOK = 0
011380             DISPLAY MG-05 E-ME98
011390             GO  TO  UAC-380.
011400     IF W-RC NOT = 1
011410         IF W-DC = 8
011420             DISPLAY E-ME4 E-ME98
011430             GO TO UAC-380.
011440     IF W-CCDD NOT = ZERO
011450         IF W-DC = 3 OR  9
011460             DISPLAY E-ME4 E-ME98
011470             GO TO UAC-380.
011480     IF W-CSC = 9
011490         IF W-DC = 4
011500             DISPLAY E-ME4 E-ME98
011510             GO TO UAC-380.
011520     IF W-RC NOT = 1
011530         GO TO UAC-450.
011540     IF W-DC = 1 OR 2                                             I.010327
011550         MOVE ZERO TO W-HNOD W-HNC.                               I.020214
011560*****    MOVE ZERO TO W-HNOD W-HNC                                D.020214
011570*****    DISPLAY SU-HMN.                                          D.020214
011580     MOVE W-DC TO W-DCD.
011590     IF W-DC = 4  OR  7
011600         MOVE ZERO TO W-DCD.
011610 UAC-450.
011620     MOVE W-DC TO W-DCC.
011630     IF W-DC = 4  OR  7
011640         MOVE ZERO TO W-DCC.
011650     IF W-DCD NOT = W-DCC
011660         DISPLAY E-ME4 E-ME98
011670         GO TO UAC-380.
011680     IF W-DC = 8
011690         DISPLAY SU-D2 SU-D3
011700*****    MOVE ZERO TO W-ZD1 W-ZD2 W-FT W-HSC                      D.131228
011710         MOVE ZERO TO W-ZD1 W-ZD2 W-FT                            I.131228
011720                     W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05) I.000822
011730                     W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10) I.000822
011740         DISPLAY DU-SZM
011750*****    IF W-CNGS < 1404                                         D.140328
011760*****        MOVE 5 TO W-HSC                                      D.140328
011770*****        GO TO UAC-700                                        D.140328
011780*****      ELSE                                                   D.140328
011790         MOVE 8 TO W-HSC                                          I.131228
011800         GO TO UAC-700.
011810     MOVE W-HCD TO W-HCDO.                                        I.010419
011820 UAC-480.
011830     IF W-ADV NOT = 0
011840         GO TO UAC-490.
011850     ACCEPT AU-HCD.
011860     DISPLAY E-CL.
011870     IF ESTAT = BTB
011880         GO TO UAC-400.
011890*****IF ESTAT = C1                                                D.001205
011900     IF ESTAT = C1 OR PF6                                         I.001205
011910         MOVE 5 TO W-ZC
011920         GO TO UAC-420.
011930*****IF ESTAT = FUK                                               D.081222
011940*****    GO TO UAC-760.                                           D.081222
011950     IF ESTAT NOT = HTB AND SKP
011960         GO TO UAC-480.
011970     IF W-HCD = ZERO
011980         MOVE W-HCDD TO W-HCD.
011990     IF W-HCD NOT = W-HCDO                                        I.010419
012000         MOVE ZERO TO W-BT.                                       I.010449
012010 UAC-490.
012020     MOVE 0 TO W-HIC.                                             I.020214
012030     PERFORM HI-RTN THRU HI-EX.
012040     IF W-EC NOT = ZERO
012050         MOVE 0 TO W-EC W-ADV
012060         GO TO UAC-480.
012070     IF W-DC = 3 OR 4 OR 9
012080        IF HI-S4(10) NOT = 1
012090            DISPLAY E-ME8 E-ME98
012100            MOVE 0 TO W-ADV
012110            GO  TO    UAC-480.
012120     IF W-HCD > 999899
012130*****    MOVE ZERO TO W-SIZ W-SUS W-FT                            D.000822
012140         MOVE ZERO TO W-SIZ W-FT                                  I.000822
012150                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
012160                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
012170         DISPLAY SU-D2 SU-D31
012180         GO TO UAC-520.
012190     IF W-DC NOT = 3 AND 9
012200         GO TO UAC-550.
012210*****MOVE ZERO TO W-SIZ W-SUS.                                    D.000822
012220     MOVE ZERO TO W-SIZ                                           I.000822
012230                  W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
012240                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
012250     DISPLAY SU-D2 SU-D31.
012260 UAC-520.
012270     IF W-ADV NOT = 0
012280         GO TO UAC-540.
012290     ACCEPT AU-SUT.
012300     DISPLAY E-CL.
012310     IF ESTAT = BTB
012320         MOVE 0 TO W-ADV
012330         MOVE W-HCD TO W-HCDO                                     I.010419
012340         GO TO UAC-480.
012350     IF ESTAT NOT = HTB AND SKP
012360         GO TO UAC-520.
012370     IF W-HCD < 999900
012380         MOVE HI-FT TO W-FT.
012390 UAC-540.
012400*****IF W-BT NOT = ZERO                                           D.020401
012410     IF W-BT = ZERO                                               I.020401
012420         PERFORM TAN-RTN THRU TAN-EX.                             I.010419
012430*****IF WK-TAN   NOT = ZERO                                       D.010419
012440*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
012450*****    MOVE  WK-TAN  TO  W-BT                                   D.010419
012460*****    GO  TO  UAC-660.                                         D.010419
012470*****IF HI-SS4 NOT = ZERO                                         D.010419
012480*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
012490*****    GO TO UAC-660.                                           D.010419
012500*****IF HI-SS3 NOT = ZERO                                         D.010419
012510*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
012520*****    GO TO UAC-660.                                           D.010419
012530*****IF HI-SS2 NOT = ZERO                                         D.010419
012540*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
012550*****    GO TO UAC-660.                                           D.010419
012560*****MOVE HI-U1(T-KL) TO W-BT.                                    D.010419
012570     GO TO UAC-660.
012580 UAC-550.
012590*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
012600*****IF W-DC NOT = 0                                              D.050805
012610*****    GO TO UAC-555.                                           D.050805
012620*****MOVE W-TCD TO TAZ-TCD.                                       D.050805
012630*****MOVE W-HCD TO TAZ-HCD.                                       D.050805
012640*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.050805
012650*****    GO TO UAC-555.                                           D.050805
012660*****DISPLAY E-ME11 E-ME99.                                       D.050805
012670*UAC-555.                                                         D.050805
012680     IF W-ADV NOT = 0
012690         GO TO UAC-570.
012700 UAC-560.                                                         I.050420
012710     ACCEPT AU-SIZ.
012720     DISPLAY E-CL.
012730     IF ESTAT = BTB
012740         MOVE 0 TO W-ADV
012750         GO TO UAC-440.
012760 UAC-570.
012770     IF W-SIZ < 1 OR > 4
012780         MOVE 0 TO W-ADV
012790         GO TO UAC-560.                                           I.050420
012800*****    GO TO UAC-550.                                           D.050420
012810     MOVE HI-FT TO W-FT.
012820     IF W-SIZ = 1
012830*****    MOVE HI-U1(T-KL) TO W-BT                                 D.010419
012840         DISPLAY DU-S1
012850         MOVE HI-SS1 TO W-ASD.
012860     IF W-SIZ = 2
012870*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
012880         DISPLAY DU-S2
012890         MOVE HI-SS2 TO W-ASD.
012900     IF W-SIZ = 3
012910*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
012920         DISPLAY DU-S3
012930         MOVE HI-SS3 TO W-ASD.
012940     IF W-SIZ = 4
012950*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
012960         DISPLAY DU-S4
012970         MOVE HI-SS4 TO W-ASD.
012980     IF W-ASD = ZERO OR SPACE
012990         MOVE 0 TO W-ADV
013000         DISPLAY E-ME9 E-ME98
013010         GO TO UAC-560.                                           I.050420
013020*****    GO TO UAC-550.                                           D.050420
013030     IF W-SIZ = 4
013040         IF W-ASD = "0000000001"
013050             MOVE 0 TO W-ADV
013060             DISPLAY E-ME9 E-ME98
013070             GO TO UAC-560.                                       I.050420
013080*****        GO TO UAC-550.                                       D.050420
013090     IF W-DC = 2 OR 6
013100         MOVE ZERO TO W-FT.
013110     IF W-BT = ZERO                                               I.010419
013120         PERFORM TAN-RTN THRU TAN-EX.
013130*****IF WK-TAN   NOT = ZERO                                       D.010419
013140*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
013150     MOVE ZERO TO W-SC W-ZC.
013160     MOVE -3 TO W-C.
013170 UAC-580.
013180     ADD 1 TO W-SC.
013190     IF W-SC > 8
013200         ADD 5 TO W-C
013210       ELSE
013220         ADD 6 TO W-C.
013230     IF W-SC = 11
013240         MOVE ZERO TO W-SC W-SUT
013250         GO TO UAC-630.
013260     IF (W-SD(W-SC) = ZERO) OR (W-ZC = 5)
013270         MOVE ZERO TO W-SU(W-SC)
013280         GO TO UAC-610.
013290     IF W-SC = 10
013300         IF W-SIZ = 4
013310             MOVE ZERO TO W-SU(W-SC)
013320             GO TO UAC-580.
013330 UAC-600.
013340     IF W-ADV NOT = 0
013350         GO TO UAC-610.
013360     IF W-SC > 7
013370         ACCEPT AU-SU1
013380       ELSE
013390         ACCEPT AU-SU.
013400     IF ESTAT = BTB
013410         MOVE 0 TO W-ADV
013420         GO TO UAC-620.
013430*****IF ESTAT = C1                                                D.001205
013440     IF ESTAT = C1 OR PF6                                         I.001205
013450         MOVE 5 TO W-ZC
013460         MOVE ZERO TO W-SU(W-SC)
013470         MOVE 0 TO W-ADV
013480         GO TO UAC-610.
013490*****IF ESTAT = FUK                                               D.081222
013500*****    MOVE ZERO TO W-SC W-SUT                                  D.081222
013510*****    GO TO UAC-630.                                           D.081222
013520     IF ESTAT NOT = HTB AND SKP
013530         MOVE 0 TO W-ADV
013540         GO TO UAC-600.
013550     IF W-SC > 7
013560         IF W-SU(W-SC) > 999 OR < -999
013570             GO TO UAC-600.
013580 UAC-610.
013590     IF W-SC < 8
013600         DISPLAY DU-SU
013610       ELSE
013620         DISPLAY DU-SU1.
013630     GO TO UAC-580.
013640 UAC-620.
013650     IF W-ADV NOT = ZERO
013660         MOVE 0 TO W-ADV.
013670     SUBTRACT 1 FROM W-SC.
013680     IF W-SC > 7
013690         SUBTRACT 5 FROM W-C
013700       ELSE
013710         SUBTRACT 6 FROM W-C.
013720     IF W-SC = ZERO
013730         GO TO UAC-560.                                           I.050420
013740*****    GO TO UAC-550.                                           D.050420
013750     IF W-SD(W-SC) = ZERO
013760         GO TO UAC-620.
013770     IF W-SC = 10
013780         IF W-SIZ = 4
013790             GO TO UAC-620.
013800     GO TO UAC-600.
013810 UAC-630.
013820     ADD 1 TO W-SC.
013830     IF W-SC < 11
013840         ADD W-SU(W-SC) TO W-SUT
013850         GO TO UAC-630.
013860     MOVE ZERO TO W-ZC.
013870     IF W-SUT = ZERO
013880         MOVE ZERO TO W-SC
013890         MOVE -3 TO W-C
013900         MOVE 0 TO W-ADV
013910         GO TO UAC-580.
013920 UAC-660.
013930     DISPLAY DU-SUT DU-BT.
013940     IF W-DC = 7
013950         MOVE ZERO TO W-BT W-KIN
013960         DISPLAY SU-BT SU-KIN
013970         GO TO UAC-720.
013980     IF W-DC = 4
013990         COMPUTE W-KIN = W-SUT * W-BT
014000         MOVE ZERO TO W-FT
014010         DISPLAY SU-KIN SU-BT
014020         GO TO UAC-720.
014030     ACCEPT AU-BT.
014040     DISPLAY E-CL.
014050     IF ESTAT NOT = BTB
014060         GO TO UAC-670.
014070     MOVE 0 TO W-ADV.
014080     IF W-HCD > 999899
014090         GO TO UAC-520.
014100     IF W-DC = 3 OR 9
014110         GO TO UAC-520.
014120     MOVE 11 TO W-SC.
014130     MOVE 60 TO W-C.
014140     GO TO UAC-620.
014150 UAC-670.
014160*****IF ESTAT NOT = HTB AND SKP                                   D.110407
014170     IF ESTAT NOT = HTB AND SKP AND PF4                           I.110407
014180         GO TO UAC-660.
014190     IF ESTAT = PF4                                               I.110407
014200         PERFORM TAO-RTN THRU TAO-EX.                             I.110407
014210     DISPLAY DU-BT.
014220     IF W-HCD < 999900
014230         IF W-BT = ZERO
014240*****        IF W-DC = 2                                          D.130703
014250             DISPLAY E-ME15 E-ME99                                I.070403
014260             DISPLAY E-CL.                                        I.130703
014270*****            DISPLAY E-CL                                     D.130703
014280*****          ELSE                                               D.130703
014290*****            GO TO UAC-660.                                   D.130703
014300     IF W-HCD > 999899
014310         IF W-BT = ZERO
014320             DISPLAY E-ME15 E-ME99
014330             DISPLAY E-CL.
014340     COMPUTE W-KIN = W-SUT * W-BT.
014350     DISPLAY DU-KIN.
014360     IF W-KIN = ZERO
014370         IF W-HCD > 999899
014380             GO TO UAC-700.
014390     GO TO UAC-720.
014400 UAC-700.
014410     ACCEPT AU-KIN.
014420     DISPLAY E-CL.
014430     IF ESTAT = BTB
014440         IF W-HCD > 999899
014450             GO  TO  UAC-660
014460           ELSE
014470             GO TO UAC-400.
014480     IF ESTAT NOT = HTB AND SKP
014490         GO TO UAC-700.
014500     DISPLAY DU-KIN.
014510 UAC-720.
014520     IF T-BIK = 0
014530         MOVE SPACE TO W-BIK
014540         DISPLAY SU-BIK
014550         GO TO UAC-740.
014560     ACCEPT AU-BIK.
014570     DISPLAY E-CL.
014580     IF ESTAT = BTB
014590         IF W-DC = 4 OR 7
014600             GO TO UAC-620
014610           ELSE
014620             GO TO UAC-660.
014630 UAC-740.
014640     MOVE W-RC TO W-GNO.
014650     MOVE W-SR TO W-AS(W-RC).
014660     GO TO UAC-340.
014670 UAC-760.
014680     MOVE ZERO TO W-GSUT W-RC W-ZC.
014690 UAC-770.
014700     ADD 1 TO W-RC.
014710     IF W-RC = 7
014720         DISPLAY DU-GSUT
014730         IF W-ZC = 0                                              I.050706
014740             DISPLAY E-ME30 E-ME99                                I.050706
014750             GO TO UAC-780                                        I.050706
014760           ELSE                                                   I.050706
014770             GO TO UAC-780.
014780     MOVE ZERO TO W-SR.
014790     MOVE W-AS(W-RC) TO W-SR.
014800     IF W-HCD < 999900
014810        ADD W-SUT TO W-GSUT.
014820     IF W-DATE NOT = ZERO
014830         MOVE W-RC TO W-HNCD.
014840     IF ZERO = W-SU(01) AND W-SU(02) AND W-SU(03) AND W-SU(04)    I.050706
014850           AND W-SU(05) AND W-SU(06) AND W-SU(07) AND W-SU(08)    I.050706
014860           AND W-SU(09) AND W-SU(10) AND W-SUT AND W-KIN          I.050706
014870         GO TO UAC-770.                                           I.050706
014880     MOVE 1 TO W-ZC.                                              I.050706
014890     GO TO UAC-770.
014900 UAC-780.
014910     IF W-BI = SPACE
014920         DISPLAY AU-BI.
014930     IF W-HNCD < W-HNC
014940         DISPLAY E-ME14 E-ME98.
014950 UAC-800.
014960     MOVE 0 TO W-ADV.
014970     DISPLAY AU-BI.
014980     MOVE W-BI TO WK-BI.
014990     ACCEPT AU-BI.
015000     DISPLAY E-CL.
015010     IF ESTAT = BTB
015020         MOVE 7 TO W-RC
015030         MOVE 22 TO W-L1
015040         MOVE 23 TO W-L2
015050         MOVE 24 TO W-L3
015060         GO TO UAC-410.
015070     IF ESTAT = ADV
015080         MOVE WK-BI TO W-BI
015090         DISPLAY AU-BI
015100         MOVE 1 TO W-ADV
015110         GO TO UAC-810.
015120     IF ESTAT NOT = HTB AND SKP
015130         GO TO UAC-780.
015140 UAC-810.
015150     MOVE W-HNOD TO W-HANO.
015160 UAC-840.
015170     IF W-DCD = 3
015180         MOVE ZERO TO W-KOSUR
015190         GO TO UAC-850.
015200     IF W-ADV NOT = 0
015210         GO TO UAC-850.
015220     ACCEPT AU-KOSU.
015230     DISPLAY E-CL.
015240     IF ESTAT = BTB
015250         GO TO UAC-800.
015260     IF ESTAT NOT = HTB AND SKP
015270         GO TO UAC-840.
015280 UAC-850.
015290     DISPLAY DU-KOSU.
015300*
015310     IF W-DCD = 8
015320*****    MOVE ZERO TO W-HSC                                       D.040708
015330*****    MOVE ZERO TO W-HSCD                                      D.131228
015340*****    IF W-CNGS < 1404                                         D.140328
015350*****        MOVE 5 TO W-HSCD                                     D.140328
015360*****        MOVE 0 TO W-FRCD                                     D.140328
015370*****        DISPLAY AU-HSC SU-FRC                                D.140328
015380*****        GO TO UAC-940                                        D.140328
015390*****      ELSE                                                   D.140328
015400         MOVE 8 TO W-HSCD                                         I.131228
015410         MOVE 0 TO W-FRCD
015420         DISPLAY AU-HSC SU-FRC
015430         GO TO UAC-940.
015440     IF T-ZEI = 1                                                 I.070319
015450*****    MOVE 8 TO W-HSCD                                         D.131228
015460         MOVE 0 TO W-HSCD                                         I.131228
015470         DISPLAY AU-HSC                                           I.070319
015480         GO TO UAC-920.                                           I.070319
015490     IF T-FKC = 99                                                I.040705
015500*****    MOVE 8 TO W-HSCD                                         D.131228
015510         MOVE 0 TO W-HSCD                                         I.131228
015520         DISPLAY AU-HSC                                           I.040705
015530         GO TO UAC-920.                                           I.040705
015540     IF W-DCD = 0
015550*****    MOVE ZERO TO W-HSC                                       D.040708
015560*****    MOVE ZERO TO W-HSCD                                      D.131228
015570*****    IF W-CNGS < 1404                                         D.140328
015580*****        MOVE 5 TO W-HSCD                                     D.140328
015590*****        DISPLAY AU-HSC                                       D.140328
015600*****        GO TO UAC-920                                        D.140328
015610*****      ELSE                                                   D.140328
015620         MOVE 8 TO W-HSCD                                         I.131228
015630         DISPLAY AU-HSC
015640         GO TO UAC-920.
015650     IF W-DCD = 3
015660*****    IF W-GSUT > ZERO                                         D.140408
015670*****        MOVE ZERO TO W-HSC W-FRCD                            D.040708
015680*****        MOVE ZERO TO W-HSCD W-FRCD                           D.131228
015690             MOVE ZERO TO W-FRCD                                  I.131228
015700*****        IF W-CNGS < 1404                                     D.140328
015710*****            MOVE 5 TO W-HSCD                                 D.140328
015720*****            DISPLAY AU-HSC SU-FRC                            D.140328
015730*****            GO TO UAC-940                                    D.140328
015740*****          ELSE                                               D.140328
015750             MOVE 8 TO W-HSCD                                     I.131228
015760             DISPLAY AU-HSC SU-FRC
015770             GO TO UAC-940.
015780 UAC-880.
015790     IF  W-DCD = 9
015800*****    MOVE 8 TO W-HSCD                                         D.131228
015810         MOVE 0 TO W-HSCD                                         I.131228
015820         MOVE 0 TO W-FRCD
015830         DISPLAY AU-HSC SU-FRC
015840         GO TO UAC-940.
015850     IF  W-DCD = 7
015860*****    MOVE 8 TO W-HSCD                                         D.131228
015870         MOVE 0 TO W-HSCD                                         I.131228
015880         GO TO UAC-920.
015890     IF W-ADV NOT = 0
015900         GO TO UAC-890.
015910     ACCEPT AU-HSC.
015920     IF ESTAT = BTB
015930         MOVE 0 TO W-ADV
015940         IF W-DCD = 3
015950             GO TO UAC-800
015960           ELSE
015970             GO TO UAC-840.
015980     IF ESTAT NOT = HTB AND SKP
015990         GO TO UAC-880.
016000 UAC-890.
016010*****IF W-HSCD NOT = 0 AND 3 AND 8                                D.131228
016020     IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                    I.131228
016030         GO TO UAC-880.
016040 UAC-920.
016050*****IF W-DCD NOT = 5 AND 0 AND 4 AND 7                           D.030708
016060     IF W-DCD NOT = 0 AND 1 AND 2 AND 4 AND 5 AND 7               I.030708
016070         MOVE 0 TO W-FRCD
016080         DISPLAY SU-FRC
016090         GO TO UAC-940.
016100     IF W-ADV NOT = 0
016110         GO TO UAC-930.
016120     ACCEPT AU-FRC.
016130     IF ESTAT = BTB
016140         IF W-DCD = 7
016150             MOVE 0 TO W-ADV
016160             GO TO UAC-840.
016170     IF ESTAT = BTB
016180         MOVE 0 TO W-ADV
016190         GO TO UAC-880.
016200     IF ESTAT NOT = HTB AND SKP
016210         GO TO UAC-920.
016220 UAC-930.
016230     DISPLAY AU-FRC.
016240     IF W-FRCD > 1
016250         GO TO UAC-920.
016260 UAC-940.
016270     DISPLAY AU-SDT.
016280     IF W-SDTD NOT = ZERO
016290         GO TO UAC-980.                                           I.000922
016300*****    GO TO UAC-990.                                           D.000922
016310     IF T-SS = ZERO OR 99                                         I.000922
016320         GO TO UAC-990.                                           I.000922
016330 UAC-960.
016340     ACCEPT AU-SDT.
016350     IF ESTAT NOT = BTB
016360         GO TO UAC-970.
016370     MOVE 0 TO W-ADV.
016380     IF W-DCD = 8
016390         GO TO UAC-840.
016400     IF W-DCD = 9
016410         IF W-GSUT > ZERO
016420             GO TO UAC-840.
016430     IF W-DCD = 9
016440         GO TO UAC-840.
016450     IF W-DCD = 5 OR 0 OR 4 OR 7
016460         GO TO UAC-920.
016470     GO TO UAC-880.
016480 UAC-970.
016490     IF ESTAT NOT = HTB AND SKP
016500         GO TO UAC-960.                                           I.000922
016510*****    GO TO UAC-940.                                           D.000922
016520     IF T-SS = ZERO OR 99                                         I.000818
016530         IF W-SDTD NOT = ZERO                                     I.000922
016540             GO TO UAC-960.                                       I.000922
016550     IF W-DCD NOT = 3                                             I.020227
016560         IF W-SDTD = 99999999                                     I.020227
016570             GO TO UAC-960.                                       I.020227
016580*****IF W-SDTD = ZERO                                             D.020227
016590     IF W-SDTD = ZERO OR 99999999                                 I.020227
016600         GO TO UAC-990.                                           I.001030
016610*****    GO TO UAC-980.                                           D.001030
016620     IF W-SDTG < 1 OR > 12
016630         GO TO UAC-960.                                           I.000922
016640*****    GO TO UAC-940.                                           D.000922
016650     IF W-SDTP < 1 OR > 31
016660         GO TO UAC-960.                                           I.000922
016670*****    GO TO UAC-940.                                           D.000922
016680     IF W-SDTN NOT = W-ND AND (W-ND + 1)
016690         GO TO UAC-960.                                           I.000922
016700*****    GO TO UAC-940.                                           D.000922
016710*****IF W-NGP > W-SDTD                                            D.001025
016720*****    GO TO UAC-960.                                           D.001025
016730 UAC-980.                                                         I.000922
016740*****IF W-SDATE NOT = ZERO                                        D.020205
016750*****IF W-SDATE NOT = ZERO AND 99999999                           D.020227
016760     IF W-SDATE NOT = ZERO                                        I.020227
016770         IF W-SDATE >= W-SDTD                                     I.000922
016780             DISPLAY E-ME25 E-ME99                                I.000922
016790             DISPLAY E-CL                                         I.000922
016800             GO TO UAC-960.                                       I.000922
016810*****IF W-SDATE = 99999999                                        D.020227
016820*****    IF W-NGD >= W-SDTNG                                      D.020227
016830*****        DISPLAY E-ME25 E-ME99                                D.020227
016840*****        DISPLAY E-CL                                         D.020227
016850*****        GO TO UAC-960.                                       D.020227
016860     IF W-NGP > W-SDTD                                            I.001025
016870         GO TO UAC-960.                                           I.001025
016880*****    GO TO UAC-940.                                           D.000922
016890 UAC-990.
016900     ACCEPT AU-DMM.
016910     IF ESTAT = BTB
016920         GO TO UAC-960.
016930     IF ESTAT NOT = HTB AND SKP
016940         GO TO UAC-990.
016950     IF W-DMM = 9
016960         DISPLAY E-ME90 E-ME98
016970         GO TO UAC-040.
016980     IF W-DMM NOT = 1
016990         GO TO UAC-990.
017000 UAC-EX.
017010     EXIT.
017020*---------------  値引入力  ----------------------------------------------
017030 NAC-RTN.
017040     IF W-NGP NOT = ZERO
017050         GO TO NAC-040.
017060     DISPLAY C-CLEAR.
017070     CALL "SCHD11".
017080 NAC-020.
017090     ACCEPT AN-NGP.
017100     DISPLAY E-CL.
017110     IF ESTAT = C2 OR PF9
017120         MOVE 1 TO W-END
017130         GO TO NAC-EX.
017140     IF ESTAT = BTB
017150         GO TO NAC-EX.
017160     IF ESTAT NOT = HTB AND SKP
017170         GO TO NAC-020.
017180     IF W-NGPS = ZERO
017190         MOVE DATE-02R TO W-NGPS
017200         DISPLAY AN-NGP.
017210     IF W-GD > 12 OR < 1
017220         GO TO NAC-020.
017230     IF W-PD > 31 OR < 1
017240         GO TO NAC-020.
017250     MOVE ZERO TO W-ND1.
017260     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
017270         ADD DATE-NC1 TO W-ND.
017280     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
017290         ADD DATE-NC2 TO W-ND.
017300     IF W-CNG NOT = W-NGD
017310         DISPLAY E-ME12 E-ME98
017320         GO TO NAC-020.
017330 NAC-040.
017340     CALL "SCHD11".
017350     DISPLAY AN-NGP.
017360     ACCEPT AN-TCD.
017370     IF ESTAT = C2 OR PF9
017380         MOVE 1 TO W-END
017390         GO TO NAC-EX.
017400     IF ESTAT = BTB
017410         GO TO NAC-020.
017420     IF ESTAT NOT = HTB AND SKP
017430         GO TO NAC-040.
017440     PERFORM TM-RTN THRU TM-EX.
017450     IF W-INV = 1
017460         DISPLAY E-ME1 E-ME98
017470         GO TO NAC-040.
017480     IF T-BC NOT = ZERO
017490         DISPLAY E-ME1 E-ME98
017500         GO TO NAC-040.
017510 NAC-060.
017520     ACCEPT AN-CSC.
017530     IF ESTAT = BTB
017540         GO TO NAC-040.
017550     IF ESTAT NOT = HTB AND SKP
017560         GO TO NAC-060.
017570     IF W-CSCD NOT = 0 AND 9
017580         GO TO NAC-060.
017590*****MOVE SPACE TO W-CSN.                                         D.020405
017600*****IF W-CSCD = 9                                                D.020405
017610*****    MOVE NC"調整分" TO W-CSN.                                D.020405
017620*****DISPLAY DN-CSN.                                              D.020405
017630 NAC-080.
017640     MOVE ZERO TO W-SR W-BR.
017650     MOVE SPACE TO W-BI.
017660*****MOVE ZERO TO W-RC W-ASR W-HSCD.                              D.131228
017670     MOVE ZERO TO W-RC W-ASR.                                     I.131228
017680*****IF W-CNGS < 1404                                             D.140328
017690*****    MOVE 5 TO W-HSCD                                         D.140328
017700*****  ELSE                                                       D.140328
017710     MOVE 8 TO W-HSCD.                                            I.131228
017720     MOVE 7 TO W-L1.
017730     CALL "SCHD11".
017740     DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC.                         I.020405
017750*****DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC DN-CSN.                  D.020405
017760 NAC-100.
017770     ADD 1 TO W-RC W-L1.
017780     IF W-RC = 7
017790         GO TO NAC-260.
017800     MOVE W-NGP TO W-DATE.
017810     MOVE W-TCDN TO W-TCD.
017820     MOVE W-CSCD TO W-CSC.
017830 NAC-120.
017840     ACCEPT AN-HCD.
017850     DISPLAY E-CL.
017860*****IF ESTAT = C1                                                D.001205
017870     IF ESTAT = C1 OR PF6                                         I.001205
017880         GO TO NAC-240.
017890     IF ESTAT NOT = BTB
017900         GO TO NAC-140.
017910     IF W-RC = 1
017920         GO TO NAC-040.
017930     SUBTRACT 1 FROM W-RC W-L1.
017940     MOVE W-AS(W-RC) TO W-SR.
017950*****IF W-HCD = 999977                                            D.020204
017960     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
017970         GO TO NAC-160.
017980     GO TO NAC-200.
017990 NAC-140.
018000     IF ESTAT NOT = HTB AND SKP
018010         GO TO NAC-120.
018020     MOVE 0 TO W-HIC.                                             I.020214
018030     PERFORM HI-RTN THRU HI-EX.
018040     IF W-EC NOT = ZERO
018050         MOVE 0 TO W-EC
018060         GO TO NAC-120.
018070     MOVE T-TNC TO W-TC2.
018080     MOVE T-FKC TO W-FKC.
018090 NAC-160.
018100*****IF W-HCD NOT = 999977                                        D.020204
018110     IF W-HCD NOT = 999977 AND 999991 AND 999992 AND 999993       I.020204
018120         GO TO NAC-180.
018130     ACCEPT AN-KIN.
018140     IF ESTAT = BTB
018150         GO TO NAC-120.
018160     IF ESTAT NOT = HTB AND SKP
018170         GO TO NAC-160.
018180     MOVE ZERO TO W-SUT W-BT.
018190     DISPLAY DN-SUT DN-BT DN-KIN.
018200     GO TO NAC-220.
018210 NAC-180.
018220     ACCEPT AN-SUT.
018230     IF ESTAT = BTB
018240         GO TO NAC-120.
018250     IF ESTAT NOT = HTB AND SKP
018260         GO TO NAC-180.
018270     DISPLAY DN-SUT.
018280     IF W-SUT < 0                                                 I.001121
018290         GO TO NAC-180.                                           I.001121
018300 NAC-200.
018310     ACCEPT AN-BT.
018320     IF ESTAT = BTB
018330         GO TO NAC-180.
018340     IF ESTAT NOT = HTB AND SKP
018350         GO TO NAC-200.
018360     COMPUTE W-KIN = W-SUT * W-BT.
018370     DISPLAY DN-BT DN-KIN.
018380 NAC-220.
018390     MOVE W-RC TO W-GNO.
018400*****MOVE ZERO TO W-SUS.                                          D.000821
018410     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
018420                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
018430     MOVE W-SR TO W-AS(W-RC).
018440     GO TO NAC-100.
018450 NAC-240.
018460     MOVE ZERO TO W-SR.
018470     MOVE W-SR TO W-AS(W-RC).
018480     DISPLAY SN-DS.
018490     ADD 1 TO W-RC W-L1.
018500     IF W-RC NOT = 7
018510         GO TO NAC-240.
018520 NAC-260.
018530     MOVE ZERO TO W-DKIN CNT.
018540 NAC-280.
018550     ADD 1 TO CNT.
018560     IF CNT = 7
018570         DISPLAY DN-DKIN
018580         GO TO NAC-300.
018590     MOVE W-AS(CNT) TO W-SR.
018600     ADD W-KIN TO W-DKIN.
018610     GO TO NAC-280.
018620 NAC-300.
018630     DISPLAY AN-BI.
018640     ACCEPT AN-BI.
018650     IF ESTAT = BTB
018660         GO TO NAC-360.
018670     IF ESTAT NOT = HTB AND SKP
018680         GO TO NAC-300.
018690     IF T-ZEI = 1                                                 I.070319
018700         MOVE 0 TO W-HSCD.                                        I.131228
018710*****    MOVE 8 TO W-HSCD.                                        D.131228
018720     IF T-FKC = 99                                                I.040708
018730         MOVE 0 TO W-HSCD.                                        I.131228
018740*****    MOVE 8 TO W-HSCD.                                        D.131228
018750     DISPLAY AN-HSC AN-SDT.
018760*****IF W-SDTD = ZERO                                             D.000922
018770*****    GO TO NAC-330.                                           D.000922
018780     GO TO NAC-340.
018790 NAC-320.
018800     ACCEPT AN-HSC.
018810     IF ESTAT = BTB
018820         GO TO NAC-300.
018830     IF ESTAT NOT = HTB AND SKP
018840         GO TO NAC-320.
018850*****IF W-HSCD NOT = 0 AND 3 AND 8                                D.131228
018860     IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                    I.131228
018870         GO TO NAC-320.
018880     IF T-SS = 00 OR 99                                           I.001030
018890         MOVE ZERO TO W-SDTD                                      I.001030
018900         DISPLAY AN-SDT                                           I.001030
018910         GO TO NAC-340.                                           I.001030
018920 NAC-330.
018930     ACCEPT AN-SDT.
018940     IF ESTAT = BTB
018950         GO TO NAC-320.
018960     IF ESTAT NOT = HTB AND SKP
018970         GO TO NAC-330.
018980*****IF T-SS = ZERO OR 99                                         D.001030
018990     IF W-SDTD = ZERO                                             I.000818
019000         GO TO NAC-340.                                           I.000818
019010     IF W-SDTG < 1 OR > 12
019020         GO TO NAC-330.
019030     IF W-SDTP < 1 OR > 31
019040         GO TO NAC-330.
019050     IF W-SDTN NOT = W-ND AND (W-ND + 1)
019060         GO TO NAC-330.
019070     IF W-NGP > W-SDTD
019080         GO TO NAC-330.
019090     IF W-SDATE NOT = ZERO                                        I.000922
019100         IF W-SDATE >= W-SDTD                                     I.000922
019110             DISPLAY E-ME25 E-ME99                                I.000922
019120             DISPLAY E-CL                                         I.000922
019130             GO TO NAC-330.                                       I.000922
019140 NAC-340.
019150     ACCEPT AN-DMM.
019160     IF ESTAT = BTB
019170         IF T-SS = 00 OR 99                                       I.001030
019180             GO TO NAC-320                                        I.001030
019190           ELSE                                                   I.001030
019200             GO TO NAC-330.
019210     IF ESTAT NOT = HTB AND SKP
019220         GO TO NAC-340.
019230     IF W-DMM = 1
019240         GO TO NAC-EX.
019250     IF W-DMM = 9
019260         GO TO NAC-040.
019270     GO TO NAC-340.
019280 NAC-360.
019290     IF W-RC = 1
019300         GO TO NAC-080.
019310     SUBTRACT 1 FROM W-RC.
019320     MOVE W-AS(W-RC) TO W-SR.
019330     SUBTRACT 1 FROM W-L1.
019340     IF W-HCD = ZERO
019350         GO TO NAC-360.
019360*****IF W-HCD = 999977                                            D.020204
019370     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
019380         GO TO NAC-160.
019390     GO TO NAC-200.
019400 NAC-EX.
019410     EXIT.
019420*------------------------------------------------------------------------
019430 TAN-RTN.
019440     MOVE 0 TO WK-TAN.
019450*****MOVE W-TCDD TO THTN-01.                                      D.010419
019460*****MOVE W-HCD TO THTN-02.                                       D.010419
019470*****MOVE W-SIZ TO THTN-03.                                       D.010419
019480*****READ JT-THTN UNLOCK INVALID                                  D.010419
019490     MOVE W-TCD TO THT-TCD.                                       I.010419
019500     MOVE W-HCD TO THT-HCD.                                       I.010419
019510     MOVE W-SIZ TO THT-SIZ.                                       I.010419
019520     READ THTM UNLOCK INVALID                                     I.010419
019530         MOVE ZERO TO THT-T.                                      I.020405
019540*****    GO TO TAN-020.                                           D.020405
019550     MOVE THT-T TO WK-TAN.                                        I.010419
019560*****MOVE THTN-04 TO WK-TAN.                                      D.010419
019570*TAN-020.                                                         D.020405
019580     IF WK-TAN NOT = ZERO
019590         GO TO TAN-090.                                           I.010419
019600*****    GO TO TAN-EX.                                            D.010419
019610*****MOVE W-TCDD TO THTN-01.                                      D.010419
019620*****MOVE W-HCD TO THTN-02.                                       D.010419
019630*****MOVE 9 TO THTN-03.                                           D.010419
019640*****READ JT-THTN UNLOCK INVALID                                  D.010419
019650     MOVE W-TCD TO THT-TCD.                                       I.010419
019660     MOVE W-HCD TO THT-HCD.                                       I.010419
019670     MOVE 9 TO THT-SIZ.                                           I.010419
019680     READ THTM UNLOCK INVALID                                     I.010419
019690         MOVE ZERO TO THT-T.                                      I.020405
019700*****    GO TO TAN-040.                                           D.020405
019710*****    GO TO TAN-EX.                                            D.010802
019720     MOVE THT-T TO WK-TAN.                                        I.010419
019730     IF WK-TAN NOT = ZERO                                         I.010802
019740         GO TO TAN-090.                                           I.010802
019750*****MOVE THTN-04 TO WK-TAN.                                      D.010419
019760*TAN-040.                                                         D.020405
019770     IF HI-MHCD = HI-HCD                                          I.010802
019780         GO TO TAN-090.                                           I.020405
019790*****    GO TO TAN-EX.                                            D.020405
019800     MOVE W-TCD TO THT-TCD.                                       I.010802
019810     MOVE HI-MHCD TO THT-HCD.                                     I.010802
019820     MOVE W-SIZ TO THT-SIZ.                                       I.010802
019830     READ THTM UNLOCK INVALID                                     I.010802
019840         MOVE ZERO TO THT-T.                                      I.020405
019850*****    GO TO TAN-060.                                           D.020405
019860     MOVE THT-T TO WK-TAN.                                        I.010802
019870*TAN-060.                                                         D.020405
019880     IF WK-TAN NOT = ZERO                                         I.010802
019890         GO TO TAN-090.                                           I.010802
019900     MOVE W-TCD TO THT-TCD.                                       I.010802
019910     MOVE HI-MHCD TO THT-HCD.                                     I.010802
019920     MOVE 9 TO THT-SIZ.                                           I.010802
019930     READ THTM UNLOCK INVALID                                     I.010802
019940         MOVE ZERO TO THT-T.                                      I.020405
019950*****    GO TO TAN-090.                                           D.020405
019960*****    GO TO TAN-EX.                                            D.020215
019970     MOVE THT-T TO WK-TAN.                                        I.010802
019980 TAN-090.                                                         I.010419
019990     IF WK-TAN NOT = ZERO                                         I.010419
020000         MOVE WK-TAN TO W-BT                                      I.010802
020010         GO TO TAN-EX.                                            I.010802
020020*****IF HI-BC1 > 19 AND < 30                                      D.070305
020030*****    MOVE HI-SB TO WK-TAN                                     D.070305
020040*****    MOVE WK-TAN TO W-BT.                                     D.070305
020050*****    MOVE HI-SB TO WK-TAN.                                    D.020401
020060*****    MOVE WK-TAN TO W-BT.                                     D.010802
020070 TAN-EX.
020080     EXIT.
020090*
020100 TAO-RTN.                                                         I.110407
020110     MOVE 0 TO WK-TAN.                                            I.110407
020120     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020130     MOVE W-HCD TO OTHT-HCD.                                      I.110407
020140     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
020150     READ OTHTM UNLOCK INVALID                                    I.110407
020160         MOVE ZERO TO OTHT-T.                                     I.110407
020170     MOVE OTHT-T TO WK-TAN.                                       I.110407
020180     IF WK-TAN NOT = ZERO                                         I.110407
020190         GO TO TAO-090.                                           I.110407
020200     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020210     MOVE W-HCD TO OTHT-HCD.                                      I.110407
020220     MOVE 9 TO OTHT-SIZ.                                          I.110407
020230     READ OTHTM UNLOCK INVALID                                    I.110407
020240         MOVE ZERO TO OTHT-T.                                     I.110407
020250     MOVE OTHT-T TO WK-TAN.                                       I.110407
020260     IF WK-TAN NOT = ZERO                                         I.110407
020270         GO TO TAO-090.                                           I.110407
020280     IF HI-MHCD = HI-HCD                                          I.110407
020290         GO TO TAO-090.                                           I.110407
020300     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020310     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
020320     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
020330     READ OTHTM UNLOCK INVALID                                    I.110407
020340         MOVE ZERO TO OTHT-T.                                     I.110407
020350     MOVE OTHT-T TO WK-TAN.                                       I.110407
020360     IF WK-TAN NOT = ZERO                                         I.110407
020370         GO TO TAO-090.                                           I.110407
020380     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020390     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
020400     MOVE 9 TO OTHT-SIZ.                                          I.110407
020410     READ OTHTM UNLOCK INVALID                                    I.110407
020420         MOVE ZERO TO OTHT-T.                                     I.110407
020430     MOVE OTHT-T TO WK-TAN.                                       I.110407
020440 TAO-090.                                                         I.110407
020450     IF WK-TAN NOT = ZERO                                         I.110407
020460         MOVE WK-TAN TO W-BT                                      I.110407
020470         GO TO TAO-EX.                                            I.110407
020480 TAO-EX.                                                          I.110407
020490     EXIT.                                                        I.110407
020500*------------------------------------------------------------------------
020510 SD-RTN.
020520     CLOSE S-TRAN.
020530     OPEN I-O S-TRAN.
020540 SD-020.
020550     READ S-TRAN AT END
020560         GO TO SD-EX.
020570     IF W-DNO NOT = S-DNO
020580         GO TO SD-020.
020590     MOVE ""FF"" TO S-R.
020600     REWRITE S-R.
020610     IF ERR-STAT NOT = "00"
020620         DISPLAY E-STAT E-ME17 E-ME99.
020630     GO TO SD-020.
020640 SD-EX.
020650     EXIT.
020660*------------------------------------------------------------------------
020670 HMN-RTN.
020680     INITIALIZE W-ASR W-BR.
020690     MOVE SPACE TO W-BI.
020700     MOVE ZERO TO W-DCD.                                          I.010327
020710     MOVE HSMS-061 TO W-TCDD.                                     I.020214
020720     PERFORM TM-RTN THRU TM-EX.                                   I.020214
020730     IF W-INV = 1                                                 I.020214
020740         DISPLAY E-ME2 E-ME99                                     I.020214
020750         GO TO HMN-EX.                                            I.020214
020760 HMN-020.
020770*****IF HSMS-02 NOT = 7                                           D.010419
020780     IF HSMS-02 = 7                                               I.010419
020790         MOVE HSMS-15 TO W-BI                                     I.010419
020800         GO TO HMN-035.                                           I.010419
020810     IF HSMS-13 = 4 OR 5
020820         MOVE 4 TO HSMS-03.
020830     MOVE ZERO TO W-SR.                                           I.010419
020840     MOVE SPACE TO W-BIK.                                         I.010419
020850     MOVE HSMS-02 TO W-GNO.                                       I.020214
020860     MOVE W-NGP TO W-DATE.                                        I.010419
020870     MOVE HSMS-03 TO W-DC.                                        I.010419
020880     MOVE W-TCDN TO W-TCD.                                        I.020205
020890     MOVE W-TCDD TO W-TCD2.                                       I.020205
020900*****MOVE HSMS-061 TO W-TCD W-TCD2.                               D.020205
020910     MOVE HSMS-09 TO W-HCD.                                       I.010419
020920     MOVE HSMS-10 TO W-SIZ.                                       I.010419
020930     MOVE HSMS-1211(01) TO W-SU(01).                              I.010419
020940     MOVE HSMS-1211(02) TO W-SU(02).                              I.010419
020950     MOVE HSMS-1211(03) TO W-SU(03).                              I.010419
020960     MOVE HSMS-1211(04) TO W-SU(04).                              I.010419
020970     MOVE HSMS-1211(05) TO W-SU(05).                              I.010419
020980     MOVE HSMS-1211(06) TO W-SU(06).                              I.010419
020990     MOVE HSMS-1211(07) TO W-SU(07).                              I.010419
021000     MOVE HSMS-1211(08) TO W-SU(08).                              I.010419
021010     MOVE HSMS-1211(09) TO W-SU(09).                              I.010419
021020     MOVE HSMS-1211(10) TO W-SU(10).                              I.010419
021030     MOVE HSMS-122 TO W-SUT.                                      I.010419
021040     MOVE HSMS-07 TO W-SOK.                                       I.010419
021050     MOVE HSMS-14 TO W-KOSU.                                      I.010419
021060     MOVE HSMS-062 TO W-CCD.                                      I.010419
021070     MOVE HSMS-22 TO W-BIK.                                       I.010419
021080     MOVE HSMS-24 TO W-USC.                                       I.040324
021090     MOVE 1 TO W-HIC.                                             I.020214
021100     PERFORM HI-RTN THRU HI-EX.                                   I.020214
021110     PERFORM TAN-RTN THRU TAN-EX.                                 I.010419
021120     COMPUTE W-KIN = W-SUT * W-BT.                                I.010419
021130     IF W-DC = 2 OR 6                                             I.020221
021140         MOVE ZERO TO W-FT                                        I.020221
021150       ELSE                                                       I.020221
021160         MOVE HI-FT TO W-FT.                                      I.020214
021170     MOVE T-TNC TO W-TC2.                                         I.020214
021180     MOVE T-FKC TO W-FKC.                                         I.020214
021190     MOVE W-SR TO W-AS(HSMS-02).                                  I.010419
021200*****IF HSMS-02 NOT = 7                                           D.010314
021210*****    IF HSMS-03 NOT = 0 AND 4                                 D.010314
021220*****        MOVE 0 TO HSMS-03.                                   D.010314
021230*****IF HSMS-02 NOT = 7                                           D.010419
021240*****    MOVE ZERO TO W-SR                                        D.010419
021250*****    MOVE SPACE TO W-BIK                                      D.010419
021260*****    MOVE W-NGP TO W-DATE                                     D.010419
021270*****    MOVE HSMS-03 TO W-DC                                     D.010419
021280*****    MOVE HSMS-061 TO W-TCD W-TCD2                            D.010419
021290*****    MOVE HSMS-09 TO W-HCD                                    D.010419
021300*****    MOVE HSMS-10 TO W-SIZ                                    D.010419
021310*****    MOVE HSMS-1211(01) TO W-SU(01)                           D.010419
021320*****    MOVE HSMS-1211(02) TO W-SU(02)                           D.010419
021330*****    MOVE HSMS-1211(03) TO W-SU(03)                           D.010419
021340*****    MOVE HSMS-1211(04) TO W-SU(04)                           D.010419
021350*****    MOVE HSMS-1211(05) TO W-SU(05)                           D.010419
021360*****    MOVE HSMS-1211(06) TO W-SU(06)                           D.010419
021370*****    MOVE HSMS-1211(07) TO W-SU(07)                           D.010419
021380*****    MOVE HSMS-1211(08) TO W-SU(08)                           D.010419
021390*****    MOVE HSMS-1211(09) TO W-SU(09)                           D.010419
021400*****    MOVE HSMS-1211(10) TO W-SU(10)                           D.010419
021410*****    MOVE HSMS-122 TO W-SUT                                   D.010419
021420*****    MOVE HSMS-07 TO W-SOK                                    D.010419
021430*****    MOVE HSMS-14 TO W-KOSU                                   D.010419
021440*****    MOVE HSMS-062 TO W-CCD                                   D.010419
021450*****    MOVE HSMS-22 TO W-BIK                                    D.010419
021460*****    MOVE W-SR TO W-AS(HSMS-02)                               D.010419
021470*****  ELSE                                                       D.010419
021480*****    MOVE HSMS-15 TO W-BI.                                    D.010419
021490 HMN-035.                                                         I.010419
021500     READ HSMSF NEXT RECORD AT END
021510         GO TO HMN-040.
021520     IF W-HMN = HSMS-01
021530         GO TO HMN-020.
021540 HMN-040.
021550     MOVE W-SOK TO W-SCD.
021560*****MOVE W-DATE TO W-NGP.                                        D.020214
021570*****MOVE W-TCD TO W-TCDN W-TCDD.                                 D.020214
021580     MOVE W-CCD TO W-CCDD.
021590     MOVE W-KOSU TO W-KOSUR.
021600*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.131228
021610     MOVE ZERO TO W-FRCD.                                         I.131228
021620*****IF W-CNGS < 1404                                             D.140328
021630*****    MOVE 5 TO W-HSCD                                         D.140328
021640*****  ELSE                                                       D.140328
021650     MOVE 8 TO W-HSCD.                                            I.131228
021660 HMN-060.
021670     MOVE 3 TO JCON3-01.
021680     MOVE W-SCD TO JCON3-02.
021690     READ JCON UNLOCK INVALID
021700         MOVE  SPACE TO JCON3-03.
021710     MOVE W-SCD TO W-SOK.
021720     DISPLAY AU-SOK DU-SNA.
021730*
021740*****PERFORM TM-RTN THRU TM-EX.                                   D.020214
021750*****IF W-INV = 1                                                 D.020214
021760*****    DISPLAY E-ME2 E-ME99                                     D.020214
021770*****    GO TO HMN-EX.                                            D.020214
021780*****MOVE W-HMN TO W-HN1.                                         D.010327
021790*****DISPLAY AU-HN1.                                              D.010327
021800*****MOVE 1 TO W-HNC.                                             D.010327
021810*****MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                         D.010327
021820     IF W-DC = 1 OR 2                                             I.010327
021830         MOVE W-DC TO W-DCD                                       I.020320
021840         MOVE ZERO TO W-HNOD                                      I.081222
021850*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
021860*****    DISPLAY SU-HMN                                           D.020214
021870       ELSE                                                       I.010327
021880         MOVE W-HMN TO W-HNOD.                                    I.081222
021890*****    MOVE W-HMN TO W-HN1                                      D.081222
021900*****    DISPLAY AU-HN1                                           D.081222
021910*****    MOVE 1 TO W-HNC                                          D.081222
021920*****    MOVE ZERO TO W-HN2 W-HN3 W-HN4 W-HN5 W-HN6               D.081222
021930*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6.              D.081222
021940     PERFORM TCM-RTN THRU TCM-EX.
021950     IF W-INV = 1                                                 I.001031
021960         DISPLAY E-ME1 E-ME99                                     I.001031
021970         GO TO HMN-EX.                                            I.001031
021980*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.131228
021990     MOVE ZERO TO W-FRCD.                                         I.131228
022000*****IF W-CNGS < 1404                                             D.140328
022010*****    MOVE 5 TO W-HSCD                                         D.140328
022020*****  ELSE                                                       D.140328
022030     MOVE 8 TO W-HSCD.                                            I.131228
022040     DISPLAY AU-BI DU-KOSU AU-HSC AU-FRC.
022050 HMN-EX.
022060     EXIT.
022070*------------------------------------------------------------------------
022080 DSP-RTN.
022090     MOVE 1 TO W-L1.
022100     MOVE 2 TO W-L2.
022110     MOVE 3 TO W-L3.
022120     MOVE ZERO TO W-RC W-ZC W-GSUT W-RCB W-LB.                    I.020409
022130*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT W-RCB W-LB.              D.020409
022140*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT.                         D.020403
022150 DSP-020.
022160     ADD 1 TO W-RC.
022170     ADD 3 TO W-L1 W-L2 W-L3.
022180     IF W-RC > 6
022190         GO TO DSP-080.
022200*
022210     INITIALIZE W-SR.
022220     MOVE W-AS(W-RC) TO W-SR.
022230     IF W-HCD = ZERO
022240         DISPLAY SU-D1 SU-D2 SU-D3
022250         GO TO DSP-020.
022260*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
022270     MOVE W-HCD TO HI-KEY.
022280     READ HI-M WITH UNLOCK INVALID KEY
022290         MOVE SPACE TO HI-NAME.
022300     DISPLAY AU-DC AU-HCD DU-HNA.
022310     IF W-HCD >= 999900
022320         DISPLAY SU-D2 SU-D31
022330         GO TO DSP-060.
022340     DISPLAY AU-SIZ.
022350     IF W-SIZ = 1
022360         DISPLAY DU-S1.
022370     IF W-SIZ = 2
022380         DISPLAY DU-S2.
022390     IF W-SIZ = 3
022400         DISPLAY DU-S3.
022410     IF W-SIZ = 4
022420         DISPLAY DU-S4.
022430     MOVE ZERO TO W-SC.
022440     MOVE -3 TO W-C.
022450 DSP-040.
022460     ADD 1 TO W-SC.
022470     IF W-SC > 8
022480         ADD 5 TO W-C
022490       ELSE
022500         ADD 6 TO W-C.
022510     IF W-SC = 11
022520         GO TO DSP-060.
022530     IF W-SC < 8
022540         DISPLAY DU-SU
022550       ELSE
022560         DISPLAY DU-SU1.
022570     GO TO DSP-040.
022580 DSP-060.
022590     DISPLAY DU-SUT DU-BT DU-KIN AU-BIK.
022600     IF W-DC = 4
022610         MOVE ZERO TO W-FT
022620         DISPLAY SU-KIN SU-BT.
022630     IF W-HCD < 999900                                            I.090120
022640         ADD W-SUT TO W-GSUT.
022650     IF W-DC NOT = 7                                              I.020401
022660         IF W-BT = ZERO                                           I.020401
022670             DISPLAY E-ME15 E-ME99                                I.020401
022680             DISPLAY E-CL                                         I.020404
022690             IF W-DSPC = 1                                        I.020404
022700                 IF W-RCB = ZERO                                  I.020404
022710                     MOVE W-RC TO W-RCB                           I.020404
022720                     MOVE W-L TO W-LB.                            I.020404
022730*****        DISPLAY E-CL.                                        D.020404
022740     GO TO DSP-020.
022750 DSP-080.
022760     DISPLAY DU-GSUT.
022770 DSP-EX.
022780     EXIT.
022790*------------------------------------------------------------------------
022800 TM-RTN.
022810     MOVE 0 TO W-INV.
022820     MOVE W-TCDD TO W-TCDN.
022830     IF W-TCDN = 0460
022840         MOVE 0458 TO W-TCDN.                                     I.010206
022850*****    MOVE 0459 TO W-TCDN.                                     D.010206
022860     MOVE W-TCDN TO T-KEY.
022870     READ T-M WITH UNLOCK INVALID KEY
022880         MOVE SPACE TO T-NAME
022890         MOVE 1 TO W-INV.
022900     IF W-UNCD = 0
022910         DISPLAY AU-TCD DU-TNA
022920       ELSE
022930         DISPLAY AN-TCD DN-TNA.
022940*
022950     MOVE W-TCDN TO TSK-KEY.                                      I.000922
022960     READ TSKF WITH UNLOCK INVALID KEY                            I.000922
022970         MOVE ZERO TO TSK-R.                                      I.000922
022980     MOVE TSK-ZNGP(4) TO W-SDATE.                                 I.000922
022990     IF TSK-ZNGP(5) NOT = ZERO                                    I.000922
023000         MOVE TSK-ZNGP(5) TO W-SDATE.                             I.020207
023010*****    MOVE 99999999 TO W-SDATE.                                D.020207
023020*
023030     MOVE ZERO TO W-SDTD.
023040*****IF W-SDATE = 99999999                                        D.020207
023050*****    GO TO TM-EX.                                             D.020207
023060     MOVE W-NGP TO W-SDTD.
023070 TM-020.
023080     MOVE T-SS TO W-SDTP.
023090     IF W-SDTP = 00 OR 99
023100         MOVE ZERO TO W-SDTD
023110         GO TO TM-EX.
023120     IF W-SDTP = 30 OR 31
023130         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
023140             MOVE 31 TO W-SDTP
023150           ELSE
023160             IF W-SDTG = 4 OR 6 OR 9 OR 11
023170                 MOVE 30 TO W-SDTP
023180               ELSE
023190                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1
023200                                           REMAINDER W-DTW2
023210                 IF W-DTW2 = 0
023220                     MOVE 29 TO W-SDTP
023230                   ELSE
023240                     MOVE 28 TO W-SDTP.
023250     IF W-NGP > W-SDTD
023260         IF W-GD NOT = W-SDTG
023270             MOVE ZERO TO W-SDTD
023280             GO TO TM-EX                                          I.001102
023290*****        MOVE T-SS TO W-SDTP                                  D.001102
023300           ELSE
023310             ADD 1 TO W-SDTG
023320             GO TO TM-040.                                        I.001102
023330*****        GO TO TM-020.                                        D.001102
023340     IF W-SDATE NOT = ZERO                                        I.000922
023350         IF W-SDATE >= W-SDTD                                     I.000922
023360             ADD 1 TO W-SDTG
023370             GO TO TM-040.                                        I.001102
023380     GO TO TM-EX.                                                 I.001102
023390*****        GO TO TM-020.                                        D.001102
023400 TM-040.                                                          I.001102
023410     IF W-SDTG = 13                                               I.001102
023420         MOVE 1 TO W-SDTG                                         I.001102
023430         ADD 1 TO W-SDTN.                                         I.001102
023440     GO TO TM-020.                                                I.001102
023450 TM-EX.
023460     EXIT.
023470*------------------------------------------------------------------------
023480*TAZ-RTN.                                                         D.070124
023490*****IF W-DC NOT = 0                                              D.070124
023500*****    GO TO TAZ-EX.                                            D.070124
023510*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
023520*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
023530*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
023540*****    GO TO TAZ-EX.                                            D.070124
023550*****DISPLAY E-ME11 E-ME99.                                       D.070124
023560*TAZ-EX.                                                          D.070124
023570*****EXIT.                                                        D.070124
023580*------------------------------------------------------------------------
023590 TCM-RTN.
023600     IF W-CCDD = ZERO
023610         DISPLAY SU-CNA
023620*****    MOVE SPACE TO W-CNA                                      D.020425
023630         GO TO TCM-EX.
023640     MOVE 0 TO W-INV.
023650     MOVE W-TCDD TO TC-TCD.
023660     MOVE W-CCDD TO TC-CCD.
023670     READ TC-M WITH UNLOCK INVALID KEY
023680         MOVE SPACE TO TC-NAME
023690         MOVE 1 TO W-INV.
023700     DISPLAY AU-CCD DU-CNA.
023710*****MOVE TC-NAME TO W-CNA.                                       D.020425
023720*****IF W-CCDD = 001                                              D.020425
023730*****    MOVE SPACE TO W-CNA.                                     D.020425
023740     MOVE 9999999 TO TC-KEY.
023750     READ TC-M WITH UNLOCK INVALID KEY
023760         MOVE 9 TO W-INV.
023770 TCM-EX.
023780     EXIT.
023790*------------------------------------------------------------------------
023800 HI-RTN.
023810     MOVE W-HCD TO W-HCDD.
023820     IF W-HIC = 0                                                 I.020214
023830         IF W-UNCD = 0
023840             DISPLAY AU-HCD
023850           ELSE
023860             DISPLAY AN-HCD.
023870     IF W-HCD = ZERO
023880         MOVE 9 TO W-EC
023890         GO TO HI-EX.
023900     MOVE W-HCD TO HI-KEY.
023910     READ HI-M WITH UNLOCK INVALID KEY
023920         MOVE 9 TO W-EC
023930         GO TO HI-EX.
023940     IF W-HIC = 0                                                 I.020214
023950         IF W-UNCD = 0
023960             DISPLAY DU-HNA
023970           ELSE
023980             DISPLAY DN-HNA.
023990     MOVE HI-BC1 TO W-BC1.
024000     MOVE HI-BC2 TO W-BC2.
024010     MOVE HI-BC3 TO W-BC3.
024020     MOVE HI-BMC TO W-BMC.                                        I.020511
024030     MOVE HI-BMNO TO W-BMNO.                                      I.020511
024040     IF W-UNCD NOT = 0
024050         GO TO HI-EX.
024060     IF W-HCD < 999900
024070        IF HI-FT = ZERO
024080           DISPLAY E-ME7 E-ME98.
024090     IF W-DC NOT = 0 AND 3 AND 4 AND 5 AND 7
024100         IF W-HCD < 999900
024110            IF HI-FT = 1
024120                DISPLAY E-ME7 E-ME98.                             I.020418
024130*****           DISPLAY E-ME7 E-ME98                              D.020418
024140*****           MOVE 9 TO W-EC.                                   D.020418
024150*
024160     MOVE W-HCD TO HUH-KEY.                                       I.020215
024170     READ HUH-M WITH UNLOCK INVALID KEY                           I.020215
024180         DISPLAY E-ME28 E-ME99                                    I.020215
024190         DISPLAY E-CL                                             I.020215
024200         GO TO HI-EX.                                             I.020215
024210     IF (HUH-ZK NOT = ZERO) AND (HUH-ZS NOT = ZERO)               I.020215
024220         COMPUTE W-FTD = HUH-ZK / HUH-ZS                          I.020215
024230         IF HI-FT NOT = W-FTD                                     I.020215
024240             MOVE 9 TO W-EC                                       I.020215
024250             DISPLAY E-ME29 E-ME99                                I.020215
024260             DISPLAY E-CL                                         I.020215
024270             GO TO HI-EX.                                         I.020215
024280     IF (HUH-NK NOT = ZERO) AND (HUH-NS NOT = ZERO)               I.020215
024290         COMPUTE W-FTD = HUH-NK / HUH-NS                          I.020215
024300         IF HI-FT NOT = W-FTD                                     I.020215
024310             MOVE 9 TO W-EC                                       I.020215
024320             DISPLAY E-ME29 E-ME99                                I.020215
024330             DISPLAY E-CL                                         I.020215
024340             GO TO HI-EX.                                         I.020215
024350     IF (HUH-UG NOT = ZERO) AND (HUH-SS NOT = ZERO)               I.020215
024360         COMPUTE W-FTD = HUH-UG / HUH-SS                          I.020215
024370         IF HI-FT NOT = W-FTD                                     I.020215
024380             MOVE 9 TO W-EC                                       I.020215
024390             DISPLAY E-ME29 E-ME99                                I.020215
024400             DISPLAY E-CL                                         I.020215
024410             GO TO HI-EX.                                         I.020215
024420     IF (HUH-YK NOT = ZERO) AND (HUH-YS NOT = ZERO)               I.020215
024430         COMPUTE W-FTD = HUH-YK / HUH-YS                          I.020215
024440         IF HI-FT NOT = W-FTD                                     I.020215
024450             MOVE 9 TO W-EC                                       I.020215
024460             DISPLAY E-ME29 E-ME99                                I.020215
024470             DISPLAY E-CL.                                        I.020215
024480 HI-EX.
024490     EXIT.
024500*------------------------------------------------------------------------
024510 UPD-RTN.
024520     ADD 1 TO W-DNOD.
024530     MOVE ZERO TO W-RC.
024540 UPD-020.
024550     ADD 1 TO W-RC.
024560     IF W-RC > 6
024570         GO TO UPD-180.
024580     MOVE W-AS(W-RC) TO W-SR.
024590     IF W-DATE = ZERO
024600         GO TO UPD-180.
024610     MOVE W-DNOD TO W-DNO.
024620     MOVE W-SDTD TO W-SDT.
024630     MOVE W-HSCD TO W-HSC.
024640     IF W-UNCD = 0
024650         MOVE W-KOSUR TO W-KOSU
024660         MOVE W-FRCD TO W-FRC.
024670     MOVE W-UNCD TO W-UNC.
024680     MOVE W-SR TO S-R.
024690     WRITE S-R.
024700     IF ERR-STAT = "00"
024710         CALL "CBLTCLS" USING S-TRAN
024720         GO TO UPD-040.
024730     DISPLAY E-STAT E-ME16 E-ME99.
024740     GO TO UPD-900.
024750 UPD-040.
024760     IF W-UNCD = 1
024770         GO TO UPD-020.                                           I.000821
024780*****    GO TO UPD-180.                                           D.000821
024790     IF W-HCD = ZERO
024800         GO TO UPD-180.
024810*****IF W-DC NOT = 3 AND 4 AND 9                                  D.070124
024820*****    GO TO UPD-100.                                           D.070124
024830*****    GO TO UPD-020.                                           D.010419
024840*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
024850*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
024860*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
024870*****    GO TO UPD-060.                                           D.070124
024880*****GO TO UPD-100.                                               D.070124
024890*****GO TO UPD-020.                                               D.010419
024900*UPD-060.                                                         D.070124
024910*****MOVE ZERO TO TAZ-R                                           D.070124
024920*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
024930*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
024940*****MOVE W-CNG TO TAZ-NG.                                        D.070124
024950*****WRITE TAZ-R INVALID KEY                                      D.070124
024960*****    DISPLAY E-STAT E-ME10 E-ME99                             D.070124
024970*****    GO TO UPD-080.                                           D.070124
024980*****CALL "CBLTCLS" USING TAZ-M.                                  D.070124
024990*****GO TO UPD-100.                                               D.070124
025000*****GO TO UPD-020.                                               D.010419
025010*UPD-080.                                                         D.070124
025020*****IF ERR-STAT NOT = "24"                                       D.070124
025030*****    DISPLAY E-ME78 E-ME99                                    D.070124
025040*****    DISPLAY E-CL                                             D.070124
025050*****    GO TO UPD-100.                                           D.070124
025060*****    GO TO UPD-020.                                           D.010419
025070*****DISPLAY E-CL.                                                D.070124
025080*****CLOSE TAZ-M.                                                 D.070124
025090*****MOVE "TAZM         " TO W-FILE.                              D.070124
025100*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.070124
025110*****DISPLAY E-CL.                                                D.070124
025120*****OPEN I-O TAZ-M.                                              D.070124
025130*****GO TO UPD-060.                                               D.070124
025140*UPD-100.                                                         D.070124
025150     IF W-DC NOT = 0 AND 3                                        I.010419
025160         GO TO UPD-020.                                           I.010419
025170     IF ZERO = W-TCD OR W-HCD                                     I.010419
025180         GO TO UPD-020.                                           I.010419
025190     IF W-BT = ZERO                                               I.060629
025200         GO TO UPD-020.                                           I.060629
025210     MOVE SPACE TO THT-KEY.                                       I.010419
025220     MOVE W-TCD TO THT-TCD.                                       I.010419
025230     MOVE W-HCD TO THT-HCD.                                       I.010419
025240     MOVE 9 TO THT-SIZ.                                           I.010419
025250     READ THTM INVALID KEY                                        I.010419
025260         GO TO UPD-120.                                           I.010419
025270     GO TO UPD-160.                                               I.010419
025280 UPD-120.                                                         I.010419
025290     MOVE SPACE TO THT-KEY.                                       I.010419
025300     MOVE W-TCD TO THT-TCD.                                       I.010419
025310     MOVE W-HCD TO THT-HCD.                                       I.010419
025320     MOVE W-SIZ TO THT-SIZ.                                       I.010419
025330     READ THTM INVALID KEY                                        I.010419
025340         GO TO UPD-140.                                           I.010419
025350     GO TO UPD-160.                                               I.010419
025360 UPD-140.                                                         I.010419
025370     MOVE ZERO TO THT-R.                                          I.010419
025380     MOVE W-TCD TO THT-TCD THT-TCD2.                              I.010419
025390     MOVE W-HCD TO THT-HCD.                                       I.010419
025400     MOVE 9 TO THT-SIZ.                                           I.010419
025410     MOVE W-BT TO THT-T.                                          I.010419
025420     MOVE W-TC2 TO THT-TNC.                                       I.010419
025430     MOVE W-NGD TO THT-NG.                                        I.010419
025440     WRITE THT-R INVALID KEY                                      I.010419
025450         DISPLAY E-STAT E-ME26 E-ME99                             I.010419
025460         DISPLAY E-CL                                             I.010419
025470         GO TO UPD-020.                                           I.010419
025480     CALL "CBLTCLS" USING THTM.                                   I.010419
025490     GO TO UPD-020.                                               I.010419
025500 UPD-160.                                                         I.010419
025510     IF W-NGD NOT = THT-NG                                        I.010419
025520         MOVE W-NGD TO THT-NG                                     I.010419
025530         REWRITE THT-R INVALID KEY                                I.010419
025540             DISPLAY E-STAT E-ME27 E-ME99                         I.010419
025550             DISPLAY E-CL.                                        I.010419
025560     GO TO UPD-020.                                               I.010419
025570 UPD-180.
025580     INITIALIZE W-SR.
025590     MOVE W-BR TO W-DT1.
025600     MOVE W-DNOD TO W-DNO.
025610     MOVE 9 TO W-GNO.
025620     MOVE W-NGP TO W-DATE.
025630     MOVE W-TCDN TO W-TCD.
025640     MOVE W-UNCD TO W-UNC.
025650     MOVE W-SR TO S-R.
025660     WRITE S-R.
025670     IF ERR-STAT = "00"
025680         CALL "CBLTCLS" USING S-TRAN
025690         GO TO UPD-200.
025700     DISPLAY E-STAT E-ME16 E-ME99.
025710     GO TO UPD-900.
025720 UPD-200.
025730     OPEN I-O HKBM.
025740     MOVE SPACE TO HKB-KEY.
025750     MOVE "05" TO HKB-NO.
025760     READ HKBM INVALID KEY
025770         CLOSE HKBM
025780         MOVE 1 TO W-END
025790         DISPLAY E-ME78 E-ME23 E-ME99
025800         MOVE 255 TO COMPLETION-CODE
025810         GO TO UPD-EX.
025820     MOVE W-DNOD TO HKB-UNN.
025830     IF HKB-UNN = ZERO                                            I.010314
025840         MOVE 1 TO HKB-UNN.                                       I.010314
025850     REWRITE HKB-R INVALID KEY
025860         CLOSE HKBM
025870         MOVE 1 TO W-END
025880         DISPLAY E-STAT E-ME78 E-ME24 E-ME99
025890         MOVE 255 TO COMPLETION-CODE
025900         GO TO UPD-EX.
025910     CLOSE HKBM.
025920*
025930     IF (W-HMN = ZERO) OR (W-HNC = 1)                             I.081222
025940         GO TO UPD-EX.                                            I.081222
025950*****IF W-HMN = ZERO                                              D.011012
025960*****MOVE 0 TO W-HC.                                              D.081222
025970 UPD-220.                                                         I.011012
025980*****ADD 1 TO W-HC.                                               D.081222
025990*****IF W-HC > 6                                                  D.081222
026000*****    GO TO UPD-EX.                                            D.081222
026010*****IF W-HC = 1                                                  D.081222
026020*****    IF W-HMN NOT = ZERO                                      D.081222
026030*****        MOVE W-HMN TO HSMS-01                                D.081222
026040*****        GO TO UPD-230.                                       D.081222
026050*****IF W-HA(W-HC) = ZERO                                         D.081222
026060*****    GO TO UPD-EX.                                            D.081222
026070     MOVE SPACE TO HSMS-KEY.
026080     MOVE W-HMN TO HSMS-01.                                       I.011012
026090*****MOVE W-HMN TO HSMS-01.                                       D.011012
026100*****MOVE W-HA(W-HC) TO HSMS-01.                                  D.081222
026110 UPD-230.                                                         I.030418
026120     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
026130         GO TO UPD-EX.                                            I.081222
026140*****    GO TO UPD-220.                                           D.081222
026150*****    GO TO UPD-EX.                                            D.011012
026160 UPD-240.
026170     READ HSMSF NEXT RECORD AT END
026180         GO TO UPD-EX.                                            I.081222
026190*****    GO TO UPD-220.                                           D.081222
026200*****IF W-HC = 1                                                  D.081222
026210     IF W-HMN NOT = HSMS-01                                       I.030418
026220         GO TO UPD-EX.                                            I.081222
026230*****        GO TO UPD-220.                                       D.081222
026240*****IF W-HC NOT = 1                                              D.081222
026250*****    IF W-HA(W-HC) NOT = HSMS-01                              D.081222
026260*****        GO TO UPD-220.                                       D.081222
026270*****    GO TO UPD-EX.                                            D.011012
026280*****IF W-HMN NOT = HSMS-01                                       D.011012
026290*****    GO TO UPD-EX.                                            D.011012
026300     IF HSMS-19 = 9
026310         GO TO UPD-EX.                                            I.081222
026320*****    GO TO UPD-220.                                           D.081222
026330*****    GO TO UPD-EX.                                            D.011012
026340     ADD 1 TO HSMS-19.
026350     REWRITE HSMS-R1 INVALID KEY
026360         DISPLAY E-STAT E-ME22 E-ME99
026370         DISPLAY E-CL.
026380     GO TO UPD-240.
026390 UPD-900.
026400     PERFORM SD-RTN THRU SD-EX.
026410     MOVE 1 TO W-END.
026420 UPD-EX.
026430     EXIT.
