000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. TSG510.
000030**************************************
000040*****     手　形　日　計　表     *****
000050*****      ( FDL : FTG510 )      *****
000060**************************************
000070 AUTHOR. S-NAKAO.
000080 DATE-WRITTEN. ,78-03-19.
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT CALNM ASSIGN TO CALN-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE DYNAMIC
000190         RECORD KEY CL-KEY
000200         FILE STATUS IS ERR-STAT.
000210*****SELECT T-M ASSIGN TO T-MSD                                   D.000225
000220     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000225
000230         ORGANIZATION INDEXED                                     I.930906
000240         ACCESS MODE DYNAMIC                                      I.930906
000250         RECORD KEY T-KEY                                         I.930906
000260         ALTERNATE RECORD KEY T-KEY2                              I.000225
000270         FILE STATUS IS ERR-STAT.                                 I.930906
000280     SELECT UKET-M ASSIGN TO UKET-MSD
000290         ORGANIZATION INDEXED
000300         ACCESS MODE DYNAMIC
000310         RECORD KEY UT-KEY
000320         FILE STATUS IS ERR-STAT.
000330     SELECT SHIT-M ASSIGN TO SHIT-MSD
000340         ORGANIZATION INDEXED
000350         ACCESS MODE DYNAMIC
000360         RECORD KEY ST-KEY
000370         FILE STATUS IS ERR-STAT.
000380     SELECT TYB-F ASSIGN TO TYB-MSD.
000390     SELECT TDT-M ASSIGN TO TDT-MSD                               I.991105
000400         ORGANIZATION INDEXED                                     I.991105
000410         ACCESS MODE DYNAMIC                                      I.991105
000420         RECORD KEY TD-KEY.                                       I.991105
000430     SELECT SP-F ASSIGN TO P-PRN999-FTG510.
000440 I-O-CONTROL.
000450     APPLY SHARED-MODE ON M-DATE
000460     APPLY SHARED-MODE ON CALNM
000470     APPLY SHARED-MODE ON T-M                                     I.930906
000480     APPLY SHIFT-CODE  ON SP-F.
000490 DATA DIVISION.
000500 FILE SECTION.
000510     COPY LIBFDD.
000520*****COPY LICALN.                                                 D.970912
000530     COPY LICAL.                                                  I.970912
000540     COPY LITM.                                                   I.930906
000550     COPY LIUKET.
000560     COPY LISHIT.
000570     COPY LSPF.
000580 FD  TYB-F
000590*****BLOCK  6 RECORDS                                             D.970912
000600     BLOCK  5 RECORDS                                             I.970912
000610     LABEL RECORD IS STANDARD
000620     VALUE OF IDENTIFICATION "TYBF".
000630 01  YRIT-F.
000640     02  Y-BCD          PIC  9(004).
000650     02  Y-YKD          PIC  9(006).
000660     02  Y-YKDD  REDEFINES Y-YKD.
000670       03  Y-YNG        PIC  9(004).
000680       03  Y-YP         PIC  9(002).
000690     02  Y-MKD          PIC  9(006).
000700     02  Y-MKDD  REDEFINES Y-MKD.
000710       03  Y-MNG        PIC  9(004).
000720       03  Y-MP         PIC  9(002).
000730     02  Y-TCD          PIC  9(004).
000740     02  Y-TSC          PIC  9(002).
000750     02  Y-KEY          PIC  9(004).
000760     02  Y-KIN          PIC  9(010).
000770     02  Y-FC           PIC  9(001).
000780     02  F              PIC  X(006).                              I.970912
000790     02  Y-SNI          PIC  9(004).                              I.970912
000800     02  Y-SNM          PIC  9(004).                              I.970912
000810*****02  F              PIC  X(005).                              D.970912
000820 FD  TDT-M                                                        I.991105
000830     BLOCK  3 RECORDS                                             I.991105
000840     LABEL RECORD IS STANDARD                                     I.991105
000850     VALUE OF IDENTIFICATION "TDTM".                              I.991105
000860 01  TDT-R.                                                       I.991105
000870     02  TD-KEY.                                                  I.991105
000880       03  TD-TKC       PIC  9(002).                              I.991105
000890       03  TD-TNO       PIC  9(004).                              I.991105
000900     02  TD-TCD         PIC  9(004).                              I.991105
000910     02  TD-DATE        PIC  9(006).                              I.991105
000920     02  TD-NGP   REDEFINES TD-DATE.                              I.991105
000930       03  TD-NG        PIC  9(004).                              I.991105
000940       03  F            PIC  9(002).                              I.991105
000950     02  TD-MND         PIC  9(006).                              I.991105
000960     02  TD-KIN         PIC S9(010).                              I.991105
000970     02  TD-BKC         PIC  9(004).                              I.991105
000980     02  TD-FRN         PIC  N(024).                              I.991105
000990     02  TD-SAD.                                                  I.991105
001000       03  TD-S     OCCURS   7  PIC S9(008).                      I.991105
001010     02  TD-ZSHZ        PIC S9(007).                              I.991105
001020     02  TD-SSHZ        PIC S9(007).                              I.991105
001030     02  F              PIC  X(006).                              I.991105
001040     02  TD-SNEN        PIC  9(004).                              I.991105
001050     02  TD-HCR         PIC  9(001).                              I.991105
001060     02  TD-HCT         PIC  9(001).                              I.991105
001070     02  TD-HCK         PIC  9(001).                              I.991105
001080     02  TD-HCZ         PIC  9(001).                              I.991105
001090     02  TD-PC          PIC  9(001).                              I.991105
001100     02  TD-RSC         PIC  9(001).                              I.991105
001110 WORKING-STORAGE SECTION.
001120 01  HEAD1.
001130     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
001140     02  F              PIC  X(022) VALUE SPACE.
001150     02  H-NEN          PIC  N(002).
001160     02  F              PIC  N(001) VALUE NC"年".
001170     02  H-GET          PIC  N(002).
001180     02  F              PIC  N(002) VALUE NC"月分".
001190     02  F              PIC  X(003) VALUE SPACE.
001200     02  F              PIC  X(005) VALUE ""3FE04F40A0"".
001210     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".
001220     02  F              PIC  N(006) VALUE NC"手形　日計表".       C870428
001230     02  F              PIC  X(015) VALUE SPACE.
001240     02  F              PIC  X(005) VALUE "DATE ".
001250     02  H-DATE         PIC 99B99B99.
001260     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
001270     02  F              PIC  X(005) VALUE ""3FE04FE080"".
001280 01  HEAD2.
001290     02  F              PIC  X(001) VALUE SPACE.
001300     02  F              PIC  N(002) VALUE NC"日付".
001310     02  F              PIC  X(002) VALUE SPACE.
001320     02  F              PIC  N(004) VALUE NC"受手受取".
001330     02  F              PIC  X(004) VALUE SPACE.
001340     02  F              PIC  N(003) VALUE NC"割　引".
001350     02  F              PIC  X(002) VALUE SPACE.
001360     02  F              PIC  N(004) VALUE NC"割手決済".
001370     02  F              PIC  X(002) VALUE SPACE.
001380     02  F              PIC  N(004) VALUE NC"取立入金".
001390     02  F              PIC  X(004) VALUE SPACE.
001400*****02  F              PIC  N(003) VALUE NC"不渡他".             D.140311
001410     02  F              PIC  N(003) VALUE NC"取消他".             I.140311
001420     02  F              PIC  X(004) VALUE SPACE.
001430     02  F              PIC  N(003) VALUE NC"合　計".
001440     02  F              PIC  X(002) VALUE SPACE.
001450     02  F              PIC  N(004) VALUE NC"支手支払".
001460     02  F              PIC  X(002) VALUE SPACE.
001470     02  F              PIC  N(004) VALUE NC"支手決済".
001480 01  HEAD5.                                                       I.930906
001490     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".         I.930906
001500     02  F              PIC  X(002) VALUE SPACE.                  I.930906
001510     02  F              PIC  N(012) VALUE                         I.930906
001520          NC"（　割引手形買戻し分　）".                           I.930906
001530     02  F              PIC  X(065) VALUE SPACE.                  I.930906
001540 01  HEAD6.                                                       I.930906
001550     02  F              PIC  X(002) VALUE SPACE.                  I.930906
001560     02  F              PIC  N(002) VALUE NC"日付".               I.930906
001570     02  F              PIC  X(002) VALUE SPACE.                  I.930906
001580     02  F              PIC  N(002) VALUE NC"　№".               I.930906
001590     02  F              PIC  X(008) VALUE "   ｺｰﾄﾞ ".             I.930906
001600     02  F              PIC  N(008) VALUE NC"取　引　先　名　".   I.930906
001610     02  F              PIC  X(035) VALUE SPACE.                  I.020423
001620*****02  F              PIC  X(032) VALUE SPACE.                  D.020423
001630     02  F              PIC  N(004) VALUE NC"金　　額".           I.930906
001640     02  F              PIC  X(014) VALUE SPACE.                  I.020423
001650*****02  F              PIC  X(017) VALUE SPACE.                  D.020423
001660 01  HEAD7.                                                       I.940119
001670     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".         I.940119
001680     02  F              PIC  X(005) VALUE SPACE.                  I.940119
001690     02  F              PIC  N(015) VALUE                         I.940119
001700          NC"［　支払手形　期日別合計表　］".                     I.940119
001710     02  F              PIC  X(070) VALUE SPACE.                  I.940119
001720 01  HEAD8.                                                       I.940119
001730     02  F              PIC  X(018) VALUE SPACE.                  I.940119
001740     02  F              PIC  N(003) VALUE NC"満期日".             I.940119
001750     02  F              PIC  X(010) VALUE SPACE.                  I.940119
001760     02  F              PIC  N(003) VALUE NC"金　額".             I.940119
001770     02  F              PIC  X(065) VALUE SPACE.                  I.940119
001780 01  W-P1.
001790     02  F              PIC  X(001).
001800     02  P-TM           PIC  N(002).
001810     02  P-DATE  REDEFINES P-TM.
001820       03  P-X1         PIC  X(001).
001830       03  P-PEY        PIC Z9.
001840       03  P-X2         PIC  X(001).
001850     02  P-UU           PIC  Z(010).
001860     02  P-YB           PIC  Z(010).
001870     02  P-YK           PIC  Z(010).
001880     02  P-TN           PIC  Z(010).
001890     02  P-FT           PIC  Z(010).
001900     02  P-ST           PIC  Z(010).
001910     02  P-SS           PIC  Z(010).
001920     02  P-SK           PIC  Z(010).
001930 01  W-P2.                                                        I.930906
001940     02  P-15K          PIC  X(005).                              I.930906
001950     02  F              PIC  X(003).                              I.930906
001960     02  P-PEYD         PIC Z9.                                   I.930906
001970     02  F              PIC  X(002).                              I.930906
001980     02  P-KEY          PIC  9(004).                              I.930906
001990     02  F              PIC  X(002).                              I.930906
002000     02  P-TCD          PIC  9(004).                              I.930906
002010     02  F              PIC  X(001).                              I.930906
002020*****02  P-NAME         PIC  N(024).                              D.020423
002030     02  P-NAME         PIC  N(026).                              I.020423
002040     02  P-KIN          PIC ZZ,ZZZ,ZZZ,ZZZ.                       I.930906
002050 01  W-P3.                                                        I.940119
002060     02  P-NEN          PIC Z9.                                   I.940119
002070     02  P-NM           PIC  N(001).                              I.940119
002080     02  P-GET          PIC Z9.                                   I.940119
002090     02  P-GM           PIC  N(004).                              I.940119
002100     02  F              PIC  X(003).                              I.940119
002110     02  P-MKD          PIC 99/99/99.                             I.940119
002120     02  P-TMDD  REDEFINES  P-MKD.                                I.940119
002130       03  P-TMD        PIC  N(003).                              I.940119
002140       03  F            PIC  X(002).                              I.940119
002150     02  P-MKIN         PIC ZZZ,ZZZ,ZZZ,ZZ9.                      I.940000
002160 01  W-D.
002170     02  W-UU    OCCURS  31  PIC  9(010).
002180     02  W-YB    OCCURS  31  PIC  9(010).
002190     02  W-YK    OCCURS  31  PIC  9(010).
002200     02  W-TN    OCCURS  31  PIC  9(010).
002210     02  W-FT    OCCURS  31  PIC  9(010).
002220     02  W-ST    OCCURS  31  PIC  9(010).
002230     02  W-SS    OCCURS  31  PIC  9(010).
002240     02  W-SK    OCCURS  31  PIC  9(010).
002250 01  W-TD.
002260     02  WT-UU          PIC  9(010).
002270     02  WT-YB          PIC  9(010).
002280     02  WT-YK          PIC  9(010).
002290     02  WT-TN          PIC  9(010).
002300     02  WT-FT          PIC  9(010).
002310     02  WT-ST          PIC  9(010).
002320     02  WT-SS          PIC  9(010).
002330     02  WT-SK          PIC  9(010).
002340 01  W-YKMD.
002350     02  W-YKM   OCCURS  20.
002360       03  W-PEYD       PIC  9(002).                              I.930906
002370       03  W-KEY        PIC  9(004).                              I.930906
002380       03  W-TCD        PIC  9(004).                              I.930906
002390       03  W-KIN        PIC  9(010).                              I.930906
002400 01  W-DATA.
002410     02  W-NGP.
002420       03  W-NG.
002430*****    04  W-NEN      PIC  9(002).                              D.970912
002440         04  W-NEN      PIC  9(004).                              I.970912
002450         04  W-NENL  REDEFINES W-NEN.                             I.970912
002460           05  W-NEN1   PIC  9(002).                              I.970912
002470           05  W-NEN2   PIC  9(002).                              I.970912
002480         04  W-GET      PIC  9(002).
002490       03  W-NGL   REDEFINES W-NG.                                I.970912
002500         04  F          PIC  9(002).                              I.970912
002510         04  W-NGS      PIC  9(004).                              I.970912
002520       03  W-PEY        PIC  9(002).
002530*****02  W-NNG.                                                   D.970912
002540*****  03  W-NNEN       PIC  9(002).                              D.970912
002550*****  03  W-NGET       PIC  9(002).                              D.970912
002560     02  W-WNG.
002570       03  W-WNEN       PIC  9(002).
002580       03  W-WGET       PIC  9(002).
002590     02  W-UNG.                                                   I.970912
002600       03  W-UNEN       PIC  9(004).                              I.970912
002610       03  W-UGET       PIC  9(002).                              I.970912
002620     02  W-ING.                                                   I.970912
002630       03  W-INEN       PIC  9(004).                              I.970912
002640       03  W-IGET       PIC  9(002).                              I.970912
002650     02  W-FNG.                                                   I.970912
002660       03  W-FNEN       PIC  9(004).                              I.970912
002670       03  W-FGET       PIC  9(002).                              I.970912
002680     02  W-MNG.                                                   I.970912
002690       03  W-MNEN       PIC  9(004).                              I.970912
002700       03  W-MGET       PIC  9(002).                              I.970912
002710     02  W-DMM          PIC  9(001).
002720     02  CHK            PIC  9(002).
002730     02  CNT            PIC  9(002).
002740     02  W-NGD.
002750       03  W-NEND       PIC  Z(002).
002760       03  W-GETD       PIC  Z(002).
002770     02  W-DC           PIC  9(002).                              I.930906
002780     02  W-TKIN         PIC  9(010).                              I.930906
002790     02  W-SC           PIC  9(001).                              I.940119
002800     02  W-EC           PIC  9(001).                              I.940119
002810     02  W-C            PIC  9(002).                              I.940119
002820     02  W-SMD.                                                   I.940119
002830       03  W-SM    OCCURS  20.                                    I.940119
002840         04  W-MKD      PIC  9(006).                              I.940119
002850         04  W-MKIN     PIC  9(011).                              I.940119
002860         04  W-MC       PIC  9(001).                              I.940019
002870     02  W-MKDD         PIC  9(006).                              I.940119
002880     02  W-CD           PIC  9(002).                              I.940119
002890     02  W-AKIN         PIC  9(011).                              I.940119
002900 01  ERR-STAT           PIC  X(002).
002910     COPY LSTAT.
002920 SCREEN SECTION.
002930 SD  C-CRT
002940     END STATUS IS ESTAT.
002950 01  C-CLEAR.
002960     02  LINE   1  CLEAR SCREEN.
002970 01  C-MID.
002980     02  LINE   3  COLUMN  10  PIC  N(017) VALUE
002990          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003000     02  LINE   4  COLUMN  10  PIC  N(017) VALUE
003010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003020     02  LINE   5  COLUMN  10  PIC  N(017) VALUE
003030          NC"＊＊＊　　　　　　　　　　　＊＊＊".
003040     02  LINE   6  COLUMN  10  PIC  N(017) VALUE
003050          NC"＊＊＊　　手形　日計表　　　＊＊＊".
003060     02  LINE   7  COLUMN  10  PIC  N(017) VALUE
003070          NC"＊＊＊　　　　　　　　　　　＊＊＊".
003080     02  LINE   8  COLUMN  10  PIC  N(017) VALUE
003090          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003100     02  LINE   9  COLUMN  10  PIC  N(017) VALUE
003110          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003120     02  LINE  12.
003130       03  COLUMN  17  PIC  X(021) VALUE "[   H   年  月 分   ]".
003140       03  COLUMN  23  PIC  Z(002) FROM  W-WNEN.                  I.970912
003150       03  COLUMN  27  PIC  Z(002) FROM  W-WGET.                  I.970912
003160*****  03  COLUMN  23  PIC  9(002) FROM  W-NNEN.                  D.970912
003170*****  03  COLUMN  27  PIC  9(002) FROM  W-NGET.                  D.970912
003180 01  C-ERR.
003190     02  LINE  24.
003200       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
003210            "***  CALNM ﾅｼ  ***".
003220       03  E-ME2   COLUMN  15  PIC  X(035) VALUE
003230            "***  ﾜﾘﾃ ｶｲﾓﾄﾞｼ ﾃﾞｰﾀ ｶﾞ ｵｵｽｷﾞﾙ  ***".
003240       03  E-ME3   COLUMN  15  PIC  X(028) VALUE                  I.940119
003250            "***  ｼﾃ ﾏﾝｷﾋﾞ ｶﾞ ｵｵｽｷﾞﾙ  ***".                       I.940119
003260       03  E-ME4   COLUMN  15  PIC  X(028) VALUE                  I.991105
003270            "***  未変換データ　有り  ***".                       I.991105
003280       03  E-KEY   COLUMN  40  PIC  X(008) FROM  CL-KEY.          I.970912
003290*****  03  E-KEY   COLUMN  40  PIC  X(006) FROM  CL-KEY.          D.970912
003300       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003310       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003320     COPY LIBSCR.
003330 PROCEDURE DIVISION.
003340 M-05.
003350     COPY LIBCPR.
003360     MOVE DATE-04R TO H-DATE.
003370     MOVE ZERO TO W-NGP.                                          I.970912
003380     MOVE D-NTNG TO W-NGS.                                        I.970912
003390     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.970912
003400         ADD DATE-NC1 TO W-NEN.                                   I.970912
003410     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.970912
003420         ADD DATE-NC2 TO W-NEN.                                   I.970912
003430     COMPUTE W-WNEN = W-NEN - DATE-YC1.                           I.970912
003440     MOVE W-GET TO W-WGET.                                        I.970912
003450*****MOVE D-NTNG TO W-NG W-NNG W-WNG.                             D.970912
003460*****SUBTRACT 88 FROM W-NNEN.                                     D.970912
003470*****SUBTRACT 25 FROM W-WNEN.                                     D.970912
003480     DISPLAY C-CLEAR.
003490     DISPLAY C-MID.
003500     PERFORM S-45 THRU S-60.                                      I.991105
003510*****MOVE W-NNEN TO W-NEND.                                       D.970912
003520*****MOVE W-NGET TO W-GETD.                                       D.970912
003530     MOVE W-WNEN TO W-NEND.                                       I.970912
003540     MOVE W-WGET TO W-GETD.                                       I.970912
003550     MOVE W-NEND TO H-NEN.
003560     MOVE W-GETD TO H-GET.
003570*****DIVIDE 4 INTO W-NNEN GIVING CNT REMAINDER CHK.               D.970912
003580*****IF W-NGET = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12                D.970912
003590     DIVIDE 4 INTO W-NEN GIVING CNT REMAINDER CHK.                I.970912
003600     IF W-GET = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12                 I.970912
003610         MOVE 32 TO CNT.
003620*****IF W-NGET = 4 OR 6 OR 9 OR 11                                D.970912
003630     IF W-GET = 4 OR 6 OR 9 OR 11                                 I.970912
003640         MOVE 31 TO CNT.
003650*****IF W-NGET = 2                                                D.970912
003660     IF W-GET = 2                                                 I.970912
003670         IF CHK = ZERO
003680             MOVE 30 TO CNT
003690           ELSE
003700             MOVE 29 TO CNT.
003710     OPEN INPUT UKET-M.
003720     MOVE ZERO TO W-D W-TD W-SMD W-EC W-AKIN.                     C.940119
003730 M-15.
003740     READ UKET-M NEXT RECORD WITH UNLOCK AT END
003750         GO TO M-20.
003760*****IF UT-UNG = W-NNG OR W-WNG                                   D.970912
003770     MOVE UT-SNU TO W-UNEN.                                       I.970912
003780     MOVE UT-UTG TO W-UGET.                                       I.970912
003790     MOVE UT-SNI TO W-INEN.                                       I.970912
003800     MOVE UT-IDG TO W-IGET.                                       I.970912
003810     IF W-UNG = W-NG                                              I.970912
003820         ADD UT-KIN TO W-UU(UT-UTP).
003830*****IF UT-ING NOT = W-NNG AND W-WNG                              D.970912
003840     IF W-ING NOT = W-NG                                          I.970912
003850         GO TO M-15.
003860*****IF UT-SKC = 90                                               D.140311
003870*****    ADD UT-KIN TO W-FT(UT-IDP) W-ST(UT-IDP).                 D.140311
003880     IF UT-SKC = 19
003890         ADD UT-KIN TO W-TN(UT-IDP) W-ST(UT-IDP).
003900     IF UT-SKC NOT = 60
003910         GO TO M-15.
003920     IF UT-SBC = ZERO
003930         ADD UT-KIN TO W-FT(UT-IDP) W-ST(UT-IDP).
003940     GO TO M-15.
003950 M-20.
003960     CLOSE UKET-M.
003970     OPEN INPUT SHIT-M.
003980 M-25.
003990     READ SHIT-M NEXT RECORD WITH UNLOCK AT END
004000         GO TO M-30.
004010     IF ST-SKC = 90                                               I.940202
004020         GO TO M-25.                                              I.940202
004030     MOVE ST-SNF TO W-FNEN.                                       I.970912
004040     MOVE ST-FDG TO W-FGET.                                       I.970912
004050     MOVE ST-SNM TO W-MNEN.                                       I.970912
004060     MOVE ST-MKG TO W-MGET.                                       I.970912
004070*****IF ST-FNG = W-NNG OR W-WNG                                   D.970912
004080     IF W-FNG = W-NG                                              I.970912
004090         ADD ST-KIN TO W-SS(ST-FDP) W-AKIN                        C.930119
004100         PERFORM S-05 THRU S-15.                                  I.940119
004110*****IF ST-MNG = W-NNG OR W-WNG                                   D.970912
004120     IF W-MNG = W-NG                                              I.970912
004130         ADD ST-KIN TO W-SK(ST-MKP).
004140     GO TO M-25.
004150 M-30.
004160     CLOSE SHIT-M.
004170     OPEN INPUT TYB-F.
004180     MOVE ZERO TO W-YKMD W-DC W-TKIN.                             I.930906
004190 M-35.
004200     READ TYB-F AT END
004210         GO TO M-40.
004220     IF Y-MKD NOT = 999999
004230         ADD Y-KIN TO W-YB(Y-YP)
004240         GO TO M-35.
004250*****IF Y-FC = 1 OR 9                                             D.930906
004260*****    ADD Y-KIN TO W-FT(Y-YP) W-ST(Y-YP)                       D.930804
004270     IF Y-FC = 9                                                  I.930906
004280         GO TO M-35.
004290*****ADD Y-KIN TO W-YK(Y-YP) W-ST(Y-YP).                          D.930906
004300     IF Y-FC NOT = 1                                              I.930906
004310         ADD Y-KIN TO W-YK(Y-YP) W-ST(Y-YP)                       I.930906
004320         GO TO M-35.
004330     ADD 1 TO W-DC.                                               I.930906
004340     IF W-DC > 20                                                 I.930906
004350         DISPLAY E-ME2 E-ME99                                     I.930906
004360       ELSE                                                       I.930906
004370         MOVE Y-YP TO W-PEYD(W-DC)                                I.930906
004380         MOVE Y-KEY TO W-KEY(W-DC)                                I.930906
004390         MOVE Y-TCD TO W-TCD(W-DC)                                I.930906
004400         MOVE Y-KIN TO W-KIN(W-DC)                                I.930906
004410         ADD Y-KIN TO W-TKIN.                                     I.930906
004420     GO TO M-35.                                                  I.930906
004430 M-40.
004440     CLOSE TYB-F.
004450     OPEN INPUT CALNM.
004460     OPEN OUTPUT SP-F.
004470     MOVE SPACE TO SP-R.
004480     MOVE HEAD1 TO SP-R.
004490     WRITE SP-R.
004500     MOVE SPACE TO SP-R.
004510     MOVE HEAD2 TO SP-R.
004520     WRITE SP-R AFTER 2.
004530     MOVE SPACE TO SP-R.
004540     MOVE ZERO TO W-PEY.
004550 M-45.
004560     ADD 1 TO W-PEY.
004570     IF W-PEY = CNT
004580         GO TO M-50.
004590     MOVE W-NGP TO CL-KEY.
004600     READ CALNM WITH UNLOCK INVALID KEY
004610         DISPLAY E-ME1 E-KEY E-ME99
004620         MOVE 0 TO CL-SJ.
004630     MOVE SPACE TO W-P1.
004640     MOVE W-PEY TO P-PEY.
004650     IF CL-SJ = 1
004660         MOVE "(" TO P-X1
004670         MOVE ")" TO P-X2.
004680     MOVE W-UU(W-PEY) TO P-UU.
004690     MOVE W-YB(W-PEY) TO P-YB.
004700     MOVE W-YK(W-PEY) TO P-YK.
004710     MOVE W-TN(W-PEY) TO P-TN.
004720     MOVE W-FT(W-PEY) TO P-FT.
004730     MOVE W-ST(W-PEY) TO P-ST.
004740     MOVE W-SS(W-PEY) TO P-SS.
004750     MOVE W-SK(W-PEY) TO P-SK.
004760     MOVE SPACE TO SP-R.
004770     MOVE W-P1 TO SP-R.
004780     WRITE SP-R.
004790     ADD W-UU(W-PEY) TO WT-UU.
004800     ADD W-YB(W-PEY) TO WT-YB.
004810     ADD W-YK(W-PEY) TO WT-YK.
004820     ADD W-TN(W-PEY) TO WT-TN.
004830     ADD W-FT(W-PEY) TO WT-FT.
004840     ADD W-ST(W-PEY) TO WT-ST.
004850     ADD W-SS(W-PEY) TO WT-SS.
004860     ADD W-SK(W-PEY) TO WT-SK.
004870     GO TO M-45.
004880 M-50.
004890     CLOSE CALNM.                                                 I.930906
004900     COMPUTE CHK = 34 - CNT.
004910     MOVE SPACE TO W-P1.
004920     MOVE NC"合計" TO P-TM.
004930     MOVE WT-UU TO P-UU.
004940     MOVE WT-YB TO P-YB.
004950     MOVE WT-YK TO P-YK.
004960     MOVE WT-TN TO P-TN.
004970     MOVE WT-FT TO P-FT.
004980     MOVE WT-ST TO P-ST.
004990     MOVE WT-SS TO P-SS.
005000     MOVE WT-SK TO P-SK.
005010     MOVE SPACE TO SP-R.
005020     MOVE W-P1 TO SP-R.
005030     WRITE SP-R AFTER CHK.
005040     IF W-DC = ZERO                                               I.930906
005050         GO TO M-65.                                              C.940119
005060*
005070     MOVE SPACE TO SP-R.                                          I.90906
005080     MOVE HEAD5 TO SP-R.                                          I.930906
005090*****WRITE SP-R AFTER 4.                                          D.950302
005100     WRITE SP-R AFTER 2.                                          D.950302
005110     MOVE SPACE TO SP-R.                                          I.930906
005120     MOVE HEAD6 TO SP-R.                                          I.930906
005130     WRITE SP-R AFTER 2.                                          I.930906
005140     MOVE SPACE TO SP-R.                                          I.930906
005150     MOVE ZERO TO W-DC.                                           I.930906
005160     OPEN INPUT T-M.                                              I.930906
005170 M-55.                                                            I.930906
005180     ADD 1 TO W-DC.                                               I.930906
005190     IF W-DC > 20                                                 I.930906
005200         GO TO M-60.                                              I.930906
005210     IF W-PEYD(W-DC) = ZERO                                       I.930906
005220         GO TO M-60.                                              I.930906
005230     MOVE W-TCD(W-DC) TO T-KEY.                                   I.930906
005240     READ T-M WITH UNLOCK INVALID KEY                             I.930906
005250         MOVE SPACE TO T-NAME                                     I.930906
005260         MOVE NC"　＊＊＊　ＴＭ　なし　　＊＊＊　" TO T-NAME.     I.930906
005270     MOVE SPACE TO W-P2.                                          I.930906
005280     MOVE SPACE TO P-NAME.                                        I.930906
005290     MOVE W-15K TO P-15K.                                         I.930906
005300     MOVE W-PEYD(W-DC) TO P-PEYD.                                 I.930906
005310     MOVE W-KEY(W-DC) TO P-KEY.                                   I.930906
005320     MOVE W-TCD(W-DC) TO P-TCD.                                   I.930906
005330     MOVE T-NAME TO P-NAME.                                       I.930906
005340     MOVE W-KIN(W-DC) TO P-KIN.                                   I.930906
005350     MOVE SPACE TO SP-R.                                          I.930906
005360     MOVE W-P2 TO SP-R.                                           I.930906
005370     WRITE SP-R.                                                  I.930906
005380     MOVE SPACE TO SP-R.                                          I.930906
005390     GO TO M-55.                                                  I.930906
005400 M-60.                                                            I.930906
005410     CLOSE T-M.                                                   I.930906
005420     IF W-DC = 2                                                  I.930906
005430         GO TO M-65.                                              C.940119
005440     MOVE SPACE TO W-P2.                                          I.930906
005450     MOVE SPACE TO P-NAME.                                        I.930906
005460     MOVE W-15K TO P-15K.                                         I.930906
005470     MOVE NC"　　　　　　　　　　　　　　　（　計　）" TO P-NAME. I.930906
005480     MOVE W-TKIN TO P-KIN.                                        I.930906
005490     MOVE SPACE TO SP-R.                                          I.930906
005500     MOVE W-P2 TO SP-R.                                           I.930906
005510     WRITE SP-R.                                                  I.930906
005520     MOVE SPACE TO SP-R.                                          I.940119
005530 M-65.                                                            I.940119
005540     IF W-EC = 5                                                  I.940119
005550         GO TO M-95.                                              I.940119
005560     IF W-MKD(1) = ZERO                                           I.940119
005570         GO TO M-95.                                              I.940119
005580*****IF LINAGE-COUNTER > 60                                       D.950302
005590     IF LINAGE-COUNTER > 62                                       I.950302
005600         MOVE SPACE TO SP-R                                       I.940119
005610         WRITE SP-R AFTER PAGE.                                   I.940119
005620     MOVE SPACE TO SP-R.                                          I.940119
005630     MOVE HEAD7 TO SP-R.                                          I.940119
005640*****WRITE SP-R AFTER 4.                                          D.950302
005650     WRITE SP-R AFTER 2.                                          I.950302
005660     MOVE SPACE TO SP-R.                                          I.940119
005670     MOVE HEAD8 TO SP-R.                                          I.940119
005680     WRITE SP-R AFTER 2.                                          I.940119
005690     MOVE SPACE TO SP-R.                                          I.940119
005700     MOVE 0 TO W-SC.                                              I.940119
005710     PERFORM S-20 THRU S-40.                                      I.940119
005720 M-95.
005730*****CLOSE CALNM.                                                 D.930906
005740     CLOSE SP-F.
005750     DISPLAY C-CLEAR.
005760     STOP RUN.
005770 S-05.                                                            I.940119
005780     IF W-EC = 5                                                  I.940119
005790         GO TO S-15.                                              I.940119
005800     MOVE ZERO TO W-C.                                            I.940119
005810 S-10.                                                            I.940119
005820     ADD 1 TO W-C.                                                I.940119
005830     IF W-C = 21                                                  I.940119
005840         DISPLAY E-ME3 E-ME99                                     I.940119
005850         MOVE 5 TO W-EC                                           I.940119
005860         GO TO S-15.                                              I.940119
005870     IF W-MKD(W-C) = ZERO                                         I.940119
005880         MOVE 1 TO W-MC(W-C)                                      I.940119
005890         MOVE ST-MKD TO W-MKD(W-C)                                I.940119
005900         ADD ST-KIN TO W-MKIN(W-C)                                I.940119
005910         GO TO S-15.                                              I.940119
005920     IF W-MKD(W-C) = ST-MKD                                       I.940119
005930         ADD ST-KIN TO W-MKIN(W-C)                                I.940119
005940         GO TO S-15.                                              I.940119
005950     GO TO S-10.                                                  I.940119
005960 S-15.                                                            I.940119
005970     EXIT.                                                        I.940119
005980 S-20.                                                            I.940119
005990     MOVE 999999 TO W-MKDD.                                       I.940119
006000     MOVE ZERO TO W-C.                                            I.940119
006010 S-25.                                                            I.940119
006020     ADD 1 TO W-C.                                                I.940119
006030     IF W-C = 21                                                  I.940119
006040         GO TO S-30.                                              I.940119
006050     IF W-MC(W-C) = 0                                             I.940119
006060         GO TO S-25.                                              I.940119
006070     IF W-MKD(W-C) < W-MKDD                                       I.940119
006080         MOVE W-MKD(W-C) TO W-MKDD                                I.940119
006090         MOVE W-C TO W-CD.                                        I.940119
006100     GO TO S-25.                                                  I.940119
006110 S-30.                                                            I.940119
006120     IF W-MKDD = 999999                                           I.940119
006130         GO TO S-35.                                              I.940119
006140     MOVE SPACE TO W-P3.                                          I.940119
006150     IF W-SC = 0                                                  I.940119
006160         MOVE 5 TO W-SC                                           I.940119
006170*****    MOVE W-NNEN TO P-NEN                                     D.970912
006180         MOVE W-NEND TO P-NEN                                     I.970912
006190         MOVE NC"年" TO P-NM                                      I.940119
006200*****    MOVE W-NGET TO P-GET                                     D.970912
006210         MOVE W-GETD TO P-GET                                     I.970912
006220         MOVE NC"月振出し" TO P-GM.                               I.940119
006230     MOVE W-MKD(W-CD) TO P-MKD.                                   I.940119
006240     MOVE W-MKIN(W-CD) TO P-MKIN.                                 I.940119
006250     IF LINAGE-COUNTER > 62                                       I.940119
006260         MOVE SPACE TO SP-R                                       I.940119
006270         WRITE SP-R AFTER PAGE                                    I.940119
006280         MOVE SPACE TO SP-R                                       I.940119
006290         MOVE HEAD7 TO SP-R                                       I.940119
006300         WRITE SP-R                                               I.940119
006310         MOVE SPACE TO SP-R                                       I.940119
006320         MOVE HEAD8 TO SP-R                                       I.940119
006330         WRITE SP-R AFTER 2                                       I.940119
006340         MOVE SPACE TO SP-R                                       I.940119
006350         MOVE W-NEND TO P-NEN                                     I.940119
006360         MOVE NC"年" TO P-NM                                      I.940119
006370         MOVE W-GETD TO P-GET                                     I.940119
006380         MOVE NC"月振出し" TO P-GM.                               I.940119
006390     MOVE SPACE TO SP-R.                                          I.940119
006400     MOVE W-P3 TO SP-R.                                           I.940119
006410     WRITE SP-R.                                                  I.940119
006420     MOVE SPACE TO SP-R.                                          I.940119
006430     MOVE 0 TO W-MC(W-CD).                                        I.940119
006440     GO TO S-20.                                                  I.940119
006450 S-35.                                                            I.940119
006460     MOVE SPACE TO W-P3.                                          I.940119
006470     MOVE NC"（計）" TO P-TMD.                                    I.940119
006480     MOVE W-AKIN TO P-MKIN.                                       I.940119
006490     IF LINAGE-COUNTER > 62                                       I.940119
006500         MOVE SPACE TO SP-R                                       I.940119
006510         WRITE SP-R AFTER PAGE                                    I.940119
006520         MOVE SPACE TO SP-R                                       I.940119
006530         MOVE HEAD7 TO SP-R                                       I.940119
006540         WRITE SP-R                                               I.940119
006550         MOVE SPACE TO SP-R                                       I.940119
006560         MOVE HEAD8 TO SP-R                                       I.940119
006570         WRITE SP-R AFTER 2                                       I.940119
006580         MOVE SPACE TO SP-R                                       I.940119
006590         MOVE W-NEND TO P-NEN                                     I.940119
006600         MOVE NC"年" TO P-NM                                      I.940119
006610         MOVE W-GETD TO P-GET                                     I.940119
006620         MOVE NC"月振出し" TO P-GM.                               I.940119
006630     MOVE SPACE TO SP-R.                                          I.940119
006640     MOVE W-P3 TO SP-R.                                           I.940119
006650     WRITE SP-R.                                                  I.940119
006660     MOVE SPACE TO SP-R.                                          I.940119
006670 S-40.
006680     EXIT.                                                        I.940119
006690 S-45.                                                            I.991105
006700     OPEN INPUT TDT-M.                                            I.991105
006710 S-50.                                                            I.991105
006720     READ TDT-M NEXT RECORD AT END                                I.991105
006730         GO TO S-55.                                              I.991105
006740     IF TD-HCT NOT = 0                                            I.991105
006750         GO TO S-50.                                              I.991105
006760     IF TD-NG NOT = W-WNG                                         I.991105
006770         GO TO S-50.                                              I.991105
006780     DISPLAY E-ME4 E-ME99.                                        I.991105
006790 S-55.                                                            I.991105
006800     CLOSE TDT-M.                                                 I.991105
006810 S-60.                                                            I.991105
006820     EXIT.                                                        I.991105
