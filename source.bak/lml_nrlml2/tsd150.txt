000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. TSD150.
000030****************************************
000040*****     éËå`ÅEçwîÉéxï•Å@ïœä∑     *****
000050****************************************
000060 AUTHOR. S-NAKAO.
000070 DATE-WRITTEN. ,78-03-19.
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.
000150     SELECT CALNM ASSIGN TO CALN-MSD                              I.910911
000160         ORGANIZATION INDEXED                                     I.910911
000170         ACCESS MODE DYNAMIC                                      I.910911
000180         RECORD KEY CL-KEY.                                       I.910911
000190*****SELECT T-M ASSIGN TO T-MSD                                   D.000224
000200     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000224
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY T-KEY                                         I.000224
000240         ALTERNATE RECORD KEY T-KEY2.                             I.000224
000250*****    RECORD KEY T-KEY.                                        D.000224
000260     SELECT S-M ASSIGN TO S-MSD
000270         ORGANIZATION INDEXED
000280         ACCESS MODE RANDOM
000290         RECORD KEY S-KEY.
000300     SELECT TDT-M ASSIGN TO TDT-MSD
000310         ORGANIZATION INDEXED
000320         ACCESS MODE DYNAMIC
000330         RECORD KEY TD-KEY
000340         FILE STATUS IS ERR-STAT.
000350     SELECT UKET-M ASSIGN TO UKET-MSD
000360         ORGANIZATION INDEXED
000370         ACCESS MODE RANDOM
000380         RECORD KEY UT-KEY
000390         FILE STATUS IS ERR-STAT.
000400     SELECT SHIT-M ASSIGN TO SHIT-MSD
000410         ORGANIZATION INDEXED
000420         ACCESS MODE RANDOM
000430         RECORD KEY ST-KEY
000440         FILE STATUS IS ERR-STAT.
000450     SELECT TNO-M ASSIGN TO TNO-MSD
000460         ORGANIZATION INDEXED
000470         ACCESS MODE RANDOM
000480         RECORD KEY NO-KEY
000490         FILE STATUS IS ERR-STAT.
000500     SELECT JSS-F ASSIGN TO JSS-MSD
000510         FILE STATUS IS ERR-STAT.
000520*****SELECT TNK-F ASSIGN TO TNK-MSD                               D.991101
000530*****    FILE STATUS IS ERR-STAT.                                 D.991101
000540     SELECT BANK-M ASSIGN TO BANK-MSD                             I.960207
000550         ORGANIZATION INDEXED                                     I.960207
000560         ACCESS MODE RANDOM                                       I.960207
000570         RECORD KEY B-KEY                                         I.960207
000580         FILE STATUS IS ERR-STAT.                                 I.960207
000590 I-O-CONTROL.
000600     APPLY SHARED-MODE ON M-DATE
000610     APPLY SHARED-MODE ON CALNM                                   I.910911
000620     APPLY SHARED-MODE ON BANK-M                                  I.960207
000630     APPLY SHARED-MODE ON S-M
000640     APPLY SHARED-MODE ON T-M.
000650 DATA DIVISION.
000660 FILE SECTION.
000670     COPY LIBFDD.
000680*****COPY LICALN.                                                 D.970904
000690     COPY LICAL.                                                  I.970904
000700     COPY LISM.
000710     COPY LITM.
000720     COPY LIUKET.
000730     COPY LISHIT.
000740     COPY LIBANK.                                                 I.960207
000750 FD  TDT-M
000760     BLOCK  3 RECORDS
000770     LABEL RECORD IS STANDARD
000780     VALUE OF IDENTIFICATION "TDTM".
000790 01  TDT-R.
000800     02  TD-KEY.
000810       03  TD-TKC.
000820         04  TD-C1      PIC  9(001).
000830         04  TD-C2      PIC  9(001).
000840       03  TD-TNO       PIC  9(004).
000850     02  TD-TCD         PIC  9(004).
000860     02  TD-DATE        PIC  9(006).
000870     02  TD-NGP   REDEFINES TD-DATE.
000880       03  TD-NG.                                                 I.960207
000890*****  03  TD-NEN       PIC  9(002).                              D.960207
000900*****  03  TD-GET       PIC  9(002).                              D.960207
000910         04  TD-NEN     PIC  9(002).                              I.960207
000920         04  TD-GET     PIC  9(002).                              I.960207
000930       03  TD-PEY       PIC  9(002).
000940     02  TD-MND         PIC  9(006).
000950     02  TD-MNGP  REDEFINES TD-MND.
000960       03  TD-MN        PIC  9(002).
000970       03  TD-MG        PIC  9(002).
000980       03  TD-MP        PIC  9(002).
000990     02  TD-KIN         PIC S9(010).
001000     02  TD-BKC         PIC  9(004).
001010     02  TD-FRN         PIC  N(024).
001020     02  TD-SAD.
001030       03  TD-S     OCCURS   7  PIC S9(008).
001040     02  TD-ZSHZ        PIC S9(007).
001050     02  TD-SSHZ        PIC S9(007).
001060*****02  F              PIC  X(015).                              D.991102
001070*****02  F              PIC  X(007).                              D.991103
001080     02  F              PIC  X(006).                              I.991103
001090     02  TD-SNEN.                                                 I.991102
001100       03  TD-SNEN1     PIC  9(002).                              I.991102
001110       03  TD-SNEN2     PIC  9(002).                              I.991102
001120     02  TD-HCR         PIC  9(001).                              I.991102
001130     02  TD-HCT         PIC  9(001).                              I.991102
001140     02  TD-HCK         PIC  9(001).                              I.991102
001150     02  TD-HCZ         PIC  9(001).                              I.991103
001160     02  TD-PC          PIC  9(001).                              I.991102
001170     02  TD-RSC         PIC  9(001).
001180 FD  TNO-M
001190     BLOCK  1 RECORDS
001200     LABEL RECORD IS STANDARD
001210     VALUE OF IDENTIFICATION "TNOM".
001220 01  TNO-R.
001230     02  NO-KEY         PIC  X(002).
001240     02  NO-UMN         PIC  9(004).
001250     02  NO-SMN         PIC  9(004).
001260     02  NO-D.
001270       03  NO-UDN       PIC  9(004).
001280       03  NO-SDN       PIC  9(004).
001290*****  03  NO-HDN       PIC  9(004).                              D.991102
001300*****  03  NO-NDN       PIC  9(004).                              D.991102
001310     02  NO-HDN         PIC  9(004).                              I.991102
001320     02  NO-NDN         PIC  9(004).                              I.991102
001330     02  F              PIC  X(230).
001340 FD  JSS-F
001350*****BLOCK  3 RECORDS                                             D.970901
001360     BLOCK  5 RECORDS                                             I.970901
001370     LABEL RECORD IS STANDARD
001380     VALUE OF IDENTIFICATION "TJSSF".
001390 01  JSS-R.
001400     02  JS-DC          PIC  9(002).
001410*****02  JS-DATE        PIC  9(006).                              D.970901
001420     02  JS-DATE        PIC  9(008).                              I.970901
001430     02  JS-NGP   REDEFINES JS-DATE.
001440*****  03  JS-NEN       PIC  9(002).                              D.970901
001450       03  JS-NEN       PIC  9(004).                              I.970901
001460       03  F            PIC  X(004).
001470     02  JS-SCD.
001480       03  JS-SCD1      PIC  9(001).
001490       03  JS-SCD2      PIC  9(003).
001500     02  JS-JCD         PIC  9(006).
001510     02  F              PIC  X(017).
001520     02  JS-KIN         PIC S9(008).                              I.990520
001530     02  JS-SHZ         PIC S9(007).                              I.990531
001540*****02  JS-SHZ         PIC S9(006).                              D.990531
001550*****02  JS-KIN         PIC S9(009).                              D.990520
001560*****02  F              PIC  X(006).                              D.990520
001570     02  F              PIC  X(019).                              I.990520
001580     02  JS-YC          PIC  9(001).
001590     02  F              PIC  X(002).
001600     02  JS-SC          PIC  9(001).
001610     02  F              PIC  X(027).                              I.990531
001620*****02  F              PIC  X(028).                              D.990531
001630*****02  F              PIC  X(013).                              D.990520
001640*****02  JS-SHZ         PIC S9(007).                              D.990520
001650*****02  F              PIC  X(026).                              D.990520
001660*****02  F              PIC  X(011).                              D.970901
001670*FD  TNK-F                                                        D.991101
001680*****BLOCK  8 RECORDS                                             D.991101
001690*****LABEL RECORD IS STANDARD                                     D.991101
001700*****VALUE OF IDENTIFICATION "TNKF".                              D.991101
001710*01  TNK-R.                                                       D.991101
001720*****02  TN-DATE        PIC  9(006).                              D.991101
001730*****02  TN-TCD         PIC  9(004).                              D.991101
001740*****02  TN-KIN         PIC S9(009).                              D.991101
001750*****02  TN-SOC         PIC  9(001).                              D.991101
001760*****02  TN-SHC         PIC  9(001).                              D.991101
001770*****02  F              PIC  X(011).                              D.991101
001780 WORKING-STORAGE SECTION.
001790 77  W-DC               PIC  9(001) VALUE 0.
001800 01  ERR-STAT           PIC  X(002).
001810 01  W-DATA.
001820     02  W-D.
001830       03  W-UDN        PIC  9(004).
001840       03  W-SDN        PIC  9(004).
001850     02  W-FKC          PIC  X(002).
001860*****02  W-NGP          PIC  9(006).                              D.970909
001870     02  W-NGP          PIC  9(008).                              I.970909
001880     02  W-NGPD  REDEFINES W-NGP.
001890*****  03  W-NEN        PIC  9(002).                              D.970909
001900       03  F            PIC  9(002).                              I.970909
001910       03  W-NGPS       PIC  9(006).                              I.970909
001920     02  W-TNGP         PIC  9(008).                              I.970909
001930     02  W-TNGPD REDEFINES W-TNGP.                                I.970909
001940       03  W-TNEN       PIC  9(004).                              I.970909
001950       03  W-TGP        PIC  9(004).                              I.970909
001960     02  W-TNGPL REDEFINES W-TNGP.                                I.970909
001970       03  F            PIC  9(002).                              I.970909
001980       03  W-TNGPS      PIC  9(006).                              I.970909
001990     02  W-DNGP         PIC  9(008).                              I.970909
002000     02  W-DNGPD REDEFINES W-DNGP.                                I.970909
002010       03  W-DNEN       PIC  9(004).                              I.970909
002020       03  W-DGP        PIC  9(004).                              I.970909
002030     02  W-DNGPL REDEFINES W-DNGP.                                I.970909
002040       03  F            PIC  9(002).                              I.970909
002050       03  W-DNGPS      PIC  9(006).                              I.970909
002060*****  03  W-GET        PIC  9(002).                              D.970909
002070*****  03  W-PEY        PIC  9(002).                              D.970909
002080     02  W-KIN          PIC S9(009).
002090     02  W-DMM          PIC  9(001).
002100     02  W-CC           PIC  9(001) VALUE 0.                      I.940228
002110     02  W-EC           PIC  9(001) VALUE 0.
002120     02  W-SRC          PIC  9(001).                              I.080930
002130     02  W-FILE         PIC  X(013).                              I.930914
002140*****02  W-BNG          PIC  9(004).                              D.970904
002150*****02  W-BNGD  REDEFINES W-BNG.                                 D.970904
002160*****  03  W-BNEN       PIC  9(002).                              D.970904
002170     02  W-BNG.                                                   I.970904
002180       03  W-BNEN       PIC  9(004).                              I.970904
002190       03  W-BNENL REDEFINES W-BNEN.                              I.970904
002200         04  W-BNEN1    PIC  9(002).                              I.970904
002210         04  W-BNEN2    PIC  9(002).                              I.970904
002220       03  W-BGET       PIC  9(002).                              I.960207
002230     02  W-BNGL  REDEFINES W-BNG.                                 I.970904
002240       03  F            PIC  9(002).                              I.970904
002250       03  W-BNGS       PIC  9(004).                              I.970904
002260     02  W-ENG.                                                   I.970904
002270       03  W-ENEN       PIC  9(004).                              I.970904
002280       03  W-ENENL REDEFINES W-ENEN.                              I.970904
002290         04  W-ENEN1    PIC  9(002).                              I.970904
002300         04  W-ENEN2    PIC  9(002).                              I.970904
002310       03  W-EGET       PIC  9(002).                              I.960207
002320     02  W-ENGL  REDEFINES W-ENG.                                 I.970904
002330       03  F            PIC  9(002).                              I.970904
002340       03  W-ENGS       PIC  9(004).                              I.970904
002350     02  W-NTNG.                                                  I.991102
002360       03  W-NTN        PIC  9(002).                              I.991102
002370       03  W-NTG        PIC  9(002).                              I.991102
002380     02  W-NBNG.                                                  I.991102
002390       03  W-NBN        PIC  9(002).                              I.991102
002400       03  W-NBG        PIC  9(002).                              I.991102
002410     02  W-OKD          PIC  9(006).                              I.170421
002420     COPY LSTAT.
002430 SCREEN SECTION.
002440 SD  C-CRT
002450     END STATUS IS ESTAT.
002460 01  C-CLEAR.
002470     02  LINE   1  CLEAR SCREEN.
002480 01  C-MID.
002490*****02  LINE   3  COLUMN  10  PIC  N(024) VALUE                  D.991101
002500*****     NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".   D.991101
002510*****02  LINE   4  COLUMN  10  PIC  N(024) VALUE                  D.991101
002520*****     NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".   D.991101
002530*****02  LINE   5  COLUMN  10  PIC  N(024) VALUE                  D.991101
002540*****     NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".   D.991101
002550*****02  LINE   6  COLUMN  10  PIC  N(024) VALUE                  D.991101
002560*****     NC"ÅñÅñÅñÅ@Å@éÛéÊÅEéxï•éËå`É}ÉXÉ^Å[Å@çÏê¨Å@Å@ÅñÅñÅñ".   D.991101
002570*****02  LINE   7  COLUMN  10  PIC  N(024) VALUE                  D.991101
002580*****     NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".   D.991101
002590*****02  LINE   8  COLUMN  10  PIC  N(024) VALUE                  D.991101
002600*****     NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".   D.991101
002610*****02  LINE   9  COLUMN  10  PIC  N(024) VALUE                  D.991101
002620*****     NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".   D.991101
002630     02  LINE   3  COLUMN  10  PIC  N(020) VALUE                  I.991101
002640          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".           I.991101
002650     02  LINE   4  COLUMN  10  PIC  N(020) VALUE                  I.991101
002660          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".           I.991101
002670     02  LINE   5  COLUMN  10  PIC  N(020) VALUE                  I.991101
002680          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".           I.991101
002690     02  LINE   6  COLUMN  10  PIC  N(020) VALUE                  I.991101
002700          NC"ÅñÅñÅñÅ@Å@éËå`ÅEçwîÉéxï•Å@ïœä∑Å@Å@ÅñÅñÅñ".           I.991101
002710     02  LINE   7  COLUMN  10  PIC  N(020) VALUE                  I.991101
002720          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".           I.991101
002730     02  LINE   8  COLUMN  10  PIC  N(020) VALUE                  I.991101
002740          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".           I.991101
002750     02  LINE   9  COLUMN  10  PIC  N(020) VALUE                  I.991101
002760          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".           I.991101
002770     02  LINE  20  COLUMN  23  PIC  X(022) VALUE
002780          "ämîF  OK=1 NO=9   ÿ¿∞›".
002790 01  C-ACP.
002800     02  A-DMM   LINE  20  COLUMN  40  PIC  9(001)
002810          USING W-DMM   CHECK OVERFLOW NO IFC.
002820 01  C-ERR.
002830     02  LINE  24.
002840       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002850       03  E-ME1   COLUMN  15  PIC  X(026) VALUE
002860            "***  UKETM ∆ºﬁ≠≥ ƒ≥€∏  ***".
002870       03  E-ME2   COLUMN  15  PIC  X(026) VALUE
002880            "***  SHITM ∆ºﬁ≠≥ ƒ≥€∏  ***".
002890       03  E-ME3   COLUMN  15  PIC  X(015) VALUE
002900            "***  TM ≈º  ***".
002910       03  E-ME4   COLUMN  15  PIC  X(015) VALUE
002920            "***  SM ≈º  ***".
002930       03  E-ME5   COLUMN  15  PIC  X(023) VALUE
002940            "***  º√ ±≤√∂”∏ ¥◊∞  ***".
002950       03  E-ME6   COLUMN  15  PIC  X(025) VALUE
002960            "***  UKETM WRITE ¥◊∞  ***".
002970       03  E-ME7   COLUMN  15  PIC  X(025) VALUE
002980            "***  SHITM WRITE ¥◊∞  ***".
002990       03  E-ME8   COLUMN  15  PIC  X(018) VALUE                  I.910911
003000            "***  CALNM ≈º  ***".                                 I.910911
003010       03  E-ME9   COLUMN  15  PIC  X(018) VALUE
003020            "***  DATA ¥◊∞  ***".
003030       03  E-ME10  COLUMN  15  PIC  X(017) VALUE
003040            "***  TNOM ≈º  ***".
003050       03  E-ME11  COLUMN  15  PIC  X(026) VALUE
003060            "***  TNOM REWRITE ¥◊∞  ***".
003070       03  E-ME12  COLUMN  15  PIC  X(018) VALUE
003080            "***  DATEM ≈º  ***".
003090       03  E-ME13  COLUMN  15  PIC  X(027) VALUE
003100            "***  DATEM REWRITE ¥◊∞  ***".
003110*****  03  E-ME14  COLUMN  15  PIC  X(024) VALUE                  D.991101
003120*****       "***  TNKF WRITE ¥◊∞  ***".                           D.991101
003130       03  E-ME15  COLUMN  15  PIC  X(025) VALUE                  I.930914
003140            "***  JSSRF WRITE ¥◊∞  ***".                          I.930914
003150       03  E-ME16  COLUMN  15  PIC  X(027) VALUE                  I.960207
003160            "***  BANKM REWRITE ¥◊∞  ***".                        I.960207
003170       03  E-ME17  COLUMN  15  PIC  X(018) VALUE                  I.960207
003180            "***  BANKM ≈º  ***".                                 I.960207
003190       03  E-ME18  COLUMN  15  PIC  X(024) VALUE                  I.980223
003200            "***  SM REWRITE ¥◊∞  ***".                           I.980223
003210       03  E-ME21  COLUMN  15  PIC  X(026) VALUE                  I.991102
003220            "***  TDTM REWRITE ¥◊∞  ***".                         I.991102
003230       03  E-ME25  COLUMN  15  PIC  X(025) VALUE                  I.170510
003240            "***  UKETM µ¡∫–Àﬁ¥◊∞  ***".                          I.170510
003250       03  E-KEY   COLUMN  50  PIC  X(006) FROM  TD-KEY.
003260       03  E-TCD   COLUMN  50  PIC  X(004) FROM  TD-TCD.
003270*****  03  E-NGP   COLUMN  60  PIC  9(006) FROM  CL-KEY.          D.970909
003280       03  E-NGP   COLUMN  60  PIC  9(008) FROM  CL-KEY.          I.970909
003290       03  E-BKC   COLUMN  50  PIC  9(004) FROM  TD-BKC.          I.960207
003300       03  E-ME71.                                                I.930914
003310         04  COLUMN   1  PIC  X(013) FROM  W-FILE.                I.930914
003320         04  COLUMN  15  PIC  N(021) VALUE                        I.930914
003330              NC"ÉIÅ[ÉoÅ[ÉtÉçÅ[ÅAóÃàÊÇägí£ÇµÅAÇeÇmÇbÅ{çƒäJ".     I.930914
003340       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"òAóç".        I.930914
003350       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003360       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003370       03  E-CL.                                                  I.930914
003380         04  COLUMN   1  PIC  X(040) VALUE                        I.930914
003390              "                                        ".         I.930914
003400         04  COLUMN  41  PIC  X(040) VALUE                        I.930914
003410              "                                        ".         I.930914
003420     COPY LIBSCR.                                                 I.970923
003430 PROCEDURE DIVISION.
003440 M-05.
003450     DISPLAY C-CLEAR.
003460     DISPLAY C-MID.
003470 M-10.
003480     ACCEPT A-DMM.
003490     IF ESTAT = PF9                                               I.930809
003500         MOVE 255 TO COMPLETION-CODE                              I.000111
003510         GO TO M-95.                                              I.930809
003520     IF ESTAT NOT = HTB AND SKP
003530         GO TO M-10.
003540     IF W-DMM = 9
003550         MOVE 255 TO COMPLETION-CODE                              I.000111
003560         GO TO M-95.                                              I.930809
003570*****    DISPLAY C-CLEAR                                          D.930809
003580*****    STOP RUN.                                                D.930809
003590     IF W-DMM NOT = 1
003600         GO TO M-10.
003610*
003620*****OPEN INPUT T-M S-M CALNM.                                    D.980223
003630     OPEN INPUT T-M CALNM.                                        I.980223
003640     OPEN I-O S-M.                                                I.980223
003650*****OPEN INPUT TDT-M.                                            D.991102
003660     OPEN I-O TDT-M.                                              I.991102
003670     OPEN I-O UKET-M SHIT-M.
003680*****OPEN EXTEND TNK-F.                                           D.991101
003690     OPEN OUTPUT JSS-F.
003700     OPEN I-O BANK-M.                                             I.960207
003710     COPY LIBCPR.                                                 I.970923
003720     MOVE ZERO TO W-D W-NGP.
003730     MOVE D-NTNG TO W-NTNG.                                       I.991102
003740     MOVE D-NBNG TO W-NBNG.                                       I.991102
003750 M-15.
003760     READ TDT-M NEXT RECORD AT END
003770         GO TO M-85.                                              I.991102
003780*****    GO TO M-80.                                              D.991102
003790     IF TD-PC NOT = 5                                             I.991102
003800         GO TO M-15.                                              I.991102
003810*****IF (TD-HCT = 1) AND (TD-HCK = 1)                             D.000108
003820     IF (TD-HCT = 1 OR 9) AND (TD-HCK = 1 OR 9)                   I.000108
003830         GO TO M-15.                                              I.991102
003840     IF TD-C1 = 0                                                 I.991102
003850         GO TO M-15.                                              I.991102
003860*
003870*****IF TD-C1 NOT = 0                                             D.991102
003880*****    GO TO M-20.                                              D.991102
003890*****PERFORM S-240 THRU S-280.                                    D.991102
003900*****IF W-EC = 9                                                  D.960207
003910*****    GO TO M-85.                                              D.960207
003920*****GO TO M-15.                                                  D.960207
003930*****GO TO M-30.                                                  D.991102
003940*M-20.                                                            D.991102
003950     IF TD-C1 NOT = 1                                             ≥π√
003960         GO TO M-25.
003970*****IF TD-HCT = 1                                                D.000108
003980     IF TD-HCT = 1 OR 9                                           I.000108
003990         GO TO M-15.                                              I.991102
004000     IF (TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG)            I.991102
004010         GO TO M-15.                                              I.991102
004020     PERFORM S-160 THRU S-280.
004030*****IF W-EC NOT = 9                                              D.960207
004040*****    GO TO M-15.                                              D.960207
004050*****GO TO M-85.                                                  D.960207
004060     GO TO M-30.                                                  I.960207
004070 M-25.
004080     IF TD-C1 NOT = 2 AND 3                                       º√•º ◊≤
004090         DISPLAY E-ME9 E-KEY E-ME99
004100         GO TO M-15.
004110*****IF (TD-HCT = 1) AND (TD-HCK = 1)                             D.000108
004120     IF (TD-HCT = 1 OR 9) AND (TD-HCK = 1 OR 9)                   I.000108
004130         GO TO M-15.                                              I.991102
004140*****IF (TD-HCT NOT = 1) AND                                      D.000108
004150     IF (TD-HCT = 0) AND                                          I.000108
004160        ((TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG))          I.991102
004170         GO TO M-15.                                              I.991102
004180*****IF (TD-HCK NOT = 1) AND                                      D.000108
004190     IF (TD-HCK = 0) AND                                          I.000108
004200        ((TD-SNEN2 NOT = W-NBN) OR (TD-GET NOT = W-NBG))          I.991102
004210         GO TO M-15.                                              I.991102
004220     PERFORM S-300 THRU S-500.                                      C.9402
004230 M-30.                                                            I.960207
004240*****IF W-EC NOT = 9                                              D.960207
004250*****    GO TO M-15.                                              D.960207
004260     IF W-EC = 9                                                  I.960207
004270         GO TO M-85.
004280     IF TD-BKC = ZERO                                             I.960207
004290         GO TO M-15.                                              I.960207
004300     MOVE TD-BKC TO B-KEY.                                        I.960207
004310     READ BANK-M INVALID KEY                                      I.960207
004320         DISPLAY E-ME17 E-BKC E-ME99                              I.960207
004330         DISPLAY E-CL                                             I.960207
004340         GO TO M-15.                                              I.960207
004350*****MOVE TD-NG TO W-BNG.                                         D.970904
004360*****ADD 88 TO W-BNEN.                                            D.970904
004370*****IF W-BNG NOT > B-NG                                          D.970904
004380     MOVE ZERO TO W-ENG.                                          I.970904
004390     MOVE B-NG TO W-ENGS.                                         I.970904
004400     IF B-NG NOT = ZERO                                           I.980223
004410         IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                   I.970904
004420             ADD DATE-NC1 TO W-ENEN.                              I.970904
004430     IF B-NG NOT = ZERO                                           I.980223
004440         IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                   I.970904
004450             ADD DATE-NC2 TO W-ENEN.                              I.970904
004460     MOVE ZERO TO W-BNG.                                          I.970904
004470     MOVE TD-NG TO W-BNGS.                                        I.970904
004480     IF W-BNEN2 >= DATE-YF1 AND <= DATE-YT1                       I.970904
004490         ADD DATE-YC1 TO W-BNEN                                   I.970904
004500       ELSE                                                       I.970904
004510         IF W-BNEN2 >= DATE-YF2 AND <= DATE-YT2                   I.970904
004520             ADD DATE-YC2 TO W-BNEN.                              I.970904
004530     IF W-BNG NOT > W-ENG                                         I.970904
004540         GO TO M-15.                                              I.960207
004550     MOVE W-BNGS TO B-NG.                                         I.970904
004560*****MOVE W-BNG TO B-NG.                                          D.970904
004570     REWRITE BANK-R INVALID KEY                                   I.960207
004580         DISPLAY E-STAT E-ME16 E-BKC E-ME99                       I.960207
004590         DISPLAY E-CL.                                            I.960207
004600     GO TO M-15.                                                  I.960207
004610*M-80.                                                            D.991102
004620*****CLOSE TDT-M.                                                 D.991102
004630*****OPEN OUTPUT TDT-M.                                           D.991102
004640 M-85.
004650     CLOSE T-M S-M CALNM.                                         C.910911
004660     CLOSE TDT-M.
004670     CLOSE UKET-M SHIT-M.
004680     CLOSE JSS-F.                                                 I.991101
004690*****CLOSE JSS-F TNK-F.                                           D.991101
004700     CLOSE BANK-M.                                                I.960207
004710*
004720     OPEN I-O TNO-M.
004730     MOVE "01" TO NO-KEY.
004740     READ TNO-M INVALID KEY
004750         DISPLAY E-ME78 E-ME10 E-ME99                             C.930914
004760         GO TO M-95.
004770*****IF NO-UMN < W-UDN                                            D.950202
004780     IF ((NO-UMN < W-UDN) OR (NO-UMN = 9999)) OR                  I.950202
004790        ((NO-UMN > 9900) AND (W-UDN < 0100))                      I.991102
004800         MOVE W-UDN TO NO-UMN.
004810*****IF NO-SMN < W-SDN                                            D.950202
004820     IF ((NO-SMN < W-SDN) OR (NO-SMN = 9999)) OR                  I.950202
004830        ((NO-SMN > 9900) AND (W-SDN < 0100))                      I.991102
004840         MOVE W-SDN TO NO-SMN.
004850     MOVE ZERO TO NO-D.
004860     REWRITE TNO-R INVALID KEY
004870         DISPLAY E-ME78 E-STAT E-ME11 E-ME99.                     C.930914
004880     CLOSE TNO-M.
004890 M-90.
004900     OPEN I-O M-DATE.
004910     MOVE "01" TO DATE-KEY.
004920     READ M-DATE INVALID KEY
004930         DISPLAY E-ME78 E-ME12 E-ME99                             C.930914
004940         CLOSE M-DATE
004950         GO TO M-95.
004960     MOVE ZERO TO W-DNGP.                                         I.970909
004970     MOVE D-TGD TO W-DNGPS.                                       I.970909
004980     IF W-DNEN >= DATE-NF1 AND <= DATE-NT1                        I.970909
004990         ADD DATE-NC1 TO W-DNEN.                                  I.970909
005000     IF W-DNEN >= DATE-NF2 AND <= DATE-NT2                        I.970909
005010         ADD DATE-NC2 TO W-DNEN.                                  I.970909
005020     IF W-NGP > W-DNGP                                            I.970909
005030         MOVE W-NGPS TO D-TGD.                                    I.970909
005040*****IF W-NEN > 62                                                D.970909
005050*****    ADD 25 TO W-NEN                                          D.970909
005060*****  ELSE                                                       D.970909
005070*****    ADD 88 TO W-NEN.                                         D.970909
005080*****IF W-NGP > D-TGD                                             D.970909
005090*****    MOVE W-NGP TO D-TGD.                                     D.970909
005100     REWRITE DATE-R INVALID KEY
005110         DISPLAY E-ME78 E-STAT E-ME13 E-ME99.                     C.930914
005120     CLOSE M-DATE.
005130 M-95.
005140*****OPEN INPUT JSS-F.                                            D.000111
005150*****READ JSS-F AT END                                            D.000111
005160*****    MOVE 255 TO COMPLETION-CODE.                             D.000111
005170*****CLOSE JSS-F.                                                 D.000111
005180     IF W-DC = 0                                                  I.930809
005190         MOVE 255 TO COMPLETION-CODE.                             I.930809
005200     DISPLAY C-CLEAR.
005210     STOP RUN.
005220 S-020.
005230     MOVE ZERO TO JSS-R.
005240     IF TD-C1 = 2
005250         MOVE 4 TO JS-SC.
005260     IF TD-TKC = 30
005270         MOVE 1 TO JS-SC.
005280     IF TD-TKC = 31
005290         MOVE 2 TO JS-SC.
005300     IF TD-TKC = 32
005310         MOVE 3 TO JS-SC.
005320     IF TD-TKC = 33
005330         MOVE 5 TO JS-SC.
005340     IF TD-TKC = 34
005350         MOVE 6 TO JS-SC.
005360     MOVE 30 TO JS-DC.
005370     MOVE TD-DATE TO JS-DATE.
005380     MOVE TD-SNEN TO JS-NEN.                                      I.991102
005390*****IF JS-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
005400*****    ADD DATE-YC1 TO JS-NEN                                   D.991102
005410*****  ELSE                                                       D.991102
005420*****    IF JS-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
005430*****        ADD DATE-YC2 TO JS-NEN.                              D.991102
005440*****IF TD-NEN > 62                                               D.970909
005450*****    ADD 25 TO JS-NEN                                         D.970901
005460*****    ADD 1925 TO JS-NEN                                       D.970909
005470*****  ELSE                                                       D.970909
005480*****    ADD 1988 TO JS-NEN.                                      D.970909
005490*****    ADD 88 TO JS-NEN.                                        D.970901
005500     MOVE TD-TCD TO JS-SCD.
005510 S-040.
005520     EXIT.
005530 S-060.
005540     MOVE ZERO TO JSS-R.
005550     MOVE 10 TO JS-DC.
005560     MOVE TD-DATE TO JS-DATE.
005570     MOVE TD-SNEN TO JS-NEN.                                      I.991102
005580*****IF JS-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
005590*****    ADD DATE-YC1 TO JS-NEN                                   D.991102
005600*****  ELSE                                                       D.991102
005610*****    IF JS-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
005620*****        ADD DATE-YC2 TO JS-NEN.                              D.991102
005630*****IF TD-NEN > 62                                               D.970909
005640*****    ADD 25 TO JS-NEN                                         D.970901
005650*****    ADD 1925 TO JS-NEN                                       D.970909
005660*****  ELSE                                                       D.970909
005670*****    ADD 1988 TO JS-NEN.                                      D.970909
005680*****    ADD 88 TO JS-NEN.                                        D.970901
005690     MOVE TD-TCD TO JS-SCD.
005700     MOVE 999000 TO JS-JCD.
005710     MOVE 5 TO JS-YC.
005720 S-080.
005730     EXIT.
005740 S-100.                                                            I.91091
005750     MOVE UT-SNM TO CL-NEN.                                       I.910911
005760     MOVE UT-MKG TO CL-GET.                                       I.910911
005770     MOVE UT-MKP TO CL-PEY.                                       I.910911
005780     READ CALNM WITH UNLOCK INVALID KEY                           I.910911
005790         DISPLAY E-ME78 E-ME8 E-NGP E-ME99                        I.910911
005800         GO TO S-140.                                              I.91091
005810     IF CL-SJ = 0                                                 I.910911
005820*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
005830         MOVE CL-NGPS TO W-OKD                                    I.170510
005840         GO TO S-140.                                              I.91091
005850 S-120.                                                            I.91091
005860     READ CALNM NEXT RECORD WITH UNLOCK AT END                    I.910911
005870         DISPLAY E-ME78 E-ME8 E-KEY E-NGP E-ME99                  I.910911
005880         MOVE UT-SNM TO CL-NEN                                    I.910911
005890         MOVE UT-MKG TO CL-GET                                    I.910911
005900         MOVE UT-MKP TO CL-PEY                                    I.910911
005910*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
005920         MOVE CL-NGPS TO W-OKD                                    I.170510
005930         GO TO S-140.                                              I.91091
005940     IF CL-SJ = 1                                                 I.910911
005950         GO TO S-120.                                              I.91091
005960     IF UT-MKG = CL-GET                                           I.170421
005970*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
005980         MOVE CL-NGPS TO W-OKD                                    I.170510
005990         GO TO S-140.                                             I.170421
006000     MOVE ZERO TO CL-KEY.                                         I.170421
006010     MOVE UT-SNM TO CL-NEN.                                       I.170421
006020     MOVE UT-MKG TO CL-GET.                                       I.170421
006030     MOVE UT-MKP TO CL-PEY.                                       I.170421
006040     START CALNM KEY NOT < CL-KEY INVALID KEY                     I.170421
006050         DISPLAY E-ME9 E-ME99                                     I.170421
006060*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
006070         MOVE CL-NGPS TO W-OKD                                    I.170510
006080         GO TO S-140.                                             I.170421
006090 S-130.                                                           1.170421
006100     READ CALNM NEXT RECORD WITH UNLOCK AT END
006110         DISPLAY E-ME78 E-ME8 E-NGP E-ME99                        I.170421
006120         MOVE UT-SNM TO CL-NEN                                    I.170421
006130         MOVE UT-MKG TO CL-GET                                    I.170421
006140         MOVE UT-MKP TO CL-PEY                                    I.170421
006150*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
006160         MOVE CL-NGPS TO W-OKD                                    I.170510
006170         GO TO S-140.                                             I.170421
006180     IF UT-MKG = CL-GET                                           I.170421
006190*****    MOVE CL-NGPS TO UT-OKD                                   D.170510
006200         MOVE CL-NGPS TO W-OKD                                    I.170510
006210         GO TO S-130.                                             I.170421
006220 S-140.                                                            I.91091
006230     EXIT.
006240*****---------------------------------------------------------------------
006250 S-160.
006260     MOVE TD-TNO TO UT-KEY.
006270     READ UKET-M INVALID KEY
006280         GO TO S-180.
006290     DISPLAY E-ME1 E-KEY E-ME99
006300     GO TO S-280.
006310 S-180.
006320     MOVE TD-TCD TO T-KEY.
006330     READ T-M WITH UNLOCK INVALID KEY
006340         DISPLAY E-ME3 E-KEY E-TCD E-ME99
006350         MOVE ZERO TO T-FKC.
006360 S-200.                                                            I.93091
006370     INITIALIZE UKET-R.
006380     MOVE TD-TNO TO UT-KEY.
006390     MOVE TD-TKC TO UT-TSC.
006400     MOVE TD-BKC TO UT-BCD.
006410     MOVE T-FKC TO UT-FKC.
006420     MOVE TD-TCD TO UT-TCD.
006430     MOVE TD-FRN TO UT-FDM.
006440     MOVE TD-KIN TO UT-KIN.
006450     MOVE TD-DATE TO UT-UTD.
006460     MOVE TD-MND TO UT-MKD.
006470     MOVE TD-SNEN TO UT-SNU.                                      I.991102
006480*****IF TD-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
006490*****    COMPUTE UT-SNU = TD-NEN + DATE-YC1                       D.991102
006500*****  ELSE                                                       D.991102
006510*****    IF TD-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
006520*****        COMPUTE UT-SNU = TD-NEN + DATE-YC2.                  D.991102
006530     IF TD-MN >= DATE-YF1 AND <= DATE-YT1                         I.970909
006540         COMPUTE UT-SNM = TD-MN + DATE-YC1                        I.970909
006550       ELSE                                                       I.970909
006560         IF TD-MN >= DATE-YF2 AND <= DATE-YT2                     I.970909
006570             COMPUTE UT-SNM = TD-MN + DATE-YC2.                   I.970909
006580*****IF TD-NEN > 62                                               D.970909
006590*****    COMPUTE UT-SNU = TD-NEN + 25                             D.970909
006600*****  ELSE                                                       D.970909
006610*****    COMPUTE UT-SNU = TD-NEN + 88.                            D.970909
006620*****IF TD-MN > 62                                                D.970909
006630*****    COMPUTE UT-SNM = TD-MN + 25                              D.970909
006640*****  ELSE                                                       D.970909
006650*****    COMPUTE UT-SNM = TD-MN + 88.                             D.970909
006660     PERFORM S-100 THRU S-140.                                      I.9109
006670*****MOVE CL-KEY TO UT-OKD.                                       D.970909
006680*****MOVE CL-NGPS TO UT-OKD.                                      D.170421
006690     IF W-OKD = ZERO                                              I.170510
006700         DISPLAY E-ME25 E-KEY E-ME99                              I.170510
006710         DISPLAY E-CL.                                            I.170510
006720     MOVE W-OKD TO UT-OKD.                                        I.170421
006730     WRITE UKET-R INVALID KEY
006740         DISPLAY E-STAT E-ME6 E-KEY E-ME99
006750         GO TO S-220.                                              I.93091
006760     CALL "CBLTCLS" USING UKET-M.                                 I.930809
006770     IF TD-TNO > W-UDN
006780         MOVE TD-TNO TO W-UDN.
006790     MOVE ZERO TO W-TNGP.                                         I.970909
006800     MOVE TD-DATE TO W-TNGPS.                                     I.970909
006810     IF W-TNEN >= DATE-YF1 AND <= DATE-YT1                        I.970909
006820         ADD DATE-YC1 TO W-TNEN                                   I.970909
006830       ELSE                                                       I.970909
006840         IF W-TNEN >= DATE-YF2 AND <= DATE-YT2                    I.970909
006850             ADD DATE-YC2 TO W-TNEN.                              I.970909
006860     IF W-TNGP > W-NGP                                            I.970909
006870         MOVE W-TNGP TO W-NGP.                                    I.970909
006880*****IF TD-DATE > W-NGP                                           D.970909
006890*****    MOVE TD-DATE TO W-NGP.                                   D.970909
006900*****IF TD-RSC = 9                                                D.991101
006910     MOVE 1 TO TD-HCT.                                            I.991102
006920     REWRITE TDT-R INVALID KEY                                    I.991102
006930         MOVE 9 TO W-EC                                           I.991102
006940         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
006950     GO TO S-280.
006960*****GO TO S-240.                                                 D.991101
006970 S-220.                                                            I.93091
006980     IF ERR-STAT NOT = "24"                                       I.930914
006990         DISPLAY E-ME78 E-ME99                                    I.930914
007000         MOVE 9 TO W-EC
007010         GO TO S-280.                                              C.93091
007020     DISPLAY E-CL.                                                I.930914
007030     CLOSE UKET-M.                                                I.930914
007040     MOVE "UKETM        " TO W-FILE.                              I.930914
007050     DISPLAY E-ME71 E-ME98 STOP " ".                              I.930914
007060     DISPLAY E-CL.                                                I.930914
007070     OPEN I-O UKET-M.                                             I.930914
007080     GO TO S-200.                                                  I.93091
007090*S-240.                                                           D.991101
007100*****INITIALIZE TNK-R.                                            D.991101
007110*****MOVE TD-DATE TO TN-DATE.                                     D.991101
007120*****MOVE TD-TCD TO TN-TCD.                                       D.991101
007130*****MOVE TD-KIN TO TN-KIN.                                       D.991101
007140*****IF TD-TKC = 07                                               D.991101
007150*****    MOVE 5 TO TN-SOC.                                        D.991101
007160*****MOVE TD-RSC TO TN-SHC.                                       D.991101
007170*****WRITE TNK-R.                                                 D.991101
007180*****IF ERR-STAT NOT = "00"                                       D.991101
007190*****    DISPLAY E-STAT E-ME14 E-ME99                             D.991101
007200*****    GO TO S-260.                                             D.991101
007210*****CALL "CBLTCLS" USING TNK-F.                                  D.991101
007220*****GO TO S-280.                                                 D.991101
007230*S-260.                                                           D.991101
007240*****IF ERR-STAT NOT = "34"                                       D.991101
007250*****    DISPLAY E-ME78 E-ME99                                    D.991101
007260*****    MOVE 9 TO W-EC                                           D.991101
007270*****    GO TO S-280.                                             D.991101
007280*****DISPLAY E-CL.                                                D.991101
007290*****CLOSE TNK-F.                                                 D.991101
007300*****MOVE "TNKF         " TO W-FILE.                              D.991101
007310*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.991101
007320*****DISPLAY E-CL.                                                D.991101
007330*****OPEN EXTEND TNK-F.                                           D.991101
007340*****GO TO S-240.                                                 D.991101
007350 S-280.
007360     EXIT.
007370*****---------------------------------------------------------------------
007380 S-300.
007390     MOVE 0 TO W-SRC.                                             I.080930
007400     MOVE TD-TCD TO S-KEY.
007410*****READ S-M WITH UNLOCK INVALID KEY                             D.980223
007420     READ S-M INVALID KEY                                         I.980223
007430         DISPLAY E-ME4 E-KEY E-TCD E-ME99
007440*****    MOVE ZERO TO S-FKC S-KKC                                 D.080829
007450         MOVE ZERO TO S-FKC                                       I.080829
007460         GO TO S-310.                                             I.980223
007470*****    MOVE ZERO TO S-FKC S-KKC.                                D.980223
007480     MOVE ZERO TO W-ENG.                                          I.980223
007490     MOVE S-ENG TO W-ENGS.                                        I.980223
007500     IF S-ENG NOT = ZERO                                          I.980223
007510         IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                   I.980223
007520             ADD DATE-NC1 TO W-ENEN.                              I.980223
007530     IF S-ENG NOT = ZERO                                          I.980223
007540         IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                   I.980223
007550             ADD DATE-NC2 TO W-ENEN.                              I.980223
007560     MOVE ZERO TO W-BNG.                                          I.980223
007570     MOVE TD-NG TO W-BNGS.                                        I.980223
007580     IF W-BNEN2 >= DATE-YF1 AND <= DATE-YT1                       I.980223
007590         ADD DATE-YC1 TO W-BNEN                                   I.980223
007600       ELSE                                                       I.980223
007610         IF W-BNEN2 >= DATE-YF2 AND <= DATE-YT2                   I.980223
007620             ADD DATE-YC2 TO W-BNEN.                              I.980223
007630     IF W-BNG > W-ENG                                             I.080930
007640         MOVE 1 TO W-SRC                                          I.080930
007650         MOVE W-BNGS TO S-ENG.                                    I.080930
007660     IF TD-C1 = 2                                                 I.080930
007670         IF S-TGC = 0                                             I.080930
007680             MOVE 1 TO W-SRC                                      I.080930
007690             MOVE 1 TO S-TGC.                                     I.080930
007700*****IF W-BNG NOT > W-ENG                                         D.080930
007710     IF W-SRC = 0                                                 I.080930
007720         GO TO S-310.                                             I.980223
007730*****MOVE W-BNGS TO S-ENG.                                        D.080930
007740     REWRITE S-R INVALID KEY                                      I.980223
007750         DISPLAY E-STAT E-ME18 E-ME99                             I.980223
007760         DISPLAY E-CL.                                            I.980223
007770 S-310.                                                           I.980223
007780     IF TD-C1 = 3
007790         GO TO S-360.
007800*****IF (TD-HCT = 1) OR                                           D.000108
007810     IF (TD-HCT = 1 OR 9) OR                                      I.000108
007820        ((TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG))          I.991102
007830         GO TO S-360.                                             I.991102
007840     MOVE TD-TNO TO ST-KEY.
007850     READ SHIT-M INVALID KEY
007860         GO TO S-320.
007870     DISPLAY E-ME2 E-KEY E-ME99.
007880     GO TO S-500.                                                  C.94022
007890 S-320.
007900     INITIALIZE SHIT-R.
007910     MOVE TD-TNO TO ST-KEY.
007920     MOVE TD-TKC TO ST-TSC.
007930     MOVE TD-BKC TO ST-BCD.
007940     MOVE S-FKC TO ST-FKC.
007950     MOVE TD-TCD TO ST-TCD.
007960     MOVE TD-KIN TO ST-KIN.
007970     MOVE TD-DATE TO ST-FDD.
007980     MOVE TD-MND TO ST-MKD.
007990     MOVE TD-SAD TO ST-UKD.
008000     ADD TD-ZSHZ TO ST-UK(1).
008010     ADD TD-SSHZ TO ST-UK(2).
008020     MOVE TD-SNEN TO ST-SNF.                                      I.991102
008030*****IF TD-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
008040*****    COMPUTE ST-SNF = TD-NEN + DATE-YC1                       D.991102
008050*****  ELSE                                                       D.991102
008060*****    IF TD-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
008070*****        COMPUTE ST-SNF = TD-NEN + DATE-YC2.                  D.991102
008080     IF TD-MN >= DATE-YF1 AND <= DATE-YT1                         I.970909
008090         COMPUTE ST-SNM = TD-MN + DATE-YC1                        I.970909
008100       ELSE                                                       I.970909
008110         IF TD-MN >= DATE-YF2 AND <= DATE-YT2                     I.970909
008120             COMPUTE ST-SNM = TD-MN + DATE-YC2.                   I.970909
008130*****IF TD-NEN > 62                                               D.970909
008140*****    COMPUTE ST-SNF = TD-NEN + 25                             D.970909
008150*****  ELSE                                                       D.970909
008160*****    COMPUTE ST-SNF = TD-NEN + 88.                            D.970909
008170*****IF TD-MN > 62                                                D.970909
008180*****    COMPUTE ST-SNM = TD-MN + 25                              D.970909
008190*****  ELSE                                                       D.970909
008200*****    COMPUTE ST-SNM = TD-MN + 88.                             D.970909
008210     WRITE SHIT-R INVALID KEY
008220         DISPLAY E-STAT E-ME7 E-KEY E-ME99
008230*****    MOVE 9 TO W-EC                                           D.940228
008240*****    GO TO S-480.                                              D.94022
008250         GO TO S-340.                                              I.94022
008260     CALL "CBLTCLS" USING SHIT-M.                                 I.930809
008270     IF TD-TNO > W-SDN
008280         MOVE TD-TNO TO W-SDN.
008290     MOVE ZERO TO W-TNGP.                                         I.970909
008300     MOVE TD-DATE TO W-TNGPS.                                     I.970909
008310     IF W-TNEN >= DATE-YF1 AND <= DATE-YT1                        I.970909
008320         ADD DATE-YC1 TO W-TNEN                                   D.991102
008330*****    ADD DATE-YC1 TO W-TNEN.                                  D.991102
008340       ELSE                                                       I.991102
008350         IF W-TNEN >= DATE-YF2 AND <= DATE-YT2                    I.970909
008360             ADD DATE-YC2 TO W-TNEN.                              I.970909
008370     IF W-TNGP > W-NGP                                            I.970909
008380         MOVE W-TNGP TO W-NGP.                                    I.970909
008390*****IF TD-DATE > W-NGP                                           D.970909
008400*****    MOVE TD-DATE TO W-NGP.                                   D.970909
008410     MOVE 1 TO TD-HCT.                                            I.991102
008420     REWRITE TDT-R INVALID KEY                                    I.991102
008430         MOVE 9 TO W-EC                                           I.991102
008440         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
008450     GO TO S-360.                                                  I.94022
008460 S-340.                                                            I.94022
008470     IF ERR-STAT NOT = "24"                                       I.940228
008480         DISPLAY E-ME78 E-ME99                                    I.940228
008490         MOVE 9 TO W-EC                                           I.940228
008500         GO TO S-500.                                              I.94022
008510     DISPLAY E-CL.                                                I.940228
008520     CLOSE SHIT-M.                                                I.940228
008530     MOVE "SHITM        " TO W-FILE.                              I.940228
008540     DISPLAY E-ME71 E-ME98 STOP " ".                              I.940228
008550     DISPLAY E-CL.                                                I.940228
008560     OPEN I-O SHIT-M.                                             I.940228
008570     GO TO S-320.                                                  I.94022
008580 S-360.
008590*****IF S-KKC = 1                                                 D.080829
008600     IF TD-TCD = 1905                                             I.080829
008610         GO TO S-500.                                              C.94022
008620*****IF (TD-HCK = 1) OR                                           D.000108
008630     IF (TD-HCK = 1 OR 9) OR                                      I.000108
008640        ((TD-SNEN2 NOT = W-NBN) OR (TD-GET NOT = W-NBG))          I.991102
008650         GO TO S-500.                                             I.991102
008660     IF ZERO NOT = TD-S(1) OR TD-ZSHZ
008670         GO TO S-380.
008680     IF ZERO NOT = TD-S(2) OR TD-SSHZ
008690         GO TO S-440.
008700     IF TD-C1 = 3
008710         DISPLAY E-ME5 E-KEY E-ME99.
008720     GO TO S-500.                                                  C.94022
008730 S-380.
008740     PERFORM S-020 THRU S-040.
008750     MOVE TD-S(1) TO JS-KIN.
008760     MOVE TD-ZSHZ TO JS-SHZ.
008770     WRITE JSS-R.
008780     IF ERR-STAT NOT = "00"                                       I.940228
008790         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008800         MOVE 1 TO W-CC                                           I.940228
008810         GO TO S-480.                                              I.94022
008820     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008830     IF W-DC = 0                                                  I.930809
008840         MOVE 9 TO W-DC.                                          I.930809
008850     IF TD-ZSHZ = ZERO
008860         GO TO S-420.
008870 S-400.                                                            I.94022
008880     PERFORM S-060 THRU S-080.
008890     MOVE TD-ZSHZ TO JS-SHZ.
008900     WRITE JSS-R.
008910     IF ERR-STAT NOT = "00"                                       I.940228
008920         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008930         MOVE 2 TO W-CC                                           I.940228
008940         GO TO S-480.                                              I.94022
008950     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008960 S-420.
008970     IF ZERO = TD-S(2) AND TD-SSHZ
008980         GO TO S-490.                                             I.991102
008990*****    GO TO S-500.                                             D.991102
009000 S-440.
009010     PERFORM S-020 THRU S-040.
009020     ADD 5 TO JS-SCD1.
009030     MOVE TD-S(2) TO JS-KIN.
009040     MOVE TD-SSHZ TO JS-SHZ.
009050     WRITE JSS-R.
009060     IF ERR-STAT NOT = "00"                                       I.940228
009070         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
009080         MOVE 3 TO W-CC                                           I.940228
009090         GO TO S-480.                                              I.94022
009100     CALL "CBLTCLS" USING JSS-F.                                  I.930809
009110     IF W-DC = 0                                                  I.930809
009120         MOVE 9 TO W-DC.                                          I.930809
009130     IF TD-SSHZ = ZERO
009140         GO TO S-490.                                             I.991102
009150*****    GO TO S-500.                                             D.991102
009160 S-460.                                                            I.94022
009170     PERFORM S-060 THRU S-080.
009180     ADD 5 TO JS-SCD1.
009190     MOVE TD-SSHZ TO JS-SHZ.
009200     WRITE JSS-R.
009210     IF ERR-STAT NOT = "00"                                       I.940228
009220         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
009230         MOVE 4 TO W-CC                                           I.940228
009240         GO TO S-480.                                              I.94022
009250     CALL "CBLTCLS" USING JSS-F.                                  I.930809
009260     GO TO S-490.                                                 I.991102
009270*****GO TO S-500.                                                 D.991102
009280 S-480.
009290*****EXIT.                                                        D.940228
009300     IF ERR-STAT NOT = "34"                                       I.940228
009310         DISPLAY E-ME78 E-ME99                                    I.940228
009320         MOVE 9 TO W-EC                                           I.940228
009330         GO TO S-500.                                              I.94022
009340     DISPLAY E-CL.                                                I.940228
009350     CLOSE JSS-F.                                                 I.940228
009360     MOVE "TJSSF        " TO W-FILE.                              I.940228
009370     DISPLAY E-ME71 E-ME98 STOP " ".                              I.940228
009380     DISPLAY E-CL.                                                I.940228
009390     OPEN EXTEND JSS-F.                                           I.940228
009400     IF W-CC = 1                                                  I.940228
009410         GO TO S-380.                                              I.94022
009420     IF W-CC = 2                                                  I.940228
009430         GO TO S-400.                                              I.94022
009440     IF W-CC = 3                                                  I.940228
009450         GO TO S-440.                                              I.94022
009460     IF W-CC = 4                                                  I.940228
009470         GO TO S-460.                                              I.94022
009480     GO TO S-500.                                                 I.991102
009490 S-490.                                                           I.991102
009500     MOVE 1 TO TD-HCK.                                            I.991102
009510     REWRITE TDT-R INVALID KEY                                    I.991102
009520         MOVE 9 TO W-EC                                           I.991102
009530         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
009540 S-500.                                                            I.94022
009550     EXIT.                                                        I.940228
