000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. TSD150.
000030****************************************
000040*****     手形・購買支払　変換     *****
000050****************************************
000060 AUTHOR. S-NAKAO.
000070 DATE-WRITTEN. ,78-03-19.
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.
000150     SELECT CALNM ASSIGN TO CALN-MSD                              I.910911
000160         ORGANIZATION INDEXED                                     I.910911
000170         ACCESS MODE DYNAMIC                                      I.910911
000180         RECORD KEY CL-KEY.                                       I.910911
000190*****SELECT T-M ASSIGN TO T-MSD                                   D.000224
000200     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000224
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY T-KEY                                         I.000224
000240         ALTERNATE RECORD KEY T-KEY2.                             I.000224
000250*****    RECORD KEY T-KEY.                                        D.000224
000260     SELECT S-M ASSIGN TO S-MSD
000270         ORGANIZATION INDEXED
000280         ACCESS MODE RANDOM
000290         RECORD KEY S-KEY.
000300     SELECT TDT-M ASSIGN TO TDT-MSD
000310         ORGANIZATION INDEXED
000320         ACCESS MODE DYNAMIC
000330         RECORD KEY TD-KEY
000340         FILE STATUS IS ERR-STAT.
000350     SELECT UKET-M ASSIGN TO UKET-MSD
000360         ORGANIZATION INDEXED
000370         ACCESS MODE RANDOM
000380         RECORD KEY UT-KEY
000390         FILE STATUS IS ERR-STAT.
000400     SELECT SHIT-M ASSIGN TO SHIT-MSD
000410         ORGANIZATION INDEXED
000420         ACCESS MODE RANDOM
000430         RECORD KEY ST-KEY
000440         FILE STATUS IS ERR-STAT.
000450     SELECT TNO-M ASSIGN TO TNO-MSD
000460         ORGANIZATION INDEXED
000470         ACCESS MODE RANDOM
000480         RECORD KEY NO-KEY
000490         FILE STATUS IS ERR-STAT.
000500     SELECT JSS-F ASSIGN TO JSS-MSD
000510         FILE STATUS IS ERR-STAT.
000520*****SELECT TNK-F ASSIGN TO TNK-MSD                               D.991101
000530*****    FILE STATUS IS ERR-STAT.                                 D.991101
000540     SELECT BANK-M ASSIGN TO BANK-MSD                             I.960207
000550         ORGANIZATION INDEXED                                     I.960207
000560         ACCESS MODE RANDOM                                       I.960207
000570         RECORD KEY B-KEY                                         I.960207
000580         FILE STATUS IS ERR-STAT.                                 I.960207
000590 I-O-CONTROL.
000600     APPLY SHARED-MODE ON M-DATE
000610     APPLY SHARED-MODE ON CALNM                                   I.910911
000620     APPLY SHARED-MODE ON BANK-M                                  I.960207
000630     APPLY SHARED-MODE ON S-M
000640     APPLY SHARED-MODE ON T-M.
000650 DATA DIVISION.
000660 FILE SECTION.
000670     COPY LIBFDD.
000680*****COPY LICALN.                                                 D.970904
000690     COPY LICAL.                                                  I.970904
000700     COPY LISM.
000710     COPY LITM.
000720     COPY LIUKET.
000730     COPY LISHIT.
000740     COPY LIBANK.                                                 I.960207
000750 FD  TDT-M
000760     BLOCK  3 RECORDS
000770     LABEL RECORD IS STANDARD
000780     VALUE OF IDENTIFICATION "TDTM".
000790 01  TDT-R.
000800     02  TD-KEY.
000810       03  TD-TKC.
000820         04  TD-C1      PIC  9(001).
000830         04  TD-C2      PIC  9(001).
000840       03  TD-TNO       PIC  9(004).
000850     02  TD-TCD         PIC  9(004).
000860     02  TD-DATE        PIC  9(006).
000870     02  TD-NGP   REDEFINES TD-DATE.
000880       03  TD-NG.                                                 I.960207
000890*****  03  TD-NEN       PIC  9(002).                              D.960207
000900*****  03  TD-GET       PIC  9(002).                              D.960207
000910         04  TD-NEN     PIC  9(002).                              I.960207
000920         04  TD-GET     PIC  9(002).                              I.960207
000930       03  TD-PEY       PIC  9(002).
000940     02  TD-MND         PIC  9(006).
000950     02  TD-MNGP  REDEFINES TD-MND.
000960       03  TD-MN        PIC  9(002).
000970       03  TD-MG        PIC  9(002).
000980       03  TD-MP        PIC  9(002).
000990     02  TD-KIN         PIC S9(010).
001000     02  TD-BKC         PIC  9(004).
001010     02  TD-FRN         PIC  N(024).
001020     02  TD-SAD.
001030       03  TD-S     OCCURS   7  PIC S9(008).
001040     02  TD-ZSHZ        PIC S9(007).
001050     02  TD-SSHZ        PIC S9(007).
001060*****02  F              PIC  X(015).                              D.991102
001070*****02  F              PIC  X(007).                              D.991103
001080     02  F              PIC  X(006).                              I.991103
001090     02  TD-SNEN.                                                 I.991102
001100       03  TD-SNEN1     PIC  9(002).                              I.991102
001110       03  TD-SNEN2     PIC  9(002).                              I.991102
001120     02  TD-HCR         PIC  9(001).                              I.991102
001130     02  TD-HCT         PIC  9(001).                              I.991102
001140     02  TD-HCK         PIC  9(001).                              I.991102
001150     02  TD-HCZ         PIC  9(001).                              I.991103
001160     02  TD-PC          PIC  9(001).                              I.991102
001170     02  TD-RSC         PIC  9(001).
001180 FD  TNO-M
001190     BLOCK  1 RECORDS
001200     LABEL RECORD IS STANDARD
001210     VALUE OF IDENTIFICATION "TNOM".
001220 01  TNO-R.
001230     02  NO-KEY         PIC  X(002).
001240     02  NO-UMN         PIC  9(004).
001250     02  NO-SMN         PIC  9(004).
001260     02  NO-D.
001270       03  NO-UDN       PIC  9(004).
001280       03  NO-SDN       PIC  9(004).
001290*****  03  NO-HDN       PIC  9(004).                              D.991102
001300*****  03  NO-NDN       PIC  9(004).                              D.991102
001310     02  NO-HDN         PIC  9(004).                              I.991102
001320     02  NO-NDN         PIC  9(004).                              I.991102
001330     02  F              PIC  X(230).
001340 FD  JSS-F
001350*****BLOCK  3 RECORDS                                             D.970901
001360     BLOCK  5 RECORDS                                             I.970901
001370     LABEL RECORD IS STANDARD
001380     VALUE OF IDENTIFICATION "TJSSF".
001390 01  JSS-R.
001400     02  JS-DC          PIC  9(002).
001410*****02  JS-DATE        PIC  9(006).                              D.970901
001420     02  JS-DATE        PIC  9(008).                              I.970901
001430     02  JS-NGP   REDEFINES JS-DATE.
001440*****  03  JS-NEN       PIC  9(002).                              D.970901
001450       03  JS-NEN       PIC  9(004).                              I.970901
001460       03  F            PIC  X(004).
001470     02  JS-SCD.
001480       03  JS-SCD1      PIC  9(001).
001490       03  JS-SCD2      PIC  9(003).
001500     02  JS-JCD         PIC  9(006).
001510     02  F              PIC  X(017).
001520     02  JS-KIN         PIC S9(008).                              I.990520
001530     02  JS-SHZ         PIC S9(007).                              I.990531
001540*****02  JS-SHZ         PIC S9(006).                              D.990531
001550*****02  JS-KIN         PIC S9(009).                              D.990520
001560*****02  F              PIC  X(006).                              D.990520
001570     02  F              PIC  X(019).                              I.990520
001580     02  JS-YC          PIC  9(001).
001590     02  F              PIC  X(002).
001600     02  JS-SC          PIC  9(001).
001610     02  F              PIC  X(027).                              I.990531
001620*****02  F              PIC  X(028).                              D.990531
001630*****02  F              PIC  X(013).                              D.990520
001640*****02  JS-SHZ         PIC S9(007).                              D.990520
001650*****02  F              PIC  X(026).                              D.990520
001660*****02  F              PIC  X(011).                              D.970901
001670*FD  TNK-F                                                        D.991101
001680*****BLOCK  8 RECORDS                                             D.991101
001690*****LABEL RECORD IS STANDARD                                     D.991101
001700*****VALUE OF IDENTIFICATION "TNKF".                              D.991101
001710*01  TNK-R.                                                       D.991101
001720*****02  TN-DATE        PIC  9(006).                              D.991101
001730*****02  TN-TCD         PIC  9(004).                              D.991101
001740*****02  TN-KIN         PIC S9(009).                              D.991101
001750*****02  TN-SOC         PIC  9(001).                              D.991101
001760*****02  TN-SHC         PIC  9(001).                              D.991101
001770*****02  F              PIC  X(011).                              D.991101
001780 WORKING-STORAGE SECTION.
001790 77  W-DC               PIC  9(001) VALUE 0.
001800 01  ERR-STAT           PIC  X(002).
001810 01  W-DATA.
001820     02  W-D.
001830       03  W-UDN        PIC  9(004).
001840       03  W-SDN        PIC  9(004).
001850     02  W-FKC          PIC  X(002).
001860*****02  W-NGP          PIC  9(006).                              D.970909
001870     02  W-NGP          PIC  9(008).                              I.970909
001880     02  W-NGPD  REDEFINES W-NGP.
001890*****  03  W-NEN        PIC  9(002).                              D.970909
001900       03  F            PIC  9(002).                              I.970909
001910       03  W-NGPS       PIC  9(006).                              I.970909
001920     02  W-TNGP         PIC  9(008).                              I.970909
001930     02  W-TNGPD REDEFINES W-TNGP.                                I.970909
001940       03  W-TNEN       PIC  9(004).                              I.970909
001950       03  W-TGP        PIC  9(004).                              I.970909
001960     02  W-TNGPL REDEFINES W-TNGP.                                I.970909
001970       03  F            PIC  9(002).                              I.970909
001980       03  W-TNGPS      PIC  9(006).                              I.970909
001990     02  W-DNGP         PIC  9(008).                              I.970909
002000     02  W-DNGPD REDEFINES W-DNGP.                                I.970909
002010       03  W-DNEN       PIC  9(004).                              I.970909
002020       03  W-DGP        PIC  9(004).                              I.970909
002030     02  W-DNGPL REDEFINES W-DNGP.                                I.970909
002040       03  F            PIC  9(002).                              I.970909
002050       03  W-DNGPS      PIC  9(006).                              I.970909
002060*****  03  W-GET        PIC  9(002).                              D.970909
002070*****  03  W-PEY        PIC  9(002).                              D.970909
002080     02  W-KIN          PIC S9(009).
002090     02  W-DMM          PIC  9(001).
002100     02  W-CC           PIC  9(001) VALUE 0.                      I.940228
002110     02  W-EC           PIC  9(001) VALUE 0.
002120     02  W-SRC          PIC  9(001).                              I.080930
002130     02  W-FILE         PIC  X(013).                              I.930914
002140*****02  W-BNG          PIC  9(004).                              D.970904
002150*****02  W-BNGD  REDEFINES W-BNG.                                 D.970904
002160*****  03  W-BNEN       PIC  9(002).                              D.970904
002170     02  W-BNG.                                                   I.970904
002180       03  W-BNEN       PIC  9(004).                              I.970904
002190       03  W-BNENL REDEFINES W-BNEN.                              I.970904
002200         04  W-BNEN1    PIC  9(002).                              I.970904
002210         04  W-BNEN2    PIC  9(002).                              I.970904
002220       03  W-BGET       PIC  9(002).                              I.960207
002230     02  W-BNGL  REDEFINES W-BNG.                                 I.970904
002240       03  F            PIC  9(002).                              I.970904
002250       03  W-BNGS       PIC  9(004).                              I.970904
002260     02  W-ENG.                                                   I.970904
002270       03  W-ENEN       PIC  9(004).                              I.970904
002280       03  W-ENENL REDEFINES W-ENEN.                              I.970904
002290         04  W-ENEN1    PIC  9(002).                              I.970904
002300         04  W-ENEN2    PIC  9(002).                              I.970904
002310       03  W-EGET       PIC  9(002).                              I.960207
002320     02  W-ENGL  REDEFINES W-ENG.                                 I.970904
002330       03  F            PIC  9(002).                              I.970904
002340       03  W-ENGS       PIC  9(004).                              I.970904
002350     02  W-NTNG.                                                  I.991102
002360       03  W-NTN        PIC  9(002).                              I.991102
002370       03  W-NTG        PIC  9(002).                              I.991102
002380     02  W-NBNG.                                                  I.991102
002390       03  W-NBN        PIC  9(002).                              I.991102
002400       03  W-NBG        PIC  9(002).                              I.991102
002410     COPY LSTAT.
002420 SCREEN SECTION.
002430 SD  C-CRT
002440     END STATUS IS ESTAT.
002450 01  C-CLEAR.
002460     02  LINE   1  CLEAR SCREEN.
002470 01  C-MID.
002480*****02  LINE   3  COLUMN  10  PIC  N(024) VALUE                  D.991101
002490*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.991101
002500*****02  LINE   4  COLUMN  10  PIC  N(024) VALUE                  D.991101
002510*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.991101
002520*****02  LINE   5  COLUMN  10  PIC  N(024) VALUE                  D.991101
002530*****     NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".   D.991101
002540*****02  LINE   6  COLUMN  10  PIC  N(024) VALUE                  D.991101
002550*****     NC"＊＊＊　　受取・支払手形マスター　作成　　＊＊＊".   D.991101
002560*****02  LINE   7  COLUMN  10  PIC  N(024) VALUE                  D.991101
002570*****     NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".   D.991101
002580*****02  LINE   8  COLUMN  10  PIC  N(024) VALUE                  D.991101
002590*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.991101
002600*****02  LINE   9  COLUMN  10  PIC  N(024) VALUE                  D.991101
002610*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".   D.991101
002620     02  LINE   3  COLUMN  10  PIC  N(020) VALUE                  I.991101
002630          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.991101
002640     02  LINE   4  COLUMN  10  PIC  N(020) VALUE                  I.991101
002650          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.991101
002660     02  LINE   5  COLUMN  10  PIC  N(020) VALUE                  I.991101
002670          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.991101
002680     02  LINE   6  COLUMN  10  PIC  N(020) VALUE                  I.991101
002690          NC"＊＊＊　　手形・購買支払　変換　　＊＊＊".           I.991101
002700     02  LINE   7  COLUMN  10  PIC  N(020) VALUE                  I.991101
002710          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.991101
002720     02  LINE   8  COLUMN  10  PIC  N(020) VALUE                  I.991101
002730          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.991101
002740     02  LINE   9  COLUMN  10  PIC  N(020) VALUE                  I.991101
002750          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.991101
002760     02  LINE  20  COLUMN  23  PIC  X(022) VALUE
002770          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002780 01  C-ACP.
002790     02  A-DMM   LINE  20  COLUMN  40  PIC  9(001)
002800          USING W-DMM   CHECK OVERFLOW NO IFC.
002810 01  C-ERR.
002820     02  LINE  24.
002830       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002840       03  E-ME1   COLUMN  15  PIC  X(026) VALUE
002850            "***  UKETM ﾆｼﾞｭｳ ﾄｳﾛｸ  ***".
002860       03  E-ME2   COLUMN  15  PIC  X(026) VALUE
002870            "***  SHITM ﾆｼﾞｭｳ ﾄｳﾛｸ  ***".
002880       03  E-ME3   COLUMN  15  PIC  X(015) VALUE
002890            "***  TM ﾅｼ  ***".
002900       03  E-ME4   COLUMN  15  PIC  X(015) VALUE
002910            "***  SM ﾅｼ  ***".
002920       03  E-ME5   COLUMN  15  PIC  X(023) VALUE
002930            "***  ｼﾃ ｱｲﾃｶﾓｸ ｴﾗｰ  ***".
002940       03  E-ME6   COLUMN  15  PIC  X(025) VALUE
002950            "***  UKETM WRITE ｴﾗｰ  ***".
002960       03  E-ME7   COLUMN  15  PIC  X(025) VALUE
002970            "***  SHITM WRITE ｴﾗｰ  ***".
002980       03  E-ME8   COLUMN  15  PIC  X(018) VALUE                  I.910911
002990            "***  CALNM ﾅｼ  ***".                                 I.910911
003000       03  E-ME9   COLUMN  15  PIC  X(018) VALUE
003010            "***  DATA ｴﾗｰ  ***".
003020       03  E-ME10  COLUMN  15  PIC  X(017) VALUE
003030            "***  TNOM ﾅｼ  ***".
003040       03  E-ME11  COLUMN  15  PIC  X(026) VALUE
003050            "***  TNOM REWRITE ｴﾗｰ  ***".
003060       03  E-ME12  COLUMN  15  PIC  X(018) VALUE
003070            "***  DATEM ﾅｼ  ***".
003080       03  E-ME13  COLUMN  15  PIC  X(027) VALUE
003090            "***  DATEM REWRITE ｴﾗｰ  ***".
003100*****  03  E-ME14  COLUMN  15  PIC  X(024) VALUE                  D.991101
003110*****       "***  TNKF WRITE ｴﾗｰ  ***".                           D.991101
003120       03  E-ME15  COLUMN  15  PIC  X(025) VALUE                  I.930914
003130            "***  JSSRF WRITE ｴﾗｰ  ***".                          I.930914
003140       03  E-ME16  COLUMN  15  PIC  X(027) VALUE                  I.960207
003150            "***  BANKM REWRITE ｴﾗｰ  ***".                        I.960207
003160       03  E-ME17  COLUMN  15  PIC  X(018) VALUE                  I.960207
003170            "***  BANKM ﾅｼ  ***".                                 I.960207
003180       03  E-ME18  COLUMN  15  PIC  X(024) VALUE                  I.980223
003190            "***  SM REWRITE ｴﾗｰ  ***".                           I.980223
003200       03  E-ME21  COLUMN  15  PIC  X(026) VALUE                  I.991102
003210            "***  TDTM REWRITE ｴﾗｰ  ***".                         I.991102
003220       03  E-KEY   COLUMN  50  PIC  X(006) FROM  TD-KEY.
003230       03  E-TCD   COLUMN  50  PIC  X(004) FROM  TD-TCD.
003240*****  03  E-NGP   COLUMN  60  PIC  9(006) FROM  CL-KEY.          D.970909
003250       03  E-NGP   COLUMN  60  PIC  9(008) FROM  CL-KEY.          I.970909
003260       03  E-BKC   COLUMN  50  PIC  9(004) FROM  TD-BKC.          I.960207
003270       03  E-ME71.                                                I.930914
003280         04  COLUMN   1  PIC  X(013) FROM  W-FILE.                I.930914
003290         04  COLUMN  15  PIC  N(021) VALUE                        I.930914
003300              NC"オーバーフロー、領域を拡張し、ＦＮＣ＋再開".     I.930914
003310       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        I.930914
003320       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003330       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003340       03  E-CL.                                                  I.930914
003350         04  COLUMN   1  PIC  X(040) VALUE                        I.930914
003360              "                                        ".         I.930914
003370         04  COLUMN  41  PIC  X(040) VALUE                        I.930914
003380              "                                        ".         I.930914
003390     COPY LIBSCR.                                                 I.970923
003400 PROCEDURE DIVISION.
003410 M-05.
003420     DISPLAY C-CLEAR.
003430     DISPLAY C-MID.
003440 M-10.
003450     ACCEPT A-DMM.
003460     IF ESTAT = PF9                                               I.930809
003470         MOVE 255 TO COMPLETION-CODE                              I.000111
003480         GO TO M-95.                                              I.930809
003490     IF ESTAT NOT = HTB AND SKP
003500         GO TO M-10.
003510     IF W-DMM = 9
003520         MOVE 255 TO COMPLETION-CODE                              I.000111
003530         GO TO M-95.                                              I.930809
003540*****    DISPLAY C-CLEAR                                          D.930809
003550*****    STOP RUN.                                                D.930809
003560     IF W-DMM NOT = 1
003570         GO TO M-10.
003580*
003590*****OPEN INPUT T-M S-M CALNM.                                    D.980223
003600     OPEN INPUT T-M CALNM.                                        I.980223
003610     OPEN I-O S-M.                                                I.980223
003620*****OPEN INPUT TDT-M.                                            D.991102
003630     OPEN I-O TDT-M.                                              I.991102
003640     OPEN I-O UKET-M SHIT-M.
003650*****OPEN EXTEND TNK-F.                                           D.991101
003660     OPEN OUTPUT JSS-F.
003670     OPEN I-O BANK-M.                                             I.960207
003680     COPY LIBCPR.                                                 I.970923
003690     MOVE ZERO TO W-D W-NGP.
003700     MOVE D-NTNG TO W-NTNG.                                       I.991102
003710     MOVE D-NBNG TO W-NBNG.                                       I.991102
003720 M-15.
003730     READ TDT-M NEXT RECORD AT END
003740         GO TO M-85.                                              I.991102
003750*****    GO TO M-80.                                              D.991102
003760     IF TD-PC NOT = 5                                             I.991102
003770         GO TO M-15.                                              I.991102
003780*****IF (TD-HCT = 1) AND (TD-HCK = 1)                             D.000108
003790     IF (TD-HCT = 1 OR 9) AND (TD-HCK = 1 OR 9)                   I.000108
003800         GO TO M-15.                                              I.991102
003810     IF TD-C1 = 0                                                 I.991102
003820         GO TO M-15.                                              I.991102
003830*
003840*****IF TD-C1 NOT = 0                                             D.991102
003850*****    GO TO M-20.                                              D.991102
003860*****PERFORM S-240 THRU S-280.                                    D.991102
003870*****IF W-EC = 9                                                  D.960207
003880*****    GO TO M-85.                                              D.960207
003890*****GO TO M-15.                                                  D.960207
003900*****GO TO M-30.                                                  D.991102
003910*M-20.                                                            D.991102
003920     IF TD-C1 NOT = 1                                             ｳｹﾃ
003930         GO TO M-25.
003940*****IF TD-HCT = 1                                                D.000108
003950     IF TD-HCT = 1 OR 9                                           I.000108
003960         GO TO M-15.                                              I.991102
003970     IF (TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG)            I.991102
003980         GO TO M-15.                                              I.991102
003990     PERFORM S-160 THRU S-280.
004000*****IF W-EC NOT = 9                                              D.960207
004010*****    GO TO M-15.                                              D.960207
004020*****GO TO M-85.                                                  D.960207
004030     GO TO M-30.                                                  I.960207
004040 M-25.
004050     IF TD-C1 NOT = 2 AND 3                                       ｼﾃ･ｼﾊﾗｲ
004060         DISPLAY E-ME9 E-KEY E-ME99
004070         GO TO M-15.
004080*****IF (TD-HCT = 1) AND (TD-HCK = 1)                             D.000108
004090     IF (TD-HCT = 1 OR 9) AND (TD-HCK = 1 OR 9)                   I.000108
004100         GO TO M-15.                                              I.991102
004110*****IF (TD-HCT NOT = 1) AND                                      D.000108
004120     IF (TD-HCT = 0) AND                                          I.000108
004130        ((TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG))          I.991102
004140         GO TO M-15.                                              I.991102
004150*****IF (TD-HCK NOT = 1) AND                                      D.000108
004160     IF (TD-HCK = 0) AND                                          I.000108
004170        ((TD-SNEN2 NOT = W-NBN) OR (TD-GET NOT = W-NBG))          I.991102
004180         GO TO M-15.                                              I.991102
004190     PERFORM S-300 THRU S-500.                                      C.9402
004200 M-30.                                                            I.960207
004210*****IF W-EC NOT = 9                                              D.960207
004220*****    GO TO M-15.                                              D.960207
004230     IF W-EC = 9                                                  I.960207
004240         GO TO M-85.
004250     IF TD-BKC = ZERO                                             I.960207
004260         GO TO M-15.                                              I.960207
004270     MOVE TD-BKC TO B-KEY.                                        I.960207
004280     READ BANK-M INVALID KEY                                      I.960207
004290         DISPLAY E-ME17 E-BKC E-ME99                              I.960207
004300         DISPLAY E-CL                                             I.960207
004310         GO TO M-15.                                              I.960207
004320*****MOVE TD-NG TO W-BNG.                                         D.970904
004330*****ADD 88 TO W-BNEN.                                            D.970904
004340*****IF W-BNG NOT > B-NG                                          D.970904
004350     MOVE ZERO TO W-ENG.                                          I.970904
004360     MOVE B-NG TO W-ENGS.                                         I.970904
004370     IF B-NG NOT = ZERO                                           I.980223
004380         IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                   I.970904
004390             ADD DATE-NC1 TO W-ENEN.                              I.970904
004400     IF B-NG NOT = ZERO                                           I.980223
004410         IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                   I.970904
004420             ADD DATE-NC2 TO W-ENEN.                              I.970904
004430     MOVE ZERO TO W-BNG.                                          I.970904
004440     MOVE TD-NG TO W-BNGS.                                        I.970904
004450     IF W-BNEN2 >= DATE-YF1 AND <= DATE-YT1                       I.970904
004460         ADD DATE-YC1 TO W-BNEN                                   I.970904
004470       ELSE                                                       I.970904
004480         IF W-BNEN2 >= DATE-YF2 AND <= DATE-YT2                   I.970904
004490             ADD DATE-YC2 TO W-BNEN.                              I.970904
004500     IF W-BNG NOT > W-ENG                                         I.970904
004510         GO TO M-15.                                              I.960207
004520     MOVE W-BNGS TO B-NG.                                         I.970904
004530*****MOVE W-BNG TO B-NG.                                          D.970904
004540     REWRITE BANK-R INVALID KEY                                   I.960207
004550         DISPLAY E-STAT E-ME16 E-BKC E-ME99                       I.960207
004560         DISPLAY E-CL.                                            I.960207
004570     GO TO M-15.                                                  I.960207
004580*M-80.                                                            D.991102
004590*****CLOSE TDT-M.                                                 D.991102
004600*****OPEN OUTPUT TDT-M.                                           D.991102
004610 M-85.
004620     CLOSE T-M S-M CALNM.                                         C.910911
004630     CLOSE TDT-M.
004640     CLOSE UKET-M SHIT-M.
004650     CLOSE JSS-F.                                                 I.991101
004660*****CLOSE JSS-F TNK-F.                                           D.991101
004670     CLOSE BANK-M.                                                I.960207
004680*
004690     OPEN I-O TNO-M.
004700     MOVE "01" TO NO-KEY.
004710     READ TNO-M INVALID KEY
004720         DISPLAY E-ME78 E-ME10 E-ME99                             C.930914
004730         GO TO M-95.
004740*****IF NO-UMN < W-UDN                                            D.950202
004750     IF ((NO-UMN < W-UDN) OR (NO-UMN = 9999)) OR                  I.950202
004760        ((NO-UMN > 9900) AND (W-UDN < 0100))                      I.991102
004770         MOVE W-UDN TO NO-UMN.
004780*****IF NO-SMN < W-SDN                                            D.950202
004790     IF ((NO-SMN < W-SDN) OR (NO-SMN = 9999)) OR                  I.950202
004800        ((NO-SMN > 9900) AND (W-SDN < 0100))                      I.991102
004810         MOVE W-SDN TO NO-SMN.
004820     MOVE ZERO TO NO-D.
004830     REWRITE TNO-R INVALID KEY
004840         DISPLAY E-ME78 E-STAT E-ME11 E-ME99.                     C.930914
004850     CLOSE TNO-M.
004860 M-90.
004870     OPEN I-O M-DATE.
004880     MOVE "01" TO DATE-KEY.
004890     READ M-DATE INVALID KEY
004900         DISPLAY E-ME78 E-ME12 E-ME99                             C.930914
004910         CLOSE M-DATE
004920         GO TO M-95.
004930     MOVE ZERO TO W-DNGP.                                         I.970909
004940     MOVE D-TGD TO W-DNGPS.                                       I.970909
004950     IF W-DNEN >= DATE-NF1 AND <= DATE-NT1                        I.970909
004960         ADD DATE-NC1 TO W-DNEN.                                  I.970909
004970     IF W-DNEN >= DATE-NF2 AND <= DATE-NT2                        I.970909
004980         ADD DATE-NC2 TO W-DNEN.                                  I.970909
004990     IF W-NGP > W-DNGP                                            I.970909
005000         MOVE W-NGPS TO D-TGD.                                    I.970909
005010*****IF W-NEN > 62                                                D.970909
005020*****    ADD 25 TO W-NEN                                          D.970909
005030*****  ELSE                                                       D.970909
005040*****    ADD 88 TO W-NEN.                                         D.970909
005050*****IF W-NGP > D-TGD                                             D.970909
005060*****    MOVE W-NGP TO D-TGD.                                     D.970909
005070     REWRITE DATE-R INVALID KEY
005080         DISPLAY E-ME78 E-STAT E-ME13 E-ME99.                     C.930914
005090     CLOSE M-DATE.
005100 M-95.
005110*****OPEN INPUT JSS-F.                                            D.000111
005120*****READ JSS-F AT END                                            D.000111
005130*****    MOVE 255 TO COMPLETION-CODE.                             D.000111
005140*****CLOSE JSS-F.                                                 D.000111
005150     IF W-DC = 0                                                  I.930809
005160         MOVE 255 TO COMPLETION-CODE.                             I.930809
005170     DISPLAY C-CLEAR.
005180     STOP RUN.
005190 S-020.
005200     MOVE ZERO TO JSS-R.
005210     IF TD-C1 = 2
005220         MOVE 4 TO JS-SC.
005230     IF TD-TKC = 30
005240         MOVE 1 TO JS-SC.
005250     IF TD-TKC = 31
005260         MOVE 2 TO JS-SC.
005270     IF TD-TKC = 32
005280         MOVE 3 TO JS-SC.
005290     IF TD-TKC = 33
005300         MOVE 5 TO JS-SC.
005310     IF TD-TKC = 34
005320         MOVE 6 TO JS-SC.
005330     MOVE 30 TO JS-DC.
005340     MOVE TD-DATE TO JS-DATE.
005350     MOVE TD-SNEN TO JS-NEN.                                      I.991102
005360*****IF JS-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
005370*****    ADD DATE-YC1 TO JS-NEN                                   D.991102
005380*****  ELSE                                                       D.991102
005390*****    IF JS-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
005400*****        ADD DATE-YC2 TO JS-NEN.                              D.991102
005410*****IF TD-NEN > 62                                               D.970909
005420*****    ADD 25 TO JS-NEN                                         D.970901
005430*****    ADD 1925 TO JS-NEN                                       D.970909
005440*****  ELSE                                                       D.970909
005450*****    ADD 1988 TO JS-NEN.                                      D.970909
005460*****    ADD 88 TO JS-NEN.                                        D.970901
005470     MOVE TD-TCD TO JS-SCD.
005480 S-040.
005490     EXIT.
005500 S-060.
005510     MOVE ZERO TO JSS-R.
005520     MOVE 10 TO JS-DC.
005530     MOVE TD-DATE TO JS-DATE.
005540     MOVE TD-SNEN TO JS-NEN.                                      I.991102
005550*****IF JS-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
005560*****    ADD DATE-YC1 TO JS-NEN                                   D.991102
005570*****  ELSE                                                       D.991102
005580*****    IF JS-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
005590*****        ADD DATE-YC2 TO JS-NEN.                              D.991102
005600*****IF TD-NEN > 62                                               D.970909
005610*****    ADD 25 TO JS-NEN                                         D.970901
005620*****    ADD 1925 TO JS-NEN                                       D.970909
005630*****  ELSE                                                       D.970909
005640*****    ADD 1988 TO JS-NEN.                                      D.970909
005650*****    ADD 88 TO JS-NEN.                                        D.970901
005660     MOVE TD-TCD TO JS-SCD.
005670     MOVE 999000 TO JS-JCD.
005680     MOVE 5 TO JS-YC.
005690 S-080.
005700     EXIT.
005710 S-100.                                                            I.91091
005720     MOVE UT-SNM TO CL-NEN.                                       I.910911
005730     MOVE UT-MKG TO CL-GET.                                       I.910911
005740     MOVE UT-MKP TO CL-PEY.                                       I.910911
005750     READ CALNM WITH UNLOCK INVALID KEY                           I.910911
005760         DISPLAY E-ME78 E-ME8 E-NGP E-ME99                        I.910911
005770         GO TO S-140.                                              I.91091
005780     IF CL-SJ = 0                                                 I.910911
005790         GO TO S-140.                                              I.91091
005800 S-120.                                                            I.91091
005810     READ CALNM NEXT RECORD WITH UNLOCK AT END                    I.910911
005820         DISPLAY E-ME78 E-ME8 E-KEY E-NGP E-ME99                  I.910911
005830         MOVE UT-SNM TO CL-NEN                                    I.910911
005840         MOVE UT-MKG TO CL-GET                                    I.910911
005850         MOVE UT-MKP TO CL-PEY                                    I.910911
005860         GO TO S-140.                                              I.91091
005870     IF CL-SJ = 1                                                 I.910911
005880         GO TO S-120.                                              I.91091
005890 S-140.                                                            I.91091
005900     EXIT.
005910*****---------------------------------------------------------------------
005920 S-160.
005930     MOVE TD-TNO TO UT-KEY.
005940     READ UKET-M INVALID KEY
005950         GO TO S-180.
005960     DISPLAY E-ME1 E-KEY E-ME99
005970     GO TO S-280.
005980 S-180.
005990     MOVE TD-TCD TO T-KEY.
006000     READ T-M WITH UNLOCK INVALID KEY
006010         DISPLAY E-ME3 E-KEY E-TCD E-ME99
006020         MOVE ZERO TO T-FKC.
006030 S-200.                                                            I.93091
006040     INITIALIZE UKET-R.
006050     MOVE TD-TNO TO UT-KEY.
006060     MOVE TD-TKC TO UT-TSC.
006070     MOVE TD-BKC TO UT-BCD.
006080     MOVE T-FKC TO UT-FKC.
006090     MOVE TD-TCD TO UT-TCD.
006100     MOVE TD-FRN TO UT-FDM.
006110     MOVE TD-KIN TO UT-KIN.
006120     MOVE TD-DATE TO UT-UTD.
006130     MOVE TD-MND TO UT-MKD.
006140     MOVE TD-SNEN TO UT-SNU.                                      I.991102
006150*****IF TD-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
006160*****    COMPUTE UT-SNU = TD-NEN + DATE-YC1                       D.991102
006170*****  ELSE                                                       D.991102
006180*****    IF TD-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
006190*****        COMPUTE UT-SNU = TD-NEN + DATE-YC2.                  D.991102
006200     IF TD-MN >= DATE-YF1 AND <= DATE-YT1                         I.970909
006210         COMPUTE UT-SNM = TD-MN + DATE-YC1                        I.970909
006220       ELSE                                                       I.970909
006230         IF TD-MN >= DATE-YF2 AND <= DATE-YT2                     I.970909
006240             COMPUTE UT-SNM = TD-MN + DATE-YC2.                   I.970909
006250*****IF TD-NEN > 62                                               D.970909
006260*****    COMPUTE UT-SNU = TD-NEN + 25                             D.970909
006270*****  ELSE                                                       D.970909
006280*****    COMPUTE UT-SNU = TD-NEN + 88.                            D.970909
006290*****IF TD-MN > 62                                                D.970909
006300*****    COMPUTE UT-SNM = TD-MN + 25                              D.970909
006310*****  ELSE                                                       D.970909
006320*****    COMPUTE UT-SNM = TD-MN + 88.                             D.970909
006330     PERFORM S-100 THRU S-140.                                      I.9109
006340*****MOVE CL-KEY TO UT-OKD.                                       D.970909
006350     MOVE CL-NGPS TO UT-OKD.                                      I.970909
006360     WRITE UKET-R INVALID KEY
006370         DISPLAY E-STAT E-ME6 E-KEY E-ME99
006380         GO TO S-220.                                              I.93091
006390     CALL "CBLTCLS" USING UKET-M.                                 I.930809
006400     IF TD-TNO > W-UDN
006410         MOVE TD-TNO TO W-UDN.
006420     MOVE ZERO TO W-TNGP.                                         I.970909
006430     MOVE TD-DATE TO W-TNGPS.                                     I.970909
006440     IF W-TNEN >= DATE-YF1 AND <= DATE-YT1                        I.970909
006450         ADD DATE-YC1 TO W-TNEN                                   I.970909
006460       ELSE                                                       I.970909
006470         IF W-TNEN >= DATE-YF2 AND <= DATE-YT2                    I.970909
006480             ADD DATE-YC2 TO W-TNEN.                              I.970909
006490     IF W-TNGP > W-NGP                                            I.970909
006500         MOVE W-TNGP TO W-NGP.                                    I.970909
006510*****IF TD-DATE > W-NGP                                           D.970909
006520*****    MOVE TD-DATE TO W-NGP.                                   D.970909
006530*****IF TD-RSC = 9                                                D.991101
006540     MOVE 1 TO TD-HCT.                                            I.991102
006550     REWRITE TDT-R INVALID KEY                                    I.991102
006560         MOVE 9 TO W-EC                                           I.991102
006570         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
006580     GO TO S-280.
006590*****GO TO S-240.                                                 D.991101
006600 S-220.                                                            I.93091
006610     IF ERR-STAT NOT = "24"                                       I.930914
006620         DISPLAY E-ME78 E-ME99                                    I.930914
006630         MOVE 9 TO W-EC
006640         GO TO S-280.                                              C.93091
006650     DISPLAY E-CL.                                                I.930914
006660     CLOSE UKET-M.                                                I.930914
006670     MOVE "UKETM        " TO W-FILE.                              I.930914
006680     DISPLAY E-ME71 E-ME98 STOP " ".                              I.930914
006690     DISPLAY E-CL.                                                I.930914
006700     OPEN I-O UKET-M.                                             I.930914
006710     GO TO S-200.                                                  I.93091
006720*S-240.                                                           D.991101
006730*****INITIALIZE TNK-R.                                            D.991101
006740*****MOVE TD-DATE TO TN-DATE.                                     D.991101
006750*****MOVE TD-TCD TO TN-TCD.                                       D.991101
006760*****MOVE TD-KIN TO TN-KIN.                                       D.991101
006770*****IF TD-TKC = 07                                               D.991101
006780*****    MOVE 5 TO TN-SOC.                                        D.991101
006790*****MOVE TD-RSC TO TN-SHC.                                       D.991101
006800*****WRITE TNK-R.                                                 D.991101
006810*****IF ERR-STAT NOT = "00"                                       D.991101
006820*****    DISPLAY E-STAT E-ME14 E-ME99                             D.991101
006830*****    GO TO S-260.                                             D.991101
006840*****CALL "CBLTCLS" USING TNK-F.                                  D.991101
006850*****GO TO S-280.                                                 D.991101
006860*S-260.                                                           D.991101
006870*****IF ERR-STAT NOT = "34"                                       D.991101
006880*****    DISPLAY E-ME78 E-ME99                                    D.991101
006890*****    MOVE 9 TO W-EC                                           D.991101
006900*****    GO TO S-280.                                             D.991101
006910*****DISPLAY E-CL.                                                D.991101
006920*****CLOSE TNK-F.                                                 D.991101
006930*****MOVE "TNKF         " TO W-FILE.                              D.991101
006940*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.991101
006950*****DISPLAY E-CL.                                                D.991101
006960*****OPEN EXTEND TNK-F.                                           D.991101
006970*****GO TO S-240.                                                 D.991101
006980 S-280.
006990     EXIT.
007000*****---------------------------------------------------------------------
007010 S-300.
007020     MOVE 0 TO W-SRC.                                             I.080930
007030     MOVE TD-TCD TO S-KEY.
007040*****READ S-M WITH UNLOCK INVALID KEY                             D.980223
007050     READ S-M INVALID KEY                                         I.980223
007060         DISPLAY E-ME4 E-KEY E-TCD E-ME99
007070*****    MOVE ZERO TO S-FKC S-KKC                                 D.080829
007080         MOVE ZERO TO S-FKC                                       I.080829
007090         GO TO S-310.                                             I.980223
007100*****    MOVE ZERO TO S-FKC S-KKC.                                D.980223
007110     MOVE ZERO TO W-ENG.                                          I.980223
007120     MOVE S-ENG TO W-ENGS.                                        I.980223
007130     IF S-ENG NOT = ZERO                                          I.980223
007140         IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                   I.980223
007150             ADD DATE-NC1 TO W-ENEN.                              I.980223
007160     IF S-ENG NOT = ZERO                                          I.980223
007170         IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                   I.980223
007180             ADD DATE-NC2 TO W-ENEN.                              I.980223
007190     MOVE ZERO TO W-BNG.                                          I.980223
007200     MOVE TD-NG TO W-BNGS.                                        I.980223
007210     IF W-BNEN2 >= DATE-YF1 AND <= DATE-YT1                       I.980223
007220         ADD DATE-YC1 TO W-BNEN                                   I.980223
007230       ELSE                                                       I.980223
007240         IF W-BNEN2 >= DATE-YF2 AND <= DATE-YT2                   I.980223
007250             ADD DATE-YC2 TO W-BNEN.                              I.980223
007260     IF W-BNG > W-ENG                                             I.080930
007270         MOVE 1 TO W-SRC                                          I.080930
007280         MOVE W-BNGS TO S-ENG.                                    I.080930
007290     IF TD-C1 = 2                                                 I.080930
007300         IF S-TGC = 0                                             I.080930
007310             MOVE 1 TO W-SRC                                      I.080930
007320             MOVE 1 TO S-TGC.                                     I.080930
007330*****IF W-BNG NOT > W-ENG                                         D.080930
007340     IF W-SRC = 0                                                 I.080930
007350         GO TO S-310.                                             I.980223
007360*****MOVE W-BNGS TO S-ENG.                                        D.080930
007370     REWRITE S-R INVALID KEY                                      I.980223
007380         DISPLAY E-STAT E-ME18 E-ME99                             I.980223
007390         DISPLAY E-CL.                                            I.980223
007400 S-310.                                                           I.980223
007410     IF TD-C1 = 3
007420         GO TO S-360.
007430*****IF (TD-HCT = 1) OR                                           D.000108
007440     IF (TD-HCT = 1 OR 9) OR                                      I.000108
007450        ((TD-SNEN2 NOT = W-NTN) OR (TD-GET NOT = W-NTG))          I.991102
007460         GO TO S-360.                                             I.991102
007470     MOVE TD-TNO TO ST-KEY.
007480     READ SHIT-M INVALID KEY
007490         GO TO S-320.
007500     DISPLAY E-ME2 E-KEY E-ME99.
007510     GO TO S-500.                                                  C.94022
007520 S-320.
007530     INITIALIZE SHIT-R.
007540     MOVE TD-TNO TO ST-KEY.
007550     MOVE TD-TKC TO ST-TSC.
007560     MOVE TD-BKC TO ST-BCD.
007570     MOVE S-FKC TO ST-FKC.
007580     MOVE TD-TCD TO ST-TCD.
007590     MOVE TD-KIN TO ST-KIN.
007600     MOVE TD-DATE TO ST-FDD.
007610     MOVE TD-MND TO ST-MKD.
007620     MOVE TD-SAD TO ST-UKD.
007630     ADD TD-ZSHZ TO ST-UK(1).
007640     ADD TD-SSHZ TO ST-UK(2).
007650     MOVE TD-SNEN TO ST-SNF.                                      I.991102
007660*****IF TD-NEN >= DATE-YF1 AND <= DATE-YT1                        D.991102
007670*****    COMPUTE ST-SNF = TD-NEN + DATE-YC1                       D.991102
007680*****  ELSE                                                       D.991102
007690*****    IF TD-NEN >= DATE-YF2 AND <= DATE-YT2                    D.991102
007700*****        COMPUTE ST-SNF = TD-NEN + DATE-YC2.                  D.991102
007710     IF TD-MN >= DATE-YF1 AND <= DATE-YT1                         I.970909
007720         COMPUTE ST-SNM = TD-MN + DATE-YC1                        I.970909
007730       ELSE                                                       I.970909
007740         IF TD-MN >= DATE-YF2 AND <= DATE-YT2                     I.970909
007750             COMPUTE ST-SNM = TD-MN + DATE-YC2.                   I.970909
007760*****IF TD-NEN > 62                                               D.970909
007770*****    COMPUTE ST-SNF = TD-NEN + 25                             D.970909
007780*****  ELSE                                                       D.970909
007790*****    COMPUTE ST-SNF = TD-NEN + 88.                            D.970909
007800*****IF TD-MN > 62                                                D.970909
007810*****    COMPUTE ST-SNM = TD-MN + 25                              D.970909
007820*****  ELSE                                                       D.970909
007830*****    COMPUTE ST-SNM = TD-MN + 88.                             D.970909
007840     WRITE SHIT-R INVALID KEY
007850         DISPLAY E-STAT E-ME7 E-KEY E-ME99
007860*****    MOVE 9 TO W-EC                                           D.940228
007870*****    GO TO S-480.                                              D.94022
007880         GO TO S-340.                                              I.94022
007890     CALL "CBLTCLS" USING SHIT-M.                                 I.930809
007900     IF TD-TNO > W-SDN
007910         MOVE TD-TNO TO W-SDN.
007920     MOVE ZERO TO W-TNGP.                                         I.970909
007930     MOVE TD-DATE TO W-TNGPS.                                     I.970909
007940     IF W-TNEN >= DATE-YF1 AND <= DATE-YT1                        I.970909
007950         ADD DATE-YC1 TO W-TNEN                                   D.991102
007960*****    ADD DATE-YC1 TO W-TNEN.                                  D.991102
007970       ELSE                                                       I.991102
007980         IF W-TNEN >= DATE-YF2 AND <= DATE-YT2                    I.970909
007990             ADD DATE-YC2 TO W-TNEN.                              I.970909
008000     IF W-TNGP > W-NGP                                            I.970909
008010         MOVE W-TNGP TO W-NGP.                                    I.970909
008020*****IF TD-DATE > W-NGP                                           D.970909
008030*****    MOVE TD-DATE TO W-NGP.                                   D.970909
008040     MOVE 1 TO TD-HCT.                                            I.991102
008050     REWRITE TDT-R INVALID KEY                                    I.991102
008060         MOVE 9 TO W-EC                                           I.991102
008070         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
008080     GO TO S-360.                                                  I.94022
008090 S-340.                                                            I.94022
008100     IF ERR-STAT NOT = "24"                                       I.940228
008110         DISPLAY E-ME78 E-ME99                                    I.940228
008120         MOVE 9 TO W-EC                                           I.940228
008130         GO TO S-500.                                              I.94022
008140     DISPLAY E-CL.                                                I.940228
008150     CLOSE SHIT-M.                                                I.940228
008160     MOVE "SHITM        " TO W-FILE.                              I.940228
008170     DISPLAY E-ME71 E-ME98 STOP " ".                              I.940228
008180     DISPLAY E-CL.                                                I.940228
008190     OPEN I-O SHIT-M.                                             I.940228
008200     GO TO S-320.                                                  I.94022
008210 S-360.
008220*****IF S-KKC = 1                                                 D.080829
008230     IF TD-TCD = 1905                                             I.080829
008240         GO TO S-500.                                              C.94022
008250*****IF (TD-HCK = 1) OR                                           D.000108
008260     IF (TD-HCK = 1 OR 9) OR                                      I.000108
008270        ((TD-SNEN2 NOT = W-NBN) OR (TD-GET NOT = W-NBG))          I.991102
008280         GO TO S-500.                                             I.991102
008290     IF ZERO NOT = TD-S(1) OR TD-ZSHZ
008300         GO TO S-380.
008310     IF ZERO NOT = TD-S(2) OR TD-SSHZ
008320         GO TO S-440.
008330     IF TD-C1 = 3
008340         DISPLAY E-ME5 E-KEY E-ME99.
008350     GO TO S-500.                                                  C.94022
008360 S-380.
008370     PERFORM S-020 THRU S-040.
008380     MOVE TD-S(1) TO JS-KIN.
008390     MOVE TD-ZSHZ TO JS-SHZ.
008400     WRITE JSS-R.
008410     IF ERR-STAT NOT = "00"                                       I.940228
008420         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008430         MOVE 1 TO W-CC                                           I.940228
008440         GO TO S-480.                                              I.94022
008450     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008460     IF W-DC = 0                                                  I.930809
008470         MOVE 9 TO W-DC.                                          I.930809
008480     IF TD-ZSHZ = ZERO
008490         GO TO S-420.
008500 S-400.                                                            I.94022
008510     PERFORM S-060 THRU S-080.
008520     MOVE TD-ZSHZ TO JS-SHZ.
008530     WRITE JSS-R.
008540     IF ERR-STAT NOT = "00"                                       I.940228
008550         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008560         MOVE 2 TO W-CC                                           I.940228
008570         GO TO S-480.                                              I.94022
008580     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008590 S-420.
008600     IF ZERO = TD-S(2) AND TD-SSHZ
008610         GO TO S-490.                                             I.991102
008620*****    GO TO S-500.                                             D.991102
008630 S-440.
008640     PERFORM S-020 THRU S-040.
008650     ADD 5 TO JS-SCD1.
008660     MOVE TD-S(2) TO JS-KIN.
008670     MOVE TD-SSHZ TO JS-SHZ.
008680     WRITE JSS-R.
008690     IF ERR-STAT NOT = "00"                                       I.940228
008700         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008710         MOVE 3 TO W-CC                                           I.940228
008720         GO TO S-480.                                              I.94022
008730     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008740     IF W-DC = 0                                                  I.930809
008750         MOVE 9 TO W-DC.                                          I.930809
008760     IF TD-SSHZ = ZERO
008770         GO TO S-490.                                             I.991102
008780*****    GO TO S-500.                                             D.991102
008790 S-460.                                                            I.94022
008800     PERFORM S-060 THRU S-080.
008810     ADD 5 TO JS-SCD1.
008820     MOVE TD-SSHZ TO JS-SHZ.
008830     WRITE JSS-R.
008840     IF ERR-STAT NOT = "00"                                       I.940228
008850         DISPLAY E-STAT E-ME15 E-ME99                             I.940228
008860         MOVE 4 TO W-CC                                           I.940228
008870         GO TO S-480.                                              I.94022
008880     CALL "CBLTCLS" USING JSS-F.                                  I.930809
008890     GO TO S-490.                                                 I.991102
008900*****GO TO S-500.                                                 D.991102
008910 S-480.
008920*****EXIT.                                                        D.940228
008930     IF ERR-STAT NOT = "34"                                       I.940228
008940         DISPLAY E-ME78 E-ME99                                    I.940228
008950         MOVE 9 TO W-EC                                           I.940228
008960         GO TO S-500.                                              I.94022
008970     DISPLAY E-CL.                                                I.940228
008980     CLOSE JSS-F.                                                 I.940228
008990     MOVE "TJSSF        " TO W-FILE.                              I.940228
009000     DISPLAY E-ME71 E-ME98 STOP " ".                              I.940228
009010     DISPLAY E-CL.                                                I.940228
009020     OPEN EXTEND JSS-F.                                           I.940228
009030     IF W-CC = 1                                                  I.940228
009040         GO TO S-380.                                              I.94022
009050     IF W-CC = 2                                                  I.940228
009060         GO TO S-400.                                              I.94022
009070     IF W-CC = 3                                                  I.940228
009080         GO TO S-440.                                              I.94022
009090     IF W-CC = 4                                                  I.940228
009100         GO TO S-460.                                              I.94022
009110     GO TO S-500.                                                 I.991102
009120 S-490.                                                           I.991102
009130     MOVE 1 TO TD-HCK.                                            I.991102
009140     REWRITE TDT-R INVALID KEY                                    I.991102
009150         MOVE 9 TO W-EC                                           I.991102
009160         DISPLAY E-ME78 E-STAT E-ME21 E-KEY E-ME99.               I.991102
009170 S-500.                                                            I.94022
009180     EXIT.                                                        I.940228
