000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. FBN050.
000030**********************************
000040*****    振込先　問合せ      *****
000050**********************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     SELECT FKSM ASSIGN TO FKS-MSD
000130         ORGANIZATION INDEXED
000140         ACCESS MODE DYNAMIC
000150         RECORD KEY FS-KEY
000160         FILE STATUS IS ERR-STAT.
000170     SELECT S-M ASSIGN TO S-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE RANDOM
000200         RECORD KEY S-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT FBKM ASSIGN TO FBK-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE RANDOM
000250         RECORD KEY FBK-KEY
000260         FILE STATUS IS ERR-STAT.
000270 I-O-CONTROL.
000280     APPLY SHARED-MODE ON FKSM
000290     APPLY SHARED-MODE ON S-M
000300     APPLY SHARED-MODE ON FBKM.
000310 DATA DIVISION.
000320 FILE SECTION.
000330     COPY LISM.
000340     COPY LIFBKM.
000350 FD  FKSM
000360     BLOCK  2 RECORDS
000370     LABEL RECORD IS STANDARD
000380     VALUE OF IDENTIFICATION "FKSM".
000390 01  FKS-R.
000400     02  FS-KEY         PIC  X(004).
000410     02  FS-FKC         PIC  9(001).
000420     02  FS-FKN1        PIC  X(030).
000430     02  FS-BKC1        PIC  9(007).
000440     02  FS-YKS1        PIC  9(001).
000450     02  FS-KNO1        PIC  9(007).
000460     02  FS-TRC1        PIC  9(001).
000470     02  FS-KIN1        PIC  9(009).
000480     02  FS-FKN2        PIC  X(030).
000490     02  FS-BKC2        PIC  9(007).
000500     02  FS-YKS2        PIC  9(001).
000510     02  FS-KNO2        PIC  9(007).
000520     02  FS-TRC2        PIC  9(001).
000530     02  FS-KIN2        PIC  9(009).
000540     02  FS-BKC         PIC  9(001).
000550     02  FS-FGP         PIC  9(004).
000560     02  F              PIC  X(002).
000570     02  FS-ENGP        PIC  9(006).
000580 WORKING-STORAGE SECTION.
000590 77  ERR-STAT           PIC  X(002).
000600 01  W-DATA.
000610     02  W-L            PIC  9(002).
000620     02  W-EC           PIC  9(001).
000630     02  W-DMM          PIC  9(001).
000640     02  W-SCD          PIC  9(004).
000650     COPY LSTAT.
000660 SCREEN SECTION.
000670 SD  C-CRT
000680     END STATUS IS ESTAT.
000690 01  C-CLEAR.
000700     02  LINE   1  CLEAR SCREEN.
000710 01  C-MID.
000720     02  LINE   1  COLUMN  14  PIC  N(017) VALUE
000730          NC"＊＊＊　　振込先　問合せ　　＊＊＊".
000740     02  LINE   3.
000750       03  COLUMN   1  PIC  X(004) VALUE "ｺｰﾄﾞ".
000760       03  COLUMN   6  PIC  N(010) VALUE
000770            NC"仕　　入　　先　　名".
000780       03  COLUMN  73  PIC  N(004) VALUE NC"最終入力".
000790     02  LINE   4.
000800       03  COLUMN   3  PIC  N(005) VALUE NC"口　座　名".
000810       03  COLUMN  34  PIC  X(006) VALUE "BKｺｰﾄﾞ".
000820       03  COLUMN  42  PIC  N(003) VALUE NC"銀行名".
000830       03  COLUMN  58  PIC  N(004) VALUE NC"本支店名".
000840       03  COLUMN  74  PIC  N(003) VALUE NC"口座№".
000850     02  LINE  23  COLUMN  30  PIC  X(037) VALUE
000860          "NEXT=ﾘﾀｰﾝ , 入力=F10 , 終了=F9       ".
000870 01  C-ACP.
000880     02  A-SCD   LINE   5  COLUMN   1  PIC  9(004)
000890          USING W-SCD   CHECK OVERFLOW NO IFC.
000900     02  A-DMM   LINE  23  COLUMN  67  PIC  9(001)
000910          USING W-DMM   CHECK OVERFLOW NO IFC.
000920 01  C-DSP.
000930     02  LINE W-L.
000940       03  D-MID.
000950         04  COLUMN   1  PIC  9(004) FROM  S-TCD.
000960         04  COLUMN   6  PIC  N(024) FROM  S-NAME.
000970       03  D-ENGP  COLUMN  73  PIC  99/99/99 FROM  FS-ENGP.
000980       03  D-DAT1.
000990         04  COLUMN   3  PIC  X(030) FROM  FS-FKN1.
001000         04  COLUMN  34  PIC  9(007) FROM  FS-BKC1.
001010         04  COLUMN  42  PIC  X(015) FROM  FBK-BKN.
001020         04  COLUMN  58  PIC  X(015) FROM  FBK-HSN.
001030         04  COLUMN  74  PIC  9(007) FROM  FS-KNO1.
001040       03  D-DAT2.
001050         04  COLUMN   3  PIC  X(030) FROM  FS-FKN2.
001060         04  COLUMN  34  PIC  9(007) FROM  FS-BKC2.
001070         04  COLUMN  42  PIC  X(015) FROM  FBK-BKN.
001080         04  COLUMN  58  PIC  X(015) FROM  FBK-HSN.
001090         04  COLUMN  74  PIC  9(007) FROM  FS-KNO2.
001100     02  D-END   LINE  23  COLUMN  30  PIC  X(037) VALUE
001110          "              ＥＮＤ　ＤＡＴＡ       ".
001120 01  C-ERR.
001130     02  LINE  24.
001140       03  E-ME1   COLUMN  15  PIC  X(022) VALUE
001150            "***  ｼｲﾚｻｷﾏｽﾀｰ ﾅｼ  ***".
001160       03  E-ME2   COLUMN  15  PIC  X(023) VALUE
001170            "***  ﾌﾘｺﾐｻｷﾏｽﾀｰ ﾅｼ  ***".
001180       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001190       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001200       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
001210       03  E-CL    COLUMN  10  PIC  X(050) VALUE
001220            "                                                  ".
001230 PROCEDURE DIVISION.
001240 M-05.
001250     DISPLAY C-CLEAR.
001260     DISPLAY C-MID.
001270     OPEN INPUT FKSM.
001280     OPEN INPUT S-M FBKM.
001290 M-10.
001300     ACCEPT A-SCD.
001310     DISPLAY E-CL.
001320     IF ESTAT = PF9
001330         GO TO M-90.
001340     IF ESTAT NOT = HTB AND SKP
001350         GO TO M-10.
001360*
001370     MOVE W-SCD TO FS-KEY.
001380     START FKSM KEY NOT < FS-KEY INVALID KEY
001390         DISPLAY E-ME2
001400         GO TO M-10.
001410     READ FKSM NEXT RECORD WITH UNLOCK AT END
001420         DISPLAY E-ME2
001430         GO TO M-10.
001440     MOVE 0 TO W-EC.
001450     MOVE 4 TO W-L.
001460 M-15.
001470     ADD 1 TO W-L.
001480     IF W-L > 19
001490         GO TO M-30.
001500     MOVE FS-KEY TO S-KEY.
001510     READ S-M WITH UNLOCK INVALID KEY
001520         MOVE SPACE TO S-NAME
001530         MOVE NC"　仕入先なし　" TO S-NAME.
001540     DISPLAY D-MID.
001550     IF FS-ENGP NOT = ZERO
001560         DISPLAY D-ENGP.
001570*
001580     IF FS-BKC1 = ZERO
001590         GO TO M-20.
001600     MOVE FS-BKC1 TO FBK-KEY.
001610     READ FBKM WITH UNLOCK INVALID KEY
001620         MOVE SPACE TO FBK-BKN FBK-HSN
001630         MOVE "** BK ﾅｼ **" TO FBK-BKN.
001640     ADD 1 TO W-L.
001650     DISPLAY D-DAT1.
001660 M-20.
001670     IF FS-BKC2 = ZERO
001680         GO TO M-25.
001690     MOVE FS-BKC2 TO FBK-KEY.
001700     READ FBKM WITH UNLOCK INVALID KEY
001710         MOVE SPACE TO FBK-BKN FBK-HSN
001720         MOVE "** BK ﾅｼ **" TO FBK-BKN.
001730     ADD 1 TO W-L.
001740     DISPLAY D-DAT2.
001750 M-25.
001760     READ FKSM NEXT RECORD WITH UNLOCK AT END
001770         MOVE 1 TO W-EC
001780         DISPLAY D-END
001790         GO TO M-30.
001800     GO TO M-15.
001810 M-30.
001820     ACCEPT A-DMM.
001830     IF ESTAT = PF9
001840         GO TO M-90.
001850     IF (ESTAT = ADV) OR (W-EC = 1)
001860         GO TO M-10.
001870     IF ESTAT NOT = HTB
001880         GO TO M-30.
001890     DISPLAY C-CLEAR.
001900     DISPLAY C-MID.
001910     MOVE 4 TO W-L.
001920     GO TO M-15.
001930 M-90.
001940     CLOSE FKSM.
001950     CLOSE S-M.
001960     CLOSE FBKM.
001970 M-95.
001980     DISPLAY C-CLEAR.
001990     STOP RUN.
