000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. TSM050.
000030************************************************
000040*****     受手・支手マスター　修正入力     *****
000050************************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     COPY LIBCSE.                                                 I.970917
000130     SELECT CALNM ASSIGN TO CALN-MSD                              I.910912
000140         ORGANIZATION INDEXED                                     I.910912
000150         ACCESS MODE DYNAMIC                                      I.910912
000160         RECORD KEY CL-KEY                                        I.910912
000170         FILE STATUS IS ERR-STAT.                                 I.910912
000180     SELECT UKET-M ASSIGN TO UKET-MSD
000190         ORGANIZATION INDEXED
000200         ACCESS MODE RANDOM
000210         RECORD KEY UT-KEY
000220         FILE STATUS IS ERR-STAT.
000230     SELECT SHIT-M ASSIGN TO SHIT-MSD
000240         ORGANIZATION INDEXED
000250         ACCESS MODE RANDOM
000260         RECORD KEY ST-KEY
000270         FILE STATUS IS ERR-STAT.
000280*****SELECT T-M ASSIGN TO T-MSD                                   D.000225
000290     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000225
000300         ORGANIZATION INDEXED
000310         ACCESS MODE RANDOM
000320         RECORD KEY T-KEY                                         I.000225
000330         ALTERNATE RECORD KEY T-KEY2                              I.040203
000340         FILE STATUS IS ERR-STAT.                                 I.040203
000350*****    ALTERNATE RECORD KEY T-KEY2.                             D.040203
000360*****    RECORD KEY T-KEY.                                        D.000225
000370     SELECT S-M ASSIGN TO S-MSD
000380         ORGANIZATION INDEXED
000390         ACCESS MODE RANDOM
000400         RECORD KEY S-KEY.
000410     SELECT BANK-M ASSIGN TO BANK-MSD
000420         ORGANIZATION INDEXED
000430         ACCESS MODE RANDOM
000440         RECORD KEY B-KEY.
000450 I-O-CONTROL.
000460     APPLY SHARED-MODE ON M-DATE                                  I.970917
000470     APPLY SHARED-MODE ON CALNM                                   I.910912
000480     APPLY SHARED-MODE ON UKET-M
000490     APPLY SHARED-MODE ON SHIT-M
000500     APPLY SHARED-MODE ON T-M
000510     APPLY SHARED-MODE ON S-M
000520     APPLY SHARED-MODE ON BANK-M.
000530 DATA DIVISION.
000540 FILE SECTION.
000550*****COPY LICALN.                                                 D.970917
000560     COPY LIBFDD.                                                 I.970917
000570     COPY LICAL.                                                  I.970917
000580     COPY LITM.
000590     COPY LISM.
000600     COPY LIBANK.
000610     COPY LIUKET.
000620     COPY LISHIT.
000630 WORKING-STORAGE SECTION.
000640 01  WU-R.
000650     02  WU-KEY         PIC  X(004).                              ﾃｶﾞﾀNO
000660     02  WU-1           PIC  9(002).                              ﾃｶﾞﾀｸﾌﾞﾝ
000670     02  WU-2           PIC  9(002).                              ｼｮﾘｸﾌﾞﾝ
000680     02  WU-3           PIC  9(004).                              BKｺｰﾄﾞ
000690     02  WU-4           PIC  9(002).                              ﾀﾝﾄｳ
000700     02  WU-5           PIC  9(001).                              ﾌﾞﾓﾝ
000710     02  WU-6           PIC  9(002).                              ﾄﾄﾞｳﾌｹﾝ
000720     02  WU-7           PIC  9(004).                              ﾄﾘﾋｷｻｷ
000730     02  WU-9           PIC S9(010).                              ｷﾝｶﾞｸ
000740     02  WU-UNGP.
000750       03  WU-UN        PIC  9(002).
000760       03  WU-UG        PIC  9(002).
000770       03  WU-UP        PIC  9(002).
000780     02  WU-10    REDEFINES WU-UNGP  PIC  9(006).                 ｳｹﾄﾘﾋﾞ
000790     02  WU-11          PIC  9(006).                              ﾌﾘﾀﾞｼﾋﾞ
000800     02  WU-12          PIC  9(006).                              ﾋｷｳｹﾋﾞ
000810     02  WU-MNGP.
000820       03  WU-MN        PIC  9(002).
000830       03  WU-MG        PIC  9(002).
000840       03  WU-MP        PIC  9(002).
000850     02  WU-13    REDEFINES WU-MNGP  PIC  9(006).                 ﾏﾝｷﾋﾞ
000860     02  WU-INGP.
000870       03  WU-IN        PIC  9(002).
000880       03  WU-IG        PIC  9(002).
000890       03  WU-IP        PIC  9(002).
000900     02  WU-14    REDEFINES WU-INGP  PIC  9(006).                 ｲﾄﾞｳﾋﾞ
000910     02  WU-15          PIC  9(004).                              ｼｮﾘBK
000920     02  WU-8           PIC  N(024).                              ﾌﾘﾀﾞｼﾆﾝ
000930     02  WU-8X    REDEFINES WU-8     PIC  X(048).
000940*****02  F              PIC  X(003).                              D.970917
000950     02  F              PIC  X(039).                              I.970917
000960     02  WU-OKD         PIC  9(006).                              ｵﾁｺﾐﾋﾞ
000970     02  WU-SNU         PIC  9(004).                              I.970917
000980     02  WU-SNM         PIC  9(004).                              I.970917
000990     02  WU-SNI         PIC  9(004).                              I.970917
001000*****02  WU-SNU         PIC  9(002).                              D.970917
001010*****02  WU-SNM         PIC  9(002).                              D.970917
001020*****02  WU-SNI         PIC  9(002).                              D.970917
001030 01  WS-R.
001040     02  WS-KEY         PIC  X(004).                              ﾃｶﾞﾀNO
001050     02  WS-1           PIC  9(002).                              ﾃｶﾞﾀｸﾌﾞﾝ
001060     02  WS-2           PIC  9(002).                              ｼｮﾘｸﾌﾞﾝ
001070     02  WS-3           PIC  9(004).                              BKｺｰﾄﾞ
001080     02  WS-4           PIC  9(002).                              ﾄﾄﾞｳﾌｹﾝ
001090     02  WS-5           PIC  9(004).                              ﾄﾘﾋｷｻｷ
001100     02  WS-6           PIC  9(010).                              ｷﾝｶﾞｸ
001110     02  WS-FNGP.
001120       03  WS-FN        PIC  9(002).
001130       03  WS-FG        PIC  9(002).
001140       03  WS-FP        PIC  9(002).
001150     02  WS-7     REDEFINES WS-FNGP  PIC  9(006).                 ﾌﾘﾀﾞｼﾋﾞ
001160     02  WS-MNGP.
001170       03  WS-MN        PIC  9(002).
001180       03  WS-MG        PIC  9(002).
001190       03  WS-MP        PIC  9(002).
001200     02  WS-8     REDEFINES WS-MNGP  PIC  9(006).                 ﾏﾝｷﾋﾞ
001210     02  WS-12          PIC  9(008).                              ｻﾞｲﾘｮｳ
001220     02  WS-14          PIC  9(008).                              ｼｲﾚｼｮｳﾋﾝ
001230     02  WS-46          PIC  9(008).                              ｾﾂﾋﾞ
001240     02  WS-20          PIC  9(008).                              ｶﾞｲﾁｭｳ
001250     02  WS-22          PIC  9(008).                              ｾｲｿﾞｳ
001260     02  WS-34          PIC  9(008).                              ｴｲｷﾞｮｳ
001270     02  WS-52          PIC  9(008).                              ｿﾉﾀ
001280     02  F              PIC  X(024).                              I.970917
001290     02  WS-SNF         PIC  9(004).                              I.970917
001300     02  WS-SNM         PIC  9(004).                              I.970917
001310*****02  F              PIC  X(028).                              D.970917
001320*****02  WS-SNF         PIC  9(002).                              D.970917
001330*****02  WS-SNM         PIC  9(002).                              D.970917
001340 01  W-DATA.
001350     02  W-KEY          PIC  9(004).
001360     02  W-ACT          PIC  9(001).
001370     02  W-DMM          PIC  9(001).
001380     02  W-NO           PIC  9(002).
001390     02  W-TNA          PIC  N(026).                              I.020424
001400*****02  W-TNA          PIC  N(024).                              D.020424
001410     02  W-KIN          PIC  9(010).
001420     02  W-KBN          PIC  N(005).
001430     02  W-SKB          PIC  N(004).
001440     02  W-BKN.
001450       03  W-BNA        PIC  N(008).
001460       03  W-SNA        PIC  N(008).
001470     02  W-YBK.
001480       03  W-YBN        PIC  N(008).
001490       03  W-YSN        PIC  N(008).
001500     02  W-NGP.
001510*****  03  W-NEN        PIC  9(002).                              D.970917
001520       03  W-NEN        PIC  9(004).                              I.970917
001530       03  W-NENL  REDEFINES W-NEN.                               I.970917
001540         04  W-NEN1     PIC  9(002).                              I.970917
001550         04  W-NEN2     PIC  9(002).                              I.970917
001560       03  W-GET        PIC  9(002).
001570       03  W-PEY        PIC  9(002).
001580     02  W-NGPL  REDEFINES W-NGP.                                 I.970917
001590       03  F            PIC  9(002).                              I.970917
001600       03  W-NGPS       PIC  9(006).                              I.970917
001610     02  CHK            PIC  9(001).
001620     02  W-TCD.
001630       03  W-TCD1       PIC  9(001).
001640       03  W-TCD2       PIC  9(003).
001650     02  CNT            PIC  9(002).
001660     02  W-NAAD.
001670       03  W-NA    OCCURS  48  PIC  X(001).
001680     02  W-NAD   REDEFINES W-NAAD  PIC  X(048).
001690 01  ERR-STAT           PIC  X(002).
001700     COPY LSTAT.
001710 SCREEN SECTION.
001720 SD  C-CRT
001730     END STATUS IS ESTAT.
001740 01  C-CLEAR.
001750     02  LINE   1  CLEAR SCREEN.
001760 01  C-MID.
001770     02  LINE   3  COLUMN  10  PIC  N(024) VALUE
001780          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001790     02  LINE   4  COLUMN  10  PIC  N(024) VALUE
001800          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001810     02  LINE   5  COLUMN  10  PIC  N(024) VALUE
001820          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
001830     02  LINE   6  COLUMN  10  PIC  N(024) VALUE
001840          NC"＊＊＊　　　受手・支手マスター　修正　　　＊＊＊".
001850     02  LINE   7  COLUMN  10  PIC  N(024) VALUE
001860          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
001870     02  LINE   8  COLUMN  10  PIC  N(024) VALUE
001880          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001890     02  LINE   9  COLUMN  10  PIC  N(024) VALUE
001900          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001910     02  LINE  12  COLUMN   9  PIC  X(050) VALUE
001920          "[   受取手形ﾏｽﾀｰ = 1  支払手形ﾏｽﾀｰ = 2    ﾘﾀｰﾝ   ]".
001930 01  C-UM.
001940     02  LINE   1  COLUMN  16  PIC  N(021) VALUE
001950          NC"＊＊＊　　受取手形マスター　修正　　＊＊＊".
001960     02  LINE   4  COLUMN  12  PIC  X(036) VALUE
001970          "手形番号          終わり=PF9     NO.".
001980     02  LINE   5  COLUMN   9  PIC  X(011) VALUE " 1.手形区分".
001990     02  LINE   6  COLUMN   9  PIC  X(011) VALUE " 2.処理区分".
002000     02  LINE   7  COLUMN   9  PIC  X(011) VALUE " 3.銀行ｺｰﾄﾞ".
002010     02  LINE   8  COLUMN   9  PIC  X(011) VALUE " 4.担当ｺｰﾄﾞ".
002020     02  LINE   9  COLUMN   9  PIC  X(011) VALUE " 5.部門ｺｰﾄﾞ".
002030     02  LINE  10  COLUMN   9  PIC  X(011) VALUE " 6.府県ｺｰﾄﾞ".
002040     02  LINE  11  COLUMN   9  PIC  X(013) VALUE " 7.取引先ｺｰﾄﾞ".
002050     02  LINE  12.                                                C870428
002060       03  COLUMN   9  PIC  X(003) VALUE " 8.".                   A870428
002070       03  COLUMN  12  PIC  N(001) VALUE NC"裏".                  A870428
002080       03  COLUMN  15  PIC  N(001) VALUE NC"書".                  A870428
002090       03  COLUMN  18  PIC  N(001) VALUE NC"人".                  A870428
002100     02  LINE  13  COLUMN   9  PIC  X(011) VALUE " 9.金　　額".
002110     02  LINE  14  COLUMN   9  PIC  X(011) VALUE "10.日　　付".
002120     02  LINE  15  COLUMN   9  PIC  X(011) VALUE "11.振 出 日".
002130     02  LINE  16  COLUMN   9  PIC  X(011) VALUE "12.引 受 日".
002140     02  LINE  17  COLUMN   9  PIC  X(011) VALUE "13.満 期 日".
002150     02  LINE  18  COLUMN   9  PIC  X(011) VALUE "14.異 動 日".
002160     02  LINE  19  COLUMN   9  PIC  X(011) VALUE "15.割引銀行".
002170     02  LINE  22  COLUMN  20  PIC  X(027) VALUE
002180          "<  確認 OK=1 NO=9   ﾘﾀｰﾝ  >".
002190 01  C-SM.
002200     02  LINE   1  COLUMN  16  PIC  N(021) VALUE
002210          NC"＊＊＊　　支払手形マスター　修正　　＊＊＊".         C870428
002220     02  LINE   4  COLUMN  12  PIC  X(036) VALUE
002230          "手形番号          終わり=PF9     NO.".
002240     02  LINE   5  COLUMN   9  PIC  X(011) VALUE " 1.手形区分".
002250     02  LINE   6  COLUMN   9  PIC  X(011) VALUE " 2.処理区分".
002260     02  LINE   7  COLUMN   9  PIC  X(011) VALUE " 3.銀行ｺｰﾄﾞ".
002270     02  LINE   8  COLUMN   9  PIC  X(011) VALUE " 4.府県ｺｰﾄﾞ".
002280     02  LINE   9  COLUMN   9  PIC  X(013) VALUE " 5.取引先ｺｰﾄﾞ".
002290     02  LINE  10  COLUMN   9  PIC  X(011) VALUE " 6.金　　額".
002300     02  LINE  11  COLUMN   9  PIC  X(011) VALUE " 7.振 出 日".
002310     02  LINE  12  COLUMN   9  PIC  X(011) VALUE " 8.満 期 日".
002320     02  LINE  13  COLUMN   9  PIC  X(011) VALUE "12.材　　料".
002330     02  LINE  14  COLUMN   9  PIC  X(011) VALUE "14.仕入商品".
002340     02  LINE  15  COLUMN   9  PIC  X(011) VALUE "46.設　　備".
002350     02  LINE  16  COLUMN   9  PIC  X(011) VALUE "20.外　　注".
002360     02  LINE  17  COLUMN   9  PIC  X(011) VALUE "22.製造経費".
002370     02  LINE  18  COLUMN   9  PIC  X(011) VALUE "34.営業経費".
002380     02  LINE  19  COLUMN   9  PIC  X(011) VALUE "52.そ の 他".
002390     02  LINE  22  COLUMN  20  PIC  X(027) VALUE
002400          "<  確認 OK=1 NO=9   ﾘﾀｰﾝ  >".
002410 01  C-ACP.
002420     02  A-ACT   LINE  12  COLUMN  50  PIC  9(001)
002430          USING W-ACT   CHECK OVERFLOW NO IFC.
002440     02  LINE   4.
002450       03  A-KEY   COLUMN  23  PIC  9(004)
002460            USING W-KEY   CHECK OVERFLOW NO IFC.
002470       03  A-NO    COLUMN  48  PIC  9(002)
002480            USING W-NO    CHECK OVERFLOW NO IFC.
002490     02  LINE   5.
002500       03  A-U1    COLUMN  23  PIC  9(002)
002510            USING WU-1    CHECK OVERFLOW NO IFC.
002520       03  A-S1    COLUMN  23  PIC  9(002)
002530            USING WS-1    CHECK OVERFLOW NO IFC.
002540     02  LINE   6.
002550       03  A-U2    COLUMN  23  PIC  9(002)
002560            USING WU-2    CHECK OVERFLOW NO IFC.
002570       03  A-S2    COLUMN  23  PIC  9(002)
002580            USING WS-2    CHECK OVERFLOW NO IFC.
002590     02  LINE   7.
002600       03  A-U3    COLUMN  23  PIC  9(004)
002610            USING WU-3    CHECK OVERFLOW NO IFC.
002620       03  A-S3    COLUMN  23  PIC  9(004)
002630            USING WS-3    CHECK OVERFLOW NO IFC.
002640     02  LINE   8.
002650       03  A-U4    COLUMN  23  PIC  9(002)
002660            USING WU-4    CHECK OVERFLOW NO IFC.
002670       03  A-S4    COLUMN  23  PIC  9(002)
002680            USING WS-4    CHECK OVERFLOW NO IFC.
002690     02  LINE   9.
002700       03  A-U5    COLUMN  23  PIC  9(001)
002710            USING WU-5    CHECK OVERFLOW NO IFC.
002720       03  A-S5    COLUMN  23  PIC  9(004)
002730            USING WS-5    CHECK OVERFLOW NO IFC.
002740     02  LINE  10.
002750       03  A-U6    COLUMN  23  PIC  9(002)
002760            USING WU-6    CHECK OVERFLOW NO IFC.
002770       03  A-S6    COLUMN  23  PIC S9(010)
002780            USING WS-6    CHECK OVERFLOW NO IFC.
002790     02  LINE  11.
002800       03  A-U7    COLUMN  23  PIC  9(004)
002810            USING WU-7    CHECK OVERFLOW NO IFC.
002820       03  A-S7    COLUMN  23  PIC  9(006)
002830            USING WS-7    CHECK OVERFLOW NO IFC.
002840     02  LINE  12.
002850       03  A-U8    COLUMN  29  PIC  N(024)
002860            USING WU-8    CHECK OVERFLOW NO IFC.
002870       03  A-S8    COLUMN  23  PIC  9(006)
002880            USING WS-8    CHECK OVERFLOW NO IFC.
002890     02  LINE  13.
002900       03  A-U9    COLUMN  23  PIC  9(010)
002910            USING WU-9    CHECK OVERFLOW NO IFC.
002920       03  A-S12   COLUMN  25  PIC S9(008)
002930            USING WS-12   CHECK OVERFLOW NO IFC.
002940     02  LINE  14.
002950       03  A-U10   COLUMN  23  PIC  9(006)
002960            USING WU-10   CHECK OVERFLOW NO IFC.
002970       03  A-S14   COLUMN  25  PIC S9(008)
002980            USING WS-14   CHECK OVERFLOW NO IFC.
002990     02  LINE  15.
003000       03  A-U11   COLUMN  23  PIC  9(006)
003010            USING WU-11   CHECK OVERFLOW NO IFC.
003020       03  A-S46   COLUMN  25  PIC S9(008)
003030            USING WS-46   CHECK OVERFLOW NO IFC.
003040     02  LINE  16.
003050       03  A-U12   COLUMN  23  PIC  9(006)
003060            USING WU-12   CHECK OVERFLOW NO IFC.
003070       03  A-S20   COLUMN  25  PIC S9(008)
003080            USING WS-20   CHECK OVERFLOW NO IFC.
003090     02  LINE  17.
003100       03  A-U13   COLUMN  23  PIC  9(006)
003110            USING WU-13   CHECK OVERFLOW NO IFC.
003120       03  A-S22   COLUMN  25  PIC S9(008)
003130            USING WS-22   CHECK OVERFLOW NO IFC.
003140     02  LINE  18.
003150       03  A-U14   COLUMN  23  PIC  9(006)
003160            USING WU-14   CHECK OVERFLOW NO IFC.
003170       03  A-S34   COLUMN  25  PIC S9(008)
003180            USING WS-34   CHECK OVERFLOW NO IFC.
003190     02  LINE  19.
003200       03  A-U15   COLUMN  23  PIC  9(004)
003210            USING WU-15   CHECK OVERFLOW NO IFC.
003220       03  A-S52   COLUMN  25  PIC S9(008)
003230            USING WS-52   CHECK OVERFLOW NO IFC.
003240     02  A-DMM   LINE  22  COLUMN  39  PIC  9(001)
003250          USING W-DMM   CHECK OVERFLOW NO IFC.
003260 01  C-DSP.
003270     02  D-KBM   LINE   5  COLUMN  29  PIC  N(005) FROM  W-KBN.
003280     02  D-SKB   LINE   6  COLUMN  29  PIC  N(004) FROM  W-SKB.
003290     02  D-BKN   LINE   7.
003300       03  COLUMN  29  PIC  N(008) FROM  W-BNA.
003310       03  COLUMN  47  PIC  N(008) FROM  W-SNA.
003320*****02  D-STNA  LINE   9  COLUMN  29  PIC  N(024) FROM  W-TNA.   D.020424
003330     02  D-STNA  LINE   9  COLUMN  29  PIC  N(026) FROM  W-TNA.   I.020424
003340     02  D-SKIN  LINE  10  COLUMN  23  PIC ZZZZZZZZZ9- FROM  WS-6.
003350*****02  D-UTNA  LINE  11  COLUMN  29  PIC  N(024) FROM  W-TNA.   D.020424
003360     02  D-UTNA  LINE  11  COLUMN  29  PIC  N(026) FROM  W-TNA.   I.020424
003370     02  LINE  13.
003380       03  D-UKIN  COLUMN  23  PIC ZZZZZZZZZ9  FROM  WU-9.
003390       03  D-S12   COLUMN  25  PIC ZZZZZZZ9-   FROM  WS-12.
003400     02  D-S14   LINE  14  COLUMN  25  PIC ZZZZZZZ9- FROM  WS-14.
003410     02  D-S46   LINE  15  COLUMN  25  PIC ZZZZZZZ9- FROM  WS-46.
003420     02  D-S20   LINE  16  COLUMN  25  PIC ZZZZZZZ9- FROM  WS-20.
003430     02  D-S22   LINE  17  COLUMN  25  PIC ZZZZZZZ9- FROM  WS-22.
003440     02  D-S34   LINE  18  COLUMN  25  PIC ZZZZZZZ9- FROM  WS-34.
003450     02  LINE  19.
003460       03  D-S52   COLUMN  25  PIC ZZZZZZZ9- FROM  WS-52.
003470       03  D-YBK.
003480         04  D-YBN   COLUMN  29  PIC  N(008) FROM  W-YBN.
003490         04  D-YSN   COLUMN  47  PIC  N(008) FROM  W-YSN.
003500 01  C-SPC.
003510     02  S-U11   LINE  15  COLUMN  23  PIC  X(006) VALUE "      ".
003520     02  S-U12   LINE  16  COLUMN  23  PIC  X(006) VALUE "      ".
003530     02  S-U14   LINE  18  COLUMN  23  PIC  X(006) VALUE "      ".
003540     02  S-U15   LINE  19  COLUMN  23  PIC  X(004) VALUE "    ".
003550 01  C-ERR.
003560     02  LINE  24.
003570       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
003580       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
003590            "***  UKETM ﾅｼ  ***".
003600       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
003610            "***  SHITM ﾅｼ  ***".
003620       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
003630            "***  BANKM ﾅｼ  ***".
003640       03  E-ME4   COLUMN  15  PIC  X(015) VALUE
003650            "***  TM ﾅｼ  ***".
003660       03  E-ME5   COLUMN  15  PIC  X(015) VALUE
003670            "***  SM ﾅｼ  ***".
003680       03  E-ME7   COLUMN  15  PIC  X(020) VALUE
003690            "***  ｲﾄﾞｳﾋﾞ ｴﾗｰ  ***".
003700       03  E-ME8   COLUMN  15  PIC  X(020) VALUE
003710            "***  ﾋｷｳｹﾋﾞ ｴﾗｰ  ***".
003720       03  E-ME9   COLUMN  15  PIC  X(021) VALUE
003730            "***  ﾌﾘﾀﾞｼﾋﾞ ｴﾗｰ  ***".
003740       03  E-ME10  COLUMN  15  PIC  X(025) VALUE
003750            "***  ﾜﾘﾋﾞｷ ｷﾞﾝｺｳ ｴﾗｰ  ***".
003760       03  E-ME11  COLUMN  15  PIC  X(019) VALUE
003770            "***  ｷﾝｶﾞｸ ｴﾗｰ  ***".
003780       03  E-ME12  COLUMN  15  PIC  X(025) VALUE
003790            "***  ｺﾓｼﾞ ﾉ ｽﾍﾟ-ｽ ｱﾘ  ***".
003800       03  E-ME13  COLUMN  15  PIC  X(018) VALUE                  I.910912
003810            "***  CALNM ﾅｼ  ***".                                 I.910912
003820       03  E-ME20  COLUMN  15  PIC  X(027) VALUE
003830            "***  UKETM REWRITE ｴﾗｰ  ***".
003840       03  E-ME21  COLUMN  15  PIC  X(027) VALUE
003850            "***  SHITM REWRITE ｴﾗｰ  ***".
003860       03  E-ME22  COLUMN  15  PIC  X(024) VALUE                  I.040203
003870            "***  TM REWRITE ｴﾗｰ  ***".                           I.040203
003880*****  03  E-NGP   COLUMN  50  PIC  9(006) FROM  W-NGP.           D.970917
003890       03  E-NGP   COLUMN  50  PIC  9(008) FROM  W-NGP.           I.970917
003900       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        I.930910
003910       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003920       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003930       03  E-CL    COLUMN  10  PIC  X(050) VALUE
003940            "                                                  ".
003950     COPY LIBSCR.                                                 I.970917
003960 PROCEDURE DIVISION.
003970 M-020.
003980     DISPLAY C-CLEAR.
003990     DISPLAY C-MID.
004000     ACCEPT A-ACT.
004010     IF ESTAT = PF9                                               I.040203
004020         DISPLAY C-CLEAR                                          I.040203
004030         STOP RUN.                                                I.040203
004040     IF ESTAT NOT = HTB AND SKP
004050         GO TO M-020.
004060     IF W-ACT NOT = 1 AND 2
004070         GO TO M-020.
004080     COPY LIBCPR.                                                 I.970917
004090     OPEN INPUT BANK-M CALNM.                                     C.910912
004100     IF W-ACT = 2
004110         GO TO M-500.
004120*****OPEN INPUT T-M.                                              D.040203
004130     OPEN I-O T-M.                                                I.040203
004140     OPEN I-O UKET-M.
004150 M-100.
004160     DISPLAY C-CLEAR.
004170     DISPLAY C-UM.
004180     ACCEPT A-KEY.
004190     IF ESTAT = PF9
004200         CLOSE UKET-M T-M
004210         GO TO M-900.
004220     IF ESTAT NOT = HTB AND SKP
004230         GO TO M-100.
004240     MOVE W-KEY TO UT-KEY.
004250     READ UKET-M INVALID KEY
004260         DISPLAY E-ME1 E-ME98
004270         GO TO M-100.
004280     INITIALIZE WU-R.
004290     MOVE UKET-R TO WU-R.
004300     PERFORM S-05 THRU S-10.
004310     PERFORM S-15 THRU S-20.
004320     MOVE WU-7 TO T-KEY.
004330     READ T-M WITH UNLOCK INVALID KEY
004340         MOVE NC"　＊＊＊　　得意先　無し　　＊＊＊" TO T-NAME.
004350     MOVE T-NAME TO W-TNA.
004360     MOVE SPACE TO W-BKN W-YBK.
004370     MOVE WU-3 TO B-KEY.
004380     READ BANK-M WITH UNLOCK INVALID KEY
004390         MOVE NC"ＢＡＮＫＭ　無し" TO B-BNA
004400         MOVE SPACE TO B-SNA.
004410     MOVE B-BNA TO W-BNA.
004420     MOVE B-SNA TO W-SNA.
004430     IF WU-15 = ZERO
004440         GO TO M-120.
004450     MOVE WU-15 TO B-KEY.
004460     READ BANK-M WITH UNLOCK INVALID KEY
004470         MOVE NC"ＢＡＮＫＭ　無し" TO B-BNA
004480         MOVE SPACE TO B-SNA.
004490     MOVE B-BNA TO W-YBN.
004500     MOVE B-SNA TO W-YSN.
004510 M-120.
004520     DISPLAY A-U1 D-KBM A-U2 D-SKB A-U3 D-BKN A-U4 A-U5
004530             A-U6 A-U7 D-UTNA A-U8 D-UKIN A-U10 A-U13.
004540     IF WU-11 NOT = ZERO
004550         DISPLAY A-U11.
004560     IF WU-12 NOT = ZERO
004570         DISPLAY A-U12.
004580     IF WU-14 NOT = ZERO
004590         DISPLAY A-U14.
004600     IF WU-15 NOT = ZERO
004610         DISPLAY A-U15 D-YBK.
004620 M-130.
004630     ACCEPT A-NO.
004640     DISPLAY E-CL.
004650     IF ESTAT = BTB
004660         GO TO M-100.
004670     IF ESTAT NOT = HTB AND SKP
004680         GO TO M-130.
004690     IF W-NO = 99
004700         GO TO M-340.
004710     IF W-NO < 1 OR > 15
004720         GO TO M-130.
004730 M-140.
004740     IF W-NO NOT = 1
004750         GO TO M-150.
004760     ACCEPT A-U1.
004770     IF ESTAT = BTB
004780         GO TO M-130.
004790     IF ESTAT NOT = HTB AND SKP
004800         GO TO M-140.
004810*****IF WU-1 NOT = 10 AND 11 AND 12                               D.161003
004820     IF WU-1 NOT = 10 AND 11 AND 12 AND 13                        I.161003
004830         GO TO M-140.
004840     PERFORM S-05 THRU S-10.
004850     DISPLAY D-KBM.
004860     GO TO M-130.
004870 M-150.
004880     IF W-NO NOT = 2
004890         GO TO M-160.
004900     ACCEPT A-U2.
004910     IF ESTAT = BTB
004920         GO TO M-130.
004930     IF ESTAT NOT = HTB AND SKP
004940         GO TO M-150.
004950*****IF WU-2 NOT = 00 AND 32 AND 19 AND 20 AND 50 AND 60 AND 90   D.980507
004960     IF WU-2 NOT = 00 AND 19 AND 20 AND 32 AND                    I.980507
004970                   50 AND 60 AND 70 AND 90                        I.980507
004980         GO TO M-150.
004990     PERFORM S-15 THRU S-20.
005000     DISPLAY D-SKB.
005010     GO TO M-130.
005020 M-160.
005030     IF W-NO NOT = 3
005040         GO TO M-170.
005050     ACCEPT A-U3.
005060     DISPLAY E-CL.
005070     IF ESTAT = BTB
005080         GO TO M-130.
005090     IF ESTAT NOT = HTB AND SKP
005100         GO TO M-160.
005110     MOVE WU-3 TO B-KEY.
005120     READ BANK-M WITH UNLOCK INVALID KEY
005130         DISPLAY E-ME3 E-ME98
005140         GO TO M-160.
005150     MOVE B-BNA TO W-BNA.
005160     MOVE B-SNA TO W-SNA.
005170     DISPLAY D-BKN.
005180     GO TO M-130.
005190 M-170.
005200     IF W-NO NOT = 4
005210         GO TO M-180.
005220     ACCEPT A-U4.
005230     IF ESTAT = BTB
005240         GO TO M-130.
005250     IF ESTAT NOT = HTB AND SKP
005260         GO TO M-170.
005270     GO TO M-130.
005280 M-180.
005290     IF W-NO NOT = 5
005300         GO TO M-190.
005310     ACCEPT A-U5.
005320     IF ESTAT = BTB
005330         GO TO M-130.
005340     IF ESTAT NOT = HTB AND SKP
005350         GO TO M-180.
005360     IF WU-5 NOT = ZERO AND 1 AND 2 AND 3
005370         GO TO M-180.
005380     GO TO M-130.
005390 M-190.
005400     IF W-NO NOT = 6
005410         GO TO M-200.
005420     ACCEPT A-U6.
005430     IF ESTAT = BTB
005440         GO TO M-130.
005450     IF ESTAT NOT = HTB AND SKP
005460         GO TO M-190.
005470     IF WU-6 < 1 OR > 47
005480         GO TO M-190.
005490     GO TO M-130.
005500 M-200.
005510     IF W-NO NOT = 7
005520         GO TO M-240.
005530     ACCEPT A-U7.
005540     DISPLAY E-CL.
005550     IF ESTAT = BTB
005560         GO TO M-130.
005570     IF ESTAT NOT = HTB AND SKP
005580         GO TO M-200.
005590     MOVE WU-7 TO T-KEY.
005600     READ T-M WITH UNLOCK INVALID KEY
005610         DISPLAY E-ME4 E-ME98
005620         GO TO M-200.
005630     MOVE T-NAME TO W-TNA.
005640     DISPLAY D-UTNA.
005650     GO TO M-130.
005660 M-240.
005670     IF W-NO NOT = 8
005680         GO TO M-250.
005690     ACCEPT A-U8.
005700     DISPLAY E-CL.
005710     IF ESTAT = BTB
005720         GO TO M-130.
005730     IF ESTAT NOT = HTB AND SKP
005740         GO TO M-240.
005750     MOVE WU-8X TO W-NAD.
005760     IF SPACE = W-NA(1) OR W-NA(3) OR W-NA(5) OR W-NA(7)
005770                  OR  W-NA(9) OR W-NA(11) OR W-NA(13) OR W-NA(15)
005780                  OR W-NA(17) OR W-NA(19) OR W-NA(21) OR W-NA(23)
005790                  OR W-NA(25) OR W-NA(27) OR W-NA(29) OR W-NA(31)
005800                  OR W-NA(33) OR W-NA(35) OR W-NA(37) OR W-NA(39)
005810                  OR W-NA(41) OR W-NA(43) OR W-NA(45) OR W-NA(47)
005820         DISPLAY E-ME12 E-ME98
005830         GO TO M-240.
005840     GO TO M-130.
005850 M-250.
005860     IF W-NO NOT = 9
005870         GO TO M-260.
005880     ACCEPT A-U9.
005890     IF ESTAT = BTB
005900         GO TO M-130.
005910     IF ESTAT NOT = HTB AND SKP
005920         GO TO M-250.
005930     DISPLAY D-UKIN.
005940     IF WU-9 = ZERO
005950         GO TO M-250.
005960     GO TO M-130.
005970 M-260.
005980     IF W-NO NOT = 10
005990         GO TO M-270.
006000     ACCEPT A-U10.
006010     IF ESTAT = BTB
006020         GO TO M-130.
006030     IF ESTAT NOT = HTB AND SKP
006040         GO TO M-260.
006050*****MOVE WU-10 TO W-NGP.                                         D.970917
006060     MOVE ZERO TO W-NGP.                                          I.970917
006070     MOVE WU-10 TO W-NGPS.                                        I.970917
006080     PERFORM S-25 THRU S-35.
006090     IF CHK = 5
006100         GO TO M-260.
006110     GO TO M-130.
006120 M-270.
006130     IF W-NO NOT = 11
006140         GO TO M-280.
006150     ACCEPT A-U11.
006160     IF ESTAT = BTB
006170         GO TO M-130.
006180     IF ESTAT NOT = HTB AND SKP
006190         GO TO M-270.
006200     IF WU-11 = ZERO
006210         DISPLAY S-U11
006220         GO TO M-130.
006230*****MOVE WU-11 TO W-NGP.                                         D.970917
006240     MOVE ZERO TO W-NGP.                                          I.970917
006250     MOVE WU-11 TO W-NGPS.                                        I.970917
006260     PERFORM S-25 THRU S-35.
006270     IF CHK = 5
006280         GO TO M-270.
006290     GO TO M-130.
006300 M-280.
006310     IF W-NO NOT = 12
006320         GO TO M-290.
006330     ACCEPT A-U12.
006340     IF ESTAT = BTB
006350         GO TO M-130.
006360     IF ESTAT NOT = HTB AND SKP
006370         GO TO M-280.
006380     IF WU-12 = ZERO
006390         DISPLAY S-U12
006400         GO TO M-130.
006410*****MOVE WU-12 TO W-NGP.                                         D.970917
006420     MOVE ZERO TO W-NGP.                                          I.970917
006430     MOVE WU-12 TO W-NGPS.                                        I.970917
006440     PERFORM S-25 THRU S-35.
006450     IF CHK = 5
006460         GO TO M-280.
006470     GO TO M-130.
006480 M-290.
006490     IF W-NO NOT = 13
006500         GO TO M-320.
006510     ACCEPT A-U13.
006520     DISPLAY E-CL.                                                I.910912
006530     IF ESTAT = BTB
006540         GO TO M-130.
006550     IF ESTAT NOT = HTB AND SKP
006560         GO TO M-290.
006570*****MOVE WU-13 TO W-NGP.                                         D.970917
006580     MOVE ZERO TO W-NGP.                                          I.970917
006590     MOVE WU-13 TO W-NGPS.                                        I.970917
006600     PERFORM S-25 THRU S-35.
006610     IF CHK = 5
006620         GO TO M-290.
006630*****IF W-NEN > 62                                                D.930910
006640*****    ADD 25 TO W-NEN                                          D.930910
006650*****  ELSE                                                       D.930910
006660*****ADD 88 TO W-NEN.                                             D.970917
006670*****MOVE W-NGP TO CL-KEY.                                        D.970917
006680*****READ CALNM WITH UNLOCK INVALID KEY                           D.970917
006690*****    DISPLAY E-ME13 E-NGP E-ME98                              D.970917
006700*****    GO TO M-290.                                             D.970917
006710     IF CL-SJ = 0                                                 I.910912
006720         GO TO M-310.                                             I.910912
006730 M-300.                                                           I.910912
006740     READ CALNM NEXT RECORD WITH UNLOCK AT END                    I.910912
006750         DISPLAY E-ME13 E-NGP E-ME98                              I.910912
006760         GO TO M-290.                                             I.910912
006770     IF CL-SJ = 1                                                 I.910912
006780         GO TO M-300.                                             I.910912
006790 M-310.                                                           I.910912
006800*****MOVE CL-KEY TO WU-OKD.                                       D.970917
006810     MOVE CL-NGPS TO WU-OKD.                                      I.970917
006820     GO TO M-130.
006830 M-320.
006840     IF W-NO NOT = 14
006850         GO TO M-330.
006860     ACCEPT A-U14.
006870     IF ESTAT = BTB
006880         GO TO M-130.
006890     IF ESTAT NOT = HTB AND SKP
006900         GO TO M-320.
006910     IF WU-14 = ZERO
006920         DISPLAY S-U14
006930         GO TO M-130.
006940*****MOVE WU-14 TO W-NGP.                                         D.970917
006950     MOVE ZERO TO W-NGP.                                          I.970917
006960     MOVE WU-14 TO W-NGPS.                                        I.970917
006970     PERFORM S-25 THRU S-35.
006980     IF CHK = 5
006990         GO TO M-320.
007000     GO TO M-130.
007010 M-330.
007020     ACCEPT A-U15.
007030     DISPLAY E-CL.
007040     IF ESTAT = BTB
007050         GO TO M-130.
007060     IF ESTAT NOT = HTB AND SKP
007070         GO TO M-330.
007080     IF WU-15 = ZERO
007090         MOVE SPACE TO W-YBK
007100         DISPLAY S-U15 D-YBK
007110         GO TO M-130.
007120     MOVE WU-15 TO B-KEY.
007130     READ BANK-M WITH UNLOCK INVALID KEY
007140         DISPLAY E-ME3 E-ME98
007150         GO TO M-330.
007160     MOVE B-BNA TO W-YBN.
007170     MOVE B-SNA TO W-YSN.
007180     DISPLAY D-YBK.
007190     GO TO M-130.
007200 M-340.
007210     IF WU-2 NOT = 32 AND 19 AND 20 AND 50
007220         GO TO M-360.
007230     IF WU-15 = ZERO
007240         DISPLAY E-ME10 E-ME98
007250         GO TO M-130.
007260     IF WU-11 = ZERO
007270         DISPLAY E-ME9 E-ME98
007280         GO TO M-130.
007290     IF WU-14 = ZERO
007300         DISPLAY E-ME7 E-ME98
007310         GO TO M-130.
007320     IF WU-1 = 12
007330         GO TO M-350.
007340     IF WU-12 NOT = ZERO
007350         DISPLAY E-ME8 E-ME98
007360         GO TO M-130.
007370     GO TO M-360.
007380 M-350.
007390     IF WU-12 = ZERO
007400         DISPLAY E-ME8 E-ME98
007410         GO TO M-130.
007420 M-360.
007430     ACCEPT A-DMM.
007440     IF ESTAT = BTB
007450         GO TO M-130.
007460     IF ESTAT NOT = HTB AND SKP
007470         GO TO M-360.
007480     IF W-DMM = 9
007490         GO TO M-130.
007500     IF W-DMM NOT = 1
007510         GO TO M-360.
007520*
007530*****IF WU-UN > 62                                                D.930910
007540*****    COMPUTE WU-SNU = WU-UN + 25                              D.930910
007550*****  ELSE                                                       D.930910
007560*****COMPUTE WU-SNU = WU-UN + 88.                                 D.970917
007570*****IF WU-MN > 62                                                D.930910
007580*****    COMPUTE WU-SNM = WU-MN + 25                              D.930910
007590*****  ELSE                                                       D.930910
007600*****COMPUTE WU-SNM = WU-MN + 88.                                 D.970917
007610*****IF WU-IN > 62                                                D.930910
007620*****    COMPUTE WU-SNI = WU-IN + 25                              D.930910
007630*****  ELSE                                                       D.930910
007640*****COMPUTE WU-SNI = WU-IN + 88.                                 D.970917
007650     MOVE ZERO TO W-NEN.                                          I.970917
007660     MOVE WU-UN TO W-NEN2.                                        I.970917
007670     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
007680         ADD DATE-YC1 TO W-NEN                                    I.970917
007690       ELSE                                                       I.970917
007700         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
007710             ADD DATE-YC2 TO W-NEN.                               I.970917
007720     MOVE W-NEN TO WU-SNU.                                        I.970917
007730     MOVE ZERO TO W-NEN.                                          I.970917
007740*****MOVE WU-UN TO W-NEN2.                                        D.080306
007750     MOVE WU-MN TO W-NEN2.                                        D.080306
007760     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
007770         ADD DATE-YC1 TO W-NEN                                    I.970917
007780       ELSE                                                       I.970917
007790         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
007800             ADD DATE-YC2 TO W-NEN.                               I.970917
007810     MOVE W-NEN TO WU-SNM.                                        I.970917
007820     MOVE ZERO TO W-NEN.                                          I.970917
007830     MOVE WU-IN TO W-NEN2.                                        I.970917
007840     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
007850         ADD DATE-YC1 TO W-NEN                                    I.970917
007860       ELSE                                                       I.970917
007870         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
007880             ADD DATE-YC2 TO W-NEN.                               I.970917
007890     IF WU-14 = ZERO                                              I.970917
007900         MOVE ZERO TO WU-SNI                                      I.970917
007910       ELSE                                                       I.970917
007920         MOVE W-NEN TO WU-SNI.                                    I.970917
007930     MOVE WU-R TO UKET-R.
007940     REWRITE UKET-R INVALID KEY
007950         DISPLAY E-ME78 E-STAT E-ME20 E-ME99                      C.930910
007960         GO TO M-900.
007970*
007980     IF WU-2 NOT = 60                                             I.040203
007990         GO TO M-100.                                             I.040203
008000     IF T-ENG NOT = ZERO                                          I.040203
008010         GO TO M-100.                                             I.040203
008020     MOVE WU-7 TO T-KEY.                                          I.040203
008030     READ T-M INVALID KEY                                         I.040203
008040         DISPLAY E-ME4 E-ME99                                     I.040203
008050         DISPLAY E-CL                                             I.040203
008060         GO TO M-100.                                             I.040203
008070     MOVE D-NTNG TO T-ENG.                                        I.040203
008080     REWRITE T-R INVALID KEY                                      I.040203
008090         DISPLAY E-STAT E-ME22 E-ME99                             I.040203
008100         DISPLAY E-CL.                                            I.040203
008110     GO TO M-100.
008120 M-500.
008130     OPEN INPUT S-M.
008140     OPEN I-O SHIT-M.
008150 M-510.
008160     DISPLAY C-CLEAR.
008170     DISPLAY C-SM.
008180     ACCEPT A-KEY.
008190     IF ESTAT = PF9
008200         CLOSE SHIT-M S-M
008210         GO TO M-900.
008220     IF ESTAT NOT = HTB AND SKP
008230         GO TO M-510.
008240     MOVE W-KEY TO ST-KEY.
008250     READ SHIT-M INVALID KEY
008260         DISPLAY E-ME2 E-ME98
008270         GO TO M-510.
008280     INITIALIZE WS-R.
008290     MOVE SHIT-R TO WS-R.
008300     MOVE SPACE TO W-KBN.
008310     IF WS-1 = 21
008320         MOVE NC"支払約手　" TO W-KBN.
008330     IF WS-1 = 22
008340         MOVE NC"支払為手　" TO W-KBN.
008350     MOVE SPACE TO W-SKB.
008360     IF WS-2 = 50
008370         MOVE NC"決　　済" TO W-SKB.
008380     IF WS-2 = 80
008390         MOVE NC"強制決済" TO W-SKB.
008400     IF WS-2 = 90
008410         MOVE NC"取消し　" TO W-SKB.
008420     MOVE WS-5 TO S-KEY.
008430     READ S-M WITH UNLOCK INVALID KEY
008440         MOVE NC"＊＊＊　　仕入先　無し　　＊＊＊　" TO S-NAME.
008450     MOVE SPACE TO W-TNA.                                         I.020424
008460     MOVE S-NAME TO W-TNA.
008470     MOVE SPACE TO W-BKN.
008480     MOVE WS-3 TO B-KEY.
008490     READ BANK-M WITH UNLOCK INVALID KEY
008500         MOVE NC"ＢＡＮＫＭ　無し" TO B-BNA
008510         MOVE SPACE TO B-SNA.
008520     MOVE B-BNA TO W-BNA.
008530     MOVE B-SNA TO W-SNA.
008540     DISPLAY A-S1 D-KBM A-S2 D-SKB A-S3 D-BKN
008550             A-S4 A-S5 D-STNA D-SKIN A-S7 A-S8
008560             D-S12 D-S14 D-S46 D-S20 D-S22 D-S34 D-S52.
008570 M-530.
008580     ACCEPT A-NO.
008590     DISPLAY E-CL.
008600     IF ESTAT = BTB
008610         GO TO M-510.
008620     IF ESTAT NOT = HTB AND SKP
008630         GO TO M-530.
008640     IF W-NO = 99
008650         GO TO M-690.
008660     IF W-NO < 1 OR > 52
008670         GO TO M-530.
008680 M-540.
008690     IF W-NO NOT = 1
008700         GO TO M-550.
008710     ACCEPT A-S1.
008720     IF ESTAT = BTB
008730         GO TO M-530.
008740     IF ESTAT NOT = HTB AND SKP
008750         GO TO M-540.
008760     IF WS-1 NOT = 22
008770         GO TO M-540.
008780     MOVE NC"支払為手　" TO W-KBN.
008790     DISPLAY D-KBM.
008800     GO TO M-530.
008810 M-550.
008820     IF W-NO NOT = 2
008830         GO TO M-560.
008840     ACCEPT A-S2.
008850     IF ESTAT = BTB
008860         GO TO M-530.
008870     IF ESTAT NOT = HTB AND SKP
008880         GO TO M-550.
008890     IF WS-2 NOT = 00 AND 50 AND 80 AND 90
008900         GO TO M-550.
008910     MOVE SPACE TO W-SKB.
008920     IF WS-2 = 50
008930         MOVE NC"決　　済" TO W-SKB.
008940     IF WS-2 = 80
008950         MOVE NC"強制決済" TO W-SKB.
008960     IF WS-2 = 90
008970         MOVE NC"取消し　" TO W-SKB.
008980     DISPLAY D-SKB.
008990     GO TO M-530.
009000 M-560.
009010     IF W-NO NOT = 3
009020         GO TO M-570.
009030     ACCEPT A-S3.
009040     DISPLAY E-CL.
009050     IF ESTAT = BTB
009060         GO TO M-530.
009070     IF ESTAT NOT = HTB AND SKP
009080         GO TO M-560.
009090     MOVE WS-3 TO B-KEY.
009100     READ BANK-M WITH UNLOCK INVALID KEY
009110         DISPLAY E-ME3 E-ME98
009120         GO TO M-560.
009130     MOVE B-BNA TO W-BNA.
009140     MOVE B-SNA TO W-SNA.
009150     DISPLAY D-BKN.
009160     GO TO M-530.
009170 M-570.
009180     IF W-NO NOT = 4
009190         GO TO M-580.
009200     ACCEPT A-S4.
009210     IF ESTAT = BTB
009220         GO TO M-530.
009230     IF ESTAT NOT = HTB AND SKP
009240         GO TO M-570.
009250     IF WS-4 < 1 OR > 47
009260         GO TO M-570.
009270     GO TO M-530.
009280 M-580.
009290     IF W-NO NOT = 5
009300         GO TO M-590.
009310     ACCEPT A-S5.
009320     DISPLAY E-CL.
009330     IF ESTAT = BTB
009340         GO TO M-530.
009350     IF ESTAT NOT = HTB AND SKP
009360         GO TO M-580.
009370     IF WS-5 > 4999
009380         GO TO M-580.
009390     MOVE WS-5 TO S-KEY.
009400     READ S-M WITH UNLOCK INVALID KEY
009410         DISPLAY E-ME5 E-ME98
009420         GO TO M-580.
009430     MOVE SPACE TO W-TNA.                                         I.020424
009440     MOVE S-NAME TO W-TNA.
009450     DISPLAY D-STNA.
009460     GO TO M-530.
009470 M-590.
009480     IF W-NO NOT = 6
009490         GO TO M-600.
009500     ACCEPT A-S6.
009510     IF ESTAT = BTB
009520         GO TO M-530.
009530     IF ESTAT NOT = HTB AND SKP
009540         GO TO M-590.
009550     IF WS-6 = ZERO
009560         GO TO M-590.
009570     DISPLAY D-SKIN.
009580     GO TO M-530.
009590 M-600.
009600     IF W-NO NOT = 7
009610         GO TO M-610.
009620     ACCEPT A-S7.
009630     IF ESTAT = BTB
009640         GO TO M-530.
009650     IF ESTAT NOT = HTB AND SKP
009660         GO TO M-600.
009670*****MOVE WS-7 TO W-NGP.                                          D.970917
009680     MOVE ZERO TO W-NGP.                                          I.970917
009690     MOVE WS-7 TO W-NGPS.                                         I.970917
009700     PERFORM S-25 THRU S-35.
009710     IF CHK = 5
009720         GO TO M-600.
009730     GO TO M-530.
009740 M-610.
009750     IF W-NO NOT = 8
009760         GO TO M-620.
009770     ACCEPT A-S8.
009780     DISPLAY E-CL.                                                I.910912
009790     IF ESTAT = BTB
009800         GO TO M-530.
009810     IF ESTAT NOT = HTB AND SKP
009820         GO TO M-610.
009830*****MOVE WS-8 TO W-NGP.                                          D.970917
009840     MOVE ZERO TO W-NGP.                                          I.970917
009850     MOVE WS-8 TO W-NGPS.                                         I.970917
009860     PERFORM S-25 THRU S-35.
009870     IF CHK = 5
009880         GO TO M-610.
009890*****IF W-NEN > 62                                                D.930910
009900*****    ADD 25 TO W-NEN                                          D.930910
009910*****  ELSE                                                       D.930910
009920*****ADD 88 TO W-NEN.                                             D.970917
009930*****MOVE W-NGP TO CL-KEY.                                        D.970917
009940*****READ CALNM WITH UNLOCK INVALID KEY                           D.970917
009950*****    DISPLAY E-ME13 E-NGP E-ME98                              D.970917
009960*****    GO TO M-610.                                             D.970917
009970     IF CL-SJ = 1                                                 I.910912
009980         GO TO M-610.                                             I.910912
009990     GO TO M-530.
010000 M-620.
010010     IF W-NO NOT = 12
010020         GO TO M-630.
010030     ACCEPT A-S12.
010040     IF ESTAT = BTB
010050         GO TO M-530.
010060     IF ESTAT NOT = HTB AND SKP
010070         GO TO M-620.
010080     DISPLAY D-S12.
010090     GO TO M-530.
010100 M-630.
010110     IF W-NO NOT = 14
010120         GO TO M-640.
010130     ACCEPT A-S14.
010140     IF ESTAT = BTB
010150         GO TO M-530.
010160     IF ESTAT NOT = HTB AND SKP
010170         GO TO M-630.
010180     DISPLAY D-S14.
010190     IF WS-14 = ZERO
010200         GO TO M-530.
010210     MOVE WS-5 TO W-TCD.
010220     ADD 5 TO W-TCD1.
010230     MOVE W-TCD TO S-KEY.
010240     READ S-M WITH UNLOCK INVALID KEY
010250         DISPLAY E-ME5 E-ME98
010260         GO TO M-630.
010270     GO TO M-530.
010280 M-640.
010290     IF W-NO NOT = 46
010300         GO TO M-650.
010310     ACCEPT A-S46.
010320     IF ESTAT = BTB
010330         GO TO M-530.
010340     IF ESTAT NOT = HTB AND SKP
010350         GO TO M-640.
010360     DISPLAY D-S46.
010370     GO TO M-530.
010380 M-650.
010390     IF W-NO NOT = 20
010400         GO TO M-660.
010410     ACCEPT A-S20.
010420     IF ESTAT = BTB
010430         GO TO M-530.
010440     IF ESTAT NOT = HTB AND SKP
010450         GO TO M-650.
010460     DISPLAY D-S20.
010470     GO TO M-530.
010480 M-660.
010490     IF W-NO NOT = 22
010500         GO TO M-670.
010510     ACCEPT A-S22.
010520     IF ESTAT = BTB
010530         GO TO M-530.
010540     IF ESTAT NOT = HTB AND SKP
010550         GO TO M-660.
010560     DISPLAY D-S22.
010570     GO TO M-530.
010580 M-670.
010590     IF W-NO NOT = 34
010600         GO TO M-680.
010610     ACCEPT A-S34.
010620     IF ESTAT = BTB
010630         GO TO M-530.
010640     IF ESTAT NOT = HTB AND SKP
010650         GO TO M-670.
010660     DISPLAY D-S34.
010670     GO TO M-530.
010680 M-680.
010690     IF W-NO NOT = 52
010700         GO TO M-530.
010710     ACCEPT A-S52.
010720     IF ESTAT = BTB
010730         GO TO M-530.
010740     IF ESTAT NOT = HTB AND SKP
010750         GO TO M-680.
010760     DISPLAY D-S52.
010770     GO TO M-530.
010780 M-690.
010790     COMPUTE W-KIN = WS-12 + WS-14 + WS-46 + WS-20
010800                           + WS-22 + WS-34 + WS-52.
010810     IF W-KIN NOT = WS-6
010820         DISPLAY E-ME11 E-ME98
010830         GO TO M-530.
010840 M-700.
010850     ACCEPT A-DMM.
010860     IF ESTAT = BTB
010870         GO TO M-530.
010880     IF ESTAT NOT = HTB AND SKP
010890         GO TO M-700.
010900     IF W-DMM = 9
010910         GO TO M-530.
010920     IF W-DMM NOT = 1
010930         GO TO M-700.
010940*
010950*****IF WS-FN > 62                                                D.930910
010960*****    COMPUTE WS-SNF = WS-FN + 25                              D.930910
010970*****  ELSE                                                       D.930910
010980*****COMPUTE WS-SNF = WS-FN + 88.                                 D.970917
010990*****IF WS-MN > 62                                                D.930910
011000*****    COMPUTE WS-SNM = WS-MN + 25                              D.930910
011010*****  ELSE                                                       D.930910
011020*****COMPUTE WS-SNM = WS-MN + 88.                                 D.970917
011030     MOVE ZERO TO W-NEN.                                          I.970917
011040     MOVE WS-FN TO W-NEN2.                                        I.970917
011050     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
011060         ADD DATE-YC1 TO W-NEN                                    I.970917
011070       ELSE                                                       I.970917
011080         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
011090             ADD DATE-YC2 TO W-NEN.                               I.970917
011100     MOVE W-NEN TO WS-SNF.                                        I.970917
011110     MOVE ZERO TO W-NEN.                                          I.970917
011120     MOVE WS-MN TO W-NEN2.                                        I.970917
011130     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
011140         ADD DATE-YC1 TO W-NEN                                    I.970917
011150       ELSE                                                       I.970917
011160         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
011170             ADD DATE-YC2 TO W-NEN.                               I.970917
011180     MOVE W-NEN TO WS-SNM.                                        I.970917
011190     MOVE WS-R TO SHIT-R.
011200     REWRITE SHIT-R INVALID KEY
011210         DISPLAY E-ME78 E-STAT E-ME21 E-ME99                      C.930910
011220         GO TO M-900.
011230     GO TO M-510.
011240 M-900.
011250     CLOSE BANK-M CALNM.
011260     DISPLAY C-CLEAR.
011270     STOP RUN.
011280 S-05.
011290     MOVE SPACE TO W-KBN.
011300     IF WU-1 = 10
011310         MOVE NC"受取小切手" TO W-KBN.
011320     IF WU-1 = 11
011330         MOVE NC"受取約手　" TO W-KBN.
011340     IF WU-1 = 12
011350         MOVE NC"受取為手　" TO W-KBN.
011360     IF WU-1 = 13                                                 I.161003
011370         MOVE NC"受取電債　" TO W-KBN.                            I.161003
011380 S-10.
011390     EXIT.
011400 S-15.
011410     MOVE SPACE TO W-SKB.
011420     IF WU-2 = 32
011430         MOVE NC"割　　引" TO W-SKB.
011440     IF WU-2 = 19
011450         MOVE NC"取立入金" TO W-SKB.
011460     IF WU-2 = 20
011470         MOVE NC"担保差入" TO W-SKB.
011480     IF WU-2 = 50
011490         MOVE NC"決　　済" TO W-SKB.
011500     IF WU-2 = 60
011510         MOVE NC"不渡り　" TO W-SKB.
011520     IF WU-2 = 70                                                 I.980507
011530         MOVE NC"割手買戻" TO W-SKB.                              I.980507
011540     IF WU-2 = 90
011550         MOVE NC"取り消し" TO W-SKB.
011560 S-20.
011570     EXIT.
011580 S-25.
011590     MOVE ZERO TO CHK.
011600     IF (W-GET < 1 OR > 12) OR (W-PEY < 1 OR > 31)
011610         MOVE 5 TO CHK                                            I.970917
011620         GO TO S-35.                                              I.970917
011630*****    MOVE 5 TO CHK.                                           D.970917
011640     IF W-NEN2 >= DATE-YF1 AND <= DATE-YT1                        I.970917
011650         ADD DATE-YC1 TO W-NEN                                    I.970917
011660       ELSE                                                       I.970917
011670         IF W-NEN2 >= DATE-YF2 AND <= DATE-YT2                    I.970917
011680             ADD DATE-YC2 TO W-NEN.                               I.970917
011690     MOVE W-NGP TO CL-KEY.                                        I.910912
011700*****IF CL-NEN > 62                                               D.930910
011710*****    ADD 25 TO CL-NEN                                         D.930910
011720*****  ELSE                                                       D.930910
011730*****ADD 88 TO CL-NEN.                                            D.970917
011740     READ CALNM WITH UNLOCK INVALID KEY                           I.910912
011750         MOVE 5 TO CHK.                                           I.910912
011760 S-35.
011770     EXIT.
