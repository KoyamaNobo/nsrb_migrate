000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. FBP010.
000030*******************************************************
000040*****    中銀・商中　総合振込伝送データ　リスト   *****
000050*******************************************************
000060 AUTHOR. S-NAKAO.
000070 DATE-WRITTEN. '78-03-12.
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.                                                 I.980216
000150     SELECT S-M ASSIGN TO S-MSD                                   I.980217
000160         ORGANIZATION INDEXED                                     I.980217
000170         ACCESS MODE RANDOM                                       I.980217
000180         RECORD KEY S-KEY                                         I.980217
000190         FILE STATUS IS ERR-STAT.                                 I.980217
000200     SELECT FKSM ASSIGN TO FKS-MSD
000210         ORGANIZATION INDEXED
000220         ACCESS MODE DYNAMIC
000230         RECORD KEY FS-KEY
000240         FILE STATUS IS ERR-STAT.
000250     SELECT FBKM ASSIGN TO FBK-MSD
000260         ORGANIZATION INDEXED
000270         ACCESS MODE DYNAMIC
000280         RECORD KEY FBK-KEY
000290         FILE STATUS IS ERR-STAT.
000300     SELECT SSOUGOF ASSIGN TO SSOUGO-MSD
000310         ORGANIZATION RELATIVE
000320         FILE STATUS IS ERR-STAT.
000330     SELECT SP-F ASSIGN TO P-PRN999.
000340 I-O-CONTROL.
000350     APPLY SHARED-MODE ON M-DATE                                  I.980216
000360     APPLY SHARED-MODE ON S-M                                     I.980217
000370     APPLY SHARED-MODE ON FKSM
000380     APPLY SHARED-MODE ON FBKM
000390     APPLY SHIFT-CODE  ON SP-F.
000400 DATA DIVISION.
000410 FILE SECTION.
000420     COPY LIBFDD.                                                 I.980216
000430     COPY LISM.                                                   I.980217
000440     COPY LIFBKM.
000450     COPY LSPF.
000460 FD  FKSM
000470     BLOCK  2 RECORDS
000480     LABEL RECORD IS STANDARD
000490     VALUE OF IDENTIFICATION "FKSM".
000500 01  FKS-R.
000510     02  FS-KEY       PIC  X(004).
000520     02  FS-FKC       PIC  9(001).
000530     02  FS-D1.
000540       03  FS-FKN1    PIC  X(030).
000550       03  FS-BKC1.
000560         04  FS-BK1   PIC  9(004).
000570         04  FS-HS1   PIC  9(003).
000580       03  FS-YKS1    PIC  9(001).
000590       03  FS-KNO1    PIC  9(007).
000600       03  FS-TRC1    PIC  9(001).
000610       03  FS-KIN1    PIC  9(009).
000620     02  FS-D2.
000630       03  FS-FKN2    PIC  X(030).
000640       03  FS-BKC2.
000650         04  FS-BK2   PIC  9(004).
000660         04  FS-HS2   PIC  9(003).
000670       03  FS-YKS2    PIC  9(001).
000680       03  FS-KNO2    PIC  9(007).
000690       03  FS-TRC2    PIC  9(001).
000700       03  FS-KIN2    PIC  9(009).
000710     02  FS-BKC       PIC  9(001).                                I.970310
000720     02  FS-FGP       PIC  9(004).                                I.970310
000730     02  F            PIC  X(008).                                I.970310
000740*****02  F            PIC  X(013).                                D.970310
000750 FD  SSOUGOF
000760*****BLOCK  1 RECORDS                                             D.060619
000770     BLOCK  2 RECORDS                                             I.060619
000780     LABEL RECORD IS STANDARD
000790     VALUE OF IDENTIFICATION "SSOUGOF".
000800 01  SSOUGO-R         PIC  X(120).
000810 WORKING-STORAGE SECTION.
000820 77  ERR-STAT         PIC  X(002).
000830 01  HEAD1.
000840     02  F            PIC  X(005) VALUE ""3FE04FE080"".
000850     02  F            PIC  X(031) VALUE SPACE.
000860*****02  F            PIC  N(010) VALUE NC"＊＊＊　　中国銀行　". D.970310
000870*****02  F            PIC  N(018) VALUE                           D.970310
000880*****     NC"総合振込伝送データ　リスト　　＊＊＊".               D.970310
000890     02  F            PIC  N(005) VALUE NC"＊＊＊　　".           I.970310
000900     02  H-BKN        PIC  N(004).                                I.970310
000910     02  F            PIC  N(019) VALUE                           I.970310
000920          NC"　総合振込伝送データ　リスト　　＊＊＊".             I.970310
000930     02  F            PIC  X(024) VALUE SPACE.
000940     02  F            PIC  X(005) VALUE "DATE ".
000950     02  H-DATE       PIC 99B99B99.
000960     02  F            PIC  X(007) VALUE "     P.".
000970     02  H-PAGE       PIC Z9.
000980 01  HEAD2.
000990     02  F            PIC  N(002) VALUE NC"種別".
001000     02  F            PIC  X(009) VALUE "ｺｰﾄﾞ ｺｰﾄﾞ".
001010     02  F            PIC  N(002) VALUE NC"区分".
001020     02  F            PIC  X(001) VALUE SPACE.
001030     02  F            PIC  N(003) VALUE NC"依頼人".
001040     02  F            PIC  X(005) VALUE "ｺｰﾄﾞ ".
001050     02  F            PIC  N(007) VALUE NC"依　頼　人　名".
001060     02  F            PIC  X(026) VALUE SPACE.
001070     02  F            PIC  N(004) VALUE NC"振込月日".
001080     02  F            PIC  X(006) VALUE " ｺｰﾄﾞ ".
001090     02  F            PIC  N(005) VALUE NC"仕向銀行名".
001100     02  F            PIC  X(010) VALUE "     ｺｰﾄﾞ ".
001110     02  F            PIC  N(006) VALUE NC"仕向本支店名".
001120     02  F            PIC  X(001) VALUE SPACE.
001130     02  F            PIC  N(004) VALUE NC"預金種目".
001140     02  F            PIC  X(001) VALUE SPACE.
001150     02  F            PIC  N(004) VALUE NC"口座番号".
001160 01  HEAD3.
001170     02  F            PIC  X(005) VALUE "ｺｰﾄﾞ ".
001180     02  F            PIC  N(003) VALUE NC"銀行名".
001190     02  F            PIC  X(014) VALUE "         ｺｰﾄﾞ ".
001200     02  F            PIC  N(010) VALUE NC"本支店名　　　交換所".
001210     02  F            PIC  X(001) VALUE SPACE.
001220     02  F            PIC  N(004) VALUE NC"預金種目".
001230     02  F            PIC  X(001) VALUE SPACE.
001240     02  F            PIC  N(004) VALUE NC"口座番号".
001250     02  F            PIC  X(001) VALUE SPACE.
001260     02  F            PIC  N(005) VALUE NC"受取人氏名".
001270     02  F            PIC  X(025) VALUE SPACE.
001280     02  F            PIC  N(003) VALUE NC"金　額".
001290     02  F            PIC  X(001) VALUE SPACE.
001300     02  F            PIC  N(002) VALUE NC"新規".
001310     02  F            PIC  X(005) VALUE "ｺｰﾄﾞ ".
001320     02  F            PIC  N(002) VALUE NC"社内".
001330     02  F            PIC  X(014) VALUE "ｺｰﾄﾞ          ".
001340 01  W-P1.
001350     02  F            PIC  X(003).
001360     02  P1-FRC       PIC  9(002).
001370     02  F            PIC  X(008).
001380     02  P1-CDC       PIC  9(001).
001390     02  F            PIC  X(004).
001400     02  P1-NRC       PIC  X(010).
001410     02  F            PIC  X(001).
001420     02  P1-NRN       PIC  X(040).
001430     02  F            PIC  X(002).
001440     02  P1-FGP       PIC 99/99.
001450     02  F            PIC  X(002).
001460     02  P1-CBC       PIC  9(004).
001470     02  F            PIC  X(001).
001480     02  P1-CBN       PIC  X(015).
001490     02  F            PIC  X(001).
001500     02  P1-CSC       PIC  9(003).
001510     02  F            PIC  X(001).
001520     02  P1-CSN       PIC  X(015).
001530     02  F            PIC  X(002).
001540     02  P1-YCD       PIC  X(001).
001550     02  F            PIC  X(004).
001560     02  P1-CCN       PIC  9(007).
001570     02  F            PIC  X(001).
001580 01  W-P2.
001590     02  P2-BKC       PIC  9(004).                                銀行ｺｰﾄﾞ
001600     02  F            PIC  X(001).
001610     02  P2-BKN       PIC  X(015).                                銀行名
001620     02  F            PIC  X(001).
001630     02  P2-HSC       PIC  9(003).                                支店ｺｰﾄﾞ
001640     02  F            PIC  X(001).
001650     02  P2-HSN       PIC  X(015).                                本支店名
001660     02  F            PIC  X(001).
001670     02  P2-KBG       PIC  X(004).                                交換所NO
001680     02  F            PIC  X(005).
001690     02  P2-YKC       PIC  9(001).                                預金種目
001700     02  F            PIC  X(004).
001710     02  P2-KNO       PIC  9(007).                                口座番号
001720     02  F            PIC  X(002).
001730     02  P2-UNA       PIC  X(030).                                氏名
001740     02  P2-TP    REDEFINES P2-UNA.
001750       03  F          PIC  X(004).
001760       03  P2-TM      PIC  X(016).
001770       03  P2-KSU     PIC ZZZZZ9.
001780       03  P2-KM      PIC  N(001).
001790       03  F          PIC  X(002).
001800     02  P2-KIN       PIC ZZZ,ZZZ,ZZ9.                            振込金額
001810     02  F            PIC  X(005).
001820     02  P2-SCD       PIC  9(001).                                新規ｺｰﾄﾞ
001830     02  F            PIC  X(007).
001840     02  P2-KEY       PIC  9(004).                                社内ｺｰﾄﾞ
001850     02  F            PIC  X(011).
001860 01  W-R              PIC  X(120).                                I.980216
001870 01  W-R1.
001880     02  W1-KBN       PIC  9(001) VALUE 1.                        ﾃﾞｰﾀ区分
001890     02  W1-FRC       PIC  9(002) VALUE 21.                       種別ｺｰﾄﾞ
001900     02  W1-CDC       PIC  9(001) VALUE 1.                        ｺｰﾄﾞ区分
001910*****02  W1-NRC       PIC  X(010) VALUE "0168101146".             D.970310
001920     02  W1-NRC       PIC  X(010).                                I.970310
001930     02  W1-NRN       PIC  X(040) VALUE                           会社名
001940          "ﾆﾂｼﾝｺﾞﾑ(ｶ                               ".             会社名
001950     02  W1-FGP       PIC  9(004).
001960     02  W1-FGPD REDEFINES W1-FGP.                                振込月日
001970       03  W1-GET     PIC  9(002).
001980       03  W1-PEY     PIC  9(002).
001990*****02  W1-CBC       PIC  9(004) VALUE 0168.                     D.970310
002000*****02  W1-CBN       PIC  X(015) VALUE "ﾁﾕｳｺﾞｸ         ".        D.970310
002010*****02  W1-CSC       PIC  9(003) VALUE 101.                      D.970310
002020*****02  W1-CSN       PIC  X(015) VALUE "ﾎﾝﾃﾝ           ".        D.970310
002030     02  W1-CBC       PIC  9(004).                                I.970310
002040     02  W1-CBN       PIC  X(015).                                I.970310
002050     02  W1-CSC       PIC  9(003).                                I.970310
002060     02  W1-CSN       PIC  X(015).                                I.970310
002070     02  W1-YCD       PIC  9(001) VALUE 2.                        預金種目
002080*****02  W1-CCN       PIC  9(007) VALUE 0006265.                  D.970310
002090     02  W1-CCN       PIC  9(007).                                I.970310
002100     02  F            PIC  X(017).
002110 01  W-R2.
002120     02  W2-KBN       PIC  9(001).                                ﾃﾞｰﾀ区分
002130     02  W2-BKC       PIC  9(004).                                銀行ｺｰﾄﾞ
002140     02  W2-BKN       PIC  X(015).                                銀行名
002150     02  W2-HSC       PIC  9(003).                                支店ｺｰﾄﾞ
002160     02  W2-HSN       PIC  X(015).                                本支店名
002170     02  W2-KBG       PIC  X(004).                                交換所NO
002180     02  W2-YKC       PIC  9(001).                                預金種目
002190     02  W2-KNO       PIC  9(007).                                口座番号
002200     02  W2-UNA       PIC  X(030).                                氏名
002210     02  W2-KIN       PIC  9(010).                                振込金額
002220     02  W2-SCD       PIC  9(001).                                新規ｺｰﾄﾞ
002230     02  W2-KEY       PIC  9(004).                                社内ｺｰﾄﾞ
002240     02  F            PIC  X(025).
002250 01  W-R3.
002260     02  W3-KBN       PIC  9(001) VALUE 8.                        ﾃﾞｰﾀ区分
002270     02  W3-KSU       PIC  9(006).                                合計件数
002280     02  W3-TKIN      PIC  9(012).                                合計金額
002290     02  F            PIC  X(101).
002300 01  W-R4.
002310     02  W4-KBN       PIC  9(001) VALUE 9.                        ﾃﾞｰﾀ区分
002320     02  F            PIC  X(119).
002330 01  W-DATA.
002340     02  W-BKCD       PIC  9(001).                                I.970310
002350     02  W-BKN        PIC  N(004).                                I.970310
002360     02  W-GP.
002370       03  W-GET      PIC  9(002).
002380       03  W-PEY      PIC  9(002).
002390     02  W-DMM        PIC  9(001).
002400     02  W-PAGE       PIC  9(002).
002410     02  W-KIND       PIC S9(009).
002420     02  W-KSU        PIC  9(004).
002430     02  W-TKIN       PIC S9(009).
002440     02  CHK          PIC  9(001).
002450     02  W-EC         PIC  9(001).
002460*****02  W-DC         PIC  9(001).                                D.980216
002470     02  W-ENGD.                                                  I.980216
002480       03  W-ENEN     PIC  9(004).                                I.980216
002490       03  W-ENENL REDEFINES W-ENEN.                              I.980216
002500         04  W-ENEN1  PIC  9(002).                                I.980216
002510         04  W-ENEN2  PIC  9(002).                                I.980216
002520       03  F          PIC  9(002).                                I.980216
002530     02  W-ENGL  REDEFINES W-ENGD.                                I.980216
002540       03  F          PIC  9(002).                                I.980216
002550       03  W-ENGS     PIC  9(004).                                I.980216
002560     02  W-NGPD.                                                  I.980216
002570       03  W-NEN      PIC  9(004).                                I.980216
002580       03  W-NENL  REDEFINES W-NEN.                               I.980216
002590         04  W-NEN1   PIC  9(002).                                I.980216
002600         04  W-NEN2   PIC  9(002).                                I.980216
002610       03  W-GPD      PIC  9(004).                                I.980216
002620     02  W-NGPL  REDEFINES W-NGPD.                                I.980216
002630       03  F          PIC  9(002).                                I.980216
002640       03  W-DATE     PIC  9(006).                                I.980216
002650       03  W-NGPS  REDEFINES W-DATE.                              I.980216
002660         04  W-NG     PIC  9(004).                                I.980216
002670         04  F        PIC  9(002).                                I.980216
002680     02  W-NGP   REDEFINES W-NGPD.                                I.980216
002690       03  W-NGD      PIC  9(006).                                I.980216
002700       03  F          PIC  9(002).                                I.980216
002710     02  W-D.
002720       03  W-FKN      PIC  X(030).
002730       03  W-BKC.
002740         04  W-BK     PIC  9(004).
002750         04  W-HS     PIC  9(003).
002760       03  W-YKS      PIC  9(001).
002770       03  W-KNO      PIC  9(007).
002780       03  W-TRC      PIC  9(001).
002790       03  W-KIN      PIC  9(009).
002800     02  W-FILE       PIC  X(013).                                I.940311
002810     COPY LSTAT.
002820 SCREEN SECTION.
002830 SD  C-CRT
002840     END STATUS IS ESTAT.
002850 01  C-CLEAR.
002860     02  LINE   1  CLEAR SCREEN.
002870 01  C-MID.
002880     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
002890          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002900     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
002910          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002920     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
002930          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
002940     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
002950          NC"＊＊＊　　Ｆ・Ｂ　総合振込データ　リスト　　＊＊＊".
002960     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
002970          NC"＊＊＊　　　　　（送信データ作成）　　　　　＊＊＊".
002980     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
002990          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003000     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
003010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003020*****02  LINE  12  COLUMN  27  PIC  X(016) VALUE                  D.970310
003030*****     "振込日    月  日".                                     D.970310
003040     02  LINE  14  COLUMN  14  PIC  X(042) VALUE                  I.970310
003050          "【            】         振込日    月   日".           I.970310
003060     02  LINE  20  COLUMN  24  PIC  X(022) VALUE
003070          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003080 01  C-ACP.
003090*****02  LINE 12.                                                 D.970310
003100*****  03  A-GET   COLUMN  35  PIC  9(002)                        D.970310
003110*****       USING W-GET   CHECK OVERFLOW NO IFC.                  D.970310
003120*****  03  A-PEY   COLUMN  39  PIC  9(002)                        D.970310
003130*****       USING W-PEY   CHECK OVERFLOW NO IFC.                  D.970310
003140     02  A-DMM   LINE  20  COLUMN  41  PIC  9(001)
003150          USING W-DMM   CHECK OVERFLOW NO IFC.
003160 01  C-DSP.                                                       I.970310
003170     02  D-DT    LINE  14.                                        I.970310
003180       03  COLUMN  18  PIC  N(004) FROM  W-BKN.                   I.970310
003190       03  COLUMN  47  PIC  Z(002) FROM  W-GET.                   I.970310
003200       03  COLUMN  52  PIC  Z(002) FROM  W-PEY.                   I.970310
003210 01  C-ERR.
003220     02  LINE  24.
003230       03  E-ME1   COLUMN  15  PIC  X(021) VALUE
003240            "***  ﾌﾘｺﾐﾏｽﾀｰ ﾅｼ  ***".
003250       03  E-ME2   COLUMN  15  PIC  X(022) VALUE
003260            "***  ｷﾞﾝｺｳﾏｽﾀｰ ﾅｼ  ***".
003270       03  E-ME3   COLUMN  15  PIC  X(019) VALUE
003280            "***  WRITE ｴﾗｰ  ***".
003290       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
003300            "***  DATA ﾅｼ  ***".
003310       03  E-ME5   COLUMN  15  PIC  X(018) VALUE                  I.970310
003320            "***  DATA ｴﾗｰ  ***".                                 I.970310
003330       03  E-ME6   COLUMN  15  PIC  X(026) VALUE                  I.980216
003340            "***  FBKM REWRITE ｴﾗｰ  ***".                         I.980216
003350       03  E-ME7   COLUMN  15  PIC  X(024) VALUE                  I.980217
003360            "***  SM REWRITE ｴﾗｰ  ***".                           I.980217
003370       03  E-KEY   COLUMN  50  PIC  9(004) FROM  FS-KEY.
003380       03  E-BKC   COLUMN  55  PIC  9(007) FROM  W-BKC.
003390*****  03  E-ME71.                                                D.980217
003400*****    04  COLUMN   1  PIC  X(013) FROM  W-FILE.                D.980217
003410*****    04  COLUMN  15  PIC  N(021) VALUE                        D.980217
003420*****         NC"オーバーフロー、領域を拡張し、ＦＮＣ＋再開".     D.980217
003430*****  03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".        D.980217
003440*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.980217
003450*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.980217
003460*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.980217
003470*****  03  E-CL.                                                  D.980217
003480*****    04  COLUMN   1  PIC  X(040) VALUE                        D.980217
003490*****         "                                        ".         D.980217
003500*****    04  COLUMN  41  PIC  X(040) VALUE                        D.980217
003510*****         "                                        ".         D.980217
003520     COPY LSSEM.                                                  I.980217
003530     COPY LIBSCR.                                                 I.980216
003540 PROCEDURE DIVISION.
003550 M-05.
003560     DISPLAY C-CLEAR.
003570     DISPLAY C-MID.
003580     OPEN INPUT FKSM.                                             I.970310
003590 M-10.
003600     READ FKSM NEXT RECORD WITH UNLOCK AT END                     I.970310
003610         DISPLAY E-ME4 E-ME99                                     I.970310
003620         CLOSE FKSM                                               I.970310
003630         DISPLAY C-CLEAR                                          I.970310
003640         STOP RUN.                                                I.970310
003650     IF FS-BKC = 0                                                I.970310
003660         GO TO M-10.                                              I.970310
003670     MOVE FS-BKC TO W-BKCD.                                       I.970310
003680     MOVE FS-FGP TO W-GP.                                         I.970310
003690     MOVE SPACE TO W-BKN.                                         I.970310
003700     IF W-BKCD = 1                                                I.970310
003710         MOVE NC"中国銀行" TO W-BKN.                              I.970310
003720     IF W-BKCD = 2                                                I.970310
003730         MOVE NC"商工中金" TO W-BKN.                              I.970310
003740     CLOSE FKSM.                                                  I.970310
003750     DISPLAY D-DT.                                                I.970310
003760*****ACCEPT A-GET.                                                D.970310
003770*****IF ESTAT = PF9                                               D.970310
003780*****    DISPLAY C-CLEAR                                          D.970310
003790*****    STOP RUN.                                                D.970310
003800*****IF ESTAT NOT = HTB AND SKP                                   D.970310
003810*****    GO TO M-10.                                              D.970310
003820*****IF W-GET < 1 OR > 12                                         D.970310
003830*****    GO TO M-10.                                              D.970310
003840*M-15.                                                            D.970310
003850*****ACCEPT A-PEY.                                                D.970310
003860*****IF ESTAT = BTB                                               D.970310
003870*****    GO TO M-10.                                              D.970310
003880*****IF ESTAT NOT = HTB AND SKP                                   D.970310
003890*****    GO TO M-15.                                              D.970310
003900*****IF W-PEY < 1 OR > 31                                         D.970310
003910*****    GO TO M-15.                                              D.970310
003920 M-20.
003930     ACCEPT A-DMM.
003940*****IF ESTAT = BTB                                               D.970310
003950*****    GO TO M-15.                                              D.970310
003960     IF ESTAT = PF9                                               I.970310
003970         DISPLAY C-CLEAR                                          I.970310
003980         STOP RUN.                                                I.970310
003990     IF ESTAT NOT = HTB AND SKP
004000         GO TO M-20.
004010     IF W-DMM = 9
004020         DISPLAY C-CLEAR
004030         STOP RUN.
004040     IF W-DMM NOT = 1
004050*****    GO TO M-10.                                              D.970310
004060         GO TO M-20.                                              I.970310
004070*
004080     OPEN INPUT FKSM.
004090 M-25.
004100     READ FKSM NEXT RECORD AT END
004110         DISPLAY E-ME4 E-ME99
004120         CLOSE FKSM
004130         DISPLAY C-CLEAR
004140         STOP RUN.
004150     IF ZERO = FS-KIN1 AND FS-KIN2
004160         GO TO M-25.
004170     IF (W-BKCD NOT = FS-BKC) OR (W-GP NOT = FS-FGP)              I.970310
004180         DISPLAY E-ME5 E-ME99                                     I.970310
004190         CLOSE FKSM                                               I.970310
004200         DISPLAY C-CLEAR                                          I.970310
004210         STOP RUN.                                                I.970310
004220     MOVE W-GP TO W1-FGP.
004230     IF W-BKCD = 1                                                I.970310
004240         MOVE "0168101146" TO W1-NRC                              I.970310
004250         MOVE 0168 TO W1-CBC                                      I.970310
004260         MOVE "ﾁﾕｳｺﾞｸ         " TO W1-CBN                         I.970310
004270         MOVE 101 TO W1-CSC                                       I.970310
004280         MOVE "ﾎﾝﾃﾝ           " TO W1-CSN                         I.970310
004290         MOVE 0006265 TO W1-CCN.                                  I.970310
004300     IF W-BKCD = 2                                                I.970310
004310         MOVE "0000067420" TO W1-NRC                              I.970310
004320         MOVE 2004 TO W1-CBC                                      I.970310
004330         MOVE "ｼﾖｳﾁﾕｳ         " TO W1-CBN                         I.970310
004340         MOVE 331 TO W1-CSC                                       I.970310
004350         MOVE "ｵｶﾔﾏ           " TO W1-CSN                         I.970310
004360         MOVE 2002701 TO W1-CCN.                                  I.970310
004370*
004380*****OPEN INPUT FBKM.                                             D.980216
004390     COPY LIBCPR.                                                 I.980216
004400     MOVE ZERO TO W-NGPD.                                         I.980216
004410     ACCEPT W-DATE FROM DATE.                                     I.980216
004420     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.980216
004430         ADD DATE-NC1 TO W-NEN.                                   I.980216
004440     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.980216
004450         ADD DATE-NC2 TO W-NEN.                                   I.980216
004460     OPEN I-O FBKM.                                               I.980216
004470     OPEN I-O S-M.                                                I.980217
004480     OPEN OUTPUT SSOUGOF.
004490     OPEN OUTPUT SP-F.
004500     ACCEPT H-DATE FROM DATE.
004510     MOVE SPACE TO SP-R.
004520     MOVE 1 TO W-PAGE.
004530     MOVE W-PAGE TO H-PAGE.
004540     MOVE HEAD1 TO SP-R.
004550     WRITE SP-R.
004560     MOVE SPACE TO SP-R.
004570     MOVE HEAD2 TO SP-R.
004580     WRITE SP-R AFTER 2.
004590     MOVE SPACE TO W-P1.
004600     MOVE W1-FRC TO P1-FRC.                                       種別ｺｰﾄﾞ
004610     MOVE W1-CDC TO P1-CDC.                                       ｺｰﾄﾞ区分
004620     MOVE W1-NRC TO P1-NRC.                                       会社ｺｰﾄﾞ
004630     MOVE W1-NRN TO P1-NRN.                                       会社名
004640     MOVE W1-FGP TO P1-FGP.                                       振込月日
004650     MOVE W1-CBC TO P1-CBC.                                       中銀ｺｰﾄﾞ
004660     MOVE W1-CBN TO P1-CBN.                                       中銀名
004670     MOVE W1-CSC TO P1-CSC.                                       本店ｺｰﾄﾞ
004680     MOVE W1-CSN TO P1-CSN.                                       本店名
004690     MOVE W1-YCD TO P1-YCD.                                       預金種目
004700     MOVE W1-CCN TO P1-CCN.                                       口座番号
004710     MOVE SPACE TO SP-R.
004720     MOVE W-P1 TO SP-R.
004730     WRITE SP-R.
004740*
004750*M-26.                                                            D.980216
004760*****MOVE 0 TO W-EC W-DC.                                         D.980216
004770*****MOVE SPACE TO SSOUGO-R.                                      D.980216
004780*****MOVE W-R1 TO SSOUGO-R.                                       D.980216
004790*****WRITE SSOUGO-R INVALID KEY                                   D.980216
004800*****    DISPLAY E-STAT E-ME3 E-ME99                              D.980216
004810*****    PERFORM S-17 THRU S-18.                                  D.980216
004820*****IF W-EC = 1                                                  D.980216
004830*****    GO TO M-26.                                              D.980216
004840     MOVE SPACE TO W-R.                                           I.980216
004850     MOVE W-R1 TO W-R.                                            I.980216
004860     MOVE 0 TO W-EC.                                              I.980216
004870     PERFORM S-20 THRU S-30.                                      I.980216
004880     IF W-EC NOT = 0                                              I.940314
004890         GO TO M-95.
004900*****CALL "CBLTCLS" USING SSOUGOF.                                D.980216
004910     MOVE SPACE TO W-P1.
004920     MOVE ALL "-" TO W-P1.
004930     MOVE W-P1 TO SP-R.
004940     WRITE SP-R.
004950     MOVE SPACE TO SP-R.
004960     MOVE HEAD3 TO SP-R.
004970     WRITE SP-R AFTER 2.
004980     MOVE ZERO TO W-KSU W-TKIN.
004990 M-30.
005000     MOVE ZERO TO W-EC.
005010*****MOVE 1 TO W-DC.                                              D.980216
005020*****IF FS-KIN1 NOT = ZERO                                        D.980216
005030*****    MOVE FS-D1 TO W-D                                        D.980216
005040*****PERFORM S-05 THRU S-18.                                      D.980216
005050     IF FS-KIN1 = ZERO                                            I.980216
005060         GO TO M-35.                                              I.980216
005070     MOVE FS-D1 TO W-D.                                           I.980216
005080     PERFORM S-05 THRU S-15.                                      I.980216
005090     IF W-EC NOT = 0
005100         GO TO M-95.
005110 M-35.                                                            I.980216
005120*****IF FS-KIN2 NOT = ZERO                                        D.980216
005130*****    MOVE FS-D2 TO W-D                                        D.980216
005140*****PERFORM S-05 THRU S-18.                                      D.980216
005150     IF FS-KIN2 = ZERO                                            I.980216
005160         GO TO M-40.                                              I.980216
005170     MOVE FS-D2 TO W-D.                                           I.980216
005180     PERFORM S-05 THRU S-15.                                      I.980216
005190     IF W-EC NOT = 0
005200         GO TO M-95.
005210 M-40.
005220     READ FKSM NEXT RECORD AT END
005230         GO TO M-45.
005240     IF ZERO = FS-KIN1 AND FS-KIN2
005250         GO TO M-40.
005260     IF (W-BKCD NOT = FS-BKC) OR (W-GP NOT = FS-FGP)              I.970310
005270         DISPLAY E-ME5 E-ME99                                     I.970310
005280         GO TO M-95.                                              I.970310
005290     GO TO M-30.
005300 M-45.
005310     MOVE SPACE TO W-P2.
005320     MOVE "***  TOTAL  *** " TO P2-TM.
005330     MOVE W-KSU TO P2-KSU.
005340     MOVE NC"件" TO P2-KM.
005350     MOVE W-TKIN TO P2-KIN.
005360     IF LINAGE-COUNTER > 60
005370         ADD 1 TO W-PAGE
005380         MOVE W-PAGE TO H-PAGE
005390         MOVE SPACE TO SP-R
005400         MOVE HEAD1 TO SP-R
005410         WRITE SP-R AFTER PAGE
005420         MOVE SPACE TO SP-R
005430         MOVE HEAD3 TO SP-R
005440         WRITE SP-R AFTER 2.
005450     MOVE SPACE TO SP-R.
005460     MOVE W-P2 TO SP-R.
005470     WRITE SP-R AFTER 2.
005480     MOVE W-KSU TO W3-KSU.
005490     MOVE W-TKIN TO W3-TKIN.
005500*
005510*M-50.                                                            D.980216
005520*****MOVE 0 TO W-EC W-DC.                                         D.980216
005530*****MOVE SPACE TO SSOUGO-R.                                      D.980216
005540*****MOVE W-R3 TO SSOUGO-R.                                       D.980216
005550*****WRITE SSOUGO-R INVALID KEY                                   D.980216
005560*****    DISPLAY E-STAT E-ME3 E-ME99                              D.980216
005570*****    PERFORM S-17 THRU S-18.                                  D.980216
005580*****IF W-EC = 1                                                  D.980216
005590*****    GO TO M-50.                                              D.980216
005600     MOVE 0 TO W-EC.                                              I.980216
005610     MOVE SPACE TO W-R.                                           I.980216
005620     MOVE W-R3 TO W-R.                                            I.980216
005630     PERFORM S-20 THRU S-30.                                      I.980216
005640     IF W-EC NOT = 0                                              I.940314
005650         GO TO M-95.
005660*****CALL "CBLTCLS" USING SSOUGOF.                                D.980216
005670*M-55.                                                            D.980216
005680*****MOVE 0 TO W-EC W-DC.                                         D.980216
005690*
005700*****MOVE SPACE TO SSOUGO-R.                                      D.980216
005710*****MOVE W-R4 TO SSOUGO-R.                                       D.980216
005720*****WRITE SSOUGO-R INVALID KEY                                   D.980216
005730*****    DISPLAY E-STAT E-ME3 E-ME99                              D.980216
005740*****    PERFORM S-17 THRU S-18.                                  D.980216
005750*****IF W-EC = 1                                                  D.980216
005760*****    GO TO M-55.                                              D.980216
005770     MOVE 0 TO W-EC.                                              I.980216
005780     MOVE SPACE TO W-R.                                           I.980216
005790     MOVE W-R4 TO W-R.                                            I.980216
005800     PERFORM S-20 THRU S-30.                                      I.980216
005810     IF W-EC NOT = 0                                              I.940314
005820         GO TO M-95.                                              I.940314
005830*****CALL "CBLTCLS" USING SSOUGOF.                                D.980216
005840 M-95.
005850     CLOSE S-M.                                                   I.980217
005860     CLOSE FKSM.
005870     CLOSE FBKM.
005880     CLOSE SSOUGOF.
005890     CLOSE SP-F.
005900     DISPLAY C-CLEAR.
005910     STOP RUN.
005920 S-05.
005930     MOVE W-KIN TO W-KIND.
005940     IF W-TRC = 0
005950         GO TO S-10.
005960     IF W-BKCD = 1                                                I.970310
005970         IF W-BKC = "0168101"
005980             GO TO S-10.
005990     IF W-BKCD = 2                                                I.970310
006000         IF W-BKC = "2004331"                                     I.970310
006010             GO TO S-10.                                          I.970310
006020     IF W-BKCD = 1                                                I.970310
006030         IF W-BK = 0168
006040*****        IF W-KIN < 30103                                     D.970313
006050*****            SUBTRACT 103 FROM W-KIND                         D.970313
006060*****        IF W-KIN < 30105                                     D.140310
006070*****            SUBTRACT 105 FROM W-KIND                         D.140310
006080             IF W-KIN < 30108                                     I.140310
006090                 SUBTRACT 108 FROM W-KIND                         I.140310
006100               ELSE
006110                 SUBTRACT 324 FROM W-KIND.                        I.140310
006120*****            SUBTRACT 315 FROM W-KIND.                        D.140310
006130*****            SUBTRACT 309 FROM W-KIND.                        D.970313
006140     IF W-BKCD = 1                                                I.970310
006150         IF W-BK NOT = 0168
006160*****        IF W-KIN < 30412                                     D.970313
006170*****            SUBTRACT 412 FROM W-KIND                         D.970313
006180*****        IF W-KIN < 30420                                     D.140310
006190*****            SUBTRACT 420 FROM W-KIND                         D.140310
006200             IF W-KIN < 30432                                     I.140310
006210                 SUBTRACT 432 FROM W-KIND                         I.140310
006220               ELSE
006230                 SUBTRACT 648 FROM W-KIND.                        I.140310
006240*****            SUBTRACT 630 FROM W-KIND.                        D.140310
006250*****            SUBTRACT 618 FROM W-KIND.                        D.970313
006260     IF W-BKCD = 2                                                I.970310
006270         IF W-BK = 2004                                           I.970310
006280*****        IF W-KIN < 30103                                     D.970313
006290*****            SUBTRACT 103 FROM W-KIND                         D.970313
006300*****        IF W-KIN < 30105                                     D.140310
006310*****            SUBTRACT 105 FROM W-KIND                         D.140310
006320             IF W-KIN < 30108                                     I.140310
006330                 SUBTRACT 108 FROM W-KIND                         I.140310
006340               ELSE                                               I.970310
006350                 SUBTRACT 324 FROM W-KIND.                        I.140310
006360*****            SUBTRACT 315 FROM W-KIND.                        D.140310
006370*****            SUBTRACT 309 FROM W-KIND.                        D.970313
006380     IF W-BKCD = 2                                                I.970310
006390         IF W-BK NOT = 2004                                       I.970310
006400*****        IF W-KIN < 10309                                     D.970313
006410*****            SUBTRACT 309 FROM W-KIND                         D.970313
006420*****        IF W-KIN < 10315                                     D.010208
006430*****            SUBTRACT 315 FROM W-KIND                         D.010208
006440*****          ELSE                                               D.010208
006450*****            IF W-KIN < 30412                                 D.970313
006460*****                SUBTRACT 412 FROM W-KIND                     D.970313
006470*****        IF W-KIN < 30420                                     D.140310
006480*****            SUBTRACT 420 FROM W-KIND                         D.140310
006490             IF W-KIN < 30432                                     I.140310
006500                 SUBTRACT 432 FROM W-KIND                         I.140310
006510               ELSE                                               I.970310
006520                 SUBTRACT 648 FROM W-KIND.                        I.140310
006530*****            SUBTRACT 630 FROM W-KIND.                        D.140310
006540*****                SUBTRACT 618 FROM W-KIND.                    D.970313
006550 S-10.
006560     MOVE W-BKC TO FBK-KEY.
006570     READ FBKM INVALID KEY
006580         DISPLAY E-ME2 E-KEY E-BKC E-ME99
006590         MOVE 5 TO W-EC
006600         GO TO S-15.                                              I.980216
006610*****    GO TO S-18.                                              D.980216
006620     INITIALIZE W-R2.
006630     MOVE 2 TO W2-KBN.
006640     MOVE FBK-BKC TO W2-BKC.
006650     MOVE FBK-BKN TO W2-BKN.
006660     MOVE FBK-HSC TO W2-HSC.
006670     MOVE FBK-HSN TO W2-HSN.
006680     MOVE W-YKS TO W2-YKC.
006690     MOVE W-KNO TO W2-KNO.
006700     MOVE W-FKN TO W2-UNA.
006710     MOVE W-KIND TO W2-KIN.
006720     MOVE FS-KEY TO W2-KEY.
006730*
006740     MOVE SPACE TO W-P2.
006750     MOVE W2-BKC TO P2-BKC.
006760     MOVE W2-BKN TO P2-BKN.
006770     MOVE W2-HSC TO P2-HSC.
006780     MOVE W2-HSN TO P2-HSN.
006790     MOVE W2-KBG TO P2-KBG.
006800     MOVE W2-YKC TO P2-YKC.
006810     MOVE W2-KNO TO P2-KNO.
006820     MOVE W2-UNA TO P2-UNA.
006830     MOVE W2-KIN TO P2-KIN.
006840     MOVE W2-SCD TO P2-SCD.
006850     MOVE W2-KEY TO P2-KEY.
006860     IF LINAGE-COUNTER > 60
006870         ADD 1 TO W-PAGE
006880         MOVE W-PAGE TO H-PAGE
006890         MOVE SPACE TO SP-R
006900         MOVE HEAD1 TO SP-R
006910         WRITE SP-R AFTER PAGE
006920         MOVE SPACE TO SP-R
006930         MOVE HEAD3 TO SP-R
006940         WRITE SP-R AFTER 2.
006950     MOVE SPACE TO SP-R.
006960     MOVE W-P2 TO SP-R.
006970     WRITE SP-R.
006980     ADD 1 TO W-KSU.
006990     ADD W2-KIN TO W-TKIN.
007000     MOVE SPACE TO W-R.                                           I.980216
007010     MOVE W-R2 TO W-R.                                            I.980216
007020     PERFORM S-20 THRU S-30.                                      I.980216
007030     IF W-EC = 0                                                  I.980216
007040         PERFORM S-35 THRU S-55.                                  I.980217
007050*****    PERFORM S-35 THRU S-45.                                  D.980217
007060 S-15.                                                            I.940314
007070*****MOVE SPACE TO SSOUGO-R.                                      D.980216
007080*****MOVE W-R2 TO SSOUGO-R.                                       D.980216
007090*****WRITE SSOUGO-R INVALID KEY                                   D.980216
007100*****    DISPLAY E-STAT E-ME3 E-ME99                              D.980216
007110*****    GO TO S-17.                                              D.980216
007120*****    MOVE 5 TO W-EC.                                          D.940314
007130*****CALL "CBLTCLS" USING SSOUGOF.                                D.980216
007140*****MOVE 0 TO W-EC.                                              D.980216
007150*S-16.                                                            D.940314
007160*S-17.                                                            D.980216
007170*****IF ERR-STAT NOT = "24"                                       D.980216
007180*****    MOVE 9 TO W-EC                                           D.980216
007190*****    DISPLAY E-ME78 E-ME99                                    D.980216
007200*****    GO TO S-18.                                              D.980216
007210*****MOVE 1 TO W-EC.                                              D.980216
007220*****DISPLAY E-CL.                                                D.980216
007230*****CLOSE SSOUGOF.                                               D.980216
007240*****MOVE "SSOUGOF      " TO W-FILE.                              D.980216
007250*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.980216
007260*****DISPLAY E-CL.                                                D.980216
007270*****OPEN EXTEND SSOUGOF.                                         D.980216
007280*****IF W-DC NOT = 0                                              D.980216
007290*****    GO TO S-15.                                              D.980216
007300*S-18.                                                            D.980216
007310     EXIT.
007320 S-20.                                                            I.980216
007330     MOVE SPACE TO SSOUGO-R.                                      I.980216
007340     MOVE W-R TO SSOUGO-R.                                        I.980216
007350     WRITE SSOUGO-R INVALID KEY                                   I.980216
007360         DISPLAY E-STAT E-ME3 E-ME99                              I.980216
007370         GO TO S-25.                                              I.980216
007380     CALL "CBLTCLS" USING SSOUGOF.                                I.980216
007390     MOVE 0 TO W-EC.                                              I.980216
007400     GO TO S-30.                                                  I.980216
007410 S-25.                                                            I.980216
007420     IF ERR-STAT NOT = "24"                                       I.980216
007430         MOVE 9 TO W-EC                                           I.980216
007440         DISPLAY E-ME78 E-ME99                                    I.980216
007450         GO TO S-30.                                              I.980216
007460     MOVE 1 TO W-EC.                                              I.980216
007470     DISPLAY E-CL.                                                I.980216
007480     CLOSE SSOUGOF.                                               I.980216
007490     MOVE "SSOUGOF      " TO W-FILE.                              I.980216
007500     DISPLAY E-ME71 E-ME98 STOP " ".                              I.980216
007510     DISPLAY E-CL.                                                I.980216
007520     OPEN EXTEND SSOUGOF.                                         I.980216
007530     GO TO S-20.                                                  I.980216
007540 S-30.                                                            I.980216
007550     EXIT.                                                        I.980216
007560 S-35.                                                            I.980216
007570     IF FBK-ENG = ZERO                                            I.980216
007580         GO TO S-40.                                              I.980216
007590     MOVE ZERO TO W-ENGD.                                         I.980216
007600     MOVE FBK-ENG TO W-ENGS.                                      I.980216
007610     IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980216
007620         ADD DATE-NC1 TO W-ENEN.                                  I.980216
007630     IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980216
007640         ADD DATE-NC2 TO W-ENEN.                                  I.980216
007650     IF W-ENGD >= W-NGD                                           I.980216
007660         GO TO S-45.                                              I.940314
007670 S-40.                                                            I.980216
007680     MOVE W-NG TO FBK-ENG.                                        I.980216
007690     REWRITE FBK-R INVALID KEY                                    I.980216
007700         DISPLAY E-ME6 E-ME99                                     I.980216
007710         DISPLAY E-CL.                                            I.980216
007720 S-45.                                                            I.980216
007730     MOVE FS-KEY TO S-KEY.                                        I.980217
007740     READ S-M INVALID KEY                                         I.980217
007750         GO TO S-55.                                              I.980217
007760     IF S-ENG = ZERO                                              I.980217
007770         GO TO S-50.                                              I.980217
007780     MOVE ZERO TO W-ENGD.                                         I.980217
007790     MOVE S-ENG TO W-ENGS.                                        I.980217
007800     IF W-ENEN2 >= DATE-NF1 AND <= DATE-NT1                       I.980217
007810         ADD DATE-NC1 TO W-ENEN.                                  I.980217
007820     IF W-ENEN2 >= DATE-NF2 AND <= DATE-NT2                       I.980217
007830         ADD DATE-NC2 TO W-ENEN.                                  I.980217
007840     IF W-ENGD >= W-NGD                                           I.980217
007850         GO TO S-55.                                              I.980217
007860 S-50.                                                            I.980217
007870     MOVE W-NG TO S-ENG.                                          I.980217
007880     MOVE ZERO TO S-TNG.                                          I.040123
007890     REWRITE S-R INVALID KEY                                      I.980217
007900         DISPLAY E-ME7 E-ME99                                     I.980217
007910         DISPLAY E-CL.                                            I.980217
007920 S-55.                                                            I.980217
007930     EXIT.                                                        I.980216
