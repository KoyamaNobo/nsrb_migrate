000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMN450.
000030*********************************************************
000040*    PROGRAM         :  履物棚卸入力ワーク　作成　　　　*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT HTIW-F ASSIGN TO HTIW-MSD.
000160     SELECT HTI-M ASSIGN TO HTI-MSD
000170         ORGANIZATION IS INDEXED
000180         ACCESS MODE IS DYNAMIC
000190         RECORD KEY IS HTI-KEY
000200         FILE STATUS IS ERR-STAT.
000210 I-O-CONTROL.
000220     APPLY SHARED-MODE ON HTI-M.
000230 DATA DIVISION.
000240 FILE SECTION.
000250     COPY LIHTIM.
000260 FD  HTIW-F
000270     BLOCK  1 RECORDS
000280     LABEL RECORD IS STANDARD
000290     VALUE OF IDENTIFICATION WK0256ID.
000300 01  HTIW-R.
000310     02  F              PIC  X(007).
000320     02  HTIW-SOC       PIC  9(001).
000330     02  HTIW-HCD       PIC  9(006).
000340     02  HTIW-SIZ       PIC  9(001).
000350     02  HTIW-SUD.
000360       03  HTIW-SU      PIC S9(006)  OCCURS  10.
000370     02  HTIW-BC.
000380       03  HTIW-BC1     PIC  9(002).
000390       03  HTIW-BC2     PIC  9(002).
000400       03  HTIW-BC3     PIC  9(002).
000410     02  F              PIC  X(175).
000420 WORKING-STORAGE SECTION.
000430 77  WK0256ID           PIC  X(009) VALUE SPACE.
000440 01  STN-NO.
000450     02  STN-NO1        PIC  X(003).
000460     02  STN-NO2        PIC  X(003).
000470 01  W-FID2.
000480     02  W-FID21        PIC  X(006) VALUE "WK0256".
000490     02  W-FID22        PIC  X(003).
000500 01  ERR-STAT           PIC  X(002).
000510 SCREEN SECTION.
000520 SD  C-CRT
000530     END STATUS IS ESTAT.
000540 01  C-CLEAR.
000550     02  C-CL    LINE   1  CLEAR SCREEN.
000560 01  C-MID.
000570     02  LINE   3  COLUMN  10  PIC N(022) VALUE
000580          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000590     02  LINE   4  COLUMN  10  PIC N(022) VALUE
000600          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000610     02  LINE   5  COLUMN  10  PIC N(022) VALUE
000620          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
000630     02  LINE   6  COLUMN  10  PIC N(022) VALUE
000640          NC"＊＊＊　　履物棚卸入力ワーク　作成　　＊＊＊".
000650     02  LINE   7  COLUMN  10  PIC N(022) VALUE
000660          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
000670     02  LINE   8  COLUMN  10  PIC N(022) VALUE
000680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000690     02  LINE   9  COLUMN  10  PIC N(022) VALUE
000700          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000710 01  C-ERR.
000720     02  LINE  24.
000730       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
000740            "***  DATA ｴﾗｰ  ***".
000750       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000760       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000770 PROCEDURE DIVISION.
000780 M-05.
000790     DISPLAY C-CLEAR.
000800     DISPLAY C-MID.
000810     CALL "CBLSTNNO" USING STN-NO.
000820     MOVE STN-NO2 TO W-FID22.
000830     MOVE W-FID2 TO WK0256ID.
000840     OPEN OUTPUT HTIW-F.
000850     OPEN INPUT HTI-M.
000860 M-10.
000870     READ HTI-M NEXT RECORD WITH UNLOCK AT END
000880         GO TO M-95.
000890     MOVE ZERO TO HTIW-R.
000900     MOVE HTI-SNO TO HTIW-SOC.
000910     MOVE HTI-HCD TO HTIW-HCD.
000920     MOVE HTI-SIZ TO HTIW-SIZ.
000930     IF HTI-GNO > 4
000940         MOVE HTI-SUD TO HTIW-SUD
000950       ELSE
000960         COMPUTE HTIW-SU(01) = HTI-SU(01) * HTI-ISU
000970         COMPUTE HTIW-SU(02) = HTI-SU(02) * HTI-ISU
000980         COMPUTE HTIW-SU(03) = HTI-SU(03) * HTI-ISU
000990         COMPUTE HTIW-SU(04) = HTI-SU(04) * HTI-ISU
001000         COMPUTE HTIW-SU(05) = HTI-SU(05) * HTI-ISU
001010         COMPUTE HTIW-SU(06) = HTI-SU(06) * HTI-ISU
001020         COMPUTE HTIW-SU(07) = HTI-SU(07) * HTI-ISU
001030         COMPUTE HTIW-SU(08) = HTI-SU(08) * HTI-ISU
001040         COMPUTE HTIW-SU(09) = HTI-SU(09) * HTI-ISU
001050         COMPUTE HTIW-SU(10) = HTI-SU(10) * HTI-ISU.
001060     MOVE HTI-BC TO HTIW-BC.
001070     WRITE HTIW-R.
001080     GO TO M-10.
001090 M-95.
001100     CLOSE HTIW-F.
001110     CLOSE HTI-M.
001120     DISPLAY C-CLEAR.
001130     STOP RUN.
