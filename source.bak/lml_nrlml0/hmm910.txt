000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMM910.
000030*********************************************************
000040*    PROGRAM         :  履物区分マスターメンテナンス    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ------                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT HKBM ASSIGN TO HKB-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE DYNAMIC
000190         RECORD KEY HKB-KEY
000200         FILE STATUS IS ERR-STAT.
000210     SELECT SP-F ASSIGN TO P-PRN999.
000220 I-O-CONTROL.
000230     APPLY SHARED-MODE ON M-DATE
000240     APPLY SHARED-MODE ON HKBM
000250     APPLY SHIFT-CODE  ON SP-F.
000260 DATA DIVISION.
000270 FILE SECTION.
000280     COPY LIBFDD.
000290     COPY LIHKBM.
000300     COPY LSPF.
000310 WORKING-STORAGE SECTION.
000320 01  HEAD1.
000330     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000340*****02  F              PIC  X(030) VALUE SPACE.                  D.960924
000350     02  F              PIC  X(034) VALUE SPACE.                  I.960924
000360     02  F              PIC  N(021) VALUE
000370          NC"＊＊＊　　履物区分マスター　プルーフリスト".
000380     02  F              PIC  N(005) VALUE NC"　　＊＊＊".
000390*****02  F              PIC  X(019) VALUE SPACE.                  D.960924
000400     02  F              PIC  X(023) VALUE SPACE.                  I.960924
000410     02  F              PIC  X(005) VALUE "DATE ".
000420     02  H-DATE         PIC 99B99B99.
000430     02  F              PIC  X(007) VALUE "     P.".
000440     02  H-PAGE         PIC Z9.
000450     02  F              PIC  X(001) VALUE SPACE.
000460 01  HEAD2.
000470     02  F              PIC  N(001) VALUE NC"№".
000480     02  F              PIC  X(001) VALUE SPACE.
000490     02  F              PIC  N(005) VALUE NC"区　分　名".
000500     02  F              PIC  X(007) VALUE SPACE.
000510     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".
000520     02  F              PIC  X(002) VALUE SPACE.
000530     02  F              PIC  N(005) VALUE NC"名　称　他".
000540*****02  F              PIC  X(023) VALUE SPACE.                  D.960924
000550     02  F              PIC  X(027) VALUE SPACE.                  I.960924
000560     02  F              PIC  X(002) VALUE SPACE.
000570     02  F              PIC  X(001) VALUE ":".
000580     02  F              PIC  X(002) VALUE SPACE.
000590     02  F              PIC  N(001) VALUE NC"№".
000600     02  F              PIC  X(001) VALUE SPACE.
000610     02  F              PIC  N(005) VALUE NC"区　分　名".
000620     02  F              PIC  X(007) VALUE SPACE.
000630     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".
000640     02  F              PIC  X(002) VALUE SPACE.
000650     02  F              PIC  N(005) VALUE NC"名　称　他".
000660*****02  F              PIC  X(023) VALUE SPACE.                  D.960924
000670     02  F              PIC  X(027) VALUE SPACE.                  I.960924
000680     02  F              PIC  X(001) VALUE SPACE.
000690 01  W-P.
000700     02  W-PD    OCCURS  59.
000710       03  P-NO1        PIC  9(002).
000720       03  F            PIC  X(001).
000730       03  P-NON1       PIC  N(008).
000740       03  F            PIC  X(001).
000750       03  P-BC1        PIC  X(005).
000760       03  F            PIC  X(001).
000770*****  03  P-MS1        PIC  N(017).                              D.960924
000780       03  P-MS1        PIC  N(019).                              I.960924
000790       03  P-FKD1  REDEFINES P-MS1.
000800         04  P-FKNA1    PIC  N(004).
000810         04  F          PIC  X(003).
000820         04  P-SU1      PIC ZZ,ZZ9.
000830*****    04  F          PIC  X(017).                              D.960924
000840*****    04  F          PIC  X(021).                              D.970108
000850         04  F          PIC  X(005).                              I.970108
000860         04  P-KTKCD1   PIC  9(001).                              I.970108
000870         04  F          PIC  X(015).                              I.970108
000880       03  P-BRD1  REDEFINES P-MS1.
000890         04  P-BRN1     PIC  N(008).                              I.030514
000900         04  F          PIC  X(022).                              I.030514
000910*****    04  P-BRF1     PIC  N(008).                              D.030514
000920*****    04  F          PIC  X(001).                              D.030514
000930*****    04  P-BRR1     PIC  N(008).                              D.030514
000940*****    04  F          PIC  X(001).                              D.030514
000950*****    04  P-BRS1     PIC  N(002).                              D.030414
000960*****  03  P-KND1  REDEFINES P-MS1.                               D.000524
000970*****    04  P-KNKH1    PIC  ZZ,ZZ9.                              D.000524
000980*****    04  F          PIC  X(028).                              D.960924
000990*****    04  F          PIC  X(032).                              D.000524
001000       03  P-KHR1  REDEFINES P-MS1.
001010         04  P-CKR1     PIC  9.999.
001020         04  F          PIC  X(003).
001030         04  P-KKR1     PIC  9.999.
001040*****    04  F          PIC  X(021).                              D.960924
001050         04  F          PIC  X(025).                              I.960924
001060       03  F            PIC  X(001).
001070       03  P-X          PIC  X(001).
001080       03  F            PIC  X(002).
001090       03  P-NO2        PIC  9(002).
001100       03  F            PIC  X(001).
001110       03  P-NON2       PIC  N(008).
001120       03  F            PIC  X(001).
001130       03  P-BC2        PIC  X(005).
001140       03  F            PIC  X(001).
001150*****  03  P-MS2        PIC  N(017).                              D.960924
001160       03  P-MS2        PIC  N(019).                              I.960924
001170       03  P-FKD2  REDEFINES P-MS2.
001180         04  P-FKNA2    PIC  N(004).
001190         04  F          PIC  X(003).
001200         04  P-SU2      PIC ZZ,ZZ9.
001210*****    04  F          PIC  X(017).                              D.960924
001220*****    04  F          PIC  X(021).                              D.970108
001230         04  F          PIC  X(005).                              I.970108
001240         04  P-KTKCD2   PIC  9(001).                              I.970108
001250         04  F          PIC  X(015).                              I.970108
001260       03  P-BRD2  REDEFINES P-MS2.
001270         04  P-BRN2     PIC  N(008).                              I.030514
001280         04  F          PIC  X(022).                              I.030514
001290*****    04  P-BRF2     PIC  N(008).                              D.030514
001300*****    04  F          PIC  X(001).                              D.030514
001310*****    04  P-BRR2     PIC  N(008).                              D.030514
001320*****    04  F          PIC  X(001).                              D.030514
001330*****    04  P-BRS2     PIC  N(002).                              D.030514
001340*****  03  P-KND2  REDEFINES P-MS2.                               D.000524
001350*****    04  P-KNKH2    PIC  ZZ,ZZ9.                              D.000524
001360*****    04  F          PIC  X(028).                              D.960924
001370*****    04  F          PIC  X(032).                              D.000524
001380*****  03  P-KHR2  REDEFINES P-MS2.                               D.141111
001390*****    04  P-CKR2     PIC  9.999.                               D.141111
001400*****    04  F          PIC  X(003).                              D.141111
001410*****    04  P-KKR2     PIC  9.999.                               D.141111
001420*****    04  F          PIC  X(021).                              D.960924
001430*****    04  F          PIC  X(025).                              D.141111
001440       03  F            PIC  X(001).
001450 01  W-R.
001460     02  W-KEY.                                                       ｺｰﾄﾞ
001470       03  W-NO         PIC  9(002).                                №
001480       03  W-BC         PIC  X(005).
001490       03  W-BC01  REDEFINES W-BC.
001500         04  W-TDFK     PIC  9(002).                              都道府県
001510         04  F          PIC  X(003).
001520       03  W-BC02  REDEFINES W-BC.
001530         04  W-BM       PIC  9(001).                              部門
001540         04  F          PIC  X(004).
001550*****  03  W-BC03  REDEFINES W-BC.                                D.050303
001560*****    04  W-TKC      PIC  9(002).                              D.050303
001570*****    04  F          PIC  X(003).                              D.050303
001580       03  W-BC04  REDEFINES W-BC.
001590         04  W-TNC      PIC  9(002).                              担当
001600         04  F          PIC  X(003).
001610       03  W-BC08  REDEFINES W-BC.
001620         04  W-KTKC     PIC  9(001).                              教育地区
001630         04  F          PIC  X(004).
001640       03  W-BC11  REDEFINES W-BC.
001650         04  W-BR1      PIC  9(002).                              分類１
001660         04  F          PIC  X(003).
001670*****  03  W-BC12  REDEFINES W-BC.                                D.030514
001680*****    04  W-BR21     PIC  9(001).                              D.030514
001690*****    04  F          PIC  X(004).                              D.030514
001700       03  W-BC13  REDEFINES W-BC.
001710         04  W-BR22     PIC  9(001).                              分類２
001720         04  F          PIC  X(004).
001730       03  W-BC14  REDEFINES W-BC.                                I.980403
001740         04  W-BR3      PIC  9(002).                              I.980403
001750         04  F          PIC  X(003).                              I.980403
001760       03  W-BC16  REDEFINES W-BC.                                I.020507
001770         04  W-BMC      PIC  9(002).                              I.020507
001780         04  F          PIC  X(003).                              I.020507
001790*****  03  W-BC18  REDEFINES W-BC.                                D.000524
001800*****    04  W-KNC      PIC  9(001).                              D.000524
001810*****    04  F          PIC  X(004).                              D.000524
001820*****  03  W-BC19  REDEFINES W-BC.                                D.141111
001830*****    04  W-KHR      PIC  X(005).                              D.141111
001840       03  W-BC31  REDEFINES W-BC.
001850         04  W-NKC1     PIC  9(001).                              入金
001860         04  F          PIC  X(004).
001870       03  W-BC32  REDEFINES W-BC.                                I.991213
001880         04  W-NSC      PIC  9(001).                              I.991213
001890         04  F          PIC  X(004).                              I.991213
001900       03  W-BC41  REDEFINES W-BC.
001910         04  W-SUC      PIC  9(001).                              仕上受入
001920         04  F          PIC  X(004).
001930       03  W-BC42  REDEFINES W-BC.
001940         04  W-SSC      PIC  9(001).                              生産
001950         04  F          PIC  X(004).
001960*    * * *   N A M E  ｺ ｳ ﾓ ｸ   * * *
001970     02  W-NAME         PIC  X(057).
001980     02  W-NA01  REDEFINES W-NAME.
001990       03  W-FKNA       PIC  N(004).                              府県名
002000       03  W-SU         PIC  9(005).                              人口
002010       03  W-KIN        PIC S9(010).                              売上金額
002020*****  03  F            PIC  X(034).                              D.970108
002030       03  W-KTKCD      PIC  9(001).                              I.970108
002040       03  F            PIC  X(033).                              I.970108
002050     02  W-NA02  REDEFINES W-NAME.
002060       03  W-BMNA       PIC  N(006).                              部門名
002070       03  F            PIC  X(045).
002080*****02  W-NA03  REDEFINES W-NAME.                                D.050303
002090*****  03  W-TKNA       PIC  N(012).                              D.050303
002100*****  03  F            PIC  X(033).                              D.050303
002110     02  W-NA04  REDEFINES W-NAME.
002120       03  W-TNNA       PIC  N(014).                              担当名
002130       03  F            PIC  X(029).
002140     02  W-NA08  REDEFINES W-NAME.
002150       03  W-KTNA       PIC  N(003).                              教育地区
002160       03  F            PIC  X(051).
002170     02  W-NA11  REDEFINES W-NAME.
002180       03  W-BRN1       PIC  N(008).                              分類名１
002190       03  F            PIC  X(041).
002200*****02  W-NA12  REDEFINES W-NAME.                                D.030514
002210*****  03  W-BRN21F     PIC  N(008).                              D.030514
002220*****  03  W-BRN21R     PIC  N(008).                              D.030514
002230*****  03  W-BRN21S     PIC  N(002).                              D.030514
002240*****  03  F            PIC  X(021).                              D.030514
002250     02  W-NA13  REDEFINES W-NAME.
002260       03  W-BRN22      PIC  N(003).                              分類名２
002270       03  F            PIC  X(051).
002280     02  W-NA14  REDEFINES W-NAME.                                I.980403
002290       03  W-BRN3       PIC  N(003).                              I.980403
002300       03  F            PIC  X(051).                              I.980403
002310     02  W-NA16  REDEFINES W-NAME.                                I.020507
002320       03  W-BMN        PIC  N(003).                              I.020507
002330       03  F            PIC  X(051).                              I.020507
002340*****02  W-NA18  REDEFINES W-NAME.                                D.000524
002350*****  03  W-KNKH       PIC  9(004).                              D.000524
002360*****  03  F            PIC  X(053).                              D.000524
002370*****02  W-NA19  REDEFINES W-NAME.                                D.141111
002380*****  03  W-CKR        PIC  9(001)V9(003).                       D.141111
002390*****  03  W-KKR        PIC  9(001)V9(003).                       D.141111
002400*****  03  F            PIC  X(049).                              D.141111
002410     02  W-NA31  REDEFINES W-NAME.
002420       03  W-NKNA       PIC  N(006).                              入金名
002430       03  F            PIC  X(045).
002440     02  W-NA32  REDEFINES W-NAME.                                I.991213
002450       03  W-NSNA       PIC  N(006).                              I.991213
002460       03  F            PIC  X(045).                              I.991213
002470     02  W-NA41  REDEFINES W-NAME.
002480       03  W-SUNA       PIC  N(005).                              仕上受入
002490       03  F            PIC  X(047).
002500     02  W-NA42  REDEFINES W-NAME.
002510       03  W-SSNA       PIC  N(004).                              生産
002520       03  F            PIC  X(049).
002530     02  W-NA90  REDEFINES W-NAME.                                I.050303
002540       03  W-ASCD.                                                I.050303
002550         04  W-SCD   OCCURS  15.                                  I.050303
002560           05  W-SC     PIC  9(001).                              I.050303
002570       03  F            PIC  X(042).                              I.050303
002580 01  W-DATA.
002590     02  W-D.
002600       03  W-NOD        PIC  9(002).
002610       03  W-NON        PIC  N(008).
002620       03  W-ACT        PIC  9(001).
002630       03  W-BKC        PIC  X(005).
002640       03  W-DMM        PIC  9(001).
002650       03  CHK          PIC  9(001).
002660       03  W-PC         PIC  9(001).
002670       03  W-LIN        PIC  9(002).
002680       03  W-PAGE       PIC  9(002).
002690       03  W-BS         PIC  9(001).
002700       03  W-INV        PIC  9(001).
002710     02  W-ANO.
002720       03  W-NO01       PIC  N(008) VALUE NC"都　道　府　県　".
002730       03  W-NO02       PIC  N(008) VALUE NC"部　　　　門　　".
002740*****  03  W-NO03       PIC  N(008) VALUE NC"地　　　　区　　".   D.050303
002750       03  W-NO04       PIC  N(008) VALUE NC"担　　　　当　　".
002760       03  W-NO08       PIC  N(008) VALUE NC"教　育　地　区　".
002770       03  W-NO11       PIC  N(008) VALUE NC"分　類　①　　　".
002780*****  03  W-NO12       PIC  N(008) VALUE NC"分　類　②－１　".   D.030514
002790*****  03  W-NO13       PIC  N(008) VALUE NC"分　類　②－２　".   D.030514
002800       03  W-NO13       PIC  N(008) VALUE NC"分　類　②　　　".   I.030514
002810       03  W-NO14       PIC  N(008) VALUE NC"分　類　③　　　".   I.980403
002820       03  W-NO16       PIC  N(008) VALUE NC"部　門　管　理　".   I.020507
002830*****  03  W-NO12       PIC  N(008) VALUE NC"分　類　②③－１".   D.980403
002840*****  03  W-NO13       PIC  N(008) VALUE NC"分　類　②③－２".   D.980403
002850*****  03  W-NO18       PIC  N(008) VALUE NC"間　　接　　費　".   D.000524
002860*****  03  W-NO19       PIC  N(008) VALUE NC"経　　費　　率　".   D.141111
002870       03  W-NO31       PIC  N(008) VALUE NC"入　　　　金　　".
002880       03  W-NO32       PIC  N(008) VALUE NC"入金その他相殺　".   I.991213
002890       03  W-NO41       PIC  N(008) VALUE NC"仕上・受入入力　".
002900       03  W-NO42       PIC  N(008) VALUE NC"生　　　　産　　".
002910       03  W-NO70       PIC  N(008) VALUE NC"作　　　　表　　".
002920       03  W-NO80       PIC  N(008) VALUE NC"システム使用区分".   I.050303
002930       03  W-NO99       PIC  N(008) VALUE NC"終　　　　了　　".
002940*****02  W-MID          PIC  X(033).                              I.960924
002950     02  W-MID          PIC  X(040).                              I.960924
002960     02  W-MID1  REDEFINES W-MID.
002970       03  W-MID11      PIC  N(005).
002980       03  F            PIC  X(001).
002990       03  W-MID12      PIC  N(010).
003000*****  03  F            PIC  X(002).                              D.960914
003010       03  F            PIC  X(009).                              I.960914
003020     02  W-MID2  REDEFINES W-MID.
003030       03  W-MID21      PIC  N(015).
003040*****  03  F            PIC  X(003).                              D.960924
003050       03  F            PIC  X(010).                              I.960924
003060     02  W-MID3  REDEFINES W-MID.
003070       03  W-MID31      PIC  N(008).
003080       03  F            PIC  X(001).
003090       03  W-MID32      PIC  N(008).
003100       03  F            PIC  X(001).                              I.960924
003110       03  W-MID33      PIC  N(003).                              I.960924
003120     02  W-ALC.                                                   I.050303
003130       03  F            PIC  X(032) VALUE                         I.050303
003140            "06340734083409341034113412341334".                   I.050303
003150       03  F            PIC  X(028) VALUE                         I.050303
003160            "0654075408540954105411541254".                       I.050303
003170     02  W-ALCD  REDEFINES W-ALC.                                 I.050303
003180       03  W-CLC        PIC  9(004) OCCURS  15.                   I.050303
003190     02  W-LC.                                                    I.050303
003200       03  W-L          PIC  9(002).                              I.050303
003210       03  W-C          PIC  9(002).                              I.050303
003220     02  CNT            PIC  9(002).                              I.050303
003230     02  W-LCD.
003240       03  W-LD         PIC  9(002).
003250       03  W-CD         PIC  9(001).
003260     02  W-POC          PIC  9(001).
003270     02  W-FILE         PIC  X(013).
003280 01  ERR-STAT           PIC  X(002).
003290     COPY LSTAT.
003300 SCREEN SECTION.
003310 SD  C-CRT
003320     END STATUS IS ESTAT.
003330 01  C-CLEAR.
003340     02  C-CL    LINE   1  CLEAR SCREEN.
003350 01  C-MID.
003360     02  LINE   1  COLUMN  14  PIC  N(025) VALUE
003370          NC"＊＊＊　　履物区分マスター　メンテナンス　　＊＊＊".
003380 01  C-MID0.
003390     02  LINE   4.
003400       03  COLUMN  15  PIC  N(008) FROM  W-NO01.
003410       03  COLUMN  31  PIC  X(005) VALUE " = 01".
003420       03  COLUMN  42  PIC  N(008) FROM  W-NO70.
003430       03  COLUMN  58  PIC  X(005) VALUE " = 70".
003440     02  LINE   5.
003450       03  COLUMN  15  PIC  N(008) FROM  W-NO02.
003460       03  COLUMN  31  PIC  X(005) VALUE " = 02".
003470       03  COLUMN  42  PIC  N(008) FROM  W-NO80.                  I.050303
003480       03  COLUMN  58  PIC  X(005) VALUE " = 80".                 I.050303
003490*****  03  COLUMN  42  PIC  N(008) FROM  W-NO99.                  D.050303
003500*****  03  COLUMN  58  PIC  X(005) VALUE " = 99".                 D.050303
003510     02  LINE   6.
003520*****  03  COLUMN  15  PIC  N(008) FROM  W-NO03.                  D.050303
003530*****  03  COLUMN  31  PIC  X(005) VALUE " = 03".                 D.050303
003540       03  COLUMN  42  PIC  N(008) FROM  W-NO99.                  I.050303
003550       03  COLUMN  58  PIC  X(005) VALUE " = 99".                 I.050303
003560     02  LINE   7.
003570       03  COLUMN  15  PIC  N(008) FROM  W-NO04.
003580       03  COLUMN  31  PIC  X(005) VALUE " = 04".
003590     02  LINE   8.
003600       03  COLUMN  15  PIC  N(008) FROM  W-NO08.
003610       03  COLUMN  31  PIC  X(005) VALUE " = 08".
003620     02  LINE   9.
003630       03  COLUMN  15  PIC  N(008) FROM  W-NO11.
003640       03  COLUMN  31  PIC  X(005) VALUE " = 11".
003650*****02  LINE  10.                                                D.030514
003660*****  03  COLUMN  15  PIC  N(008) FROM  W-NO12.                  D.030514
003670*****  03  COLUMN  31  PIC  X(005) VALUE " = 12".                 D.030514
003680     02  LINE  11.
003690       03  COLUMN  15  PIC  N(008) FROM  W-NO13.
003700       03  COLUMN  31  PIC  X(005) VALUE " = 13".
003710     02  LINE  12.
003720       03  COLUMN  15  PIC  N(008) FROM  W-NO14.                  I.980403
003730       03  COLUMN  31  PIC  X(005) VALUE " = 14".                 I.980403
003740     02  LINE  13.                                                I.020507
003750       03  COLUMN  15  PIC  N(008) FROM  W-NO16.                  I.020507
003760       03  COLUMN  31  PIC  X(005) VALUE " = 16".                 I.020507
003770*****02  LINE  13.                                                D.000524
003780*****  03  COLUMN  15  PIC  N(008) FROM  W-NO18.                  D.000524
003790*****  03  COLUMN  31  PIC  X(005) VALUE " = 18".                 D.000524
003800*****02  LINE  13.                                                D.980403
003810*****02  LINE  14.                                                D.141111
003820*****  03  COLUMN  15  PIC  N(008) FROM  W-NO19.                  D.141111
003830*****  03  COLUMN  31  PIC  X(005) VALUE " = 19".                 D.141111
003840*****02  LINE  14.                                                D.980403
003850     02  LINE  15.                                                I.980403
003860       03  COLUMN  15  PIC  N(008) FROM  W-NO31.
003870       03  COLUMN  31  PIC  X(005) VALUE " = 31".
003880     02  LINE  16.                                                I.991213
003890       03  COLUMN  15  PIC  N(008) FROM  W-NO32.                  I.991213
003900       03  COLUMN  31  PIC  X(005) VALUE " = 32".                 I.991213
003910*****02  LINE  15.                                                D.980403
003920*****02  LINE  16.                                                D.991213
003930     02  LINE  17.                                                I.991213
003940       03  COLUMN  15  PIC  N(008) FROM  W-NO41.
003950       03  COLUMN  31  PIC  X(005) VALUE " = 41".
003960*****02  LINE  16.                                                D.980403
003970*****02  LINE  17.                                                D.991213
003980     02  LINE  18.                                                I.991213
003990       03  COLUMN  15  PIC  N(008) FROM  W-NO42.
004000       03  COLUMN  31  PIC  X(005) VALUE " = 42".
004010     02  LINE  19  COLUMN  58  PIC  N(001) VALUE NC"№".
004020     02  LINE  22  COLUMN  28  PIC  X(022) VALUE
004030          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
004040 01  C-MID1.
004050*****02  LINE   4  COLUMN  18  PIC  X(033) VALUE                  D.960924
004060     02  LINE   4  COLUMN  14  PIC  X(033) VALUE                  I.960924
004070          "ACT : 登録=1 修正=2 削除=3 終了=9".
004080     02  LINE   6.
004090*****  03  COLUMN  15  PIC  X(018) VALUE "ACT ｺｰﾄﾞ".              D.960924
004100*****  03  COLUMN  25  PIC  X(033) FROM  W-MID.                   D.960924
004110*****  03  COLUMN  59  PIC  N(002) VALUE NC"確認".                D.960924
004120*****02  LINE  22  COLUMN  46  PIC  X(016) VALUE                  D.960924
004130       03  COLUMN  11  PIC  X(018) VALUE "ACT ｺｰﾄﾞ".              I.960924
004140       03  COLUMN  21  PIC  X(040) FROM  W-MID.                   I.960924
004150       03  COLUMN  62  PIC  N(002) VALUE NC"確認".                I.960924
004160     02  LINE  22  COLUMN  49  PIC  X(016) VALUE                  I.960924
004170          "確認 : OK=1 NO=9".
004180 01  C-MID80.                                                     I.050303
004190     02  LINE  06  COLUMN  19  PIC  X(036) VALUE                  I.050303
004200          "売上値引入力        － － － －     ".                 I.050303
004210     02  LINE   7  COLUMN  19  PIC  X(036) VALUE                  I.050303
004220          "売上値引伝票        日 計 更 新     ".                 I.050303
004230     02  LINE   8  COLUMN  19  PIC  X(036) VALUE                  I.050303
004240          "仕上受入入力        － － － －     ".                 I.050303
004250     02  LINE   9  COLUMN  19  PIC  X(036) VALUE                  I.050303
004260          "仕上受入変換        請   求   書    ".                 I.050303
004270     02  LINE  10  COLUMN  19  PIC  X(036) VALUE                  I.050303
004280          "入 金 変 換         － － － －     ".                 I.050303
004290     02  LINE  11  COLUMN  19  PIC  X(036) VALUE                  I.050303
004300          "入 金 入 力         月末一括振替    ".                 I.050303
004310     02  LINE  12  COLUMN  19  PIC  X(036) VALUE                  I.050303
004320          "入 金 伝 票         月 次 更 新     ".                 I.050303
004330     02  LINE  13  COLUMN  19  PIC  X(036) VALUE                  I.050303
004340          "－ － － －     ".                                     I.050303
004350     02  LINE  22  COLUMN  28  PIC  X(022) VALUE                  I.050303
004360          "確認  OK=1 NO=9   ﾘﾀｰﾝ".                               I.050303
004370 01  C-ACP.
004380     02  A-NO    LINE  19  COLUMN  61  PIC  9(002)
004390          USING W-NOD   CHECK OVERFLOW NO IFC.
004400*
004410     02  A-SC    LINE W-L  COLUMN W-C  PIC  9(001)                I.050303
004420          USING W-SC(CNT) CHECK OVERFLOW NO IFC.                  I.050303
004430*
004440     02  A-DMMD  LINE  22  COLUMN  45  PIC  9(001)
004450            USING W-DMM   CHECK OVERFLOW NO IFC.
004460*
004470     02  LINE W-LIN.
004480*****  03  A-ACT   COLUMN  16  PIC  9(001)                        D.960924
004490       03  A-ACT   COLUMN  12  PIC  9(001)                        I.960924
004500            USING W-ACT   CHECK OVERFLOW NO IFC.
004510*                                                                 都道府県
004520*****  03  A-TDFK  COLUMN  20  PIC  9(002)                        D.960924
004530       03  A-TDFK  COLUMN  16  PIC  9(002)                        I.960924
004540            USING W-TDFK  CHECK OVERFLOW NO IFC.
004550*****  03  A-FKNA  COLUMN  25  PIC  N(004)                        D.960924
004560       03  A-FKNA  COLUMN  21  PIC  N(004)                        I.960924
004570            USING W-FKNA  CHECK OVERFLOW NO IFC.
004580*****  03  A-SU    COLUMN  35  PIC  9(005)                        D.960924
004590       03  A-SU    COLUMN  31  PIC  9(005)                        I.960924
004600            USING W-SU    CHECK OVERFLOW NO IFC.
004610       03  A-KTKCD COLUMN  42  PIC  9(001)                        I.970108
004620            USING W-KTKCD CHECK OVERFLOW NO IFC.                  I.970108
004630*                                                                 部門
004640*****  03  A-BM    COLUMN  21  PIC  9(001)                        D.960924
004650       03  A-BM    COLUMN  17  PIC  9(001)                        I.960924
004660            USING W-BM    CHECK OVERFLOW NO IFC.
004670*****  03  A-BMNA  COLUMN  25  PIC  N(006)                        D.960924
004680       03  A-BMNA  COLUMN  21  PIC  N(006)                        I.960924
004690            USING W-BMNA  CHECK OVERFLOW NO IFC.
004700*                                                                 地区
004710*****  03  A-TKC   COLUMN  20  PIC  9(002)                        D.960924
004720*****  03  A-TKC   COLUMN  16  PIC  9(002)                        D.050303
004730*****       USING W-TKC   CHECK OVERFLOW NO IFC.                  D.050303
004740*****  03  A-TKNA  COLUMN  25  PIC  N(012)                        D.960924
004750*****  03  A-TKNA  COLUMN  21  PIC  N(012)                        D.050303
004760*****       USING W-TKNA  CHECK OVERFLOW NO IFC.                  D.050303
004770*                                                                 担当
004780*****  03  A-TNC   COLUMN  20  PIC  9(002)                        D.960924
004790       03  A-TNC   COLUMN  16  PIC  9(002)                        I.960924
004800            USING W-TNC   CHECK OVERFLOW NO IFC.
004810*****  03  A-TNNA  COLUMN  25  PIC  N(014)                        D.960924
004820       03  A-TNNA  COLUMN  21  PIC  N(014)                        I.960924
004830            USING W-TNNA  CHECK OVERFLOW NO IFC.
004840*                                                                 教育地区
004850*****  03  A-KTKC  COLUMN  21  PIC  9(001)                        D.960924
004860       03  A-KTKC  COLUMN  17  PIC  9(001)                        I.960924
004870            USING W-KTKC  CHECK OVERFLOW NO IFC.
004880*****  03  A-KTNA  COLUMN  25  PIC  N(003)                        D.960924
004890       03  A-KTNA  COLUMN  21  PIC  N(003)                        I.960924
004900            USING W-KTNA  CHECK OVERFLOW NO IFC.
004910*                                                                 分類①
004920*****  03  A-BR1   COLUMN  20  PIC  9(002)                        D.960924
004930       03  A-BR1   COLUMN  16  PIC  9(002)                        I.960924
004940            USING W-BR1   CHECK OVERFLOW NO IFC.
004950*****  03  A-BRN1  COLUMN  25  PIC  N(008)                        D.960924
004960       03  A-BRN1  COLUMN  21  PIC  N(008)                        I.960924
004970            USING W-BRN1  CHECK OVERFLOW NO IFC.
004980*                                                                 分類②-1
004990*****  03  A-BR21  COLUMN  21  PIC  9(001)                        D.960924
005000*****  03  A-BR21  COLUMN  17  PIC  9(001)                        D.030514
005010*****       USING W-BR21  CHECK OVERFLOW NO IFC.                  D.030514
005020*****  03  A-BRN21F COLUMN  25  PIC  N(008)                       D.960924
005030*****  03  A-BRN21F COLUMN  21  PIC  N(008)                       D.030514
005040*****       USING W-BRN21F CHECK OVERFLOW NO IFC.                 D.030514
005050*****  03  A-BRN21R COLUMN  42  PIC  N(008)                       D.960924
005060*****  03  A-BRN21R COLUMN  38  PIC  N(008)                       D.030514
005070*****       USING W-BRN21R CHECK OVERFLOW NO IFC.                 D.030514
005080*****  03  A-BRN21S COLUMN  56  PIC  N(002)                       D.030514
005090*****       USING W-BRN21S CHECK OVERFLOW NO IFC.                 D.030514
005100*                                                                 分類②-2
005110*****  03  A-BR22  COLUMN  21  PIC  9(001)                        D.960924
005120       03  A-BR22  COLUMN  17  PIC  9(001)                        I.960924
005130            USING W-BR22  CHECK OVERFLOW NO IFC.
005140*****  03  A-BRN22 COLUMN  25  PIC  N(003)                        D.960924
005150       03  A-BRN22 COLUMN  21  PIC  N(003)                        I.960924
005160            USING W-BRN22 CHECK OVERFLOW NO IFC.
005170*                                                                 分類③
005180       03  A-BR3   COLUMN  16  PIC  9(002)                        I.980403
005190            USING W-BR3   CHECK OVERFLOW NO IFC.                  I.980403
005200       03  A-BRN3  COLUMN  21  PIC  N(003)                        I.980403
005210            USING W-BRN3  CHECK OVERFLOW NO IFC.                  I.980403
005220*                                                                 部門管理
005230       03  A-BMC   COLUMN  16  PIC  9(002)                        I.020507
005240            USING W-BMC   CHECK OVERFLOW NO IFC.                  I.020507
005250       03  A-BMN   COLUMN  21  PIC  N(003)                        I.020507
005260            USING W-BMN   CHECK OVERFLOW NO IFC.                  I.020507
005270*                                                                 間接費
005280*****  03  A-KNC   COLUMN  21  PIC  9(001)                        D.960924
005290*****  03  A-KNC   COLUMN  17  PIC  9(001)                        D.000524
005300*****       USING W-KNC   CHECK OVERFLOW NO IFC.                  D.000524
005310*****  03  A-KNKH  COLUMN  27  PIC  9(004)                        D.960924
005320*****  03  A-KNKH  COLUMN  23  PIC  9(004)                        D.000524
005330*****       USING W-KNKH  CHECK OVERFLOW NO IFC.                  D.000524
005340*                                                                 経費
005350*****  03  A-CKR   COLUMN  28  PIC  9(001)V9(03)                  D.960924
005360*****  03  A-CKR   COLUMN  24  PIC  9(001)V9(03)                  D.141111
005370*****       USING W-CKR   CHECK OVERFLOW NO IFC.                  D.141111
005380*****  03  A-KKR   COLUMN  39  PIC  9(001)V9(03)                  D.960924
005390*****  03  A-KKR   COLUMN  35  PIC  9(001)V9(03)                  D.141111
005400*****       USING W-KKR   CHECK OVERFLOW NO IFC.                  D.141111
005410*                                                                 入金
005420*****  03  A-NKC1  COLUMN  21  PIC  9(001)                        D.960924
005430       03  A-NKC1  COLUMN  17  PIC  9(001)                        I.960924
005440            USING W-NKC1  CHECK OVERFLOW NO IFC.
005450*****  03  A-NKNA  COLUMN  25  PIC  N(006)                        D.960924
005460       03  A-NKNA  COLUMN  21  PIC  N(006)                        I.960924
005470            USING W-NKNA  CHECK OVERFLOW NO IFC.
005480*                                                                 入他相殺
005490       03  A-NSC   COLUMN  17  PIC  9(001)                        I.991213
005500            USING W-NSC   CHECK OVERFLOW NO IFC.                  I.991213
005510       03  A-NSNA  COLUMN  21  PIC  N(006)                        I.991213
005520            USING W-NSNA  CHECK OVERFLOW NO IFC.                  I.991213
005530*                                                                 仕上受入
005540*****  03  A-SUC   COLUMN  21  PIC  9(001)                        D.960924
005550       03  A-SUC   COLUMN  17  PIC  9(001)                        I.960924
005560            USING W-SUC   CHECK OVERFLOW NO IFC.
005570*****  03  A-SUNA  COLUMN  25  PIC  N(005)                        D.960924
005580       03  A-SUNA  COLUMN  21  PIC  N(005)                        I.960924
005590            USING W-SUNA  CHECK OVERFLOW NO IFC.
005600*                                                                 生産
005610*****  03  A-SSC   COLUMN  21  PIC  9(001)                        D.960924
005620       03  A-SSC   COLUMN  17  PIC  9(001)                        I.960924
005630            USING W-SSC   CHECK OVERFLOW NO IFC.
005640*****  03  A-SSNA  COLUMN  25  PIC  N(004)                        D.960924
005650       03  A-SSNA  COLUMN  21  PIC  N(004)                        I.960924
005660            USING W-SSNA  CHECK OVERFLOW NO IFC.
005670*                                                                 確認
005680*****  03  A-DMM   COLUMN  61  PIC  9(001)                        D.960924
005690       03  A-DMM   COLUMN  64  PIC  9(001)                        I.960924
005700            USING W-DMM   CHECK OVERFLOW NO IFC.
005710 01  C-DSP.
005720     02  LINE W-LIN.
005730*****  03  D-CL    COLUMN  15  PIC  X(050) VALUE                  D.960924
005740       03  D-CL.                                                  I.960924
005750         04  COLUMN   1  PIC  X(040) VALUE                        I.960924
005760              "                                        ".         I.960924
005770         04  COLUMN  41  PIC  X(040) VALUE                        I.960924
005780              "                                        ".         I.960924
005790     02  LINE W-LIN.
005800*****  03  D-SU    COLUMN  35  PIC ZZZZ9  FROM  W-SU.             D.960924
005810*****  03  D-KNKH  COLUMN  27  PIC ZZZ9   FROM  W-KNKH.           D.960924
005820*****  03  D-CKR   COLUMN  28  PIC 9.999  FROM  W-CKR.            D.960924
005830*****  03  D-KKR   COLUMN  39  PIC 9.999  FROM  W-KKR.            D.960924
005840       03  D-SU    COLUMN  31  PIC ZZZZ9  FROM  W-SU.             I.960924
005850*****  03  D-KNKH  COLUMN  23  PIC ZZZ9   FROM  W-KNKH.           D.000524
005860*****  03  D-CKR   COLUMN  24  PIC 9.999  FROM  W-CKR.            D.141111
005870*****  03  D-KKR   COLUMN  35  PIC 9.999  FROM  W-KKR.            D.141111
005880 01  C-ERR.
005890     02  LINE  24.
005900       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
005910            "***  ﾄｳﾛｸ ｽﾞﾐ  ***".
005920       03  E-ME2   COLUMN  15  PIC  X(017) VALUE
005930            "***  ﾏｽﾀｰ ﾅｼ  ***".
005940       03  E-ME3   COLUMN  15  PIC  X(015) VALUE
005950            "***  ｷｬﾝｾﾙ  ***".
005960       03  E-ME11  COLUMN  15  PIC  X(019) VALUE
005970            "***  WRITE ｴﾗｰ  ***".
005980       03  E-ME12  COLUMN  15  PIC  X(021) VALUE
005990            "***  REWRITE ｴﾗｰ  ***".
006000       03  E-ME13  COLUMN  15  PIC  X(020) VALUE
006010            "***  DELETE ｴﾗｰ  ***".
006020     COPY LSSEM.
006030     COPY LIBSCR.
006040 PROCEDURE DIVISION.
006050 M-020.
006060     COPY LIBCPR.
006070     MOVE DATE-02R TO H-DATE.
006080     OPEN I-O HKBM.
006090     MOVE ZERO TO W-D.
006100     MOVE SPACE TO W-NON.
006110 M-040.
006120     DISPLAY C-CLEAR.
006130     DISPLAY C-MID C-MID0.
006140 M-060.
006150     ACCEPT A-NO.
006160     IF ESTAT NOT = HTB AND SKP
006170         GO TO M-060.
006180*****IF W-NOD NOT = 01 AND 02 AND 03 AND 04 AND 08 AND 11 AND 12  D.030514
006190*****IF W-NOD NOT = 01 AND 02 AND 03 AND 04 AND 08 AND 11         D.050303
006200     IF W-NOD NOT = 01 AND 02 AND 04 AND 08 AND 11                I.050303
006210                       AND 13 AND 14 AND 16                       I.141111
006220*****                  AND 13 AND 14 AND 16 AND 19                D.141111
006230                       AND 31 AND 32 AND 41 AND 42                I.050303
006240                       AND 70 AND 80 AND 99                       I.050303
006250******                 AND 13 AND 14 AND 19                       D.020507
006260*****                  AND 13 AND 14 AND 18 AND 19                D.000524
006270*****                  AND 31 AND 32 AND 41 AND 42 AND 70 AND 99  D.050303
006280*****                  AND 31 AND 41 AND 42 AND 70 AND 99         D.991213
006290*****                  AND 13 AND 18 AND 19 AND 31 AND 41 AND 42  D.980403
006300*****                  AND 70 AND 99                              D.980403
006310         GO TO M-060.
006320 M-080.
006330     ACCEPT A-DMMD.
006340     IF ESTAT = BTB
006350         GO TO M-060.
006360     IF ESTAT NOT = HTB AND SKP
006370         GO TO M-080.
006380     IF W-DMM = 9
006390         GO TO M-060.
006400     IF W-DMM NOT = 1
006410         GO TO M-080.
006420     IF W-NOD = 99
006430         GO TO M-980.
006440     IF W-NOD = 80                                                I.050303
006450         GO TO M-720.                                             I.050303
006460     IF W-NOD = 70
006470         GO TO M-820.
006480*
006490     MOVE SPACE TO W-MID.
006500     IF W-NOD = 01
006510         MOVE NC"都道府県名" TO W-MID11
006520*****    MOVE NC"人口　　　　　　　　" TO W-MID12.                D.970108
006530         MOVE NC"人口　教育地区　　　" TO W-MID12.                I.970108
006540     IF W-NOD = 02
006550         MOVE NC"部門名　　　　　　　　　　　　" TO W-MID21.
006560*****IF W-NOD = 03                                                D.050303
006570*****    MOVE NC"地　区　名　　　　　　　　　　" TO W-MID21.      D.050303
006580     IF W-NOD = 04
006590         MOVE NC"担　当　者　名　　　　　　　　" TO W-MID21.
006600     IF W-NOD = 08
006610         MOVE NC"教育地区名　　　　　　　　　　" TO W-MID21.
006620     IF W-NOD = 11
006630         MOVE NC"分類名①　　　　　　　　　　　" TO W-MID21.
006640*****IF W-NOD = 12                                                D.030514
006650*****    MOVE NC"分類名②③－１前" TO W-MID31                     D.980403
006660*****    MOVE NC"後　　　　　　　" TO W-MID32.                    D.960924
006670*****    MOVE NC"分類名②－１前　" TO W-MID31                     D.030514
006680*****    MOVE NC"後　　　　　　　" TO W-MID32                     D.030514
006690*****    MOVE NC"前縮小" TO W-MID33.                              D.030514
006700     IF W-NOD = 13
006710         MOVE NC"分類名②　　　　　　　　　　　" TO W-MID21.      I.030514
006720*****    MOVE NC"分類名②－２　　　　　　　　　" TO W-MID21.      D.030514
006730*****    MOVE NC"分類名②③－２　　　　　　　　" TO W-MID21.      D.980403
006740     IF W-NOD = 14                                                I.980403
006750         MOVE NC"分類名③　　　　　　　　　　　" TO W-MID21.      I.980403
006760     IF W-NOD = 16                                                I.020507
006770         MOVE NC"部門管理名　　　　　　　　　　" TO W-MID21.      I.020507
006780*****IF W-NOD = 18                                                D.000524
006790*****    MOVE NC"間接費　　　　　　　　　　　　" TO W-MID21.      D.000524
006800*****IF W-NOD = 19                                                D.141111
006810*****    MOVE NC"直接経費率" TO W-MID11                           D.141111
006820*****    MOVE NC"間接経費率　　　　　" TO W-MID12.                D.141111
006830     IF W-NOD = 31
006840         MOVE NC"入金名　　　　　　　　　　　　" TO W-MID21.
006850     IF W-NOD = 32                                                I.991213
006860         MOVE NC"入金その他相殺名　　　　　　　" TO W-MID21.      I.991213
006870     IF W-NOD = 41
006880         MOVE NC"仕上受入入力区分名　　　　　　" TO W-MID21.
006890     IF W-NOD = 42
006900         MOVE NC"生産区分名　　　　　　　　　　" TO W-MID21.
006910*
006920     DISPLAY C-CLEAR.
006930     DISPLAY C-MID.
006940     DISPLAY C-MID1.
006950     MOVE 6 TO W-LIN.
006960 M-120.
006970     ADD 1 TO W-LIN.
006980     IF W-LIN = 21
006990         DISPLAY C-CLEAR
007000         DISPLAY C-MID C-MID1
007010         MOVE 7 TO W-LIN.
007020 M-220.
007030     IF W-ACT NOT = ZERO
007040         DISPLAY A-ACT.
007050     ACCEPT A-ACT.
007060     DISPLAY E-CL.
007070     IF ESTAT = BTB
007080         GO TO M-040.
007090     IF ESTAT NOT = HTB AND SKP
007100         GO TO M-220.
007110     IF W-ACT = 9
007120         GO TO M-980.
007130     IF W-ACT < 1 OR > 3
007140         GO TO M-220.
007150*
007160     MOVE SPACE TO W-R.
007170     MOVE W-NOD TO W-NO.
007180     MOVE 0 TO W-BS.
007190 M-240.
007200     IF W-NOD = 01
007210         PERFORM TDFK-RTN THRU TDFK-EX.
007220     IF W-NOD = 02
007230         PERFORM BM-RTN THRU BM-EX.
007240*****IF W-NOD = 03                                                D.050303
007250*****    PERFORM TKC-RTN THRU TKC-EX.                             D.050303
007260     IF W-NOD = 04
007270         PERFORM TNC-RTN THRU TNC-EX.
007280     IF W-NOD = 08
007290         PERFORM KTKC-RTN THRU KTKC-EX.
007300     IF W-NOD = 11
007310         PERFORM BR1-RTN THRU BR1-EX.
007320*****IF W-NOD = 12                                                D.030514
007330*****    PERFORM BR21-RTN THRU BR21-EX.                           D.020514
007340     IF W-NOD = 13
007350         PERFORM BR22-RTN THRU BR22-EX.
007360     IF W-NOD = 14                                                I.980403
007370         PERFORM BR3-RTN THRU BR3-EX.                             I.980403
007380     IF W-NOD = 16                                                I.020507
007390         PERFORM BMC-RTN THRU BMC-EX.                             I.020507
007400*****IF W-NOD = 18                                                D.000524
007410*****    PERFORM KNC-RTN THRU KNC-EX.                             D.000524
007420*****IF W-NOD = 19                                                D.141111
007430*****    PERFORM KHR-RTN THRU KHR-EX.                             D.141111
007440     IF W-NOD = 31
007450         PERFORM NKC1-RTN THRU NKC1-EX.
007460     IF W-NOD = 32                                                I.991213
007470         PERFORM NSC-RTN THRU NSC-EX.                             I.991213
007480     IF W-NOD = 41
007490         PERFORM SUC-RTN THRU SUC-EX.
007500     IF W-NOD = 42
007510         PERFORM SSC-RTN THRU SSC-EX.
007520     IF W-BS = 9
007530         GO TO M-220.
007540 M-540.
007550     ACCEPT A-DMM.
007560     IF ESTAT = BTB
007570         IF W-ACT = 3
007580             GO TO M-240
007590           ELSE
007600             MOVE 5 TO W-BS
007610             GO TO M-240.
007620     IF ESTAT NOT = HTB AND SKP
007630         GO TO M-540.
007640     IF W-DMM = 9
007650         DISPLAY E-ME3 E-ME98
007660         GO TO M-240.
007670     IF W-DMM NOT = 1
007680         GO TO M-540.
007690*
007700     PERFORM WRD-RTN THRU WRD-EX.
007710     IF W-INV = 9
007720         GO TO M-980.
007730     GO TO M-120.
007740 M-720.                                                           I.050303
007750     DISPLAY C-CLEAR.                                             I.050303
007760     DISPLAY C-MID.                                               I.050303
007770     DISPLAY C-MID80.                                             I.050303
007780     MOVE SPACE TO HKB-KEY.                                       I.050303
007790     MOVE 90 TO HKB-NO.                                           I.050303
007800     READ HKBM INVALID KEY                                        I.050303
007810         DISPLAY E-ME78 E-ME2 E-ME99                              I.050303
007820         GO TO M-040.                                             I.050303
007830     MOVE HKB-R TO W-R.                                           I.050303
007840     MOVE ZERO TO CNT.                                            I.050303
007850 M-740.                                                           I.050303
007860     ADD 1 TO CNT.                                                I.050303
007870     IF CNT > 0 AND < 16                                          I.050303
007880         MOVE W-CLC(CNT) TO W-LC                                  I.050303
007890         DISPLAY A-SC                                             I.050303
007900         GO TO M-740.                                             I.050303
007910     MOVE ZERO TO CNT.                                            I.050303
007920 M-760.                                                           I.050303
007930     ADD 1 TO CNT.                                                I.050303
007940     IF CNT = 0 OR > 15                                           I.050303
007950         GO TO M-800.                                             I.050303
007960 M-780.                                                           I.050303
007970     MOVE W-CLC(CNT) TO W-LC.                                     I.050303
007980     ACCEPT A-SC.                                                 I.050303
007990     IF ESTAT = BTB                                               I.050303
008000         SUBTRACT 1 FROM CNT                                      I.050303
008010         IF CNT = 0                                               I.050303
008020             GO TO M-040                                          I.050303
008030           ELSE                                                   I.050303
008040             GO TO M-780.                                         I.050303
008050     IF ESTAT NOT = HTB AND SKP                                   I.050303
008060         GO TO M-780.                                             I.050303
008070     IF W-SC(CNT) > 1                                             I.050303
008080         GO TO M-780.                                             I.050303
008090     GO TO M-760.                                                 I.050303
008100 M-800.                                                           I.050303
008110     ACCEPT A-DMMD.                                               I.050303
008120     IF ESTAT = BTB                                               I.050303
008130         SUBTRACT 1 FROM CNT                                      I.050303
008140         GO TO M-780.                                             I.050303
008150     IF ESTAT NOT = HTB AND SKP                                   I.050303
008160         GO TO M-800.                                             I.050303
008170     IF W-DMM = 9                                                 I.050303
008180         GO TO M-720.                                             I.050303
008190     IF W-DMM NOT = 1                                             I.050303
008200         GO TO M-800.                                             I.050303
008210*
008220     MOVE 2 TO W-ACT.                                             I.050303
008230     PERFORM WRD-RTN THRU WRD-EX.                                 I.050303
008240     IF W-INV = 9                                                 I.050303
008250         GO TO M-980.                                             I.050303
008260     GO TO M-040.                                                 I.050303
008270 M-820.
008280     CLOSE HKBM.
008290     PERFORM PRI-RTN THRU PRI-EX.
008300     OPEN I-O HKBM.
008310     GO TO M-040.
008320 M-980.
008330     CLOSE HKBM.
008340     DISPLAY C-CLEAR.
008350     STOP RUN.
008360*-------------　都道府県　入力  ------------------------------------------
008370 TDFK-RTN.
008380     IF W-BS = 5
008390         MOVE 0 TO W-BS
008400*****    GO TO TDFK-040.                                          D.970108
008410         GO TO TDFK-060.                                          I.970108
008420     ACCEPT A-TDFK.
008430     DISPLAY E-CL.
008440     IF ESTAT = BTB
008450         MOVE 9 TO W-BS
008460         GO TO TDFK-EX.
008470     IF ESTAT NOT = HTB AND SKP
008480         GO TO TDFK-RTN.
008490*****IF W-TDFK < 1 OR > 47                                        D.960911
008500*****    GO TO TDFK-RTN.                                          D.960911
008510     PERFORM RED-RTN THRU RED-EX.
008520     IF CHK = 5
008530         GO TO TDFK-RTN.
008540     IF W-ACT = 1
008550         MOVE SPACE TO W-FKNA
008560*****    MOVE ZERO TO W-SU.                                       D.970127
008570         MOVE ZERO TO W-SU W-KTKCD.                               I.970127
008580*****DISPLAY A-FKNA D-SU.                                         D.970127
008590     DISPLAY A-FKNA D-SU A-KTKCD.                                 I.970127
008600     IF W-ACT = 3
008610         GO TO TDFK-EX.
008620 TDFK-020.
008630     ACCEPT A-FKNA.
008640     IF ESTAT = BTB
008650         GO TO TDFK-RTN.
008660     IF ESTAT NOT = HTB AND SKP
008670         GO TO TDFK-020.
008680 TDFK-040.
008690     ACCEPT A-SU.
008700     IF ESTAT = BTB
008710         GO TO TDFK-020.
008720     IF ESTAT NOT = HTB AND SKP
008730         GO TO TDFK-040.
008740     DISPLAY D-SU.
008750 TDFK-060.                                                        I.970108
008760     ACCEPT A-KTKCD.                                              I.970108
008770     IF ESTAT = BTB                                               I.970108
008780         GO TO TDFK-040.                                          I.970108
008790     IF ESTAT NOT = HTB AND SKP                                   I.970108
008800         GO TO TDFK-060.                                          I.970108
008810 TDFK-EX.
008820     EXIT.
008830*-------------　部門　入力  ----------------------------------------------
008840 BM-RTN.
008850     IF W-BS = 5
008860         MOVE 0 TO W-BS
008870         GO TO BM-020.
008880     ACCEPT A-BM.
008890     DISPLAY E-CL.
008900     IF ESTAT = BTB
008910         MOVE 9 TO W-BS
008920         GO TO BM-EX.
008930     IF ESTAT NOT = HTB AND SKP
008940         GO TO BM-RTN.
008950     PERFORM RED-RTN THRU RED-EX.
008960     IF CHK = 5
008970         GO TO BM-RTN.
008980     IF W-ACT = 1
008990         MOVE SPACE TO W-BMNA.
009000     DISPLAY A-BMNA.
009010     IF W-ACT = 3
009020         GO TO BM-EX.
009030 BM-020.
009040     ACCEPT A-BMNA.
009050     IF ESTAT = BTB
009060         GO TO BM-RTN.
009070     IF ESTAT NOT = HTB AND SKP
009080         GO TO BM-020.
009090 BM-EX.
009100     EXIT.
009110*-------------　地区　入力  ----------------------------------------------
009120*TKC-RTN.                                                         D.050303
009130*****IF W-BS = 5                                                  D.050303
009140*****    MOVE 0 TO W-BS                                           D.050303
009150*****    GO TO TKC-020.                                           D.050303
009160*****ACCEPT A-TKC.                                                D.050303
009170*****DISPLAY E-CL.                                                D.050303
009180*****IF ESTAT = BTB                                               D.050303
009190*****    MOVE 9 TO W-BS                                           D.050303
009200*****    GO TO TKC-EX.                                            D.050303
009210*****IF ESTAT NOT = HTB AND SKP                                   D.050303
009220*****    GO TO TKC-RTN.                                           D.050303
009230*****PERFORM RED-RTN THRU RED-EX.                                 D.050303
009240*****IF CHK = 5                                                   D.050303
009250*****    GO TO TKC-RTN.                                           D.050303
009260*****IF W-ACT = 1                                                 D.050303
009270*****    MOVE SPACE TO W-TKNA.                                    D.050303
009280*****DISPLAY A-TKNA.                                              D.050303
009290*****IF W-ACT = 3                                                 D.050303
009300*****    GO TO TKC-EX.                                            D.050303
009310*TKC-020.                                                         D.050303
009320*****ACCEPT A-TKNA.                                               D.050303
009330*****IF ESTAT = BTB                                               D.050303
009340*****    GO TO TKC-RTN.                                           D.050303
009350*****IF ESTAT NOT = HTB AND SKP                                   D.050303
009360*****    GO TO TKC-020.                                           D.050303
009370*TKC-EX.                                                          D.050303
009380*****EXIT.                                                        D.050303
009390*-------------　担当　入力  ----------------------------------------------
009400 TNC-RTN.
009410     IF W-BS = 5
009420         MOVE 0 TO W-BS
009430         GO TO TNC-020.
009440     ACCEPT A-TNC.
009450     DISPLAY E-CL.
009460     IF ESTAT = BTB
009470         MOVE 9 TO W-BS
009480         GO TO TNC-EX.
009490     IF ESTAT NOT = HTB AND SKP
009500         GO TO TNC-RTN.
009510     PERFORM RED-RTN THRU RED-EX.
009520     IF CHK = 5
009530         GO TO TNC-RTN.
009540     IF W-ACT = 1
009550         MOVE SPACE TO W-TNNA.
009560     DISPLAY A-TNNA.
009570     IF W-ACT = 3
009580         GO TO TNC-EX.
009590 TNC-020.
009600     ACCEPT A-TNNA.
009610     IF ESTAT = BTB
009620         GO TO TNC-RTN.
009630     IF ESTAT NOT = HTB AND SKP
009640         GO TO TNC-020.
009650 TNC-EX.
009660     EXIT.
009670*-------------　教育地区　入力  ------------------------------------------
009680 KTKC-RTN.
009690     IF W-BS = 5
009700         MOVE 0 TO W-BS
009710         GO TO KTKC-020.
009720     ACCEPT A-KTKC.
009730     DISPLAY E-CL.
009740     IF ESTAT = BTB
009750         MOVE 9 TO W-BS
009760         GO TO KTKC-EX.
009770     IF ESTAT NOT = HTB AND SKP
009780         GO TO KTKC-RTN.
009790     PERFORM RED-RTN THRU RED-EX.
009800     IF CHK = 5
009810         GO TO KTKC-RTN.
009820     IF W-ACT = 1
009830         MOVE SPACE TO W-KTNA.
009840     DISPLAY A-KTNA.
009850     IF W-ACT = 3
009860         GO TO KTKC-EX.
009870 KTKC-020.
009880     ACCEPT A-KTNA.
009890     IF ESTAT = BTB
009900         GO TO KTKC-RTN.
009910     IF ESTAT NOT = HTB AND SKP
009920         GO TO KTKC-020.
009930 KTKC-EX.
009940     EXIT.
009950*-------------　分類①　入力  --------------------------------------------
009960 BR1-RTN.
009970     IF W-BS = 5
009980         MOVE 0 TO W-BS
009990         GO TO BR1-020.
010000     ACCEPT A-BR1.
010010     DISPLAY E-CL.
010020     IF ESTAT = BTB
010030         MOVE 9 TO W-BS
010040         GO TO BR1-EX.
010050     IF ESTAT NOT = HTB AND SKP
010060         GO TO BR1-RTN.
010070     PERFORM RED-RTN THRU RED-EX.
010080     IF CHK = 5
010090         GO TO BR1-RTN.
010100     IF W-ACT = 1
010110         MOVE SPACE TO W-BRN1.
010120     DISPLAY A-BRN1.
010130     IF W-ACT = 3
010140         GO TO BR1-EX.
010150 BR1-020.
010160     ACCEPT A-BRN1.
010170     IF ESTAT = BTB
010180         GO TO BR1-RTN.
010190     IF ESTAT NOT = HTB AND SKP
010200         GO TO BR1-020.
010210 BR1-EX.
010220     EXIT.
010230*-------------　分類②－１　入力  ----------------------------------------
010240*BR21-RTN.                                                        D.030514
010250*****IF W-BS = 5                                                  D.030514
010260*****    MOVE 0 TO W-BS                                           D.030514
010270*****    GO TO BR21-040.                                          D.960924
010280*****    GO TO BR21-060.                                          D.030514
010290*****ACCEPT A-BR21.                                               D.030514
010300*****DISPLAY E-CL.                                                D.030514
010310*****IF ESTAT = BTB                                               D.030514
010320*****    MOVE 9 TO W-BS                                           D.030514
010330*****    GO TO BR21-EX.                                           D.030514
010340*****IF ESTAT NOT = HTB AND SKP                                   D.030514
010350*****    GO TO BR21-RTN.                                          D.030514
010360*****PERFORM RED-RTN THRU RED-EX.                                 D.030514
010370*****IF CHK = 5                                                   D.030514
010380*****    GO TO BR21-RTN.                                          D.030514
010390*****IF W-ACT = 1                                                 D.030514
010400*****    MOVE SPACE TO W-BRN21F W-BRN21R.                         D.960924
010410*****DISPLAY A-BRN21F A-BRN21R.                                   D.960924
010420*****    MOVE SPACE TO W-BRN21F W-BRN21R W-BRN21S.                D.030514
010430*****DISPLAY A-BRN21F A-BRN21R A-BRN21S.                          D.030514
010440*****IF W-ACT = 3                                                 D.030514
010450*****    GO TO BR21-EX.                                           D.030514
010460*BR21-020.                                                        D.030514
010470*****ACCEPT A-BRN21F.                                             D.030514
010480*****IF ESTAT = BTB                                               D.030514
010490*****    GO TO BR21-RTN.                                          D.030514
010500*****IF ESTAT NOT = HTB AND SKP                                   D.030514
010510*****    GO TO BR21-020.                                          D.030514
010520*BR21-040.                                                        D.030514
010530*****ACCEPT A-BRN21R.                                             D.030514
010540*****IF ESTAT = BTB                                               D.030514
010550*****    GO TO BR21-020.                                          D.030514
010560*****IF ESTAT NOT = HTB AND SKP                                   D.030514
010570*****    GO TO BR21-040.                                          D.030514
010580*BR21-060.                                                        D.030514
010590*****ACCEPT A-BRN21S.                                             D.030514
010600*****IF ESTAT = BTB                                               D.030514
010610*****    GO TO BR21-040.                                          D.030514
010620*****IF ESTAT NOT = HTB AND SKP                                   D.030514
010630*****    GO TO BR21-060.                                          D.030514
010640*BR21-EX.                                                         D.030514
010650*****EXIT.                                                        D.030514
010660*-------------　分類②　入力  --------------------------------------------
010670 BR22-RTN.
010680     IF W-BS = 5
010690         MOVE 0 TO W-BS
010700         GO TO BR22-020.
010710     ACCEPT A-BR22.
010720     DISPLAY E-CL.
010730     IF ESTAT = BTB
010740         MOVE 9 TO W-BS
010750         GO TO BR22-EX.
010760     IF ESTAT NOT = HTB AND SKP
010770         GO TO BR22-RTN.
010780     PERFORM RED-RTN THRU RED-EX.
010790     IF CHK = 5
010800         GO TO BR22-RTN.
010810     IF W-ACT = 1
010820         MOVE SPACE TO W-BRN22.
010830     DISPLAY A-BRN22.
010840     IF W-ACT = 3
010850         GO TO BR22-EX.
010860 BR22-020.
010870     ACCEPT A-BRN22.
010880     IF ESTAT = BTB
010890         GO TO BR22-RTN.
010900     IF ESTAT NOT = HTB AND SKP
010910         GO TO BR22-020.
010920 BR22-EX.
010930     EXIT.
010940*-------------　分類③　入力  --------------------------------------------
010950 BR3-RTN.                                                         I.980403
010960     IF W-BS = 5                                                  I.980403
010970         MOVE 0 TO W-BS                                           I.980403
010980         GO TO BR3-020.                                           I.980403
010990     ACCEPT A-BR3.                                                I.980403
011000     DISPLAY E-CL.                                                I.980403
011010     IF ESTAT = BTB                                               I.980403
011020         MOVE 9 TO W-BS                                           I.980403
011030         GO TO BR3-EX.                                            I.980403
011040     IF ESTAT NOT = HTB AND SKP                                   I.980403
011050         GO TO BR3-RTN.                                           I.980403
011060     PERFORM RED-RTN THRU RED-EX.                                 I.980403
011070     IF CHK = 5                                                   I.980403
011080         GO TO BR3-RTN.                                           I.980403
011090     IF W-ACT = 1                                                 I.980403
011100         MOVE SPACE TO W-BRN3.                                    I.980403
011110     DISPLAY A-BRN3.                                              I.980403
011120     IF W-ACT = 3                                                 I.980403
011130         GO TO BR3-EX.                                            I.980403
011140 BR3-020.                                                         I.980403
011150     ACCEPT A-BRN3.                                               I.980403
011160     IF ESTAT = BTB                                               I.980403
011170         GO TO BR3-RTN.                                           I.980403
011180     IF ESTAT NOT = HTB AND SKP                                   I.980403
011190         GO TO BR3-020.                                           I.980403
011200 BR3-EX.                                                          I.980403
011210     EXIT.                                                        I.980403
011220*-------------　部門管理入力  --------------------------------------------
011230 BMC-RTN.                                                         I.020507
011240     IF W-BS = 5                                                  I.020507
011250         MOVE 0 TO W-BS                                           I.020507
011260         GO TO BMC-020.                                           I.020507
011270     ACCEPT A-BMC.                                                I.020507
011280     DISPLAY E-CL.                                                I.020507
011290     IF ESTAT = BTB                                               I.020507
011300         MOVE 9 TO W-BS                                           I.020507
011310         GO TO BMC-EX.                                            I.020507
011320     IF ESTAT NOT = HTB AND SKP                                   I.020507
011330         GO TO BMC-RTN.                                           I.020507
011340     PERFORM RED-RTN THRU RED-EX.                                 I.020507
011350     IF CHK = 5                                                   I.020507
011360         GO TO BMC-RTN.                                           I.020507
011370     IF W-ACT = 1                                                 I.020507
011380         MOVE SPACE TO W-BMN.                                     I.020507
011390     DISPLAY A-BMN.                                               I.020507
011400     IF W-ACT = 3                                                 I.020507
011410         GO TO BMC-EX.                                            I.020507
011420 BMC-020.                                                         I.020507
011430     ACCEPT A-BMN.                                                I.020507
011440     IF ESTAT = BTB                                               I.020507
011450         GO TO BMC-RTN.                                           I.020507
011460     IF ESTAT NOT = HTB AND SKP                                   I.020507
011470         GO TO BMC-020.                                           I.020507
011480 BMC-EX.                                                          I.020507
011490     EXIT.                                                        I.020507
011500*-------------　間接費　入力  --------------------------------------------
011510*KNC-RTN.                                                         D.000524
011520*****IF W-BS = 5                                                  D.000524
011530*****    MOVE 0 TO W-BS                                           D.000524
011540*****    GO TO KNC-020.                                           D.000524
011550*****ACCEPT A-KNC.                                                D.000524
011560*****DISPLAY E-CL.                                                D.000524
011570*****IF ESTAT = BTB                                               D.000524
011580*****    MOVE 9 TO W-BS                                           D.000524
011590*****    GO TO KNC-EX.                                            D.000524
011600*****IF ESTAT NOT = HTB AND SKP                                   D.000524
011610*****    GO TO KNC-RTN.                                           D.000524
011620*****PERFORM RED-RTN THRU RED-EX.                                 D.000524
011630*****IF CHK = 5                                                   D.000524
011640*****    GO TO KNC-RTN.                                           D.000524
011650*****IF W-ACT = 1                                                 D.000524
011660*****    MOVE ZERO TO W-KNKH.                                     D.000524
011670*****DISPLAY D-KNKH.                                              D.000524
011680*****IF W-ACT = 3                                                 D.000524
011690*****    GO TO KNC-EX.                                            D.000524
011700*KNC-020.                                                         D.000524
011710*****ACCEPT A-KNKH.                                               D.000524
011720*****IF ESTAT = BTB                                               D.000524
011730*****    GO TO KNC-RTN.                                           D.000524
011740*****IF ESTAT NOT = HTB AND SKP                                   D.000524
011750*****    GO TO KNC-020.                                           D.000524
011760*****DISPLAY D-KNKH.                                              D.000524
011770*KNC-EX.                                                          D.000524
011780*****EXIT.                                                        D.000524
011790*-------------　経費率　入力  --------------------------------------------
011800*KHR-RTN.                                                         D.141111
011810*****IF W-BS = 5                                                  D.141111
011820*****    MOVE 0 TO W-BS                                           D.141111
011830*****    GO TO KHR-040.                                           D.141111
011840*****PERFORM RED-RTN THRU RED-EX.                                 D.141111
011850*****IF CHK = 5                                                   D.141111
011860*****    MOVE 9 TO W-BS                                           D.141111
011870*****    GO TO KHR-EX.                                            D.141111
011880*****IF W-ACT = 1                                                 D.141111
011890*****    MOVE ZERO TO W-CKR W-KKR.                                D.141111
011900*****DISPLAY D-CKR D-KKR.                                         D.141111
011910*****IF W-ACT = 3                                                 D.141111
011920*****    GO TO KHR-EX.                                            D.141111
011930*KHR-020.                                                         D.141111
011940*****ACCEPT A-CKR.                                                D.141111
011950*****DISPLAY E-CL.                                                D.141111
011960*****IF ESTAT = BTB                                               D.141111
011970*****    MOVE 9 TO W-BS                                           D.141111
011980*****    GO TO KHR-EX.                                            D.141111
011990*****IF ESTAT NOT = HTB AND SKP                                   D.141111
012000*****    GO TO KHR-020.                                           D.141111
012010*****DISPLAY D-CKR.                                               D.141111
012020*KHR-040.                                                         D.141111
012030*****ACCEPT A-KKR.                                                D.141111
012040*****IF ESTAT = BTB                                               D.141111
012050*****    GO TO KHR-020.                                           D.141111
012060*****IF ESTAT NOT = HTB AND SKP                                   D.141111
012070*****    GO TO KHR-040.                                           D.141111
012080*****DISPLAY D-KKR.                                               D.141111
012090*KHR-EX.                                                          D.141111
012100*****EXIT.                                                        D.141111
012110*-------------　入金　入力  ----------------------------------------------
012120 NKC1-RTN.
012130     IF W-BS = 5
012140         MOVE 0 TO W-BS
012150         GO TO NKC1-020.
012160     ACCEPT A-NKC1.
012170     DISPLAY E-CL.
012180     IF ESTAT = BTB
012190         MOVE 9 TO W-BS
012200         GO TO NKC1-EX.
012210     IF ESTAT NOT = HTB AND SKP
012220         GO TO NKC1-RTN.
012230     PERFORM RED-RTN THRU RED-EX.
012240     IF CHK = 5
012250         GO TO NKC1-RTN.
012260     IF W-ACT = 1
012270         MOVE SPACE TO W-NKNA.
012280     DISPLAY A-NKNA.
012290     IF W-ACT = 3
012300         GO TO NKC1-EX.
012310 NKC1-020.
012320     ACCEPT A-NKNA.
012330     IF ESTAT = BTB
012340         GO TO NKC1-RTN.
012350     IF ESTAT NOT = HTB AND SKP
012360         GO TO NKC1-020.
012370 NKC1-EX.
012380     EXIT.
012390*-------------　入金その他相殺名　入力  ----------------------------------
012400 NSC-RTN.
012410     IF W-BS = 5
012420         MOVE 0 TO W-BS
012430         GO TO NSC-020.
012440     ACCEPT A-NSC.
012450     DISPLAY E-CL.
012460     IF ESTAT = BTB
012470         MOVE 9 TO W-BS
012480         GO TO NSC-EX.
012490     IF ESTAT NOT = HTB AND SKP
012500         GO TO NSC-RTN.
012510     PERFORM RED-RTN THRU RED-EX.
012520     IF CHK = 5
012530         GO TO NSC-RTN.
012540     IF W-ACT = 1
012550         MOVE SPACE TO W-NSNA.
012560     DISPLAY A-NSNA.
012570     IF W-ACT = 3
012580         GO TO NSC-EX.
012590 NSC-020.
012600     ACCEPT A-NSNA.
012610     IF ESTAT = BTB
012620         GO TO NSC-RTN.
012630     IF ESTAT NOT = HTB AND SKP
012640         GO TO NSC-020.
012650 NSC-EX.
012660     EXIT.
012670*-------------　仕上受入入力　入力  --------------------------------------
012680 SUC-RTN.
012690     IF W-BS = 5
012700         MOVE 0 TO W-BS
012710         GO TO SUC-020.
012720     ACCEPT A-SUC.
012730     DISPLAY E-CL.
012740     IF ESTAT = BTB
012750         MOVE 9 TO W-BS
012760         GO TO SUC-EX.
012770     IF ESTAT NOT = HTB AND SKP
012780         GO TO SUC-RTN.
012790     PERFORM RED-RTN THRU RED-EX.
012800     IF CHK = 5
012810         GO TO SUC-RTN.
012820     IF W-ACT = 1
012830         MOVE SPACE TO W-SUNA.
012840     DISPLAY A-SUNA.
012850     IF W-ACT = 3
012860         GO TO SUC-EX.
012870 SUC-020.
012880     ACCEPT A-SUNA.
012890     IF ESTAT = BTB
012900         GO TO SUC-RTN.
012910     IF ESTAT NOT = HTB AND SKP
012920         GO TO SUC-020.
012930 SUC-EX.
012940     EXIT.
012950*-------------　生産区分　入力  ------------------------------------------
012960 SSC-RTN.
012970     IF W-BS = 5
012980         MOVE 0 TO W-BS
012990         GO TO SSC-020.
013000     ACCEPT A-SSC.
013010     DISPLAY E-CL.
013020     IF ESTAT = BTB
013030         MOVE 9 TO W-BS
013040         GO TO SSC-EX.
013050     IF ESTAT NOT = HTB AND SKP
013060         GO TO SSC-RTN.
013070     PERFORM RED-RTN THRU RED-EX.
013080     IF CHK = 5
013090         GO TO SSC-RTN.
013100     IF W-ACT = 1
013110         MOVE SPACE TO W-SSNA.
013120     DISPLAY A-SSNA.
013130     IF W-ACT = 3
013140         GO TO SSC-EX.
013150 SSC-020.
013160     ACCEPT A-SSNA.
013170     IF ESTAT = BTB
013180         GO TO SSC-RTN.
013190     IF ESTAT NOT = HTB AND SKP
013200         GO TO SSC-020.
013210 SSC-EX.
013220     EXIT.
013230*-------------　ＲＥＡＤ  ------------------------------------------------
013240 RED-RTN.
013250     MOVE ZERO TO CHK.
013260     MOVE W-KEY TO HKB-KEY.
013270     READ HKBM INVALID KEY
013280         GO TO RED-020.
013290     IF W-ACT = 1
013300         DISPLAY E-ME1 E-ME98
013310         MOVE 5 TO CHK
013320       ELSE
013330         MOVE HKB-R TO W-R.
013340     GO TO RED-EX.
013350 RED-020.
013360     IF W-ACT NOT = 1
013370         DISPLAY E-ME2 E-ME98
013380         MOVE 5 TO CHK.
013390 RED-EX.
013400     EXIT.
013410*-------------　ＷＲＩＴＥ・ＲＥＷＲＩＴＥ・ＤＥＬＥＴＥ　----------------
013420 WRD-RTN.
013430     IF W-ACT = 3
013440         GO TO WRD-220.
013450 WRD-020.
013460     INITIALIZE HKB-R.
013470     MOVE W-R TO HKB-R.
013480     IF W-ACT = 2
013490         GO TO WRD-120.
013500     WRITE HKB-R INVALID KEY
013510         DISPLAY E-STAT E-ME11 E-ME99
013520         GO TO WRD-040.
013530     CALL "CBLTCLS" USING HKBM.
013540     GO TO WRD-EX.
013550 WRD-040.
013560     IF ERR-STAT NOT = "24"
013570         DISPLAY E-ME78 E-ME99
013580         MOVE 9 TO W-INV
013590         GO TO WRD-EX.
013600     DISPLAY E-CL.
013610     CLOSE HKBM.
013620     MOVE "KKBM         " TO W-FILE.
013630     DISPLAY E-ME71 E-ME98 STOP " ".
013640     DISPLAY E-CL.
013650     OPEN I-O HKBM.
013660     GO TO WRD-020.
013670 WRD-120.
013680     REWRITE HKB-R INVALID KEY
013690         DISPLAY E-ME78 E-STAT E-ME12 E-ME99
013700         MOVE 9 TO W-INV
013710         GO TO WRD-EX.
013720     GO TO WRD-EX.
013730 WRD-220.
013740     DELETE HKBM INVALID KEY
013750         DISPLAY E-ME78 E-STAT E-ME13 E-ME99
013760         MOVE 9 TO W-INV
013770         GO TO WRD-EX.
013780     CALL "CBLTCLS" USING HKBM.
013790     GO TO WRD-EX.
013800 WRD-EX.
013810     EXIT.
013820*-------------　作表　ＭＯＶＥ  ------------------------------------------
013830 PRI-RTN.
013840     OPEN INPUT HKBM.
013850 PRI-020.
013860     READ HKBM NEXT RECORD WITH UNLOCK AT END
013870         DISPLAY E-ME2 E-ME98
013880         CLOSE HKBM
013890         GO TO PRI-EX.
013900*****IF HKB-NO = 05                                               D.050303
013910     IF HKB-NO = 03 OR 05 OR 90                                   I.050303
013920         GO TO PRI-020.                                           I.990603
013930     MOVE ZERO TO W-LCD.
013940     MOVE SPACE TO W-P.
013950 PRI-040.
013960     IF W-LD NOT = ZERO
013970         PERFORM PST-RTN THRU PST-EX.
013980     MOVE ZERO TO W-PC.
013990     MOVE HKB-NO TO W-NOD.
014000     IF W-NOD = 01
014010         MOVE W-NO01 TO W-NON.
014020     IF W-NOD = 02
014030         MOVE W-NO02 TO W-NON.
014040*****IF W-NOD = 03                                                D.050303
014050*****    MOVE W-NO03 TO W-NON.                                    D.050303
014060     IF W-NOD = 04
014070         MOVE W-NO04 TO W-NON.
014080     IF W-NOD = 08
014090         MOVE W-NO08 TO W-NON.
014100     IF W-NOD = 11
014110         MOVE W-NO11 TO W-NON.
014120*****IF W-NOD = 12                                                D.030514
014130*****    MOVE W-NO12 TO W-NON.                                    D.030514
014140     IF W-NOD = 13
014150         MOVE W-NO13 TO W-NON.
014160     IF W-NOD = 14                                                I.980403
014170         MOVE W-NO14 TO W-NON.                                    I.980403
014180     IF W-NOD = 16                                                I.020507
014190         MOVE W-NO16 TO W-NON.                                    I.020507
014200*****IF W-NOD = 18                                                D.000524
014210*****    MOVE W-NO18 TO W-NON.                                    D.000524
014220*****IF W-NOD = 19                                                D.141111
014230*****    MOVE W-NO19 TO W-NON.                                    D.141111
014240     IF W-NOD = 31
014250         MOVE W-NO31 TO W-NON.
014260     IF W-NOD = 32                                                I.991213
014270         MOVE W-NO32 TO W-NON.                                    I.991213
014280     IF W-NOD = 41
014290         MOVE W-NO41 TO W-NON.
014300     IF W-NOD = 42
014310         MOVE W-NO42 TO W-NON.
014320 PRI-060.
014330     PERFORM PST-RTN THRU PST-EX.
014340     IF W-CD NOT = 0
014350         GO TO PRI-080.
014360     IF W-PC = 0
014370         MOVE 5 TO W-PC
014380         MOVE HKB-NO TO P-NO1(W-LD)
014390         MOVE W-NON TO P-NON1(W-LD).
014400     MOVE HKB-BC TO P-BC1(W-LD).
014410     IF HKB-NO = 01
014420         MOVE HKB-FKNA TO P-FKNA1(W-LD)
014430*****    MOVE HKB-SU TO P-SU1(W-LD).                              D.970108
014440         MOVE HKB-SU TO P-SU1(W-LD)                               I.970108
014450         MOVE HKB-KTKCD TO P-KTKCD1(W-LD).                        I.970108
014460     IF HKB-NO = 02
014470         MOVE HKB-BMNA TO P-MS1(W-LD).
014480*****IF HKB-NO = 03                                               D.050303
014490*****    MOVE HKB-TKNA TO P-MS1(W-LD).                            D.050303
014500     IF HKB-NO = 04
014510         MOVE HKB-TNNA TO P-MS1(W-LD).
014520     IF HKB-NO = 08
014530         MOVE HKB-KTNA TO P-MS1(W-LD).
014540     IF HKB-NO = 11
014550         MOVE HKB-BRN1 TO P-MS1(W-LD).
014560*****IF HKB-NO = 12                                               D.030514
014570*****    MOVE HKB-BRN21F TO P-BRF1(W-LD)                          D.030514
014580*****    MOVE HKB-BRN21R TO P-BRR1(W-LD).                         D.960924
014590*****    MOVE HKB-BRN21R TO P-BRR1(W-LD)                          D.030514
014600*****    MOVE HKB-BRN21S TO P-BRS1(W-LD).                         D.030514
014610     IF HKB-NO = 13
014620         MOVE HKB-BRN22 TO P-MS1(W-LD).
014630     IF HKB-NO = 14                                               I.980403
014640         MOVE HKB-BRN3 TO P-MS1(W-LD).                            I.980403
014650     IF HKB-NO = 16                                               I.020507
014660         MOVE HKB-BMN TO P-MS1(W-LD).                             I.020507
014670*****IF HKB-NO = 18                                               D.000524
014680*****    MOVE HKB-KNKH TO P-KNKH1(W-LD).                          D.000524
014690*****IF HKB-NO = 19                                               D.141111
014700*****    MOVE HKB-CKR TO P-CKR1(W-LD)                             D.141111
014710*****    MOVE HKB-KKR TO P-KKR1(W-LD).                            D.141111
014720     IF HKB-NO = 31
014730         MOVE HKB-NKNA TO P-MS1(W-LD).
014740     IF HKB-NO = 32                                               I.991213
014750         MOVE HKB-NSNA TO P-MS1(W-LD).                            I.991213
014760     IF HKB-NO = 41
014770         MOVE HKB-SUNA TO P-MS1(W-LD).
014780     IF HKB-NO = 42
014790         MOVE HKB-SSNA TO P-MS1(W-LD).
014800     GO TO PRI-100.
014810 PRI-080.
014820     IF W-PC = 0
014830         MOVE 5 TO W-PC
014840         MOVE HKB-NO TO P-NO2(W-LD)
014850         MOVE W-NON TO P-NON2(W-LD).
014860     MOVE HKB-BC TO P-BC2(W-LD).
014870     IF HKB-NO = 01
014880         MOVE HKB-FKNA TO P-FKNA2(W-LD)
014890*****    MOVE HKB-SU TO P-SU2(W-LD).                              D.970108
014900         MOVE HKB-SU TO P-SU2(W-LD)                               I.970108
014910         MOVE HKB-KTKCD TO P-KTKCD2(W-LD).                        I.970108
014920     IF HKB-NO = 02
014930         MOVE HKB-BMNA TO P-MS2(W-LD).
014940*****IF HKB-NO = 03                                               D.050303
014950*****    MOVE HKB-TKNA TO P-MS2(W-LD).                            D.050303
014960     IF HKB-NO = 04
014970         MOVE HKB-TNNA TO P-MS2(W-LD).
014980     IF HKB-NO = 08
014990         MOVE HKB-KTNA TO P-MS2(W-LD).
015000     IF HKB-NO = 11
015010         MOVE HKB-BRN1 TO P-MS2(W-LD).
015020*****IF HKB-NO = 12                                               D.030514
015030*****    MOVE HKB-BRN21F TO P-BRF2(W-LD)                          D.030514
015040*****    MOVE HKB-BRN21R TO P-BRR2(W-LD).                         D.960924
015050*****    MOVE HKB-BRN21R TO P-BRR2(W-LD)                          D.030514
015060*****    MOVE HKB-BRN21S TO P-BRS2(W-LD).                         D.030514
015070     IF HKB-NO = 13
015080         MOVE HKB-BRN22 TO P-MS2(W-LD).
015090     IF HKB-NO = 14                                               I.980403
015100         MOVE HKB-BRN3 TO P-MS2(W-LD).                            I.980403
015110     IF HKB-NO = 16                                               I.020507
015120         MOVE HKB-BMN TO P-MS2(W-LD).                             I.020507
015130*****IF HKB-NO = 18                                               D.000524
015140*****    MOVE HKB-KNKH TO P-KNKH2(W-LD).                          D.000524
015150*****IF HKB-NO = 19                                               D.141111
015160*****    MOVE HKB-CKR TO P-CKR2(W-LD)                             D.141111
015170*****    MOVE HKB-KKR TO P-KKR2(W-LD).                            D.141111
015180     IF HKB-NO = 31
015190         MOVE HKB-NKNA TO P-MS2(W-LD).
015200     IF HKB-NO = 32                                               I.991213
015210         MOVE HKB-NSNA TO P-MS2(W-LD).                            I.991213
015220     IF HKB-NO = 41
015230         MOVE HKB-SUNA TO P-MS2(W-LD).
015240     IF HKB-NO = 42
015250         MOVE HKB-SSNA TO P-MS2(W-LD).
015260 PRI-100.
015270     READ HKBM NEXT RECORD WITH UNLOCK AT END
015280         GO TO PRI-120.
015290*****IF HKB-NO = 05                                               D.050303
015300     IF HKB-NO = 03 OR 05 OR 90                                   I.050303
015310         GO TO PRI-100.                                           I.990603
015320     IF HKB-NO = W-NOD
015330         GO TO PRI-060.
015340     GO TO PRI-040.
015350 PRI-120.
015360     PERFORM WRI-RTN THRU WRI-EX.
015370     CLOSE HKBM.
015380     CLOSE SP-F.
015390 PRI-EX.
015400     EXIT.
015410*-------------　作表　見出し  --------------------------------------------
015420 MID-RTN.
015430     MOVE SPACE TO SP-R.
015440     WRITE SP-R AFTER PAGE.
015450 MID-020.
015460     ADD 1 TO W-PAGE.
015470     MOVE W-PAGE TO H-PAGE.
015480     MOVE SPACE TO SP-R.
015490     MOVE HEAD1 TO SP-R.
015500     WRITE SP-R.
015510     MOVE SPACE TO SP-R.
015520     MOVE HEAD2 TO SP-R.
015530     WRITE SP-R AFTER 2.
015540     MOVE SPACE TO SP-R.
015550 MID-EX.
015560     EXIT.
015570*-------------　作表　改頁・改行  ----------------------------------------
015580 PST-RTN.
015590     ADD 1 TO W-LD.
015600     IF W-LD NOT = 60
015610         GO TO PST-020.
015620     IF W-CD = 0
015630         ADD 1 TO W-CD
015640         MOVE ZERO TO W-LD W-PC
015650         GO TO PST-RTN.
015660     PERFORM WRI-RTN THRU WRI-EX.
015670     MOVE ZERO TO W-LCD W-PC.
015680     MOVE SPACE TO W-P.
015690     GO TO PST-RTN.
015700 PST-020.
015710     IF W-CD = 0
015720         MOVE ":" TO P-X(W-LD).
015730 PST-EX.
015740     EXIT.
015750*-------------　作表　ＷＲＩＴＥ  ----------------------------------------
015760 WRI-RTN.
015770     IF W-POC = 0
015780         MOVE 5 TO W-POC
015790         OPEN OUTPUT SP-F
015800         PERFORM MID-020 THRU MID-EX
015810       ELSE
015820         PERFORM MID-RTN THRU MID-EX.
015830     MOVE ZERO TO W-LD.
015840 WRI-020.
015850     ADD 1 TO W-LD.
015860     IF W-LD NOT = 60
015870         IF P-X(W-LD) NOT = SPACE
015880             MOVE SPACE TO SP-R
015890             MOVE W-PD(W-LD) TO SP-R
015900             WRITE SP-R
015910             MOVE SPACE TO SP-R
015920             GO TO WRI-020.
015930 WRI-EX.
015940     EXIT.
