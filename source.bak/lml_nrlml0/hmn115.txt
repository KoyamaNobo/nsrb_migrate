000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMN115.
000030*********************************************************
000040*    PROGRAM         :  実棚卸入力（Ｗチェック入力用）  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHN11                          *
000070*        変更　　　  :  94/04/04                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT JCON ASSIGN TO JCON-MSD
000180         ORGANIZATION INDEXED
000190         RECORD KEY JCON1-KEY
000200         ACCESS MODE DYNAMIC
000210         FILE STATUS IS ERR-STAT.
000220*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010806
000230     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010806
000240         ORGANIZATION INDEXED
000250         ACCESS MODE DYNAMIC
000260         RECORD KEY HI-KEY
000270         ALTERNATE RECORD KEY HI-KEY2                             I.010806
000280         FILE STATUS IS ERR-STAT.
000290*****SELECT SHM ASSIGN TO SH-MSD                                  D.010806
000300*****    ORGANIZATION INDEXED                                     D.010806
000310*****    RECORD KEY SHM-KEY                                       D.010806
000320*****    ACCESS MODE DYNAMIC                                      D.010806
000330*****    FILE STATUS IS ERR-STAT.                                 D.010806
000340     SELECT HTI-M ASSIGN TO HTI-MSD
000350         ORGANIZATION INDEXED
000360         RECORD KEY HTI-KEY
000370         ACCESS MODE DYNAMIC
000380         FILE STATUS IS ERR-STAT.
000390     SELECT SP-F ASSIGN TO P-PRN999.
000400 I-O-CONTROL.
000410     APPLY SHARED-MODE ON M-DATE
000420     APPLY SHARED-MODE ON JCON
000430     APPLY SHARED-MODE ON HI-M
000440*****APPLY SHARED-MODE ON SHM                                     D.010806
000450     APPLY SHARED-MODE ON HTI-M
000460     APPLY SHIFT-CODE  ON SP-F.
000470 DATA DIVISION.
000480 FILE SECTION.
000490     COPY LIBFDD.
000500     COPY L-JCON.
000510*****COPY L-SHM.                                                  D.010806
000520     COPY LIHIM.
000530*****COPY LIHTIM.
000540*********************************************
000550*****     履物製品棚卸入力マスター      *****
000560*****      ( HTIM )   85/3              *****
000570*********************************************
000580 FD  HTI-M
000590*****BLOCK  4 RECORDS                                             D.990121
000600     BLOCK  3 RECORDS                                             I.990121
000610     LABEL RECORD IS STANDARD
000620     VALUE OF IDENTIFICATION "HTIMW".
000630 01  HTI-R.
000640     02  HTI-KEY.
000650       03  HTI-DNO.                                               伝票№
000660         04  HTI-DNO1   PIC  9(005).                              伝票№
000670         04  HTI-DNO2   PIC  X(001).
000680       03  HTI-GNO      PIC  9(001).                              行№
000690     02  HTI-SNO        PIC  9(001).                              I.990121
000700     02  HTI-HCD        PIC  9(006).                              品名ｺｰﾄﾞ
000710     02  HTI-SIZ        PIC  9(001).                              I.990121
000720     02  HTI-SUD.                                                 棚卸数
000730       03  HTI-SU       PIC S9(006)  OCCURS  10.                  I.990121
000740*****  03  HTI-SU       PIC S9(005)  OCCURS  10.                  D.990121
000750     02  HTI-ASU   REDEFINES  HTI-SUD.
000760       03  HTI-SU01     PIC S9(006).                              I.990121
000770       03  HTI-SU02     PIC S9(006).                              I.990121
000780       03  HTI-SU03     PIC S9(006).                              I.990121
000790       03  HTI-SU04     PIC S9(006).                              I.990121
000800       03  HTI-SU05     PIC S9(006).                              I.990121
000810       03  HTI-SU06     PIC S9(006).                              I.990121
000820       03  HTI-SU07     PIC S9(006).                              I.990121
000830       03  HTI-SU08     PIC S9(006).                              I.990121
000840       03  HTI-SU09     PIC S9(006).                              I.990121
000850       03  HTI-SU10     PIC S9(006).                              I.990121
000860     02  HTI-BC.                                                  I.990121
000870       03  HTI-BC1      PIC  9(002).                              I.990121
000880       03  HTI-BC2      PIC  9(002).                              I.990121
000890       03  HTI-BC3      PIC  9(002).                              I.990121
000900     02  HTI-ISU        PIC  9(003).                              I.000420
000910     02  F              PIC  X(001).                              I.000420
000920*****02  F              PIC  X(004).                              D.000420
000930*****  03  HTI-SU01     PIC S9(005).                              D.990121
000940*****  03  HTI-SU02     PIC S9(005).                              D.990121
000950*****  03  HTI-SU03     PIC S9(005).                              D.990121
000960*****  03  HTI-SU04     PIC S9(005).                              D.990121
000970*****  03  HTI-SU05     PIC S9(005).                              D.990121
000980*****  03  HTI-SU06     PIC S9(005).                              D.990121
000990*****  03  HTI-SU07     PIC S9(005).                              D.990121
001000*****  03  HTI-SU08     PIC S9(005).                              D.990121
001010*****  03  HTI-SU09     PIC S9(005).                              D.990121
001020*****  03  HTI-SU10     PIC S9(005).                              D.990121
001030*****02  HTI-SNO        PIC  9(001).                              D.990121
001040     COPY LSPF.
001050 WORKING-STORAGE SECTION.
001060 01  HEAD1.
001070     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
001080     02  F              PIC  N(010) VALUE
001090          NC"【Ｗチェック入力用】".
001100     02  F              PIC  X(019) VALUE SPACE.
001110     02  F              PIC  N(023) VALUE
001120          NC"＊＊＊　　履物　棚卸伝票　入力リスト　　＊＊＊".
001130     02  F              PIC  X(028) VALUE SPACE.
001140     02  F              PIC  X(005) VALUE "DATE ".
001150     02  H-DATE         PIC 99B99B99.
001160     02  F              PIC  X(007) VALUE "     P.".
001170     02  H-PAGE         PIC ZZ9.
001180 01  HEAD2.
001190     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001200     02  F              PIC  N(002) VALUE NC"倉庫".
001210     02  F              PIC  X(001) VALUE SPACE.
001220*****02  F              PIC  N(004) VALUE NC"　伝票№".           D.000420
001230*****02  F              PIC  X(010) VALUE "    ｺｰﾄﾞ  ".           D.000420
001240     02  F              PIC  N(004) VALUE NC"伝票№　".           I.000420
001250     02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             I.000420
001260     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
001270     02  F              PIC  X(025) VALUE SPACE.
001280     02  F              PIC  X(001) VALUE "(".                    I.000420
001290     02  F              PIC  N(002) VALUE NC"入数".               I.000420
001300     02  F              PIC  X(001) VALUE ")".                    I.000420
001310     02  F              PIC  X(076) VALUE SPACE.                  I.000420
001320 01  HEAD3.                                                       I.000420
001330     02  F              PIC  X(037) VALUE SPACE.                  I.000420
001340     02  F              PIC  X(001) VALUE "1".
001350     02  F              PIC  X(004) VALUE SPACE.
001360     02  F              PIC  N(002) VALUE NC"３号".
001370     02  F              PIC  X(004) VALUE SPACE.
001380     02  F              PIC  N(002) VALUE NC"２号".
001390     02  F              PIC  X(004) VALUE SPACE.
001400     02  F              PIC  N(002) VALUE NC"１号".
001410     02  F              PIC  X(004) VALUE SPACE.
001420     02  F              PIC  N(002) VALUE NC"０号".
001430     02  F              PIC  X(004) VALUE SPACE.
001440     02  F              PIC  N(002) VALUE NC"　中".
001450     02  F              PIC  X(004) VALUE SPACE.
001460     02  F              PIC  N(002) VALUE NC"　大".
001470     02  F              PIC  X(004) VALUE SPACE.
001480     02  F              PIC  N(002) VALUE NC"特大".
001490     02  F              PIC  X(003) VALUE SPACE.
001500     02  F              PIC  X(004) VALUE "28.0".
001510     02  F              PIC  X(003) VALUE SPACE.
001520     02  F              PIC  X(004) VALUE "29.0".
001530     02  F              PIC  X(003) VALUE SPACE.
001540     02  F              PIC  X(004) VALUE "30.0".
001550     02  F              PIC  X(028) VALUE SPACE.                  I.000420
001560*****02  F              PIC  X(008) VALUE SPACE.                  D.000420
001570*01  HEAD3.                                                       D.000420
001580*****02  F              PIC  X(057) VALUE SPACE.                  D.000420
001590 01  HEAD4.                                                       I.000420
001600     02  F              PIC  X(037) VALUE SPACE.                  I.000420
001610     02  F              PIC  X(001) VALUE "2".
001620     02  F              PIC  X(003) VALUE SPACE.
001630     02  F              PIC  X(004) VALUE "12.5".
001640     02  F              PIC  X(003) VALUE SPACE.
001650     02  F              PIC  X(004) VALUE "13.0".
001660     02  F              PIC  X(003) VALUE SPACE.
001670     02  F              PIC  X(004) VALUE "13.5".
001680     02  F              PIC  X(003) VALUE SPACE.
001690     02  F              PIC  X(004) VALUE "14.0".
001700     02  F              PIC  X(003) VALUE SPACE.
001710     02  F              PIC  X(004) VALUE "15.0".
001720     02  F              PIC  X(003) VALUE SPACE.
001730     02  F              PIC  X(004) VALUE "16.0".
001740     02  F              PIC  X(003) VALUE SPACE.
001750     02  F              PIC  X(004) VALUE "17.0".
001760     02  F              PIC  X(003) VALUE SPACE.
001770     02  F              PIC  X(004) VALUE "18.0".
001780     02  F              PIC  X(003) VALUE SPACE.
001790     02  F              PIC  X(004) VALUE "19.0".
001800     02  F              PIC  X(003) VALUE SPACE.
001810     02  F              PIC  X(004) VALUE "20.0".
001820     02  F              PIC  X(028) VALUE SPACE.                  I.000420
001830*****02  F              PIC  X(008) VALUE SPACE.                  D.000420
001840*01  HEAD4.                                                       D.000420
001850*****02  F              PIC  X(057) VALUE SPACE.                  D.000420
001860 01  HEAD5.                                                       I.000420
001870     02  F              PIC  X(037) VALUE SPACE.                  I.000420
001880     02  F              PIC  X(001) VALUE "3".
001890     02  F              PIC  X(003) VALUE SPACE.
001900     02  F              PIC  X(004) VALUE "21.0".
001910     02  F              PIC  X(003) VALUE SPACE.
001920     02  F              PIC  X(004) VALUE "21.5".
001930     02  F              PIC  X(003) VALUE SPACE.
001940     02  F              PIC  X(004) VALUE "22.0".
001950     02  F              PIC  X(003) VALUE SPACE.
001960     02  F              PIC  X(004) VALUE "22.5".
001970     02  F              PIC  X(003) VALUE SPACE.
001980     02  F              PIC  X(004) VALUE "23.0".
001990     02  F              PIC  X(003) VALUE SPACE.
002000     02  F              PIC  X(004) VALUE "23.5".
002010     02  F              PIC  X(003) VALUE SPACE.
002020     02  F              PIC  X(004) VALUE "24.0".
002030     02  F              PIC  X(003) VALUE SPACE.
002040     02  F              PIC  X(004) VALUE "24.5".
002050     02  F              PIC  X(003) VALUE SPACE.
002060     02  F              PIC  X(004) VALUE "25.0".
002070     02  F              PIC  X(035) VALUE SPACE.                  I.000420
002080*****02  F              PIC  X(015) VALUE SPACE.                  D.000420
002090*01  HEAD5.                                                       D.000420
002100*****02  F              PIC  X(057) VALUE SPACE.                  D.000420
002110 01  HEAD6.                                                       I.000420
002120     02  F              PIC  X(037) VALUE SPACE.                  I.000420
002130     02  F              PIC  X(001) VALUE "4".
002140     02  F              PIC  X(003) VALUE SPACE.
002150     02  F              PIC  X(004) VALUE "24.0".
002160     02  F              PIC  X(003) VALUE SPACE.
002170     02  F              PIC  X(004) VALUE "24.5".
002180     02  F              PIC  X(003) VALUE SPACE.
002190     02  F              PIC  X(004) VALUE "25.0".
002200     02  F              PIC  X(003) VALUE SPACE.
002210     02  F              PIC  X(004) VALUE "25.5".
002220     02  F              PIC  X(003) VALUE SPACE.
002230     02  F              PIC  X(004) VALUE "26.0".
002240     02  F              PIC  X(003) VALUE SPACE.
002250     02  F              PIC  X(004) VALUE "26.5".
002260     02  F              PIC  X(003) VALUE SPACE.
002270     02  F              PIC  X(004) VALUE "27.0".
002280     02  F              PIC  X(003) VALUE SPACE.
002290     02  F              PIC  X(004) VALUE "27.5".
002300     02  F              PIC  X(016) VALUE SPACE.
002310     02  F              PIC  N(004) VALUE NC"ケース計".           I.000420
002320     02  F              PIC  X(004) VALUE SPACE.                  I.000420
002330     02  F              PIC  N(004) VALUE NC"足数合計".           I.000420
002340     02  F              PIC  X(004) VALUE SPACE.                  I.000420
002350     02  F              PIC  N(004) VALUE NC"　総合計".           I.000420
002360*****02  F              PIC  N(004) VALUE NC"　合　計".           D.000420
002370*01  W-P.                                                         D.000420
002380 01  W-P1.                                                        I.000420
002390     02  F              PIC  X(001).
002400     02  P-SNO          PIC  9(001).
002410*****02  F              PIC  X(002).                              D.000420
002420     02  F              PIC  X(001).                              I.000420
002430     02  P-DNO1         PIC  9(002).
002440     02  P-V            PIC  X(001).
002450     02  P-DNO2         PIC  X(004).
002460*****02  F              PIC  X(002).                              D.000420
002470     02  F              PIC  X(001).                              I.000420
002480     02  P-HCD          PIC  9(006).
002490     02  F              PIC  X(001).
002500     02  P-NAME         PIC  N(024).
002510     02  F              PIC  X(001).                              I.000420
002520     02  P-F            PIC  X(001).                              I.000420
002530     02  P-ISU          PIC ZZZ.                                  I.000420
002540     02  P-R            PIC  X(001).                              I.000420
002550     02  F              PIC  X(076).                              I.000420
002560*****02  F              PIC  X(001).                              D.000420
002570 01  W-P2.                                                        I.000420
002580     02  F              PIC  X(028).                              I.000420
002590     02  P-SM           PIC  N(006).                              I.000420
002600     02  P-SIZ          PIC  9(001).
002610     02  P-SUD.
002620       03  P-SU         PIC ---,--9  OCCURS  10.
002630     02  P-KST          PIC ----,--9.                             I.000420
002640     02  P-SST          PIC --,---,--9.                           I.000420
002650     02  P-ASU          PIC --,---,--9.                           I.000420
002660*****02  P-SUG          PIC ----,--9.                             D.000420
002670 01  W-RD.
002680     02  W-SUD1.
002690       03  W-SU1        PIC S9(006)  OCCURS  10.                  I.990224
002700*****  03  W-SU1        PIC S9(005)  OCCURS  10.                  D.990204
002710     02  W-SUD2.
002720       03  W-SU2        PIC S9(006)  OCCURS  10.                  I.990204
002730*****  03  W-SU2        PIC S9(005)  OCCURS  10.                  D.990204
002740     02  W-SUD3.
002750       03  W-SU3        PIC S9(006)  OCCURS  10.                  I.990204
002760*****  03  W-SU3        PIC S9(005)  OCCURS  10.                  D.990204
002770     02  W-SUD4.
002780       03  W-SU4        PIC S9(006)  OCCURS  10.                  I.990204
002790     02  W-SUD5.                                                  I.000420
002800       03  W-SU5        PIC S9(006)  OCCURS  10.                  I.000420
002810     02  W-SUD6.                                                  I.000420
002820       03  W-SU6        PIC S9(006)  OCCURS  10.                  I.000420
002830     02  W-SUD7.                                                  I.000420
002840       03  W-SU7        PIC S9(006)  OCCURS  10.                  I.000420
002850     02  W-SUD8.                                                  I.000420
002860       03  W-SU8        PIC S9(006)  OCCURS  10.                  I.000420
002870     02  W-SUG.                                                   I.000420
002880       03  W-KST        PIC S9(006).                              I.000420
002890       03  W-SST        PIC S9(007).                              I.000420
002900       03  W-HST        PIC S9(007).                              I.000420
002910       03  W-ASU        PIC S9(007).                              I.000420
002920*****  03  W-SU4        PIC S9(005)  OCCURS  10.                  D.990204
002930*****02  W-SUG          PIC S9(006).                              D.000420
002940 01  W-SUD.
002950     02  W-SU           PIC S9(006)  OCCURS  10.                  I.990204
002960*****02  W-SU           PIC S9(005)  OCCURS  10.                  D.990204
002970 01  W-SSD.
002980     02  W-SS           PIC  9(001)  OCCURS  10.
002990 01  W-DATA.
003000     02  W-SNO          PIC  9(001).
003010     02  W-SN           PIC  N(006).
003020     02  W-DNO          PIC  X(006).
003030     02  W-DNOD  REDEFINES W-DNO.
003040       03  W-DNO1       PIC  9(002).
003050       03  W-DNO2.
003060         04  W-DNO21    PIC  9(003).
003070         04  W-DNO22    PIC  X(001).
003080     02  W-HCD          PIC  9(006) VALUE ZERO.
003090     02  W-PAGE         PIC  9(003) VALUE ZERO.
003100     02  CNT            PIC  9(002).
003110     02  W-L            PIC  9(002).
003120     02  W-C            PIC  9(002).
003130     02  W-SC           PIC  9(001).
003140     02  W-ZC           PIC  9(001).
003150     02  W-SUF          PIC S9(006).                              I.000420
003160     02  CHK.
003170       03  CHK1         PIC  9(001).
003180       03  CHK2         PIC  9(001).
003190     02  W-ACT          PIC  9(001) VALUE ZERO.
003200     02  W-DMM          PIC  9(001).
003210     02  W-PC           PIC  9(001).
003220     02  W-SE.
003230       03  W-SDNO       PIC  X(006).
003240       03  W-EDNO       PIC  X(006) VALUE "999999".               I.151106
003250*****  03  W-EDNO       PIC  X(006).                              D.151106
003260     02  W-POC          PIC  9(001) VALUE ZERO.
003270     02  W-TC           PIC  9(001).                              I.000420
003280     02  W-TCD          PIC  9(001).                              I.000420
003290 01  ERR-STAT           PIC  X(002).
003300     COPY LSTAT.
003310 SCREEN SECTION.
003320 SD  C-CRT
003330     END STATUS IS ESTAT.
003340 01  C-CLEAR.
003350     02  LINE  1  CLEAR SCREEN.
003360 01  C-MID.
003370     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
003380          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003390     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
003400          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
003410     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
003420          NC"＊＊＊　　履物　棚卸伝票　入力リスト　　＊＊＊".
003430     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
003440          NC"＊＊＊　　　　Ｗチェック入力用　　　　　＊＊＊".
003450     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
003460          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003470     02  LINE  12  COLUMN  15  PIC  X(036) VALUE
003480          "作表  :  する=1  しない=9 ..... ﾘﾀｰﾝ".
003490     02  LINE  15  COLUMN  21  PIC  X(024) VALUE
003500          "伝票№         ～ 999999".
003510*****02  LINE  22  COLUMN  29  PIC  X(022) VALUE                  D.000420
003520     02  LINE  23  COLUMN  40  PIC  X(022) VALUE                  I.000420
003530          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003540 01  C-ACP.
003550*****02  A-ACT   LINE   3  COLUMN  51  PIC  9(001)                D.000420
003560     02  A-ACT   LINE   1  COLUMN  60  PIC  9(001)                I.000420
003570          USING W-ACT   CHECK OVERFLOW NO IFC.
003580*****02  LINE   6.                                                D.000420
003590     02  LINE   3.                                                D.000420
003600       03  A-SNO   COLUMN   2  PIC  9(001)
003610            USING W-SNO   CHECK OVERFLOW NO IFC.
003620       03  A-DNO1  COLUMN  17  PIC  9(002)
003630            USING W-DNO1  CHECK OVERFLOW NO IFC.
003640       03  A-DNO2  COLUMN  20  PIC  X(004)
003650            USING W-DNO2  CHECK OVERFLOW NO IFC.
003660       03  A-HCD   COLUMN  25  PIC  9(006)
003670            USING W-HCD   CHECK OVERFLOW NO IFC.
003680     02  A-SU    LINE W-L  COLUMN W-C  PIC S9(005)
003690          USING W-SU(CNT)  CHECK OVERFLOW NO IFC.
003700     02  A-PC    LINE  12  COLUMN  46  PIC  9(001)
003710          USING W-PC    CHECK OVERFLOW NO IFC.
003720     02  LINE  15.
003730       03  A-SDNO  COLUMN  29  PIC  X(006)
003740            USING W-SDNO  CHECK OVERFLOW NO IFC.
003750       03  A-EDNO  COLUMN  39  PIC  X(006)
003760            USING W-EDNO  CHECK OVERFLOW NO IFC.
003770*****02  A-DMM   LINE  22  COLUMN  46  PIC  9(001)                D.000420
003780     02  A-DMM   LINE  23  COLUMN  57  PIC  9(001)                I.000420
003790          USING W-DMM   CHECK OVERFLOW NO IFC.
003800 01  C-DSP.
003810     02  D-WCM   LINE   1  COLUMN  70  PIC  N(004) VALUE
003820          NC"Ｗ入力用" REVERSE.
003830*****02  LINE   6.                                                D.000420
003840     02  LINE   3.                                                D.000420
003850       03  D-SN    COLUMN   4  PIC  N(006) FROM  W-SN.
003860       03  D-NAME  COLUMN  32  PIC  N(024) FROM  HI-NAME.         I.010806
003870     02  D-ISU   LINE   4  COLUMN  76  PIC ZZ9 FROM  HI-ISU.      I.010806
003880*****  03  D-NAME  COLUMN  32  PIC  N(024) FROM  SHM-02.          D.010806
003890*****02  D-ISU   LINE   4  COLUMN  76  PIC ZZ9 FROM  SHM-07.      D.010806
003900*****  03  D-NAME  COLUMN  32  PIC  N(024) FROM  HI-NAME.         D.000420
003910     02  LINE W-L.
003920       03  D-SU    COLUMN W-C  PIC ZZZZ9-  FROM  W-SU(CNT).
003930       03  S-SU    COLUMN W-C  PIC  X(006) VALUE "      ".
003940     02  D-SUG.                                                   I.000420
003950       03  D-KT.                                                  I.000420
003960         04  LINE  10  COLUMN  73  PIC  ZZZZZ9- FROM  W-KST.      I.000420
003970         04  LINE  12  COLUMN  72  PIC ZZZZZZ9- FROM  W-SST.      I.000420
003980       03  D-AT.                                                  I.000420
003990         04  LINE  21  COLUMN  72  PIC ZZZZZZ9-   FROM  W-HST.    I.000420
004000         04  LINE  22  COLUMN  70  PIC Z,ZZZ,ZZ9- FROM  W-ASU.    I.000420
004010*****02  D-SUG   LINE  20  COLUMN  64  PIC Z,ZZZ,ZZ9- FROM  W-SUG.D.000420
004020 01  C-ERR.
004030     02  LINE  24.
004040       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
004050       03  E-ME1   COLUMN  15  PIC  X(025) VALUE
004060            "***  ﾄｳﾛｸ ｽﾞﾐ  ***       ".
004070       03  E-ME2   COLUMN  15  PIC  X(025) VALUE
004080            "***  ﾐﾄｳﾛｸ  ***          ".
004090       03  E-ME3   COLUMN  15  PIC  X(025) VALUE
004100            "***  ｿｳｺ ﾅｼ  ***         ".
004110       03  E-ME4   COLUMN  15  PIC  X(025) VALUE
004120            "***  HIM ﾅｼ  ***         ".
004130       03  E-ME5   COLUMN  15  PIC  X(025) VALUE
004140            "***  DATA ZERO  ***      ".
004150*****  03  E-ME6   COLUMN  15  PIC  X(024) VALUE                  D.000508
004160*****       "***  ﾀﾝｶ ZERO  ***      ".                           D.000508
004170*****  03  E-ME7   COLUMN  15  PIC  X(025) VALUE                  D.010806
004180*****       "***  SHM ﾅｼ  ***         ".                          D.010806
004190       03  E-ME8   COLUMN  15  PIC  X(025) VALUE                  I.090318
004200            "***  ｲﾘｽｳ ﾅｼ  ***        ".                          I.090318
004210       03  E-ME11  COLUMN  15  PIC  X(025) VALUE
004220            "***  WRITE ｴﾗｰ  ***      ".
004230       03  E-ME12  COLUMN  15  PIC  X(025) VALUE
004240            "***  REWRITE ｴﾗｰ  ***    ".
004250       03  E-ME13  COLUMN  15  PIC  X(025) VALUE
004260            "***  DELETE ｴﾗｰ  ***     ".
004270       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".
004280       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
004290       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
004300       03  E-KEY   COLUMN  45  PIC  X(007) FROM  HTI-KEY.
004310       03  E-CL.
004320         04  COLUMN  1  PIC  X(040) VALUE
004330              "                                        ".
004340         04  COLUMN 41  PIC  X(040) VALUE
004350              "                                        ".
004360     COPY LIBSCR.
004370 PROCEDURE DIVISION.
004380 M-020.
004390     COPY LIBCPR.
004400     MOVE DATE-02R TO H-DATE.
004410     OPEN INPUT HI-M.
004420*****OPEN INPUT SHM.                                              D.010806
004430     OPEN I-O HTI-M.
004440 M-040.
004450     DISPLAY C-CLEAR.
004460     CALL "SCHN11".
004470     DISPLAY D-WCM.
004480     IF W-ACT NOT = 0
004490         DISPLAY A-ACT.
004500 M-060.
004510     ACCEPT A-ACT.
004520     IF ESTAT NOT = HTB AND SKP
004530         GO TO M-060.
004540     IF W-ACT = 9
004550         CLOSE HTI-M
004560*****    CLOSE SHM                                                D.010806
004570         CLOSE HI-M
004580         DISPLAY C-CLEAR
004590         DISPLAY C-MID
004600         GO TO M-700.
004610     IF W-ACT NOT = 1 AND 2 AND 3
004620         GO TO M-060.
004630     IF W-ACT = 2 OR 3
004640         GO TO M-120.
004650 M-100.
004660     ACCEPT A-SNO.
004670     DISPLAY E-CL.
004680     IF ESTAT = BTB
004690         IF W-ACT = 2
004700             GO TO M-160
004710           ELSE
004720             GO TO M-060.
004730     IF ESTAT NOT = HTB AND SKP
004740         GO TO M-100.
004750     MOVE SPACE TO W-SN.
004760     OPEN INPUT JCON.
004770     MOVE 3 TO JCON3-01.
004780     MOVE W-SNO TO JCON3-02.
004790     READ JCON WITH UNLOCK INVALID KEY
004800         DISPLAY E-ME3 E-ME98
004810         CLOSE JCON
004820         GO TO M-100.
004830     MOVE JCON3-03 TO W-SN.
004840     CLOSE JCON.
004850     DISPLAY D-SN.
004860     IF W-SNO NOT = 6                                             ++++++++
004870         GO TO M-100.                                             ++++++++
004880     IF W-ACT = 2
004890         GO TO M-200.
004900 M-120.
004910     ACCEPT A-DNO1.
004920     DISPLAY E-CL.
004930     IF ESTAT = BTB
004940         IF W-ACT = 1
004950             GO TO M-100
004960           ELSE
004970             GO TO M-060.
004980     IF ESTAT NOT = HTB AND SKP
004990         GO TO M-120.
005000 M-140.
005010     CALL "SCHN11".
005020     DISPLAY D-WCM.
005030     DISPLAY A-ACT A-DNO1.
005040     IF W-ACT = 1
005050         DISPLAY A-SNO D-SN.
005060 M-160.
005070     ACCEPT A-DNO2.
005080     DISPLAY E-CL.
005090     IF ESTAT = BTB
005100         GO TO M-120.
005110     IF ESTAT NOT = HTB AND SKP
005120         GO TO M-160.
005130     IF W-DNO21 NOT NUMERIC
005140         GO TO M-160.
005150*
005160     MOVE SPACE TO HTI-KEY.
005170     MOVE W-DNO TO HTI-DNO.
005180     START HTI-M KEY NOT < HTI-KEY INVALID KEY
005190         GO TO M-180.
005200     READ HTI-M NEXT RECORD WITH UNLOCK AT END
005210         GO TO M-180.
005220     IF HTI-DNO NOT = W-DNO
005230         GO TO M-180.
005240*
005250     PERFORM DSP-RTN THRU DSP-EX.
005260     IF W-KST NOT = ZERO                                          I.090318
005270         IF HI-ISU = ZERO                                         I.090318
005280             DISPLAY E-ME8 E-ME99                                 I.090318
005290             GO TO M-160.                                         I.090318
005300     IF W-ACT = 1
005310         DISPLAY E-ME1 E-ME99
005320         GO TO M-140.
005330     IF W-ACT = 3
005340         GO TO M-500.
005350     GO TO M-100.
005360 M-180.
005370     IF W-ACT NOT = 1
005380         DISPLAY E-ME2 E-ME98
005390         GO TO M-160.
005400     MOVE ZERO TO W-RD.
005410 M-200.
005420     ACCEPT A-HCD.
005430     DISPLAY E-CL.
005440     IF ESTAT = BTB
005450         IF W-ACT = 2
005460             GO TO M-100
005470           ELSE
005480             GO TO M-160.
005490     IF ESTAT NOT = HTB AND SKP
005500         GO TO M-200.
005510*****MOVE W-HCD TO HI-KEY.                                        D.000420
005520*****READ HI-M WITH UNLOCK INVALID KEY                            D.000420
005530*****    DISPLAY E-ME4 E-ME98                                     D.000420
005540*****MOVE W-HCD TO SHM-KEY.                                       D.010806
005550*****READ SHM WITH UNLOCK INVALID KEY                             D.010806
005560*****    DISPLAY E-ME7 E-ME98                                     D.010806
005570*****    GO TO M-200.                                             D.010806
005580     MOVE W-HCD TO HI-KEY.
005590     READ HI-M WITH UNLOCK INVALID KEY
005600         DISPLAY E-ME4 E-ME98
005610         GO TO M-200.
005620     DISPLAY D-NAME D-ISU.                                        I.000420
005630     IF HI-BC3 = 30                                               ++++++++
005640         GO TO M-200.                                             ++++++++
005650*****DISPLAY D-NAME.                                              D.000420
005660     IF W-HCD > 999899
005670         GO TO M-200.
005680*****IF HI-FT = ZERO                                              D.000508
005690*****    DISPLAY E-ME6 E-ME98                                     D.000508
005700*****    GO TO M-200.                                             D.000508
005710 M-220.
005720     MOVE ZERO TO W-SC CHK.
005730 M-240.
005740     ADD 1 TO W-SC.
005750*****IF W-SC = 5                                                  D.090318
005760     IF W-SC NOT = 5                                              I.090318
005770         GO TO M-250.                                             I.090318
005780     PERFORM KEI-RTN THRU KEI-EX.                                 I.000420
005790     IF W-KST NOT = ZERO                                          I.090318
005800         IF HI-ISU = ZERO                                         I.090318
005810             DISPLAY E-ME8 E-ME99                                 I.090318
005820             GO TO M-220.                                         I.090318
005830 M-250.                                                           I.090318
005840     IF W-SC = 9                                                  I.000420
005850         GO TO M-420.                                             I.000420
005860*****    GO TO M-400.                                             D.000420
005870     MOVE ZERO TO CHK1.
005880     PERFORM FST-RTN THRU FST-EX.
005890 M-260.
005900*****MOVE 5 TO W-C.                                               D.000420
005910     MOVE 2 TO W-C.                                               I.000420
005920     MOVE ZERO TO CNT.
005930 M-280.
005940     ADD 1 TO CNT.
005950     IF CNT = 11
005960         GO TO M-300.
005970     IF W-SS(CNT) = 0
005980         MOVE ZERO TO W-SU(CNT)
005990         DISPLAY S-SU
006000         GO TO M-340.
006010     IF 9 = CHK1 OR CHK2
006020         MOVE ZERO TO W-SU(CNT)
006030         DISPLAY D-SU
006040         GO TO M-340.
006050     GO TO M-320.
006060 M-300.
006070     PERFORM RST-RTN THRU RST-EX.
006080     GO TO M-240.
006090 M-320.
006100     MOVE W-SU(CNT) TO W-SUF.                                     I.000420
006110     ACCEPT A-SU.
006120     DISPLAY E-CL.
006130     IF ESTAT = BTB
006140         GO TO M-360.
006150*****IF ESTAT = ADV                                               D.000420
006160     IF ESTAT = PF6                                               I.000420
006170         MOVE 9 TO CHK1
006180         GO TO M-260.
006190*****IF ESTAT = C1                                                D.000420
006200     IF ESTAT = ADV                                               I.000420
006210         MOVE 9 TO CHK2
006220         MOVE ZERO TO W-SU(CNT)
006230         DISPLAY D-SU
006240         GO TO M-340.
006250     IF ESTAT = PF7                                               I.000420
006260         GO TO M-400.                                             I.000420
006270     IF ESTAT NOT = HTB AND SKP
006280         GO TO M-320.
006290     DISPLAY D-SU.
006300 M-340.
006310     ADD 7 TO W-C.
006320     GO TO M-280.
006330 M-360.
006340     SUBTRACT 1 FROM CNT.
006350     IF CNT = ZERO
006360         GO TO M-380.
006370     SUBTRACT 7 FROM W-C.
006380     IF W-SS(CNT) = 0
006390         GO TO M-360.
006400     GO TO M-320.
006410 M-380.
006420     PERFORM RST-RTN THRU RST-EX.
006430     SUBTRACT 1 FROM W-SC.
006440     IF W-SC = ZERO
006450         GO TO M-200.
006460     PERFORM FST-RTN THRU FST-EX.
006470     MOVE 11 TO CNT.
006480     MOVE 72 TO W-C.                                              I.000420
006490*****MOVE 75 TO W-C.                                              D.000420
006500     GO TO M-360.
006510 M-400.
006520     MOVE W-SUF TO W-SU(CNT).                                     I.000420
006530     DISPLAY D-SU.                                                I.000420
006540     PERFORM RST-RTN THRU RST-EX.                                 I.000420
006550     PERFORM KEI-RTN THRU KEI-EX.                                 I.000420
006560     IF W-KST NOT = ZERO                                          I.090318
006570         IF HI-ISU = ZERO                                         I.090318
006580             DISPLAY E-ME8 E-ME99                                 I.090318
006590             GO TO M-220.                                         I.090318
006600     IF W-SC > 4                                                  I.000420
006610         GO TO M-220                                              I.000420
006620       ELSE                                                       I.000420
006630         MOVE ZERO TO CHK                                         I.010502
006640*****    MOVE 5 TO W-SC                                           D.010502
006650         MOVE 4 TO W-SC                                           I.010502
006660         GO TO M-240.                                             I.000420
006670*****MOVE ZERO TO W-SUG CNT CHK.                                  D.000420
006680 M-420.
006690*****ADD 1 TO CNT.                                                D.000420
006700*****IF CNT = 11                                                  D.000420
006710*****    DISPLAY D-SUG                                            D.000420
006720*****    IF W-SUG = ZERO                                          D.000420
006730     PERFORM KEI-RTN THRU KEI-EX.                                 I.000420
006740     IF W-ASU = ZERO                                              I.000420
006750         DISPLAY E-ME5 E-ME98
006760         GO TO M-220.                                             I.000420
006770*****    GO TO M-220                                              D.000420
006780*****  ELSE                                                       D.000420
006790*****    GO TO M-500.                                             D.000420
006800*****ADD W-SU1(CNT) TO W-SUG.                                     D.000420
006810*****ADD W-SU2(CNT) TO W-SUG.                                     D.000420
006820*****ADD W-SU3(CNT) TO W-SUG.                                     D.000420
006830*****ADD W-SU4(CNT) TO W-SUG.                                     D.000420
006840*****GO TO M-420.                                                 D.000420
006850 M-500.
006860     ACCEPT A-DMM.
006870     DISPLAY E-CL.
006880     IF ESTAT = BTB
006890         IF W-ACT = 3
006900             GO TO M-160
006910           ELSE
006920*****        MOVE 4 TO W-SC                                       D.000420
006930*****        MOVE 75 TO W-C                                       D.000420
006940             MOVE ZERO TO CHK                                     I.000429
006950             MOVE 8 TO W-SC                                       I.000420
006960             MOVE 72 TO W-C                                       I.000420
006970             GO TO M-360.
006980     IF ESTAT NOT = HTB AND SKP
006990         GO TO M-500.
007000     IF W-DMM = 9
007010         IF W-ACT = 3
007020             GO TO M-160
007030           ELSE
007040             GO TO M-220.
007050     IF W-DMM NOT = 1
007060         GO TO M-500.
007070*
007080     IF W-ACT = 3
007090         GO TO M-620.
007100     MOVE ZERO TO W-SC.
007110 M-520.
007120     ADD 1 TO W-SC.
007130*****IF W-SC = 5                                                  D.000420
007140     IF W-SC = 9                                                  I.000420
007150         GO TO M-140.
007160     MOVE ZERO TO W-SUD CNT W-ZC.
007170     IF W-SC = 1
007180         MOVE W-SUD1 TO W-SUD.
007190     IF W-SC = 2
007200         MOVE W-SUD2 TO W-SUD.
007210     IF W-SC = 3
007220         MOVE W-SUD3 TO W-SUD.
007230     IF W-SC = 4
007240         MOVE W-SUD4 TO W-SUD.
007250     IF W-SC = 5                                                  I.000420
007260         MOVE W-SUD5 TO W-SUD.                                    I.000420
007270     IF W-SC = 6                                                  I.000420
007280         MOVE W-SUD6 TO W-SUD.                                    I.000420
007290     IF W-SC = 7                                                  I.000420
007300         MOVE W-SUD7 TO W-SUD.                                    I.000420
007310     IF W-SC = 8                                                  I.000420
007320         MOVE W-SUD8 TO W-SUD.                                    I.000420
007330 M-540.
007340     ADD 1 TO CNT.
007350     IF CNT = 11
007360         GO TO M-560.
007370     IF W-SU(CNT) = ZERO
007380         GO TO M-540.
007390     MOVE 5 TO W-ZC.
007400 M-560.
007410     MOVE W-DNO TO HTI-DNO.
007420     MOVE W-SC TO HTI-GNO.
007430     READ HTI-M INVALID KEY
007440         GO TO M-600.
007450*
007460     IF W-ZC = 0
007470         GO TO M-580.
007480     MOVE W-HCD TO HTI-HCD.
007490     IF HTI-GNO > 4                                               I.000420
007500         COMPUTE HTI-SIZ = HTI-GNO - 3                            I.000420
007510       ELSE                                                       I.000420
007520         COMPUTE HTI-SIZ = HTI-GNO + 1.                           I.990204
007530     IF HTI-SIZ = 5                                               I.990204
007540         MOVE 1 TO HTI-SIZ.                                       I.990204
007550     MOVE W-SUD TO HTI-SUD.
007560     MOVE W-SNO TO HTI-SNO.
007570     MOVE HI-BC TO HTI-BC.                                        I.990204
007580     MOVE HI-ISU TO HTI-ISU.                                      I.010806
007590*****MOVE SHM-07 TO HTI-ISU.                                      D.010806
007600     REWRITE HTI-R INVALID KEY
007610         DISPLAY E-ME78 E-STAT E-ME12 E-KEY E-ME99
007620         GO TO M-960.
007630     GO TO M-520.
007640 M-580.
007650     DELETE HTI-M INVALID KEY
007660         DISPLAY E-ME78 E-STAT E-ME13 E-KEY E-ME99
007670         GO TO M-960.
007680     CALL "CBLTCLS" USING HTI-M.
007690     GO TO M-520.
007700 M-600.
007710     IF W-ZC = ZERO
007720         GO TO M-520.
007730     INITIALIZE HTI-R.
007740     MOVE W-DNO TO HTI-DNO.
007750     MOVE W-SC TO HTI-GNO.
007760     MOVE W-HCD TO HTI-HCD.
007770     IF HTI-GNO > 4                                               I.000420
007780         COMPUTE HTI-SIZ = HTI-GNO - 3                            I.000420
007790       ELSE                                                       I.000420
007800         COMPUTE HTI-SIZ = HTI-GNO + 1.                           I.990204
007810     IF HTI-SIZ = 5                                               I.990204
007820         MOVE 1 TO HTI-SIZ.                                       I.990204
007830     MOVE W-SUD TO HTI-SUD.
007840     MOVE W-SNO TO HTI-SNO.
007850     MOVE HI-BC TO HTI-BC.                                        I.990204
007860     MOVE HI-ISU TO HTI-ISU.                                      I.010806
007870*****MOVE SHM-07 TO HTI-ISU.                                      D.010806
007880     WRITE HTI-R INVALID KEY
007890         DISPLAY E-ME78 E-STAT E-ME11 E-KEY E-ME99
007900         GO TO M-960.
007910     CALL "CBLTCLS" USING HTI-M.
007920     GO TO M-520.
007930 M-620.
007940     MOVE SPACE TO HTI-KEY.
007950     MOVE W-DNO TO HTI-DNO.
007960     START HTI-M KEY NOT < HTI-KEY INVALID KEY
007970         GO TO M-040.
007980 M-640.
007990     READ HTI-M NEXT RECORD AT END
008000         GO TO M-040.
008010     IF HTI-DNO NOT = W-DNO
008020         GO TO M-040.
008030     DELETE HTI-M INVALID KEY
008040         DISPLAY E-ME78 E-STAT E-ME13 E-KEY E-ME99
008050         GO TO M-960.
008060     CALL "CBLTCLS" USING HTI-M.
008070     GO TO M-640.
008080 M-700.
008090     ACCEPT A-PC.
008100     IF ESTAT NOT = HTB AND SKP
008110         GO TO M-700.
008120     IF W-PC = 9
008130         GO TO M-760.
008140     IF W-PC NOT = 1
008150         GO TO M-700.
008160 M-720.
008170     ACCEPT A-SDNO.
008180     IF ESTAT = BTB
008190         GO TO M-700.
008200     IF ESTAT NOT = HTB AND SKP
008210         GO TO M-720.
008220 M-740.
008230     ACCEPT A-EDNO.
008240     IF ESTAT = BTB
008250         GO TO M-720.
008260     IF ESTAT NOT = HTB AND SKP
008270         GO TO M-740.
008280     IF W-SDNO > W-EDNO
008290         GO TO M-740.
008300 M-760.
008310     ACCEPT A-DMM.
008320     IF ESTAT = BTB
008330         IF W-PC = 9
008340             GO TO M-700
008350           ELSE
008360             GO TO M-740.
008370     IF ESTAT = HTB AND SKP
008380         GO TO M-760.
008390     IF W-DMM = 9
008400         GO TO M-700.
008410     IF W-DMM NOT = 1
008420         GO TO M-760.
008430     IF W-PC = 9
008440         GO TO M-980.
008450*
008460     OPEN INPUT HTI-M.
008470     OPEN INPUT HI-M.                                             I.020502
008480*****OPEN INPUT HI-M.                                             D.000420
008490*****OPEN INPUT SHM.                                              D.010806
008500     MOVE SPACE TO HTI-KEY.
008510     MOVE W-SDNO TO HTI-DNO.
008520     START HTI-M KEY NOT < HTI-KEY INVALID KEY
008530         DISPLAY E-ME2 E-ME99
008540         GO TO M-960.
008550     READ HTI-M NEXT RECORD WITH UNLOCK AT END
008560         DISPLAY E-ME2 E-ME99
008570         GO TO M-960.
008580     IF HTI-DNO > W-EDNO
008590         DISPLAY E-ME2 E-ME99
008600         GO TO M-960.
008610     MOVE 5 TO W-POC.
008620     OPEN OUTPUT SP-F.
008630     PERFORM MID-010 THRU MID-EX.
008640 M-780.
008650     MOVE HTI-SNO TO W-SNO.
008660     MOVE ZERO TO CHK.
008670 M-800.
008680     MOVE HTI-DNO TO W-DNO.
008690     MOVE ZERO TO W-SUG.                                          I.000420
008700*****MOVE ZERO TO W-SUG CHK2.                                     D.000420
008710     MOVE HTI-HCD TO W-HCD.
008720*****MOVE W-HCD TO SHM-KEY.                                       D.010806
008730*****READ SHM WITH UNLOCK INVALID KEY                             D.010806
008740*****    MOVE ZERO TO SHM-07                                      D.010806
008750*****    MOVE SPACE TO SHM-02                                     D.010806
008760*****    MOVE ALL "1" TO SHM-04                                   D.010806
008770*****    MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO SHM-02.   D.010806
008780     MOVE W-HCD TO HI-KEY.                                        I.010806
008790     READ HI-M WITH UNLOCK INVALID KEY                            I.010806
008800         MOVE ZERO TO HI-ISU                                      I.010806
008810         MOVE SPACE TO HI-NAME                                    I.010806
008820         MOVE ALL "1" TO HI-ASSD                                  I.010806
008830         MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.  I.010806
008840     PERFORM PR1-RTN THRU PR1-EX.                                 I.000420
008850 M-810.                                                           I.000420
008860     IF HTI-GNO < 5                                               I.000420
008870         MOVE 1 TO W-TC                                           I.000420
008880       ELSE                                                       I.000420
008890         MOVE 2 TO W-TC.                                          I.000420
008900     MOVE 0 TO W-TCD.                                             I.000420
008910*****MOVE W-HCD TO HI-KEY.                                        D.000420
008920*****READ HI-M WITH UNLOCK INVALID KEY                            D.000420
008930*****    MOVE SPACE TO HI-NAME                                    D.000420
008940*****    MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.  D.000420
008950 M-820.
008960     MOVE ZERO TO W-SSD.                                          I.000429
008970     IF HTI-SIZ = 1                                               I.000429
008980         MOVE HI-SS1 TO W-SSD.                                    I.010806
008990*****    MOVE SHM-041 TO W-SSD.                                   D.010806
009000     IF HTI-SIZ = 2                                               I.000429
009010         MOVE HI-SS2 TO W-SSD.                                    I.010806
009020*****    MOVE SHM-042 TO W-SSD.                                   D.010806
009030     IF HTI-SIZ = 3                                               I.000429
009040         MOVE HI-SS3 TO W-SSD.                                    I.010806
009050*****    MOVE SHM-043 TO W-SSD.                                   D.010806
009060     IF HTI-SIZ = 4                                               I.000429
009070         MOVE HI-SS4 TO W-SSD.                                    I.010806
009080*****    MOVE SHM-044 TO W-SSD.                                   D.010806
009090*****MOVE SPACE TO W-P.                                           D.000420
009100*****MOVE SPACE TO P-NAME.                                        D.000420
009110*****IF CHK1 = 0                                                  D.000420
009120*****    MOVE 5 TO CHK1                                           D.000420
009130*****    MOVE W-SNO TO P-SNO.                                     D.000420
009140*****IF CHK2 = 0                                                  D.000420
009150*****    MOVE 5 TO CHK2                                           D.000420
009160*****    MOVE W-DNO1 TO P-DNO1                                    D.000420
009170*****    MOVE "-" TO P-V                                          D.000420
009180*****    MOVE W-DNO2 TO P-DNO2                                    D.000420
009190*****    MOVE W-HCD TO P-HCD                                      D.000420
009200*****    MOVE HI-NAME TO P-NAME.                                  D.000420
009210     MOVE SPACE TO W-P2.                                          I.000420
009220     MOVE SPACE TO P-SM.                                          I.000420
009230     IF W-TC NOT = W-TCD                                          I.000420
009240         IF W-TC = 1                                              I.000420
009250             MOVE NC"［ケース］" TO P-SM                          I.000420
009260           ELSE                                                   I.000420
009270             MOVE NC"［端　数］" TO P-SM.                         I.000420
009280     MOVE HTI-SIZ TO P-SIZ.                                       I.990204
009290*****IF HTI-GNO = 1                                               D.990204
009300*****    MOVE 2 TO P-SIZ.                                         D.990204
009310*****IF HTI-GNO = 2                                               D.990204
009320*****    MOVE 3 TO P-SIZ.                                         D.990204
009330*****IF HTI-GNO = 3                                               D.990204
009340*****    MOVE 4 TO P-SIZ.                                         D.990204
009350*****IF HTI-GNO = 4                                               D.990204
009360*****    MOVE 1 TO P-SIZ.                                         D.990204
009370     MOVE ZERO TO CNT.
009380 M-840.
009390     ADD 1 TO CNT.
009400     IF CNT = 11
009410         GO TO M-860.
009420*****IF HTI-GNO = 2                                               D.000420
009430     IF HTI-GNO = 2 OR 6                                          I.000420
009440         IF CNT > 9
009450             GO TO M-840.
009460*****IF HTI-GNO = 3                                               D.000420
009470     IF HTI-GNO = 3 OR 7                                          I.000420
009480         IF CNT > 8
009490             GO TO M-840.
009500     IF (HTI-SU(CNT) NOT = ZERO) OR (W-SS(CNT) NOT = ZERO)        I.000429
009510         MOVE HTI-SU(CNT) TO P-SU(CNT).
009520     IF HTI-GNO < 5                                               I.000420
009530         ADD HTI-SU(CNT) TO W-KST                                 I.000420
009540       ELSE                                                       I.000420
009550         ADD HTI-SU(CNT) TO W-HST.                                I.000420
009560*****ADD HTI-SU(CNT) TO W-SUG.                                    D.000420
009570     GO TO M-840.
009580 M-860.
009590     READ HTI-M NEXT RECORD WITH UNLOCK AT END
009600         GO TO M-900.
009610     IF HTI-DNO > W-EDNO
009620         GO TO M-900.
009630     IF HTI-GNO < 5                                               I.000420
009640         MOVE 1 TO W-TCD                                          I.000420
009650       ELSE                                                       I.000420
009660         MOVE 2 TO W-TCD.                                         I.000420
009670     IF HTI-SNO = W-SNO
009680         IF HTI-DNO = W-DNO
009690             IF W-TCD = W-TC                                      I.000420
009700                 GO TO M-880.
009710     IF W-TCD NOT = W-TC                                          I.000420
009720         IF W-TC = 1                                              I.000420
009730*****        COMPUTE W-SST = W-KST * SHM-07                       D.010806
009740             COMPUTE W-SST = W-KST * HI-ISU                       I.010806
009750             MOVE W-KST TO P-KST                                  I.000420
009760             MOVE W-SST TO P-SST                                  I.000420
009770           ELSE                                                   I.000420
009780             MOVE W-HST TO P-SST.                                 I.000420
009790     IF HTI-DNO = W-DNO                                           I.000420
009800         GO TO M-880.                                             I.000420
009810     IF W-TC = 1                                                  I.000420
009820*****    COMPUTE W-SST = W-KST * SHM-07                           D.010806
009830         COMPUTE W-SST = W-KST * HI-ISU                           I.010806
009840         MOVE W-KST TO P-KST                                      I.000420
009850         MOVE W-SST TO P-SST                                      I.000420
009860       ELSE                                                       I.000420
009870         MOVE W-HST TO P-SST.                                     I.000420
009880     COMPUTE W-ASU = W-SST + W-HST.                               I.000420
009890     MOVE W-ASU TO P-ASU.                                         I.000420
009900*****MOVE W-SUG TO P-SUG.                                         D.000420
009910*****MOVE 9 TO CHK2.                                              D.000420
009920 M-880.
009930     PERFORM PR2-RTN THRU PR2-EX.
009940     IF HTI-SNO NOT = W-SNO
009950         GO TO M-780.
009960     IF HTI-DNO NOT = W-DNO
009970         GO TO M-800.
009980     IF W-TCD NOT = W-TC                                          I.000420
009990         GO TO M-810.                                             I.000420
010000     GO TO M-820.
010010 M-900.
010020*****MOVE W-SUG TO P-SUG.                                         D.000420
010030     IF W-TC = 1                                                  I.000420
010040*****    COMPUTE W-SST = W-KST * SHM-07                           D.010806
010050         COMPUTE W-SST = W-KST * HI-ISU                           I.010806
010060         MOVE W-KST TO P-KST                                      I.000420
010070         MOVE W-SST TO P-SST                                      I.000420
010080       ELSE                                                       I.000420
010090         MOVE W-HST TO P-SST.                                     I.000420
010100     COMPUTE W-ASU = W-SST + W-HST.                               I.000420
010110     MOVE W-ASU TO P-ASU.                                         I.000420
010120     PERFORM PR2-RTN THRU PR2-EX.
010130 M-960.
010140*****CLOSE HI-M.                                                  D.000420
010150*****CLOSE SHM.                                                   D.010806
010160     CLOSE HTI-M.
010170     IF W-POC NOT = ZERO
010180         CLOSE SP-F.
010190 M-980.
010200     DISPLAY C-CLEAR.
010210     STOP RUN.
010220 MID-RTN.
010230     MOVE SPACE TO SP-R.
010240     WRITE SP-R AFTER PAGE.
010250 MID-010.
010260     ADD 1 TO W-PAGE.
010270     MOVE W-PAGE TO H-PAGE.
010280     MOVE SPACE TO SP-R.
010290     MOVE HEAD1 TO SP-R.
010300     WRITE SP-R.
010310     MOVE SPACE TO SP-R.
010320     MOVE HEAD2 TO SP-R.
010330     WRITE SP-R AFTER 2.
010340     MOVE SPACE TO SP-R.
010350     MOVE HEAD3 TO SP-R.
010360     WRITE SP-R.
010370     MOVE SPACE TO SP-R.
010380     MOVE HEAD4 TO SP-R.
010390     WRITE SP-R.
010400     MOVE SPACE TO SP-R.
010410     MOVE HEAD5 TO SP-R.
010420     WRITE SP-R.
010430     MOVE SPACE TO SP-R.
010440     MOVE HEAD6 TO SP-R.                                          I.000420
010450     WRITE SP-R.
010460     MOVE SPACE TO SP-R.                                          I.000420
010470 MID-EX.
010480     EXIT.
010490 PR1-RTN.                                                         I.000420
010500     MOVE SPACE TO W-P1.                                          I.000420
010510     MOVE SPACE TO P-NAME.                                        I.000420
010520     IF CHK1 = 0                                                  I.000420
010530         MOVE 5 TO CHK1                                           I.000420
010540         MOVE W-SNO TO P-SNO.                                     I.000420
010550     MOVE W-DNO1 TO P-DNO1.                                       I.000420
010560     MOVE "-" TO P-V.                                             I.000420
010570     MOVE W-DNO2 TO P-DNO2.                                       I.000420
010580     MOVE W-HCD TO P-HCD.                                         I.000420
010590*****MOVE SHM-02 TO P-NAME.                                       D.010806
010600     MOVE HI-NAME TO P-NAME.                                      I.010806
010610     MOVE "(" TO P-F.                                             I.000420
010620*****MOVE SHM-07 TO P-ISU.                                        D.010806
010630     MOVE HI-ISU TO P-ISU.                                        I.010806
010640     MOVE ")" TO P-R.                                             I.000420
010650     IF LINAGE-COUNTER > 59                                       I.000420
010660         MOVE W-SNO TO P-SNO                                      I.000420
010670         PERFORM MID-RTN THRU MID-EX.                             I.000420
010680     MOVE SPACE TO SP-R.                                          I.000420
010690     MOVE W-P1 TO SP-R.                                           I.000420
010700     WRITE SP-R.                                                  I.000420
010710     MOVE SPACE TO SP-R.                                          I.000420
010720 PR1-EX.                                                          I.000420
010730     EXIT.                                                        I.000420
010740 PR2-RTN.
010750     IF LINAGE-COUNTER NOT > 60                                   I.000420
010760         GO TO PR2-010.                                           I.000420
010770*****IF LINAGE-COUNTER > 59                                       D.000420
010780*****    MOVE W-SNO TO P-SNO                                      D.000420
010790*****    MOVE W-DNO1 TO P-DNO1                                    D.000420
010800*****    MOVE "-" TO P-V                                          D.000420
010810*****    MOVE W-DNO2 TO P-DNO2                                    D.000420
010820*****    MOVE W-HCD TO P-HCD                                      D.000420
010830*****    MOVE HI-NAME TO P-NAME                                   D.000420
010840     PERFORM MID-RTN THRU MID-EX.
010850     MOVE W-SNO TO P-SNO.                                         I.000420
010860     MOVE W-DNO1 TO P-DNO1.                                       I.000420
010870     MOVE "-" TO P-V.                                             I.000420
010880     MOVE W-DNO2 TO P-DNO2.                                       I.000420
010890     MOVE W-HCD TO P-HCD.                                         I.000420
010900     MOVE HI-NAME TO P-NAME.                                      I.000420
010910     IF W-TC = 1                                                  I.000420
010920         MOVE NC"［ケース］" TO P-SM                              I.000420
010930       ELSE                                                       I.000420
010940         MOVE NC"［端　数］" TO P-SM.                             I.000420
010950 PR2-010.                                                         I.000420
010960     MOVE SPACE TO SP-R.
010970*****MOVE W-P TO SP-R.                                            D.000420
010980     MOVE W-P2 TO SP-R.                                           I.000420
010990     WRITE SP-R.
011000     MOVE SPACE TO SP-R.
011010*****IF CHK2 = 9                                                  D.000420
011020*****    WRITE SP-R.                                              D.000420
011030 PR2-EX.
011040     EXIT.
011050 DSP-RTN.
011060     MOVE HTI-SNO TO W-SNO.
011070     MOVE HTI-HCD TO W-HCD.
011080     MOVE SPACE TO W-SN.
011090     OPEN INPUT JCON.
011100     MOVE 3 TO JCON3-01.
011110     MOVE W-SNO TO JCON3-02.
011120     READ JCON WITH UNLOCK INVALID KEY
011130         MOVE NC"倉庫なし　　" TO JCON3-03.
011140     MOVE JCON3-03 TO W-SN.
011150     CLOSE JCON.
011160*****MOVE W-HCD TO HI-KEY.                                        D.000420
011170*****READ HI-M WITH UNLOCK INVALID KEY                            D.000420
011180*****    MOVE SPACE TO HI-NAME                                    D.000420
011190*****    MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.  D.000420
011200*****DISPLAY A-SNO D-SN A-HCD D-NAME.                             D.000420
011210*****MOVE W-HCD TO SHM-KEY.                                       D.010806
011220*****READ SHM WITH UNLOCK INVALID KEY                             D.010806
011230*****    MOVE ZERO TO SHM-07                                      D.010806
011240*****    MOVE SPACE TO SHM-02                                     D.010806
011250*****    MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO SHM-02.   D.010806
011260     MOVE W-HCD TO HI-KEY.                                        I.000420
011270     READ HI-M WITH UNLOCK INVALID KEY                            I.000420
011280         INITIALIZE HI-R.                                         I.000420
011290     DISPLAY A-SNO D-SN A-HCD D-NAME D-ISU.                       I.000420
011300     MOVE ZERO TO W-RD.
011310 DSP-010.
011320     IF HTI-GNO = 1
011330         MOVE HTI-SUD TO W-SUD1.
011340     IF HTI-GNO = 2
011350         MOVE HTI-SUD TO W-SUD2.
011360     IF HTI-GNO = 3
011370         MOVE HTI-SUD TO W-SUD3.
011380     IF HTI-GNO = 4
011390         MOVE HTI-SUD TO W-SUD4.
011400     IF HTI-GNO = 5
011410         MOVE HTI-SUD TO W-SUD5.
011420     IF HTI-GNO = 6
011430         MOVE HTI-SUD TO W-SUD6.
011440     IF HTI-GNO = 7
011450         MOVE HTI-SUD TO W-SUD7.
011460     IF HTI-GNO = 8
011470         MOVE HTI-SUD TO W-SUD8.
011480*
011490     READ HTI-M NEXT RECORD WITH UNLOCK AT END
011500         GO TO DSP-020.
011510     IF HTI-DNO = W-DNO
011520         GO TO DSP-010.
011530 DSP-020.
011540*****MOVE ZERO TO W-SC W-SUG.                                     D.000420
011550     MOVE ZERO TO W-SC.                                           I.000420
011560 DSP-030.
011570     ADD 1 TO W-SC.
011580*****IF W-SC = 5                                                  D.000420
011590     IF W-SC = 9                                                  I.000420
011600*****    COMPUTE W-SST = W-KST * SHM-07                           D.010806
011610         COMPUTE W-SST = W-KST * HI-ISU                           I.010806
011620         COMPUTE W-ASU = W-SST + W-HST                            I.000420
011630         DISPLAY D-SUG
011640         GO TO DSP-EX.
011650     PERFORM FST-RTN THRU FST-EX.
011660*****MOVE 5 TO W-C.                                               D.000420
011670     MOVE 2 TO W-C.                                               I.000420
011680     MOVE ZERO TO CNT.
011690 DSP-040.
011700     ADD 1 TO CNT.
011710     IF CNT = 11
011720         GO TO DSP-030.
011730     IF W-SS(CNT) = 0
011740         MOVE ZERO TO W-SU(CNT)
011750         DISPLAY S-SU
011760       ELSE
011770         DISPLAY D-SU                                             I.000420
011780         IF W-SC < 5                                              I.000420
011790             ADD W-SU(CNT) TO W-KST                               I.000420
011800           ELSE                                                   I.000420
011810             ADD W-SU(CNT) TO W-HST.                              I.000420
011820*****    ADD W-SU(CNT) TO W-SUG                                   D.000420
011830*****    DISPLAY D-SU.                                            D.000420
011840     ADD 7 TO W-C.
011850     GO TO DSP-040.
011860 DSP-EX.
011870     EXIT.
011880 FST-RTN.
011890     MOVE ZERO TO W-SUD W-SSD.
011900*****IF W-SC = 1                                                  D.000420
011910     IF W-SC = 1 OR 5                                             I.000420
011920         MOVE HI-SS2 TO W-SSD
011930         IF W-SC = 1                                              I.000420
011940             MOVE W-SUD1 TO W-SUD
011950             MOVE  6 TO W-L                                       I.000420
011960           ELSE                                                   I.000420
011970             MOVE W-SUD5 TO W-SUD                                 I.000420
011980             MOVE 15 TO W-L.                                      I.000420
011990*****    MOVE 9 TO W-L.                                           D.000420
012000*****IF W-SC = 2                                                  D.000420
012010     IF W-SC = 2 OR 6                                             I.000420
012020         MOVE HI-SS3 TO W-SSD
012030         IF W-SC = 2                                              I.000420
012040             MOVE W-SUD2 TO W-SUD
012050             MOVE  8 TO W-L                                       I.000420
012060           ELSE                                                   I.000420
012070             MOVE W-SUD6 TO W-SUD                                 I.000420
012080             MOVE 17 TO W-L.                                      I.000420
012090*****    MOVE 12 TO W-L.                                          D.000420
012100*****IF W-SC = 3                                                  D.000420
012110     IF W-SC = 3 OR 7                                             I.000420
012120         MOVE HI-SS4 TO W-SSD
012130         MOVE 0 TO W-SS(10)
012140         IF W-SC = 3                                              I.000420
012150             MOVE W-SUD3 TO W-SUD
012160             MOVE 10 TO W-L                                       I.000420
012170           ELSE                                                   I.000420
012180             MOVE W-SUD7 TO W-SUD                                 I.000420
012190             MOVE 19 TO W-L.                                      I.000420
012200*****    MOVE 15 TO W-L.                                          D.000420
012210*****IF W-SC = 4                                                  D.000420
012220     IF W-SC = 4 OR 8                                             I.000420
012230         MOVE HI-SS1 TO W-SSD
012240         IF W-SC = 4                                              I.000420
012250             MOVE W-SUD4 TO W-SUD
012260             MOVE 12 TO W-L                                       I.000420
012270           ELSE                                                   I.000420
012280             MOVE W-SUD8 TO W-SUD                                 I.000420
012290             MOVE 21 TO W-L.                                      I.000420
012300*****    MOVE 18 TO W-L.                                          D.000420
012310 FST-EX.
012320     EXIT.
012330 RST-RTN.
012340     IF W-SC = 1
012350         MOVE W-SUD TO W-SUD1.
012360     IF W-SC = 2
012370         MOVE W-SUD TO W-SUD2.
012380     IF W-SC = 3
012390         MOVE W-SUD TO W-SUD3.
012400     IF W-SC = 4
012410         MOVE W-SUD TO W-SUD4.
012420     IF W-SC = 5                                                  I.000420
012430         MOVE W-SUD TO W-SUD5.                                    I.000420
012440     IF W-SC = 6                                                  I.000420
012450         MOVE W-SUD TO W-SUD6.                                    I.000420
012460     IF W-SC = 7                                                  I.000420
012470         MOVE W-SUD TO W-SUD7.                                    I.000420
012480     IF W-SC = 8                                                  I.000420
012490         MOVE W-SUD TO W-SUD8.                                    I.000420
012500 RST-EX.
012510     EXIT.
012520 KEI-RTN.                                                         I.000420
012530     MOVE ZERO TO W-SUG CNT.                                      I.000420
012540 KEI-010.                                                         I.000420
012550     ADD 1 TO CNT.                                                I.000420
012560     IF CNT = 11                                                  I.000420
012570*****    COMPUTE W-SST = W-KST * SHM-07                           D.010806
012580         COMPUTE W-SST = W-KST * HI-ISU                           I.010806
012590         COMPUTE W-ASU = W-SST + W-HST                            I.000420
012600         DISPLAY D-SUG                                            I.000420
012610         GO TO KEI-EX.                                            I.000420
012620     ADD W-SU1(CNT) TO W-KST.                                     I.000420
012630     ADD W-SU2(CNT) TO W-KST.                                     I.000420
012640     ADD W-SU3(CNT) TO W-KST.                                     I.000420
012650     ADD W-SU4(CNT) TO W-KST.                                     I.000420
012660     ADD W-SU5(CNT) TO W-HST.                                     I.000420
012670     ADD W-SU6(CNT) TO W-HST.                                     I.000420
012680     ADD W-SU7(CNT) TO W-HST.                                     I.000420
012690     ADD W-SU8(CNT) TO W-HST.                                     I.000420
012700     GO TO KEI-010.                                               I.000420
012710 KEI-EX.                                                          I.000420
012720     EXIT.
