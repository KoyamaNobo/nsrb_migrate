000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMY250.
000030**********************************************************
000040*****     担当得意先品種月別　年間売上数量集計表     *****
000050**********************************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     COPY LIBCSE.
000130*****SELECT T-M ASSIGN TO T-MSD                                   D.000224
000140     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000224
000150         ORGANIZATION IS INDEXED
000160         ACCESS MODE IS RANDOM
000170         RECORD KEY IS T-KEY                                      I.000224
000180         ALTERNATE RECORD KEY IS T-KEY2.                          I.000224
000190*****    RECORD KEY IS T-KEY.                                     D.000224
000200*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010807
000210     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010807
000220         ORGANIZATION IS INDEXED
000230         ACCESS MODE IS RANDOM
000240         RECORD KEY IS HI-KEY                                     I.010807
000250         ALTERNATE RECORD KEY IS HI-KEY2.                         I.010807
000260*****    RECORD KEY IS HI-KEY.                                    D.010807
000270     SELECT SSR-YF ASSIGN TO SSR-MSD.
000280     SELECT SP-F ASSIGN TO P-PRN999.
000290 I-O-CONTROL.
000300     APPLY SHARED-MODE ON T-M
000310     APPLY SHARED-MODE ON HI-M
000320     APPLY SHARED-MODE ON M-DATE
000330     APPLY SHIFT-CODE  ON SP-F.
000340 DATA DIVISION.
000350 FILE SECTION.
000360     COPY LIBFDD.
000370     COPY LITM.
000380     COPY LIHIM.
000390     COPY LSPF.
000400 FD  SSR-YF
000410     BLOCK  4 RECORDS
000420     LABEL RECORD IS STANDARD
000430     VALUE OF IDENTIFICATION WK0064ID.                            I.950719
000440*****VALUE OF IDENTIFICATION "SSRYF".                             D.950719
000450 01  SSR-YR.
000460     02  SSR-TCD        PIC  9(004).
000470     02  SSR-HCD        PIC  9(006).
000480     02  SSR-SU         PIC S9(007).
000490     02  SSR-UK         PIC S9(010).
000500     02  SSR-GK         PIC S9(010).
000510     02  SSR-TKC        PIC  9(002).
000520     02  SSR-TTC.
000530       03  SSR-TTC1     PIC  9(001).
000540       03  SSR-TTC2     PIC  9(001).
000550*****02  SSR-BC1        PIC  9(002).                              D.060526
000560*****02  SSR-BC2.                                                 D.060526
000570     02  SSR-BCD1.                                                I.060526
000580       03  SSR-BC1      PIC  9(002).                              I.060526
000590       03  SSR-BC21     PIC  9(001).
000600*****  03  SSR-BC22     PIC  9(001).                              D.060526
000610     02  SSR-BC22       PIC  9(001).                              I.060526
000620     02  SSR-BC3        PIC  9(002).
000630     02  F              PIC  X(005).                              I.020520
000640*****02  F              PIC  X(002).                              D.020520
000650     02  SSR-NG         PIC  9(006).                              I.970722
000660     02  F              PIC  X(006).                              I.020520
000670*****02  F              PIC  X(009).                              D.020520
000680*****02  SSR-NG         PIC  9(004).                              D.970722
000690*****02  F              PIC  X(011).                              D.970722
000700 WORKING-STORAGE  SECTION.
000710 77  WK0064ID           PIC  X(009) VALUE SPACE.                  I.950719
000720 01  STN-NO.                                                      I.950719
000730     02  STN-NO1        PIC  X(003).                              I.950719
000740     02  STN-NO2        PIC  X(003).                              I.950719
000750 01  W-FID.                                                       I.950719
000760     02  W-FID1         PIC  X(006) VALUE "WK0064".               I.950719
000770     02  W-FID2         PIC  X(003).                              I.950719
000780 01  HEAD1.
000790     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000800*****02  H-IKCM         PIC  N(006) VALUE NC"｛　一般　｝".       D.961111
000810*****02  F              PIC  X(009) VALUE SPACE.                  D.961111
000820     02  H-IKCM         PIC  N(010) VALUE                         I.961111
000830          NC"｛　一　般　｝　　　".                               I.961111
000840     02  F              PIC  X(001) VALUE SPACE.                  I.961111
000850     02  F              PIC  N(005) VALUE NC"＊＊＊　　".
000860     02  H-SN           PIC 99.
000870     02  F              PIC  N(001) VALUE NC"年".
000880     02  H-SG           PIC Z9.
000890     02  F              PIC  N(004) VALUE NC"月　〜　".
000900     02  H-EN           PIC 99.
000910     02  F              PIC  N(001) VALUE NC"年".
000920     02  H-EG           PIC Z9.
000930     02  F              PIC  N(019) VALUE
000940          NC"月　得意先品種月別　年間売上数量集計表".
000950     02  F              PIC  N(005) VALUE NC"　　＊＊＊".
000960     02  F              PIC  X(010) VALUE SPACE.
000970     02  F              PIC  X(005) VALUE "DATE ".
000980     02  H-DATE         PIC 99B99B99.
000990     02  F              PIC  X(007) VALUE "     P.".
001000     02  H-PAGE         PIC ZZ9.
001010 01  HEAD2.
001020     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001030     02  H-TTM          PIC  N(002) VALUE NC"担当".
001040     02  F              PIC  X(006) VALUE " ｺｰﾄﾞ ".
001050     02  F              PIC  N(008) VALUE NC"得　意　先　名　".
001060     02  F              PIC  X(087) VALUE SPACE.
001070*****02  F              PIC  N(016) VALUE                         D.971121
001080     02  H-SMID         PIC  N(016) VALUE                         I.971121
001090          NC"＜　合計１０足以下は，その他　＞".
001100 01  HEAD3.
001110     02  F              PIC  X(020) VALUE SPACE.
001120     02  F              PIC  X(006) VALUE "ｺｰﾄﾞ  ".
001130     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
001140     02  F              PIC  X(024) VALUE SPACE.
001150     02  H-NGDM1.
001160       03  H-NGD1  OCCURS   6.
001170         04  F          PIC  X(003).
001180         04  H-NG1      PIC 99/99.
001190     02  F              PIC  X(006) VALUE " :    ".
001200     02  F              PIC  N(004) VALUE NC"小　　計".
001210     02  F              PIC  X(004) VALUE SPACE.
001220     02  H-AM1          PIC  N(004).
001230 01  HEAD4.
001240     02  F              PIC  X(062) VALUE SPACE.
001250     02  H-NGDM2.
001260       03  H-NGD2  OCCURS   6.
001270         04  F          PIC  X(003).
001280         04  H-NG2      PIC 99/99.
001290     02  F              PIC  X(006) VALUE " :    ".
001300     02  F              PIC  N(004) VALUE NC"小　　計".
001310     02  F              PIC  X(004) VALUE SPACE.
001320     02  H-AM2          PIC  N(004) VALUE NC"合　　計".
001330 01  W-P1.
001340     02  F              PIC  X(001).
001350     02  P-TTC1         PIC  9(002).
001360     02  F              PIC  X(001).
001370     02  P-TCD          PIC  9(004).
001380     02  F              PIC  X(001).
001390     02  P-TNA          PIC  N(026).                              I.020410
001400     02  F              PIC  X(063).                              I.020410
001410*****02  P-TNA          PIC  N(024).                              D.020410
001420*****02  F              PIC  X(066).                              D.020410
001430     02  P-X1           PIC  X(001).
001440     02  F              PIC  X(020).
001450 01  W-P2.
001460     02  F              PIC  X(001).
001470     02  P-TTC2         PIC  9(002).
001480     02  F              PIC  X(016).
001490     02  P-HCD          PIC  9(006).
001500     02  F              PIC  X(001).
001510     02  P-HNA          PIC  N(024).
001520     02  P-SUD.
001530       03  P-SU    OCCURS   6  PIC ----,--9.
001540     02  F              PIC  X(001).
001550     02  P-X2           PIC  X(001).
001560     02  P-HSU          PIC --,---,--9.
001570     02  P-ASU          PIC --,---,--9.
001580 01  W-DATA.
001590*****02  W-JC           PIC  9(001).                              D.961111
001600     02  W-NGD1.
001610       03  W-NG1   OCCURS   6  PIC  9(006).                       I.970722
001620*****  03  W-NG1   OCCURS   6  PIC  9(004).                       D.970722
001630     02  W-NGD2.
001640       03  W-NG2   OCCURS   6  PIC  9(006).                       I.970722
001650*****  03  W-NG2   OCCURS   6  PIC  9(004).                       D.970722
001660*****02  W-SNGD         PIC  9(004).                              D.950719
001670*****02  W-ENGD         PIC  9(004).                              D.950719
001680     02  W-SNG.
001690*****  03  W-SNEN       PIC  9(002).                              D.970722
001700       03  W-SNEN       PIC  9(004).                              I.970722
001710       03  W-SND   REDEFINES W-SNEN.                              I.970722
001720         04  W-SN1      PIC  9(002).                              I.970722
001730         04  W-SN2      PIC  9(002).                              I.970722
001740       03  W-SGET       PIC  9(002).
001750     02  W-SNGL  REDEFINES W-SNG.                                 I.970722
001760       03  F            PIC  9(002).                              I.970722
001770       03  W-SNGS       PIC  9(004).                              I.970722
001780     02  W-ENG.
001790*****  03  W-ENEN       PIC  9(002).                              D.970722
001800       03  W-ENEN       PIC  9(004).                              I.970722
001810       03  W-END   REDEFINES W-ENEN.                              I.970722
001820         04  W-EN1      PIC  9(002).                              I.970722
001830         04  W-EN2      PIC  9(002).                              I.970722
001840       03  W-EGET       PIC  9(002).
001850     02  W-ENGL  REDEFINES W-ENG.                                 I.970722
001860       03  F            PIC  9(002).                              I.970722
001870       03  W-ENGS       PIC  9(004).                              I.970722
001880*****02  W-NG           PIC  9(004).                              D.970722
001890     02  W-NG           PIC  9(006).                              I.970722
001900     02  W-NGD   REDEFINES W-NG.
001910*****  03  W-NEN        PIC  9(002).                              D.970722
001920       03  W-NEN        PIC  9(004).                              I.970722
001930       03  W-GET        PIC  9(002).
001940     02  W-NGL   REDEFINES W-NG.                                  I.970722
001950       03  F            PIC  9(002).                              I.970722
001960       03  W-NGS        PIC  9(004).                              I.970722
001970     02  W-SETTC.
001980       03  W-STTC       PIC  9(002) VALUE 00.
001990       03  W-ETTC       PIC  9(002) VALUE 99.
002000     02  W-TTC.
002010       03  W-TTC1       PIC  9(001).
002020       03  W-TTC2       PIC  9(001).
002030     02  W-TCD          PIC  9(004).
002040     02  W-HCD          PIC  9(006).
002050     02  W-DTC          PIC  9(001).
002060     02  W-PAGE         PIC  9(003) VALUE ZERO.
002070     02  CNT            PIC  9(002).
002080     02  W-DC           PIC  9(001).
002090     02  CHK            PIC  9(001).
002100     02  W-C            PIC  9(001).
002110     02  W-SUD.
002120       03  W-SU1   OCCURS   6  PIC S9(006).
002130       03  W-SU2   OCCURS   6  PIC S9(006).
002140     02  W-HSU1         PIC S9(007).
002150     02  W-HSU2         PIC S9(007).
002160     02  W-ASU          PIC S9(007).
002170*****02  W-IKCM         PIC  N(006).                              D.961111
002180     02  W-IKCM         PIC  N(010).                              I.961111
002190     02  W-DMM          PIC  9(001).
002200 01  WT-D.
002210     02  WT-SUD.
002220       03  WT-SU1   OCCURS   6  PIC S9(006).
002230       03  WT-SU2   OCCURS   6  PIC S9(006).
002240 01  WN-D.
002250     02  WN-SUD.
002260       03  WN-SU1   OCCURS   6  PIC S9(006).
002270       03  WN-SU2   OCCURS   6  PIC S9(006).
002280 01  WS-D.
002290     02  WS-SUD.
002300       03  WS-SU1   OCCURS   6  PIC S9(006).
002310       03  WS-SU2   OCCURS   6  PIC S9(006).
002320 01  WA-D.
002330     02   WA-SUD.
002340       03  WA-SU1   OCCURS   6  PIC S9(006).
002350       03  WA-SU2   OCCURS   6  PIC S9(006).
002360     COPY LSTAT.
002370 SCREEN SECTION.
002380 SD  C-CRT
002390     END STATUS IS ESTAT.
002400 01  C-CLEAR.
002410     02  LINE   1  CLEAR SCREEN.
002420 01  C-MID.
002430     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
002440          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002450     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
002460          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002470     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
002480          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
002490     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
002500          NC"＊＊＊　　得意先品種　月別　売上数集計表　　＊＊＊".
002510     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
002520          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
002530     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
002540          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002550     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
002560          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002570     02  LINE  13  COLUMN  23  PIC  X(024) VALUE
002580          "'  年   月 〜 '  年   月".
002590*****02  LINE  15  COLUMN  22  PIC  X(027) VALUE                  D.961111
002600*****     "一般=1 教育=5 終了=9   ﾘﾀｰﾝ".                          D.961111
002610*****02  LINE  17  COLUMN  22  PIC  X(026) VALUE                  D.961111
002620*****     "担当者ｺｰﾄﾞ 00 より 99 まで".                           D.961111
002630     02  LINE  20  COLUMN  24  PIC  X(022) VALUE
002640          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002650 01  C-ACP.
002660*****02  LINE  13.                                                D.950719
002670*****  03  A-SNEN  COLUMN  24  PIC  9(002)                        D.950719
002680*****       USING W-SNEN  CHECK OVERFLOW NO IFC.                  D.950719
002690*****  03  A-SGET  COLUMN  29  PIC  9(002)                        D.950719
002700*****       USING W-SGET  CHECK OVERFLOW NO IFC.                  D.950719
002710*****  03  A-ENEN  COLUMN  38  PIC  9(002)                        D.950719
002720*****       USING W-ENEN  CHECK OVERFLOW NO IFC.                  D.950719
002730*****  03  A-EGET  COLUMN  43  PIC  9(002)                        D.950719
002740*****       USING W-EGET  CHECK OVERFLOW NO IFC.                  D.950719
002750     02  LINE  15.
002760*****  03  A-JC    COLUMN  44  PIC  9(001)                        D.961111
002770*****       USING W-JC    CHECK OVERFLOW NO IFC.                  D.961111
002780*****02  LINE  17.                                                D.961111
002790       03  A-STTC  COLUMN  33  PIC  9(002)
002800            USING W-STTC  CHECK OVERFLOW NO IFC.
002810       03  A-ETTC  COLUMN  41  PIC  9(002)
002820            USING W-ETTC  CHECK OVERFLOW NO IFC.
002830     02  A-DMM   LINE  20  COLUMN  41  PIC  9(001)
002840          USING W-DMM   CHECK OVERFLOW NO IFC.
002850 01  C-DSP.                                                       I.961111
002860*****02  D-IKCM  LINE   7  COLUMN  28  PIC  N(006) FROM  W-IKCM.  D.950526
002870     02  D-IKCM  LINE   7  COLUMN  26  PIC  N(010) FROM  W-IKCM.  I.950526
002880     02  D-TTCM  LINE  15  COLUMN  22  PIC  X(026) VALUE          I.961111
002890          "担当者ｺｰﾄﾞ 00 より 99 まで".                           I.961111
002900*01  C-DSP.                                                       D.961111
002910     02  D-NG    LINE  13.                                        I.950719
002920*****  03  COLUMN  24  PIC  9(002) FROM  W-SNEN.                  D.970722
002930       03  COLUMN  24  PIC  9(002) FROM  W-SN2.                   I.970722
002940       03  COLUMN  29  PIC  9(002) FROM  W-SGET.                  I.950719
002950*****  03  COLUMN  38  PIC  9(002) FROM  W-ENEN.                  D.970722
002960       03  COLUMN  38  PIC  9(002) FROM  W-EN2.                   I.970722
002970       03  COLUMN  43  PIC  9(002) FROM  W-EGET.                  I.950719
002980 01  C-ERR.
002990     02  LINE  24.
003000       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
003010            "***  DATA ﾅｼ  ***".
003020       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
003030            "***  DATA ｴﾗｰ  ***".
003040       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003050       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003060       03  E-CL    COLUMN  10  PIC  X(050) VALUE                  I.950526
003070            "                                                  ". I.950526
003080     COPY LIBSCR.
003090 PROCEDURE DIVISION.
003100 M-020.
003110     COPY LIBCPR.
003120     MOVE DATE-02R TO H-DATE.
003130     MOVE ZERO TO W-SNG W-ENG.                                    I.970722
003140     MOVE D-SPNG TO W-SNGS.                                       I.970722
003150     MOVE D-EPNG TO W-ENGS.                                       I.970722
003160     IF W-SN2 >= DATE-NF1 AND <= DATE-NT1                         I.970722
003170         ADD DATE-NC1 TO W-SNEN.                                  I.970722
003180     IF W-SN2 >= DATE-NF2 AND <= DATE-NT2                         I.970722
003190         ADD DATE-NC2 TO W-SNEN.                                  I.970722
003200     IF W-EN2 >= DATE-NF1 AND <= DATE-NT1                         I.970722
003210         ADD DATE-NC1 TO W-ENEN.                                  I.970722
003220     IF W-EN2 >= DATE-NF2 AND <= DATE-NT2                         I.970722
003230         ADD DATE-NC2 TO W-ENEN.                                  I.970722
003240*****MOVE D-SNG TO W-SNGD W-SNG.                                  D.950719
003250*****MOVE D-ENG TO W-ENGD W-ENG.                                  D.950719
003260*****MOVE D-SPNG TO W-SNG.                                        D.970722
003270*****MOVE D-EPNG TO W-ENG.                                        D.970722
003280     DISPLAY C-CLEAR.
003290     DISPLAY C-MID.
003300     DISPLAY D-NG.                                                I.950719
003310*****DISPLAY A-SNEN A-SGET A-ENEN A-EGET.                         D.950719
003320*****MOVE 0 TO W-JC.                                              D.950526
003330*****IF COMPLETION-CODE = 100                                     D.950526
003340*****    MOVE NC"｛　教育　｝" TO W-IKCM                          D.950526
003350*****    MOVE 5 TO W-JC                                           D.950526
003360*****  ELSE                                                       D.950526
003370*****    MOVE NC"｛　一般　｝" TO W-IKCM                          D.950526
003380*****    DISPLAY D-TTCM.                                          D.950526
003390     IF COMPLETION-CODE = 110                                     I.961111
003400         MOVE NC"｛　一　般　｝　　　" TO W-IKCM.                 I.961111
003410     IF COMPLETION-CODE = 130                                     I.961111
003420         MOVE SPACE TO H-SMID                                     I.971121
003430         MOVE NC"｛ヴィヴェンディ｝　" TO W-IKCM.                 I.961111
003440     IF COMPLETION-CODE = 150                                     I.961111
003450         MOVE NC"｛　教　育　｝　　　" TO W-IKCM.                 I.961111
003460     DISPLAY D-IKCM.                                              I.961111
003470     IF COMPLETION-CODE = 110                                     I.961111
003480         DISPLAY D-TTCM                                           I.961111
003490       ELSE                                                       I.961111
003500         GO TO M-180.                                             I.961111
003510*M-040.                                                           D.950719
003520*****ACCEPT A-SNEN.                                               D.950719
003530*****IF ESTAT = PF9                                               D.950719
003540*****    GO TO M-980.                                             D.950719
003550*****IF ESTAT NOT = HTB AND SKP                                   D.950719
003560*****    GO TO M-040.                                             D.950719
003570*M-060.                                                           D.950719
003580*****ACCEPT A-SGET.                                               D.950719
003590*****IF ESTAT = BTB                                               D.950719
003600*****    GO TO M-040.                                             D.950719
003610*****IF ESTAT NOT = HTB AND SKP                                   D.950719
003620*****    GO TO M-060.                                             D.950719
003630*****IF W-SGET < 1 OR > 12                                        D.950719
003640*****    GO TO M-060.                                             D.950719
003650*****IF W-SNG < W-SNGD OR > W-ENGD                                D.950719
003660*****    GO TO M-060.                                             D.950719
003670*M-080.                                                           D.950719
003680*****ACCEPT A-ENEN.                                               D.950719
003690*****IF ESTAT = BTB                                               D.950719
003700*****    GO TO M-060.                                             D.950719
003710*****IF ESTAT NOT = HTB AND SKP                                   D.950719
003720*****    GO TO M-080.                                             D.950719
003730*****IF W-ENEN < W-SNEN                                           D.950719
003740*****    GO TO M-080.                                             D.950719
003750*M-100.                                                           D.950719
003760*****ACCEPT A-EGET.                                               D.950719
003770*****IF ESTAT = BTB                                               D.950719
003780*****    GO TO M-080.                                             D.950719
003790*****IF ESTAT NOT = HTB AND SKP                                   D.950719
003800*****    GO TO M-100.                                             D.950719
003810*****IF W-EGET < 1 OR > 12                                        D.950719
003820*****    GO TO M-100.                                             D.950719
003830*****IF W-ENG < W-SNGD OR > W-ENGD                                D.950719
003840*****    GO TO M-060.                                             D.950719
003850*****IF W-SNG > W-ENG                                             D.950719
003860*****    GO TO M-100.                                             D.950719
003870*****IF W-JC = 5                                                  D.950526
003880*****    GO TO M-180.                                             D.950526
003890*M-120.                                                           D.961111
003900*****ACCEPT A-JC.                                                 D.961111
003910*****IF ESTAT = BTB                                               D.950719
003920*****    GO TO M-100.                                             D.950719
003930*****IF ESTAT = PF9                                               D.961111
003940*****    GO TO M-980.                                             D.961111
003950*****IF ESTAT NOT = HTB AND SKP                                   D.961111
003960*****    GO TO M-120.                                             D.961111
003970*****IF W-JC NOT = 1 AND 5 AND 9                                  D.961111
003980*****    GO TO M-120.                                             D.961111
003990*****IF W-JC = 9                                                  D.961111
004000*****    MOVE ZERO TO W-STTC W-ETTC                               D.961111
004010*****    DISPLAY A-STTC A-ETTC                                    D.961111
004020*****    GO TO M-180.                                             D.961111
004030 M-140.
004040     ACCEPT A-STTC.
004050*****IF ESTAT = BTB                                               D.961111
004060*****    GO TO M-100.                                             D.950526
004070*****    GO TO M-120.                                             D.961111
004080     IF ESTAT = PF9                                               I.961111
004090         MOVE 255 TO COMPLETION-CODE                              I.961111
004100         GO TO M-980.                                             I.961111
004110     IF ESTAT NOT = HTB AND SKP
004120         GO TO M-140.
004130 M-160.
004140     ACCEPT A-ETTC.
004150     IF ESTAT = BTB
004160         GO TO M-140.
004170     IF ESTAT NOT = HTB AND SKP
004180         GO TO M-160.
004190     IF W-STTC > W-ETTC
004200         GO TO M-160.
004210 M-180.
004220     ACCEPT A-DMM.
004230     IF COMPLETION-CODE = 110                                     I.961111
004240         IF ESTAT = BTB
004250*****    IF W-JC = 5                                              D.950526
004260*****        GO TO M-100                                          D.950526
004270*****    IF W-JC = 9                                              D.961111
004280*****        GO TO M-120                                          D.961111
004290*****      ELSE                                                   D.961111
004300             GO TO M-160.
004310     IF ESTAT NOT = HTB AND SKP
004320         GO TO M-180.
004330     IF W-DMM = 9
004340         IF COMPLETION-CODE NOT = 110                             I.961111
004350             MOVE 255 TO COMPLETION-CODE                          I.961111
004360             GO TO M-980                                          I.961111
004370           ELSE                                                   I.961111
004380             GO TO M-140.                                         I.961111
004390*****    DISPLAY C-CLEAR                                          D.961111
004400*****    STOP RUN.                                                D.950719
004410*****    GO TO M-040.                                             D.950719
004420*****    GO TO M-120.                                             D.961111
004430     IF W-DMM NOT = 1
004440         GO TO M-180.
004450*
004460*****IF W-JC = 9                                                  D.961111
004470*****    GO TO M-980.                                             D.961111
004480*****IF W-JC = 1                                                  D.961111
004490*****    MOVE NC"｛　一般　｝" TO W-IKCM                          D.961111
004500*****  ELSE                                                       D.961111
004510*****    MOVE NC"｛　教育　｝" TO W-IKCM.                         D.961111
004520     CALL "CBLSTNNO" USING STN-NO.                                I.950719
004530     MOVE STN-NO2 TO W-FID2.                                      I.950719
004540     MOVE W-FID TO WK0064ID.                                      I.950719
004550     OPEN INPUT SSR-YF.
004560 M-220.
004570     READ SSR-YF AT END
004580         CLOSE SSR-YF
004590         DISPLAY E-ME1 E-ME99
004600         GO TO M-980.                                             I.961111
004610*****    DISPLAY E-CL                                             D.961111
004620*****    GO TO M-120.                                             D.961111
004630     IF SSR-NG < W-SNG OR > W-ENG
004640         GO TO M-220.
004650*****IF W-JC = 0                                                  D.950526
004660*****    IF SSR-TTC < W-STTC OR > W-ETTC                          D.950526
004670     IF COMPLETION-CODE = 110                                     I.961111
004680         IF SSR-TTC < W-STTC                                      I.950526
004690             GO TO M-220.
004700     IF COMPLETION-CODE = 110                                     I.961111
004710         IF SSR-TTC > W-ETTC                                      I.950526
004720             CLOSE SSR-YF                                         I.950526
004730             DISPLAY E-ME1 E-ME99                                 I.950526
004740             GO TO M-980.                                         I.961111
004750*****    DISPLAY E-CL                                             D.961111
004760*****    GO TO M-120.                                             D.961111
004770*****IF W-JC = 0                                                  D.950526
004780*****IF W-JC = 1                                                  D.961111
004790*****    IF SSR-BC21 = 2                                          D.961111
004800     IF COMPLETION-CODE = 110                                     I.961111
004810*****    IF SSR-BC1 = 33 OR 71                                    D.020520
004820*****    IF (SSR-BC1 = 33) OR (SSR-BC3 = 30)                      D.060526
004830         IF (SSR-BCD1 = 322) OR (SSR-BC3 = 30)                    I.060526
004840             GO TO M-220.
004850     IF COMPLETION-CODE = 130                                     I.961111
004860*****    IF SSR-BC1 NOT = 33                                      D.060526
004870         IF SSR-BCD1 NOT = 322                                    I.060526
004880             GO TO M-220.                                         I.961111
004890*****IF W-JC = 5                                                  D.961111
004900*****    IF SSR-BC21 NOT = 2                                      D.961111
004910     IF COMPLETION-CODE = 150                                     I.961111
004920*****    IF SSR-BC1 NOT = 71                                      D.020520
004930         IF SSR-BC3 NOT = 30                                      I.020520
004940             GO TO M-220.
004950     IF SSR-SU = ZERO
004960         GO TO M-220.
004970     OPEN INPUT T-M.
004980     OPEN INPUT HI-M.
004990     OPEN OUTPUT SP-F.
005000*****MOVE W-SNEN TO H-SN.                                         I.970722
005010     MOVE W-SN2 TO H-SN.                                          I.970722
005020     MOVE W-SGET TO H-SG.
005030*****MOVE W-ENEN TO H-EN.                                         D.970722
005040     MOVE W-EN2 TO H-EN.                                          I.970722
005050     MOVE W-EGET TO H-EG.
005060     MOVE W-SNG TO W-NG.
005070     MOVE ZERO TO WA-D W-DTC.
005080     IF W-SNEN = W-ENEN
005090         COMPUTE CNT = W-EGET - W-SGET
005100       ELSE
005110         COMPUTE CNT = (12 + W-EGET) - W-SGET.
005120     IF CNT > 11
005130         CLOSE SSR-YF
005140         DISPLAY E-ME2 E-ME99
005150*****    DISPLAY C-CLEAR                                          D.950526
005160*****    STOP RUN.                                                D.950526
005170         GO TO M-980.                                             I.950526
005180     IF CNT > 5
005190         MOVE 5 TO W-DTC
005200         MOVE SPACE TO H-AM1
005210       ELSE
005220         MOVE H-AM2 TO H-AM1.
005230     MOVE SPACE TO H-NGDM1 H-NGDM2.
005240     MOVE ZERO TO CHK W-NGD1 W-NGD2.
005250 M-240.
005260     ADD 1 TO CHK.
005270     IF CHK = 7
005280         MOVE 0 TO CHK
005290         GO TO M-260.
005300*****MOVE W-NG TO W-NG1(CHK) H-NG1(CHK).                          D.970722
005310     MOVE W-NG TO W-NG1(CHK).                                     I.970722
005320     MOVE W-NGS TO H-NG1(CHK).                                    I.970722
005330     IF W-NG = W-ENG
005340         GO TO M-280.
005350     ADD 1 TO W-GET.
005360     IF W-GET = 13
005370         ADD 1 TO W-NEN
005380         MOVE 1 TO W-GET.
005390     GO TO M-240.
005400 M-260.
005410     ADD 1 TO CHK.
005420     IF CHK = 7
005430         GO TO M-280.
005440*****MOVE W-NG TO W-NG2(CHK) H-NG2(CHK).                          D.970722
005450     MOVE W-NG TO W-NG2(CHK).                                     I.970722
005460     MOVE W-NGS TO H-NG2(CHK).                                    D.970722
005470     IF W-NG = W-ENG
005480         GO TO M-280.
005490     ADD 1 TO W-GET.
005500     IF W-GET = 13
005510         ADD 1 TO W-NEN
005520         MOVE 1 TO W-GET.
005530     GO TO M-260.
005540 M-280.
005550     MOVE W-IKCM TO H-IKCM.
005560*****IF W-JC = 5                                                  D.950526
005570*****    MOVE SPACE TO H-TTM.                                     D.950526
005580     PERFORM S-040 THRU S-060.
005590 M-300.
005600*****IF W-JC = 0                                                  D.950526
005610*****    MOVE SSR-TTC TO W-TTC                                    D.950526
005620     IF COMPLETION-CODE NOT = 110                                 I.961111
005630         GO TO M-320.                                             I.961111
005640     MOVE SSR-TTC TO W-TTC.                                       I.950526
005650     MOVE ZERO TO WS-D W-C.
005660 M-320.
005670     MOVE ZERO TO WN-D WT-D W-DC.
005680     MOVE SSR-TCD TO W-TCD.
005690     MOVE W-TCD TO T-KEY.
005700     READ T-M WITH UNLOCK INVALID KEY
005710         MOVE NC"　＊＊　得意先マスター　なし　＊＊" TO T-NAME.
005720     PERFORM S-080 THRU S-100.
005730 M-340.
005740     MOVE SSR-HCD TO W-HCD.
005750     MOVE W-HCD TO HI-KEY.
005760     READ HI-M WITH UNLOCK INVALID KEY
005770         MOVE NC"　＊＊　品名マスター　なし　＊＊　　" TO HI-NAME.
005780     MOVE ZERO TO W-ASU W-HSU1 W-HSU2 W-SUD.
005790 M-360.
005800     MOVE 0 TO CHK.
005810 M-380.
005820     ADD 1 TO CHK.
005830     IF CHK = 7
005840         GO TO M-400.
005850     IF SSR-NG = W-NG1(CHK)
005860         MOVE SSR-SU TO W-SU1(CHK)
005870         ADD SSR-SU TO W-HSU1 W-ASU
005880         GO TO M-400.
005890     IF W-DTC = 5
005900         IF SSR-NG = W-NG2(CHK)
005910             MOVE SSR-SU TO W-SU2(CHK)
005920             ADD SSR-SU TO W-HSU2 W-ASU
005930             GO TO M-400.
005940     GO TO M-380.
005950 M-400.
005960     READ SSR-YF AT END
005970         GO TO M-900.
005980     IF SSR-NG < W-SNG OR > W-ENG
005990         GO TO M-400.
006000*****IF W-JC = 0                                                  D.950526
006010*****    IF SSR-TTC < W-STTC OR > W-ETTC                          D.950526
006020*****        GO TO M-400.                                         D.950526
006030     IF COMPLETION-CODE = 110                                     I.961111
006040         IF SSR-TTC > W-ETTC                                      I.950526
006050             GO TO M-900.                                         I.950526
006060*****IF W-JC = 0                                                  D.950526
006070*****IF W-JC = 1                                                  D.961111
006080*****    IF SSR-BC21 = 2                                          D.961111
006090     IF COMPLETION-CODE = 110                                     I.961111
006100*****    IF SSR-BC1 = 33 OR 71                                    D.020520
006110*****    IF (SSR-BC1 = 33) OR (SSR-BC3 = 30)                      D.060526
006120         IF (SSR-BCD1 = 322) OR (SSR-BC3 = 30)                    I.060526
006130             GO TO M-400.
006140     IF COMPLETION-CODE = 130                                     I.961111
006150*****    IF SSR-BC1 NOT = 33                                      D.060526
006160         IF SSR-BCD1 NOT = 322                                    I.060526
006170             GO TO M-400.                                         I.961111
006180*****IF W-JC = 5                                                  D.961111
006190*****    IF SSR-BC21 NOT = 2                                      D.961111
006200     IF COMPLETION-CODE = 150                                     I.961111
006210*****    IF SSR-BC1 NOT = 71                                      D.020520
006220         IF SSR-BC3 NOT = 30                                      I.020520
006230             GO TO M-400.
006240     IF SSR-SU = ZERO
006250         GO TO M-400.
006260*****IF W-JC = 0                                                  D.950526
006270     IF COMPLETION-CODE = 110                                     I.961111
006280         IF SSR-TTC NOT = W-TTC
006290            GO TO M-440.
006300     IF SSR-TCD NOT = W-TCD
006310         GO TO M-420.
006320     IF SSR-HCD = W-HCD
006330         GO TO M-360.
006340     PERFORM S-120 THRU S-240.
006350     GO TO M-340.
006360 M-420.
006370     PERFORM S-120 THRU S-240.
006380     PERFORM S-260 THRU S-380.
006390     PERFORM S-400 THRU S-520.
006400     GO TO M-320.
006410 M-440.
006420     PERFORM S-120 THRU S-240.
006430     PERFORM S-260 THRU S-380.
006440     PERFORM S-400 THRU S-520.
006450     PERFORM S-540 THRU S-640.
006460     IF SSR-TTC1 NOT = W-TTC1
006470         PERFORM S-020 THRU S-040.
006480     GO TO M-300.
006490 M-900.
006500     PERFORM S-120 THRU S-240.
006510     PERFORM S-260 THRU S-380.
006520     PERFORM S-400 THRU S-520.
006530*****IF W-JC = 0                                                  D.950526
006540     IF COMPLETION-CODE = 110                                     I.961111
006550         PERFORM S-540 THRU S-640.
006560     PERFORM S-660 THRU S-760.
006570     CLOSE T-M.
006580     CLOSE HI-M.
006590     CLOSE SSR-YF.
006600     CLOSE SP-F.
006610*****GO TO M-120.                                                 D.961111
006620 M-980.
006630     DISPLAY C-CLEAR.
006640     STOP RUN.
006650 S-020.
006660     MOVE SPACE TO SP-R.
006670     WRITE SP-R AFTER PAGE.
006680 S-040.
006690     ADD 1 TO W-PAGE.
006700     MOVE W-PAGE TO H-PAGE.
006710     MOVE SPACE TO SP-R.
006720     MOVE HEAD1 TO SP-R.
006730     WRITE SP-R.
006740     MOVE SPACE TO SP-R.
006750     MOVE HEAD2 TO SP-R.
006760     WRITE SP-R AFTER 2.
006770     MOVE SPACE TO SP-R.
006780     MOVE HEAD3 TO SP-R.
006790     WRITE SP-R.
006800     MOVE SPACE TO SP-R.
006810     IF W-DTC = 5
006820         MOVE HEAD4 TO SP-R
006830         WRITE SP-R
006840         MOVE SPACE TO SP-R.
006850     MOVE 0 TO W-C.
006860 S-060.
006870     EXIT.
006880 S-080.
006890     IF LINAGE-COUNTER > 60
006900         PERFORM S-020 THRU S-060.
006910     MOVE SPACE TO W-P1.
006920*****IF W-JC = 0                                                  D.950526
006930     IF W-C = 0
006940         MOVE 5 TO W-C
006950         MOVE W-TTC TO P-TTC1.
006960     MOVE W-TCD TO P-TCD.
006970     MOVE T-NAME TO P-TNA.
006980     MOVE ":" TO P-X1.
006990     MOVE W-P1 TO SP-R.
007000     WRITE SP-R.
007010     MOVE SPACE TO SP-R.
007020 S-100.
007030     EXIT.
007040 S-120.
007050*****IF W-ASU > 9                                                 D.971121
007060     IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                    I.971121
007070         MOVE SPACE TO W-P2
007080         MOVE W-HCD TO P-HCD
007090         MOVE HI-NAME TO P-HNA
007100         MOVE ":" TO P-X2
007110         MOVE W-HSU1 TO P-HSU.
007120     MOVE 0 TO CHK.
007130 S-140.
007140     ADD 1 TO CHK.
007150     IF CHK = 7
007160         GO TO S-160.
007170     IF W-NG1(CHK) NOT = ZERO
007180         ADD W-SU1(CHK) TO WN-SU1(CHK)
007190*****    IF W-ASU > 9                                             D.971121
007200         IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                I.971121
007210             MOVE W-SU1(CHK) TO P-SU(CHK)
007220           ELSE
007230             ADD W-SU1(CHK) TO WT-SU1(CHK).
007240     GO TO S-140.
007250 S-160.
007260*****IF W-ASU < 10                                                D.971121
007270     IF (W-ASU < 10) AND (COMPLETION-CODE NOT = 130)              I.971121
007280         GO TO S-180.
007290     IF W-DTC = 0
007300         MOVE W-ASU TO P-ASU.
007310     IF LINAGE-COUNTER < 61
007320         GO TO S-180.
007330     PERFORM S-020 THRU S-060.
007340     PERFORM S-080 THRU S-100.
007350 S-180.
007360*****IF W-ASU > 9                                                 D.971121
007370     IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                    I.971121
007380         PERFORM S-800 THRU S-820.
007390     IF W-DTC = 0
007400         GO TO S-240.
007410*****IF W-ASU > 9                                                 D.971121
007420     IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                    I.971121
007430         MOVE SPACE TO W-P2
007440         MOVE SPACE TO P-HNA
007450         MOVE ":" TO P-X2
007460         MOVE W-HSU2 TO P-HSU
007470         MOVE W-ASU TO P-ASU.
007480     MOVE 0 TO CHK.
007490 S-200.
007500     ADD 1 TO CHK.
007510     IF CHK = 7
007520         GO TO S-220.
007530     IF W-NG2(CHK) NOT = ZERO
007540         ADD W-SU2(CHK) TO WN-SU2(CHK)
007550*****    IF W-ASU > 9                                             D.971121
007560         IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                I.971121
007570             MOVE W-SU2(CHK) TO P-SU(CHK)
007580           ELSE
007590             ADD W-SU2(CHK) TO WT-SU2(CHK).
007600     GO TO S-200.
007610 S-220.
007620*****IF W-ASU > 9                                                 D.971121
007630     IF (W-ASU > 9) OR (COMPLETION-CODE = 130)                    I.971121
007640         PERFORM S-800 THRU S-820.
007650 S-240.
007660     EXIT.
007670 S-260.
007680     IF WT-D = ZERO
007690         GO TO S-380.
007700     MOVE SPACE TO W-P2.
007710     MOVE SPACE TO P-HNA.
007720     MOVE NC"そ　の　他　" TO P-HNA.
007730     MOVE ":" TO P-X2.
007740     MOVE ZERO TO CHK W-HSU1 W-ASU.
007750 S-280.
007760     ADD 1 TO CHK.
007770     IF CHK = 7
007780         GO TO S-300.
007790     IF W-NG1(CHK) NOT = ZERO
007800         MOVE WT-SU1(CHK) TO P-SU(CHK)
007810         ADD WT-SU1(CHK) TO W-HSU1 W-ASU.
007820     GO TO S-280.
007830 S-300.
007840     MOVE W-HSU1 TO P-HSU.
007850     IF W-DTC = 0
007860         MOVE W-ASU TO P-ASU.
007870     IF LINAGE-COUNTER < 61
007880         GO TO S-320.
007890     PERFORM S-020 THRU S-060.
007900     PERFORM S-080 THRU S-100.
007910 S-320.
007920     PERFORM S-800 THRU S-820.
007930     IF W-DTC = 0
007940         GO TO S-380.
007950     MOVE SPACE TO W-P2.
007960     MOVE SPACE TO P-HNA.
007970     MOVE ":" TO P-X2.
007980     MOVE ZERO TO CHK W-HSU2.
007990 S-340.
008000     ADD 1 TO CHK.
008010     IF CHK = 7
008020         GO TO S-360.
008030     IF W-NG2(CHK) NOT = ZERO
008040         MOVE WT-SU2(CHK) TO P-SU(CHK)
008050         ADD WT-SU2(CHK) TO W-HSU2 W-ASU.
008060     GO TO S-340.
008070 S-360.
008080     MOVE W-HSU2 TO P-HSU.
008090     MOVE W-ASU TO P-ASU.
008100     PERFORM S-800 THRU S-820.
008110 S-380.
008120     EXIT.
008130 S-400.
008140     MOVE SPACE TO W-P2.
008150     MOVE SPACE TO P-HNA.
008160     MOVE NC"　　　　　　　　　　　　（　ＴＯＴＡＬ　）" TO P-HNA.
008170     MOVE ":" TO P-X2.
008180     MOVE ZERO TO CHK W-HSU1 W-ASU.
008190 S-420.
008200     ADD 1 TO CHK.
008210     IF CHK = 7
008220         GO TO S-440.
008230     IF W-NG1(CHK) NOT = ZERO
008240         MOVE WN-SU1(CHK) TO P-SU(CHK)
008250         ADD WN-SU1(CHK) TO W-HSU1 W-ASU
008260*****    IF W-JC = 0                                              D.960606
008270*****    IF W-JC = 1                                              D.961111
008280         IF COMPLETION-CODE = 110                                 I.961111
008290             ADD WN-SU1(CHK) TO WS-SU1(CHK)
008300           ELSE
008310             ADD WN-SU1(CHK) TO WA-SU1(CHK).
008320     GO TO S-420.
008330 S-440.
008340     MOVE W-HSU1 TO P-HSU.
008350     IF W-DTC = 0
008360         MOVE W-ASU TO P-ASU.
008370     IF LINAGE-COUNTER < 61
008380         GO TO S-460.
008390     PERFORM S-020 THRU S-060.
008400     PERFORM S-080 THRU S-100.
008410 S-460.
008420     PERFORM S-800 THRU S-820.
008430     IF W-DTC = 0
008440         GO TO S-520.
008450     MOVE SPACE TO W-P2.
008460     MOVE SPACE TO P-HNA.
008470     MOVE ":" TO P-X2.
008480     MOVE ZERO TO CHK W-HSU2.
008490 S-480.
008500     ADD 1 TO CHK.
008510     IF CHK = 7
008520         GO TO S-500.
008530     IF W-NG2(CHK) NOT = ZERO
008540         MOVE WN-SU2(CHK) TO P-SU(CHK)
008550         ADD WN-SU2(CHK) TO W-HSU2 W-ASU
008560*****    IF W-JC = 0                                              D.960606
008570*****    IF W-JC = 1                                              D.961111
008580         IF COMPLETION-CODE = 110                                 I.961111
008590             ADD WN-SU2(CHK) TO WS-SU2(CHK)
008600           ELSE
008610             ADD WN-SU2(CHK) TO WA-SU2(CHK).
008620     GO TO S-480.
008630 S-500.
008640     MOVE W-HSU2 TO P-HSU.
008650     MOVE W-ASU TO P-ASU.
008660     PERFORM S-800 THRU S-820.
008670 S-520.
008680     EXIT.
008690 S-540.
008700     MOVE SPACE TO W-P2.
008710     MOVE SPACE TO P-HNA.
008720     MOVE ":" TO P-X2.
008730     IF W-DTC = 0
008740         PERFORM S-800 THRU S-820.
008750     MOVE NC"　　　　　［　　ＳＵＢ　ＴＯＴＡＬ　　］　" TO P-HNA.
008760     MOVE ZERO TO CHK W-HSU1 W-ASU.
008770 S-560.
008780     ADD 1 TO CHK.
008790     IF CHK = 7
008800         GO TO S-580.
008810     IF W-NG1(CHK) NOT = ZERO
008820         MOVE WS-SU1(CHK) TO P-SU(CHK)
008830         ADD WS-SU1(CHK) TO W-HSU1 W-ASU WA-SU1(CHK).
008840     GO TO S-560.
008850 S-580.
008860     MOVE W-HSU1 TO P-HSU.
008870     IF W-DTC = 0
008880         MOVE W-ASU TO P-ASU.
008890     IF LINAGE-COUNTER > 61
008900         MOVE W-TTC TO P-TTC2
008910         PERFORM S-020 THRU S-060.
008920     PERFORM S-800 THRU S-820.
008930     IF W-DTC = 0
008940         GO TO S-640.
008950     MOVE SPACE TO W-P2.
008960     MOVE SPACE TO P-HNA.
008970     MOVE ":" TO P-X2.
008980     MOVE ZERO TO CHK W-HSU2.
008990 S-600.
009000     ADD 1 TO CHK.
009010     IF CHK = 7
009020         GO TO S-620.
009030     IF W-NG2(CHK) NOT = ZERO
009040         MOVE WS-SU2(CHK) TO P-SU(CHK)
009050         ADD WS-SU2(CHK) TO W-HSU2 W-ASU WA-SU2(CHK).
009060     GO TO S-600.
009070 S-620.
009080     MOVE W-HSU2 TO P-HSU.
009090     MOVE W-ASU TO P-ASU.
009100     PERFORM S-800 THRU S-820.
009110 S-640.
009120     EXIT.
009130 S-660.
009140     MOVE SPACE TO W-P2.
009150     MOVE SPACE TO P-HNA.
009160     MOVE ":" TO P-X2.
009170     IF W-DTC = 0
009180         PERFORM S-800 THRU S-820.
009190     MOVE NC"　【　　ＡＬＬ　ＴＯＴＡＬ　　】　　　　　" TO P-HNA.
009200     MOVE ZERO TO CHK W-HSU1 W-ASU.
009210 S-680.
009220     ADD 1 TO CHK.
009230     IF CHK = 7
009240         GO TO S-700.
009250     IF W-NG1(CHK) NOT = ZERO
009260         MOVE WA-SU1(CHK) TO P-SU(CHK)
009270         ADD WA-SU1(CHK) TO W-HSU1 W-ASU.
009280     GO TO S-680.
009290 S-700.
009300     MOVE W-HSU1 TO P-HSU.
009310     IF W-DTC = 0
009320         MOVE W-ASU TO P-ASU.
009330     IF LINAGE-COUNTER > 61
009340         PERFORM S-020 THRU S-060.
009350     PERFORM S-800 THRU S-820.
009360     IF W-DTC = 0
009370         GO TO S-760.
009380     MOVE SPACE TO W-P2.
009390     MOVE SPACE TO P-HNA.
009400     MOVE ":" TO P-X2.
009410     MOVE ZERO TO CHK W-HSU2.
009420 S-720.
009430     ADD 1 TO CHK.
009440     IF CHK = 7
009450         GO TO S-740.
009460     IF W-NG2(CHK) NOT = ZERO
009470         MOVE WA-SU2(CHK) TO P-SU(CHK)
009480         ADD WA-SU2(CHK) TO W-HSU2 W-ASU.
009490     GO TO S-720.
009500 S-740.
009510     MOVE W-HSU2 TO P-HSU.
009520     MOVE W-ASU TO P-ASU.
009530     PERFORM S-800 THRU S-820.
009540 S-760.
009550     EXIT.
009560 S-800.
009570     MOVE SPACE TO SP-R.
009580     MOVE W-P2 TO SP-R.
009590     WRITE SP-R.
009600     MOVE SPACE TO SP-R.
009610 S-820.
009620     EXIT.
