000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMN210.
000030*********************************************************
000040*    PROGRAM         :  品名別棚卸チェックリスト        *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*        変更　　　  :  94/04/05                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*    JS-SIGN         :  0=通常 , 1=Ｗチェック           *
000100*********************************************************
000110 ENVIRONMENT DIVISION.
000120 CONFIGURATION SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.
000180*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010806
000190     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010806
000200         ORGANIZATION INDEXED
000210         ACCESS MODE RANDOM
000220         RECORD KEY HI-KEY
000230         ALTERNATE RECORD KEY HI-KEY2                             I.010806
000240         FILE STATUS IS ERR-STAT.
000250*****SELECT SHM ASSIGN TO SH-MSD                                  D.010806
000260*****    ORGANIZATION INDEXED                                     D.010806
000270*****    ACCESS MODE RANDOM                                       D.010806
000280*****    RECORD KEY SHM-KEY                                       D.010806
000290*****    FILE STATUS IS ERR-STAT.                                 D.010806
000300     SELECT HTI-M ASSIGN TO HTI-MSD                               I.000509
000310         ORGANIZATION INDEXED                                     I.000509
000320         ACCESS MODE RANDOM                                       I.000509
000330         RECORD KEY HTI-KEY                                       I.000509
000340         FILE STATUS IS ERR-STAT.                                 I.000509
000350     SELECT HTIW-M ASSIGN TO HTIW-MSD.
000360     SELECT SP-F ASSIGN TO P-PRN999.
000370 I-O-CONTROL.
000380     APPLY SHARED-MODE ON M-DATE
000390*****APPLY SHARED-MODE ON SHM                                     D.010806
000400     APPLY SHARED-MODE ON HTI-M                                   I.000509
000410     APPLY SHARED-MODE ON HI-M
000420     APPLY SHIFT-CODE  ON SP-F.
000430 DATA DIVISION.
000440 FILE SECTION.
000450     COPY LIBFDD.
000460*****COPY L-SHM.                                                  D.010806
000470     COPY LIHTIM.                                                 I.000509
000480     COPY LIHIM.
000490     COPY LSPF.
000500 FD  HTIW-M
000510*****BLOCK  3 RECORDS                                             D.970520
000520*****BLOCK  4 RECORDS                                             D.990204
000530     BLOCK  2 RECORDS                                             I.990204
000540     LABEL RECORD IS STANDARD
000550     VALUE OF IDENTIFICATION WK0128ID.                            I.990204
000560*****VALUE OF IDENTIFICATION WK0064ID.                            D.990204
000570*****VALUE OF IDENTIFICATION "HA64".                              D.950626
000580*****VALUE OF IDENTIFICATION WK0085ID.                            D.970520
000590 01  HTIW-R.
000600     02  HTIW-KEY.
000610       03  HTIW-DNO.                                              伝票№
000620         04  HTIW-DNO1  PIC  9(005).                              伝票№
000630         04  HTIW-DNO2  PIC  X(001).                              伝票№
000640       03  HTIW-GNO     PIC  9(001).                              行№
000650     02  HTIW-SNO       PIC  9(001).                              I.990204
000660     02  HTIW-HCD       PIC  9(006).                              品名ｺｰﾄﾞ
000670     02  HTIW-SIZ       PIC  9(001).                              I.990204
000680     02  HTIW-SUD.                                                棚卸数
000690       03  HTIW-SU      PIC S9(006)  OCCURS  10.                  I.990204
000700     02  HTIW-BC.                                                 I.990204
000710       03  HTIW-BC1     PIC  9(002).                              I.990204
000720       03  HTIW-BC2     PIC  9(002).                              I.990204
000730       03  HTIW-BC3     PIC  9(002).                              I.990204
000740     02  HTIW-ISU       PIC  9(003).                              I.000421
000750     02  F              PIC  X(044).                              I.000421
000760*****02  F              PIC  X(047).                              D.000421
000770*****  03  HTIW-SU      PIC S9(005)  OCCURS  10.                  D.990204
000780*****02  HTIW-SNO       PIC  9(001).                              D.990204
000790*****02  F              PIC  X(021).                              D.970520
000800 WORKING-STORAGE SECTION.
000810 77  JS-SIGN            PIC  9(001).                              I.090317
000820 77  W-END              PIC  9(001) VALUE 0.                      I.090317
000830*77  WK0085ID           PIC  X(009) VALUE SPACE.                  D.970520
000840*77  WK0064ID           PIC  X(009) VALUE SPACE.                  D.990204
000850 77  WK0128ID           PIC  X(009) VALUE SPACE.                  I.990204
000860 01  STN-NO.                                                      I.950626
000870     02  STN-NO1        PIC  X(003).                              I.950626
000880     02  STN-NO2        PIC  X(003).                              I.950626
000890 01  W-FID.                                                       I.950626
000900*****02  W-FID1         PIC  X(006) VALUE "WK0085".               D.970520
000910*****02  W-FID1         PIC  X(006) VALUE "WK0064".               D.990204
000920     02  W-FID1         PIC  X(006) VALUE "WK0128".               I.990204
000930     02  W-FID2         PIC  X(003).                              I.950626
000940 01  HEAD1.
000950     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000960     02  H-MID          PIC  N(002) VALUE SPACE.                  I.090317
000970     02  F              PIC  X(034) VALUE SPACE.                  I.090317
000980*****02  F              PIC  X(038) VALUE SPACE.                  D.090317
000990     02  F              PIC  N(024) VALUE
001000          NC"＊＊＊　　品名別　棚卸　チェックリスト　　＊＊＊".
001010     02  F              PIC  X(027) VALUE SPACE.
001020     02  F              PIC  X(005) VALUE "DATE ".
001030     02  H-DATE         PIC 99B99B99.
001040     02  F              PIC  X(007) VALUE "     P.".
001050     02  H-PAGE         PIC ZZ9.
001060 01  HEAD2.
001070     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001080     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".
001090     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
001100     02  F              PIC  X(025) VALUE SPACE.                  I.000421
001110     02  F              PIC  X(001) VALUE "(".                    I.000421
001120     02  F              PIC  N(002) VALUE NC"入数".               I.000421
001130     02  F              PIC  X(001) VALUE ")".                    I.000421
001140     02  F              PIC  X(087) VALUE SPACE.                  I.000421
001150*****02  F              PIC  X(024) VALUE SPACE.                  D.000421
001160 01  HEAD3.                                                       I.000421
001170     02  F              PIC  X(017) VALUE SPACE.                  I.000421
001180     02  F              PIC  N(002) VALUE NC"倉庫".
001190     02  F              PIC  X(001) VALUE SPACE.
001200     02  F              PIC  N(004) VALUE NC"　伝票№".
001210     02  F              PIC  X(010) VALUE SPACE.                  I.000421
001220*****02  F              PIC  X(002) VALUE SPACE.                  D.000421
001230     02  F              PIC  X(001) VALUE "1".
001240     02  F              PIC  X(004) VALUE SPACE.
001250     02  F              PIC  N(002) VALUE NC"３号".
001260     02  F              PIC  X(004) VALUE SPACE.
001270     02  F              PIC  N(002) VALUE NC"２号".
001280     02  F              PIC  X(004) VALUE SPACE.
001290     02  F              PIC  N(002) VALUE NC"１号".
001300     02  F              PIC  X(004) VALUE SPACE.
001310     02  F              PIC  N(002) VALUE NC"０号".
001320     02  F              PIC  X(004) VALUE SPACE.
001330     02  F              PIC  N(002) VALUE NC"　中".
001340     02  F              PIC  X(004) VALUE SPACE.
001350     02  F              PIC  N(002) VALUE NC"　大".
001360     02  F              PIC  X(004) VALUE SPACE.
001370     02  F              PIC  N(002) VALUE NC"特大".
001380     02  F              PIC  X(003) VALUE SPACE.
001390     02  F              PIC  X(004) VALUE "28.0".
001400     02  F              PIC  X(003) VALUE SPACE.
001410     02  F              PIC  X(004) VALUE "29.0".
001420     02  F              PIC  X(003) VALUE SPACE.
001430     02  F              PIC  X(004) VALUE "30.0".
001440     02  F              PIC  X(028) VALUE SPACE.                  I.000421
001450*****02  F              PIC  X(010) VALUE SPACE.                  D.000421
001460*01  HEAD3.                                                       D.000421
001470*****02  F              PIC  X(055) VALUE SPACE.                  D.000421
001480 01  HEAD4.                                                       I.000421
001490     02  F              PIC  X(037) VALUE SPACE.                  I.000421
001500     02  F              PIC  X(001) VALUE "2".
001510     02  F              PIC  X(003) VALUE SPACE.
001520     02  F              PIC  X(004) VALUE "12.5".
001530     02  F              PIC  X(003) VALUE SPACE.
001540     02  F              PIC  X(004) VALUE "13.0".
001550     02  F              PIC  X(003) VALUE SPACE.
001560     02  F              PIC  X(004) VALUE "13.5".
001570     02  F              PIC  X(003) VALUE SPACE.
001580     02  F              PIC  X(004) VALUE "14.0".
001590     02  F              PIC  X(003) VALUE SPACE.
001600     02  F              PIC  X(004) VALUE "15.0".
001610     02  F              PIC  X(003) VALUE SPACE.
001620     02  F              PIC  X(004) VALUE "16.0".
001630     02  F              PIC  X(003) VALUE SPACE.
001640     02  F              PIC  X(004) VALUE "17.0".
001650     02  F              PIC  X(003) VALUE SPACE.
001660     02  F              PIC  X(004) VALUE "18.0".
001670     02  F              PIC  X(003) VALUE SPACE.
001680     02  F              PIC  X(004) VALUE "19.0".
001690     02  F              PIC  X(003) VALUE SPACE.
001700     02  F              PIC  X(004) VALUE "20.0".
001710     02  F              PIC  X(028) VALUE SPACE.                  I.000421
001720*****02  F              PIC  X(010) VALUE SPACE.                  D.000421
001730*01  HEAD4.                                                       D.000421
001740*****02  F              PIC  X(055) VALUE SPACE.                  D.000421
001750 01  HEAD5.                                                       I.000421
001760     02  F              PIC  X(037) VALUE SPACE.                  I.000421
001770     02  F              PIC  X(001) VALUE "3".
001780     02  F              PIC  X(003) VALUE SPACE.
001790     02  F              PIC  X(004) VALUE "21.0".
001800     02  F              PIC  X(003) VALUE SPACE.
001810     02  F              PIC  X(004) VALUE "21.5".
001820     02  F              PIC  X(003) VALUE SPACE.
001830     02  F              PIC  X(004) VALUE "22.0".
001840     02  F              PIC  X(003) VALUE SPACE.
001850     02  F              PIC  X(004) VALUE "22.5".
001860     02  F              PIC  X(003) VALUE SPACE.
001870     02  F              PIC  X(004) VALUE "23.0".
001880     02  F              PIC  X(003) VALUE SPACE.
001890     02  F              PIC  X(004) VALUE "23.5".
001900     02  F              PIC  X(003) VALUE SPACE.
001910     02  F              PIC  X(004) VALUE "24.0".
001920     02  F              PIC  X(003) VALUE SPACE.
001930     02  F              PIC  X(004) VALUE "24.5".
001940     02  F              PIC  X(003) VALUE SPACE.
001950     02  F              PIC  X(004) VALUE "25.0".
001960     02  F              PIC  X(035) VALUE SPACE.                  I.000421
001970*****02  F              PIC  X(017) VALUE SPACE.                  D.000421
001980*01  HEAD5.                                                       D.000421
001990*****02  F              PIC  X(055) VALUE SPACE.                  D.000421
002000 01  HEAD6.                                                       I.000421
002010     02  F              PIC  X(037) VALUE SPACE.                  I.000421
002020     02  F              PIC  X(001) VALUE "4".
002030     02  F              PIC  X(003) VALUE SPACE.
002040     02  F              PIC  X(004) VALUE "24.0".
002050     02  F              PIC  X(003) VALUE SPACE.
002060     02  F              PIC  X(004) VALUE "24.5".
002070     02  F              PIC  X(003) VALUE SPACE.
002080     02  F              PIC  X(004) VALUE "25.0".
002090     02  F              PIC  X(003) VALUE SPACE.
002100     02  F              PIC  X(004) VALUE "25.5".
002110     02  F              PIC  X(003) VALUE SPACE.
002120     02  F              PIC  X(004) VALUE "26.0".
002130     02  F              PIC  X(003) VALUE SPACE.
002140     02  F              PIC  X(004) VALUE "26.5".
002150     02  F              PIC  X(003) VALUE SPACE.
002160     02  F              PIC  X(004) VALUE "27.0".
002170     02  F              PIC  X(003) VALUE SPACE.
002180     02  F              PIC  X(004) VALUE "27.5".
002190     02  F              PIC  X(016) VALUE SPACE.                  I.000421
002200     02  F              PIC  N(004) VALUE NC"ケース計".           I.000421
002210     02  F              PIC  X(004) VALUE SPACE.                  I.000421
002220     02  F              PIC  N(004) VALUE NC"足数合計".           I.000421
002230     02  F              PIC  X(004) VALUE SPACE.                  I.000421
002240     02  F              PIC  N(004) VALUE NC"　総合計".           I.000421
002250*****02  F              PIC  X(018) VALUE SPACE.                  D.000421
002260*****02  F              PIC  N(004) VALUE NC"　合　計".           D.000421
002270*01  W-P.                                                         D.000421
002280 01  W-P1.                                                        I.000421
002290     02  P-HCD          PIC  9(006).
002300     02  F              PIC  X(001).
002310     02  P-NAME         PIC  N(024).
002320     02  F              PIC  X(001).
002330     02  P-F            PIC  X(001).                              I.000421
002340     02  P-ISU          PIC ZZ9.                                  I.000421
002350     02  P-R            PIC  X(001).                              I.000421
002360     02  F              PIC  X(002).                              I.050510
002370     02  P-BC3          PIC  9(002).                              I.050510
002380     02  P-VER          PIC  X(001).                              I.050510
002390     02  P-BC1          PIC  9(002).                              I.050510
002400     02  F              PIC  X(042).                              I.050510
002410*****02  F              PIC  X(049).                              D.050510
002420     02  P-ZM           PIC  N(010).                              I.000509
002430     02  F              PIC  X(023).                              I.000509
002440*****02  F              PIC  X(087).                              D.000509
002450 01  W-P2.                                                        I.000421
002460     02  P-TM           PIC  N(012).                              I.000421
002470     02  P-SNO          PIC  9(001).
002480*****02  F              PIC  X(002).                              D.000421
002490     02  F              PIC  X(001).                              I.000421
002500     02  P-DNO1         PIC  9(002).
002510     02  P-V            PIC  X(001).
002520     02  P-DNO2         PIC  X(004).
002530     02  F              PIC  X(001).
002540     02  P-SM           PIC  N(006).                              I.000421
002550     02  P-SIZ          PIC  9(001).
002560     02  P-SUD.
002570       03  P-SU         PIC ---,--9  OCCURS  10.
002580     02  P-KST          PIC ----,--9.                             I.000421
002590     02  P-SST          PIC --,---,--9.                           I.000421
002600     02  P-AST          PIC --,---,--9.                           I.000421
002610*****02  P-SUG          PIC --,---,--9.                           D.000421
002620 01  W-ASU.
002630     02  W-SUD1.
002640       03  W-SU1        PIC S9(006)  OCCURS  10.                  I.990204
002650*****  03  W-SU1        PIC S9(005)  OCCURS  10.                  D.990204
002660     02  W-SUD2.
002670       03  W-SU2        PIC S9(006)  OCCURS  10.                  I.990204
002680*****  03  W-SU2        PIC S9(005)  OCCURS  10.                  D.990204
002690     02  W-SUD3.
002700       03  W-SU3        PIC S9(006)  OCCURS  10.                  I.990204
002710*****  03  W-SU3        PIC S9(005)  OCCURS  10.                  D.990204
002720     02  W-SUD4.
002730       03  W-SU4        PIC S9(006)  OCCURS  10.                  I.990204
002740*****  03  W-SU4        PIC S9(005)  OCCURS  10.                  D.990204
002750     02  W-SUD5.                                                  I.000421
002760       03  W-SU5        PIC S9(006)  OCCURS  10.                  I.000421
002770     02  W-SUD6.                                                  I.000421
002780       03  W-SU6        PIC S9(006)  OCCURS  10.                  I.000421
002790     02  W-SUD7.                                                  I.000421
002800       03  W-SU7        PIC S9(006)  OCCURS  10.                  I.000421
002810     02  W-SUD8.                                                  I.000421
002820       03  W-SU8        PIC S9(006)  OCCURS  10.                  I.000421
002830 01  W-SUD.
002840     02  W-SU           PIC S9(006)  OCCURS  10.                  I.990204
002850*****02  W-SU           PIC S9(005)  OCCURS  10.                  D.990204
002860 01  W-DATA.
002870     02  W-SNO          PIC  9(001).
002880     02  W-DNO          PIC  X(006).
002890     02  W-DNOD  REDEFINES W-DNO.
002900       03  W-DNO1       PIC  9(002).
002910       03  W-DNO2       PIC  X(004).
002920     02  W-HCD          PIC  9(006) VALUE ZERO.
002930     02  W-PAGE         PIC  9(003) VALUE ZERO.
002940     02  CNT            PIC  9(002).
002950     02  W-C            PIC  9(001).
002960     02  W-SC           PIC  9(001).
002970     02  W-ZCD.
002980       03  W-ZC         PIC  9(001) OCCURS  8.                    I.000421
002990*****  03  W-ZC         PIC  9(001) OCCURS  4.                    D.000421
003000     02  CHK.
003010       03  CHK1         PIC  9(001).
003020       03  CHK2         PIC  9(001).
003030       03  CHK3         PIC  9(001).
003040     02  W-DMM          PIC  9(001).
003050     02  W-PC           PIC  9(001).
003060     02  W-SEN          PIC  9(001).                              I.090317
003070     02  W-SE.
003080       03  W-SBC3       PIC  9(002).                              I.040507
003090       03  W-EBC3       PIC  9(002) VALUE 99.                     I.151106
003100*****  03  W-EBC3       PIC  9(002).                              D.151106
003110       03  W-SHCD       PIC  9(006).
003120       03  W-EHCD       PIC  9(006) VALUE 999999.                 I.151106
003130*****  03  W-EHCD       PIC  9(006).                              D.151106
003140     02  W-TC           PIC  9(001).                              I.000421
003150     02  W-TCD          PIC  9(001).                              I.000421
003160     02  W-ISU          PIC  9(003).                              I.000421
003170     02  W-T.                                                     I.000421
003180       03  W-KST        PIC S9(006).                              I.000421
003190       03  W-SST        PIC S9(007).                              I.000421
003200       03  W-HST        PIC S9(007).                              I.000421
003210       03  W-AST        PIC S9(007).                              I.000421
003220     02  WS-T.                                                    I.000421
003230       03  WS-KST       PIC S9(006).                              I.000421
003240       03  WS-SST       PIC S9(007).                              I.000421
003250       03  WS-HST       PIC S9(007).                              I.000421
003260       03  WS-AST       PIC S9(007).                              I.000421
003270     02  WA-AST         PIC S9(007).                              I.000421
003280*****02  W-SUG          PIC S9(006).                              D.000421
003290*****02  WS-SUG         PIC S9(006).                              D.000421
003300*****02  WA-SUG         PIC S9(007).                              D.000421
003310 01  ERR-STAT           PIC  X(002).
003320     COPY LSTAT.
003330 SCREEN SECTION.
003340 SD  C-CRT
003350     END STATUS IS ESTAT.
003360 01  C-CLEAR.
003370     02  LINE  1  CLEAR SCREEN.
003380 01  C-MID.
003390     02  LINE   3  COLUMN  10  PIC  N(023) VALUE
003400          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003410     02  LINE   4  COLUMN  10  PIC  N(023) VALUE
003420          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
003430     02  LINE   5  COLUMN  10  PIC  N(023) VALUE
003440          NC"＊＊＊　　品名別　棚卸チェックリスト　　＊＊＊".
003450     02  LINE   6  COLUMN  10  PIC  N(023) VALUE
003460          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
003470     02  LINE   7  COLUMN  10  PIC  N(023) VALUE
003480          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003490     02  LINE  10  COLUMN  20  PIC  X(032) VALUE                  I.090317
003500            "通常=0 , チェック=1 (玉島) ...  ".                   I.090317
003510     02  LINE  13.                                                I.040507
003520       03  COLUMN  20  PIC  X(022) VALUE                          I.040507
003530            "分類ｺｰﾄﾞ3     00 ～ 99".                             I.040507
003540       03  COLUMN  49  PIC  X(031) VALUE                          I.040515
003550            "(一　般=10,ワーク=20,教　育=30)".                    I.040515
003560*****  03  COLUMN  49  PIC  X(029) VALUE                          D.040515
003570*****       "(カジュ=10,ワーク=20,教育=30)".                      D.040515
003580     02  LINE  15  COLUMN  20  PIC  X(026) VALUE
003590          "品名ｺｰﾄﾞ  000000 ～ 999999".
003600     02  LINE  22  COLUMN  29  PIC  X(022) VALUE
003610          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003620 01  C-ACP.
003630     02  A-SEN   LINE  10  COLUMN  51  PIC  9(001)                I.090317
003640          USING W-SEN   CHECK OVERFLOW NO IFC.                    I.090317
003650     02  LINE  13.                                                I.040507
003660       03  A-SBC3  COLUMN  34  PIC  9(002)                        I.040507
003670            USING W-SBC3  CHECK OVERFLOW NO IFC.                  I.040507
003680       03  A-EBC3  COLUMN  40  PIC  9(002)                        I.040507
003690            USING W-EBC3  CHECK OVERFLOW NO IFC.                  I.040507
003700     02  LINE  15.
003710       03  A-SHCD  COLUMN  30  PIC  9(006)
003720            USING W-SHCD  CHECK OVERFLOW NO IFC.
003730       03  A-EHCD  COLUMN  40  PIC  9(006)
003740            USING W-EHCD  CHECK OVERFLOW NO IFC.
003750     02  A-DMM   LINE  22  COLUMN  46  PIC  9(001)
003760          USING W-DMM   CHECK OVERFLOW NO IFC.
003770 01  C-ERR.
003780     02  LINE  24.
003790       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
003800       03  E-ME1   COLUMN  15  PIC  X(025) VALUE
003810            "***  DATA ﾅｼ  ***        ".
003820       03  E-ME2   COLUMN  15  PIC  X(025) VALUE                  I.000509
003830            "***  HTIM ﾅｼ  ***        ".                          I.000509
003840       03  E-ME3   COLUMN  15  PIC  X(025) VALUE                  I.000509
003850            "***  HTIM REWRITE ｴﾗｰ  **".                          I.000509
003860       03  E-ME5   COLUMN  15  PIC  X(025) VALUE                  I.000509
003870            "***  ｲﾘｽｳ ZERO  ***      ".                          I.000509
003880       03  E-ME6   COLUMN  15  PIC  X(025) VALUE                  I.000509
003890            "***  ﾀﾝｶ ZERO  ***       ".                          I.000509
003900       03  E-KEY   COLUMN  45  PIC  X(007) FROM  HTI-KEY.         I.000509
003910       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".
003920       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003930       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003940       03  E-CL.
003950         04  COLUMN  1  PIC  X(040) VALUE
003960              "                                        ".
003970         04  COLUMN 41  PIC  X(040) VALUE
003980              "                                        ".
003990     COPY LIBSCR.
004000 PROCEDURE DIVISION.
004010 M-05.
004020     ACCEPT JS-SIGN.                                              I.090317
004030     IF JS-SIGN > 1                                               I.090317
004040         STOP RUN.                                                I.090317
004050     DISPLAY C-CLEAR.
004060     DISPLAY C-MID.
004070     COPY LIBCPR.
004080     MOVE DATE-02R TO H-DATE.
004090*
004100     PERFORM ACP-RTN THRU ACP-EX.                                 I.090317
004110     IF W-END NOT = 0                                             I.090317
004120         GO TO M-95.                                              I.090317
004130*M-01.                                                            D.090317
004140*****ACCEPT A-SBC3.                                               D.090317
004150*****IF ESTAT = PF9                                               D.090317
004160*****    DISPLAY C-CLEAR                                          D.090317
004170*****    STOP RUN.                                                D.090317
004180*****IF ESTAT NOT = HTB AND SKP                                   D.090317
004190*****    GO TO M-01.                                              D.090317
004200*M-02.                                                            D.090317
004210*****ACCEPT A-EBC3.                                               D.090317
004220*****IF ESTAT = BTB                                               D.090317
004230*****    GO TO M-01.                                              D.090317
004240*****IF ESTAT NOT = HTB AND SKP                                   D.090317
004250*****    GO TO M-02.                                              D.090317
004260*****IF W-SBC3 > W-EBC3                                           D.090317
004270*****    GO TO M-02.                                              D.090317
004280*M-03.                                                            D.090317
004290*****ACCEPT A-SHCD.                                               D.090317
004300*****IF ESTAT = PF9                                               D.090317
004310*****    DISPLAY C-CLEAR                                          D.090317
004320*****    STOP RUN.                                                D.090317
004330*****IF ESTAT = BTB                                               D.090317
004340*****    GO TO M-02.                                              D.090317
004350*****IF ESTAT NOT = HTB AND SKP                                   D.090317
004360*****    GO TO M-03.                                              D.090317
004370*M-04.                                                            D.090317
004380*****ACCEPT A-EHCD.                                               D.090317
004390*****IF ESTAT = BTB                                               D.090317
004400*****    GO TO M-03.                                              D.090317
004410*****IF ESTAT NOT = HTB AND SKP                                   D.090317
004420*****    GO TO M-04.                                              D.090317
004430*****IF W-SHCD > W-EHCD                                           D.090317
004440*****    GO TO M-04.                                              D.090317
004450*M-06.                                                            D.090317
004460*****ACCEPT A-DMM.                                                D.090317
004470*****IF ESTAT = BTB                                               D.090317
004480*****    GO TO M-04.                                              D.090317
004490*****IF ESTAT = HTB AND SKP                                       D.090317
004500*****    GO TO M-06.                                              D.090317
004510*****IF W-DMM = 9                                                 D.090317
004520*****    DISPLAY C-CLEAR                                          D.090317
004530*****    STOP RUN.                                                D.090317
004540*****IF W-DMM NOT = 1                                             D.090317
004550*****    GO TO M-06.                                              D.090317
004560*
004570     CALL "CBLSTNNO" USING STN-NO.                                I.950626
004580     MOVE STN-NO2 TO W-FID2.                                      I.950626
004590     MOVE W-FID TO WK0128ID.                                      I.990204
004600*****MOVE W-FID TO WK0085ID.                                      D.970520
004610*****MOVE W-FID TO WK0064ID.                                      D.990204
004620     OPEN INPUT HTIW-M.
004630 M-10.
004640     READ HTIW-M AT END
004650         DISPLAY E-ME1 E-ME99
004660         CLOSE HTIW-M
004670         DISPLAY C-CLEAR
004680         STOP RUN.
004690     IF W-SEN = 1                                                 I.090317
004700         IF HTIW-SNO NOT = 6                                      I.090317
004710             GO TO M-10                                           I.090317
004720           ELSE                                                   I.090317
004730             IF HTIW-BC3 = 30                                     I.090317
004740                 GO TO M-10.                                      I.090317
004750     IF HTIW-HCD < W-SHCD
004760         GO TO M-10.
004770     IF HTIW-HCD > W-EHCD
004780         DISPLAY E-ME1 E-ME99
004790         CLOSE HTIW-M
004800         DISPLAY C-CLEAR
004810         STOP RUN.
004820     IF HTIW-BC3 < W-SBC3 OR > W-EBC3                             I.040507
004830         GO TO M-10.                                              I.040507
004840*****MOVE ZERO TO WA-SUG.                                         D.000421
004850     MOVE ZERO TO WA-AST.                                         I.000421
004860     OPEN INPUT HI-M.
004870*****OPEN INPUT SHM.                                              D.010806
004880     IF JS-SIGN = 1                                               I.090317
004890         MOVE NC"Ｃ２" TO H-MID                                   I.090317
004900       ELSE                                                       I.090317
004910         OPEN I-O HTI-M                                           I.090317
004920         IF W-SEN = 1                                             I.090317
004930             MOVE NC"Ｃ１" TO H-MID.                              I.090317
004940*****    OPEN I-O HTI-M.                                          D.090317
004950     OPEN OUTPUT SP-F.
004960     PERFORM MID-010 THRU MID-EX.
004970 M-15.
004980     MOVE HTIW-HCD TO W-HCD.
004990     MOVE HTIW-ISU TO W-ISU.                                      I.000421
005000     MOVE W-HCD TO HI-KEY.
005010     READ HI-M WITH UNLOCK INVALID KEY
005020*****    MOVE ZERO TO HI-FT                                       D.010806
005030*****    MOVE ZERO TO HI-FT HI-ISU                                D.050510
005040         MOVE ZERO TO HI-FT HI-ISU HI-BC1 HI-BC3                  I.050510
005050         MOVE SPACE TO HI-NAME
005060         MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.
005070*****MOVE W-HCD TO SHM-KEY.                                       D.010806
005080*****READ SHM WITH UNLOCK INVALID KEY                             D.010806
005090*****    MOVE ZERO TO SHM-02.                                     D.010806
005100     IF JS-SIGN = 0                                               I.090317
005110         IF W-ISU = ZERO                                          I.000509
005120*****    IF SHM-02 NOT = ZERO                                     D.010806
005130             IF HI-ISU NOT = ZERO                                 I.010806
005140                 PERFORM REW-RTN THRU REW-EX.                     I.000509
005150     PERFORM ME1-RTN THRU ME1-EX.                                 I.000421
005160     MOVE ZERO TO W-ASU WS-T W-ZCD CHK W-C.                       I.000421
005170*****MOVE ZERO TO W-ASU WS-SUG W-ZCD CHK W-C.                     D.000421
005180 M-20.
005190     MOVE HTIW-SNO TO W-SNO.
005200     MOVE ZERO TO CHK2.
005210 M-25.
005220     MOVE HTIW-DNO TO W-DNO.
005230     MOVE ZERO TO W-T CHK3.                                       I.000421
005240*****MOVE ZERO TO W-SUG CHK3.                                     D.000421
005250 M-30.                                                            I.000421
005260     IF HTIW-GNO < 5                                              I.000421
005270         MOVE 1 TO W-TC                                           I.000421
005280       ELSE                                                       I.000421
005290         MOVE 2 TO W-TC.                                          I.000421
005300     MOVE 0 TO W-TCD.                                             I.000421
005310 M-35.
005320*****MOVE SPACE TO W-P.                                           D.000421
005330*****MOVE SPACE TO P-NAME.                                        D.000421
005340*****IF CHK1 = 0                                                  D.000421
005350*****    MOVE 5 TO CHK1                                           D.000421
005360*****    MOVE W-HCD TO P-HCD                                      D.000421
005370*****    MOVE HI-NAME TO P-NAME.                                  D.000421
005380     MOVE SPACE TO W-P2.                                          I.000421
005390     MOVE SPACE TO P-TM P-SM.                                     I.000421
005400     IF CHK2 = 0
005410         MOVE 5 TO CHK2
005420         MOVE W-SNO TO P-SNO.
005430     IF CHK3 = 0
005440         MOVE 5 TO CHK3
005450         MOVE W-DNO1 TO P-DNO1
005460         MOVE "-" TO P-V
005470         MOVE W-DNO2 TO P-DNO2.
005480     IF W-TC NOT = W-TCD                                          I.000421
005490         IF W-TC = 1                                              I.000421
005500             MOVE NC"［ケース］　" TO P-SM                        I.000421
005510           ELSE                                                   I.000421
005520             MOVE NC"［端　数］　" TO P-SM.                       I.000421
005530     MOVE HTIW-SIZ TO P-SIZ.                                      I.990204
005540*****IF HTIW-GNO = 1                                              D.990204
005550*****    MOVE 2 TO P-SIZ.                                         D.990204
005560*****IF HTIW-GNO = 2                                              D.990204
005570*****    MOVE 3 TO P-SIZ.                                         D.990204
005580*****IF HTIW-GNO = 3                                              D.990204
005590*****    MOVE 4 TO P-SIZ.                                         D.990204
005600*****IF HTIW-GNO = 4                                              D.990204
005610*****    MOVE 1 TO P-SIZ.                                         D.990204
005620     IF W-ZC(HTIW-GNO) = 0
005630         MOVE 1 TO W-ZC(HTIW-GNO).
005640     MOVE ZERO TO CNT.
005650 M-40.
005660     ADD 1 TO CNT.
005670     IF CNT = 11
005680         GO TO M-45.
005690*****IF HTIW-GNO = 2                                              D.000421
005700     IF HTIW-GNO = 2 OR 6                                         I.000421
005710         IF CNT > 9
005720             GO TO M-40.
005730*****IF HTIW-GNO = 3                                              D.000421
005740     IF HTIW-GNO = 3 OR 7                                         I.000421
005750         IF CNT > 8
005760             GO TO M-40.
005770     MOVE HTIW-SU(CNT) TO P-SU(CNT).
005780*****ADD HTIW-SU(CNT) TO W-SUG.                                   D.000421
005790     IF HTIW-GNO = 1
005800         ADD HTIW-SU(CNT) TO W-SU1(CNT) W-KST.                    I.000421
005810*****    ADD HTIW-SU(CNT) TO W-SU1(CNT) WS-SUG WA-SUG.            D.000421
005820     IF HTIW-GNO = 2
005830         ADD HTIW-SU(CNT) TO W-SU2(CNT) W-KST.                    I.000421
005840*****    ADD HTIW-SU(CNT) TO W-SU2(CNT) WS-SUG WA-SUG.            D.000421
005850     IF HTIW-GNO = 3
005860         ADD HTIW-SU(CNT) TO W-SU3(CNT) W-KST.                    I.000421
005870*****    ADD HTIW-SU(CNT) TO W-SU3(CNT) WS-SUG WA-SUG.            D.000421
005880     IF HTIW-GNO = 4
005890         ADD HTIW-SU(CNT) TO W-SU4(CNT) W-KST.                    I.000421
005900*****    ADD HTIW-SU(CNT) TO W-SU4(CNT) WS-SUG WA-SUG.            D.000421
005910     IF HTIW-GNO = 5                                              I.000421
005920         ADD HTIW-SU(CNT) TO W-SU5(CNT) W-HST.                    I.000421
005930     IF HTIW-GNO = 6                                              I.000421
005940         ADD HTIW-SU(CNT) TO W-SU6(CNT) W-HST.                    I.000421
005950     IF HTIW-GNO = 7                                              I.000421
005960         ADD HTIW-SU(CNT) TO W-SU7(CNT) W-HST.                    I.000421
005970     IF HTIW-GNO = 8                                              I.000421
005980         ADD HTIW-SU(CNT) TO W-SU8(CNT) W-HST.                    I.000421
005990     GO TO M-40.
006000 M-45.
006010     READ HTIW-M AT END
006020         GO TO M-90.
006030     IF W-SEN = 1                                                 I.090317
006040         IF HTIW-SNO NOT = 6                                      I.090317
006050             GO TO M-45                                           I.090317
006060           ELSE                                                   I.090317
006070             IF HTIW-BC3 = 30                                     I.090317
006080                 GO TO M-45.                                      I.090317
006090     IF HTIW-HCD > W-EHCD
006100         GO TO M-90.
006110     IF HTIW-BC3 < W-SBC3 OR > W-EBC3                             I.040507
006120         GO TO M-45.                                              I.040507
006130     IF HTIW-GNO < 5                                              I.000421
006140         MOVE 1 TO W-TCD                                          I.000421
006150       ELSE                                                       I.000421
006160         MOVE 2 TO W-TCD.                                         I.000421
006170*****IF HTIW-DNO = W-DNO                                          D.000421
006180     IF HTIW-DNO NOT = W-DNO                                      I.000421
006190         GO TO M-50.                                              I.000421
006200     IF W-TC = W-TCD                                              I.000421
006210         GO TO M-55.
006220     IF W-TC = 1                                                  I.000421
006230         COMPUTE W-SST = W-KST * W-ISU                            I.000421
006240         ADD W-KST TO WS-KST                                      I.000421
006250         ADD W-SST TO WS-SST                                      I.000421
006260         MOVE W-KST TO P-KST                                      I.000421
006270         MOVE W-SST TO P-SST                                      I.000421
006280       ELSE                                                       I.000421
006290         ADD W-HST TO WS-HST                                      I.000421
006300         MOVE W-HST TO P-SST.                                     I.000421
006310     GO TO M-55.                                                  I.000421
006320 M-50.                                                            I.000421
006330     IF W-TC = 1                                                  I.000421
006340         COMPUTE W-SST = W-KST * W-ISU                            I.000421
006350         ADD W-KST TO WS-KST                                      I.000421
006360         ADD W-SST TO WS-SST                                      I.000421
006370         MOVE W-KST TO P-KST                                      I.000421
006380         MOVE W-SST TO P-SST                                      I.000421
006390       ELSE                                                       I.000421
006400         ADD W-HST TO WS-HST                                      I.000421
006410         MOVE W-HST TO P-SST.                                     I.000421
006420     COMPUTE W-AST = W-SST + W-HST.                               I.000421
006430     ADD W-AST TO WS-AST WA-AST.                                  I.000421
006440     MOVE W-AST TO P-AST.                                         I.000421
006450*****MOVE W-SUG TO P-SUG.                                         D.000421
006460*****MOVE 9 TO CHK3.                                              D.000421
006470     IF W-C = 5
006480         MOVE 9 TO W-C.
006490     IF W-C = 0
006500         MOVE 5 TO W-C.
006510 M-55.
006520     PERFORM ME2-RTN THRU ME2-EX.
006530*****IF CHK3 = 9                                                  D.000421
006540*****    MOVE SPACE TO SP-R                                       D.000421
006550*****    WRITE SP-R.                                              D.000421
006560     IF HTIW-HCD NOT = W-HCD
006570         GO TO M-60.
006580     IF HTIW-SNO NOT = W-SNO
006590         GO TO M-20.
006600     IF HTIW-DNO NOT = W-DNO
006610         GO TO M-25.
006620     IF W-TC NOT = W-TCD                                          I.000421
006630         GO TO M-30.                                              I.000421
006640     GO TO M-35.
006650 M-60.
006660     MOVE SPACE TO SP-R.                                          I.000421
006670     WRITE SP-R.                                                  I.000421
006680     IF W-C = 9
006690         PERFORM SUB-RTN THRU SUB-EX.
006700     GO TO M-15.
006710 M-90.
006720     IF W-TC = 1                                                  I.000421
006730         COMPUTE W-SST = W-KST * W-ISU                            I.000421
006740         ADD W-KST TO WS-KST                                      I.000421
006750         ADD W-SST TO WS-SST                                      I.000421
006760         MOVE W-KST TO P-KST                                      I.000421
006770         MOVE W-SST TO P-SST                                      I.000421
006780       ELSE                                                       I.000421
006790         ADD W-HST TO WS-HST                                      I.000421
006800         MOVE W-HST TO P-SST.                                     I.000421
006810     COMPUTE W-AST = W-SST + W-HST.                               I.000421
006820     ADD W-AST TO WS-AST WA-AST.                                  I.000421
006830     MOVE W-AST TO P-AST.                                         I.000421
006840*****MOVE W-SUG TO P-SUG.                                         D.000421
006850     IF W-C = 5
006860         MOVE 9 TO W-C.
006870     IF W-C = 0
006880         MOVE 5 TO W-C.
006890     PERFORM ME2-RTN THRU ME2-EX.
006900     MOVE SPACE TO SP-R.
006910     WRITE SP-R.
006920     IF W-C = 9
006930         PERFORM SUB-RTN THRU SUB-EX.
006940     PERFORM ALL-RTN THRU ALL-EX.
006950*M-93.                                                            D.090317
006960     IF JS-SIGN = 0                                               I.090317
006970         CLOSE HTI-M.                                             I.090317
006980     CLOSE HI-M.
006990*****CLOSE SHM.                                                   D.010806
007000     CLOSE HTIW-M.
007010     CLOSE SP-F.
007020 M-95.                                                            I.090317
007030     DISPLAY C-CLEAR.
007040     STOP RUN.
007050 ACP-RTN.                                                         I.090317
007060     IF JS-SIGN = 1                                               I.090317
007070         MOVE 1 TO W-SEN                                          I.090317
007080         DISPLAY A-SEN                                            I.090317
007090         GO TO ACP-020.                                           I.090317
007100 ACP-010.                                                         I.090317
007110     ACCEPT A-SEN.                                                I.090317
007120     IF ESTAT = PF9                                               I.090317
007130         MOVE 1 TO W-END                                          I.090317
007140         GO TO ACP-EX.                                            I.090317
007150     IF ESTAT NOT = HTB AND SKP                                   I.090317
007160         GO TO ACP-010.                                           I.090317
007170     IF W-SEN > 1                                                 I.090317
007180         GO TO ACP-010.                                           I.090317
007190 ACP-020.                                                         I.090317
007200     ACCEPT A-SBC3.                                               I.090317
007210     IF ESTAT = PF9                                               I.090317
007220         MOVE 1 TO W-END                                          I.090317
007230         GO TO ACP-EX.                                            I.090317
007240     IF ESTAT = BTB                                               I.090317
007250         IF JS-SIGN = 0                                           I.090317
007260             GO TO ACP-010.                                       I.090317
007270     IF ESTAT NOT = HTB AND SKP                                   I.090317
007280         GO TO ACP-020.                                           I.090317
007290 ACP-030.                                                         I.090317
007300     ACCEPT A-EBC3.                                               I.090317
007310     IF ESTAT = BTB                                               I.090317
007320         GO TO ACP-020.                                           I.090317
007330     IF ESTAT NOT = HTB AND SKP                                   I.090317
007340         GO TO ACP-030.                                           I.090317
007350     IF W-SBC3 > W-EBC3                                           I.090317
007360         GO TO ACP-030.                                           I.090317
007370 ACP-040.                                                         I.090317
007380     ACCEPT A-SHCD.                                               I.090317
007390     IF ESTAT = PF9                                               I.090317
007400         MOVE 1 TO W-END                                          I.090317
007410         GO TO ACP-EX.                                            I.090317
007420     IF ESTAT = BTB                                               I.090317
007430         GO TO ACP-030.                                           I.090317
007440     IF ESTAT NOT = HTB AND SKP                                   I.090317
007450         GO TO ACP-040.                                           I.090317
007460 ACP-050.                                                         I.090317
007470     ACCEPT A-EHCD.                                               I.090317
007480     IF ESTAT = BTB                                               I.090317
007490         GO TO ACP-040.                                           I.090317
007500     IF ESTAT NOT = HTB AND SKP                                   I.090317
007510         GO TO ACP-050.                                           I.090317
007520     IF W-SHCD > W-EHCD                                           I.090317
007530         GO TO ACP-050.                                           I.090317
007540 ACP-090.                                                         I.090317
007550     ACCEPT A-DMM.                                                I.090317
007560     IF ESTAT = BTB                                               I.090317
007570         GO TO ACP-050.                                           I.090317
007580     IF ESTAT = HTB AND SKP                                       I.090317
007590         GO TO ACP-090.                                           I.090317
007600     IF W-DMM = 9                                                 I.090317
007610         GO TO ACP-RTN.                                           I.090317
007620     IF W-DMM NOT = 1                                             I.090317
007630         GO TO ACP-090.                                           I.090317
007640 ACP-EX.                                                          I.090317
007650     EXIT.                                                        I.090317
007660 MID-RTN.
007670     MOVE SPACE TO SP-R.
007680     WRITE SP-R AFTER PAGE.
007690 MID-010.
007700     ADD 1 TO W-PAGE.
007710     MOVE W-PAGE TO H-PAGE.
007720     MOVE SPACE TO SP-R.
007730     MOVE HEAD1 TO SP-R.
007740     WRITE SP-R.
007750     MOVE SPACE TO SP-R.
007760     MOVE HEAD2 TO SP-R.
007770     WRITE SP-R AFTER 2.
007780     MOVE SPACE TO SP-R.
007790     MOVE HEAD3 TO SP-R.
007800     WRITE SP-R.
007810     MOVE SPACE TO SP-R.
007820     MOVE HEAD4 TO SP-R.
007830     WRITE SP-R.
007840     MOVE SPACE TO SP-R.
007850     MOVE HEAD5 TO SP-R.
007860     WRITE SP-R.
007870     MOVE SPACE TO SP-R.
007880     MOVE HEAD6 TO SP-R.                                          I.000421
007890     WRITE SP-R.
007900     MOVE SPACE TO SP-R.                                          I.000421
007910 MID-EX.
007920     EXIT.
007930 ME1-RTN.                                                         I.000421
007940     MOVE SPACE TO W-P1.                                          I.000421
007950*****MOVE SPACE TO P-NAME.                                        D.000509
007960     MOVE SPACE TO P-NAME P-ZM.                                   I.000509
007970     MOVE W-HCD TO P-HCD.                                         I.000421
007980     MOVE HI-NAME TO P-NAME.                                      I.000421
007990     MOVE "(" TO P-F.                                             I.000421
008000     MOVE W-ISU TO P-ISU.                                         I.000421
008010     MOVE ")" TO P-R.                                             I.000421
008020     MOVE HI-BC3 TO P-BC3.                                        I.050510
008030     MOVE "-" TO P-VER.                                           I.050510
008040     MOVE HI-BC1 TO P-BC1.                                        I.050510
008050     IF ZERO = HI-FT AND W-ISU                                    I.000509
008060         MOVE NC"　（単価０，入数０）" TO P-ZM.                   I.000509
008070     IF HI-FT = ZERO                                              I.000509
008080         IF W-ISU NOT = ZERO                                      I.000509
008090             MOVE NC"　　　　　（単価０）" TO P-ZM.               I.000509
008100     IF W-ISU = ZERO                                              I.000509
008110         IF HI-FT NOT = ZERO                                      I.000509
008120             MOVE NC"　　　　　（入数０）" TO P-ZM.               I.000509
008130*****IF LINAGE-COUNTER > 59                                       D.070205
008140     IF LINAGE-COUNTER > 61                                       I.070205
008150         PERFORM MID-RTN THRU MID-EX.                             I.000421
008160     MOVE SPACE TO SP-R.                                          I.000421
008170     MOVE W-P1 TO SP-R.                                           I.000421
008180     WRITE SP-R.                                                  I.000421
008190     MOVE SPACE TO SP-R.                                          I.000421
008200 ME1-EX.                                                          I.000421
008210     EXIT.                                                        I.000421
008220 ME2-RTN.
008230*****IF LINAGE-COUNTER NOT > 60                                   D.070205
008240     IF LINAGE-COUNTER NOT > 62                                   I.070205
008250         GO TO ME2-010.                                           I.000421
008260*****IF LINAGE-COUNTER > 59                                       D.000421
008270*****    MOVE W-HCD TO P-HCD                                      D.000421
008280*****    MOVE HI-NAME TO P-NAME                                   D.000421
008290*****    MOVE W-SNO TO P-SNO                                      D.000421
008300*****    MOVE W-DNO1 TO P-DNO1                                    D.000421
008310*****    MOVE "-" TO P-V                                          D.000421
008320*****    MOVE W-DNO2 TO P-DNO2                                    D.000421
008330     PERFORM MID-RTN THRU MID-EX.
008340     PERFORM ME1-RTN THRU ME1-EX.                                 I.000421
008350     MOVE W-SNO TO P-SNO.                                         I.000421
008360     MOVE W-DNO1 TO P-DNO1.                                       I.000421
008370     MOVE "-" TO P-V.                                             I.000421
008380     MOVE W-DNO2 TO P-DNO2.                                       I.000421
008390     IF W-TC = 1                                                  I.000421
008400         MOVE NC"［ケース］　" TO P-SM                            I.000421
008410       ELSE                                                       I.000421
008420         MOVE NC"［端　数］　" TO P-SM.                           I.000421
008430 ME2-010.                                                         I.000421
008440     MOVE SPACE TO SP-R.
008450*****MOVE W-P TO SP-R.                                            D.000421
008460     MOVE W-P2 TO SP-R.                                           I.000421
008470     WRITE SP-R.
008480     MOVE SPACE TO SP-R.
008490 ME2-EX.
008500     EXIT.
008510 SUB-RTN.
008520     MOVE ZERO TO W-SC CHK.
008530 SUB-010.
008540     ADD 1 TO W-SC.
008550*****IF W-SC = 5                                                  D.000421
008560*****    WRITE SP-R                                               D.000421
008570     IF W-SC = 9                                                  I.000421
008580         GO TO SUB-EX.
008590     IF W-ZC(W-SC) = 0
008600         GO TO SUB-010.
008610*
008620*****MOVE SPACE TO W-P.
008630*****MOVE SPACE TO P-NAME.                                        D.000421
008640     MOVE SPACE TO W-P2.                                          I.000421
008650     MOVE SPACE TO P-TM P-SM.                                     I.000421
008660     IF CHK1 = 0
008670         MOVE 5 TO CHK1
008680         MOVE NC"　　　　　　［　合計　］" TO P-TM.               I.000421
008690*****    MOVE NC"　　　　　　　　　　［　合　計　］　" TO P-NAME. D.000421
008700     MOVE ZERO TO W-SUD.
008710     IF W-SC = 1
008720         MOVE W-SUD1 TO W-SUD
008730         MOVE 2 TO P-SIZ                                          I.000421
008740         MOVE NC"［ケース］　" TO P-SM.                           I.000421
008750*****    MOVE 2 TO P-SIZ.                                         D.000421
008760     IF W-SC = 2
008770         MOVE W-SUD2 TO W-SUD
008780         MOVE 3 TO P-SIZ                                          I.000421
008790         IF ZERO = W-ZC(1)                                        I.000421
008800             MOVE NC"［ケース］　" TO P-SM.                       I.000421
008810*****    MOVE 3 TO P-SIZ.                                         D.000421
008820     IF W-SC = 3
008830         MOVE W-SUD3 TO W-SUD
008840         MOVE 4 TO P-SIZ                                          I.000421
008850         IF ZERO = W-ZC(1) AND W-ZC(2)                            I.000421
008860             MOVE NC"［ケース］　" TO P-SM.                       I.000421
008870*****    MOVE 4 TO P-SIZ.                                         D.000421
008880     IF W-SC = 4
008890         MOVE W-SUD4 TO W-SUD
008900         MOVE 1 TO P-SIZ                                          I.000421
008910         IF ZERO = W-ZC(1) AND W-ZC(2) AND W-ZC(3)                I.000421
008920             MOVE NC"［ケース］　" TO P-SM.                       I.000421
008930*****    MOVE 1 TO P-SIZ.                                         D.000421
008940     IF W-SC = 5                                                  I.000421
008950         MOVE W-SUD5 TO W-SUD                                     I.000421
008960         MOVE 2 TO P-SIZ                                          I.000421
008970         MOVE NC"［端　数］　" TO P-SM.                           I.000421
008980     IF W-SC = 6                                                  I.000421
008990         MOVE W-SUD6 TO W-SUD                                     I.000421
009000         MOVE 3 TO P-SIZ                                          I.000421
009010         IF ZERO = W-ZC(5)                                        I.000421
009020             MOVE NC"［端　数］　" TO P-SM.                       I.000421
009030     IF W-SC = 7                                                  I.000421
009040         MOVE W-SUD7 TO W-SUD                                     I.000421
009050         MOVE 4 TO P-SIZ                                          I.000421
009060         IF ZERO = W-ZC(5) AND W-ZC(6)                            I.000421
009070             MOVE NC"［端　数］　" TO P-SM.                       I.000421
009080     IF W-SC = 8                                                  I.000421
009090         MOVE W-SUD8 TO W-SUD                                     I.000421
009100         MOVE 1 TO P-SIZ                                          I.000421
009110         IF ZERO = W-ZC(5) AND W-ZC(6) AND W-ZC(7)                I.000421
009120             MOVE NC"［端　数］　" TO P-SM.                       I.000421
009130     MOVE ZERO TO CNT.
009140 SUB-020.
009150     ADD 1 TO CNT.
009160     IF CNT = 11
009170         GO TO SUB-030.
009180*****IF W-SC = 2                                                  D.000421
009190     IF W-SC = 2 OR 6                                             I.000421
009200         IF CNT > 9
009210             GO TO SUB-020.
009220*****IF W-SC = 3                                                  D.000421
009230     IF W-SC = 3 OR 7                                             I.000421
009240         IF CNT > 8
009250             GO TO SUB-020.
009260     MOVE W-SU(CNT) TO P-SU(CNT).
009270     GO TO SUB-020.
009280 SUB-030.
009290     IF W-SC = 1
009300         IF ZERO = W-ZC(2) AND W-ZC(3) AND W-ZC(4)
009310             MOVE WS-KST TO P-KST                                 I.000421
009320             MOVE WS-SST TO P-SST                                 I.000421
009330             IF ZERO = W-ZC(5) AND W-ZC(6) AND W-ZC(7)            I.000421
009340                                           AND W-ZC(8)            I.000421
009350                 MOVE WS-AST TO P-AST.                            I.000421
009360*****        MOVE WS-SUG TO P-SUG.                                D.000421
009370     IF W-SC = 2
009380         IF ZERO = W-ZC(3) AND W-ZC(4)
009390             MOVE WS-KST TO P-KST                                 I.000421
009400             MOVE WS-SST TO P-SST                                 I.000421
009410             IF ZERO = W-ZC(5) AND W-ZC(6) AND W-ZC(7)            I.000421
009420                                           AND W-ZC(8)            I.000421
009430                 MOVE WS-AST TO P-AST.                            I.000421
009440*****        MOVE WS-SUG TO P-SUG.                                D.000421
009450     IF W-SC = 3
009460         IF ZERO = W-ZC(4)
009470             MOVE WS-KST TO P-KST                                 I.000421
009480             MOVE WS-SST TO P-SST                                 I.000421
009490             IF ZERO = W-ZC(5) AND W-ZC(6) AND W-ZC(7)            I.000421
009500                                           AND W-ZC(8)            I.000421
009510                 MOVE WS-AST TO P-AST.                            I.000421
009520*****        MOVE WS-SUG TO P-SUG.                                D.000421
009530     IF W-SC = 4
009540         MOVE WS-KST TO P-KST                                     I.000421
009550         MOVE WS-SST TO P-SST                                     I.000421
009560         IF ZERO = W-ZC(5) AND W-ZC(6) AND W-ZC(7) AND W-ZC(8)    I.000421
009570             MOVE WS-AST TO P-AST.                                I.000421
009580     IF W-SC = 5                                                  I.000421
009590         IF ZERO = W-ZC(6) AND W-ZC(7) AND W-ZC(8)                I.000421
009600             MOVE WS-HST TO P-SST                                 I.000421
009610             MOVE WS-AST TO P-AST.                                I.000421
009620     IF W-SC = 6                                                  I.000421
009630         IF ZERO = W-ZC(7) AND W-ZC(8)                            I.000421
009640             MOVE WS-HST TO P-SST                                 I.000421
009650             MOVE WS-AST TO P-AST.                                I.000421
009660     IF W-SC = 7                                                  I.000421
009670         IF ZERO = W-ZC(8)                                        I.000421
009680             MOVE WS-HST TO P-SST                                 I.000421
009690             MOVE WS-AST TO P-AST.                                I.000421
009700     IF W-SC = 8                                                  I.000421
009710         MOVE WS-HST TO P-SST                                     I.000421
009720         MOVE WS-AST TO P-AST.                                    I.000421
009730*****    MOVE WS-SUG TO P-SUG.                                    D.000421
009740*****IF LINAGE-COUNTER > 59                                       D.000421
009750*****    MOVE NC"　　　　　　　　　　［　合　計　］　" TO P-NAME  D.000421
009760*****    PERFORM MID-RTN THRU MID-EX.                             D.000421
009770*****IF LINAGE-COUNTER > 60                                       D.070205
009780     IF LINAGE-COUNTER > 62                                       I.070205
009790         PERFORM MID-RTN THRU MID-EX                              I.000421
009800         PERFORM ME1-RTN THRU ME1-EX                              I.000421
009810         MOVE NC"　　　　　　［　合計　］" TO P-TM                I.000421
009820         IF W-SC < 5                                              I.000421
009830             MOVE NC"［ケース］　" TO P-SM                        I.000421
009840           ELSE                                                   I.000421
009850             MOVE NC"［端　数］　" TO P-SM.                       I.000421
009860     MOVE SPACE TO SP-R.
009870*****MOVE W-P TO SP-R.                                            D.000421
009880     MOVE W-P2 TO SP-R.                                           I.000421
009890     WRITE SP-R.
009900     MOVE SPACE TO SP-R.
009910     GO TO SUB-010.
009920 SUB-EX.
009930     EXIT.
009940 ALL-RTN.
009950*****MOVE SPACE TO W-P.                                           D.000421
009960*****MOVE SPACE TO P-NAME.                                        D.000421
009970*****MOVE NC"　　　　　【　総　合　計　】　" TO P-NAME.           D.000421
009980*****MOVE WA-SUG TO P-SUG.                                        D.000421
009990     MOVE SPACE TO W-P2.                                          I.000421
010000     MOVE SPACE TO P-TM P-SM.                                     I.000421
010010     MOVE NC"　　【　総　合　計　】　" TO P-TM.                   I.000421
010020     MOVE WA-AST TO P-AST.                                        I.000421
010030*****IF LINAGE-COUNTER > 59                                       D.070205
010040     IF LINAGE-COUNTER > 61                                       I.070205
010050         PERFORM MID-RTN THRU MID-EX.
010060     MOVE SPACE TO SP-R.
010070*****MOVE W-P TO SP-R.                                            D.000421
010080*****WRITE SP-R.                                                  D.000421
010090     MOVE W-P2 TO SP-R.                                           I.000421
010100     WRITE SP-R AFTER 2.                                          I.000421
010110     MOVE SPACE TO SP-R.
010120 ALL-EX.
010130     EXIT.
010140 REW-RTN.                                                         I.000509
010150     MOVE HTIW-KEY TO HTI-KEY.                                    I.000509
010160     READ HTI-M INVALID KEY                                       I.000509
010170         DISPLAY E-ME2 E-ME99                                     I.000509
010180         DISPLAY E-CL                                             I.000509
010190         GO TO REW-EX.                                            I.000509
010200*****MOVE SHM-02 TO HTI-ISU W-ISU.                                D.010806
010210     MOVE HI-ISU TO HTI-ISU W-ISU.                                I.010806
010220     REWRITE HTI-R INVALID KEY                                    I.000509
010230         DISPLAY E-STAT E-ME3 E-KEY E-ME99                        I.000509
010240         DISPLAY E-CL.                                            I.000509
010250 REW-EX.                                                          I.000509
010260     EXIT.                                                        I.000509
