000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMM220.
000030*********************************************************
000040*    PROGRAM         :  直送先　名簿　　　　　　　　    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*        変更　　　  :  62/03/27                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT TC-M ASSIGN TO TC-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE DYNAMIC
000190         RECORD KEY TC-KEY
000200         FILE STATUS IS ERR-STAT.
000210     SELECT SP-F1 ASSIGN TO P1-PRN999-FHM220.
000220     SELECT SP-F2 ASSIGN TO P2-PRN999-FHM230.
000230 I-O-CONTROL.
000240     APPLY SHARED-MODE ON TC-M
000250     APPLY SHIFT-CODE  ON SP-F1                                   A 62/03
000260     APPLY SHIFT-CODE  ON SP-F2.                                  A 62/03
000270 DATA DIVISION.
000280 FILE SECTION.
000290     COPY LITCM.
000300 FD  SP-F1
000310     LABEL RECORD IS OMITTED
000320     LINAGE IS 66 LINES.
000330 01  SP-R1              PIC  X(206).
000340 FD  SP-F2
000350     LABEL RECORD IS OMITTED
000360     LINAGE IS 66 LINES.
000370 01  SP-R2              PIC  X(206).
000380 WORKING-STORAGE SECTION.
000390 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
000400 01  HEAD11.
000410     02  F              PIC  X(005) VALUE ""3FE04FE080"".
000420*****02  F              PIC  X(034) VALUE SPACE.                  D.970123
000430     02  F              PIC  X(038) VALUE SPACE.                  I.970123
000440     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".
000450     02  H-PM11A        PIC  N(008).
000460     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
000470     02  F              PIC  X(036) VALUE SPACE.
000480     02  H-PM11B        PIC  X(025).
000490 01  HEAD12.
000500     02  F              PIC  X(005) VALUE ""3FE04FE080"".
000510*****02  F              PIC  X(029) VALUE SPACE.                  D.970123
000520     02  F              PIC  X(034) VALUE SPACE.                  I.970123
000530     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".
000540     02  H-PM12A        PIC  N(008).
000550     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
000560     02  F              PIC  X(030) VALUE SPACE.
000570     02  H-PM12B        PIC  X(025).
000580 01  HEAD21.
000590     02  F              PIC  X(015) VALUE "  コード       ".
000600*****02  H-PM21         PIC  X(113).                              D.970123
000610     02  H-PM21         PIC  X(117).                              I.970123
000620 01  HEAD22.
000630     02  F              PIC  X(005) VALUE SPACE.
000640*****02  H-PM22         PIC  X(113).                              D.970123
000650     02  H-PM22         PIC  X(117).                              I.970123
000660 01  W-P1.
000670     02  P-15K1         PIC  X(005).
000680     02  F              PIC  X(001).
000690     02  P-TCD1         PIC  9(004).
000700     02  F              PIC  X(001).
000710     02  P-CCD1         PIC  9(003).
000720     02  F              PIC  X(002).
000730*****02  P-PM1          PIC  X(150).                              D.970123
000740     02  P-PM1          PIC  X(154).                              I.970123
000750 01  W-P2.
000760     02  P-15K2         PIC  X(005).
000770     02  F              PIC  X(001).
000780*****02  P-PM2          PIC  X(150).                              D.970123
000790     02  P-PM2          PIC  X(154).                              I.970123
000800 01  W-PM.
000810     02  W-PMH1A        PIC  N(008) VALUE NC"履物直送先　名簿".
000820     02  W-PMH1B.
000830       03  F            PIC  N(003) VALUE NC"作成日".
000840       03  H-DATE       PIC B99B99B99.
000850       03  F            PIC  X(007) VALUE "     P.".
000860       03  H-PAGE       PIC ZZ9.
000870     02  W-PMH2.
000880       03  F            PIC  N(010) VALUE
000890            NC"直　　送　　先　　名".
000900*****  03  F            PIC  X(013) VALUE SPACE.                  D.970123
000910       03  F            PIC  X(014) VALUE SPACE.                  I.970123
000920       03  F            PIC  N(004) VALUE NC"郵便番号".
000930*****  03  F            PIC  X(014) VALUE SPACE.                  D.970123
000940       03  F            PIC  X(015) VALUE SPACE.                  I.970123
000950       03  F            PIC  N(010) VALUE
000960            NC"住　　　　　　　　所".
000970       03  F            PIC  X(024) VALUE SPACE.
000980       03  F            PIC  X(014) VALUE " 電 話 番 号  ".
000990       03  F            PIC  X(002) VALUE SPACE.                  I.970123
001000     02  W-PMD.
001010       03  P-15K2D        PIC  X(005).                            I.030515
001020       03  P-CNA        PIC  N(024).
001030       03  F            PIC  X(002).
001040*****  03  P-UNO        PIC  X(006).                              D.970123
001050       03  P-UNO        PIC  X(008).                              I.970123
001060       03  F            PIC  X(002).
001070       03  P-ZU         PIC  N(024).
001080       03  F            PIC  X(002).
001090       03  P-ZS         PIC  N(012).
001100       03  F            PIC  X(002).
001110*****  03  P-TEL        PIC  X(012).                              D.970123
001120       03  P-TEL        PIC  X(014).                              I.970123
001130 01  W-D.
001140     02  W-DMM          PIC  9(001).
001150     02  W-PC           PIC  9(001).
001160     02  W-TCD          PIC  9(004).
001170     02  W-SEKEY.
001180       03  W-SKEY       PIC  9(004).
001190       03  W-EKEY       PIC  9(004).
001200     02  W-PAGE         PIC  9(003).
001210     02  CNT            PIC  9(002).
001220 01  ERR-STAT           PIC  X(002).
001230     COPY LSTAT.
001240 SCREEN SECTION.
001250 SD  C-CRT
001260     END STATUS ESTAT.
001270 01  C-CLEAR.
001280     02  LINE   1  CLEAR SCREEN.
001290 01  C-MID.
001300     02  LINE   3  COLUMN  10  PIC  N(016) VALUE
001310          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001320     02  LINE   4  COLUMN  10  PIC  N(016) VALUE
001330          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001340     02  LINE   5  COLUMN  10  PIC  N(016) VALUE
001350          NC"＊＊＊　　　　　　　　　　＊＊＊".
001360     02  LINE   6  COLUMN  10  PIC  N(016) VALUE
001370          NC"＊＊＊　　直送先　名簿　　＊＊＊".
001380     02  LINE   7  COLUMN  10  PIC  N(016) VALUE
001390          NC"＊＊＊　　　　　　　　　　＊＊＊".
001400     02  LINE   8  COLUMN  10  PIC  N(016) VALUE
001410          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001420     02  LINE   9  COLUMN  10  PIC  N(016) VALUE
001430          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001440     02  LINE  12  COLUMN   9  PIC  X(034) VALUE
001450          "得意先ｺｰﾄﾞ      より      迄打出し".
001460     02  LINE  15  COLUMN   8  PIC  X(036) VALUE
001470          "直送先ｺｰﾄﾞ  PRINT  ｽﾙ=1 ｼﾅｲ=5   ﾘﾀｰﾝ".
001480     02  LINE  20  COLUMN  15  PIC  X(022) VALUE
001490          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
001500 01  C-ACP.
001510     02  LINE  12.
001520       03  A-SKEY  COLUMN  20  PIC  9(004)
001530            USING W-SKEY  CHECK OVERFLOW NO IFC.
001540       03  A-EKEY  COLUMN  30  PIC  9(004)
001550            USING W-EKEY  CHECK OVERFLOW NO IFC.
001560     02  A-PC    LINE  15  COLUMN  39  PIC  9(001)
001570          USING W-PC    CHECK OVERFLOW NO IFC.
001580     02  A-DMM   LINE  20  COLUMN  32  PIC  9(001)
001590          USING W-DMM   CHECK OVERFLOW NO IFC.
001600 01  C-ERR.
001610     02  LINE  24.
001620       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
001630            "***  TC-M ﾅｼ  ***".
001640       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001650       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001660       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
001670       03  E-CL    COLUMN  10  PIC  X(050) VALUE
001680            "                                                  ".
001690 PROCEDURE DIVISION.
001700 M-05.
001710     DISPLAY C-CLEAR.
001720     DISPLAY C-MID.
001730     MOVE ZERO TO W-SEKEY.
001740 M-10.
001750     ACCEPT A-SKEY.
001760     IF ESTAT NOT = HTB AND SKP
001770         GO TO M-10.
001780 M-15.
001790     ACCEPT A-EKEY.
001800     IF ESTAT = BTB
001810         GO TO M-10.
001820     IF ESTAT NOT = HTB AND SKP
001830         GO TO M-15.
001840     IF W-SKEY > W-EKEY
001850         GO TO M-15.
001860 M-20.
001870     ACCEPT A-PC.
001880     IF ESTAT = BTB
001890         GO TO M-15.
001900     IF ESTAT NOT = HTB AND SKP
001910         GO TO M-20.
001920     IF W-PC NOT = 1 AND 5
001930         GO TO M-20.
001940 M-25.
001950     ACCEPT A-DMM.
001960     IF ESTAT = BTB
001970         GO TO M-20.
001980     IF ESTAT NOT = HTB AND SKP
001990         GO TO M-25.
002000     IF W-DMM = 9
002010         DISPLAY C-CLEAR
002020         STOP RUN.
002030     IF W-DMM NOT = 1
002040         GO TO M-25.
002050 M-30.
002060     OPEN INPUT TC-M.
002070     MOVE ZERO TO TC-KEY.
002080     MOVE W-SKEY TO TC-TCD.
002090     START TC-M KEY NOT < TC-KEY INVALID KEY
002100         DISPLAY E-ME1 E-ME99
002110         GO TO M-95.
002120     READ TC-M NEXT RECORD WITH UNLOCK AT END
002130         DISPLAY E-ME1 E-ME99
002140         GO TO M-95.
002150     IF TC-TCD > W-EKEY
002160         DISPLAY E-ME1 E-ME99
002170         GO TO M-95.
002180     IF TC-TCD = 9999
002190         DISPLAY E-ME1 E-ME99
002200         GO TO M-95.
002210     ACCEPT H-DATE FROM DATE.
002220     IF W-PC = 1
002230         OPEN OUTPUT SP-F1
002240         MOVE W-PMH1A TO H-PM11A
002250         MOVE W-PMH2 TO H-PM21
002260       ELSE
002270         OPEN OUTPUT SP-F2
002280         MOVE W-PMH1A TO H-PM12A
002290         MOVE W-PMH2 TO H-PM22.
002300     MOVE ZERO TO W-PAGE W-DMM.
002310     PERFORM S-10 THRU S-15.
002320 M-35.
002330     ADD 1 TO CNT.
002340     IF CNT < 60
002350         GO TO M-40.
002360     PERFORM S-05 THRU S-15.
002370     GO TO M-35.
002380 M-40.
002390     MOVE TC-TCD TO W-TCD.
002400     MOVE SPACE TO W-PMD.
002410     MOVE W-15K TO P-15K2D.                                       I.030515
002420     MOVE TC-NAME TO P-CNA.
002430     MOVE TC-UNO TO P-UNO.
002440     MOVE TC-JSU TO P-ZU.
002450     MOVE TC-JSS TO P-ZS.
002460     MOVE TC-TEL TO P-TEL.
002470     IF W-PC NOT = 1
002480         MOVE SPACE TO W-P2
002490         MOVE W-15K TO P-15K2
002500         MOVE W-PMD TO P-PM2
002510         MOVE W-P2 TO SP-R2
002520         WRITE SP-R2
002530         MOVE SPACE TO SP-R2
002540         GO TO M-45.
002550     MOVE SPACE TO W-P1.
002560     MOVE W-15K TO P-15K1.
002570     IF W-DMM = 0
002580         MOVE 5 TO W-DMM
002590         MOVE TC-TCD TO P-TCD1.
002600     MOVE TC-CCD TO P-CCD1.
002610     MOVE W-PMD TO P-PM1.
002620     MOVE W-P1 TO SP-R1.
002630     WRITE SP-R1.
002640     MOVE SPACE TO SP-R1.
002650 M-45.
002660     READ TC-M NEXT RECORD WITH UNLOCK AT END
002670         GO TO M-90.
002680     IF TC-TCD > W-EKEY
002690         GO TO M-90.
002700     IF TC-TCD = 9999
002710         GO TO M-90.
002720     IF TC-TCD NOT = W-TCD
002730         MOVE 0 TO W-DMM.
002740     GO TO M-35.
002750 M-90.
002760     IF W-PC = 1
002770         CLOSE SP-F1
002780       ELSE
002790         CLOSE SP-F2.
002800 M-95.
002810     CLOSE TC-M.
002820     DISPLAY C-CLEAR.
002830     STOP RUN.
002840 S-05.
002850     IF W-PC = 1
002860         MOVE SPACE TO SP-R1
002870         WRITE SP-R1 AFTER PAGE
002880       ELSE
002890         MOVE SPACE TO SP-R2
002900         WRITE SP-R2 AFTER PAGE.
002910 S-10.
002920     ADD 1 TO W-PAGE.
002930     MOVE W-PAGE TO H-PAGE.
002940     IF W-PC = 1
002950         MOVE W-PMH1B TO H-PM11B
002960         MOVE SPACE TO SP-R1
002970         MOVE HEAD11 TO SP-R1
002980         WRITE SP-R1
002990         MOVE SPACE TO SP-R1
003000         MOVE HEAD21 TO SP-R1
003010         WRITE SP-R1 AFTER 2
003020         MOVE SPACE TO SP-R1
003030       ELSE
003040         MOVE W-PMH1B TO H-PM12B
003050         MOVE SPACE TO SP-R2
003060         MOVE HEAD12 TO SP-R2
003070         WRITE SP-R2
003080         MOVE SPACE TO SP-R2
003090         MOVE HEAD22 TO SP-R2
003100         WRITE SP-R2 AFTER 2
003110         MOVE SPACE TO SP-R2.
003120     MOVE ZERO TO CNT W-DMM.
003130 S-15.
003140     EXIT.
