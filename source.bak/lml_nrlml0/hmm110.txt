000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID.      HMM110.
000030*********************************************************
000040*    PROGRAM         :  履物品名マスターメンテナンス    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHM11                          *
000070*    DATA WRITTN     :  01/  /                          *
000080*    COMPILE TYPE    :  COBOL                           *
000090*    JS-SIGN         :  0=メンテ , 1=問合せ             *
000100*********************************************************
000110 ENVIRONMENT      DIVISION.
000120 CONFIGURATION    SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT     SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.
000180     SELECT HI-M ASSIGN TO HIM1-MSD HIM2-MSD
000190         ORGANIZATION IS INDEXED
000200         ACCESS MODE IS DYNAMIC
000210         RECORD KEY IS HI-KEY
000220         ALTERNATE RECORD KEY HI-KEY2
000230         FILE STATUS IS ERR-STAT.
000240     SELECT HUH-M ASSIGN TO HUH-MSD
000250         ORGANIZATION IS INDEXED
000260         ACCESS MODE IS DYNAMIC
000270         RECORD KEY IS HUH-KEY
000280         FILE STATUS IS ERR-STAT.
000290     SELECT HHTF ASSIGN TO HHT1-MSD HHT2-MSD
000300         ORGANIZATION IS INDEXED
000310         ACCESS MODE IS DYNAMIC
000320         RECORD KEY IS HHT-KEY
000330         ALTERNATE RECORD KEY HHT-KEY2
000340         FILE STATUS IS ERR-STAT.
000350     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD
000360         ORGANIZATION IS INDEXED
000370         ACCESS MODE IS DYNAMIC
000380         RECORD KEY IS THT-KEY
000390         ALTERNATE RECORD KEY THT-KEY2
000400         FILE STATUS IS ERR-STAT.
000410     SELECT HKBM ASSIGN TO HKB-MSD
000420         ORGANIZATION IS INDEXED
000430         ACCESS MODE IS DYNAMIC
000440         RECORD KEY IS HKB-KEY
000450         FILE STATUS IS ERR-STAT.
000460*****SELECT MSTRN ASSIGN TO MS-MSD                                D.160329
000470*****    ORGANIZATION IS INDEXED                                  D.160329
000480*****    ACCESS MODE IS DYNAMIC                                   D.160329
000490*****    RECORD KEY IS MS-KEY                                     D.160329
000500*****    FILE STATUS IS ERR-STAT.                                 D.160329
000510     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000520         ORGANIZATION IS INDEXED
000530         ACCESS MODE IS RANDOM
000540         RECORD KEY IS T-KEY
000550         ALTERNATE RECORD KEY T-KEY2
000560         FILE STATUS IS ERR-STAT.
000570     SELECT NJZAI ASSIGN TO NJZAI-MSD                             I.011107
000580         ORGANIZATION IS INDEXED                                  I.011107
000590         ACCESS MODE IS DYNAMIC                                   I.011107
000600         RECORD KEY IS NJZAI-KEY                                  I.011107
000610         FILE STATUS IS ERR-STAT.                                 I.011107
000620     SELECT SP-F ASSIGN TO P-PRN999.
000630 I-O-CONTROL.
000640     APPLY SHARED-MODE ON M-DATE
000650     APPLY SHARED-MODE ON HI-M
000660     APPLY SHARED-MODE ON HUH-M
000670     APPLY SHARED-MODE ON HHTF
000680     APPLY SHARED-MODE ON THTM
000690     APPLY SHARED-MODE ON HKBM
000700*****APPLY SHARED-MODE ON MSTRN                                   D.160329
000710     APPLY SHARED-MODE ON T-M
000720     APPLY SHARED-MODE ON NJZAI                                   I.011107
000730     APPLY SHIFT-CODE  ON SP-F.
000740 DATA DIVISION.
000750 FILE SECTION.
000760     COPY LIBFDD.
000770     COPY LIHIM.
000780     COPY LIHHTF.
000790     COPY LIHUHM.
000800     COPY LIHKBM.
000810     COPY LITM.
000820     COPY LNJZAI.                                                 I.011107
000830     COPY LITHTM.                                                 I.080529
000840     COPY LSPF.
000850*FD  MSTRN                                                        D.160329
000860*****BLOCK 12 RECORDS                                             D.160329
000870*****LABEL RECORD STANDARD                                        D.160329
000880*****VALUE OF IDENTIFICATION IS "MSTRN".                          D.160329
000890*01  MS-R.                                                        D.160329
000900*****02  MS-KEY.                                                  D.160329
000910*****  03  MS-ID        PIC  X(001).                              D.160329
000920*****  03  MS-HCD       PIC  9(006).                              D.160329
000930*****  03  F            PIC  X(001).                              D.160329
000940*****02  F              PIC  X(006).                              D.160329
000950*****02  MS-ACT         PIC  9(001).                              D.160329
000960*****02  MS-DATE        PIC  9(006).                              D.160329
000970*FD  THTM                                                         D.080528
000980*****BLOCK  8 RECORDS                                             D.080528
000990*****LABEL RECORD IS STANDARD                                     D.080528
001000*****VALUE OF IDENTIFICATION "THTM1"                              D.080528
001010*****ALTERNATE IDENTIFICATION "THTM2".                            D.080528
001020*01  THT-R.                                                       D.080528
001030*****02  THT-KD.                                                  D.080528
001040*****  03  THT-KEY.                                               D.080528
001050*****    04  THT-TCD    PIC  9(004).                              D.080528
001060*****    04  THT-HCD.                                             D.080528
001070*****      05  THT-HCDF PIC  9(004).                              D.080528
001080*****      05  THT-HCDR PIC  9(002).                              D.080528
001090*****    04  THT-SIZ    PIC  9(001).                              D.080528
001100*****  03  THT-TCD1     PIC  9(004).                              D.080528
001110*****02  THT-KDD   REDEFINES THT-KD.                              D.080528
001120*****  03  THT-TCD3     PIC  9(004).                              D.080528
001130*****  03  THT-KEY2.                                              D.080528
001140*****    04  THT-HCD2   PIC  9(006).                              D.080528
001150*****    04  THT-SIZ2   PIC  9(001).                              D.080528
001160*****    04  THT-TCD2   PIC  9(004).                              D.080528
001170*****02  THT-T          PIC  9(005).                              D.080528
001180*****02  THT-TNC        PIC  9(002).                              D.080528
001190*****02  F              PIC  X(006).                              D.080528
001200*****02  THT-NG         PIC  9(004).                              D.080528
001210 WORKING-STORAGE  SECTION.
001220 77  JS-SIGN            PIC  9(001).                              I.061110
001230 77  ERR-STAT           PIC  X(002).
001240 77  W-FILE             PIC  X(013).
001250 77  W-MSG              PIC  X(030).
001260 01  HEAD01.
001270     02  F              PIC  X(005) VALUE ""3FE04FE080"".
001280     02  F              PIC  X(008) VALUE ""3F507F4F657F4F9B"".
001290     02  F              PIC  X(040) VALUE SPACE.
001300     02  F              PIC  N(013) VALUE
001310          NC"履物　品名マスター　リスト".
001320     02  F              PIC  X(044) VALUE SPACE.
001330     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
001340 01  HEAD02.
001350     02  F              PIC  X(106) VALUE SPACE.
001360     02  F              PIC  N(003) VALUE NC"作成日".
001370     02  F              PIC  X(002) VALUE " '".
001380     02  H-DATE         PIC 99/99/99.
001390     02  F              PIC  X(014) VALUE SPACE.
001400 01  HEAD1.
001410     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
001420     02  F              PIC  X(037) VALUE SPACE.
001430     02  F              PIC  N(014) VALUE
001440          NC"＊＊＊　　履物品名マスター　".
001450     02  F              PIC  N(012) VALUE
001460          NC"プルーフリスト　　＊＊＊".
001470     02  F              PIC  X(024) VALUE SPACE.
001480     02  F              PIC  X(005) VALUE "DATE ".
001490     02  H-NGP          PIC 99B99B99.
001500     02  F              PIC  X(007) VALUE "     P.".
001510     02  H-PAGE         PIC ZZ9.
001520 01  HEAD2.
001530     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001540     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".
001550     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
001560     02  F              PIC  X(025) VALUE SPACE.                  I.090121
001570     02  F              PIC  N(006) VALUE NC"略　　　称　".       I.090121
001580     02  F              PIC  X(015) VALUE SPACE.                  I.090121
001590*****02  F              PIC  X(026) VALUE SPACE.                  D.011030
001600*****02  F              PIC  X(022) VALUE SPACE.                  D.011120
001610*****02  F              PIC  X(034) VALUE SPACE.                  D.020314
001620*****02  F              PIC  X(030) VALUE SPACE.                  D.030822
001630*****02  F              PIC  X(023) VALUE SPACE.                  D.040311
001640*****02  F              PIC  X(022) VALUE SPACE.                  D.090121
001650*****02  F              PIC  N(008) VALUE NC"　分類①　②　③".   D.090121
001660     02  F              PIC  N(002) VALUE NC"　③".               I.090121
001670     02  F              PIC  X(001) VALUE SPACE.                  I.020314
001680     02  F              PIC  N(002) VALUE NC"部門".               I.020314
001690     02  F              PIC  X(001) VALUE SPACE.                  I.090121
001700     02  F              PIC  N(002) VALUE NC"　①".               I.090121
001710     02  F              PIC  N(002) VALUE NC"　②".               I.090121
001720     02  F              PIC  N(002) VALUE NC"　④".               I.090121
001730     02  F              PIC  X(001) VALUE SPACE.                  I.090121
001740     02  F              PIC  N(004) VALUE NC"予定原価".           I.090121
001750     02  F              PIC  X(001) VALUE SPACE.                  I.090121
001760     02  F              PIC  N(004) VALUE NC"振替単価".           I.090121
001770     02  F              PIC  X(001) VALUE SPACE.                  I.090121
001780     02  F              PIC  N(004) VALUE NC"予定売価".           I.090121
001790*****02  F              PIC  N(004) VALUE NC"　予売価".           D.090121
001800*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001810*****02  F              PIC  N(004) VALUE NC"予定売価".           D.050416
001820*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001830*****02  F              PIC  N(004) VALUE NC"　材料費".           D.090121
001840*****02  F              PIC  N(004) VALUE NC"　内加工".           D.090121
001850*****02  F              PIC  N(004) VALUE NC"　外加工".           D.090121
001860*****02  F              PIC  X(002) VALUE SPACE.                  D.090121
001870*****02  F              PIC  N(002) VALUE NC"間接".               D.090121
001880*****02  F              PIC  N(004) VALUE NC"　振単価".           D.090121
001890*****02  F              PIC  N(004) VALUE NC"　予原価".           D.090121
001900*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001910*****02  F              PIC  N(004) VALUE NC"社内加工".           D.050416
001920*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001930*****02  F              PIC  N(004) VALUE NC"社外加工".           D.050416
001940*****02  F              PIC  N(004) VALUE NC"　間接費".           D.050416
001950*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001960*****02  F              PIC  N(004) VALUE NC"振替単価".           D.050416
001970*****02  F              PIC  X(001) VALUE SPACE.                  D.050416
001980*****02  F              PIC  N(004) VALUE NC"予定原価".           D.050416
001990     02  F              PIC  X(001) VALUE SPACE.
002000     02  F              PIC  N(002) VALUE NC"入数".
002010     02  F              PIC  X(001) VALUE SPACE.                  I.090121
002020     02  F              PIC  N(002) VALUE NC"加硫".               I.090121
002030     02  F              PIC  X(001) VALUE SPACE.                  I.090121
002040     02  F              PIC  N(002) VALUE NC"廃番".               I.090121
002050     02  F              PIC  X(001) VALUE SPACE.                  I.100601
002060     02  F              PIC  N(002) VALUE NC"種別".               I.100601
002070     02  F              PIC  X(001) VALUE SPACE.                  I.090121
002080     02  F              PIC  X(003) VALUE "ﾊｰﾌ".                  D.090121
002090     02  F              PIC  X(001) VALUE SPACE.                  I.090121
002100     02  F              PIC  X(005) VALUE "ﾊｲﾊﾟ-".                I.090121
002110     02  F              PIC  X(004) VALUE SPACE.                  I.100601
002120*****02  F              PIC  X(008) VALUE SPACE.                  D.100601
002130*****02  F              PIC  X(001) VALUE SPACE.                  D.040311
002140*****02  F              PIC  N(002) VALUE NC"加硫".               D.040311
002150*****02  F              PIC  X(001) VALUE SPACE.                  D.040311
002160*****02  F              PIC  N(002) VALUE NC"産地".               D.040311
002170*****02  F              PIC  N(002) VALUE NC"　加".               D.090121
002180*****02  F              PIC  N(002) VALUE NC"　廃".               D.090121
002190*****02  F              PIC  N(002) VALUE NC"　産".               D.080521
002200*****02  F              PIC  X(006) VALUE " ﾊｰ ﾊｲ".               D.090121
002210*****02  F              PIC  X(003) VALUE " ﾊｰ".                  D.050416
002220*****02  F              PIC  N(004) VALUE NC"　得意先".           D.090121
002230*****02  F              PIC  N(004) VALUE NC"　登録日".           D.090121
002240*****02  F              PIC  N(004) VALUE NC"　廃止日".           D.090121
002250*****02  F              PIC  X(004) VALUE SPACE.                  D.090121
002260*****02  F              PIC  X(001) VALUE SPACE.                  D.011120
002270*****02  F              PIC  N(004) VALUE NC"注　釈　".           D.011120
002280*****02  F              PIC  X(009) VALUE SPACE.                  D.011120
002290 01  HEAD3.
002300*****02  F              PIC  X(005) VALUE ""3FE04FE080"".         D.090121
002310*****02  F              PIC  N(001) VALUE NC"親".                 D.090121
002320*****02  F              PIC  X(005) VALUE ""3FE04F40A0"".         D.090121
002330*****02  F              PIC  X(005) VALUE "ｺｰﾄﾞ)".                D.090121
002340     02  F              PIC  X(002) VALUE SPACE.                  I.090121
002350     02  F              PIC  N(002) VALUE NC"　親".               I.090121
002360     02  F              PIC  X(002) VALUE " )".                   I.090121
002370     02  F              PIC  X(001) VALUE SPACE.
002380     02  F              PIC  X(003) VALUE "1  ".
002390     02  F              PIC  N(002) VALUE NC"３号".
002400     02  F              PIC  X(002) VALUE SPACE.
002410     02  F              PIC  N(002) VALUE NC"２号".
002420*****02  F              PIC  X(002) VALUE SPACE.                  D.040311
002430*****02  F              PIC  N(002) VALUE NC"１号".               D.040311
002440*****02  F              PIC  X(002) VALUE SPACE.                  D.040311
002450*****02  F              PIC  N(002) VALUE NC"０号".               D.040311
002460*****02  F              PIC  X(002) VALUE SPACE.                  D.040311
002470*****02  F              PIC  N(002) VALUE NC"　中".               D.040311
002480*****02  F              PIC  X(002) VALUE SPACE.                  D.040311
002490*****02  F              PIC  N(002) VALUE NC"　大".               D.040311
002500*****02  F              PIC  X(002) VALUE SPACE.                  D.040311
002510*****02  F              PIC  N(002) VALUE NC"特大".               D.040311
002520     02  F              PIC  X(025) VALUE                         I.040311
002530          "  SS    S    M    L   LL ".                            I.040311
002540     02  F              PIC  X(015) VALUE " 28.0 29.0 30.0".
002550*****02  F              PIC  X(062) VALUE SPACE.                  D.040311
002560*****02  F              PIC  X(050) VALUE SPACE.                  D.050416
002570     02  F              PIC  X(043) VALUE SPACE.                  I.050416
002580     02  F              PIC  N(004) VALUE NC"得意先　".           I.090121
002590     02  F              PIC  X(001) VALUE SPACE.                  I.090121
002600     02  F              PIC  N(004) VALUE NC"注　　釈".           I.090121
002610     02  F              PIC  X(009) VALUE SPACE.                  I.090121
002620     02  F              PIC  N(004) VALUE NC"　登録日".           I.090121
002630     02  F              PIC  N(004) VALUE NC"　廃止日".           I.090121
002640*****02  F              PIC  N(002) VALUE NC"　硫".               D.090121
002650*****02  F              PIC  N(002) VALUE NC"　地".               D.080521
002660*****02  F              PIC  N(002) VALUE NC"　番".               D.090121
002670*****02  F              PIC  X(006) VALUE "  ﾌ ﾊﾟ".               D.090121
002680*****02  F              PIC  X(003) VALUE "  ﾌ".                  D.050416
002690*****02  F              PIC  X(007) VALUE SPACE.                  D.090121
002700*****02  F              PIC  N(004) VALUE NC"注　釈　".           D.090121
002710*****02  F              PIC  X(009) VALUE SPACE.                  D.090121
002720*****02  F              PIC  X(077) VALUE SPACE.                  D.011120
002730 01  HEAD4.
002740     02  F              PIC  X(008) VALUE SPACE.
002750     02  F              PIC  X(051) VALUE
002760          "2 12.5 13.0 13.5 14.0 15.0 16.0 17.0 18.0 19.0 20.0".
002770     02  F              PIC  X(077) VALUE SPACE.
002780 01  HEAD5.
002790     02  F              PIC  X(008) VALUE SPACE.
002800     02  F              PIC  X(051) VALUE
002810          "3 21.0 21.5 22.0 22.5 23.0 23.5 24.0 24.5 25.0     ".
002820     02  F              PIC  X(077) VALUE SPACE.
002830 01  HEAD6.
002840     02  F              PIC  X(008) VALUE SPACE.
002850     02  F              PIC  X(048) VALUE
002860          "4 24.0 24.5 25.0 25.5 26.0 26.5 27.0 27.5       ".
002870     02  F              PIC  N(002) VALUE NC"預り".
002880     02  F              PIC  X(077) VALUE SPACE.
002890 01  W-P1.
002900     02  P-HCD          PIC  9(006).
002910     02  F              PIC  X(001).
002920     02  P-NAME         PIC  N(024).
002930     02  F              PIC  X(001).                              I.090121
002940     02  P-SMS          PIC  N(016).                              I.090121
002950*****02  F              PIC  X(006).                              D.011030
002960*****02  F              PIC  X(002).                              D.011130
002970*****02  F              PIC  X(014).                              D.020314
002980*****02  F              PIC  X(010).                              D.030514
002990*****02  P-BC1          PIC  9(002).                              D.030514
003000*****02  F              PIC  X(001).                              D.030514
003010*****02  P-BC2          PIC  9(002).                              D.030514
003020*****02  F              PIC  X(009).                              D.030822
003030*****02  F              PIC  X(002).                              D.040311
003040     02  F              PIC  X(001).                              I.040311
003050     02  P-BC3          PIC  9(002).                              I.090121
003060     02  F              PIC  X(002).                              I.040311
003070     02  P-BMC          PIC  9(002).                              I.090121
003080     02  F              PIC  X(001).                              I.090121
003090     02  P-BC1          PIC  9(002).                              I.030514
003100     02  P-BC21         PIC  9(001).                              I.030514
003110     02  F              PIC  X(002).                              I.030514
003120     02  P-BC22         PIC  9(001).                              I.030514
003130*****02  F              PIC  X(001).                              D.090121
003140*****02  P-BC3          PIC  9(002).                              D.090121
003150     02  F              PIC  X(002).                              I.020314
003160     02  P-BC4          PIC  9(001).                              I.090121
003170     02  F              PIC  X(001).                              I.090121
003180     02  P-YG           PIC ZZ,ZZ9.                               I.090121
003190     02  F              PIC  X(001).                              I.090121
003200     02  P-FT           PIC ZZ,ZZ9.                               I.090121
003210*****02  P-BMC          PIC  9(002).                              D.090121
003220*****02  F              PIC  X(001).                              D.050416
003230     02  F              PIC  X(001).                              I.090121
003240     02  P-SB           PIC ZZ,ZZZ.
003250*****02  F              PIC  X(001).                              D.050416
003260*****02  P-ZRG          PIC ZZ,ZZZ.                               D.090121
003270*****02  F              PIC  X(001).                              D.050416
003280*****02  P-SKG          PIC ZZ,ZZZ.                               D.090121
003290*****02  F              PIC  X(001).                              D.050416
003300*****02  P-GKG          PIC ZZ,ZZZ.                               D.090121
003310*****02  F              PIC  X(001).                              D.050416
003320*****02  P-KNG          PIC Z,ZZZ.                                D.090121
003330*****02  F              PIC  X(001).                              D.050416
003340*****02  P-FT           PIC ZZ,ZZ9.                               D.090121
003350*****02  F              PIC  X(001).                              D.050416
003360*****02  P-YG           PIC ZZ,ZZ9.                               D.090121
003370     02  F              PIC  X(001).
003380     02  P-ISU          PIC  Z(003).
003390*****02  F              PIC  X(003).                              D.040311
003400*****02  F              PIC  X(002).                              D.090121
003410     02  F              PIC  X(003).                              I.090121
003420     02  P-KRC          PIC  Z(001).                              I.011030
003430*****02  F              PIC  X(003).                              D.040311
003440*****02  F              PIC  X(002).                              D.090121
003450     02  F              PIC  X(003).                              I.090121
003460     02  P-SCC          PIC  Z(001).                              I.011120
003470*****02  F              PIC  X(002).                              D.090121
003480     02  F              PIC  X(003).                              I.100601
003490     02  P-SSC          PIC  Z(001).                              I.100601
003500     02  F              PIC  X(003).                              I.090121
003510     02  P-HKB          PIC  Z(001).                              I.040311
003520*****02  F              PIC  X(002).                              D.090401
003530     02  F              PIC  X(004).                              I.090121
003540     02  P-HPV          PIC  Z(001).                              I.050416
003550     02  F              PIC  X(005).                              I.100601
003560*****02  F              PIC  X(009).                              D.100601
003570*****02  F              PIC  X(002).                              D.090121
003580*****02  P-TCD          PIC  9(004).                              D.090121
003590*****02  F              PIC  X(001).                              D.090121
003600*****02  P-SNG          PIC 99/99.                                D.090121
003610*****02  F              PIC  X(001).                              D.090121
003620*****02  P-ENG          PIC 99/99.                                D.090121
003630*****02  F              PIC  X(004).                              D.090121
003640*****02  F              PIC  X(001).                              D.011120
003650*****02  P-CS           PIC  N(010).                              D.011120
003660 01  W-P2.
003670     02  P-MHCD         PIC  9(006).
003680     02  P-C            PIC  X(001).
003690     02  F              PIC  X(001).
003700     02  P-SIZ          PIC  9(001).
003710     02  P-ASC   OCCURS  10.
003720       03  F            PIC  X(003).
003730       03  P-SC         PIC  9(001).
003740       03  F            PIC  X(001).
003750     02  F              PIC  X(045).                              I.090121
003760     02  P-TCD          PIC  9(004).                              I.090121
003770     02  F              PIC  X(001).                              I.090121
003780*****02  F              PIC  X(062).                              D.090121
003790     02  P-CS           PIC  N(010).                              I.011120
003800     02  F              PIC  X(001).                              I.090121
003810     02  P-SNG          PIC 99/99.                                I.090121
003820     02  F              PIC  X(001).                              I.090121
003830     02  P-ENG          PIC 99/99.                                I.090121
003840*****02  F              PIC  X(077).                              D.011120
003850 01  W-R.
003860     02  W-KEY2.
003870       03  W-MHCD       PIC  9(006).
003880       03  W-KEY        PIC  9(006).
003890     02  W-NAME         PIC  N(024).
003900     02  W-NAMD  REDEFINES W-NAME.
003910       03  W-NAD   OCCURS 24.
003920         04  W-NA       PIC  N(001).
003930     02  W-NAAD  REDEFINES W-NAME.
003940       03  W-NAA   OCCURS 48  PIC  X(001).
003950     02  W-BC.
003960       03  W-BCD1.                                                I.030514
003970         04  W-BC1      PIC  9(002).                              I.030514
003980         04  W-BC21     PIC  9(001).                              I.030514
003990*****  03  W-BC1        PIC  9(002).                              D.030514
004000*****  03  W-BC2.                                                 D.030514
004010*****    04  W-BC21     PIC  9(001).                              D.030514
004020*****    04  W-BC22     PIC  9(001).                              D.030514
004030       03  W-BC22       PIC  9(001).                              I.030514
004040       03  W-BC3        PIC  9(002).
004050     02  W-SSD.
004060       03  W-SS    OCCURS 40.
004070         04  W-S        PIC  9(001).
004080     02  W-SKDD  REDEFINES W-SSD.
004090       03  W-SKD   OCCURS  4.
004100         04  W-SK       PIC  9(010).
004110     02  W-SB           PIC  9(005).
004120     02  W-FT           PIC  9(005).
004130*****02  W-ZRG          PIC  9(005).                              D.090121
004140*****02  W-SKG          PIC  9(005).                              D.090121
004150*****02  W-GKG          PIC  9(005).                              D.090121
004160*****02  W-KNG          PIC  9(004).                              D.090121
004170     02  F              PIC  X(019).                              I.090121
004180     02  W-KT           PIC  9(005).
004190     02  W-TCD          PIC  9(004).
004200     02  W-ISU          PIC  9(003).
004210     02  W-KRC          PIC  9(001).                              I.011030
004220     02  W-SCC          PIC  9(001).                              I.011120
004230     02  W-BMC          PIC  9(002).                              I.020314
004240     02  W-BMNO         PIC  9(001).                              I.020425
004250     02  W-YG           PIC  9(005).                              I.030822
004260     02  W-HKB          PIC  9(001).                              I.040311
004270     02  W-HPV          PIC  9(001).                              I.050416
004280     02  W-BC4          PIC  9(001).                              I.090121
004290     02  W-SSC          PIC  9(001).                              I.100601
004300*****02  F              PIC  X(069).                              D.011030
004310*****02  F              PIC  X(068).                              D.011120
004320*****02  F              PIC  X(067).                              D.020314
004330*****02  F              PIC  X(065).                              D.020425
004340*****02  F              PIC  X(064).                              D.030822
004350*****02  F              PIC  X(059).                              D.040311
004360*****02  F              PIC  X(058).                              D.050416
004370*****02  F              PIC  X(057).                              D.090121
004380*****02  F              PIC  X(011).                              D.100601
004390*****02  F              PIC  X(010).                              D.130605
004400     02  F              PIC  X(005).                              I.130605
004410     02  W-YG2          PIC  9(005).                              I.130605
004420     02  W-SMS          PIC  N(016).                              I.090121
004430     02  W-SMSD  REDEFINES W-SMS.                                 I.090121
004440       03  W-MSD   OCCURS 16.                                     I.090121
004450         04  W-MS       PIC  N(001).                              I.090121
004460     02  W-SMD   REDEFINES W-SMS.                                 I.090121
004470       03  W-SM    OCCURS 32  PIC  X(001).                        I.090121
004480     02  F              PIC  9(006).                              I.090121
004490     02  F              PIC  9(006).                              I.090121
004500     02  F              PIC  X(001).                              I.090121
004510     02  W-CS           PIC  N(010).
004520     02  F              PIC  X(006).
004530     02  W-DNG          PIC  9(006).
004540     02  W-SNG          PIC  9(004).
004550     02  W-SNGD    REDEFINES W-SNG.
004560       03  W-SNEN       PIC  9(002).
004570       03  W-SGET       PIC  9(002).
004580     02  W-ENG          PIC  9(004).
004590     02  W-ENGD    REDEFINES W-ENG.
004600       03  W-ENEN       PIC  9(002).
004610       03  W-EGET       PIC  9(002).
004620 01  W-DATA.
004630     02  W-END          PIC  9(001) VALUE ZERO.
004640     02  W-OVER         PIC  9(001) VALUE ZERO.
004650     02  W-INV          PIC  9(001).
004660     02  W-ZC           PIC  9(001).
004670     02  W-POC          PIC  9(001) VALUE ZERO.
004680     02  W-ACT          PIC  9(001) VALUE ZERO.
004690     02  W-ACTD         PIC  9(001).
004700     02  W-ACP          PIC  9(001).
004710     02  W-PMC          PIC  9(001).
004720     02  W-DMM          PIC  9(001).
004730     02  W-SKP          PIC  9(001).
004740     02  W-IC           PIC  9(001).
004750     02  W-LC.
004760       03  W-L          PIC  9(002).
004770       03  W-C          PIC  9(002).
004780     02  CNT            PIC  9(002).
004790     02  CNTD           PIC  9(002).
004800     02  CHK            PIC  9(001).
004810     02  W-DCDD.
004820       03  W-DCD   OCCURS   4.
004830         04  W-DC       PIC  9(001).
004840     02  W-RC           PIC  9(001).
004850*****02  W-FTW.                                                   D.090121
004860*****  03  W-FTW1       PIC  9(005)V9(02).                        D.090121
004870*****  03  W-FTW2       PIC  9(005).                              D.090121
004880*****02  W-GEN.                                                   D.090121
004890*****  03  W-FTD        PIC  9(005).                              D.090121
004900*****  03  W-ZRGD       PIC  9(005).                              D.090121
004910*****  03  W-SKGD       PIC  9(005).                              D.090121
004920*****  03  W-GKGD       PIC  9(005).                              D.090121
004930*****  03  W-KNGD       PIC  9(004).                              D.090121
004940     02  W-FTD          PIC  9(005).                              I.090121
004950     02  W-KRCN         PIC  N(001).                              I.011030
004960     02  W-SCCN         PIC  N(002).                              I.011120
004970     02  W-SSCN         PIC  X(003).                              I.100601
004980     02  W-HKBN         PIC  X(003).                              I.040311
004990     02  W-BMCN         PIC  N(003).                              I.090121
005000*****02  W-BMCN         PIC  N(004).                              D.090121
005010     02  W-SEKEY.
005020       03  W-SKEY       PIC  9(006).
005030       03  W-EKEY       PIC  9(006).
005040     02  W-PAGE         PIC  9(003) VALUE ZERO.
005050     02  W-NGP          PIC  9(006).
005060     02  W-NG           PIC  9(006).
005070     02  W-NGD   REDEFINES W-NG.
005080       03  W-NEN        PIC  9(004).
005090       03  W-NEND  REDEFINES W-NEN.
005100         04  W-NEN1     PIC  9(002).
005110         04  W-NEN2     PIC  9(002).
005120       03  W-GET        PIC  9(002).
005130     02  W-NGSD  REDEFINES W-NG.
005140       03  F            PIC  9(002).
005150       03  W-NGS        PIC  9(004).
005160     02  W-OMD.
005170       03  W-OMHCD      PIC  9(006).
005180*****  03  W-ONAME      PIC  N(024).                              D.160329
005190       03  W-OBC.
005200         04  W-OBCD1    PIC  9(003).                              I.030514
005210         04  W-OBC22    PIC  9(001).                              I.030514
005220*****    04  W-OBC1     PIC  9(002).                              D.030514
005230*****    04  W-OBC2     PIC  9(002).                              D.030514
005240         04  W-OBC3     PIC  9(002).
005250       03  W-OBMC       PIC  9(002).                              I.020425
005260       03  W-OBC4       PIC  9(001).                              I.090121
005270       03  W-OSSD.
005280         04  W-OSS    OCCURS 40.
005290           05  W-OS     PIC  9(001).
005300       03  W-OSKDD REDEFINES W-OSSD.
005310         04  W-OSKD   OCCURS  4.
005320           05  W-OSK    PIC  9(010).
005330*****  03  W-OISU       PIC  9(003).                              D.160329
005340*****  03  W-OSMS       PIC  N(016).                              D.160329
005350*****  03  W-OHKB       PIC  9(001).                              D.160329
005360*****  03  W-OSSC       PIC  9(001).                              D.160329
005370     02  W-HCD.
005380       03  W-HCD1       PIC  9(004).
005390       03  W-HCD2       PIC  9(002).
005400     02  W-NMD          PIC  N(024).                              品名
005410     02  W-NMDC  REDEFINES W-NMD.
005420       03  W-NMDD  OCCURS  24.
005430         04  W-NM       PIC  N(001).
005440*****02  W-BRN2         PIC  N(008).                              D.020620
005450*****02  W-BRN2D REDEFINES W-BRN2.                                D.020620
005460*****  03  W-BRN2F      PIC  N(002).                              D.020620
005470*****  03  W-BRN2R      PIC  N(006).                              D.020620
005480     02  W-BUD.
005490       03  W-BMHCD      PIC  9(006).
005500       03  W-BNAME      PIC  N(024).
005510*****  03  W-BBC1       PIC  9(002).                              D.030514
005520*****  03  W-BBC2       PIC  9(002).                              D.030514
005530       03  W-BBCD1      PIC  9(003).                              I.030514
005540       03  W-BBC22      PIC  9(001).                              I.030514
005550       03  W-BBC3       PIC  9(002).
005560*****  03  W-BZRG       PIC  9(005).                              D.090121
005570*****  03  W-BSKG       PIC  9(005).                              D.090121
005580*****  03  W-BGKG       PIC  9(005).                              D.090121
005590*****  03  W-BKNG       PIC  9(004).                              D.090121
005600       03  W-BFT        PIC  9(005).
005610       03  W-BSB        PIC  9(005).
005620       03  W-BYG        PIC  9(005).                              I.030822
005630       03  W-BYG2       PIC  9(005).                              I.130605
005640       03  W-BISU       PIC  9(003).
005650       03  W-BKRC       PIC  9(001).                              I.011030
005660       03  W-BSCC       PIC  9(001).                              I.011120
005670       03  W-BSSC       PIC  9(001).                              I.100601
005680       03  W-BHKB       PIC  9(001).                              I.040311
005690       03  W-BHPV       PIC  9(001).                              I.050416
005700       03  W-BBC4       PIC  9(001).                              I.090121
005710       03  W-BBMC       PIC  9(002).                              I.020314
005720       03  W-BSSD.
005730         04  W-BSS    OCCURS  40.
005740           05  W-BS     PIC  9(001).
005750       03  W-BSNG       PIC  9(004).
005760       03  W-BENG       PIC  9(004).
005770       03  W-BTCD       PIC  9(004).
005780       03  W-BCS        PIC  N(010).
005790       03  W-BSMS       PIC  N(016).                              I.090121
005800     02  W-DDD.
005810       03  W-DD    OCCURS  20.
005820         04  W-DHCD     PIC  9(006).
005830     02  W-DCNT         PIC  9(002).
005840     02  W-BCN21        PIC  N(004).                              I.030514
005850     02  W-BCN4         PIC  N(003).                              I.090121
005860     COPY LSTAT.
005870 SCREEN      SECTION.
005880 SD  C-CRT
005890     END  STATUS IS  ESTAT.
005900 01  C-CLEAR.
005910     02  C-CL    LINE   1  CLEAR SCREEN.
005920 01  C-ACP.
005930*****02  A-ACT   LINE  3  COLUMN  60  PIC  9(001)                 D.061110
005940     02  A-ACT   LINE  3  COLUMN  64  PIC  9(001)                 I.061110
005950          USING W-ACT   CHECK OVERFLOW NO IFC.
005960     02  LINE   5.
005970       03  A-HCD   COLUMN  11  PIC  9(006)
005980            USING W-HCD   CHECK OVERFLOW NO IFC.
005990       03  A-HCD1  COLUMN  11  PIC  9(004)
006000            USING W-HCD1  CHECK OVERFLOW NO IFC.
006010       03  A-NAME  COLUMN  25  PIC  N(024)
006020            USING W-NAME  CHECK OVERFLOW NO IFC.
006030     02  A-MHCD  LINE  6  COLUMN  11  PIC  9(006)
006040          USING W-MHCD  CHECK OVERFLOW NO IFC.
006050     02  LINE   7.                                                I.090121
006060       03  A-BC3   COLUMN  12  PIC  9(002)                        I.090121
006070            USING W-BC3   CHECK OVERFLOW NO IFC.                  I.090121
006080       03  A-SMS   COLUMN  30  PIC  N(016)                        I.090121
006090            USING W-SMS   CHECK OVERFLOW NO IFC.                  I.090121
006100       03  A-YG2   COLUMN  74  PIC  9(005)                        I.130605
006110            USING W-YG2   CHECK OVERFLOW NO IFC.                  I.130605
006120     02  LINE   8.                                                I.090121
006130       03  A-BMC   COLUMN  12  PIC  9(002)                        I.090121
006140            USING W-BMC   CHECK OVERFLOW NO IFC.                  I.090121
006150       03  A-YG    COLUMN  53  PIC  9(005)                        I.090121
006160            USING W-YG    CHECK OVERFLOW NO IFC.                  I.090121
006170       03  A-KRC   COLUMN  70  PIC  9(001)                        I.090121
006180            USING W-KRC   CHECK OVERFLOW NO IFC.                  I.090121
006190*****02  A-BC1   LINE   7  COLUMN   9  PIC  9(002)                D.030514
006200*****02  A-BCD1  LINE   7  COLUMN   9  PIC  9(003)                D.090121
006210*****     USING W-BCD1  CHECK OVERFLOW NO IFC.                    D.090121
006220*****     USING W-BC1   CHECK OVERFLOW NO IFC.                    D.030514
006230*****02  A-BC2   LINE   8  COLUMN   9  PIC  9(002)                D.030514
006240*****02  A-BC2   LINE   8  COLUMN   9  PIC  9(001)                D.030514
006250*****     USING W-BC2   CHECK OVERFLOW NO IFC.                    D.030514
006260*****02  A-BC22  LINE   8  COLUMN   9  PIC  9(001)                D.090121
006270*****     USING W-BC22  CHECK OVERFLOW NO IFC.                    D.090121
006280*****02  A-BC3   LINE   9  COLUMN   9  PIC  9(002)                D.090121
006290*****     USING W-BC3   CHECK OVERFLOW NO IFC.                    D.090121
006300*****02  A-BMC   LINE  10  COLUMN   9  PIC  9(002)                D.090121
006310*****     USING W-BMC   CHECK OVERFLOW NO IFC.                    D.090121
006320     02  LINE  9.
006330       03  A-BCD1  COLUMN  12  PIC  9(003)                        I.090121
006340            USING W-BCD1  CHECK OVERFLOW NO IFC.                  I.090121
006350*****  03  A-ZRG   COLUMN  31  PIC  9(005)                        D.090121
006360*****       USING W-ZRG   CHECK OVERFLOW NO IFC.                  D.090121
006370*****  03  A-SKG   COLUMN  37  PIC  9(005)                        D.090121
006380*****       USING W-SKG   CHECK OVERFLOW NO IFC.                  D.090121
006390*****  03  A-GKG   COLUMN  43  PIC  9(005)                        D.090121
006400*****       USING W-GKG   CHECK OVERFLOW NO IFC.                  D.090121
006410*****  03  A-KNG   COLUMN  49  PIC  9(004)                        D.090121
006420*****       USING W-KNG   CHECK OVERFLOW NO IFC.                  D.090121
006430*****  03  A-FT    COLUMN  54  PIC  9(005)                        D.090121
006440       03  A-FT    COLUMN  53  PIC  9(005)                        I.090121
006450            USING W-FT    CHECK OVERFLOW NO IFC.
006460       03  A-SCC   COLUMN  70  PIC  9(001)                        I.090121
006470            USING W-SCC   CHECK OVERFLOW NO IFC.                  I.090121
006480     02  LINE 10.                                                 I.090121
006490       03  A-BC22  COLUMN  12  PIC  9(001)                        I.090121
006500            USING W-BC22  CHECK OVERFLOW NO IFC.                  I.090121
006510*****  03  A-SB    COLUMN  60  PIC  9(005)                        D.090121
006520       03  A-SB    COLUMN  53  PIC  9(005)                        I.090121
006530            USING W-SB    CHECK OVERFLOW NO IFC.
006540       03  A-SSC   COLUMN  70  PIC  9(001)                        I.100601
006550            USING W-SSC   CHECK OVERFLOW NO IFC.                  I.100601
006560*****  03  A-HKB   COLUMN  70  PIC  9(001)                        D.100601
006570*****       USING W-HKB   CHECK OVERFLOW NO IFC.                  D.100601
006580     02  LINE 11.                                                 I.090121
006590       03  A-BC4   COLUMN  12  PIC  9(001)                        I.090121
006600            USING W-BC4   CHECK OVERFLOW NO IFC.                  I.090121
006610*****  03  A-YG    COLUMN  66  PIC  9(005)                        D.090121
006620*****       USING W-YG    CHECK OVERFLOW NO IFC.                  D.090121
006630*****  03  A-ISU   COLUMN  69  PIC  9(003)                        D.030822
006640*****  03  A-ISU   COLUMN  74  PIC  9(003)                        D.090121
006650       03  A-ISU   COLUMN  55  PIC  9(003)                        I.090121
006660            USING W-ISU   CHECK OVERFLOW NO IFC.
006670       03  A-HKB   COLUMN  70  PIC  9(001)                        I.100601
006680            USING W-HKB   CHECK OVERFLOW NO IFC.                  I.100601
006690     02  LINE 12.                                                 I.100601
006700       03  A-HPV   COLUMN  70  PIC  9(001)                        I.090121
006710            USING W-HPV   CHECK OVERFLOW NO IFC.                  I.090121
006720*****  03  A-KRC   COLUMN  75  PIC  9(001)                        D.030822
006730*****02  A-KRC   LINE  11  COLUMN  67  PIC  9(001)                D.090121
006740*****     USING W-KRC   CHECK OVERFLOW NO IFC.                    D.090121
006750*****02  A-SCC   LINE  13  COLUMN  59  PIC  9(001)                D.020314
006760*****02  LINE  13.                                                D.030822
006770*****  03  A-SCC   COLUMN  59  PIC  9(001)                        D.030822
006780*****02  A-SCC   LINE  12  COLUMN  67  PIC  9(001)                D.090121
006790*****     USING W-SCC   CHECK OVERFLOW NO IFC.                    D.090121
006800*****02  A-HKB   LINE  13  COLUMN  67  PIC  9(001)                D.090121
006810*****     USING W-HKB   CHECK OVERFLOW NO IFC.                    D.090121
006820*****02  A-HPV   LINE  14  COLUMN  70  PIC  9(001)                D.090121
006830*****     USING W-HPV   CHECK OVERFLOW NO IFC.                    D.090121
006840*****  03  A-BMC   COLUMN  68  PIC  9(002)                        D.030822
006850*****     USING W-BMC   CHECK OVERFLOW NO IFC.                    D.030822
006860     02  A-S     LINE W-L  COLUMN W-C  PIC  9(001)
006870          USING W-S(CNT) CHECK OVERFLOW NO IFC.
006880     02  LINE  22.
006890*****  03  A-SNG   COLUMN   2  PIC  9(004)                        D.090121
006900       03  A-SNG   COLUMN   4  PIC  9(004)                        I.090121
006910            USING W-SNG   CHECK OVERFLOW NO IFC.
006920*****  03  A-ENG   COLUMN   7  PIC  9(004)                        D.090121
006930       03  A-ENG   COLUMN   9  PIC  9(004)                        I.090121
006940            USING W-ENG   CHECK OVERFLOW NO IFC.
006950       03  A-CS    COLUMN  23  PIC  N(010)                        I.090121
006960            USING W-CS    CHECK OVERFLOW NO IFC.                  I.090121
006970*****02  A-TCD   LINE  20  COLUMN  21  PIC  9(004)                D.090121
006980     02  A-TCD   LINE  21  COLUMN  23  PIC  9(004)                I.090121
006990          USING W-TCD   CHECK OVERFLOW NO IFC.
007000*****02  A-CS    LINE  22  COLUMN  19  PIC  N(010)                D.090121
007010*****     USING W-CS    CHECK OVERFLOW NO IFC.                    D.090121
007020*
007030     02  A-PMC   LINE   6  COLUMN  51  PIC  9(001)
007040          USING W-PMC   CHECK OVERFLOW NO IFC.
007050     02  LINE  12.
007060       03  A-SKEY  COLUMN  25  PIC  9(006)
007070            USING W-SKEY  CHECK OVERFLOW NO IFC.
007080       03  A-EKEY  COLUMN  37  PIC  9(006)
007090            USING W-EKEY  CHECK OVERFLOW NO IFC.
007100*
007110     02  A-DMM   LINE  23  COLUMN  70  PIC  9(001)
007120          USING W-DMM   CHECK OVERFLOW NO IFC.
007130 01  C-DSP.
007140     02  LINE   6.
007150       03  D-MHNA  COLUMN  25  PIC  N(024) FROM  HI-NAME.
007160       03  D-CHNA  COLUMN  25  PIC  X(048) VALUE
007170            "                                                ".
007180     02  D-BCN3  LINE   7  COLUMN  16  PIC  N(003) FROM  HKB-BRN3.I.090121
007190*****02  D-BCN1  LINE   7  COLUMN  13  PIC  N(008) FROM  HKB-BRN1.D.090121
007200     02  D-YG2   LINE   7  COLUMN  74  PIC  Z(005) FROM  W-YG2.   I.130605
007210     02  LINE   8.                                                I.030514
007220       03  D-BM.                                                  I.090121
007230         04  D-BMC   COLUMN  12  PIC  Z(002) FROM  W-BMC.         I.090121
007240         04  D-BMCN  COLUMN  16  PIC  N(004) FROM  W-BMCN.        I.090121
007250       03  D-YG    COLUMN  53  PIC  Z(005) FROM  W-YG.            I.090121
007260       03  D-KR.                                                  I.090121
007270         04  D-KRC   COLUMN  70  PIC  Z(001) FROM  W-KRC.         I.090121
007280         04  D-KRCN  COLUMN  72  PIC  N(001) FROM  W-KRCN.        I.090121
007290*****  03  D-BCN22 COLUMN  13  PIC  N(003) FROM  HKB-BRN22.       D.090121
007300*****  03  D-BCN21 COLUMN  21  PIC  N(004) FROM  W-BCN21.         D.090121
007310*****02  D-BCN1  LINE   7  COLUMN  12  PIC  N(008) FROM  HKB-BRN1.D.030514
007320*****02  D-BCN21 LINE   8  COLUMN  12  PIC  N(008) FROM  W-BRN2.  D.020620
007330     02  LINE   9.
007340       03  D-BCN12.                                               I.090121
007350         04  D-BCN1  COLUMN  16  PIC  N(008) FROM  HKB-BRN1.      I.090121
007360         04  D-BCN21 COLUMN  33  PIC  N(004) FROM  W-BCN21.       I.090121
007370       03  D-FT    COLUMN  53  PIC  Z(005) FROM  W-FT.            I.090121
007380       03  D-SC.                                                  I.090121
007390         04  D-SCC   COLUMN  70  PIC  Z(001) FROM  W-SCC.         I.090121
007400         04  D-SCCN  COLUMN  72  PIC  N(002) FROM  W-SCCN.        I.090121
007410     02  LINE  10.                                                I.090121
007420       03  D-BCN22 COLUMN  16  PIC  N(003) FROM  HKB-BRN22.       I.090121
007430       03  D-SB    COLUMN  53  PIC  Z(005) FROM  W-SB.            I.090121
007440       03  D-SSCM.                                                I.100601
007450         04  D-SSC   COLUMN  70  PIC  9(001) FROM  W-SSC.         I.100601
007460         04  D-SSCN  COLUMN  72  PIC  X(003) FROM  W-SSCN.        I.100601
007470*****  03  D-HK.                                                  D.100601
007480*****    04  D-HKB   COLUMN  70  PIC  Z(001) FROM  W-HKB.         D.100601
007490*****    04  D-HKBN  COLUMN  72  PIC  X(003) FROM  W-HKBN.        D.100601
007500     02  LINE  11.                                                I.090121
007510       03  D-BCN4  COLUMN  16  PIC  N(003) FROM  W-BCN4.          I.090121
007520       03  D-ISU   COLUMN  55  PIC  Z(003) FROM  W-ISU.           I.090121
007530       03  D-HK.                                                  I.100601
007540         04  D-HKB   COLUMN  70  PIC  Z(001) FROM  W-HKB.         I.100601
007550         04  D-HKBN  COLUMN  72  PIC  X(003) FROM  W-HKBN.        I.100601
007560*****  03  D-BCN3  COLUMN  13  PIC  N(003) FROM  HKB-BRN3.        D.090121
007570*****  03  D-BCN22 COLUMN  22  PIC  N(003) FROM  HKB-BRN22.       D.030514
007580*****  03  D-BCN3  COLUMN  12  PIC  N(003) FROM  HKB-BRN3.        D.030514
007590*****  03  D-SG.                                                  D.090121
007600*****    04  D-ZRG   COLUMN  31  PIC  Z(005) FROM  W-ZRG.         D.090121
007610*****    04  D-SKG   COLUMN  37  PIC  Z(005) FROM  W-SKG.         D.090121
007620*****    04  D-GKG   COLUMN  43  PIC  Z(005) FROM  W-GKG.         D.090121
007630*****    04  D-KNG   COLUMN  49  PIC  Z(004) FROM  W-KNG.         D.090121
007640*****    04  D-FT    COLUMN  54  PIC  Z(005) FROM  W-FT.          D.090121
007650*****  03  D-SB    COLUMN  60  PIC  Z(005) FROM  W-SB.            D.090121
007660*****  03  D-YG    COLUMN  66  PIC  Z(005) FROM  W-YG.            D.090121
007670*****  03  D-ISU   COLUMN  74  PIC  Z(003) FROM  W-ISU.           D.090121
007680*****02  D-BM    LINE  10.                                        D.090121
007690*****  03  D-BMC   COLUMN   9  PIC  Z(002) FROM  W-BMC.           D.090121
007700*****  03  D-BMCN  COLUMN  13  PIC  N(004) FROM  W-BMCN.          D.090121
007710*****02  D-KR    LINE  11.                                        D.090121
007720*****  03  D-KRC   COLUMN  67  PIC  Z(001) FROM  W-KRC.           D.090121
007730*****  03  D-KRCN  COLUMN  69  PIC  N(001) FROM  W-KRCN.          D.090121
007740*****02  D-SC    LINE  12.                                        D.090121
007750*****  03  D-SCC   COLUMN  67  PIC  Z(001) FROM  W-SCC.           D.090121
007760*****  03  D-SCCN  COLUMN  69  PIC  N(002) FROM  W-SCCN.          D.090121
007770*****02  D-HK    LINE  13.                                        D.090121
007780*****  03  D-HKB   COLUMN  67  PIC  Z(001) FROM  W-HKB.           D.090121
007790*****  03  D-HKBN  COLUMN  69  PIC  X(003) FROM  W-HKBN.          D.090121
007800*****  03  D-ISU   COLUMN  69  PIC  Z(003) FROM  W-ISU.           D.030822
007810*****  03  D-KR.                                                  D.030822
007820*****    04  D-KRC   COLUMN  75  PIC  Z(001) FROM  W-KRC.         D.030822
007830*****    04  D-KRCN  COLUMN  77  PIC  N(001) FROM  W-KRCN.        D.030822
007840*****02  LINE  13.                                                D.030822
007850*****  03  D-SC.                                                  D.030822
007860*****    04  D-SCC   COLUMN  59  PIC  Z(001) FROM  W-SCC.         D.030822
007870*****    04  D-SCCN  COLUMN  61  PIC  N(002) FROM  W-SCCN.        D.030822
007880*****  03  D-BM.                                                  D.030822
007890*****    04  D-BMC   COLUMN  68  PIC  Z(002) FROM  W-BMC.         D.030822
007900*****    04  D-BMCN  COLUMN  71  PIC  N(004) FROM  W-BMCN.        D.030822
007910*****02  D-SC    LINE  13.                                        D.020314
007920*****  03  D-SCC   COLUMN  59  PIC  Z(001) FROM  W-SCC.           D.020314
007930*****  03  D-SCCN  COLUMN  61  PIC  N(002) FROM  W-SCCN.          D.020314
007940     02  D-S     LINE W-L  COLUMN W-C  PIC  Z(001) FROM  W-S(CNT).
007950     02  LINE  22.
007960       03  D-SNGC  COLUMN   4  PIC  X(004) VALUE "    ".          I.090121
007970       03  D-ENGC  COLUMN   9  PIC  X(004) VALUE "    ".          I.090121
007980     02  D-TCD   LINE  21  COLUMN  28  PIC  N(026) FROM  T-NAME.  I.090121
007990*****  03  D-SNGC  COLUMN   2  PIC  X(004) VALUE "    ".          D.090121
008000*****  03  D-ENGC  COLUMN   7  PIC  X(004) VALUE "    ".          D.090121
008010*****02  D-TCD   LINE  20  COLUMN  26  PIC  N(026) FROM  T-NAME.  D.090121
008020*****02  D-TCD   LINE  20  COLUMN  26  PIC  N(024) FROM  T-NAME.  D.020402
008030 01  C-MID.
008040     02  LINE   1  COLUMN  14  PIC  X(050) VALUE
008050          "＊＊＊　　履物品名マスター　メンテナンス　　＊＊＊".
008060     02  LINE   3  COLUMN   8  PIC  X(037) VALUE                  I.061110
008070          "登録=1 修正=2 削除=3 作表=4 問合せ=5 ".                I.061110
008080     02  LINE   3  COLUMN  45  PIC  X(024) VALUE                  I.061110
008090          "一括削除=8 終了=9   ﾘﾀｰﾝ".                             I.061110
008100*****02  LINE   3  COLUMN  13  PIC  X(052) VALUE                  D.061110
008110*****     "登録=1 修正=2 削除=3 作表=4 一括削除=8 終了=9   ﾘﾀｰﾝ". D.061110
008120     02  LINE  23  COLUMN  53  PIC  X(022) VALUE
008130           "確認  OK=1 NO=9   ﾘﾀｰﾝ".
008140 01  C-PM.
008150     02  LINE   6  COLUMN  17  PIC  X(039) VALUE
008160           "大見出し　作表　する=5  しない=0   ﾘﾀｰﾝ".
008170     02  LINE  12  COLUMN  13  PIC  X(044) VALUE
008180           "<  品名ｺｰﾄﾞ        より        まで打出し  >".
008190 01  C-ERR.
008200     02  LINE  24.
008210       03  E-ME    COLUMN  15  PIC  X(030) FROM  W-MSG.
008220       03  E-FILE  COLUMN  46  PIC  X(013) FROM  W-FILE.
008230       03  E-HI    COLUMN  60  PIC  9(006) FROM  HI-KEY.
008240       03  E-HUH   COLUMN  60  PIC  9(006) FROM  HUH-KEY.
008250       03  E-HHT   COLUMN  60  PIC  9(007) FROM  HHT-KEY.
008260       03  E-THT   COLUMN  60  PIC  9(011) FROM  THT-KEY.
008270     COPY LSSEM.
008280     COPY LIBSCR.
008290 PROCEDURE DIVISION.
008300 M-05.
008310     ACCEPT JS-SIGN.                                              I.061110
008320     IF JS-SIGN > 1                                               I.061110
008330         STOP RUN.                                                I.061110
008340*****OPEN I-O HI-M.                                               D.061110
008350*****OPEN I-O HUH-M.                                              D.061110
008360*****OPEN I-O HHTF.                                               D.061110
008370*****OPEN I-O MSTRN.                                              D.061110
008380     OPEN INPUT HKBM.
008390     OPEN INPUT T-M.
008400     IF JS-SIGN = 1                                               I.061110
008410         OPEN INPUT HI-M                                          I.061110
008420       ELSE                                                       I.061110
008430         OPEN I-O HI-M                                            I.061110
008440         OPEN I-O HUH-M                                           I.061110
008450         OPEN I-O HHTF                                            I.061110
008460*****    OPEN I-O MSTRN                                           D.160329
008470         OPEN INPUT NJZAI.
008480     ACCEPT W-NGP FROM DATE.
008490     COPY LIBCPR.
008500     MOVE ZERO TO W-NG.
008510     MOVE D-NHNG TO W-NGS.
008520     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
008530         ADD DATE-NC1 TO W-NEN.
008540     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
008550         ADD DATE-NC2 TO W-NEN.
008560     MOVE DATE-02R TO H-DATE H-NGP.
008570 M-15.
008580     DISPLAY C-CLEAR.
008590     DISPLAY C-MID.
008600     CALL "SCHM11".
008610     ACCEPT A-ACT.
008620     IF ESTAT NOT = HTB AND SKP
008630         GO TO M-15.
008640     IF W-ACT = 9
008650         GO TO M-95.
008660     IF W-ACT = 4
008670         GO TO M-70.
008680*****IF W-ACT NOT = 1 AND 2 AND 3 AND 8                           D.061110
008690     IF JS-SIGN = 0                                               I.061110
008700         IF W-ACT NOT = 1 AND 2 AND 3 AND 5 AND 8                 I.061110
008710             GO TO M-15.
008720     IF JS-SIGN = 1                                               I.061110
008730         IF W-ACT NOT = 5                                         I.061110
008740             GO TO M-15.                                          I.061110
008750*
008760     INITIALIZE W-R.
008770     MOVE SPACE TO W-NAME W-CS.
008780 M-25.
008790     IF (W-ACT NOT = 1) OR (W-KEY = ZERO)
008800         DISPLAY C-CLEAR
008810         CALL "SCHM11"
008820         DISPLAY A-ACT
008830         INITIALIZE W-R
008840         MOVE SPACE TO W-NAME W-CS.
008850     IF W-ACT = 8
008860         ACCEPT A-HCD1
008870       ELSE
008880         ACCEPT A-HCD.
008890     DISPLAY E-CL.
008900     IF ESTAT = ADV
008910         IF W-ACT NOT = 1 AND 8
008920             GO TO M-30.
008930     IF ESTAT = BTB
008940         GO TO M-15.
008950     IF ESTAT NOT = HTB AND SKP
008960         GO TO M-25.
008970     IF W-ACT NOT = 8
008980         IF W-HCD = ZERO
008990             GO TO M-25.
009000     IF W-ACT = 8
009010         IF W-HCD1 = ZERO OR 9999
009020             GO TO M-25.
009030 M-30.
009040     PERFORM SET-RTN THRU SET-EX.
009050     IF W-END = 9
009060         GO TO M-95.
009070     IF W-ACP = 9
009080         GO TO M-25.
009090*--------------   登録・修正　入力   -----------------------------
009100 M-35.
009110     PERFORM ACP-RTN THRU ACP-EX.
009120     IF W-END = 9
009130         GO TO M-95.
009140     IF W-ACP = 9
009150         GO TO M-25.
009160     IF W-ACT = 5                                                 I.061110
009170         GO TO M-65.                                              I.061110
009180*-----------------   ＦＩＬＥ　ＷＲＩＴＥ   ----------------------
009190     IF W-ACT NOT = 1
009200         GO TO M-50.
009210 M-45.
009220     PERFORM WRI-RTN THRU WRI-EX.
009230     IF W-END = 9
009240         GO TO M-95.
009250     GO TO M-60.
009260*------------------   ＦＩＬＥ　ＲＥＷＲＩＴＥ   -----------------
009270 M-50.
009280     IF W-ACT NOT = 2
009290         GO TO M-55.
009300     PERFORM REW-RTN THRU REW-EX.
009310     IF W-END = 9
009320         GO TO M-95.
009330     GO TO M-60.
009340*------------------   ＦＩＬＥ　ＤＥＬＥＴＥ   -------------------
009350 M-55.
009360     PERFORM DEL-RTN THRU DEL-EX.
009370     IF W-END = 9
009380         GO TO M-95.
009390*---------------   マスター送信ファイル　作成   ------------------
009400 M-60.
009410     IF W-ACT = 1
009420         IF W-MHCD NOT = W-KEY
009430             GO TO M-25.
009440*****PERFORM MST-RTN THRU MST-EX.                                 D.160329
009450*****IF W-END = 9                                                 D.160329
009460*****    GO TO M-95.                                              D.160329
009470 M-65.                                                            I.061110
009480     IF W-ACTD NOT = 0
009490         MOVE W-ACTD TO W-ACT.
009500     GO TO M-25.
009510*-----------------   プルーフ　リスト   --------------------------
009520 M-70.
009530     PERFORM PRI-RTN THRU PRI-EX.
009540     GO TO M-15.
009550*--------------------   Ｅ　Ｎ　Ｄ   -----------------------------
009560 M-95.
009570     CLOSE HI-M.
009580*****CLOSE HHTF.                                                  D.061110
009590*****CLOSE HUH-M.                                                 D.061110
009600*****CLOSE MSTRN.                                                 D.061110
009610     CLOSE HKBM.
009620     CLOSE T-M.
009630     IF JS-SIGN NOT = 1                                           I.061110
009640         CLOSE HHTF                                               I.061110
009650         CLOSE HUH-M                                              I.061110
009660*****    CLOSE MSTRN                                              D.160329
009670         CLOSE NJZAI.                                             I.020108
009680*****IF W-POC = 5                                                 D.151120
009690     IF W-POC = 9                                                 I.151120
009700         CLOSE SP-F.
009710     DISPLAY C-CLEAR.
009720     STOP RUN.
009730******************************************
009740*****    入力可能　チェック　　　    *****
009750******************************************
009760 SET-RTN.
009770     MOVE 0 TO W-ACP.
009780     IF W-ACT NOT = 8
009790         GO TO SET-040.
009800     MOVE SPACE TO HI-KEY.
009810     MOVE W-HCD1 TO HI-HCD1.
009820     START HI-M KEY NOT < HI-KEY INVALID KEY
009830         GO TO SET-300.
009840     READ HI-M NEXT RECORD AT END
009850         GO TO SET-300.
009860     IF W-HCD1 NOT = HI-HCD1
009870         GO TO SET-300.
009880*
009890     MOVE HI-R TO W-R.
009900     MOVE HI-KEY TO W-HCD.
009910     MOVE SPACE TO W-NMD.
009920     MOVE HI-NAME TO W-NMD.
009930     MOVE SPACE TO W-NAME.
009940     MOVE ZERO TO CNT.
009950 SET-020.
009960     ADD 1 TO CNT.
009970     IF CNT = 25
009980         DISPLAY A-NAME
009990         GO TO SET-100.
010000     MOVE W-NM(CNT) TO W-NA(CNT).
010010     IF W-NA(CNT) NOT = SPACE
010020         GO TO SET-020.
010030     ADD 1 TO CNT.
010040     IF CNT = 25
010050         DISPLAY A-NAME
010060         GO TO SET-100.
010070     MOVE W-NM(CNT) TO W-NA(CNT).
010080     IF W-NA(CNT) NOT = SPACE
010090         GO TO SET-020.
010100     DISPLAY A-NAME.
010110     GO TO SET-100.
010120 SET-040.
010130     IF W-HCD = ZERO
010140         GO TO SET-060.
010150     MOVE W-HCD TO HI-KEY.
010160     IF JS-SIGN = 0                                               I.061110
010170         READ HI-M INVALID KEY
010180             GO TO SET-300.
010190     IF JS-SIGN = 1                                               I.061110
010200         READ HI-M WITH UNLOCK INVALID KEY                        I.061110
010210             GO TO SET-300.                                       I.061110
010220     GO TO SET-080.
010230 SET-060.
010240     READ HI-M NEXT RECORD AT END
010250         GO TO SET-300.
010260     MOVE HI-KEY TO W-HCD.
010270 SET-080.
010280     MOVE HI-R TO W-R.
010290     IF W-ACT NOT = 5                                             I.061110
010300         PERFORM DO1-RTN THRU DO1-EX.
010310     IF W-END = 9
010320         GO TO SET-EX.
010330     PERFORM CRT-RTN THRU CRT-EX.
010340     IF W-ACP = 9
010350         GO TO SET-EX.
010360     IF W-ACT = 5                                                 I.061110
010370         GO TO SET-EX.                                            I.061110
010380     IF W-ACT = 2
010390*****    MOVE ZERO TO W-GEN                                       D.090121
010400         MOVE W-FT TO W-FTD
010410*****    MOVE W-ZRG TO W-ZRGD                                     D.090121
010420*****    MOVE W-SKG TO W-SKGD                                     D.090121
010430*****    MOVE W-GKG TO W-GKGD                                     D.090121
010440*****    MOVE W-KNG TO W-KNGD                                     D.090121
010450         INITIALIZE W-OMD
010460         MOVE W-MHCD TO W-OMHCD
010470*****    MOVE W-NAME TO W-ONAME                                   D.160329
010480         MOVE W-BC TO W-OBC
010490         MOVE W-BMC TO W-OBMC                                     I.020425
010500         MOVE W-SKDD TO W-OSKDD
010510*****    MOVE W-ISU TO W-OISU                                     D.160329
010520*****    MOVE W-SMS TO W-OSMS                                     D.160329
010530*****    MOVE W-HKB TO W-OHKB                                     D.160329
010540*****    MOVE W-SSC TO W-OSSC                                     D.160329
010550         GO TO SET-EX.
010560     IF W-ACT = 1
010570         MOVE SPACE TO W-MSG
010580         MOVE "***  登録済み  ***" TO W-MSG
010590         DISPLAY E-ME E-ME98
010600         MOVE 9 TO W-ACP
010610         GO TO SET-EX.
010620 SET-100.
010630     MOVE W-HCD TO HUH-HCD.
010640     READ HUH-M WITH UNLOCK INVALID KEY
010650         GO TO SET-120.
010660     IF ZERO NOT = HUH-ZS OR HUH-ZK OR HUH-NS OR HUH-NK OR
010670                   HUH-SS OR HUH-SK OR HUH-YS OR HUH-YK OR HUH-UG
010680         MOVE SPACE TO W-MSG W-FILE
010690         MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG
010700         MOVE "HUHM" TO W-FILE
010710         DISPLAY E-ME E-FILE E-HUH E-ME99
010720         MOVE 9 TO W-ACP
010730         GO TO SET-EX.
010740 SET-120.
010750     MOVE SPACE TO HHT-KEY.
010760     MOVE W-HCD TO HHT-HCD.
010770     START HHTF KEY NOT < HHT-KEY INVALID KEY
010780         GO TO SET-180.
010790 SET-140.
010800     READ HHTF NEXT RECORD WITH UNLOCK AT END
010810         GO TO SET-180.
010820     IF W-HCD NOT = HHT-HCD
010830         GO TO SET-180.
010840*
010850     MOVE ZERO TO CNT.
010860 SET-160.
010870     ADD 1 TO CNT.
010880     IF CNT = 11
010890         GO TO SET-140.
010900     IF ZERO = HHT-ZSU(CNT) AND HHT-NSU(CNT) AND HHT-USU(CNT)
010910         GO TO SET-160.
010920     MOVE SPACE TO W-MSG W-FILE.
010930     MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG.
010940     MOVE "HHTF" TO W-FILE.
010950     DISPLAY E-ME E-FILE E-HHT E-ME99.
010960     MOVE 9 TO W-ACP.
010970     GO TO SET-EX.
010980 SET-180.
010990     IF HI-MHCD NOT = HI-HCD
011000         GO TO SET-260.
011010     MOVE SPACE TO HI-KEY2.
011020     MOVE W-HCD TO HI-MHCD.
011030     START HI-M KEY NOT < HI-KEY2 INVALID KEY
011040         GO TO SET-220.
011050 SET-200.
011060     READ HI-M NEXT RECORD WITH UNLOCK AT END
011070         GO TO SET-220.
011080     IF W-HCD NOT = HI-MHCD
011090         GO TO SET-220.
011100     IF HI-MHCD = HI-HCD
011110         GO TO SET-200.
011120     MOVE SPACE TO W-MSG.
011130     MOVE "***  ｺ ｺｰﾄﾞ ｱﾘ  ***" TO W-MSG.
011140     DISPLAY E-ME E-HI E-ME99.
011150     MOVE 9 TO W-ACP.
011160     GO TO SET-EX.
011170 SET-220.
011180     MOVE W-HCD TO HI-KEY.
011190     READ HI-M INVALID KEY
011200         MOVE SPACE TO W-MSG
011210         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
011220         DISPLAY E-ME E-ME98
011230         MOVE 9 TO W-ACP
011240         GO TO SET-EX.
011250 SET-260.
011260     IF W-ACT = 3
011270         GO TO SET-EX.
011280     READ HI-M NEXT RECORD AT END
011290         GO TO SET-EX.
011300     IF W-HCD NOT = HI-KEY
011310         GO TO SET-EX.
011320     MOVE HI-R TO W-R.
011330     MOVE HI-KEY TO W-HCD.
011340     GO TO SET-100.
011350 SET-300.
011360     IF W-ACT NOT = 1
011370         MOVE SPACE TO W-MSG
011380         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
011390         DISPLAY E-ME E-ME98
011400         MOVE 9 TO W-ACP
011410         GO TO SET-EX.
011420     MOVE W-HCD TO W-KEY.
011430     PERFORM DO2-RTN THRU DO2-EX.
011440 SET-EX.
011450     EXIT.
011460*******************************
011470*****    同期確認(ADD)　　*****
011480*******************************
011490 DO1-RTN.
011500     MOVE W-KEY TO HUH-KEY.
011510     READ HUH-M WITH UNLOCK INVALID KEY
011520         MOVE SPACE TO W-MSG
011530         MOVE "***  HUHM ﾅｼ  ***" TO W-MSG
011540         DISPLAY E-ME E-ME99
011550         PERFORM HU1-RTN THRU HU1-EX.
011560     IF W-END = 9
011570         GO TO DO1-EX.
011580     MOVE ZERO TO CNT.
011590 DO1-020.
011600     ADD 1 TO CNT.
011610     IF CNT = 5
011620         GO TO DO1-EX.
011630     IF HI-SS(CNT) = ZERO
011640         GO TO DO1-020.
011650     MOVE HI-KEY TO HHT-HCD.
011660     MOVE CNT TO HHT-SIZ.
011670     READ HHTF WITH UNLOCK INVALID KEY
011680         MOVE SPACE TO W-MSG
011690         MOVE "***  HHTF ﾅｼ  ***" TO W-MSG
011700         DISPLAY E-ME E-ME99
011710         PERFORM HH1-RTN THRU HH1-EX.
011720     IF W-END = 9
011730         GO TO DO1-EX.
011740     GO TO DO1-020.
011750 DO1-EX.
011760     EXIT.
011770*******************************
011780*****    同期確認(DEL)　　*****
011790*******************************
011800 DO2-RTN.
011810     MOVE 0 TO W-ZC.
011820     MOVE W-HCD TO HUH-HCD.
011830     READ HUH-M WITH UNLOCK INVALID KEY
011840         GO TO DO2-020.
011850     IF W-ZC = 0
011860         MOVE SPACE TO W-MSG W-FILE
011870         MOVE "***  DATA ｱﾘ  ***" TO W-MSG
011880         MOVE "HUHM" TO W-FILE
011890         MOVE 1 TO W-ZC
011900         DISPLAY E-ME E-FILE E-HUH E-ME99
011910         DISPLAY E-CL.
011920     IF ZERO = HUH-ZS AND HUH-ZK AND HUH-NS AND HUH-NK AND
011930               HUH-SS AND HUH-SK AND HUH-YS AND HUH-YK AND HUH-UG
011940         GO TO DO2-020.
011950     MOVE 9 TO W-ZC.
011960     MOVE SPACE TO W-MSG W-FILE.
011970     MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG.
011980     MOVE "HUHM" TO W-FILE.
011990     DISPLAY E-ME E-FILE E-HUH E-ME99.
012000     MOVE 9 TO W-END.
012010     GO TO DO2-EX.
012020 DO2-020.
012030     MOVE SPACE TO HHT-KEY.
012040     MOVE W-HCD TO HHT-HCD.
012050     START HHTF KEY NOT < HHT-KEY INVALID KEY
012060         GO TO DO2-080.
012070 DO2-040.
012080     READ HHTF NEXT RECORD WITH UNLOCK AT END
012090         GO TO DO2-080.
012100     IF W-HCD NOT = HHT-HCD
012110         GO TO DO2-080.
012120     IF W-ZC = 0 OR 1
012130         MOVE SPACE TO W-MSG W-FILE
012140         MOVE "***  DATA ｱﾘ  ***" TO W-MSG
012150         MOVE "HHTF" TO W-FILE
012160         MOVE 2 TO W-ZC
012170         DISPLAY E-ME E-FILE E-HHT E-ME99
012180         DISPLAY E-CL.
012190     MOVE ZERO TO CNT.
012200 DO2-060.
012210     ADD 1 TO CNT.
012220     IF CNT = 11
012230         GO TO DO2-040.
012240     IF ZERO = HHT-ZSU(CNT) AND HHT-NSU(CNT) AND HHT-USU(CNT)
012250         GO TO DO2-060.
012260     MOVE 9 TO W-ZC.
012270     MOVE SPACE TO W-MSG W-FILE.
012280     MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG.
012290     MOVE "HUHM" TO W-FILE.
012300     DISPLAY E-ME E-FILE E-HHT E-ME99.
012310     MOVE 9 TO W-END.
012320     GO TO DO2-EX.
012330 DO2-080.
012340     IF W-ZC = 0
012350         GO TO DO2-EX.
012360     MOVE W-HCD TO HUH-HCD.
012370     READ HUH-M INVALID KEY
012380         GO TO DO2-100.
012390     DELETE HUH-M INVALID KEY
012400         MOVE SPACE TO W-MSG W-FILE
012410         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
012420         MOVE "HUHM" TO W-FILE
012430         MOVE 9 TO W-END
012440         DISPLAY E-STAT E-ME E-FILE E-HUH E-ME99
012450         GO TO DO2-EX.
012460 DO2-100.
012470     MOVE SPACE TO HHT-KEY.
012480     MOVE W-HCD TO HHT-HCD.
012490     START HHTF KEY NOT < HHT-KEY INVALID KEY
012500         GO TO DO2-EX.
012510 DO2-120.
012520     READ HHTF NEXT RECORD AT END
012530         GO TO DO2-EX.
012540     IF W-HCD NOT = HHT-HCD
012550         GO TO DO2-EX.
012560     DELETE HHTF INVALID KEY
012570         MOVE SPACE TO W-MSG W-FILE
012580         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
012590         MOVE "HHTF" TO W-FILE
012600         MOVE 9 TO W-END
012610         DISPLAY E-STAT E-ME E-FILE E-HHT E-ME99
012620         GO TO DO2-EX.
012630     GO TO DO2-120.
012640 DO2-EX.
012650     EXIT.
012660****************************
012670*****    画面　入力　　*****
012680****************************
012690 ACP-RTN.
012700     MOVE 0 TO W-ACP W-SKP.
012710*****IF W-ACT = 3 OR 8                                            D.061110
012720     IF W-ACT = 3 OR 5 OR 8                                       I.061110
012730         GO TO ACP-980.
012740 ACP-020.
012750     MOVE W-MHCD TO W-BMHCD.
012760     ACCEPT A-MHCD.
012770     DISPLAY A-MHCD.
012780     DISPLAY E-CL.
012790     IF ESTAT = ADV
012800         MOVE W-MHCD TO W-MHCD
012810         DISPLAY A-MHCD
012820         MOVE 1 TO W-SKP.
012830     IF ESTAT = PF6
012840         MOVE 6 TO W-SKP.
012850     IF ESTAT = BTB
012860         MOVE 9 TO W-ACP
012870         GO TO ACP-EX.
012880     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV
012890         GO TO ACP-020.
012900     IF W-MHCD = ZERO
012910         MOVE W-KEY TO W-MHCD
012920         DISPLAY A-MHCD D-MHNA.
012930     IF W-MHCD = W-KEY
012940         DISPLAY D-CHNA
012950         GO TO ACP-040.
012960     MOVE W-MHCD TO HI-KEY.
012970     READ HI-M WITH UNLOCK INVALID KEY
012980         MOVE SPACE TO W-MSG
012990         MOVE "***  ﾋﾝﾒｲ ﾅｼ  ***" TO W-MSG
013000         DISPLAY E-ME E-ME98
013010         MOVE 0 TO W-SKP
013020         GO TO ACP-020.
013030     DISPLAY D-MHNA.
013040     IF HI-KEY NOT = HI-MHCD
013050         MOVE SPACE TO W-MSG
013060         MOVE "***  親ｺｰﾄﾞ ﾃﾞﾅｲ  ***" TO W-MSG
013070         DISPLAY E-ME E-ME98
013080         MOVE 0 TO W-SKP
013090         GO TO ACP-020.
013100     IF W-ACT NOT = 1
013110         GO TO ACP-040.
013120*
013130     IF W-NAME = SPACE
013140         MOVE HI-NAME TO W-NAME
013150         DISPLAY A-NAME.
013160     IF W-BC1 = ZERO
013170         MOVE HI-BCD1 TO W-BCD1                                   I.030514
013180         DISPLAY A-BCD1.                                          I.030514
013190*****    MOVE HI-BC1 TO W-BC1                                     D.030514
013200*****    DISPLAY A-BC1.                                           D.030514
013210     IF W-BC22 = ZERO                                             I.030514
013220         MOVE HI-BC22 TO W-BC22                                   I.030514
013230         DISPLAY A-BC22.                                          I.030514
013240     IF W-BC3 = ZERO
013250         MOVE HI-BC3 TO W-BC3
013260         DISPLAY A-BC3.
013270     IF W-SB = ZERO
013280         MOVE HI-SB TO W-SB
013290         DISPLAY D-SB.
013300     IF W-ISU = ZERO
013310         MOVE HI-ISU TO W-ISU
013320         DISPLAY D-ISU.
013330     IF W-KRC = ZERO                                              I.090121
013340         MOVE HI-KRC TO W-KRC                                     I.090121
013350         DISPLAY A-KRC.                                           I.090121
013360     IF W-SSC = ZERO                                              I.100601
013370         MOVE HI-SSC TO W-SSC                                     I.100601
013380         DISPLAY D-SSCM.                                          I.090121
013390     IF W-HKB = ZERO                                              I.090121
013400         MOVE HI-HKB TO W-HKB                                     I.090121
013410         DISPLAY A-HKB.                                           I.090121
013420     IF W-HPV = ZERO                                              I.090121
013430         MOVE HI-HPV TO W-HPV                                     I.090121
013440         DISPLAY A-HPV.                                           I.090121
013450     IF W-BC4 = ZERO                                              I.090121
013460         MOVE HI-BC4 TO W-BC4                                     I.090121
013470         DISPLAY A-HPV.                                           I.090121
013480     IF W-TCD = ZERO
013490         MOVE HI-TCD TO W-TCD
013500         DISPLAY A-TCD.
013510     IF W-SMS = SPACE                                             I.090121
013520         MOVE HI-SMS TO W-SMS                                     I.090121
013530         DISPLAY A-SMS.                                           I.090121
013540     IF W-SSD = ZERO
013550         MOVE HI-ASSD TO W-SSD
013560         PERFORM CRT-030 THRU CRT-EX.
013570 ACP-040.
013580     IF (W-ACT = 2) AND (W-HCD NOT = HI-KEY)
013590         MOVE W-HCD TO HI-KEY
013600         READ HI-M INVALID KEY
013610             MOVE SPACE TO W-MSG
013620             MOVE "***  ﾓﾄﾉ ﾋﾝﾒｲ ﾅｼ  ***" TO W-MSG
013630             DISPLAY E-ME E-ME98
013640             MOVE 0 TO W-SKP
013650             GO TO ACP-020.
013660     IF W-ACT NOT = 2                                             I.020108
013670         GO TO ACP-050.                                           I.020108
013680     IF W-OMHCD = W-MHCD                                          I.020108
013690         GO TO ACP-050.                                           I.020108
013700     MOVE SPACE TO NJZAI-KEY.                                     I.020108
013710     MOVE 9 TO NJZAI-01.                                          I.020108
013720     MOVE W-OMHCD TO NJZAI-02.                                    I.020108
013730     START NJZAI KEY NOT < NJZAI-KEY INVALID KEY                  I.020108
013740         GO TO ACP-050.                                           I.020108
013750     READ NJZAI NEXT RECORD WITH UNLOCK AT END                    I.020108
013760         GO TO ACP-050.                                           I.020108
013770     IF (NJZAI-01 NOT = 9) OR (NJZAI-02 NOT = W-OMHCD)            I.020108
013780         GO TO ACP-050.                                           I.020108
013790     MOVE SPACE TO W-MSG.                                         I.020108
013800     MOVE "***  ｸﾗﾍﾞﾂ ｻﾞｲｺ ﾃﾞｰﾀ ｱﾘ  ***" TO W-MSG.                I.020108
013810     DISPLAY E-ME E-ME99.                                         I.020108
013820     DISPLAY E-CL.                                                I.020108
013830 ACP-050.                                                         I.020108
013840     IF W-SKP NOT = 0
013850         GO TO ACP-070.
013860 ACP-060.
013870     MOVE W-NAME TO W-BNAME.
013880     ACCEPT A-NAME.
013890     DISPLAY A-NAME.
013900     DISPLAY E-CL.
013910     IF ESTAT = ADV
013920         MOVE W-BNAME TO W-NAME
013930         DISPLAY A-NAME
013940         MOVE 1 TO W-SKP.
013950     IF ESTAT = PF6
013960         MOVE 6 TO W-SKP.
013970     IF ESTAT = BTB
013980         GO TO ACP-020.
013990     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV
014000         GO TO ACP-060.
014010 ACP-070.
014020     IF SPACE = W-NAA(01) OR W-NAA(03) OR W-NAA(05) OR W-NAA(07)
014030             OR W-NAA(09) OR W-NAA(11) OR W-NAA(13) OR W-NAA(15)
014040             OR W-NAA(17) OR W-NAA(19) OR W-NAA(21) OR W-NAA(23)
014050             OR W-NAA(25) OR W-NAA(27) OR W-NAA(29) OR W-NAA(31)
014060             OR W-NAA(33) OR W-NAA(35) OR W-NAA(37) OR W-NAA(39)
014070             OR W-NAA(41) OR W-NAA(43) OR W-NAA(45) OR W-NAA(47)
014080         MOVE SPACE TO W-MSG
014090         MOVE "***  ｺﾓｼﾞ ﾉ ｽﾍﾟｰｽ ｱﾘ  ***" TO W-MSG
014100         DISPLAY E-ME E-ME98
014110         MOVE 0 TO W-SKP
014120         GO TO ACP-060.
014130     IF W-SKP = 6
014140         MOVE 0 TO W-SKP.
014150     IF W-SKP NOT = 0
014160         GO TO ACP-074.                                           I.090121
014170*****    GO TO ACP-120.                                           D.090121
014180 ACP-072.                                                         I.090121
014190     MOVE W-SMS TO W-BSMS.                                        I.090121
014200     ACCEPT A-SMS.                                                I.090121
014210     DISPLAY A-SMS.                                               I.090121
014220     DISPLAY E-CL.                                                I.090121
014230     IF ESTAT = ADV                                               I.090121
014240         MOVE W-BSMS TO W-SMS                                     I.090121
014250         DISPLAY A-SMS                                            I.090121
014260         MOVE 1 TO W-SKP.                                         I.090121
014270     IF ESTAT = PF6                                               I.090121
014280         MOVE 6 TO W-SKP.                                         I.090121
014290     IF ESTAT = BTB                                               I.090121
014300         GO TO ACP-060.                                           I.090121
014310     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV           I.090121
014320         GO TO ACP-072.                                           I.090121
014330 ACP-074.                                                         I.090121
014340     IF SPACE = W-SM(01) OR W-SM(03) OR W-SM(05) OR W-SM(07)      I.090121
014350             OR W-SM(09) OR W-SM(11) OR W-SM(13) OR W-SM(15)      I.090121
014360             OR W-SM(17) OR W-SM(19) OR W-SM(21) OR W-SM(23)      I.090121
014370             OR W-SM(25) OR W-SM(27) OR W-SM(29) OR W-SM(31)      I.090121
014380         MOVE SPACE TO W-MSG                                      I.090121
014390         MOVE "***  ｺﾓｼﾞ ﾉ ｽﾍﾟｰｽ ｱﾘ  ***" TO W-MSG                I.090121
014400         DISPLAY E-ME E-ME98                                      I.090121
014410         MOVE 0 TO W-SKP                                          I.090121
014420         GO TO ACP-072.                                           I.090121
014430     IF W-SMS = SPACE                                             I.100625
014440         GO TO ACP-072.                                           I.100625
014450     IF W-SKP = 6                                                 I.090121
014460         MOVE 0 TO W-SKP.                                         I.090121
014470     IF W-SKP NOT = 0                                             I.090121
014480         GO TO ACP-084.                                           I.090121
014490 ACP-082.                                                         I.090121
014500     MOVE W-BC3 TO W-BBC3.                                        I.090121
014510     ACCEPT A-BC3.                                                I.090121
014520     DISPLAY A-BC3.                                               I.090121
014530     DISPLAY E-CL.                                                I.090121
014540     IF ESTAT = ADV                                               I.090121
014550         MOVE W-BBC3 TO W-BC3                                     I.090121
014560         DISPLAY A-BC3                                            I.090121
014570         MOVE 1 TO W-SKP.                                         I.090121
014580     IF ESTAT = PF6                                               I.090121
014590         MOVE 6 TO W-SKP.                                         I.090121
014600     IF ESTAT = BTB                                               I.090121
014610         GO TO ACP-072.                                           I.090121
014620     IF ESTAT = HTB OR SKP                                        I.090121
014630         MOVE 0 TO W-SKP.                                         I.090121
014640     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV           I.090121
014650         GO TO ACP-082.                                           I.090121
014660 ACP-084.                                                         I.090121
014670     MOVE SPACE TO HKB-KEY.                                       I.090121
014680     MOVE "14" TO HKB-NO.                                         I.090121
014690     MOVE W-BC3 TO HKB-BR3.                                       I.090121
014700     PERFORM HKB-RTN THRU HKB-EX.                                 I.090121
014710     IF W-INV NOT = 0                                             I.090121
014720         MOVE 0 TO W-INV W-SKP                                    I.090121
014730         GO TO ACP-082.                                           I.090121
014740     DISPLAY A-BC3 D-BCN3.                                        I.090121
014750     IF W-SKP = 6                                                 I.090121
014760         MOVE 0 TO W-SKP.                                         I.090121
014770     IF W-SKP NOT = 0                                             I.090121
014780         GO TO ACP-088.                                           I.090121
014790 ACP-086.                                                         I.090121
014800     MOVE W-BMC TO W-BBMC.                                        I.090121
014810     ACCEPT A-BMC.                                                I.090121
014820     DISPLAY E-CL.                                                I.090121
014830     IF ESTAT = ADV                                               I.090121
014840         MOVE W-BBMC TO W-BMC                                     I.090121
014850         DISPLAY A-BMC                                            I.090121
014860         MOVE 1 TO W-SKP.                                         I.090121
014870     IF ESTAT = PF6                                               I.090121
014880         MOVE 6 TO W-SKP.                                         I.090121
014890     IF ESTAT = BTB                                               I.090121
014900         GO TO ACP-082.                                           I.090121
014910     IF ESTAT = HTB AND SKP                                       I.090121
014920         MOVE 0 TO W-SKP.                                         I.090121
014930     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.090121
014940         GO TO ACP-086.                                           I.090121
014950 ACP-088.                                                         I.090121
014960     IF W-BMC NOT = 22 AND 23 AND 24 AND 26 AND 29                I.090121
014970         GO TO ACP-086.                                           I.090121
014980     IF W-BC3 = 10                                                I.090121
014990         IF W-BMC = 23 OR 24                                      I.090121
015000             GO TO ACP-086.                                       I.090121
015010     IF W-BC3 = 20                                                I.090121
015020         IF W-BMC NOT = 23                                        I.090121
015030             GO TO ACP-086.                                       I.090121
015040     IF W-BC3 = 30                                                I.090121
015050         IF W-BMC NOT = 24                                        I.090121
015060             GO TO ACP-086.                                       I.090121
015070     IF W-BMC = 22                                                I.090121
015080         MOVE 1 TO W-BMNO                                         I.090121
015090         MOVE NC"国　内" TO W-BMCN.                               I.090121
015100     IF W-BMC = 23                                                I.090121
015110         MOVE 4 TO W-BMNO                                         I.090121
015120         MOVE NC"ワーク" TO W-BMCN.                               I.090121
015130     IF W-BMC = 24                                                I.090121
015140         MOVE 5 TO W-BMNO                                         I.090121
015150         MOVE NC"教　育" TO W-BMCN.                               I.090121
015160     IF W-BMC = 26                                                I.090121
015170         MOVE 2 TO W-BMNO                                         I.090121
015180         MOVE NC"上　海" TO W-BMCN.                               I.090121
015190     IF W-BMC = 29                                                I.090121
015200         MOVE 3 TO W-BMNO                                         I.090121
015210         MOVE NC"仕　入" TO W-BMCN.                               I.090121
015220*
015230     DISPLAY D-BM.                                                I.090121
015240     IF W-SKP NOT = 0                                             I.090121
015250         GO TO ACP-120.                                           I.090121
015260 ACP-100.
015270*****MOVE W-BC1 TO W-BBC1.                                        D.030514
015280*****ACCEPT A-BC1.                                                D.030514
015290*****DISPLAY A-BC1.                                               D.030514
015300     MOVE W-BCD1 TO W-BBCD1.                                      I.030514
015310     ACCEPT A-BCD1.                                               I.030514
015320     DISPLAY A-BCD1.                                              I.030514
015330     DISPLAY E-CL.
015340     IF ESTAT = ADV
015350*****    MOVE W-BBC1 TO W-BC1                                     D.030514
015360*****    DISPLAY A-BC1                                            D.030514
015370         MOVE W-BBCD1 TO W-BCD1                                   I.030514
015380         DISPLAY A-BCD1                                           I.030514
015390         MOVE 1 TO W-SKP.
015400     IF ESTAT = PF6
015410         MOVE 6 TO W-SKP.
015420     IF ESTAT = BTB
015430         GO TO ACP-086.                                           I.090121
015440*****    GO TO ACP-060.                                           D.090121
015450     IF ESTAT = HTB OR SKP
015460         MOVE 0 TO W-SKP.
015470     IF ESTAT NOT = HTB AND SKP AND PF7 AND PF6 AND ADV
015480         GO TO ACP-100.
015490*****IF W-BC1 = 21                                                D.040420
015500*****    IF W-BC21 < 1 OR > 6                                     D.040420
015510*****        GO TO ACP-120.                                       D.040420
015520 ACP-120.
015530     MOVE 0 TO W-INV.
015540     MOVE SPACE TO HKB-KEY.
015550     MOVE "11" TO HKB-NO.
015560     MOVE W-BC1 TO HKB-BR1.
015570     PERFORM HKB-RTN THRU HKB-EX.
015580     IF W-INV NOT = 0
015590         MOVE 0 TO W-INV W-SKP
015600         GO TO ACP-100.
015610     DISPLAY A-BCD1 D-BCN1.                                       I.030514
015620     MOVE SPACE TO W-BCN21.                                       I.030514
015630     PERFORM BC21-RTN THRU BC21-EX.                               I.030514
015640*****IF W-BC1 NOT = 21 AND 81                                     D.040420
015650*****IF W-BC1 NOT = 21 AND 26 AND 81                              D.041201
015660*****IF W-BC1 NOT = 26 AND 81                                     D.060524
015670*****IF W-BC1 NOT = 26 AND 48 AND 58                              D.060525
015680     IF W-BC3 = 10                                                I.090121
015690         IF W-BC1 = 11 OR 12 OR 13 OR 41 OR 50 OR 51 OR 55 OR 56  I.090121
015700                       OR 58 OR 71 OR 72                          I.090121
015710             GO TO ACP-100.                                       I.090121
015720     IF W-BC3 = 20                                                I.090121
015730         IF W-BC1 = 22 OR 23 OR 26 OR 27 OR 71 OR 72              I.090121
015740             GO TO ACP-100.                                       I.090121
015750     IF W-BC3 = 30                                                I.090121
015760*****    IF W-BC1 NOT = 71 AND 72 AND 91                          D.131021
015770*****    IF W-BC1 NOT = 71 AND 72 AND 74 AND 91                   D.170531
015780         IF W-BC1 NOT = 71 AND 72 AND 74 AND 76 AND 91            I.170531
015790             GO TO ACP-100.                                       I.090121
015800     IF W-BC1 NOT = 26 AND 32 AND 51 AND 48 AND 58                I.060525
015810         IF W-BC21 NOT = 0                                        I.030514
015820             GO TO ACP-100.                                       I.030514
015830*****IF W-BC1 = 21                                                D.041201
015840*****    IF W-BC21 < 1 OR > 7                                     D.041201
015850*****        GO TO ACP-100.                                       D.041201
015860     IF W-BC1 = 26                                                I.040420
015870*****    IF W-BC21 < 1 OR > 2                                     D.040611
015880         IF W-BC21 < 1 OR > 3                                     I.040611
015890             GO TO ACP-100.                                       I.040420
015900*****IF W-BC1 = 81                                                D.060524
015910*****    IF W-BC21 < 1 OR > 2                                     D.050727
015920     IF W-BC1 = 32 OR 51                                          I.060525
015930         IF W-BC21 < 1 OR > 2                                     I.060525
015940             GO TO ACP-100.                                       I.060525
015950     IF W-BC1 = 48 OR 58                                          I.060524
015960         IF W-BC21 < 1 OR > 3                                     I.050727
015970             GO TO ACP-100.                                       I.030514
015980     DISPLAY D-BCN21.                                             I.030514
015990*****DISPLAY A-BC1 D-BCN1.                                        D.030514
016000     IF W-SKP NOT = 0
016010         GO TO ACP-160.
016020 ACP-140.
016030*****MOVE W-BC2 TO W-BBC2.                                        D.030514
016040*****ACCEPT A-BC2.                                                D.030514
016050*****DISPLAY A-BC2.                                               D.030514
016060     MOVE W-BC22 TO W-BBC22.                                      I.030514
016070     ACCEPT A-BC22.                                               I.030514
016080     DISPLAY A-BC22.                                              I.030514
016090     DISPLAY E-CL.
016100     IF ESTAT = ADV
016110*****    MOVE W-BBC2 TO W-BC2                                     D.030514
016120*****    DISPLAY A-BC2                                            D.030514
016130         MOVE W-BBC22 TO W-BC22                                   I.030514
016140         DISPLAY A-BC22                                           I.030514
016150         MOVE 1 TO W-SKP.
016160     IF ESTAT = PF6
016170         MOVE 6 TO W-SKP.
016180     IF ESTAT = BTB
016190         GO TO ACP-100.
016200     IF ESTAT = HTB OR SKP
016210         MOVE 0 TO W-SKP.
016220     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV
016230         GO TO ACP-140.
016240 ACP-160.
016250*****MOVE SPACE TO HKB-KEY.                                       D.020620
016260*****MOVE 12 TO HKB-NO.                                           D.020620
016270*****MOVE W-BC21 TO HKB-BR21.                                     D.020620
016280*****PERFORM HKB-RTN THRU HKB-EX.                                 D.020620
016290*****IF W-INV NOT = 0                                             D.020620
016300*****    MOVE 0 TO W-INV W-SKP                                    D.020620
016310*****    GO TO ACP-140.                                           D.020620
016320*****MOVE SPACE TO W-BRN2.                                        D.020620
016330*****IF HKB-BRN21R = SPACE                                        D.020620
016340*****    MOVE HKB-BRN21F TO W-BRN2                                D.020620
016350*****  ELSE                                                       D.020620
016360*****    MOVE HKB-BRN21S TO W-BRN2F                               D.020620
016370*****    MOVE HKB-BRN21R TO W-BRN2R.                              D.02620
016380     MOVE SPACE TO HKB-KEY.
016390     MOVE 13 TO HKB-NO.
016400     MOVE W-BC22 TO HKB-BR22.
016410     PERFORM HKB-RTN THRU HKB-EX.
016420     IF W-INV NOT = 0
016430         MOVE 0 TO W-INV W-SKP
016440         GO TO ACP-140.
016450*****DISPLAY A-BC2 D-BCN21 D-BCN22.                               D.020620
016460*****DISPLAY A-BC2 D-BCN22.                                       D.030514
016470     DISPLAY A-BC22 D-BCN22.                                      I.030514
016480     IF W-SKP NOT = 0
016490         GO TO ACP-214.                                           I.090121
016500*****    GO TO ACP-181.                                           D.090121
016510 ACP-180.
016520     MOVE W-BC4 TO W-BBC4.                                        I.090121
016530     ACCEPT A-BC4.                                                I.090121
016540     DISPLAY A-BC4.                                               I.090121
016550*****MOVE W-BC3 TO W-BBC3.                                        D.090121
016560*****ACCEPT A-BC3.                                                D.090121
016570*****DISPLAY A-BC3.                                               D.090121
016580     DISPLAY E-CL.
016590     IF ESTAT = ADV
016600*****    MOVE W-BBC3 TO W-BC3                                     D.090121
016610*****    DISPLAY A-BC3                                            D.090121
016620         MOVE W-BBC4 TO W-BC4                                     I.090121
016630         DISPLAY A-BC4                                            I.090121
016640         MOVE 1 TO W-SKP.
016650     IF ESTAT = PF6
016660         MOVE 6 TO W-SKP.
016670     IF ESTAT = BTB
016680         GO TO ACP-140.
016690     IF ESTAT = HTB OR SKP
016700         MOVE 0 TO W-SKP.
016710     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV
016720         GO TO ACP-180.
016730     IF W-BC4 > 2                                                 I.090121
016740         GO TO ACP-180.                                           I.090121
016750*ACP-181.                                                         D.090121
016760*****MOVE SPACE TO HKB-KEY.                                       D.090121
016770*****MOVE "14" TO HKB-NO.                                         D.090121
016780*****MOVE W-BC3 TO HKB-BR3.                                       D.090121
016790*****PERFORM HKB-RTN THRU HKB-EX.                                 D.090121
016800*****IF W-INV NOT = 0                                             D.090121
016810*****    MOVE 0 TO W-INV W-SKP                                    D.090121
016820*****    GO TO ACP-180.                                           D.090121
016830*****DISPLAY A-BC3 D-BCN3.                                        D.090121
016840*****IF W-SKP = 6                                                 D.090121
016850*****    MOVE 0 TO W-SKP.                                         D.090121
016860*****IF W-SKP NOT = 0                                             D.090121
016870*****    GO TO ACP-214.                                           D.090121
016880*ACP-182.                                                         D.090121
016890*****MOVE W-BMC TO W-BBMC.                                        D.090121
016900*****ACCEPT A-BMC.                                                D.090121
016910*****DISPLAY E-CL.                                                D.090121
016920*****IF ESTAT = ADV                                               D.090121
016930*****    MOVE W-BBMC TO W-BMC                                     D.090121
016940*****    DISPLAY A-BMC                                            D.090121
016950*****    MOVE 1 TO W-SKP.                                         D.090121
016960*****IF ESTAT = PF6                                               D.090121
016970*****    MOVE 6 TO W-SKP.                                         D.090121
016980*****IF ESTAT = BTB                                               D.090121
016990*****    GO TO ACP-180.                                           D.090121
017000*****IF ESTAT = HTB AND SKP                                       D.090121
017010*****    MOVE 0 TO W-SKP.                                         D.090121
017020*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
017030*****    GO TO ACP-182.                                           D.090121
017040*ACP-183.                                                         D.090121
017050*****IF W-BMC NOT = 22 AND 23 AND 24 AND 26 AND 29                D.090121
017060*****    GO TO ACP-182.                                           D.090121
017070*****IF W-BMC = 22                                                D.090121
017080*****    MOVE 1 TO W-BMNO                                         D.090121
017090*****    MOVE NC"国内成型" TO W-BMCN.                             D.090121
017100*****IF W-BMC = 23                                                D.090121
017110*****    MOVE 4 TO W-BMNO                                         D.090121
017120*****    MOVE NC"ワーク　" TO W-BMCN.                             D.090121
017130*****IF W-BMC = 24                                                D.090121
017140*****    MOVE 5 TO W-BMNO                                         D.090121
017150*****    MOVE NC"教　育　" TO W-BMCN.                             D.090121
017160*****IF W-BMC = 26                                                D.090121
017170*****    MOVE 2 TO W-BMNO                                         D.090121
017180*****    MOVE NC"上海成型" TO W-BMCN.                             D.090121
017190*****IF W-BMC = 29                                                D.090121
017200*****    MOVE 3 TO W-BMNO                                         D.090121
017210*****    MOVE NC"仕　入　" TO W-BMCN.                             D.090121
017220 ACP-214.                                                         I.030822
017230     MOVE SPACE TO W-BCN4.                                        I.090121
017240     IF W-BC3 = 20                                                I.090121
017250         IF W-BC4 = 0                                             I.090121
017260             MOVE NC"ワーク" TO W-BCN4                            I.090121
017270           ELSE                                                   I.090121
017280             IF W-BC4 = 1                                         I.090121
017290                 MOVE NC"厨　房" TO W-BCN4                        I.090121
017300               ELSE                                               I.090121
017310                 IF W-BC4 = 2                                     I.090121
017320                     MOVE NC"介　護" TO W-BCN4.                   I.090121
017330     DISPLAY D-BCN4.                                              I.090121
017340*****DISPLAY D-BM.                                                D.090121
017350     IF W-SKP = 6                                                 I.030822
017360         MOVE 0 TO W-SKP.                                         I.030822
017370*
017380     IF W-HCD1 = 9999
017390*****    MOVE ZERO TO W-ZRG W-SKG W-GKG W-KNG W-FT                D.090121
017400*****    DISPLAY D-ZRG D-SKG D-GKG D-KNG D-FT                     D.090121
017410         MOVE ZERO TO W-FT                                        I.090121
017420         DISPLAY D-FT                                             I.090121
017430         GO TO ACP-400.
017440*****IF W-BC22 NOT = 1                                            D.090121
017450*****    MOVE ZERO TO W-ZRG W-SKG W-GKG W-KNG                     D.090121
017460*****    DISPLAY D-ZRG D-SKG D-GKG D-KNG                          D.090121
017470*****    GO TO ACP-228.                                           D.090121
017480     IF W-SKP NOT = 0
017490         GO TO ACP-375.                                           I.090121
017500*****    GO TO ACP-222.                                           D.090121
017510*ACP-221.                                                         D.090121
017520*****MOVE W-ZRG TO W-BZRG.                                        D.090121
017530*****ACCEPT A-ZRG.                                                D.090121
017540*****DISPLAY D-ZRG.                                               D.090121
017550*****DISPLAY E-CL.                                                D.090121
017560*****IF ESTAT = PF5                                               D.090121
017570*****    GO TO ACP-100.                                           D.090121
017580*****IF ESTAT = ADV                                               D.090121
017590*****    MOVE W-BZRG TO W-ZRG                                     D.090121
017600*****    DISPLAY D-ZRG                                            D.090121
017610*****    MOVE 1 TO W-SKP.                                         D.090121
017620*****IF ESTAT = PF6                                               D.090121
017630*****    MOVE 6 TO W-SKP.                                         D.090121
017640*****IF ESTAT = BTB                                               D.090121
017650*****    GO TO ACP-182.                                           D.090121
017660*****    GO TO ACP-180.                                           D.030822
017670*****IF ESTAT = HTB OR SKP                                        D.090121
017680*****    MOVE 0 TO W-SKP.                                         D.090121
017690*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
017700*****    GO TO ACP-221.                                           D.090121
017710*ACP-222.                                                         D.090121
017720*****DISPLAY D-ZRG.                                               D.090121
017730*****IF W-SKP NOT = 0                                             D.090121
017740*****    GO TO ACP-224.                                           D.090121
017750*ACP-223.                                                         D.090121
017760*****MOVE W-SKG TO W-BSKG.                                        D.090121
017770*****ACCEPT A-SKG.                                                D.090121
017780*****DISPLAY D-SKG.                                               D.090121
017790*****DISPLAY E-CL.                                                D.090121
017800*****IF ESTAT = PF5                                               D.090121
017810*****    GO TO ACP-100.                                           D.090121
017820*****IF ESTAT = ADV                                               D.090121
017830*****    MOVE W-BSKG TO W-SKG                                     D.090121
017840*****    DISPLAY D-SKG                                            D.090121
017850*****    MOVE 1 TO W-SKP.                                         D.090121
017860*****IF ESTAT = PF6                                               D.090121
017870*****    MOVE 6 TO W-SKP.                                         D.090121
017880*****IF ESTAT = BTB                                               D.090121
017890*****    GO TO ACP-221.                                           D.090121
017900*****IF ESTAT = HTB OR SKP                                        D.090121
017910*****    MOVE 0 TO W-SKP.                                         D.090121
017920*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
017930*****    GO TO ACP-223.                                           D.090121
017940*ACP-224.                                                         D.090121
017950*****DISPLAY D-SKG.                                               D.090121
017960*****IF W-SKP NOT = 0                                             D.090121
017970*****    GO TO ACP-226.                                           D.090121
017980*ACP-225.                                                         D.090121
017990*****MOVE W-GKG TO W-BGKG.                                        D.090121
018000*****ACCEPT A-GKG.                                                D.090121
018010*****DISPLAY D-GKG.                                               D.090121
018020*****DISPLAY E-CL.                                                D.090121
018030*****IF ESTAT = PF5                                               D.090121
018040*****    GO TO ACP-100.                                           D.090121
018050*****IF ESTAT = ADV                                               D.090121
018060*****    MOVE W-BGKG TO W-GKG                                     D.090121
018070*****    DISPLAY D-GKG                                            D.090121
018080*****    MOVE 1 TO W-SKP.                                         D.090121
018090*****IF ESTAT = PF6                                               D.090121
018100*****    MOVE 6 TO W-SKP.                                         D.090121
018110*****IF ESTAT = BTB                                               D.090121
018120*****    GO TO ACP-223.                                           D.090121
018130*****IF ESTAT = HTB OR SKP                                        D.090121
018140*****    MOVE 0 TO W-SKP.                                         D.090121
018150*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
018160*****    GO TO ACP-225.                                           D.090121
018170*ACP-226.                                                         D.090121
018180*****DISPLAY D-GKG.                                               D.090121
018190*****IF W-SKP NOT = 0                                             D.090121
018200*****    GO TO ACP-228.                                           D.090121
018210*ACP-227.                                                         D.090121
018220*****MOVE W-KNG TO W-BKNG.                                        D.090121
018230*****ACCEPT A-KNG.                                                D.090121
018240*****DISPLAY D-KNG.                                               D.090121
018250*****DISPLAY E-CL.                                                D.090121
018260*****IF ESTAT = PF5                                               D.090121
018270*****    GO TO ACP-100.                                           D.090121
018280*****IF ESTAT = ADV                                               D.090121
018290*****    MOVE W-BKNG TO W-KNG                                     D.090121
018300*****    DISPLAY D-KNG                                            D.090121
018310*****    MOVE 1 TO W-SKP.                                         D.090121
018320*****IF ESTAT = PF6                                               D.090121
018330*****    MOVE 6 TO W-SKP.                                         D.090121
018340*****IF ESTAT = BTB                                               D.090121
018350*****    GO TO ACP-225.                                           D.090121
018360*****IF ESTAT = HTB OR SKP                                        D.090121
018370*****    MOVE 0 TO W-SKP.                                         D.090121
018380*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
018390*****    GO TO ACP-227.                                           D.090121
018400*ACP-228.                                                         D.090121
018410*****DISPLAY D-KNG.                                               D.090121
018420*****IF W-SKP NOT = 0                                             D.090121
018430*****    GO TO ACP-400.                                           D.090121
018440*****IF ZERO = W-ZRG AND W-SKG AND W-GKG AND W-KNG                D.090121
018450*****    GO TO ACP-380.                                           D.090121
018460******OVE SPACE TO HKB-KEY.                                       D.090121
018470*****MOVE 19 TO HKB-NO.                                           D.090121
018480*****READ HKBM WITH UNLOCK INVALID KEY                            D.090121
018490*****    MOVE 0 TO W-INV                                          D.090121
018500*****    MOVE ZERO TO HKB-CKR.                                    D.090121
018510*****COMPUTE W-FTW1 ROUNDED = W-SKG * HKB-CKR.                    D.090121
018520*****COMPUTE W-FTW2 = W-FTW1 + 0.99.                              D.090121
018530*****COMPUTE W-FT = W-ZRG + W-SKG + W-GKG + W-KNG + W-FTW2.       D.090121
018540*****IF W-ACT = 2                                                 D.090121
018550*****    IF (W-ZRG = W-ZRGD) AND (W-SKG = W-SKGD) AND             D.090121
018560*****       (W-GKG = W-GKGD) AND (W-KNG = W-KNGD)                 D.090121
018570*****        MOVE W-FTD TO W-FT.                                  D.090121
018580*****DISPLAY D-FT.                                                D.090121
018590 ACP-370.                                                         I.090121
018600     MOVE W-YG TO W-BYG.                                          I.090121
018610     ACCEPT A-YG.                                                 I.090121
018620     DISPLAY D-YG.                                                I.090121
018630     DISPLAY E-CL.                                                I.090121
018640     IF ESTAT = PF5                                               I.090121
018650         GO TO ACP-100.                                           I.090121
018660     IF ESTAT = ADV                                               I.090121
018670         MOVE W-BYG TO W-YG                                       I.090121
018680         DISPLAY D-YG                                             I.090121
018690         MOVE 1 TO W-SKP.                                         I.090121
018700     IF ESTAT = PF6                                               I.090121
018710         MOVE 6 TO W-SKP.                                         I.090121
018720     IF ESTAT = BTB                                               I.090121
018730         IF W-BC3 = 20                                            I.090121
018740             GO TO ACP-180                                        I.090120
018750           ELSE                                                   I.090121
018760             GO TO ACP-140.                                       I.090121
018770     IF ESTAT = HTB OR SKP                                        I.090121
018780         MOVE 0 TO W-SKP.                                         I.090121
018790     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.090121
018800         GO TO ACP-370.                                           I.090121
018810 ACP-375.                                                         I.090121
018820     DISPLAY D-YG.                                                I.090121
018830     IF W-SKP NOT = 0                                             I.090121
018840         GO TO ACP-400.                                           I.090121
018850 ACP-380.
018860     MOVE W-FT TO W-BFT.
018870     ACCEPT A-FT.
018880     DISPLAY D-FT.
018890     DISPLAY E-CL.
018900     IF ESTAT = PF5
018910         GO TO ACP-100.
018920     IF ESTAT = ADV
018930         MOVE W-BFT TO W-FT
018940         DISPLAY D-FT
018950         MOVE 1 TO W-SKP.
018960     IF ESTAT = PF6
018970         MOVE 6 TO W-SKP.
018980     IF ESTAT = BTB
018990         GO TO ACP-370.                                           I.090121
019000*****    IF W-BC22 = 1                                            D.090121
019010*****        GO TO ACP-227                                        D.090121
019020*****      ELSE                                                   D.090121
019030*****        GO TO ACP-182.                                       D.090121
019040*****        GO TO ACP-180.                                       D.030822
019050     IF ESTAT = HTB OR SKP
019060         MOVE 0 TO W-SKP.
019070     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
019080         GO TO ACP-380.
019090 ACP-400.
019100     DISPLAY D-FT.
019110     IF W-ACT = 2                                                 I.100602
019120         GO TO ACP-410.                                           I.100602
019130     IF W-HCD1 NOT = 9999
019140         IF W-FT = ZERO
019150             MOVE SPACE TO W-MSG                                  I.110531
019160             MOVE "廃棄品以外はＮＧ" TO W-MSG                     I.110531
019170             DISPLAY E-ME E-ME99.                                 I.110531
019180*****        GO TO ACP-380.                                       D.110531
019190     IF W-ACT NOT = 2                                             I.020221
019200         GO TO ACP-410.                                           I.020221
019210     IF W-FT = W-FTD                                              I.020221
019220         GO TO ACP-410.                                           I.020221
019230     IF ZERO = HUH-ZS AND HUH-ZK AND HUH-NS AND HUH-NK AND        I.020221
019240               HUH-SS AND HUH-UG AND HUH-YS AND HUH-YK            I.020221
019250         GO TO ACP-410.                                           I.020221
019260     IF ZERO = HUH-NS AND HUH-NK AND                              I.100609
019270               HUH-SS AND HUH-UG                                  I.100609
019280         MOVE SPACE TO W-MSG                                      I.100609
019290         MOVE "***  ｻﾞｲｺ ｱﾘ  ***" TO W-MSG                        I.100609
019300         DISPLAY E-ME E-ME98                                      I.100609
019310         GO TO ACP-410.                                           I.100609
019320     MOVE SPACE TO W-MSG.                                         I.020221
019330     MOVE "***  ﾄｳｹﾞﾂ ﾃﾞｰﾀ ｱﾘ  ***" TO W-MSG.                     I.020221
019340     DISPLAY E-ME E-ME99.                                         I.020221
019350     GO TO ACP-380.                                               I.020221
019360 ACP-410.                                                         I.020221
019370     IF W-SKP NOT = 0
019380         GO TO ACP-440.
019390 ACP-420.
019400     MOVE W-SB TO W-BSB.
019410     ACCEPT A-SB.
019420     DISPLAY D-SB.
019430     DISPLAY E-CL.
019440     IF ESTAT = ADV
019450         MOVE W-BSB TO W-SB
019460         DISPLAY D-SB
019470         MOVE 1 TO W-SKP.
019480     IF ESTAT = PF6
019490         MOVE 6 TO W-SKP.
019500     IF ESTAT = BTB
019510         GO TO ACP-380.
019520     IF ESTAT = HTB OR SKP
019530         MOVE 0 TO W-SKP.
019540     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
019550         GO TO ACP-420.
019560 ACP-440.
019570     DISPLAY D-SB.
019580     IF W-SKP NOT = 0
019590         GO TO ACP-480.                                           I.090121
019600*****    GO TO ACP-442.                                           D.090121
019610*****    GO TO ACP-480.                                           D.030822
019620*ACP-441.                                                         D.090121
019630*****MOVE W-YG TO W-BYG.                                          D.090121
019640*****ACCEPT A-YG.                                                 D.090121
019650*****DISPLAY D-YG.                                                D.090121
019660*****DISPLAY E-CL.                                                D.090121
019670*****IF ESTAT = ADV                                               D.090121
019680*****    MOVE W-BYG TO W-YG                                       D.090121
019690*****    DISPLAY D-YG                                             D.090121
019700*****    MOVE 1 TO W-SKP.                                         D.090121
019710*****IF ESTAT = PF6                                               D.090121
019720*****    MOVE 6 TO W-SKP.                                         D.090121
019730*****IF ESTAT = BTB                                               D.090121
019740*****    GO TO ACP-420.                                           D.090121
019750*****IF ESTAT = HTB OR SKP                                        D.090121
019760*****    MOVE 0 TO W-SKP.                                         D.090121
019770*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.090121
019780*****    GO TO ACP-441.                                           D.090121
019790*ACP-442.                                                         D.090121
019800*****DISPLAY D-YG.                                                D.090121
019810*****IF W-SKP NOT = 0                                             D.090121
019820*****    GO TO ACP-480.                                           D.090121
019830 ACP-460.
019840     MOVE W-ISU TO W-BISU.
019850     ACCEPT A-ISU.
019860     DISPLAY D-ISU.
019870     DISPLAY E-CL.
019880     IF ESTAT = ADV
019890         MOVE W-BISU TO W-ISU
019900         DISPLAY A-ISU
019910         MOVE 1 TO W-SKP.
019920     IF ESTAT = PF6
019930         MOVE 6 TO W-SKP.
019940     IF ESTAT = BTB
019950         GO TO ACP-420.                                           I.090121
019960*****    GO TO ACP-441.                                           D.090121
019970*****    GO TO ACP-420.                                           D.030822
019980     IF ESTAT = HTB OR SKP
019990         MOVE 0 TO W-SKP.
020000     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
020010         GO TO ACP-460.
020020 ACP-480.
020030     DISPLAY D-ISU.
020040     IF W-SKP NOT = 0                                             I.011030
020050         GO TO ACP-495.                                           I.130605
020060*****    GO TO ACP-520.                                           D.130605
020070*****IF (W-BC22 NOT = 1) OR (W-HCD1 = 9999)                       D.130605
020080*****    MOVE 0 TO W-KRC                                          D.130605
020090*****    MOVE SPACE TO W-KRCN                                     D.130605
020100*****    GO TO ACP-520.                                           D.130605
020110 ACP-490.                                                         I.130605
020120     MOVE W-YG2 TO W-BYG2.                                        I.130605
020130     ACCEPT A-YG2.                                                I.130605
020140     DISPLAY D-YG2.                                               I.130605
020150     DISPLAY E-CL.                                                I.130605
020160     IF ESTAT = ADV                                               I.130605
020170         MOVE W-BYG2 TO W-YG2                                     I.130605
020180         DISPLAY D-YG2                                            I.130605
020190         MOVE 1 TO W-SKP.                                         I.130605
020200     IF ESTAT = PF6                                               I.130605
020210         MOVE 6 TO W-SKP.                                         I.130605
020220     IF ESTAT = BTB                                               I.130605
020230         GO TO ACP-460.                                           I.130605
020240     IF ESTAT = HTB OR SKP                                        I.130605
020250         MOVE 0 TO W-SKP.                                         I.130605
020260     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.130605
020270         GO TO ACP-490.                                           I.130605
020280 ACP-495.                                                         I.130605
020290     DISPLAY D-YG2.                                               I.130605
020300     IF W-SKP NOT = 0                                             I.130605
020310         GO TO ACP-520.                                           I.130605
020320     IF (W-BC22 NOT = 1) OR (W-HCD1 = 9999)                       I.130605
020330         MOVE 0 TO W-KRC                                          I.130605
020340         MOVE SPACE TO W-KRCN                                     I.130605
020350         GO TO ACP-520.                                           I.130605
020360 ACP-500.                                                         I.011030
020370     MOVE W-KRC TO W-BKRC.                                        I.011030
020380     ACCEPT A-KRC.                                                I.011030
020390     DISPLAY E-CL.                                                I.011030
020400     IF ESTAT = ADV                                               I.011030
020410         MOVE W-BKRC TO W-KRC                                     I.011030
020420         DISPLAY A-KRC                                            I.011030
020430         MOVE 1 TO W-SKP.                                         I.011030
020440     IF ESTAT = PF6                                               I.011030
020450         MOVE 6 TO W-SKP.                                         I.011030
020460     IF ESTAT = BTB                                               I.011030
020470         GO TO ACP-490.                                           I.130605
020480*****    GO TO ACP-460.                                           D.130605
020490     IF ESTAT = HTB OR SKP                                        I.011030
020500         MOVE 0 TO W-SKP.                                         I.011030
020510     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.011030
020520         GO TO ACP-500.                                           I.011030
020530 ACP-520.                                                         I.011030
020540     IF W-KRC > 2                                                 I.011030
020550         GO TO ACP-500.                                           I.011030
020560     IF W-KRC = 1                                                 I.011030
020570         MOVE NC"加" TO W-KRCN                                    I.011030
020580       ELSE                                                       I.011030
020590         IF W-KRC = 2                                             I.011030
020600             MOVE NC"非" TO W-KRCN                                I.011030
020610           ELSE                                                   I.011030
020620             MOVE SPACE TO W-KRCN.                                I.011030
020630     DISPLAY D-KR.                                                I.011030
020640*
020650     IF W-SKP NOT = 0                                             I.011120
020660         GO TO ACP-540.                                           I.011120
020670*****IF (W-BC22 NOT = 1) OR (W-HCD1 = 9999)                       D.080521
020680*****    MOVE 0 TO W-SCC                                          D.080521
020690*****    MOVE SPACE TO W-SCCN                                     D.080521
020700*****    GO TO ACP-540.                                           D.080521
020710*****    GO TO ACP-542.                                           D.030822
020720*****    GO TO ACP-541.                                           D.020314
020730 ACP-530.                                                         I.011120
020740     MOVE W-SCC TO W-BSCC.                                        I.011120
020750     ACCEPT A-SCC.                                                I.011120
020760     DISPLAY E-CL.                                                I.011120
020770     IF ESTAT = ADV                                               I.011120
020780         MOVE W-BSCC TO W-SCC                                     I.011120
020790         DISPLAY A-SCC                                            I.011120
020800         MOVE 1 TO W-SKP.                                         I.011120
020810     IF ESTAT = PF6                                               I.011120
020820         MOVE 6 TO W-SKP.                                         I.011120
020830     IF ESTAT = BTB                                               I.011120
020840         GO TO ACP-500.                                           I.011120
020850     IF ESTAT = HTB OR SKP                                        I.011120
020860         MOVE 0 TO W-SKP.                                         I.011120
020870     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.011120
020880         GO TO ACP-530.                                           I.011120
020890 ACP-540.                                                         I.011120
020900*****IF W-SCC > 3                                                 D.080521
020910     IF W-SCC > 2                                                 I.080521
020920         GO TO ACP-530.                                           I.011120
020930     IF W-SCC = 0                                                 I.011120
020940         MOVE NC"　　" TO W-SCCN                                  I.011120
020950       ELSE                                                       I.011120
020960         IF W-SCC = 1                                             I.011120
020970             MOVE NC"廃番" TO W-SCCN                              I.080521
020980*****        MOVE NC"上縫" TO W-SCCN                              D.080521
020990           ELSE                                                   I.011120
021000             MOVE NC"不良" TO W-SCCN.                             I.080521
021010*****        IF W-SCC = 2                                         D.080521
021020*****            MOVE NC"上成" TO W-SCCN                          D.080521
021030*****          ELSE                                               D.080521
021040*****            MOVE NC"上未" TO W-SCCN.                         D.080521
021050*ACP-541.                                                         D.040311
021060     DISPLAY D-SC.                                                I.011120
021070*****IF W-SKP NOT = ZERO                                          D.030822
021080*****    GO TO ACP-544.                                           D.030822
021090*ACP-542.                                                         D.030822
021100*****MOVE W-BMC TO W-BBMC.                                        D.030822
021110*****ACCEPT A-BMC.                                                D.030822
021120*****DISPLAY E-CL.                                                D.030822
021130*****IF ESTAT = ADV                                               D.030822
021140*****    MOVE W-BBMC TO W-BMC                                     D.030822
021150*****    DISPLAY A-BMC                                            D.030822
021160*****    MOVE 1 TO W-SKP.                                         D.030822
021170*****IF ESTAT = PF6                                               D.030822
021180*****    MOVE 6 TO W-SKP.                                         D.030822
021190*****IF ESTAT = BTB                                               D.030822
021200*****    IF (W-BC22 = 1) AND (W-HCD1 NOT = 9999)                  D.030822
021210*****        GO TO ACP-530                                        D.030822
021220*****      ELSE                                                   D.030822
021230*****        GO TO ACP-460.                                       D.030822
021240*****IF ESTAT = HTB AND SKP                                       D.030822
021250*****    MOVE 0 TO W-SKP.                                         D.030822
021260*****IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   D.030822
021270*****    GO TO ACP-542.                                           D.030822
021280*ACP-543.                                                         D.030822
021290*****IF W-BMC NOT = 22 AND 23 AND 24 AND 26                       D.030423
021300*****IF W-BMC NOT = 22 AND 23 AND 24 AND 26 AND 29                D.030822
021310*****    GO TO ACP-542.                                           D.030822
021320*****IF W-BMC = 22                                                D.030822
021330*****    MOVE 1 TO W-BMNO                                         D.030822
021340*****    MOVE NC"国内成型" TO W-BMCN.                             D.030822
021350*****IF W-BMC = 23                                                D.030822
021360*****    MOVE 3 TO W-BMNO                                         D.030423
021370*****    MOVE 4 TO W-BMNO                                         D.030822
021380*****    MOVE NC"ワーク　" TO W-BMCN.                             D.030822
021390*****IF W-BMC = 24                                                D.030822
021400*****    MOVE 4 TO W-BMNO                                         D.030423
021410*****    MOVE 5 TO W-BMNO                                         D.030822
021420*****    MOVE NC"教　育　" TO W-BMCN.                             D.030822
021430*****IF W-BMC = 26                                                D.030822
021440*****    MOVE 2 TO W-BMNO                                         D.030822
021450*****    MOVE NC"上海成型" TO W-BMCN.                             D.030822
021460*****IF W-BMC = 29                                                D.030822
021470*****    MOVE 3 TO W-BMNO                                         D.030822
021480*****    MOVE NC"仕　入　" TO W-BMCN.                             D.030822
021490*ACP-544.                                                         D.030822
021500*****DISPLAY D-BM.                                                D.030822
021510     IF W-SKP NOT = 0                                             I.040311
021520         GO TO ACP-555.                                           I.100601
021530*****    GO TO ACP-575.                                           D.100601
021540 ACP-550.                                                         I.100601
021550     MOVE W-SSC TO W-BSSC.                                        I.100601
021560     ACCEPT A-SSC.                                                I.100601
021570     DISPLAY E-CL.                                                I.100601
021580     IF ESTAT = ADV                                               I.100601
021590         MOVE W-BSSC TO W-SSC                                     I.100601
021600         DISPLAY A-SSC                                            I.100601
021610         MOVE 1 TO W-SKP.                                         I.100601
021620     IF ESTAT = PF6                                               I.100601
021630         MOVE 6 TO W-SKP.                                         I.100601
021640     IF ESTAT = BTB                                               I.100601
021650         GO TO ACP-530.                                           I.100601
021660     IF ESTAT = HTB OR SKP                                        I.100601
021670         MOVE 0 TO W-SKP.                                         I.100601
021680     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.100601
021690         GO TO ACP-550.                                           I.100601
021700 ACP-555.                                                         I.100601
021710     IF W-SSC > 3                                                 I.100601
021720         GO TO ACP-550.                                           I.100601
021730     IF W-SSC = 0                                                 I.100601
021740         MOVE "ｾﾝﾁ" TO W-SSCN                                     I.100601
021750       ELSE                                                       I.100601
021760         IF W-SSC = 1                                             I.100601
021770             MOVE "SML" TO W-SSCN                                 I.100601
021780           ELSE                                                   I.100601
021790             IF W-SSC = 2                                         I.100601
021800                 MOVE "ﾀﾞｲ" TO W-SSCN                             I.100601
021810               ELSE                                               I.100601
021820                 IF W-SSC = 3                                     I.100601
021830                     MOVE "ﾅｼ " TO W-SSCN.                        I.100601
021840     DISPLAY D-SSCM.                                              I.100601
021850*****IF (W-BC3 NOT = 30) OR (W-HCD1 = 9999)                       D.050325
021860*****IF (W-BC3 = 20) OR (W-HCD1 = 9999)                           D.100601
021870     IF (W-BC3 = 20) OR (W-HCD1 = 9999) OR (W-SSC > 0)            I.100601
021880         MOVE 0 TO W-HKB                                          I.040311
021890         GO TO ACP-575.                                           I.040311
021900 ACP-570.                                                         I.040311
021910     MOVE W-HKB TO W-BHKB.                                        I.040311
021920     ACCEPT A-HKB.                                                I.040311
021930     DISPLAY E-CL.                                                I.040311
021940     IF ESTAT = ADV                                               I.040311
021950         MOVE W-BHKB TO W-HKB                                     I.040311
021960         DISPLAY A-HKB                                            I.040311
021970         MOVE 1 TO W-SKP.                                         I.040311
021980     IF ESTAT = PF6                                               I.040311
021990         MOVE 6 TO W-SKP.                                         I.040311
022000     IF ESTAT = BTB                                               I.040311
022010         GO TO ACP-550.                                           I.100601
022020*****    IF W-BC22 NOT = 1                                        D.080521
022030*****        GO TO ACP-460                                        D.080521
022040*****        GO TO ACP-480                                        D.051102
022050*****      ELSE                                                   D.080521
022060*****        GO TO ACP-530.                                       D.100601
022070     IF ESTAT = HTB OR SKP                                        I.040311
022080         MOVE 0 TO W-SKP.                                         I.040311
022090     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.040311
022100         GO TO ACP-570.                                           I.040311
022110 ACP-575.                                                         I.040311
022120     IF W-HKB > 1                                                 I.040311
022130         GO TO ACP-570.                                           I.040311
022140     IF W-HKB = 0                                                 I.040311
022150         MOVE SPACE TO W-HKBN                                     I.040311
022160       ELSE                                                       I.040311
022170         MOVE "ﾊｰﾌ" TO W-HKBN.                                    I.040311
022180     DISPLAY D-HK.                                                I.040311
022190 ACP-580.                                                         I.050416
022200     MOVE W-HPV TO W-BHPV.                                        I.050416
022210     ACCEPT A-HPV.                                                I.050416
022220     DISPLAY E-CL.                                                I.050416
022230     IF ESTAT = ADV                                               I.050416
022240         MOVE W-BHPV TO W-HPV                                     I.050416
022250         DISPLAY A-HPV                                            I.050416
022260         MOVE 1 TO W-SKP.                                         I.050416
022270     IF ESTAT = PF6                                               I.050416
022280         MOVE 6 TO W-SKP.                                         I.050416
022290     IF ESTAT = BTB                                               I.050416
022300*****    IF (W-BC3 NOT = 20) AND (W-HCD1 NOT = 9999)              D.100601
022310         IF (W-BC3 NOT = 20) AND (W-HCD1 NOT = 9999) AND          I.100601
022320                                 (W-SSC      = 0)                 I.100601
022330             GO TO ACP-570                                        I.050416
022340           ELSE                                                   I.050416
022350             GO TO ACP-550.                                       I.100601
022360*****        GO TO ACP-530.                                       D.100601
022370*****        IF (W-BC22 = 1) AND (W-HCD1 NOT = 9999)              D.080521
022380*****            GO TO ACP-530                                    D.080521
022390*****          ELSE                                               D.080521
022400*****            GO TO ACP-460.                                   D.080521
022410     IF ESTAT = HTB OR SKP                                        I.050416
022420         MOVE 0 TO W-SKP.                                         I.050416
022430     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV                   I.050416
022440         GO TO ACP-580.                                           I.050416
022450 ACP-585.                                                         I.050416
022460     IF W-HPV > 1                                                 I.050416
022470         GO TO ACP-570.                                           I.050416
022480     IF W-SKP = 6
022490         MOVE 0 TO W-SKP.
022500 ACP-600.
022510     MOVE ZERO TO CNT.
022520     MOVE 16 TO W-L.                                              I.090121
022530     MOVE 7 TO W-C.                                               I.090121
022540*****MOVE 15 TO W-L.                                              D.090121
022550*****MOVE 4 TO W-C.                                               D.090121
022560 ACP-620.
022570     ADD 1 TO CNT.
022580     IF CNT = 41
022590         GO TO ACP-700.
022600     IF CNT = 11 OR 21 OR 31
022610         ADD 1 TO W-L
022620*****    MOVE 4 TO W-C                                            D.090121
022630         MOVE 7 TO W-C                                            I.090121
022640         IF W-SKP = 7
022650             MOVE 0 TO W-SKP.
022660     ADD 5 TO W-C.
022670     IF CNT = 30 OR 39
022680         MOVE 0 TO W-S(CNT)
022690*****    DISPLAY D-S                                              D.090121
022700         GO TO ACP-620.
022710     IF W-SKP NOT = 0
022720         GO TO ACP-660.
022730 ACP-640.
022740     MOVE W-S(CNT) TO W-BS(CNT).
022750     ACCEPT A-S.
022760     DISPLAY D-S.
022770     DISPLAY E-CL.
022780     IF ESTAT = ADV
022790         MOVE W-BS(CNT) TO W-S(CNT)
022800         DISPLAY D-S
022810         MOVE 1 TO W-SKP.
022820     IF ESTAT = PF5
022830         GO TO ACP-082.                                           I.090121
022840*****    GO TO ACP-181.                                           D.090121
022850     IF ESTAT = PF4
022860         MOVE 4 TO W-SKP
022870         GO TO ACP-680.
022880     IF ESTAT = PF6
022890         MOVE 6 TO W-SKP.
022900     IF ESTAT = PF7
022910         MOVE 7 TO W-SKP.
022920     IF ESTAT = BTB
022930         GO TO ACP-680.
022940     IF ESTAT = HTB OR SKP
022950         MOVE 0 TO W-SKP.
022960     IF ESTAT NOT = HTB AND SKP AND PF6 AND PF7 AND ADV
022970         GO TO ACP-640.
022980 ACP-660.
022990*****IF W-S(CNT) > 5                                              D.040219
023000*****    MOVE 0 TO W-SKP                                          D.040219
023010*****    GO TO ACP-640.                                           D.040219
023020     IF CNT = 40
023030         IF W-S(CNT) > 1
023040             MOVE 0 TO W-SKP
023050             GO TO ACP-640.
023060     DISPLAY D-S.
023070     IF CNT = 31
023080         IF W-S(31) NOT = 0
023090             IF W-S(27) NOT = 0
023100                 GO TO ACP-640.
023110     IF CNT = 32
023120         IF W-S(32) NOT = 0
023130             IF W-S(28) NOT = 0
023140                 GO TO ACP-640.
023150     IF CNT = 33
023160         IF W-S(33) NOT = 0
023170             IF W-S(29) NOT = 0
023180                 GO TO ACP-640.
023190     IF W-ACT = 2
023200         IF W-S(CNT) = 0
023210             IF W-OS(CNT) NOT = ZERO
023220                 PERFORM CHK-RTN THRU CHK-RTN.
023230     IF W-ACP = 9
023240         MOVE 0 TO W-SKP
023250         GO TO ACP-640.
023260     GO TO ACP-620.
023270 ACP-680.
023280     SUBTRACT 1 FROM CNT.
023290     IF CNT = ZERO
023300         GO TO ACP-580.                                           I.050416
023310*****    IF (W-BC3 = 30) AND (W-HCD1 NOT = 9999)                  D.050325
023320*****    IF (W-BC3 NOT = 20) AND (W-HCD1 NOT = 9999)              D.050416
023330*****        GO TO ACP-570                                        D.050416
023340*****      ELSE                                                   D.050416
023350*****        IF (W-BC22 = 1) AND (W-HCD1 NOT = 9999)              D.050416
023360*****            GO TO ACP-530                                    D.050416
023370*****          ELSE                                               D.050416
023380*****            GO TO ACP-460.                                   D.050416
023390*****    GO TO ACP-542.                                           D.030822
023400*****    IF (W-BC22 = 1) AND (W-HCD1 NOT = 9999)                  D.020314
023410*****        GO TO ACP-530                                        D.020314
023420*****        GO TO ACP-500                                        D.011120
023430*****      ELSE                                                   D.020314
023440*****        GO TO ACP-460.                                       D.020314
023450     IF CNT = 10 OR 20 OR 30 OR 40
023460         SUBTRACT 1 FROM W-L
023470         MOVE 62 TO W-C                                           I.090121
023480*****    MOVE 59 TO W-C                                           D.090121
023490         IF W-SKP = 4
023500             MOVE 0 TO W-SKP.
023510     SUBTRACT 5 FROM W-C.
023520     IF CNT = 30 OR 39
023530         GO TO ACP-680.
023540     IF W-SKP = 4
023550         GO TO ACP-680.
023560     GO TO ACP-640.
023570 ACP-700.
023580     IF W-SSD = ZERO
023590         MOVE SPACE TO W-MSG
023600         MOVE "***  ｻｲｽﾞ ｶﾞ ﾊｲｯﾃﾅｲ  ***" TO W-MSG
023610         DISPLAY E-ME E-ME98
023620         MOVE 0 TO W-SKP
023630         GO TO ACP-600.
023640     IF W-SSC NOT = 0                                             I.100601
023650         IF (W-SK(2) NOT = ZERO) OR (W-SK(3) NOT = ZERO) OR       I.100601
023660            (W-S(31) NOT = 0) OR (W-S(32) NOT = 0) OR             I.100601
023670            (W-S(33) NOT = 0) OR (W-S(34) NOT = 0) OR             I.100601
023680            (W-S(35) NOT = 0) OR (W-S(36) NOT = 0) OR             I.100601
023690            (W-S(37) NOT = 0) OR (W-S(38) NOT = 0) OR             I.100601
023700            (W-S(39) NOT = 0)                                     I.100601
023710             MOVE SPACE TO W-MSG                                  I.100601
023720             MOVE "***  ｻｲｽﾞ ｴﾗｰ  ***" TO W-MSG                   I.100601
023730             DISPLAY E-ME E-ME98                                  I.100601
023740             MOVE 0 TO W-SKP                                      I.100601
023750             GO TO ACP-600.                                       I.100601
023760     IF W-SSC = 0                                                 I.100601
023770         IF (W-S(01) NOT = 0) OR (W-S(02) NOT = 0) OR             I.100601
023780            (W-S(03) NOT = 0) OR (W-S(04) NOT = 0) OR             I.100601
023790            (W-S(05) NOT = 0) OR (W-S(06) NOT = 0) OR             I.100601
023800            (W-S(07) NOT = 0)                                     I.100601
023810             MOVE SPACE TO W-MSG                                  I.100601
023820             MOVE "***  ｻｲｽﾞ ｴﾗｰ  ***" TO W-MSG                   I.100601
023830             DISPLAY E-ME E-ME98                                  I.100601
023840             MOVE 0 TO W-SKP                                      I.100601
023850             GO TO ACP-600.                                       I.100601
023860     IF W-SKP = 6
023870         MOVE 0 TO W-SKP.
023880     IF W-SKP NOT = 0
023890         GO TO ACP-740.
023900 ACP-720.
023910     MOVE W-SNG TO W-BSNG.
023920     ACCEPT A-SNG.
023930     IF W-SNG = ZERO
023940         DISPLAY D-SNGC
023950       ELSE
023960         DISPLAY A-SNG.
023970     DISPLAY E-CL.
023980     IF ESTAT = PF5
023990         GO TO ACP-600.
024000     IF ESTAT = ADV
024010         MOVE W-BSNG TO W-SNG
024020         MOVE 1 TO W-SKP
024030         IF W-SNG = ZERO
024040             DISPLAY D-SNGC
024050           ELSE
024060             DISPLAY A-SNG.
024070     IF ESTAT = PF6
024080         MOVE 6 TO W-SKP.
024090     IF ESTAT = BTB
024100         MOVE 41 TO CNT
024110         MOVE 20 TO W-L                                           I.090121
024120*****    MOVE 19 TO W-L                                           D.090121
024130         GO TO ACP-680.
024140     IF ESTAT = HTB OR SKP
024150         MOVE 0 TO W-SKP.
024160     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
024170         GO TO ACP-720.
024180 ACP-740.
024190     IF W-SNG = ZERO
024200         DISPLAY D-SNGC
024210       ELSE
024220         DISPLAY A-SNG.
024230     IF W-SKP NOT = 0
024240         GO TO ACP-780.
024250 ACP-760.
024260     MOVE W-ENG TO W-BENG.
024270     ACCEPT A-ENG.
024280     IF W-ENG = ZERO
024290         DISPLAY D-ENGC
024300       ELSE
024310         DISPLAY A-ENG.
024320     DISPLAY E-CL.
024330     IF ESTAT = PF5
024340         GO TO ACP-600.
024350     IF ESTAT = ADV
024360         MOVE W-BENG TO W-ENG
024370         MOVE 1 TO W-SKP
024380         IF W-ENG = ZERO
024390             DISPLAY D-ENGC
024400           ELSE
024410             DISPLAY A-ENG.
024420     IF ESTAT = PF6
024430         MOVE 6 TO W-SKP.
024440     IF ESTAT = BTB
024450         GO TO ACP-720.
024460     IF ESTAT = HTB OR SKP
024470         MOVE 0 TO W-SKP.
024480     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
024490         GO TO ACP-760.
024500 ACP-780.
024510     IF W-ENG = ZERO
024520         DISPLAY D-ENGC
024530       ELSE
024540         DISPLAY A-ENG.
024550     IF W-SKP NOT = 0
024560         GO TO ACP-820.
024570*
024580     IF W-ACT NOT = 1
024590         GO TO ACP-800.
024600     IF W-TCD NOT = ZERO
024610         GO TO ACP-800.
024620*****IF W-BC1 = 33                                                D.060525
024630     IF W-BCD1 = 322                                              I.060525
024640         MOVE 5359 TO W-TCD.
024650     IF W-BC1 = 22 OR 23
024660         MOVE 0459 TO W-TCD.
024670     IF W-BC1 = 29
024680         MOVE 5349 TO W-TCD.
024690*****IF W-BC1 = 21                                                D.060525
024700*****    IF W-HCD > 749999 AND < 830000                           D.060525
024710*****        MOVE 1494 TO W-TCD.                                  D.060525
024720*****IF W-BC1 = 21                                                D.060525
024730*****    IF W-HCD > 829999 AND < 900000                           D.060525
024740*****        MOVE 5399 TO W-TCD.                                  D.060525
024750     IF W-BC3 = 30
024760         MOVE 5350 TO W-TCD.
024770     IF W-BC3 = 20
024780         MOVE 5358 TO W-TCD.
024790     MOVE W-TCD TO T-KEY.
024800     READ T-M WITH UNLOCK INVALID KEY
024810         GO TO ACP-800.
024820     DISPLAY A-TCD D-TCD.
024830 ACP-800.
024840     MOVE W-TCD TO W-BTCD.
024850     ACCEPT A-TCD.
024860     DISPLAY A-TCD.
024870     DISPLAY E-CL.
024880     IF ESTAT = ADV
024890         MOVE W-BTCD TO W-TCD
024900         DISPLAY A-TCD
024910         MOVE 1 TO W-SKP.
024920     IF ESTAT = PF6
024930         MOVE 6 TO W-SKP.
024940     IF ESTAT = BTB
024950         GO TO ACP-760.
024960     IF ESTAT = HTB OR SKP
024970         MOVE 0 TO W-SKP.
024980     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
024990         GO TO ACP-800.
025000 ACP-820.
025010     IF W-TCD = ZERO
025020         MOVE SPACE TO T-NAME
025030         DISPLAY D-TCD
025040         GO TO ACP-840.
025050     MOVE W-TCD TO T-KEY.
025060     READ T-M WITH UNLOCK INVALID KEY
025070         GO TO ACP-800.
025080     DISPLAY A-TCD D-TCD.
025090     IF T-BC NOT = 0
025100         MOVE SPACE TO W-MSG
025110         MOVE "***  ﾌﾞﾓﾝ ｶﾞ ﾁｶﾞｳ  ***" TO W-MSG
025120         DISPLAY E-ME E-ME98
025130         MOVE 0 TO W-SKP
025140         GO TO ACP-800.
025150 ACP-840.
025160     IF W-SKP NOT = 0
025170         GO TO ACP-880.
025180 ACP-860.
025190     MOVE W-CS TO W-BCS.
025200     ACCEPT A-CS.
025210     DISPLAY A-CS.
025220     DISPLAY E-CL.
025230     IF ESTAT = PF5
025240         GO TO ACP-600.
025250     IF ESTAT = ADV
025260         MOVE W-BCS TO W-CS
025270         MOVE 1 TO W-SKP
025280         DISPLAY A-CS.
025290     IF ESTAT = BTB
025300         GO TO ACP-800.
025310     IF ESTAT = HTB OR SKP
025320         MOVE 0 TO W-SKP.
025330     IF ESTAT NOT = HTB AND SKP AND PF6 AND ADV
025340         GO TO ACP-860.
025350 ACP-880.
025360     DISPLAY A-CS.
025370     MOVE 0 TO W-SKP.
025380 ACP-980.
025390     ACCEPT A-DMM.
025400     IF ESTAT = BTB
025410*****    IF W-ACT = 3 OR 8                                        D.061110
025420         IF W-ACT = 3 OR 5 OR 8                                   I.061110
025430             MOVE 9 TO W-ACP
025440             GO TO ACP-EX
025450           ELSE
025460             GO TO ACP-860.
025470     IF ESTAT NOT = HTB AND SKP
025480         GO TO ACP-980.
025490     IF W-DMM = 9
025500         MOVE 9 TO W-ACP
025510         GO TO ACP-EX.
025520     IF W-DMM NOT = 1
025530         GO TO ACP-980.
025540 ACP-EX.
025550     EXIT.
025560********************************
025570*****　　　画面　表示      *****
025580********************************
025590 CRT-RTN.
025600*****DISPLAY A-HCD A-MHCD A-NAME D-SG D-SB D-ISU A-CS.            D.030822
025610*****DISPLAY A-HCD A-MHCD A-NAME D-SG D-SB D-YG D-ISU A-CS.       D.050416
025620*****DISPLAY A-HCD A-MHCD A-NAME D-SG D-SB D-YG D-ISU A-CS A-HPV. D.090121
025630     DISPLAY A-HCD A-MHCD A-NAME A-SMS                            I.090121
025640*****        D-FT D-SB D-YG D-ISU A-CS A-HPV.                     D.130605
025650             D-FT D-SB D-YG D-YG2 D-ISU A-CS A-HPV.               I.130605
025660     IF W-KRC = 1                                                 I.011030
025670         MOVE NC"加" TO W-KRCN                                    I.011030
025680       ELSE                                                       I.011030
025690         IF W-KRC = 2                                             I.011030
025700             MOVE NC"非" TO W-KRCN                                I.011030
025710           ELSE                                                   I.011030
025720             MOVE SPACE TO W-KRCN.                                I.011030
025730     DISPLAY D-KR.                                                I.011030
025740     IF W-SCC = 0                                                 I.011120
025750         MOVE NC"　　" TO W-SCCN                                  I.011120
025760       ELSE                                                       I.011120
025770         IF W-SCC = 1                                             I.011120
025780             MOVE NC"廃番" TO W-SCCN                              I.080521
025790*****        MOVE NC"上縫" TO W-SCCN                              D.080521
025800           ELSE                                                   I.011120
025810             MOVE NC"不良" TO W-SCCN.                             I.080521
025820*****        IF W-SCC = 2                                         D.080521
025830*****            MOVE NC"上成" TO W-SCCN                          D.080521
025840*****          ELSE                                               D.080521
025850*****            MOVE NC"上未" TO W-SCCN.                         D.080521
025860     DISPLAY D-SC.                                                I.011120
025870     MOVE SPACE TO W-SSCN.                                        I.100601
025880     IF W-SSC = 0                                                 I.100601
025890         MOVE "ｾﾝﾁ" TO W-SSCN                                     I.100601
025900       ELSE                                                       I.100601
025910         IF W-SSC = 1                                             I.100601
025920             MOVE "SML" TO W-SSCN                                 I.100601
025930           ELSE                                                   I.100601
025940             IF W-SSC = 2                                         I.100601
025950                 MOVE "ﾀﾞｲ" TO W-SSCN                             I.100601
025960               ELSE                                               I.100601
025970                 IF W-SSC = 3                                     I.100601
025980                     MOVE "ﾅｼ " TO W-SSCN.                        I.100601
025990     DISPLAY D-SSCM.                                              I.100601
026000     IF W-HKB = 0                                                 I.040311
026010         MOVE SPACE TO W-HKBN                                     I.040311
026020       ELSE                                                       I.040311
026030         MOVE "ﾊｰﾌ" TO W-HKBN.                                    I.040311
026040     DISPLAY D-HK.                                                I.040311
026050     MOVE SPACE TO W-BMCN.                                        I.020314
026060     IF W-BMC = 22                                                I.020314
026070         MOVE NC"国　内" TO W-BMCN.                               I.090121
026080*****    MOVE NC"国内成型" TO W-BMCN.                             D.090121
026090     IF W-BMC = 23                                                I.020314
026100         MOVE NC"ワーク" TO W-BMCN.                               I.090121
026110*****    MOVE NC"ワーク　" TO W-BMCN.                             D.090121
026120     IF W-BMC = 24                                                I.020314
026130         MOVE NC"教　育" TO W-BMCN.                               I.090121
026140*****    MOVE NC"教　育　" TO W-BMCN.                             D.090121
026150     IF W-BMC = 26                                                I.020314
026160         MOVE NC"上　海" TO W-BMCN.                               I.090121
026170*****    MOVE NC"上海成型" TO W-BMCN.                             D.090121
026180     IF W-BMC = 29                                                I.030423
026190         MOVE NC"仕　入" TO W-BMCN.                               I.090121
026200*****    MOVE NC"仕　入　" TO W-BMCN.                             D.090121
026210     DISPLAY D-BM.                                                I.020314
026220     IF W-SNG NOT = ZERO
026230         DISPLAY A-SNG.
026240     IF W-ENG NOT = ZERO
026250         DISPLAY A-ENG.
026260*
026270     IF W-MHCD = W-KEY
026280         DISPLAY D-CHNA
026290         GO TO CRT-020.
026300     MOVE W-MHCD TO HI-KEY.
026310     READ HI-M WITH UNLOCK INVALID KEY
026320         MOVE SPACE TO HI-NAME.
026330     DISPLAY D-MHNA.
026340     MOVE W-KEY TO HI-KEY.
026350*****READ HI-M WITH UNLOCK INVALID KEY                            D.030403
026360     READ HI-M INVALID KEY                                        I.030403
026370         MOVE SPACE TO W-MSG
026380         MOVE "***  DATA ﾅｼ ?  ***" TO W-MSG
026390         DISPLAY E-ME E-ME99
026400         MOVE 9 TO W-ACP
026410         GO TO CRT-EX.
026420 CRT-020.
026430     MOVE SPACE TO HKB-KEY.
026440     MOVE 11 TO HKB-NO.
026450     MOVE W-BC1 TO HKB-BR1.
026460     READ HKBM WITH UNLOCK INVALID KEY
026470         MOVE SPACE TO HKB-BRN1.
026480     DISPLAY A-BCD1 D-BCN1.                                       I.030514
026490     MOVE SPACE TO W-BCN21.                                       I.030514
026500     PERFORM BC21-RTN THRU BC21-EX.                               I.030514
026510*****DISPLAY A-BC1 D-BCN1.                                        D.030514
026520*
026530*****MOVE SPACE TO HKB-KEY.                                       D.020620
026540*****MOVE 12 TO HKB-NO.                                           D.020620
026550*****MOVE W-BC21 TO HKB-BR21.                                     D.020620
026560*****READ HKBM WITH UNLOCK INVALID KEY                            D.020620
026570*****    MOVE SPACE TO HKB-BRN21F HKB-BRN21R HKB-BRN21S.          D.020620
026580*****MOVE SPACE TO W-BRN2.                                        D.020620
026590*****IF HKB-BRN21R = SPACE                                        D.020620
026600*****    MOVE HKB-BRN21F TO W-BRN2                                D.020620
026610*****  ELSE                                                       D.020620
026620*****    MOVE HKB-BRN21S TO W-BRN2F                               D.020620
026630*****    MOVE HKB-BRN21R TO W-BRN2R.                              D.020620
026640     MOVE SPACE TO HKB-KEY.
026650     MOVE 13 TO HKB-NO.
026660     MOVE W-BC22 TO HKB-BR22.
026670     READ HKBM WITH UNLOCK INVALID KEY
026680         MOVE SPACE TO HKB-BRN22.
026690     DISPLAY A-BC22 D-BCN22.                                      I.030514
026700*****DISPLAY A-BC2 D-BCN22.                                       D.030514
026710*****DISPLAY A-BC2 D-BCN21 D-BCN22.                               D.020620
026720*
026730     MOVE SPACE TO HKB-KEY.
026740     MOVE 14 TO HKB-NO.
026750     MOVE W-BC3 TO HKB-BR3.
026760     READ HKBM WITH UNLOCK INVALID KEY
026770         MOVE SPACE TO HKB-BRN3.
026780     DISPLAY A-BC3 D-BCN3.
026790*
026800     MOVE SPACE TO W-BCN4.                                        I.090121
026810     IF W-BC3 = 20                                                I.090121
026820         IF W-BC4 = 0                                             I.090121
026830             MOVE NC"ワーク" TO W-BCN4                            I.090121
026840           ELSE                                                   I.090121
026850             IF W-BC4 = 1                                         I.090121
026860                 MOVE NC"厨　房" TO W-BCN4                        I.090121
026870               ELSE                                               I.090121
026880                 IF W-BC4 = 2                                     I.090121
026890                     MOVE NC"介　護" TO W-BCN4.                   I.090121
026900     DISPLAY A-BC4 D-BCN4.                                        I.090121
026910 CRT-030.
026920     MOVE W-TCD TO T-KEY.
026930     READ T-M WITH UNLOCK INVALID KEY
026940         MOVE SPACE TO T-NAME.
026950     DISPLAY A-TCD D-TCD.
026960*
026970     MOVE ZERO TO CNT.
026980     MOVE 16 TO W-L.                                              I.090121
026990     MOVE 7 TO W-C.                                               I.090121
027000*****MOVE 15 TO W-L.                                              D.090121
027010*****MOVE 4 TO W-C.                                               D.090121
027020 CRT-040.
027030     ADD 1 TO CNT.
027040     IF CNT = 41
027050         GO TO CRT-EX.
027060     IF CNT = 11 OR 21 OR 31
027070         ADD 1 TO W-L
027080         MOVE 7 TO W-C.                                           I.090121
027090*****    MOVE 4 TO W-C.                                           D.090121
027100     ADD 5 TO W-C.
027110     IF CNT NOT = 30 AND 39                                       I.090121
027120         DISPLAY D-S.
027130     GO TO CRT-040.
027140 CRT-EX.
027150     EXIT.
027160************************************
027170*****　　ＢＣ２１　ＤＩＳＰ    *****
027180************************************
027190 BC21-RTN.                                                        I.030514
027200*****IF W-BC1 NOT = 21                                            D.041201
027210*****    GO TO BC21-010.                                          D.041201
027220*****IF W-BC21 = 1                                                D.041201
027230*****    MOVE NC"定　番　" TO W-BCN21.                            D.041201
027240*****IF W-BC21 = 2                                                D.041201
027250*****    MOVE NC"Ｓ　Ｓ　" TO W-BCN21.                            D.041201
027260*****IF W-BC21 = 3                                                D.041201
027270*****    MOVE NC"Ａ　Ｗ　" TO W-BCN21.                            D.041201
027280*****IF W-BC21 = 4                                                D.041201
027290*****    MOVE NC"サンダル" TO W-BCN21.                            D.041201
027300*****IF W-BC21 = 5                                                D.041201
027310*****    MOVE NC"レイン　" TO W-BCN21.                            D.041201
027320*****IF W-BC21 = 6                                                D.041201
027330*****    MOVE NC"キ　サ　" TO W-BCN21.                            D.041201
027340*****IF W-BC21 = 7                                                D.041201
027350*****    MOVE NC"その他　" TO W-BCN21.                            D.041201
027360*****GO TO BC21-090.                                              D.041201
027370*BC21-010.                                                        D.041201
027380*****IF W-BC1 NOT = 81                                            D.060524
027390     IF W-BC1 NOT = 48 AND 58                                     I.060524
027400         GO TO BC21-020.                                          I.040420
027410*****    GO TO BC21-090.                                          D.040420
027420     IF W-BC21 = 1                                                I.030514
027430         MOVE NC"黒　　　" TO W-BCN21.                            I.030514
027440     IF W-BC21 = 2                                                I.030514
027450         MOVE NC"カラー　" TO W-BCN21.                            I.030514
027460     IF W-BC21 = 3                                                I.050727
027470         MOVE NC"インジェ" TO W-BCN21.                            I.050727
027480 BC21-020.                                                        I.040420
027490     IF W-BC1 NOT = 26                                            I.040420
027500         GO TO BC21-030.                                          I.060525
027510*****    GO TO BC21-090.                                          D.060525
027520     IF W-BC21 = 1                                                I.040420
027530         MOVE NC"定　番　" TO W-BCN21.                            I.040420
027540     IF W-BC21 = 2                                                I.040420
027550         MOVE NC"非定番　" TO W-BCN21.                            I.040420
027560     IF W-BC21 = 3                                                I.040611
027570         MOVE NC"仕入品　" TO W-BCN21.                            I.040611
027580 BC21-030.                                                        I.060525
027590     IF W-BC1 NOT = 32 AND 51                                     I.060525
027600         GO TO BC21-090.                                          I.060525
027610     IF W-BC21 = 1                                                I.060525
027620         MOVE NC"一　　般" TO W-BCN21.                            I.060525
027630     IF W-BC21 = 2                                                I.060525
027640         MOVE NC"ヴィヴェ" TO W-BCN21.                            I.060525
027650 BC21-090.                                                        I.030514
027660     DISPLAY D-BCN21.                                             I.030514
027670 BC21-EX.                                                         I.030514
027680     EXIT.                                                        I.030514
027690************************************
027700*****　　ＨＫＢＭ　ＲＥＡＤ    *****
027710************************************
027720 HKB-RTN.
027730     READ HKBM WITH UNLOCK INVALID KEY
027740         MOVE SPACE TO W-MSG
027750         MOVE "***  ﾌﾞﾝﾙｲ ﾅｼ  ***" TO W-MSG
027760         DISPLAY E-ME E-ME98
027770         MOVE 9 TO W-INV.
027780 HKB-EX.
027790     EXIT.
027800***************************************
027810*****    ＨＵＨＭ　ＷＲＩＴＥ     *****
027820***************************************
027830 HU1-RTN.
027840     INITIALIZE HUH-R.
027850     MOVE W-KEY TO HUH-KEY.
027860     MOVE W-NG TO HUH-NG.
027870*****MOVE W-BC1 TO HUH-BC1.                                       D.030514
027880*****MOVE W-BC2 TO HUH-BC2.                                       D.030514
027890     MOVE W-BCD1 TO HUH-BCD1.                                     I.030514
027900     MOVE W-BC22 TO HUH-BC22.                                     I.030514
027910     MOVE W-BC3 TO HUH-BC3.
027920     MOVE W-BMC TO HUH-BMC.                                       I.020314
027930     MOVE W-BMNO TO HUH-BMNO.                                     I.020425
027940     MOVE W-BC4 TO HUH-BC4.                                       I.090121
027950     WRITE HUH-R INVALID KEY
027960         MOVE SPACE TO W-MSG W-FILE
027970         MOVE "***  WRITE ｴﾗｰ  ***" TO W-MSG
027980         MOVE "HUHM" TO W-FILE
027990         DISPLAY E-STAT E-ME E-FILE E-HUH E-ME99
028000         GO TO HU1-020.
028010     GO TO HU1-EX.
028020 HU1-020.
028030     IF ERR-STAT NOT = "24"
028040         DISPLAY E-ME78 E-ME99
028050         MOVE 9 TO W-END
028060         GO TO HU1-EX.
028070     DISPLAY E-CL.
028080     CLOSE HUH-M.
028090     DISPLAY E-ME71 E-ME98 STOP " ".
028100     DISPLAY E-CL.
028110     OPEN I-O HUH-M.
028120     GO TO HU1-RTN.
028130 HU1-EX.
028140     EXIT.
028150***************************************
028160*****    ＨＨＴＦ　ＷＲＩＴＥ     *****
028170***************************************
028180 HH1-RTN.
028190     INITIALIZE HHT-R.
028200     MOVE W-MHCD TO HHT-MHCD.
028210     MOVE W-KEY TO HHT-HCD.
028220     MOVE CNT TO HHT-SIZ.
028230*****MOVE W-BC1 TO HHT-BC1.                                       D.030514
028240*****MOVE W-BC2 TO HHT-BC2.                                       D.030514
028250     MOVE W-BCD1 TO HHT-BCD1.                                     I.030514
028260     MOVE W-BC22 TO HHT-BC22.                                     I.030514
028270     MOVE W-BC3 TO HHT-BC3.
028280     MOVE W-BMNO TO HHT-BMNO.                                     I.020425
028290     MOVE W-BC4 TO HHT-BC4.                                       I.090121
028300     WRITE HHT-R INVALID KEY
028310         MOVE SPACE TO W-MSG W-FILE
028320         MOVE "***  WRITE ｴﾗｰ  ***" TO W-MSG
028330         MOVE "HHTF" TO W-FILE
028340         DISPLAY E-STAT E-ME E-FILE E-HHT E-ME99
028350         GO TO HH1-020.
028360     GO TO HH1-EX.
028370 HH1-020.
028380     IF ERR-STAT NOT = "24"
028390         DISPLAY E-ME78 E-ME99
028400         MOVE 9 TO W-END
028410         GO TO HH1-EX.
028420     DISPLAY E-CL.
028430     CLOSE HHTF.
028440     DISPLAY E-ME71 E-ME98 STOP " ".
028450     DISPLAY E-CL.
028460     OPEN I-O HHTF.
028470     GO TO HH1-RTN.
028480 HH1-EX.
028490     EXIT.
028500****************************************
028510*****　　修正時サイズ　チェック    *****
028520****************************************
028530 CHK-RTN.
028540     MOVE 0 TO W-ACP.
028550     MOVE SPACE TO HHT-KEY.
028560     MOVE W-HCD TO HHT-HCD.
028570     START HHTF KEY NOT < HHT-KEY INVALID KEY
028580         GO TO CHK-EX.
028590 CHK-020.
028600     READ HHTF NEXT RECORD WITH UNLOCK AT END
028610         GO TO CHK-EX.
028620     IF W-HCD NOT = HHT-HCD
028630         GO TO CHK-EX.
028640     IF CNT > 00 AND < 11
028650         IF HHT-SIZ NOT = 1
028660             GO TO CHK-020
028670           ELSE
028680             MOVE CNT TO CNTD.
028690     IF CNT > 10 AND < 21
028700         IF HHT-SIZ NOT = 2
028710             GO TO CHK-020
028720           ELSE
028730             COMPUTE CNTD = CNT - 10.
028740     IF CNT > 20 AND < 31
028750         IF HHT-SIZ NOT = 3
028760             GO TO CHK-020
028770           ELSE
028780             COMPUTE CNTD = CNT - 20.
028790     IF CNT > 30 AND < 41
028800         IF HHT-SIZ NOT = 4
028810             GO TO CHK-020
028820           ELSE
028830             COMPUTE CNTD = CNT - 30.
028840     IF ZERO NOT = HHT-ZSU(CNTD) OR HHT-NSU(CNTD) OR HHT-USU(CNTD)
028850         MOVE SPACE TO W-MSG W-FILE
028860         MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG
028870         MOVE "HHTF" TO W-FILE
028880         DISPLAY E-ME E-FILE E-HHT E-ME99
028890         MOVE 9 TO W-ACP.
028900 CHK-EX.
028910     EXIT.
028920****************************
028930*****    ＷＲＩＴＥ　　*****
028940****************************
028950 WRI-RTN.
028960     INITIALIZE HI-R.
028970     MOVE W-R TO HI-R.
028980     WRITE HI-R INVALID KEY
028990         MOVE SPACE TO W-MSG W-FILE
029000         MOVE "***  WRITE ｴﾗｰ  ***" TO W-MSG
029010         MOVE "HIM" TO W-FILE
029020         DISPLAY E-STAT E-ME E-FILE E-HI E-ME99
029030         GO TO WRI-020.
029040     GO TO WRI-040.
029050 WRI-020.
029060     IF ERR-STAT NOT = "24"
029070         DISPLAY E-ME78 E-ME99
029080         MOVE 9 TO W-END
029090         GO TO WRI-EX.
029100     DISPLAY E-CL.
029110     CLOSE HI-M.
029120     DISPLAY E-ME71 E-ME98 STOP " ".
029130     DISPLAY E-CL.
029140     OPEN I-O HI-M.
029150     GO TO WRI-RTN.
029160 WRI-040.
029170     PERFORM HU1-RTN THRU HU1-EX.
029180     IF W-END = 9
029190         GO TO WRI-EX.
029200*
029210     MOVE ZERO TO CNT.
029220 WRI-060.
029230     ADD 1 TO CNT.
029240     IF CNT = 5
029250         GO TO WRI-EX.
029260     IF W-SK(CNT) = ZERO
029270         GO TO WRI-060.
029280     PERFORM HH1-RTN THRU HH1-EX.
029290     IF W-END = 9
029300         GO TO WRI-EX.
029310     GO TO WRI-060.
029320 WRI-EX.
029330     EXIT.
029340********************************
029350*****    ＲＥＷＲＩＴＥ　　*****
029360********************************
029370 REW-RTN.
029380     INITIALIZE HI-R.
029390     MOVE W-R TO HI-R.
029400     REWRITE HI-R INVALID KEY
029410         MOVE SPACE TO W-MSG W-FILE
029420         MOVE "***  REWRITE ｴﾗｰ  ***" TO W-MSG
029430         MOVE "HIM" TO W-FILE
029440         DISPLAY E-STAT E-ME E-FILE E-HI E-ME99
029450         MOVE 9 TO W-END
029460         GO TO REW-EX.
029470*
029480     MOVE ZERO TO W-DCDD.
029490     IF (W-OSKD(1) NOT = ZERO) AND (W-SKD(1) = ZERO)
029500         MOVE 1 TO W-DC(1).
029510     IF (W-OSKD(2) NOT = ZERO) AND (W-SKD(2) = ZERO)
029520         MOVE 1 TO W-DC(2).
029530     IF (W-OSKD(3) NOT = ZERO) AND (W-SKD(3) = ZERO)
029540         MOVE 1 TO W-DC(3).
029550     IF (W-OSKD(4) NOT = ZERO) AND (W-SKD(4) = ZERO)
029560         MOVE 1 TO W-DC(4).
029570     IF (W-OSKD(1) = ZERO) AND (W-SKD(1) NOT = ZERO)
029580         MOVE 2 TO W-DC(1).
029590     IF (W-OSKD(2) = ZERO) AND (W-SKD(2) NOT = ZERO)
029600         MOVE 2 TO W-DC(2).
029610     IF (W-OSKD(3) = ZERO) AND (W-SKD(3) NOT = ZERO)
029620         MOVE 2 TO W-DC(3).
029630     IF (W-OSKD(4) = ZERO) AND (W-SKD(4) NOT = ZERO)
029640         MOVE 2 TO W-DC(4).
029650     IF W-DCDD = ZERO
029660         GO TO REW-100.
029670*
029680     MOVE 0 TO CHK.
029690 REW-020.
029700     ADD 1 TO CHK.
029710     IF CHK = 5
029720         GO TO REW-100.
029730     IF W-DC(CHK) = 0
029740         GO TO REW-020.
029750     IF W-DC(CHK) = 2
029760         GO TO REW-060.
029770     MOVE W-KEY TO HHT-HCD.
029780     MOVE CHK TO HHT-SIZ.
029790     READ HHTF INVALID KEY
029800         GO TO REW-020.
029810     IF ZERO = HHT-ZSU(01) AND HHT-ZSU(02) AND HHT-ZSU(03) AND
029820               HHT-ZSU(04) AND HHT-ZSU(05) AND HHT-ZSU(06) AND
029830               HHT-ZSU(07) AND HHT-ZSU(08) AND HHT-ZSU(09) AND
029840               HHT-ZSU(10) AND
029850               HHT-NSU(01) AND HHT-NSU(02) AND HHT-NSU(03) AND
029860               HHT-NSU(04) AND HHT-NSU(05) AND HHT-NSU(06) AND
029870               HHT-NSU(07) AND HHT-NSU(08) AND HHT-NSU(09) AND
029880               HHT-NSU(10) AND
029890               HHT-USU(01) AND HHT-USU(02) AND HHT-USU(03) AND
029900               HHT-USU(04) AND HHT-USU(05) AND HHT-USU(06) AND
029910               HHT-USU(07) AND HHT-USU(08) AND HHT-USU(09) AND
029920               HHT-USU(10)
029930         GO TO REW-040.
029940     MOVE SPACE TO W-MSG W-FILE.
029950     MOVE "***  DATA ｶﾞ ZERO ﾃﾞﾅｲ  ***" TO W-MSG.
029960     MOVE "HHTF" TO W-FILE.
029970     DISPLAY E-ME E-FILE E-HHT E-ME99.
029980     MOVE 9 TO W-END.
029990     GO TO REW-EX.
030000 REW-040.
030010     DELETE HHTF INVALID KEY
030020         MOVE SPACE TO W-MSG W-FILE
030030         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
030040         MOVE "HHTF" TO W-FILE
030050         DISPLAY E-STAT E-ME E-FILE E-HHT E-ME99
030060         MOVE 9 TO W-END
030070         GO TO REW-EX.
030080     GO TO REW-020.
030090 REW-060.
030100     MOVE CHK TO CNT.
030110     PERFORM HH1-RTN THRU HH1-EX.
030120     IF W-END = 9
030130         GO TO REW-EX.
030140     GO TO REW-020.
030150*-------------------------------------------------------------------------
030160 REW-100.
030170     MOVE 0 TO W-RC.
030180*****IF (W-BC1 = W-OBC1) AND (W-BC2 = W-OBC2)                     D.030514
030190*****IF (W-BCD1 = W-OBCD1) AND (W-BC22 = W-OBC22)                 D.090121
030200*****           AND (W-BC3 = W-OBC3) AND (W-BMC = W-OBMC)         D.090121
030210*****                    AND (W-BC3 = W-OBC3)                     D.020425
030220     IF (W-BCD1 = W-OBCD1) AND (W-BC22 = W-OBC22) AND             I.090121
030230        (W-BC3 = W-OBC3) AND (W-BMC = W-OBMC) AND (W-BC4 = W-OBC4)I.090121
030240         GO TO REW-120.                                           I.020205
030250*****    GO TO REW-EX.                                            D.020205
030260*
030270     MOVE W-KEY TO HUH-KEY.
030280     READ HUH-M INVALID KEY
030290         GO TO REW-120.
030300*
030310*****MOVE W-BC1 TO HUH-BC1.                                       D.030514
030320*****MOVE W-BC2 TO HUH-BC2.                                       D.030514
030330     MOVE W-BCD1 TO HUH-BCD1.                                     I.030514
030340     MOVE W-BC22 TO HUH-BC22.                                     I.030514
030350     MOVE W-BC3 TO HUH-BC3.
030360     MOVE W-BMC TO HUH-BMC.                                       I.020314
030370     MOVE W-BMNO TO HUH-BMNO.                                     I.020425
030380     MOVE W-BC4 TO HUH-BC4.                                       I.090121
030390     REWRITE HUH-R INVALID KEY
030400         MOVE SPACE TO W-MSG W-FILE
030410         MOVE "***  REWRITE ｴﾗｰ  ***" TO W-MSG
030420         MOVE "HUHM" TO W-FILE
030430         DISPLAY E-STAT E-ME E-FILE E-HUH E-ME99
030440         MOVE 9 TO W-END
030450         GO TO REW-EX.
030460     IF COMPLETION-CODE = 000
030470         MOVE 050 TO COMPLETION-CODE.
030480     IF COMPLETION-CODE = 100
030490         MOVE 150 TO COMPLETION-CODE.
030500     IF W-RC = 0
030510         MOVE 1 TO W-RC.
030520 REW-120.
030530*****IF (W-BC1 = W-OBC1) AND (W-BC2 = W-OBC2)                     D.030514
030540     IF (W-BCD1 = W-OBCD1) AND (W-BC22 = W-OBC22)                 I.030514
030550         AND (W-BC3 = W-OBC3) AND (W-MHCD = W-OMHCD)              I.020205
030560         AND (W-BMC = W-OBMC) AND (W-BC4 = W-OBC4)                I.090121
030570*****    AND (W-BMC = W-OBMC)                                     D.090121
030580         GO TO REW-EX.                                            I.020205
030590     MOVE SPACE TO HHT-KEY.
030600     MOVE W-KEY TO HHT-HCD.
030610     START HHTF KEY NOT < HHT-KEY INVALID KEY
030620         GO TO REW-200.
030630 REW-140.
030640     READ HHTF NEXT RECORD AT END
030650         GO TO REW-200.
030660     IF W-KEY NOT = HHT-HCD
030670         GO TO REW-200.
030680*
030690     MOVE W-MHCD TO HHT-MHCD.                                     I.020205
030700*****MOVE W-BC1 TO HHT-BC1.                                       D.030514
030710*****MOVE W-BC2 TO HHT-BC2.                                       D.030514
030720     MOVE W-BCD1 TO HHT-BCD1.                                     I.030514
030730     MOVE W-BC22 TO HHT-BC22.                                     I.030514
030740     MOVE W-BC3 TO HHT-BC3.
030750     MOVE W-BMNO TO HHT-BMNO.                                     I.020425
030760     MOVE W-BC4 TO HHT-BC4.                                       I.090121
030770     REWRITE HHT-R INVALID KEY
030780         MOVE SPACE TO W-MSG W-FILE
030790         MOVE "***  REWRITE ｴﾗｰ  ***" TO W-MSG
030800         MOVE "HHTF" TO W-FILE
030810         DISPLAY E-STAT E-ME E-FILE E-HHT E-ME99
030820         MOVE 9 TO W-END
030830         GO TO REW-EX.
030840     GO TO REW-140.
030850 REW-200.
030860     IF W-RC = 0
030870         GO TO REW-EX.
030880     OPEN I-O M-DATE.
030890     MOVE "01" TO DATE-KEY.
030900     READ M-DATE INVALID KEY
030910         CLOSE M-DATE
030920         MOVE SPACE TO W-MSG W-FILE
030930         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
030940         MOVE "DATEM" TO W-FILE
030950         DISPLAY E-ME E-FILE E-ME99
030960         DISPLAY E-CL
030970         GO TO REW-EX.
030980*****IF W-BC1 NOT = W-OBC1                                        D.030514
030990     IF W-BCD1 NOT = W-OBCD1                                      I.030514
031000         MOVE 1 TO DATE-HBC1.
031010*****IF W-BC2 NOT = W-OBC2                                        D.030514
031020*****IF W-BC22 NOT = W-OBC22                                      D.090121
031030     IF (W-BC22 NOT = W-OBC22) OR (W-BC4 NOT = W-OBC4)            I.090121
031040         MOVE 1 TO DATE-HBC2.
031050     IF W-BC3 NOT = W-OBC3
031060         MOVE 1 TO DATE-HBC3.
031070     REWRITE DATE-R INVALID KEY
031080         MOVE SPACE TO W-MSG W-FILE
031090         MOVE "***  REWRITE ｴﾗｰ  ***" TO W-MSG
031100         MOVE "DATEM" TO W-FILE
031110         DISPLAY E-STAT E-ME E-FILE E-ME99
031120         DISPLAY E-CL.
031130     CLOSE M-DATE.
031140 REW-EX.
031150     EXIT.
031160******************************
031170*****    ＤＥＬＥＴＥ　　*****
031180******************************
031190 DEL-RTN.
031200     IF W-ACT NOT = 8
031210         GO TO DEL-040.
031220     MOVE ZERO TO W-DDD W-DCNT.
031230     MOVE SPACE TO HI-KEY.
031240     MOVE W-HCD1 TO HI-HCD1.
031250     START HI-M KEY NOT < HI-KEY INVALID KEY
031260         GO TO DEL-EX.
031270 DEL-020.
031280     READ HI-M NEXT RECORD AT END
031290         GO TO DEL-EX.
031300     IF W-HCD1 NOT = HI-HCD1
031310         GO TO DEL-EX.
031320     MOVE HI-KEY TO W-HCD.
031330     IF HI-MHCD = HI-HCD
031340         ADD 1 TO W-DCNT
031350         IF W-DCNT < 21
031360             MOVE HI-MHCD TO W-DHCD(W-DCNT)
031370           ELSE
031380             MOVE SPACE TO W-MSG
031390             MOVE "***  ｲﾛ ｶﾞ ｵｵｽｷﾞﾙ (ｿｳｼﾝF)  ***" TO W-MSG
031400             DISPLAY E-ME E-HI E-ME99
031410             DISPLAY E-CL.
031420 DEL-040.
031430     DELETE HI-M INVALID KEY
031440         MOVE SPACE TO W-MSG W-FILE
031450         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
031460         MOVE "HIM" TO W-FILE
031470         DISPLAY E-STAT E-ME E-FILE E-HI E-ME99
031480         MOVE 9 TO W-END
031490         GO TO DEL-EX.
031500     IF COMPLETION-CODE = 000
031510         MOVE 100 TO COMPLETION-CODE.
031520     IF COMPLETION-CODE = 050
031530         MOVE 150 TO COMPLETION-CODE.
031540*
031550 DEL-060.
031560     MOVE W-HCD TO HUH-KEY.
031570     READ HUH-M INVALID KEY
031580         GO TO DEL-080.
031590*
031600     DELETE HUH-M INVALID KEY
031610         MOVE SPACE TO W-MSG W-FILE
031620         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
031630         MOVE "HUHM" TO W-FILE
031640         DISPLAY E-STAT E-ME E-FILE E-HUH E-ME99
031650         MOVE 9 TO W-END
031660         GO TO DEL-EX.
031670 DEL-080.
031680     MOVE SPACE TO HHT-KEY.
031690     MOVE W-HCD TO HHT-HCD.
031700     START HHTF KEY NOT < HHT-KEY INVALID KEY
031710         GO TO DEL-120.
031720 DEL-100.
031730     READ HHTF NEXT RECORD AT END
031740         GO TO DEL-120.
031750     IF W-HCD NOT = HHT-HCD
031760         GO TO DEL-120.
031770*
031780     DELETE HHTF INVALID KEY
031790         MOVE SPACE TO W-MSG W-FILE
031800         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
031810         MOVE "HHTF" TO W-FILE
031820         DISPLAY E-STAT E-ME E-FILE E-HHT E-ME99
031830         MOVE 9 TO W-END
031840         GO TO DEL-EX.
031850     GO TO DEL-100.
031860 DEL-120.
031870     OPEN I-O THTM.
031880     MOVE SPACE TO THT-KEY2.
031890     MOVE W-HCD TO THT-HCD2.
031900     START THTM KEY NOT < THT-KEY2 INVALID KEY
031910         GO TO DEL-160.
031920 DEL-140.
031930     READ THTM NEXT RECORD AT END
031940         GO TO DEL-160.
031950     IF THT-KEY2 NOT = W-HCD
031960         GO TO DEL-160.
031970     DELETE THTM INVALID KEY
031980         MOVE SPACE TO W-MSG W-FILE
031990         MOVE "***  DELETE ｴﾗｰ  ***" TO W-MSG
032000         MOVE "THTM" TO W-FILE
032010         DISPLAY E-STAT E-ME E-FILE E-THT E-ME99
032020         MOVE 9 TO W-END
032030         GO TO DEL-160.
032040     GO TO DEL-140.
032050 DEL-160.
032060     CLOSE THTM.
032070     IF W-ACT = 8
032080         GO TO DEL-020.
032090 DEL-EX.
032100     EXIT.
032110****************************
032120*****    ＭＳＴＲＮ　　*****
032130****************************
032140*MST-RTN.                                                         D.160329
032150*****MOVE 0 TO W-ACTD.                                            D.160329
032160*****IF W-ACT = 2                                                 D.160329
032170*****    IF (W-MHCD = W-OMHCD) AND                                D.160329
032180*****       (W-NAME = W-ONAME) AND (W-BC = W-OBC) AND             D.160329
032190*****       (W-SKDD = W-OSKDD) AND (W-ISU = W-OISU)               D.160329
032200*****       AND (W-SMS = W-OSMS) AND (W-HKB = W-OHKB)             D.160329
032210*****                          AND (W-SMS = W-OSMS)               D.090707
032220*****            GO TO MST-EX.                                    D.160329
032230*****IF W-ACT = 2                                                 D.160329
032240*****    IF W-MHCD NOT = W-OMHCD                                  D.160329
032250*****        IF W-KEY NOT = W-MHCD AND W-OMHCD                    D.160329
032260*****            GO TO MST-EX                                     D.160329
032270*****          ELSE                                               D.160329
032280*****            MOVE W-ACT TO W-ACTD                             D.160329
032290*****            IF W-KEY = W-MHCD                                D.160329
032300*****                MOVE 1 TO W-ACT                              D.160329
032310*****              ELSE                                           D.160329
032320*****                IF W-KEY = W-OMHCD                           D.160329
032330*****                    MOVE 3 TO W-ACT                          D.160329
032340*****                    MOVE W-OMHCD TO W-MHCD.                  D.160329
032350*****IF W-ACT = 3                                                 D.160329
032360*****    IF W-MHCD NOT = W-KEY                                    D.160329
032370*****        GO TO MST-EX.                                        D.160329
032380*****IF W-ACT = 8                                                 D.160329
032390*****    IF W-DDD = ZERO                                          D.160329
032400*****        GO TO MST-EX                                         D.160329
032410*****      ELSE                                                   D.160329
032420*****        MOVE ZERO TO W-DCNT.                                 D.160329
032430*MST-010.                                                         D.160329
032440*****MOVE ZERO TO MS-R.                                           D.160329
032450*****MOVE "2" TO MS-ID.                                           D.160329
032460*****IF W-ACT = 8                                                 D.160329
032470*****    ADD 1 TO W-DCNT                                          D.160329
032480*****    IF W-DCNT > 20                                           D.160329
032490*****        GO TO MST-EX                                         D.160329
032500*****      ELSE                                                   D.160329
032510*****        IF W-DHCD(W-DCNT) = ZERO                             D.160329
032520*****            GO TO MST-EX.                                    D.160329
032530*****IF W-ACT = 8                                                 D.160329
032540*****    MOVE W-DHCD(W-DCNT) TO MS-HCD                            D.160329
032550*****  ELSE                                                       D.160329
032560*****    MOVE W-MHCD TO MS-HCD.                                   D.160329
032570*****READ MSTRN INVALID KEY                                       D.160329
032580*****    GO TO MST-020.                                           D.160329
032590*****MOVE W-ACT TO MS-ACT.                                        D.160329
032600*****IF MS-ACT = 8                                                D.160329
032610*****    MOVE 3 TO MS-ACT.                                        D.160329
032620*****MOVE W-NGP TO MS-DATE.                                       D.160329
032630*****REWRITE MS-R INVALID KEY                                     D.160329
032640*****    MOVE SPACE TO W-MSG W-FILE                               D.160329
032650*****    MOVE "***  REWRITE ｴﾗｰ  ***" TO W-MSG                    D.160329
032660*****    MOVE "MSTRAN" TO W-FILE                                  D.160329
032670*****    DISPLAY E-STAT E-ME E-FILE E-ME99                        D.160329
032680*****    MOVE 9 TO W-END.                                         D.160329
032690*****IF W-ACT = 8                                                 D.160329
032700*****    GO TO MST-010.                                           D.160329
032710*****GO TO MST-EX.                                                D.160329
032720*MST-020.                                                         D.160329
032730*****IF W-OVER = 5                                                D.160329
032740*****    GO TO MST-EX.                                            D.160329
032750*****MOVE W-ACT TO MS-ACT.                                        D.160329
032760*****IF MS-ACT = 8                                                D.160329
032770*****     MOVE 3 TO MS-ACT.                                       D.160329
032780*****MOVE W-NGP TO MS-DATE.                                       D.160329
032790*****WRITE MS-R INVALID KEY                                       D.160329
032800*****    MOVE 5 TO W-OVER                                         D.160329
032810*****    MOVE SPACE TO W-MSG W-FILE                               D.160329
032820*****    MOVE "***  WRITE ｴﾗｰ  ***" TO W-MSG                      D.160329
032830*****    MOVE "MSTRAN" TO W-FILE                                  D.160329
032840*****    DISPLAY E-STAT E-ME E-FILE E-ME99                        D.160329
032850*****    DISPLAY E-CL.                                            D.160329
032860*****IF W-ACT = 8                                                 D.160329
032870*****    GO TO MST-010.                                           D.160329
032880*MST-EX.                                                          D.160329
032890*****EXIT.                                                        D.160329
032900****************************
032910*****　　作　　　表    *****
032920****************************
032930 PRI-RTN.
032940     DISPLAY C-CLEAR.
032950     DISPLAY C-MID C-PM A-ACT.
032960 PRI-020.
032970     ACCEPT A-PMC.
032980     IF ESTAT = BTB
032990         GO TO PRI-EX.
033000     IF ESTAT NOT = HTB AND SKP
033010         GO TO PRI-020.
033020     IF W-PMC NOT = 0 AND 5
033030         GO TO PRI-020.
033040 PRI-060.
033050     ACCEPT A-SKEY.
033060     DISPLAY E-CL.
033070     IF ESTAT = BTB
033080         GO TO PRI-020.
033090     IF ESTAT NOT = HTB AND SKP
033100         GO TO PRI-060.
033110 PRI-080.
033120     ACCEPT A-EKEY.
033130     IF ESTAT = BTB
033140         GO TO PRI-060.
033150     IF ESTAT NOT = HTB AND SKP
033160         GO TO PRI-080.
033170     IF W-SKEY > W-EKEY
033180         GO TO PRI-060.
033190 PRI-100.
033200     ACCEPT A-DMM.
033210     IF ESTAT = BTB
033220         GO TO PRI-080.
033230     IF ESTAT NOT = HTB AND SKP
033240         GO TO PRI-100.
033250     IF W-DMM = 9
033260         GO TO PRI-EX.
033270     IF W-DMM NOT = 1
033280         GO TO PRI-100.
033290*
033300     MOVE W-SKEY TO HI-HCD.
033310     START HI-M KEY NOT < HI-KEY INVALID KEY
033320         MOVE SPACE TO W-MSG
033330         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
033340         DISPLAY E-ME E-ME98
033350         GO TO PRI-060.
033360     READ HI-M NEXT RECORD WITH UNLOCK AT END
033370         MOVE SPACE TO W-MSG
033380         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
033390         DISPLAY E-ME E-ME98
033400         GO TO PRI-060.
033410     IF HI-HCD > W-EKEY
033420         MOVE SPACE TO W-MSG
033430         MOVE "***  DATA ﾅｼ  ***" TO W-MSG
033440         DISPLAY E-ME E-ME98
033450         GO TO PRI-060.
033460     PERFORM LST-RTN THRU LST-EX.
033470 PRI-EX.
033480     EXIT.
033490****************************
033500*****　　明細　印字    *****
033510****************************
033520 LST-RTN.
033530     IF W-POC = 0
033540         MOVE 9 TO W-POC
033550         OPEN OUTPUT SP-F
033560         PERFORM MID-020 THRU MID-EX.
033570     MOVE SPACE TO W-P1.
033580     MOVE HI-HCD TO P-HCD.
033590     MOVE HI-NAME TO P-NAME.
033600     MOVE HI-SMS TO P-SMS.                                        I.090121
033610     MOVE HI-BC1 TO P-BC1.
033620     MOVE HI-BC21 TO P-BC21.                                      I.030514
033630     MOVE HI-BC22 TO P-BC22.                                      I.030514
033640*****MOVE HI-BC2 TO P-BC2.                                        D.030514
033650     MOVE HI-BC3 TO P-BC3.
033660     MOVE HI-BMC TO P-BMC.                                        I.020314
033670     IF HI-BC3 = 20                                               I.090121
033680         MOVE HI-BC4 TO P-BC4.                                    I.090121
033690     MOVE HI-SB TO P-SB.
033700*****MOVE HI-ZRG TO P-ZRG.                                        D.090121
033710*****MOVE HI-SKG TO P-SKG.                                        D.090121
033720*****MOVE HI-GKG TO P-GKG.                                        D.090121
033730*****MOVE HI-KNG TO P-KNG.                                        D.090121
033740     MOVE HI-FT TO P-FT.
033750     MOVE HI-YG TO P-YG.                                          I.030822
033760     MOVE HI-ISU TO P-ISU.
033770     MOVE HI-KRC TO P-KRC.                                        I.011030
033780     MOVE HI-SCC TO P-SCC.                                        I.011120
033790     MOVE HI-SSC TO P-SSC.                                        I.100601
033800     MOVE HI-HKB TO P-HKB.                                        I.040311
033810     MOVE HI-HPV TO P-HPV.                                        I.050416
033820*****IF HI-TCD NOT = ZERO                                         D.090121
033830*****    MOVE HI-TCD TO P-TCD.                                    D.090121
033840*****IF HI-SNG NOT = ZERO                                         D.090121
033850*****    MOVE HI-SNG TO P-SNG.                                    D.090121
033860*****IF HI-ENG NOT = ZERO                                         D.090121
033870*****    MOVE HI-ENG TO P-ENG.                                    D.090121
033880*****MOVE HI-CS TO P-CS.                                          D.011120
033890*****IF LINAGE-COUNTER > 59                                       D.090121
033900     IF LINAGE-COUNTER > 60                                       I.090121
033910         PERFORM MID-RTN THRU MID-EX.
033920     MOVE SPACE TO SP-R.
033930     MOVE W-P1 TO SP-R.
033940     WRITE SP-R.
033950     MOVE SPACE TO SP-R.
033960*
033970     MOVE SPACE TO W-P2.
033980     MOVE SPACE TO P-CS.                                          I.011120
033990     IF HI-MHCD NOT = HI-HCD
034000         MOVE HI-MHCD TO P-MHCD
034010         MOVE ")" TO P-C.
034020     MOVE HI-CS TO P-CS.                                          I.011120
034030     IF HI-TCD NOT = ZERO                                         I.090121
034040         MOVE HI-TCD TO P-TCD.                                    I.090121
034050     IF HI-SNG NOT = ZERO                                         I.090121
034060         MOVE HI-SNG TO P-SNG.                                    I.090121
034070     IF HI-ENG NOT = ZERO                                         I.090121
034080         MOVE HI-ENG TO P-ENG.                                    I.090121
034090     MOVE ZERO TO CHK.
034100 LST-020.
034110     ADD 1 TO CHK.
034120     IF CHK = 5
034130         GO TO LST-060.
034140     IF HI-SS(CHK) = ZERO
034150         GO TO LST-020.
034160     MOVE CHK TO P-SIZ.
034170     MOVE ZERO TO CNT.
034180 LST-040.
034190     ADD 1 TO CNT.
034200     IF CNT NOT = 11
034210         MOVE HI-S(CHK,CNT) TO P-SC(CNT)
034220         GO TO LST-040.
034230*
034240*****IF LINAGE-COUNTER > 60                                       D.090121
034250     IF LINAGE-COUNTER > 61                                       I.090121
034260         PERFORM MID-RTN THRU MID-EX.
034270     MOVE SPACE TO SP-R.
034280     MOVE W-P2 TO SP-R.
034290     WRITE SP-R.
034300     MOVE SPACE TO SP-R.
034310     MOVE SPACE TO W-P2.
034320     MOVE SPACE TO P-CS.                                          I.011120
034330     GO TO LST-020.
034340 LST-060.
034350     READ HI-M NEXT RECORD WITH UNLOCK AT END
034360         GO TO LST-EX.
034370     IF HI-HCD > W-EKEY
034380         GO TO LST-EX.
034390     GO TO LST-RTN.
034400 LST-EX.
034410     EXIT.
034420******************************
034430*****　　見出し　印字    *****
034440******************************
034450 MID-RTN.
034460     MOVE SPACE TO SP-R.
034470     WRITE SP-R AFTER PAGE.
034480 MID-020.
034490     IF W-PMC = 5
034500         MOVE 0 TO W-PMC
034510         MOVE SPACE TO SP-R
034520         WRITE SP-R AFTER 24
034530         MOVE HEAD01 TO SP-R
034540         WRITE SP-R AFTER 3
034550         MOVE SPACE TO SP-R
034560         MOVE HEAD02 TO SP-R
034570         WRITE SP-R AFTER 10
034580         MOVE SPACE TO SP-R
034590         WRITE SP-R AFTER PAGE.
034600     ADD 1 TO W-PAGE.
034610     MOVE W-PAGE TO H-PAGE.
034620     MOVE HEAD1 TO SP-R.
034630     WRITE SP-R.
034640     MOVE SPACE TO SP-R.
034650     MOVE HEAD2 TO SP-R.
034660     WRITE SP-R AFTER 2.
034670     MOVE SPACE TO SP-R.
034680     MOVE HEAD3 TO SP-R.
034690     WRITE SP-R.
034700     MOVE SPACE TO SP-R.
034710     MOVE HEAD4 TO SP-R.
034720     WRITE SP-R.
034730     MOVE SPACE TO SP-R.
034740     MOVE HEAD5 TO SP-R.
034750     WRITE SP-R.
034760     MOVE SPACE TO SP-R.
034770     MOVE HEAD6 TO SP-R.
034780     WRITE SP-R.
034790     MOVE SPACE TO SP-R.
034800     WRITE SP-R.
034810 MID-EX.
034820     EXIT.
