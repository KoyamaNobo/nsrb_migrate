000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMT360.
000030*********************************************************
000040*    PROGRAM         :  óöï®ïîñÂíSìñï îÑè„ñ‚çáÇπ        *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHT36                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT SNTRF ASSIGN TO SNTR-MSD
000170         FILE STATUS IS ERR-STAT.
000180 I-O-CONTROL.
000190     APPLY SHARED-MODE ON M-DATE.
000200 DATA DIVISION.
000210 FILE SECTION.
000220     COPY LIBFDD.
000230     COPY LSSNTW.
000240 WORKING-STORAGE SECTION.
000250 77  WK0064ID           PIC  X(009) VALUE SPACE.
000260 01  STN-NO.
000270     02  STN-NO1        PIC  X(003).
000280     02  STN-NO2        PIC  X(003).
000290 01  W-FID.
000300     02  W-FID1         PIC  X(006) VALUE "WK0064".
000310     02  W-FID2         PIC  X(003).
000320 01  W-DATA.
000330     02  W-DMM          PIC  9(001).
000340     02  W-DC           PIC  9(001).
000350     02  W-TNC.
000360       03  W-TNC1       PIC  9(001).
000370       03  W-TNC2       PIC  9(001).
000380     02  W-L            PIC  9(002).
000390     02  W-DATE.
000400       03  W-NEN        PIC  9(002).
000410       03  W-GET        PIC  9(002).
000420       03  W-PEY        PIC  9(002).
000430     02  W-KIN          PIC S9(008).
000440     02  WN-D.
000450       03  WN-NU        PIC S9(009).
000460       03  WN-IU        PIC S9(009).
000470       03  WN-KU        PIC S9(009).
000480       03  WN-GU        PIC S9(009).
000490     02  WT-D.
000500       03  WT-NU        PIC S9(009).
000510       03  WT-IU        PIC S9(009).
000520       03  WT-KU        PIC S9(009).
000530       03  WT-GU        PIC S9(009).
000540     02  WS-D.
000550       03  WS-NU        PIC S9(009).
000560       03  WS-IU        PIC S9(009).
000570       03  WS-KU        PIC S9(009).
000580       03  WS-GU        PIC S9(009).
000590     02  WA-D.
000600       03  WA-NU        PIC S9(009).
000610       03  WA-IU        PIC S9(009).
000620       03  WA-KU        PIC S9(009).
000630       03  WA-GU        PIC S9(009).
000640     02  W-TM           PIC  N(002).
000650     02  W-NEM          PIC  X(021).
000660 01  ERR-STAT           PIC  X(002).
000670     COPY LSTAT.
000680 SCREEN SECTION.
000690 SD  C-CRT
000700     END STATUS IS ESTAT.
000710 01  C-CLEAR.
000720     02  C-CL    LINE   1  CLEAR SCREEN.
000730 01  C-ACP.
000740     02  A-DMM   LINE  23  COLUMN  67  PIC  9(001)
000750          USING W-DMM   CHECK OVERFLOW NO IFC.
000760 01  C-DSP.
000770     02  D-MM    LINE  2.
000780       03  COLUMN  60  PIC Z9      FROM  W-GET.
000790       03  COLUMN  62  PIC  X(001) VALUE "/".
000800       03  COLUMN  64  PIC  9(001) VALUE 1.
000810       03  COLUMN  65  PIC  N(001) VALUE NC"Å`".
000820       03  COLUMN  67  PIC Z9      FROM  W-PEY.
000830     02  D-DATA  LINE W-L.
000840       03  COLUMN  14  PIC  9(002)       FROM  W-TNC.
000850       03  COLUMN  18  PIC ----,---,--9  FROM  WN-NU.
000860       03  COLUMN  31  PIC ----,---,--9  FROM  WN-IU.
000870       03  COLUMN  44  PIC ----,---,--9  FROM  WN-KU.
000880       03  COLUMN  57  PIC ----,---,--9  FROM  WN-GU.
000890     02  D-TD    LINE W-L.
000900       03  COLUMN  13  PIC  N(002)       FROM  W-TM.
000910       03  COLUMN  18  PIC ----,---,--9  FROM  WT-NU.
000920       03  COLUMN  31  PIC ----,---,--9  FROM  WT-IU.
000930       03  COLUMN  44  PIC ----,---,--9  FROM  WT-KU.
000940       03  COLUMN  57  PIC ----,---,--9  FROM  WT-GU.
000950     02  D-NEM   LINE  23  COLUMN  47  PIC  X(021) FROM  W-NEM.
000960 01  C-ERR.
000970     02  LINE  24.
000980       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
000990            "***  DATA ≈º  ***".
001000       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001010       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001020       03  E-CL    COLUMN  10  PIC  X(050) VALUE
001030            "                                                  ".
001040     COPY LIBSCR.
001050 PROCEDURE DIVISION.
001060 M-05.
001070     DISPLAY C-CLEAR.
001080     CALL "SCHT36".
001090     MOVE ZERO TO W-DATA.
001100     COPY LIBCPR.
001110     MOVE D-HSD TO W-DATE.
001120     DISPLAY D-MM.
001130     CALL "CBLSTNNO" USING STN-NO.
001140     MOVE STN-NO2 TO W-FID2.
001150     MOVE W-FID TO WK0064ID.
001160     OPEN INPUT SNTRF.
001170 M-10.
001180     READ SNTRF AT END
001190         DISPLAY E-ME1
001200         GO TO M-90.
001210     IF SNTR-DC = 4 OR 8
001220         GO TO M-10.
001230     IF (SNTR-SNC = 1) OR (SNTR-DC = 1 OR 2 OR 5)
001240         COMPUTE W-KIN = SNTR-KIN * -1
001250       ELSE
001260         MOVE SNTR-KIN TO W-KIN.
001270     IF W-KIN = ZERO
001280         GO TO M-10.
001290     MOVE ZERO TO WA-D.
001300     MOVE 3 TO W-L.
001310 M-15.
001320     MOVE ZERO TO WS-D.
001330     MOVE SNTR-TNC TO W-TNC.
001340 M-20.
001350     MOVE ZERO TO WN-D.
001360     MOVE SNTR-TNC2 TO W-TNC2.
001370 M-25.
001380     IF SNTR-BC3 = 10
001390         ADD W-KIN TO WN-NU WS-NU WA-NU.
001400     IF SNTR-BC3 = 20
001410         ADD W-KIN TO WN-IU WS-IU WA-IU.
001420     IF SNTR-BC3 = 30
001430         ADD W-KIN TO WN-KU WS-KU WA-KU.
001440     ADD W-KIN TO WN-GU WS-GU WA-GU.
001450 M-30.
001460     READ SNTRF AT END
001470         GO TO M-40.
001480     IF SNTR-DC = 4 OR 8
001490         GO TO M-30.
001500     IF (SNTR-SNC = 1) OR (SNTR-DC = 1 OR 2 OR 5)
001510         COMPUTE W-KIN = SNTR-KIN * -1
001520       ELSE
001530         MOVE SNTR-KIN TO W-KIN.
001540     IF W-KIN = ZERO
001550         GO TO M-30.
001560     IF SNTR-TNC1 NOT = W-TNC1
001570         GO TO M-35.
001580     IF SNTR-TNC2 = W-TNC2
001590         GO TO M-25.
001600     MOVE 0 TO W-DC.
001610     PERFORM MEI-RTN THRU MEI-EX.
001620     IF ESTAT = PF9                                               I.070219
001630         GO TO M-90.                                              I.070219
001640     GO TO M-20.
001650 M-35.
001660     MOVE 0 TO W-DC.
001670     PERFORM MEI-RTN THRU MEI-EX.
001680     IF ESTAT = PF9                                               I.070219
001690         GO TO M-90.                                              I.070219
001700     MOVE 1 TO W-DC.
001710     PERFORM MEI-RTN THRU MEI-EX.
001720     IF ESTAT = PF9                                               I.070219
001730         GO TO M-90.                                              I.070219
001740     GO TO M-15.
001750 M-40.
001760     MOVE 0 TO W-DC.
001770     PERFORM MEI-RTN THRU MEI-EX.
001780     IF ESTAT = PF9                                               I.070219
001790         GO TO M-90.                                              I.070219
001800     MOVE 1 TO W-DC.
001810     PERFORM MEI-RTN THRU MEI-EX.
001820     IF ESTAT = PF9                                               I.070219
001830         GO TO M-90.                                              I.070219
001840     PERFORM ALL-RTN THRU ALL-EX.
001850 M-90.
001860     CLOSE SNTRF.
001870 M-95.
001880     DISPLAY C-CLEAR.
001890     STOP RUN.
001900 MEI-RTN.
001910     ADD 1 TO W-L.
001920     IF W-L NOT = 23
001930         IF W-DC = 0
001940             DISPLAY D-DATA
001950             GO TO MEI-EX
001960           ELSE
001970             MOVE WS-D TO WT-D
001980             MOVE NC"è¨åv" TO W-TM
001990             DISPLAY D-TD
002000             GO TO MEI-EX.
002010     MOVE SPACE TO W-NEM.
002020     MOVE "ÇmÇdÇwÇsÅ@ÇcÇ`ÇsÇ`   " TO W-NEM.
002030     DISPLAY D-NEM.
002040 MEI-020.
002050     ACCEPT A-DMM.
002060     IF ESTAT NOT = PF9
002070         DISPLAY C-CLEAR
002080         CALL "SCHT36"
002090         DISPLAY D-MM
002100         MOVE 3 TO W-L
002110         GO TO MEI-RTN.
002120 MEI-EX.
002130     EXIT.
002140 ALL-RTN.
002150     ADD 1 TO W-L.
002160     IF W-L = 23
002170         MOVE SPACE TO W-NEM
002180         MOVE "ÇmÇdÇwÇsÅ@ÇcÇ`ÇsÇ`   " TO W-NEM
002190       ELSE
002200         MOVE WA-D TO WT-D
002210         MOVE NC"çáåv" TO W-TM
002220         DISPLAY D-TD
002230         MOVE SPACE TO W-NEM
002240         MOVE "Å@ÇdÇmÇcÅ@ÇcÇ`ÇsÇ`   " TO W-NEM.
002250     DISPLAY D-NEM.
002260 ALL-020.
002270     ACCEPT A-DMM.
002280     IF W-L = 23
002290         IF ESTAT NOT = PF9
002300             DISPLAY C-CLEAR
002310             CALL "SCHT36"
002320             DISPLAY D-MM
002330             MOVE 3 TO W-L
002340             GO TO ALL-RTN.
002350 ALL-EX.
002360     EXIT.
