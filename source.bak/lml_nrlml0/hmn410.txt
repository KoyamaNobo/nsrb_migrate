000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMN410.
000030*********************************************************
000040*    PROGRAM         :  履物品名統計ワーク作成        　*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT HHTW ASSIGN TO HHTW-MSD.
000160     SELECT HHTF ASSIGN TO HHTF-MSD.
000170 DATA DIVISION.
000180 FILE SECTION.
000190 FD  HHTW
000200     BLOCK  1 RECORDS
000210     LABEL RECORD IS STANDARD
000220     VALUE OF IDENTIFICATION WK0256ID.
000230 01  HHTW-R.
000240     02  HHTW-KEY2.
000250       03  HHTW-MHCD    PIC  9(006).
000260       03  HHTW-KEY.
000270         04  HHTW-HCD   PIC  9(006).
000280         04  HHTW-SIZ   PIC  9(001).
000290     02  HHTW-AZSU.                                               前月残数
000300       03  HHTW-ZSUD  OCCURS  10.
000310         04  HHTW-ZSU   PIC S9(006) COMP-3.
000320     02  HHTW-ANSU.                                               入庫数
000330       03  HHTW-NSUD  OCCURS  10.
000340         04  HHTW-NSU   PIC S9(006) COMP-3.
000350     02  HHTW-AUSU.                                               出庫数
000360       03  HHTW-USUD  OCCURS  10.
000370         04  HHTW-USU   PIC S9(006) COMP-3.
000380     02  HHTW-AASS.                                               預り出荷
000390       03  HHTW-ASSD  OCCURS  10.
000400         04  HHTW-ASS   PIC S9(004) COMP-3.
000410     02  HHTW-ATZS.                                               棚卸帳簿
000420       03  HHTW-TSZD  OCCURS  10.
000430         04  HHTW-TZS   PIC S9(006) COMP-3.
000440     02  HHTW-ATSU.                                               棚卸数
000450       03  HHTW-TSUD  OCCURS  10.
000460         04  HHTW-TSU   PIC S9(006) COMP-3.
000470     02  F              PIC  X(012).
000480     02  HHTW-SEN       PIC  9(001).
000490 FD  HHTF
000500     BLOCK  1 RECORDS
000510     LABEL RECORD IS STANDARD
000520     VALUE OF IDENTIFICATION WK0512ID.
000530 01  HHT-R.
000540     02  HHT-KEY2.
000550       03  HHT-MHCD     PIC  9(006).
000560       03  HHT-KEY.
000570         04  HHT-HCD    PIC  9(006).
000580         04  HHT-SIZ    PIC  9(001).
000590     02  HHT-AZSU.                                                前月残数
000600       03  HHT-ZSUD  OCCURS  10.
000610         04  HHT-ZSU    PIC S9(006) COMP-3.
000620     02  HHT-ANSU.                                                入庫数
000630       03  HHT-NSUD  OCCURS  10.
000640         04  HHT-NSU    PIC S9(006) COMP-3.
000650     02  HHT-AUSU.                                                出庫数
000660       03  HHT-USUD  OCCURS  10.
000670         04  HHT-USU    PIC S9(006) COMP-3.
000680     02  HHT-AASS.                                                預り出荷
000690       03  HHT-ASSD  OCCURS  10.
000700         04  HHT-ASS    PIC S9(004) COMP-3.
000710     02  HHT-ATZS.                                                棚卸帳簿
000720       03  HHT-TSZD  OCCURS  10.
000730         04  HHT-TZS    PIC S9(006) COMP-3.
000740     02  HHT-ATSU.                                                棚卸数
000750       03  HHT-TSUD  OCCURS  10.
000760         04  HHT-TSU    PIC S9(006) COMP-3.
000770     02  HHT-BCD12.
000780       03  HHT-BCD1     PIC  9(003).
000790       03  HHT-BC22     PIC  9(001).
000800     02  HHT-BC3        PIC  9(002).                              分類CD3
000810     02  HHT-BMNO       PIC  9(001).
000820     02  F              PIC  X(006).
000830     02  F              PIC  X(256).
000840 WORKING-STORAGE SECTION.
000850 77  WK0256ID           PIC  X(009) VALUE SPACE.
000860 77  WK0512ID           PIC  X(009) VALUE SPACE.
000870 01  STN-NO.
000880     02  STN-NO1        PIC  X(003).
000890     02  STN-NO2        PIC  X(003).
000900 01  W-FID1.
000910     02  W-FID11        PIC  X(006) VALUE "WK0256".
000920     02  W-FID12        PIC  X(003).
000930 01  W-FID2.
000940     02  W-FID21        PIC  X(006) VALUE "WK0512".
000950     02  W-FID22        PIC  X(003).
000960 01  W-DATA.
000970     02  W-SEN          PIC  9(001).
000980     02  W-DMM          PIC  9(001).
000990     02  W-ZC           PIC  9(001).
001000     02  CNT            PIC  9(002).
001010 01  ERR-STAT           PIC  X(002).
001020     COPY LSTAT.
001030 SCREEN SECTION.
001040 SD  C-CRT
001050     END STATUS IS ESTAT.
001060 01  C-CLEAR.
001070     02  C-CL    LINE   1  CLEAR SCREEN.
001080 01  C-MID.
001090     02  LINE   3  COLUMN  10  PIC N(024) VALUE
001100          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001110     02  LINE   4  COLUMN  10  PIC N(024) VALUE
001120          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001130     02  LINE   5  COLUMN  10  PIC N(024) VALUE
001140          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
001150     02  LINE   6  COLUMN  10  PIC N(024) VALUE
001160          NC"＊＊＊　　品名サイズ別棚卸ワーク　作成　　＊＊＊".
001170     02  LINE   7  COLUMN  10  PIC N(024) VALUE
001180          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
001190     02  LINE   8  COLUMN  10  PIC N(024) VALUE
001200          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001210     02  LINE   9  COLUMN  10  PIC N(024) VALUE
001220          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001230     02  LINE  15  COLUMN  22  PIC X(024) VALUE
001240            "子ｺｰﾄﾞ=0 , 親ｺｰﾄﾞ=1 ... ".
001250     02  LINE  20  COLUMN  24  PIC X(022) VALUE
001260            "確認  OK=1 NO=9   ﾘﾀｰﾝ".
001270 01  C-ACP.
001280     02  A-SEN   LINE  15  COLUMN  45  PIC  9(001)
001290          USING W-SEN   CHECK OVERFLOW NO IFC.
001300     02  A-DMM   LINE  20  COLUMN  41  PIC  9(001)
001310          USING W-DMM   CHECK OVERFLOW NO IFC.
001320 01  C-ERR.
001330     02  LINE  24.
001340       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
001350            "***  DATA ｴﾗｰ  ***".
001360       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001370       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001380       03  E-CL    COLUMN  10  PIC  X(050) VALUE
001390            "                                                  ".
001400 PROCEDURE DIVISION.
001410 M-05.
001420     DISPLAY C-CLEAR.
001430     DISPLAY C-MID.
001440 M-10.
001450     ACCEPT A-SEN.
001460     IF ESTAT = PF9
001470         MOVE 255 TO COMPLETION-CODE
001480         STOP RUN.
001490     IF ESTAT NOT = HTB AND SKP
001500         GO TO M-10.
001510     IF W-SEN > 1
001520         GO TO M-10.
001530 M-15.
001540     ACCEPT A-DMM.
001550     IF ESTAT = PF9
001560         MOVE 255 TO COMPLETION-CODE
001570         STOP RUN.
001580     IF ESTAT = BTB
001590         GO TO M-10.
001600     IF ESTAT NOT = HTB AND SKP
001610         GO TO M-15.
001620     IF W-DMM = 9
001630         MOVE 255 TO COMPLETION-CODE
001640         STOP RUN.
001650     IF W-DMM NOT = 1
001660         GO TO M-15.
001670*
001680     CALL "CBLSTNNO" USING STN-NO.
001690     MOVE STN-NO2 TO W-FID12 W-FID22.
001700     MOVE W-FID1 TO WK0256ID.
001710     MOVE W-FID2 TO WK0512ID.
001720     OPEN INPUT HHTF.
001730     OPEN OUTPUT HHTW.
001740 M-20.
001750     READ HHTF AT END
001760         MOVE 255 TO COMPLETION-CODE
001770         GO TO M-95.
001780     IF HHT-HCD > 999899
001790         GO TO M-20.
001800 M-25.
001810     PERFORM S-05 THRU S-15.
001820     IF W-SEN = 0
001830         MOVE HHT-HCD TO HHTW-HCD
001840       ELSE
001850         MOVE HHT-MHCD TO HHTW-HCD.
001860     MOVE HHT-SIZ TO HHTW-SIZ.
001870     MOVE W-SEN TO HHTW-SEN.
001880 M-30.
001890     PERFORM S-20 THRU S-30.
001900 M-35.
001910     READ HHTF AT END
001920         GO TO M-80.
001930     IF HHT-HCD > 999899
001940         GO TO M-35.
001950     IF W-SEN = 1
001960         IF HHT-MHCD = HHTW-HCD
001970             IF HHT-SIZ = HHTW-SIZ
001980                 GO TO M-30.
001990     PERFORM S-35 THRU S-45.
002000     IF W-ZC = 1
002010         WRITE HHTW-R.
002020     GO TO M-25.
002030 M-80.
002040     PERFORM S-35 THRU S-45.
002050     IF W-ZC = 1
002060         WRITE HHTW-R.
002070 M-95.
002080     CLOSE HHTF.
002090     CLOSE HHTW.
002100     DISPLAY C-CLEAR.
002110     STOP RUN.
002120 S-05.
002130     MOVE ZERO TO HHTW-R CNT.
002140 S-10.
002150     ADD 1 TO CNT.
002160     IF CNT NOT = 11
002170         MOVE ZERO TO HHTW-ZSU(CNT) HHTW-NSU(CNT) HHTW-USU(CNT)
002180                      HHTW-ASS(CNT) HHTW-TZS(CNT) HHTW-TSU(CNT)
002190         GO TO S-10.
002200 S-15.
002210     EXIT.
002220 S-20.
002230     MOVE ZERO TO CNT.
002240 S-25.
002250     ADD 1 TO CNT.
002260     IF CNT NOT = 11
002270         ADD HHT-ZSU(CNT) TO HHTW-ZSU(CNT)
002280         ADD HHT-NSU(CNT) TO HHTW-NSU(CNT)
002290         ADD HHT-USU(CNT) TO HHTW-USU(CNT)
002300         ADD HHT-ASS(CNT) TO HHTW-ASS(CNT)
002310         ADD HHT-TZS(CNT) TO HHTW-TZS(CNT)
002320         ADD HHT-TSU(CNT) TO HHTW-TSU(CNT)
002330         GO TO S-25.
002340 S-30.
002350     EXIT.
002360 S-35.
002370     MOVE ZERO TO W-ZC CNT.
002380 S-40.
002390     ADD 1 TO CNT.
002400     IF CNT = 11
002410         GO TO S-45.
002420     IF ZERO = HHTW-ZSU(CNT) AND HHTW-NSU(CNT) AND HHTW-USU(CNT)
002430           AND HHTW-ASS(CNT) AND HHTW-TZS(CNT) AND HHTW-TSU(CNT)
002440         GO TO S-40.
002450     MOVE 1 TO W-ZC.
002460 S-45.
002470     EXIT.
