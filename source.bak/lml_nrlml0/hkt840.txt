000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         HKT840.
000030**************************************************************
000040*    PROGRAM         :  担当別売上･粗利前年対比ワーク作成    *
000050*    PRINTER TYPE    :  JIPS                                 *
000060*    SCREEN          :  ______                               *
000070*    COMPILE TYPE    :  COBOL                                *
000080**************************************************************
000090 ENVIRONMENT         DIVISION.
000100 CONFIGURATION       SECTION.
000110 SOURCE-COMPUTER.    SYSTEM3100.
000120 OBJECT-COMPUTER.    SYSTEM3100.
000130 INPUT-OUTPUT        SECTION.
000140 FILE-CONTROL.
000150     SELECT THY-M ASSIGN TO THY-MSD.
000160     SELECT WTHY-M ASSIGN TO WTHY-MSD.
000170 DATA                DIVISION.
000180 FILE                SECTION.
000190 FD  THY-M
000200     BLOCK  1 RECORDS
000210     LABEL RECORD IS STANDARD
000220     VALUE OF IDENTIFICATION IS "WK0512".
000230 01  TH-R.
000240     02  TH-KEY         PIC  9(004).
000250     02  TH-IKC         PIC  9(001).
000260     02  TH-UD.
000270       03  TH-U     OCCURS  24.
000280         04  TH-UKD     PIC S9(009).
000290       03  TH-TU.
000300         04  TH-AOTU    PIC S9(010).
000310         04  TH-ANTU    PIC S9(010).
000320     02  TH-AD.
000330       03  TH-A     OCCURS  24.
000340         04  TH-AKD     PIC S9(009).
000350       03  TH-TA.
000360         04  TH-AOTA    PIC S9(010).
000370         04  TH-ANTA    PIC S9(010).
000380     02  TH-NG.
000390       03  TH-N         PIC  9(004).
000400       03  TH-G         PIC  9(002).
000410     02  TH-TC.
000420       03  TH-TC1       PIC  9(001).
000430       03  TH-TC2       PIC  9(001).
000440     02  TH-BC          PIC  9(001).
000450     02  F              PIC  X(025).
000460     02  TH-SEN         PIC  9(001).
000470 FD  WTHY-M
000480     BLOCK  1 RECORDS
000490     LABEL RECORD IS STANDARD
000500     VALUE OF IDENTIFICATION IS WK0512ID.
000510 01  WTH-R.
000520     02  WTH-KEY        PIC  9(004).
000530     02  WTH-IKC        PIC  9(001).
000540     02  WTH-UD.
000550       03  WTH-U     OCCURS  24.
000560         04  WTH-UKD    PIC S9(009).
000570       03  WTH-TU.
000580         04  WTH-AOTU   PIC S9(010).
000590         04  WTH-ANTU   PIC S9(010).
000600     02  WTH-AD.
000610       03  WTH-A     OCCURS  24.
000620         04  WTH-AKD    PIC S9(009).
000630       03  WTH-TA.
000640         04  WTH-AOTA   PIC S9(010).
000650         04  WTH-ANTA   PIC S9(010).
000660     02  WTH-NG.
000670       03  WTH-N        PIC  9(004).
000680       03  WTH-G        PIC  9(002).
000690     02  WTH-TC.
000700       03  WTH-TC1      PIC  9(001).
000710       03  WTH-TC2      PIC  9(001).
000720     02  WTH-BC         PIC  9(001).
000730     02  F              PIC  X(025).
000740     02  WTH-SEN        PIC  9(001).
000750 WORKING-STORAGE     SECTION.
000760 77  WK0512ID           PIC  X(009) VALUE SPACE.
000770 01  STN-NO.
000780     02  STN-NO1        PIC  X(003).
000790     02  STN-NO2        PIC  X(003).
000800 01  W-FID.
000810     02  W-FID1         PIC  X(006) VALUE "WK0512".
000820     02  W-FID2         PIC  X(003).
000830 01  W-DATA.
000840     02  W-TC1          PIC  9(001).
000850     02  CNT            PIC  9(002).
000860 01  ERR-STAT           PIC  X(002).
000870 SCREEN              SECTION.
000880 SD  C-CRT
000890     END  STATUS  IS  ESTAT.
000900 01  C-CLEAR.
000910     02  C-CL    LINE   1  CLEAR SCREEN.
000920 01  C-MID.
000930     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
000940          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000950     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
000960          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000970     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
000980          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
000990     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
001000          NC"＊＊＊　　担当売上粗利前年対比ワーク作成　　＊＊＊".
001010     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
001020          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
001030     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
001040          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001050     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
001060          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001070 01  C-ERR.
001080     02  LINE  24.
001090       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
001100             "***  ﾃﾞｰﾀ ﾅｼ  ***".
001110       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001120       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001130       03  E-CL    COLUMN  10  PIC  X(050) VALUE
001140            "                                                  ".
001150 PROCEDURE           DIVISION.
001160 M-05.
001170     DISPLAY C-CLEAR.
001180     DISPLAY C-MID.
001190*
001200     CALL "CBLSTNNO" USING STN-NO.
001210     MOVE STN-NO2 TO W-FID2.
001220     MOVE W-FID TO WK0512ID.
001230     OPEN INPUT THY-M.
001240     OPEN OUTPUT WTHY-M.
001250*
001260     READ THY-M AT END
001270         MOVE 255 TO COMPLETION-CODE
001280         DISPLAY E-ME1 E-ME99
001290         GO TO M-90.
001300 M-10.
001310     MOVE TH-TC1 TO W-TC1.
001320     INITIALIZE WTH-R.
001330     MOVE TH-R TO WTH-R.
001340 M-25.
001350     READ THY-M AT END
001360         GO TO M-85.
001370     IF TH-TC1 = W-TC1
001380         GO TO M-30.
001390     WRITE WTH-R.
001400     GO TO M-10.
001410 M-30.
001420     ADD TH-AOTU TO WTH-AOTU.
001430     ADD TH-ANTU TO WTH-ANTU.
001440     ADD TH-AOTA TO WTH-AOTA.
001450     ADD TH-ANTA TO WTH-ANTA.
001460     MOVE ZERO TO CNT.
001470 M-35.
001480     ADD 1 TO CNT.
001490     IF CNT < 25
001500         ADD TH-UKD(CNT) TO WTH-UKD(CNT)
001510         ADD TH-AKD(CNT) TO WTH-AKD(CNT)
001520         GO TO M-35.
001530     GO TO M-25.
001540 M-85.
001550     WRITE WTH-R.
001560 M-90.
001570     CLOSE THY-M.
001580     CLOSE WTHY-M.
001590 M-95.
001600     DISPLAY C-CLEAR.
001610     STOP RUN.
