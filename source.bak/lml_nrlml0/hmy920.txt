000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMY920.
000030**************************************************************
000040*    PROGRAM         :  履物年間サイズ別受払表　ワークＦ作成 *
000050*    PRINTER TYPE    :  JIPS                                 *
000060*    SCREEN          :  ******                               *
000070*    COMPILE TYPE    :  COBOL                                *
000080**************************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM7200.
000120 OBJECT-COMPUTER. SYSTEM7200.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT HHTYW  ASSIGN TO HHTYW-MSD.
000160     SELECT HHTY ASSIGN TO HHTY-MSD.
000170 DATA DIVISION.
000180 FILE SECTION.
000190 FD  HHTYW
000200     BLOCK  1 RECORDS
000210     LABEL RECORD IS STANDARD
000220     VALUE OF IDENTIFICATION WK0512ID.
000230 01  HHTYW-R.
000240     02  HHTYW-KEY.
000250       03  HHTYW-HCD    PIC  9(006).
000260       03  HHTYW-SIZ    PIC  9(001).
000270     02  HHTYW-AZSU.                                                前月残
000280       03  HHTYW-ZSUD  OCCURS  10.
000290         04  HHTYW-ZSU  PIC S9(006).
000300     02  HHTYW-ANSU.                                                入庫数
000310       03  HHTYW-NSUD  OCCURS  10.
000320         04  HHTYW-NSU  PIC S9(006).
000330     02  HHTYW-AUSU.                                                出庫数
000340       03  HHTYW-USUD  OCCURS  10.
000350         04  HHTYW-USU  PIC S9(006).
000360     02  HHTYW-AYSU.                                                前月残
000370       03  HHTYW-YSUD  OCCURS  10.
000380         04  HHTYW-YSU  PIC S9(006).
000390     02  HHTYW-SNG      PIC  9(006).
000400     02  HHTYW-ENG      PIC  9(006).
000410     02  HHTYW-BC.
000420       03  HHTYW-BC1    PIC  9(002).
000430       03  HHTYW-BC2    PIC  9(002).
000440       03  HHTYW-BC3    PIC  9(002).
000450     02  HHTYW-BMNO     PIC  9(001).
000460     02  HHTYW-NG       PIC  9(006).
000470     02  F              PIC  X(240).
000480 FD  HHTY
000490     BLOCK  1 RECORDS
000500     LABEL RECORD IS STANDARD
000510     VALUE OF IDENTIFICATION WK0768ID.
000520 01  HHTY-R.
000530     02  HHTY-KEY.
000540       03  HHTY-HCD     PIC  9(006).
000550       03  HHTY-SIZ     PIC  9(001).
000560     02  HHTY-AZSU.                                                 前月残
000570       03  HHTY-ZSUD  OCCURS  10.
000580         04  HHTY-ZSU   PIC S9(006)  COMP-3.
000590     02  HHTY-ANSU.                                                 入庫数
000600       03  HHTY-NSUD  OCCURS  10.
000610         04  HHTY-NSU   PIC S9(006)  COMP-3.
000620     02  HHTY-AUSU.                                                 出庫数
000630       03  HHTY-USUD  OCCURS  10.
000640         04  HHTY-USU   PIC S9(006)  COMP-3.
000650     02  HHTY-AYSU.                                                 前月残
000660       03  HHTY-YSUD  OCCURS  10.
000670         04  HHTY-YSU   PIC S9(006)  COMP-3.
000680     02  HHTY-SNG       PIC  9(006).
000690     02  HHTY-ENG       PIC  9(006).
000700     02  HHTY-BC.
000710       03  HHTY-BC1     PIC  9(002).
000720       03  HHTY-BC2     PIC  9(002).
000730       03  HHTY-BC3     PIC  9(002).
000740     02  HHTY-BMNO      PIC  9(001).
000750     02  F              PIC  X(070).
000760     02  F              PIC  X(512).
000770 WORKING-STORAGE SECTION.
000780 01  ERR-STAT           PIC  X(002).
000790 77  WK0512ID           PIC  X(009) VALUE SPACE.
000800 77  WK0768ID           PIC  X(009) VALUE SPACE.
000810 01  STN-NO.
000820     02  STN-NO1        PIC  X(003).
000830     02  STN-NO2        PIC  X(003).
000840 01  W-FID1.
000850     02  W-FID11        PIC  X(006) VALUE "WK0512".
000860     02  W-FID12        PIC  X(003).
000870 01  W-FID2.
000880     02  W-FID21        PIC  X(006) VALUE "WK0768".
000890     02  W-FID22        PIC  X(003).
000900 01  W-DATA.
000910     02  CNT            PIC  9(002).
000920     02  W-C            PIC  9(002).
000930     02  W-ZC           PIC  9(001).
000940 SCREEN SECTION.
000950 SD  C-CRT
000960     END STATUS IS ESTAT.
000970 01  C-CLEAR.
000980     02  LINE  1  CLEAR SCREEN.
000990 01  C-MID.
001000     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
001010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001020     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
001030          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001040     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
001050          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
001060     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
001070          NC"＊＊＊　　履物年間サイズ別受払ワーク作成　　＊＊＊".
001080     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
001090          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
001100     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
001110          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001120     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
001130          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001140 01  C-ERR.
001150     02  LINE  24.
001160       03  E-ME3   COLUMN  15  PIC  X(017) VALUE
001170            "***  DATA ﾅｼ  ***".
001180       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001190       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001200 PROCEDURE DIVISION.
001210 M-05.
001220     DISPLAY C-CLEAR.
001230     DISPLAY C-MID.
001240     CALL "CBLSTNNO" USING STN-NO.
001250     MOVE STN-NO2 TO W-FID12 W-FID22.
001260     MOVE W-FID1 TO WK0512ID.
001270     MOVE W-FID2 TO WK0768ID.
001280     OPEN INPUT HHTYW.
001290     OPEN OUTPUT HHTY.
001300*
001310     READ HHTYW AT END
001320         MOVE 255 TO COMPLETION-CODE
001330         DISPLAY E-ME3 E-ME99
001340         GO TO M-90.
001350 M-10.
001360     INITIALIZE HHTY-R.
001370     MOVE HHTYW-KEY TO HHTY-KEY.
001380     MOVE HHTYW-SNG TO HHTY-SNG.
001390     MOVE HHTYW-ENG TO HHTY-ENG.
001400     MOVE HHTYW-BC TO HHTY-BC.
001410     MOVE HHTYW-BMNO TO HHTY-BMNO.
001420 M-15.
001430     MOVE ZERO TO CNT.
001440 M-20.
001450     ADD 1 TO CNT.
001460     IF CNT NOT = 11
001470         ADD HHTYW-ZSU(CNT) TO HHTY-ZSU(CNT)
001480         ADD HHTYW-NSU(CNT) TO HHTY-NSU(CNT)
001490         ADD HHTYW-USU(CNT) TO HHTY-USU(CNT)
001500         ADD HHTYW-YSU(CNT) TO HHTY-YSU(CNT)
001510         GO TO M-20.
001520*
001530     READ HHTYW AT END
001540         GO TO M-80.
001550     IF HHTYW-KEY = HHTY-KEY
001560         GO TO M-15.
001570*
001580     PERFORM CHK-RTN THRU CHK-EX.
001590     IF W-ZC NOT = 0
001600         WRITE HHTY-R.
001610     GO TO M-10.
001620 M-80.
001630     PERFORM CHK-RTN THRU CHK-EX.
001640     IF W-ZC NOT = 0
001650         WRITE HHTY-R.
001660 M-90.
001670     CLOSE HHTY.
001680     CLOSE HHTYW.
001690 M-95.
001700     DISPLAY C-CLEAR.
001710     STOP RUN.
001720 CHK-RTN.
001730     MOVE ZERO TO W-ZC W-C.
001740 CHK-10.
001750     ADD 1 TO W-C.
001760     IF W-C = 11
001770         GO TO CHK-EX.
001780     IF HHTY-ZSU(W-C) NOT = ZERO
001790         MOVE 1 TO W-ZC
001800         GO TO CHK-EX.
001810     IF HHTY-NSU(W-C) NOT = ZERO
001820         MOVE 1 TO W-ZC
001830         GO TO CHK-EX.
001840     IF HHTY-USU(W-C) NOT = ZERO
001850         MOVE 1 TO W-ZC
001860         GO TO CHK-EX.
001870     IF HHTY-YSU(W-C) NOT = ZERO
001880         MOVE 1 TO W-ZC
001890         GO TO CHK-EX.
001900     GO TO CHK-10.
001910 CHK-EX.
001920     EXIT.
