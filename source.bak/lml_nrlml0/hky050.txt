000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HMY050.
000030*********************************************************
000040*    PROGRAM         :  得意先台帳発行                  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    BASE PROGRAM    :  HMD230                          *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT DTWF ASSIGN TO DTW-MSD.
000180     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000190         ORGANIZATION IS INDEXED
000200         ACCESS MODE IS RANDOM
000210         RECORD KEY IS T-KEY
000220         ALTERNATE  RECORD KEY IS T-KEY2
000230         FILE STATUS IS ERR-STAT.
000240     SELECT HKBM ASSIGN TO HKB-MSD
000250         ORGANIZATION INDEXED
000260         RECORD KEY HKB-KEY
000270         ACCESS MODE RANDOM
000280         FILE STATUS IS ERR-STAT.
000290     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000300         ORGANIZATION IS INDEXED
000310         ACCESS MODE IS RANDOM
000320         RECORD KEY IS HI-KEY
000330         ALTERNATE RECORD KEY IS HI-KEY2
000340         FILE STATUS IS ERR-STAT.
000350     SELECT TC-M ASSIGN TO TC-MSD
000360         ORGANIZATION INDEXED
000370         RECORD KEY TC-KEY
000380         ACCESS MODE RANDOM
000390         FILE STATUS IS ERR-STAT.
000400     SELECT KH-M ASSIGN TO KH-MSD
000410         ORGANIZATION INDEXED
000420         RECORD KEY KH-KEY
000430         ACCESS MODE RANDOM
000440         FILE STATUS IS ERR-STAT.
000450     SELECT J-M ASSIGN TO J-MSD
000460         ORGANIZATION INDEXED
000470         RECORD KEY J-KEY
000480         ACCESS MODE RANDOM
000490         FILE STATUS IS ERR-STAT.
000500     SELECT SP-F ASSIGN TO P-PRN999.
000510 I-O-CONTROL.
000520     APPLY SHARED-MODE ON M-DATE
000530     APPLY SHARED-MODE ON HI-M TC-M KH-M J-M
000540     APPLY SHARED-MODE ON T-M HKBM
000550     APPLY SHIFT-CODE  ON SP-F.
000560 DATA DIVISION.
000570 FILE SECTION.
000580     COPY LIBFDD.
000590     COPY LIHIM.
000600     COPY LITM.
000610     COPY LIHKBM.
000620     COPY LITCM.
000630     COPY LIKHM.
000640     COPY LIJM.
000650     COPY LSPF.
000660 FD  DTWF
000670     BLOCK  1 RECORDS
000680     LABEL RECORD STANDARD
000690     VALUE OF IDENTIFICATION IS WK0256ID.
000700 01  DTW-R.
000710     02  DTW-D1.
000720       03  DT1-BMC      PIC  9(001).
000730       03  DT1-UNC      PIC  9(001).
000740       03  DT1-DNO      PIC  9(006).
000750       03  DT1-GNO      PIC  9(001).
000760       03  DT1-NGP      PIC  9(008).
000770       03  DT1-NGPD  REDEFINES DT1-NGP.
000780         04  F          PIC  9(002).
000790         04  DT1-DATE   PIC  9(006).
000800       03  DT1-NGPL  REDEFINES DT1-NGP.
000810         04  DT1-NG     PIC  9(006).
000820         04  F          PIC  9(002).
000830       03  DT1-TCD      PIC  9(004).
000840       03  DT1-HCD      PIC  9(006).
000850       03  DT1-HCDD  REDEFINES  DT1-HCD.
000860         04  DT1-KCD    PIC  X(005).
000870         04  F          PIC  X(001).
000880       03  DT1-SUT      PIC S9(006)V9(02).
000890       03  DT1-T        PIC S9(006)V9(02).
000900*****  03  DT1-KIN      PIC S9(008).                              D.110919
000910       03  DT1-KIN      PIC S9(009).                              I.110919
000920       03  DT1-CSC      PIC  9(001).
000930       03  DT1-DC       PIC  9(001).
000940       03  DT1-BKC      PIC  9(002).
000950       03  DT1-BMNO     PIC  9(001).
000960       03  DT1-FT       PIC  9(006)V9(02).
000970       03  DT1-SHZ      PIC S9(007).                              I.110919
000980*****  03  F            PIC  X(010).                              D.110919
000990       03  DT1-SIZ      PIC  9(001).
001000       03  DT1-ASU.
001010         04  DT1-SUD   OCCURS 10.
001020           05  DT1-SU   PIC S9(004).
001030       03  DT1-CCD      PIC  9(003).
001040       03  DT1-BC       PIC  9(006).
001050       03  DT1-SKC      PIC  9(001).
001060       03  DT1-TNC      PIC  9(002).
001070       03  F            PIC  X(002).
001080       03  DT1-HSC      PIC  9(001).
001090       03  DT1-KOSU     PIC  9(003).
001100       03  DT1-FRC      PIC  9(001).
001110       03  DT1-TCD2     PIC  9(004).
001120       03  DT1-BIK      PIC  X(010).
001130       03  DT1-USC      PIC  9(001).
001140       03  DT1-SNC      PIC  9(001).
001150*****  03  F            PIC  X(010).                              D.110919
001160       03  DT1-HYC      PIC  9(001).
001170       03  DT1-YC       PIC  9(002).
001180       03  DT1-SGP      PIC  9(004).
001190       03  DT1-NNO      PIC  9(006).
001200       03  DT1-JCD      PIC  9(006).
001210       03  DT1-TEKI     PIC  N(018).
001220*****  03  F            PIC  X(010).                              D.110919
001230       03  DT1-NKC      PIC  9(002).
001240       03  DT1-NKCD  REDEFINES  DT1-NKC.
001250         04  DT1-NKC1   PIC  9(001).
001260         04  DT1-NKC2   PIC  9(001).
001270       03  DT1-SSC      PIC  9(001).
001280       03  F            PIC  9(002).
001290       03  DT1-TKG      PIC  9(006).
001300       03  F            PIC  9(002).
001310       03  DT1-SKNG     PIC  9(004).
001320       03  DT1-DCC      PIC  9(001).
001330       03  DT1-SNGP.                                              I.110919
001340         04  DT1-SNEN   PIC  9(002).                              I.110919
001350         04  DT1-SGET   PIC  9(002).                              I.110919
001360         04  DT1-SPEY   PIC  9(002).                              I.110919
001370       03  F            PIC  X(019).                              I.110919
001380*****  03  F            PIC  X(003).                              D.110919
001390       03  DT1-EC       PIC  9(001).
001400*****  03  DT1-SKU      PIC  9(008).                              D.110919
001410       03  F            PIC  9(002).                              I.110919
001420       03  DT1-SKU      PIC  9(006).                              I.110919
001430       03  DT1-PC       PIC  9(001).
001440     02  DTW-D2   REDEFINES  DTW-D1.
001450       03  DT2-BMC      PIC  9(001).
001460       03  DT2-UNC      PIC  9(001).
001470       03  DT2-DNO      PIC  9(006).
001480       03  DT2-GNO      PIC  9(001).
001490       03  DT2-DATE     PIC  9(008).
001500       03  DT2-TCD      PIC  9(004).
001510       03  DT2-BI       PIC  N(024).
001520       03  DT2-HNO      PIC  9(006).
001530       03  F            PIC  X(028).
001540       03  DT2-TAX      PIC S9(007).
001550       03  F            PIC  X(029).
001560       03  DT2-SNC      PIC  9(001).
001570       03  F            PIC  X(106).
001580       03  DT2-EC       PIC  9(001).
001590       03  F            PIC  X(008).
001600       03  DT2-PC       PIC  9(001).
001610 WORKING-STORAGE  SECTION.
001620 77  WK0256ID           PIC  X(009) VALUE SPACE.
001630 01  STN-NO.
001640     02  STN-NO1        PIC  X(003).
001650     02  STN-NO2        PIC  X(003).
001660 01  W-FID.
001670     02  W-FID1         PIC  X(006) VALUE "WK0256".
001680     02  W-FID2         PIC  X(003).
001690 77  W-DCHK             PIC  9(001).
001700 77  W-DZC              PIC  9(001) VALUE 0.
001710 77  W-FILE             PIC  X(013).
001720 77  W-KSU              PIC  9(005).                              I.150706
001730 01  HEAD01.                                                      I.110926
001740     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".         I.110926
001750     02  F              PIC  X(049) VALUE SPACE.                  I.110926
001760     02  W-30K          PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.110926
001770     02  F              PIC  N(008) VALUE NC"得意先元帳総括票".   I.110926
001780     02  W-35K          PIC  X(008) VALUE ""3F504F40674F40A0"".   I.110926
001790     02  F              PIC  X(025) VALUE SPACE.                  I.110926
001800     02  F              PIC  N(002) VALUE NC"　№".               I.110926
001810     02  F              PIC  X(001) VALUE SPACE.                  I.110926
001820     02  P-DNO          PIC  N(004).                              I.110926
001830 01  HEAD02.                                                      I.110926
001840     02  F              PIC  X(013) VALUE SPACE.                  I.110926
001850     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".                 I.110926
001860     02  F              PIC  X(011) VALUE SPACE.                  I.110926
001870     02  F              PIC  N(010) VALUE                         I.110926
001880          NC"得　　意　　先　　名".                               I.110926
001890     02  F              PIC  X(065) VALUE SPACE.                  I.110926
001900 01  HEAD08.                                                      I.110926
001910     02  F              PIC  X(016) VALUE SPACE.                  I.110926
001920     02  F              PIC  N(004) VALUE NC"日　　付".           I.110926
001930     02  F              PIC  X(010) VALUE SPACE.                  I.110926
001940     02  F              PIC  N(004) VALUE NC"売　　上".           I.110926
001950     02  F              PIC  X(005) VALUE SPACE.                  I.110926
001960     02  F              PIC  N(004) VALUE NC"　消費税".           I.110926
001970     02  F              PIC  X(007) VALUE SPACE.                  I.110926
001980     02  F              PIC  N(004) VALUE NC"入　　金".           I.110926
001990     02  F              PIC  X(007) VALUE SPACE.                  I.110926
002000     02  F              PIC  N(004) VALUE NC"売掛残高".           I.110926
002010     02  F              PIC  X(002) VALUE SPACE.                  I.110926
002020     02  F              PIC  N(006) VALUE NC"　消費税残高".       I.110926
002030     02  F              PIC  X(007) VALUE SPACE.                  I.110926
002040     02  F              PIC  N(004) VALUE NC"残高合計".           I.110926
002050     02  F              PIC  X(003) VALUE SPACE.                  I.110926
002060     02  F              PIC  N(004) VALUE NC"備　考　".           I.110926
002070 01  W-P01.                                                       I.110926
002080     02  F              PIC  X(062).                              I.110926
002090     02  P-UM           PIC  N(002).                              I.110926
002100     02  P-UNO          PIC  X(008).                              I.110926
002110     02  F              PIC  X(001).                              I.110926
002120     02  P-JSU          PIC  N(020).                              I.110926
002130     02  F              PIC  X(004).                              I.110926
002140 01  W-P02.                                                       I.110926
002150     02  F              PIC  X(013).                              I.110926
002160     02  P-TCD          PIC  9(004).                              I.110926
002170     02  F              PIC  X(002).                              I.110926
002180     02  P-NAME         PIC  N(026).                              I.110926
002190     02  F              PIC  X(020).                              I.110926
002200     02  P-JSS          PIC  N(020).                              I.110926
002210 01  W-P03.                                                       I.110926
002220     02  F              PIC  X(058).                              I.110926
002230     02  P-F            PIC  X(001).                              I.110926
002240     02  P-BMC          PIC  9(001).                              I.110926
002250     02  P-R            PIC  X(001).                              I.110926
002260     02  F              PIC  X(009).                              I.110926
002270     02  P-TM           PIC  X(003).                              I.110926
002280     02  F              PIC  X(001).                              I.110926
002290     02  P-TEL          PIC  X(014).                              I.110926
002300     02  F              PIC  X(002).                              I.110926
002310     02  P-FM           PIC  X(003).                              I.110926
002320     02  F              PIC  X(001).                              I.110926
002330     02  P-FAX          PIC  X(014).                              I.110926
002340 01  W-P04.                                                       I.110926
002350     02  F              PIC  X(013).                              I.110926
002360     02  P-DNM          PIC  N(008).                              I.110926
002370     02  F              PIC  X(083).                              I.110926
002380 01  W-P05.                                                       I.110926
002390     02  F              PIC  X(013).                              I.110926
002400     02  P-MSM          PIC  N(008).                              I.110926
002410     02  P-UK           PIC -----,---,---.                        I.110926
002420     02  P-UKZ          PIC ---,---,---.                          I.110926
002430     02  P-NK           PIC -----,---,---.                        I.110926
002440     02  P-UZ           PIC -----,---,---.                        I.110926
002450     02  P-UZZ          PIC ---,---,---.                          I.110926
002460     02  P-UZG          PIC -----,---,---.                        I.110926
002470     02  F              PIC  X(009).                              I.110926
002480 01  HEAD1.
002490     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
002500     02  F              PIC  X(038) VALUE SPACE.
002510     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".
002520     02  F              PIC  N(014) VALUE
002530          NC"【　得　意　先　台　帳　】　".
002540     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
002550     02  F              PIC  X(019) VALUE SPACE.
002560     02  F              PIC  X(005) VALUE "DATE ".
002570     02  H-DATE         PIC 99/99/99.
002580     02  F              PIC  X(007) VALUE "     P.".
002590     02  H-PAGE         PIC ZZ9.
002600 01  HEAD2.
002610     02  F              PIC  X(005) VALUE ""3FE04F40A0"".
002620     02  F              PIC  X(005) VALUE "ｺｰﾄﾞ ".
002630     02  H-TCD          PIC  9(004).
002640     02  F              PIC  X(001) VALUE SPACE.
002650     02  F              PIC  N(004) VALUE NC"得意先名".
002660     02  F              PIC  X(001) VALUE SPACE.
002670     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".
002680     02  H-TNA          PIC  N(026).
002690     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".
002700     02  F              PIC  X(041) VALUE SPACE.
002710 01  HEAD3H.
002720     02  F              PIC  X(002) VALUE SPACE.
002730     02  F              PIC  N(004) VALUE NC"日　付　".
002740     02  F              PIC  X(002) VALUE SPACE.
002750     02  F              PIC  N(004) VALUE NC"伝票区分".
002760     02  F              PIC  X(008) VALUE SPACE.
002770     02  F              PIC  X(001) VALUE "(".
002780     02  F              PIC  N(004) VALUE NC"伝票№　".
002790     02  F              PIC  X(001) VALUE ")".
002800     02  F              PIC  X(018) VALUE SPACE.
002810     02  F              PIC  X(051) VALUE
002820          "1             SS    S    M    L   LL 28.0 29.0 30.0".
002830     02  F              PIC  X(025) VALUE SPACE.
002840     02  F              PIC  N(006) VALUE NC"請求予定日　".
002850     02  F              PIC  X(001) VALUE SPACE.
002860 01  HEAD4H.
002870     02  F              PIC  X(007) VALUE SPACE.
002880     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".
002890     02  F              PIC  X(002) VALUE SPACE.
002900     02  F              PIC  N(008) VALUE NC"品　　　　　名　".
002910     02  F              PIC  X(025) VALUE SPACE.
002920     02  F              PIC  X(051) VALUE
002930          "2 12.5 13.0 13.5 14.0 15.0 16.0 17.0 18.0 19.0 20.0".
002940     02  F              PIC  X(035) VALUE SPACE.
002950 01  HEAD5H.
002960     02  F              PIC  X(050) VALUE SPACE.
002970     02  F              PIC  X(051) VALUE
002980          "3 21.0 21.5 22.0 22.5 23.0 23.5 24.0 24.5 25.0     ".
002990     02  F              PIC  X(025) VALUE SPACE.
003000     02  F              PIC  N(002) VALUE NC"備考".
003010     02  F              PIC  X(007) VALUE SPACE.
003020 01  HEAD6H.
003030     02  F              PIC  X(032) VALUE SPACE.
003040     02  F              PIC  N(004) VALUE NC"摘　　要".
003050     02  F              PIC  X(012) VALUE SPACE.
003060     02  F              PIC  X(051) VALUE
003070          "4 24.0 24.5 25.0 25.5 26.0 26.5 27.0 27.5          ".
003080     02  F              PIC  X(004) VALUE SPACE.
003090     02  F              PIC  N(002) VALUE NC"数量".
003100     02  F              PIC  X(004) VALUE SPACE.
003110     02  F              PIC  N(002) VALUE NC"単価".
003120     02  F              PIC  X(007) VALUE SPACE.
003130     02  F              PIC  N(002) VALUE NC"金額".
003140     02  F              PIC  X(005) VALUE SPACE.
003150     02  F              PIC  N(004) VALUE NC"　総合計".
003160 01  HEAD3K.
003170     02  F              PIC  X(002) VALUE SPACE.
003180     02  F              PIC  N(004) VALUE NC"日　付　".
003190     02  F              PIC  X(002) VALUE SPACE.
003200     02  F              PIC  N(004) VALUE NC"伝票区分".
003210     02  F              PIC  X(008) VALUE SPACE.
003220     02  F              PIC  X(001) VALUE "(".
003230     02  F              PIC  N(004) VALUE NC"伝票№　".
003240     02  F              PIC  X(001) VALUE ")".
003250     02  F              PIC  X(003) VALUE SPACE.
003260     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".
003270     02  F              PIC  X(001) VALUE SPACE.
003280     02  F              PIC  N(006) VALUE NC"品　　　　名".
003290     02  F              PIC  X(048) VALUE SPACE.
003300     02  F              PIC  N(004) VALUE NC"数　　量".
003310     02  F              PIC  X(005) VALUE SPACE.
003320     02  F              PIC  N(004) VALUE NC"単　　価".
003330     02  F              PIC  X(005) VALUE SPACE.
003340     02  F              PIC  N(004) VALUE NC"金　　額".
003350     02  F              PIC  X(001) VALUE SPACE.
003360     02  F              PIC  N(006) VALUE NC"請求予定日　".
003370     02  F              PIC  X(001) VALUE SPACE.
003380 01  HEAD4K.
003390     02  F              PIC  X(060) VALUE SPACE.
003400     02  F              PIC  N(004) VALUE NC"摘　　要".
003410     02  F              PIC  X(064) VALUE SPACE.
003420     02  F              PIC  N(004) VALUE NC"　総合計".
003430 01  W-P1H.
003440     02  PH-15K1        PIC  X(005).
003450     02  PH-NGP         PIC 99/99/99.
003460     02  F              PIC  X(002).
003470     02  PH-DC          PIC  9(001).
003480     02  PH-CSC         PIC  9(001).
003490     02  PH-FRC         PIC  X(001).
003500     02  PH-DCM         PIC  N(002).
003510     02  F              PIC  X(001).
003520     02  PH-DCD         PIC  N(004).
003530     02  F              PIC  X(001).
003540     02  PH-F           PIC  X(001).
003550     02  PH-DNO         PIC  9(006).
003560     02  PH-R           PIC  X(001).
003570     02  F              PIC  X(094).
003580     02  PH-MNGP        PIC 99/99/99.
003590     02  F              PIC  X(002).
003600 01  W-P2H.
003610     02  PH-15K2        PIC  X(005).
003620     02  F              PIC  X(006).
003630     02  PH-HCD         PIC  9(006).
003640     02  F              PIC  X(001).
003650     02  PH-HNA         PIC  N(024).
003660     02  F              PIC  X(001).
003670     02  PH-SIZ         PIC  Z(001).
003680     02  PH-20K2        PIC  X(005).
003690     02  PH-SUD.
003700       03  PH-SU    OCCURS  10  PIC  -(005).
003710     02  PH-SUT         PIC ---,---.
003720     02  PH-T           PIC ---,---.
003730     02  PH-KIN         PIC --,---,---.
003740     02  PH-KIND  REDEFINES PH-KIN.
003750       03  PH-MSM       PIC  N(005).
003760     02  F              PIC  X(001).
003770     02  PH-BIK         PIC  X(010).
003780 01  W-P3H.
003790     02  PH-15K3        PIC  X(005).
003800     02  F              PIC  X(007).
003810     02  PH-KOSU        PIC  N(004).
003820     02  PH-KO          PIC  N(002).
003830     02  F              PIC  X(004).
003840     02  PH-CNAM        PIC  N(032).
003850     02  PH-BID   REDEFINES PH-CNAM.
003860       03  F            PIC  N(008).
003870       03  PH-BI        PIC  N(024).
003880     02  F              PIC  X(004).
003890     02  PH-NOM         PIC  N(006).
003900     02  F              PIC  X(001).
003910     02  PH-HMN         PIC  9(006).
003920     02  F              PIC  X(007).
003930     02  PH-TME         PIC  N(004).
003940     02  PH-GSUT        PIC ---,---.
003950     02  F              PIC  X(001).
003960     02  PH-SZM         PIC  N(004).
003970     02  PH-GKIN        PIC --,---,---.
003980     02  PH-TKIN        PIC ---,---,---.
003990 01  W-P1K.
004000     02  PK-15K1        PIC  X(005).
004010     02  PK-NGP         PIC 99/99/99.
004020     02  F              PIC  X(002).
004030     02  PK-DC          PIC  9(001).
004040     02  PK-CSC         PIC  9(001).
004050     02  F              PIC  X(001).
004060     02  PK-DCM         PIC  N(002).
004070     02  F              PIC  X(001).
004080     02  PK-DCD         PIC  N(004).
004090     02  F              PIC  X(001).
004100     02  PK-F           PIC  X(001).
004110     02  PK-DNO         PIC  9(006).
004120     02  PK-R           PIC  X(001).
004130     02  F              PIC  X(002).
004140     02  PK-HCD         PIC  X(005).
004150     02  F              PIC  X(001).
004160     02  PK-HNA         PIC  N(024).
004170     02  F              PIC  X(001).
004180     02  PK-JF          PIC  X(001).
004190     02  PK-JCD         PIC  9(006).
004200     02  PK-JR          PIC  X(001).
004210     02  F              PIC  X(007).
004220     02  PK-20K1        PIC  X(005).
004230     02  PK-SUT         PIC ----,--9.99.
004240     02  PK-T           PIC ----,--9.99.
004250     02  PK-KIN         PIC ---,---,--9.
004260     02  PK-KIND  REDEFINES PK-KIN.
004270       03  F            PIC  X(001).
004280       03  PK-MSM       PIC  N(005).
004290     02  F              PIC  X(001).
004300     02  PK-MNGP        PIC 99/99/99.
004310     02  F              PIC  X(002).
004320 01  W-P2K.
004330     02  PK-15K2        PIC  X(005).
004340     02  F              PIC  X(060).
004350     02  PK-BI          PIC  N(018).
004360     02  F              PIC  X(014).
004370     02  PK-TME         PIC  N(004).
004380     02  F              PIC  X(001).
004390     02  PK-SZM         PIC  N(004).
004400     02  PK-GKIN        PIC ---,---,--9.
004410     02  PK-TKIN        PIC ---,---,--9.
004420 01  W-P1N.
004430     02  PN-15K1        PIC  X(005).
004440     02  PN-NGP         PIC 99/99/99.
004450     02  F              PIC  X(002).
004460     02  PN-DCM         PIC  N(002).
004470     02  F              PIC  X(001).
004480     02  PN-NKC         PIC  N(006).
004490     02  F              PIC  X(001).
004500     02  PN-F           PIC  X(001).
004510     02  PN-DNO         PIC  9(006).
004520     02  PN-R           PIC  X(001).
004530     02  F              PIC  X(003).
004540     02  PN-TKGM        PIC  N(004).
004550     02  PN-TKGC        PIC  X(001).
004560     02  PN-TKGD        PIC 99/99/99.
004570     02  F              PIC  X(003).
004580     02  PN-KINM        PIC  N(002).
004590     02  PN-KINC        PIC  X(001).
004600     02  PN-KIND        PIC ---,---,--9.
004610     02  F              PIC  X(003).
004620     02  PN-SKBM        PIC  N(004).
004630     02  PN-SKBC        PIC  X(001).
004640     02  PN-SKNG        PIC 99/99.
004650     02  F              PIC  X(012).
004660     02  PN-TME         PIC  N(004).
004670     02  F              PIC  X(008).
004680     02  PN-SZM         PIC  N(004).
004690     02  PN-GKIN        PIC --,---,--9.
004700     02  PN-TKIN        PIC ---,---,--9.
004710 01  W-YOKO.
004720     02  F              PIC  X(136).
004730 01  W-DATA.
004740     02  W-PAGE         PIC  9(003).
004750     02  W-BMC          PIC  9(001).
004760     02  W-TCD          PIC  9(004).
004770     02  W-NG           PIC  9(006).
004780     02  W-UNC          PIC  9(001).
004790     02  W-DNO          PIC  9(006).
004800     02  W-TD.
004810       03  W-ASUT       PIC S9(006).
004820       03  W-AKIN       PIC S9(008).
004830       03  W-SHZ        PIC S9(006).
004840       03  W-TKIN       PIC S9(008).
004850     02  W-D.
004860       03  W-GNO        PIC  9(001).
004870       03  W-ASU.
004880         04  W-SU    OCCURS  10  PIC S9(004).
004890       03  W-SUT        PIC S9(005).
004900       03  W-KIN        PIC S9(008).
004910       03  W-KINZ       PIC S9(007).
004920       03  CNT          PIC  9(002).
004930       03  W-DC         PIC  9(001).
004940       03  W-HSC        PIC  9(001).
004950       03  W-CSC        PIC  9(001).
004960     02  W-NENC         PIC  9(001).
004970     02  W-WARI         PIC  9(003).
004980     02  W-DMM          PIC  9(001).
004990     02  W-CCC          PIC  9(001).
005000     02  W-NAME         PIC  N(024).
005010     02  W-NAMED REDEFINES W-NAME.
005020       03  W-NAD   OCCURS  24.
005030         04  W-NA       PIC  N(001).
005040     02  WK-SUT         PIC S9(006)V9(02).
005050     02  WK-T           PIC S9(006)V9(02).
005060     02  WK-KIN         PIC S9(008).
005070     02  WK-SHZ         PIC S9(007).
005080     02  W-NGP          PIC  9(006).
005090     02  W-NGPD REDEFINES W-NGP.
005100       03  W-NEN        PIC  9(002).
005110       03  W-GET        PIC  9(002).
005120       03  W-PEY        PIC  9(002).
005130     02  W-BIC          PIC  9(001).
005140     02  W-NEND         PIC  9(004).
005150 01  W-SDAT.                                                      I.110926
005160     02  W-SDC          PIC  9(001).                              I.110926
005170     02  W-SNGP         PIC  9(006).                              I.110926
005180     02  WP-D.                                                    I.110926
005190       03  WP-NGP.                                                I.110926
005200         04  WP-NEN     PIC 99.                                   I.110926
005210         04  WP-GET     PIC Z9.                                   I.110926
005220         04  WP-PEY     PIC Z9.                                   I.110926
005230       03  WP-TGP.                                                I.110926
005240         04  WP-TG      PIC Z9.                                   I.110926
005250         04  WP-TP      PIC Z9.                                   I.110926
005260     02  W-DNMD.                                                  I.110926
005270       03  W-DNN        PIC  N(002).                              I.110926
005280       03  F            PIC  N(001) VALUE NC"．".                 I.110926
005290       03  W-DNG        PIC  N(002).                              I.110926
005300       03  F            PIC  N(001) VALUE NC"．".                 I.110926
005310       03  W-DNP        PIC  N(002).                              I.110926
005320     02  W-DNM   REDEFINES W-DNMD  PIC  N(008).                   I.110926
005330     02  W-MSM          PIC  N(008).                              I.110926
005340     02  W-SDNO         PIC  N(004).                              I.110926
005350     02  W-DNOD  REDEFINES W-SDNO.                                I.110926
005360       03  F            PIC  N(001).                              I.110926
005370       03  W-TNC1       PIC  N(001).                              I.110926
005380       03  W-V          PIC  N(001).                              I.110926
005390       03  W-DCC        PIC  N(001).                              I.110926
005400     02  W-NK           PIC S9(009).                              I.110926
005410     02  W-UZ           PIC S9(009).                              I.110926
005420     02  W-UZZ          PIC S9(007).                              I.110926
005430     02  W-UZG          PIC S9(009).                              I.110926
005440     02  W-STD.                                                   I.110926
005450       03  W-TUK        PIC S9(009).                              I.110926
005460       03  W-TUKZ       PIC S9(007).                              I.110926
005470       03  W-TNK        PIC S9(009).                              I.110926
005480     02  SCNT           PIC  9(002) VALUE ZERO.                   I.110926
005490 01  ERR-STAT           PIC  X(002).
005500 01  W-AREA.
005510     02  W-KOSU         PIC ZZZZ.
005520     02  N              PIC  9(002).
005530     02  TBL-NAM        PIC  N(032).
005540     02  TBL-NAMR  REDEFINES TBL-NAM.
005550       03  T-NAM        PIC  N(001)  OCCURS  32.
005560     02  SV-KOSU        PIC  9(003).
005570     02  SV-TCD         PIC  9(004).
005580     02  SV-CCD2        PIC  9(003).
005590     COPY LNAMW.
005600     COPY LSTAT.
005610 SCREEN SECTION.
005620 SD  C-CRT
005630     END STATUS IS ESTAT.
005640 01  C-CLEAR.
005650     02  C-CL    LINE   1  CLEAR SCREEN.
005660 01  C-MID.
005670     02  LINE   2  COLUMN  15  PIC  N(022) VALUE
005680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005690     02  LINE   3  COLUMN  15  PIC  N(022) VALUE
005700          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005710     02  LINE   4  COLUMN  15  PIC  N(022) VALUE
005720          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
005730     02  LINE   5  COLUMN  15  PIC  N(022) VALUE
005740          NC"＊＊＊　　　　得意先台帳　作成　　　　＊＊＊".
005750     02  LINE   6  COLUMN  15  PIC  N(022) VALUE
005760          NC"＊＊＊　　　　　（両面印刷）　　　　　＊＊＊".
005770     02  LINE   7  COLUMN  15  PIC  N(022) VALUE
005780          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005790     02  LINE   8  COLUMN  15  PIC  N(022) VALUE
005800          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
005810     02  LINE  20  COLUMN  27  PIC  X(022) VALUE
005820            "確認  OK=1 NO=9   ﾘﾀｰﾝ".
005830 01  C-KSM.                                                       I.150706
005840     02  LINE  12.                                                I.150706
005850       03  COLUMN  29  PIC  X(016) VALUE                          I.150706
005860          "｛　      件　｝".                                     I.150706
005870       03  COLUMN  33  PIC ZZ,ZZ9  FROM  W-KSU.                   I.150706
005880 01  C-ACP.
005890     02  A-DMM   LINE  20  COLUMN  44  PIC  9(001)
005900          USING W-DMM   CHECK OVERFLOW NO IFC.
005910 01  C-ERR.
005920     02  LINE  24.
005930       03  EMSG-JS COLUMN  15  PIC  X(024) VALUE
005940            "***  ｺﾝﾄﾛｰﾙ情報ｴﾗｰ   ***".
005950       03  E-ME2   COLUMN  15  PIC  X(016) VALUE
005960            "***  HIM ﾅｼ  ***".
005970       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
005980            "***  KHM ﾅｼ  ***".
005990       03  E-ME4   COLUMN  15  PIC  X(015) VALUE
006000            "***  JM ﾅｼ  ***".
006010       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
006020            "***  ｳﾘｱｹﾞ ｴﾗｰ (OVER)  ***".
006030       03  E-ME6   COLUMN  15  PIC  X(024) VALUE
006040            "***  ｳﾘｱｹﾞ ｴﾗｰ (NO)  ***".
006050       03  E-ME7   COLUMN  15  PIC  X(026) VALUE
006060            "***  ｳﾘｱｹﾞ ｴﾗｰ (ﾋﾞｺｳ)  ***".
006070       03  E-ME8   COLUMN  15  PIC  X(019) VALUE
006080            "***  ﾆｭｳｷﾝ ｴﾗｰ  ***".
006090       03  E-ME10  COLUMN  15  PIC  X(015) VALUE
006100            "***  TM ﾅｼ  ***".
006110       03  E-ME11  COLUMN  15  PIC  X(018) VALUE
006120            "***  DATA ﾅｼ   ***".
006130       03  E-TCD   COLUMN  50  PIC  9(004) FROM  DT1-TCD.
006140       03  E-HCD   COLUMN  50  PIC  X(006) FROM  DT1-HCD.
006150       03  E-JCD   COLUMN  50  PIC  X(006) FROM  DT1-JCD.
006160     COPY LSSEM.
006170     COPY LIBSCR.
006180 PROCEDURE DIVISION.
006190 M-020.
006200     DISPLAY C-CLEAR.
006210     DISPLAY C-MID.
006220     CALL "CBLSTNNO" USING STN-NO.                                I.150706
006230     MOVE STN-NO2 TO W-FID2.                                      I.150706
006240     MOVE W-FID TO WK0256ID.                                      I.150706
006250     PERFORM CHK-RTN THRU CHK-EX.                                 I.150706
006260     IF COMPLETION-CODE = 255                                     I.150706
006270         DISPLAY E-ME11 E-ME99                                    I.150706
006280         DISPLAY C-CLEAR                                          I.150706
006290         STOP RUN.                                                I.150706
006300     DISPLAY C-KSM.                                               I.150706
006310 M-040.
006320     ACCEPT A-DMM.
006330     IF ESTAT NOT = HTB AND SKP
006340         GO TO M-040.
006350     IF W-DMM = 9
006360         MOVE 255 TO COMPLETION-CODE
006370         DISPLAY C-CLEAR
006380         STOP RUN.
006390     IF W-DMM NOT = 1
006400         GO TO M-040.
006410 M-080.
006420*****CALL "CBLSTNNO" USING STN-NO.                                D.150706
006430*****MOVE STN-NO2 TO W-FID2.                                      D.150706
006440*****MOVE W-FID TO WK0256ID.                                      D.150706
006450     OPEN INPUT DTWF.
006460     READ DTWF AT END
006470         CLOSE DTWF
006480         DISPLAY E-ME11 E-ME99
006490         GO TO M-980.
006500*
006510     OPEN INPUT T-M HKBM.
006520     OPEN OUTPUT SP-F.
006530     MOVE ZERO TO W-DATA.
006540     MOVE ALL "-" TO W-YOKO.
006550 M-100.
006560     MOVE 0 TO W-SDC.
006570     MOVE DT1-BMC TO W-BMC.
006580     MOVE DT1-NG TO W-NG.
006590     MOVE DT1-TCD TO T-KEY W-TCD.
006600     READ T-M WITH UNLOCK INVALID KEY
006610         DISPLAY E-ME10 E-TCD E-ME99
006620         MOVE SPACE TO T-NAME.
006630*
006640     MOVE W-TCD TO H-TCD.
006650     MOVE T-NAME TO H-TNA.
006660     MOVE DT1-DATE TO W-NGP.
006670     IF W-GET = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
006680         MOVE 31 TO W-PEY
006690       ELSE
006700         IF W-GET = 4 OR 6 OR 9 OR 11
006710             MOVE 30 TO W-PEY
006720           ELSE
006730             MOVE 2000 TO W-NEND
006740             ADD W-NEN TO W-NEND
006750             DIVIDE 4 INTO W-NEND GIVING W-WARI REMAINDER W-NENC
006760             IF W-NENC = 3
006770                 MOVE 29 TO W-PEY
006780               ELSE
006790                 MOVE 28 TO W-PEY.
006800     IF DT1-SNGP = ZERO                                           I.110926
006810         IF W-SDC = 0                                             I.110926
006820             GO TO M-220.                                         I.110926
006830     CLOSE SP-F.                                                  I.110926
006840     OPEN OUTPUT SP-F.                                            I.110926
006850     MOVE 1 TO W-SDC.                                             I.110926
006860     MOVE ZERO TO W-SNGP SCNT.                                    I.110926
006870     PERFORM MDM-RTN THRU MDM-EX.                                 I.110926
006880     PERFORM MDP-RTN THRU MDP-EX.                                 I.110926
006890     PERFORM KKM-RTN THRU KKM-EX.                                 I.110926
006900     IF DT1-DC = 0                                                I.110926
006910         GO TO M-140.                                             I.110926
006920 M-120.                                                           I.110926
006930     PERFORM MSM-RTN THRU MSM-EX.                                 I.110926
006940 M-140.                                                           I.110926
006950     READ DTWF AT END                                             I.110926
006960         GO TO M-160.                                             I.110926
006970     IF DT1-BMC NOT = W-BMC                                       I.110926
006980         GO TO M-180.                                             I.110926
006990     IF DT1-NG NOT = W-NG                                         I.110926
007000         GO TO M-180.                                             I.110926
007010     IF DT1-TCD NOT = W-TCD                                       I.110926
007020         GO TO M-180.                                             I.110926
007030     IF DT1-SNGP = ZERO                                           I.110926
007040         GO TO M-200.                                             I.110926
007050     GO TO M-120.                                                 I.110926
007060 M-160.                                                           I.110926
007070     PERFORM SKE-RTN THRU SKE-EX.                                 I.110926
007080     CLOSE T-M.                                                   I.110926
007090     CLOSE DTWF.                                                  I.110926
007100     CLOSE SP-F.                                                  I.110926
007110     GO TO M-980.                                                 I.110926
007120 M-180.                                                           I.110926
007130     PERFORM SKE-RTN THRU SKE-EX.                                 I.110926
007140     CLOSE SP-F.
007150     OPEN OUTPUT SP-F.
007160     GO TO M-100.                                                 I.110926
007170 M-200.                                                           I.110926
007180     PERFORM SKE-RTN THRU SKE-EX.                                 I.110926
007190 M-220.                                                           I.110926
007200     CLOSE SP-F.
007210     OPEN OUTPUT SP-F.
007220     MOVE ZERO TO W-PAGE.
007230     MOVE W-NGP TO H-DATE.
007240     PERFORM MID-010 THRU MID-EX.
007250     IF DT1-BMC = 0
007260         OPEN INPUT HI-M TC-M
007270       ELSE
007280         OPEN INPUT KH-M J-M.
007290 M-240.
007300     MOVE DT1-UNC TO W-UNC.
007310     MOVE DT1-DNO TO W-DNO.
007320     MOVE ZERO TO W-TD.
007330 M-260.
007340     IF DT1-UNC NOT = 1
007350         GO TO M-320.
007360     MOVE SPACE TO W-P1N.
007370     MOVE W-15K TO PN-15K1.
007380     MOVE SPACE TO PN-DCM PN-NKC PN-TKGM PN-KINM PN-SKBM PN-TME
007390                                                         PN-SZM.
007400     IF DT1-GNO = 1
007410         MOVE DT1-DATE TO PN-NGP
007420         MOVE NC"入金" TO PN-DCM.
007430     IF DT1-NKC = 60
007440         GO TO M-280.
007450     MOVE SPACE TO HKB-KEY.
007460     MOVE "31" TO HKB-NO.
007470     MOVE DT1-NKC1 TO HKB-NKC1.
007480     READ HKBM WITH UNLOCK INVALID KEY
007490         MOVE SPACE TO HKB-NKNA.
007500     GO TO M-300.
007510 M-280.
007520     MOVE SPACE TO HKB-KEY.
007530     MOVE "32" TO HKB-NO.
007540     MOVE DT1-SSC TO HKB-NSC.
007550     READ HKBM WITH UNLOCK INVALID KEY
007560         MOVE SPACE TO HKB-NSNA.
007570 M-300.
007580     IF DT1-GNO = 1
007590         MOVE "(" TO PN-F
007600         MOVE W-DNO TO PN-DNO
007610         MOVE ")" TO PN-R.
007620     ADD DT1-KIN TO W-TKIN.
007630     IF DT1-NKC2 = 8
007640         MOVE DT1-KIN TO W-SHZ
007650         MOVE NC"消　費　税　" TO PN-NKC
007660       ELSE
007670         ADD DT1-KIN TO W-AKIN
007680         IF DT1-NKC = 60
007690             MOVE HKB-NSNA TO PN-NKC
007700           ELSE
007710             MOVE HKB-NKNA TO PN-NKC.
007720     IF DT1-TKG NOT = ZERO
007730         MOVE NC"手形期日" TO PN-TKGM
007740         MOVE ":" TO PN-TKGC
007750         MOVE DT1-TKG TO PN-TKGD.
007760     MOVE NC"金額" TO PN-KINM.
007770     MOVE ":" TO PN-KINC.
007780     MOVE DT1-KIN TO PN-KIND.
007790     IF DT1-SKNG NOT = ZERO
007800         MOVE NC"請求年月" TO PN-SKBM
007810         MOVE ":" TO PN-SKBC
007820         MOVE DT1-SKNG TO PN-SKNG.
007830     IF DT1-EC = 9
007840         MOVE NC"　合　計" TO PN-TME
007850         MOVE W-AKIN TO PN-GKIN.
007860     IF LINAGE-COUNTER > 63
007870         MOVE DT1-DATE TO PN-NGP
007880         MOVE NC"入金" TO PN-DCM
007890         PERFORM MID-RTN THRU MID-EX.
007900     MOVE SPACE TO SP-R.
007910     MOVE W-P1N TO SP-R.
007920     WRITE SP-R.
007930     MOVE SPACE TO SP-R.
007940     IF DT1-EC = 9
007950         MOVE SPACE TO W-P1N
007960         MOVE W-15K TO PN-15K1
007970         MOVE SPACE TO PN-DCM PN-NKC PN-TKGM PN-KINM
007980                       PN-SKBM PN-TME PN-SZM
007990         MOVE NC"　消費税" TO PN-SZM
008000         MOVE W-SHZ TO PN-GKIN
008010         MOVE W-TKIN TO PN-TKIN
008020         MOVE SPACE TO SP-R
008030         MOVE W-P1N TO SP-R
008040         WRITE SP-R
008050         MOVE SPACE TO SP-R
008060         MOVE W-YOKO TO SP-R
008070         WRITE SP-R
008080         MOVE SPACE TO SP-R.
008090     GO TO M-540.
008100 M-320.
008110     IF DT1-BMC NOT = ZERO
008120         GO TO M-460.
008130*
008140     IF W-DZC = 0
008150         MOVE 1 TO W-DZC.
008160     MOVE ZERO TO W-TD W-D.
008170     MOVE DT1-CSC TO W-CSC.
008180     MOVE DT1-HSC TO W-HSC.
008190     MOVE DT1-KOSU TO SV-KOSU.
008200     MOVE DT1-TCD2 TO SV-TCD.
008210     MOVE DT1-CCD TO SV-CCD2.
008220*
008230     MOVE 0 TO W-CCC.
008240     IF DT1-CCD = ZERO OR 001
008250         GO TO M-380.
008260     MOVE DT1-TCD2 TO TC-TCD.
008270     MOVE DT1-CCD TO TC-CCD.
008280     READ TC-M WITH UNLOCK INVALID KEY
008290         MOVE 0 TO TC-DHC.
008300     IF TC-DHC NOT = 0
008310         MOVE 1 TO W-CCC.
008320 M-380.
008330     MOVE SPACE TO W-P1H.
008340     MOVE W-15K TO PH-15K1.
008350     MOVE SPACE TO PH-DCM PH-DCD.
008360     MOVE DT1-DATE TO PH-NGP.
008370     MOVE DT1-CSC TO PH-CSC.
008380     IF DT1-SNC = 0
008390         IF DT1-DC = 4
008400             MOVE 0 TO PH-DC
008410           ELSE
008420             MOVE DT1-DC TO PH-DC.
008430     IF DT1-FRC NOT = 0
008440         MOVE DT1-FRC TO PH-FRC.
008450     MOVE "(" TO PH-F.
008460     MOVE W-DNO TO PH-DNO.
008470     MOVE ")" TO PH-R.
008480     IF DT1-SNC = 0
008490         IF DT1-DC = 0 OR 6
008500             MOVE NC"売上" TO PH-DCM
008510           ELSE
008520             IF DT1-DC = 1 OR 2 OR 5
008530                 MOVE NC"返品" TO PH-DCM
008540               ELSE
008550                 IF DT1-DC = 3 OR 4 OR 7
008560                     IF DT1-SUT < ZERO
008570                         MOVE NC"値引" TO PH-DCM
008580                       ELSE
008590                         MOVE NC"売上" TO PH-DCM.
008600     IF DT1-SNC = 1
008610         IF DT1-KIN < 0
008620             MOVE NC"売上" TO PH-DCM
008630           ELSE
008640             MOVE NC"値引" TO PH-DCM.
008650     IF DT1-DC = 2
008660         MOVE NC"不良返品" TO PH-DCD.
008670     IF DT1-DC = 3
008680         MOVE NC"預り保管" TO PH-DCD.
008690     IF DT1-DC = 8
008700         MOVE NC"税調整分" TO PH-DCD.
008710     IF DT1-SKU NOT = ZERO AND 999999
008720         MOVE DT1-SKU TO PH-MNGP.
008730     IF LINAGE-COUNTER > 62
008740         PERFORM MID-RTN THRU MID-EX.
008750     MOVE SPACE TO SP-R.
008760     MOVE W-P1H TO SP-R.
008770     WRITE SP-R.
008780     IF DT1-DC NOT = 8
008790         GO TO M-400.
008800     ADD DT1-KIN TO W-AKIN.
008810     GO TO M-540.
008820 M-400.
008830     ADD 1 TO W-GNO.
008840     IF W-GNO = 7
008850         DISPLAY E-ME5 E-ME99
008860         GO TO M-980.
008870     IF W-GNO NOT = DT1-GNO
008880         DISPLAY E-ME6 E-ME99.
008890     PERFORM MEI-RTN THRU MEI-EX.
008900     GO TO M-540.
008910*-------------------------------------------------------------------------
008920 M-460.
008930     MOVE SPACE TO W-P1K.
008940     MOVE W-15K TO PK-15K1.
008950     MOVE W-20K TO PK-20K1.
008960     MOVE SPACE TO PK-DCM PK-DCD PK-HNA.
008970     IF DT1-GNO = 1
008980         PERFORM KM1-RTN THRU KM1-EX.
008990     MOVE DT1-SUT TO WK-SUT.
009000     MOVE DT1-T TO WK-T.
009010     MOVE DT1-KIN TO WK-KIN.
009020     MOVE ZERO TO WK-SHZ.
009030     IF DT1-DC = 8 OR 9
009040         COMPUTE WK-T = -1 * WK-T
009050         COMPUTE WK-KIN = -1 * WK-KIN.
009060     IF DT1-DC = 5 OR 9                                           税
009070         MOVE WK-KIN TO WK-SHZ
009080         MOVE ZERO TO WK-KIN
009090         IF (DT1-GNO = 1) AND (DT1-EC = 9)
009100             GO TO M-500                                          計
009110           ELSE
009120             GO TO M-520.
009130     IF WK-SUT NOT = ZERO
009140         MOVE WK-SUT TO PK-SUT.
009150     IF WK-T NOT = ZERO
009160         MOVE WK-T TO PK-T.
009170     MOVE WK-KIN TO PK-KIN.
009180     MOVE DT1-KCD TO PK-HCD.
009190     IF DT1-KCD = "00800"
009200         GO TO M-480.
009210     MOVE DT1-KCD TO KH-KEY.
009220     READ KH-M WITH UNLOCK INVALID KEY
009230         DISPLAY E-ME3 E-HCD E-ME99
009240         MOVE SPACE TO KH-NAME.
009250     MOVE KH-NAME TO PK-HNA.
009260     GO TO M-500.
009270 M-480.
009280     MOVE DT1-JCD TO J-KEY.
009290     READ J-M WITH UNLOCK INVALID KEY
009300         DISPLAY E-ME4 E-JCD E-ME99
009310         MOVE SPACE TO J-NAME.
009320     MOVE J-NAME TO PK-HNA.
009330     MOVE "<" TO PK-JF.
009340     MOVE DT1-JCD TO PK-JCD.
009350     MOVE ">" TO PK-JR.
009360 M-500.
009370     IF LINAGE-COUNTER > 62
009380         PERFORM MID-RTN THRU MID-EX
009390         PERFORM KM1-RTN THRU KM1-EX.
009400     MOVE SPACE TO SP-R.
009410     MOVE W-P1K TO SP-R.
009420     WRITE SP-R.
009430     MOVE SPACE TO SP-R.
009440 M-520.
009450     ADD WK-KIN TO W-AKIN.
009460     ADD WK-SHZ TO W-SHZ.
009470     IF DT1-EC = 9
009480         PERFORM KKE-RTN THRU KKE-EX.
009490 M-540.
009500     READ DTWF AT END
009510         GO TO M-900.
009520     IF (DT1-BMC NOT = W-BMC) OR
009530        (DT1-NG  NOT = W-NG)  OR
009540        (DT1-TCD NOT = W-TCD)
009550         GO TO M-660.
009560*
009570     IF W-UNC = 1
009580         IF DT1-DNO = W-DNO
009590             GO TO M-260
009600           ELSE
009610             GO TO M-240.
009620     IF W-BMC NOT = 0
009630         GO TO M-620.
009640     IF DT1-DNO = W-DNO
009650         IF DT1-GNO NOT = 9
009660             GO TO M-400.
009670     IF DT1-DNO NOT = W-DNO
009680         DISPLAY E-ME7 E-ME99
009690         GO TO M-980.
009700     PERFORM KEI-RTN THRU KEI-EX.
009710*
009720     READ DTWF AT END
009730         GO TO M-900.
009740     IF (DT1-BMC NOT = W-BMC) OR
009750        (DT1-NG  NOT = W-NG)  OR
009760        (DT1-TCD NOT = W-TCD)
009770         GO TO M-660.
009780     GO TO M-240.
009790 M-620.
009800     IF DT1-DNO = W-DNO
009810         GO TO M-460.
009820     GO TO M-240.
009830 M-660.
009840     IF W-BMC = 0
009850         CLOSE HI-M TC-M
009860       ELSE
009870         CLOSE KH-M J-M.
009880     GO TO M-100.
009890 M-900.
009900     IF W-BMC = 0
009910         CLOSE HI-M TC-M
009920       ELSE
009930         CLOSE KH-M J-M.
009940     CLOSE T-M.
009950     CLOSE DTWF.
009960     CLOSE SP-F.
009970 M-980.
009980     DISPLAY C-CLEAR.
009990     STOP RUN.
010000 CHK-RTN.                                                         I.150706
010010     MOVE ZERO TO W-KSU.                                          I.150706
010020     OPEN INPUT DTWF.                                             I.150706
010030     READ DTWF AT END                                             I.150706
010040         MOVE 255 TO COMPLETION-CODE                              I.150706
010050         GO TO CHK-080.                                           I.150706
010060 CHK-020.                                                         I.150706
010070     ADD 1 TO W-KSU.                                              I.150706
010080     READ DTWF AT END                                             I.150706
010090         GO TO CHK-080.                                           I.150706
010100     GO TO CHK-020.                                               I.150706
010110 CHK-080.                                                         I.150706
010120     CLOSE DTWF.                                                  I.150706
010130 CHK-EX.                                                          I.150706
010140     EXIT.                                                        I.150706
010150 MDM-RTN.                                                         I.110926
010160     MOVE SPACE TO W-P01 W-P02 W-P03.                             I.110926
010170     MOVE SPACE TO P-DNO P-UM P-JSU P-NAME P-JSS.                 I.110926
010180     MOVE SPACE TO W-SDNO.                                        I.110926
010190     MOVE T-TNC1 TO W-TNC1.                                       I.110926
010200     MOVE NC"－" TO W-V.                                          I.110926
010210     MOVE T-DCC TO W-DCC.                                         I.110926
010220     MOVE W-SDNO TO P-DNO.                                        I.110926
010230     MOVE NC"　〒" TO P-UM.                                       I.110926
010240     MOVE "TEL" TO P-TM.                                          I.110926
010250     MOVE "FAX" TO P-FM.                                          I.110926
010260     MOVE T-TCD TO P-TCD.                                         I.110926
010270     MOVE T-NAME TO P-NAME.                                       I.110926
010280     MOVE "<" TO P-F.                                             I.110926
010290     MOVE ">" TO P-R.                                             I.110926
010300     MOVE T-BC TO P-BMC.                                          I.110926
010310     MOVE T-JSU TO P-JSU.                                         I.110926
010320     MOVE T-JSS TO P-JSS.                                         I.110926
010330     MOVE T-UNO TO P-UNO.                                         I.110926
010340     MOVE T-TEL TO P-TEL.                                         I.110926
010350     MOVE T-FAX TO P-FAX.                                         I.110926
010360     MOVE ZERO TO W-UZ W-UZZ W-UZG W-STD.                         I.110926
010370 MDM-EX.                                                          I.110926
010380     EXIT.                                                        I.110926
010390 MDP-RTN.                                                         I.110926
010400     MOVE SPACE TO SP-R.                                          I.110926
010410     MOVE HEAD01 TO SP-R.                                         I.110926
010420     WRITE SP-R AFTER 2.                                          I.110926
010430     MOVE SPACE TO SP-R.                                          I.110926
010440     MOVE HEAD02 TO SP-R.                                         I.110926
010450     WRITE SP-R AFTER 3.                                          I.110926
010460     MOVE SPACE TO SP-R.                                          I.110926
010470     MOVE W-P01 TO SP-R.                                          I.110926
010480     WRITE SP-R.                                                  I.110926
010490     MOVE SPACE TO SP-R.                                          I.110926
010500     MOVE W-P02 TO SP-R.                                          I.110926
010510     WRITE SP-R.                                                  I.110926
010520     MOVE SPACE TO SP-R.                                          I.110926
010530     MOVE W-P03 TO SP-R.                                          I.110926
010540     WRITE SP-R.                                                  I.110926
010550     MOVE SPACE TO SP-R.                                          I.110926
010560     MOVE HEAD08 TO SP-R.                                         I.110926
010570     WRITE SP-R AFTER 3.                                          I.110926
010580     MOVE SPACE TO SP-R.                                          I.110926
010590 MDP-EX.                                                          I.110926
010600     EXIT.                                                        I.110926
010610 KKM-RTN.                                                         I.110926
010620     MOVE SPACE TO W-P04 W-P05.                                   I.110926
010630     MOVE SPACE TO P-DNM P-MSM.                                   I.110926
010640     IF (DT1-DC NOT = 0) OR (SCNT = 11)                           I.110926
010650         GO TO KKM-020.                                           I.110926
010660     MOVE DT1-SNEN TO WP-NEN.                                     I.110926
010670     MOVE DT1-SGET TO WP-GET.                                     I.110926
010680     MOVE DT1-SPEY TO WP-PEY.                                     I.110926
010690     MOVE WP-NEN TO W-DNN.                                        I.110926
010700     MOVE WP-GET TO W-DNG.                                        I.110926
010710     MOVE WP-PEY TO W-DNP.                                        I.110926
010720     MOVE W-DNM TO P-DNM.                                         I.110926
010730     MOVE NC"　　　　　　繰越" TO P-MSM.                          I.110926
010740     MOVE DT1-KIN TO W-UZ.                                        I.110926
010750     MOVE DT1-SHZ TO W-UZZ.                                       I.110926
010760     COMPUTE W-UZG = W-UZ + W-UZZ.                                I.110926
010770     MOVE W-UZ TO P-UZ.                                           I.110926
010780     MOVE W-UZZ TO P-UZZ.                                         I.110926
010790     MOVE W-UZG TO P-UZG.                                         I.110926
010800 KKM-020.                                                         I.110926
010810     MOVE SPACE TO SP-R.                                          I.110926
010820     MOVE W-P04 TO SP-R.                                          I.110926
010830     WRITE SP-R.                                                  I.110926
010840     MOVE SPACE TO SP-R.                                          I.110926
010850     MOVE W-P05 TO SP-R.                                          I.110926
010860     WRITE SP-R.                                                  I.110926
010870     MOVE SPACE TO SP-R.                                          I.110926
010880     MOVE 1 TO SCNT.                                              I.110926
010890 KKM-EX.                                                          I.110926
010900     EXIT.                                                        I.110926
010910 MSM-RTN.                                                         I.110926
010920     MOVE SPACE TO W-P04 W-P05.                                   I.110926
010930     MOVE SPACE TO P-DNM P-MSM.                                   I.110926
010940     IF DT1-SNGP NOT = W-SNGP                                     I.110926
010950         MOVE DT1-SNGP TO W-SNGP                                  I.110926
010960         MOVE DT1-SNEN TO WP-NEN                                  I.110926
010970         MOVE DT1-SGET TO WP-GET                                  I.110926
010980         MOVE DT1-SPEY TO WP-PEY                                  I.110926
010990         MOVE WP-NEN TO W-DNN                                     I.110926
011000         MOVE WP-GET TO W-DNG                                     I.110926
011010         MOVE WP-PEY TO W-DNP                                     I.110926
011020         MOVE W-DNM TO P-DNM.                                     I.110926
011030     IF DT1-DC NOT = 1                                            I.110926
011040         GO TO MSM-040.                                           I.110926
011050     MOVE NC"　　　　　　まで" TO P-MSM.                          I.110926
011060     ADD DT1-KIN TO W-TUK W-UZ.                                   I.110926
011070     ADD DT1-SHZ TO W-TUKZ W-UZZ.                                 I.110926
011080     COMPUTE W-UZG = W-UZ + W-UZZ.                                I.110926
011090     MOVE DT1-KIN TO P-UK.                                        I.110926
011100     MOVE DT1-SHZ TO P-UKZ.                                       I.110926
011110     MOVE W-UZ TO P-UZ.                                           I.110926
011120     MOVE W-UZZ TO P-UZZ.                                         I.110926
011130     MOVE W-UZG TO P-UZG.                                         I.110926
011140     GO TO MSM-100.                                               I.110926
011150 MSM-040.                                                         I.110926
011160     IF DT1-DC NOT = 2                                            I.110926
011170         GO TO MSM-060.                                           I.110926
011180     MOVE NC"　　　　　　入金" TO P-MSM.                          I.110926
011190     SUBTRACT DT1-KIN FROM W-UZ.                                  I.110926
011200     SUBTRACT DT1-SHZ FROM W-UZZ.                                 I.110926
011210     COMPUTE W-NK = DT1-KIN + DT1-SHZ.                            I.110926
011220     COMPUTE W-UZG = W-UZ + W-UZZ.                                I.110926
011230     MOVE W-NK TO P-NK.                                           I.110926
011240     MOVE W-UZ TO P-UZ.                                           I.110926
011250     MOVE W-UZZ TO P-UZZ.                                         I.110926
011260     MOVE W-UZG TO P-UZG.                                         I.110926
011270     ADD W-NK TO W-TNK.                                           I.110926
011280     GO TO MSM-100.                                               I.110926
011290 MSM-060.                                                         I.110926
011300     MOVE NC"　　　　　　請求" TO P-MSM.                          I.110926
011310     COMPUTE W-UZG = DT1-KIN + DT1-SHZ.                           I.110926
011320     MOVE DT1-KIN TO P-UZ.                                        I.110926
011330     MOVE DT1-SHZ TO P-UZZ.                                       I.110926
011340     MOVE W-UZG TO P-UZG.                                         I.110926
011350 MSM-100.                                                         I.110926
011360     ADD 1 TO SCNT.                                               I.110926
011370     IF SCNT NOT = 11                                             I.110926
011380         GO TO MSM-120.                                           I.110926
011390     MOVE SPACE TO SP-R.                                          I.110926
011400     WRITE SP-R AFTER PAGE.                                       I.110926
011410     MOVE ZERO TO W-SNGP SCNT.                                    I.110926
011420     PERFORM MDP-RTN THRU MDP-EX.                                 I.110926
011430     PERFORM KKM-RTN THRU KKM-EX.                                 I.110926
011440     MOVE DT1-SNEN TO WP-NEN.                                     I.110926
011450     MOVE DT1-SGET TO WP-GET.                                     I.110926
011460     MOVE DT1-SPEY TO WP-PEY.                                     I.110926
011470     MOVE WP-NEN TO W-DNN.                                        I.110926
011480     MOVE WP-GET TO W-DNG.                                        I.110926
011490     MOVE WP-PEY TO W-DNP.                                        I.110926
011500     MOVE W-DNM TO P-DNM.                                         I.110926
011510     IF DT1-DC = 1                                                I.110926
011520         SUBTRACT DT1-KIN FROM W-TUK W-UZ                         I.110926
011530         SUBTRACT DT1-SHZ FROM W-TUKZ W-UZZ                       I.110926
011540       ELSE                                                       I.110926
011550         IF DT1-DC = 2                                            I.110926
011560             ADD DT1-KIN TO W-UZ                                  I.110926
011570             ADD DT1-SHZ TO W-UZZ                                 I.110926
011580             SUBTRACT DT1-KIN FROM W-TNK                          I.110926
011590             SUBTRACT DT1-SHZ FROM W-TNK.                         I.110926
011600     GO TO MSM-RTN.                                               I.110926
011610 MSM-120.                                                         I.110926
011620     MOVE SPACE TO SP-R.                                          I.110926
011630     MOVE W-P04 TO SP-R.                                          I.110926
011640     WRITE SP-R.                                                  I.110926
011650     MOVE SPACE TO SP-R.                                          I.110926
011660     MOVE W-P05 TO SP-R.                                          I.110926
011670     WRITE SP-R.                                                  I.110926
011680     MOVE SPACE TO SP-R.                                          I.110926
011690 MSM-EX.                                                          I.110926
011700     EXIT.                                                        I.110926
011710 SKE-RTN.                                                         I.110926
011720     IF ZERO = W-TUK AND W-TUKZ AND W-TNK                         I.110926
011730         GO TO SKE-020.                                           I.110926
011740     MOVE SPACE TO W-P05.                                         I.110926
011750     MOVE SPACE TO P-MSM.                                         I.110926
011760     MOVE NC"合　　　計　　　" TO P-MSM.                          I.110926
011770     MOVE W-TUK TO P-UK.                                          I.110926
011780     MOVE W-TUKZ TO P-UKZ.                                        I.110926
011790     MOVE W-TNK TO P-NK.                                          I.110926
011800     COMPUTE SCNT = 22 - (2 * SCNT).                              I.110926
011810     IF SCNT = ZERO                                               I.110926
011820         MOVE 22 TO SCNT.                                         I.110926
011830     MOVE SPACE TO SP-R.                                          I.110926
011840     MOVE W-P05 TO SP-R.                                          I.110926
011850     WRITE SP-R AFTER SCNT.                                       I.110926
011860 SKE-020.                                                         I.110926
011870     MOVE SPACE TO SP-R.                                          I.110926
011880     WRITE SP-R AFTER PAGE.                                       I.110926
011890 SKE-EX.                                                          I.110926
011900     EXIT.                                                        I.110926
011910*-------------------------------------------------------------------------
011920 MID-RTN.
011930     MOVE SPACE TO SP-R.
011940     WRITE SP-R AFTER PAGE.
011950 MID-010.
011960     ADD 1 TO W-PAGE.
011970     MOVE W-PAGE TO H-PAGE.
011980     MOVE SPACE TO SP-R.
011990     MOVE HEAD1 TO SP-R.
012000     WRITE SP-R.
012010     MOVE SPACE TO SP-R.
012020     MOVE HEAD2 TO SP-R.
012030     WRITE SP-R.
012040     MOVE SPACE TO SP-R.
012050     IF W-BMC = 0
012060         MOVE HEAD3H TO SP-R
012070         WRITE SP-R
012080         MOVE SPACE TO SP-R
012090         MOVE HEAD4H TO SP-R
012100         WRITE SP-R
012110         MOVE SPACE TO SP-R
012120         MOVE HEAD5H TO SP-R
012130         WRITE SP-R
012140         MOVE SPACE TO SP-R
012150         MOVE HEAD6H TO SP-R
012160         WRITE SP-R
012170       ELSE
012180         MOVE HEAD3K TO SP-R
012190         WRITE SP-R
012200         MOVE SPACE TO SP-R
012210         MOVE HEAD4K TO SP-R
012220         WRITE SP-R.
012230     MOVE SPACE TO SP-R.
012240 MID-EX.
012250     EXIT.
012260 MEI-RTN.
012270     MOVE DT1-DC TO W-DC.
012280     MOVE SPACE TO W-P2H.
012290     MOVE SPACE TO PH-HNA.
012300     MOVE W-15K TO PH-15K2.
012310     MOVE W-20K TO PH-20K2.
012320     IF (DT1-SNC = 1) OR (DT1-HCD > 999899) OR (DT1-DC = 3)
012330         GO TO MEI-040.
012340     MOVE ZERO TO CNT W-ASU.
012350 MEI-020.
012360     ADD 1 TO CNT.
012370     IF CNT = 11
012380         GO TO MEI-040.
012390     MOVE DT1-SU(CNT) TO W-SU(CNT).
012400     IF W-SU(CNT) NOT = ZERO
012410         MOVE W-SU(CNT) TO PH-SU(CNT).
012420     GO TO MEI-020.
012430 MEI-040.
012440     IF DT1-HCD NOT = ZERO
012450         MOVE DT1-HCD TO PH-HCD
012460         IF DT1-SNC = 0
012470             MOVE DT1-SIZ TO PH-SIZ.
012480     MOVE DT1-SUT TO W-SUT.
012490     IF DT1-HCD = ZERO
012500         GO TO MEI-100.
012510     IF DT1-DC = 3 OR 4 OR 7
012520         IF W-SUT < ZERO
012530             COMPUTE W-SUT = W-SUT * -1.
012540     MOVE W-SUT TO PH-SUT.
012550     IF DT1-DC NOT = 4
012560         GO TO MEI-060.
012570     IF DT1-SUT < ZERO
012580         MOVE NC"預りへ戻し" TO PH-MSM
012590       ELSE
012600         MOVE NC"預り出荷　" TO PH-MSM.
012610     GO TO MEI-080.
012620 MEI-060.
012630     IF DT1-DC = 9
012640         MOVE NC"預り振替　"    TO PH-MSM
012650         GO TO MEI-080.
012660     MOVE DT1-T TO PH-T.
012670     MOVE DT1-KIN TO W-KIN.
012680     IF (DT1-DC = 3) OR (DT1-SNC = 1)
012690         IF W-KIN < ZERO
012700             COMPUTE W-KIN = W-KIN * -1.
012710     MOVE W-KIN TO PH-KIN.
012720 MEI-080.
012730     MOVE DT1-HCD TO HI-KEY.
012740     READ HI-M WITH UNLOCK INVALID KEY
012750         DISPLAY E-ME2 E-HCD E-ME99
012760         MOVE SPACE TO HI-NAME.
012770     IF DT1-TCD = 0013 OR 0458 OR 0459 OR 0460
012780         MOVE HI-NAME TO W-NAME
012790         MOVE SPACE TO W-NA(24)
012800         MOVE W-NAME TO PH-HNA
012810       ELSE
012820         MOVE HI-NAME TO PH-HNA.
012830     IF DT1-SNC = 0
012840         IF DT1-BIK NOT = SPACE
012850             MOVE DT1-BIK TO PH-BIK.
012860 MEI-100.
012870     IF LINAGE-COUNTER > 63
012880         PERFORM MID-RTN THRU MID-EX.
012890     MOVE SPACE TO SP-R.
012900     MOVE W-P2H TO SP-R.
012910     WRITE SP-R.
012920     MOVE SPACE TO SP-R.
012930     IF DT1-HCD <  999900
012940         ADD W-SUT TO W-ASUT.
012950     IF DT1-DC NOT = 4 AND 9
012960         ADD DT1-KIN TO W-AKIN.
012970 MEI-EX.
012980     EXIT.
012990 KEI-RTN.
013000     MOVE SPACE TO W-P3H.
013010     MOVE W-15K TO PH-15K3.
013020     MOVE SPACE TO PH-KOSU PH-KO PH-CNAM PH-NOM PH-TME PH-SZM.
013030     IF SV-KOSU NOT = ZERO
013040        MOVE SV-KOSU TO   W-KOSU
013050        MOVE W-KOSU  TO   PH-KOSU
013060        MOVE NC"個口" TO  PH-KO.
013070     IF SV-CCD2 NOT = ZERO AND 001
013080         IF W-CCC = 0
013090             PERFORM TNA-RTN THRU TNA-EX.
013100     MOVE NC"　合　計" TO PH-TME.
013110     IF DT2-HNO NOT = ZERO
013120         MOVE NC"発送明細書№" TO PH-NOM
013130         MOVE DT2-HNO TO PH-HMN.
013140     IF W-GNO = ZERO
013150         MOVE W-AKIN TO W-SHZ W-KINZ
013160         MOVE ZERO TO W-AKIN W-KIN
013170         GO TO KEI-060.
013180     MOVE W-ASUT TO PH-GSUT.                                      数計
013190     MOVE W-AKIN TO W-KIN.
013200*****IF W-HSC = 0                                                 D.140128
013210*****    COMPUTE W-SHZ ROUNDED = W-KIN * 0.05.                    D.140128
013220*****IF W-HSC = 3                                                 D.140128
013230*****    COMPUTE W-SHZ ROUNDED = W-KIN * 0.03.                    D.140128
013240     IF W-HSC = 1                                                 I.140128
013250         COMPUTE W-SHZ ROUNDED = W-KIN * 0.10                     I.140128
013260       ELSE                                                       I.140128
013270         IF W-HSC = 3                                             I.140128
013280             COMPUTE W-SHZ ROUNDED = W-KIN * 0.03                 I.140128
013290           ELSE                                                   I.140128
013300             IF W-HSC = 5                                         I.140128
013310                 COMPUTE W-SHZ ROUNDED = W-KIN * 0.05             I.140128
013320               ELSE                                               I.140128
013330                 IF W-HSC = 8                                     I.140128
013340                     COMPUTE W-SHZ ROUNDED = W-KIN * 0.08.        I.140128
013350     MOVE W-SHZ TO W-KINZ.
013360     IF (W-DC = 3) OR (DT2-SNC = 1)
013370         IF W-KIN < ZERO
013380             COMPUTE W-KIN = W-KIN * -1
013390             COMPUTE W-KINZ = W-KINZ * -1.
013400 KEI-060.
013410     MOVE W-KIN TO PH-GKIN.                                       計
013420     IF LINAGE-COUNTER > 63
013430         PERFORM MID-RTN THRU MID-EX.
013440     MOVE SPACE TO SP-R.
013450     MOVE W-P3H TO SP-R.
013460     WRITE SP-R.
013470     MOVE SPACE TO SP-R.
013480*
013490     MOVE SPACE TO W-P3H.
013500     MOVE W-15K TO PH-15K3.
013510     MOVE SPACE TO PH-KOSU PH-KO PH-CNAM PH-NOM PH-TME PH-SZM.
013520     MOVE DT2-BI TO PH-BI.
013530     MOVE NC"消費税　" TO PH-SZM.
013540     MOVE W-KINZ TO PH-GKIN.                                      消
013550     COMPUTE W-TKIN = W-KIN + W-KINZ.
013560     MOVE W-TKIN TO PH-TKIN.                                      総
013570     IF LINAGE-COUNTER > 63
013580         PERFORM MID-RTN THRU MID-EX.
013590     MOVE SPACE TO SP-R.
013600     MOVE W-P3H TO SP-R.
013610     WRITE SP-R.
013620     MOVE SPACE TO SP-R.
013630     MOVE W-YOKO TO SP-R.
013640     WRITE SP-R.
013650     MOVE SPACE TO SP-R.
013660     IF W-DC = 1 OR 2 OR 5
013670         COMPUTE W-AKIN = W-AKIN * -1
013680         COMPUTE W-SHZ = W-SHZ * -1.
013690 KEI-EX.
013700     EXIT.
013710 TNA-RTN.
013720     MOVE SV-TCD TO TC-TCD.
013730     MOVE SV-CCD2 TO TC-CCD.
013740     READ TC-M UNLOCK INVALID KEY
013750         MOVE SPACE TO TC-NAME.
013760     MOVE TC-NAME TO PH-CNAM.
013770     MOVE PH-CNAM TO TBL-NAM.
013780     MOVE 26 TO N.
013790 TNA-020.
013800     IF N = 0
013810         GO TO TNA-EX.
013820     IF T-NAM(N) NOT = SPACE AND NC"　"
013830         GO TO TNA-040.
013840     COMPUTE N = N - 1.
013850     GO TO TNA-020.
013860 TNA-040.
013870     IF W-DC = 1 OR 2
013880         ADD 1 TO N
013890         MOVE NC"様" TO T-NAM(N)
013900         ADD 1 TO N
013910         MOVE NC"よ" TO T-NAM(N)
013920         ADD 1 TO N
013930         MOVE NC"り" TO T-NAM(N)
013940         ADD 1 TO N
013950         MOVE NC"返" TO T-NAM(N)
013960         ADD 1 TO N
013970         MOVE NC"品" TO T-NAM(N)
013980         MOVE TBL-NAM TO PH-CNAM
013990         GO TO TNA-EX.
014000     ADD 1 TO N.
014010     MOVE NC"様" TO T-NAM(N).
014020     ADD 1 TO N.
014030     MOVE NC"　" TO T-NAM(N).
014040     ADD 1 TO N.
014050     MOVE NC"直" TO T-NAM(N).
014060     ADD 1 TO N.
014070     MOVE NC"送" TO T-NAM(N).
014080     MOVE TBL-NAM TO PH-CNAM.
014090 TNA-EX.
014100     EXIT.
014110 KM1-RTN.
014120     MOVE DT1-DATE TO PK-NGP.
014130     MOVE DT1-CSC TO PK-CSC.
014140     IF DT1-SNC = 0
014150         IF DT1-DC = 4
014160             MOVE 0 TO PK-DC
014170           ELSE
014180             MOVE DT1-DC TO PK-DC.
014190     MOVE "(" TO PK-F.
014200     MOVE W-DNO TO PK-DNO.
014210     MOVE ")" TO PK-R.
014220     IF DT1-SNC = 0
014230         IF DT1-DC = 0 OR 6
014240             MOVE NC"売上" TO PK-DCM
014250           ELSE
014260             IF DT1-DC = 1 OR 2
014270                 MOVE NC"返品" TO PK-DCM
014280               ELSE
014290                 IF DT1-DC = 3 OR 4 OR 7
014300                     IF DT1-SUT < ZERO
014310                         MOVE NC"値引" TO PK-DCM
014320                       ELSE
014330                         MOVE NC"売上" TO PK-DCM.
014340     IF DT1-SNC = 1
014350         IF DT1-KIN < 0
014360             MOVE NC"売上" TO PK-DCM
014370           ELSE
014380             MOVE NC"値引" TO PK-DCM.
014390     IF DT1-DC = 2
014400         MOVE NC"不良返品" TO PK-DCD.
014410     IF DT1-DC = 3
014420         MOVE NC"預り保管" TO PK-DCD.
014430     IF DT1-DC = 5 OR 9
014440         IF DT1-CSC = 9
014450             MOVE NC"税調整分" TO PK-DCD.
014460     IF DT1-SKU NOT = ZERO AND 999999
014470         MOVE DT1-SKU TO PK-MNGP.
014480 KM1-EX.
014490     EXIT.
014500 KKE-RTN.
014510     MOVE 0 TO W-BIC.
014520     COMPUTE W-TKIN = W-AKIN + W-SHZ.
014530     MOVE SPACE TO W-P2K.
014540     MOVE W-15K TO PK-15K2.
014550     MOVE SPACE TO PK-BI PK-TME PK-SZM.
014560     MOVE NC"　合　計" TO PK-TME.
014570     IF DT1-GNO = 1
014580         IF DT1-DC = 5 OR 9
014590             GO TO KKE-050.
014600     MOVE W-AKIN TO PK-GKIN.
014610     MOVE DT1-TEKI TO PK-BI.
014620     MOVE 1 TO W-BIC.
014630     IF LINAGE-COUNTER > 61
014640         PERFORM MID-RTN THRU MID-EX
014650         PERFORM KM1-RTN THRU KM1-EX.
014660     MOVE SPACE TO SP-R.
014670     MOVE W-P2K TO SP-R.
014680     WRITE SP-R.
014690     MOVE SPACE TO SP-R.
014700*
014710     MOVE SPACE TO W-P2K.
014720     MOVE W-15K TO PK-15K2.
014730     MOVE SPACE TO PK-BI PK-TME PK-SZM.
014740 KKE-050.
014750     IF W-BIC = 0
014760         MOVE DT1-TEKI TO PK-BI.
014770     MOVE NC"　消費税" TO PK-SZM.
014780     MOVE W-SHZ TO PK-GKIN.
014790     MOVE W-TKIN TO PK-TKIN.
014800     MOVE SPACE TO SP-R.
014810     MOVE W-P2K TO SP-R.
014820     WRITE SP-R.
014830     MOVE SPACE TO SP-R.
014840     MOVE W-YOKO TO SP-R.
014850     WRITE SP-R.
014860     MOVE SPACE TO SP-R.
014870 KKE-EX.
014880     EXIT.
014890 ERR-RTN.
014900     DISPLAY E-ME99
014910     GO TO ERR-RTN.
014920 ERR-EX.
014930     EXIT.
