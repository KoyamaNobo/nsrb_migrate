000010 IDENTIFICATION      DIVISION.
000020 PROGRAM-ID.         HKD910.
000030 AUTHOR.             KAMASAKA   1995-12-22.
000040**************************************
000050******    直送先シール　作成    ******
000060******    JS-SIGN  0 : ｺｰﾄﾞ入力 ******
000070******             1 : ALL入力  ******
000080******             2 : 担当・得意先   ******
000090**************************************
000100 ENVIRONMENT         DIVISION.
000110 CONFIGURATION       SECTION.
000120 SOURCE-COMPUTER.    SYSTEM3100.
000130 OBJECT-COMPUTER.    SYSTEM3100.
000140 INPUT-OUTPUT        SECTION.
000150 FILE-CONTROL.
000160     SELECT  TC-M  ASSIGN  TO  TC-MSD
000170             ORGANIZATION  INDEXED
000180             ACCESS  MODE  DYNAMIC
000190             RECORD  KEY   TC-KEY
000200             FILE  STATUS  IS  ERR-STAT.
000210*****SELECT  T-M   ASSIGN  TO  T-MSD                              D.000224
000220     SELECT  T-M   ASSIGN  TO  T1-MSD T2-MSD                      I.000224
000230             ORGANIZATION  INDEXED
000240             ACCESS  MODE  DYNAMIC
000250             RECORD  KEY   T-KEY
000260             ALTERNATE  RECORD  KEY   T-KEY2                      I.000224
000270             FILE  STATUS  IS  ERR-STAT.
000280     SELECT  TMW   ASSIGN  TO  TMW-MSD.                           I.000224
000290     SELECT  SP-F  ASSIGN  TO  P-PRN999.
000300 I-O-CONTROL.
000310     APPLY  SHARED-MODE  ON  TC-M
000320     APPLY  SHARED-MODE  ON  T-M
000330     APPLY  SHIFT-CODE   ON  SP-F.
000340 DATA                DIVISION.
000350 FILE                SECTION.
000360 COPY  LITCM.
000370 COPY  LITM.
000380 FD  TMW                                                          I.051029
000390     BLOCK  1 RECORDS                                             I.051029
000400     LABEL RECORD IS STANDARD                                     I.051029
000410     VALUE OF IDENTIFICATION WK0512ID.                            I.051029
000420 01  TMW-R.                                                       I.051029
000430     02  TMW-KEY2.                                                I.051029
000440       03  TMW-NTCD     PIC  9(004).                              I.051029
000450       03  TMW-KEY.                                               I.051029
000460         04  TMW-TCD    PIC  9(004).                              I.051029
000470     02  TMW-NAME       PIC  N(026).                              I.051029
000480     02  TMW-JSU        PIC  N(020).                              I.051029
000490     02  TMW-JSS        PIC  N(020).                              I.051029
000500     02  TMW-UNO        PIC  X(008).                              I.051029
000510     02  TMW-TEL        PIC  X(014).                              I.051029
000520     02  TMW-FAX        PIC  X(014).                              I.051029
000530     02  TMW-FKC        PIC  9(002).                              I.051029
000540     02  TMW-BC         PIC  9(001).                              I.051029
000550     02  F              PIC  9(002).                              I.051029
000560     02  TMW-TNC        PIC  9(002).                              I.051029
000570     02  TMW-SS         PIC  9(002).                              I.051029
000580     02  TMW-NKY        PIC  9(003).                              I.051029
000590     02  TMW-DCC        PIC  9(001).                              I.051029
000600     02  TMW-TGC        PIC  9(001).                              I.051029
000610     02  TMW-YG         PIC  9(006).                              I.051029
000620     02  TMW-BIK        PIC  9(001).                              I.051029
000630     02  TMW-ZEI        PIC  9(001).                              I.051029
000640     02  F              PIC  X(009).                              I.051029
000650     02  TMW-TNA        PIC  N(016).                              I.051029
000660     02  TMW-SNA        PIC  N(026).                              I.051029
000670     02  TMW-SJSU       PIC  N(020).                              I.051029
000680     02  TMW-SJSS       PIC  N(020).                              I.051029
000690     02  TMW-SUNO       PIC  X(008).                              I.051029
000700     02  TMW-STEL       PIC  X(014).                              I.051029
000710     02  TMW-SFAX       PIC  X(014).                              I.051029
000720     02  TMW-SHD        PIC  9(002).                              I.051029
000730     02  TMW-SSI        PIC  9(003).                              I.051029
000740     02  TMW-SHC1       PIC  9(001).                              I.051029
000750     02  TMW-SHC2       PIC  9(001).                              I.051029
000760     02  TMW-SGT        PIC  9(001).                              I.051029
000770     02  TMW-SGR        PIC  9(001)V9(01).                        I.051029
000780     02  TMW-STT        PIC  9(001).                              I.051029
000790     02  TMW-STR        PIC  9(001)V9(01).                        I.051029
000800     02  TMW-SKR        PIC  9(004).                              I.051029
000810     02  F              PIC  9(001).                              I.051029
000820     02  TMW-KSC        PIC  9(001).                              I.051029
000830     02  TMW-SSC        PIC  9(001).                              I.051029
000840*
000850     02  F              PIC  X(035).                              I.051029
000860     02  TMW-KANA       PIC  X(036).                              I.051029
000870     02  TMW-DNG        PIC  9(006).                              I.051029
000880     02  TMW-SNG        PIC  9(004).                              I.051029
000890     02  TMW-ENG        PIC  9(004).                              I.051029
000900 FD  SP-F
000910     LABEL  RECORD  IS  OMITTED
000920*****LINAGE  IS  10  LINES.                                       D.120830
000930     LINAGE  IS  11  LINES.                                       I.120830
000940 01  SP-R                      PIC X(204).
000950 WORKING-STORAGE     SECTION.
000960 77  WK0512ID           PIC  X(009) VALUE SPACE.                  I.051029
000970 01  STN-NO.                                                      I.051029
000980     02  STN-NO1        PIC  X(003).                              I.051029
000990     02  STN-NO2        PIC  X(003).                              I.051029
001000 01  W-FID.                                                       I.051029
001010     02  W-FID1         PIC  X(006) VALUE "WK0512".               I.051029
001020     02  W-FID2         PIC  X(003).                              I.051029
001030 01  JS-SIGN                   PIC 9(001).                        I.970618
001040 01  W-15K                     PIC X(005)    VALUE ""3FE04F40A0"".
001050 01  W-P1.
001060     02  P-15K                 PIC X(005).
001070     02  P-UM1                 PIC N(002).
001080*****02  P-UB1                 PIC X(006).                        D.970128
001090*****02  F                     PIC X(026).                        D.970128
001100     02  P-UB1                 PIC X(008).                        I.970128
001110     02  F                     PIC X(024).                        I.970128
001120     02  P-UM2                 PIC N(002).
001130*****02  P-UB2                 PIC X(006).                        D.970128
001140*****02  F                     PIC X(026).                        D.970128
001150     02  P-UB2                 PIC X(008).                        I.970128
001160     02  F                     PIC X(024).                        I.970128
001170     02  P-UM3                 PIC N(002).
001180*****02  P-UB3                 PIC X(006).                        D.970128
001190*****02  F                     PIC X(026).                        D.970128
001200     02  P-UB3                 PIC X(008).                        I.970128
001210     02  F                     PIC X(024).                        I.970128
001220     02  P-UM4                 PIC N(002).
001230*****02  P-UB4                 PIC X(006).                        D.970128
001240     02  P-UB4                 PIC X(008).                        I.970128
001250 01  W-P2.
001260*****02  F                     PIC X(001).                        D.020422
001270     02  P-JU1                 PIC N(020).
001280     02  F                     PIC X(005).
001290     02  P-JU2                 PIC N(020).
001300     02  F                     PIC X(005).
001310     02  P-JU3                 PIC N(020).
001320     02  F                     PIC X(005).
001330     02  P-JU4                 PIC N(020).
001340 01  W-P3.
001350*****02  F                     PIC X(001).                        D.020422
001360     02  P-JS1                 PIC N(020).
001370     02  F                     PIC X(005).
001380     02  P-JS2                 PIC N(020).
001390     02  F                     PIC X(005).
001400     02  P-JS3                 PIC N(020).
001410     02  F                     PIC X(005).
001420     02  P-JS4                 PIC N(020).
001430*01  W-P4.                                                        D.020422
001440*****02  F                     PIC X(013).                        D.020422
001450*****02  P-JC1                 PIC N(012).                        D.020422
001460*****02  F                     PIC X(017).                        D.020422
001470*****02  P-JC2                 PIC N(012).                        D.020422
001480*****02  F                     PIC X(017).                        D.020422
001490*****02  P-JC3                 PIC N(012).                        D.020422
001500*****02  F                     PIC X(017).                        D.020422
001510*****02  P-JC4                 PIC N(012).                        D.020422
001520 01  W-P5.
001530     02  F                     PIC X(001).
001540     02  P-NA1                 PIC N(020).
001550     02  F                     PIC X(005).
001560     02  P-NA2                 PIC N(020).
001570     02  F                     PIC X(005).
001580     02  P-NA3                 PIC N(020).
001590     02  F                     PIC X(005).
001600     02  P-NA4                 PIC N(020).
001610 01  W-P6.
001620     02  F                     PIC X(001).
001630     02  P-NA5                 PIC N(020).
001640     02  F                     PIC X(005).
001650     02  P-NA6                 PIC N(020).
001660     02  F                     PIC X(005).
001670     02  P-NA7                 PIC N(020).
001680     02  F                     PIC X(005).
001690     02  P-NA8                 PIC N(020).
001700 01  W-DATA.
001710     02  W-TPC                 PIC 9(001).
001720     02  W-STCD                PIC 9(004).                        I.051029
001730     02  W-ETCD                PIC 9(004).                        I.051029
001740     02  W-STNC                PIC 9(002).                        I.150317
001750     02  W-ETNC                PIC 9(002).                        I.150317
001760     02  W-DMM                 PIC 9(001).
001770     02  W-EC                  PIC 9(001).
001780     02  W-C                   PIC 9(002).
001790     02  W-ZC                  PIC 9(002).
001800     02  W-L                   PIC 9(002).
001810     02  CNT                   PIC 9(002).
001820     02  CNTD                  PIC 9(002).
001830     02  CNTE                  PIC 9(002).
001840     02  CNTF                  PIC 9(002).
001850     02  CNTG                  PIC 9(002).
001860     02  CNTH                  PIC 9(002).
001870     02  W-OLD                 PIC 9(007).                        I.980629
001880     02  W-AD.
001890         03  W-D    OCCURS  16.
001900             04  W-KEY         PIC 9(007).
001910             04  W-KEYD    REDEFINES  W-KEY.
001920                 05  W-KEY1    PIC 9(004).
001930                 05  W-KEY2    PIC 9(003).
001940             04  W-NAME        PIC N(026).                        I.020422
001950             04  W-JSU         PIC N(020).                        I.020422
001960             04  W-JSS         PIC N(020).                        I.020422
001970*****        04  W-NAME        PIC N(024).                        D.020422
001980*****        04  W-JSU         PIC N(024).                        D.020422
001990*****        04  W-JSS         PIC N(012).                        D.020422
002000*****        04  W-UNO         PIC X(006).                        D.970128
002010             04  W-UNO         PIC X(008).                        I.970128
002020     02  W-BD.                                                    I.990602
002030         03  W-BKEY            PIC 9(007).                        I.990602
002040         03  W-BNAME           PIC N(026).                        I.020422
002050         03  W-BJSU            PIC N(020).                        I.020422
002060         03  W-BJSS            PIC N(020).                        I.020422
002070*****    03  W-BNAME           PIC N(024).                        D.020422
002080*****    03  W-BJSU            PIC N(024).                        D.020422
002090*****    03  W-BJSS            PIC N(012).                        D.020422
002100         03  W-BNO             PIC X(008).                        I.990602
002110*****02  W-NMD                 PIC N(027).                        D.020422
002120*****02  W-NAD             REDEFINES  W-NMD.                      D.020422
002130*****    03  W-NA              PIC N(001)    OCCURS  27.          D.020422
002140*****02  W-NUR                 PIC N(020).                        D.020422
002150*****02  W-NUD             REDEFINES  W-NUR.                      D.020422
002160*****    03  W-NU              PIC N(001)    OCCURS  20.          D.020422
002170*****02  W-NSR                 PIC N(020).                        D.020422
002180*****02  W-NSD             REDEFINES  W-NSR.                      D.020422
002190*****    03  W-NS              PIC N(001)    OCCURS  20.          D.020422
002200*****02  W-JUR                 PIC N(024).                        D.020422
002210*****02  W-JUD             REDEFINES  W-JUR.                      D.020422
002220*****    03  W-JU              PIC N(001)    OCCURS  24.          D.020422
002230*****02  W-ADRU                PIC N(020).                        D.020422
002240*****02  W-ADDU            REDEFINES  W-ADRU.                     D.020422
002250*****    03  W-ADU             PIC N(001)    OCCURS  20.          D.020422
002260*****02  W-ADRN                PIC N(020).                        D.020422
002270*****02  W-ADDN            REDEFINES  W-ADRN.                     D.020422
002280*****    03  W-ADN             PIC N(001)    OCCURS  20.          D.020422
002290     02  W-END                 PIC 9(001) VALUE 0.                I.970618
002300 01  WN-AREA.                                                     I.020422
002310     02  WN-DCHK        PIC  9(001).                              I.020422
002320     02  WN-CNT1        PIC  9(002).                              I.020422
002330     02  WN-CNT2        PIC  9(002).                              I.020422
002340     02  WN-CNT3        PIC  9(002).                              I.020422
002350     02  WN-CNT4        PIC  9(002).                              I.020422
002360     02  WN-NAME        PIC  N(026).                              I.020422
002370     02  WN-ANA   REDEFINES WN-NAME.                              I.020422
002380       03  WN-NAD   OCCURS  26.                                   I.020422
002390         04  WN-NA      PIC  N(001).                              I.020422
002400     02  WN-WNAME       PIC  N(026).                              I.020422
002410     02  WN-WANA   REDEFINES WN-WNAME.                            I.020422
002420       03  WN-WNAD   OCCURS  26.                                  I.020422
002430         04  WN-WNA     PIC  N(001).                              I.020422
002440     02  WN-ONAME       PIC  N(019).                              I.020422
002450     02  WN-AONA  REDEFINES WN-ONAME.                             I.020422
002460       03  WN-ONAD  OCCURS  19.                                   I.020422
002470         04  WN-ONA     PIC  N(001).                              I.020422
002480     02  WN-UNAME       PIC  N(019).                              I.020422
002490     02  WN-AUNA  REDEFINES WN-UNAME.                             I.020422
002500       03  WN-UNAD  OCCURS  19.                                   I.020422
002510         04  WN-UNA     PIC  N(001).                              I.020422
002520     02  WN-KUM         PIC  N(004).                              I.020422
002530     02  WN-AKUM  REDEFINES WN-KUM.                               I.020422
002540       03  WN-KUMD  OCCURS   4.                                   I.020422
002550         04  WN-KU      PIC  N(001).                              I.020422
002560 01  ERR-STAT                  PIC X(002).
002570     COPY LSTAT.
002580 SCREEN              SECTION.
002590 SD  C-CRT
002600     END  STATUS  IS  ESTAT.
002610 01  C-CLEAR.
002620     02  C-CL  LINE  1    CLEAR  SCREEN.
002630 01  C-MID.
002640     02  LINE   3    COLUMN  10    PIC N(024)    VALUE
002650           NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002660     02  LINE   4    COLUMN  10    PIC N(024)    VALUE
002670           NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002680     02  LINE   5    COLUMN  10    PIC N(024)    VALUE
002690           NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002700     02  LINE   6    COLUMN  10    PIC N(024)    VALUE
002710*****      NC"＊＊＊　　直送先・得意先シール　作成　　＊＊＊".    D.970618
002720           NC"＊＊＊　　　郵便　宛名シール　作成　　　＊＊＊".    I.970618
002730     02  LINE   7    COLUMN  10    PIC N(024)    VALUE
002740           NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
002750     02  LINE   8    COLUMN  10    PIC N(024)    VALUE
002760           NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002770     02  LINE   9    COLUMN  10    PIC N(024)    VALUE
002780           NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002790     02  LINE  15    COLUMN  12    PIC X(038)    VALUE
002800             "[  TEST PRINT  ｽﾙ=9  ｼﾅｲ=1     ﾘﾀｰﾝ  ]".
002810 01  C-MID1.
002820     02  LINE   1    COLUMN  12    PIC N(024)    VALUE
002830           NC"＊＊＊　　直送先・得意先シール　作成　　＊＊＊".
002840*****02  LINE   2    COLUMN  68    PIC X(008)    VALUE            D.980629
002850*****        "終了=PF9".                                          D.980629
002860     02  LINE   2    COLUMN  58    PIC X(018)    VALUE            I.980629
002870             "同上=F5 , 終了=F9 ".                                I.091015
002880*****        "同上=Ⅱ , 終了=PF9".                                D.091015
002890     02  LINE   3.
002900         03  COLUMN   8    PIC X(026)    VALUE
002910               "ｺｰﾄﾞ      直送先・得意先名".
002920         03  COLUMN  68    PIC X(012)    VALUE
002930               "確認=F10    ".                                    I.091015
002940*****          "確認=ADVANCE".                                    D.091015
002950     02  LINE  23    COLUMN  40    PIC X(022)    VALUE
002960               "確認  OK=1 NO=9   ﾘﾀｰﾝ".
002970 01  C-MID2.                                                      I.970618
002980     02  LINE   1    COLUMN  20    PIC N(020)    VALUE            I.970618
002990           NC"＊＊＊　　郵便宛名シール　作成　　＊＊＊".          I.970618
003000     02  LINE   5.                                                I.970618
003010         03  COLUMN  11    PIC N(004)    VALUE                    I.970618
003020           NC"郵便番号".                                          I.970618
003030         03  COLUMN  33    PIC X(008)    VALUE                    I.970618
003040             "終了=F9 ".                                          I.091012
003050*****        "終了=PF9".                                          D.091012
003060     02  LINE   7    COLUMN  11    PIC X(008)    VALUE            I.970618
003070             "住所(上)".                                          I.970618
003080     02  LINE   8    COLUMN  11    PIC X(008)    VALUE            I.970618
003090             "    (下)".                                          I.970618
003100     02  LINE  10    COLUMN  11    PIC N(004)    VALUE            I.970618
003110           NC"氏　　名".                                          I.970618
003120     02  LINE  11    COLUMN  60    PIC N(007)    VALUE            I.970618
003130           NC"様・殿の入力要".                                    I.970618
003140     02  LINE  23    COLUMN  40    PIC X(022)    VALUE
003150               "確認  OK=1 NO=9  1ﾘﾀｰﾝ".
003160 01  C-MID3.                                                      I.051029
003170     02  LINE   1    COLUMN  20    PIC N(020)    VALUE            I.051029
003180           NC"＊＊＊　　郵便宛名シール　作成　　＊＊＊".          I.051029
003190     02  LINE   6    COLUMN  28    PIC X(024)    VALUE            I.150317
003200             "担当者ｺｰﾄﾞ    00 ～ 99  ".                          I.150317
003210     02  LINE   8    COLUMN  28    PIC X(024)    VALUE            I.051029
003220             "得意先ｺｰﾄﾞ  0000 ～ 9999".                          I.051029
003230     02  LINE  23    COLUMN  40    PIC X(022)    VALUE            I.051029
003240               "確認  OK=1 NO=9   ﾘﾀｰﾝ".                          I.051029
003250 01  C-ACP.
003260     02  A-TPC      LINE  15     COLUMN  41    PIC 9(001)
003270           USING  W-TPC       CHECK  OVERFLOW  NO  IFC.
003280     02  A-KEY      LINE  W-L    COLUMN   8    PIC 9(007)
003290           USING  W-KEY(W-C)  CHECK  OVERFLOW  NO  IFC.
003300*
003310     02  A-UNO      LINE    5    COLUMN  21    PIC X(008)         I.970618
003320           USING  W-UNO(W-C)  CHECK  OVERFLOW  NO  IFC.           I.970618
003330*****02  A-JSU      LINE    7    COLUMN  21    PIC N(024)         D.020422
003340     02  A-JSU      LINE    7    COLUMN  21    PIC N(020)         I.020422
003350           USING  W-JSU(W-C)  CHECK  OVERFLOW  NO  IFC.           I.970618
003360*****02  A-JSS      LINE    8    COLUMN  21    PIC N(012)         D.020422
003370     02  A-JSS      LINE    8    COLUMN  21    PIC N(020)         I.020422
003380           USING  W-JSS(W-C)  CHECK  OVERFLOW  NO  IFC.           I.970618
003390*****02  A-NAME     LINE   10    COLUMN  21    PIC N(024)         D.020422
003400     02  A-NAME     LINE   10    COLUMN  21    PIC N(026)         I.020422
003410           USING  W-NAME(W-C) CHECK  OVERFLOW  NO  IFC.           I.970618
003420*
003430     02  LINE   6.                                                I.150317
003440       03  A-STNC     COLUMN  42    PIC 9(002)                    I.150317
003450             USING  W-STNC      CHECK  OVERFLOW  NO  IFC.         I.150317
003460       03  A-ETNC     COLUMN  48    PIC 9(002)                    I.150317
003470             USING  W-ETNC      CHECK  OVERFLOW  NO  IFC.         I.150317
003480     02  LINE   8.                                                I.051029
003490       03  A-STCD     COLUMN  40    PIC 9(004)                    I.051029
003500             USING  W-STCD      CHECK  OVERFLOW  NO  IFC.         I.051029
003510       03  A-ETCD     COLUMN  48    PIC 9(004)                    I.051029
003520             USING  W-ETCD      CHECK  OVERFLOW  NO  IFC.         I.051029
003530*
003540     02  A-DMM      LINE  23     COLUMN  57    PIC 9(001)
003550           USING  W-DMM       CHECK  OVERFLOW  NO  IFC.
003560 01  C-DSP.
003570*****02  D-NAME     LINE  W-L    COLUMN  18    PIC N(024)         D.020422
003580     02  D-NAME     LINE  W-L    COLUMN  18    PIC N(026)         I.020422
003590                                                FROM  W-NAME(W-C).
003600     02  D-CLEAR    LINE  W-L.
003610         03  COLUMN  13    PIC X(007)    VALUE  "       ".
003620         03  COLUMN  18    PIC X(052)    VALUE                    I.020422
003630          "                                                    ". I.020422
003640*****    03  COLUMN  18    PIC X(048)    VALUE                    D.020422
003650*****          "                                                ".D.020422
003660 01  C-ERR.
003670     02  LINE  24.
003680         03  E-ME1   COLUMN 15   PIC X(026)   VALUE
003690               "***  ﾁｮｸｿｳｻｷ･ﾄｸｲｻｷ ﾅｼ  ***".
003700         03  E-ME98  COLUMN 75   PIC X(005)   VALUE ""27"J"05"".
003710         03  E-ME99  COLUMN 75   PIC X(005)   VALUE ""27"B"05"".
003720         03  E-STAT  COLUMN 10   PIC X(002)   FROM  ERR-STAT.
003730         03  E-CL    COLUMN 10   PIC X(050)   VALUE
003740             "                                                  ".
003750 PROCEDURE           DIVISION.
003760 M-05.
003770     ACCEPT JS-SIGN.                                              I.970618
003780*****IF JS-SIGN > 1                                               D.051029
003790     IF JS-SIGN > 2                                               I.051029
003800         STOP RUN.                                                I.970618
003810     DISPLAY  C-CLEAR.
003820     DISPLAY  C-MID.
003830     OPEN  OUTPUT  SP-F.
003840 M-10.
003850     ACCEPT  A-TPC.
003860     IF  ESTAT = PF9
003870         CLOSE  SP-F
003880         DISPLAY  C-CLEAR
003890         STOP  RUN.
003900     IF  ESTAT NOT = HTB AND SKP
003910         GO  TO  M-10.
003920     IF  W-TPC = 1
003930         GO  TO  M-12.                                            I.970618
003940*****    OPEN  INPUT  TC-M                                        D.970618
003950*****    OPEN  INPUT  T-M                                         D.970618
003960*****    GO  TO  M-15.                                            D.970618
003970     IF  W-TPC NOT = 9
003980         GO  TO  M-10.
003990*****MOVE  SPACE       TO  W-P1    W-P2    W-P3    W-P4    W-P5   D.020422
004000*****                      W-P6    W-NSR.                         D.020422
004010     MOVE  SPACE       TO  W-P1    W-P2    W-P3    W-P5    W-P6.  I.020422
004020     MOVE  W-15K       TO  P-15K.
004030     MOVE  NC"〒　"    TO  P-UM1     P-UM2     P-UM3     P-UM4.
004040*****MOVE  "XXXXXX"    TO  P-UB1     P-UB2     P-UB3     P-UB4.   D.970128
004050     MOVE  "XXXXXXXX"  TO  P-UB1     P-UB2     P-UB3     P-UB4.   I.970128
004060     MOVE  ALL NC"Ｎ"  TO  P-JU1     P-JU2     P-JU3     P-JU4
004070                           P-JS1     P-JS2     P-JS3     P-JS4.   I.020422
004080     MOVE  NC"ＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮＮ　"  TO       I.020422
004090         P-NA1  P-NA2  P-NA3  P-NA4  P-NA5  P-NA6  P-NA7  P-NA8.  I.020422
004100*****                      P-JS1     P-JS2     P-JS3     P-JS4    D.020422
004110*****                      P-JC1     P-JC2     P-JC3     P-JC4    D.020422
004120*****                      P-NA1     P-NA2     P-NA3     P-NA4.   D.020422
004130*****PERFORM  S-110  THRU  S-120.                                 D.020422
004140*****MOVE  W-NSR      TO  P-NA5  P-NA6  P-NA7  P-NA8.             D.020422
004150     PERFORM  S-05  THRU  S-10.
004160     GO  TO  M-10.
004170 M-12.                                                            I.970618
004180     IF JS-SIGN = 0                                               I.970618
004190         MOVE ZERO TO W-OLD                                       I.980629
004200         OPEN  INPUT  TC-M                                        I.970618
004210         OPEN  INPUT  T-M                                         I.051029
004220       ELSE                                                       I.051029
004230         CALL "CBLSTNNO" USING STN-NO                             I.051029
004240         MOVE STN-NO2 TO W-FID2                                   I.051029
004250         MOVE W-FID TO WK0512ID                                   I.051029
004260         OPEN  INPUT  TMW.                                        I.970618
004270     INITIALIZE W-BD.                                             I.990602
004280 M-15.
004290     DISPLAY  C-CLEAR.
004300     IF JS-SIGN = 0                                               I.970618
004310         DISPLAY  C-MID1.
004320     IF JS-SIGN = 1                                               I.970618
004330         DISPLAY  C-MID2.                                         I.970618
004340     IF JS-SIGN = 2                                               I.051029
004350         MOVE 9999 TO W-ETCD                                      I.151102
004360         MOVE 99 TO W-ETNC                                        I.151102
004370         DISPLAY  C-MID3.                                         I.051029
004380     MOVE  ZERO  TO  W-C  W-EC.
004390     PERFORM  S-15  THRU  S-25.
004400     IF JS-SIGN = 1                                               I.970618
004410         GO TO M-41.                                              I.970618
004420     IF JS-SIGN = 2                                               I.051029
004430         GO TO M-57.                                              I.051029
004440     MOVE  3     TO  W-L.
004450 M-20.
004460     ADD  1  TO  W-C  W-L.
004470     IF  W-C > 16
004480         GO  TO  M-50.
004490     IF  W-EC NOT = ZERO
004500         GO  TO  M-40.
004510 M-25.
004520     ACCEPT  A-KEY.
004530     DISPLAY  E-CL.
004540     IF  ESTAT = BTB
004550         GO  TO  M-35.
004560*****IF  ESTAT = C2                                               D.091015
004570     IF  ESTAT = PF5                                              I.091015
004580         IF W-OLD NOT = ZERO                                      I.980629
004590             MOVE W-OLD TO W-KEY(W-C)                             I.980629
004600             DISPLAY A-KEY                                        I.980629
004610             GO TO M-27.                                          I.980629
004620     IF  ESTAT = ADV
004630         MOVE  1  TO  W-EC
004640         GO  TO  M-40.
004650     IF  ESTAT = PF9
004660         IF  W-C = 1
004670             GO  TO  M-95.
004680     IF  ESTAT NOT = HTB AND SKP
004690         GO  TO  M-25.
004700 M-27.                                                            I.980629
004710     MOVE  W-KEY(W-C)  TO  TC-KEY
004720     READ  TC-M  WITH  UNLOCK  INVALID  KEY
004730         GO  TO  M-30.
004740     MOVE  TC-NAME  TO  W-NAME(W-C).
004750     MOVE  TC-JSU   TO  W-JSU(W-C).
004760     MOVE  TC-JSS   TO  W-JSS(W-C).
004770     MOVE  TC-UNO   TO  W-UNO(W-C).
004780     DISPLAY  D-NAME.
004790     MOVE  W-KEY(W-C)  TO  W-OLD.                                 I.980629
004800     GO  TO  M-20.
004810 M-30.
004820     MOVE  W-KEY1(W-C)  TO  T-KEY.
004830     READ  T-M  WITH  UNLOCK  INVALID  KEY
004840         DISPLAY  E-ME1  E-ME98                                   I.970618
004850         GO  TO  M-25.                                            I.970618
004860*****    GO  TO  M-31.                                            D.970618
004870     MOVE  T-NAME  TO  W-NAME(W-C).
004880     MOVE  T-JSU   TO  W-JSU(W-C).
004890     MOVE  T-JSS   TO  W-JSS(W-C).
004900     MOVE  T-UNO   TO  W-UNO(W-C).
004910     DISPLAY  D-NAME.
004920     MOVE  W-KEY(W-C)  TO  W-OLD.                                 I.020422
004930     GO  TO  M-20.
004940*M-31.                                                            D.970618
004950*****DISPLAY  E-ME1  E-ME98.                                      D.970618
004960*****GO  TO  M-25.                                                D.970618
004970 M-35.
004980     SUBTRACT  1  FROM  W-C  W-L.
004990     IF  W-C = ZERO
005000         GO  TO  M-15.
005010     IF  W-KEY(W-C) = ZERO
005020         GO  TO  M-35.
005030     GO  TO  M-25.
005040 M-40.
005050     MOVE  ZERO   TO  W-KEY(W-C).
005060     MOVE  SPACE  TO  W-NAME(W-C)  W-JSU(W-C)  W-JSS(W-C).
005070     MOVE  SPACE  TO  W-UNO(W-C).
005080     DISPLAY  D-CLEAR.
005090     GO  TO  M-20.
005100 M-41.                                                            I.970618
005110     ADD  1  TO  W-C.                                             I.970618
005120     IF W-C = 17                                                  I.970618
005130         GO TO M-52.                                              I.970618
005140     IF W-C = 1                                                   I.990602
005150         IF W-BNAME NOT = SPACE                                   I.990602
005160             MOVE W-BD TO W-D(W-C)                                I.990602
005170             DISPLAY A-UNO A-JSU A-JSS A-NAME.                    I.990602
005180 M-42.                                                            I.970618
005190     ACCEPT A-UNO.                                                I.970618
005200     IF ESTAT = PF9                                               I.970618
005210         MOVE 9 TO W-END                                          I.970618
005220         GO TO M-52.                                              I.970618
005230     IF ESTAT NOT = HTB AND SKP                                   I.970618
005240         GO TO M-42.                                              I.970618
005250 M-43.                                                            I.970618
005260     ACCEPT A-JSU.                                                I.970618
005270     IF ESTAT = BTB                                               I.970618
005280         GO TO M-42.                                              I.970618
005290     IF ESTAT NOT = HTB AND SKP                                   I.970618
005300         GO TO M-43.                                              I.970618
005310 M-44.                                                            I.970618
005320     ACCEPT A-JSS.                                                I.970618
005330     IF ESTAT = BTB                                               I.970618
005340         GO TO M-43.                                              I.970618
005350     IF ESTAT NOT = HTB AND SKP                                   I.970618
005360         GO TO M-44.                                              I.970618
005370 M-45.                                                            I.970618
005380     ACCEPT A-NAME.                                               I.970618
005390     IF ESTAT = BTB                                               I.970618
005400         GO TO M-44.                                              I.970618
005410     IF ESTAT NOT = HTB AND SKP                                   I.970618
005420         GO TO M-45.                                              I.970618
005430 M-50.
005440     ACCEPT  A-DMM.
005450     IF  ESTAT = BTB
005460         IF JS-SIGN = 1                                           I.970618
005470             GO TO M-45                                           I.970618
005480           ELSE                                                   I.970618
005490             MOVE  ZERO  TO  W-EC
005500             GO  TO  M-35.
005510     IF  ESTAT NOT = HTB AND SKP
005520         GO  TO  M-50.
005530     IF  W-DMM = 9
005540         IF JS-SIGN = 1                                           I.970618
005550             GO TO M-42                                           I.970618
005560           ELSE                                                   I.970618
005570             MOVE  ZERO  TO  W-C  W-EC
005580             MOVE  3     TO  W-L
005590             GO  TO  M-20.
005600     IF  W-DMM NOT = 1
005610         GO  TO  M-50.
005620     IF JS-SIGN = 1                                               I.970618
005630         MOVE 9999999 TO W-KEY(W-C)                               I.970618
005640         MOVE W-D(W-C) TO W-BD                                    I.990602
005650         DISPLAY  C-MID2                                          I.970618
005660         GO TO M-41.                                              I.970618
005670 M-52.                                                            I.970618
005680     MOVE  ZERO  TO  W-C  CNT.
005690 M-55.
005700     ADD  1  TO  W-C.
005710     IF  W-C > 16
005720         GO  TO  M-80.
005730     IF  W-KEY(W-C) = ZERO
005740         GO  TO  M-80.
005750*****PERFORM  S-30  THRU  S-40.                                   D.020422
005760*****PERFORM  S-90  THRU  S-105.                                  D.020422
005770     MOVE W-NAME(W-C) TO WN-NAME.                                 I.020422
005780     PERFORM NAM-RTN THRU NAM-EX.                                 I.020422
005790     IF  CNT = ZERO
005800         MOVE  SPACE  TO  W-P1  W-P2  W-P3  W-P5  W-P6            I.020422
005810*****    MOVE  SPACE  TO  W-P1  W-P2  W-P3  W-P4  W-P5  W-P6      D.020422
005820         MOVE  W-15K  TO  P-15K.
005830     ADD  1  TO  CNT.
005840     IF  CNT = 1
005850         MOVE  NC"〒　"    TO  P-UM1
005860         MOVE  W-UNO(W-C)  TO  P-UB1
005870         MOVE  W-JSU(W-C)  TO  P-JU1                              I.020422
005880         MOVE  W-JSS(W-C)  TO  P-JS1                              I.020422
005890         MOVE  WN-ONAME    TO  P-NA1                              I.020422
005900         MOVE  WN-UNAME    TO  P-NA5                              I.020422
005910*****    MOVE  W-ADRU      TO  P-JU1                              D.020422
005920*****    MOVE  W-ADRN      TO  P-JS1                              D.020422
005930*****    MOVE  W-JSS(W-C)  TO  P-JC1                              D.020422
005940*****    MOVE  W-NUR       TO  P-NA1                              D.020422
005950*****    MOVE  W-NSR       TO  P-NA5                              D.020422
005960         GO  TO  M-55.
005970     IF  CNT = 2
005980         MOVE  NC"〒　"    TO  P-UM2
005990         MOVE  W-UNO(W-C)  TO  P-UB2
006000         MOVE  W-JSU(W-C)  TO  P-JU2                              I.020422
006010         MOVE  W-JSS(W-C)  TO  P-JS2                              I.020422
006020         MOVE  WN-ONAME    TO  P-NA2                              I.020422
006030         MOVE  WN-UNAME    TO  P-NA6                              I.020422
006040*****    MOVE  W-ADRU      TO  P-JU2                              D.020422
006050*****    MOVE  W-ADRN      TO  P-JS2                              D.020422
006060*****    MOVE  W-JSS(W-C)  TO  P-JC2                              D.020422
006070*****    MOVE  W-NUR       TO  P-NA2                              D.020422
006080*****    MOVE  W-NSR       TO  P-NA6                              D.020422
006090         GO  TO  M-55.
006100     IF  CNT = 3
006110         MOVE  NC"〒　"    TO  P-UM3
006120         MOVE  W-UNO(W-C)  TO  P-UB3
006130         MOVE  W-JSU(W-C)  TO  P-JU3                              I.020422
006140         MOVE  W-JSS(W-C)  TO  P-JS3                              I.020422
006150         MOVE  WN-ONAME    TO  P-NA3                              I.020422
006160         MOVE  WN-UNAME    TO  P-NA7                              I.020422
006170*****    MOVE  W-ADRU      TO  P-JU3                              D.020422
006180*****    MOVE  W-ADRN      TO  P-JS3                              D.020422
006190*****    MOVE  W-JSS(W-C)  TO  P-JC3                              D.020422
006200*****    MOVE  W-NUR       TO  P-NA3                              D.020422
006210*****    MOVE  W-NSR       TO  P-NA7                              D.020422
006220         GO  TO  M-55.
006230     MOVE  NC"〒　"    TO  P-UM4.
006240     MOVE  W-UNO(W-C)  TO  P-UB4.
006250     MOVE  W-JSU(W-C)  TO  P-JU4.                                 I.020422
006260     MOVE  W-JSS(W-C)  TO  P-JS4.                                 I.020422
006270     MOVE  WN-ONAME    TO  P-NA4.                                 I.020422
006280     MOVE  WN-UNAME    TO  P-NA8.                                 I.020422
006290*****MOVE  W-ADRU      TO  P-JU4.                                 D.020422
006300*****MOVE  W-ADRN      TO  P-JS4.                                 D.020422
006310*****MOVE  W-JSS(W-C)  TO  P-JC4.                                 D.020422
006320*****MOVE  W-NUR       TO  P-NA4.                                 D.020422
006330*****MOVE  W-NSR       TO  P-NA8.                                 D.020422
006340     PERFORM  S-05  THRU  S-10.
006350     MOVE  ZERO  TO  CNT.
006360     GO  TO  M-55.
006370*-------------------------------------------------------------------------
006380 M-57.                                                            I.051029
006390     ACCEPT A-STNC.                                               I.150317
006400     DISPLAY  E-CL.                                               I.150317
006410     IF  ESTAT = PF9                                              I.150317
006420             GO  TO  M-95.                                        I.150317
006430     IF  ESTAT NOT = HTB AND SKP                                  I.150317
006440         GO  TO  M-57.                                            I.150317
006450 M-58.                                                            I.150317
006460     ACCEPT A-ETNC.                                               I.150317
006470     DISPLAY  E-CL.                                               I.150317
006480     IF  ESTAT = BTB                                              I.150317
006490         GO  TO  M-57.                                            I.150317
006500     IF  ESTAT NOT = HTB AND SKP                                  I.150317
006510         GO  TO  M-58.                                            I.150317
006520     IF  W-STNC > W-ETNC                                          I.150317
006530         GO  TO  M-58.                                            I.150317
006540 M-60.                                                            I.051029
006550     ACCEPT A-STCD.                                               I.051029
006560     DISPLAY  E-CL.                                               I.051029
006570*****IF  ESTAT = PF9                                              D.150317
006580*****        GO  TO  M-95.                                        D.150317
006590     IF  ESTAT = BTB                                              I.150317
006600         GO  TO  M-58.                                            I.150317
006610     IF  ESTAT NOT = HTB AND SKP                                  I.051029
006620         GO  TO  M-60.                                            I.051029
006630 M-62.                                                            I.051029
006640     ACCEPT A-ETCD.                                               I.051029
006650     DISPLAY  E-CL.                                               I.051029
006660     IF  ESTAT = BTB                                              I.051029
006670         GO  TO  M-60.                                            I.051029
006680     IF  ESTAT NOT = HTB AND SKP                                  I.051029
006690         GO  TO  M-62.                                            I.051029
006700     IF  W-STCD > W-ETCD                                          I.051029
006710         GO  TO  M-62.                                            I.051029
006720 M-65.                                                            I.051029
006730     ACCEPT A-DMM.                                                I.051029
006740     DISPLAY  E-CL.                                               I.051029
006750     IF  ESTAT = BTB                                              I.051029
006760         GO  TO  M-62.                                            I.051029
006770     IF  ESTAT NOT = HTB AND SKP                                  I.051029
006780         GO  TO  M-65.                                            I.051029
006790     IF  W-DMM = 9                                                I.051029
006800         GO  TO  M-60.                                            I.051029
006810     IF  W-DMM NOT = 1                                            I.051029
006820         GO  TO  M-65.                                            I.051029
006830*
006840     MOVE  ZERO  TO  CNT.                                         I.051029
006850 M-70.                                                            I.051029
006860     READ TMW AT END                                              I.051029
006870         GO TO M-80.                                              I.051029
006880     IF TMW-TNC < W-STNC OR > W-ETNC                              I.150317
006890         GO TO M-70.                                              I.150317
006900     IF TMW-TCD < W-STCD                                          I.051029
006910         GO TO M-70.                                              I.051029
006920     IF TMW-TCD > W-ETCD                                          I.051029
006930         GO TO M-70.                                              I.150317
006940*****    GO TO M-80.                                              D.150317
006950     IF TMW-ENG NOT = ZERO                                        I.051029
006960         GO TO M-70.                                              I.051029
006970     IF TMW-JSU = SPACE                                           I.051029
006980         GO TO M-70.                                              I.051029
006990     PERFORM SET2-RTN THRU SET2-EX.                               I.051029
007000     GO TO M-70.                                                  I.051029
007010 M-80.
007020     IF  CNT NOT = ZERO
007030         PERFORM  S-05  THRU  S-10.
007040     IF JS-SIGN = 1                                               I.970618
007050         IF W-END = 9                                             I.970618
007060             GO TO M-95.                                          I.970618
007070     IF JS-SIGN = 2                                               I.051029
007080         GO TO M-95.                                              I.051029
007090     GO  TO  M-15.
007100 M-95.
007110     CLOSE  SP-F.                                                 I.970618
007120     IF JS-SIGN = 0                                               I.970618
007130         CLOSE  TC-M  T-M.                                        I.970618
007140     IF JS-SIGN = 2                                               I.051029
007150         CLOSE  TMW.                                              I.051029
007160*****CLOSE  TC-M  T-M  SP-F.                                      D.970618
007170     DISPLAY  C-CLEAR.
007180     STOP  RUN.
007190 S-05.
007200     MOVE   SPACE  TO  SP-R.
007210     MOVE   W-P1   TO  SP-R.
007220     WRITE  SP-R  AFTER  2.                                       I.020422
007230*****WRITE  SP-R.                                                 D.020422
007240     MOVE   SPACE  TO  SP-R.
007250     MOVE   W-P2   TO  SP-R.
007260     WRITE  SP-R   AFTER  2.
007270     MOVE   SPACE  TO  SP-R.
007280     MOVE   W-P3   TO  SP-R.
007290     WRITE  SP-R.
007300     MOVE   SPACE  TO  SP-R.
007310*****MOVE   W-P4   TO  SP-R.                                      D.020422
007320*****WRITE  SP-R.                                                 D.020422
007330     MOVE   SPACE  TO  SP-R.
007340     MOVE   W-P5   TO  SP-R.
007350     WRITE  SP-R   AFTER  2.
007360     MOVE   SPACE  TO  SP-R.
007370     MOVE   W-P6   TO  SP-R.
007380     WRITE  SP-R.
007390     MOVE   SPACE  TO  SP-R.
007400     WRITE  SP-R   AFTER  3.                                      I.120830
007410*****WRITE  SP-R   AFTER  2.                                      D.120830
007420 S-10.
007430     EXIT.
007440 S-15.
007450     MOVE  ZERO  TO  W-ZC.
007460 S-20.
007470     ADD  1  TO  W-ZC.
007480     IF  W-ZC > 16
007490         MOVE  ZERO   TO  W-KEY(W-ZC)
007500         MOVE  SPACE  TO  W-NAME(W-ZC)  W-JSU(W-ZC)  W-JSS(W-ZC)
007510         MOVE  SPACE  TO  W-UNO(W-ZC)
007520         GO  TO  S-20.
007530 S-25.
007540     EXIT.
007550 NAM-RTN.                                                         I.020422
007560     MOVE 0 TO WN-DCHK.                                           I.020422
007570 NAM-010.                                                         I.020422
007580     MOVE SPACE TO WN-ONAME WN-UNAME.                             I.020422
007590     MOVE 27 TO WN-CNT1.                                          I.020422
007600 NAM-020.                                                         I.020422
007610     SUBTRACT 1 FROM WN-CNT1.                                     I.020422
007620     IF WN-CNT1 = 17                                              I.020422
007630         MOVE SPACE TO WN-ONAME                                   I.020422
007640         MOVE WN-NAME TO WN-UNAME                                 I.020422
007650         GO TO NAM-510.                                           I.020422
007660     IF WN-NA(WN-CNT1) = SPACE                                    I.020422
007670         GO TO NAM-020.                                           I.020422
007680     IF WN-DCHK = 1                                               I.020422
007690         GO TO NAM-310.                                           I.020422
007700     IF WN-DCHK = 2                                               I.020422
007710         GO TO NAM-410.                                           I.020422
007720 NAM-100.                                                         I.020422
007730     MOVE 18 TO WN-CNT2.                                          I.020422
007740 NAM-110.                                                         I.020422
007750     IF WN-CNT1 < 9                                               I.020422
007760         GO TO NAM-210.                                           I.020422
007770     IF WN-NA(WN-CNT1) = SPACE                                    I.020422
007780         GO TO NAM-120.                                           I.020422
007790     SUBTRACT 1 FROM WN-CNT2.                                     I.020422
007800     IF WN-CNT2 NOT = ZERO                                        I.020422
007810         MOVE WN-NA(WN-CNT1) TO WN-UNA(WN-CNT2)                   I.020422
007820         SUBTRACT 1 FROM WN-CNT1                                  I.020422
007830         GO TO NAM-110.                                           I.020422
007840     GO TO NAM-210.                                               I.020422
007850 NAM-120.                                                         I.020422
007860     IF WN-CNT1 > 20                                              I.020422
007870         SUBTRACT 1 FROM WN-CNT1                                  I.020422
007880         GO TO NAM-110.                                           I.020422
007890*
007900     MOVE ZERO TO WN-CNT3.                                        I.020422
007910 NAM-130.                                                         I.020422
007920     ADD 1 TO WN-CNT3.                                            I.020422
007930     IF WN-CNT1 = WN-CNT3                                         I.020422
007940         GO TO NAM-510.                                           I.020422
007950     IF WN-CNT3 < 20                                              I.020422
007960         MOVE WN-NA(WN-CNT3) TO WN-ONA(WN-CNT3)                   I.020422
007970         GO TO NAM-130.                                           I.020422
007980 NAM-210.                                                         I.020422
007990     MOVE WN-NAME TO WN-WNAME.                                    I.020422
008000     MOVE SPACE TO WN-NAME.                                       I.020422
008010     MOVE ZERO TO WN-CNT1 WN-CNT2.                                I.020422
008020 NAM-220.                                                         I.020422
008030     ADD 1 TO WN-CNT1.                                            I.020422
008040     IF WN-CNT1 > 26                                              I.020422
008050         MOVE 1 TO WN-DCHK                                        I.020422
008060         GO TO NAM-010.                                           I.020422
008070     IF WN-WNA(WN-CNT1) NOT = SPACE                               I.020422
008080         ADD 1 TO WN-CNT2                                         I.020422
008090         MOVE WN-WNA(WN-CNT1) TO WN-NA(WN-CNT2).                  I.020422
008100     GO TO NAM-220.                                               I.020422
008110 NAM-310.                                                         I.020422
008120     MOVE WN-NAME TO WN-WNAME.                                    I.020422
008130     MOVE SPACE TO WN-NAME.                                       I.020422
008140     MOVE ZERO TO WN-CNT1.                                        I.020422
008150 NAM-320.                                                         I.020422
008160     ADD 1 TO WN-CNT1.                                            I.020422
008170     IF WN-CNT1 > 23                                              I.020422
008180         MOVE SPACE TO WN-NAME                                    I.020422
008190         MOVE WN-WNAME TO WN-NAME                                 I.020422
008200         GO TO NAM-410.                                           I.020422
008210     MOVE WN-WNA(WN-CNT1) TO WN-NA(WN-CNT1).                      I.020422
008220     MOVE SPACE TO WN-KUM.                                        I.020422
008230     MOVE WN-CNT1 TO WN-CNT2.                                     I.020422
008240     MOVE ZERO TO WN-CNT3.                                        I.020422
008250 NAM-330.                                                         I.020422
008260     ADD 1 TO WN-CNT3.                                            I.020422
008270     IF WN-CNT3 NOT = 5                                           I.020422
008280         MOVE WN-WNA(WN-CNT2) TO WN-KU(WN-CNT3)                   I.020422
008290         ADD 1 TO WN-CNT2                                         I.020422
008300         GO TO NAM-330.                                           I.020422
008310     IF WN-KUM NOT = NC"株式会社" AND NC"有限会社"                I.020422
008320         GO TO NAM-320.                                           I.020422
008330*
008340     IF WN-KUM = NC"株式会社"                                     I.020422
008350         MOVE NC"㈱" TO WN-NA(WN-CNT1).                           I.020422
008360     IF WN-KUM = NC"有限会社"                                     I.020422
008370         MOVE NC"㈲" TO WN-NA(WN-CNT1).                           I.020422
008380     MOVE WN-CNT1 TO WN-CNT2.                                     I.020422
008390     ADD 4 TO WN-CNT2.                                            I.020422
008400 NAM-340.                                                         I.020422
008410     ADD 1 TO WN-CNT1 WN-CNT2.                                    I.020422
008420     IF WN-CNT2 < 27                                              I.020422
008430         MOVE WN-WNA(WN-CNT2) TO WN-NA(WN-CNT1)                   I.020422
008440         GO TO NAM-340.                                           I.020422
008450     MOVE 2 TO WN-DCHK.                                           I.020422
008460     GO TO NAM-010.                                               I.020422
008470 NAM-410.                                                         I.020422
008480     MOVE SPACE TO WN-ONAME WN-UNAME.                             I.020422
008490     MOVE ZERO TO WN-CNT1.                                        I.020422
008500 NAM-420.                                                         I.020422
008510     ADD 1 TO WN-CNT1.                                            I.020422
008520     IF WN-CNT1 > 26                                              I.020422
008530         GO TO NAM-510.                                           I.020422
008540     IF WN-CNT1 < 19                                              I.020422
008550         MOVE WN-NA(WN-CNT1) TO WN-ONA(WN-CNT1)                   I.020422
008560         GO TO NAM-420.                                           I.020422
008570     IF WN-CNT1 = 19                                              I.020422
008580         MOVE 9 TO WN-CNT2.                                       I.020422
008590     ADD 1 TO WN-CNT2.                                            I.020422
008600     MOVE WN-NA(WN-CNT1) TO WN-UNA(WN-CNT2)                       I.020422
008610     GO TO NAM-420.                                               I.020422
008620 NAM-510.                                                         I.020422
008630     IF JS-SIGN = 1                                               I.120720
008640         GO TO NAM-EX.                                            I.120720
008650     MOVE 20 TO WN-CNT1.                                          I.020422
008660 NAM-520.                                                         I.020422
008670     SUBTRACT 1 FROM WN-CNT1.                                     I.020422
008680     IF WN-CNT1 = ZERO                                            I.020422
008690         MOVE NC"殿" TO WN-UNA(19)                                I.020422
008700         GO TO NAM-EX.                                            I.020422
008710     IF WN-UNA(WN-CNT1) = SPACE                                   I.020422
008720         GO TO NAM-520.                                           I.020422
008730     ADD 2 TO WN-CNT1.                                            I.020422
008740     IF WN-CNT1 > 19                                              I.020422
008750         MOVE 19 TO WN-CNT1.                                      I.020422
008760     MOVE NC"殿" TO WN-UNA(WN-CNT1).                              I.020422
008770 NAM-EX.                                                          I.020422
008780     EXIT.                                                        I.020422
008790 SET2-RTN.                                                        I.051029
008800     MOVE TMW-NAME TO WN-NAME.                                    I.051029
008810     PERFORM NAM-RTN THRU NAM-EX.                                 I.051029
008820     IF  CNT = ZERO                                               I.051029
008830         MOVE  SPACE  TO  W-P1  W-P2  W-P3  W-P5  W-P6            I.051029
008840         MOVE  W-15K  TO  P-15K.                                  I.051029
008850     ADD  1  TO  CNT.                                             I.051029
008860     IF  CNT = 1                                                  I.051029
008870         MOVE  NC"〒　"    TO  P-UM1                              I.051029
008880         MOVE  TMW-UNO     TO  P-UB1                              I.051029
008890         MOVE  TMW-JSU     TO  P-JU1                              I.051029
008900         MOVE  TMW-JSS     TO  P-JS1                              I.051029
008910         MOVE  WN-ONAME    TO  P-NA1                              I.051029
008920         MOVE  WN-UNAME    TO  P-NA5                              I.051029
008930         GO  TO  SET2-EX.                                         I.051029
008940     IF  CNT = 2                                                  I.051029
008950         MOVE  NC"〒　"    TO  P-UM2                              I.051029
008960         MOVE  TMW-UNO     TO  P-UB2                              I.051029
008970         MOVE  TMW-JSU     TO  P-JU2                              I.051029
008980         MOVE  TMW-JSS     TO  P-JS2                              I.051029
008990         MOVE  WN-ONAME    TO  P-NA2                              I.051029
009000         MOVE  WN-UNAME    TO  P-NA6                              I.051029
009010         GO  TO  SET2-EX.                                         I.051029
009020     IF  CNT = 3                                                  I.051029
009030         MOVE  NC"〒　"    TO  P-UM3                              I.051029
009040         MOVE  TMW-UNO     TO  P-UB3                              I.051029
009050         MOVE  TMW-JSU     TO  P-JU3                              I.051029
009060         MOVE  TMW-JSS     TO  P-JS3                              I.051029
009070         MOVE  WN-ONAME    TO  P-NA3                              I.051029
009080         MOVE  WN-UNAME    TO  P-NA7                              I.051029
009090         GO  TO  SET2-EX.                                         I.051029
009100     MOVE  NC"〒　"    TO  P-UM4.                                 I.051029
009110     MOVE  TMW-UNO     TO  P-UB4.                                 I.051029
009120     MOVE  TMW-JSU     TO  P-JU4.                                 I.051029
009130     MOVE  TMW-JSS     TO  P-JS4.                                 I.051029
009140     MOVE  WN-ONAME    TO  P-NA4.                                 I.051029
009150     MOVE  WN-UNAME    TO  P-NA8.                                 I.051029
009160     PERFORM  S-05  THRU  S-10.                                   I.051029
009170     MOVE  ZERO  TO  CNT.                                         I.051029
009180 SET2-EX.                                                         I.051029
009190     EXIT.                                                        I.051029
009200*S-30.                                                            D.020422
009210*****MOVE  SPACE        TO  W-NMD  W-NUR  W-NSR.                  D.020422
009220*****MOVE  W-NAME(W-C)  TO  W-NMD.                                D.020422
009230*****MOVE  25  TO  CNTD.                                          D.020422
009240*S-35.                                                            D.020422
009250*****SUBTRACT  1  FROM  CNTD.                                     D.020422
009260*****IF  CNTD NOT = ZERO                                          D.020422
009270*****    IF  W-NA(CNTD) = SPACE                                   D.020422
009280*****        GO  TO  S-35.                                        D.020422
009290*****ADD  3  TO  CNTD.                                            D.020422
009300*****MOVE  NC"様"  TO  W-NA(CNTD).                                D.020422
009310*****IF  CNTD < 21                                                D.020422
009320*****    MOVE  W-NMD  TO  W-NSR                                   D.020422
009330*****    GO  TO  S-40.                                            D.020422
009340*****IF  CNTD > 20                                                D.020422
009350*****    MOVE  6  TO  CNTE                                        D.020422
009360*****    PERFORM  S-45  THRU  S-50.                               D.020422
009370*S-40.                                                            D.020422
009380*****EXIT.                                                        D.020422
009390*S-45.                                                            D.020422
009400*****ADD  1  TO  CNTE.                                            D.020422
009410*****IF  CNTE < 28                                                D.020422
009420*****    IF  W-NA(CNTE) NOT = SPACE                               D.020422
009430*****        GO  TO  S-45.                                        D.020422
009440*****    IF  CNTE > 20                                            D.020422
009450*****        MOVE  ZERO  TO  CNTF                                 D.020422
009460*****        PERFORM  S-75  THRU  S-85                            D.020422
009470*****        GO  TO  S-50.                                        D.020422
009480*****    IF  CNTE < 21                                            D.020422
009490*****        PERFORM  S-55  THRU  S-70.                           D.020422
009500*S-50.                                                            D.020422
009510*****EXIT.                                                        D.020422
009520*S-55.                                                            D.020422
009530*****MOVE  ZERO  TO  CNTF.                                        D.020422
009540*S-60.                                                            D.020422
009550*****ADD  1  TO  CNTF.                                            D.020422
009560*****IF  CNTF < CNTE                                              D.020422
009570*****    MOVE  W-NA(CNTF)  TO  W-NU(CNTF)                         D.020422
009580*****    GO  TO  S-60.                                            D.020422
009590*****MOVE  CNTE  TO  CNTG.                                        D.020422
009600*****MOVE  ZERO  TO  CNTH.                                        D.020422
009610*S-65.                                                            D.020422
009620*****ADD  1  TO  CNTG  CNTH.                                      D.020422
009630*****IF  CNTG < 28                                                D.020422
009640*****    MOVE  W-NA(CNTG)  TO  W-NS(CNTH)                         D.020422
009650*****    GO  TO  S-65.                                            D.020422
009660*S-70.                                                            D.020422
009670*****EXIT.                                                        D.020422
009680*S-75.                                                            D.020422
009690*****ADD  1  TO  CNTF.                                            D.020422
009700*****IF  CNTF < 8                                                 D.020422
009710*****    MOVE  W-NA(CNTF)  TO  W-NU(CNTF)                         D.020422
009720*****    GO  TO  S-75.                                            D.020422
009730*****MOVE  1  TO  CNTG.                                           D.020422
009740*****MOVE  W-NA(CNTF)  TO  W-NS(CNTG).                            D.020422
009750*S-80.                                                            D.020422
009760*****ADD  1  TO  CNTF  CNTG.                                      D.020422
009770*****IF  CNTF < 28                                                D.020422
009780*****    MOVE  W-NA(CNTF)  TO  W-NS(CNTG)                         D.020422
009790*****    GO  TO  S-80.                                            D.020422
009800*S-85.                                                            D.020422
009810*****EXIT.                                                        D.020422
009820*S-90.                                                            D.020422
009830*****MOVE  SPACE       TO  W-JUR  W-ADRU  W-ADRN.                 D.020422
009840*****MOVE  W-JSU(W-C)  TO  W-JUR.                                 D.020422
009850*****IF  SPACE = W-JU(21) AND W-JU(22) AND W-JU(23) AND W-JU(24)  D.020422
009860*****    MOVE  W-JUR  TO  W-ADRU                                  D.020422
009870*****    GO  TO  S-105.                                           D.020422
009880*****MOVE  ZERO  TO  CNTE.                                        D.020422
009890*S-95.                                                            D.020422
009900*****ADD  1  TO  CNTE.                                            D.020422
009910*****IF  CNTE > 20                                                D.020422
009920*****    MOVE  W-JU(21)  TO  W-ADN(01)                            D.020422
009930*****    MOVE  W-JU(22)  TO  W-ADN(02)                            D.020422
009940*****    MOVE  W-JU(23)  TO  W-ADN(03)                            D.020422
009950*****    MOVE  W-JU(24)  TO  W-ADN(04)                            D.020422
009960*****    GO  TO  S-105.                                           D.020422
009970*****MOVE  W-JU(CNTE)  TO  W-ADU(CNTE).                           D.020422
009980*****IF  W-JU(CNTE) NOT = SPACE                                   D.020422
009990*****    GO  TO  S-95.                                            D.020422
010000*****IF  CNTE < 4                                                 D.020422
010010*****    GO  TO  S-95.                                            D.020422
010020*****IF  CNTE = 4                                                 D.020422
010030*****    MOVE  W-JU(CNTE)  TO  W-ADU(CNTE).                       D.020422
010040*****MOVE  ZERO  TO  CNTF.                                        D.020422
010050*S-100.                                                           D.020422
010060*****ADD  1  TO  CNTE  CNTF.                                      D.020422
010070*****IF  CNTE < 25                                                D.020422
010080*****    MOVE  W-JU(CNTE)  TO  W-ADN(CNTF)                        D.020422
010090*****    GO  TO  S-100.                                           D.020422
010100*S-105.                                                           D.020422
010110*****EXIT.                                                        D.020422
010120*S-110.                                                           D.020422
010130*****MOVE  ZERO  TO  CNT.                                         D.020422
010140*S-115.                                                           D.020422
010150*****ADD  1  TO  CNT.                                             D.020422
010160*****IF  CNT < 20                                                 D.020422
010170*****    MOVE  NC"Ｎ"  TO  W-NS(CNT)                              D.020422
010180*****    GO  TO  S-115.                                           D.020422
010190*****MOVE  NC"様"  TO  W-NS(CNT).                                 D.020422
010200*S-120.                                                           D.020422
010210*****EXIT.                                                        D.020422
