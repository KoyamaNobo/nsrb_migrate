000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMG010.
000030 AUTHOR. T-FUJII.
000040 DATE-WRITTEN. 1974-07-27.
000050*******************************************************************
000060*    PROGRAM         :  担当得意先品名別売上粗利集計表　          *
000070*    PRINTER TYPE    :  JIPS                                      *
000080*    SCREEN          :  ******                                    *
000090*        変更　　　  :  62/05/12                                  *
000100*                    :  JS-SIGN = 0   改頁なし 全体               *
000110*                    :  JS-SIGN = 1   改頁あり 一般               *
000120*                    :  JS-SIGN = 2   改頁なし ｳﾞｨｳﾞｪﾝﾃﾞｨ         *
000130*                    :  JS-SIGN = 3   改頁なし 教育               *
000140*                    :  JS-SIGN = 4   改頁あり 一般(教育･VIV含む) *
000150*                    :  JS-SIGN = 5   改頁なし 得意先入力         *
000160*                    :  JS-SIGN = 6   改頁なし 全体（参考）       *
000170*                    :  JS-SIGN = 7   改頁なし 担当（参考）       *
000180*                    :  JS-SIGN = 8   ＥＸＣＥＬ変換 ｳﾞｨｳﾞｪﾝﾃﾞｨ   *
000190*                    :  JS-SIGN = 9   全体ＥＸＣＬＥ変換          *
000200*******************************************************************
000210 ENVIRONMENT DIVISION.
000220 CONFIGURATION SECTION.
000230 SOURCE-COMPUTER. SYSTEM3100.
000240 OBJECT-COMPUTER. SYSTEM3100.
000250 INPUT-OUTPUT SECTION.
000260 FILE-CONTROL.
000270     COPY LIBCSE.
000280*****SELECT T-M ASSIGN TO T-MSD                                   D.000222
000290     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000222
000300         ORGANIZATION IS INDEXED
000310         ACCESS MODE IS RANDOM
000320         RECORD KEY IS T-KEY
000330         ALTERNATE RECORD KEY IS T-KEY2                           I.000222
000340         FILE STATUS IS ERR-STAT.
000350*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010806
000360     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010806
000370         ORGANIZATION IS INDEXED
000380         ACCESS MODE IS RANDOM
000390         RECORD KEY IS HI-KEY
000400         ALTERNATE RECORD KEY IS HI-KEY2                          I.010806
000410         FILE STATUS IS ERR-STAT.
000420     SELECT SNTRF ASSIGN TO SNTR-MSD
000430         FILE STATUS IS ERR-STAT.
000440     SELECT EXL-F ASSIGN TO EXL-MSD.                              I.061018
000450     SELECT SP-F ASSIGN TO P-PRN999.
000460 I-O-CONTROL.
000470     APPLY SHARED-MODE ON M-DATE
000480     APPLY SHARED-MODE ON T-M
000490     APPLY SHARED-MODE ON HI-M
000500     APPLY SHIFT-CODE  ON SP-F.                                   A 62/05
000510 DATA DIVISION.
000520 FILE SECTION.
000530     COPY LIBFDD.
000540     COPY LITM.
000550     COPY LIHIM.
000560     COPY LSSNTW.                                                 I.970715
000570     COPY LSPF.
000580 FD  EXL-F                                                        I.061018
000590     BLOCK  1 RECORDS                                             I.061018
000600     LABEL RECORD IS STANDARD                                     I.061018
000610     VALUE OF IDENTIFICATION IS "WK0256000".                      I.061018
000620 01  EXL-R.                                                       I.061018
000630     02  EXL-TNC        PIC  X(002).                              I.061018
000640     02  EXL-TCD        PIC  X(004).                              I.061018
000650     02  EXL-TNA        PIC  N(026).                              I.061018
000660     02  EXL-HCD        PIC  X(006).                              I.061018
000670     02  EXL-HNA        PIC  N(024).                              I.061018
000680     02  EXL-SU         PIC S9(007).                              I.061018
000690     02  EXL-UKI        PIC S9(009).                              I.061018
000700     02  EXL-UT         PIC S9(006).                              I.061018
000710     02  EXL-SKI        PIC S9(009).                              I.061018
000720     02  EXL-GT         PIC S9(005).                              I.061018
000730     02  EXL-AR         PIC S9(009).                              I.061018
000740     02  EXL-RR         PIC S9(003)V9(1).                         I.061018
000750     02  F              PIC  X(095).                              I.061018
000760*FD  SNTRF                                                        D.970715
000770*****BLOCK  5 RECORDS                                             D.950612
000780*****BLOCK  3 RECORDS                                             D.970519
000790*****BLOCK  2 RECORDS                                             D.970715
000800*****LABEL RECORD IS STANDARD                                     D.970715
000810*****VALUE OF IDENTIFICATION IS WK0128ID.                         D.970715
000820*****VALUE OF IDENTIFICATION IS "HA51".                           D.950612
000830*****VALUE OF IDENTIFICATION IS WK0085ID.                         D.970519
000840*01  SNTR-R.                                                      D.970715
000850*****02  SNTR-DATE      PIC  9(006).                              D.970715
000860*****02  SNTR-KEY.                                                D.970715
000870*****  03  SNTR-TCD     PIC  9(004).                              D.970715
000880*****  03  SNTR-HCD     PIC  9(006).                              D.970715
000890*****02  F              PIC  X(041).                              D.970715
000900*****02  F              PIC  X(001).                              D.970519
000910*****02  SNTR-SU        PIC S9(006).                              D.961213
000920*****02  SNTR-SU        PIC S9(005).                              D.970715
000930*****02  F              PIC  X(005).                              D.970715
000940*****02  SNTR-KIN       PIC S9(008).                              D.970715
000950*****02  F              PIC  X(001).                              D.970715
000960*****02  SNTR-DC        PIC  9(001).                              D.970715
000970*****02  SNTR-FT        PIC  9(005).                              D.970715
000980*****02  SNTR-SKI       PIC S9(008).                              D.961213
000990*****02  F              PIC  X(007).                              D.970715
001000*****02  SNTR-BC1       PIC  9(002).                              D.970715
001010*****02  SNTR-BC2       PIC  9(002).                              D.960708
001020*****02  SNTR-BC2.                                                D.970715
001030*****  03  SNTR-BC21    PIC  9(001).                              D.970715
001040*****  03  SNTR-BC22    PIC  9(001).                              D.970715
001050*****02  SNTR-BC3       PIC  9(002).                              D.970715
001060*****02  F              PIC  X(001).                              D.970715
001070*****02  SNTR-TNC.                                                D.970715
001080*****  03  SNTR-TNC1    PIC  9(001).                              D.970715
001090*****  03  SNTR-TNC2    PIC  9(001).                              D.970715
001100*****02  F              PIC  X(022).                              D.970519
001110*****02  F              PIC  X(029).                              D.970715
001120*****02  SNTR-SNC       PIC  9(001).                              D.970715
001130*****02  F              PIC  X(005).                              D.950612
001140*****02  F              PIC  X(039).                              D.961213
001150*****02  F              PIC  X(004).                              D.970519
001160 WORKING-STORAGE SECTION.
001170 77  JS-SIGN            PIC  9(001).                              I.940804
001180 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
001190*77  WK0085ID           PIC  X(009) VALUE SPACE.                  D.970519
001200*77  WK0128ID           PIC  X(009) VALUE SPACE.                  D.970715
001210 77  WK0064ID           PIC  X(009) VALUE SPACE.                  I.970715
001220 01  STN-NO.                                                      I.950612
001230     02  STN-NO1        PIC  X(003).                              I.950612
001240     02  STN-NO2        PIC  X(003).                              I.950612
001250 01  W-FID.                                                       I.950612
001260*****02  W-FID1         PIC  X(006) VALUE "WK0085".               D.970519
001270*****02  W-FID1         PIC  X(006) VALUE "WK0128".               D.970715
001280     02  W-FID1         PIC  X(006) VALUE "WK0064".               I.970715
001290     02  W-FID2         PIC  X(003).                              I.950612
001300 01  HEAD1.
001310     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
001320*****02  F              PIC  X(034) VALUE SPACE.                  D.960605
001330     02  H-MID          PIC  N(012) VALUE SPACE.                  I.960605
001340     02  F              PIC  X(010) VALUE SPACE.                  I.960605
001350     02  F              PIC  N(026) VALUE
001360         NC"＊＊＊　　担当得意先品種別　売上粗利集計表　　＊＊＊".
001370     02  F              PIC  X(025) VALUE SPACE.
001380     02  F              PIC  X(005) VALUE "DATE ".
001390     02  H-DATE         PIC 99B99B99.
001400     02  F              PIC  X(007) VALUE "     P.".
001410     02  H-PAGE         PIC Z9.
001420 01  HEAD2.
001430     02  F              PIC  X(030) VALUE
001440          "担当 ｺｰﾄﾞ 得　　意　　先　　名".
001450     02  F              PIC  X(103) VALUE SPACE.
001460 01  HEAD3.
001470     02  F              PIC  X(020) VALUE SPACE.
001480     02  F              PIC  X(017) VALUE
001490          " ｺｰﾄﾞ  品　　　名".
001500     02  F              PIC  X(033) VALUE SPACE.
001510     02  F              PIC  X(024) VALUE
001520          "数量     売上金額 足単価".
001530     02  F              PIC  X(039) VALUE
001540          "    売上原価 足単価　　  粗利益 利益率%".
001550 01  W-P1.
001560     02  P-20KA         PIC  X(005).
001570     02  F              PIC  X(001).
001580     02  P-TNC          PIC  9(002).
001590     02  F              PIC  X(002).
001600     02  P-TCD          PIC  9(004).
001610     02  F              PIC  X(001).
001620     02  P-TNA          PIC  N(026).                              I.020409
001630     02  F              PIC  X(070).                              I.020409
001640*****02  P-TNA          PIC  N(024).                              D.020409
001650*****02  F              PIC  X(074).                              D.020409
001660 01  W-P2.
001670     02  P-15KB         PIC  X(005).
001680     02  F              PIC  X(020).
001690     02  P-HCD          PIC  9(006).
001700     02  F              PIC  X(001).
001710     02  P-HNA          PIC  N(024).
001720     02  P-SU           PIC ---,---,--9.
001730     02  P-UKI          PIC -----,---,--9.
001740     02  P-UT           PIC ---,--9.
001750     02  P-SKI          PIC ----,---,--9.
001760     02  P-GT           PIC ---,--9.
001770     02  P-AR           PIC ----,---,--9.
001780     02  P-RR           PIC -----9.9.
001790     02  P-20KB         PIC  X(005).
001800 01  W-D.
001810     02  W-KEY.
001820       03  W-TCD        PIC  9(004).
001830       03  W-HCD        PIC  9(006).
001840     02  W-TNC.
001850       03  W-TNC1       PIC  9(001).
001860       03  W-TNC2       PIC  9(001).
001870     02  W-AR           PIC S9(009).
001880     02  W-RR           PIC S9(003)V9(01).
001890     02  W-KIN          PIC S9(009).
001900     02  W-UT           PIC S9(005).
001910     02  W-GT           PIC S9(005).
001920     02  W-RD.                                                    I.961213
001930       03  W-SU         PIC S9(005).                              I.961213
001940       03  W-UKIN       PIC S9(008).                              I.961213
001950       03  W-GKIN       PIC S9(008).                              I.961213
001960 01  WN-D.
001970     02  WN-SU          PIC S9(007).
001980     02  WN-UKI         PIC S9(009).
001990     02  WN-SKI         PIC S9(009).
002000 01  WT-D.
002010     02  WT-SU          PIC S9(007).
002020     02  WT-UKI         PIC S9(009).
002030     02  WT-SKI         PIC S9(009).
002040 01  WG-D.
002050     02  WG-SU          PIC S9(007).
002060     02  WG-UKI         PIC S9(009).
002070     02  WG-SKI         PIC S9(009).
002080 01  WS-D.
002090     02  WS-SU          PIC S9(007).
002100     02  WS-UKI         PIC S9(009).
002110     02  WS-SKI         PIC S9(009).
002120 01  WA-D.
002130     02  WA-SU          PIC S9(007).
002140     02  WA-UKI         PIC S9(009).
002150     02  WA-SKI         PIC S9(009).
002160 01  W-DATA.
002170     02  W-ALL          PIC S9(006)V9(05).
002180     02  W-PAGE         PIC  9(002).
002190     02  CNT.
002200       03  CNT1         PIC  9(003).
002210       03  CNT2         PIC  9(003).
002220     02  CHK            PIC  9(001).
002230     02  W-C            PIC  9(001).
002240*****02  W-PC           PIC  9(001).                              D.940804
002250     02  W-DMM          PIC  9(001).                              I.000906
002260     02  W-SETC.                                                  I.000906
002270       03  W-STC        PIC  9(002).                              I.000906
002280       03  W-ETC        PIC  9(002) VALUE 99.                     I.151103
002290*****  03  W-ETC        PIC  9(002).                              D.151103
002300     02  W-SETCD.                                                 I.010201
002310       03  W-STCD       PIC  9(004).                              I.010201
002320       03  W-ETCD       PIC  9(004) VALUE 9999.                   I.151103
002330*****  03  W-ETCD       PIC  9(004).                              D.151103
002340 01  ERR-STAT           PIC  X(002).
002350     COPY LSTAT.                                                  I.940704
002360 SCREEN SECTION.
002370 SD  C-CRT
002380     END STATUS IS ESTAT.
002390 01  C-CLEAR.
002400     02  C-CL    LINE   1  CLEAR SCREEN.
002410 01  C-MID.
002420     02  LINE   3  COLUMN  10  PIC  N(024) VALUE
002430          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002440     02  LINE   4  COLUMN  10  PIC  N(024) VALUE
002450          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002460     02  LINE   5  COLUMN  10  PIC  N(024) VALUE
002470          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
002480     02  LINE   6  COLUMN  10  PIC  N(024) VALUE
002490          NC"＊＊＊　担当得意先品種別　売上粗利集計表　＊＊＊".
002500     02  LINE   7  COLUMN  10  PIC  N(024) VALUE
002510          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
002520     02  LINE   8  COLUMN  10  PIC  N(024) VALUE
002530          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002540     02  LINE   9  COLUMN  10  PIC  N(024) VALUE
002550          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002560*****02  LINE  12  COLUMN  10  PIC  X(048) VALUE                  D.940804
002570*****     "担当者毎改ページ　　する＝５　しない＝１    ﾘﾀｰﾝ".     D.940804
002580*01  C-ACP.                                                       D.940804
002590*****02  A-DMM   LINE  12  COLUMN  53  PIC  9(001)                D.940804
002600*****     USING W-DMM   CHECK OVERFLOW NO IFC.                    D.940804
002610 01  C-ACP.                                                       I.000906
002620     02  LINE  15.                                                I.000906
002630       03  A-STC   COLUMN  36  PIC  9(002)                        I.000906
002640            USING W-STC   CHECK OVERFLOW NO IFC.                  I.000906
002650       03  A-ETC   COLUMN  42  PIC  9(002)                        I.000906
002660            USING W-ETC   CHECK OVERFLOW NO IFC.                  I.000906
002670       03  A-STCD  COLUMN  34  PIC  9(004)                        I.010201
002680            USING W-STCD  CHECK OVERFLOW NO IFC.                  I.010201
002690       03  A-ETCD  COLUMN  42  PIC  9(004)                        I.010201
002700            USING W-ETCD  CHECK OVERFLOW NO IFC.                  I.010201
002710     02  A-DMM   LINE  20  COLUMN  40  PIC  9(001)                I.000906
002720          USING W-DMM   CHECK OVERFLOW NO IFC.                    I.000906
002730 01  C-DSP.                                                       I.960605
002740     02  D-SEN   LINE  12  COLUMN  23  PIC  N(012)  FROM  H-MID.  I.000906
002750     02  D-TCM.                                                   I.000906
002760       03  LINE  15  COLUMN  24  PIC  X(020) VALUE                I.000906
002770            "担当者ｺｰﾄﾞ  00 〜 99".                               I.000906
002780       03  LINE  20  COLUMN  23  PIC  X(022) VALUE                I.000906
002790            "確認  OK=1 NO=9   ﾘﾀｰﾝ".                             I.000906
002800     02  D-TCDM.                                                  I.010201
002810       03  LINE  15  COLUMN  22  PIC  X(024) VALUE                I.010201
002820            "得意先ｺｰﾄﾞ  0000 〜 9999".                           I.010201
002830       03  LINE  20  COLUMN  23  PIC  X(022) VALUE                I.010201
002840            "確認  OK=1 NO=9   ﾘﾀｰﾝ".                             I.010201
002850*****02  D-SEN   LINE  15  COLUMN  23  PIC  N(012)  FROM  H-MID.  D.000906
002860 01  C-ERR.
002870     02  LINE  24.
002880       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002890            "***  DATA ﾅｼ  ***".
002900       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002910       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002920     COPY LIBSCR.
002930 PROCEDURE DIVISION.
002940 M-05.
002950     ACCEPT JS-SIGN.                                              I.940804
002960*****IF JS-SIGN > 1                                               D.960605
002970*****IF JS-SIGN > 2                                               D.961218
002980*****IF JS-SIGN > 3                                               D.010201
002990*****IF JS-SIGN NOT = 0 AND 1 AND 2 AND 3 AND 5                   D.031117
003000*****IF JS-SIGN NOT = 0 AND 1 AND 2 AND 3 AND 4 AND 5             D.061018
003010*****IF JS-SIGN NOT = 0 AND 1 AND 2 AND 3 AND 4 AND 5 AND 9       D.101006
003020*****IF JS-SIGN NOT = 0 AND 1 AND 2 AND 3 AND 4 AND 5 AND 8 AND 9 D.111122
003030     IF JS-SIGN NOT = 0 AND 1 AND 2 AND 3 AND 4 AND 5 AND         I.111122
003040                      6 AND 7 AND 8 AND 9                         I.130712
003050*****                 6 AND 8 AND 9                               D.130712
003060         GO TO M-05.                                              I.940804
003070     COPY LIBCPR.
003080     DISPLAY C-CLEAR.
003090     DISPLAY C-MID.
003100     MOVE SPACE TO H-MID.                                         I.961218
003110*****IF JS-SIGN = 1                                               D.031117
003120     IF JS-SIGN = 1 OR 4                                          I.031117
003130         MOVE NC"《　一　　般　》　　　　" TO H-MID.              I.961218
003140*****IF JS-SIGN = 2                                               D.101006
003150     IF JS-SIGN = 2 OR 8                                          I.101006
003160         MOVE NC"《　ヴィヴェンディ　》　" TO H-MID.              I.961218
003170*****    MOVE NC"《　ヴィヴェンディ　》　" TO H-MID               D.961218
003180*****    DISPLAY D-SEN.                                           D.961218
003190     IF JS-SIGN = 3                                               I.961218
003200         MOVE NC"《　教　　育　》　　　　" TO H-MID.              I.961218
003210*****IF JS-SIGN = 6                                               D.130712
003220     IF JS-SIGN = 6 OR 7                                          I.130712
003230         MOVE NC"（参考）　　　　　　　　" TO H-MID.              I.111122
003240     DISPLAY D-SEN.                                               I.961218
003250*****IF JS-SIGN NOT = 0 AND 2 AND 3 AND 9                         D.101006
003260*****IF JS-SIGN NOT = 0 AND 2 AND 3 AND 8 AND 9                   D.111122
003270     IF JS-SIGN NOT = 0 AND 2 AND 3 AND 6 AND 8 AND 9             I.111122
003280         PERFORM ACP-RTN THRU ACP-EX.                             I.061018
003290     IF ESTAT = PF9                                               I.061018
003300         GO TO M-95.                                              I.061018
003310*****IF JS-SIGN = 1                                               D.010201
003320*****    DISPLAY D-TCM                                            D.010201
003330*****  ELSE                                                       D.010201
003340*****IF JS-SIGN = 0 OR 2 OR 3                                     D.061018
003350*****IF JS-SIGN = 0 OR 2 OR 3 OR 9                                D.061018
003360*****    GO TO M-14.                                              D.061018
003370*****IF JS-SIGN = 5                                               D.061018
003380*****    DISPLAY D-TCDM                                           D.061018
003390*****    GO TO M-09.                                              D.061018
003400*****DISPLAY D-TCM.                                               D.061018
003410*M-06.                                                            D.940804
003420*****ACCEPT A-DMM.                                                D.940804
003430*****IF ESTAT NOT = HTB AND SKP                                   D.940804
003440*****    GO TO M-06.                                              D.940804
003450*****IF W-DMM NOT = 1 AND 5                                       D.940804
003460*****    GO TO M-06.                                              D.940804
003470*M-07.                                                            D.061018
003480*****ACCEPT A-STC.                                                D.061018
003490*****IF ESTAT = PF9                                               D.061018
003500*****    GO TO M-95.                                              D.061018
003510*****IF ESTAT NOT = HTB AND SKP                                   D.061018
003520*****    GO TO M-07.                                              D.061018
003530*M-08.                                                            D.061018
003540*****ACCEPT A-ETC.                                                D.061018
003550*****IF ESTAT = BTB                                               D.061018
003560*****    GO TO M-07.                                              D.061018
003570*****IF ESTAT NOT = HTB AND SKP                                   D.061018
003580*****    GO TO M-08.                                              D.061018
003590*****IF W-STC > W-ETC                                             D.061018
003600*****    GO TO M-08.                                              D.061018
003610*****GO TO M-12.                                                  D.061018
003620*M-09.                                                            D.061018
003630*****ACCEPT A-STCD.                                               D.061018
003640*****IF ESTAT = PF9                                               D.061018
003650*****    GO TO M-95.                                              D.061018
003660*****IF ESTAT NOT = HTB AND SKP                                   D.061018
003670*****    GO TO M-09.                                              D.061018
003680*M-10.                                                            D.061018
003690*****ACCEPT A-ETCD.                                               D.061018
003700*****IF ESTAT = BTB                                               D.061018
003710*****    GO TO M-09.                                              D.061018
003720*****IF ESTAT NOT = HTB AND SKP                                   D.061018
003730*****    GO TO M-10.                                              D.061018
003740*****IF W-STCD > W-ETCD                                           D.061018
003750*****    GO TO M-10.                                              D.061018
003760*M-12.                                                            D.061018
003770*****ACCEPT A-DMM.                                                D.061018
003780*****IF ESTAT = BTB                                               D.061018
003790*****    IF JS-SIGN = 5                                           D.061018
003800*****        GO TO M-10                                           D.061018
003810*****      ELSE                                                   D.061018
003820*****        GO TO M-08.                                          D.061018
003830*****IF ESTAT NOT = HTB AND SKP                                   D.061018
003840*****    GO TO M-12.                                              D.061018
003850*****IF W-DMM = 9                                                 D.061018
003860*****    IF JS-SIGN = 5                                           D.061018
003870*****        GO TO M-09                                           D.061018
003880*****      ELSE                                                   D.061018
003890*****        GO TO M-07.                                          D.061018
003900*****IF W-DMM NOT = 1                                             D.061018
003910*****    GO TO M-12.                                              D.061018
003920*M-14.                                                            D.061018
003930     IF JS-SIGN = 8 OR 9                                          I.101006
003940         OPEN OUTPUT EXL-F                                        I.101006
003950         CLOSE EXL-F.                                             I.101006
003960     CALL "CBLSTNNO" USING STN-NO.                                I.950612
003970     MOVE STN-NO2 TO W-FID2.                                      I.950612
003980*****MOVE W-FID TO WK0085ID.                                      D.970519
003990*****MOVE W-FID TO WK0128ID.                                      D.970715
004000     MOVE W-FID TO WK0064ID.                                      I.970715
004010     OPEN INPUT SNTRF.
004020*****MOVE ZERO TO W-PC.                                           D.940804
004030 M-15.
004040     READ SNTRF AT END
004050*****    DISPLAY E-ME1 E-ME99                                     D.010109
004060         CLOSE SNTRF
004070         GO TO M-95.                                              I.061018
004080*****    DISPLAY C-CLEAR                                          D.061018
004090*****    STOP RUN.                                                D.061018
004100*****IF SNTR-DC = 4                                               D.970117
004110     IF SNTR-DC = 4 OR 8                                          I.970117
004120         GO TO M-15.                                              I.961213
004130*****IF JS-SIGN = 2                                               D.101006
004140*****    IF SNTR-HCD < 215100 OR > 299999                         D.960711
004150*****    IF SNTR-BC1 NOT = 33                                     D.060525
004160     IF JS-SIGN = 2 OR 8                                          I.101006
004170         IF (SNTR-BC1 NOT = 32) OR (SNTR-BC21 NOT = 2)            I.060525
004180             GO TO M-15.                                          I.960605
004190     IF JS-SIGN = 3                                               I.961218
004200*****    IF SNTR-BC1 NOT = 71                                     D.020408
004210         IF SNTR-BC3 NOT = 30                                     I.020408
004220             GO TO M-15.                                          I.961218
004230     IF JS-SIGN = 1                                               I.960708
004240*****    IF SNTR-BC21 = 2                                         D.960711
004250*****    IF SNTR-BC1 = 71                                         D.961218
004260*****        GO TO M-15.                                          D.961218
004270*****IF JS-SIGN = 1                                               D.961218
004280*****    IF SNTR-HCD > 215099 AND < 300000                        D.960711
004290*****    IF SNTR-BC1 = 33                                         D.961218
004300*****    IF SNTR-BC1 = 33 OR 71                                   D.020408
004310*****    IF (SNTR-BC1 = 33) OR (SNTR-BC3 = 30)                    D.060525
004320         IF ((SNTR-BC1 = 32) AND (SNTR-BC21 = 2)) OR              I.060525
004330                                                 (SNTR-BC3 = 30)  I.060525
004340             GO TO M-15                                           I.000906
004350           ELSE                                                   I.000906
004360             IF SNTR-TNC < W-STC OR > W-ETC                       I.000906
004370                 GO TO M-15.                                      I.960605
004380*****IF JS-SIGN = 4                                               D.130712
004390     IF JS-SIGN = 4 OR 7                                          I.130712
004400         IF SNTR-TNC < W-STC OR > W-ETC                           I.031117
004410             GO TO M-15.                                          I.031117
004420     IF JS-SIGN = 5                                               I.010201
004430         IF SNTR-TCD < W-STCD OR > W-ETCD                         I.010201
004440             GO TO M-15.                                          I.010201
004450*****IF JS-SIGN = 1                                               D.950607
004460*****    IF SNTR-TNC1 = 8                                         D.950607
004470*****        GO TO M-15.                                          D.950607
004480*****ADD 1 TO W-PC.                                               D.940804
004490     PERFORM DST-RTN THRU DST-EX.                                 I.961213
004500     IF ZERO = W-SU AND W-UKIN AND W-GKIN                         I.961213
004510         GO TO M-15.                                              I.961213
004520*
004530     MOVE ZERO TO WA-D.
004540     OPEN INPUT T-M.
004550     OPEN INPUT HI-M.
004560*****IF JS-SIGN = 9                                               D.101006
004570     IF JS-SIGN = 8 OR 9                                          I.101006
004580         OPEN OUTPUT EXL-F                                        I.061018
004590         GO TO M-20.                                              I.061018
004600     OPEN OUTPUT SP-F.
004610     MOVE DATE-02R TO H-DATE.
004620     MOVE ZERO TO W-PAGE.
004630     PERFORM HED-010 THRU HED-EX.
004640 M-20.
004650     MOVE ZERO TO WS-D.
004660     MOVE SNTR-TNC1 TO W-TNC1.
004670 M-25.
004680     MOVE ZERO TO WG-D W-C.
004690     MOVE SNTR-TNC2 TO W-TNC2.
004700 M-30.
004710     MOVE ZERO TO WT-D CHK CNT1.
004720     MOVE SNTR-TCD TO W-TCD.
004730     MOVE SNTR-TCD TO T-KEY.
004740     READ T-M WITH UNLOCK INVALID KEY
004750         MOVE NC"　＊　マスター　なし　＊　　　　　" TO T-NAME.
004760 M-35.
004770     MOVE ZERO TO WN-D.
004780     MOVE SNTR-HCD TO W-HCD.
004790 M-40.
004800*****ADD SNTR-SU TO WN-SU.                                        D.961213
004810*****ADD SNTR-KIN TO WN-UKI.                                      D.961213
004820*****ADD SNTR-SKI TO WN-SKI.                                      D.961213
004830     ADD W-SU TO WN-SU.                                           I.961213
004840     ADD W-UKIN TO WN-UKI.                                        I.961213
004850     ADD W-GKIN TO WN-SKI.                                        I.961213
004860 M-45.
004870     READ SNTRF AT END
004880         GO TO M-70.
004890*****IF SNTR-DC = 4                                               D.970117
004900     IF SNTR-DC = 4 OR 8                                          I.970117
004910         GO TO M-45.                                              I.961213
004920*****IF JS-SIGN = 2                                               D.101006
004930*****    IF SNTR-HCD < 215100 OR > 299999                         D.960711
004940*****    IF SNTR-BC1 NOT = 33                                     D.060525
004950     IF JS-SIGN = 2 OR 8                                          I.101006
004960         IF (SNTR-BC1 NOT = 32) OR (SNTR-BC21 NOT = 2)            I.060525
004970             GO TO M-45.                                          I.960605
004980     IF JS-SIGN = 3                                               I.961218
004990*****    IF SNTR-BC1 NOT = 71                                     D.020408
005000         IF SNTR-BC3 NOT = 30                                     I.020408
005010             GO TO M-45.                                          I.961218
005020     IF JS-SIGN = 1                                               I.960708
005030*****    IF SNTR-BC21 = 2                                         D.960711
005040*****    IF SNTR-BC1 = 71                                         D.961218
005050*****        GO TO M-45.                                          D.961218
005060*****IF JS-SIGN = 1                                               D.961218
005070*****    IF SNTR-HCD > 215099 AND < 300000                        D.960711
005080*****    IF SNTR-BC1 = 33                                         D.961218
005090*****    IF SNTR-BC1 = 33 OR 71                                   D.020408
005100*****    IF (SNTR-BC1 = 33) OR (SNTR-BC3 = 30)                    D.060525
005110         IF ((SNTR-BC1 = 32) AND (SNTR-BC21 = 2)) OR              I.060525
005120                                                 (SNTR-BC3 = 30)  I.060525
005130             GO TO M-45                                           I.000906
005140           ELSE                                                   I.000906
005150             IF SNTR-TNC < W-STC OR > W-ETC                       I.000906
005160                 GO TO M-45.                                      I.960605
005170*****IF JS-SIGN = 4                                               D.130712
005180     IF JS-SIGN = 4 OR 7                                          I.130712
005190         IF SNTR-TNC < W-STC OR > W-ETC                           I.031117
005200             GO TO M-45.                                          I.031117
005210     IF JS-SIGN = 5                                               I.010201
005220         IF SNTR-TCD < W-STCD OR > W-ETCD                         I.010201
005230             GO TO M-45.                                          I.010201
005240*****IF JS-SIGN = 1                                               D.950607
005250*****    IF SNTR-TNC1 = 8                                         D.950607
005260*****        GO TO M-45.                                          D.950607
005270     PERFORM DST-RTN THRU DST-EX.                                 I.961213
005280     IF ZERO = W-SU AND W-UKIN AND W-GKIN                         I.961213
005290         GO TO M-45.                                              I.961213
005300*
005310     IF W-TNC1 NOT = SNTR-TNC1
005320         GO TO M-65.
005330     IF W-TNC NOT = SNTR-TNC
005340         GO TO M-60.
005350     IF W-TCD NOT = SNTR-TCD
005360         GO TO M-55.
005370     IF W-HCD NOT = SNTR-HCD
005380         GO TO M-50.
005390     GO TO M-40.
005400 M-50.
005410     PERFORM MPR2-RTN THRU MPR2-EX.
005420     GO TO M-35.
005430 M-55.
005440     PERFORM MPR2-RTN THRU MPR2-EX.
005450     PERFORM KPR-RTN THRU KPR-EX.
005460     GO TO M-30.
005470 M-60.
005480     PERFORM MPR2-RTN THRU MPR2-EX.
005490     PERFORM KPR-RTN THRU KPR-EX.
005500     PERFORM TPR-RTN THRU TPR-EX.
005510*****IF W-DMM = 5                                                 D.940804
005520*****IF JS-SIGN = 1                                               D.031117
005530     IF JS-SIGN = 1 OR 4                                          I.031117
005540         PERFORM HED-RTN THRU HED-EX.                             I.921203
005550     GO TO M-25.
005560 M-65.
005570     PERFORM MPR2-RTN THRU MPR2-EX.
005580     PERFORM KPR-RTN THRU KPR-EX.
005590     PERFORM TPR-RTN THRU TPR-EX.
005600     PERFORM SPR-RTN THRU SPR-EX.
005610*****IF W-DMM = 5                                                 D.940804
005620*****IF JS-SIGN = 1                                               D.031117
005630     IF JS-SIGN = 1 OR 4                                          I.031117
005640         PERFORM HED-RTN THRU HED-EX.
005650     GO TO M-20.
005660 M-70.
005670     PERFORM MPR2-RTN THRU MPR2-EX.
005680     PERFORM KPR-RTN THRU KPR-EX.
005690     PERFORM TPR-RTN THRU TPR-EX.
005700     PERFORM SPR-RTN THRU SPR-EX.
005710     PERFORM APR-RTN THRU APR-EX.                                 I.061018
005720*****MOVE SPACE TO W-P2.                                          D.061018
005730*****MOVE W-15K TO P-15KB.                                        D.061018
005740*****MOVE W-20K TO P-20KB.                                        D.061018
005750*****MOVE NC"　【　　総　合　計　　】　　　　" TO P-HNA.          D.060118
005760*****MOVE WA-SU TO P-SU.                                          D.061018
005770*****MOVE WA-UKI TO P-UKI.                                        D.061018
005780*****MOVE WA-SKI TO P-SKI.                                        D.061018
005790*****COMPUTE W-AR = WA-UKI - WA-SKI.                              D.061018
005800*****MOVE W-AR TO P-AR.                                           D.061018
005810*****IF WA-UKI = ZERO                                             D.061018
005820*****    GO TO M-75.                                              D.061018
005830*****MOVE WA-UKI TO W-KIN.                                        D.061018
005840*****IF W-KIN < ZERO                                              D.061018
005850*****    COMPUTE W-KIN = W-KIN * -1.                              D.061018
005860*****COMPUTE W-ALL ROUNDED = W-AR / W-KIN.                        D.061018
005870*****COMPUTE W-RR ROUNDED = W-ALL * 100.                          D.061018
005880*****MOVE W-RR TO P-RR.                                           D.061018
005890*M-75.                                                            D.061018
005900*****IF LINAGE-COUNTER > 62                                       D.010508
005910*****IF LINAGE-COUNTER > 60                                       D.061018
005920*****    PERFORM HED-RTN THRU HED-EX.                             D.061018
005930*****MOVE SPACE TO SP-R.                                          D.061018
005940*****MOVE W-P2 TO SP-R.                                           D.061018
005950*****WRITE SP-R.                                                  D.061018
005960*
005970     CLOSE SNTRF.
005980*****IF JS-SIGN = 9                                               D.101006
005990     IF JS-SIGN = 8 OR 9                                          I.101006
006000         CLOSE EXL-F                                              I.061018
006010       ELSE                                                       I.061018
006020         CLOSE SP-F.
006030     CLOSE T-M.
006040     CLOSE HI-M.
006050*****IF W-DMM = 1                                                 D.940804
006060*****    GO TO M-95.                                              D.940804
006070*****IF W-PC NOT = 2                                              D.940804
006080*****    OPEN INPUT SNTRF                                         D.940804
006090*****    GO TO M-15.                                              D.940804
006100 M-95.
006110     DISPLAY C-CLEAR.
006120     STOP RUN.
006130 ACP-RTN.                                                         I.061018
006140     IF JS-SIGN = 5                                               I.061018
006150         DISPLAY D-TCDM                                           I.061018
006160         GO TO ACP-060.                                           I.061018
006170     DISPLAY D-TCM.                                               I.061018
006180 ACP-020.                                                         I.061018
006190     ACCEPT A-STC.                                                I.061018
006200     IF ESTAT = PF9                                               I.061018
006210         GO TO ACP-EX.                                            I.061018
006220     IF ESTAT NOT = HTB AND SKP                                   I.061018
006230         GO TO ACP-020.                                           I.061018
006240 ACP-040.                                                         I.061018
006250     ACCEPT A-ETC.                                                I.061018
006260     IF ESTAT = BTB                                               I.061018
006270         GO TO ACP-020.                                           I.061018
006280     IF ESTAT NOT = HTB AND SKP                                   I.061018
006290         GO TO ACP-040.                                           I.061018
006300     IF W-STC > W-ETC                                             I.061018
006310         GO TO ACP-040.                                           I.061018
006320     GO TO ACP-100.                                               I.061018
006330 ACP-060.                                                         I.061018
006340     ACCEPT A-STCD.                                               I.061018
006350     IF ESTAT = PF9                                               I.061018
006360         GO TO ACP-EX.                                            I.061018
006370     IF ESTAT NOT = HTB AND SKP                                   I.061018
006380         GO TO ACP-060.                                           I.061018
006390 ACP-080.                                                         I.061018
006400     ACCEPT A-ETCD.                                               I.061018
006410     IF ESTAT = BTB                                               I.061018
006420         GO TO ACP-060.                                           I.061018
006430     IF ESTAT NOT = HTB AND SKP                                   I.061018
006440         GO TO ACP-080.                                           I.061018
006450     IF W-STCD > W-ETCD                                           I.061018
006460         GO TO ACP-080.                                           I.061018
006470 ACP-100.                                                         I.061018
006480     ACCEPT A-DMM.                                                I.061018
006490     IF ESTAT = BTB                                               I.061018
006500         IF JS-SIGN = 5                                           I.061018
006510             GO TO ACP-080                                        I.061018
006520           ELSE                                                   I.061018
006530             GO TO ACP-040.                                       I.061018
006540     IF ESTAT NOT = HTB AND SKP                                   I.061018
006550         GO TO ACP-100.                                           I.061018
006560     IF W-DMM = 9                                                 I.061018
006570         IF JS-SIGN = 5                                           I.061018
006580             GO TO ACP-060                                        I.061018
006590           ELSE                                                   I.061018
006600             GO TO ACP-020.                                       I.061018
006610     IF W-DMM NOT = 1                                             I.061018
006620         GO TO ACP-100.                                           I.061018
006630 ACP-EX.                                                          I.061018
006640     EXIT.                                                        I.061018
006650 DST-RTN.                                                         I.961213
006660     MOVE ZERO TO W-RD.                                           I.961213
006670     IF (SNTR-SNC = 0) OR (SNTR-DC NOT = 2)                       I.961213
006680         COMPUTE W-GKIN = SNTR-SU * SNTR-FT.                      I.961213
006690     IF (SNTR-SNC = 1) OR (SNTR-DC = 1 OR 2 OR 5)                 I.961213
006700         COMPUTE W-SU = SNTR-SU * -1                              I.961213
006710         COMPUTE W-GKIN = W-GKIN * -1                             I.961213
006720         COMPUTE W-UKIN = SNTR-KIN * -1                           I.961213
006730       ELSE                                                       I.961213
006740         MOVE SNTR-SU TO W-SU                                     I.961213
006750         MOVE SNTR-KIN TO W-UKIN.                                 I.961213
006760     IF (SNTR-HCD > 999899) OR (SNTR-SNC = 1) OR (SNTR-DC = 2)    I.961213
006770         MOVE ZERO TO W-SU.                                       I.961213
006780 DST-EX.                                                          I.961213
006790     EXIT.                                                        I.961213
006800 HED-RTN.
006810     MOVE SPACE TO SP-R.
006820     WRITE SP-R AFTER PAGE.
006830     MOVE ZERO TO W-C.
006840 HED-010.
006850     ADD 1 TO W-PAGE.
006860     MOVE W-PAGE TO H-PAGE.
006870     MOVE SPACE TO SP-R.
006880     MOVE HEAD1 TO SP-R.
006890     WRITE SP-R.
006900     MOVE SPACE TO SP-R.
006910     MOVE HEAD2 TO SP-R.
006920     WRITE SP-R AFTER 2.
006930     MOVE SPACE TO SP-R.
006940     MOVE HEAD3 TO SP-R.
006950     WRITE SP-R.
006960     MOVE SPACE TO SP-R.
006970     MOVE ZERO TO CHK.
006980 HED-EX.
006990     EXIT.
007000 MPR1-RTN.
007010     MOVE SPACE TO W-P1.
007020     MOVE W-20K TO P-20KA.
007030     IF W-C = ZERO
007040         MOVE W-TNC TO P-TNC.
007050     MOVE W-TCD TO P-TCD.
007060     MOVE T-NAME TO P-TNA.
007070*****IF LINAGE-COUNTER > 61                                       D.010509
007080*****IF LINAGE-COUNTER > 59                                       D.061018
007090     IF LINAGE-COUNTER > 61                                       I.061018
007100         MOVE W-TNC TO P-TNC
007110         PERFORM HED-RTN THRU HED-EX.
007120     MOVE SPACE TO SP-R.
007130     MOVE W-P1 TO SP-R.
007140     WRITE SP-R.
007150     MOVE 5 TO W-C.
007160 MPR1-EX.
007170     EXIT.
007180 MPR2-RTN.
007190     IF ZERO = WN-SU AND WN-UKI AND WN-SKI
007200         GO TO MPR2-EX.
007210*****IF JS-SIGN = 9                                               D.101006
007220     IF JS-SIGN = 8 OR 9                                          I.101006
007230         INITIALIZE EXL-R                                         I.061018
007240         MOVE SPACE TO EXL-TNA EXL-HNA.                           I.061018
007250     IF CHK = ZERO                                                I.061018
007260*****    IF JS-SIGN = 9                                           D.101008
007270         IF JS-SIGN = 8 OR 9                                      I.101008
007280             MOVE W-TCD TO EXL-TCD                                I.061018
007290             MOVE T-NAME TO EXL-TNA                               I.061018
007300             IF W-C = ZERO                                        I.061018
007310                 MOVE 5 TO W-C                                    I.061018
007320                 MOVE W-TNC TO EXL-TNC.                           I.061018
007330     IF CHK = ZERO
007340*****    IF JS-SIGN NOT = 9                                       D.101006
007350         IF JS-SIGN NOT = 8 AND 9                                 I.101006
007360             PERFORM MPR1-RTN THRU MPR1-EX.
007370     MOVE W-HCD TO HI-KEY.                                        I.020730
007380     READ HI-M WITH UNLOCK INVALID KEY                            I.020730
007390         MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.  I.020730
007400     IF HI-OL = 1                                                 I.020730
007410         GO TO MPR2-080.                                          I.020730
007420*****IF JS-SIGN = 9                                               D.101006
007430     IF JS-SIGN = 8 OR 9                                          I.101006
007440         MOVE W-HCD TO EXL-HCD                                    I.061018
007450         MOVE HI-NAME TO EXL-HNA                                  I.061018
007460         MOVE WN-SU TO EXL-SU                                     I.061018
007470         MOVE WN-UKI TO EXL-UKI                                   I.061018
007480         MOVE WN-SKI TO EXL-SKI                                   I.061018
007490         GO TO MPR2-010.                                          I.061018
007500     MOVE SPACE TO W-P2.
007510     MOVE W-15K TO P-15KB.
007520     MOVE W-20K TO P-20KB.
007530     MOVE W-HCD TO P-HCD.
007540*****MOVE W-HCD TO HI-KEY.                                        D.020730
007550*****READ HI-M WITH UNLOCK INVALID KEY                            D.020730
007560*****    MOVE NC"　＊＊　マスター　なし　＊＊　　　" TO HI-NAME.  D.020730
007570     MOVE HI-NAME TO P-HNA.
007580     MOVE WN-SU TO P-SU.
007590     MOVE WN-UKI TO P-UKI.
007600     MOVE WN-SKI TO P-SKI.
007610 MPR2-010.                                                        I.061018
007620     MOVE ZERO TO W-UT W-GT.
007630     IF WN-SU = ZERO
007640         GO TO MPR2-020.
007650     IF WN-UKI NOT = ZERO
007660         COMPUTE W-UT ROUNDED = WN-UKI / WN-SU.
007670     IF WN-SKI NOT = ZERO
007680         COMPUTE W-GT ROUNDED = WN-SKI / WN-SU.
007690*****MOVE W-UT TO P-UT.                                           D.061018
007700*****IF JS-SIGN = 9                                               D.101006
007710     IF JS-SIGN = 8 OR 9                                          I.101006
007720         MOVE W-UT TO EXL-UT                                      I.061018
007730         MOVE W-GT TO EXL-GT                                      I.061018
007740       ELSE                                                       I.061018
007750         MOVE W-UT TO P-UT                                        I.061018
007760         MOVE W-GT TO P-GT.
007770 MPR2-020.
007780     COMPUTE W-AR = WN-UKI - WN-SKI.
007790*****IF JS-SIGN = 9                                               D.101006
007800     IF JS-SIGN = 8 OR 9                                          I.101006
007810         MOVE W-AR TO EXL-AR                                      I.061018
007820       ELSE                                                       I.061018
007830         MOVE W-AR TO P-AR.
007840     IF WN-UKI = ZERO
007850         GO TO MPR2-040.
007860     MOVE WN-UKI TO W-KIN.
007870     IF W-KIN < ZERO
007880         COMPUTE W-KIN = W-KIN * -1.
007890     COMPUTE W-ALL ROUNDED = W-AR / W-KIN.
007900     COMPUTE W-RR ROUNDED = W-ALL * 100.
007910*****IF JS-SIGN = 9                                               D.101006
007920     IF JS-SIGN = 8 OR 9                                          I.101006
007930         MOVE W-RR TO EXL-RR                                      I.061018
007940       ELSE                                                       I.061018
007950         MOVE W-RR TO P-RR.
007960 MPR2-040.
007970*****IF JS-SIGN = 9                                               D.101006
007980     IF JS-SIGN = 8 OR 9                                          I.101006
007990         WRITE EXL-R                                              I.061018
008000         GO TO MPR2-080.                                          I.061018
008010*****IF LINAGE-COUNTER < 63                                       D.010508
008020*****IF LINAGE-COUNTER < 61                                       D.061018
008030     IF LINAGE-COUNTER < 63                                       I.061018
008040         GO TO MPR2-060.
008050     PERFORM HED-RTN THRU HED-EX.
008060     PERFORM MPR1-RTN THRU MPR1-EX.
008070 MPR2-060.
008080     MOVE SPACE TO SP-R.
008090     WRITE SP-R FROM W-P2 AFTER 1.                                A 62/05
008100     MOVE SPACE TO SP-R.                                          A 62/05
008110 MPR2-080.                                                        I.020730
008120     ADD WN-SU TO WT-SU.
008130     ADD WN-UKI TO WT-UKI.
008140     ADD WN-SKI TO WT-SKI.
008150     ADD 1 TO CNT1.
008160     MOVE 5 TO CHK.
008170 MPR2-EX.
008180     EXIT.
008190 KPR-RTN.
008200     IF ZERO = WT-SU AND WT-UKI AND WT-SKI
008210         GO TO KPR-EX.
008220     COMPUTE W-AR = WT-UKI - WT-SKI.
008230*****IF JS-SIGN = 9                                               D.101006
008240     IF JS-SIGN = 8 OR 9                                          I.101006
008250         INITIALIZE EXL-R                                         I.061018
008260         MOVE SPACE TO EXL-TNA                                    I.061018
008270         MOVE NC"　　　　　　　　　　（　　計　　）　" TO EXL-HNA I.061018
008280         MOVE WT-SU TO EXL-SU                                     I.061018
008290         MOVE WT-UKI TO EXL-UKI                                   I.061018
008300         MOVE WT-SKI TO EXL-SKI                                   I.061018
008310         MOVE W-AR TO EXL-AR                                      I.061018
008320         GO TO KPR-010.                                           I.061018
008330     IF CNT1 = 1
008340         IF HI-OL NOT = 1                                         I.020730
008350             GO TO KPR-060.
008360     MOVE SPACE TO W-P2.
008370     MOVE W-15K TO P-15KB.
008380     MOVE W-20K TO P-20KB.
008390     MOVE NC"　　　　　　　　　　（　　計　　）　　" TO P-HNA.
008400     MOVE WT-SU TO P-SU.
008410     MOVE WT-UKI TO P-UKI.
008420     MOVE WT-SKI TO P-SKI.
008430     MOVE W-AR TO P-AR.
008440 KPR-010.                                                         I.061018
008450     IF WT-UKI = ZERO
008460         GO TO KPR-020.
008470     MOVE WT-UKI TO W-KIN.
008480     IF W-KIN < ZERO
008490         COMPUTE W-KIN = W-KIN * -1.
008500     COMPUTE W-ALL ROUNDED = W-AR / W-KIN.
008510     COMPUTE W-RR ROUNDED = W-ALL * 100.
008520*****IF JS-SIGN = 9                                               D.101006
008530     IF JS-SIGN = 8 OR 9                                          I.101006
008540         MOVE W-RR TO EXL-RR                                      I.061018
008550       ELSE                                                       I.061018
008560         MOVE W-RR TO P-RR.
008570 KPR-020.
008580*****IF JS-SIGN = 9                                               D.101006
008590     IF JS-SIGN = 8 OR 9                                          I.101006
008600         WRITE EXL-R                                              I.061018
008610         GO TO KPR-060.                                           I.061018
008620*****IF LINAGE-COUNTER < 62                                       D.010509
008630*****IF LINAGE-COUNTER < 60                                       D.061018
008640     IF LINAGE-COUNTER < 62                                       I.061018
008650         GO TO KPR-040.
008660     PERFORM HED-RTN THRU HED-EX.
008670     PERFORM MPR1-RTN THRU MPR1-EX.
008680 KPR-040.
008690     MOVE SPACE TO SP-R.                                          A 62/05
008700     WRITE SP-R FROM W-P2 AFTER 1.                                A 62/05
008710 KPR-060.
008720     MOVE SPACE TO SP-R.
008730     ADD WT-SU TO WG-SU.
008740     ADD WT-UKI TO WG-UKI.
008750     ADD WT-SKI TO WG-SKI.
008760 KPR-EX.
008770     EXIT.
008780 TPR-RTN.
008790     IF ZERO = WG-SU AND WG-UKI AND WG-SKI
008800         IF JS-SIGN = 8 OR 9                                      I.140205
008810             GO TO TPR-EX                                         I.140205
008820           ELSE                                                   I.140205
008830             MOVE SPACE TO SP-R
008840             WRITE SP-R
008850             GO TO TPR-EX.
008860     COMPUTE W-AR = WG-UKI - WG-SKI.
008870*****IF JS-SIGN = 9                                               D.101006
008880     IF JS-SIGN = 8 OR 9                                          I.101006
008890         INITIALIZE EXL-R                                         I.061018
008900         MOVE SPACE TO EXL-TNA                                    I.061018
008910         MOVE NC"　　　　　　　＜　　合　計　　＞　　" TO EXL-HNA I.061018
008920         MOVE WG-SU TO EXL-SU                                     I.061018
008930         MOVE WG-UKI TO EXL-UKI                                   I.061018
008940         MOVE WG-SKI TO EXL-SKI                                   I.061018
008950         MOVE W-AR TO EXL-AR                                      I.061018
008960         GO TO TPR-010.                                           I.061018
008970     MOVE SPACE TO W-P2.
008980     MOVE W-15K TO P-15KB.
008990     MOVE W-20K TO P-20KB.
009000     MOVE NC"　　　　　　　＜　　合　計　　＞　　　" TO P-HNA.
009010     MOVE WG-SU TO P-SU.
009020     MOVE WG-UKI TO P-UKI.
009030     MOVE WG-SKI TO P-SKI.
009040     MOVE W-AR TO P-AR.
009050 TPR-010.                                                         I.061018
009060     IF WG-UKI = ZERO
009070         GO TO TPR-020.
009080     MOVE WG-UKI TO W-KIN.
009090     IF W-KIN < ZERO
009100         COMPUTE W-KIN = W-KIN * -1.
009110     COMPUTE W-ALL ROUNDED = W-AR / W-KIN.
009120     COMPUTE W-RR ROUNDED = W-ALL * 100.
009130*****IF JS-SIGN = 9                                               D.101006
009140     IF JS-SIGN = 8 OR 9                                          I.101006
009150         MOVE W-RR TO EXL-RR                                      I.061018
009160       ELSE                                                       I.061018
009170         MOVE W-RR TO P-RR.
009180 TPR-020.
009190*****IF JS-SIGN = 9                                               D.101006
009200     IF JS-SIGN = 8 OR 9                                          I.101006
009210         WRITE EXL-R                                              I.061018
009220         GO TO TPR-030.                                           I.061018
009230*****IF LINAGE-COUNTER > 62                                       D.010508
009240*****IF LINAGE-COUNTER > 60                                       D.061018
009250     IF LINAGE-COUNTER > 62                                       I.061018
009260         PERFORM HED-RTN THRU HED-EX.
009270     MOVE SPACE TO SP-R.                                          A 62/05
009280     WRITE SP-R FROM W-P2 AFTER 1.                                A 62/05
009290     MOVE SPACE TO SP-R.
009300 TPR-030.                                                         I.061018
009310     ADD WG-SU TO WS-SU.
009320     ADD WG-UKI TO WS-UKI.
009330     ADD WG-SKI TO WS-SKI.
009340 TPR-EX.
009350     EXIT.
009360 SPR-RTN.
009370     IF ZERO = WS-SU AND WS-UKI AND WS-SKI
009380         IF JS-SIGN = 8 OR 9                                      I.140205
009390             GO TO SPR-EX                                         I.140205
009400           ELSE                                                   I.140205
009410             MOVE SPACE TO SP-R
009420             WRITE SP-R
009430             GO TO SPR-EX.
009440     COMPUTE W-AR = WS-UKI - WS-SKI.
009450*****IF JS-SIGN = 9                                               D.101006
009460     IF JS-SIGN = 8 OR 9                                          I.101006
009470         INITIALIZE EXL-R                                         I.061018
009480         MOVE SPACE TO EXL-TNA                                    I.061018
009490         MOVE NC"　　　　［　　小　合　計　　］　　　" TO EXL-HNA I.061018
009500         MOVE WS-SU TO EXL-SU                                     I.061018
009510         MOVE WS-UKI TO EXL-UKI                                   I.061018
009520         MOVE WS-SKI TO EXL-SKI                                   I.061018
009530         MOVE W-AR TO EXL-AR                                      I.061018
009540         GO TO SPR-010.                                           I.061018
009550     MOVE SPACE TO W-P2.
009560     MOVE W-15K TO P-15KB.
009570     MOVE W-20K TO P-20KB.
009580     MOVE NC"　　　　［　　小　合　計　　］　　　　　" TO P-HNA.
009590     MOVE WS-SU TO P-SU.
009600     MOVE WS-UKI TO P-UKI.
009610     MOVE WS-SKI TO P-SKI.
009620     MOVE W-AR TO P-AR.
009630 SPR-010.                                                         I.061018
009640     IF WS-UKI = ZERO
009650         GO TO SPR-020.
009660     MOVE WS-UKI TO W-KIN.
009670     IF W-KIN < ZERO
009680         COMPUTE W-KIN = W-KIN * -1.
009690     COMPUTE W-ALL ROUNDED = W-AR / W-KIN.
009700     COMPUTE W-RR ROUNDED = W-ALL * 100.
009710*****IF JS-SIGN = 9                                               D.101006
009720     IF JS-SIGN = 8 OR 9                                          I.101006
009730         MOVE W-RR TO EXL-RR                                      I.061018
009740       ELSE                                                       I.061018
009750         MOVE W-RR TO P-RR.
009760 SPR-020.
009770*****IF JS-SIGN = 9                                               D.101006
009780     IF JS-SIGN = 8 OR 9                                          I.101006
009790         WRITE EXL-R                                              I.061018
009800         GO TO SPR-030.                                           I.061018
009810*****IF LINAGE-COUNTER > 62                                       D.010508
009820*****IF LINAGE-COUNTER > 60                                       D.061018
009830     IF LINAGE-COUNTER > 62                                       I.061018
009840         PERFORM HED-RTN THRU HED-EX.
009850     MOVE SPACE TO SP-R.                                          A 62/05
009860     WRITE SP-R FROM W-P2 AFTER 1.                                A 62/05
009870     MOVE SPACE TO SP-R.
009880     WRITE SP-R.
009890 SPR-030.                                                         I.061018
009900     ADD WS-SU TO WA-SU.
009910     ADD WS-UKI TO WA-UKI.
009920     ADD WS-SKI TO WA-SKI.
009930 SPR-EX.
009940     EXIT.
009950 APR-RTN.                                                         I.061018
009960     COMPUTE W-AR = WA-UKI - WA-SKI.                              I.061018
009970*****IF JS-SIGN = 9                                               D.101006
009980     IF JS-SIGN = 8 OR 9                                          I.101006
009990         INITIALIZE EXL-R                                         I.061018
010000         MOVE SPACE TO EXL-TNA                                    I.061018
010010         MOVE NC"　【　　総　合　計　　】　　　　" TO EXL-HNA     I.061018
010020         MOVE WA-SU TO EXL-SU                                     I.061018
010030         MOVE WA-UKI TO EXL-UKI                                   I.061018
010040         MOVE WA-SKI TO EXL-SKI                                   I.061018
010050         MOVE W-AR TO EXL-AR                                      I.061018
010060         GO TO APR-010.                                           I.061018
010070     MOVE SPACE TO W-P2.                                          I.061018
010080     MOVE W-15K TO P-15KB.                                        I.061018
010090     MOVE W-20K TO P-20KB.                                        I.061018
010100     MOVE NC"　【　　総　合　計　　】　　　　" TO P-HNA.          I.061018
010110     MOVE WA-SU TO P-SU.                                          I.061018
010120     MOVE WA-UKI TO P-UKI.                                        I.061018
010130     MOVE WA-SKI TO P-SKI.                                        I.061018
010140     MOVE W-AR TO P-AR.                                           I.061018
010150 APR-010.                                                         I.061018
010160     IF WA-UKI = ZERO                                             I.061018
010170         GO TO APR-020.                                           I.061018
010180     MOVE WA-UKI TO W-KIN.                                        I.061018
010190     IF W-KIN < ZERO                                              I.061018
010200         COMPUTE W-KIN = W-KIN * -1.                              I.061018
010210     COMPUTE W-ALL ROUNDED = W-AR / W-KIN.                        I.061018
010220     COMPUTE W-RR ROUNDED = W-ALL * 100.                          I.061018
010230*****IF JS-SIGN = 9                                               D.101006
010240     IF JS-SIGN = 8 OR 9                                          I.101006
010250         MOVE W-RR TO EXL-RR                                      I.061018
010260       ELSE                                                       I.061018
010270         MOVE W-RR TO P-RR.                                       I.061018
010280 APR-020.                                                         I.061018
010290*****IF JS-SIGN = 9                                               D.101006
010300     IF JS-SIGN = 8 OR 9                                          I.101006
010310         WRITE EXL-R                                              I.061018
010320         GO TO APR-EX.                                            I.061018
010330     IF LINAGE-COUNTER > 62                                       I.061018
010340         PERFORM HED-RTN THRU HED-EX.                             I.061018
010350     MOVE SPACE TO SP-R.                                          I.061018
010360     MOVE W-P2 TO SP-R.                                           I.061018
010370     WRITE SP-R.                                                  I.061018
010380 APR-EX.                                                          I.061018
010390     EXIT.                                                        I.061018
