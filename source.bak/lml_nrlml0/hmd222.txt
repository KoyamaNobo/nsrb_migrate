000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HMD220.
000030*********************************************************
000040*    PROGRAM         :  ”„ãE’lˆø“`•[”­s              *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.                                                 I.031219
000160*****SELECT S-TRAN ASSIGN TO S-MSD
000170*****    FILE STATUS IS ERR-STAT.
000180     SELECT STRANYR ASSIGN TO STRANY-MSD.                         I.010208
000190     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000200         ORGANIZATION IS INDEXED
000210         ACCESS MODE IS RANDOM
000220         RECORD KEY IS HI-KEY
000230         ALTERNATE RECORD KEY IS HI-KEY2                          I.010802
000240         FILE STATUS IS ERR-STAT.
000250     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000260         ORGANIZATION IS INDEXED
000270         ACCESS MODE IS RANDOM
000280         RECORD KEY IS T-KEY
000290         ALTERNATE  RECORD KEY IS T-KEY2
000300         FILE STATUS IS ERR-STAT.
000310     SELECT TC-M ASSIGN TO TC-MSD
000320         ORGANIZATION INDEXED
000330         RECORD KEY TC-KEY
000340         ACCESS MODE RANDOM
000350         FILE STATUS IS ERR-STAT.
000360     SELECT SP-F ASSIGN TO P-PRN999.
000370 I-O-CONTROL.
000380     APPLY SHARED-MODE ON M-DATE                                  I.031219
000390     APPLY SHARED-MODE ON HI-M TC-M
000400     APPLY SHARED-MODE ON T-M
000410     APPLY SHIFT-CODE  ON SP-F.
000420 DATA DIVISION.
000430 FILE SECTION.
000440     COPY LIBFDD.                                                 I.031219
000450     COPY LIHIM.
000460     COPY LITM.
000470     COPY LITCM.
000480*FD  S-TRAN
000490*****BLOCK  2 RECORDS
000500*****LABEL RECORD STANDARD
000510*****VALUE OF IDENTIFICATION IS "STRAN".
000520*01  S-R                PIC  X(128).                              I.010208
000530 FD  STRANYR                                                      I.010208
000540     BLOCK  2 RECORDS                                             I.010208
000550     LABEL RECORD STANDARD                                        I.010208
000560     VALUE OF IDENTIFICATION IS WK0128ID.                         I.050625
000570 01  STRANYR-R          PIC  X(128).                              I.010208
000580 FD  SP-F
000590     LABEL RECORD OMITTED
000600     LINAGE IS 36 LINES.
000610 01  SP-R               PIC  X(170).
000620 WORKING-STORAGE  SECTION.
000630*77  JS-SIGN            PIC  X(001).
000640 77  W-DCHK             PIC  9(001).
000650 77  W-DZC              PIC  9(001) VALUE 0.
000660 77  W-FILE             PIC  X(013).
000670 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
000680 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
000690 77  W-30K              PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.051031
000700 77  W-40K              PIC  X(008) VALUE ""3F504F40674F40A0"".   I.051031
000710 77  WK0128ID           PIC  X(009) VALUE SPACE.                  I.960509
000720 01  STN-NO.                                                      I.960509
000730     02  STN-NO1        PIC  X(003).                              I.960509
000740     02  STN-NO2        PIC  X(003).                              I.960509
000750 01  W-FID.                                                       I.960509
000760     02  W-FID1         PIC  X(006) VALUE "WK0128".               I.960509
000770     02  W-FID2         PIC  X(003).                              I.960509
000780 01  W-P01.
000790     02  P-15K1         PIC  X(005).
000800     02  F              PIC  X(088).                              I.041015
000810     02  P-CSC          PIC  Z(001).
000820     02  P-DC           PIC  Z(001).
000830     02  P-FRC          PIC  9(001).
000840     02  F              PIC  X(002).
000850     02  P-DNO          PIC  9(006).
000860     02  P-NBK          PIC  X(001).                              I.010523
000870     02  F              PIC  X(002).                              I.010523
000880     02  P-SHC          PIC  X(001).                              I.010208
000890 01  W-P02.
000900     02  F              PIC  X(086).                              I.041015
000910     02  P-NC           PIC  X(001).
000920     02  P-DATE         PIC 99BB99BB99.
000930     02  F              PIC  X(006).
000940 01  W-P03.
000950     02  F              PIC  X(008).                              I.041015
000960     02  P-UBM          PIC  N(002).                              I.020404
000970     02  P-UB           PIC  X(008).                              I.020404
000980     02  F              PIC  X(029).                              I.020404
000990     02  P-MID21        PIC  X(007).
001000     02  F              PIC  X(001).
001010     02  P-MID22        PIC  X(007).
001020     02  F              PIC  X(040).                              I.020404
001030 01  W-P04.
001040     02  F              PIC  X(010).                              I.041015
001050     02  P-JUO          PIC  N(020).                              I.020404
001060     02  F              PIC  X(039).                              I.051031
001070     02  P-30K          PIC  X(008).                              I.051031
001080     02  P-NRN          PIC  N(008).                              I.051031
001090     02  P-40K          PIC  X(008).                              I.051031
001100 01  W-P05.
001110     02  F              PIC  X(010).                              I.041015
001120     02  P-JUU          PIC  N(020).                              I.020404
001130     02  F              PIC  X(039).                              I.090403
001140     02  P-NRUM         PIC  N(002).                              I.051031
001150     02  P-NRU          PIC  X(008).                              I.051031
001160     02  F              PIC  X(012).                              I.051031
001170 01  W-P06.                                                       I.020404
001180     02  F              PIC  X(055).                              I.041015
001190     02  P-AZH          PIC  N(006).                              I.020404
001200     02  F              PIC  X(015).                              I.090403
001210     02  P-NRJ          PIC  N(016).                              I.090403
001220 01  W-P07.
001230     02  F              PIC  X(011).                              I.041015
001240     02  P-TNAO         PIC  N(020).                              I.020404
001250     02  F              PIC  X(041).                              I.051031
001260     02  P-NRT          PIC  X(018).                              I.051031
001270     02  F              PIC  X(003).                              I.051031
001280 01  W-P08.
001290     02  F              PIC  X(011).                              I.041015
001300     02  P-TNAU         PIC  N(020).                              I.020404
001310     02  F              PIC  X(003).                              I.020404
001320     02  P-TF           PIC  X(001).                              I.010220
001330     02  P-TNC1         PIC  9(001).                              I.010220
001340     02  P-TV           PIC  X(001).                              I.010220
001350     02  P-DCC          PIC  9(001).                              I.010220
001360     02  P-TR           PIC  X(001).                              I.010220
001370     02  F              PIC  X(001).                              I.051108
001380     02  P-W            PIC  N(002).                              I.051108
001390     02  P-TCD          PIC  9(004).
001400     02  P-V            PIC  X(001).
001410     02  P-CCD          PIC  9(003).
001420     02  F              PIC  X(001).
001430     02  P-X            PIC  X(002).
001440     02  F              PIC  X(018).                              I.051031
001450     02  P-NRF          PIC  X(018).                              I.051031
001460     02  F              PIC  X(003).                              I.051031
001470 01  W-P09.
001480     02  F              PIC  X(006).                              I.041015
001490     02  P-HCD          PIC  9(006).
001500     02  F              PIC  X(016).
001510     02  P-F            PIC  X(001).
001520     02  P-BIK          PIC  X(010).
001530     02  P-R            PIC  X(001).
001540     02  F              PIC  X(063).
001550 01  W-P10.
001560     02  F              PIC  X(005).                              I.041015
001570     02  P-HNA          PIC  N(024).
001580     02  P-SIZ          PIC  Z(001).
001590     02  P-SUD.
001600       03  P-SU    OCCURS  10  PIC  Z(004).
001610     02  P-SUT          PIC  -(006).
001620     02  P-T            PIC  Z(005).
001630     02  P-20K1         PIC  X(005).                              I.020405
001640     02  P-D.
001650       03  P-KIN        PIC  -(010).
001660     02  P-AZM   REDEFINES P-D     PIC  N(005).
001670     02  P-15K2         PIC  X(005).                              I.020405
001680 01  W-P11.
001690     02  F              PIC  X(008).                              I.041015
001700     02  P-KOSU         PIC  N(004).
001710     02  P-KO           PIC  N(002).
001720     02  F              PIC  X(007).                              I.020405
001730     02  P-CNAM         PIC  N(032).                              I.020405
001740 01  W-P12.
001750     02  F              PIC  X(082).                              I.041015
001760     02  P-ASUT         PIC  -(006).
001770     02  F              PIC  X(005).
001780     02  P-AKIN         PIC  -(010).
001790 01  W-P13.
001800     02  F              PIC  X(009).                              I.041015
001810     02  P-BI           PIC  N(024).
001820     02  F              PIC  X(035).
001830     02  P-ZR           PIC  X(004).
001840 01  W-P14.
001850     02  F              PIC  X(011).                              I.041015
001860     02  P-HNM          PIC  N(008).                              I.020405
001870     02  F              PIC  X(001).
001880     02  P-HNO          PIC  9(006).                              I.081224
001890     02  F              PIC  X(050).                              I.081224
001900     02  P-SHZ          PIC  -(008).
001910     02  F              PIC  X(005).
001920     02  P-TKIN         PIC  -(010).
001930     02  P-20K2         PIC  X(005).
001940 01  W-R.                                                         I.010208
001950     02  WR-S1.                                                   I.010208
001960       03  S1-DNO       PIC  9(006).                              I.010208
001970       03  S1-GNO       PIC  9(001).                              I.010208
001980       03  S1-DATE      PIC  9(008).                              I.010208
001990       03  S1-NGP   REDEFINES S1-DATE.                            I.031219
002000         04  S1-NG      PIC  9(006).                              I.031219
002010         04  S1-PEY     PIC  9(002).                              I.031219
002020       03  S1-TCD       PIC  9(004).                              I.010208
002030       03  S1-HCD       PIC  9(006).                              I.010208
002040       03  S1-SIZ       PIC  9(001).                              I.010208
002050       03  S1-ASU.                                                I.010208
002060         04  S1-SUD   OCCURS 10.                                  I.010208
002070           05  S1-SU    PIC S9(004)   COMP-3.                     I.010208
002080       03  S1-SUT       PIC S9(005).                              I.010208
002090       03  S1-T         PIC  9(005).                              I.010208
002100       03  S1-KIN       PIC S9(008).                              I.010208
002110       03  S1-CSC       PIC  9(001).                              I.010208
002120       03  S1-DC        PIC  9(001).                              I.010208
002130       03  S1-TCDD      PIC  9(004).                              I.090518
002140       03  F            PIC  X(001).                              I.090518
002150*****  03  S1-FT        PIC  9(005).                              I.010208
002160       03  S1-CCD       PIC  9(003).                              I.010208
002170       03  F            PIC  X(011).                              I.010208
002180       03  S1-HSC       PIC  9(001).                              I.010208
002190       03  S1-KOSU      PIC  9(003).                              I.010208
002200       03  S1-FRC       PIC  9(001).                              I.010208
002210       03  S1-TCD2      PIC  9(004).                              I.010208
002220       03  S1-BIK       PIC  X(010).                              I.010208
002230       03  F            PIC  X(012).                              I.010208
002240       03  S1-DHC       PIC  9(001).                              I.010208
002250       03  S1-UNC       PIC  9(001).                              I.010208
002260     02  WR-S2    REDEFINES WR-S1.                                I.010208
002270       03  S2-DNO       PIC  9(006).                              I.010208
002280       03  S2-GNO       PIC  9(001).                              I.010208
002290       03  S2-DATE      PIC  9(008).                              I.010208
002300       03  S2-TCD       PIC  9(004).                              I.010208
002310       03  S2-BI        PIC  N(024).                              I.010208
002320       03  S2-HNO       PIC  9(006).                              I.081224
002330       03  F            PIC  X(030).                              I.081224
002340       03  S2-TAX       PIC S9(007).                              I.010208
002350       03  S2-SHZZ      PIC S9(007).                              I.010208
002360       03  S2-UZ        PIC S9(009).                              I.010208
002370       03  S2-DHC       PIC  9(001).                              I.010208
002380       03  S2-UNC       PIC  9(001).                              I.010208
002390 01  W-DATA.
002400     02  W-TD.
002410       03  W-ASUT       PIC S9(006).
002420       03  W-AKIN       PIC S9(008).
002430       03  W-SHZ        PIC S9(006).
002440       03  W-TKIN       PIC S9(008).
002450     02  W-D.
002460       03  W-TPC        PIC  9(001).
002470       03  W-GNO        PIC  9(001).
002480       03  W-L          PIC  9(002).
002490       03  W-LC         PIC  9(002).
002500       03  W-ASU.
002510         04  W-SU    OCCURS  10  PIC S9(004).
002520       03  W-SUT        PIC S9(005).
002530       03  W-KIN        PIC S9(008).
002540       03  W-KINZ       PIC S9(007).
002550       03  CNT          PIC  9(002).
002560       03  W-DC         PIC  9(001).
002570       03  W-BE         PIC  9(001).
002580       03  W-HSC        PIC  9(001).
002590       03  W-CSC        PIC  9(001).
002600     02  CHK.
002610       03  CHK1         PIC  9(001).
002620       03  CHK2         PIC  9(001).
002630     02  W-DNO          PIC  9(006).
002640     02  W-DATE         PIC  9(008).
002650     02  W-NGP   REDEFINES W-DATE.
002660       03  F            PIC  9(002).
002670       03  W-NGPS       PIC  9(006).
002680     02  W-AAL          PIC  X(014) VALUE "13110907050301".
002690     02  W-ALD   REDEFINES W-AAL.
002700       03  W-AL    OCCURS   7  PIC  9(002).
002710     02  W-CCD          PIC  9(003).
002720     02  W-NGPD.                                                  I.050625
002730       03  W-NG.                                                  I.050625
002740         04  W-NEN      PIC  9(004).                              I.050625
002750         04  W-NEND  REDEFINES W-NEN.                             I.050625
002760           05  W-NEN1   PIC  9(002).                              I.050625
002770           05  W-NEN2   PIC  9(002).                              I.050625
002780         04  W-GET      PIC  9(002).                              I.050625
002790       03  W-PEY        PIC  9(002).                              I.050625
002800     02  W-SENGP.                                                 I.050625
002810       03  W-SNGP       PIC  9(008).                              I.050625
002820       03  W-SNGPD REDEFINES W-SNGP.                              I.050625
002830         04  W-SNG      PIC  9(006).                              I.050625
002840         04  F          PIC  9(002).                              I.050625
002850       03  W-ENGP       PIC  9(008).                              I.050625
002860       03  W-ENGPD REDEFINES W-ENGP.                              I.050625
002870         04  W-ENG      PIC  9(006).                              I.050625
002880         04  F          PIC  9(002).                              I.050625
002890     02  W-SETCD.                                                 I.050625
002900       03  W-STCD       PIC  9(004).                              I.050625
002910       03  W-ETCD       PIC  9(004).                              I.050625
002920     02  W-SEDNO.
002930       03  W-SDNO       PIC  9(006).
002940       03  W-EDNO       PIC  9(006).
002950     02  W-DMM          PIC  9(001).
002960     02  W-CCC          PIC  9(001).
002970     02  W-NAME         PIC  N(024).                              I.000821
002980     02  W-NAMED REDEFINES W-NAME.                                I.000821
002990       03  W-NAD   OCCURS  24.                                    I.000821
003000         04  W-NA       PIC  N(001).                              I.000821
003010     02  W-NC           PIC  9(001).                              I.050625
003020 01  ERR-STAT           PIC  X(002).
003030 01  W-AREA.
003040     02  W-KOSU         PIC ZZZZ.
003050     02  N              PIC  9(002).
003060     02  TBL-NAM        PIC  N(032).                              I.020405
003070     02  TBL-NAMR  REDEFINES TBL-NAM.
003080       03  T-NAM        PIC  N(001)  OCCURS  32.                  I.020405
003090     02  SV-KOSU        PIC  9(003).
003100     02  SV-TCD         PIC  9(004).
003110     02  SV-CCD2        PIC  9(003).
003120     COPY LNAMW.                                                  I.020405
003130     COPY LSTAT.
003140 SCREEN SECTION.
003150 SD  C-CRT
003160     END STATUS IS ESTAT.
003170 01  C-CLEAR.
003180     02  C-CL    LINE   1  CLEAR SCREEN.
003190 01  C-MID.
003200     02  LINE   2  COLUMN  15  PIC  N(023) VALUE
003210          NC"–––––––––––––––––––––––".
003220     02  LINE   3  COLUMN  15  PIC  N(023) VALUE
003230          NC"–––––––––––––––––––––––".
003240     02  LINE   4  COLUMN  15  PIC  N(023) VALUE
003250          NC"–––@@@@@@@@@@@@@@@@@–––".
003260     02  LINE   5  COLUMN  15  PIC  N(023) VALUE
003270          NC"–––@@”„ãE•Ô•iE’lˆø“`•[@ì¬@@–––".
003280     02  LINE   6  COLUMN  15  PIC  N(023) VALUE
003290          NC"–––@@@@@@ç‹ÈŽY‹Æ@@@@@@@–––".
003300     02  LINE   7  COLUMN  15  PIC  N(023) VALUE
003310          NC"–––––––––––––––––––––––".
003320     02  LINE   8  COLUMN  15  PIC  N(023) VALUE
003330          NC"–––––––––––––––––––––––".
003340 01  C-DSP.
003350*****02  D-SHM.
003360*****  03  LINE   6  COLUMN  33  PIC  N(005) VALUE NC"iÄ”­sj".
003370*****  03  LINE  10  COLUMN  23  PIC  X(030) VALUE                I.050625
003380*****       "“`•[‡‚ 000000 ‚æ‚è 999999 ‚Ü‚Å".
003390*****  03  LINE  12  COLUMN  23  PIC  X(037) VALUE                I.050625
003400*****       "'00”N00ŒŽ00“ú ‚æ‚è '99”N99ŒŽ99“ú ‚Ü‚Å".              I.050625
003410*****  03  LINE  14  COLUMN  23  PIC  X(030) VALUE                I.050625
003420*****       "“¾ˆÓæ   0000 ‚æ‚è 9999   ‚Ü‚Å".                     I.050625
003430*****  03  LINE  16  COLUMN  27  PIC  X(022) VALUE                I.060524
003440*****       "Šm”F  OK=1 NO=9   ØÀ°Ý".
003450     02  D-CM.
003460       03  LINE  18  COLUMN  24  PIC  X(028) VALUE                I.050625
003470            "-----   —pŽ†@ƒZƒbƒg   -----".
003480       03  LINE  20  COLUMN  21  PIC  X(034) VALUE                D.031219
003490            "[  Ã½Ä ÌßØÝÄ  OK=1 NO=9    ØÀ°Ý  ]".
003500     02  D-DM    LINE  22.                                        I.031219
003510       03  D-UDM    COLUMN  27  PIC  N(010) VALUE
003520            NC"y@@”„ã“`•[@@z".
003530       03  D-HDM    COLUMN  27  PIC  N(010) VALUE
003540            NC"y@•Ô•i’lˆø“`•[@z".
003550 01  C-ACP.
003560*****02  LINE  10.
003570*****  03  A-SDNO  COLUMN  30  PIC  9(006)
003580*****       USING W-SDNO  CHECK OVERFLOW NO IFC.
003590*****  03  A-EDNO  COLUMN  42  PIC  9(006)
003600*****       USING W-EDNO  CHECK OVERFLOW NO IFC.
003610*****02  LINE  12.                                                I.050625
003620*****  03  A-SNEN  COLUMN  24  PIC  9(002)                        I.050625
003630*****       USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
003640*****  03  A-SGET  COLUMN  28  PIC  9(002)                        I.050625
003650*****       USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
003660*****  03  A-SPEY  COLUMN  32  PIC  9(002)                        I.050625
003670*****       USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
003680*****  03  A-ENEN  COLUMN  43  PIC  9(002)                        I.050625
003690*****       USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
003700*****  03  A-EGET  COLUMN  47  PIC  9(002)                        I.050625
003710*****       USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
003720*****  03  A-EPEY  COLUMN  51  PIC  9(002)                        I.050625
003730*****       USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
003740*****02  LINE  14.                                                I.050625
003750*****  03  A-STCD  COLUMN  32  PIC  9(004)                        I.050625
003760*****       USING W-STCD  CHECK OVERFLOW NO IFC.                  I.050625
003770*****  03  A-ETCD  COLUMN  42  PIC  9(004)                        I.050625
003780*****       USING W-ETCD  CHECK OVERFLOW NO IFC.                  I.050625
003790*****02  A-DMM   LINE  16  COLUMN  44  PIC  9(001)                I.050625
003800*****     USING W-DMM   CHECK OVERFLOW NO IFC.
003810     02  A-TPC   LINE  20  COLUMN  47  PIC  9(001)                I.031219
003820          USING W-TPC   CHECK OVERFLOW NO IFC.
003830 01  C-ERR.
003840     02  LINE  24.
003850       03  EMSG-JS COLUMN  15  PIC  X(024) VALUE
003860            "***  ºÝÄÛ°Ùî•ñ´×°   ***".
003870       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
003880            "***  HIM Å¼  ***".
003890       03  E-ME4   COLUMN  15  PIC  X(034) VALUE
003900            "***  Ê¯º³¸ÌÞÝ É ÄÞ³·¶Þ ÄÚÃ²Å²  ***".
003910       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
003920            "***  STRAN ´×° (OVER)  ***".
003930       03  E-ME6   COLUMN  15  PIC  X(024) VALUE
003940            "***  STRAN ´×° (NO)  ***".
003950       03  E-ME7   COLUMN  15  PIC  X(026) VALUE
003960            "***  STRAN ´×° (ËÞº³)  ***".
003970       03  E-ME10  COLUMN  15  PIC  X(015) VALUE
003980            "***  TM Å¼  ***".
003990       03  E-ME11  COLUMN  15  PIC  X(018) VALUE
004000            "***  DATA Å¼   ***".
004010*****  03  E-ME24  COLUMN  15  PIC  X(029) VALUE
004020*****       "***   STRAN REWRITE ´×°   ***".
004030       03  E-TCD   COLUMN  50  PIC  9(004) FROM  S1-TCD.
004040       03  E-HCD   COLUMN  50  PIC  9(006) FROM  S1-HCD.
004050     COPY LSSEM.
004060     COPY LIBSCR.                                                 I.031219
004070 PROCEDURE DIVISION.
004080 M-020.
004090*****ACCEPT JS-SIGN.
004100     DISPLAY C-CLEAR.
004110     DISPLAY C-MID.
004120*****IF JS-SIGN NOT = 0 AND 1
004130*****    MOVE 255 TO COMPLETION-CODE                              I.010208
004140*****    DISPLAY EMSG-JS E-ME99
004150*****    STOP RUN.
004160     MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            I.020603
004170                   W-P07 W-P08.                                   I.020603
004180     MOVE SPACE TO W-P09 W-P10 W-P11 W-P12 W-P13 W-P14.           I.070126
004190     MOVE W-15K TO P-15K2.                                        I.020405
004200     MOVE W-20K TO P-20K1 P-20K2.                                 I.020405
004210     MOVE W-30K TO P-30K.                                         I.051031
004220     MOVE W-40K TO P-40K.                                         I.051031
004230     MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-W P-AZH P-NRN      I.051108
004240                   P-HNA P-BI P-HNM.                              I.020603
004250     MOVE NC"@§" TO P-UBM.                                      I.020405
004260     MOVE ALL "X" TO P-UB.
004270     MOVE ALL NC"‚w" TO P-JUO P-JUU P-TNAO P-TNAU P-W             I.051108
004280                        P-HNA P-BI P-CNAM P-KO.                   I.020405
004290     MOVE  NC"ç‹ÈŽY‹ÆŠ”Ž®‰ïŽÐ" TO P-NRN.                         I.051031
004300     MOVE  NC"@§" TO P-NRUM.                                    I.051031
004310     MOVE    "542-0081" TO P-NRU.                                 I.051207
004320     MOVE  NC"@‘åãŽs’†‰›‹æ“ì‘Dê‚P|‚P‚P|‚X" TO P-NRJ.         I.090403
004330     MOVE    "TEL (06) 6268-4561" TO P-NRT.                       I.051207
004340     MOVE    "FAX (06) 6268-4562" TO P-NRF.                       I.051207
004350     MOVE ALL "9" TO P-DNO P-HCD P-SUD P-SUT P-T P-KIN
004360                     P-ASUT P-AKIN P-SHZ P-TKIN.                  D.070126
004370     MOVE NC"‚X‚X‚X‚X"   TO  P-KOSU.
004380     MOVE "'" TO P-NC.
004390     MOVE 999999 TO P-DATE.
004400     MOVE 9 TO P-CSC P-DC P-SIZ.
004410*****IF JS-SIGN = 0
004420*****   GO TO M-100.
004430*****DISPLAY D-SHM.
004440*****MOVE 0 TO W-NC.                                              I.050625
004450*M-040.
004460*****ACCEPT A-SDNO.
004470*****IF ESTAT = PF9                                               I.050625
004480*****    DISPLAY C-CLEAR                                          I.050625
004490*****    STOP RUN.                                                I.050625
004500*****IF ESTAT NOT = HTB AND SKP
004510*****    GO TO M-040.
004520*M-060.
004530*****ACCEPT A-EDNO.
004540*****IF ESTAT = BTB
004550*****    GO TO M-040.
004560*****IF ESTAT = PF9                                               I.050625
004570*****    DISPLAY C-CLEAR                                          I.050625
004580*****    STOP RUN.                                                I.050625
004590*****IF ESTAT NOT = HTB AND SKP
004600*****    GO TO M-060.
004610*****IF W-SDNO > W-EDNO
004620*****    GO TO M-060.
004630*M-062.                                                           I.050625
004640*****ACCEPT A-SNEN.                                               I.050625
004650*****IF ESTAT = BTB                                               I.050625
004660*****    GO TO M-060.                                             I.050625
004670*****IF ESTAT = PF9                                               I.050625
004680*****    DISPLAY C-CLEAR                                          I.050625
004690*****    STOP RUN.                                                I.050625
004700*****IF ESTAT NOT = HTB AND SKP                                   I.050625
004710*****    GO TO M-062.                                             I.050625
004720*M-064.                                                           I.050625
004730*****ACCEPT A-SGET.                                               I.050625
004740*****IF ESTAT = BTB                                               I.050625
004750*****    GO TO M-062.                                             I.050625
004760*****IF ESTAT = PF9                                               I.050625
004770*****    DISPLAY C-CLEAR                                          I.050625
004780*****    STOP RUN.                                                I.050625
004790*****IF ESTAT NOT = HTB AND SKP                                   I.050625
004800*****    GO TO M-064.                                             I.050625
004810*M-066.                                                           I.050625
004820*****ACCEPT A-SPEY.                                               I.050625
004830*****IF ESTAT = BTB                                               I.050625
004840*****    GO TO M-064.                                             I.050625
004850*****IF ESTAT = PF9                                               I.050625
004860*****    DISPLAY C-CLEAR                                          I.050625
004870*****    STOP RUN.                                                I.050625
004880*****IF ESTAT NOT = HTB AND SKP                                   I.050625
004890*****    GO TO M-066.                                             I.050625
004900*****IF W-NEN2 = ZERO                                             I.050625
004910*****    MOVE ZERO TO W-NEN1                                      I.050625
004920*****  ELSE                                                       I.050625
004930*****    MOVE 20 TO W-NEN1.                                       I.050625
004940*****MOVE W-NGPD TO W-SNGP.                                       I.050625
004950*M-068.                                                           I.050625
004960*****ACCEPT A-ENEN.                                               I.050625
004970*****IF ESTAT = BTB                                               I.050625
004980*****    GO TO M-066.                                             I.050625
004990*****IF ESTAT = PF9                                               I.050625
005000*****    DISPLAY C-CLEAR                                          I.050625
005010*****    STOP RUN.                                                I.050625
005020*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005030*****    GO TO M-068.                                             I.050625
005040*****IF W-NEN2 = ZERO                                             I.050625
005050*****    GO TO M-068.                                             I.050625
005060*M-070.                                                           I.050625
005070*****ACCEPT A-EGET.                                               I.050625
005080*****IF ESTAT = BTB                                               I.050625
005090*****    GO TO M-068.                                             I.050625
005100*****IF ESTAT = PF9                                               I.050625
005110*****    DISPLAY C-CLEAR                                          I.050625
005120*****    STOP RUN.                                                I.050625
005130*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005140*****    GO TO M-070.                                             I.050625
005150*M-072.                                                           I.050625
005160*****ACCEPT A-EPEY.                                               I.050625
005170*****IF ESTAT = BTB                                               I.050625
005180*****    GO TO M-070.                                             I.050625
005190*****IF ESTAT = PF9                                               I.050625
005200*****    DISPLAY C-CLEAR                                          I.050625
005210*****    STOP RUN.                                                I.050625
005220*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005230*****    GO TO M-072.                                             I.050625
005240*****IF W-NEN2 = ZERO                                             I.050625
005250*****    MOVE ZERO TO W-NEN1                                      I.050625
005260*****  ELSE                                                       I.050625
005270*****    MOVE 20 TO W-NEN1.                                       I.050625
005280*****MOVE W-NGPD TO W-ENGP.                                       I.050625
005290*****IF W-SNGP > W-ENGP                                           I.050625
005300*****    GO TO M-068.                                             I.050625
005310*M-074.                                                           I.050625
005320*****ACCEPT A-STCD.                                               I.050625
005330*****IF ESTAT = BTB                                               I.050625
005340*****    GO TO M-072.                                             I.050625
005350*****IF ESTAT = PF9                                               I.050625
005360*****    DISPLAY C-CLEAR                                          I.050625
005370*****    STOP RUN.                                                I.050625
005380*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005390*****    GO TO M-074.                                             I.050625
005400*M-076.                                                           I.050625
005410*****ACCEPT A-ETCD.                                               I.050625
005420*****IF ESTAT = BTB                                               I.050625
005430*****    GO TO M-074.                                             I.050625
005440*****IF ESTAT = PF9                                               I.050625
005450*****    DISPLAY C-CLEAR                                          I.050625
005460*****    STOP RUN.                                                I.050625
005470*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005480*****    GO TO M-076.                                             I.050625
005490*****IF W-STCD > W-ETCD                                           I.050625
005500*****    GO TO M-076.                                             I.050625
005510*M-080.
005520*****ACCEPT A-DMM.
005530*****IF ESTAT = BTB
005540*****    GO TO M-076.                                             I.050625
005550*****IF ESTAT NOT = HTB AND SKP
005560*****    GO TO M-080.
005570*****IF W-DMM = 9
005580*****    DISPLAY C-CLEAR
005590*****    STOP RUN.
005600*****IF W-DMM NOT = 1
005610*****    GO TO M-080.
005620*****GO TO M-110.                                                 I.010208
005630*M-100.
005640*****PERFORM CHK-RTN THRU CHK-EX.
005650*****IF W-DCHK = 0 OR 2                                           I.050928
005660*****    MOVE 255 TO COMPLETION-CODE
005670*****    DISPLAY E-ME11 E-ME99
005680*****    DISPLAY C-CLEAR
005690*****    STOP RUN.
005700*****IF W-DCHK = 3
005710*****    MOVE 255 TO COMPLETION-CODE
005720*****    DISPLAY E-ME4 E-ME99
005730*****    DISPLAY C-CLEAR
005740*****    STOP RUN.
005750 M-110.                                                           I.010208
005760     OPEN OUTPUT SP-F.
005770*****IF JS-SIGN = 1                                               I.050625
005780         IF W-NC = 0                                              I.050625
005790             MOVE 1 TO W-NC                                       I.050625
005800           ELSE                                                   I.050625
005810             GO TO M-200.                                         I.050625
005820     DISPLAY D-CM E-ME99.
005830 M-120.
005840     PERFORM MID-RTN THRU MID-EX.
005850     ADD 1 TO W-GNO.
005860     MOVE SPACE TO SP-R.
005870     MOVE W-P09 TO SP-R.
005880     WRITE SP-R.
005890     MOVE SPACE TO SP-R.
005900     MOVE W-P10 TO SP-R.
005910     WRITE SP-R.
005920 M-140.
005930     ACCEPT A-TPC.
005940     IF ESTAT NOT = HTB AND SKP
005950         GO TO M-140.
005960     IF W-TPC = 1
005970         MOVE SPACE TO SP-R
005980         WRITE SP-R AFTER PAGE
005990         GO TO M-200.
006000     IF W-TPC NOT = 9
006010         GO TO M-140.
006020     ADD 1 TO W-GNO.
006030     IF W-GNO NOT = 7
006040         MOVE SPACE TO SP-R
006050         MOVE W-P09 TO SP-R
006060         WRITE SP-R
006070         MOVE SPACE TO SP-R
006080         MOVE W-P10 TO SP-R
006090         WRITE SP-R
006100         GO TO M-140.
006110     MOVE SPACE TO SP-R.
006120     MOVE W-P11 TO SP-R.
006130     WRITE SP-R AFTER 1.
006140     MOVE SPACE TO SP-R.
006150     MOVE W-P12 TO SP-R.
006160     WRITE SP-R AFTER 1.
006170     MOVE SPACE TO SP-R.
006180     MOVE W-P13 TO SP-R.
006190     WRITE SP-R AFTER 1.
006200     MOVE SPACE TO SP-R.
006210     MOVE W-P14 TO SP-R.
006220     WRITE SP-R AFTER 1.
006230     MOVE SPACE TO SP-R.
006240     WRITE SP-R AFTER PAGE.
006250     GO TO M-120.
006260 M-200.
006270     MOVE ZERO TO CHK.
006280     OPEN INPUT HI-M T-M TC-M.
006290*****IF JS-SIGN = 1
006300     CALL "CBLSTNNO" USING STN-NO.                                I.960509
006310     MOVE STN-NO2 TO W-FID2.                                      I.960509
006320     MOVE W-FID TO WK0128ID.                                      I.960509
006330         OPEN INPUT STRANYR.                                      I.010208
006340******   GO TO M-230.                                             I.010208
006350*****OPEN I-O S-TRAN.
006360*M-220.
006370*****READ S-TRAN AT END
006380*****    GO TO M-920.
006390*****MOVE S-R TO WR-S1.                                           I.010208
006400*****IF S1-DHC NOT = 1
006410*****    GO TO M-240.
006420*****GO TO M-220.                                                 I.010208
006430 M-230.                                                           I.010208
006440     READ STRANYR AT END                                          I.010208
006450         GO TO M-920.                                             I.010208
006460     MOVE STRANYR-R TO WR-S1.                                     I.010208
006470*****IF S1-NG < W-SNG                                             I.050625
006480*****    GO TO M-230.                                             I.031219
006490*****IF S1-NG > W-ENG                                             I.050625
006500*****    GO TO M-920.                                             I.031219
006510*****IF S1-DNO < W-SDNO OR > W-EDNO                               I.050625
006520*****    GO TO M-230.                                             I.010221
006530*****IF S1-DATE < W-SNGP OR > W-ENGP                              I.050625
006540*****    GO TO M-230.                                             I.050625
006550*****IF S1-TCD < W-STCD OR > W-ETCD                               I.050625
006560*****    GO TO M-230.                                             I.050625
006570 M-240.
006580     IF W-DZC = 0
006590         MOVE 1 TO W-DZC.
006600     MOVE ZERO TO W-TD W-D.
006610     MOVE S1-DNO TO W-DNO.
006620     MOVE S1-CSC TO W-CSC.
006630     MOVE S1-HSC TO W-HSC.
006640     IF S1-UNC = 1
006650         IF S1-KIN < 0                                            I.010523
006660             MOVE 1 TO CHK1                                       I.010523
006670             GO TO M-260                                          I.010523
006680           ELSE                                                   I.010523
006690             MOVE 5 TO CHK1
006700             GO TO M-260.
006710     IF S1-DC = 1 OR 2 OR 5
006720         MOVE 5 TO CHK1
006730         GO TO M-260.
006740     IF S1-DC = 0 OR 6
006750         MOVE 1 TO CHK1
006760         GO TO M-260.
006770     IF S1-SUT < ZERO
006780         MOVE 5 TO CHK1
006790       ELSE
006800         MOVE 1 TO CHK1.
006810 M-260.
006820     IF CHK1 = CHK2
006830         GO TO M-280.
006840     IF CHK1 = 1
006850         DISPLAY D-UDM
006860       ELSE
006870         DISPLAY D-HDM.
006880     DISPLAY E-ME99.
006890     MOVE CHK1 TO CHK2.
006900 M-280.
006910     MOVE S1-KOSU TO SV-KOSU.
006920     MOVE S1-TCD2 TO SV-TCD.
006930     MOVE S1-CCD TO SV-CCD2.
006940     MOVE S1-TCDD TO T-KEY.
006950     READ T-M WITH UNLOCK INVALID KEY
006960         DISPLAY E-ME10 E-TCD E-ME99
006970         GO TO M-980.
006980*
006990     MOVE 0 TO W-CCC.
007000     IF S1-CCD = ZERO OR 001
007010         GO TO M-300.
007020     MOVE S1-TCD2 TO TC-TCD.
007030     MOVE S1-CCD TO TC-CCD.
007040     READ TC-M WITH UNLOCK INVALID KEY
007050         MOVE 0 TO TC-DHC.
007060     IF TC-DHC NOT = 0
007070         MOVE 1 TO W-CCC.
007080 M-300.
007090*****IF JS-SIGN = 1
007100*****    GO TO M-320.
007110 M-320.
007120     MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            I.020603
007130                   W-P07 W-P08.                                   I.020603
007140     MOVE SPACE TO P-AZH.                                         I.051108
007150     MOVE W-30K TO P-30K.                                         I.051031
007160     MOVE W-40K TO P-40K.                                         I.051031
007170     MOVE  NC"ç‹ÈŽY‹ÆŠ”Ž®‰ïŽÐ" TO P-NRN.                         I.051031
007180     MOVE  NC"@§" TO P-NRUM.                                    I.051031
007190     MOVE    "542-0081" TO P-NRU.                                 I.051207
007200     MOVE  NC"@‘åãŽs’†‰›‹æ“ì‘Dê‚P|‚P‚P|‚X" TO P-NRJ.         I.090403
007210     MOVE    "TEL (06) 6268-4561" TO P-NRT.                       I.051207
007220     MOVE    "FAX (06) 6268-4562" TO P-NRF.                       I.051207
007230     MOVE S1-CSC TO P-CSC.
007240     IF S1-UNC = 0
007250         IF S1-DC = 4
007260             MOVE 0 TO P-DC
007270           ELSE
007280             MOVE S1-DC TO P-DC.
007290     IF S1-FRC NOT = 0
007300         MOVE S1-FRC TO P-FRC.
007310     MOVE W-DNO TO P-DNO.
007320     IF S1-UNC = 1                                                I.010523
007330         IF S1-KIN < 0                                            I.010523
007340             MOVE "-" TO P-NBK.                                   I.010523
007350*****IF JS-SIGN = 1                                               I.010208
007360*****    MOVE "." TO P-SHC.                                       I.010208
007370     MOVE NC"@§" TO P-UBM.                                      I.020405
007380     IF W-CCC = 1
007390         MOVE TC-UNO TO P-UB
007400       ELSE
007410         MOVE T-UNO TO P-UB.
007420     MOVE "'" TO P-NC.
007430     MOVE S1-DATE TO W-DATE.
007440     MOVE W-NGPS TO P-DATE.
007450     IF S1-UNC = 1
007460         IF S1-KIN >= 0                                           I.010523
007470             MOVE "=======" TO P-MID21.
007480     IF S1-UNC = 0
007490         IF S1-DC = 1 OR 2 OR 5
007500             MOVE "=======" TO P-MID22
007510           ELSE
007520             IF S1-DC = 3 OR 4 OR 7
007530                 IF S1-SUT < ZERO
007540                     MOVE "=======" TO P-MID22.
007550     IF W-CCC = 1
007560         MOVE TC-JSU TO P-JUO
007570         MOVE TC-JSS TO P-JUU
007580         MOVE TC-NAME TO WN-NAME                                  I.020405
007590       ELSE
007600         MOVE T-JSU TO P-JUO
007610         MOVE T-JSS TO P-JUU
007620         MOVE T-NAME TO WN-NAME.                                  I.020405
007630     COPY LNAMP.                                                  I.020405
007640     MOVE WN-ONAME TO P-TNAO.                                     I.020405
007650     MOVE WN-UNAME TO P-TNAU.                                     I.020405
007660     IF S1-DC = 2
007670         MOVE NC"•s—Ç•Ô•i@@" TO P-AZH.
007680     IF S1-DC = 3
007690         MOVE NC"—a‚è•ÛŠÇ@@" TO P-AZH.
007700     IF S1-DC = 8
007710         MOVE NC"Á”ïÅ’²®•ª" TO P-AZH.
007720*****MOVE "(" TO P-TF.                                            I.010220
007730*****MOVE T-TNC1 TO P-TNC1.                                       I.010220
007740*****MOVE "-" TO P-TV.                                            I.010220
007750*****MOVE T-DCC TO P-DCC.                                         I.010220
007760*****MOVE ")" TO P-TR.                                            I.010220
007770     MOVE NC"@‡‚" TO P-W.                                        I.051108
007780     MOVE S1-TCDD TO P-TCD.
007790*****IF W-CCC = 1
007800*****    MOVE "-" TO P-V
007810*****    MOVE S1-CCD TO P-CCD.
007820*****IF T-SS NOT = 20 AND 99
007830*****    IF T-SS > 29
007840*****        MOVE "**" TO P-X
007850*****      ELSE
007860*****        IF T-SS NOT = ZERO
007870*****            MOVE " *" TO P-X.
007880     PERFORM MID-RTN THRU MID-EX.
007890     IF S1-DC NOT = 8
007900         GO TO M-360.
007910     ADD S1-KIN TO W-AKIN.
007920     PERFORM MEI-120 THRU MEI-EX.
007930     GO TO M-400.
007940 M-360.
007950     ADD 1 TO W-GNO.
007960     IF W-GNO = 7
007970         DISPLAY E-ME5 E-ME99
007980         GO TO M-980.
007990     IF W-GNO NOT = S1-GNO
008000         DISPLAY E-ME6 E-ME99.
008010     PERFORM MEI-RTN THRU MEI-EX.
008020 M-400.
008030*****IF JS-SIGN = 1                                               I.010221
008040*****    GO TO M-420.                                             I.010221
008050*****READ S-TRAN AT END
008060*****    DISPLAY E-ME7 E-ME99
008070*****    GO TO M-980.
008080*****MOVE S-R TO WR-S1.                                           I.010208
008090*****GO TO M-440.                                                 I.010208
008100 M-420.                                                           I.010208
008110     READ STRANYR AT END                                          I.010208
008120         DISPLAY E-ME7 E-ME99                                     I.010208
008130         GO TO M-980.                                             I.010208
008140     MOVE STRANYR-R TO WR-S1.                                     I.010208
008150 M-440.                                                           I.010208
008160     IF S1-DNO = W-DNO
008170         IF S1-GNO NOT = 9
008180             GO TO M-360.
008190     IF S1-DNO NOT = W-DNO
008200         DISPLAY E-ME7 E-ME99
008210         GO TO M-980.
008220     PERFORM KEI-RTN THRU KEI-EX.
008230*****IF JS-SIGN = 1                                               I.010208
008240         GO TO M-230.                                             I.010208
008250*****  ELSE                                                       I.010208
008260*****    GO TO M-220.
008270 M-920.
008280     IF W-DZC = 0
008290         DISPLAY E-ME11 E-ME99.
008300 M-980.
008310     CLOSE HI-M T-M TC-M.
008320     CLOSE SP-F.                                                  I.050625
008330*****IF JS-SIGN = 1                                               I.010208
008340*****    CLOSE STRANYR                                            I.010208
008350*****    GO TO M-040.                                             I.050625
008360*****  ELSE                                                       I.010208
008370*****    CLOSE S-TRAN.                                            I.070126
008380     DISPLAY C-CLEAR.
008390     STOP RUN.
008400 MID-RTN.
008410     MOVE SPACE TO SP-R.
008420     MOVE W-15K TO P-15K1.                                        I.020405
008430     MOVE W-P01 TO SP-R.
008440     WRITE SP-R.
008450     MOVE SPACE TO SP-R.
008460     MOVE W-P02 TO SP-R.
008470     WRITE SP-R AFTER 2.
008480     MOVE SPACE TO SP-R.
008490     MOVE W-P03 TO SP-R.
008500     WRITE SP-R.
008510     MOVE SPACE TO SP-R.
008520     MOVE W-P04 TO SP-R.
008530     WRITE SP-R AFTER 2.                                          I.020405
008540     MOVE SPACE TO SP-R.
008550     MOVE W-P05 TO SP-R.
008560     WRITE SP-R.
008570     MOVE SPACE TO SP-R.
008580     MOVE W-P06 TO SP-R.                                          I.020603
008590     WRITE SP-R.                                                  I.020603
008600     MOVE SPACE TO SP-R.                                          I.020603
008610     MOVE W-P07 TO SP-R.
008620     WRITE SP-R.                                                  I.020603
008630     MOVE SPACE TO SP-R.
008640     MOVE W-P08 TO SP-R.
008650     WRITE SP-R.                                                  I.020405
008660     MOVE SPACE TO SP-R.
008670     WRITE SP-R AFTER 5.
008680     MOVE ZERO TO W-GNO.
008690 MID-EX.
008700     EXIT.
008710 MEI-RTN.
008720     MOVE S1-DC TO W-DC.
008730     MOVE SPACE TO W-P09 W-P10.
008740     MOVE W-15K TO P-15K2.                                        I.020405
008750     MOVE W-20K TO P-20K1.                                        I.020405
008760     IF (S1-UNC = 1) OR (S1-HCD > 999899) OR (S1-DC = 3)          I.000819
008770         GO TO MEI-040.
008780     MOVE ZERO TO CNT W-ASU.
008790 MEI-020.
008800     ADD 1 TO CNT.
008810     IF CNT = 11
008820         GO TO MEI-040.
008830     MOVE S1-SU(CNT) TO W-SU(CNT).
008840     IF W-SU(CNT) NOT = ZERO
008850         MOVE W-SU(CNT) TO P-SU(CNT).
008860     GO TO MEI-020.
008870 MEI-040.
008880     IF S1-HCD NOT = ZERO
008890         MOVE S1-HCD TO P-HCD
008900         IF S1-UNC = 0
008910             MOVE S1-SIZ TO P-SIZ.
008920     MOVE S1-SUT TO W-SUT.
008930     IF S1-HCD = ZERO
008940         GO TO MEI-100.
008950     IF S1-DC = 3 OR 4 OR 7
008960         IF W-SUT < ZERO
008970             COMPUTE W-SUT = W-SUT * -1.
008980     MOVE W-SUT TO P-SUT.
008990     IF S1-DC NOT = 4
009000         GO TO MEI-060.
009010     IF S1-SUT < ZERO
009020         MOVE NC"—a‚è‚Ö–ß‚µ" TO P-AZM
009030       ELSE
009040         MOVE NC"—a‚èo‰×@" TO P-AZM.
009050     GO TO MEI-080.
009060 MEI-060.
009070     IF S1-DC = 9
009080         MOVE NC"—a‚èU‘Ö@"    TO P-AZM
009090         GO TO MEI-080.
009100     MOVE S1-T TO P-T.
009110     MOVE S1-KIN TO W-KIN.
009120     IF (S1-DC = 3) OR (S1-UNC = 1)                               I.010523
009130         IF W-KIN < ZERO
009140             COMPUTE W-KIN = W-KIN * -1.
009150     MOVE W-KIN TO P-KIN.
009160 MEI-080.
009170     MOVE S1-HCD TO HI-KEY.
009180     READ HI-M WITH UNLOCK INVALID KEY
009190         DISPLAY E-ME3 E-HCD E-ME99
009200         MOVE SPACE TO HI-NAME.
009210*****IF S1-TCD = 0013 OR 0458 OR 0459 OR 0460                     I.010709
009220*****    MOVE HI-NAME TO W-NAME                                   I.000821
009230*****    MOVE SPACE TO W-NA(24)                                   I.000821
009240*****    MOVE W-NAME TO P-HNA                                     I.000821
009250*****  ELSE                                                       I.000821
009260         MOVE HI-NAME TO P-HNA.
009270*****IF S1-UNC = 0
009280*****    IF S1-BIK NOT = SPACE
009290*****        MOVE "[" TO P-F
009300*****        MOVE S1-BIK TO P-BIK
009310*****        MOVE "]" TO P-R.
009320 MEI-100.
009330     MOVE SPACE TO SP-R.
009340     MOVE W-P09 TO SP-R.
009350     WRITE SP-R.
009360     MOVE SPACE TO SP-R.
009370     MOVE W-P10 TO SP-R.
009380     WRITE SP-R.
009390     IF S1-HCD <  999900
009400         ADD W-SUT TO W-ASUT.
009410     IF S1-DC NOT = 4 AND 9
009420         ADD S1-KIN TO W-AKIN.
009430 MEI-120.
009440*****IF JS-SIGN = 1
009450*****    GO TO MEI-EX.
009460*****MOVE 1 TO S1-DHC.
009470*****MOVE WR-S1 TO S-R.                                           I.010208
009480*****REWRITE S-R.                                                 I.010208
009490*****IF ERR-STAT NOT = "00"
009500*****    DISPLAY E-ME78 E-STAT E-ME24 E-ME99
009510*****    DISPLAY E-CL.
009520 MEI-EX.
009530     EXIT.
009540 KEI-RTN.
009550     MOVE SPACE TO W-P12 W-P14.                                   I.070126
009560     MOVE W-20K TO P-20K2.                                        I.020405
009570     MOVE ALL NC"@" TO P-BI P-HNM P-CNAM P-KOSU P-KO.
009580 KEI-020.
009590     IF SV-KOSU NOT = ZERO
009600        MOVE SV-KOSU TO   W-KOSU
009610        MOVE W-KOSU  TO   P-KOSU
009620        MOVE NC"ŒÂŒû" TO  P-KO.
009630     IF SV-CCD2 NOT = ZERO AND 001
009640         IF W-CCC = 0
009650             PERFORM TNA-RTN THRU TNA-EX.
009660     MOVE S2-BI TO P-BI.
009670     IF S2-HNO = ZERO                                             I.081224
009680         GO TO KEI-040.
009690     MOVE NC"@¦”­‘—–¾×‘‡‚" TO P-HNM.                          I.020405
009700     MOVE S2-HNO TO P-HNO.                                        I.081224
009710 KEI-040.
009720     IF W-GNO = ZERO
009730         MOVE W-AKIN TO W-SHZ W-KINZ
009740         MOVE ZERO TO W-AKIN W-KIN
009750         GO TO KEI-060.
009760     MOVE W-ASUT TO P-ASUT.
009770     MOVE W-AKIN TO W-KIN.
009780     IF W-HSC = 0
009790         COMPUTE W-SHZ ROUNDED = W-KIN * 0.05.
009800     IF W-HSC = 3
009810         COMPUTE W-SHZ ROUNDED = W-KIN * 0.03.
009820     MOVE W-SHZ TO W-KINZ.
009830     IF (W-DC = 3) OR (S2-UNC = 1)                                I.010523
009840         IF W-KIN < ZERO
009850             COMPUTE W-KIN = W-KIN * -1
009860             COMPUTE W-KINZ = W-KINZ * -1.
009870 KEI-060.
009880     MOVE W-KIN TO P-AKIN.
009890*****IF W-KINZ NOT = ZERO
009900*****    IF W-HSC = 0
009910*****        MOVE "(5%)" TO P-ZR
009920*****      ELSE
009930*****        IF W-HSC = 3
009940*****            MOVE "(3%)" TO P-ZR.
009950     MOVE W-KINZ TO P-SHZ.
009960     COMPUTE W-TKIN = W-KIN + W-KINZ.
009970     MOVE W-TKIN TO P-TKIN.
009980*****IF JS-SIGN = 0
009990*****    IF W-DC = 1 OR 2 OR 5
010000*****        COMPUTE W-AKIN = W-AKIN * -1
010010*****        COMPUTE W-SHZ = W-SHZ * -1.                          I.071003
010020     ADD 1 TO W-GNO.
010030     MOVE SPACE TO SP-R.
010040     MOVE W-P11 TO SP-R.
010050     WRITE SP-R AFTER W-AL(W-GNO).
010060     MOVE SPACE TO SP-R.
010070     MOVE W-P12  TO SP-R.
010080     WRITE SP-R AFTER 1.
010090     MOVE SPACE TO SP-R.
010100     MOVE W-P13 TO SP-R.
010110     WRITE SP-R AFTER 1.
010120     MOVE SPACE TO SP-R.
010130     MOVE W-20K TO P-20K2.                                        I.070126
010140     MOVE W-P14 TO SP-R.
010150     WRITE SP-R AFTER 1.
010160     MOVE SPACE TO SP-R.
010170     MOVE SPACE TO SP-R.
010180     WRITE SP-R AFTER PAGE.
010190*****IF JS-SIGN = 1
010200*****    GO TO KEI-EX.
010210 KEI-120.
010220*****MOVE W-SHZ TO S2-TAX.
010230*****MOVE 1 TO S2-DHC.
010240*****MOVE WR-S2 TO S-R.                                           I.010208
010250*****REWRITE S-R.                                                 I.010208
010260*****IF ERR-STAT NOT = "00"
010270*****    DISPLAY E-ME78 E-STAT E-ME24 E-ME99
010280*****    DISPLAY E-CL.
010290 KEI-EX.
010300     EXIT.
010310 TNA-RTN.
010320     MOVE SV-TCD TO TC-TCD.
010330     MOVE SV-CCD2 TO TC-CCD.
010340     READ TC-M UNLOCK INVALID KEY
010350         MOVE SPACE TO TC-NAME.
010360     MOVE TC-NAME TO P-CNAM.
010370     MOVE P-CNAM TO TBL-NAM.
010380     MOVE 26 TO N.                                                I.020405
010390 TNA-020.
010400     IF N = 0
010410         GO TO TNA-EX.
010420     IF T-NAM(N) NOT = SPACE AND NC"@"
010430         GO TO TNA-040.
010440     COMPUTE N = N - 1.
010450     GO TO TNA-020.
010460 TNA-040.
010470     IF W-DC = 1 OR 2                                             I.050614
010480         ADD 1 TO N
010490         MOVE NC"—l" TO T-NAM(N)
010500         ADD 1 TO N
010510         MOVE NC"‚æ" TO T-NAM(N)
010520         ADD 1 TO N
010530         MOVE NC"‚è" TO T-NAM(N)
010540         ADD 1 TO N
010550         MOVE NC"•Ô" TO T-NAM(N)
010560         ADD 1 TO N
010570         MOVE NC"•i" TO T-NAM(N)
010580         MOVE TBL-NAM TO P-CNAM
010590         GO TO TNA-EX.
010600     ADD 1 TO N.
010610     MOVE NC"—l" TO T-NAM(N).
010620     ADD 1 TO N.
010630     MOVE NC"@" TO T-NAM(N).
010640     ADD 1 TO N.
010650     MOVE NC"’¼" TO T-NAM(N).
010660     ADD 1 TO N.
010670     MOVE NC"‘—" TO T-NAM(N).
010680     MOVE TBL-NAM TO P-CNAM.
010690 TNA-EX.
010700     EXIT.
010710*CHK-RTN.
010720*****MOVE 0 TO W-DCHK.
010730*****OPEN INPUT S-TRAN.
010740*CHK-020.
010750*****READ S-TRAN AT END
010760*****    GO TO CHK-040.
010770*****MOVE S-R TO WR-S1.                                           I.050928
010780*****IF W-DCHK = 1
010790*****    IF S1-DHC = 1
010800*****        MOVE 3 TO W-DCHK
010810*****        GO TO CHK-040
010820*****      ELSE
010830*****        GO TO CHK-020.
010840*****IF W-DCHK = 2
010850*****    IF S1-DHC NOT = 1
010860*****        MOVE 3 TO W-DCHK
010870*****        GO TO CHK-040
010880*****      ELSE
010890*****        GO TO CHK-020.
010900*****IF S1-DHC NOT = 1
010910*****    MOVE 1 TO W-DCHK
010920*****  ELSE
010930*****    MOVE 2 TO W-DCHK.
010940*****GO TO CHK-020.
010950*CHK-040.
010960*****CLOSE S-TRAN.
010970*CHK-EX.
010980*****EXIT.
010990 ERR-RTN.
011000     DISPLAY E-ME99
011010     GO TO ERR-RTN.
011020 ERR-EX.
011030     EXIT.
