000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HMD220.
000030*********************************************************
000040*    PROGRAM         :  ”„ãE’lˆø“`•[”­s  JS-SIGN=0   *
000050*                    :              Ä”­s  JS-SIGN=1   *
000060*    PRINTER TYPE    :  JIPS                            *
000070*    SCREEN          :  ******                          *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.                                                 I.031219
000170     SELECT S-TRAN ASSIGN TO S-MSD
000180         FILE STATUS IS ERR-STAT.
000190     SELECT STRANYR ASSIGN TO STRANY-MSD.                         I.010208
000200*****SELECT HUND-F ASSIGN TO HUND-MSD                             D.000825
000210*****    FILE STATUS IS ERR-STAT.                                 D.000825
000220*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000230     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000240         ORGANIZATION IS INDEXED
000250         ACCESS MODE IS RANDOM
000260         RECORD KEY IS HI-KEY
000270         ALTERNATE RECORD KEY IS HI-KEY2                          I.010802
000280         FILE STATUS IS ERR-STAT.
000290     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000300         ORGANIZATION IS INDEXED
000310         ACCESS MODE IS RANDOM
000320         RECORD KEY IS T-KEY
000330         ALTERNATE  RECORD KEY IS T-KEY2
000340         FILE STATUS IS ERR-STAT.
000350*****SELECT TT-M ASSIGN TO TT-MSD                                 D.070126
000360*****    ORGANIZATION IS INDEXED                                  D.070126
000370*****    ACCESS MODE IS RANDOM                                    D.070126
000380*****    RECORD KEY IS TT-KEY                                     D.070126
000390*****    FILE STATUS IS ERR-STAT.                                 D.070126
000400*****SELECT HKBM ASSIGN TO HKB-MSD                                D.070126
000410*****    ORGANIZATION IS INDEXED                                  D.070126
000420*****    ACCESS MODE IS RANDOM                                    D.070126
000430*****    RECORD KEY IS HKB-KEY                                    D.070126
000440*****    FILE STATUS IS ERR-STAT.                                 D.070126
000450     SELECT TC-M ASSIGN TO TC-MSD
000460         ORGANIZATION INDEXED
000470         RECORD KEY TC-KEY
000480         ACCESS MODE RANDOM
000490         FILE STATUS IS ERR-STAT.
000500*****SELECT TUKF ASSIGN TO TUK-MSD                                D.030912
000510*****SELECT TUKF ASSIGN TO TUK1-MSD TUK2-MSD                      D.070126
000520*****    ORGANIZATION INDEXED                                     D.070126
000530*****    ACCESS MODE RANDOM                                       D.070126
000540*****    RECORD KEY TUK-KEY                                       D.070126
000550*****    ALTERNATE RECORD KEY TUK-KEY2                            D.070126
000560*****    FILE STATUS IS ERR-STAT.                                 D.070126
000570     SELECT SP-F ASSIGN TO P-PRN999.
000580 I-O-CONTROL.
000590     APPLY SHARED-MODE ON M-DATE                                  I.031219
000600     APPLY SHARED-MODE ON HI-M TC-M
000610     APPLY SHARED-MODE ON T-M
000620*****APPLY SHARED-MODE ON TT-M                                    D.070126
000630*****APPLY SHARED-MODE ON HKBM                                    D.070126
000640*****APPLY SHARED-MODE ON TUKF                                    D.070126
000650     APPLY SHIFT-CODE  ON SP-F.
000660 DATA DIVISION.
000670 FILE SECTION.
000680     COPY LIBFDD.                                                 I.031219
000690     COPY LIHIM.
000700     COPY LITM.
000710*****COPY LITTM.                                                  D.070126
000720     COPY LITCM.
000730*****COPY LIHKBM.                                                 D.070126
000740*****COPY LITUKF.                                                 D.070126
000750 FD  S-TRAN
000760     BLOCK  2 RECORDS
000770     LABEL RECORD STANDARD
000780     VALUE OF IDENTIFICATION IS "STRAN".
000790 01  S-R                PIC  X(128).                              I.010208
000800 FD  STRANYR                                                      I.010208
000810     BLOCK  2 RECORDS                                             I.010208
000820     LABEL RECORD STANDARD                                        I.010208
000830     VALUE OF IDENTIFICATION IS "STRANYR".                        I.050625
000840*****VALUE OF IDENTIFICATION IS SNTRF-ID.                         D.050625
000850*****VALUE OF IDENTIFICATION IS "SNTRF".                          D.031219
000860 01  STRANYR-R          PIC  X(128).                              I.010208
000870*01  S-R1.                                                        D.010208
000880*****02  S1-DNO         PIC  9(006).                              D.010208
000890*****02  S1-GNO         PIC  9(001).                              D.010208
000900*****02  S1-DATE        PIC  9(008).                              D.010208
000910*****02  S1-TCD         PIC  9(004).                              D.010208
000920*****02  S1-HCD         PIC  9(006).                              D.010208
000930*****02  S1-SIZ         PIC  9(001).                              D.010208
000940*****02  S1-ASU.                                                  D.010208
000950*****  03  S1-SUD   OCCURS 10.                                    D.010208
000960*****    04  S1-SU      PIC S9(004)   COMP-3.                     D.010208
000970*****02  S1-SUT         PIC S9(005).                              D.010208
000980*****02  S1-T           PIC  9(005).                              D.010208
000990*****02  S1-KIN         PIC S9(008).                              D.010208
001000*****02  S1-CSC         PIC  9(001).                              D.010208
001010*****02  S1-DC          PIC  9(001).                              D.010208
001020*****02  S1-FT          PIC  9(005).                              D.010208
001030*****02  S1-CCD         PIC  9(003).                              D.010208
001040*****02  F              PIC  X(011).                              D.010208
001050*****02  S1-HSC         PIC  9(001).                              D.010208
001060*****02  S1-KOSU        PIC  9(003).                              D.010208
001070*****02  S1-FRC         PIC  9(001).                              D.010208
001080*****02  S1-TCD2        PIC  9(004).                              D.010208
001090*****02  S1-BIK         PIC  X(010).                              D.010208
001100*****02  F              PIC  X(012).                              D.010208
001110*****02  S1-DHC         PIC  9(001).                              D.010208
001120*****02  S1-UNC         PIC  9(001).                              D.010208
001130*01  S-R2.                                                        D.010208
001140*****02  S2-DNO         PIC  9(006).                              D.010208
001150*****02  S2-GNO         PIC  9(001).                              D.010208
001160*****02  S2-DATE        PIC  9(008).                              D.010208
001170*****02  S2-TCD         PIC  9(004).                              D.010208
001180*****02  S2-BI          PIC  N(024).                              D.010208
001190*****02  S2-HNO.                                                  D.010208
001200*****  03  S2-HN1       PIC  9(006).                              D.010208
001210*****  03  S2-HN2       PIC  9(006).                              D.010208
001220*****  03  S2-HN3       PIC  9(006).                              D.010208
001230*****  03  S2-HN4       PIC  9(006).                              D.010208
001240*****  03  S2-HN5       PIC  9(006).                              D.010208
001250*****  03  S2-HN6       PIC  9(006).                              D.010208
001260*****02  S2-TAX         PIC S9(007).                              D.010208
001270*****02  S2-SHZZ        PIC S9(007).                              D.010208
001280*****02  S2-UZ          PIC S9(009).                              D.010208
001290*****02  S2-DHC         PIC  9(001).                              D.010208
001300*****02  S2-UNC         PIC  9(001).                              D.010208
001310*FD  HUND-F                                                       D.000825
001320*****BLOCK  6 RECORDS                                             D.000825
001330*****LABEL RECORD STANDARD                                        D.000825
001340*****VALUE OF IDENTIFICATION IS "HUNDF".                          D.000825
001350*01  HUND-R.                                                      D.000825
001360*****02  UN-DATE        PIC  9(008).                              D.000825
001370*****02  UN-NO          PIC  9(006).                              D.000825
001380*****02  UN-TCD         PIC  9(004).                              D.000825
001390*****02  UN-SHZ         PIC S9(006).                              D.000825
001400*****02  UN-KIN         PIC S9(008).                              D.000825
001410*****02  UN-UNC         PIC  9(001).                              D.000825
001420*****02  UN-CSC         PIC  9(001).                              D.000825
001430*****02  F              PIC  X(008).                              D.000825
001440 FD  SP-F
001450     LABEL RECORD OMITTED
001460     LINAGE IS 36 LINES.
001470 01  SP-R               PIC  X(170).
001480 WORKING-STORAGE  SECTION.
001490 77  JS-SIGN            PIC  X(001).
001500 77  W-DCHK             PIC  9(001).
001510 77  W-NCHK             PIC  9(001) VALUE 0.                      I.151103
001520 77  W-DZC              PIC  9(001) VALUE 0.
001530 77  W-FILE             PIC  X(013).
001540*77  SNTRF-ID           PIC  X(009).                              D.050625
001550 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
001560 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
001570 77  W-30K              PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.051031
001580 77  W-40K              PIC  X(008) VALUE ""3F504F40674F40A0"".   I.051031
001590 01  W-P01.
001600     02  P-15K1         PIC  X(005).
001610*****02  F              PIC  X(089).                              D.041015
001620     02  F              PIC  X(088).                              I.041015
001630     02  P-CSC          PIC  Z(001).
001640     02  P-DC           PIC  Z(001).
001650     02  P-FRC          PIC  9(001).
001660     02  F              PIC  X(002).
001670     02  P-DNO          PIC  9(006).
001680*****02  F              PIC  X(003).                              D.010523
001690     02  P-NBK          PIC  X(001).                              I.010523
001700     02  F              PIC  X(002).                              I.010523
001710     02  P-SHC          PIC  X(001).                              I.010208
001720*****02  F              PIC  X(004).                              D.010208
001730 01  W-P02.
001740*****02  F              PIC  X(011).                              D.020404
001750*****02  P-UB           PIC  X(008).                              D.020404
001760*****02  F              PIC  X(068).                              D.020404
001770*****02  F              PIC  X(087).                              D.041015
001780     02  F              PIC  X(086).                              I.041015
001790     02  P-NC           PIC  X(001).
001800     02  P-DATE         PIC 99BB99BB99.
001810     02  F              PIC  X(006).
001820 01  W-P03.
001830*****02  F              PIC  X(057).                              D.020404
001840*****02  F              PIC  X(009).                              D.041015
001850     02  F              PIC  X(008).                              I.041015
001860     02  P-UBM          PIC  N(002).                              I.020404
001870     02  P-UB           PIC  X(008).                              I.020404
001880     02  F              PIC  X(029).                              I.020404
001890     02  P-MID21        PIC  X(007).
001900     02  F              PIC  X(001).
001910     02  P-MID22        PIC  X(007).
001920     02  F              PIC  X(040).                              I.020404
001930*****02  F              PIC  X(032).                              D.020404
001940 01  W-P04.
001950*****02  F              PIC  X(011).                              D.041015
001960     02  F              PIC  X(010).                              I.041015
001970     02  P-JUO          PIC  N(020).                              I.020404
001980     02  F              PIC  X(039).                              I.051031
001990     02  P-30K          PIC  X(008).                              I.051031
002000     02  P-NRN          PIC  N(008).                              I.051031
002010     02  P-40K          PIC  X(008).                              I.051031
002020*****02  F              PIC  X(063).                              D.051031
002030*****02  F              PIC  X(010).                              D.020404
002040*****02  P-JUO          PIC  N(024).                              D.020404
002050*****02  F              PIC  X(058).                              D.020404
002060 01  W-P05.
002070*****02  F              PIC  X(011).                              D.041015
002080     02  F              PIC  X(010).                              I.041015
002090     02  P-JUU          PIC  N(020).                              I.020404
002100*****02  F              PIC  X(040).                              D.090403
002110     02  F              PIC  X(039).                              I.090403
002120     02  P-NRUM         PIC  N(002).                              I.051031
002130     02  P-NRU          PIC  X(008).                              I.051031
002140     02  F              PIC  X(012).                              I.051031
002150*****02  F              PIC  X(063).                              D.051031
002160*****02  F              PIC  X(028).                              D.020404
002170*****02  P-JUU          PIC  N(012).                              D.020404
002180*****02  F              PIC  X(058).                              D.020404
002190 01  W-P06.                                                       I.020404
002200*****02  F              PIC  X(056).                              D.041015
002210     02  F              PIC  X(055).                              I.041015
002220     02  P-AZH          PIC  N(006).                              I.020404
002230     02  F              PIC  X(015).                              I.090403
002240     02  P-NRJ          PIC  N(016).                              I.090403
002250*****02  F              PIC  X(016).                              D.090403
002260*****02  P-NRJ          PIC  N(014).                              D.090403
002270*****02  F              PIC  X(002).                              D.090403
002280*****02  F              PIC  X(039).                              D.051031
002290 01  W-P07.
002300*****02  F              PIC  X(012).                              D.041015
002310     02  F              PIC  X(011).                              I.041015
002320     02  P-TNAO         PIC  N(020).                              I.020404
002330     02  F              PIC  X(041).                              I.051031
002340     02  P-NRT          PIC  X(018).                              I.051031
002350     02  F              PIC  X(003).                              I.051031
002360*****02  F              PIC  X(062).                              D.051031
002370*****02  P-TNA          PIC  N(024).                              D.020404
002380*****02  F              PIC  X(010).                              D.020404
002390*****02  P-AZH          PIC  N(006).                              D.020404
002400*****02  F              PIC  X(037).                              D.020404
002410 01  W-P08.
002420*****02  F              PIC  X(012).                              D.041015
002430     02  F              PIC  X(011).                              I.041015
002440     02  P-TNAU         PIC  N(020).                              I.020404
002450     02  F              PIC  X(003).                              I.020404
002460*****02  F              PIC  X(006).                              D.020404
002470     02  P-TF           PIC  X(001).                              I.010220
002480     02  P-TNC1         PIC  9(001).                              I.010220
002490     02  P-TV           PIC  X(001).                              I.010220
002500     02  P-DCC          PIC  9(001).                              I.010220
002510     02  P-TR           PIC  X(001).                              I.010220
002520     02  F              PIC  X(001).                              I.051108
002530*****02  F              PIC  X(002).                              D.051108
002540*****02  P-W            PIC  X(003).                              D.010220
002550*****02  P-W            PIC  X(002).                              D.051108
002560     02  P-W            PIC  N(002).                              I.051108
002570     02  P-TCD          PIC  9(004).
002580     02  P-V            PIC  X(001).
002590     02  P-CCD          PIC  9(003).
002600     02  F              PIC  X(001).
002610     02  P-X            PIC  X(002).
002620     02  F              PIC  X(018).                              I.051031
002630     02  P-NRF          PIC  X(018).                              I.051031
002640     02  F              PIC  X(003).                              I.051031
002650*****02  F              PIC  X(039).                              D.051031
002660*****02  F              PIC  X(078).                              D.020404
002670*****02  F              PIC  X(084).                              D.010220
002680 01  W-P09.
002690*****02  F              PIC  X(007).                              D.041015
002700     02  F              PIC  X(006).                              I.041015
002710     02  P-HCD          PIC  9(006).
002720     02  F              PIC  X(016).
002730     02  P-F            PIC  X(001).
002740     02  P-BIK          PIC  X(010).
002750     02  P-R            PIC  X(001).
002760     02  F              PIC  X(063).
002770 01  W-P10.
002780*****02  F              PIC  X(006).                              D.041015
002790     02  F              PIC  X(005).                              I.041015
002800     02  P-HNA          PIC  N(024).
002810     02  P-SIZ          PIC  Z(001).
002820     02  P-SUD.
002830       03  P-SU    OCCURS  10  PIC  Z(004).
002840     02  P-SUT          PIC  -(006).
002850     02  P-T            PIC  Z(005).
002860     02  P-20K1         PIC  X(005).                              I.020405
002870     02  P-D.
002880       03  P-KIN        PIC  -(010).
002890     02  P-AZM   REDEFINES P-D     PIC  N(005).
002900     02  P-15K2         PIC  X(005).                              I.020405
002910 01  W-P11.
002920*****02  P-CD11         PIC  X(005).                              D.020405
002930*****02  F              PIC  X(009).                              D.041015
002940     02  F              PIC  X(008).                              I.041015
002950     02  P-KOSU         PIC  N(004).
002960     02  P-KO           PIC  N(002).
002970     02  F              PIC  X(007).                              I.020405
002980     02  P-CNAM         PIC  N(032).                              I.020405
002990*****02  F              PIC  X(001).                              D.020405
003000*****02  F              PIC  X(006).                              D.020405
003010*****02  P-CD1          PIC  X(005).                              D.020405
003020*****02  P-CNAM         PIC  N(030).                              D.020405
003030 01  W-P12.
003040*****02  F              PIC  X(083).                              D.041015
003050     02  F              PIC  X(082).                              I.041015
003060     02  P-ASUT         PIC  -(006).
003070     02  F              PIC  X(005).
003080     02  P-AKIN         PIC  -(010).
003090 01  W-P13.
003100*****02  F              PIC  X(010).                              D.041015
003110     02  F              PIC  X(009).                              I.041015
003120     02  P-BI           PIC  N(024).
003130     02  F              PIC  X(035).
003140     02  P-ZR           PIC  X(005).                              I.140110
003150*****02  P-ZR           PIC  X(004).                              D.140110
003160 01  W-P14.
003170*****02  P-CD3          PIC  X(005).                              D.020405
003180*****02  F              PIC  X(010).                              D.020405
003190*****02  P-HNM          PIC  N(007).                              D.020405
003200*****02  P-CD4          PIC  X(005).                              D.020405
003210*****02  F              PIC  X(012).                              D.041015
003220     02  F              PIC  X(011).                              I.041015
003230     02  P-HNM          PIC  N(008).                              I.020405
003240     02  F              PIC  X(001).
003250     02  P-HNO          PIC  9(006).                              I.081224
003260*****02  P-HN1          PIC  9(006).                              D.081224
003270*****02  P-C2           PIC  X(001).                              D.081224
003280*****02  P-HN2          PIC  9(006).                              D.081224
003290*****02  P-C3           PIC  X(001).                              D.081224
003300*****02  P-HN3          PIC  9(006).                              D.081224
003310*****02  P-C4           PIC  X(001).                              D.081224
003320*****02  P-HN4          PIC  9(006).                              D.081224
003330*****02  P-C5           PIC  X(001).                              D.081224
003340*****02  P-HN5          PIC  9(006).                              D.081224
003350*****02  P-C6           PIC  X(001).                              D.081224
003360*****02  P-HN6          PIC  9(006).                              D.081224
003370*****02  F              PIC  X(015).                              D.081224
003380     02  F              PIC  X(050).                              I.081224
003390     02  P-SHZ          PIC  -(008).
003400     02  F              PIC  X(005).
003410     02  P-TKIN         PIC  -(010).
003420*01  W-P15.                                                       D.070126
003430*****02  F              PIC  X(081).                              D.041015
003440*****02  F              PIC  X(080).                              D.070126
003450*****02  P-SHZZ         PIC -------9.                             D.070126
003460*****02  F              PIC  X(004).                              D.070126
003470*****02  P-UZ           PIC ----------9.                          D.070126
003480     02  P-20K2         PIC  X(005).
003490 01  W-R.                                                         I.010208
003500     02  WR-S1.                                                   I.010208
003510       03  S1-DNO       PIC  9(006).                              I.010208
003520       03  S1-GNO       PIC  9(001).                              I.010208
003530       03  S1-DATE      PIC  9(008).                              I.010208
003540       03  S1-NGP   REDEFINES S1-DATE.                            I.031219
003550         04  S1-NG      PIC  9(006).                              I.031219
003560         04  S1-PEY     PIC  9(002).                              I.031219
003570       03  S1-TCD       PIC  9(004).                              I.010208
003580       03  S1-HCD       PIC  9(006).                              I.010208
003590       03  S1-SIZ       PIC  9(001).                              I.010208
003600       03  S1-ASU.                                                I.010208
003610         04  S1-SUD   OCCURS 10.                                  I.010208
003620           05  S1-SU    PIC S9(004)   COMP-3.                     I.010208
003630       03  S1-SUT       PIC S9(005).                              I.010208
003640       03  S1-T         PIC  9(005).                              I.010208
003650       03  S1-KIN       PIC S9(008).                              I.010208
003660       03  S1-CSC       PIC  9(001).                              I.010208
003670       03  S1-DC        PIC  9(001).                              I.010208
003680       03  S1-FT        PIC  9(005).                              I.010208
003690       03  S1-CCD       PIC  9(003).                              I.010208
003700       03  F            PIC  X(011).                              I.010208
003710       03  S1-HSC       PIC  9(001).                              I.010208
003720       03  S1-KOSU      PIC  9(003).                              I.010208
003730       03  S1-FRC       PIC  9(001).                              I.010208
003740       03  S1-TCD2      PIC  9(004).                              I.010208
003750       03  S1-BIK       PIC  X(010).                              I.010208
003760       03  F            PIC  X(012).                              I.010208
003770       03  S1-DHC       PIC  9(001).                              I.010208
003780       03  S1-UNC       PIC  9(001).                              I.010208
003790     02  WR-S2    REDEFINES WR-S1.                                I.010208
003800       03  S2-DNO       PIC  9(006).                              I.010208
003810       03  S2-GNO       PIC  9(001).                              I.010208
003820       03  S2-DATE      PIC  9(008).                              I.010208
003830       03  S2-TCD       PIC  9(004).                              I.010208
003840       03  S2-BI        PIC  N(024).                              I.010208
003850       03  S2-HNO       PIC  9(006).                              I.081224
003860       03  F            PIC  X(030).                              I.081224
003870*****  03  S2-HNO.                                                D.081224
003880*****    04  S2-HN1     PIC  9(006).                              D.081224
003890*****    04  S2-HN2     PIC  9(006).                              D.081224
003900*****    04  S2-HN3     PIC  9(006).                              D.081224
003910*****    04  S2-HN4     PIC  9(006).                              D.081224
003920*****    04  S2-HN5     PIC  9(006).                              D.081224
003930*****    04  S2-HN6     PIC  9(006).                              D.081224
003940       03  S2-TAX       PIC S9(007).                              I.010208
003950       03  S2-SHZZ      PIC S9(007).                              I.010208
003960       03  S2-UZ        PIC S9(009).                              I.010208
003970       03  S2-DHC       PIC  9(001).                              I.010208
003980       03  S2-UNC       PIC  9(001).                              I.010208
003990 01  W-DATA.
004000     02  W-TD.
004010       03  W-ASUT       PIC S9(006).
004020       03  W-AKIN       PIC S9(008).
004030*****  03  W-UG         PIC S9(008).                              D.071003
004040       03  W-SHZ        PIC S9(006).
004050       03  W-TKIN       PIC S9(008).
004060     02  W-D.
004070       03  W-TPC        PIC  9(001).
004080       03  W-GNO        PIC  9(001).
004090       03  W-L          PIC  9(002).
004100       03  W-LC         PIC  9(002).
004110       03  W-ASU.
004120         04  W-SU    OCCURS  10  PIC S9(004).
004130       03  W-SUT        PIC S9(005).
004140       03  W-KIN        PIC S9(008).
004150       03  W-KINZ       PIC S9(007).
004160       03  CNT          PIC  9(002).
004170       03  W-DC         PIC  9(001).
004180       03  W-BE         PIC  9(001).
004190       03  W-HSC        PIC  9(001).
004200       03  W-CSC        PIC  9(001).
004210     02  CHK.
004220       03  CHK1         PIC  9(001).
004230       03  CHK2         PIC  9(001).
004240     02  W-DNO          PIC  9(006).
004250     02  W-DATE         PIC  9(008).
004260     02  W-NGP   REDEFINES W-DATE.
004270       03  F            PIC  9(002).
004280       03  W-NGPS       PIC  9(006).
004290     02  W-NGPL  REDEFINES W-DATE.                                I.140110
004300       03  F            PIC  9(002).                              I.140110
004310       03  W-NGS        PIC  9(004).                              I.140110
004320       03  F            PIC  9(002).                              I.140110
004330     02  W-AAL          PIC  X(014) VALUE "13110907050301".
004340     02  W-ALD   REDEFINES W-AAL.
004350       03  W-AL    OCCURS   7  PIC  9(002).
004360     02  W-CCD          PIC  9(003).
004370     02  W-NGPD.                                                  I.050625
004380       03  W-NG.                                                  I.050625
004390         04  W-NEN      PIC  9(004).                              I.050625
004400         04  W-NEND  REDEFINES W-NEN.                             I.050625
004410           05  W-NEN1   PIC  9(002).                              I.050625
004420           05  W-NEN2   PIC  9(002).                              I.050625
004430         04  W-GET      PIC  9(002).                              I.050625
004440       03  W-PEY        PIC  9(002).                              I.050625
004450*****02  W-NG.                                                    D.050625
004460*****  03  W-NEN        PIC  9(004).                              D.050625
004470*****  03  W-NEND  REDEFINES W-NEN.                               D.050625
004480*****    04  W-NEN1     PIC  9(002).                              D.050625
004490*****    04  W-NEN2     PIC  9(002).                              D.050625
004500*****  03  W-GET        PIC  9(002).                              D.050625
004510*****02  W-NGL   REDEFINES W-NG.                                  D.050625
004520*****  03  F            PIC  9(002).                              D.050625
004530*****  03  W-NGS        PIC  9(004).                              D.050625
004540*****02  W-NGD          PIC  9(004).                              D.050625
004550     02  W-SENGP.                                                 I.050625
004560       03  W-SNGP       PIC  9(008).                              I.050625
004570       03  W-SNGPD REDEFINES W-SNGP.                              I.050625
004580         04  W-SNG      PIC  9(006).                              I.050625
004590         04  F          PIC  9(002).                              I.050625
004600       03  W-ENGP       PIC  9(008).                              I.050625
004610       03  W-ENGPD REDEFINES W-ENGP.                              I.050625
004620         04  W-ENG      PIC  9(006).                              I.050625
004630         04  F          PIC  9(002).                              I.050625
004640     02  W-SETCD.                                                 I.050625
004650       03  W-STCD       PIC  9(004).                              I.050625
004660       03  W-ETCD       PIC  9(004) VALUE 9999.                   I.151103
004670*****  03  W-ETCD       PIC  9(004).                              D.151103
004680     02  W-SEDNO.
004690       03  W-SDNO       PIC  9(006).
004700       03  W-EDNO       PIC  9(006) VALUE 999999.                 I.151103
004710*****  03  W-EDNO       PIC  9(006).                              D.151103
004720     02  W-DMM          PIC  9(001).
004730     02  W-CCC          PIC  9(001).
004740     02  W-NAME         PIC  N(024).                              I.000821
004750     02  W-NAMED REDEFINES W-NAME.                                I.000821
004760       03  W-NAD   OCCURS  24.                                    I.000821
004770         04  W-NA       PIC  N(001).                              I.000821
004780     02  W-NC           PIC  9(001).                              I.050625
004790     02  W-DNOD         PIC  9(006).                              I.120327
004800     02  W-DHC          PIC  9(001).                              I.120327
004810 01  ERR-STAT           PIC  X(002).
004820 01  W-AREA.
004830     02  W-KOSU         PIC ZZZZ.
004840     02  N              PIC  9(002).
004850*****02  TBL-NAM        PIC  N(030).                              D.020405
004860     02  TBL-NAM        PIC  N(032).                              I.020405
004870     02  TBL-NAMR  REDEFINES TBL-NAM.
004880       03  T-NAM        PIC  N(001)  OCCURS  32.                  I.020405
004890*****  03  T-NAM        PIC  N(001)  OCCURS  30.                  D.020405
004900     02  SV-KOSU        PIC  9(003).
004910     02  SV-TCD         PIC  9(004).
004920     02  SV-CCD2        PIC  9(003).
004930     COPY LNAMW.                                                  I.020405
004940     COPY LSTAT.
004950*****COPY LDAIW.                                                  D.070126
004960 SCREEN SECTION.
004970 SD  C-CRT
004980     END STATUS IS ESTAT.
004990 01  C-CLEAR.
005000     02  C-CL    LINE   1  CLEAR SCREEN.
005010 01  C-MID.
005020     02  LINE   2  COLUMN  15  PIC  N(023) VALUE
005030          NC"–––––––––––––––––––––––".
005040     02  LINE   3  COLUMN  15  PIC  N(023) VALUE
005050          NC"–––––––––––––––––––––––".
005060     02  LINE   4  COLUMN  15  PIC  N(023) VALUE
005070          NC"–––@@@@@@@@@@@@@@@@@–––".
005080     02  LINE   5  COLUMN  15  PIC  N(023) VALUE
005090          NC"–––@@”„ãE•Ô•iE’lˆø“`•[@ì¬@@–––".
005100     02  LINE   6  COLUMN  15  PIC  N(023) VALUE
005110          NC"–––@@@@@@@@@@@@@@@@@–––".
005120     02  LINE   7  COLUMN  15  PIC  N(023) VALUE
005130          NC"–––––––––––––––––––––––".
005140     02  LINE   8  COLUMN  15  PIC  N(023) VALUE
005150          NC"–––––––––––––––––––––––".
005160 01  C-DSP.
005170     02  D-SHM.
005180       03  LINE   6  COLUMN  33  PIC  N(005) VALUE NC"iÄ”­sj".
005190*****  03  LINE  10  COLUMN  23  PIC  X(030) VALUE                D.031219
005200*****  03  LINE  10  COLUMN  23  PIC  X(013) VALUE                D.050625
005210*****       "'  ”N   ŒŽ •ª".                                      D.050625
005220*****       "'  ”N   ŒŽ •ª".                                      D.050625
005230       03  LINE  10  COLUMN  23  PIC  X(030) VALUE                I.050625
005240            "“`•[‡‚ 000000 ‚æ‚è 999999 ‚Ü‚Å".
005250       03  LINE  12  COLUMN  23  PIC  X(037) VALUE                I.050625
005260            "'00”N00ŒŽ00“ú ‚æ‚è '99”N99ŒŽ99“ú ‚Ü‚Å".              I.050625
005270       03  LINE  14  COLUMN  23  PIC  X(030) VALUE                I.050625
005280            "“¾ˆÓæ   0000 ‚æ‚è 9999   ‚Ü‚Å".                     I.050625
005290*****  03  LINE  12  COLUMN  27  PIC  X(022) VALUE                D.031219
005300*****  03  LINE  14  COLUMN  27  PIC  X(022) VALUE                D.060524
005310       03  LINE  16  COLUMN  27  PIC  X(022) VALUE                I.060524
005320            "Šm”F  OK=1 NO=9   ØÀ°Ý".
005330     02  D-CM.
005340*****  03  LINE  14  COLUMN  24  PIC  X(028) VALUE                D.031219
005350*****  03  LINE  16  COLUMN  24  PIC  X(028) VALUE                D.050625
005360*****       "----------------------------".                       D.050625
005370*****  03  LINE  15  COLUMN  24  PIC  X(028) VALUE                D.031219
005380*****  03  LINE  17  COLUMN  24  PIC  X(028) VALUE                D.050625
005390       03  LINE  18  COLUMN  24  PIC  X(028) VALUE                I.050625
005400            "-----   —pŽ†@ƒZƒbƒg   -----".
005410*****  03  LINE  16  COLUMN  24  PIC  X(028) VALUE                D.031219
005420*****  03  LINE  18  COLUMN  24  PIC  X(028) VALUE                D.050625
005430*****       "----------------------------".
005440*****  03  LINE  18  COLUMN  21  PIC  X(034) VALUE                D.031219
005450       03  LINE  20  COLUMN  21  PIC  X(034) VALUE                D.031219
005460            "[  Ã½Ä ÌßØÝÄ  OK=1 NO=9    ØÀ°Ý  ]".
005470*****02  D-DM    LINE  20.                                        D.031219
005480     02  D-DM    LINE  22.                                        I.031219
005490       03  D-UDM    COLUMN  27  PIC  N(010) VALUE
005500            NC"y@@”„ã“`•[@@z".
005510       03  D-HDM    COLUMN  27  PIC  N(010) VALUE
005520            NC"y@•Ô•i’lˆø“`•[@z".
005530 01  C-ACP.
005540     02  LINE  10.
005550*****  03  A-NEN   COLUMN  24  PIC  9(002)                        D.050625
005560*****       USING W-NEN2  CHECK OVERFLOW NO IFC.                  D.050625
005570*****  03  A-GET   COLUMN  29  PIC  9(002)                        D.050625
005580*****       USING W-GET   CHECK OVERFLOW NO IFC.                  D.050625
005590*****02  LINE  12.                                                D.050625
005600       03  A-SDNO  COLUMN  30  PIC  9(006)
005610            USING W-SDNO  CHECK OVERFLOW NO IFC.
005620       03  A-EDNO  COLUMN  42  PIC  9(006)
005630            USING W-EDNO  CHECK OVERFLOW NO IFC.
005640     02  LINE  12.                                                I.050625
005650       03  A-SNEN  COLUMN  24  PIC  9(002)                        I.050625
005660            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
005670       03  A-SGET  COLUMN  28  PIC  9(002)                        I.050625
005680            USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
005690       03  A-SPEY  COLUMN  32  PIC  9(002)                        I.050625
005700            USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
005710       03  A-ENEN  COLUMN  43  PIC  9(002)                        I.050625
005720            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
005730       03  A-EGET  COLUMN  47  PIC  9(002)                        I.050625
005740            USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
005750       03  A-EPEY  COLUMN  51  PIC  9(002)                        I.050625
005760            USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
005770     02  LINE  14.                                                I.050625
005780       03  A-STCD  COLUMN  32  PIC  9(004)                        I.050625
005790            USING W-STCD  CHECK OVERFLOW NO IFC.                  I.050625
005800       03  A-ETCD  COLUMN  42  PIC  9(004)                        I.050625
005810            USING W-ETCD  CHECK OVERFLOW NO IFC.                  I.050625
005820*****02  A-DMM   LINE  12  COLUMN  44  PIC  9(001)                D.031219
005830*****02  A-DMM   LINE  14  COLUMN  44  PIC  9(001)                D.050625
005840     02  A-DMM   LINE  16  COLUMN  44  PIC  9(001)                I.050625
005850          USING W-DMM   CHECK OVERFLOW NO IFC.
005860*****02  A-TPC   LINE  18  COLUMN  47  PIC  9(001)                D.031219
005870     02  A-TPC   LINE  20  COLUMN  47  PIC  9(001)                I.031219
005880          USING W-TPC   CHECK OVERFLOW NO IFC.
005890 01  C-ERR.
005900     02  LINE  24.
005910       03  EMSG-JS COLUMN  15  PIC  X(024) VALUE
005920            "***  ºÝÄÛ°Ùî•ñ´×°   ***".
005930*****  03  E-ME1   COLUMN  15  PIC  X(017) VALUE                  D.070126
005940*****       "***  HKBM Å¼  ***".                                  D.070126
005950*****  03  E-ME2   COLUMN  15  PIC  X(016) VALUE                  D.070126
005960*****       "***  TTM Å¼  ***".                                   D.070126
005970       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
005980            "***  HIM Å¼  ***".
005990       03  E-ME4   COLUMN  15  PIC  X(034) VALUE
006000            "***  Ê¯º³¸ÌÞÝ É ÄÞ³·¶Þ ÄÚÃ²Å²  ***".
006010       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
006020            "***  STRAN ´×° (OVER)  ***".
006030       03  E-ME6   COLUMN  15  PIC  X(024) VALUE
006040            "***  STRAN ´×° (NO)  ***".
006050       03  E-ME7   COLUMN  15  PIC  X(026) VALUE
006060            "***  STRAN ´×° (ËÞº³)  ***".
006070       03  E-ME10  COLUMN  15  PIC  X(015) VALUE
006080            "***  TM Å¼  ***".
006090       03  E-ME11  COLUMN  15  PIC  X(018) VALUE
006100            "***  DATA Å¼   ***".
006110       03  E-ME12  COLUMN  15  PIC  N(015) VALUE                  I.120327
006120            NC"ˆóŽšÏ‚ ‚è@“r’†‚©‚çˆóŽš‚µ‚Ü‚·".                   I.120327
006130*****  03  E-ME22  COLUMN  15  PIC  X(025) VALUE                  D.070126
006140*****       "***  TTM REWRITE ´×°  ***".                          D.070126
006150*****  03  E-ME23  COLUMN  15  PIC  X(028) VALUE                  D.070126
006160*****       "***   HKBM REWRITE ´×°   ***".                       D.070126
006170       03  E-ME24  COLUMN  15  PIC  X(029) VALUE
006180            "***   STRAN REWRITE ´×°   ***".
006190*****  03  E-ME26  COLUMN  15  PIC  X(027) VALUE                  D.000825
006200*****       "***   HUNDF WRITE ´×°   ***".                        D.000825
006210*****  03  E-ME27  COLUMN  15  PIC  X(026) VALUE                  D.070126
006220*****       "***   HKBM WRITE ´×°   ***".                         D.070126
006230*****  03  E-ME28  COLUMN  15  PIC  X(026) VALUE                  D.070126
006240*****       "***   TUKF WRITE ´×°   ***".                         D.070126
006250*****  03  E-ME50  COLUMN  15  PIC  X(026) VALUE                  D.070126
006260*****       "***   ÀÞ²Á®³NO µ°ÊÞ°   ***".                         D.070126
006270       03  E-TCD   COLUMN  50  PIC  9(004) FROM  S1-TCD.
006280       03  E-HCD   COLUMN  50  PIC  9(006) FROM  S1-HCD.
006290     COPY LSSEM.
006300     COPY LIBSCR.                                                 I.031219
006310 PROCEDURE DIVISION.
006320 M-020.
006330     ACCEPT JS-SIGN.
006340     DISPLAY C-CLEAR.
006350     DISPLAY C-MID.
006360     IF JS-SIGN NOT = 0 AND 1
006370         MOVE 255 TO COMPLETION-CODE                              I.010208
006380         DISPLAY EMSG-JS E-ME99
006390         STOP RUN.
006400*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P07 W-P08.     D.020603
006410*****MOVE SPACE TO W-P11 W-P13.                                   D.020603
006420*****MOVE SPACE TO W-P09 W-P10 W-P12 W-P14 W-P15.                 D.020603
006430     MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            I.020603
006440                   W-P07 W-P08.                                   I.020603
006450*****MOVE SPACE TO W-P09 W-P10 W-P11 W-P12 W-P13 W-P14 W-P15.     D.070126
006460     MOVE SPACE TO W-P09 W-P10 W-P11 W-P12 W-P13 W-P14.           I.070126
006470     MOVE W-15K TO P-15K2.                                        I.020405
006480     MOVE W-20K TO P-20K1 P-20K2.                                 I.020405
006490     MOVE W-30K TO P-30K.                                         I.051031
006500     MOVE W-40K TO P-40K.                                         I.051031
006510*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-AZH                D.051031
006520*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-AZH P-NRN          D.051108
006530     MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-W P-AZH P-NRN      I.051108
006540                   P-HNA P-BI P-HNM.                              I.020603
006550*****MOVE SPACE TO P-JUO P-JUU P-TNAO P-TNAU P-HNA P-BI P-HNM.    D.020603
006560*****MOVE SPACE TO P-JUO P-JUU P-TNA P-HNA P-BI P-HNM.            D.020405
006570     MOVE NC"@§" TO P-UBM.                                      I.020405
006580     MOVE ALL "X" TO P-UB.
006590*****MOVE ALL NC"‚w" TO P-JUO P-JUU P-TNAO P-TNAU                 D.051108
006600     MOVE ALL NC"‚w" TO P-JUO P-JUU P-TNAO P-TNAU P-W             I.051108
006610                        P-HNA P-BI P-CNAM P-KO.                   I.020405
006620     MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ" TO P-NRN.                         I.051031
006630     MOVE  NC"@§" TO P-NRUM.                                    I.051031
006640     MOVE    "700-0975" TO P-NRU.                                 I.051207
006650     MOVE  NC"@‰ªŽRŽs–k‹æ¡‚W’š–Ú‚P‚U”Ô‚P‚V†" TO P-NRJ.         I.090403
006660*****MOVE  NC"@‰ªŽRŽs¡‚W’š–Ú‚P‚U”Ô‚P‚V†" TO P-NRJ.             D.090403
006670     MOVE    "TEL (086) 243-2456" TO P-NRT.                       I.051207
006680     MOVE    "FAX (086) 242-0550" TO P-NRF.                       I.051207
006690*****MOVE    "700-0034" TO P-NRU.                                 D.051207
006700*****MOVE  NC"@‰ªŽRŽs‚–ö“Œ’¬‚P‚R”Ô‚S‚U†" TO P-NRJ.             D.051207
006710*****MOVE    "TEL (086) 252-2456" TO P-NRT.                       D.051207
006720*****MOVE    "FAX (086) 254-8595" TO P-NRF.                       D.051207
006730*****MOVE ALL NC"‚w" TO P-JUO P-JUU P-TNA P-HNA P-BI P-CNAM.      D.020405
006740*****MOVE ALL NC"‚w" TO P-KO.                                     D.020405
006750     MOVE ALL "9" TO P-DNO P-HCD P-SUD P-SUT P-T P-KIN
006760                     P-ASUT P-AKIN P-SHZ P-TKIN.                  D.070126
006770*****                P-ASUT P-AKIN P-UZ P-SHZ P-SHZZ P-TKIN.      D.070126
006780     MOVE NC"‚X‚X‚X‚X"   TO  P-KOSU.
006790     MOVE "'" TO P-NC.
006800     MOVE 999999 TO P-DATE.
006810     MOVE 9 TO P-CSC P-DC P-SIZ.
006820     IF JS-SIGN = 0
006830        GO TO M-100.
006840*****COPY LIBCPR.                                                 D.050625
006850*****MOVE D-NHNG TO W-NGD.                                        D.050625
006860*****MOVE W-NGD TO W-NGS.                                         D.060624
006870     DISPLAY D-SHM.
006880     MOVE 0 TO W-NC.                                              I.050625
006890*****DISPLAY A-NEN A-GET.                                         D.050625
006900*M-030.                                                           D.050625
006910*****ACCEPT A-NEN.                                                D.050625
006920*****IF ESTAT = PF9                                               D.050625
006930*****    DISPLAY C-CLEAR                                          D.050625
006940*****    STOP RUN.                                                D.050625
006950*****IF ESTAT NOT = HTB AND SKP                                   D.050625
006960*****    GO TO M-030.                                             D.050625
006970*****MOVE ZERO TO W-NEN1.                                         D.050625
006980*****IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        D.050625
006990*****    ADD DATE-NC1 TO W-NEN.                                   D.050625
007000*****IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        D.050625
007010*****    ADD DATE-NC2 TO W-NEN.                                   D.050625
007020*M-035.                                                           D.050625
007030*****ACCEPT A-GET.                                                D.050625
007040*****IF ESTAT = BTB                                               D.050625
007050*****    GO TO M-030.                                             D.050625
007060*****IF ESTAT NOT = HTB AND SKP                                   D.050625
007070*****    GO TO M-035.                                             D.050625
007080*****IF W-GET < 1 OR > 12                                         D.050625
007090*****    GO TO M-035.                                             D.050625
007100 M-040.
007110     ACCEPT A-SDNO.
007120*****IF ESTAT = BTB                                               D.050625
007130*****    GO TO M-035.                                             D.050625
007140     IF ESTAT = PF9                                               I.050625
007150         DISPLAY C-CLEAR                                          I.050625
007160         STOP RUN.                                                I.050625
007170*****IF ESTAT = PF9                                               D.031219
007180*****    DISPLAY C-CLEAR                                          D.031219
007190*****    STOP RUN.                                                D.031219
007200     IF ESTAT NOT = HTB AND SKP
007210         GO TO M-040.
007220 M-060.
007230     ACCEPT A-EDNO.
007240     IF ESTAT = BTB
007250         GO TO M-040.
007260     IF ESTAT = PF9                                               I.050625
007270         DISPLAY C-CLEAR                                          I.050625
007280         STOP RUN.                                                I.050625
007290     IF ESTAT NOT = HTB AND SKP
007300         GO TO M-060.
007310     IF W-SDNO > W-EDNO
007320         GO TO M-060.
007330 M-062.                                                           I.050625
007340     ACCEPT A-SNEN.                                               I.050625
007350     IF ESTAT = BTB                                               I.050625
007360         GO TO M-060.                                             I.050625
007370     IF ESTAT = PF9                                               I.050625
007380         DISPLAY C-CLEAR                                          I.050625
007390         STOP RUN.                                                I.050625
007400     IF ESTAT NOT = HTB AND SKP                                   I.050625
007410         GO TO M-062.                                             I.050625
007420 M-064.                                                           I.050625
007430     ACCEPT A-SGET.                                               I.050625
007440     IF ESTAT = BTB                                               I.050625
007450         GO TO M-062.                                             I.050625
007460     IF ESTAT = PF9                                               I.050625
007470         DISPLAY C-CLEAR                                          I.050625
007480         STOP RUN.                                                I.050625
007490     IF ESTAT NOT = HTB AND SKP                                   I.050625
007500         GO TO M-064.                                             I.050625
007510 M-066.                                                           I.050625
007520     ACCEPT A-SPEY.                                               I.050625
007530     IF ESTAT = BTB                                               I.050625
007540         GO TO M-064.                                             I.050625
007550     IF ESTAT = PF9                                               I.050625
007560         DISPLAY C-CLEAR                                          I.050625
007570         STOP RUN.                                                I.050625
007580     IF ESTAT NOT = HTB AND SKP                                   I.050625
007590         GO TO M-066.                                             I.050625
007600     IF W-NEN2 = ZERO                                             I.050625
007610         MOVE ZERO TO W-NEN1                                      I.050625
007620       ELSE                                                       I.050625
007630         MOVE 20 TO W-NEN1.                                       I.050625
007640     MOVE W-NGPD TO W-SNGP.                                       I.050625
007650     IF W-NCHK = 0                                                I.151103
007660         MOVE 1 TO W-NCHK                                         I.151103
007670         MOVE 99 TO W-NEN2 W-GET W-PEY                            I.151103
007680       ELSE                                                       I.151103
007690         MOVE W-ENGP TO W-NGPD.                                   I.151103
007700 M-068.                                                           I.050625
007710     ACCEPT A-ENEN.                                               I.050625
007720     IF ESTAT = BTB                                               I.050625
007730         MOVE W-SNGP TO W-NGPD                                    I.151103
007740         GO TO M-066.                                             I.050625
007750     IF ESTAT = PF9                                               I.050625
007760         DISPLAY C-CLEAR                                          I.050625
007770         STOP RUN.                                                I.050625
007780     IF ESTAT NOT = HTB AND SKP                                   I.050625
007790         GO TO M-068.                                             I.050625
007800     IF W-NEN2 = ZERO                                             I.050625
007810         GO TO M-068.                                             I.050625
007820     MOVE W-NGPD TO W-ENGP.                                       I.151103
007830 M-070.                                                           I.050625
007840     ACCEPT A-EGET.                                               I.050625
007850     IF ESTAT = BTB                                               I.050625
007860         GO TO M-068.                                             I.050625
007870     IF ESTAT = PF9                                               I.050625
007880         DISPLAY C-CLEAR                                          I.050625
007890         STOP RUN.                                                I.050625
007900     IF ESTAT NOT = HTB AND SKP                                   I.050625
007910         GO TO M-070.                                             I.050625
007920     MOVE W-NGPD TO W-ENGP.                                       I.151103
007930 M-072.                                                           I.050625
007940     ACCEPT A-EPEY.                                               I.050625
007950     IF ESTAT = BTB                                               I.050625
007960         GO TO M-070.                                             I.050625
007970     IF ESTAT = PF9                                               I.050625
007980         DISPLAY C-CLEAR                                          I.050625
007990         STOP RUN.                                                I.050625
008000     IF ESTAT NOT = HTB AND SKP                                   I.050625
008010         GO TO M-072.                                             I.050625
008020     IF W-NEN2 = ZERO                                             I.050625
008030         MOVE ZERO TO W-NEN1                                      I.050625
008040       ELSE                                                       I.050625
008050         MOVE 20 TO W-NEN1.                                       I.050625
008060     MOVE W-NGPD TO W-ENGP.                                       I.050625
008070     IF W-SNGP > W-ENGP                                           I.050625
008080         GO TO M-068.                                             I.050625
008090 M-074.                                                           I.050625
008100     ACCEPT A-STCD.                                               I.050625
008110     IF ESTAT = BTB                                               I.050625
008120         GO TO M-072.                                             I.050625
008130     IF ESTAT = PF9                                               I.050625
008140         DISPLAY C-CLEAR                                          I.050625
008150         STOP RUN.                                                I.050625
008160     IF ESTAT NOT = HTB AND SKP                                   I.050625
008170         GO TO M-074.                                             I.050625
008180 M-076.                                                           I.050625
008190     ACCEPT A-ETCD.                                               I.050625
008200     IF ESTAT = BTB                                               I.050625
008210         GO TO M-074.                                             I.050625
008220     IF ESTAT = PF9                                               I.050625
008230         DISPLAY C-CLEAR                                          I.050625
008240         STOP RUN.                                                I.050625
008250     IF ESTAT NOT = HTB AND SKP                                   I.050625
008260         GO TO M-076.                                             I.050625
008270     IF W-STCD > W-ETCD                                           I.050625
008280         GO TO M-076.                                             I.050625
008290 M-080.
008300     ACCEPT A-DMM.
008310     IF ESTAT = BTB
008320         GO TO M-076.                                             I.050625
008330*****    GO TO M-060.                                             D.050625
008340     IF ESTAT NOT = HTB AND SKP
008350         GO TO M-080.
008360     IF W-DMM = 9
008370         DISPLAY C-CLEAR
008380         STOP RUN.
008390     IF W-DMM NOT = 1
008400         GO TO M-080.
008410*****IF W-NGD = W-NGS                                             D.050625
008420*****    MOVE "SNTRF    " TO SNTRF-ID                             D.050625
008430*****  ELSE                                                       D.050625
008440*****    MOVE "STRANYR  " TO SNTRF-ID.                            D.050625
008450     GO TO M-110.                                                 I.010208
008460 M-100.
008470     PERFORM CHK-RTN THRU CHK-EX.
008480*****IF W-DCHK = 0                                                D.050928
008490*****IF W-DCHK = 0 OR 2                                           D.120327
008500     IF W-DCHK = 0                                                I.120327
008510         MOVE 255 TO COMPLETION-CODE
008520         DISPLAY E-ME11 E-ME99
008530         DISPLAY C-CLEAR
008540         STOP RUN.
008550*****IF JS-SIGN = 1                                               D.010208
008560*****    IF W-DCHK = 1                                            D.010208
008570*****        MOVE 255 TO COMPLETION-CODE                          D.010208
008580*****        DISPLAY E-ME11 E-ME99                                D.010208
008590*****        DISPLAY C-CLEAR                                      D.010208
008600*****        STOP RUN.                                            D.010208
008610*****IF JS-SIGN = 0                                               D.010208
008620*****IF W-DCHK = 2                                                D.050928
008630*****    MOVE 255 TO COMPLETION-CODE                              D.050928
008640*****    DISPLAY E-ME11 E-ME99                                    D.050928
008650*****    DISPLAY C-CLEAR                                          D.050928
008660*****    STOP RUN.                                                D.050928
008670     IF W-DCHK = 3
008680         MOVE 255 TO COMPLETION-CODE
008690         DISPLAY E-ME4 E-ME99
008700         DISPLAY C-CLEAR
008710         STOP RUN.
008720     IF W-DCHK = 2                                                I.120327
008730         DISPLAY E-ME12 E-ME99                                    I.120327
008740         DISPLAY E-CL.                                            I.120327
008750 M-110.                                                           I.010208
008760     OPEN OUTPUT SP-F.
008770     IF JS-SIGN = 1                                               I.050625
008780         IF W-NC = 0                                              I.050625
008790             MOVE 1 TO W-NC                                       I.050625
008800           ELSE                                                   I.050625
008810             GO TO M-200.                                         I.050625
008820     DISPLAY D-CM E-ME99.
008830 M-120.
008840     PERFORM MID-RTN THRU MID-EX.
008850     ADD 1 TO W-GNO.
008860     MOVE SPACE TO SP-R.
008870     MOVE W-P09 TO SP-R.
008880     WRITE SP-R.
008890     MOVE SPACE TO SP-R.
008900     MOVE W-P10 TO SP-R.
008910     WRITE SP-R.
008920 M-140.
008930     ACCEPT A-TPC.
008940     IF ESTAT NOT = HTB AND SKP
008950         GO TO M-140.
008960     IF W-TPC = 1
008970         MOVE SPACE TO SP-R
008980         WRITE SP-R AFTER PAGE
008990         GO TO M-200.
009000     IF W-TPC NOT = 9
009010         GO TO M-140.
009020     ADD 1 TO W-GNO.
009030     IF W-GNO NOT = 7
009040         MOVE SPACE TO SP-R
009050         MOVE W-P09 TO SP-R
009060         WRITE SP-R
009070         MOVE SPACE TO SP-R
009080         MOVE W-P10 TO SP-R
009090         WRITE SP-R
009100         GO TO M-140.
009110     MOVE SPACE TO SP-R.
009120     MOVE W-P11 TO SP-R.
009130     WRITE SP-R AFTER 1.
009140     MOVE SPACE TO SP-R.
009150     MOVE W-P12 TO SP-R.
009160     WRITE SP-R AFTER 1.
009170     MOVE SPACE TO SP-R.
009180     MOVE W-P13 TO SP-R.
009190     WRITE SP-R AFTER 1.
009200     MOVE SPACE TO SP-R.
009210     MOVE W-P14 TO SP-R.
009220     WRITE SP-R AFTER 1.
009230     MOVE SPACE TO SP-R.
009240*****MOVE W-P15 TO SP-R.                                          D.070126
009250*****WRITE SP-R AFTER 3.                                          D.070126
009260*****MOVE SPACE TO SP-R.                                          D.070126
009270     WRITE SP-R AFTER PAGE.
009280     GO TO M-120.
009290 M-200.
009300     MOVE ZERO TO CHK.
009310     OPEN INPUT HI-M T-M TC-M.
009320     IF JS-SIGN = 1
009330         OPEN INPUT STRANYR                                       I.010208
009340         GO TO M-230.                                             I.010208
009350*****    OPEN INPUT S-TRAN                                        D.010208
009360*****    GO TO M-220.                                             D.010208
009370     OPEN I-O S-TRAN.
009380*****OPEN I-O TT-M.                                               D.070126
009390*****OPEN EXTEND HUND-F.                                          D.000825
009400*****OPEN I-O TUKF.                                               D.070126
009410*****OPEN I-O HKBM.                                               D.070126
009420 M-220.
009430     READ S-TRAN AT END
009440         GO TO M-920.
009450     MOVE S-R TO WR-S1.                                           I.010208
009460*****IF S1-DHC NOT = 1                                            D.120327
009470     IF S1-DHC = 1                                                I.120327
009480         GO TO M-220.                                             I.120327
009490     GO TO M-240.
009500*****GO TO M-220.                                                 D.120327
009510 M-230.                                                           I.010208
009520     READ STRANYR AT END                                          I.010208
009530         GO TO M-920.                                             I.010208
009540     MOVE STRANYR-R TO WR-S1.                                     I.010208
009550*****IF JS-SIGN = 1                                               D.010208
009560*****IF S1-NG < W-NG                                              D.050625
009570     IF S1-NG < W-SNG                                             I.050625
009580         GO TO M-230.                                             I.031219
009590*****IF S1-NG > W-NG                                              D.050625
009600     IF S1-NG > W-ENG                                             I.050625
009610         GO TO M-920.                                             I.031219
009620*****IF S1-DNO < W-SDNO                                           D.050625
009630     IF S1-DNO < W-SDNO OR > W-EDNO                               I.050625
009640         GO TO M-230.                                             I.010221
009650     IF S1-DATE < W-SNGP OR > W-ENGP                              I.050625
009660         GO TO M-230.                                             I.050625
009670     IF S1-TCD < W-STCD OR > W-ETCD                               I.050625
009680         GO TO M-230.                                             I.050625
009690*****    GO TO M-220.                                             D.010221
009700*****IF JS-SIGN = 1                                               D.010208
009710*****IF S1-DNO > W-EDNO                                           D.050625
009720*****    GO TO M-920.                                             D.050625
009730 M-240.
009740     IF W-DZC = 0
009750         MOVE 1 TO W-DZC.
009760     MOVE ZERO TO W-TD W-D.
009770     MOVE S1-DNO TO W-DNO.
009780     MOVE S1-CSC TO W-CSC.
009790     MOVE S1-HSC TO W-HSC.
009800     IF S1-UNC = 1
009810         IF S1-KIN < 0                                            I.010523
009820             MOVE 1 TO CHK1                                       I.010523
009830             GO TO M-260                                          I.010523
009840           ELSE                                                   I.010523
009850             MOVE 5 TO CHK1
009860             GO TO M-260.
009870     IF S1-DC = 1 OR 2 OR 5
009880         MOVE 5 TO CHK1
009890         GO TO M-260.
009900     IF S1-DC = 0 OR 6
009910         MOVE 1 TO CHK1
009920         GO TO M-260.
009930     IF S1-SUT < ZERO
009940         MOVE 5 TO CHK1
009950       ELSE
009960         MOVE 1 TO CHK1.
009970 M-260.
009980     IF CHK1 = CHK2
009990         GO TO M-280.
010000     IF CHK1 = 1
010010         DISPLAY D-UDM
010020       ELSE
010030         DISPLAY D-HDM.
010040     DISPLAY E-ME99.
010050     MOVE CHK1 TO CHK2.
010060 M-280.
010070     MOVE S1-KOSU TO SV-KOSU.
010080     MOVE S1-TCD2 TO SV-TCD.
010090     MOVE S1-CCD TO SV-CCD2.
010100     MOVE S1-TCD TO T-KEY.
010110     READ T-M WITH UNLOCK INVALID KEY
010120         DISPLAY E-ME10 E-TCD E-ME99
010130         GO TO M-980.
010140*
010150     MOVE 0 TO W-CCC.
010160     IF S1-CCD = ZERO OR 001
010170         GO TO M-300.
010180     MOVE S1-TCD2 TO TC-TCD.
010190     MOVE S1-CCD TO TC-CCD.
010200     READ TC-M WITH UNLOCK INVALID KEY
010210         MOVE 0 TO TC-DHC.
010220     IF TC-DHC NOT = 0
010230         MOVE 1 TO W-CCC.
010240 M-300.
010250     IF JS-SIGN = 1
010260         GO TO M-320.
010270*****MOVE S1-TCD TO TT-KEY.                                       D.070126
010280*****READ TT-M INVALID KEY                                        D.070126
010290*****    DISPLAY E-ME2 E-TCD E-ME99                               D.070126
010300*****    GO TO M-980.                                             D.070126
010310 M-320.
010320*****MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P07 W-P08.     D.020603
010330     MOVE SPACE TO W-P01 W-P02 W-P03 W-P04 W-P05 W-P06            I.020603
010340                   W-P07 W-P08.                                   I.020603
010350     MOVE SPACE TO P-AZH.                                         I.051108
010360     MOVE W-30K TO P-30K.                                         I.051031
010370     MOVE W-40K TO P-40K.                                         I.051031
010380     MOVE  NC"“úiƒSƒ€Š”Ž®‰ïŽÐ" TO P-NRN.                         I.051031
010390     MOVE  NC"@§" TO P-NRUM.                                    I.051031
010400     MOVE    "700-0975" TO P-NRU.                                 I.051207
010410     MOVE  NC"@‰ªŽRŽs–k‹æ¡‚W’š–Ú‚P‚U”Ô‚P‚V†" TO P-NRJ.         I.090403
010420*****MOVE  NC"@‰ªŽRŽs¡‚W’š–Ú‚P‚U”Ô‚P‚V†" TO P-NRJ.             D.090403
010430     MOVE    "TEL (086) 243-2456" TO P-NRT.                       I.051207
010440     MOVE    "FAX (086) 242-0550" TO P-NRF.                       I.051207
010450*****MOVE    "700-0034" TO P-NRU.                                 D.051207
010460*****MOVE  NC"@‰ªŽRŽs‚–ö“Œ’¬‚P‚R”Ô‚S‚U†" TO P-NRJ.             D.051207
010470*****MOVE    "TEL (086) 252-2456" TO P-NRT.                       D.051207
010480*****MOVE    "FAX (086) 254-8595" TO P-NRF.                       D.051207
010490     MOVE S1-CSC TO P-CSC.
010500     IF S1-UNC = 0
010510         IF S1-DC = 4
010520             MOVE 0 TO P-DC
010530           ELSE
010540             MOVE S1-DC TO P-DC.
010550     IF S1-FRC NOT = 0
010560         MOVE S1-FRC TO P-FRC.
010570     MOVE W-DNO TO P-DNO.
010580     IF S1-UNC = 1                                                I.010523
010590         IF S1-KIN < 0                                            I.010523
010600             MOVE "-" TO P-NBK.                                   I.010523
010610     IF JS-SIGN = 1                                               I.010208
010620         MOVE "." TO P-SHC.                                       I.010208
010630*M-340.                                                           D.020405
010640     MOVE NC"@§" TO P-UBM.                                      I.020405
010650     IF W-CCC = 1
010660         MOVE TC-UNO TO P-UB
010670       ELSE
010680         MOVE T-UNO TO P-UB.
010690     MOVE "'" TO P-NC.
010700     MOVE S1-DATE TO W-DATE.
010710     MOVE W-NGPS TO P-DATE.
010720     IF S1-UNC = 1
010730         IF S1-KIN >= 0                                           I.010523
010740             MOVE "=======" TO P-MID21.
010750     IF S1-UNC = 0
010760         IF S1-DC = 1 OR 2 OR 5
010770             MOVE "=======" TO P-MID22
010780           ELSE
010790             IF S1-DC = 3 OR 4 OR 7
010800                 IF S1-SUT < ZERO
010810                     MOVE "=======" TO P-MID22.
010820     IF W-CCC = 1
010830         MOVE TC-JSU TO P-JUO
010840         MOVE TC-JSS TO P-JUU
010850         MOVE TC-NAME TO WN-NAME                                  I.020405
010860*****    MOVE TC-NAME TO P-TNA                                    D.020405
010870       ELSE
010880         MOVE T-JSU TO P-JUO
010890         MOVE T-JSS TO P-JUU
010900         MOVE T-NAME TO WN-NAME.                                  I.020405
010910     COPY LNAMP.                                                  I.020405
010920     MOVE WN-ONAME TO P-TNAO.                                     I.020405
010930     MOVE WN-UNAME TO P-TNAU.                                     I.020405
010940*****    MOVE T-NAME TO P-TNA.                                    D.020405
010950     IF S1-DC = 2
010960         MOVE NC"•s—Ç•Ô•i@@" TO P-AZH.
010970     IF S1-DC = 3
010980         MOVE NC"—a‚è•ÛŠÇ@@" TO P-AZH.
010990     IF S1-DC = 8
011000         MOVE NC"Á”ïÅ’²®•ª" TO P-AZH.
011010*****MOVE "‡‚ " TO P-W.                                           D.010220
011020     MOVE "(" TO P-TF.                                            I.010220
011030     MOVE T-TNC1 TO P-TNC1.                                       I.010220
011040     MOVE "-" TO P-TV.                                            I.010220
011050     MOVE T-DCC TO P-DCC.                                         I.010220
011060     MOVE ")" TO P-TR.                                            I.010220
011070*****MOVE "‡‚" TO P-W.                                            D.051108
011080     MOVE NC"@‡‚" TO P-W.                                        I.051108
011090     MOVE S1-TCD TO P-TCD.
011100     IF W-CCC = 1
011110         MOVE "-" TO P-V
011120         MOVE S1-CCD TO P-CCD.
011130     IF T-SS NOT = 20 AND 99
011140         IF T-SS > 29
011150             MOVE "**" TO P-X
011160           ELSE
011170             IF T-SS NOT = ZERO
011180                 MOVE " *" TO P-X.
011190     PERFORM MID-RTN THRU MID-EX.
011200     IF S1-DC NOT = 8
011210         GO TO M-360.
011220     ADD S1-KIN TO W-AKIN.
011230     PERFORM MEI-120 THRU MEI-EX.
011240     GO TO M-400.
011250 M-360.
011260     ADD 1 TO W-GNO.
011270     IF W-GNO = 7
011280         DISPLAY E-ME5 E-ME99
011290         GO TO M-980.
011300     IF W-GNO NOT = S1-GNO
011310         DISPLAY E-ME6 E-ME99.
011320     PERFORM MEI-RTN THRU MEI-EX.
011330 M-400.
011340     IF JS-SIGN = 1                                               I.010221
011350         GO TO M-420.                                             I.010221
011360     READ S-TRAN AT END
011370         DISPLAY E-ME7 E-ME99
011380         GO TO M-980.
011390     MOVE S-R TO WR-S1.                                           I.010208
011400     GO TO M-440.                                                 I.010208
011410 M-420.                                                           I.010208
011420     READ STRANYR AT END                                          I.010208
011430         DISPLAY E-ME7 E-ME99                                     I.010208
011440         GO TO M-980.                                             I.010208
011450     MOVE STRANYR-R TO WR-S1.                                     I.010208
011460 M-440.                                                           I.010208
011470     IF S1-DNO = W-DNO
011480         IF S1-GNO NOT = 9
011490             GO TO M-360.
011500     IF S1-DNO NOT = W-DNO
011510         DISPLAY E-ME7 E-ME99
011520         GO TO M-980.
011530     PERFORM KEI-RTN THRU KEI-EX.
011540     IF JS-SIGN = 1                                               I.010208
011550         GO TO M-230                                              I.010208
011560       ELSE                                                       I.010208
011570         GO TO M-220.
011580 M-920.
011590     IF W-DZC = 0
011600         DISPLAY E-ME11 E-ME99.
011610 M-980.
011620*****CLOSE S-TRAN.                                                D.010208
011630     CLOSE HI-M T-M TC-M.
011640     CLOSE SP-F.                                                  I.050625
011650*****IF JS-SIGN = 0                                               D.010208
011660     IF JS-SIGN = 1                                               I.010208
011670         CLOSE STRANYR                                            I.010208
011680         GO TO M-040                                              I.050625
011690       ELSE                                                       I.010208
011700         CLOSE S-TRAN.                                            I.070126
011710*****    CLOSE S-TRAN                                             D.070126
011720*****    CLOSE TT-M                                               D.070126
011730*****    CLOSE HKBM                                               D.070126
011740*****    CLOSE TUKF.                                              D.070126
011750*****    CLOSE TUKF                                               D.000825
011760*****    CLOSE HUND-F.                                            D.000825
011770*****CLOSE SP-F.                                                  D.050625
011780     DISPLAY C-CLEAR.
011790     STOP RUN.
011800 MID-RTN.
011810     MOVE SPACE TO SP-R.
011820     MOVE W-15K TO P-15K1.                                        I.020405
011830*****MOVE W-15K TO P-15K1 P-CD1 P-CD4.                            D.020405
011840*****MOVE W-20K TO P-CD3 P-CD11.                                  D.020405
011850     MOVE W-P01 TO SP-R.
011860     WRITE SP-R.
011870     MOVE SPACE TO SP-R.
011880     MOVE W-P02 TO SP-R.
011890     WRITE SP-R AFTER 2.
011900     MOVE SPACE TO SP-R.
011910     MOVE W-P03 TO SP-R.
011920     WRITE SP-R.
011930     MOVE SPACE TO SP-R.
011940     MOVE W-P04 TO SP-R.
011950     WRITE SP-R AFTER 2.                                          I.020405
011960*****WRITE SP-R.                                                  D.020405
011970     MOVE SPACE TO SP-R.
011980     MOVE W-P05 TO SP-R.
011990     WRITE SP-R.
012000     MOVE SPACE TO SP-R.
012010     MOVE W-P06 TO SP-R.                                          I.020603
012020     WRITE SP-R.                                                  I.020603
012030     MOVE SPACE TO SP-R.                                          I.020603
012040     MOVE W-P07 TO SP-R.
012050     WRITE SP-R.                                                  I.020603
012060*****WRITE SP-R AFTER 2.                                          D.020603
012070     MOVE SPACE TO SP-R.
012080     MOVE W-P08 TO SP-R.
012090     WRITE SP-R.                                                  I.020405
012100*****WRITE SP-R AFTER 2.                                          D.020405
012110     MOVE SPACE TO SP-R.
012120     WRITE SP-R AFTER 5.
012130     MOVE ZERO TO W-GNO.
012140 MID-EX.
012150     EXIT.
012160 MEI-RTN.
012170     MOVE S1-DC TO W-DC.
012180     MOVE SPACE TO W-P09 W-P10.
012190     MOVE W-15K TO P-15K2.                                        I.020405
012200     MOVE W-20K TO P-20K1.                                        I.020405
012210*****IF S1-UNC = 1                                                D.000819
012220     IF (S1-UNC = 1) OR (S1-HCD > 999899) OR (S1-DC = 3)          I.000819
012230         GO TO MEI-040.
012240     MOVE ZERO TO CNT W-ASU.
012250 MEI-020.
012260     ADD 1 TO CNT.
012270     IF CNT = 11
012280         GO TO MEI-040.
012290     MOVE S1-SU(CNT) TO W-SU(CNT).
012300     IF W-SU(CNT) NOT = ZERO
012310         MOVE W-SU(CNT) TO P-SU(CNT).
012320     GO TO MEI-020.
012330 MEI-040.
012340     IF S1-HCD NOT = ZERO
012350         MOVE S1-HCD TO P-HCD
012360         IF S1-UNC = 0
012370             MOVE S1-SIZ TO P-SIZ.
012380     MOVE S1-SUT TO W-SUT.
012390     IF S1-HCD = ZERO
012400         GO TO MEI-100.
012410     IF S1-DC = 3 OR 4 OR 7
012420         IF W-SUT < ZERO
012430             COMPUTE W-SUT = W-SUT * -1.
012440     MOVE W-SUT TO P-SUT.
012450     IF S1-DC NOT = 4
012460         GO TO MEI-060.
012470     IF S1-SUT < ZERO
012480         MOVE NC"—a‚è‚Ö–ß‚µ" TO P-AZM
012490       ELSE
012500         MOVE NC"—a‚èo‰×@" TO P-AZM.
012510     GO TO MEI-080.
012520 MEI-060.
012530     IF S1-DC = 9
012540         MOVE NC"—a‚èU‘Ö@"    TO P-AZM
012550         GO TO MEI-080.
012560     MOVE S1-T TO P-T.
012570     MOVE S1-KIN TO W-KIN.
012580*****IF S1-DC = 3                                                 D.010523
012590     IF (S1-DC = 3) OR (S1-UNC = 1)                               I.010523
012600         IF W-KIN < ZERO
012610             COMPUTE W-KIN = W-KIN * -1.
012620     MOVE W-KIN TO P-KIN.
012630 MEI-080.
012640     MOVE S1-HCD TO HI-KEY.
012650     READ HI-M WITH UNLOCK INVALID KEY
012660         DISPLAY E-ME3 E-HCD E-ME99
012670         MOVE SPACE TO HI-NAME.
012680*****IF S1-TCD = 0459 OR 0460                                     D.010419
012690*****IF S1-TCD = 0458 OR 0459 OR 0460                             D.010709
012700     IF S1-TCD = 0013 OR 0458 OR 0459 OR 0460                     I.010709
012710         MOVE HI-NAME TO W-NAME                                   I.000821
012720         MOVE SPACE TO W-NA(24)                                   I.000821
012730         MOVE W-NAME TO P-HNA                                     I.000821
012740       ELSE                                                       I.000821
012750         MOVE HI-NAME TO P-HNA.
012760     IF S1-UNC = 0
012770         IF S1-BIK NOT = SPACE
012780             MOVE "[" TO P-F
012790             MOVE S1-BIK TO P-BIK
012800             MOVE "]" TO P-R.
012810 MEI-100.
012820     MOVE SPACE TO SP-R.
012830     MOVE W-P09 TO SP-R.
012840     WRITE SP-R.
012850     MOVE SPACE TO SP-R.
012860     MOVE W-P10 TO SP-R.
012870     WRITE SP-R.
012880     IF S1-HCD <  999900
012890         ADD W-SUT TO W-ASUT.
012900     IF S1-DC NOT = 4 AND 9
012910         ADD S1-KIN TO W-AKIN.
012920*****IF S1-UNC = 0                                                D.071003
012930*****    IF S1-DC NOT = 4                                         D.071003
012940*****        IF JS-SIGN = 0                                       D.071003
012950*****            COMPUTE W-UG = W-UG + (S1-SUT * S1-FT).          D.072103
012960 MEI-120.
012970     IF JS-SIGN = 1
012980         GO TO MEI-EX.
012990     MOVE 1 TO S1-DHC.
013000     MOVE WR-S1 TO S-R.                                           I.010208
013010*****REWRITE S-R1.                                                D.010208
013020     REWRITE S-R.                                                 I.010208
013030     IF ERR-STAT NOT = "00"
013040         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
013050         DISPLAY E-CL.
013060 MEI-EX.
013070     EXIT.
013080 KEI-RTN.
013090*****MOVE SPACE TO W-P12 W-P14 W-P15.                             D.070126
013100*****MOVE SPACE TO W-P12 W-P14.                                   D.140111
013110     MOVE SPACE TO W-P12 W-P13 W-P14.                             I.140111
013120     MOVE W-20K TO P-20K2.                                        I.020405
013130     MOVE ALL NC"@" TO P-BI P-HNM P-CNAM P-KOSU P-KO.
013140*****MOVE W-15K TO P-CD1 P-CD4.                                   D.020405
013150*****MOVE W-20K TO P-CD3 P-CD11.                                  D.020405
013160 KEI-020.
013170     IF SV-KOSU NOT = ZERO
013180        MOVE SV-KOSU TO   W-KOSU
013190        MOVE W-KOSU  TO   P-KOSU
013200        MOVE NC"ŒÂŒû" TO  P-KO.
013210     IF SV-CCD2 NOT = ZERO AND 001
013220         IF W-CCC = 0
013230             PERFORM TNA-RTN THRU TNA-EX.
013240     MOVE S2-BI TO P-BI.
013250*****IF S2-HN1 = ZERO                                             D.081224
013260     IF S2-HNO = ZERO                                             I.081224
013270         GO TO KEI-040.
013280*****MOVE NC"¦”­‘—–¾×‘‡‚"   TO P-HNM.                          D.020405
013290     MOVE NC"@¦”­‘—–¾×‘‡‚" TO P-HNM.                          I.020405
013300     MOVE S2-HNO TO P-HNO.                                        I.081224
013310*****IF S2-HN1 NOT = ZERO                                         D.081224
013320*****    MOVE S2-HN1 TO P-HN1.                                    D.081224
013330*****IF S2-HN2 NOT = ZERO                                         D.081224
013340*****    MOVE "," TO P-C2                                         D.081224
013350*****    MOVE S2-HN2 TO P-HN2.                                    D.081224
013360*****IF S2-HN3 NOT = ZERO                                         D.081224
013370*****    MOVE "," TO P-C3                                         D.081224
013380*****    MOVE S2-HN3 TO P-HN3.                                    D.081224
013390*****IF S2-HN4 NOT = ZERO                                         D.081224
013400*****    MOVE "," TO P-C4                                         D.081224
013410*****    MOVE S2-HN4 TO P-HN4.                                    D.081224
013420*****IF S2-HN5 NOT = ZERO                                         D.081224
013430*****    MOVE "," TO P-C5                                         D.081224
013440*****    MOVE S2-HN5 TO P-HN5.                                    D.081224
013450*****IF S2-HN6 NOT = ZERO                                         D.081224
013460*****    MOVE "," TO P-C6                                         D.081224
013470*****    MOVE S2-HN6 TO P-HN6.                                    D.081224
013480 KEI-040.
013490     IF W-GNO = ZERO
013500         MOVE W-AKIN TO W-SHZ W-KINZ
013510         MOVE ZERO TO W-AKIN W-KIN
013520         GO TO KEI-060.
013530     MOVE W-ASUT TO P-ASUT.
013540     MOVE W-AKIN TO W-KIN.
013550*****IF W-NGS < 1404                                              D.140328
013560*****    IF W-HSC = 0                                             D.140328
013570*****        COMPUTE W-SHZ ROUNDED = W-KIN * 0.05.                D.140328
013580*****IF W-NGS < 1404                                              D.140328
013590*****    IF W-HSC = 3                                             D.140328
013600*****        COMPUTE W-SHZ ROUNDED = W-KIN * 0.03.                D.140328
013610*****IF W-NGS NOT < 1404                                          D.140328
013620     IF W-HSC = 8                                                 I.140110
013630         COMPUTE W-SHZ ROUNDED = W-KIN * 0.08                     I.140110
013640       ELSE                                                       I.140110
013650         IF W-HSC = 5                                             I.140110
013660             COMPUTE W-SHZ ROUNDED = W-KIN * 0.05                 I.140110
013670           ELSE                                                   I.140110
013680             IF W-HSC = 3                                         I.140110
013690                 COMPUTE W-SHZ ROUNDED = W-KIN * 0.03             I.140110
013700               ELSE                                               I.140110
013710                 IF W-HSC = 1                                     I.140110
013720                     COMPUTE W-SHZ ROUNDED = W-KIN * 0.10.        I.140110
013730     MOVE W-SHZ TO W-KINZ.
013740*****IF W-DC = 3                                                  D.010523
013750     IF (W-DC = 3) OR (S2-UNC = 1)                                I.010523
013760         IF W-KIN < ZERO
013770             COMPUTE W-KIN = W-KIN * -1
013780             COMPUTE W-KINZ = W-KINZ * -1.
013790 KEI-060.
013800     MOVE W-KIN TO P-AKIN.
013810*****IF W-NGS < 1404                                              D.140328
013820*****    IF W-KINZ NOT = ZERO                                     D.140328
013830*****        IF W-HSC = 0                                         D.140328
013840*****            MOVE "(5%)" TO P-ZR                              D.140328
013850*****          ELSE                                               D.140328
013860*****            IF W-HSC = 3                                     D.140328
013870*****                MOVE "(3%)" TO P-ZR.                         D.140328
013880*****IF W-NGS NOT < 1404                                          D.140328
013890     IF W-KINZ NOT = ZERO                                         I.140110
013900         IF W-HSC = 8                                             I.140110
013910             MOVE "(8%)" TO P-ZR                                  I.140110
013920           ELSE                                                   I.140110
013930             IF W-HSC = 5                                         I.140110
013940                 MOVE "(5%)" TO P-ZR                              I.140110
013950               ELSE                                               I.140110
013960                 IF W-HSC = 3                                     I.140110
013970                     MOVE "(3%)" TO P-ZR                          I.140110
013980                   ELSE                                           I.140110
013990                     IF W-HSC = 1                                 I.140110
014000                         MOVE "(10%)" TO P-ZR.                    I.140110
014010     MOVE W-KINZ TO P-SHZ.
014020     COMPUTE W-TKIN = W-KIN + W-KINZ.
014030     MOVE W-TKIN TO P-TKIN.
014040     IF JS-SIGN = 0
014050         IF W-DC = 1 OR 2 OR 5
014060             COMPUTE W-AKIN = W-AKIN * -1
014070             COMPUTE W-SHZ = W-SHZ * -1.                          I.071003
014080*****        COMPUTE W-SHZ = W-SHZ * -1                           D.071003
014090*****        COMPUTE W-UG = W-UG * -1.                            D.071003
014100*****IF JS-SIGN NOT = 0                                           D.070126
014110*****    MOVE S2-UZ TO P-UZ                                       D.070126
014120*****    MOVE S2-SHZZ TO P-SHZZ                                   D.070126
014130*****    GO TO KEI-080.                                           D.070126
014140*****IF S2-UNC = 0                                                D.070126
014150*****    COMPUTE W-KIN = TT-TUZ + W-AKIN                          D.070126
014160*****    COMPUTE W-KINZ = TT-TUZZ + W-SHZ                         D.070126
014170*****  ELSE                                                       D.070126
014180*****    COMPUTE W-KIN = TT-TUZ - W-AKIN                          D.070126
014190*****    COMPUTE W-KINZ = TT-TUZZ - W-SHZ.                        D.070126
014200*****MOVE W-KIN TO P-UZ.                                          D.070126
014210*****MOVE W-KINZ TO P-SHZZ.                                       D.070126
014220*KEI-080.                                                         D.070126
014230     ADD 1 TO W-GNO.
014240*
014250     MOVE SPACE TO SP-R.
014260     MOVE W-P11 TO SP-R.
014270     WRITE SP-R AFTER W-AL(W-GNO).
014280     MOVE SPACE TO SP-R.
014290     MOVE W-P12  TO SP-R.
014300     WRITE SP-R AFTER 1.
014310     MOVE SPACE TO SP-R.
014320     MOVE W-P13 TO SP-R.
014330     WRITE SP-R AFTER 1.
014340     MOVE SPACE TO SP-R.
014350     MOVE W-20K TO P-20K2.                                        I.070126
014360     MOVE W-P14 TO SP-R.
014370     WRITE SP-R AFTER 1.
014380     MOVE SPACE TO SP-R.
014390*****MOVE W-20K TO P-20K2.                                        D.070126
014400*****MOVE W-P15 TO SP-R.                                          D.070126
014410*****WRITE SP-R AFTER 3.                                          D.070126
014420     MOVE SPACE TO SP-R.
014430     WRITE SP-R AFTER PAGE.
014440     IF JS-SIGN = 1
014450         GO TO KEI-EX.
014460*****MOVE W-KIN TO TT-TUZ.                                        D.070126
014470*****MOVE W-KINZ TO TT-TUZZ.                                      D.070126
014480*****IF S2-UNC = 0                                                D.070126
014490*****    ADD W-AKIN TO TT-TUA                                     D.070126
014500*****    ADD W-SHZ TO TT-TUAZ                                     D.070126
014510*****    ADD W-UG TO TT-TUG                                       D.070126
014520*****  ELSE                                                       D.070126
014530*****    ADD W-AKIN TO TT-TNB                                     D.070126
014540*****    ADD W-SHZ TO TT-TNBZ.                                    D.070126
014550*****IF S2-UNC = 0                                                D.001123
014560*****    IF W-CSC = 0                                             D.001123
014570*****        ADD W-AKIN TO TT-SUA                                 D.001123
014580*****        ADD W-SHZ TO TT-SUAZ                                 D.001123
014590*****      ELSE                                                   D.001123
014600*****        ADD W-AKIN TO TT-STS                                 D.001123
014610*****        ADD W-SHZ TO TT-STSZ.                                D.001123
014620*****IF S2-UNC NOT = 0                                            D.001123
014630*****    IF W-CSC = 0                                             D.001123
014640*****        SUBTRACT W-AKIN FROM TT-SUA                          D.001123
014650*****        SUBTRACT W-SHZ FROM TT-SUAZ                          D.001123
014660*****      ELSE                                                   D.001123
014670*****        SUBTRACT W-AKIN FROM TT-STS                          D.001123
014680*****        SUBTRACT W-SHZ FROM TT-STSZ.                         D.001123
014690*****REWRITE TT-R INVALID KEY                                     D.070126
014700*****    DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      D.070126
014710*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
014720*KEI-100.                                                         D.000825
014730*****MOVE ZERO TO HUND-R.                                         D.000825
014740*****MOVE W-DATE TO UN-DATE.                                      D.000825
014750*****MOVE W-DNO TO UN-NO.                                         D.000825
014760*****MOVE T-KEY TO UN-TCD.                                        D.000825
014770*****MOVE W-SHZ TO UN-SHZ.                                        D.000825
014780*****MOVE W-AKIN TO UN-KIN.                                       D.000825
014790*****MOVE W-CSC TO UN-CSC.                                        D.000825
014800*****MOVE S2-UNC TO UN-UNC.                                       D.000825
014810*****WRITE HUND-R.                                                D.000825
014820*****IF ERR-STAT = "00"                                           D.000825
014830*****    CALL "CBLTCLS" USING HUND-F                              D.000825
014840*****    GO TO KEI-120.                                           D.000825
014850*****DISPLAY E-STAT E-ME26 E-ME99.                                D.000825
014860*****IF ERR-STAT NOT = "34"                                       D.000825
014870*****    DISPLAY E-ME78 E-ME99                                    D.000825
014880*****    GO TO KEI-120.                                           D.000825
014890*****DISPLAY E-CL.                                                D.000825
014900*****CLOSE HUND-F.                                                D.000825
014910*****MOVE "HUNDF        " TO W-FILE.                              D.000825
014920*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000825
014930*****DISPLAY E-CL.                                                D.000825
014940*****OPEN EXTEND HUND-F.                                          D.000825
014950*****GO TO KEI-100.                                               D.000825
014960 KEI-120.
014970*****MOVE W-KINZ TO S2-SHZZ.                                      D.070126
014980*****MOVE W-KIN TO S2-UZ.                                         D.070126
014990     MOVE W-SHZ TO S2-TAX.
015000     MOVE 1 TO S2-DHC.
015010     MOVE WR-S2 TO S-R.                                           I.010208
015020*****REWRITE S-R2.                                                D.010208
015030     REWRITE S-R.                                                 I.010208
015040     IF ERR-STAT NOT = "00"
015050         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
015060         DISPLAY E-CL.
015070*
015080*****MOVE SPACE TO HKB-KEY.                                       D.070126
015090*****MOVE "05" TO HKB-NO.                                         D.070126
015100*****READ HKBM INVALID KEY                                        D.070126
015110*****    DISPLAY E-ME78 E-ME1 E-ME99                              D.070126
015120*****    GO TO KEI-140.                                           D.070126
015130*****MOVE HKB-DAI TO W-DAI.                                       D.070126
015140*****GO TO KEI-160.                                               D.070126
015150*KEI-140.                                                         D.070126
015160*****INITIALIZE HKB-R.                                            D.070126
015170*****MOVE SPACE TO HKB-KEY.                                       D.070126
015180*****MOVE "05" TO HKB-NO.                                         D.070126
015190*****WRITE HKB-R INVALID KEY                                      D.070126
015200*****    DISPLAY E-ME78 E-STAT E-ME27 E-ME99                      D.070126
015210*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
015220*****INITIALIZE W-DAI.                                            D.070126
015230*KEI-160.                                                         D.070126
015240*****COPY LDAIP.                                                  D.070126
015250*****IF W-DAI1 = "999"                                            D.070126
015260*****    DISPLAY E-ME78 E-ME50 E-ME99                             D.070126
015270*****    DISPLAY E-CL.                                            D.070126
015280*****MOVE W-DAI TO HKB-DAI.                                       D.070126
015290*****REWRITE HKB-R INVALID KEY                                    D.070126
015300*****    DISPLAY E-ME78 E-STAT E-ME23 E-ME99                      D.070126
015310*****    PERFORM ERR-RTN THRU ERR-EX.                             D.070126
015320*KEI-180.                                                         D.070126
015330*****INITIALIZE TUK-R.                                            D.070126
015340*****MOVE T-KEY TO TUK-TCD.                                       D.030912
015350*****MOVE T-KEY TO TUK-TCD TUK-TCD2.                              D.070126
015360*****MOVE W-DAI TO TUK-DAI.                                       D.070126
015370*****MOVE W-DATE TO TUK-DATE.                                     D.070126
015380*****IF S2-UNC = 0                                                D.070126
015390*****    MOVE 1 TO TUK-DC                                         D.070126
015400*****  ELSE                                                       D.070126
015410*****    MOVE 2 TO TUK-DC.                                        D.070126
015420*****MOVE W-AKIN TO TUK-KIN.                                      D.070126
015430*****MOVE W-SHZ TO TUK-SHZ.                                       D.070126
015440*****MOVE W-DNO TO TUK-DNO.                                       D.070126
015450*****MOVE 0 TO TUK-GNO.                                           D.070126
015460*****MOVE T-TNC TO TUK-TNC.                                       D.070126
015470*****MOVE T-DCC TO TUK-DCC.                                       D.070126
015480*****MOVE T-DNO TO TUK-DCN.                                       D.010220
015490*****MOVE 0 TO TUK-BMC.                                           D.070126
015500*****WRITE TUK-R INVALID KEY                                      D.070126
015510*****    DISPLAY E-STAT E-ME28 E-ME99                             D.070126
015520*****    GO TO KEI-200.                                           D.070126
015530*****GO TO KEI-EX.                                                D.070126
015540*KEI-200.                                                         D.070126
015550*****IF ERR-STAT NOT = "24"                                       D.070126
015560*****    DISPLAY E-ME78 E-ME99                                    D.070126
015570*****    GO TO KEI-EX.                                            D.070126
015580*****DISPLAY E-CL.                                                D.070126
015590*****CLOSE TUKF.                                                  D.070126
015600*****MOVE "TUKF         " TO W-FILE.                              D.070126
015610*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.070126
015620*****DISPLAY E-CL.                                                D.070126
015630*****OPEN I-O TUKF.                                               D.070126
015640*****GO TO KEI-180.                                               D.070126
015650 KEI-EX.
015660     EXIT.
015670 TNA-RTN.
015680     MOVE SV-TCD TO TC-TCD.
015690     MOVE SV-CCD2 TO TC-CCD.
015700     READ TC-M UNLOCK INVALID KEY
015710         MOVE SPACE TO TC-NAME.
015720     MOVE TC-NAME TO P-CNAM.
015730     MOVE P-CNAM TO TBL-NAM.
015740     MOVE 26 TO N.                                                I.020405
015750*****MOVE 24 TO N.                                                D.020405
015760 TNA-020.
015770     IF N = 0
015780         GO TO TNA-EX.
015790     IF T-NAM(N) NOT = SPACE AND NC"@"
015800         GO TO TNA-040.
015810     COMPUTE N = N - 1.
015820     GO TO TNA-020.
015830 TNA-040.
015840*****IF W-DC = 1 OR 2 OR 5                                        D.050614
015850     IF W-DC = 1 OR 2                                             I.050614
015860         ADD 1 TO N
015870         MOVE NC"—l" TO T-NAM(N)
015880         ADD 1 TO N
015890         MOVE NC"‚æ" TO T-NAM(N)
015900         ADD 1 TO N
015910         MOVE NC"‚è" TO T-NAM(N)
015920         ADD 1 TO N
015930         MOVE NC"•Ô" TO T-NAM(N)
015940         ADD 1 TO N
015950         MOVE NC"•i" TO T-NAM(N)
015960         MOVE TBL-NAM TO P-CNAM
015970         GO TO TNA-EX.
015980     ADD 1 TO N.
015990     MOVE NC"—l" TO T-NAM(N).
016000     ADD 1 TO N.
016010     MOVE NC"@" TO T-NAM(N).
016020     ADD 1 TO N.
016030     MOVE NC"’¼" TO T-NAM(N).
016040     ADD 1 TO N.
016050     MOVE NC"‘—" TO T-NAM(N).
016060     MOVE TBL-NAM TO P-CNAM.
016070 TNA-EX.
016080     EXIT.
016090 CHK-RTN.
016100*****MOVE 0 TO W-DCHK.                                            D.120327
016110     MOVE ZERO TO W-DNOD W-DCHK.                                  I.120327
016120     OPEN INPUT S-TRAN.
016130*CHK-010.                                                         D.120327
016140     READ S-TRAN AT END
016150         GO TO CHK-900.
016160     MOVE S-R TO WR-S1.                                           I.050928
016170 CHK-020.                                                         I.120327
016180     IF W-DCHK = 0                                                I.120327
016190         MOVE 1 TO W-DCHK.                                        I.120327
016200     MOVE S1-DNO TO W-DNOD.                                       I.120327
016210     MOVE S1-DHC TO W-DHC.                                        I.120327
016220 CHK-040.                                                         I.120327
016230     READ S-TRAN AT END                                           I.120327
016240         GO TO CHK-900.                                           I.120327
016250     MOVE S-R TO WR-S1.                                           I.120327
016260     IF S1-DNO = W-DNOD                                           I.120327
016270         IF S1-DHC = W-DHC                                        I.120327
016280             GO TO CHK-040                                        I.120327
016290           ELSE                                                   I.120327
016300             MOVE 3 TO W-DCHK                                     I.120327
016310             GO TO CHK-900.                                       I.120327
016320     IF S1-DHC = W-DHC                                            I.120327
016330         GO TO CHK-020.                                           I.120327
016340     IF W-DHC = 0                                                 I.120327
016350         IF S1-DHC = 1                                            I.120327
016360             MOVE 3 TO W-DCHK                                     I.120327
016370             GO TO CHK-900.                                       I.120327
016380     IF W-DHC = 1                                                 I.120327
016390         IF S1-DHC = 0                                            I.120327
016400             MOVE 2 TO W-DCHK.                                    I.120327
016410     GO TO CHK-020.                                               I.120327
016420*****IF W-DCHK = 1                                                D.120327
016430*****    IF S1-DHC = 1                                            D.120327
016440*****        MOVE 3 TO W-DCHK                                     D.120327
016450******       GO TO CHK-900                                        D.120327
016460*****      ELSE                                                   D.120327
016470*****        GO TO CHK-010.                                       D.120327
016480*****IF W-DCHK = 2                                                D.120327
016490*****    IF S1-DHC NOT = 1                                        D.120327
016500*****        MOVE 3 TO W-DCHK                                     D.120327
016510*****        GO TO CHK-900                                        D.120327
016520*****      ELSE                                                   D.120327
016530*****        GO TO CHK-010.                                       D.120327
016540*****IF S1-DHC NOT = 1                                            D.120327
016550******   MOVE 1 TO W-DCHK.                                        D.120327
016560*****    MOVE 1 TO W-DCHK                                         D.120327
016570*****  ELSE                                                       D.120327
016580*****    MOVE 2 TO W-DCHK.                                        D.120327
016590*****GO TO CHK-010.                                               D.120327
016600 CHK-900.
016610     CLOSE S-TRAN.
016620 CHK-EX.
016630     EXIT.
016640 ERR-RTN.
016650     DISPLAY E-ME99
016660     GO TO ERR-RTN.
016670 ERR-EX.
016680     EXIT.
