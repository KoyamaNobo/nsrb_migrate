000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HKG910.
000030*********************************************************
000040*    PROGRAM         :  全体累積ファイル　クリア        *
000050*    PRINTER TYPE    :  *****                           *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  62/05/29                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.                                                 I.980406
000170*****SELECT T-FM ASSIGN TO T-MSD.                                 D.000324
000180*****SELECT YG-F ASSIGN TO YG-MSD.
000190*****SELECT NKR-F ASSIGN TO NKR-MSD.                              D.000324
000200     SELECT NYUR-F ASSIGN TO NYUR-MSD.
000210*****SELECT STT-F ASSIGN TO STT-MSD.                              D.001127
000220     SELECT TT-M ASSIGN TO TT-MSD                                 I.000324
000230         ORGANIZATION INDEXED                                     I.000324
000240         ACCESS MODE DYNAMIC                                      I.000324
000250         RECORD KEY TT-KEY                                        I.000324
000260         FILE STATUS IS ERR-STAT.                                 I.000324
000270     SELECT HKBM ASSIGN TO HKB-MSD                                I.000324
000280         ORGANIZATION IS INDEXED                                  I.000324
000290         ACCESS MODE IS RANDOM                                    I.000324
000300         RECORD KEY IS HKB-KEY                                    I.000324
000310         FILE STATUS IS ERR-STAT.                                 I.000324
000320*****SELECT TUKF ASSIGN TO TUK-MSD                                D.030916
000330     SELECT TUKF ASSIGN TO TUK1-MSD TUK2-MSD                      I.030916
000340         ORGANIZATION INDEXED                                     I.000324
000350         ACCESS MODE DYNAMIC                                      I.000324
000360         RECORD KEY TUK-KEY                                       I.000324
000370         ALTERNATE RECORD KEY TUK-KEY2                            I.030916
000380         FILE STATUS IS ERR-STAT.                                 I.000324
000390     SELECT TUKOF ASSIGN TO TUKO-MSD                              I.010922
000400         ORGANIZATION INDEXED                                     I.010922
000410         RECORD KEY TUKO-KEY                                      I.010922
000420         ACCESS MODE DYNAMIC                                      I.010922
000430         FILE STATUS IS ERR-STAT.                                 I.010922
000440     SELECT KKB-M ASSIGN TO KKB-MSD                               I.000324
000450         ORGANIZATION INDEXED                                     I.000324
000460         ACCESS MODE IS RANDOM                                    I.000324
000470         RECORD KEY KKB-KEY                                       I.000324
000480         FILE STATUS IS ERR-STAT.                                 I.000324
000490     SELECT T-M ASSIGN TO T1-MSD  T2-MSD                          I.000725
000500         ORGANIZATION INDEXED                                     I.000725
000510         ACCESS MODE RANDOM                                       I.000725
000520         RECORD KEY T-KEY                                         I.000725
000530         ALTERNATE RECORD KEY T-KEY2                              I.000725
000540         FILE STATUS IS ERR-STAT.                                 I.000725
000550     SELECT TSKF ASSIGN TO TSK-MSD                                I.001017
000560         ORGANIZATION INDEXED                                     I.001017
000570         ACCESS MODE IS DYNAMIC                                   I.001017
000580         RECORD KEY TSK-KEY                                       I.001017
000590         FILE STATUS IS ERR-STAT.                                 I.001017
000600     SELECT SKDF ASSIGN TO SKD-MSD                                I.001017
000610         ORGANIZATION INDEXED                                     I.001017
000620         ACCESS MODE IS DYNAMIC                                   I.001017
000630         RECORD KEY SKD-KEY                                       I.001017
000640         FILE STATUS IS ERR-STAT.                                 I.001017
000650     SELECT TUKOYR ASSIGN TO TUKOY-MSD                            I.110830
000660         FILE STATUS IS ERR-STAT.                                 I.110830
000670     SELECT TSKFYR ASSIGN TO TSKYR-MSD                            I.121018
000680         FILE STATUS IS ERR-STAT.                                 I.121018
000690     SELECT SKDFYR ASSIGN TO SKDYR-MSD                            I.121018
000700         FILE STATUS IS ERR-STAT.                                 I.121018
000710*****SELECT TMS-F ASSIGN TO TMS-MSD.                              D.000324
000720 I-O-CONTROL.                                                     I.980406
000730     APPLY SHARED-MODE ON HKBM                                    I.000324
000740     APPLY SHARED-MODE ON TUKF                                    I.000324
000750     APPLY SHARED-MODE ON TUKOF                                   I.010922
000760     APPLY SHARED-MODE ON KKB-M                                   I.000324
000770     APPLY SHARED-MODE ON T-M                                     I.000725
000780     APPLY SHARED-MODE ON M-DATE.                                 I.980406
000790 DATA DIVISION.
000800 FILE SECTION.
000810     COPY LIBFDD.                                                 I.980406
000820     COPY LSNYUR.
000830     COPY LITTM.                                                  I.000324
000840     COPY LIHKBM.                                                 I.000324
000850     COPY LITUKF.                                                 I.000324
000860     COPY LIKKBM.                                                 I.000324
000870     COPY LITM.                                                   I.000725
000880     COPY LITSKF.                                                 I.001017
000890     COPY LISKDF.                                                 I.001017
000900 FD  TUKOF                                                        I.010922
000910     BLOCK  4 RECORDS                                             I.010922
000920     LABEL RECORD IS STANDARD                                     I.010922
000930     VALUE OF IDENTIFICATION "TUKOF".                             I.010922
000940 01  TUKO-R.                                                      I.010922
000950     02  TUKO-KEY.                                                I.010922
000960       03  TUKO-TCD     PIC  9(004).                              I.010922
000970       03  TUKO-DAI     PIC  X(010).                              I.010922
000980     02  F              PIC  X(004).                              I.030916
000990     02  TUKO-DATE      PIC  9(008).                              I.010922
001000     02  F              PIC  X(038).                              I.030916
001010 FD  TUKOYR                                                       I.110830
001020     BLOCK  4 RECORDS                                             I.110830
001030     LABEL RECORD IS STANDARD                                     I.110830
001040     VALUE OF IDENTIFICATION "TUKOYR".                            I.110830
001050 01  TUKOY-R.                                                     I.110830
001060     02  TUKOY-KEY.                                               I.110830
001070       03  TUKOY-TCD    PIC  9(004).                              I.110830
001080       03  TUKOY-DAI    PIC  X(010).                              I.110830
001090     02  F              PIC  X(004).                              I.110830
001100     02  TUKOY-DATE     PIC  9(008).                              I.110830
001110     02  F              PIC  X(038).                              I.110830
001120 FD  TSKFYR                                                       I.121018
001130     BLOCK  1 RECORDS                                             I.121018
001140     LABEL RECORD IS STANDARD                                     I.121018
001150     VALUE OF IDENTIFICATION "TSKFYR".                            I.121018
001160 01  TSKY-R.                                                      I.121018
001170     02  F              PIC  X(250).                              I.121018
001180     02  TSKY-NG        PIC  9(006).                              I.121018
001190 FD  SKDFYR                                                       I.121018
001200     BLOCK  4 RECORDS                                             I.121018
001210     LABEL RECORD IS STANDARD                                     I.121018
001220     VALUE OF IDENTIFICATION "SKDFYR".                            I.121018
001230 01  SKDY-R.                                                      I.121018
001240     02  F              PIC  X(180).                              I.121018
001250     02  SKDY-NG        PIC  9(006).                              I.121018
001260     02  F              PIC  X(006).                              I.121018
001270*****02  F              PIC  X(042).                              D.030916
001280*FD  STT-F                                                        D.001127
001290*****BLOCK  4 RECORDS                                             D.001127
001300*****LABEL RECORD IS STANDARD                                     D.001127
001310*****VALUE OF IDENTIFICATION "STTF".                              D.001127
001320*01  STT-R              PIC  X(192).                              D.001127
001330*FD  T-FM                                                         D.000324
001340*****BLOCK  3 RECORDS                                             D.000324
001350*****LABEL RECORD IS STANDARD                                     D.000324
001360*****VALUE OF IDENTIFICATION "ATMF".                              D.000324
001370*01  T-R.                                                         D.000324
001380*****02  T-TCD          PIC  X(004).                              D.000324
001390*****02  F              PIC  X(166).                              D.000324
001400*FD  YG-F
001410*****BLOCK 16 RECORDS
001420*****LABEL RECORD IS STANDARD
001430*****VALUE OF IDENTIFICATION "YGF".                               C 62/05
001440*01  YG-R         PIC X(16).
001450*FD  NKR-F                                                        D.000324
001460*****BLOCK  8 RECORDS                                             D.000324
001470*****LABEL RECORD IS STANDARD                                     D.000324
001480*****VALUE OF IDENTIFICATION "NKRF".                              D.000324
001490*01  NK-R               PIC  X(032).                              D.000324
001500*FD  TMS-F                                                        D.000324
001510*****BLOCK  6 RECORDS                                             D.970717
001520*****BLOCK  5 RECORDS                                             D.000324
001530*****LABEL RECORD IS STANDARD                                     D.000324
001540*****VALUE OF IDENTIFICATION "TMSF".                              D.000324
001550*01  TMS-R              PIC  X(051).                              D.000324
001560*01  TMS-R              PIC  X(042).                              D.970717
001570 WORKING-STORAGE SECTION.
001580*01  W-DMM              PIC  9(001).                              D.000324
001590 01  ERR-STAT           PIC  X(002).
001600 01  W-FILE             PIC  X(013).                              I.000324
001610 01  W-DATA.                                                      I.000324
001620     02  W-NGPD.                                                  I.000324
001630       03  W-NGD        PIC  9(006).                              I.000324
001640       03  W-NGDD  REDEFINES W-NGD.                               I.000324
001650         04  W-NEND     PIC  9(004).                              I.000324
001660         04  W-NENDL REDEFINES W-NEND.                            I.000324
001670           05  W-NEND1  PIC  9(002).                              I.000324
001680           05  W-NEND2  PIC  9(002).                              I.000324
001690         04  W-GETD     PIC  9(002).                              I.000324
001700       03  W-NGDL  REDEFINES W-NGD.                               I.000324
001710         04  F          PIC  9(002).                              I.000324
001720         04  W-NGDS     PIC  9(004).                              I.000324
001730       03  W-PEYD       PIC  9(002).                              I.000324
001740     02  W-NGP.                                                   I.000324
001750       03  W-NEN        PIC  9(004).                              I.000324
001760       03  W-GET        PIC  9(002).                              I.000324
001770       03  W-PEY        PIC  9(002).                              I.000324
001780     02  W-DTW1         PIC  9(003).                              I.001017
001790     02  W-DTW2         PIC  9(001).                              I.001017
001800     02  W-SDTD         PIC  9(008).                              I.001017
001810     02  W-SDTM  REDEFINES W-SDTD.                                I.001017
001820       03  W-SDTN       PIC  9(004).                              I.001017
001830       03  W-SDTG       PIC  9(002).                              I.001017
001840       03  W-SDTP       PIC  9(002).                              I.001017
001850     COPY LDAIW.                                                  I.000324
001860*****COPY LSTAT.                                                  D.000324
001870 SCREEN SECTION.
001880 SD  C-CRT
001890     END STATUS IS ESTAT.
001900 01  C-CLEAR.
001910     02  C-CL    LINE   1  CLEAR SCREEN.
001920 01  C-MID.
001930     02  LINE   3  COLUMN  10  PIC  N(022) VALUE                  I.000324
001940          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       I.000324
001950     02  LINE   4  COLUMN  10  PIC  N(022) VALUE                  I.000324
001960          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       I.000324
001970     02  LINE   5  COLUMN  10  PIC  N(022) VALUE                  I.000324
001980          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".       I.000324
001990     02  LINE   6  COLUMN  10  PIC  N(022) VALUE                  I.000324
002000          NC"＊＊＊　　履物・工品　更新・クリア　　＊＊＊".       I.000324
002010     02  LINE   7  COLUMN  10  PIC  N(022) VALUE                  I.000324
002020          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".       I.000324
002030     02  LINE   8  COLUMN  10  PIC  N(022) VALUE                  I.000324
002040          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       I.000324
002050     02  LINE   9  COLUMN  10  PIC  N(022) VALUE                  I.000324
002060          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       I.000324
002070*****02  LINE   3  COLUMN  10  PIC  N(021) VALUE                  D.000324
002080*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         D.000324
002090*****02  LINE   4  COLUMN  10  PIC  N(021) VALUE                  D.000324
002100*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         D.000324
002110*****02  LINE   5  COLUMN  10  PIC  N(021) VALUE                  D.000324
002120*****     NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".         D.000324
002130*****02  LINE   6  COLUMN  10  PIC  N(021) VALUE                  D.000324
002140*****     NC"＊＊＊　　履物，工品集計　クリア　　＊＊＊".         D.000324
002150*****02  LINE   7  COLUMN  10  PIC  N(021) VALUE                  D.000324
002160*****     NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".         D.000324
002170*****02  LINE   8  COLUMN  10  PIC  N(021) VALUE                  D.000324
002180*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         D.000324
002190*****02  LINE   9  COLUMN  10  PIC  N(021) VALUE                  D.000324
002200*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".         D.000324
002210*****02  LINE  20  COLUMN  16  PIC  X(027) VALUE                  D.000324
002220*****     "<  確認 OK=1 NO=9   ﾘﾀｰﾝ  >".                          D.000324
002230*01  C-ACP.                                                       D.000324
002240*****02  A-DMM   LINE  20  COLUMN  35  PIC  9(001)                D.000324
002250*****     USING W-DMM   CHECK OVERFLOW NO IFC.                    D.000324
002260 01  C-ERR.
002270     02  LINE  24.
002280*****  03  E-ME1   COLUMN  15  PIC  N(013) VALUE                  D.000324
002290*****       NC"＊＊　クリア　しない　＊＊".                       D.000324
002300       03  E-ME2   COLUMN  15  PIC  X(018) VALUE                  I.980406
002310            "***  DATEM ﾅｼ  ***".                                 I.980406
002320       03  E-ME3   COLUMN  15  PIC  X(027) VALUE                  I.980406
002330            "***  DATEM REWRITE ｴﾗｰ  ***".                        I.980406
002340       03  E-ME5   COLUMN  15  PIC  X(028) VALUE                  I.000324
002350            "***   TUKOF DELETE ｴﾗｰ   ***".                       I.010922
002360       03  E-ME6   COLUMN  15  PIC  X(027) VALUE                  I.010922
002370            "***   TUKOF WRITE ｴﾗｰ   ***".                        I.010922
002380       03  E-ME7   COLUMN  15  PIC  X(027) VALUE                  I.010922
002390            "***   TUKF DELETE ｴﾗｰ   ***".                        I.000324
002400       03  E-ME8   COLUMN  15  PIC  X(017) VALUE                  I.000324
002410            "***  KKBM ﾅｼ  ***".                                  I.000324
002420       03  E-ME9   COLUMN  15  PIC  X(026) VALUE                  I.000324
002430            "***  KKBM REWRITE ｴﾗｰ  ***".                         I.000324
002440       03  E-ME11  COLUMN  15  PIC  X(026) VALUE                  I.000324
002450            "***  TT-M REWRITE ｴﾗ-  ***".                         I.000324
002460       03  E-ME12  COLUMN  15  PIC  X(028) VALUE                  I.001017
002470            "***   TSKF REWRITE ｴﾗｰ   ***".                       I.001017
002480       03  E-ME13  COLUMN  15  PIC  X(027) VALUE                  I.001017
002490            "***   TSKF DELETE ｴﾗｰ   ***".                        I.001017
002500       03  E-ME14  COLUMN  15  PIC  X(026) VALUE                  I.001017
002510            "***   SKDF WRITE ｴﾗｰ   ***".                         I.001017
002520       03  E-ME15  COLUMN  15  PIC  X(027) VALUE                  I.001030
002530            "***   SKDF DELETE ｴﾗｰ   ***".                        I.001030
002540       03  E-ME21  COLUMN  15  PIC  X(017) VALUE                  I.000324
002550            "***  HKBM ﾅｼ  ***".                                  I.000324
002560       03  E-ME22  COLUMN  15  PIC  X(026) VALUE                  I.000324
002570            "***  HKBM REWRITE ｴﾗｰ  ***".                         I.000324
002580       03  E-ME23  COLUMN  15  PIC  X(024) VALUE                  I.000324
002590            "***  HKBM WRITE ｴﾗｰ  ***".                           I.000324
002600       03  E-ME28  COLUMN  15  PIC  X(026) VALUE                  I.000324
002610            "***   TUKF WRITE ｴﾗｰ   ***".                         I.000324
002620       03  E-ME29  COLUMN  15  PIC  X(028) VALUE                  I.110830
002630            "***   TUKOYR WRITE ｴﾗｰ   ***".                       I.110830
002640       03  E-ME30  COLUMN  15  PIC  X(028) VALUE                  I.121018
002650            "***   SKDFYR WRITE ｴﾗｰ   ***".                       I.121018
002660       03  E-ME31  COLUMN  15  PIC  X(028) VALUE                  I.121018
002670            "***   TSKFYR WRITE ｴﾗｰ   ***".                       I.121018
002680       03  E-ME50  COLUMN  15  PIC  X(026) VALUE                  I.000324
002690            "***   ﾀﾞｲﾁｮｳNO ｵｰﾊﾞｰ   ***".                         I.000324
002700       03  E-TTM   COLUMN  50  PIC  X(004) FROM  TT-KEY.          I.000324
002710       03  E-TUK   COLUMN  50  PIC  X(014) FROM  TUK-KEY.         I.000324
002720       03  E-TUKO  COLUMN  50  PIC  X(014) FROM  TUKO-KEY.        I.010922
002730       03  E-TSK   COLUMN  50  PIC  X(004) FROM  TSK-KEY.         I.001017
002740       03  E-SKD   COLUMN  50  PIC  X(020) FROM  SKD-KEY.         I.001030
002750     COPY LSSEM.                                                  I.000324
002760     COPY LIBSCR.                                                 I.000324
002770*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.000324
002780*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.000324
002790*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.000324
002800 PROCEDURE DIVISION.
002810 M-05.
002820     DISPLAY C-CLEAR.
002830     DISPLAY C-MID.
002840*
002850     COPY LIBCPR.                                                 I.000324
002860     MOVE ZERO TO W-NGPD.                                         I.000324
002870     MOVE D-NHNG TO W-NGDS.                                       I.000324
002880     IF W-NEND2 >= DATE-NF1 AND <= DATE-NT1                       I.000324
002890         ADD DATE-NC1 TO W-NEND.                                  I.000324
002900     IF W-NEND2 >= DATE-NF2 AND <= DATE-NT2                       I.000324
002910         ADD DATE-NC2 TO W-NEND.                                  I.000324
002920     MOVE 1 TO W-PEYD.                                            I.000324
002930*
002940     PERFORM DEL-RTN THRU DEL-EX.                                 I.000324
002950     IF COMPLETION-CODE = 255                                     I.000324
002960         GO TO M-95.                                              I.000324
002970*
002980     MOVE W-NGPD TO W-NGP.                                        I.000405
002990     ADD 1 TO W-GET.                                              I.000405
003000     IF W-GET = 13                                                I.000405
003010         ADD 1 TO W-NEN                                           I.000405
003020         MOVE 1 TO W-GET.                                         I.000405
003030     OPEN I-O TT-M.                                               I.000324
003040     OPEN I-O TUKF.                                               I.000324
003050     OPEN INPUT T-M.                                              I.000725
003060 M-10.
003070     READ TT-M NEXT RECORD AT END                                 I.000324
003080         GO TO M-15.                                              I.000324
003090     MOVE TT-TUZ TO TT-TZZ.                                       I.000324
003100     MOVE TT-TUZZ TO TT-TZZZ.                                     I.000324
003110     MOVE ZERO TO TT-TUA TT-TUAZ TT-TNB TT-TNBZ                   I.000324
003120                  TT-TNK TT-TNKZ TT-TUG.                          I.000324
003130*****MOVE ZERO TO TT-SP TT-SK.                                    D.001127
003140     REWRITE TT-R INVALID KEY                                     I.000324
003150         MOVE 255 TO COMPLETION-CODE                              I.000324
003160         DISPLAY E-ME78 E-STAT E-ME11 E-TTM E-ME99                I.000324
003170         GO TO M-15.                                              I.000324
003180     IF ZERO = TT-TZZ AND TT-TZZZ                                 I.000324
003190         GO TO M-10.                                              I.000324
003200     PERFORM HKB-RTN THRU HKB-EX.                                 I.000324
003210     IF COMPLETION-CODE = 255                                     I.000324
003220         GO TO M-15.                                              I.000324
003230     PERFORM TUK-RTN THRU TUK-EX.                                 I.000324
003240     IF COMPLETION-CODE = 255                                     I.000324
003250         GO TO M-15.                                              I.000324
003260     GO TO M-10.                                                  I.000324
003270*****ACCEPT A-DMM.                                                D.000324
003280*****IF ESTAT NOT = HTB AND SKP                                   D.000324
003290*****    GO TO M-10.                                              D.000324
003300*****IF W-DMM = 9                                                 D.000324
003310*****    DISPLAY E-ME1 E-ME99                                     D.000324
003320*****    DISPLAY C-CLEAR                                          D.000324
003330*****    STOP RUN.                                                D.000324
003340*****IF W-DMM NOT = 1                                             D.000324
003350*****    GO TO M-10.                                              D.000324
003360*****OPEN OUTPUT NKR-F.                                           D.000324
003370*****OPEN OUTPUT YG-F.
003380*****OPEN OUTPUT T-FM.                                            D.000324
003390 M-15.                                                            I.000324
003400*****CLOSE T-M.                                                   D.001017
003410     CLOSE TT-M.                                                  I.000324
003420     CLOSE TUKF.                                                  I.000324
003430     IF COMPLETION-CODE = 255                                     I.000324
003440         GO TO M-95.                                              I.000324
003450*
003460     MOVE ZERO TO W-PEY.                                          I.001017
003470     OPEN I-O TSKF.                                               I.001017
003480     OPEN I-O SKDF.                                               I.001017
003490     OPEN EXTEND TSKFYR.                                          I.121018
003500 M-20.                                                            I.001017
003510     READ TSKF NEXT RECORD AT END                                 I.001017
003520         GO TO M-40.                                              I.001017
003530 M-25.                                                            I.121018
003540     INITIALIZE TSKY-R.                                           I.121018
003550     MOVE TSK-R TO TSKY-R.                                        I.121018
003560     MOVE W-NGD TO TSKY-NG.                                       I.121018
003570     WRITE TSKY-R.                                                I.121018
003580     IF ERR-STAT = "00"                                           I.121018
003590         GO TO M-30.                                              I.121018
003600     DISPLAY E-STAT E-TSK E-ME31 E-ME99.                          I.121018
003610     IF ERR-STAT NOT = "34"                                       I.121018
003620         MOVE 255 TO COMPLETION-CODE                              I.121018
003630         DISPLAY E-ME78 E-ME99                                    I.121018
003640         CLOSE T-M                                                I.121018
003650         CLOSE TSKF                                               I.121018
003660         CLOSE SKDF                                               I.121018
003670         GO TO M-95.                                              I.121018
003680     DISPLAY E-CL.                                                I.121018
003690     CLOSE TSKFYR.                                                I.121018
003700     MOVE "TSKFYR       " TO W-FILE.                              I.121018
003710     DISPLAY E-ME71 E-ME98 STOP " ".                              I.121018
003720     DISPLAY E-CL.                                                I.121018
003730     OPEN EXTEND TSKFYR.                                          I.121018
003740     GO TO M-25.                                                  I.121018
003750 M-30.                                                            I.121018
003760     IF TSK-ZNGP(4) NOT = ZERO                                    I.110712
003770         IF TSK-ZNGP(5) = ZERO                                    I.001017
003780             MOVE TSK-ZSD(2) TO TSK-ZSD(1)                        I.001017
003790             MOVE TSK-ZSD(3) TO TSK-ZSD(2)                        I.001017
003800             MOVE TSK-ZSD(4) TO TSK-ZSD(3)                        I.001017
003810           ELSE                                                   I.001017
003820             MOVE TSK-ZSD(3) TO TSK-ZSD(1)                        I.001017
003830             MOVE TSK-ZSD(4) TO TSK-ZSD(2)                        I.001017
003840             MOVE TSK-ZSD(5) TO TSK-ZSD(3).                       I.001017
003850     IF TSK-ZNGP(4) = ZERO                                        I.160622
003860         MOVE TSK-ZSD(2) TO TSK-ZSD(1)                            I.160622
003870         MOVE TSK-ZSD(3) TO TSK-ZSD(2)                            I.160622
003880         MOVE ZERO TO TSK-ZSD(3).                                 I.160622
003890     MOVE ZERO TO TSK-ZSD(4) TSK-ZSD(5).                          I.001017
003900     IF ZERO = TSK-ZSD(1) AND TSK-ZSD(2) AND TSK-ZSD(3)           I.001017
003910         GO TO M-35.                                              I.001017
003920     MOVE TSK-TCD TO T-KEY.                                       I.010321
003930     READ T-M WITH UNLOCK INVALID KEY                             I.010321
003940         MOVE ZERO TO T-SS T-DCC.                                 I.010321
003950     MOVE T-TNC TO TSK-TNC.                                       I.010321
003960     MOVE T-DCC TO TSK-DCC.                                       I.010321
003970     PERFORM TSR-RTN THRU TSR-EX.                                 I.001017
003980     IF COMPLETION-CODE = 255                                     I.001017
003990         GO TO M-95.                                              I.001017
004000*****IF TSK-ZSD(3) = ZERO                                         D.001023
004010     IF ZERO = TSK-HTS(3) AND TSK-SZS(3)                          I.001023
004020         GO TO M-20.                                              I.001017
004030*
004040     PERFORM SKD-RTN THRU SKD-EX.                                 I.001017
004050     IF COMPLETION-CODE = 255                                     I.001017
004060         GO TO M-95.                                              I.001017
004070     GO TO M-20.                                                  I.001017
004080 M-35.                                                            I.001017
004090     PERFORM TSD-RTN THRU TSD-EX.                                 I.001017
004100     IF COMPLETION-CODE = 255                                     I.001017
004110         GO TO M-95.                                              I.001017
004120     GO TO M-20.                                                  I.001017
004130 M-40.                                                            I.001017
004140     CLOSE T-M.                                                   I.001017
004150     CLOSE TSKF.                                                  I.001017
004160     CLOSE SKDF.                                                  I.001017
004170     CLOSE TSKFYR.                                                I.121018
004180*
004190     OPEN OUTPUT NYUR-F.                                          I.001127
004200     CLOSE NYUR-F.                                                I.001128
004210*****OPEN OUTPUT NYUR-F STT-F.                                    D.001127
004220*****CLOSE NYUR-F STT-F.                                          D.001128
004230*****OPEN OUTPUT NYUR-F.                                          D.000407
004240*****OPEN OUTPUT TMS-F.                                           D.000324
004250*****CLOSE NKR-F.                                                 D.000324
004260*****CLOSE YG-F.
004270*****CLOSE T-FM.                                                  D.000324
004280*****CLOSE NYUR-F.                                                D.000407
004290*****CLOSE TMS-F.                                                 D.000324
004300*
004310     OPEN I-O M-DATE.                                             I.980406
004320     MOVE "01" TO DATE-KEY.                                       I.980406
004330     READ M-DATE INVALID KEY                                      I.980406
004340         CLOSE M-DATE                                             I.980406
004350         DISPLAY E-ME2 E-ME99                                     I.980406
004360         GO TO M-95.                                              I.980406
004370     MOVE W-NGDS TO D-ENG.                                        I.000324
004380     ADD 1 TO W-GETD.                                             I.000324
004390     IF W-GETD = 13                                               I.000324
004400         MOVE 1 TO W-GETD                                         I.000324
004410         ADD 1 TO W-NEND.                                         I.000324
004420     MOVE W-NGDS TO D-NHNG D-NKNG D-NANG.                         I.000324
004430     MOVE ZERO TO D-HSD D-HND D-KUD D-KKD D-KSD D-KRD.            I.030626
004440     MOVE 0 TO DATE-HFC.                                          I.020208
004450*****ADD 1 TO D-NAG.                                              D.000324
004460*****IF D-NAG = 13                                                D.000324
004470*****    ADD 1 TO D-NAN                                           D.000324
004480*****    MOVE 1 TO D-NAG.                                         D.000324
004490     REWRITE DATE-R INVALID KEY                                   I.980406
004500         DISPLAY E-STAT E-ME3 E-ME99.                             I.980406
004510     CLOSE M-DATE.                                                I.980406
004520*
004530     OPEN I-O KKB-M.                                              I.000324
004540     MOVE SPACE TO KKB-KEY.                                       I.000324
004550     MOVE 90 TO KKB-NO.                                           I.000324
004560     READ KKB-M INVALID KEY                                       I.000324
004570         DISPLAY E-ME78 E-ME8 E-ME99                              I.000324
004580         CLOSE KKB-M                                              I.000324
004590         GO TO M-95.                                              I.000324
004600     MOVE 0 TO KKB-SC15.                                          I.000324
004610     REWRITE KKB-R INVALID KEY                                    I.000324
004620         DISPLAY E-ME78 E-STAT E-ME9 E-ME99.                      I.000324
004630     CLOSE KKB-M.                                                 I.000324
004640 M-95.                                                            I.980406
004650     DISPLAY C-CLEAR.
004660     STOP RUN.
004670 DEL-RTN.                                                         I.000324
004680     MOVE W-NGPD TO W-NGP.                                        I.000324
004690*****SUBTRACT 1 FROM W-GET.                                       D.000725
004700*****IF W-GET = ZERO                                              D.000725
004710*****    MOVE 12 TO W-GET                                         D.000725
004720*****    SUBTRACT 1 FROM W-NEN.                                   D.000725
004730*****SUBTRACT 1 FROM W-GET.                                       D.000725
004740*****IF W-GET = ZERO                                              D.000725
004750*****    MOVE 12 TO W-GET                                         D.000725
004760     SUBTRACT 1 FROM W-NEN.                                       I.000324
004770     MOVE 99 TO W-PEY.                                            I.000324
004780*
004790*****OPEN I-O TUKF.                                               D.010922
004800     OPEN I-O TUKOF.                                              I.010922
004810 DEL-010.                                                         I.000324
004820*****READ TUKF NEXT RECORD AT END                                 D.010922
004830     READ TUKOF NEXT RECORD AT END                                I.010922
004840         GO TO DEL-020.                                           I.000324
004850*****IF TUK-DATE > W-NGP                                          D.010922
004860     IF TUKO-DATE > W-NGP                                         I.010922
004870         GO TO DEL-010.                                           I.000324
004880*****DELETE TUKF INVALID KEY                                      D.010922
004890     DELETE TUKOF INVALID KEY                                     I.010922
004900         MOVE 255 TO COMPLETION-CODE                              I.000324
004910*****    DISPLAY E-ME78 E-STAT E-ME5 E-TUK E-ME99                 D.010922
004920         DISPLAY E-ME78 E-STAT E-ME5 E-TUKO E-ME99                I.010922
004930         GO TO DEL-020.                                           I.000324
004940     GO TO DEL-010.                                               I.000324
004950 DEL-020.                                                         I.000324
004960*****CLOSE TUKF.                                                  D.010922
004970     IF COMPLETION-CODE = 255                                     I.001030
004980         CLOSE TUKOF                                              I.010922
004990         GO TO DEL-EX.                                            I.001030
005000*
005010     MOVE W-NGPD TO W-NGP.                                        I.010922
005020     SUBTRACT 1 FROM W-GET.                                       I.010922
005030     IF W-GET = ZERO                                              I.010922
005040         MOVE 12 TO W-GET                                         I.010922
005050         SUBTRACT 1 FROM W-NEN.                                   I.010922
005060     SUBTRACT 1 FROM W-GET.                                       I.010922
005070     IF W-GET = ZERO                                              I.010922
005080         MOVE 12 TO W-GET                                         I.010922
005090         SUBTRACT 1 FROM W-NEN.                                   I.010922
005100     OPEN I-O TUKF.                                               I.010922
005110     OPEN EXTEND TUKOYR.                                          I.110830
005120 DEL-110.                                                         I.010922
005130     READ TUKF NEXT RECORD AT END                                 I.010922
005140         GO TO DEL-140.                                           I.010922
005150     IF TUK-DATE > W-NGP                                          I.010922
005160         GO TO DEL-110.                                           I.010922
005170*
005180     INITIALIZE TUKO-R.                                           I.010922
005190     MOVE TUK-R TO TUKO-R.                                        I.010922
005200     WRITE TUKO-R INVALID KEY                                     I.010922
005210         MOVE 255 TO COMPLETION-CODE                              I.010922
005220         DISPLAY E-ME78 E-STAT E-ME6 E-TUK E-ME99                 I.010922
005230         GO TO DEL-140.                                           I.010922
005240 DEL-120.                                                         I.110830
005250     INITIALIZE TUKOY-R.                                          I.110830
005260     MOVE TUK-R TO TUKOY-R.                                       I.110830
005270     WRITE TUKOY-R.                                               I.110830
005280     IF ERR-STAT = "00"                                           I.110830
005290         GO TO DEL-130.                                           I.110830
005300     DISPLAY E-STAT E-TUK E-ME29 E-ME99.                          I.110830
005310     IF ERR-STAT NOT = "34"                                       I.110830
005320         MOVE 255 TO COMPLETION-CODE                              I.110830
005330         DISPLAY E-ME78 E-ME99                                    I.110830
005340         GO TO DEL-140.                                           I.110830
005350     DISPLAY E-CL.                                                I.110830
005360     CLOSE TUKOYR.                                                I.110830
005370     MOVE "TUKOYR       " TO W-FILE.                              I.110830
005380     DISPLAY E-ME71 E-ME98 STOP " ".                              I.110830
005390     DISPLAY E-CL.                                                I.110830
005400     OPEN EXTEND TUKOYR.                                          I.110830
005410     GO TO DEL-120.                                               I.110830
005420 DEL-130.                                                         I.110830
005430     DELETE TUKF INVALID KEY                                      I.010922
005440         MOVE 255 TO COMPLETION-CODE                              I.010922
005450         DISPLAY E-ME78 E-STAT E-ME7 E-TUK E-ME99                 I.010922
005460         GO TO DEL-140.                                           I.010922
005470     GO TO DEL-110.                                               I.010922
005480 DEL-140.                                                         I.010922
005490     CLOSE TUKF.                                                  I.010922
005500     CLOSE TUKOF.                                                 I.010922
005510     CLOSE TUKOYR.                                                I.110830
005520     IF COMPLETION-CODE = 255                                     I.010922
005530         GO TO DEL-EX.                                            I.010922
005540*
005550     MOVE W-NGPD TO W-NGP.                                        I.001030
005560     SUBTRACT 1 FROM W-GET.                                       I.001030
005570     IF W-GET = ZERO                                              I.001030
005580         MOVE 12 TO W-GET                                         I.001030
005590         SUBTRACT 1 FROM W-NEN.                                   I.001030
005600     SUBTRACT 1 FROM W-GET.                                       I.001030
005610     IF W-GET = ZERO                                              I.001030
005620         MOVE 12 TO W-GET                                         I.001030
005630         SUBTRACT 1 FROM W-NEN.                                   I.001030
005640     SUBTRACT 1 FROM W-GET.                                       I.001030
005650     IF W-GET = ZERO                                              I.001030
005660         MOVE 12 TO W-GET                                         I.001030
005670         SUBTRACT 1 FROM W-NEN.                                   I.001030
005680     SUBTRACT 1 FROM W-GET.                                       I.001030
005690     IF W-GET = ZERO                                              I.001030
005700         MOVE 12 TO W-GET                                         I.001030
005710         SUBTRACT 1 FROM W-NEN.                                   I.001030
005720     MOVE 99 TO W-PEY.                                            I.001030
005730*
005740     OPEN I-O SKDF.                                               I.001030
005750     OPEN EXTEND SKDFYR.                                          I.121018
005760 DEL-210.                                                         I.001030
005770     READ SKDF NEXT RECORD AT END                                 I.001030
005780         GO TO DEL-260.                                           I.001030
005790     IF SKD-NGP > W-NGP                                           I.001030
005800*****    IF SKD-SNO = ZERO                                        I.051001
005810*****        IF SKD-SKD NOT = 99999999                            D.051001
005820*****            IF SKD-SKD NOT = 00000000                        D.051001
005830         GO TO DEL-210.                                           I.001030
005840 DEL-220.                                                         I.121018
005850     INITIALIZE SKDY-R.                                           I.121018
005860     MOVE SKD-R TO SKDY-R.                                        I.121018
005870     MOVE W-NGD TO SKDY-NG.                                       I.121018
005880     WRITE SKDY-R.                                                I.121018
005890     IF ERR-STAT = "00"                                           I.121018
005900         GO TO DEL-240.                                           I.121018
005910     DISPLAY E-STAT E-SKD E-ME30 E-ME99.                          I.121018
005920     IF ERR-STAT NOT = "34"                                       I.121018
005930         MOVE 255 TO COMPLETION-CODE                              I.121018
005940         DISPLAY E-ME78 E-ME99                                    I.121018
005950         GO TO DEL-140.                                           I.121018
005960     DISPLAY E-CL.                                                I.121018
005970     CLOSE SKDFYR.                                                I.121018
005980     MOVE "SKDFYR       " TO W-FILE.                              I.121018
005990     DISPLAY E-ME71 E-ME98 STOP " ".                              I.121018
006000     DISPLAY E-CL.                                                I.121018
006010     OPEN EXTEND SKDFYR.                                          I.121018
006020     GO TO DEL-220.                                               I.121018
006030 DEL-240.                                                         I.121018
006040     DELETE SKDF INVALID KEY                                      I.001030
006050         MOVE 255 TO COMPLETION-CODE                              I.001030
006060         DISPLAY E-ME78 E-STAT E-ME15 E-SKD E-ME99                I.001030
006070         GO TO DEL-260.                                           I.001030
006080     GO TO DEL-210.                                               I.001030
006090 DEL-260.                                                         I.001030
006100     CLOSE SKDF.                                                  I.001030
006110     CLOSE SKDFYR.                                                I.121018
006120 DEL-EX.                                                          I.000324
006130     EXIT.                                                        I.000324
006140 HKB-RTN.                                                         I.000324
006150     OPEN I-O HKBM.                                               I.000324
006160     MOVE SPACE TO HKB-KEY.                                       I.000324
006170     MOVE "05" TO HKB-NO.                                         I.000324
006180     READ HKBM INVALID KEY                                        I.000324
006190         DISPLAY E-ME21 E-ME99                                    I.000324
006200         GO TO HKB-010.                                           I.000324
006210     MOVE HKB-DAI TO W-DAI.                                       I.000324
006220     GO TO HKB-EX.                                                I.000324
006230 HKB-010.                                                         I.000324
006240     INITIALIZE HKB-R.                                            I.000324
006250     MOVE SPACE TO HKB-KEY.                                       I.000324
006260     MOVE "05" TO HKB-NO.                                         I.000324
006270     WRITE HKB-R INVALID KEY                                      I.000324
006280         DISPLAY E-ME78 E-STAT E-ME23 E-ME99                      I.000324
006290         MOVE 255 TO COMPLETION-CODE.                             I.000324
006300     INITIALIZE W-DAI.                                            I.000324
006310 HKB-EX.                                                          I.000324
006320     EXIT.                                                        I.000324
006330 TUK-RTN.                                                         I.000324
006340     COPY LDAIP.                                                  I.000324
006350     IF W-DAI1 = "999"                                            I.000324
006360         DISPLAY E-ME78 E-ME50 E-ME99                             I.000324
006370         DISPLAY E-CL.                                            I.000324
006380     MOVE W-DAI TO HKB-DAI.                                       I.000324
006390     REWRITE HKB-R INVALID KEY                                    I.000324
006400         CLOSE HKBM                                               I.000324
006410         MOVE 255 TO COMPLETION-CODE                              I.000324
006420         DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      I.000324
006430         GO TO TUK-EX.                                            I.000324
006440     CLOSE HKBM.                                                  I.000324
006450 TUK-010.                                                         I.000324
006460     INITIALIZE TUK-R.                                            I.000324
006470*****MOVE TT-KEY TO TUK-TCD.                                      D.030917
006480     MOVE TT-KEY TO TUK-TCD TUK-TCD2.                             1.030917
006490     MOVE W-DAI TO TUK-DAI.                                       I.000324
006500     MOVE W-NGP TO TUK-DATE.                                      I.000324
006510     MOVE 0 TO TUK-DC.                                            I.000324
006520     MOVE TT-TZZ TO TUK-KIN.                                      I.000324
006530     MOVE TT-TZZZ TO TUK-SHZ.                                     I.000324
006540     MOVE TUK-TCD TO T-KEY.                                       I.000725
006550     READ T-M WITH UNLOCK INVALID KEY                             I.000725
006560         MOVE ZERO TO T-TNC T-DCC.                                I.000725
006570*****    MOVE ZERO TO T-TNC T-DNO.                                D.010221
006580     MOVE T-TNC TO TUK-TNC.                                       I.000725
006590     MOVE T-DCC TO TUK-DCC.                                       I.010221
006600*****MOVE T-DNO TO TUK-DCN.                                       D.010221
006610     MOVE TT-BC TO TUK-BMC.                                       I.000324
006620     WRITE TUK-R INVALID KEY                                      I.000324
006630         DISPLAY E-STAT E-ME28 E-ME99                             I.000324
006640         GO TO TUK-020.                                           I.000324
006650     GO TO TUK-EX.                                                I.000324
006660 TUK-020.                                                         I.000324
006670     IF ERR-STAT NOT = "24"                                       I.000324
006680         MOVE 255 TO COMPLETION-CODE                              I.000324
006690         DISPLAY E-ME78 E-ME99                                    I.000324
006700         GO TO TUK-EX.                                            I.000324
006710     DISPLAY E-CL.                                                I.000324
006720     CLOSE TUKF.                                                  I.000324
006730     MOVE "TUKF         " TO W-FILE.                              I.000324
006740     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000324
006750     DISPLAY E-CL.                                                I.000324
006760     OPEN I-O TUKF.                                               I.000324
006770     GO TO TUK-010.                                               I.000324
006780 TUK-EX.                                                          I.000324
006790     EXIT.                                                        I.000324
006800 TSD-RTN.                                                         I.001017
006810     DELETE TSKF INVALID KEY                                      I.001017
006820         MOVE 255 TO COMPLETION-CODE                              I.001017
006830         DISPLAY E-ME78 E-STAT E-ME13 E-TSK E-ME99.               I.001017
006840 TSD-EX.                                                          I.001017
006850     EXIT.                                                        I.001017
006860 TSR-RTN.                                                         I.001017
006870     REWRITE TSK-R INVALID KEY                                    I.001017
006880         MOVE 255 TO COMPLETION-CODE                              I.001017
006890         DISPLAY E-ME78 E-STAT E-ME12 E-TSK E-ME99.               I.001017
006900 TSR-EX.                                                          I.001017
006910     EXIT.                                                        I.001017
006920 SKD-RTN.                                                         I.001017
006930*****MOVE TSK-TCD TO T-KEY.                                       D.010321
006940*****READ T-M WITH UNLOCK INVALID KEY                             D.010321
006950*****    MOVE ZERO TO T-SS.                                       D.010321
006960*
006970     MOVE ZERO TO W-SDTD.                                         I.001017
006980     IF T-SS = ZERO OR 99                                         I.001017
006990         GO TO SKD-010.                                           I.001017
007000     MOVE W-NGP TO W-SDTD.                                        I.001017
007010     MOVE T-SS TO W-SDTP.                                         I.001017
007020     IF W-SDTP = 30 OR 31                                         I.001017
007030         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12            I.001017
007040             MOVE 31 TO W-SDTP                                    I.001017
007050           ELSE                                                   I.001017
007060             IF W-SDTG = 4 OR 6 OR 9 OR 11                        I.001017
007070                 MOVE 30 TO W-SDTP                                I.001017
007080               ELSE                                               I.001017
007090                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1               I.001017
007100                                           REMAINDER W-DTW2       I.001017
007110                 IF W-DTW2 = 0                                    I.001017
007120                     MOVE 29 TO W-SDTP                            I.001017
007130                   ELSE                                           I.001017
007140                     MOVE 28 TO W-SDTP.                           I.001017
007150 SKD-010.                                                         I.001017
007160     MOVE ZERO TO SKD-R.                                          I.001017
007170     MOVE SPACE TO SKD-BI.                                        I.001017
007180     MOVE TSK-TCD TO SKD-TCD.                                     I.001017
007190     MOVE W-NGP TO SKD-DATE.                                      I.001017
007200     MOVE 5 TO SKD-DTC.                                           I.001017
007210     MOVE TSK-HTS(3) TO SKD-KIN.                                  I.001017
007220     MOVE TSK-SZS(3) TO SKD-SHZ.                                  I.001017
007230     MOVE W-SDTD TO SKD-SKD.                                      I.001017
007240     MOVE TSK-TNC TO SKD-TNC.                                     I.001017
007250     MOVE TSK-DCC TO SKD-DCC.                                     I.010221
007260*****MOVE TSK-DCN TO SKD-DCN.                                     D.010221
007270     MOVE TSK-BMC TO SKD-BMC.                                     I.001017
007280     WRITE SKD-R INVALID KEY                                      I.001017
007290         DISPLAY E-STAT E-ME14 E-ME99                             I.001017
007300         GO TO SKD-020.                                           I.001017
007310     GO TO SKD-EX.                                                I.001017
007320 SKD-020.                                                         I.001017
007330     IF ERR-STAT NOT = "24"                                       I.001017
007340         MOVE 255 TO COMPLETION-CODE                              I.001017
007350         DISPLAY E-ME78 E-ME99                                    I.001017
007360         GO TO SKD-EX.                                            I.001017
007370     DISPLAY E-CL.                                                I.001017
007380     CLOSE SKDF.                                                  I.001017
007390     MOVE "SKDF         " TO W-FILE.                              I.001017
007400     DISPLAY E-ME71 E-ME98 STOP " ".                              I.001017
007410     DISPLAY E-CL.                                                I.001017
007420     OPEN I-O SKDF.                                               I.001017
007430     GO TO SKD-010.                                               I.001017
007440 SKD-EX.                                                          I.001017
007450     EXIT.                                                        I.001017
