000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMT830.
000030*********************************************************
000040*    PROGRAM         : 　得意先品名別出荷集計ワーク作成 *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT SNTR-F ASSIGN TO SNTR-MSD.
000170     SELECT SSR-F ASSIGN TO SSR-MSD.
000180 I-O-CONTROL.
000190     APPLY SHARED-MODE ON M-DATE.
000200 DATA DIVISION.
000210 FILE SECTION.
000220     COPY LIBFDD.
000230 FD  SNTR-F
000240     BLOCK  2 RECORDS
000250     LABEL RECORD IS STANDARD
000260     VALUE OF IDENTIFICATION IS "SNTRF".
000270 01  SNTR-R.
000280     02  SNTR-DNO       PIC  9(006).
000290     02  SNTR-GNO       PIC  9(001).
000300     02  SNTR-DATE.
000310       03  SNTR-NG      PIC  9(006).
000320       03  SNTR-PEY     PIC  9(002).
000330     02  SNTR-TCD       PIC  9(004).
000340     02  SNTR-HCD       PIC  9(006).
000350     02  F              PIC  X(031).
000360     02  SNTR-SU        PIC S9(005).
000370     02  SNTR-BT        PIC S9(005).
000380     02  SNTR-UKIN      PIC S9(008).
000390     02  F              PIC  X(001).
000400     02  SNTR-DC        PIC  9(001).
000410     02  SNTR-FT        PIC  9(005).
000420     02  F              PIC  X(003).
000430     02  SNTR-BC.
000440       03  SNTR-BC1     PIC  9(002).
000450       03  SNTR-BC2     PIC  9(002).
000460       03  SNTR-BC3     PIC  9(002).
000470     02  SNTR-BCD   REDEFINES SNTR-BC.
000480       03  SNTR-BCD1    PIC  9(003).
000490       03  F            PIC  9(003).
000500     02  F              PIC  X(001).
000510     02  SNTR-TNC       PIC  9(002).
000520     02  SNTR-FKC       PIC  9(002).
000530     02  F              PIC  X(027).
000540     02  SNTR-BMC       PIC  9(002).
000550     02  SNTR-BMNO      PIC  9(001).
000560     02  F              PIC  X(002).
000570     02  SNTR-SNC       PIC  9(001).
000580 FD  SSR-F
000590     BLOCK  4 RECORDS
000600     LABEL RECORD IS STANDARD
000610     VALUE OF IDENTIFICATION IS WK0064ID.
000620 01  SSR-R.
000630     02  SSR-TCD        PIC  9(004).
000640     02  SSR-HCD        PIC  9(006).
000650     02  SSR-SU         PIC S9(007).
000660     02  SSR-UKIN       PIC S9(010).
000670     02  SSR-GKIN       PIC S9(010).
000680     02  SSR-TKC        PIC  9(002).
000690     02  SSR-TNC        PIC  9(002).
000700     02  SSR-BC.
000710       03  SSR-BC1      PIC  9(002).
000720       03  SSR-BC2      PIC  9(002).
000730       03  SSR-BC3      PIC  9(002).
000740     02  SSR-BMC        PIC  9(002).
000750     02  SSR-BMNO       PIC  9(001).
000760     02  SSR-FKC        PIC  9(002).
000770     02  SSR-NG         PIC  9(006).
000780     02  F              PIC  X(006).
000790 WORKING-STORAGE SECTION.
000800 77  JS-SIGN            PIC  9(001).
000810 77  W-FILE             PIC  X(013).
000820 77  WK0064ID           PIC  X(009) VALUE SPACE.
000830 01  STN-NO.
000840     02  STN-NO1        PIC  X(003).
000850     02  STN-NO2        PIC  X(003).
000860 01  W-FID.
000870     02  W-FID1         PIC  X(006) VALUE "WK0064".
000880     02  W-FID2         PIC  X(003).
000890 01  W-DATA.
000900     02  W-DATE         PIC  9(008).
000910     02  W-NGP   REDEFINES W-DATE.
000920       03  W-NG.
000930         04  W-NEN      PIC  9(004).
000940         04  W-NENL  REDEFINES W-NEN.
000950           05  W-NEN1   PIC  9(002).
000960           05  W-NEN2   PIC  9(002).
000970         04  W-GET      PIC  9(002).
000980       03  W-NGL   REDEFINES W-NG.
000990         04  F          PIC  9(002).
001000         04  W-NGS      PIC  9(004).
001010       03  W-PEY        PIC  9(002).
001020     02  W-NGPL  REDEFINES W-DATE.
001030       03  F            PIC  9(002).
001040       03  W-NGPS       PIC  9(006).
001050     02  W-RD.
001060       03  W-SU         PIC S9(005).
001070       03  W-UKIN       PIC S9(008).
001080       03  W-GKIN       PIC S9(008).
001090     02  W-KIN          PIC S9(009).
001100 01  ERR-STAT           PIC  X(002).
001110 SCREEN SECTION.
001120 SD  C-CRT
001130     END STATUS IS ESTAT.
001140 01  C-CLEAR.
001150     02  C-CL    LINE   1  CLEAR SCREEN.
001160 01  C-MID.
001170     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
001180          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001190     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
001200          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001210     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
001220          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
001230     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
001240          NC"＊＊＊　　得意先品名別出荷集計ワーク作成　　＊＊＊".
001250     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
001260          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
001270     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
001280          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001290     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
001300          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
001310     COPY LIBSCR.
001320 PROCEDURE DIVISION.
001330 M-05.
001340     DISPLAY C-CLEAR.
001350     DISPLAY C-MID.
001360*
001370     MOVE ZERO TO W-DATE.
001380     COPY LIBCPR.
001390     MOVE D-NHNG TO W-NGS.
001400     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
001410         ADD DATE-NC1 TO W-NEN.
001420     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
001430         ADD DATE-NC2 TO W-NEN.
001440*
001450     CALL "CBLSTNNO" USING STN-NO.
001460     MOVE STN-NO2 TO W-FID2.
001470     MOVE W-FID TO WK0064ID.
001480     OPEN EXTEND SSR-F.
001490     OPEN INPUT SNTR-F.
001500 M-10.
001510     READ SNTR-F AT END
001520         GO TO M-90.
001530     IF SNTR-GNO = 9
001540         GO TO M-10.
001550     IF SNTR-DC = 4 OR 8
001560         GO TO M-10.
001570     PERFORM DST-RTN THRU DST-EX.
001580     IF ZERO = W-SU AND W-UKIN AND W-GKIN
001590         GO TO M-10.
001600*
001610     MOVE ZERO      TO SSR-R.
001620     MOVE SNTR-TCD  TO SSR-TCD.
001630     MOVE SNTR-HCD  TO SSR-HCD.
001640     MOVE W-SU   TO SSR-SU.
001650     MOVE W-UKIN TO SSR-UKIN.
001660     MOVE W-GKIN TO SSR-GKIN.
001670     MOVE SNTR-TNC  TO SSR-TNC.
001680     MOVE SNTR-BC   TO SSR-BC.
001690     MOVE SNTR-BMC  TO SSR-BMC.
001700     MOVE SNTR-BMNO TO SSR-BMNO.
001710     MOVE SNTR-FKC  TO SSR-FKC.
001720     MOVE SNTR-NG TO SSR-NG.
001730     WRITE SSR-R.
001740     GO TO M-10.
001750 M-90.
001760     CLOSE SNTR-F.
001770     CLOSE SSR-F.
001780 M-95.
001790     DISPLAY C-CLEAR.
001800     STOP RUN.
001810 DST-RTN.
001820     MOVE ZERO TO W-RD.
001830     IF (SNTR-SNC = 0) OR (SNTR-DC NOT = 2)
001840         COMPUTE W-GKIN = SNTR-SU * SNTR-FT.
001850     IF (SNTR-SNC = 1) OR (SNTR-DC = 1 OR 2 OR 5)
001860         COMPUTE W-SU = SNTR-SU * -1
001870         COMPUTE W-GKIN = W-GKIN * -1
001880         COMPUTE W-UKIN = SNTR-UKIN * -1
001890       ELSE
001900         MOVE SNTR-SU TO W-SU
001910         MOVE SNTR-UKIN TO W-UKIN.
001920     IF (SNTR-HCD > 999899) OR (SNTR-SNC = 1) OR (SNTR-DC = 2)
001930         MOVE ZERO TO W-SU.
001940 DST-EX.
001950     EXIT.
