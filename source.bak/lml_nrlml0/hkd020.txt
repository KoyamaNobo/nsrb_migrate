000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HKD020.
000030**********************************************************
000040*    入金伝票発行                　　　　　              *
000050*    FORM    : FHK020                                    *
000060*    JS-SIGN : 正規=0 , 再発行(伝票№)=1 , (当月得意先)=2*
000070**********************************************************
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     SELECT KKB-M ASSIGN TO KKB-MSD
000150         ORGANIZATION INDEXED
000160         ACCESS MODE RANDOM
000170         RECORD KEY KKB-KEY
000180         FILE STATUS IS ERR-STAT.
000190*****SELECT T-M ASSIGN TO T-MSD                                   D.000221
000200     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000221
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY T-KEY
000240         ALTERNATE RECORD KEY T-KEY2                              I.000221
000250         FILE STATUS IS ERR-STAT.
000260*****SELECT HT-M ASSIGN TO HT-MSD                                 D.000221
000270*****SELECT TT-M ASSIGN TO TT-MSD                                 D.070126
000280*****    ORGANIZATION INDEXED                                     D.070126
000290*****    ACCESS MODE RANDOM                                       D.070126
000300*****    RECORD KEY TT-KEY                                        D.070126
000310*****    RECORD KEY HT-KEY                                        D.000221
000320*****    FILE STATUS IS ERR-STAT.                                 D.070126
000330*****SELECT KT-M ASSIGN TO KT-MSD                                 D.000221
000340*****    ORGANIZATION INDEXED                                     D.000221
000350*****    ACCESS MODE RANDOM                                       D.000221
000360*****    RECORD KEY KT-KEY                                        D.000221
000370*****    FILE STATUS IS ERR-STAT.                                 D.000221
000380     SELECT HKBM ASSIGN TO HKB-MSD
000390         ORGANIZATION INDEXED
000400         ACCESS MODE RANDOM
000410         RECORD KEY HKB-KEY
000420         FILE STATUS IS ERR-STAT.
000430     SELECT NYU-F ASSIGN TO NYU-MSD
000440         ORGANIZATION INDEXED
000450         ACCESS MODE DYNAMIC
000460         RECORD KEY N-KEY
000470         FILE STATUS IS ERR-STAT.
000480     SELECT NYUW-F ASSIGN TO NYUW-MSD.
000490     SELECT SP-F ASSIGN TO P-PRN999-FHK020.                       I.081023
000500*****SELECT SP-F ASSIGN TO P-PRN999.                              D.081023
000510 I-O-CONTROL.
000520     APPLY SHARED-MODE ON KKB-M
000530     APPLY SHARED-MODE ON T-M
000540*****APPLY SHARED-MODE ON TT-M                                    D.070126
000550*****APPLY SHARED-MODE ON HT-M                                    D.000221
000560*****APPLY SHARED-MODE ON KT-M                                    D.000221
000570     APPLY SHARED-MODE ON HKBM
000580     APPLY SHIFT-CODE  ON SP-F.
000590 DATA DIVISION.
000600 FILE SECTION.
000610     COPY LIKKBM.
000620     COPY LITM.
000630*****COPY LITTM.                                                  D.070126
000640*****COPY LIHTM.                                                  D.000221
000650*****COPY LIKTM.                                                  D.000221
000660     COPY LIHKBM.
000670 FD  NYU-F
000680*****BLOCK  3 RECORDS                                             D.000824
000690     BLOCK  5 RECORDS                                             I.000824
000700     LABEL RECORD IS STANDARD
000710     VALUE OF IDENTIFICATION "NYUF".
000720 01  NYU-R.
000730     02  N-DATE         PIC  9(008).
000740     02  N-TCD          PIC  9(004).
000750     02  N-KIN          PIC S9(008).
000760     02  N-NC           PIC  9(002).
000770     02  N-NSC          PIC  9(001).
000780     02  N-TD           PIC  9(008).
000790     02  N-SS           PIC  9(006).
000800     02  N-BC           PIC  9(001).
000810     02  N-TC           PIC  9(002).
000820     02  F              PIC  X(003).
000830     02  N-KEY.
000840       03  N-NO         PIC  9(006).
000850       03  N-GNO        PIC  9(001).
000860     02  F              PIC  X(032).                              I.000824
000870*****02  F              PIC  X(011).                              D.000824
000880     02  N-DPC          PIC  9(001).
000890     02  N-ACT          PIC  9(001).
000900     02  N-PRC          PIC  9(001).
000910     02  F              PIC  X(017).                              I.070126
000920*****02  F              PIC  X(005).                              D.000824
000930*****02  N-UZ           PIC S9(009).                              D.070126
000940*****02  N-UZZ          PIC S9(007).                              D.070126
000950*****02  F              PIC  X(001).                              D.070126
000960 FD  NYUW-F
000970     BLOCK  2 RECORDS
000980     LABEL RECORD IS STANDARD
000990     VALUE OF IDENTIFICATION WK0128ID.
001000 01  NYUW-R.
001010     02  NW-DATE.
001020       03  F            PIC  9(002).
001030       03  NW-NEN       PIC  9(002).
001040       03  NW-GET       PIC  9(002).
001050       03  NW-PEY       PIC  9(002).
001060     02  NW-TCD         PIC  9(004).
001070     02  NW-KIN         PIC S9(008).
001080     02  NW-NC          PIC  9(002).
001090     02  NW-NCD   REDEFINES NW-NC.
001100       03  NW-NC1       PIC  9(001).
001110       03  NW-NC2       PIC  9(001).
001120     02  NW-NSC         PIC  9(001).
001130     02  NW-TD.
001140       03  F            PIC  9(002).
001150       03  NW-TDN       PIC  9(002).
001160       03  NW-TDG       PIC  9(002).
001170       03  NW-TDP       PIC  9(002).
001180     02  NW-SS.
001190       03  F            PIC  9(002).
001200       03  NW-SSN       PIC  9(002).
001210       03  NW-SSG       PIC  9(002).
001220     02  NW-BC          PIC  9(001).
001230*****02  NW-TC          PIC  9(002).                              D.010220
001240     02  NW-TNC.                                                  I.010220
001250       03  NW-TNC1      PIC  9(001).                              I.010220
001260       03  NW-TNC2      PIC  9(001).                              I.010220
001270     02  F              PIC  X(003).
001280     02  NW-KEY.
001290       03  NW-NO        PIC  9(006).
001300       03  NW-GNO       PIC  9(001).
001310     02  NW-FDNO.
001320       03  NW-FNO       PIC  9(006).
001330       03  NW-FGNO      PIC  9(002).
001340*****02  F              PIC  X(003).                              D.000824
001350*****02  F              PIC  X(024).                              D.010220
001360*****02  F              PIC  X(008).                              D.010321
001370     02  F              PIC  X(002).                              I.010321
001380     02  NW-SKD         PIC  9(006).                              I.010321
001390     02  NW-DCC         PIC  9(001).                              I.010220
001400     02  F              PIC  X(015).                              I.010220
001410     02  NW-DPC         PIC  9(001).
001420     02  NW-ACT         PIC  9(001).
001430     02  NW-PRC         PIC  9(001).
001440     02  F              PIC  X(043).                              I.070126
001450*****02  F              PIC  X(005).                              D.000824
001460*****02  NW-UZ          PIC S9(009).                              D.070126
001470*****02  NW-UZZ         PIC S9(007).                              D.070126
001480*****02  F              PIC  X(027).                              D.070126
001490*****02  F              PIC  X(043).                              D.000824
001500 FD  SP-F
001510     LABEL RECORD IS OMITTED
001520     LINAGE IS 36 LINES.
001530 01  SP-R             PIC  X(170).
001540 WORKING-STORAGE SECTION.
001550 77  JS-SIGN            PIC  9(001).
001560 77  WK0128ID           PIC  X(009) VALUE SPACE.
001570 01  STN-NO.
001580     02  STN-NO1        PIC  X(003).
001590     02  STN-NO2        PIC  X(003).
001600 01  W-FID.
001610     02  W-FID1         PIC  X(006) VALUE "WK0128".
001620     02  W-FID2         PIC  X(003).
001630 01  ERR-STAT           PIC  X(002).
001640 01  W-FILE             PIC  X(013).
001650*01  W-20K              PIC  X(005) VALUE ""3FE04FE080"".         D.081023
001660*01  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".         D.081023
001670 01  HEAD1.
001680     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".         I.081023
001690     02  F              PIC  X(098) VALUE SPACE.                  I.081023
001700     02  F              PIC  N(002) VALUE NC"№　".               I.081023
001710*****02  P-20K1         PIC  X(005).                              D.081023
001720*****02  F              PIC  X(095).                              D.041015
001730*****02  F              PIC  X(094).                              D.081023
001740     02  P-NO           PIC  9(006).
001750     02  F              PIC  X(002) VALUE SPACE.                  I.081023
001760 01  HEAD2.
001770     02  F              PIC  X(093) VALUE SPACE.                  I.081023
001780     02  F              PIC  X(001) VALUE "'".                    I.081023
001790*****02  F              PIC  X(050).                              D.041015
001800*****02  F              PIC  X(049).                              D.081023
001810     02  P-NEN          PIC  9(002).
001820     02  F              PIC  N(002) VALUE NC"年　".               I.081023
001830*****02  F              PIC  X(003).                              D.081023
001840     02  P-GET          PIC Z9.
001850     02  F              PIC  N(002) VALUE NC"月　".               I.081023
001860*****02  F              PIC  X(003).                              D.081023
001870     02  P-PEY          PIC Z9.
001880     02  F              PIC  N(002) VALUE NC"日　".               I.081023
001890*****02  F              PIC  X(039).                              D.081023
001900 01  HEAD3.                                                       I.081023
001910     02  F              PIC  X(049) VALUE SPACE.                  I.081023
001920     02  F              PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.081023
001930     02  F              PIC  N(008) VALUE NC"入　　金　　票　".   I.081023
001940     02  F              PIC  X(008) VALUE ""3F504F40674F40A0"".   I.081023
001950     02  F              PIC  X(036) VALUE SPACE.                  I.081023
001960 01  HEAD4.                                                       I.081023
001970     02  F              PIC  X(013) VALUE SPACE.                  I.081023
001980     02  F              PIC  X(004) VALUE "ｺｰﾄﾞ".                 I.081023
001990     02  F              PIC  X(014) VALUE SPACE.                  I.081023
002000     02  F              PIC  N(010) VALUE                         I.081023
002010          NC"得　　意　　先　　名".                               I.081023
002020     02  F              PIC  X(063) VALUE SPACE.                  I.081023
002030 01   HEAD5.
002040*****02  F              PIC  X(022).                              D.041015
002050*****02  F              PIC  X(021).                              D.081023
002060*****02  P-TCD          PIC  N(004).                              D.081023
002070*****02  F              PIC  X(008).                              D.081023
002080*****02  P-15K          PIC  X(005).                              D.081023
002090     02  F              PIC  X(013).                              I.081023
002100     02  P-TCD          PIC  9(004).                              I.081023
002110     02  F              PIC  X(002).                              I.081023
002120     02  P-NAME         PIC  N(026).                              I.020408
002130     02  F              PIC  X(005).                              I.081023
002140*****02  P-20K2         PIC  X(005).                              D.081023
002150*****02  F              PIC  X(013).                              D.081023
002160*****02  P-NAME         PIC  N(024).                              D.020408
002170*****02  F              PIC  X(004).                              D.020408
002180     02  P-DF           PIC  X(001).                              I.000128
002190     02  P-TNC1         PIC  9(001).                              I.010220
002200     02  P-DV           PIC  X(001).                              I.010220
002210     02  P-DCC          PIC  9(001).                              I.010220
002220*****02  P-DNO          PIC  Z(003).                              D.010220
002230     02  P-DR           PIC  X(001).                              I.000128
002240     02  F              PIC  X(006).                              I.000128
002250     02  P-SKD          PIC  99/99/99.                            I.081023
002260     02  F              PIC  X(027).                              I.081023
002270*****02  F              PIC  X(015).                              D.000128
002280 01  HEAD6.                                                       I.081023
002290     02  F              PIC  X(020) VALUE SPACE.                  I.081023
002300     02  F              PIC  N(004) VALUE NC"摘　　要".           I.081023
002310     02  F              PIC  X(022) VALUE SPACE.                  I.081023
002320     02  F              PIC  N(004) VALUE NC"手形期日".           I.081023
002330     02  F              PIC  X(013) VALUE SPACE.                  I.081023
002340     02  F              PIC  N(004) VALUE NC"金　　額".           I.081023
002350     02  F              PIC  X(007) VALUE SPACE.                  I.081023
002360     02  F              PIC  N(004) VALUE NC"請求年月".           I.081023
002370     02  F              PIC  X(023) VALUE SPACE.                  I.081023
002380 01  W-PM.
002390*****02  F              PIC  X(012).                              D.041015
002400*****02  F              PIC  X(011).                              D.081023
002410*****02  P-NC           PIC  N(002).                              D.081023
002420     02  F              PIC  X(013).                              I.081023
002430     02  P-NF           PIC  X(001).                              I.081023
002440     02  P-NC           PIC  9(002).                              I.081023
002450     02  P-NR           PIC  X(001).                              I.081023
002460     02  F              PIC  X(001).
002470     02  P-NCM          PIC  N(006).
002480     02  F              PIC  X(009).                              I.081023
002490*****02  F              PIC  X(017).                              D.081023
002500     02  P-FF           PIC  X(001).
002510     02  P-FNO          PIC  9(006).
002520     02  P-FR           PIC  X(001).
002530     02  F              PIC  X(002).
002540     02  P-TDN          PIC  N(002).
002550     02  P-TDV1         PIC  X(001).
002560     02  P-TDG          PIC  N(002).
002570     02  P-TDV2         PIC  X(001).
002580     02  P-TDP          PIC  N(002).
002590     02  F              PIC  X(003).                              I.081023
002600     02  P-KIN          PIC  N(012).                              I.081023
002610*****02  F              PIC  X(001).                              D.081023
002620*****02  P-KIN          PIC  N(010).                              D.081023
002630*****02  F              PIC  X(001).                              D.081023
002640     02  F              PIC  X(002).                              I.081023
002650     02  P-SSN          PIC  N(002).
002660     02  P-SSV          PIC  X(001).
002670     02  P-SSG          PIC  N(002).
002680     02  F              PIC  X(022).                              I.081023
002690 01  HEAD8.                                                       I.081023
002700     02  F              PIC  X(013) VALUE SPACE.                  I.081023
002710     02  F              PIC  N(002) VALUE NC"備考".               I.081023
002720     02  F              PIC  X(042) VALUE SPACE.                  I.081023
002730     02  F              PIC  N(004) VALUE NC"入　　金".           I.081023
002740     02  F              PIC  X(010) VALUE SPACE.                  I.081023
002750     02  F              PIC  N(006) VALUE NC"　消　費　税".       I.081023
002760     02  F              PIC  X(013) VALUE SPACE.                  I.081023
002770     02  F              PIC  N(004) VALUE NC"合　　計".           I.081023
002780     02  F              PIC  X(007) VALUE SPACE.                  I.081023
002790 01  W-PT.
002800     02  F              PIC  X(051).                              I.041015
002810     02  P-TKIN         PIC  N(012).                              I.081023
002820     02  F              PIC  X(001).                              I.041015
002830     02  P-SHZ          PIC  N(012).                              I.081023
002840     02  F              PIC  X(001).                              I.041015
002850     02  P-AKIN         PIC  N(012).                              I.081023
002860     02  F              PIC  X(002).                              I.041015
002870 01  HEAD9.
002880     02  F              PIC  X(013) VALUE SPACE.                  I.081023
002890     02  F              PIC  X(005) VALUE "* 00=".                I.081023
002900     02  F              PIC  N(002) VALUE NC"現金".               I.081023
002910     02  F              PIC  X(004) VALUE " 10=".                 I.081023
002920     02  F              PIC  N(002) VALUE NC"振込".               I.081023
002930     02  F              PIC  X(004) VALUE " 20=".                 I.081023
002940     02  F              PIC  N(004) VALUE NC"小切手　".           I.081023
002950     02  F              PIC  X(003) VALUE "30=".                  I.081023
002960     02  F              PIC  N(002) VALUE NC"約手".               I.081023
002970     02  F              PIC  X(004) VALUE " 40=".                 I.081023
002980     02  F              PIC  N(002) VALUE NC"為手".               I.081023
002990     02  F              PIC  X(004) VALUE " 50=".                 I.081023
003000     02  F              PIC  N(006) VALUE NC"買掛金相殺　".       I.081023
003010     02  F              PIC  X(003) VALUE "60=".                  I.081023
003020     02  F              PIC  N(006) VALUE NC"その他相殺　".       I.081023
003030     02  F              PIC  X(003) VALUE "58=".                  I.081023
003040     02  F              PIC  N(006) VALUE NC"買掛金消費税".       I.081023
003050     02  F              PIC  X(004) VALUE " 79=".                 I.081023
003060     02  F              PIC  N(006) VALUE NC"消費税取消　".       I.081023
003070     02  F              PIC  X(008) VALUE SPACE.                  I.081023
003080*****02  F              PIC  X(057).                              D.041015
003090*****02  F              PIC  X(056).                              D.081023
003100*****02  P-SHZ          PIC  N(008).                              D.081023
003110*****D2  F              PIC  X(008).                              D.081023
003120*****02  P-TKIN         PIC  N(010).                              D.081023
003130*01  W-P7.                                                        D.081023
003140*****02  F              PIC  X(095).                              D.041015
003150*****02  F              PIC  X(094).                              D.081023
003160*****02  P-SKD          PIC  99/99/99.                            D.081023
003170 01  W-DATA.
003180     02  W-SE.
003190       03  W-SDNO       PIC  9(006).
003200       03  W-EDNO       PIC  9(006).
003210     02  W-TCD          PIC  9(004).                              I.120910
003220     02  W-DMM          PIC  9(001).                              I.120910
003230     02  W-POC          PIC  9(001).
003240     02  W-TPC          PIC  9(001).
003250     02  W-DNO          PIC  9(006).
003260     02  W-SKD          PIC  9(006).                              I.010321
003270     02  W-AD.
003280       03  W-AKIN       PIC S9(009).
003290       03  W-TKIN       PIC S9(009).
003300       03  W-SHZ        PIC S9(007).
003310     02  CNT            PIC  9(001).
003320*****02  W-UZ           PIC S9(009).                              D.070126
003330*****02  W-UZZ          PIC S9(007).                              D.070126
003340     02  W-Z.
003350       03  W-TDGZ       PIC Z9.
003360       03  W-TDPZ       PIC Z9.
003370       03  W-SSGZ       PIC Z9.
003380       03  W-KINZ       PIC ----,---,--9.                         I.081023
003390*****  03  W-KINZ       PIC ---------9.                           D.081023
003400*****  03  W-SHZZ       PIC -------9.                             D.081023
003410     02  W-KDC          PIC  9(001).
003420     02  W-NOC          PIC  9(001).                              I.120910
003430     02  W-DTH          PIC  9(001).                              I.120924
003440     02  W-DTK          PIC  9(001).                              I.120924
003450     02  W-KG           PIC  9(002).
003460     02  W-BC           PIC  9(001).
003470     02  W-END          PIC  9(001).
003480     COPY LSTAT.
003490 SCREEN SECTION.
003500 SD  C-CRT
003510     END STATUS IS ESTAT.
003520 01  C-CLEAR.
003530     02  LINE   1  CLEAR SCREEN.
003540 01  C-MID.
003550     02  LINE   3  COLUMN  18  PIC  N(021) VALUE
003560          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003570     02  LINE   4  COLUMN  18  PIC  N(021) VALUE
003580          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003590     02  LINE   5  COLUMN  18  PIC  N(021) VALUE
003600          NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".
003610     02  LINE   6  COLUMN  18  PIC  N(021) VALUE
003620          NC"＊＊＊　　入　金　伝　票　発　行　　＊＊＊".
003630     02  LINE   7  COLUMN  18  PIC  N(021) VALUE
003640          NC"＊＊＊　　　　　　　　　　　　　　　＊＊＊".
003650     02  LINE   8  COLUMN  18  PIC  N(021) VALUE
003660          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003670     02  LINE   9  COLUMN  18  PIC  N(021) VALUE
003680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003690*****02  LINE  15  COLUMN  28  PIC  X(028) VALUE                  D.120910
003700*****02  LINE  12  COLUMN  28  PIC  X(028) VALUE                  D.120924
003710*****     "-----   用紙　セット   -----" BLINK.                   D.120924
003720*****02  LINE  18  COLUMN  23  PIC  X(034) VALUE                  D.120910
003730*****02  LINE  14  COLUMN  23  PIC  X(034) VALUE                  D.120924
003740*****     "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  ｼﾅｲ=1 ｽﾙ=9   ﾘﾀｰﾝ  ]".                   D.120924
003750*****     "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  OK=1 NO=9    ﾘﾀｰﾝ  ]".                   D.000218
003760 01  C-DSP.
003770*****02  D-KSM   LINE   6  COLUMN  28  PIC  N(011) VALUE          D.070126
003780*****     NC"　（　ＴＴＭ更新　）　".                             D.070126
003790*****     NC"（ＨＴＭ，ＫＴＭ更新）".                             D.000221
003800     02  D-SHM.
003810*****  03  LINE   6  COLUMN  34  PIC  N(005) VALUE NC"（再発行）".D.120910
003820       03  LINE   7  COLUMN  31  PIC  N(008) VALUE                I.120910
003830            NC"（当月分再発行）".                                 I.120910
003840       03  LINE  12  COLUMN  28  PIC  X(028) VALUE                I.120924
003850            "-----   用紙　セット   -----" BLINK.                 I.120924
003860       03  LINE  14  COLUMN  23  PIC  X(034) VALUE                I.120924
003870            "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  ｼﾅｲ=1 ｽﾙ=9   ﾘﾀｰﾝ  ]".                 I.120924
003880       03  LINE  20  COLUMN  38  PIC  X(022) VALUE                I.120910
003890            "確認  OK=1 NO=9   ﾘﾀｰﾝ".                             I.120910
003900*****  03  LINE  12  COLUMN  24  PIC  X(030) VALUE                D.120910
003910     02  D-DNM.                                                   I.120910
003920       03  LINE  16  COLUMN  24  PIC  X(030) VALUE                I.120910
003930            "伝票№ 000000 より 999999 まで".
003940     02  D-TSM.                                                   I.120910
003950       03  LINE  16  COLUMN  14  PIC  X(009) VALUE                I.120910
003960            "ｺｰﾄﾞ     ".
003970     02  D-NAME  LINE  16  COLUMN  24  PIC  N(026) FROM  T-NAME.  I.120910
003980 01  C-ACP.
003990     02  A-TPC   LINE  14  COLUMN  49  PIC  9(001)                I.120910
004000          USING W-TPC   CHECK OVERFLOW NO IFC.                    I.120910
004010*****02  LINE  12.                                                D.120910
004020     02  LINE  16.                                                D.120910
004030       03  A-TCD   COLUMN  19  PIC  9(004)                        I.120910
004040            USING W-TCD   CHECK OVERFLOW NO IFC.                  I.120910
004050       03  A-SDNO  COLUMN  31  PIC  9(006)
004060            USING W-SDNO  CHECK OVERFLOW NO IFC.
004070       03  A-EDNO  COLUMN  43  PIC  9(006)
004080            USING W-EDNO  CHECK OVERFLOW NO IFC.
004090     02  A-DMM   LINE  20  COLUMN  55  PIC  9(001)                I.120910
004100          USING W-DMM   CHECK OVERFLOW NO IFC.                    I.120910
004110*****02  A-TPC   LINE  18  COLUMN  49  PIC  9(001)                D.120910
004120*****     USING W-TPC   CHECK OVERFLOW NO IFC.                    D.120910
004130 01  C-DSP.
004140     02  LINE  15.
004150       03  D-SME04 COLUMN  18  PIC  N(017) VALUE
004160            NC"＊＊＊　　他で入金入力中　　＊＊＊" BLINK.
004170       03  D-SME13 COLUMN  18  PIC  N(017) VALUE
004180            NC"＊＊＊　　他で日次更新中　　＊＊＊" BLINK.
004190       03  D-SME15 COLUMN  18  PIC  N(017) VALUE
004200            NC"＊＊＊　　他で月次更新中　　＊＊＊" BLINK.
004210 01  C-ERR.
004220     02  LINE  24.
004230       03  E-ME1   COLUMN  15  PIC  X(018) VALUE                  I.120910
004240            "***  ﾄｸｲｻｷ ﾅｼ  ***".                                 I.120910
004250*****  03  E-ME2   COLUMN  15  PIC  X(016) VALUE                  D.070126
004260*****       "***  TTM ﾅｼ  ***".                                   D.070126
004270*****       "***  HTM ﾅｼ  ***".                                   D.000221
004280*****  03  E-ME3   COLUMN  15  PIC  X(016) VALUE                  D.000221
004290*****       "***  KTM ﾅｼ  ***".                                   D.000221
004300*****  03  E-ME5   COLUMN  15  PIC  X(025) VALUE                  D.070126
004310*****       "***  TTM REWRITE ｴﾗｰ  ***".                          D.070126
004320*****       "***  HTM REWRITE ｴﾗｰ  ***".                          D.000221
004330*****  03  E-ME6   COLUMN  15  PIC  X(025) VALUE                  D.000221
004340*****       "***  KTM REWRITE ｴﾗｰ  ***".                          D.000221
004350       03  E-ME7   COLUMN  15  PIC  X(017) VALUE
004360            "***  KKBM ﾅｼ  ***".
004370       03  E-ME8   COLUMN  15  PIC  X(026) VALUE
004380            "***  KKBM REWRITE ｴﾗｰ  ***".
004390       03  E-ME11  COLUMN  15  PIC  X(017) VALUE
004400            "***  HKBM ﾅｼ  ***".
004410       03  E-ME12  COLUMN  15  PIC  X(018) VALUE
004420            "***  ﾌﾞﾓﾝ ｴﾗｰ  ***".
004430       03  E-ME13  COLUMN  15  PIC  X(017) VALUE
004440            "***  NYUF ﾅｼ  ***".
004450       03  E-ME14  COLUMN  15  PIC  X(026) VALUE
004460            "***  NYUF REWRITE ｴﾗｰ  ***".
004470       03  E-ME15  COLUMN  15  PIC  X(017) VALUE
004480            "***  DATA ﾅｼ  ***".
004490       03  E-ME16  COLUMN  15  PIC  X(018) VALUE
004500            "***  DATA ｴﾗｰ  ***".
004510       03  E-ME90  COLUMN  15  PIC  N(022) VALUE
004520            NC"【　　工品区分マスターを修正して下さい　　】".
004530       03  E-KEY   COLUMN  65  PIC  X(006) FROM NW-NO.
004540       03  E-TCD   COLUMN  60  PIC  X(004) FROM T-KEY.
004550     COPY LSSEM.
004560 PROCEDURE DIVISION.
004570 M-05.
004580     ACCEPT JS-SIGN.
004590*****IF JS-SIGN > 1                                               D.120910
004600     IF JS-SIGN > 2                                               I.120910
004610         STOP RUN.
004620     DISPLAY C-CLEAR.
004630     DISPLAY C-MID.
004640     MOVE ZERO TO W-DATA.
004650     MOVE 999999 TO W-EDNO.                                       I.151102
004660     IF JS-SIGN NOT = 0                                           I.120910
004670         DISPLAY D-SHM                                            I.120910
004680         IF JS-SIGN = 1                                           I.120910
004690             DISPLAY D-DNM                                        I.120910
004700           ELSE                                                   I.120910
004710             IF JS-SIGN = 2                                       I.120910
004720                 DISPLAY D-TSM.                                   I.120910
004730     OPEN INPUT T-M.                                              I.120910
004740*
004750     IF JS-SIGN NOT = 0                                           I.120910
004760         GO TO M-10.                                              I.120910
004770     PERFORM KDC-RTN THRU KDC-EX.                                 I.120910
004780     IF W-END = 9                                                 I.120910
004790         GO TO M-95.                                              I.120910
004800     GO TO M-40.                                                  I.120924
004810*****IF JS-SIGN = 0                                               D.120910
004820*****    DISPLAY D-KSM                                            D.070126
004830*****    GO TO M-10.                                              D.120910
004840*****DISPLAY D-SHM.                                               D.120910
004850*M-06.                                                            D.120910
004860*****ACCEPT A-SDNO.                                               D.120910
004870*****IF ESTAT = PF9                                               D.120910
004880*****    IF W-POC = 0                                             D.120910
004890*****        GO TO M-95                                           D.120910
004900*****      ELSE                                                   D.120910
004910*****        CLOSE SP-F                                           D.120910
004920*****        GO TO M-95.                                          D.120910
004930*****IF ESTAT NOT = HTB AND SKP                                   D.120910
004940*****    GO TO M-06.                                              D.120910
004950*M-07.                                                            D.120910
004960*****ACCEPT A-EDNO.                                               D.120910
004970*****IF ESTAT = BTB                                               D.120910
004980*****    GO TO M-06.                                              D.120910
004990*****IF ESTAT NOT = HTB AND SKP                                   D.120910
005000******   GO TO M-07.                                              D.120910
005010*****IF W-SDNO > W-EDNO                                           D.010808
005020*****    GO TO M-07.                                              D.010808
005030 M-10.
005040     ACCEPT A-TPC.
005050     IF ESTAT = PF9
005060         IF W-POC = 0
005070             GO TO M-95
005080           ELSE
005090             CLOSE SP-F
005100             GO TO M-95.
005110*****IF ESTAT = BTB                                               D.120910
005120*****    IF JS-SIGN = 1                                           D.120910
005130*****        GO TO M-07.                                          D.120910
005140     IF ESTAT NOT = HTB AND SKP
005150         GO TO M-10.
005160     IF W-TPC = 1
005170         IF JS-SIGN = 0                                           I.120910
005180             GO TO M-40                                           I.120910
005190           ELSE                                                   I.120910
005200             IF JS-SIGN = 1                                       I.120910
005210                 GO TO M-20                                       I.120910
005220               ELSE                                               I.120910
005230                 GO TO M-30.                                      I.120910
005240     IF W-TPC NOT = 9
005250         GO TO M-10.
005260*
005270     IF W-POC = 0
005280         MOVE 1 TO W-POC
005290         OPEN OUTPUT SP-F
005300         MOVE SPACE TO HEAD5 W-PM W-PT                            I.081023
005310*****    MOVE SPACE TO HEAD1 HEAD2 HEAD5 W-PM W-PT                D.081023
005320*****    MOVE W-20K TO P-20K1                                     D.020408
005330*****    MOVE W-20K TO P-20K1 P-20K2                              D.081023
005340*****    MOVE W-15K TO P-15K                                      D.081023
005350         MOVE 999999 TO P-NO
005360         MOVE 99 TO P-NEN P-GET P-PEY
005370         MOVE "9999" TO P-TCD                                     I.081023
005380*****    MOVE NC"９９９９" TO P-TCD                               D.081023
005390         MOVE ALL NC"Ｎ" TO P-NAME
005400         MOVE NC"　９９９，９９９，９９９" TO P-TKIN P-AKIN       I.081023
005410         MOVE NC"　　９９，９９９，９９９" TO P-SHZ.              I.081023
005420*****    MOVE NC"－９９９９９９９９９" TO P-TKIN                  D.081023
005430*****    MOVE NC"－９９９９９９９" TO P-SHZ.                      D.081023
005440     PERFORM MID-RTN THRU MID-EX.
005450     MOVE 0 TO CNT.
005460 M-15.
005470     ADD 1 TO CNT.
005480     IF CNT = 9
005490*****    MOVE SPACE TO W-PM                                       D.081023
005500*****    MOVE SPACE TO P-NC P-NCM P-TDN P-TDG P-TDP P-SSN P-SSG   D.081023
005510*****    MOVE NC"－９９９９９９９９９" TO P-KIN                   D.081023
005520*****    MOVE W-PM TO SP-R                                        D.081023
005530         MOVE SPACE TO SP-R                                       I.081023
005540         MOVE HEAD8 TO SP-R                                       I.081023
005550         WRITE SP-R AFTER 2
005560         MOVE SPACE TO SP-R
005570         MOVE W-PT TO SP-R
005580         WRITE SP-R AFTER 2
005590         MOVE SPACE TO SP-R                                       I.081023
005600         MOVE HEAD9 TO SP-R                                       I.081023
005610*****    WRITE SP-R AFTER 2                                       D.070126
005620         MOVE SPACE TO SP-R
005630         WRITE SP-R AFTER 2                                       I.081023
005640         MOVE SPACE TO SP-R                                       I.081023
005650         WRITE SP-R AFTER 2                                       I.081023
005660*****    WRITE SP-R AFTER 6                                       D.081023
005670*****    WRITE SP-R AFTER 4                                       D.070126
005680         GO TO M-10.
005690     IF CNT = 1
005700         MOVE SPACE TO W-PM
005710         MOVE SPACE TO P-NCM P-TDN P-TDG P-TDP P-KIN P-SSN P-SSG  I.081023
005720         MOVE "(" TO P-NF P-FF                                    I.081023
005730         MOVE ")" TO P-NR P-FR                                    I.081023
005740         MOVE 99 TO P-NC                                          I.081023
005750         MOVE NC"９９" TO P-TDN P-TDG P-TDP P-SSN P-SSG           D.081023
005760*****    MOVE NC"９９" TO P-NC P-TDN P-TDG P-TDP P-SSN P-SSG      D.081023
005770         MOVE NC"ＮＮＮＮＮＮ" TO P-NCM
005780         MOVE 999999 TO P-FNO
005790         MOVE "/" TO P-TDV1 P-TDV2 P-SSV
005800         MOVE NC"　９９９，９９９，９９９" TO P-KIN.              I.081023
005810*****    MOVE "(" TO P-FF                                         D.081023
005820*****    MOVE ")" TO P-FR                                         D.081023
005830*****    MOVE NC"－９９９９９９９９９" TO P-KIN.                  D.081023
005840     MOVE SPACE TO SP-R.
005850     MOVE W-PM TO SP-R.
005860     WRITE SP-R AFTER 2.
005870     MOVE SPACE TO SP-R.
005880     GO TO M-15.
005890*M-16.                                                            D.120910
005900*****IF JS-SIGN = 1                                               D.120910
005910*****    GO TO M-40.                                              D.120910
005920*****PERFORM KDC-RTN THRU KDC-EX.                                 D.120910
005930*****IF W-END = 9                                                 D.120910
005940*****    GO TO M-95.                                              D.120910
005950 M-20.                                                            I.120910
005960     ACCEPT A-SDNO.                                               I.120910
005970     IF ESTAT = BTB                                               I.120910
005980         GO TO M-10.                                              I.120910
005990     IF ESTAT = PF9                                               I.120910
006000         IF W-POC = 0                                             I.120910
006010             GO TO M-95                                           I.120910
006020           ELSE                                                   I.120910
006030             CLOSE SP-F                                           I.120910
006040             GO TO M-95.                                          I.120910
006050     IF ESTAT NOT = HTB AND SKP                                   I.120910
006060         GO TO M-20.                                              I.120910
006070 M-25.                                                            I.120910
006080     ACCEPT A-EDNO.                                               I.120910
006090     IF ESTAT = BTB                                               I.120910
006100         GO TO M-20.                                              I.120910
006110     IF ESTAT NOT = HTB AND SKP                                   I.120910
006120         GO TO M-25.                                              I.120910
006130     IF W-SDNO > W-EDNO                                           I.120910
006140         GO TO M-25.                                              I.120910
006150     GO TO M-35.                                                  I.120910
006160 M-30.                                                            I.120910
006170     ACCEPT A-TCD.                                                I.120910
006180     IF ESTAT = BTB                                               I.120910
006190         GO TO M-10.                                              I.120910
006200     IF ESTAT = PF9                                               I.120910
006210         GO TO M-90.                                              I.120924
006220*****    IF W-POC = 0                                             D.120924
006230*****        GO TO M-95                                           D.120924
006240*****      ELSE                                                   D.120924
006250*****        CLOSE SP-F                                           D.120924
006260*****        GO TO M-95.                                          D.120924
006270     IF ESTAT NOT = HTB AND SKP                                   I.120910
006280         GO TO M-30.                                              I.120910
006290     IF W-TCD = 9999                                              I.120924
006300         GO TO M-90.                                              I.120924
006310     MOVE W-TCD TO T-KEY.                                         I.120910
006320     READ T-M WITH UNLOCK INVALID KEY                             I.120910
006330         DISPLAY E-ME1                                            I.120910
006340         GO TO M-30.                                              I.120910
006350     DISPLAY D-NAME.                                              I.120910
006360 M-35.                                                            I.120910
006370     ACCEPT A-DMM.                                                I.120910
006380     IF ESTAT = BTB                                               I.120910
006390         IF JS-SIGN = 1                                           I.120910
006400             GO TO M-25                                           I.120910
006410           ELSE                                                   I.120910
006420             GO TO M-30.                                          I.120910
006430     IF ESTAT NOT = HTB AND SKP                                   I.120910
006440         GO TO M-35.                                              I.120910
006450     IF W-DMM = 9                                                 I.120910
006460         IF JS-SIGN = 1                                           I.120910
006470             GO TO M-20                                           I.120910
006480           ELSE                                                   I.120910
006490             GO TO M-30.                                          I.120910
006500     IF W-DMM NOT = 1                                             I.120910
006510         GO TO M-35.                                              I.120910
006520 M-40.
006530*****CALL "CBLSTNNO" USING STN-NO.                                D.120910
006540*****MOVE STN-NO2 TO W-FID2.                                      D.120910
006550*****MOVE W-FID TO WK0128ID.                                      D.120910
006560*****OPEN INPUT NYUW-F.                                           D.120910
006570*****OPEN INPUT T-M.                                              D.120910
006580*****OPEN INPUT HKBM.                                             D.120910
006590*****IF JS-SIGN = 1                                               D.070126
006600*****    GO TO M-45.                                              D.070126
006610     IF W-NOC = 0                                                 I.120910
006620         MOVE 1 TO W-NOC                                          I.120910
006630         CALL "CBLSTNNO" USING STN-NO                             I.120910
006640         MOVE STN-NO2 TO W-FID2                                   I.120910
006650         MOVE W-FID TO WK0128ID                                   I.120910
006660         OPEN INPUT NYUW-F                                        I.120910
006670         OPEN INPUT HKBM                                          I.120910
006680         IF JS-SIGN = 0                                           I.070126
006690             OPEN I-O NYU-F.
006700*****OPEN I-O TT-M.                                               D.070126
006710*****OPEN I-O HT-M.                                               D.000221
006720*****IF W-KDC NOT = 0                                             D.000221
006730*****    OPEN I-O KT-M.                                           D.000221
006740 M-45.
006750     READ NYUW-F AT END
006760         DISPLAY E-ME15 E-ME99
006770         GO TO M-90.
006780     IF JS-SIGN = 0
006790         IF NW-DPC NOT = 0
006800             GO TO M-45.
006810     IF JS-SIGN NOT = 0                                           I.120910
006820         IF NW-DPC = 0                                            I.120910
006830             GO TO M-45.                                          I.120910
006840     IF JS-SIGN = 1
006850*****    IF NW-DPC = 0                                            D.120910
006860*****        GO TO M-45                                           D.120910
006870*****      ELSE                                                   D.120910
006880         IF NW-NO < W-SDNO OR > W-EDNO
006890             GO TO M-45.
006900     IF JS-SIGN = 2                                               I.120910
006910         IF NW-TCD NOT = W-TCD                                    I.120910
006920             GO TO M-45.                                          I.120910
006930 M-50.
006940     IF NW-GNO NOT = 1
006950         DISPLAY E-ME16 E-KEY E-ME99
006960         GO TO M-90.
006970     MOVE NW-NO TO W-DNO.
006980*****MOVE NW-SKD TO W-SKD.                                        D.081023
006990     MOVE ZERO TO W-AD.
007000     MOVE NW-TCD TO T-KEY.
007010     READ T-M WITH UNLOCK INVALID KEY
007020         MOVE SPACE TO T-NAME.                                    I.010220
007030*****    MOVE SPACE TO T-NAME                                     D.010220
007040*****    MOVE ZERO TO T-DNO.                                      D.010220
007050*****    MOVE SPACE TO T-NAME.                                    D.000128
007060     IF NW-BC NOT = T-BC
007070         DISPLAY E-ME12 E-KEY E-ME99
007080         GO TO M-90.
007090     MOVE NW-BC TO W-BC.
007100*****IF JS-SIGN = 1                                               D.070126
007110*****    GO TO M-52.                                              D.070126
007120*****IF NW-BC NOT = 0                                             D.000221
007130*****    GO TO M-51.                                              D.000221
007140*****MOVE NW-TCD TO HT-KEY.                                       D.000221
007150*****READ HT-M INVALID KEY                                        D.000221
007160*****MOVE NW-TCD TO TT-KEY.                                       D.070126
007170*****READ TT-M INVALID KEY                                        D.070126
007180*****    DISPLAY E-ME2 E-TCD E-ME99                               D.070126
007190*****    GO TO M-90.                                              D.070126
007200*****GO TO M-52.                                                  D.000221
007210*M-51.                                                            D.000221
007220*****MOVE NW-TCD TO KT-KEY.                                       D.000221
007230*****READ KT-M INVALID KEY                                        D.000221
007240*****    DISPLAY E-ME3 E-TCD E-ME99                               D.000221
007250*****    GO TO M-90.                                              D.000221
007260*M-52.                                                            D.070126
007270     IF JS-SIGN = 0                                               I.120924
007280         GO TO M-55.                                              I.120924
007290     IF W-POC = 0
007300         MOVE 1 TO W-POC
007310         OPEN OUTPUT SP-F.
007320     MOVE SPACE TO HEAD5.                                         I.081023
007330*****MOVE SPACE TO HEAD1 HEAD2 HEAD5.                             D.081023
007340*****MOVE W-20K TO P-20K1.                                        D.020408
007350*****MOVE W-20K TO P-20K1 P-20K2.                                 D.081023
007360*****MOVE W-15K TO P-15K.                                         D.081023
007370     MOVE W-DNO TO P-NO.
007380     MOVE NW-NEN TO P-NEN.
007390     MOVE NW-GET TO P-GET.
007400     MOVE NW-PEY TO P-PEY.
007410     MOVE NW-TCD TO P-TCD.
007420     MOVE T-NAME TO P-NAME.
007430*****IF T-DNO NOT = ZERO                                          D.010220
007440*****    MOVE "(" TO P-DF                                         D.010220
007450*****    MOVE T-DNO TO P-DNO                                      D.010220
007460     MOVE "(" TO P-DF.                                            I.010220
007470     MOVE NW-TNC1 TO P-TNC1.                                      I.010220
007480     MOVE "-" TO P-DV.                                            I.010220
007490     MOVE NW-DCC TO P-DCC.                                        I.010220
007500     MOVE ")" TO P-DR.                                            I.000128
007510     IF NW-SKD NOT = ZERO                                         I.081023
007520         MOVE NW-SKD TO P-SKD.                                    I.081023
007530     PERFORM MID-RTN THRU MID-EX.
007540 M-55.                                                            I.120924
007550     MOVE 0 TO CNT.
007560 M-60.
007570     ADD 1 TO CNT.
007580     IF CNT = 9
007590         GO TO M-75.
007600     IF NW-BC NOT = W-BC
007610         DISPLAY E-ME12 E-KEY E-ME99
007620         GO TO M-90.
007630*****IF JS-SIGN = 1                                               D.120910
007640     IF JS-SIGN NOT = 0                                           I.120910
007650         GO TO M-65.
007660     MOVE NW-KEY TO N-KEY.
007670     READ NYU-F INVALID KEY
007680         DISPLAY E-ME13 E-KEY E-ME99
007690         GO TO M-90.
007700 M-65.
007710*****PERFORM PRI-RTN THRU PRI-EX.                                 D.120924
007720*****IF JS-SIGN = 1                                               D.120910
007730*****    MOVE NW-UZ TO W-UZ                                       D.070126
007740*****    MOVE NW-UZZ TO W-UZZ                                     D.070126
007750     IF JS-SIGN NOT = 0                                           I.120910
007760         PERFORM PRI-RTN THRU PRI-EX                              I.120924
007770       ELSE                                                       I.120910
007780*****    GO TO M-70.                                              D.120924
007790*****MOVE 1 TO N-DPC.                                             D.120924
007800         MOVE 1 TO N-DPC                                          I.120924
007810         REWRITE NYU-R INVALID KEY
007820             DISPLAY E-STAT E-ME14 E-KEY E-ME99
007830             GO TO M-90.
007840 M-70.
007850     READ NYUW-F AT END
007860         GO TO M-85.
007870     IF JS-SIGN = 0
007880         IF NW-DPC NOT = 0
007890             GO TO M-70.
007900     IF JS-SIGN NOT = 0                                           I.120910
007910         IF NW-DPC = 0                                            I.120910
007920             GO TO M-70.                                          I.120910
007930     IF JS-SIGN = 1
007940*****    IF NW-DPC = 0                                            D.120910
007950*****        GO TO M-70                                           D.120910
007960*****      ELSE                                                   D.120910
007970         IF NW-NO < W-SDNO OR > W-EDNO
007980             GO TO M-70.
007990     IF JS-SIGN = 2                                               I.120910
008000         IF NW-TCD NOT = W-TCD                                    I.120910
008010             GO TO M-70.                                          I.120910
008020     IF NW-NO = W-DNO
008030         GO TO M-60.
008040 M-75.
008050     IF JS-SIGN NOT = 0                                           I.120910
008060         PERFORM KEI-RTN THRU KEI-EX.
008070*****IF W-END = 9                                                 D.120910
008080*****    GO TO M-90.                                              D.120910
008090     GO TO M-50.
008100 M-85.
008110     IF JS-SIGN NOT = 0                                           I.120910
008120         PERFORM KEI-RTN THRU KEI-EX.
008130 M-90.
008140     IF ESTAT NOT = PF9                                           I.120910
008150         IF JS-SIGN = 2                                           I.120910
008160             IF W-TCD NOT = 9999                                  I.120924
008170                 DISPLAY C-CLEAR                                  I.120910
008180                 DISPLAY C-MID                                    I.120910
008190                 DISPLAY D-SHM D-TSM                              I.120910
008200                 CLOSE NYUW-F                                     I.120910
008210                 OPEN INPUT NYUW-F                                I.120910
008220                 GO TO M-30.                                      I.120910
008230     IF W-POC NOT = 0
008240         CLOSE SP-F.
008250*****CLOSE NYUW-F.                                                D.120924
008260*****CLOSE T-M.                                                   D.120910
008270*****CLOSE HKBM.                                                  D.120924
008280*****IF JS-SIGN = 1                                               D.120910
008290*****    GO TO M-95.                                              D.120910
008300*****CLOSE HT-M.                                                  D.000221
008310*****CLOSE TT-M.                                                  D.070126
008320     IF W-NOC = 1                                                 I.120924
008330         CLOSE NYUW-F                                             I.120924
008340         CLOSE HKBM                                               I.120924
008350         IF JS-SIGN = 0                                           I.120910
008360             CLOSE NYU-F.
008370*****IF W-KDC NOT = 0                                             D.000128
008380*****    MOVE 000 TO COMPLETION-CODE                              D.000128
008390*****  ELSE                                                       D.000128
008400*****    MOVE 100 TO COMPLETION-CODE                              D.000128
008410*****IF W-KDC NOT = 0                                             D.120910
008420*****    PERFORM KKB2-RTN THRU KKB2-EX.                           D.120910
008430 M-95.
008440     IF W-KDC NOT = 0                                             I.120910
008450         PERFORM KKB2-RTN THRU KKB2-EX.                           I.120910
008460     CLOSE T-M.                                                   I.120910
008470     DISPLAY C-CLEAR.
008480     STOP RUN.
008490 KDC-RTN.
008500     OPEN INPUT NYU-F.
008510 KDC-010.
008520     READ NYU-F NEXT RECORD AT END
008530         GO TO KDC-020.
008540     IF N-DPC NOT = 0
008550         GO TO KDC-010.
008560     IF N-BC = 0
008570         IF W-DTH = 0                                             I.120924
008580             MOVE 1 TO W-DTH.                                     I.120924
008590     IF N-BC NOT = 0                                              I.120924
008600         MOVE 1 TO W-KDC                                          I.120924
008610         IF W-DTK = 0                                             I.120924
008620             MOVE 1 TO W-DTK.                                     I.120924
008630     GO TO KDC-010.
008640*****MOVE 1 TO W-KDC.                                             D.120924
008650 KDC-020.
008660     CLOSE NYU-F.
008670     IF W-KDC NOT = 0
008680         PERFORM KKB1-RTN THRU KKB1-EX.
008690 KDC-EX.
008700     EXIT.
008710*-------------  ＫＫＢＭ　チェック　--------------------------------------
008720 KKB1-RTN.
008730     OPEN I-O KKB-M.
008740     MOVE SPACE TO KKB-KEY.
008750     MOVE 90 TO KKB-NO.
008760     READ KKB-M INVALID KEY
008770         DISPLAY E-ME78 E-ME7 E-ME99
008780         MOVE 9 TO W-END
008790         GO TO KKB1-020.
008800     IF KKB-SC15 = 1
008810         DISPLAY D-SME15 E-ME99
008820         MOVE 9 TO W-END
008830         GO TO KKB1-020.
008840     IF KKB-SC13 = 1
008850         DISPLAY D-SME13 E-ME99
008860         MOVE 9 TO W-END
008870         GO TO KKB1-020.
008880     IF KKB-SC04 = 1
008890         DISPLAY D-SME04 E-ME99
008900         MOVE 9 TO W-END
008910         GO TO KKB1-020.
008920     MOVE 1 TO KKB-SC04.
008930     REWRITE KKB-R INVALID KEY
008940         DISPLAY E-ME78 E-STAT E-ME8 E-ME99
008950         MOVE 9 TO W-END.
008960 KKB1-020.
008970     CLOSE KKB-M.
008980 KKB1-EX.
008990     EXIT.
009000*-------------  見出し　印字　--------------------------------------------
009010 MID-RTN.
009020     MOVE SPACE TO SP-R.
009030     MOVE HEAD1 TO SP-R.
009040     WRITE SP-R.                                                  I.081023
009050*****WRITE SP-R AFTER 2.                                          D.081023
009060     MOVE SPACE TO SP-R.
009070     MOVE HEAD2 TO SP-R.
009080     WRITE SP-R AFTER 2.                                          I.081023
009090     MOVE SPACE TO SP-R.                                          I.081023
009100     MOVE HEAD3 TO SP-R.                                          I.081023
009110     WRITE SP-R.                                                  I.081023
009120     MOVE SPACE TO SP-R.                                          I.081023
009130     MOVE HEAD4 TO SP-R.                                          I.081023
009140     WRITE SP-R AFTER 3.
009150     MOVE SPACE TO SP-R.
009160     MOVE HEAD5 TO SP-R.
009170     WRITE SP-R AFTER 2.                                          I.081023
009180     MOVE SPACE TO SP-R.                                          I.081023
009190     MOVE HEAD6 TO SP-R.                                          I.081023
009200     WRITE SP-R AFTER 3.
009210     MOVE SPACE TO SP-R.
009220*****WRITE SP-R AFTER 2.                                          D.081023
009230 MID-EX.
009240     EXIT.
009250*-------------　合計　印字　----------------------------------------------
009260 KEI-RTN.
009270     IF CNT > 7
009280         MOVE 2 TO W-KG
009290       ELSE
009300         COMPUTE W-KG = 18 - (CNT * 2).
009310*****MOVE SPACE TO W-PM.                                          D.081023
009320*****MOVE SPACE TO P-NC P-NCM P-TDN P-TDG P-TDP P-SSN P-SSG.      D.081023
009330*****MOVE W-AKIN TO W-KINZ.                                       D.081023
009340*****MOVE W-KINZ TO P-KIN.                                        D.081023
009350*****MOVE W-PM TO SP-R.                                           D.081023
009360     MOVE SPACE TO SP-R.                                          I.081023
009370     MOVE HEAD8 TO SP-R.                                          I.081023
009380     WRITE SP-R AFTER W-KG.
009390     MOVE SPACE TO SP-R.
009400     MOVE SPACE TO W-PT.
009410     MOVE W-TKIN TO W-KINZ.
009420     MOVE W-KINZ TO P-TKIN.
009430     MOVE W-SHZ TO W-KINZ.                                        I.081023
009440     MOVE W-KINZ TO P-SHZ.                                        I.081023
009450     MOVE W-AKIN TO W-KINZ.                                       I.081023
009460     MOVE W-KINZ TO P-AKIN.                                       I.081023
009470*****MOVE W-SHZ TO W-SHZZ.                                        D.081023
009480*****MOVE W-SHZZ TO P-SHZ.                                        D.081023
009490     MOVE W-PT TO SP-R.
009500     WRITE SP-R AFTER 2.
009510     MOVE SPACE TO SP-R.
009520*****MOVE SPACE TO W-PT.                                          D.070126
009530*
009540*****IF JS-SIGN = 1                                               D.070126
009550*****    MOVE NW-UZ TO W-KINZ                                     D.010323
009560*****    MOVE W-UZ TO W-KINZ                                      D.070126
009570*****    MOVE W-KINZ TO P-TKIN                                    D.070126
009580*****    MOVE NW-UZZ TO W-SHZZ                                    D.010323
009590*****    MOVE W-UZZ TO W-SHZZ                                     D.070126
009600*****    MOVE W-SHZZ TO P-SHZ                                     D.070126
009610*****    GO TO KEI-060.                                           D.070126
009620*****IF W-BC NOT = 0                                              D.000221
009630*****    GO TO KEI-020.                                           D.000221
009640*****SUBTRACT W-TKIN FROM HT-TUZ.                                 D.000221
009650*****SUBTRACT W-SHZ FROM HT-TUZZ.                                 D.000221
009660*****ADD W-TKIN TO HT-TNK HT-SNK.                                 D.000221
009670*****ADD W-SHZ TO HT-TNKZ HT-SNKZ.                                D.000221
009680*****REWRITE HT-R INVALID KEY                                     D.000221
009690*****SUBTRACT W-TKIN FROM TT-TUZ.                                 D.070126
009700*****SUBTRACT W-SHZ FROM TT-TUZZ.                                 D.070126
009710*****ADD W-TKIN TO TT-TNK TT-SNK.                                 D.001123
009720*****ADD W-SHZ TO TT-TNKZ TT-SNKZ.                                D.001123
009730*****ADD W-TKIN TO TT-TNK.                                        D.070126
009740*****ADD W-SHZ TO TT-TNKZ.                                        D.070126
009750*****REWRITE TT-R INVALID KEY                                     D.070126
009760*****    MOVE 9 TO W-END                                          D.070126
009770*****    DISPLAY E-ME78 E-STAT E-ME5 E-TCD E-ME99                 D.070126
009780*****    GO TO KEI-EX.                                            D.070126
009790*****MOVE HT-TUZ TO W-KINZ N-UZ.                                  D.000221
009800*****MOVE TT-TUZ TO W-KINZ N-UZ.                                  D.070126
009810*****MOVE W-KINZ TO P-TKIN.                                       D.070126
009820*****MOVE TT-TUZZ TO W-SHZZ N-UZZ.                                D.070126
009830*****MOVE HT-TUZZ TO W-SHZZ N-UZZ.                                D.000221
009840*****MOVE W-SHZZ TO P-SHZ.                                        D.070126
009850*****GO TO KEI-040.                                               D.000221
009860*KEI-020.                                                         D.000221
009870*****SUBTRACT W-TKIN FROM KT-TUZ.                                 D.000221
009880*****SUBTRACT W-SHZ FROM KT-TUZZ.                                 D.000221
009890*****ADD W-TKIN TO KT-TNK KT-SNK.                                 D.000221
009900*****ADD W-SHZ TO KT-TNKZ KT-SNKZ.                                D.000221
009910*****REWRITE KT-R INVALID KEY                                     D.000221
009920*****    MOVE 9 TO W-END                                          D.000221
009930*****    DISPLAY E-ME78 E-STAT E-ME6 E-TCD E-ME99                 D.000221
009940*****    GO TO KEI-EX.                                            D.000221
009950*****MOVE KT-TUZ TO W-KINZ N-UZ.                                  D.000221
009960*****MOVE W-KINZ TO P-TKIN.                                       D.000221
009970*****MOVE KT-TUZZ TO W-SHZZ N-UZZ.                                D.000221
009980*****MOVE W-SHZZ TO P-SHZ.                                        D.000221
009990*KEI-040.                                                         D.000221
010000*****REWRITE NYU-R INVALID KEY                                    D.070126
010010*****    MOVE 9 TO W-END                                          D.070126
010020*****    DISPLAY E-STAT E-ME14 E-KEY E-ME99                       D.070126
010030*****    GO TO KEI-EX.                                            D.070126
010040*KEI-060.                                                         D.070126
010050*****MOVE W-PT TO SP-R.                                           D.070126
010060*****WRITE SP-R AFTER 2.                                          D.070126
010070*****MOVE SPACE TO SP-R.                                          D.070126
010080*****MOVE SPACE TO W-P7.                                          D.081023
010090*****IF W-SKD NOT = ZERO                                          D.081023
010100*****    MOVE W-SKD TO P-SKD.                                     D.081023
010110*****MOVE W-P7 TO SP-R.                                           D.081023
010120*****WRITE SP-R AFTER 4.                                          D.081023
010130*****WRITE SP-R AFTER 2.                                          D.070126
010140     MOVE SPACE TO SP-R.                                          I.010321
010150     MOVE HEAD9 TO SP-R                                           I.081023
010160     WRITE SP-R AFTER 2.                                          I.010321
010170     MOVE SPACE TO SP-R.                                          I.081023
010180     WRITE SP-R AFTER 2.                                          I.081023
010190*****WRITE SP-R AFTER 4.                                          D.010321
010200 KEI-EX.
010210     EXIT.
010220*-------------  ＫＫＢＭ　開放　------------------------------------------
010230 KKB2-RTN.
010240     OPEN I-O KKB-M.
010250     MOVE SPACE TO KKB-KEY.
010260     MOVE 90 TO KKB-NO.
010270     READ KKB-M INVALID KEY
010280         DISPLAY E-ME78 E-ME7 E-ME99
010290         CLOSE KKB-M
010300         GO TO KKB2-EX.
010310     MOVE 0 TO KKB-SC04.
010320     REWRITE KKB-R INVALID KEY
010330         DISPLAY E-ME78 E-STAT E-ME8 E-ME99
010340         DISPLAY E-ME90 E-ME99.
010350     CLOSE KKB-M.
010360 KKB2-EX.
010370     EXIT.
010380 PRI-RTN.
010390     IF NW-NC = "60"
010400         GO TO PRI-010.
010410     MOVE SPACE TO HKB-KEY.
010420     MOVE "31" TO HKB-NO.
010430     MOVE NW-NC1 TO HKB-NKC1.
010440     READ HKBM WITH UNLOCK INVALID KEY
010450         MOVE SPACE TO HKB-NKNA.
010460     GO TO PRI-020.
010470 PRI-010.
010480     MOVE SPACE TO HKB-KEY.
010490     MOVE "32" TO HKB-NO.
010500     MOVE NW-NSC TO HKB-NSC.
010510     READ HKBM WITH UNLOCK INVALID KEY
010520         MOVE SPACE TO HKB-NSNA.
010530 PRI-020.
010540     MOVE SPACE TO W-PM.
010550     MOVE SPACE TO P-NCM P-TDN P-TDG P-TDP P-KIN P-SSN P-SSG.     I.081023
010560     MOVE "(" TO P-NF.                                            I.081023
010570     MOVE ")" TO P-NR.                                            I.081023
010580     MOVE NW-NC TO P-NC.
010590     IF NW-NC2 = 8
010600         MOVE NC"消　費　税　" TO P-NCM
010610       ELSE
010620         IF NW-NC = "60"
010630             MOVE HKB-NSNA TO P-NCM
010640           ELSE
010650             MOVE HKB-NKNA TO P-NCM.
010660     IF NW-TD NOT = ZERO
010670         MOVE NW-TDG TO W-TDGZ
010680         MOVE NW-TDP TO W-TDPZ
010690         MOVE "/" TO P-TDV1 P-TDV2
010700         MOVE NW-TDN TO P-TDN
010710         MOVE W-TDGZ TO P-TDG
010720         MOVE W-TDPZ TO P-TDP.
010730     MOVE NW-KIN TO W-KINZ.
010740     MOVE W-KINZ TO P-KIN.
010750     IF NW-SS NOT = ZERO
010760         MOVE NW-SSG TO W-SSGZ
010770         MOVE "/" TO P-SSV
010780         MOVE NW-SSN TO P-SSN
010790         MOVE W-SSGZ TO P-SSG.
010800     IF NW-FNO NOT = ZERO
010810         MOVE "(" TO P-FF
010820         MOVE ")" TO P-FR
010830         MOVE NW-FNO TO P-FNO.
010840     MOVE SPACE TO SP-R.
010850     MOVE W-PM TO SP-R.
010860     WRITE SP-R AFTER 2.
010870     MOVE SPACE TO SP-R.
010880*
010890     ADD NW-KIN TO W-AKIN.
010900     IF NW-NC2 > 7
010910         ADD NW-KIN TO W-SHZ
010920       ELSE
010930         ADD NW-KIN TO W-TKIN.
010940 PRI-EX.
010950     EXIT.
