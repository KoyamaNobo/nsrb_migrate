000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD210.
000030*********************************************************
000040*    PROGRAM         :  履物売上・値引入力              *
000050*    SCREEN          :  SCHD01,SCHD11                   *
000060*    COMPILE TYPE    :  COBOL                           *
000070*********************************************************
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.
000150     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE RANDOM
000180         RECORD KEY T-KEY
000190         ALTERNATE RECORD KEY T-KEY2.
000200*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000210     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY HI-KEY                                        I.010802
000250         ALTERNATE RECORD KEY HI-KEY2.                            I.010802
000260*****    RECORD KEY HI-KEY.                                       D.010802
000270*****SELECT TAZ-M ASSIGN TO TAZ-MSD                               D.070124
000280*****    ACCESS MODE RANDOM                                       D.070124
000290*****    ORGANIZATION INDEXED                                     D.070124
000300*****    RECORD KEY TAZ-KEY                                       D.070124
000310*****    FILE STATUS IS ERR-STAT.                                 D.070124
000320     SELECT TC-M ASSIGN TO TC-MSD
000330         ORGANIZATION INDEXED
000340         ACCESS MODE RANDOM
000350         RECORD KEY TC-KEY.
000360     SELECT S-TRAN ASSIGN TO S-MSD
000370         FILE STATUS IS ERR-STAT.
000380     SELECT JCON ASSIGN TO F4-MSD
000390         ORGANIZATION INDEXED
000400         ACCESS MODE RANDOM
000410         RECORD KEY JCON3-KEY
000420         FILE STATUS IS ERR-STAT.
000430*****SELECT JT-THTN ASSIGN TO F5-MSD                              D.010419
000440     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD                      I.010419
000450         ORGANIZATION INDEXED
000460         ACCESS MODE RANDOM
000470         RECORD KEY THT-KEY                                       I.010419
000480         ALTERNATE RECORD KEY THT-KEY2                            I.010419
000490*****    RECORD KEY THTN-KEY                                      D.010419
000500         FILE STATUS IS ERR-STAT.
000510     SELECT OTHTM ASSIGN TO OTHT1-MSD OTHT2-MSD                   I.110407
000520         ORGANIZATION INDEXED                                     I.110407
000530         ACCESS MODE RANDOM                                       I.110407
000540         RECORD KEY OTHT-KEY                                      I.110407
000550         ALTERNATE RECORD KEY OTHT-KEY2                           I.110407
000560         FILE STATUS IS ERR-STAT.                                 I.110407
000570     SELECT HSMSF ASSIGN TO HSMS-MSD
000580         ORGANIZATION INDEXED
000590         ACCESS MODE DYNAMIC
000600         RECORD KEY HSMS-KEY
000610         FILE STATUS IS ERR-STAT.
000620     SELECT HKBM  ASSIGN TO HKB-MSD
000630         ORGANIZATION INDEXED
000640         ACCESS MODE RANDOM
000650         RECORD KEY HKB-KEY
000660         FILE STATUS IS ERR-STAT.
000670     SELECT TSKF  ASSIGN TO TSK-MSD                               I.000922
000680         ORGANIZATION INDEXED                                     I.000922
000690         ACCESS MODE RANDOM                                       I.000922
000700         RECORD KEY TSK-KEY                                       I.000922
000710         FILE STATUS IS ERR-STAT.                                 I.000922
000720     SELECT HUH-M ASSIGN TO HUH-MSD                               I.020215
000730         ORGANIZATION INDEXED                                     I.020215
000740         ACCESS MODE RANDOM                                       I.020215
000750         RECORD KEY HUH-KEY                                       I.020215
000760         FILE STATUS IS ERR-STAT.                                 I.020215
000770 I-O-CONTROL.
000780     APPLY SHARED-MODE ON T-M
000790     APPLY SHARED-MODE ON JCON
000800*****APPLY SHARED-MODE ON JT-THTN                                 D.010419
000810     APPLY SHARED-MODE ON THTM                                    I.010419
000820     APPLY SHARED-MODE ON OTHTM                                   I.110407
000830     APPLY SHARED-MODE ON HI-M
000840*****APPLY SHARED-MODE ON TAZ-M                                   D.070124
000850     APPLY SHARED-MODE ON TC-M
000860     APPLY SHARED-MODE ON HSMSF
000870     APPLY SHARED-MODE ON HKBM
000880     APPLY SHARED-MODE ON TSKF                                    I.000922
000890     APPLY SHARED-MODE ON HUH-M                                   I.020215
000900     APPLY SHARED-MODE ON M-DATE.
000910 DATA DIVISION.
000920 FILE SECTION.
000930     COPY LIBFDD.
000940     COPY LITM.
000950     COPY LIHIM.
000960     COPY LITCM.
000970     COPY LIHSMS.
000980     COPY LIHKBM.
000990*****COPY LTHTN.                                                  D.010419
001000     COPY LITHTM.                                                 I.010419
001010     COPY LIOTHT.                                                 I.110407
001020     COPY L-JCON.
001030     COPY LITSKF.                                                 I.000922
001040     COPY LIHUHM.                                                 I.020215
001050*FD  TAZ-M                                                        D.070124
001060*****BLOCK  8 RECORDS                                             D.020821
001070*****BLOCK  6 RECORDS                                             D.070124
001080*****LABEL RECORD IS STANDARD                                     D.070124
001090*****VALUE OF IDENTIFICATION "TAZM".                              D.070124
001100*01  TAZ-R.                                                       D.070124
001110*****02  TAZ-KEY.                                                 D.070124
001120*****  03  TAZ-TCD      PIC  9(004).                              D.070124
001130*****  03  TAZ-HCD      PIC  9(006).                              D.070124
001140*****02  TAZ-ZS         PIC S9(005).                              D.020821
001150*****02  TAZ-AS         PIC S9(005).                              D.020821
001160*****02  F              PIC  X(006).                              D.020821
001170*****02  F              PIC  X(026).                              D.070124
001180*****02  TAZ-NG         PIC  9(006).                              D.070124
001190 FD  S-TRAN
001200     BLOCK  2 RECORDS
001210     LABEL RECORD IS STANDARD
001220     VALUE OF IDENTIFICATION "STRAN".
001230 01  S-R.
001240     02  S-DNO          PIC  9(006).
001250     02  S-GNO          PIC  9(001).
001260     02  S-DATE         PIC  9(008).
001270     02  S-TCD          PIC  9(004).
001280     02  F              PIC  X(107).
001290     02  S-DHC          PIC  9(001).
001300     02  S-SNC          PIC  9(001).
001310 WORKING-STORAGE SECTION.
001320 77  W-FILE             PIC  X(013).
001330 77  W-END              PIC  9(001) VALUE 0.
001340 77  CHK                PIC  9(001) VALUE 0.
001350 77  W-INV              PIC  9(001) VALUE 0.
001360 77  W-ADV              PIC  9(001) VALUE 0.
001370 01  ERR-STAT           PIC  X(002).
001380 01  W-SR.
001390     02  W-DNO          PIC  9(006).
001400     02  W-GNO          PIC  9(001).
001410     02  W-DATE         PIC  9(008).
001420     02  W-TCD          PIC  9(004).
001430     02  W-DT1          PIC  X(107).
001440     02  W-DT2   REDEFINES W-DT1.
001450       03  W-ZD1.
001460         04  W-HCD      PIC  9(006).
001470         04  W-SIZ      PIC  9(001).
001480         04  W-SUS.
001490           05  W-SUSD  OCCURS  10.
001500             06  W-SU   PIC S9(004)  COMP-3.
001510         04  W-SUT      PIC S9(005).
001520         04  W-BT       PIC S9(005).
001530       03  W-KIN        PIC S9(008).
001540       03  W-CSC        PIC  9(001).
001550       03  W-DC         PIC  9(001).
001560       03  W-FT         PIC  9(005).
001570       03  W-CCD        PIC  9(003).
001580       03  W-ZD2.
001590         04  W-BC1      PIC  9(002).
001600         04  W-BC2.
001610           05  W-BC21   PIC  9(001).
001620           05  W-BC22   PIC  9(001).
001630         04  W-BC3      PIC  9(002).
001640         04  W-SOK      PIC  9(001).
001650       03  W-TC2        PIC  9(002).
001660       03  W-FKC        PIC  9(002).
001670       03  W-HSC        PIC  9(001).
001680       03  W-KOSU       PIC  9(003).
001690       03  W-FRC        PIC  9(001).
001700       03  W-TCD2       PIC  9(004).
001710       03  W-BIK        PIC  X(010).
001720       03  W-SDT        PIC  9(008).
001730       03  W-BMC        PIC  9(002).                              I.020517
001740       03  W-BMNO       PIC  9(001).                              I.020517
001750       03  W-USC        PIC  9(001).                              I.040324
001760*****  03  F            PIC  X(001).                              D.040324
001770*****  03  F            PIC  X(004).                              D.020517
001780     02  W-DHC          PIC  9(001).
001790     02  W-UNC          PIC  9(001).
001800 01  W-ASR.
001810     02  W-AS    OCCURS   6  PIC  X(128).
001820 01  W-BR.
001830     02  W-BI           PIC  N(024).
001840     02  W-HANO         PIC  9(006).                              I.081222
001850     02  F              PIC  X(030).                              I.081222
001860*****02  W-HANO.                                                  D.081222
001870*****  03  W-HA    OCCURS   6  PIC  9(006).                       D.081222
001880     02  W-TAX          PIC S9(007).
001890     02  W-UZZ          PIC S9(007).
001900     02  W-UZ           PIC S9(009).
001910 01  W-ASD.
001920     02  W-SD    OCCURS  10  PIC  9(001).
001930 01  W-DATA.
001940     02  W-L.
001950       03  W-L1         PIC  9(002).
001960       03  W-L2         PIC  9(002).
001970       03  W-L3         PIC  9(002).
001980     02  W-C            PIC S9(002).
001990     02  W-GSUT         PIC S9(006).
002000     02  W-UNCD         PIC  9(001).
002010     02  W-RC           PIC  9(001).
002020     02  W-SC           PIC  9(002).
002030     02  W-DMM          PIC  9(001).
002040     02  W-DNOD         PIC  9(006).
002050     02  W-DNOO         PIC  9(006).
002060     02  W-NGP          PIC  9(008).
002070     02  W-NGPD  REDEFINES W-NGP.
002080       03  W-NGD.
002090         04  W-ND       PIC  9(004).
002100         04  W-NDD   REDEFINES W-ND.
002110           05  W-ND1    PIC  9(002).
002120           05  W-ND2    PIC  9(002).
002130         04  W-GD       PIC  9(002).
002140       03  W-PD         PIC  9(002).
002150     02  W-NGPSD REDEFINES W-NGP.
002160       03  F            PIC  9(002).
002170       03  W-NGPS       PIC  9(006).
002180     02  W-TCDD         PIC  9(004).
002190     02  W-TCDN         PIC  9(004).
002200     02  W-CCDD         PIC  9(003).
002210     02  W-HCDD         PIC  9(006).
002220     02  W-HCDO         PIC  9(006).                              I.010419
002230     02  W-CSCD         PIC  9(001).
002240     02  W-HNOD         PIC  9(006).                              I.081222
002250*****02  W-HNOD.                                                  D.081222
002260*****  03  W-HN1        PIC  9(006).                              D.081222
002270*****  03  W-HN2        PIC  9(006).                              D.081222
002280*****  03  W-HN3        PIC  9(006).                              D.081222
002290*****  03  W-HN4        PIC  9(006).                              D.081222
002300*****  03  W-HN5        PIC  9(006).                              D.081222
002310*****  03  W-HN6        PIC  9(006).                              D.081222
002320     02  W-DCD          PIC  9(001).
002330     02  W-DCC          PIC  9(001).
002340     02  W-ZC           PIC  9(001).
002350*****02  W-CNA          PIC  N(024).                              D.020425
002360     02  W-CNG.
002370       03  W-CN         PIC  9(004).
002380       03  W-CND   REDEFINES W-CN.
002390         04  W-CN1      PIC  9(002).
002400         04  W-CN2      PIC  9(002).
002410       03  W-CG         PIC  9(002).
002420     02  W-SNGD  REDEFINES W-CNG.
002430       03  F            PIC  9(002).
002440       03  W-CNGS       PIC  9(004).
002450     02  W-HSCD         PIC  9(001).
002460     02  W-HNC          PIC  9(001).
002470     02  W-HNCD         PIC  9(001).
002480     02  W-SCD          PIC  9(001).
002490     02  W-KOSUR        PIC  9(003).
002500     02  WK-TAN         PIC S9(005).
002510     02  W-FRCD         PIC  9(001).
002520     02  W-DTW1         PIC  9(003).
002530     02  W-DTW2         PIC  9(001).
002540     02  W-SDTD         PIC  9(008).
002550     02  W-SDTM  REDEFINES W-SDTD.
002560       03  W-SDTNG.
002570         04  W-SDTN     PIC  9(004).
002580         04  W-SDTG     PIC  9(002).
002590       03  W-SDTP       PIC  9(002).
002600     02  W-HMN          PIC  9(006).
002610     02  WK-SCD         PIC  9(001).
002620     02  WK-DC          PIC  9(001).
002630     02  WK-BI          PIC  N(024).
002640     02  W-EC           PIC  9(001).
002650     02  W-DEL          PIC  9(001).
002660     02  W-RCD          PIC  9(001).
002670     02  CNT            PIC  9(001).
002680     02  W-HC           PIC  9(001).                              I.011012
002690     02  W-LD           PIC  9(006).                              I.020404
002700     02  W-RCB          PIC  9(001).                              I.020404
002710     02  W-LB           PIC  9(006).                              I.020404
002720     02  W-DSPC         PIC  9(001).                              I.020404
002730*****02  W-LD.                                                    D.020404
002740*****  03  W-L1D        PIC  9(002).                              D.020404
002750*****  03  W-L2D        PIC  9(002).                              D.020404
002760*****  03  W-L3D        PIC  9(002).                              D.020404
002770*****02  W-CSN          PIC  N(003).                              D.020405
002780     02  W-DKIN         PIC S9(008).
002790     02  W-SDATE        PIC  9(008).                              I.000922
002800     02  W-HIC          PIC  9(001).                              I.020214
002810     02  W-FTD          PIC  9(005).                              I.020215
002820     02  W-TCHK         PIC  9(001).                              I.110407
002830     COPY LSTAT.
002840 SCREEN SECTION.
002850 SD  C-CRT
002860     END STATUS IS ESTAT.
002870 01  C-CLEAR.
002880     02  LINE   1  CLEAR SCREEN.
002890 01  C-MID.
002900     02  LINE   3  COLUMN  15  PIC  N(022) VALUE
002910          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002920     02  LINE   4  COLUMN  15  PIC  N(022) VALUE
002930          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002940     02  LINE   5  COLUMN  15  PIC  N(022) VALUE
002950          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
002960     02  LINE   6  COLUMN  15  PIC  N(022) VALUE
002970          NC"＊＊＊　　履物売上・値引伝票　入力　　＊＊＊".
002980     02  LINE   7  COLUMN  15  PIC  N(022) VALUE
002990          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003000     02  LINE   8  COLUMN  15  PIC  N(022) VALUE
003010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003020     02  LINE   9  COLUMN  15  PIC  N(022) VALUE
003030          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003040     02  LINE  15  COLUMN  26  PIC  X(022) VALUE
003050          "売上=0 , 値引=1   ﾘﾀｰﾝ".
003060 01  C-ACP.
003070     02  A-UNC   LINE  15  COLUMN  43  PIC  9(001)
003080          USING W-UNCD  CHECK OVERFLOW NO IFC.
003090*
003100     02  LINE   1.
003110       03  AU-NGP   COLUMN  16  PIC  9(006)
003120            USING W-NGPS  CHECK OVERFLOW NO IFC.
003130       03  AU-HMN   COLUMN  30  PIC  9(006)
003140            USING W-HMN   CHECK OVERFLOW NO IFC.
003150       03  AU-SOK   COLUMN  42  PIC  9(001)
003160            USING W-SCD   CHECK OVERFLOW NO IFC.
003170*****  03  AU-HN1   COLUMN  68  PIC  9(006)                       D.081222
003180*****       USING W-HN1   CHECK OVERFLOW NO IFC.                  D.081222
003190*****  03  AU-HN2   COLUMN  75  PIC  9(006)                       D.081222
003200*****       USING W-HN2   CHECK OVERFLOW NO IFC.                  D.081222
003210     02  LINE   2.
003220*****  03  AU-TCD   COLUMN   8  PIC  9(004)                       D.020405
003230       03  AU-TCD   COLUMN   6  PIC  9(004)                       I.020405
003240            USING W-TCDD  CHECK OVERFLOW NO IFC.
003250*****  03  AU-HN3   COLUMN  68  PIC  9(006)                       D.081222
003260*****       USING W-HN3   CHECK OVERFLOW NO IFC.                  D.081222
003270*****  03  AU-HN4   COLUMN  75  PIC  9(006)                       D.081222
003280*****       USING W-HN4   CHECK OVERFLOW NO IFC.                  D.081222
003290     02  LINE   3.
003300*****  03  AU-CCD   COLUMN   8  PIC  9(003)                       D.020405
003310       03  AU-CCD   COLUMN   6  PIC  9(003)                       I.020405
003320            USING W-CCDD  CHECK OVERFLOW NO IFC.
003330*****  03  AU-CSC   COLUMN  64  PIC  9(001)                       D.020405
003340       03  AU-CSC   COLUMN  65  PIC  9(001)                       I.020405
003350            USING W-CSCD  CHECK OVERFLOW NO IFC.
003360*****  03  AU-HN5   COLUMN  68  PIC  9(006)                       D.081222
003370*****       USING W-HN5   CHECK OVERFLOW NO IFC.                  D.081222
003380*****  03  AU-HN6   COLUMN  75  PIC  9(006)                       D.081222
003390*****       USING W-HN6   CHECK OVERFLOW NO IFC.                  D.081222
003400     02  LINE W-L1.
003410       03  AU-DC    COLUMN   4  PIC  9(001)
003420            USING W-DC    CHECK OVERFLOW NO IFC.
003430       03  AU-HCD   COLUMN  11  PIC  9(006)
003440            USING W-HCD   CHECK OVERFLOW NO IFC.
003450       03  AU-BIK   COLUMN  71  PIC  X(010)
003460            USING W-BIK   CHECK OVERFLOW NO IFC.
003470     02  LINE W-L3.
003480       03  AU-SIZ   COLUMN   1  PIC  9(001)
003490            USING W-SIZ   CHECK OVERFLOW NO IFC.
003500       03  AU-SU    COLUMN W-C  PIC S9(004)
003510            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003520       03  AU-SU1   COLUMN W-C  PIC S9(003)
003530            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003540       03  AU-SUT   COLUMN  60  PIC S9(005)
003550            USING W-SUT   CHECK OVERFLOW NO IFC.
003560       03  AU-BT    COLUMN  67  PIC  9(005)
003570            USING W-BT    CHECK OVERFLOW NO IFC.
003580       03  AU-KIN   COLUMN  73  PIC S9(007)
003590            USING W-KIN   CHECK OVERFLOW NO IFC.
003600     02  AU-BI    LINE  22  COLUMN   6  PIC  N(024)
003610          USING W-BI    CHECK OVERFLOW NO IFC.
003620     02  LINE  23.
003630       03  AU-KOSU  COLUMN   6  PIC  9(003)
003640            USING W-KOSUR CHECK OVERFLOW NO IFC.
003650       03  AU-HSC   COLUMN  17  PIC  9(001)
003660            USING W-HSCD  CHECK OVERFLOW NO IFC.
003670       03  AU-FRC   COLUMN  24  PIC  9(001)
003680            USING W-FRCD  CHECK OVERFLOW NO IFC.
003690       03  AU-SDT   COLUMN  33  PIC  9(008)
003700            USING W-SDTD  CHECK OVERFLOW NO IFC.
003710       03  AU-DMM   COLUMN  63  PIC  9(001)
003720            USING W-DMM   CHECK OVERFLOW NO IFC.
003730*
003740     02  AN-NGP   LINE   4  COLUMN   8  PIC  9(006)
003750          USING W-NGPS  CHECK OVERFLOW NO IFC.
003760     02  AN-TCD   LINE   5  COLUMN   8  PIC  9(004)
003770          USING W-TCDD  CHECK OVERFLOW NO IFC.
003780*****02  AN-CSC   LINE   5  COLUMN  71  PIC  9(001)               D.020405
003790     02  AN-CSC   LINE   5  COLUMN  75  PIC  9(001)               I.020405
003800          USING W-CSCD  CHECK OVERFLOW NO IFC.
003810     02  LINE W-L1.
003820       03  AN-HCD   COLUMN  01  PIC  9(006)
003830            USING W-HCD  CHECK OVERFLOW NO IFC.
003840       03  AN-SUT   COLUMN  58  PIC S9(005)
003850            USING W-SUT  CHECK OVERFLOW NO IFC.
003860       03  AN-BT    COLUMN  65  PIC S9(004)
003870            USING W-BT   CHECK OVERFLOW NO IFC.
003880       03  AN-KIN   COLUMN  71  PIC S9(008)
003890            USING W-KIN   CHECK OVERFLOW NO IFC.
003900     02  AN-BI    LINE  15  COLUMN  08  PIC  N(024)
003910          USING W-BI    CHECK OVERFLOW NO IFC.
003920     02  AN-HSC   LINE  16  COLUMN  12  PIC  9(001)
003930          USING W-HSCD  CHECK OVERFLOW NO IFC.
003940     02  AN-SDT   LINE  17  COLUMN   8  PIC  9(008)
003950            USING W-SDTD  CHECK OVERFLOW NO IFC.
003960     02  AN-DMM   LINE  20  COLUMN  46  PIC  9(001)
003970          USING W-DMM   CHECK OVERFLOW NO IFC.
003980*
003990     02  A-CHK   LINE  24  COLUMN  55  PIC  9(001)
004000          USING CHK     CHECK OVERFLOW NO IFC.
004010 01  C-DSP.
004020     02  DU-SNA   LINE   1  COLUMN  44  PIC  N(006) FROM
004030          JCON3-03.
004040     02  DU-TNA   LINE   2  COLUMN  11  PIC  N(026) FROM  T-NAME. I.020405
004050     02  DU-CNA   LINE   3  COLUMN  11  PIC  N(026) FROM  TC-NAME.I.020405
004060*****02  DU-TNA   LINE   2  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004070*****02  DU-CNA   LINE   3  COLUMN  13  PIC  N(024) FROM  TC-NAME.D.020405
004080     02  LINE W-L1.
004090       03  DU-HNA   COLUMN  18  PIC  N(024)    FROM  HI-NAME.
004100       03  DU-SZM   COLUMN  18  PIC  N(006)    VALUE
004110            NC"消費税調整分".
004120     02  LINE W-L2.
004130       03  DU-S1.
004140*****    04  COLUMN   3  PIC  X(005) VALUE "３号 ".               D.081222
004150*****    04  COLUMN   9  PIC  X(005) VALUE "２号 ".               D.081222
004160*****    04  COLUMN  15  PIC  X(005) VALUE "１号 ".               D.081222
004170*****    04  COLUMN  21  PIC  X(005) VALUE "０号 ".               D.081222
004180*****    04  COLUMN  27  PIC  X(005) VALUE " 中　".               D.081222
004190*****    04  COLUMN  33  PIC  X(005) VALUE " 大　".               D.081222
004200*****    04  COLUMN  39  PIC  X(005) VALUE "特大 ".               D.081222
004210         04  COLUMN   3  PIC  X(005) VALUE "     ".               I.081222
004220         04  COLUMN   9  PIC  X(005) VALUE "     ".               I.081222
004230         04  COLUMN  15  PIC  X(005) VALUE " SS  ".               I.081222
004240         04  COLUMN  21  PIC  X(005) VALUE "  S  ".               I.081222
004250         04  COLUMN  27  PIC  X(005) VALUE "  M  ".               I.081222
004260         04  COLUMN  33  PIC  X(005) VALUE "  L  ".               I.081222
004270         04  COLUMN  39  PIC  X(005) VALUE " LL  ".               I.081222
004280         04  COLUMN  45  PIC  X(004) VALUE "28.0".
004290         04  COLUMN  50  PIC  X(004) VALUE "29.0".
004300         04  COLUMN  55  PIC  X(004) VALUE "30.0".
004310       03  DU-S2.
004320         04  COLUMN   3  PIC  X(005) VALUE "12.5 ".
004330         04  COLUMN   9  PIC  X(005) VALUE "13.0 ".
004340         04  COLUMN  15  PIC  X(005) VALUE "13.5 ".
004350         04  COLUMN  21  PIC  X(005) VALUE "14.0 ".
004360         04  COLUMN  27  PIC  X(005) VALUE "15.0 ".
004370         04  COLUMN  33  PIC  X(005) VALUE "16.0 ".
004380         04  COLUMN  39  PIC  X(005) VALUE "17.0 ".
004390         04  COLUMN  45  PIC  X(004) VALUE "18.0".
004400         04  COLUMN  50  PIC  X(004) VALUE "19.0".
004410         04  COLUMN  55  PIC  X(004) VALUE "20.0".
004420       03  DU-S3.
004430         04  COLUMN   3  PIC  X(005) VALUE "21.0 ".
004440         04  COLUMN   9  PIC  X(005) VALUE "21.5 ".
004450         04  COLUMN  15  PIC  X(005) VALUE "22.0 ".
004460         04  COLUMN  21  PIC  X(005) VALUE "22.5 ".
004470         04  COLUMN  27  PIC  X(005) VALUE "23.0 ".
004480         04  COLUMN  33  PIC  X(005) VALUE "23.5 ".
004490         04  COLUMN  39  PIC  X(005) VALUE "24.0 ".
004500         04  COLUMN  45  PIC  X(004) VALUE "24.5".
004510         04  COLUMN  50  PIC  X(004) VALUE "25.0".
004520         04  COLUMN  55  PIC  X(004) VALUE "    ".
004530       03  DU-S4.
004540         04  COLUMN   3  PIC  X(005) VALUE "24.0 ".
004550         04  COLUMN   9  PIC  X(005) VALUE "24.5 ".
004560         04  COLUMN  15  PIC  X(005) VALUE "25.0 ".
004570         04  COLUMN  21  PIC  X(005) VALUE "25.5 ".
004580         04  COLUMN  27  PIC  X(005) VALUE "26.0 ".
004590         04  COLUMN  33  PIC  X(005) VALUE "26.5 ".
004600         04  COLUMN  39  PIC  X(005) VALUE "27.0 ".
004610         04  COLUMN  45  PIC  X(004) VALUE "27.5".
004620         04  COLUMN  50  PIC  X(004) VALUE "    ".
004630         04  COLUMN  55  PIC  X(004) VALUE "    ".
004640     02  LINE W-L3.
004650       03  DU-SU    COLUMN W-C  PIC ZZZZ-     FROM  W-SU(W-SC).
004660       03  DU-SU1   COLUMN W-C  PIC ZZZ-      FROM  W-SU(W-SC).
004670       03  DU-SUT   COLUMN  60  PIC ZZZZZ-    FROM  W-SUT.
004680       03  DU-BT    COLUMN  67  PIC ZZZZZ     FROM  W-BT.
004690       03  DU-KIN   COLUMN  73  PIC ZZZZZZZ-  FROM  W-KIN.
004700     02  LINE  22.
004710       03  DU-GSUT  COLUMN  58  PIC ZZZ,ZZZ-  FROM  W-GSUT.
004720     02  LINE  23.
004730       03  DU-KOSU  COLUMN   6  PIC ZZ9       FROM  W-KOSUR.
004740*
004750*****02  DN-TNA   LINE   5  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004760*****02  DN-CSN   LINE   5  COLUMN  73  PIC  N(003) FROM  W-CSN.  D.020405
004770     02  DN-TNA   LINE   5  COLUMN  13  PIC  N(026) FROM  T-NAME. I.020405
004780     02  LINE W-L1.
004790       03  DN-HNA   COLUMN   8  PIC  N(024)    FROM  HI-NAME.
004800       03  DN-SUT   COLUMN  57  PIC ZZZZZZ-    FROM  W-SUT.
004810       03  DN-BT    COLUMN  65  PIC ZZZZ-      FROM  W-BT.
004820       03  DN-KIN   COLUMN  71  PIC ZZZZZZZZ-  FROM  W-KIN.
004830     02  DN-DKIN.
004840       03  LINE  14  COLUMN  69  PIC ZZ,ZZZ,ZZ9-  FROM  W-DKIN.
004850 01  C-SPC.
004860     02  SU-HNO.
004870       03  LINE   1.
004880         04  SU-DATE  COLUMN  16  PIC  X(006) VALUE "      ".
004890         04  SU-HMN   COLUMN  30  PIC  X(006) VALUE "      ".
004900         04  SU-SOK   COLUMN  42  PIC  X(014) VALUE
004910              "            ".
004920         04  SU-HNM   COLUMN  56  PIC  X(010) VALUE "          ".
004930*****    04  SU-HN1   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
004940*****    04  SU-HN2   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
004950*****  03  LINE  2.                                               D.081222
004960*****    04  SU-HN3   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
004970*****    04  SU-HN4   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
004980*****  03  LINE  3.                                               D.081222
004990*****    04  SU-HN5   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
005000*****    04  SU-HN6   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
005010     02  SU-CNA   LINE   3.
005020       03  COLUMN   6  PIC  X(003) VALUE "   ".                   I.020405
005030       03  COLUMN  11  PIC  X(052) VALUE                          I.020405
005040           "                                                    ".I.020405
005050*****  03  COLUMN   8  PIC  X(003) VALUE "   ".                   D.020405
005060*****  03  COLUMN  13  PIC  X(048) VALUE                          D.020405
005070*****       "                                                ".   D.020405
005080     02  SU-D1    LINE W-L1.
005090       03  COLUMN   4  PIC  X(001) VALUE " ".
005100       03  COLUMN  11  PIC  X(006) VALUE "     ".
005110       03  COLUMN  18  PIC  X(048) VALUE
005120            "                                                ".
005130       03  SU-BIK   COLUMN  71  PIC  X(010) VALUE "          ".
005140     02  SU-D2    LINE W-L2.
005150       03  COLUMN   3  PIC  X(005) VALUE "     ".
005160       03  COLUMN   9  PIC  X(005) VALUE "     ".
005170       03  COLUMN  15  PIC  X(005) VALUE "     ".
005180       03  COLUMN  21  PIC  X(005) VALUE "     ".
005190       03  COLUMN  27  PIC  X(005) VALUE "     ".
005200       03  COLUMN  33  PIC  X(005) VALUE "     ".
005210       03  COLUMN  39  PIC  X(005) VALUE "     ".
005220       03  COLUMN  45  PIC  X(004) VALUE "    ".
005230       03  COLUMN  50  PIC  X(004) VALUE "    ".
005240       03  COLUMN  55  PIC  X(004) VALUE "    ".
005250     02  SU-D3    LINE W-L3.
005260       03  SU-D31.
005270         04  COLUMN   1  PIC  X(001) VALUE " ".
005280         04  COLUMN   3  PIC  X(005) VALUE "     ".
005290         04  COLUMN   9  PIC  X(005) VALUE "     ".
005300         04  COLUMN  15  PIC  X(005) VALUE "     ".
005310         04  COLUMN  21  PIC  X(005) VALUE "     ".
005320         04  COLUMN  27  PIC  X(005) VALUE "     ".
005330         04  COLUMN  33  PIC  X(005) VALUE "     ".
005340         04  COLUMN  39  PIC  X(005) VALUE "     ".
005350         04  COLUMN  45  PIC  X(004) VALUE "    ".
005360         04  COLUMN  50  PIC  X(004) VALUE "    ".
005370         04  COLUMN  55  PIC  X(004) VALUE "    ".
005380       03          COLUMN  60  PIC  X(006) VALUE "      ".
005390       03  SU-BT    COLUMN  67  PIC  X(005) VALUE "     ".
005400       03  SU-KIN   COLUMN  73  PIC  X(008) VALUE "        ".
005410     02  LINE  23.
005420       03  SU-KOSU  COLUMN   6  PIC  X(003) VALUE "   ".
005430       03  SU-HSC   COLUMN  17  PIC  X(001) VALUE " ".
005440       03  SU-FRC   COLUMN  24  PIC  X(001) VALUE " ".
005450*
005460     02  SN-DS    LINE W-L1.
005470       03  COLUMN  01  PIC  X(006) VALUE "      ".
005480       03  COLUMN   8  PIC  X(048) VALUE
005490            "                                                ".
005500       03  COLUMN  57  PIC  X(007) VALUE "       ".
005510       03  COLUMN  65  PIC  X(005) VALUE "     ".
005520       03  COLUMN  71  PIC  X(009) VALUE "         ".
005530 01  C-ERR.
005540     02  LINE  24.
005550       03  E-ME1   COLUMN  15  PIC  X(015) VALUE
005560            "***  TM ﾅｼ  ***".
005570       03  E-ME2   COLUMN  15  PIC  X(016) VALUE
005580            "***  TCM ﾅｼ  ***".
005590       03  E-ME3   COLUMN  15  PIC  X(021) VALUE
005600            "***  PROGRAM ｴﾗｰ  ***".
005610       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
005620            "***  区分エラー  ***".
005630       03  E-ME5   COLUMN  15  PIC  X(020) VALUE
005640            "***  直送エラー ***".
005650       03  E-ME6.                                                 I.020214
005660         04  COLUMN  15  PIC  X(016) VALUE                        I.020214
005670              "***  HIM ﾅｼ  ***".                                 I.020214
005680         04  COLUMN  34  PIC  9(006) FROM  W-HCD.                 I.020214
005690       03  E-ME7.                                                 I.020214
005700         04  COLUMN  15  PIC  X(022) VALUE                        I.020214
005710              "***  振替単価無し  ***".                           I.020214
005720         04  COLUMN  40  PIC  9(006) FROM  W-HCD.                 I.020214
005730*****  03  E-ME6   COLUMN  15  PIC  X(016) VALUE                  D.020214
005740*****       "***  HIM ﾅｼ  ***".                                   D.020214
005750*****  03  E-ME7   COLUMN  15  PIC  X(022) VALUE                  D.020214
005760*****       "***  振替単価無し  ***".                             D.020214
005770       03  E-ME8   COLUMN  15  PIC  X(024) VALUE
005780            "***  預りサイズ無し  ***".
005790       03  E-ME9   COLUMN  15  PIC  X(020) VALUE
005800            "***  サイズ無し  ***".
005810*****  03  E-ME10  COLUMN  15  PIC  X(025) VALUE                  D.070124
005820*****       "***  TAZ-M WRITE ｴﾗｰ  ***".                          D.070124
005830*****  03  E-ME11  COLUMN  15  PIC  X(022) VALUE                  D.070124
005840*****       "***  預りチェック  ***".                             D.070124
005850       03  E-ME12  COLUMN  15  PIC  X(020) VALUE
005860            "***  日付エラー ***".
005870*****  03  E-ME13  COLUMN  15  PIC  X(025) VALUE                  D.010531
005880*****       "***  価格ランクエラー ***".                          D.010531
005890       03  E-ME14  COLUMN  15  PIC  X(025) VALUE
005900            "***  発送明細№ CHECK ***".
005910       03  E-ME15  COLUMN  15  PIC  X(025) VALUE
005920            "***  単価  ZERO CHECK ***".
005930       03  E-ME16  COLUMN  15  PIC  X(025) VALUE
005940            "***  STRAN WRITE ｴﾗｰ  ***".
005950       03  E-ME17  COLUMN  15  PIC  X(027) VALUE
005960            "***  STRAN REWRITE ｴﾗｰ  ***".
005970       03  E-ME19  COLUMN  15  PIC  X(028) VALUE
005980            "***  未更新データ　有り  ***".
005990       03  E-ME20  COLUMN  15  PIC  X(041) VALUE
006000            "伝票未発行データ有り   消す  OK=1 NO=5   ".          I.050226
006010*****       "未更新データ　有り     消す  OK=1 NO=5   ".          D.050226
006020       03  E-ME21  COLUMN  15  PIC  X(017) VALUE
006030            "***  ﾃﾞｰﾀ ﾅｼ  ***".
006040       03  E-ME22  COLUMN  15  PIC  X(027) VALUE
006050            "***  HSMSF REWRITE ｴﾗｰ  ***".
006060       03  E-ME23  COLUMN  15  PIC  X(017) VALUE
006070            "***  HKBM ﾅｼ  ***".
006080       03  E-ME24  COLUMN  15  PIC  X(026) VALUE
006090            "***  HKBM REWRITE ｴﾗｰ  ***".
006100       03  E-ME25.                                                I.000922
006110         04  COLUMN  15  PIC  N(008) VALUE                        I.000922
006120              NC"請求書　発行済み".                               I.000922
006130         04  COLUMN  34  PIC 9999/99/99  FROM  W-SDATE.           I.000922
006140       03  E-ME26  COLUMN  15  PIC  X(024) VALUE                  I.010419
006150            "***  THTM WRITE ｴﾗｰ  ***".                           I.010419
006160       03  E-ME27  COLUMN  15  PIC  X(026) VALUE                  I.010419
006170            "***  THTM REWRITE ｴﾗｰ  ***".                         I.010419
006180       03  E-ME28  COLUMN  15  PIC  X(017) VALUE                  I.020215
006190            "***  HUHM ﾅｼ  ***".                                  I.020215
006200       03  E-ME29  COLUMN  15  PIC  X(030) VALUE                  I.020215
006210            "***  マスター　単価エラー  ***".                     I.020215
006220       03  E-ME30  COLUMN  15  PIC  X(030) VALUE                  I.050706
006230            "***  データが入っていない  ***".                     I.050706
006240       03  E-ME90  COLUMN  15  PIC  X(021) VALUE
006250            "---   キャンセル  ---".
006260       03  MG-03   COLUMN  15  PIC  X(024) VALUE
006270            "***  ｺﾝﾄﾛｰﾙＦ未登録  ***".
006280       03  MG-05   COLUMN  15  PIC  X(022) VALUE
006290            "***  倉庫省略不可  ***".
006300     COPY LSSEM.
006310     COPY LIBSCR.
006320 PROCEDURE DIVISION.
006330 M-05.
006340     COPY LIBCPR.
006350     MOVE ZERO TO W-CNG.
006360     MOVE D-NHNG TO W-CNGS.
006370     IF W-CN2 >= DATE-NF1 AND <= DATE-NT1
006380         ADD DATE-NC1 TO W-CN.
006390     IF W-CN2 >= DATE-NF2 AND <= DATE-NT2
006400         ADD DATE-NC2 TO W-CN.
006410     ADD 1 TO W-CNGS.                                             ++++++++
006420*
006430     DISPLAY C-CLEAR.
006440     DISPLAY C-MID.
006450*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN.                       D.000922
006460*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN TSKF.                  D.010419
006470*****OPEN INPUT T-M HI-M TC-M JCON TSKF.                          D.020215
006480     OPEN INPUT T-M HI-M TC-M JCON TSKF HUH-M.                    I.020215
006490     OPEN INPUT OTHTM.                                            I.110407
006500*****OPEN I-O TAZ-M.                                              D.070124
006510     OPEN I-O HSMSF.
006520     OPEN I-O THTM.                                               I.010419
006530     OPEN INPUT S-TRAN.
006540     READ S-TRAN AT END
006550         GO TO M-20.
006560 M-10.
006570     IF S-DHC NOT = 0
006580         DISPLAY E-ME19 E-ME99
006590         MOVE 255 TO COMPLETION-CODE
006600         GO TO M-95.
006610     READ S-TRAN AT END
006620         DISPLAY E-ME20 E-ME99
006630         GO TO M-15.
006640     GO TO M-10.
006650 M-15.
006660     ACCEPT A-CHK.
006670     IF ESTAT NOT = HTB AND SKP
006680         GO TO M-15.
006690     IF CHK = 1
006700         GO TO M-20.
006710     IF CHK = 5
006720         MOVE 255 TO COMPLETION-CODE
006730         GO TO M-95.
006740     GO TO M-15.
006750 M-20.
006760     CLOSE S-TRAN.
006770     OPEN INPUT HKBM.
006780     MOVE SPACE TO HKB-KEY.
006790     MOVE "05" TO HKB-NO.
006800     READ HKBM WITH UNLOCK INVALID KEY
006810         CLOSE HKBM
006820         DISPLAY E-ME78 E-ME23 E-ME99
006830         MOVE 255 TO COMPLETION-CODE
006840         GO TO M-95.
006850     MOVE HKB-UNN TO W-DNOD W-DNOO.
006860     CLOSE HKBM.
006870     OPEN OUTPUT S-TRAN.
006880 M-25.
006890     ACCEPT A-UNC.
006900     IF ESTAT = C2 OR PF9
006910         GO TO M-95.
006920     IF ESTAT NOT = HTB AND SKP
006930         GO TO M-25.
006940*
006950     MOVE ZERO TO W-NGP.
006960     IF W-UNCD > 1
006970         GO TO M-25.
006980 M-30.
006990     IF W-UNCD = 1
007000         GO TO M-35.
007010*
007020     PERFORM UAC-RTN THRU UAC-EX.
007030     IF ESTAT = BTB
007040         DISPLAY C-CLEAR
007050         DISPLAY C-MID
007060         GO TO M-25.
007070     IF W-END NOT = 0
007080         GO TO M-95.
007090     GO TO M-80.
007100 M-35.
007110     PERFORM NAC-RTN THRU NAC-EX.
007120     IF ESTAT = BTB
007130         DISPLAY C-CLEAR
007140         DISPLAY C-MID
007150         GO TO M-25.
007160     IF W-END NOT = 0
007170         GO TO M-95.
007180 M-80.
007190     PERFORM UPD-RTN THRU UPD-EX.
007200     IF W-END = 0
007210         GO TO M-30.
007220 M-95.
007230*****CLOSE T-M HI-M TC-M JCON JT-THTN.                            D.000922
007240*****CLOSE T-M HI-M TC-M JCON JT-THTN TSKF.                       D.010419
007250*****CLOSE T-M HI-M TC-M JCON TSKF.                               D.020215
007260     CLOSE T-M HI-M TC-M JCON TSKF HUH-M.                         I.020215
007270*****CLOSE TAZ-M.                                                 D.070124
007280     CLOSE HSMSF.
007290     CLOSE OTHTM.                                                 I.110407
007300     CLOSE THTM.                                                  I.010419
007310     CLOSE S-TRAN.
007320     DISPLAY C-CLEAR.
007330     STOP RUN.
007340*----------  出荷　入力  -------------------------------------------------
007350 UAC-RTN.
007360     IF W-NGP NOT = ZERO
007370         GO TO UAC-040.
007380     MOVE ZERO TO W-TCDD W-CSCD W-HNOD.
007390     MOVE ZERO TO W-NGP.
007400     MOVE DATE-02R TO W-NGPS.
007410 UAC-020.
007420     CALL "SCHD01".
007430     DISPLAY AU-NGP.
007440     ACCEPT AU-NGP.
007450     DISPLAY E-CL.
007460     IF ESTAT = C2 OR PF9
007470         MOVE 1 TO W-END
007480         GO TO UAC-EX.
007490     IF ESTAT = BTB
007500         GO TO UAC-EX.
007510     IF ESTAT NOT = HTB AND SKP
007520         GO TO UAC-020.
007530     IF W-NGPS = ZERO
007540         MOVE DATE-02R TO W-NGPS
007550         DISPLAY AU-NGP.
007560 UAC-040.
007570     CALL "SCHD01".
007580     DISPLAY AU-NGP.
007590     MOVE ZERO TO W-ND1.
007600     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
007610         ADD DATE-NC1 TO W-ND.
007620     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
007630         ADD DATE-NC2 TO W-ND.
007640     IF W-NGD NOT = W-CNG
007650         DISPLAY E-ME12 E-ME98
007660         GO TO UAC-020.
007670     IF W-PD < 1 OR > 31
007680         GO TO UAC-020.
007690     MOVE ZERO TO W-HNOD W-HNC W-CSCD.
007700 UAC-060.
007710     ACCEPT AU-HMN.
007720     DISPLAY E-CL.
007730     IF ESTAT = BTB
007740         GO TO UAC-020.
007750     IF ESTAT NOT = HTB AND SKP
007760         GO TO UAC-060.
007770     IF W-HMN = ZERO
007780         DISPLAY SU-HMN
007790         GO TO UAC-080.
007800     MOVE SPACE TO HSMS-KEY.
007810     MOVE W-HMN TO HSMS-01.
007820     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
007830         DISPLAY E-ME21 E-ME98
007840         MOVE 1 TO W-HNC                                          I.081222
007850         MOVE W-HMN TO W-HNOD                                     I.081222
007860         GO TO UAC-080.                                           I.081222
007870*****    GO TO UAC-060.                                           D.081222
007880     READ HSMSF NEXT RECORD AT END
007890         DISPLAY E-ME21 E-ME98
007900         MOVE 1 TO W-HNC                                          I.081222
007910         MOVE W-HMN TO W-HNOD                                     I.081222
007920         GO TO UAC-080.                                           I.081222
007930*****    GO TO UAC-060.                                           D.081222
007940     IF W-HMN NOT = HSMS-01
007950         DISPLAY E-ME21 E-ME98
007960         MOVE 1 TO W-HNC                                          I.081222
007970         MOVE W-HMN TO W-HNOD                                     I.081222
007980         GO TO UAC-080.                                           I.081222
007990*****    GO TO UAC-060.                                           D.081222
008000     IF HSMS-02 = 7
008010         DISPLAY E-ME21 E-ME98
008020         GO TO UAC-060.
008030     PERFORM HMN-RTN THRU HMN-EX.
008040     IF W-INV = 1                                                 I.001031
008050         GO TO UAC-060.                                           I.001031
008060     IF W-EC NOT = 0                                              I.020215
008070         MOVE 0 TO W-EC                                           I.020215
008080         GO TO UAC-060.                                           I.001031
008090     IF T-BC NOT = ZERO                                           I.001031
008100         DISPLAY E-ME1 E-ME98                                     I.001031
008110         GO TO UAC-060.                                           I.001031
008120*****IF T-KL < 1 OR > 5                                           D.010419
008130*****    DISPLAY E-ME13 E-ME98                                    D.010419
008140*****    GO TO UAC-060.                                           D.010419
008150     MOVE 1 TO W-DSPC.                                            I.020404
008160     PERFORM DSP-RTN THRU DSP-EX.
008170     MOVE 0 TO W-RC.                                              I.020214
008180     MOVE 1 TO W-L1.                                              I.020214
008190     MOVE 2 TO W-L2.                                              I.020214
008200     MOVE 3 TO W-L3.                                              I.020214
008210 UAC-070.                                                         I.020214
008220     ADD 1 TO W-RC.                                               I.020214
008230     ADD 3 TO W-L1 W-L2 W-L3.                                     I.020214
008240     IF W-RC > 6                                                  I.020214
008250         GO TO UAC-800.                                           I.020214
008260     MOVE W-AS(W-RC) TO W-SR.                                     I.020214
008270     IF W-GNO = 0                                                 I.020404
008280         GO TO UAC-360.                                           I.020404
008290*****IF W-GNO NOT = 0                                             D.020404
008300     IF W-RCB = ZERO                                              I.020404
008310         GO TO UAC-070.                                           I.020214
008320     IF W-RC NOT = W-RCB                                          I.020404
008330         GO TO UAC-070.                                           I.020404
008340     MOVE W-RCB TO W-RC.                                          I.020404
008350     MOVE W-LB TO W-L.                                            I.020404
008360     GO TO UAC-360.                                               I.020214
008370 UAC-080.
008380     MOVE W-SCD TO WK-SCD.
008390     ACCEPT AU-SOK.
008400     DISPLAY E-CL.
008410     IF ESTAT = BTB
008420         GO TO UAC-060.
008430     IF W-HMN NOT = ZERO
008440         IF W-HNC = 0                                             I.081222
008450             IF ESTAT = ADV
008460                 MOVE WK-SCD TO W-SCD
008470                 MOVE 1 TO W-ADV
008480                 GO TO UAC-090.
008490     IF ESTAT NOT = HTB AND SKP
008500         GO TO UAC-080.
008510 UAC-090.
008520     IF W-SCD = ZERO
008530         MOVE W-SCD TO W-SOK
008540         DISPLAY SU-SOK
008550         GO TO UAC-100.
008560     MOVE 3 TO JCON3-01.
008570     MOVE W-SCD TO JCON3-02.
008580     READ JCON UNLOCK INVALID
008590         MOVE  SPACE TO JCON3-03
008600         DISPLAY DU-SNA MG-03 E-ME98
008610         GO TO UAC-080.
008620     MOVE W-SCD TO W-SOK.
008630     DISPLAY AU-SOK DU-SNA.
008640 UAC-100.
008650     IF W-HMN NOT = ZERO
008660         IF W-HNC = 0                                             I.081222
008670             IF ESTAT = ADV
008680                 GO TO UAC-280.
008690 UAC-120.
008700     ACCEPT AU-TCD.
008710     DISPLAY E-CL.
008720     IF ESTAT = BTB
008730         GO TO UAC-080.
008740     IF ESTAT NOT = HTB AND SKP
008750         GO TO UAC-120.
008760     PERFORM TM-RTN THRU TM-EX.
008770     IF W-INV = 1
008780         DISPLAY E-ME1 E-ME98
008790         GO TO UAC-120.
008800     IF T-BC NOT = ZERO
008810         DISPLAY E-ME1 E-ME98
008820         GO TO UAC-120.
008830*****IF T-KL < 1 OR > 5                                           D.010531
008840*****    DISPLAY E-ME13 E-ME98                                    D.010531
008850*****    GO TO UAC-120.                                           D.010531
008860*UAC-140.                                                         D.081222
008870*****ACCEPT AU-HN1.                                               D.081222
008880*****IF ESTAT = BTB                                               D.081222
008890*****    GO TO UAC-080.                                           D.081222
008900*****IF ESTAT NOT = HTB AND SKP                                   D.081222
008910*****    GO TO UAC-140.                                           D.081222
008920*****IF W-HN1 = ZERO                                              D.081222
008930*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
008940*****    DISPLAY SU-HN1 SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6        D.081222
008950*****    GO TO UAC-260.                                           D.081222
008960*UAC-160.                                                         D.081222
008970*****ACCEPT AU-HN2.                                               D.081222
008980*****IF ESTAT = BTB                                               D.081222
008990*****    GO TO UAC-140.                                           D.081222
009000*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009010*****    GO TO UAC-160.                                           D.081222
009020*****IF ESTAT = ADV                                               D.081222
009030*****    COMPUTE W-HN2 = W-HN1 + 1                                D.081222
009040*****    DISPLAY AU-HN2.                                          D.081222
009050*****IF W-HN2 = ZERO                                              D.081222
009060*****    MOVE 1 TO W-HNC                                          D.081222
009070*****    MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                     D.081222
009080*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6               D.081222
009090*****    GO TO UAC-260.                                           D.081222
009100*UAC-180.                                                         D.081222
009110*****ACCEPT AU-HN3.                                               D.081222
009120*****IF ESTAT = BTB                                               D.081222
009130*****    GO TO UAC-160.                                           D.081222
009140*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009150*****    GO TO UAC-180.                                           D.081222
009160*****IF ESTAT = ADV                                               D.081222
009170*****    COMPUTE W-HN3 = W-HN2 + 1                                D.081222
009180*****    DISPLAY AU-HN3.                                          D.081222
009190*****IF W-HN3 = ZERO                                              D.081222
009200*****    MOVE 2 TO W-HNC                                          D.081222
009210*****    MOVE ZERO TO W-HN4 W-HN5 W-HN6                           D.081222
009220*****    DISPLAY SU-HN3 SU-HN4 SU-HN5 SU-HN6                      D.081222
009230*****    GO TO UAC-260.                                           D.081222
009240*UAC-200.                                                         D.081222
009250*****ACCEPT AU-HN4.                                               D.081222
009260*****IF ESTAT = BTB                                               D.081222
009270*****    GO TO UAC-180.                                           D.081222
009280*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009290*****    GO TO UAC-200.                                           D.081222
009300*****IF ESTAT = ADV                                               D.081222
009310*****    COMPUTE W-HN4 = W-HN3 + 1                                D.081222
009320*****    DISPLAY AU-HN4.                                          D.081222
009330*****IF W-HN4 = ZERO                                              D.081222
009340*****    MOVE 3 TO W-HNC                                          D.081222
009350*****    MOVE ZERO TO W-HN5 W-HN6                                 D.081222
009360*****    DISPLAY SU-HN4 SU-HN5 SU-HN6                             D.081222
009370*****    GO TO UAC-260.                                           D.081222
009380*UAC-220.                                                         D.081222
009390*****ACCEPT AU-HN5.                                               D.081222
009400*****IF ESTAT = BTB                                               D.081222
009410*****    GO TO UAC-200.                                           D.081222
009420*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009430*****    GO TO UAC-220.                                           D.081222
009440*****IF ESTAT = ADV                                               D.081222
009450*****    COMPUTE W-HN5 = W-HN4 + 1                                D.081222
009460*****    DISPLAY AU-HN5.                                          D.081222
009470*****IF W-HN5 = ZERO                                              D.081222
009480*****    MOVE 4 TO W-HNC                                          D.081222
009490*****    MOVE ZERO TO W-HN6                                       D.081222
009500*****    DISPLAY SU-HN5 SU-HN6                                    D.081222
009510*****    GO TO UAC-260.                                           D.081222
009520*UAC-240.                                                         D.081222
009530*****ACCEPT AU-HN6.                                               D.081222
009540*****IF ESTAT = BTB                                               D.081222
009550*****    GO TO UAC-220.                                           D.081222
009560*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009570*****    GO TO UAC-240.                                           D.081222
009580*****IF ESTAT = ADV                                               D.081222
009590*****    COMPUTE W-HN6 = W-HN5 + 1                                D.081222
009600*****    DISPLAY AU-HN6.                                          D.081222
009610*****IF W-HN6 = ZERO                                              D.081222
009620*****    MOVE 5 TO W-HNC                                          D.081222
009630*****    DISPLAY SU-HN6                                           D.081222
009640*****  ELSE                                                       D.081222
009650*****    MOVE 6 TO W-HNC.                                         D.081222
009660 UAC-260.
009670     ACCEPT AU-CCD.
009680     DISPLAY E-CL.
009690     IF ESTAT = BTB
009700         GO TO UAC-120.                                           I.081222
009710*****    IF W-HNC > 4                                             D.081222
009720*****        GO TO UAC-240.                                       D.081222
009730*****IF ESTAT = BTB                                               D.081222
009740*****    IF W-HNC = 4                                             D.081222
009750*****        GO TO UAC-220.                                       D.081222
009760*****IF ESTAT = BTB                                               D.081222
009770*****    IF W-HNC = 3                                             D.081222
009780*****        GO TO UAC-200.                                       D.081222
009790*****IF ESTAT = BTB                                               D.081222
009800*****    IF W-HNC = 2                                             D.081222
009810*****        GO TO UAC-180.                                       D.081222
009820*****IF ESTAT = BTB                                               D.081222
009830*****    IF W-HNC = 1                                             D.081222
009840*****        GO TO UAC-160.                                       D.081222
009850*****IF ESTAT = BTB                                               D.081222
009860*****    GO TO UAC-140.                                           D.081222
009870     IF ESTAT NOT = HTB AND SKP
009880         GO TO UAC-260.
009890     PERFORM TCM-RTN THRU TCM-EX.
009900     IF W-INV = 1
009910         DISPLAY E-ME2 E-ME98
009920         GO TO UAC-260.
009930     IF W-INV = 9
009940         DISPLAY E-ME3 E-ME99
009950         MOVE 1 TO W-END
009960         GO TO UAC-EX.
009970 UAC-280.
009980     DISPLAY AU-CSC.
009990     IF W-CSCD = ZERO
010000         GO TO UAC-320.
010010 UAC-300.
010020     ACCEPT AU-CSC.
010030     IF ESTAT = BTB
010040         GO TO UAC-260.
010050     IF ESTAT NOT = HTB AND SKP
010060         GO TO UAC-300.
010070     IF W-CSCD NOT = 0 AND 9
010080         GO TO UAC-300.
010090 UAC-320.
010100     MOVE 1 TO W-L1.
010110     MOVE 2 TO W-L2.
010120     MOVE 3 TO W-L3.
010130*****MOVE ZERO TO W-RC W-DCD W-ZC W-HSCD.                         D.140324
010140     MOVE ZERO TO W-RC W-DCD W-ZC.                                I.140324
010150     IF W-CNGS < 1404                                             I.140324
010160         MOVE 0 TO W-HSCD                                         I.140324
010170       ELSE                                                       I.140324
010180         MOVE 8 TO W-HSCD.                                        I.140324
010190*****IF W-HMN = ZERO                                              D.081222
010200     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
010210         INITIALIZE W-ASR W-BR
010220         MOVE ALL NX"2121" TO W-BI.
010230 UAC-340.
010240     MOVE 0 TO W-DEL.
010250     ADD 1 TO W-RC.
010260     ADD 3 TO W-L1 W-L2 W-L3.
010270     IF W-RC > 6
010280         GO TO UAC-760.
010290     IF W-RC = 2
010300         IF W-DC = 8
010310             MOVE 5 TO W-ZC.
010320     IF W-ZC = 5
010330         GO TO UAC-420.
010340 UAC-360.
010350     MOVE W-AS(W-RC) TO W-SR.
010360     MOVE W-SCD TO W-SOK.
010370     MOVE W-NGP TO W-DATE.
010380     MOVE W-TCDN TO W-TCD.
010390     MOVE W-TCDD TO W-TCD2.
010400     MOVE W-CSCD TO W-CSC.
010410     MOVE T-TNC TO W-TC2.
010420     MOVE T-FKC TO W-FKC.
010430     MOVE W-CCDD TO W-CCD.
010440 UAC-380.
010450     IF W-DEL = 9
010460         MOVE 0 TO W-DEL
010470         GO TO UAC-400.
010480     IF W-HMN NOT = ZERO
010490         IF W-HNC = 0                                             I.081222
010500             IF W-HCD NOT = ZERO
010510                 GO TO UAC-400.
010520     MOVE W-DCD TO W-DC.
010530     DISPLAY AU-DC.
010540 UAC-400.
010550     MOVE W-DC TO WK-DC.
010560     MOVE 0 TO W-ADV.
010570     ACCEPT AU-DC.
010580     DISPLAY E-CL.
010590     IF ESTAT = PF21
010600         MOVE W-RC TO W-RCD
010610         MOVE W-L TO W-LD
010620         GO TO UAC-430.
010630*****IF ESTAT = C1                                                D.001205
010640     IF ESTAT = C1 OR PF6                                         I.001205
010650         MOVE 5 TO W-ZC
010660         GO TO UAC-420.
010670*****IF ESTAT = FUK                                               D.081222
010680*****    GO TO UAC-760.                                           D.081222
010690     IF ESTAT = ADV
010700         IF W-HCD NOT = ZERO
010710             MOVE WK-DC TO W-DC
010720             DISPLAY AU-DC
010730             MOVE 1 TO W-ADV
010740             GO TO UAC-440.
010750     IF ESTAT NOT = BTB
010760         GO TO UAC-440.
010770*****IF W-HMN = ZERO                                              D.081222
010780     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
010790         IF W-GNO = ZERO
010800             MOVE ZERO TO W-SR
010810                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
010820                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
010830             MOVE W-SR TO W-AS(W-RC)
010840             DISPLAY SU-D1 SU-D2 SU-D3.
010850 UAC-410.
010860     SUBTRACT 1 FROM W-RC.
010870     SUBTRACT 3 FROM W-L1 W-L2 W-L3.
010880     IF W-RC = ZERO
010890         GO TO UAC-300.
010900     MOVE W-AS(W-RC) TO W-SR.
010910     IF W-GNO = ZERO
010920         GO TO UAC-410.
010930     GO TO UAC-400.
010940 UAC-420.
010950     IF W-RC = 1
010960*****    MOVE ZERO TO W-HCD W-SIZ W-SUS W-SUT W-BT W-KIN W-DC     D.000822
010970         MOVE ZERO TO W-HCD W-SIZ W-SUT W-BT W-KIN W-DC           I.000822
010980                      W-FT W-BC1 W-BC2 W-BC3 W-SOK
010990                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
011000                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
011010         MOVE SPACE TO W-BIK
011020         MOVE W-RC TO W-GNO
011030         MOVE W-SR TO W-AS(W-RC)
011040         DISPLAY SU-D1 SU-D2 SU-D3
011050         GO TO UAC-340.
011060     MOVE ZERO TO W-SR.
011070     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
011080                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
011090     MOVE SPACE TO W-BIK.
011100     MOVE W-SR TO W-AS(W-RC).
011110     DISPLAY SU-D1 SU-D2 SU-D3.
011120     GO TO UAC-340.
011130 UAC-430.
011140     IF W-RC NOT = 6
011150         COMPUTE CNT = W-RC + 1
011160         MOVE W-AS(CNT) TO W-AS(W-RC)
011170         ADD 1 TO W-RC
011180         GO TO UAC-430.
011190     MOVE ZERO TO W-AS(W-RC).
011200     MOVE 0 TO W-DSPC.                                            I.020404
011210     PERFORM DSP-RTN THRU DSP-EX.
011220     MOVE W-RCD TO W-RC.
011230     MOVE W-LD TO W-L.
011240     MOVE 9 TO W-DEL.
011250     GO TO UAC-360.
011260 UAC-440.
011270     IF ESTAT NOT = HTB AND SKP AND ADV
011280         GO TO UAC-380.
011290     IF W-CSCD = 9                                                I.131227
011300         IF W-DC NOT = 8                                          I.131227
011310             GO TO UAC-380.                                       I.070126
011320     IF W-DC = 8                                                  I.131227
011330         IF W-CSCD NOT = 9                                        I.131227
011340             GO TO UAC-380.                                       I.070126
011350     IF W-DC = 6 OR 9                                             I.070126
011360         GO TO UAC-380.                                           I.070126
011370     IF W-DC NOT = 2 AND 3 AND 6 AND 8 AND 9
011380        IF W-SOK = 0
011390             DISPLAY MG-05 E-ME98
011400             GO  TO  UAC-380.
011410     IF W-RC NOT = 1
011420         IF W-DC = 8
011430             DISPLAY E-ME4 E-ME98
011440             GO TO UAC-380.
011450     IF W-CCDD NOT = ZERO
011460         IF W-DC = 3 OR  9
011470             DISPLAY E-ME4 E-ME98
011480             GO TO UAC-380.
011490     IF W-CSC = 9
011500         IF W-DC = 4
011510             DISPLAY E-ME4 E-ME98
011520             GO TO UAC-380.
011530     IF W-RC NOT = 1
011540         GO TO UAC-450.
011550     IF W-DC = 1 OR 2                                             I.010327
011560         MOVE ZERO TO W-HNOD W-HNC.                               I.020214
011570*****    MOVE ZERO TO W-HNOD W-HNC                                D.020214
011580*****    DISPLAY SU-HMN.                                          D.020214
011590     MOVE W-DC TO W-DCD.
011600     IF W-DC = 4  OR  7
011610         MOVE ZERO TO W-DCD.
011620 UAC-450.
011630     MOVE W-DC TO W-DCC.
011640     IF W-DC = 4  OR  7
011650         MOVE ZERO TO W-DCC.
011660     IF W-DCD NOT = W-DCC
011670         DISPLAY E-ME4 E-ME98
011680         GO TO UAC-380.
011690     IF W-DC = 8
011700         DISPLAY SU-D2 SU-D3
011710         MOVE ZERO TO W-ZD1 W-ZD2 W-FT W-HSC
011720                     W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05) I.000822
011730                     W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10) I.000822
011740         DISPLAY DU-SZM
011750         GO TO UAC-700.
011760     MOVE W-HCD TO W-HCDO.                                        I.010419
011770 UAC-480.
011780     IF W-ADV NOT = 0
011790         GO TO UAC-490.
011800     ACCEPT AU-HCD.
011810     DISPLAY E-CL.
011820     IF ESTAT = BTB
011830         GO TO UAC-400.
011840*****IF ESTAT = C1                                                D.001205
011850     IF ESTAT = C1 OR PF6                                         I.001205
011860         MOVE 5 TO W-ZC
011870         GO TO UAC-420.
011880*****IF ESTAT = FUK                                               D.081222
011890*****    GO TO UAC-760.                                           D.081222
011900     IF ESTAT NOT = HTB AND SKP
011910         GO TO UAC-480.
011920     IF W-HCD = ZERO
011930         MOVE W-HCDD TO W-HCD.
011940     IF W-HCD NOT = W-HCDO                                        I.010419
011950         MOVE ZERO TO W-BT.                                       I.010449
011960 UAC-490.
011970     MOVE 0 TO W-HIC.                                             I.020214
011980     PERFORM HI-RTN THRU HI-EX.
011990     IF W-EC NOT = ZERO
012000         MOVE 0 TO W-EC W-ADV
012010         GO TO UAC-480.
012020     IF W-DC = 3 OR 4 OR 9
012030        IF HI-S4(10) NOT = 1
012040            DISPLAY E-ME8 E-ME98
012050            MOVE 0 TO W-ADV
012060            GO  TO    UAC-480.
012070     IF W-HCD > 999899
012080*****    MOVE ZERO TO W-SIZ W-SUS W-FT                            D.000822
012090         MOVE ZERO TO W-SIZ W-FT                                  I.000822
012100                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
012110                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
012120         DISPLAY SU-D2 SU-D31
012130         GO TO UAC-520.
012140     IF W-DC NOT = 3 AND 9
012150         GO TO UAC-550.
012160*****MOVE ZERO TO W-SIZ W-SUS.                                    D.000822
012170     MOVE ZERO TO W-SIZ                                           I.000822
012180                  W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
012190                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
012200     DISPLAY SU-D2 SU-D31.
012210 UAC-520.
012220     IF W-ADV NOT = 0
012230         GO TO UAC-540.
012240     ACCEPT AU-SUT.
012250     DISPLAY E-CL.
012260     IF ESTAT = BTB
012270         MOVE 0 TO W-ADV
012280         MOVE W-HCD TO W-HCDO                                     I.010419
012290         GO TO UAC-480.
012300     IF ESTAT NOT = HTB AND SKP
012310         GO TO UAC-520.
012320     IF W-HCD < 999900
012330        MOVE HI-FT TO W-FT.
012340 UAC-540.
012350*****IF W-BT NOT = ZERO                                           D.020401
012360     IF W-BT = ZERO                                               I.020401
012370         PERFORM TAN-RTN THRU TAN-EX.                             I.010419
012380*****IF WK-TAN   NOT = ZERO                                       D.010419
012390*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
012400*****    MOVE  WK-TAN  TO  W-BT                                   D.010419
012410*****    GO  TO  UAC-660.                                         D.010419
012420*****IF HI-SS4 NOT = ZERO                                         D.010419
012430*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
012440*****    GO TO UAC-660.                                           D.010419
012450*****IF HI-SS3 NOT = ZERO                                         D.010419
012460*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
012470*****    GO TO UAC-660.                                           D.010419
012480*****IF HI-SS2 NOT = ZERO                                         D.010419
012490*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
012500*****    GO TO UAC-660.                                           D.010419
012510*****MOVE HI-U1(T-KL) TO W-BT.                                    D.010419
012520     GO TO UAC-660.
012530 UAC-550.
012540*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
012550*****IF W-DC NOT = 0                                              D.050805
012560*****    GO TO UAC-555.                                           D.050805
012570*****MOVE W-TCD TO TAZ-TCD.                                       D.050805
012580*****MOVE W-HCD TO TAZ-HCD.                                       D.050805
012590*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.050805
012600*****    GO TO UAC-555.                                           D.050805
012610*****DISPLAY E-ME11 E-ME99.                                       D.050805
012620*UAC-555.                                                         D.050805
012630     IF W-ADV NOT = 0
012640         GO TO UAC-570.
012650 UAC-560.                                                         I.050420
012660     ACCEPT AU-SIZ.
012670     DISPLAY E-CL.
012680     IF ESTAT = BTB
012690         MOVE 0 TO W-ADV
012700         GO TO UAC-440.
012710 UAC-570.
012720     IF W-SIZ < 1 OR > 4
012730         MOVE 0 TO W-ADV
012740         GO TO UAC-560.                                           I.050420
012750*****    GO TO UAC-550.                                           D.050420
012760     MOVE HI-FT TO W-FT.
012770     IF W-SIZ = 1
012780*****    MOVE HI-U1(T-KL) TO W-BT                                 D.010419
012790         DISPLAY DU-S1
012800         MOVE HI-SS1 TO W-ASD.
012810     IF W-SIZ = 2
012820*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
012830         DISPLAY DU-S2
012840         MOVE HI-SS2 TO W-ASD.
012850     IF W-SIZ = 3
012860*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
012870         DISPLAY DU-S3
012880         MOVE HI-SS3 TO W-ASD.
012890     IF W-SIZ = 4
012900*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
012910         DISPLAY DU-S4
012920         MOVE HI-SS4 TO W-ASD.
012930     IF W-ASD = ZERO OR SPACE
012940         MOVE 0 TO W-ADV
012950         DISPLAY E-ME9 E-ME98
012960         GO TO UAC-560.                                           I.050420
012970*****    GO TO UAC-550.                                           D.050420
012980     IF W-SIZ = 4
012990         IF W-ASD = "0000000001"
013000             MOVE 0 TO W-ADV
013010             DISPLAY E-ME9 E-ME98
013020             GO TO UAC-560.                                       I.050420
013030*****        GO TO UAC-550.                                       D.050420
013040     IF W-DC = 2 OR 6
013050         MOVE ZERO TO W-FT.
013060     IF W-BT = ZERO                                               I.010419
013070         PERFORM TAN-RTN THRU TAN-EX.
013080*****IF WK-TAN   NOT = ZERO                                       D.010419
013090*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
013100     MOVE ZERO TO W-SC W-ZC.
013110     MOVE -3 TO W-C.
013120 UAC-580.
013130     ADD 1 TO W-SC.
013140     IF W-SC > 8
013150         ADD 5 TO W-C
013160       ELSE
013170         ADD 6 TO W-C.
013180     IF W-SC = 11
013190         MOVE ZERO TO W-SC W-SUT
013200         GO TO UAC-630.
013210     IF (W-SD(W-SC) = ZERO) OR (W-ZC = 5)
013220         MOVE ZERO TO W-SU(W-SC)
013230         GO TO UAC-610.
013240     IF W-SC = 10
013250         IF W-SIZ = 4
013260             MOVE ZERO TO W-SU(W-SC)
013270             GO TO UAC-580.
013280 UAC-600.
013290     IF W-ADV NOT = 0
013300         GO TO UAC-610.
013310     IF W-SC > 7
013320         ACCEPT AU-SU1
013330       ELSE
013340         ACCEPT AU-SU.
013350     IF ESTAT = BTB
013360         MOVE 0 TO W-ADV
013370         GO TO UAC-620.
013380*****IF ESTAT = C1                                                D.001205
013390     IF ESTAT = C1 OR PF6                                         I.001205
013400         MOVE 5 TO W-ZC
013410         MOVE ZERO TO W-SU(W-SC)
013420         MOVE 0 TO W-ADV
013430         GO TO UAC-610.
013440*****IF ESTAT = FUK                                               D.081222
013450*****    MOVE ZERO TO W-SC W-SUT                                  D.081222
013460*****    GO TO UAC-630.                                           D.081222
013470     IF ESTAT NOT = HTB AND SKP
013480         MOVE 0 TO W-ADV
013490         GO TO UAC-600.
013500     IF W-SC > 7
013510         IF W-SU(W-SC) > 999 OR < -999
013520             GO TO UAC-600.
013530 UAC-610.
013540     IF W-SC < 8
013550         DISPLAY DU-SU
013560       ELSE
013570         DISPLAY DU-SU1.
013580     GO TO UAC-580.
013590 UAC-620.
013600     IF W-ADV NOT = ZERO
013610         MOVE 0 TO W-ADV.
013620     SUBTRACT 1 FROM W-SC.
013630     IF W-SC > 7
013640         SUBTRACT 5 FROM W-C
013650       ELSE
013660         SUBTRACT 6 FROM W-C.
013670     IF W-SC = ZERO
013680         GO TO UAC-560.                                           I.050420
013690*****    GO TO UAC-550.                                           D.050420
013700     IF W-SD(W-SC) = ZERO
013710         GO TO UAC-620.
013720     IF W-SC = 10
013730         IF W-SIZ = 4
013740             GO TO UAC-620.
013750     GO TO UAC-600.
013760 UAC-630.
013770     ADD 1 TO W-SC.
013780     IF W-SC < 11
013790         ADD W-SU(W-SC) TO W-SUT
013800         GO TO UAC-630.
013810     MOVE ZERO TO W-ZC.
013820     IF W-SUT = ZERO
013830         MOVE ZERO TO W-SC
013840         MOVE -3 TO W-C
013850         MOVE 0 TO W-ADV
013860         GO TO UAC-580.
013870 UAC-660.
013880     DISPLAY DU-SUT DU-BT.
013890     IF W-DC = 7
013900        MOVE ZERO TO W-BT W-KIN
013910        DISPLAY SU-BT SU-KIN
013920        GO TO UAC-720.
013930     IF W-DC = 4
013940         COMPUTE W-KIN = W-SUT * W-BT
013950         MOVE ZERO TO W-FT
013960         DISPLAY SU-KIN SU-BT
013970         GO TO UAC-720.
013980     ACCEPT AU-BT.
013990     DISPLAY E-CL.
014000     IF ESTAT NOT = BTB
014010         GO TO UAC-670.
014020     MOVE 0 TO W-ADV.
014030     IF W-HCD > 999899
014040         GO TO UAC-520.
014050     IF W-DC = 3 OR 9
014060         GO TO UAC-520.
014070     MOVE 11 TO W-SC.
014080     MOVE 60 TO W-C.
014090     GO TO UAC-620.
014100 UAC-670.
014110*****IF ESTAT NOT = HTB AND SKP                                   D.110407
014120     IF ESTAT NOT = HTB AND SKP AND PF4                           I.110407
014130         GO TO UAC-660.
014140     IF ESTAT = PF4                                               I.110407
014150         PERFORM TAO-RTN THRU TAO-EX.                             I.110407
014160     DISPLAY DU-BT.
014170     IF W-HCD < 999900
014180         IF W-BT = ZERO
014190*****        IF W-DC = 2                                          D.130703
014200                 DISPLAY E-ME15 E-ME99                            I.070403
014210                 DISPLAY E-CL.                                    I.130703
014220*****            DISPLAY E-CL                                     D.130703
014230*****          ELSE                                               D.130703
014240*****            GO TO UAC-660.                                   D.130703
014250     IF W-HCD > 999899
014260         IF W-BT = ZERO
014270             DISPLAY E-ME15 E-ME99
014280             DISPLAY E-CL.
014290     COMPUTE W-KIN = W-SUT * W-BT.
014300     DISPLAY DU-KIN.
014310     IF W-KIN = ZERO
014320         IF W-HCD > 999899
014330             GO TO UAC-700.
014340     GO TO UAC-720.
014350 UAC-700.
014360     ACCEPT AU-KIN.
014370     DISPLAY E-CL.
014380     IF ESTAT = BTB
014390         IF W-HCD > 999899
014400             GO  TO  UAC-660
014410           ELSE
014420             GO TO UAC-400.
014430     IF ESTAT NOT = HTB AND SKP
014440         GO TO UAC-700.
014450     DISPLAY DU-KIN.
014460 UAC-720.
014470     IF T-BIK = 0
014480         MOVE SPACE TO W-BIK
014490         DISPLAY SU-BIK
014500         GO TO UAC-740.
014510     ACCEPT AU-BIK.
014520     DISPLAY E-CL.
014530     IF ESTAT = BTB
014540         IF W-DC = 4 OR 7
014550             GO TO UAC-620
014560           ELSE
014570             GO TO UAC-660.
014580 UAC-740.
014590     MOVE W-RC TO W-GNO.
014600     MOVE W-SR TO W-AS(W-RC).
014610     GO TO UAC-340.
014620 UAC-760.
014630     MOVE ZERO TO W-GSUT W-RC W-ZC.
014640 UAC-770.
014650     ADD 1 TO W-RC.
014660     IF W-RC = 7
014670         DISPLAY DU-GSUT
014680         IF W-ZC = 0                                              I.050706
014690             DISPLAY E-ME30 E-ME99                                I.050706
014700             GO TO UAC-780                                        I.050706
014710           ELSE                                                   I.050706
014720             GO TO UAC-780.
014730     MOVE ZERO TO W-SR.
014740     MOVE W-AS(W-RC) TO W-SR.
014750     IF W-HCD < 999900
014760        ADD W-SUT TO W-GSUT.
014770     IF W-DATE NOT = ZERO
014780         MOVE W-RC TO W-HNCD.
014790     IF ZERO = W-SU(01) AND W-SU(02) AND W-SU(03) AND W-SU(04)    I.050706
014800           AND W-SU(05) AND W-SU(06) AND W-SU(07) AND W-SU(08)    I.050706
014810           AND W-SU(09) AND W-SU(10) AND W-SUT AND W-KIN          I.050706
014820         GO TO UAC-770.                                           I.050706
014830     MOVE 1 TO W-ZC.                                              I.050706
014840     GO TO UAC-770.
014850 UAC-780.
014860     IF W-BI = SPACE
014870         DISPLAY AU-BI.
014880     IF W-HNCD < W-HNC
014890         DISPLAY E-ME14 E-ME98.
014900 UAC-800.
014910     MOVE 0 TO W-ADV.
014920     DISPLAY AU-BI.
014930     MOVE W-BI TO WK-BI.
014940     ACCEPT AU-BI.
014950     DISPLAY E-CL.
014960     IF ESTAT = BTB
014970         MOVE 7 TO W-RC
014980         MOVE 22 TO W-L1
014990         MOVE 23 TO W-L2
015000         MOVE 24 TO W-L3
015010         GO TO UAC-410.
015020     IF ESTAT = ADV
015030         MOVE WK-BI TO W-BI
015040         DISPLAY AU-BI
015050         MOVE 1 TO W-ADV
015060         GO TO UAC-810.
015070     IF ESTAT NOT = HTB AND SKP
015080         GO TO UAC-780.
015090 UAC-810.
015100     MOVE W-HNOD TO W-HANO.
015110 UAC-840.
015120     IF W-DCD = 3
015130         MOVE ZERO TO W-KOSUR
015140         GO TO UAC-850.
015150     IF W-ADV NOT = 0
015160         GO TO UAC-850.
015170     ACCEPT AU-KOSU.
015180     DISPLAY E-CL.
015190     IF ESTAT = BTB
015200         GO TO UAC-800.
015210     IF ESTAT NOT = HTB AND SKP
015220         GO TO UAC-840.
015230 UAC-850.
015240     DISPLAY DU-KOSU.
015250*
015260     IF W-DCD = 8
015270*****    MOVE ZERO TO W-HSC                                       D.040708
015280         MOVE ZERO TO W-HSCD                                      I.040708
015290         MOVE 0 TO W-FRCD
015300         DISPLAY AU-HSC SU-FRC
015310         GO TO UAC-940.
015320     IF T-ZEI = 1                                                 I.070319
015330         IF W-CNGS < 1404                                         I.140324
015340             MOVE 8 TO W-HSCD                                     I.070319
015350             DISPLAY AU-HSC                                       I.070319
015360             GO TO UAC-920                                        I.140324
015370           ELSE                                                   I.140324
015380             MOVE 0 TO W-HSCD                                     I.140324
015390             DISPLAY AU-HSC                                       I.140324
015400             GO TO UAC-920.                                       I.070319
015410     IF T-FKC = 99                                                I.040705
015420         IF W-CNGS < 1404                                         I.140324
015430             MOVE 8 TO W-HSCD                                     I.070319
015440             DISPLAY AU-HSC                                       I.070319
015450             GO TO UAC-920                                        I.140324
015460           ELSE                                                   I.140324
015470             MOVE 0 TO W-HSCD                                     I.140324
015480             DISPLAY AU-HSC                                       I.140324
015490             GO TO UAC-920.                                       I.070319
015500     IF W-DCD = 0
015510*****    MOVE ZERO TO W-HSC                                       D.040708
015520         IF W-CNGS < 1404                                         I.140324
015530             MOVE ZERO TO W-HSCD                                  I.040708
015540             DISPLAY AU-HSC
015550             GO TO UAC-920                                        I.140324
015560           ELSE                                                   I.140324
015570             MOVE 8 TO W-HSCD                                     I.140324
015580             DISPLAY AU-HSC                                       I.140324
015590             GO TO UAC-920.
015600     IF W-DCD = 3
015610         IF W-GSUT > ZERO
015620*****        MOVE ZERO TO W-HSC W-FRCD                            D.040708
015630*****        MOVE ZERO TO W-HSCD W-FRCD                           D.140324
015640             MOVE ZERO TO W-FRCD                                  I.140324
015650             IF W-CNGS < 1404                                     I.140324
015660                 MOVE ZERO TO W-HSCD                              I.140324
015670                 DISPLAY AU-HSC SU-FRC
015680                 GO TO UAC-940                                    I.140324
015690               ELSE                                               I.140324
015700                 MOVE 8 TO W-HSCD                                 I.140324
015710                 DISPLAY AU-HSC SU-FRC                            I.140324
015720                 GO TO UAC-940.
015730 UAC-880.
015740     IF  W-DCD = 9
015750*****    MOVE 8 TO W-HSCD                                         D.140324
015760         MOVE 0 TO W-FRCD
015770         IF W-CNGS < 1404                                         I.140324
015780             MOVE 8 TO W-HSCD                                     I.140324
015790             DISPLAY AU-HSC SU-FRC
015800             GO TO UAC-940                                        I.140324
015810           ELSE                                                   I.140324
015820             MOVE 0 TO W-HSCD                                     I.140324
015830             DISPLAY AU-HSC SU-FRC                                I.140324
015840             GO TO UAC-940.
015850     IF W-DCD = 7
015860         IF W-CNGS < 1404                                         I.140324
015870             MOVE 8 TO W-HSCD
015880             GO TO UAC-920                                        I.140324
015890           ELSE                                                   I.140324
015900             MOVE 0 TO W-HSCD                                     I.140324
015910             GO TO UAC-920.
015920     IF W-ADV NOT = 0
015930         GO TO UAC-890.
015940     ACCEPT AU-HSC.
015950     IF ESTAT = BTB
015960         MOVE 0 TO W-ADV
015970         IF W-DCD = 3
015980             GO TO UAC-800
015990           ELSE
016000             GO TO UAC-840.
016010     IF ESTAT NOT = HTB AND SKP
016020         GO TO UAC-880.
016030 UAC-890.
016040     IF W-CNGS < 1404                                             I.140324
016050         IF W-HSCD NOT = 0 AND 3 AND 8
016060             GO TO UAC-880.
016070     IF W-CNGS NOT < 1404                                         I.140324
016080         IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                I.140324
016090             GO TO UAC-880.
016100 UAC-920.
016110*****IF W-DCD NOT = 5 AND 0 AND 4 AND 7                           D.030708
016120     IF W-DCD NOT = 0 AND 1 AND 2 AND 4 AND 5 AND 7               I.030708
016130         MOVE 0 TO W-FRCD
016140         DISPLAY SU-FRC
016150         GO TO UAC-940.
016160     IF W-ADV NOT = 0
016170         GO TO UAC-930.
016180     ACCEPT AU-FRC.
016190     IF ESTAT = BTB
016200         IF W-DCD = 7
016210             MOVE 0 TO W-ADV
016220             GO TO UAC-840.
016230     IF ESTAT = BTB
016240         MOVE 0 TO W-ADV
016250         GO TO UAC-880.
016260     IF ESTAT NOT = HTB AND SKP
016270         GO TO UAC-920.
016280 UAC-930.
016290     DISPLAY AU-FRC.
016300     IF W-FRCD > 1
016310         GO TO UAC-920.
016320 UAC-940.
016330     DISPLAY AU-SDT.
016340     IF W-SDTD NOT = ZERO
016350         GO TO UAC-980.                                           I.000922
016360*****    GO TO UAC-990.                                           D.000922
016370     IF T-SS = ZERO OR 99                                         I.000922
016380         GO TO UAC-990.                                           I.000922
016390 UAC-960.
016400     ACCEPT AU-SDT.
016410     IF ESTAT NOT = BTB
016420         GO TO UAC-970.
016430     MOVE 0 TO W-ADV.
016440     IF W-DCD = 8
016450         GO TO UAC-840.
016460     IF W-DCD = 9
016470         IF W-GSUT > ZERO
016480             GO TO UAC-840.
016490     IF W-DCD = 9
016500         GO TO UAC-840.
016510     IF W-DCD = 5 OR 0 OR 4 OR 7
016520         GO TO UAC-920.
016530     GO TO UAC-880.
016540 UAC-970.
016550     IF ESTAT NOT = HTB AND SKP
016560         GO TO UAC-960.                                           I.000922
016570*****    GO TO UAC-940.                                           D.000922
016580     IF T-SS = ZERO OR 99                                         I.000818
016590         IF W-SDTD NOT = ZERO                                     I.000922
016600             GO TO UAC-960.                                       I.000922
016610     IF W-DCD NOT = 3                                             I.020227
016620         IF W-SDTD = 99999999                                     I.020227
016630             GO TO UAC-960.                                       I.020227
016640*****IF W-SDTD = ZERO                                             D.020227
016650     IF W-SDTD = ZERO OR 99999999                                 I.020227
016660         GO TO UAC-990.                                           I.001030
016670*****    GO TO UAC-980.                                           D.001030
016680     IF W-SDTG < 1 OR > 12
016690         GO TO UAC-960.                                           I.000922
016700*****    GO TO UAC-940.                                           D.000922
016710     IF W-SDTP < 1 OR > 31
016720         GO TO UAC-960.                                           I.000922
016730*****    GO TO UAC-940.                                           D.000922
016740     IF W-SDTN NOT = W-ND AND (W-ND + 1)
016750         GO TO UAC-960.                                           I.000922
016760*****    GO TO UAC-940.                                           D.000922
016770*****IF W-NGP > W-SDTD                                            D.001025
016780*****    GO TO UAC-960.                                           D.001025
016790 UAC-980.                                                         I.000922
016800*****IF W-SDATE NOT = ZERO                                        D.020205
016810*****IF W-SDATE NOT = ZERO AND 99999999                           D.020227
016820     IF W-SDATE NOT = ZERO                                        I.020227
016830         IF W-SDATE >= W-SDTD                                     I.000922
016840             DISPLAY E-ME25 E-ME99                                I.000922
016850             DISPLAY E-CL                                         I.000922
016860             GO TO UAC-960.                                       I.000922
016870*****IF W-SDATE = 99999999                                        D.020227
016880*****    IF W-NGD >= W-SDTNG                                      D.020227
016890*****        DISPLAY E-ME25 E-ME99                                D.020227
016900*****        DISPLAY E-CL                                         D.020227
016910*****        GO TO UAC-960.                                       D.020227
016920     IF W-NGP > W-SDTD                                            I.001025
016930         GO TO UAC-960.                                           I.001025
016940*****    GO TO UAC-940.                                           D.000922
016950 UAC-990.
016960     ACCEPT AU-DMM.
016970     IF ESTAT = BTB
016980         GO TO UAC-960.
016990     IF ESTAT NOT = HTB AND SKP
017000         GO TO UAC-990.
017010     IF W-DMM = 9
017020         DISPLAY E-ME90 E-ME98
017030         GO TO UAC-040.
017040     IF W-DMM NOT = 1
017050         GO TO UAC-990.
017060 UAC-EX.
017070     EXIT.
017080*---------------  値引入力  ----------------------------------------------
017090 NAC-RTN.
017100     IF W-NGP NOT = ZERO
017110         GO TO NAC-040.
017120     DISPLAY C-CLEAR.
017130     CALL "SCHD11".
017140 NAC-020.
017150     ACCEPT AN-NGP.
017160     DISPLAY E-CL.
017170     IF ESTAT = C2 OR PF9
017180         MOVE 1 TO W-END
017190         GO TO NAC-EX.
017200     IF ESTAT = BTB
017210         GO TO NAC-EX.
017220     IF ESTAT NOT = HTB AND SKP
017230         GO TO NAC-020.
017240     IF W-NGPS = ZERO
017250         MOVE DATE-02R TO W-NGPS
017260         DISPLAY AN-NGP.
017270     IF W-GD > 12 OR < 1
017280         GO TO NAC-020.
017290     IF W-PD > 31 OR < 1
017300         GO TO NAC-020.
017310     MOVE ZERO TO W-ND1.
017320     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
017330         ADD DATE-NC1 TO W-ND.
017340     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
017350         ADD DATE-NC2 TO W-ND.
017360     IF W-CNG NOT = W-NGD
017370         DISPLAY E-ME12 E-ME98
017380         GO TO NAC-020.
017390 NAC-040.
017400     CALL "SCHD11".
017410     DISPLAY AN-NGP.
017420     ACCEPT AN-TCD.
017430     IF ESTAT = C2 OR PF9
017440         MOVE 1 TO W-END
017450         GO TO NAC-EX.
017460     IF ESTAT = BTB
017470         GO TO NAC-020.
017480     IF ESTAT NOT = HTB AND SKP
017490         GO TO NAC-040.
017500     PERFORM TM-RTN THRU TM-EX.
017510     IF W-INV = 1
017520         DISPLAY E-ME1 E-ME98
017530         GO TO NAC-040.
017540     IF T-BC NOT = ZERO
017550         DISPLAY E-ME1 E-ME98
017560         GO TO NAC-040.
017570 NAC-060.
017580     ACCEPT AN-CSC.
017590     IF ESTAT = BTB
017600         GO TO NAC-040.
017610     IF ESTAT NOT = HTB AND SKP
017620         GO TO NAC-060.
017630     IF W-CSCD NOT = 0 AND 9
017640         GO TO NAC-060.
017650*****MOVE SPACE TO W-CSN.                                         D.020405
017660*****IF W-CSCD = 9                                                D.020405
017670*****    MOVE NC"調整分" TO W-CSN.                                D.020405
017680*****DISPLAY DN-CSN.                                              D.020405
017690 NAC-080.
017700     MOVE ZERO TO W-SR W-BR.
017710     MOVE SPACE TO W-BI.
017720     MOVE ZERO TO W-RC W-ASR.                                     I.140324
017730*****MOVE ZERO TO W-RC W-ASR W-HSCD.                              D.140324
017740     IF W-CNGS < 1404                                             I.140324
017750         MOVE 0 TO W-HSCD                                         I.140324
017760       ELSE                                                       I.140324
017770         MOVE 8 TO W-HSCD.                                        I.140324
017780     MOVE 7 TO W-L1.
017790     CALL "SCHD11".
017800     DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC.                         I.020405
017810*****DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC DN-CSN.                  D.020405
017820 NAC-100.
017830     ADD 1 TO W-RC W-L1.
017840     IF W-RC = 7
017850         GO TO NAC-260.
017860     MOVE W-NGP TO W-DATE.
017870     MOVE W-TCDN TO W-TCD.
017880     MOVE W-CSCD TO W-CSC.
017890 NAC-120.
017900     ACCEPT AN-HCD.
017910     DISPLAY E-CL.
017920*****IF ESTAT = C1                                                D.001205
017930     IF ESTAT = C1 OR PF6                                         I.001205
017940         GO TO NAC-240.
017950     IF ESTAT NOT = BTB
017960         GO TO NAC-140.
017970     IF W-RC = 1
017980         GO TO NAC-040.
017990     SUBTRACT 1 FROM W-RC W-L1.
018000     MOVE W-AS(W-RC) TO W-SR.
018010*****IF W-HCD = 999977                                            D.020204
018020     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
018030         GO TO NAC-160.
018040     GO TO NAC-200.
018050 NAC-140.
018060     IF ESTAT NOT = HTB AND SKP
018070         GO TO NAC-120.
018080     MOVE 0 TO W-HIC.                                             I.020214
018090     PERFORM HI-RTN THRU HI-EX.
018100     IF W-EC NOT = ZERO
018110         MOVE 0 TO W-EC
018120         GO TO NAC-120.
018130     MOVE T-TNC TO W-TC2.
018140     MOVE T-FKC TO W-FKC.
018150 NAC-160.
018160*****IF W-HCD NOT = 999977                                        D.020204
018170     IF W-HCD NOT = 999977 AND 999991 AND 999992 AND 999993       I.020204
018180         GO TO NAC-180.
018190     ACCEPT AN-KIN.
018200     IF ESTAT = BTB
018210         GO TO NAC-120.
018220     IF ESTAT NOT = HTB AND SKP
018230         GO TO NAC-160.
018240     MOVE ZERO TO W-SUT W-BT.
018250     DISPLAY DN-SUT DN-BT DN-KIN.
018260     GO TO NAC-220.
018270 NAC-180.
018280     ACCEPT AN-SUT.
018290     IF ESTAT = BTB
018300         GO TO NAC-120.
018310     IF ESTAT NOT = HTB AND SKP
018320         GO TO NAC-180.
018330     DISPLAY DN-SUT.
018340     IF W-SUT < 0                                                 I.001121
018350         GO TO NAC-180.                                           I.001121
018360 NAC-200.
018370     ACCEPT AN-BT.
018380     IF ESTAT = BTB
018390         GO TO NAC-180.
018400     IF ESTAT NOT = HTB AND SKP
018410         GO TO NAC-200.
018420     COMPUTE W-KIN = W-SUT * W-BT.
018430     DISPLAY DN-BT DN-KIN.
018440 NAC-220.
018450     MOVE W-RC TO W-GNO.
018460*****MOVE ZERO TO W-SUS.                                          D.000821
018470     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
018480                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
018490     MOVE W-SR TO W-AS(W-RC).
018500     GO TO NAC-100.
018510 NAC-240.
018520     MOVE ZERO TO W-SR.
018530     MOVE W-SR TO W-AS(W-RC).
018540     DISPLAY SN-DS.
018550     ADD 1 TO W-RC W-L1.
018560     IF W-RC NOT = 7
018570         GO TO NAC-240.
018580 NAC-260.
018590     MOVE ZERO TO W-DKIN CNT.
018600 NAC-280.
018610     ADD 1 TO CNT.
018620     IF CNT = 7
018630         DISPLAY DN-DKIN
018640         GO TO NAC-300.
018650     MOVE W-AS(CNT) TO W-SR.
018660     ADD W-KIN TO W-DKIN.
018670     GO TO NAC-280.
018680 NAC-300.
018690     DISPLAY AN-BI.
018700     ACCEPT AN-BI.
018710     IF ESTAT = BTB
018720         GO TO NAC-360.
018730     IF ESTAT NOT = HTB AND SKP
018740         GO TO NAC-300.
018750     IF T-ZEI = 1                                                 I.070319
018760         IF W-CNGS < 1404                                         I.140324
018770             MOVE 8 TO W-HSCD                                     I.140324
018780           ELSE                                                   I.140324
018790             MOVE 0 TO W-HSCD.                                    I.140324
018800*****        MOVE 8 TO W-HSCD.                                    D.140324
018810     IF T-FKC = 99                                                I.040708
018820         IF W-CNGS < 1404                                         I.140324
018830             MOVE 8 TO W-HSCD                                     I.140324
018840           ELSE                                                   I.140324
018850             MOVE 0 TO W-HSCD.                                    I.140324
018860*****    MOVE 8 TO W-HSCD.                                        D.140324
018870     DISPLAY AN-HSC AN-SDT.
018880*****IF W-SDTD = ZERO                                             D.000922
018890*****    GO TO NAC-330.                                           D.000922
018900     GO TO NAC-340.
018910 NAC-320.
018920     ACCEPT AN-HSC.
018930     IF ESTAT = BTB
018940         GO TO NAC-300.
018950     IF ESTAT NOT = HTB AND SKP
018960         GO TO NAC-320.
018970     IF W-CNGS < 1404                                             I.140324
018980         IF W-HSCD NOT = 0 AND 3 AND 8
018990             GO TO NAC-320.
019000     IF W-CNGS NOT < 1404                                         I.140324
019010         IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                I.140324
019020             GO TO NAC-320.                                       I.130324
019030     IF T-SS = 00 OR 99                                           I.001030
019040         MOVE ZERO TO W-SDTD                                      I.001030
019050         DISPLAY AN-SDT                                           I.001030
019060         GO TO NAC-340.                                           I.001030
019070 NAC-330.
019080     ACCEPT AN-SDT.
019090     IF ESTAT = BTB
019100         GO TO NAC-320.
019110     IF ESTAT NOT = HTB AND SKP
019120         GO TO NAC-330.
019130*****IF T-SS = ZERO OR 99                                         D.001030
019140     IF W-SDTD = ZERO                                             I.000818
019150         GO TO NAC-340.                                           I.000818
019160     IF W-SDTG < 1 OR > 12
019170         GO TO NAC-330.
019180     IF W-SDTP < 1 OR > 31
019190         GO TO NAC-330.
019200     IF W-SDTN NOT = W-ND AND (W-ND + 1)
019210         GO TO NAC-330.
019220     IF W-NGP > W-SDTD
019230         GO TO NAC-330.
019240     IF W-SDATE NOT = ZERO                                        I.000922
019250         IF W-SDATE >= W-SDTD                                     I.000922
019260             DISPLAY E-ME25 E-ME99                                I.000922
019270             DISPLAY E-CL                                         I.000922
019280             GO TO NAC-330.                                       I.000922
019290 NAC-340.
019300     ACCEPT AN-DMM.
019310     IF ESTAT = BTB
019320         IF T-SS = 00 OR 99                                       I.001030
019330             GO TO NAC-320                                        I.001030
019340           ELSE                                                   I.001030
019350             GO TO NAC-330.
019360     IF ESTAT NOT = HTB AND SKP
019370         GO TO NAC-340.
019380     IF W-DMM = 1
019390         GO TO NAC-EX.
019400     IF W-DMM = 9
019410         GO TO NAC-040.
019420     GO TO NAC-340.
019430 NAC-360.
019440     IF W-RC = 1
019450         GO TO NAC-080.
019460     SUBTRACT 1 FROM W-RC.
019470     MOVE W-AS(W-RC) TO W-SR.
019480     SUBTRACT 1 FROM W-L1.
019490     IF W-HCD = ZERO
019500         GO TO NAC-360.
019510*****IF W-HCD = 999977                                            D.020204
019520     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
019530         GO TO NAC-160.
019540     GO TO NAC-200.
019550 NAC-EX.
019560     EXIT.
019570*------------------------------------------------------------------------
019580 TAN-RTN.
019590     MOVE 0 TO WK-TAN.
019600*****MOVE W-TCDD TO THTN-01.                                      D.010419
019610*****MOVE W-HCD TO THTN-02.                                       D.010419
019620*****MOVE W-SIZ TO THTN-03.                                       D.010419
019630*****READ JT-THTN UNLOCK INVALID                                  D.010419
019640     MOVE W-TCD TO THT-TCD.                                       I.010419
019650     MOVE W-HCD TO THT-HCD.                                       I.010419
019660     MOVE W-SIZ TO THT-SIZ.                                       I.010419
019670     READ THTM UNLOCK INVALID                                     I.010419
019680         MOVE ZERO TO THT-T.                                      I.020405
019690*****    GO TO TAN-020.                                           D.020405
019700     MOVE THT-T TO WK-TAN.                                        I.010419
019710*****MOVE THTN-04 TO WK-TAN.                                      D.010419
019720*TAN-020.                                                         D.020405
019730     IF WK-TAN NOT = ZERO
019740         GO TO TAN-090.                                           I.010419
019750*****    GO TO TAN-EX.                                            D.010419
019760*****MOVE W-TCDD TO THTN-01.                                      D.010419
019770*****MOVE W-HCD TO THTN-02.                                       D.010419
019780*****MOVE 9 TO THTN-03.                                           D.010419
019790*****READ JT-THTN UNLOCK INVALID                                  D.010419
019800     MOVE W-TCD TO THT-TCD.                                       I.010419
019810     MOVE W-HCD TO THT-HCD.                                       I.010419
019820     MOVE 9 TO THT-SIZ.                                           I.010419
019830     READ THTM UNLOCK INVALID                                     I.010419
019840         MOVE ZERO TO THT-T.                                      I.020405
019850*****    GO TO TAN-040.                                           D.020405
019860*****    GO TO TAN-EX.                                            D.010802
019870     MOVE THT-T TO WK-TAN.                                        I.010419
019880     IF WK-TAN NOT = ZERO                                         I.010802
019890         GO TO TAN-090.                                           I.010802
019900*****MOVE THTN-04 TO WK-TAN.                                      D.010419
019910*TAN-040.                                                         D.020405
019920     IF HI-MHCD = HI-HCD                                          I.010802
019930         GO TO TAN-090.                                           I.020405
019940*****    GO TO TAN-EX.                                            D.020405
019950     MOVE W-TCD TO THT-TCD.                                       I.010802
019960     MOVE HI-MHCD TO THT-HCD.                                     I.010802
019970     MOVE W-SIZ TO THT-SIZ.                                       I.010802
019980     READ THTM UNLOCK INVALID                                     I.010802
019990         MOVE ZERO TO THT-T.                                      I.020405
020000*****    GO TO TAN-060.                                           D.020405
020010     MOVE THT-T TO WK-TAN.                                        I.010802
020020*TAN-060.                                                         D.020405
020030     IF WK-TAN NOT = ZERO                                         I.010802
020040         GO TO TAN-090.                                           I.010802
020050     MOVE W-TCD TO THT-TCD.                                       I.010802
020060     MOVE HI-MHCD TO THT-HCD.                                     I.010802
020070     MOVE 9 TO THT-SIZ.                                           I.010802
020080     READ THTM UNLOCK INVALID                                     I.010802
020090         MOVE ZERO TO THT-T.                                      I.020405
020100*****    GO TO TAN-090.                                           D.020405
020110*****    GO TO TAN-EX.                                            D.020215
020120     MOVE THT-T TO WK-TAN.                                        I.010802
020130 TAN-090.                                                         I.010419
020140     IF WK-TAN NOT = ZERO                                         I.010419
020150         MOVE WK-TAN TO W-BT                                      I.010802
020160         GO TO TAN-EX.                                            I.010802
020170*****IF HI-BC1 > 19 AND < 30                                      D.070305
020180*****    MOVE HI-SB TO WK-TAN                                     D.070305
020190*****    MOVE WK-TAN TO W-BT.                                     D.070305
020200*****    MOVE HI-SB TO WK-TAN.                                    D.020401
020210*****    MOVE WK-TAN TO W-BT.                                     D.010802
020220 TAN-EX.
020230     EXIT.
020240*
020250 TAO-RTN.                                                         I.110407
020260     MOVE 0 TO WK-TAN.                                            I.110407
020270     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020280     MOVE W-HCD TO OTHT-HCD.                                      I.110407
020290     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
020300     READ OTHTM UNLOCK INVALID                                    I.110407
020310         MOVE ZERO TO OTHT-T.                                     I.110407
020320     MOVE OTHT-T TO WK-TAN.                                       I.110407
020330     IF WK-TAN NOT = ZERO                                         I.110407
020340         GO TO TAO-090.                                           I.110407
020350     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020360     MOVE W-HCD TO OTHT-HCD.                                      I.110407
020370     MOVE 9 TO OTHT-SIZ.                                          I.110407
020380     READ OTHTM UNLOCK INVALID                                    I.110407
020390         MOVE ZERO TO OTHT-T.                                     I.110407
020400     MOVE OTHT-T TO WK-TAN.                                       I.110407
020410     IF WK-TAN NOT = ZERO                                         I.110407
020420         GO TO TAO-090.                                           I.110407
020430     IF HI-MHCD = HI-HCD                                          I.110407
020440         GO TO TAO-090.                                           I.110407
020450     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020460     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
020470     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
020480     READ OTHTM UNLOCK INVALID                                    I.110407
020490         MOVE ZERO TO OTHT-T.                                     I.110407
020500     MOVE OTHT-T TO WK-TAN.                                       I.110407
020510     IF WK-TAN NOT = ZERO                                         I.110407
020520         GO TO TAO-090.                                           I.110407
020530     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020540     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
020550     MOVE 9 TO OTHT-SIZ.                                          I.110407
020560     READ OTHTM UNLOCK INVALID                                    I.110407
020570         MOVE ZERO TO OTHT-T.                                     I.110407
020580     MOVE OTHT-T TO WK-TAN.                                       I.110407
020590 TAO-090.                                                         I.110407
020600     IF WK-TAN NOT = ZERO                                         I.110407
020610         MOVE WK-TAN TO W-BT                                      I.110407
020620         GO TO TAO-EX.                                            I.110407
020630 TAO-EX.                                                          I.110407
020640     EXIT.                                                        I.110407
020650*------------------------------------------------------------------------
020660 SD-RTN.
020670     CLOSE S-TRAN.
020680     OPEN I-O S-TRAN.
020690 SD-020.
020700     READ S-TRAN AT END
020710         GO TO SD-EX.
020720     IF W-DNO NOT = S-DNO
020730         GO TO SD-020.
020740     MOVE ""FF"" TO S-R.
020750     REWRITE S-R.
020760     IF ERR-STAT NOT = "00"
020770         DISPLAY E-STAT E-ME17 E-ME99.
020780     GO TO SD-020.
020790 SD-EX.
020800     EXIT.
020810*------------------------------------------------------------------------
020820 HMN-RTN.
020830     INITIALIZE W-ASR W-BR.
020840     MOVE SPACE TO W-BI.
020850     MOVE ZERO TO W-DCD.                                          I.010327
020860     MOVE HSMS-061 TO W-TCDD.                                     I.020214
020870     PERFORM TM-RTN THRU TM-EX.                                   I.020214
020880     IF W-INV = 1                                                 I.020214
020890         DISPLAY E-ME2 E-ME99                                     I.020214
020900         GO TO HMN-EX.                                            I.020214
020910 HMN-020.
020920*****IF HSMS-02 NOT = 7                                           D.010419
020930     IF HSMS-02 = 7                                               I.010419
020940         MOVE HSMS-15 TO W-BI                                     I.010419
020950         GO TO HMN-035.                                           I.010419
020960     IF HSMS-13 = 4 OR 5
020970         MOVE 4 TO HSMS-03.
020980     MOVE ZERO TO W-SR.                                           I.010419
020990     MOVE SPACE TO W-BIK.                                         I.010419
021000     MOVE HSMS-02 TO W-GNO.                                       I.020214
021010     MOVE W-NGP TO W-DATE.                                        I.010419
021020     MOVE HSMS-03 TO W-DC.                                        I.010419
021030     MOVE W-TCDN TO W-TCD.                                        I.020205
021040     MOVE W-TCDD TO W-TCD2.                                       I.020205
021050*****MOVE HSMS-061 TO W-TCD W-TCD2.                               D.020205
021060     MOVE HSMS-09 TO W-HCD.                                       I.010419
021070     MOVE HSMS-10 TO W-SIZ.                                       I.010419
021080     MOVE HSMS-1211(01) TO W-SU(01).                              I.010419
021090     MOVE HSMS-1211(02) TO W-SU(02).                              I.010419
021100     MOVE HSMS-1211(03) TO W-SU(03).                              I.010419
021110     MOVE HSMS-1211(04) TO W-SU(04).                              I.010419
021120     MOVE HSMS-1211(05) TO W-SU(05).                              I.010419
021130     MOVE HSMS-1211(06) TO W-SU(06).                              I.010419
021140     MOVE HSMS-1211(07) TO W-SU(07).                              I.010419
021150     MOVE HSMS-1211(08) TO W-SU(08).                              I.010419
021160     MOVE HSMS-1211(09) TO W-SU(09).                              I.010419
021170     MOVE HSMS-1211(10) TO W-SU(10).                              I.010419
021180     MOVE HSMS-122 TO W-SUT.                                      I.010419
021190     MOVE HSMS-07 TO W-SOK.                                       I.010419
021200     MOVE HSMS-14 TO W-KOSU.                                      I.010419
021210     MOVE HSMS-062 TO W-CCD.                                      I.010419
021220     MOVE HSMS-22 TO W-BIK.                                       I.010419
021230     MOVE HSMS-24 TO W-USC.                                       I.040324
021240     MOVE 1 TO W-HIC.                                             I.020214
021250     PERFORM HI-RTN THRU HI-EX.                                   I.020214
021260     PERFORM TAN-RTN THRU TAN-EX.                                 I.010419
021270     COMPUTE W-KIN = W-SUT * W-BT.                                I.010419
021280     IF W-DC = 2 OR 6                                             I.020221
021290         MOVE ZERO TO W-FT                                        I.020221
021300       ELSE                                                       I.020221
021310         MOVE HI-FT TO W-FT.                                      I.020214
021320     MOVE T-TNC TO W-TC2.                                         I.020214
021330     MOVE T-FKC TO W-FKC.                                         I.020214
021340     MOVE W-SR TO W-AS(HSMS-02).                                  I.010419
021350*****IF HSMS-02 NOT = 7                                           D.010314
021360*****    IF HSMS-03 NOT = 0 AND 4                                 D.010314
021370*****        MOVE 0 TO HSMS-03.                                   D.010314
021380*****IF HSMS-02 NOT = 7                                           D.010419
021390*****    MOVE ZERO TO W-SR                                        D.010419
021400*****    MOVE SPACE TO W-BIK                                      D.010419
021410*****    MOVE W-NGP TO W-DATE                                     D.010419
021420*****    MOVE HSMS-03 TO W-DC                                     D.010419
021430*****    MOVE HSMS-061 TO W-TCD W-TCD2                            D.010419
021440*****    MOVE HSMS-09 TO W-HCD                                    D.010419
021450*****    MOVE HSMS-10 TO W-SIZ                                    D.010419
021460*****    MOVE HSMS-1211(01) TO W-SU(01)                           D.010419
021470*****    MOVE HSMS-1211(02) TO W-SU(02)                           D.010419
021480*****    MOVE HSMS-1211(03) TO W-SU(03)                           D.010419
021490*****    MOVE HSMS-1211(04) TO W-SU(04)                           D.010419
021500*****    MOVE HSMS-1211(05) TO W-SU(05)                           D.010419
021510*****    MOVE HSMS-1211(06) TO W-SU(06)                           D.010419
021520*****    MOVE HSMS-1211(07) TO W-SU(07)                           D.010419
021530*****    MOVE HSMS-1211(08) TO W-SU(08)                           D.010419
021540*****    MOVE HSMS-1211(09) TO W-SU(09)                           D.010419
021550*****    MOVE HSMS-1211(10) TO W-SU(10)                           D.010419
021560*****    MOVE HSMS-122 TO W-SUT                                   D.010419
021570*****    MOVE HSMS-07 TO W-SOK                                    D.010419
021580*****    MOVE HSMS-14 TO W-KOSU                                   D.010419
021590*****    MOVE HSMS-062 TO W-CCD                                   D.010419
021600*****    MOVE HSMS-22 TO W-BIK                                    D.010419
021610*****    MOVE W-SR TO W-AS(HSMS-02)                               D.010419
021620*****  ELSE                                                       D.010419
021630*****    MOVE HSMS-15 TO W-BI.                                    D.010419
021640 HMN-035.                                                         I.010419
021650     READ HSMSF NEXT RECORD AT END
021660         GO TO HMN-040.
021670     IF W-HMN = HSMS-01
021680         GO TO HMN-020.
021690 HMN-040.
021700     MOVE W-SOK TO W-SCD.
021710*****MOVE W-DATE TO W-NGP.                                        D.020214
021720*****MOVE W-TCD TO W-TCDN W-TCDD.                                 D.020214
021730     MOVE W-CCD TO W-CCDD.
021740     MOVE W-KOSU TO W-KOSUR.
021750*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.140324
021760     IF W-CNGS < 1404                                             I.140324
021770         MOVE 0 TO W-HSCD                                         I.140324
021780       ELSE                                                       I.140324
021790         MOVE 8 TO W-HSCD.                                        I.140324
021800     MOVE ZERO TO W-FRCD.                                         I.140324
021810 HMN-060.
021820     MOVE 3 TO JCON3-01.
021830     MOVE W-SCD TO JCON3-02.
021840     READ JCON UNLOCK INVALID
021850         MOVE  SPACE TO JCON3-03.
021860     MOVE W-SCD TO W-SOK.
021870     DISPLAY AU-SOK DU-SNA.
021880*
021890*****PERFORM TM-RTN THRU TM-EX.                                   D.020214
021900*****IF W-INV = 1                                                 D.020214
021910*****    DISPLAY E-ME2 E-ME99                                     D.020214
021920*****    GO TO HMN-EX.                                            D.020214
021930*****MOVE W-HMN TO W-HN1.                                         D.010327
021940*****DISPLAY AU-HN1.                                              D.010327
021950*****MOVE 1 TO W-HNC.                                             D.010327
021960*****MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                         D.010327
021970     IF W-DC = 1 OR 2                                             I.010327
021980         MOVE W-DC TO W-DCD                                       I.020320
021990         MOVE ZERO TO W-HNOD                                      I.081222
022000*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
022010*****    DISPLAY SU-HMN                                           D.020214
022020       ELSE                                                       I.010327
022030         MOVE W-HMN TO W-HNOD.                                    I.081222
022040*****    MOVE W-HMN TO W-HN1                                      D.081222
022050*****    DISPLAY AU-HN1                                           D.081222
022060*****    MOVE 1 TO W-HNC                                          D.081222
022070*****    MOVE ZERO TO W-HN2 W-HN3 W-HN4 W-HN5 W-HN6               D.081222
022080*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6.              D.081222
022090     PERFORM TCM-RTN THRU TCM-EX.
022100     IF W-INV = 1                                                 I.001031
022110         DISPLAY E-ME1 E-ME99                                     I.001031
022120         GO TO HMN-EX.                                            I.001031
022130     IF W-CNGS < 1404                                             I.140324
022140         MOVE 0 TO W-HSCD                                         I.140324
022150       ELSE                                                       I.140324
022160         MOVE 8 TO W-HSCD.                                        I.140324
022170     MOVE ZERO TO W-FRCD.                                         I.140324
022180*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.140324
022190     DISPLAY AU-BI DU-KOSU AU-HSC AU-FRC.
022200 HMN-EX.
022210     EXIT.
022220*------------------------------------------------------------------------
022230 DSP-RTN.
022240     MOVE 1 TO W-L1.
022250     MOVE 2 TO W-L2.
022260     MOVE 3 TO W-L3.
022270     MOVE ZERO TO W-RC W-ZC W-GSUT W-RCB W-LB.                    I.020409
022280*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT W-RCB W-LB.              D.020409
022290*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT.                         D.020403
022300 DSP-020.
022310     ADD 1 TO W-RC.
022320     ADD 3 TO W-L1 W-L2 W-L3.
022330     IF W-RC > 6
022340         GO TO DSP-080.
022350*
022360     INITIALIZE W-SR.
022370     MOVE W-AS(W-RC) TO W-SR.
022380     IF W-HCD = ZERO
022390         DISPLAY SU-D1 SU-D2 SU-D3
022400         GO TO DSP-020.
022410*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
022420     MOVE W-HCD TO HI-KEY.
022430     READ HI-M WITH UNLOCK INVALID KEY
022440         MOVE SPACE TO HI-NAME.
022450     DISPLAY AU-DC AU-HCD DU-HNA.
022460     IF W-HCD >= 999900
022470         DISPLAY SU-D2 SU-D31
022480         GO TO DSP-060.
022490     DISPLAY AU-SIZ.
022500     IF W-SIZ = 1
022510         DISPLAY DU-S1.
022520     IF W-SIZ = 2
022530         DISPLAY DU-S2.
022540     IF W-SIZ = 3
022550         DISPLAY DU-S3.
022560     IF W-SIZ = 4
022570         DISPLAY DU-S4.
022580     MOVE ZERO TO W-SC.
022590     MOVE -3 TO W-C.
022600 DSP-040.
022610     ADD 1 TO W-SC.
022620     IF W-SC > 8
022630         ADD 5 TO W-C
022640       ELSE
022650         ADD 6 TO W-C.
022660     IF W-SC = 11
022670         GO TO DSP-060.
022680     IF W-SC < 8
022690         DISPLAY DU-SU
022700       ELSE
022710         DISPLAY DU-SU1.
022720     GO TO DSP-040.
022730 DSP-060.
022740     DISPLAY DU-SUT DU-BT DU-KIN AU-BIK.
022750     IF W-DC = 4
022760         MOVE ZERO TO W-FT
022770         DISPLAY SU-KIN SU-BT.
022780     IF W-HCD < 999900                                            I.090120
022790         ADD W-SUT TO W-GSUT.
022800     IF W-DC NOT = 7                                              I.020401
022810         IF W-BT = ZERO                                           I.020401
022820             DISPLAY E-ME15 E-ME99                                I.020401
022830             DISPLAY E-CL                                         I.020404
022840             IF W-DSPC = 1                                        I.020404
022850                 IF W-RCB = ZERO                                  I.020404
022860                     MOVE W-RC TO W-RCB                           I.020404
022870                     MOVE W-L TO W-LB.                            I.020404
022880*****        DISPLAY E-CL.                                        D.020404
022890     GO TO DSP-020.
022900 DSP-080.
022910     DISPLAY DU-GSUT.
022920 DSP-EX.
022930     EXIT.
022940*------------------------------------------------------------------------
022950 TM-RTN.
022960     MOVE 0 TO W-INV.
022970     MOVE W-TCDD TO W-TCDN.
022980     IF W-TCDN = 0460
022990         MOVE 0458 TO W-TCDN.                                     I.010206
023000*****    MOVE 0459 TO W-TCDN.                                     D.010206
023010     MOVE W-TCDN TO T-KEY.
023020     READ T-M WITH UNLOCK INVALID KEY
023030         MOVE SPACE TO T-NAME
023040         MOVE 1 TO W-INV.
023050     IF W-UNCD = 0
023060         DISPLAY AU-TCD DU-TNA
023070       ELSE
023080         DISPLAY AN-TCD DN-TNA.
023090*
023100     MOVE W-TCDN TO TSK-KEY.                                      I.000922
023110     READ TSKF WITH UNLOCK INVALID KEY                            I.000922
023120         MOVE ZERO TO TSK-R.                                      I.000922
023130     MOVE TSK-ZNGP(4) TO W-SDATE.                                 I.000922
023140     IF TSK-ZNGP(5) NOT = ZERO                                    I.000922
023150         MOVE TSK-ZNGP(5) TO W-SDATE.                             I.020207
023160*****    MOVE 99999999 TO W-SDATE.                                D.020207
023170*
023180     MOVE ZERO TO W-SDTD.
023190*****IF W-SDATE = 99999999                                        D.020207
023200*****    GO TO TM-EX.                                             D.020207
023210     MOVE W-NGP TO W-SDTD.
023220 TM-020.
023230     MOVE T-SS TO W-SDTP.
023240     IF W-SDTP = 00 OR 99
023250         MOVE ZERO TO W-SDTD
023260         GO TO TM-EX.
023270     IF W-SDTP = 30 OR 31
023280         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
023290             MOVE 31 TO W-SDTP
023300           ELSE
023310             IF W-SDTG = 4 OR 6 OR 9 OR 11
023320                 MOVE 30 TO W-SDTP
023330               ELSE
023340                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1
023350                                           REMAINDER W-DTW2
023360                 IF W-DTW2 = 0
023370                     MOVE 29 TO W-SDTP
023380                   ELSE
023390                     MOVE 28 TO W-SDTP.
023400     IF W-NGP > W-SDTD
023410         IF W-GD NOT = W-SDTG
023420             MOVE ZERO TO W-SDTD
023430             GO TO TM-EX                                          I.001102
023440*****        MOVE T-SS TO W-SDTP                                  D.001102
023450           ELSE
023460             ADD 1 TO W-SDTG
023470             GO TO TM-040.                                        I.001102
023480*****        GO TO TM-020.                                        D.001102
023490     IF W-SDATE NOT = ZERO                                        I.000922
023500         IF W-SDATE >= W-SDTD                                     I.000922
023510             ADD 1 TO W-SDTG
023520             GO TO TM-040.                                        I.001102
023530     GO TO TM-EX.                                                 I.001102
023540*****        GO TO TM-020.                                        D.001102
023550 TM-040.                                                          I.001102
023560     IF W-SDTG = 13                                               I.001102
023570         MOVE 1 TO W-SDTG                                         I.001102
023580         ADD 1 TO W-SDTN.                                         I.001102
023590     GO TO TM-020.                                                I.001102
023600 TM-EX.
023610     EXIT.
023620*------------------------------------------------------------------------
023630*TAZ-RTN.                                                         D.070124
023640*****IF W-DC NOT = 0                                              D.070124
023650*****    GO TO TAZ-EX.                                            D.070124
023660*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
023670*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
023680*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
023690*****    GO TO TAZ-EX.                                            D.070124
023700*****DISPLAY E-ME11 E-ME99.                                       D.070124
023710*TAZ-EX.                                                          D.070124
023720*****EXIT.                                                        D.070124
023730*------------------------------------------------------------------------
023740 TCM-RTN.
023750     IF W-CCDD = ZERO
023760         DISPLAY SU-CNA
023770*****    MOVE SPACE TO W-CNA                                      D.020425
023780         GO TO TCM-EX.
023790     MOVE 0 TO W-INV.
023800     MOVE W-TCDD TO TC-TCD.
023810     MOVE W-CCDD TO TC-CCD.
023820     READ TC-M WITH UNLOCK INVALID KEY
023830         MOVE SPACE TO TC-NAME
023840         MOVE 1 TO W-INV.
023850     DISPLAY AU-CCD DU-CNA.
023860*****MOVE TC-NAME TO W-CNA.                                       D.020425
023870*****IF W-CCDD = 001                                              D.020425
023880*****    MOVE SPACE TO W-CNA.                                     D.020425
023890     MOVE 9999999 TO TC-KEY.
023900     READ TC-M WITH UNLOCK INVALID KEY
023910         MOVE 9 TO W-INV.
023920 TCM-EX.
023930     EXIT.
023940*------------------------------------------------------------------------
023950 HI-RTN.
023960     MOVE W-HCD TO W-HCDD.
023970     IF W-HIC = 0                                                 I.020214
023980         IF W-UNCD = 0
023990             DISPLAY AU-HCD
024000           ELSE
024010             DISPLAY AN-HCD.
024020     IF W-HCD = ZERO
024030         MOVE 9 TO W-EC
024040         GO TO HI-EX.
024050     MOVE W-HCD TO HI-KEY.
024060     READ HI-M WITH UNLOCK INVALID KEY
024070         MOVE 9 TO W-EC
024080         GO TO HI-EX.
024090     IF W-HIC = 0                                                 I.020214
024100         IF W-UNCD = 0
024110             DISPLAY DU-HNA
024120           ELSE
024130             DISPLAY DN-HNA.
024140     MOVE HI-BC1 TO W-BC1.
024150     MOVE HI-BC2 TO W-BC2.
024160     MOVE HI-BC3 TO W-BC3.
024170     MOVE HI-BMC TO W-BMC.                                        I.020511
024180     MOVE HI-BMNO TO W-BMNO.                                      I.020511
024190     IF W-UNCD NOT = 0
024200         GO TO HI-EX.
024210     IF W-HCD < 999900
024220        IF HI-FT = ZERO
024230           DISPLAY E-ME7 E-ME98.
024240     IF W-DC NOT = 0 AND 3 AND 4 AND 5 AND 7
024250         IF W-HCD < 999900
024260            IF HI-FT = 1
024270                DISPLAY E-ME7 E-ME98.                             I.020418
024280*****           DISPLAY E-ME7 E-ME98                              D.020418
024290*****           MOVE 9 TO W-EC.                                   D.020418
024300*
024310     MOVE W-HCD TO HUH-KEY.                                       I.020215
024320     READ HUH-M WITH UNLOCK INVALID KEY                           I.020215
024330         DISPLAY E-ME28 E-ME99                                    I.020215
024340         DISPLAY E-CL                                             I.020215
024350         GO TO HI-EX.                                             I.020215
024360     IF (HUH-ZK NOT = ZERO) AND (HUH-ZS NOT = ZERO)               I.020215
024370         COMPUTE W-FTD = HUH-ZK / HUH-ZS                          I.020215
024380         IF HI-FT NOT = W-FTD                                     I.020215
024390             MOVE 9 TO W-EC                                       I.020215
024400             DISPLAY E-ME29 E-ME99                                I.020215
024410             DISPLAY E-CL                                         I.020215
024420             GO TO HI-EX.                                         I.020215
024430     IF (HUH-NK NOT = ZERO) AND (HUH-NS NOT = ZERO)               I.020215
024440         COMPUTE W-FTD = HUH-NK / HUH-NS                          I.020215
024450         IF HI-FT NOT = W-FTD                                     I.020215
024460             MOVE 9 TO W-EC                                       I.020215
024470             DISPLAY E-ME29 E-ME99                                I.020215
024480             DISPLAY E-CL                                         I.020215
024490             GO TO HI-EX.                                         I.020215
024500     IF (HUH-UG NOT = ZERO) AND (HUH-SS NOT = ZERO)               I.020215
024510         COMPUTE W-FTD = HUH-UG / HUH-SS                          I.020215
024520         IF HI-FT NOT = W-FTD                                     I.020215
024530             MOVE 9 TO W-EC                                       I.020215
024540             DISPLAY E-ME29 E-ME99                                I.020215
024550             DISPLAY E-CL                                         I.020215
024560             GO TO HI-EX.                                         I.020215
024570     IF (HUH-YK NOT = ZERO) AND (HUH-YS NOT = ZERO)               I.020215
024580         COMPUTE W-FTD = HUH-YK / HUH-YS                          I.020215
024590         IF HI-FT NOT = W-FTD                                     I.020215
024600             MOVE 9 TO W-EC                                       I.020215
024610             DISPLAY E-ME29 E-ME99                                I.020215
024620             DISPLAY E-CL.                                        I.020215
024630 HI-EX.
024640     EXIT.
024650*------------------------------------------------------------------------
024660 UPD-RTN.
024670     ADD 1 TO W-DNOD.
024680     MOVE ZERO TO W-RC.
024690 UPD-020.
024700     ADD 1 TO W-RC.
024710     IF W-RC > 6
024720         GO TO UPD-180.
024730     MOVE W-AS(W-RC) TO W-SR.
024740     IF W-DATE = ZERO
024750         GO TO UPD-180.
024760     MOVE W-DNOD TO W-DNO.
024770     MOVE W-SDTD TO W-SDT.
024780     MOVE W-HSCD TO W-HSC.
024790     IF W-UNCD = 0
024800         MOVE W-KOSUR TO W-KOSU
024810         MOVE W-FRCD TO W-FRC.
024820     MOVE W-UNCD TO W-UNC.
024830     MOVE W-SR TO S-R.
024840     WRITE S-R.
024850     IF ERR-STAT = "00"
024860         CALL "CBLTCLS" USING S-TRAN
024870         GO TO UPD-040.
024880     DISPLAY E-STAT E-ME16 E-ME99.
024890     GO TO UPD-900.
024900 UPD-040.
024910     IF W-UNCD = 1
024920         GO TO UPD-020.                                           I.000821
024930*****    GO TO UPD-180.                                           D.000821
024940     IF W-HCD = ZERO
024950         GO TO UPD-180.
024960*****IF W-DC NOT = 3 AND 4 AND 9                                  D.070124
024970*****    GO TO UPD-100.                                           D.070124
024980*****    GO TO UPD-020.                                           D.010419
024990*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
025000*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
025010*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
025020*****    GO TO UPD-060.                                           D.070124
025030*****GO TO UPD-100.                                               D.070124
025040*****GO TO UPD-020.                                               D.010419
025050*UPD-060.                                                         D.070124
025060*****MOVE ZERO TO TAZ-R                                           D.070124
025070*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
025080*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
025090*****MOVE W-CNG TO TAZ-NG.                                        D.070124
025100*****WRITE TAZ-R INVALID KEY                                      D.070124
025110*****    DISPLAY E-STAT E-ME10 E-ME99                             D.070124
025120*****    GO TO UPD-080.                                           D.070124
025130*****CALL "CBLTCLS" USING TAZ-M.                                  D.070124
025140*****GO TO UPD-100.                                               D.070124
025150*****GO TO UPD-020.                                               D.010419
025160*UPD-080.                                                         D.070124
025170*****IF ERR-STAT NOT = "24"                                       D.070124
025180*****    DISPLAY E-ME78 E-ME99                                    D.070124
025190*****    DISPLAY E-CL                                             D.070124
025200*****    GO TO UPD-100.                                           D.070124
025210*****    GO TO UPD-020.                                           D.010419
025220*****DISPLAY E-CL.                                                D.070124
025230*****CLOSE TAZ-M.                                                 D.070124
025240*****MOVE "TAZM         " TO W-FILE.                              D.070124
025250*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.070124
025260*****DISPLAY E-CL.                                                D.070124
025270*****OPEN I-O TAZ-M.                                              D.070124
025280*****GO TO UPD-060.                                               D.070124
025290*UPD-100.                                                         D.070124
025300     IF W-DC NOT = 0 AND 3                                        I.010419
025310         GO TO UPD-020.                                           I.010419
025320     IF ZERO = W-TCD OR W-HCD                                     I.010419
025330         GO TO UPD-020.                                           I.010419
025340     IF W-BT = ZERO                                               I.060629
025350         GO TO UPD-020.                                           I.060629
025360     MOVE SPACE TO THT-KEY.                                       I.010419
025370     MOVE W-TCD TO THT-TCD.                                       I.010419
025380     MOVE W-HCD TO THT-HCD.                                       I.010419
025390     MOVE 9 TO THT-SIZ.                                           I.010419
025400     READ THTM INVALID KEY                                        I.010419
025410         GO TO UPD-120.                                           I.010419
025420     GO TO UPD-160.                                               I.010419
025430 UPD-120.                                                         I.010419
025440     MOVE SPACE TO THT-KEY.                                       I.010419
025450     MOVE W-TCD TO THT-TCD.                                       I.010419
025460     MOVE W-HCD TO THT-HCD.                                       I.010419
025470     MOVE W-SIZ TO THT-SIZ.                                       I.010419
025480     READ THTM INVALID KEY                                        I.010419
025490         GO TO UPD-140.                                           I.010419
025500     GO TO UPD-160.                                               I.010419
025510 UPD-140.                                                         I.010419
025520     MOVE ZERO TO THT-R.                                          I.010419
025530     MOVE W-TCD TO THT-TCD THT-TCD2.                              I.010419
025540     MOVE W-HCD TO THT-HCD.                                       I.010419
025550     MOVE 9 TO THT-SIZ.                                           I.010419
025560     MOVE W-BT TO THT-T.                                          I.010419
025570     MOVE W-TC2 TO THT-TNC.                                       I.010419
025580     MOVE W-NGD TO THT-NG.                                        I.010419
025590     WRITE THT-R INVALID KEY                                      I.010419
025600         DISPLAY E-STAT E-ME26 E-ME99                             I.010419
025610         DISPLAY E-CL                                             I.010419
025620         GO TO UPD-020.                                           I.010419
025630     CALL "CBLTCLS" USING THTM.                                   I.010419
025640     GO TO UPD-020.                                               I.010419
025650 UPD-160.                                                         I.010419
025660     IF W-NGD NOT = THT-NG                                        I.010419
025670         MOVE W-NGD TO THT-NG                                     I.010419
025680         REWRITE THT-R INVALID KEY                                I.010419
025690             DISPLAY E-STAT E-ME27 E-ME99                         I.010419
025700             DISPLAY E-CL.                                        I.010419
025710     GO TO UPD-020.                                               I.010419
025720 UPD-180.
025730     INITIALIZE W-SR.
025740     MOVE W-BR TO W-DT1.
025750     MOVE W-DNOD TO W-DNO.
025760     MOVE 9 TO W-GNO.
025770     MOVE W-NGP TO W-DATE.
025780     MOVE W-TCDN TO W-TCD.
025790     MOVE W-UNCD TO W-UNC.
025800     MOVE W-SR TO S-R.
025810     WRITE S-R.
025820     IF ERR-STAT = "00"
025830         CALL "CBLTCLS" USING S-TRAN
025840         GO TO UPD-200.
025850     DISPLAY E-STAT E-ME16 E-ME99.
025860     GO TO UPD-900.
025870 UPD-200.
025880     OPEN I-O HKBM.
025890     MOVE SPACE TO HKB-KEY.
025900     MOVE "05" TO HKB-NO.
025910     READ HKBM INVALID KEY
025920         CLOSE HKBM
025930         MOVE 1 TO W-END
025940         DISPLAY E-ME78 E-ME23 E-ME99
025950         MOVE 255 TO COMPLETION-CODE
025960         GO TO UPD-EX.
025970     MOVE W-DNOD TO HKB-UNN.
025980     IF HKB-UNN = ZERO                                            I.010314
025990         MOVE 1 TO HKB-UNN.                                       I.010314
026000     REWRITE HKB-R INVALID KEY
026010         CLOSE HKBM
026020         MOVE 1 TO W-END
026030         DISPLAY E-STAT E-ME78 E-ME24 E-ME99
026040         MOVE 255 TO COMPLETION-CODE
026050         GO TO UPD-EX.
026060     CLOSE HKBM.
026070*
026080     IF (W-HMN = ZERO) OR (W-HNC = 1)                             I.081222
026090         GO TO UPD-EX.                                            I.081222
026100*****IF W-HMN = ZERO                                              D.011012
026110*****MOVE 0 TO W-HC.                                              D.081222
026120 UPD-220.                                                         I.011012
026130*****ADD 1 TO W-HC.                                               D.081222
026140*****IF W-HC > 6                                                  D.081222
026150*****    GO TO UPD-EX.                                            D.081222
026160*****IF W-HC = 1                                                  D.081222
026170*****    IF W-HMN NOT = ZERO                                      D.081222
026180*****        MOVE W-HMN TO HSMS-01                                D.081222
026190*****        GO TO UPD-230.                                       D.081222
026200*****IF W-HA(W-HC) = ZERO                                         D.081222
026210*****    GO TO UPD-EX.                                            D.081222
026220     MOVE SPACE TO HSMS-KEY.
026230     MOVE W-HMN TO HSMS-01.                                       I.011012
026240*****MOVE W-HMN TO HSMS-01.                                       D.011012
026250*****MOVE W-HA(W-HC) TO HSMS-01.                                  D.081222
026260 UPD-230.                                                         I.030418
026270     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
026280         GO TO UPD-EX.                                            I.081222
026290*****    GO TO UPD-220.                                           D.081222
026300*****    GO TO UPD-EX.                                            D.011012
026310 UPD-240.
026320     READ HSMSF NEXT RECORD AT END
026330         GO TO UPD-EX.                                            I.081222
026340*****    GO TO UPD-220.                                           D.081222
026350*****IF W-HC = 1                                                  D.081222
026360     IF W-HMN NOT = HSMS-01                                       I.030418
026370         GO TO UPD-EX.                                            I.081222
026380*****        GO TO UPD-220.                                       D.081222
026390*****IF W-HC NOT = 1                                              D.081222
026400*****    IF W-HA(W-HC) NOT = HSMS-01                              D.081222
026410*****        GO TO UPD-220.                                       D.081222
026420*****    GO TO UPD-EX.                                            D.011012
026430*****IF W-HMN NOT = HSMS-01                                       D.011012
026440*****    GO TO UPD-EX.                                            D.011012
026450     IF HSMS-19 = 9
026460         GO TO UPD-EX.                                            I.081222
026470*****    GO TO UPD-220.                                           D.081222
026480*****    GO TO UPD-EX.                                            D.011012
026490     ADD 1 TO HSMS-19.
026500     REWRITE HSMS-R1 INVALID KEY
026510         DISPLAY E-STAT E-ME22 E-ME99
026520         DISPLAY E-CL.
026530     GO TO UPD-240.
026540 UPD-900.
026550     PERFORM SD-RTN THRU SD-EX.
026560     MOVE 1 TO W-END.
026570 UPD-EX.
026580     EXIT.
