000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HMD225.
000030*********************************************************
000040*    PROGRAM         :  請求内訳票発行　千曲産業        *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    FORM            :  FHD225                          *
000080*    COMPILE TYPE    :  COBOL                           *
000090*    BASE PROGRAM    :  HMD220                          *
000100*********************************************************
000110 ENVIRONMENT DIVISION.
000120 CONFIGURATION SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.                                                 I.031219
000180     SELECT S-TRAN ASSIGN TO S-MSD
000190         FILE STATUS IS ERR-STAT.
000200     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000210         ORGANIZATION IS INDEXED
000220         ACCESS MODE IS RANDOM
000230         RECORD KEY IS HI-KEY
000240         ALTERNATE RECORD KEY IS HI-KEY2                          I.010802
000250         FILE STATUS IS ERR-STAT.
000260     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000270         ORGANIZATION IS INDEXED
000280         ACCESS MODE IS RANDOM
000290         RECORD KEY IS T-KEY
000300         ALTERNATE  RECORD KEY IS T-KEY2
000310         FILE STATUS IS ERR-STAT.
000320     SELECT TC-M ASSIGN TO TC-MSD
000330         ORGANIZATION INDEXED
000340         RECORD KEY TC-KEY
000350         ACCESS MODE RANDOM
000360         FILE STATUS IS ERR-STAT.
000370     SELECT SP-F ASSIGN TO P-PRN999-FHD225.                       I.081119
000380 I-O-CONTROL.
000390     APPLY SHARED-MODE ON M-DATE                                  I.031219
000400     APPLY SHARED-MODE ON HI-M TC-M
000410     APPLY SHARED-MODE ON T-M
000420     APPLY SHIFT-CODE  ON SP-F.
000430 DATA DIVISION.
000440 FILE SECTION.
000450     COPY LIBFDD.                                                 I.031219
000460     COPY LIHIM.
000470     COPY LITM.
000480     COPY LITCM.
000490 FD  S-TRAN
000500     BLOCK  2 RECORDS
000510     LABEL RECORD STANDARD
000520     VALUE OF IDENTIFICATION IS "SNTRF-2N".
000530 01  S-R                PIC  X(128).                              I.010208
000540 FD  SP-F
000550     LABEL RECORD OMITTED
000560     LINAGE IS 36 LINES.
000570 01  SP-R               PIC  X(170).
000580 WORKING-STORAGE  SECTION.
000590 77  JS-SIGN            PIC  X(001).
000600 77  W-DCHK             PIC  9(001).
000610 77  W-DZC              PIC  9(001) VALUE 0.
000620 77  W-FILE             PIC  X(013).
000630 77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".
000640 77  W-20K              PIC  X(005) VALUE ""3FE04FE080"".
000650 77  W-30K              PIC  X(008) VALUE ""3F504F40677F4F9B"".   I.051031
000660 77  W-40K              PIC  X(008) VALUE ""3F504F40674F40A0"".   I.051031
000670 01  W-P01.
000680     02  P-15K1         PIC  X(005).
000690     02  F              PIC  X(080).                              I.081119
000700     02  P-DCM          PIC  N(004).                              I.081119
000710     02  P-CSC          PIC  Z(001).
000720     02  P-DC           PIC  Z(001).
000730     02  P-FRC          PIC  9(001).
000740     02  P-DNOM         PIC  N(002).                              I.081119
000750     02  P-DNO          PIC  9(006).
000760     02  P-NBK          PIC  X(001).                              I.010523
000770     02  F              PIC  X(002).                              I.010523
000780     02  P-SHC          PIC  X(001).                              I.010208
000790 01  W-P02.
000800     02  P-20K1         PIC  X(005).                              I.081119
000810     02  F              PIC  X(086).                              I.041015
000820     02  P-NC           PIC  X(001).
000830     02  P-NEN          PIC  9(002).                              I.081119
000840     02  P-NENM         PIC  N(001).                              I.081119
000850     02  P-GET          PIC  Z(002).                              I.081119
000860     02  P-GETM         PIC  N(001).                              I.081119
000870     02  P-PEY          PIC  Z(002).                              I.081119
000880     02  P-PEYM         PIC  N(001).                              I.081119
000890     02  F              PIC  X(004).                              I.081119
000900 01  W-P03.
000910     02  P-15K2         PIC  X(005).                              I.081119
000920     02  F              PIC  X(048).                              I.081119
000930     02  P-30K          PIC  X(008).                              I.081119
000940     02  P-DPM          PIC  N(008).                              I.081119
000950     02  P-40K          PIC  X(008).                              I.081119
000960     02  F              PIC  X(031).                              I.081119
000970 01  W-P06.                                                       I.020404
000980     02  F              PIC  X(055).                              I.041015
000990     02  P-AZH          PIC  N(006).                              I.020404
001000     02  F              PIC  X(039).                              I.081119
001010 01  W-P07.
001020     02  F              PIC  X(011).                              I.041015
001030     02  P-TNAO         PIC  N(020).                              I.020404
001040     02  F              PIC  X(062).                              I.081119
001050 01  W-P08.
001060     02  F              PIC  X(011).                              I.041015
001070     02  P-TNAU         PIC  N(020).                              I.020404
001080     02  F              PIC  X(003).                              I.020404
001090     02  P-TF           PIC  X(001).                              I.010220
001100     02  P-TNC1         PIC  9(001).                              I.010220
001110     02  P-TV           PIC  X(001).                              I.010220
001120     02  P-DCC          PIC  9(001).                              I.010220
001130     02  P-TR           PIC  X(001).                              I.010220
001140     02  F              PIC  X(001).                              I.051108
001150     02  P-W            PIC  N(002).                              I.051108
001160     02  P-TCD          PIC  9(004).
001170     02  P-V            PIC  X(001).
001180     02  P-CCD          PIC  9(003).
001190     02  F              PIC  X(001).
001200     02  P-X            PIC  X(002).
001210     02  F              PIC  X(039).                              I.081119
001220 01  W-P08A.                                                      I.081119
001230     02  F              PIC  X(017).                              I.081119
001240     02  P-HMM          PIC  N(008).                              I.081119
001250     02  F              PIC  X(012).                              I.081119
001260     02  P-SIZM         PIC  X(041).                              I.081119
001270     02  P-SUM          PIC  N(004).                              I.081119
001280     02  F              PIC  X(001).                              I.081119
001290     02  P-TM           PIC  N(002).                              I.081119
001300     02  F              PIC  X(002).                              I.081119
001310     02  P-KINM         PIC  N(004).                              I.081119
001320     02  F              PIC  X(002).                              I.081119
001330 01  W-P09.
001340     02  F              PIC  X(006).                              I.041015
001350     02  P-HCD          PIC  9(006).
001360     02  F              PIC  X(016).
001370     02  P-F            PIC  X(001).
001380     02  P-BIK          PIC  X(010).
001390     02  P-R            PIC  X(001).
001400     02  F              PIC  X(063).
001410 01  W-P10.
001420     02  F              PIC  X(005).                              I.041015
001430     02  P-HNA          PIC  N(024).
001440     02  P-SIZ          PIC  Z(001).
001450     02  P-SUD.
001460       03  P-SU    OCCURS  10  PIC  Z(004).
001470     02  P-SUT          PIC  -(006).
001480     02  P-T            PIC  Z(005).
001490     02  P-20K2         PIC  X(005).                              I.081119
001500     02  P-D.
001510       03  P-KIN        PIC  -(010).
001520     02  P-AZM   REDEFINES P-D     PIC  N(005).
001530     02  P-15K3         PIC  X(005).                              I.081119
001540 01  W-P11.
001550     02  F              PIC  X(008).                              I.041015
001560     02  P-KOSU         PIC  N(004).
001570     02  P-KO           PIC  N(002).
001580     02  F              PIC  X(007).                              I.020405
001590     02  P-CNAM         PIC  N(032).                              I.020405
001600 01  W-P12.
001610     02  F              PIC  X(003).                              I.081119
001620     02  P-TKM1         PIC  N(002).                              I.081119
001630     02  F              PIC  X(069).                              I.081119
001640     02  P-GOM          PIC  N(004).                              I.081119
001650     02  F              PIC  X(001).                              I.081119
001660     02  P-ASUT         PIC  -(006).
001670     02  F              PIC  X(005).
001680     02  P-AKIN         PIC  -(010).
001690 01  W-P13.
001700     02  F              PIC  X(009).                              I.041015
001710     02  P-BI           PIC  N(024).
001720     02  F              PIC  X(035).
001730     02  P-ZR           PIC  X(004).
001740 01  W-P14.
001750     02  F              PIC  X(011).                              I.041015
001760     02  P-HNM          PIC  N(008).                              I.020405
001770     02  F              PIC  X(001).
001780     02  P-HNO          PIC  9(006).                              I.081224
001790     02  F              PIC  X(045).                              I.081224
001800     02  P-SZM          PIC  N(004).                              I.081119
001810     02  P-SHZ          PIC  -(007).                              I.081119
001820     02  P-TKM          PIC  N(004).                              I.081119
001830     02  P-TKIN         PIC  -(009).                              I.081119
001840 01  W-P15.                                                       I.081119
001850     02  F              PIC  X(003).                              I.081119
001860     02  P-TKM2         PIC  N(002).                              I.081119
001870     02  F              PIC  X(097).                              I.081119
001880     02  P-20K3         PIC  X(005).                              I.081119
001890 01  W-R.                                                         I.010208
001900     02  WR-S1.                                                   I.010208
001910       03  S1-DNO       PIC  9(006).                              I.010208
001920       03  S1-GNO       PIC  9(001).                              I.010208
001930       03  S1-DATE      PIC  9(008).                              I.010208
001940       03  S1-NGP   REDEFINES S1-DATE.                            I.031219
001950         04  S1-NG      PIC  9(006).                              I.031219
001960         04  S1-PEY     PIC  9(002).                              I.031219
001970       03  S1-TCD       PIC  9(004).                              I.010208
001980       03  S1-HCD       PIC  9(006).                              I.010208
001990       03  S1-SIZ       PIC  9(001).                              I.010208
002000       03  S1-ASU.                                                I.010208
002010         04  S1-SUD   OCCURS 10.                                  I.010208
002020           05  S1-SU    PIC S9(004)   COMP-3.                     I.010208
002030       03  S1-SUT       PIC S9(005).                              I.010208
002040       03  S1-T         PIC  9(005).                              I.010208
002050       03  S1-KIN       PIC S9(008).                              I.010208
002060       03  S1-CSC       PIC  9(001).                              I.010208
002070       03  S1-DC        PIC  9(001).                              I.010208
002080       03  S1-TCDD      PIC  9(004).                              I.010208
002090       03  F            PIC  X(001).                              I.010208
002100       03  S1-CCD       PIC  9(003).                              I.010208
002110       03  F            PIC  X(011).                              I.010208
002120       03  S1-HSC       PIC  9(001).                              I.010208
002130       03  S1-KOSU      PIC  9(003).                              I.010208
002140       03  S1-FRC       PIC  9(001).                              I.010208
002150       03  S1-TCD2      PIC  9(004).                              I.010208
002160       03  S1-BIK       PIC  X(010).                              I.010208
002170       03  S1-SKD       PIC  9(008).                              I.010208
002180       03  F            PIC  X(004).                              I.010208
002190       03  S1-DHC       PIC  9(001).                              I.010208
002200       03  S1-UNC       PIC  9(001).                              I.010208
002210     02  WR-S2    REDEFINES WR-S1.                                I.010208
002220       03  S2-DNO       PIC  9(006).                              I.010208
002230       03  S2-GNO       PIC  9(001).                              I.010208
002240       03  S2-DATE      PIC  9(008).                              I.010208
002250       03  S2-TCD       PIC  9(004).                              I.010208
002260       03  S2-BI        PIC  N(024).                              I.010208
002270       03  S2-HNO       PIC  9(006).                              I.081224
002280       03  F            PIC  X(003).                              I.081224
002290       03  S2-TCDD      PIC  9(004).                              I.010208
002300       03  F            PIC  X(023).                              I.081224
002310       03  S2-TAX       PIC S9(007).                              I.010208
002320       03  S2-SHZZ      PIC S9(007).                              I.010208
002330       03  S2-UZ        PIC S9(009).                              I.010208
002340       03  S2-DHC       PIC  9(001).                              I.010208
002350       03  S2-UNC       PIC  9(001).                              I.010208
002360 01  W-DATA.
002370     02  W-TD.
002380       03  W-ASUT       PIC S9(006).
002390       03  W-AKIN       PIC S9(008).
002400       03  W-SHZ        PIC S9(006).
002410       03  W-TKIN       PIC S9(008).
002420     02  W-D.
002430       03  W-TPC        PIC  9(001).
002440       03  W-GNO        PIC  9(001).
002450       03  W-L          PIC  9(002).
002460       03  W-LC         PIC  9(002).
002470       03  W-ASU.
002480         04  W-SU    OCCURS  10  PIC S9(004).
002490       03  W-SUT        PIC S9(005).
002500       03  W-KIN        PIC S9(008).
002510       03  W-KINZ       PIC S9(007).
002520       03  CNT          PIC  9(002).
002530       03  W-DC         PIC  9(001).
002540       03  W-BE         PIC  9(001).
002550       03  W-HSC        PIC  9(001).
002560       03  W-CSC        PIC  9(001).
002570     02  CHK.
002580       03  CHK1         PIC  9(001).
002590       03  CHK2         PIC  9(001).
002600     02  W-DNO          PIC  9(006).
002610     02  W-AAL          PIC  X(014) VALUE "13110907050301".
002620     02  W-ALD   REDEFINES W-AAL.
002630       03  W-AL    OCCURS   7  PIC  9(002).
002640     02  W-CCD          PIC  9(003).
002650     02  W-NGPD.                                                  I.050625
002660       03  W-NG.                                                  I.050625
002670         04  W-NEN      PIC  9(004).                              I.050625
002680         04  W-NEND  REDEFINES W-NEN.                             I.050625
002690           05  W-NEN1   PIC  9(002).                              I.050625
002700           05  W-NEN2   PIC  9(002).                              I.050625
002710         04  W-GET      PIC  9(002).                              I.050625
002720       03  W-PEY        PIC  9(002).                              I.050625
002730*****02  W-SENGP.                                                 I.050625
002740     02  W-SNGP         PIC  9(008).                              I.050625
002750     02  W-SNGPD REDEFINES W-SNGP.                                I.050625
002760       03  W-SNG        PIC  9(006).                              I.050625
002770       03  F            PIC  9(002).                              I.050625
002780*****  03  W-ENGP       PIC  9(008).                              I.050625
002790*****  03  W-ENGPD REDEFINES W-ENGP.                              I.050625
002800*****    04  W-ENG      PIC  9(006).                              I.050625
002810*****    04  F          PIC  9(002).                              I.050625
002820     02  W-SETCD.                                                 I.050625
002830       03  W-STCD       PIC  9(004).                              I.050625
002840       03  W-ETCD       PIC  9(004).                              I.050625
002850     02  W-SEDNO.
002860       03  W-SDNO       PIC  9(006).
002870       03  W-EDNO       PIC  9(006).
002880     02  W-DMM          PIC  9(001).
002890     02  W-CCC          PIC  9(001).
002900     02  W-NAME         PIC  N(024).                              I.000821
002910     02  W-NAMED REDEFINES W-NAME.                                I.000821
002920       03  W-NAD   OCCURS  24.                                    I.000821
002930         04  W-NA       PIC  N(001).                              I.000821
002940     02  W-NC           PIC  9(001).                              I.050625
002950 01  ERR-STAT           PIC  X(002).
002960 01  W-AREA.
002970     02  W-KOSU         PIC ZZZZ.
002980     02  N              PIC  9(002).
002990     02  TBL-NAM        PIC  N(032).                              I.020405
003000     02  TBL-NAMR  REDEFINES TBL-NAM.
003010       03  T-NAM        PIC  N(001)  OCCURS  32.                  I.020405
003020     02  SV-KOSU        PIC  9(003).
003030     02  SV-TCD         PIC  9(004).
003040     02  SV-CCD2        PIC  9(003).
003050     COPY LNAMW.                                                  I.020405
003060     COPY LSTAT.
003070 SCREEN SECTION.
003080 SD  C-CRT
003090     END STATUS IS ESTAT.
003100 01  C-CLEAR.
003110     02  C-CL    LINE   1  CLEAR SCREEN.
003120 01  C-MID.
003130     02  LINE   2  COLUMN  15  PIC  N(023) VALUE
003140          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003150     02  LINE   3  COLUMN  15  PIC  N(023) VALUE
003160          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003170     02  LINE   4  COLUMN  15  PIC  N(023) VALUE
003180          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
003190     02  LINE   5  COLUMN  15  PIC  N(023) VALUE
003200          NC"＊＊＊　　千曲産業　請求内訳票　作成　　＊＊＊".
003210     02  LINE   6  COLUMN  15  PIC  N(023) VALUE
003220          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".
003230     02  LINE   7  COLUMN  15  PIC  N(023) VALUE
003240          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003250     02  LINE   8  COLUMN  15  PIC  N(023) VALUE
003260          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003270 01  C-DSP.
003280     02  D-SHM.
003290       03  LINE  12  COLUMN  23  PIC  X(026) VALUE                I.050625
003300            "請求締日   '  年   月   日".                         I.050625
003310       03  LINE  14  COLUMN  23  PIC  X(030) VALUE                I.050625
003320            "得意先   0000 より 9999   まで".                     I.050625
003330       03  LINE  16  COLUMN  27  PIC  X(022) VALUE                I.060524
003340            "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003350     02  D-CM.
003360       03  LINE  18  COLUMN  22  PIC  X(032) VALUE                I.081119
003370            "-----   白紙用紙　セット   -----".                   I.081119
003380       03  LINE  20  COLUMN  21  PIC  X(035) VALUE                I.081119
003390            "[  ﾃｽﾄ ﾌﾟﾘﾝﾄ  ｼﾅｲ=1 ｽﾙ=9    ﾘﾀｰﾝ  ]".                I.081119
003400 01  C-ACP.
003410     02  LINE  12.                                                I.050625
003420       03  A-SNEN  COLUMN  35  PIC  9(002)                        I.050625
003430            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.050625
003440       03  A-SGET  COLUMN  40  PIC  9(002)                        I.050625
003450            USING W-GET   CHECK OVERFLOW NO IFC.                  I.050625
003460       03  A-SPEY  COLUMN  45  PIC  9(002)                        I.050625
003470            USING W-PEY   CHECK OVERFLOW NO IFC.                  I.050625
003480     02  LINE  14.                                                I.050625
003490       03  A-STCD  COLUMN  32  PIC  9(004)                        I.050625
003500            USING W-STCD  CHECK OVERFLOW NO IFC.                  I.050625
003510       03  A-ETCD  COLUMN  42  PIC  9(004)                        I.050625
003520            USING W-ETCD  CHECK OVERFLOW NO IFC.                  I.050625
003530     02  A-DMM   LINE  16  COLUMN  44  PIC  9(001)                I.050625
003540          USING W-DMM   CHECK OVERFLOW NO IFC.
003550     02  A-TPC   LINE  20  COLUMN  48  PIC  9(001)                I.081119
003560          USING W-TPC   CHECK OVERFLOW NO IFC.
003570 01  C-ERR.
003580     02  LINE  24.
003590       03  EMSG-JS COLUMN  15  PIC  X(024) VALUE
003600            "***  ｺﾝﾄﾛｰﾙ情報ｴﾗｰ   ***".
003610       03  E-ME3   COLUMN  15  PIC  X(016) VALUE
003620            "***  HIM ﾅｼ  ***".
003630       03  E-ME4   COLUMN  15  PIC  X(034) VALUE
003640            "***  ﾊｯｺｳｸﾌﾞﾝ ﾉ ﾄﾞｳｷｶﾞ ﾄﾚﾃｲﾅｲ  ***".
003650       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
003660            "***  STRAN ｴﾗｰ (OVER)  ***".
003670       03  E-ME6   COLUMN  15  PIC  X(024) VALUE
003680            "***  STRAN ｴﾗｰ (NO)  ***".
003690       03  E-ME7   COLUMN  15  PIC  X(026) VALUE
003700            "***  STRAN ｴﾗｰ (ﾋﾞｺｳ)  ***".
003710       03  E-ME10  COLUMN  15  PIC  X(015) VALUE
003720            "***  TM ﾅｼ  ***".
003730       03  E-ME11  COLUMN  15  PIC  X(018) VALUE
003740            "***  DATA ﾅｼ   ***".
003750       03  E-ME24  COLUMN  15  PIC  X(029) VALUE
003760            "***   STRAN REWRITE ｴﾗｰ   ***".
003770       03  E-TCD   COLUMN  50  PIC  9(004) FROM  S1-TCD.
003780       03  E-HCD   COLUMN  50  PIC  9(006) FROM  S1-HCD.
003790     COPY LSSEM.
003800     COPY LIBSCR.                                                 I.031219
003810 PROCEDURE DIVISION.
003820 M-020.
003830*    ACCEPT JS-SIGN.
003840     DISPLAY C-CLEAR.
003850     DISPLAY C-MID.
003860*    IF JS-SIGN NOT = 0 AND 1
003870*        MOVE 255 TO COMPLETION-CODE                              I.010208
003880*        DISPLAY EMSG-JS E-ME99
003890*        STOP RUN.
003900     MOVE SPACE TO W-P01 W-P02 W-P03 W-P06 W-P07 W-P08            I.081119
003910                   W-P09 W-P10 W-P11 W-P12 W-P13 W-P14 W-P15.     I.081119
003920     MOVE W-15K TO P-15K1 P-15K2 P-15K3.                          I.081119
003930     MOVE W-20K TO P-20K1 P-20K2 P-20K3.                          I.081119
003940     MOVE W-30K TO P-30K.                                         I.051031
003950     MOVE W-40K TO P-40K.                                         I.051031
003960     MOVE SPACE TO P-AZH P-TNAO P-TNAU P-W P-HNA P-KOSU P-KO      I.081119
003970                   P-BI P-HNM.                                    I.081119
003980     MOVE ALL NC"Ｎ" TO P-AZH P-TNAO P-TNAU P-W P-HNA P-BI P-KO.  I.081119
003990     MOVE NC"伝票区分" TO P-DCM.                                  I.081119
004000     MOVE NC"　№" TO P-DNOM.                                     I.081119
004010     MOVE NC"年" TO P-NENM.                                       I.081119
004020     MOVE NC"月" TO P-GETM.                                       I.081119
004030     MOVE NC"日" TO P-PEYM.                                       I.081119
004040     MOVE NC"　請求内訳票　　" TO P-DPM.                          I.081119
004050     MOVE NC"　摘" TO P-TKM1.                                     I.081119
004060     MOVE NC"　合　計" TO P-GOM.                                  I.081119
004070     MOVE NC"消費税　" TO P-SZM.                                  I.081119
004080     MOVE NC"総合計　" TO P-TKM.                                  I.081119
004090     MOVE NC"　要" TO P-TKM2.                                     I.081119
004100     MOVE ALL "9" TO P-DNO P-TCD P-HCD P-SUD P-SUT P-T P-KIN      I.081119
004110                     P-ASUT P-AKIN P-SHZ P-TKIN.                  D.070126
004120     MOVE NC"９９９９"   TO  P-KOSU.
004130     MOVE "'" TO P-NC.
004140     MOVE 99 TO P-NEN P-GET P-PEY.                                I.081119
004150     MOVE 9 TO P-CSC P-DC P-SIZ.
004160*****IF JS-SIGN = 0
004170*****   GO TO M-100.
004180     DISPLAY D-SHM.
004190     MOVE 0 TO W-NC.                                              I.050625
004200*M-040.
004210*****ACCEPT A-SDNO.
004220*****IF ESTAT = PF9                                               I.050625
004230*****    MOVE 255 TO COMPLETION-CODE                              I.081119
004240*****    DISPLAY C-CLEAR                                          I.050625
004250*****    STOP RUN.                                                I.050625
004260*****IF ESTAT NOT = HTB AND SKP
004270*****    GO TO M-040.
004280*M-060.
004290*****ACCEPT A-EDNO.
004300*****IF ESTAT = BTB
004310*****    GO TO M-040.
004320*****IF ESTAT = PF9                                               I.050625
004330*****    MOVE 255 TO COMPLETION-CODE                              I.081119
004340*****    DISPLAY C-CLEAR                                          I.050625
004350*****    STOP RUN.                                                I.050625
004360*****IF ESTAT NOT = HTB AND SKP
004370*****    GO TO M-060.
004380*****IF W-SDNO > W-EDNO
004390*****    GO TO M-060.
004400 M-062.                                                           I.050625
004410     ACCEPT A-SNEN.                                               I.050625
004420*****IF ESTAT = BTB                                               I.050625
004430*****    GO TO M-060.                                             I.050625
004440     IF ESTAT = PF9                                               I.050625
004450         MOVE 255 TO COMPLETION-CODE                              I.081119
004460         DISPLAY C-CLEAR                                          I.050625
004470         STOP RUN.                                                I.050625
004480     IF ESTAT NOT = HTB AND SKP                                   I.050625
004490         GO TO M-062.                                             I.050625
004500 M-064.                                                           I.050625
004510     ACCEPT A-SGET.                                               I.050625
004520     IF ESTAT = BTB                                               I.050625
004530         GO TO M-062.                                             I.050625
004540     IF ESTAT = PF9                                               I.050625
004550         MOVE 255 TO COMPLETION-CODE                              I.081119
004560         DISPLAY C-CLEAR                                          I.050625
004570         STOP RUN.                                                I.050625
004580     IF ESTAT NOT = HTB AND SKP                                   I.050625
004590         GO TO M-064.                                             I.050625
004600 M-066.                                                           I.050625
004610     ACCEPT A-SPEY.                                               I.050625
004620     IF ESTAT = BTB                                               I.050625
004630         GO TO M-064.                                             I.050625
004640     IF ESTAT = PF9                                               I.050625
004650         MOVE 255 TO COMPLETION-CODE                              I.081119
004660         DISPLAY C-CLEAR                                          I.050625
004670         STOP RUN.                                                I.050625
004680     IF ESTAT NOT = HTB AND SKP                                   I.050625
004690         GO TO M-066.                                             I.050625
004700     IF W-NEN2 = ZERO                                             I.050625
004710         MOVE ZERO TO W-NEN1                                      I.050625
004720       ELSE                                                       I.050625
004730         MOVE 20 TO W-NEN1.                                       I.050625
004740     MOVE W-NGPD TO W-SNGP.                                       I.050625
004750*M-068.                                                           I.050625
004760*****ACCEPT A-ENEN.                                               I.050625
004770*****IF ESTAT = BTB                                               I.050625
004780*****    GO TO M-066.                                             I.050625
004790*****IF ESTAT = PF9                                               I.050625
004800*****    MOVE 255 TO COMPLETION-CODE                              I.081119
004810*****    DISPLAY C-CLEAR                                          I.050625
004820*****    STOP RUN.                                                I.050625
004830*****IF ESTAT NOT = HTB AND SKP                                   I.050625
004840*****    GO TO M-068.                                             I.050625
004850*****IF W-NEN2 = ZERO                                             I.050625
004860*****    GO TO M-068.                                             I.050625
004870*M-070.                                                           I.050625
004880*****ACCEPT A-EGET.                                               I.050625
004890*****IF ESTAT = BTB                                               I.050625
004900*****    GO TO M-068.                                             I.050625
004910*****IF ESTAT = PF9                                               I.050625
004920*****    MOVE 255 TO COMPLETION-CODE                              I.081119
004930*****    DISPLAY C-CLEAR                                          I.050625
004940*****    STOP RUN.                                                I.050625
004950*****IF ESTAT NOT = HTB AND SKP                                   I.050625
004960*****    GO TO M-070.                                             I.050625
004970*M-072.                                                           I.050625
004980*****ACCEPT A-EPEY.                                               I.050625
004990*****IF ESTAT = BTB                                               I.050625
005000*****    GO TO M-070.                                             I.050625
005010*****IF ESTAT = PF9                                               I.050625
005020*****    MOVE 255 TO COMPLETION-CODE                              I.081119
005030*****    DISPLAY C-CLEAR                                          I.050625
005040*****    STOP RUN.                                                I.050625
005050*****IF ESTAT NOT = HTB AND SKP                                   I.050625
005060*****    GO TO M-072.                                             I.050625
005070*****IF W-NEN2 = ZERO                                             I.050625
005080*****    MOVE ZERO TO W-NEN1                                      I.050625
005090*****  ELSE                                                       I.050625
005100*****    MOVE 20 TO W-NEN1.                                       I.050625
005110*****MOVE W-NGPD TO W-ENGP.                                       I.050625
005120*****IF W-SNGP > W-ENGP                                           I.050625
005130*****    GO TO M-068.                                             I.050625
005140 M-074.                                                           I.050625
005150     ACCEPT A-STCD.                                               I.050625
005160     IF ESTAT = BTB                                               I.050625
005170         GO TO M-066.                                             I.050625
005180     IF ESTAT = PF9                                               I.050625
005190         MOVE 255 TO COMPLETION-CODE                              I.081119
005200         DISPLAY C-CLEAR                                          I.050625
005210         STOP RUN.                                                I.050625
005220     IF ESTAT NOT = HTB AND SKP                                   I.050625
005230         GO TO M-074.                                             I.050625
005240 M-076.                                                           I.050625
005250     ACCEPT A-ETCD.                                               I.050625
005260     IF ESTAT = BTB                                               I.050625
005270         GO TO M-074.                                             I.050625
005280     IF ESTAT = PF9                                               I.050625
005290         MOVE 255 TO COMPLETION-CODE                              I.081119
005300         DISPLAY C-CLEAR                                          I.050625
005310         STOP RUN.                                                I.050625
005320     IF ESTAT NOT = HTB AND SKP                                   I.050625
005330         GO TO M-076.                                             I.050625
005340     IF W-STCD > W-ETCD                                           I.050625
005350         GO TO M-076.                                             I.050625
005360 M-080.
005370     ACCEPT A-DMM.
005380     IF ESTAT = BTB
005390         GO TO M-076.                                             I.050625
005400     IF ESTAT NOT = HTB AND SKP
005410         GO TO M-080.
005420     IF W-DMM = 9
005430         GO TO M-062.
005440     IF W-DMM NOT = 1
005450         GO TO M-080.
005460*****GO TO M-110.                                                 I.010208
005470*M-100.
005480*****PERFORM CHK-RTN THRU CHK-EX.
005490*****IF W-DCHK = 0 OR 2                                           I.050928
005500*****    MOVE 255 TO COMPLETION-CODE
005510*****    DISPLAY E-ME11 E-ME99
005520*****    DISPLAY C-CLEAR
005530*****    STOP RUN.
005540*****IF W-DCHK = 3
005550*****    MOVE 255 TO COMPLETION-CODE
005560*****    DISPLAY E-ME4 E-ME99
005570*****    DISPLAY C-CLEAR
005580*****    STOP RUN.
005590 M-110.                                                           I.010208
005600     OPEN OUTPUT SP-F.
005610*****IF JS-SIGN = 1                                               I.050625
005620*****    IF W-NC = 0                                              I.050625
005630*****        MOVE 1 TO W-NC                                       I.050625
005640*****      ELSE                                                   I.050625
005650*****        GO TO M-200.                                         I.050625
005660     DISPLAY D-CM.                                                I.081119
005670 M-140.
005680     ACCEPT A-TPC.
005690     IF ESTAT = PF9                                               I.081119
005700         CLOSE SP-F                                               I.081119
005710         MOVE 255 TO COMPLETION-CODE                              I.081119
005720         DISPLAY C-CLEAR                                          I.081119
005730         STOP RUN.                                                I.081119
005740     IF ESTAT NOT = HTB AND SKP
005750         GO TO M-140.
005760     IF W-TPC = 1
005770         GO TO M-200.
005780     IF W-TPC NOT = 9
005790         GO TO M-140.
005800*
005810     PERFORM MID-RTN THRU MID-EX.                                 I.081119
005820 M-150.                                                           I.081119
005830     ADD 1 TO W-GNO.
005840     IF W-GNO NOT = 7
005850         MOVE SPACE TO SP-R
005860         MOVE W-P09 TO SP-R
005870         WRITE SP-R
005880         MOVE SPACE TO SP-R
005890         MOVE W-P10 TO SP-R
005900         WRITE SP-R
005910         GO TO M-150.                                             I.081119
005920     MOVE SPACE TO SP-R.
005930     MOVE W-P11 TO SP-R.
005940     WRITE SP-R AFTER 1.
005950     MOVE SPACE TO SP-R.
005960     MOVE W-P12 TO SP-R.
005970     WRITE SP-R AFTER 1.
005980     MOVE SPACE TO SP-R.
005990     MOVE W-P13 TO SP-R.
006000     WRITE SP-R AFTER 1.
006010     MOVE SPACE TO SP-R.
006020     MOVE W-P14 TO SP-R.
006030     WRITE SP-R AFTER 1.
006040     MOVE SPACE TO SP-R.
006050     MOVE W-P15 TO SP-R.                                          I.081119
006060     WRITE SP-R AFTER 1.                                          I.081119
006070     MOVE SPACE TO SP-R.                                          I.081119
006080     WRITE SP-R AFTER PAGE.
006090     GO TO M-140.                                                 I.081119
006100 M-200.
006110     MOVE ZERO TO CHK.
006120     OPEN INPUT HI-M T-M TC-M.
006130*****IF JS-SIGN = 1
006140*****    OPEN INPUT STRANYR                                       I.010208
006150*****    GO TO M-230.                                             I.010208
006160     OPEN I-O S-TRAN.
006170 M-220.
006180     READ S-TRAN AT END
006190         GO TO M-920.
006200     MOVE S-R TO WR-S1.                                           I.010208
006210     IF S1-GNO = 9
006220         GO TO M-220.                                             I.050625
006230     IF S1-SKD NOT = W-SNGP                                       I.050625
006240         GO TO M-220.                                             I.050625
006250     IF S1-TCD < W-STCD OR > W-ETCD                               I.050625
006260         GO TO M-220.                                             I.050625
006270*****IF S1-DHC NOT = 1
006280*****    GO TO M-240.
006290*****GO TO M-220.                                                 I.010208
006300*M-230.                                                           I.010208
006310*****READ STRANYR AT END                                          I.010208
006320*****    GO TO M-920.                                             I.010208
006330*****MOVE STRANYR-R TO WR-S1.                                     I.010208
006340*****IF S1-NG < W-SNG                                             I.050625
006350*****    GO TO M-230.                                             I.031219
006360*****IF S1-NG > W-ENG                                             I.050625
006370*****    GO TO M-920.                                             I.031219
006380*****IF S1-DNO < W-SDNO OR > W-EDNO                               I.050625
006390*****    GO TO M-230.                                             I.010221
006400*****IF S1-DATE < W-SNGP OR > W-ENGP                              I.050625
006410*****    GO TO M-230.                                             I.050625
006420*****IF S1-TCD < W-STCD OR > W-ETCD                               I.050625
006430*****    GO TO M-230.                                             I.050625
006440 M-240.
006450     IF W-DZC = 0
006460         MOVE 1 TO W-DZC.
006470     MOVE ZERO TO W-TD W-D.
006480     MOVE S1-DNO TO W-DNO.
006490     MOVE S1-CSC TO W-CSC.
006500     MOVE S1-HSC TO W-HSC.
006510     MOVE S1-KOSU TO SV-KOSU.
006520     MOVE S1-TCD2 TO SV-TCD.
006530     MOVE S1-CCD TO SV-CCD2.
006540     MOVE S1-TCDD TO T-KEY.
006550     READ T-M WITH UNLOCK INVALID KEY
006560         DISPLAY E-ME10 E-TCD E-ME99
006570         GO TO M-980.
006580*
006590     MOVE 0 TO W-CCC.
006600     IF S1-CCD = ZERO OR 001
006610         GO TO M-300.
006620     MOVE S1-TCD2 TO TC-TCD.
006630     MOVE S1-CCD TO TC-CCD.
006640     READ TC-M WITH UNLOCK INVALID KEY
006650         MOVE 0 TO TC-DHC.
006660     IF TC-DHC NOT = 0
006670         MOVE 1 TO W-CCC.
006680 M-300.
006690     MOVE SPACE TO W-P01 W-P02 W-P03 W-P06 W-P07 W-P08.           I.081119
006700     MOVE W-15K TO P-15K1 P-15K2.                                 I.081119
006710     MOVE W-20K TO P-20K1.                                        I.081119
006720     MOVE W-30K TO P-30K.                                         I.051031
006730     MOVE W-40K TO P-40K.                                         I.051031
006740     MOVE SPACE TO P-DCM P-DNOM P-NENM P-GETM P-PEYM P-DPM P-AZH  I.081119
006750                   P-TNAO P-TNAU P-W.                             I.081119
006760     MOVE NC"伝票区分" TO P-DCM.                                  I.081119
006770     MOVE NC"　№" TO P-DNOM.                                     I.081119
006780     MOVE S1-CSC TO P-CSC.
006790     IF S1-UNC = 0
006800         IF S1-DC = 4
006810             MOVE 0 TO P-DC
006820           ELSE
006830             MOVE S1-DC TO P-DC.
006840     IF S1-FRC NOT = 0
006850         MOVE S1-FRC TO P-FRC.
006860     MOVE W-DNO TO P-DNO.
006870     IF S1-UNC = 1                                                I.010523
006880         IF S1-KIN < 0                                            I.010523
006890             MOVE "-" TO P-NBK.                                   I.010523
006900*****IF JS-SIGN = 1                                               I.010208
006910*****    MOVE "." TO P-SHC.                                       I.010208
006920     MOVE S1-DATE TO W-NGPD.                                      I.081119
006930     MOVE "'" TO P-NC.
006940     MOVE NC"年" TO P-NENM.                                       I.081119
006950     MOVE NC"月" TO P-GETM.                                       I.081119
006960     MOVE NC"日" TO P-PEYM.                                       I.081119
006970     MOVE W-NEN2 TO P-NEN.                                        I.081119
006980     MOVE W-GET TO P-GET.                                         I.081119
006990     MOVE W-PEY TO P-PEY.                                         I.081119
007000     MOVE NC"　請求内訳票　　" TO P-DPM.                          I.081119
007010     IF W-CCC = 1
007020         MOVE TC-NAME TO WN-NAME                                  I.020405
007030       ELSE
007040         MOVE T-NAME TO WN-NAME.                                  I.020405
007050     COPY LNAMP.                                                  I.020405
007060     MOVE WN-ONAME TO P-TNAO.                                     I.020405
007070     MOVE WN-UNAME TO P-TNAU.                                     I.020405
007080     IF S1-DC = 2
007090         MOVE NC"不良返品　　" TO P-AZH.
007100     IF S1-DC = 3
007110         MOVE NC"預り保管　　" TO P-AZH.
007120     IF S1-DC = 8
007130         MOVE NC"消費税調整分" TO P-AZH.
007140     MOVE "(" TO P-TF.                                            I.010220
007150     MOVE T-TNC1 TO P-TNC1.                                       I.010220
007160     MOVE "-" TO P-TV.                                            I.010220
007170     MOVE T-DCC TO P-DCC.                                         I.010220
007180     MOVE ")" TO P-TR.                                            I.010220
007190     MOVE NC"　№" TO P-W.                                        I.051108
007200     MOVE S1-TCD TO P-TCD.
007210     IF W-CCC = 1
007220         MOVE "-" TO P-V
007230         MOVE S1-CCD TO P-CCD.
007240     IF T-SS NOT = 20 AND 99
007250         IF T-SS > 29
007260             MOVE "**" TO P-X
007270           ELSE
007280             IF T-SS NOT = ZERO
007290                 MOVE " *" TO P-X.
007300     PERFORM MID-RTN THRU MID-EX.
007310     IF S1-DC NOT = 8
007320         GO TO M-360.
007330     ADD S1-KIN TO W-AKIN.
007340     PERFORM MEI-120 THRU MEI-EX.
007350     GO TO M-400.
007360 M-360.
007370     ADD 1 TO W-GNO.
007380     IF W-GNO = 7
007390         DISPLAY E-ME5 E-ME99
007400         GO TO M-980.
007410     IF W-GNO NOT = S1-GNO
007420         DISPLAY E-ME6 E-ME99.
007430     PERFORM MEI-RTN THRU MEI-EX.
007440 M-400.
007450*****IF JS-SIGN = 1                                               I.010221
007460*****    GO TO M-420.                                             I.010221
007470     READ S-TRAN AT END
007480         DISPLAY E-ME7 E-ME99
007490         GO TO M-980.
007500     MOVE S-R TO WR-S1.                                           I.010208
007510*****GO TO M-440.                                                 I.010208
007520*M-420.                                                           I.010208
007530*****READ STRANYR AT END                                          I.010208
007540*****    DISPLAY E-ME7 E-ME99                                     I.010208
007550*****    GO TO M-980.                                             I.010208
007560*****MOVE STRANYR-R TO WR-S1.                                     I.010208
007570*M-440.                                                           I.010208
007580     IF S1-DNO = W-DNO
007590         IF S1-GNO NOT = 9
007600             GO TO M-360.
007610     IF S1-DNO NOT = W-DNO
007620         DISPLAY E-ME7 E-ME99
007630         GO TO M-980.
007640     PERFORM KEI-RTN THRU KEI-EX.
007650*****IF JS-SIGN = 1                                               I.010208
007660*****    GO TO M-230                                              I.010208
007670*****  ELSE                                                       I.010208
007680     GO TO M-220.
007690 M-920.
007700     IF W-DZC = 0
007710         DISPLAY E-ME11 E-ME99.
007720 M-980.
007730     CLOSE HI-M T-M TC-M.
007740     CLOSE SP-F.                                                  I.050625
007750*****IF JS-SIGN = 1                                               I.010208
007760*****    CLOSE STRANYR                                            I.010208
007770*****    GO TO M-040                                              I.050625
007780*****  ELSE                                                       I.010208
007790     CLOSE S-TRAN.                                                I.070126
007800*****GO TO M-040.
007810     DISPLAY C-CLEAR.
007820     STOP RUN.
007830 MID-RTN.
007840     MOVE SPACE TO SP-R.
007850     MOVE W-15K TO P-15K1 P-15K2.                                 I.081119
007860     MOVE W-20K TO P-20K1.                                        I.081119
007870     MOVE W-30K TO P-30K.                                         I.081119
007880     MOVE W-40K TO P-40K.                                         I.081119
007890     MOVE W-P01 TO SP-R.
007900     WRITE SP-R.
007910     MOVE SPACE TO SP-R.
007920     MOVE W-P02 TO SP-R.
007930     WRITE SP-R AFTER 2.
007940     MOVE SPACE TO SP-R.
007950     MOVE W-P03 TO SP-R.
007960     WRITE SP-R.
007970     MOVE SPACE TO SP-R.
007980     MOVE W-P06 TO SP-R.                                          I.020603
007990     WRITE SP-R AFTER 4.                                          I.081119
008000     MOVE SPACE TO SP-R.                                          I.020603
008010     MOVE W-P07 TO SP-R.
008020     WRITE SP-R.                                                  I.020603
008030     MOVE SPACE TO SP-R.
008040     MOVE W-P08 TO SP-R.
008050     WRITE SP-R.                                                  I.020405
008060     MOVE SPACE TO SP-R.
008070*
008080     MOVE SPACE TO W-P08A.                                        I.081119
008090     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
008100     MOVE "1         SS   S   M   L  LL 28.029.030.0" TO P-SIZM.  I.081119
008110     MOVE W-P08A TO SP-R.                                         I.081119
008120     WRITE SP-R AFTER 2.                                          I.081119
008130     MOVE SPACE TO SP-R.                                          I.081119
008140     MOVE SPACE TO W-P08A.                                        I.081119
008150     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
008160     MOVE "212.513.013.514.015.016.017.018.019.020.0" TO P-SIZM.  I.081119
008170     MOVE W-P08A TO SP-R.                                         I.081119
008180     WRITE SP-R.                                                  I.081119
008190     MOVE SPACE TO SP-R.                                          I.081119
008200     MOVE SPACE TO W-P08A.                                        I.081119
008210     MOVE NC"品　　　　　名　" TO P-HMM.                          I.081119
008220     MOVE NC"　数量　" TO P-SUM.                                  I.081119
008230     MOVE NC"単価" TO P-TM.                                       I.081119
008240     MOVE NC"金　　額" TO P-KINM.                                 I.081119
008250     MOVE "321.021.522.022.523.023.524.024.525.0    " TO P-SIZM.  I.081119
008260     MOVE W-P08A TO SP-R.                                         I.081119
008270     WRITE SP-R.                                                  I.081119
008280     MOVE SPACE TO SP-R.                                          I.081119
008290     MOVE SPACE TO W-P08A.                                        I.081119
008300     MOVE SPACE TO P-HMM P-SUM P-TM P-KINM.                       I.081119
008310     MOVE "424.024.525.025.526.026.527.027.5        " TO P-SIZM.  I.081119
008320     MOVE W-P08A TO SP-R.                                         I.081119
008330     WRITE SP-R.                                                  I.081119
008340     MOVE SPACE TO SP-R.                                          I.081119
008350     MOVE ZERO TO W-GNO.
008360 MID-EX.
008370     EXIT.
008380 MEI-RTN.
008390     MOVE S1-DC TO W-DC.
008400     MOVE SPACE TO W-P09 W-P10.
008410     MOVE SPACE TO P-HNA.                                         I.081119
008420     MOVE W-15K TO P-15K3.                                        I.081119
008430     MOVE W-20K TO P-20K2.                                        I.081119
008440     IF (S1-UNC = 1) OR (S1-HCD > 999899) OR (S1-DC = 3)          I.000819
008450         GO TO MEI-040.
008460     MOVE ZERO TO CNT W-ASU.
008470 MEI-020.
008480     ADD 1 TO CNT.
008490     IF CNT = 11
008500         GO TO MEI-040.
008510     MOVE S1-SU(CNT) TO W-SU(CNT).
008520     IF W-SU(CNT) NOT = ZERO
008530         MOVE W-SU(CNT) TO P-SU(CNT).
008540     GO TO MEI-020.
008550 MEI-040.
008560     IF S1-HCD NOT = ZERO
008570         MOVE S1-HCD TO P-HCD
008580         IF S1-UNC = 0
008590             MOVE S1-SIZ TO P-SIZ.
008600     MOVE S1-SUT TO W-SUT.
008610     IF S1-HCD = ZERO
008620         GO TO MEI-100.
008630     IF S1-DC = 3 OR 4 OR 7
008640         IF W-SUT < ZERO
008650             COMPUTE W-SUT = W-SUT * -1.
008660     MOVE W-SUT TO P-SUT.
008670     IF S1-DC NOT = 4
008680         GO TO MEI-060.
008690     IF S1-SUT < ZERO
008700         MOVE NC"預りへ戻し" TO P-AZM
008710       ELSE
008720         MOVE NC"預り出荷　" TO P-AZM.
008730     GO TO MEI-080.
008740 MEI-060.
008750     IF S1-DC = 9
008760         MOVE NC"預り振替　"    TO P-AZM
008770         GO TO MEI-080.
008780     MOVE S1-T TO P-T.
008790     MOVE S1-KIN TO W-KIN.
008800     IF (S1-DC = 3) OR (S1-UNC = 1)                               I.010523
008810         IF W-KIN < ZERO
008820             COMPUTE W-KIN = W-KIN * -1.
008830     MOVE W-KIN TO P-KIN.
008840 MEI-080.
008850     MOVE S1-HCD TO HI-KEY.
008860     READ HI-M WITH UNLOCK INVALID KEY
008870         DISPLAY E-ME3 E-HCD E-ME99
008880         MOVE SPACE TO HI-NAME.
008890*****IF S1-TCD = 0013 OR 0458 OR 0459 OR 0460                     I.010709
008900*****    MOVE HI-NAME TO W-NAME                                   I.000821
008910*****    MOVE SPACE TO W-NA(24)                                   I.000821
008920*****    MOVE W-NAME TO P-HNA                                     I.000821
008930*****  ELSE                                                       I.000821
008940     MOVE HI-NAME TO P-HNA.
008950     IF S1-UNC = 0
008960         IF S1-BIK NOT = SPACE
008970             MOVE "[" TO P-F
008980             MOVE S1-BIK TO P-BIK
008990             MOVE "]" TO P-R.
009000 MEI-100.
009010     MOVE SPACE TO SP-R.
009020     MOVE W-P09 TO SP-R.
009030     WRITE SP-R.
009040     MOVE SPACE TO SP-R.
009050     MOVE W-P10 TO SP-R.
009060     WRITE SP-R.
009070     IF S1-HCD <  999900
009080         ADD W-SUT TO W-ASUT.
009090     IF S1-DC NOT = 4 AND 9
009100         ADD S1-KIN TO W-AKIN.
009110 MEI-120.
009120*****IF JS-SIGN = 1
009130*****    GO TO MEI-EX.
009140     MOVE 1 TO S1-DHC.
009150     MOVE WR-S1 TO S-R.                                           I.010208
009160     REWRITE S-R.                                                 I.010208
009170     IF ERR-STAT NOT = "00"
009180         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
009190         DISPLAY E-CL.
009200 MEI-EX.
009210     EXIT.
009220 KEI-RTN.
009230     MOVE SPACE TO W-P11 W-P12 W-P13 W-P14.                       I.081119
009240     MOVE ALL NC"　" TO P-KOSU P-KO P-CNAM P-TKM1 P-GOM P-BI      I.081119
009250                        P-HNM P-SZM P-TKM.                        I.081119
009260 KEI-020.
009270     IF SV-KOSU NOT = ZERO
009280        MOVE SV-KOSU TO   W-KOSU
009290        MOVE W-KOSU  TO   P-KOSU
009300        MOVE NC"個口" TO  P-KO.
009310     IF SV-CCD2 NOT = ZERO AND 001
009320         IF W-CCC = 0
009330             PERFORM TNA-RTN THRU TNA-EX.
009340     MOVE S2-BI TO P-BI.
009350     MOVE NC"　摘" TO P-TKM1.                                     I.081119
009360     MOVE NC"　合　計" TO P-GOM.                                  I.081119
009370     MOVE NC"消費税　" TO P-SZM.                                  I.081119
009380     MOVE NC"総合計　" TO P-TKM.                                  I.081119
009390     IF S2-HNO = ZERO                                             I.081224
009400         GO TO KEI-040.
009410     MOVE NC"　※発送明細書№" TO P-HNM.                          I.020405
009420     MOVE S2-HNO TO P-HNO.                                        I.081224
009430 KEI-040.
009440     IF W-GNO = ZERO
009450         MOVE W-AKIN TO W-SHZ W-KINZ
009460         MOVE ZERO TO W-AKIN W-KIN
009470         GO TO KEI-060.
009480     MOVE W-ASUT TO P-ASUT.
009490     MOVE W-AKIN TO W-KIN.
009500     MOVE S2-TAX TO W-SHZ.
009510*****IF W-HSC = 0
009520*****    COMPUTE W-SHZ ROUNDED = W-KIN * 0.05.
009530*****IF W-HSC = 3
009540*****    COMPUTE W-SHZ ROUNDED = W-KIN * 0.03.
009550     MOVE W-SHZ TO W-KINZ.
009560     IF (W-DC = 3) OR (S2-UNC = 1)                                I.010523
009570         IF W-KIN < ZERO
009580             COMPUTE W-KIN = W-KIN * -1
009590             COMPUTE W-KINZ = W-KINZ * -1.
009600 KEI-060.
009610     MOVE W-KIN TO P-AKIN.
009620     MOVE W-KINZ TO P-SHZ.
009630     COMPUTE W-TKIN = W-KIN + W-KINZ.
009640     MOVE W-TKIN TO P-TKIN.
009650*    IF JS-SIGN = 0
009660         IF W-DC = 1 OR 2 OR 5
009670             COMPUTE W-AKIN = W-AKIN * -1
009680             COMPUTE W-SHZ = W-SHZ * -1.                          I.071003
009690     ADD 1 TO W-GNO.
009700*
009710     MOVE SPACE TO SP-R.
009720     MOVE W-P11 TO SP-R.
009730     WRITE SP-R AFTER W-AL(W-GNO).
009740     MOVE SPACE TO SP-R.
009750     MOVE W-P12  TO SP-R.
009760     WRITE SP-R AFTER 1.
009770     MOVE SPACE TO SP-R.
009780     MOVE W-P13 TO SP-R.
009790     WRITE SP-R AFTER 1.
009800     MOVE SPACE TO SP-R.
009810     MOVE W-P14 TO SP-R.
009820     WRITE SP-R AFTER 1.
009830     MOVE SPACE TO SP-R.
009840     MOVE W-P15 TO SP-R.                                          I.081119
009850     WRITE SP-R AFTER 1.                                          I.081119
009860     MOVE SPACE TO SP-R.                                          I.081119
009870     MOVE SPACE TO SP-R.
009880     WRITE SP-R AFTER PAGE.
009890*****IF JS-SIGN = 1
009900*****    GO TO KEI-EX.
009910 KEI-120.
009920*****MOVE W-SHZ TO S2-TAX.
009930     MOVE 1 TO S2-DHC.
009940     MOVE WR-S2 TO S-R.                                           I.010208
009950     REWRITE S-R.                                                 I.010208
009960     IF ERR-STAT NOT = "00"
009970         DISPLAY E-ME78 E-STAT E-ME24 E-ME99
009980         DISPLAY E-CL.
009990 KEI-EX.
010000     EXIT.
010010 TNA-RTN.
010020     MOVE SV-TCD TO TC-TCD.
010030     MOVE SV-CCD2 TO TC-CCD.
010040     READ TC-M UNLOCK INVALID KEY
010050         MOVE SPACE TO TC-NAME.
010060     MOVE TC-NAME TO P-CNAM.
010070     MOVE P-CNAM TO TBL-NAM.
010080     MOVE 26 TO N.                                                I.020405
010090 TNA-020.
010100     IF N = 0
010110         GO TO TNA-EX.
010120     IF T-NAM(N) NOT = SPACE AND NC"　"
010130         GO TO TNA-040.
010140     COMPUTE N = N - 1.
010150     GO TO TNA-020.
010160 TNA-040.
010170     IF W-DC = 1 OR 2                                             I.050614
010180         ADD 1 TO N
010190         MOVE NC"様" TO T-NAM(N)
010200         ADD 1 TO N
010210         MOVE NC"よ" TO T-NAM(N)
010220         ADD 1 TO N
010230         MOVE NC"り" TO T-NAM(N)
010240         ADD 1 TO N
010250         MOVE NC"返" TO T-NAM(N)
010260         ADD 1 TO N
010270         MOVE NC"品" TO T-NAM(N)
010280         MOVE TBL-NAM TO P-CNAM
010290         GO TO TNA-EX.
010300     ADD 1 TO N.
010310     MOVE NC"様" TO T-NAM(N).
010320     ADD 1 TO N.
010330     MOVE NC"　" TO T-NAM(N).
010340     ADD 1 TO N.
010350     MOVE NC"直" TO T-NAM(N).
010360     ADD 1 TO N.
010370     MOVE NC"送" TO T-NAM(N).
010380     MOVE TBL-NAM TO P-CNAM.
010390 TNA-EX.
010400     EXIT.
010410*CHK-RTN.
010420*****MOVE 0 TO W-DCHK.
010430*****OPEN INPUT S-TRAN.
010440*CHK-020.
010450*****READ S-TRAN AT END
010460*****    GO TO CHK-040.
010470*****MOVE S-R TO WR-S1.                                           I.050928
010480*****IF W-DCHK = 1
010490*****    IF S1-DHC = 1
010500*****        MOVE 3 TO W-DCHK
010510*****        GO TO CHK-040
010520*****      ELSE
010530*****        GO TO CHK-020.
010540*****IF W-DCHK = 2
010550*****    IF S1-DHC NOT = 1
010560*****        MOVE 3 TO W-DCHK
010570*****        GO TO CHK-040
010580*****      ELSE
010590*****        GO TO CHK-020.
010600*****IF S1-DHC NOT = 1
010610*****    MOVE 1 TO W-DCHK
010620*****  ELSE
010630*****    MOVE 2 TO W-DCHK.
010640*****GO TO CHK-020.
010650*CHK-040.
010660*****CLOSE S-TRAN.
010670*CHK-EX.
010680*****EXIT.
010690 ERR-RTN.
010700     DISPLAY E-ME99
010710     GO TO ERR-RTN.
010720 ERR-EX.
010730     EXIT.
