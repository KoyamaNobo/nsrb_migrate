000010 IDENTIFICATION   DIVISION.
000020 PROGRAM-ID. HKY010.
000030*********************************************************
000040*    PROGRAM         :  ìæà”êÊë‰í†ÉèÅ[ÉNçÏê¨            *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT TMS-F ASSIGN TO TMS-MSD.
000170     SELECT STRANYR ASSIGN TO STRANY-MSD.
000180     SELECT URIRYR ASSIGN TO URIRYY-MSD.
000190     SELECT NYURYR ASSIGN TO NYURY-MSD.
000200     SELECT DTWF ASSIGN TO DTW-MSD.
000210 I-O-CONTROL.
000220     APPLY SHARED-MODE ON M-DATE.
000230 DATA DIVISION.
000240 FILE SECTION.
000250     COPY LIBFDD.
000260 FD  TMS-F
000270     BLOCK  4 RECORDS
000280     LABEL RECORD IS STANDARD
000290     VALUE OF IDENTIFICATION WK0064ID.
000300 01  TMS-R.
000310     02  TMS-TCD        PIC  9(004).
000320     02  F              PIC  9(002).
000330     02  TMS-DATE       PIC  9(006).
000340     02  TMS-KIN        PIC S9(009).
000350     02  TMS-SHZ        PIC S9(007).
000360     02  TMS-DC         PIC  9(001).
000370     02  TMS-BC         PIC  9(001).
000380     02  TMS-TNC        PIC  9(002).
000390     02  TMS-DCC        PIC  9(001).
000400     02  TMS-NGP.
000410       03  TMS-NG       PIC  9(006).
000420       03  F            PIC  9(002).
000430     02  TMS-SNG        PIC  9(004).
000440     02  TMS-ENG        PIC  9(004).
000450     02  TMS-BM         PIC  9(001).
000460     02  TMS-STCD       PIC  9(004).
000470     02  TMS-ETCD       PIC  9(004).
000480     02  F              PIC  X(006).
000490 FD  STRANYR
000500     BLOCK  2 RECORDS
000510     LABEL RECORD STANDARD
000520     VALUE OF IDENTIFICATION IS "STRANYR".
000530 01  STRANY-R.
000540     02  ST-S1.
000550       03  S1-DNO       PIC  9(006).
000560       03  S1-GNO       PIC  9(001).
000570       03  S1-DATE      PIC  9(008).
000580       03  S1-NGP   REDEFINES S1-DATE.
000590         04  F          PIC  9(002).
000600         04  S1-NG      PIC  9(004).
000610         04  S1-PEY     PIC  9(002).
000620       03  S1-TCD       PIC  9(004).
000630       03  S1-HCD       PIC  9(006).
000640       03  S1-SIZ       PIC  9(001).
000650       03  S1-ASU.
000660         04  S1-SUD   OCCURS 10.
000670           05  S1-SU    PIC S9(004)   COMP-3.
000680       03  S1-SUT       PIC S9(005).
000690       03  S1-T         PIC S9(005).
000700       03  S1-KIN       PIC S9(008).
000710       03  S1-CSC       PIC  9(001).
000720       03  S1-DC        PIC  9(001).
000730       03  S1-FT        PIC  9(005).
000740       03  S1-CCD       PIC  9(003).
000750       03  S1-BC        PIC  9(006).
000760       03  S1-SKC       PIC  9(001).
000770       03  S1-TNC       PIC  9(002).
000780       03  F            PIC  X(002).
000790       03  S1-HSC       PIC  9(001).
000800       03  S1-KOSU      PIC  9(003).
000810       03  S1-FRC       PIC  9(001).
000820       03  S1-TCD2      PIC  9(004).
000830       03  S1-BIK       PIC  X(010).
000840       03  S1-SKU       PIC  9(008).
000850       03  S1-BKC       PIC  9(002).
000860       03  S1-BMNO      PIC  9(001).
000870       03  S1-USC       PIC  9(001).
000880       03  S1-DHC       PIC  9(001).
000890       03  S1-SNC       PIC  9(001).
000900     02  ST-S2    REDEFINES ST-S1.
000910       03  S2-DNO       PIC  9(006).
000920       03  S2-GNO       PIC  9(001).
000930       03  S2-DATE      PIC  9(008).
000940       03  S2-TCD       PIC  9(004).
000950       03  S2-BI        PIC  N(024).
000960       03  S2-HNO       PIC  9(006).
000970       03  F            PIC  X(030).
000980       03  S2-TAX       PIC S9(007).
000990       03  S2-SHZZ      PIC S9(007).
001000       03  S2-UZ        PIC S9(009).
001010       03  S2-DHC       PIC  9(001).
001020       03  S2-SNC       PIC  9(001).
001030 FD  URIRYR
001040     BLOCK  2 RECORDS
001050     LABEL RECORD STANDARD
001060     VALUE OF IDENTIFICATION IS "URIRYR".
001070 01  URIRY-R.
001080     02  UR-DC          PIC  9(001).
001090     02  UR-DATE        PIC  9(008).
001100     02  UR-NGP   REDEFINES UR-DATE.
001110       03  F            PIC  9(002).
001120       03  UR-NG        PIC  9(004).
001130       03  UR-PEY       PIC  9(002).
001140     02  UR-TCD         PIC  9(004).
001150     02  UR-HCD         PIC  X(005).
001160     02  UR-SUT         PIC S9(006)V9(02).
001170     02  UR-T           PIC S9(006)V9(02).
001180     02  UR-KIN         PIC S9(008).
001190     02  UR-YC          PIC  9(002).
001200     02  UR-SGP         PIC  9(004).
001210     02  UR-NNO         PIC  9(006).
001220     02  UR-HYC         PIC  9(001).
001230     02  UR-CSC         PIC  9(001).
001240     02  UR-BKC         PIC  9(002).
001250     02  UR-SKU         PIC  9(008).
001260     02  UR-DNO         PIC  9(006).
001270     02  UR-GNO         PIC  9(001).
001280     02  UR-JCD         PIC  9(006).
001290     02  UR-GT          PIC S9(006)V9(02).
001300     02  UR-TEK         PIC  N(018).
001310     02  UR-BMC         PIC  9(001).
001320     02  F              PIC  X(003).
001330     02  UR-PC          PIC  9(001).
001340 FD  NYURYR
001350     BLOCK  5 RECORDS
001360     LABEL RECORD STANDARD
001370     VALUE OF IDENTIFICATION IS "NYURYR".
001380 01  NYURY-R.
001390     02  NY-DATE        PIC  9(008).
001400     02  NY-NGP   REDEFINES NY-DATE.
001410       03  F            PIC  9(002).
001420       03  NY-NG        PIC  9(004).
001430       03  NY-PEY       PIC  9(002).
001440     02  NY-TCD         PIC  9(004).
001450     02  NY-KIN         PIC S9(008).
001460     02  NY-NKC         PIC  9(002).
001470     02  NY-SSC         PIC  9(001).
001480     02  NY-TKG         PIC  9(008).
001490     02  NY-SKNG        PIC  9(006).
001500     02  NY-BMC         PIC  9(001).
001510     02  NY-TNC         PIC  9(002).
001520     02  NY-SKN         PIC  9(002).
001530     02  NY-SKK         PIC  9(001).
001540     02  NY-DNO         PIC  9(006).
001550     02  NY-GNO         PIC  9(001).
001560     02  F              PIC  X(008).
001570     02  NY-SKU         PIC  9(008).
001580     02  NY-DCC         PIC  9(001).
001590     02  F              PIC  X(013).
001600     02  NY-NRC         PIC  9(001).
001610     02  F              PIC  9(001).
001620     02  NY-PC          PIC  9(001).
001630     02  F              PIC  X(019).
001640 FD  DTWF
001650     BLOCK  1 RECORDS
001660     LABEL RECORD STANDARD
001670     VALUE OF IDENTIFICATION IS WK0256ID.
001680 01  DTW-R.
001690     02  DTW-D1.
001700       03  DT1-BMC      PIC  9(001).
001710       03  DT1-UNC      PIC  9(001).
001720       03  DT1-DNO      PIC  9(006).
001730       03  DT1-GNO      PIC  9(001).
001740       03  DT1-DATE     PIC  9(008).
001750       03  DT1-TCD      PIC  9(004).
001760       03  DT1-HCD      PIC  9(006).
001770       03  DT1-HCDD  REDEFINES  DT1-HCD.
001780         04  DT1-KCD    PIC  X(005).
001790         04  F          PIC  X(001).
001800       03  DT1-SUT      PIC S9(006)V9(02).
001810       03  DT1-T        PIC S9(006)V9(02).
001820       03  DT1-KIN      PIC S9(009).                              I.110919
001830*****  03  DT1-KIN      PIC S9(008).                              D.110919
001840       03  DT1-CSC      PIC  9(001).
001850       03  DT1-DC       PIC  9(001).
001860       03  DT1-BKC      PIC  9(002).
001870       03  DT1-BMNO     PIC  9(001).
001880       03  DT1-FT       PIC  9(006)V9(02).
001890       03  DT1-SHZ      PIC S9(007).                              I.110919
001900*****  03  F            PIC  X(010).                              D.110919
001910       03  DT1-SIZ      PIC  9(001).
001920       03  DT1-ASU.
001930         04  DT1-SUD   OCCURS 10.
001940           05  DT1-SU   PIC S9(004).
001950       03  DT1-CCD      PIC  9(003).
001960       03  DT1-BC       PIC  9(006).
001970       03  DT1-SKC      PIC  9(001).
001980       03  DT1-TNC      PIC  9(002).
001990       03  F            PIC  X(002).
002000       03  DT1-HSC      PIC  9(001).
002010       03  DT1-KOSU     PIC  9(003).
002020       03  DT1-FRC      PIC  9(001).
002030       03  DT1-TCD2     PIC  9(004).
002040       03  DT1-BIK      PIC  X(010).
002050       03  DT1-USC      PIC  9(001).
002060       03  DT1-SNC      PIC  9(001).
002070*****  03  F            PIC  X(010).                              D.110919
002080       03  DT1-HYC      PIC  9(001).
002090       03  DT1-YC       PIC  9(002).
002100       03  DT1-SGP      PIC  9(004).
002110       03  DT1-NNO      PIC  9(006).
002120       03  DT1-JCD      PIC  9(006).
002130       03  DT1-TEKI     PIC  N(018).
002140*****  03  F            PIC  X(010).                              D.110919
002150       03  DT1-NKC      PIC  9(002).
002160       03  DT1-SSC      PIC  9(001).
002170       03  DT1-TKG      PIC  9(008).
002180       03  DT1-SKNG     PIC  9(006).
002190       03  DT1-DCC      PIC  9(001).
002200       03  DT1-SNGP     PIC  9(006).                              1.110919
002210       03  F            PIC  X(019).                              I.110919
002220*****  03  F            PIC  X(003).                              D.110919
002230       03  DT1-EC       PIC  9(001).
002240       03  DT1-SKU      PIC  9(008).
002250       03  DT1-PC       PIC  9(001).
002260     02  DTW-D2   REDEFINES  DTW-D1.
002270       03  DT2-BMC      PIC  9(001).
002280       03  DT2-UNC      PIC  9(001).
002290       03  DT2-DNO      PIC  9(006).
002300       03  DT2-GNO      PIC  9(001).
002310       03  DT2-DATE     PIC  9(008).
002320       03  DT2-TCD      PIC  9(004).
002330       03  DT2-BI       PIC  N(024).
002340       03  DT2-HNO      PIC  9(006).
002350       03  F            PIC  X(028).
002360       03  DT2-TAX      PIC S9(007).
002370       03  F            PIC  X(029).
002380       03  DT2-SNC      PIC  9(001).
002390       03  F            PIC  X(106).
002400       03  DT2-EC       PIC  9(001).
002410       03  F            PIC  X(008).
002420       03  DT2-PC       PIC  9(001).
002430 WORKING-STORAGE  SECTION.
002440 77  ERR-STAT           PIC  X(002).
002450 77  W-FILE             PIC  X(013).
002460 77  W-DC               PIC  9(001) VALUE 0.
002470 77  WK0064ID           PIC  X(009) VALUE SPACE.
002480 77  WK0256ID           PIC  X(009) VALUE SPACE.
002490 01  STN-NO.
002500     02  STN-NO1        PIC  X(003).
002510     02  STN-NO2        PIC  X(003).
002520 01  W-FID1.
002530     02  W-FID11        PIC  X(006) VALUE "WK0064".
002540     02  W-FID12        PIC  X(003).
002550 01  W-FID2.
002560     02  W-FID21        PIC  X(006) VALUE "WK0256".
002570     02  W-FID22        PIC  X(003).
002580 01  W-DATA.
002590     02  W-SNG          PIC  9(004).
002600     02  W-SNGW  REDEFINES  W-SNG.
002610       03  W-SNEN       PIC  9(002).
002620       03  W-SGET       PIC  9(002).
002630     02  W-ENG          PIC  9(004).
002640     02  W-ENGW  REDEFINES  W-ENG.
002650       03  W-ENEN       PIC  9(002).
002660       03  W-EGET       PIC  9(002).
002670     02  W-BM           PIC  9(001).
002680     02  W-STCD         PIC  9(004).
002690     02  W-ETCD         PIC  9(004) VALUE 9999.                   I.151103
002700*****02  W-ETCD         PIC  9(004).                              D.151103
002710     02  W-DMM          PIC  9(001).
002720*
002730     02  W-NG.
002740       03  W-NEN        PIC  9(002).
002750       03  W-GET        PIC  9(002).
002760     02  W-SNGD.
002770       03  W-SND        PIC  9(002).
002780       03  W-SGD        PIC  9(002).
002790     02  W-ENGD.
002800       03  W-END        PIC  9(002).
002810       03  W-EGD        PIC  9(002).
002820     02  W-DNO          PIC  9(006).
002830     02  W-TCD          PIC  9(004).
002840     02  W-NGP          PIC  9(008).
002850     02  CHK            PIC  9(001).
002860     COPY LSTAT.
002870 SCREEN SECTION.
002880 SD  C-CRT
002890     END STATUS IS ESTAT.
002900 01  C-CLEAR.
002910     02  C-CL    LINE   1  CLEAR SCREEN.
002920 01  C-MID.
002930     02  LINE   2  COLUMN  15  PIC  N(021) VALUE
002940          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002950     02  LINE   3  COLUMN  15  PIC  N(021) VALUE
002960          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002970     02  LINE   4  COLUMN  15  PIC  N(021) VALUE
002980          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".
002990     02  LINE   5  COLUMN  15  PIC  N(021) VALUE
003000          NC"ÅñÅñÅñÅ@Å@ìæà”êÊë‰í†ÉèÅ[ÉNÅ@çÏê¨Å@Å@ÅñÅñÅñ".
003010     02  LINE   6  COLUMN  15  PIC  N(021) VALUE
003020          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".
003030     02  LINE   7  COLUMN  15  PIC  N(021) VALUE
003040          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
003050     02  LINE   8  COLUMN  15  PIC  N(021) VALUE
003060          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
003070     02  LINE  11  COLUMN  17  PIC  X(039) VALUE
003080            "ÉfÅ[É^ä˙ä‘   '  îN   åéÅ@Å`Å@'  îN   åé".
003090     02  LINE  13  COLUMN  17  PIC  X(039) VALUE
003100            " íäèoä˙ä‘    '  îN   åéÅ@Å`Å@'  îN   åé".
003110     02  LINE  16  COLUMN  17  PIC  X(042) VALUE
003120            "ëSëÃ = 0  ,  óöï® = 1  ,  çHïiëº = 2   [ ]".
003130     02  LINE  18  COLUMN  17  PIC  X(024) VALUE
003140            "ìæà”êÊ∫∞ƒﬁ  0000 Å` 9999".
003150     02  LINE  22  COLUMN  30  PIC  X(022) VALUE
003160            "ämîF  OK=1 NO=9   ÿ¿∞›".
003170 01  C-DSP.
003180     02  D-DNG   LINE  11.
003190       03  COLUMN  31  PIC  9(002)  FROM  W-SND.
003200       03  COLUMN  36  PIC  Z(002)  FROM  W-SGD.
003210       03  COLUMN  47  PIC  9(002)  FROM  W-END.
003220       03  COLUMN  52  PIC  Z(002)  FROM  W-EGD.
003230 01  C-ACP.
003240     02  LINE  13.
003250       03  A-SNEN  COLUMN  31  PIC  9(002)
003260            USING W-SNEN  CHECK OVERFLOW NO IFC.
003270       03  A-SGET  COLUMN  36  PIC  9(002)
003280            USING W-SGET  CHECK OVERFLOW NO IFC.
003290       03  A-ENEN  COLUMN  47  PIC  9(002)
003300            USING W-ENEN  CHECK OVERFLOW NO IFC.
003310       03  A-EGET  COLUMN  52  PIC  9(002)
003320            USING W-EGET  CHECK OVERFLOW NO IFC.
003330     02  A-BM    LINE  16  COLUMN  57  PIC  9(001)
003340          USING W-BM    CHECK OVERFLOW NO IFC.
003350     02  LINE  18.
003360       03  A-STCD  COLUMN  29  PIC  9(004)
003370            USING W-STCD  CHECK OVERFLOW NO IFC.
003380       03  A-ETCD  COLUMN  37  PIC  9(004)
003390            USING W-ETCD  CHECK OVERFLOW NO IFC.
003400     02  A-DMM   LINE  22  COLUMN  47  PIC  9(001)
003410          USING W-DMM   CHECK OVERFLOW NO IFC.
003420 01  C-ERR.
003430     02  LINE  24.
003440       03  E-ME1   COLUMN  15  PIC  X(018) VALUE
003450            "***  DATA ≈º   ***".
003460     COPY LSSEM.
003470     COPY LIBSCR.
003480 PROCEDURE DIVISION.
003490 M-05.
003500     DISPLAY C-CLEAR.
003510     DISPLAY C-MID.
003520*
003530     COPY LIBCPR.
003540     MOVE D-SNG TO W-SNGD.
003550     MOVE D-NHNG TO W-ENGD W-SNG W-ENG.
003560*
003570     CALL "CBLSTNNO" USING STN-NO.
003580     MOVE STN-NO2 TO W-FID12 W-FID22.
003590     MOVE W-FID1 TO WK0064ID.
003600     MOVE W-FID2 TO WK0256ID.
003610     OPEN INPUT TMS-F.
003620     READ TMS-F AT END
003630         MOVE 1 TO W-DC
003640         GO TO M-10.
003650     MOVE TMS-SNG TO W-SNG.
003660     MOVE TMS-ENG TO W-ENG.
003670     MOVE TMS-BM TO W-BM.
003680     MOVE TMS-STCD TO W-STCD.
003690     MOVE TMS-ETCD TO W-ETCD.
003700 M-10.
003710     CLOSE TMS-F.
003720     DISPLAY D-DNG A-SNEN A-SGET A-ENEN A-EGET.
003730     IF W-DC = 0
003740         DISPLAY A-BM A-STCD A-ETCD.
003750*
003760     PERFORM ACP-RTN THRU ACP-EX.
003770     IF COMPLETION-CODE = 255
003780         GO TO M-95.
003790*
003800     OPEN OUTPUT DTWF.
003810     PERFORM TMS-RTN THRU TMS-EX.
003820     IF W-BM = 2
003830         GO TO M-35.
003840*
003850     PERFORM STR-RTN THRU STR-EX.
003860     IF W-BM = 1
003870         GO TO M-60.
003880 M-35.
003890     PERFORM URI-RTN THRU URI-EX.
003900 M-60.
003910     PERFORM NYU-RTN THRU NYU-EX.
003920     CLOSE DTWF.
003930 M-95.
003940     DISPLAY C-CLEAR.
003950     STOP RUN.
003960 ACP-RTN.
003970     IF W-DC = 0
003980         MOVE 1 TO W-DMM
003990         DISPLAY A-DMM
004000         GO TO ACP-EX.
004010     ACCEPT A-SNEN.
004020     IF ESTAT = PF9
004030         MOVE 255 TO COMPLETION-CODE
004040         GO TO ACP-EX.
004050     IF ESTAT NOT = HTB AND SKP
004060         GO TO ACP-RTN.
004070     IF W-SNEN < W-SND
004080         GO TO ACP-RTN.
004090 ACP-020.
004100     ACCEPT A-SGET.
004110     IF ESTAT = BTB
004120         GO TO ACP-RTN.
004130     IF ESTAT NOT = HTB AND SKP
004140         GO TO ACP-020.
004150     IF W-SGET < 1 OR > 12
004160         GO TO ACP-020.
004170     IF W-SNG < W-SNGD
004180         GO TO ACP-020.
004190     MOVE W-SNG TO W-NG.
004200     SUBTRACT 1 FROM W-GET.
004210     IF W-GET = ZERO
004220         MOVE 12 TO W-GET
004230       ELSE
004240         ADD 1 TO W-NEN.
004250 ACP-040.
004260     ACCEPT A-ENEN.
004270     IF ESTAT = BTB
004280         GO TO ACP-020.
004290     IF ESTAT NOT = HTB AND SKP
004300         GO TO ACP-040.
004310     IF W-ENEN > W-END
004320         GO TO ACP-040.
004330 ACP-060.
004340     ACCEPT A-EGET.
004350     IF ESTAT = BTB
004360         GO TO ACP-040.
004370     IF ESTAT NOT = HTB AND SKP
004380         GO TO ACP-060.
004390     IF W-ENG > W-ENGD
004400         GO TO ACP-060.
004410     IF W-ENG > W-NG
004420         GO TO ACP-060.
004430 ACP-080.
004440     ACCEPT A-BM.
004450     IF ESTAT = BTB
004460         GO TO ACP-060.
004470     IF ESTAT = PF9
004480         MOVE 255 TO COMPLETION-CODE
004490         GO TO ACP-EX.
004500     IF ESTAT NOT = HTB AND SKP
004510         GO TO ACP-080.
004520     IF W-BM > 2
004530         GO TO ACP-080.
004540 ACP-100.
004550     ACCEPT A-STCD.
004560     IF ESTAT = BTB
004570         GO TO ACP-080.
004580     IF ESTAT = PF9
004590         MOVE 255 TO COMPLETION-CODE
004600         GO TO ACP-EX.
004610     IF ESTAT NOT = HTB AND SKP
004620         GO TO ACP-100.
004630 ACP-120.
004640     ACCEPT A-ETCD.
004650     IF ESTAT = BTB
004660         GO TO ACP-100.
004670     IF ESTAT NOT = HTB AND SKP
004680         GO TO ACP-100.
004690     IF W-STCD > W-ETCD
004700         GO TO ACP-120.
004710 ACP-140.
004720     ACCEPT A-DMM.
004730     IF W-DC = 0
004740         IF ESTAT = PF9
004750             MOVE 255 TO COMPLETION-CODE
004760             GO TO ACP-EX.
004770     IF ESTAT = BTB
004780         IF W-DC = 1
004790             GO TO ACP-120.
004800     IF ESTAT NOT = HTB AND SKP
004810         GO TO ACP-140.
004820     IF W-DMM = 9
004830         IF W-DC = 1
004840             GO TO ACP-RTN
004850           ELSE
004860             MOVE 255 TO COMPLETION-CODE
004870             GO TO ACP-EX.
004880     IF W-DMM NOT = 1
004890         GO TO ACP-140.
004900 ACP-EX.
004910     EXIT.
004920 TMS-RTN.
004930     OPEN INPUT TMS-F.
004940 TMS-020.
004950     READ TMS-F AT END
004960         GO TO TMS-100.
004970*****IF TMS-TCD = 4745 OR 4758                                    D.160128
004980*****    GO TO TMS-020.                                           D.160128
004990     IF ZERO = TMS-KIN AND TMS-SHZ
005000         GO TO TMS-020.
005010 TMS-040.
005020     MOVE TMS-TCD TO W-TCD.
005030     MOVE TMS-NGP TO W-NGP.
005040*
005050     MOVE SPACE TO DTW-R.
005060     INITIALIZE DTW-D1.
005070     MOVE SPACE TO DT1-TEKI.
005080     MOVE TMS-BC  TO DT1-BMC.
005090     MOVE TMS-NGP TO DT1-DATE.
005100     MOVE TMS-TCD TO DT1-TCD.
005110     MOVE TMS-KIN TO DT1-KIN.
005120     MOVE TMS-DC  TO DT1-DC.
005130     MOVE TMS-SHZ TO DT1-SHZ.
005140     MOVE TMS-TNC TO DT1-TNC.
005150     MOVE TMS-DATE TO DT1-SNGP.
005160 TMS-060.
005170     READ TMS-F AT END
005180         GO TO TMS-080.
005190*****IF UR-TCD = 4745 OR 4758                                     D.160128
005200*****    GO TO TMS-060.                                           D.160128
005210     IF ZERO = TMS-KIN AND TMS-SHZ
005220         GO TO TMS-060.
005230     IF (TMS-TCD NOT = W-TCD) OR (TMS-NGP NOT = W-NGP)
005240         MOVE 9 TO DT1-EC.
005250     WRITE DTW-R.
005260     GO TO TMS-040.
005270 TMS-080.
005280     MOVE 9 TO DT1-EC.
005290     WRITE DTW-R.
005300 TMS-100.
005310     CLOSE TMS-F.
005320 TMS-EX.
005330     EXIT.
005340 STR-RTN.
005350     OPEN INPUT STRANYR.
005360     MOVE 0 TO CHK.
005370 STR-020.
005380     READ STRANYR AT END
005390         GO TO STR-100.
005400     IF W-SNG > S1-NG
005410         GO TO STR-020.
005420     IF W-ENG < S1-NG
005430         GO TO STR-100.
005440     IF S1-TCD < W-STCD OR > W-ETCD
005450         GO TO STR-020.
005460     IF S1-TCD = 5000 OR 9850
005470         GO TO STR-020.
005480 STR-040.
005490     MOVE S1-DNO TO W-DNO.
005500*
005510     MOVE SPACE TO DTW-R.
005520     IF S1-GNO > 6
005530         INITIALIZE DTW-D2
005540         MOVE SPACE TO DT2-BI
005550         MOVE S2-DNO TO DT2-DNO
005560         MOVE S2-GNO TO DT2-GNO
005570         MOVE S2-DATE TO DT2-DATE
005580         MOVE S2-TCD TO DT2-TCD
005590         MOVE S2-BI TO DT2-BI
005600         MOVE S2-HNO TO DT2-HNO
005610         MOVE S2-TAX TO DT2-TAX
005620         MOVE S2-SNC TO DT2-SNC
005630         MOVE S2-DHC TO DT2-PC
005640       ELSE
005650         INITIALIZE DTW-D1
005660         MOVE SPACE   TO DT1-TEKI
005670         MOVE S1-DNO  TO DT1-DNO
005680         MOVE S1-GNO  TO DT1-GNO
005690         MOVE S1-DATE TO DT1-DATE
005700         MOVE S1-TCD  TO DT1-TCD
005710         MOVE S1-HCD  TO DT1-HCD
005720         MOVE S1-SUT  TO DT1-SUT
005730         MOVE S1-T    TO DT1-T
005740         MOVE S1-KIN  TO DT1-KIN
005750         MOVE S1-CSC  TO DT1-CSC
005760         MOVE S1-DC   TO DT1-DC
005770         MOVE S1-BKC  TO DT1-BKC
005780         MOVE S1-BMNO TO DT1-BMNO
005790         MOVE S1-FT   TO DT1-FT
005800         MOVE S1-SIZ  TO DT1-SIZ
005810         MOVE S1-SU(01) TO DT1-SU(01)
005820         MOVE S1-SU(02) TO DT1-SU(02)
005830         MOVE S1-SU(03) TO DT1-SU(03)
005840         MOVE S1-SU(04) TO DT1-SU(04)
005850         MOVE S1-SU(05) TO DT1-SU(05)
005860         MOVE S1-SU(06) TO DT1-SU(06)
005870         MOVE S1-SU(07) TO DT1-SU(07)
005880         MOVE S1-SU(08) TO DT1-SU(08)
005890         MOVE S1-SU(09) TO DT1-SU(09)
005900         MOVE S1-SU(10) TO DT1-SU(10)
005910         MOVE S1-CCD  TO DT1-CCD
005920         MOVE S1-BC   TO DT1-BC
005930         MOVE S1-SKC  TO DT1-SKC
005940         MOVE S1-TNC  TO DT1-TNC
005950         MOVE S1-HSC  TO DT1-HSC
005960         MOVE S1-KOSU TO DT1-KOSU
005970         MOVE S1-FRC  TO DT1-FRC
005980         MOVE S1-TCD2 TO DT1-TCD2
005990         MOVE S1-BIK  TO DT1-BIK
006000         MOVE S1-USC  TO DT1-USC
006010         MOVE S1-SNC  TO DT1-SNC
006020         MOVE S1-SKU  TO DT1-SKU
006030         MOVE S1-DHC  TO DT1-PC.
006040 STR-060.
006050     READ STRANYR AT END
006060         GO TO STR-080.
006070     IF W-ENG < S1-NG
006080         GO TO STR-080.
006090     IF S1-TCD < W-STCD OR > W-ETCD
006100         GO TO STR-060.
006110     IF S1-TCD = 5000 OR 9850
006120         GO TO STR-060.
006130     IF S1-DNO NOT = W-DNO
006140         MOVE 9 TO DT1-EC.
006150     WRITE DTW-R.
006160     GO TO STR-040.
006170 STR-080.
006180     MOVE 9 TO DT1-EC.
006190     WRITE DTW-R.
006200 STR-100.
006210     CLOSE STRANYR.
006220 STR-EX.
006230     EXIT.
006240 URI-RTN.
006250     OPEN INPUT URIRYR.
006260 URI-020.
006270     READ URIRYR AT END
006280         GO TO URI-100.
006290     IF W-SNG > UR-NG
006300         GO TO URI-020.
006310     IF W-ENG < UR-NG
006320         GO TO URI-100.
006330     IF UR-TCD < W-STCD OR > W-ETCD
006340         GO TO URI-020.
006350*****IF UR-TCD = 4745 OR 4758                                     D.160128
006360*****    GO TO URI-020.                                           D.160128
006370 URI-040.
006380     MOVE UR-DNO TO W-DNO.
006390*
006400     MOVE SPACE TO DTW-R.
006410     INITIALIZE DTW-D1.
006420     MOVE SPACE TO DT1-TEKI.
006430     MOVE UR-BMC  TO DT1-BMC.
006440     MOVE UR-DNO  TO DT1-DNO.
006450     MOVE UR-GNO  TO DT1-GNO.
006460     MOVE UR-DATE TO DT1-DATE.
006470     MOVE UR-TCD  TO DT1-TCD.
006480     MOVE UR-HCD  TO DT1-KCD.
006490     MOVE UR-SUT  TO DT1-SUT.
006500     MOVE UR-T    TO DT1-T.
006510     MOVE UR-KIN  TO DT1-KIN.
006520     MOVE UR-CSC  TO DT1-CSC.
006530     MOVE UR-DC   TO DT1-DC.
006540     MOVE UR-BKC  TO DT1-BKC.
006550     MOVE UR-GT   TO DT1-FT.
006560     MOVE UR-HYC  TO DT1-HYC.
006570     MOVE UR-YC   TO DT1-YC.
006580     MOVE UR-SGP  TO DT1-SGP.
006590     MOVE UR-NNO  TO DT1-NNO.
006600     MOVE UR-JCD  TO DT1-JCD.
006610     MOVE UR-TEK  TO DT1-TEKI.
006620     MOVE UR-SKU  TO DT1-SKU.
006630     MOVE UR-PC   TO DT1-PC.
006640 URI-060.
006650     READ URIRYR AT END
006660         GO TO URI-080.
006670     IF W-ENG < UR-NG
006680         GO TO URI-080.
006690     IF UR-TCD < W-STCD OR > W-ETCD
006700         GO TO URI-060.
006710*****IF UR-TCD = 4745 OR 4758                                     D.160128
006720*****    GO TO URI-060.                                           D.160128
006730     IF UR-DNO NOT = W-DNO
006740         MOVE 9 TO DT1-EC.
006750     WRITE DTW-R.
006760     GO TO URI-040.
006770 URI-080.
006780     MOVE 9 TO DT1-EC.
006790     WRITE DTW-R.
006800 URI-100.
006810     CLOSE URIRYR.
006820 URI-EX.
006830     EXIT.
006840 NYU-RTN.
006850     OPEN INPUT NYURYR.
006860 NYU-020.
006870     READ NYURYR AT END
006880         GO TO NYU-100.
006890     IF W-SNG > NY-NG
006900         GO TO NYU-020.
006910     IF W-ENG < NY-NG
006920         GO TO NYU-100.
006930     IF NY-TCD < W-STCD OR > W-ETCD
006940         GO TO NYU-020.
006950*****IF NY-TCD = 5000 OR 9850 OR 4745 OR 4758                     D.160128
006960     IF NY-TCD = 5000 OR 9850                                     I.160128
006970         GO TO NYU-020.
006980     IF W-BM = 1
006990         IF NY-BMC NOT = 0
007000             GO TO NYU-020.
007010     IF W-BM = 2
007020         IF NY-BMC = 0
007030             GO TO NYU-020.
007040 NYU-040.
007050     MOVE NY-DNO  TO W-DNO.
007060*
007070     MOVE SPACE TO DTW-R.
007080     INITIALIZE DTW-D1.
007090     MOVE SPACE TO DT1-TEKI.
007100     MOVE NY-BMC  TO DT1-BMC.
007110     MOVE 1       TO DT1-UNC.
007120     MOVE NY-DNO  TO DT1-DNO.
007130     MOVE NY-GNO  TO DT1-GNO.
007140     MOVE NY-DATE TO DT1-DATE.
007150     MOVE NY-TCD  TO DT1-TCD.
007160     MOVE NY-KIN  TO DT1-KIN.
007170     MOVE NY-NKC  TO DT1-NKC.
007180     MOVE NY-SSC  TO DT1-SSC.
007190     MOVE NY-TKG  TO DT1-TKG.
007200     MOVE NY-SKNG TO DT1-SKNG.
007210     MOVE NY-DCC  TO DT1-DCC.
007220     MOVE NY-SKU  TO DT1-SKU.
007230     MOVE NY-PC   TO DT1-PC.
007240 NYU-060.
007250     READ NYURYR AT END
007260         GO TO NYU-080.
007270     IF W-ENG < NY-NG
007280         GO TO NYU-080.
007290     IF NY-TCD < W-STCD OR > W-ETCD
007300         GO TO NYU-060.
007310*****IF NY-TCD = 5000 OR 9850 OR 4745 OR 4758                     D.160128
007320     IF NY-TCD = 5000 OR 9850                                     I.160128
007330         GO TO NYU-060.
007340     IF W-BM = 1
007350         IF NY-BMC NOT = 0
007360             GO TO NYU-060.
007370     IF W-BM = 2
007380         IF NY-BMC = 0
007390             GO TO NYU-060.
007400     IF NY-DNO NOT = W-DNO
007410         MOVE 9 TO DT1-EC.
007420     WRITE DTW-R.
007430     GO TO NYU-040.
007440 NYU-080.
007450     MOVE 9 TO DT1-EC.
007460     WRITE DTW-R.
007470 NYU-100.
007480     CLOSE NYURYR.
007490 NYU-EX.
007500     EXIT.
