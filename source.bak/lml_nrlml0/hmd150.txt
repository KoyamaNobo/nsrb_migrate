000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD150.
000030*********************************************************
000040*    PROGRAM         :  î≠ëóñæç◊ÇeÅ@èCê≥ì¸óÕ (≈Ã∫•‹∞∏œ›)*
000050*    SCREEN          :  SCHD15                          *
000060*    COMPILE TYPE    :  COBOL                           *
000070*********************************************************
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER. SYSTEM3100.
000110 OBJECT-COMPUTER. SYSTEM3100.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     COPY LIBCSE.
000150     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000160         ORGANIZATION INDEXED
000170         ACCESS MODE RANDOM
000180         RECORD KEY T-KEY
000190         ALTERNATE RECORD KEY T-KEY2.
000200     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000210         ORGANIZATION INDEXED
000220         ACCESS MODE RANDOM
000230         RECORD KEY HI-KEY
000240         ALTERNATE RECORD KEY HI-KEY2.
000250     SELECT TC-M ASSIGN TO TC-MSD
000260         ORGANIZATION INDEXED
000270         ACCESS MODE RANDOM
000280         RECORD KEY TC-KEY.
000290     SELECT JCON ASSIGN TO F4-MSD
000300         ORGANIZATION INDEXED
000310         ACCESS MODE RANDOM
000320         RECORD KEY JCON3-KEY
000330         FILE STATUS IS ERR-STAT.
000340     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD
000350         ORGANIZATION INDEXED
000360         ACCESS MODE RANDOM
000370         RECORD KEY THT-KEY
000380         ALTERNATE RECORD KEY THT-KEY2
000390         FILE STATUS IS ERR-STAT.
000400     SELECT HSMSF ASSIGN TO HSMS-MSD
000410         ORGANIZATION INDEXED
000420         ACCESS MODE DYNAMIC
000430         RECORD KEY HSMS-KEY
000440         FILE STATUS IS ERR-STAT.
000450     SELECT TSKF  ASSIGN TO TSK-MSD
000460         ORGANIZATION INDEXED
000470         ACCESS MODE RANDOM
000480         RECORD KEY TSK-KEY
000490         FILE STATUS IS ERR-STAT.
000500 I-O-CONTROL.
000510     APPLY SHARED-MODE ON T-M
000520     APPLY SHARED-MODE ON JCON
000530     APPLY SHARED-MODE ON THTM
000540     APPLY SHARED-MODE ON HI-M
000550     APPLY SHARED-MODE ON TC-M
000560     APPLY SHARED-MODE ON HSMSF
000570     APPLY SHARED-MODE ON TSKF
000580     APPLY SHARED-MODE ON M-DATE.
000590 DATA DIVISION.
000600 FILE SECTION.
000610     COPY LIBFDD.
000620     COPY LITM.
000630     COPY LIHIM.
000640     COPY LITCM.
000650     COPY LIHSMS.
000660     COPY LITHTM.
000670     COPY L-JCON.
000680     COPY LITSKF.
000690 WORKING-STORAGE SECTION.
000700 77  W-FILE             PIC  X(013).
000710 77  W-END              PIC  9(001) VALUE 0.
000720 77  W-INV              PIC  9(001) VALUE 0.
000730 77  W-ADV              PIC  9(001) VALUE 0.
000740 01  ERR-STAT           PIC  X(002).
000750 01  WR-D1.
000760     02  WR-KEY.                                                  KEY
000770       03  WR-DNO       PIC  9(006).                              º≠Ø∂ºΩﬁ
000780       03  WR-GNO       PIC  9(001).                              ∑ﬁÆ≥
000790     02  WR-DC          PIC  9(001).                              √ﬁ›∏
000800     02  WR-DATE        PIC  9(008).                              º≠Ø∂Àﬁºﬁ
000810     02  WR-OTD.                                                  ¡Æ∏ø≥ CD
000820       03  WR-TCD       PIC  9(004).                              ƒ∏≤∫∞ƒﬁ
000830       03  WR-CCD       PIC  9(003).                              ¡Æ∏ NO
000840     02  WR-SOK         PIC  9(001).                              ∏◊ ∫∞ƒﬁ
000850     02  WR-HCD         PIC  9(006).                              À›∫∞ƒﬁ
000860     02  WR-SIZ         PIC  9(001).                              ª≤Ωﬁ∏Ãﬁ›
000870     02  WR-ASU.                                                  º≠Ø∂ºﬁ¬
000880       03  WR-SUD   OCCURS  10.                                   ª≤ΩﬁÕﬁ¬
000890         04  WR-SU      PIC S9(004).
000900       03  WR-SUT       PIC S9(006).
000910     02  WR-ACD         PIC  9(001).                              ±Ωﬁ∂ÿ KB
000920     02  WR-KSU         PIC S9(003).                              å¬êî
000930     02  WR-PRC         PIC  9(001).                              ≤›ºﬁ∏Ãﬁ›
000940     02  WR-TNC         PIC  9(002).                              ¿›ƒ≥
000950     02  F              PIC  9(002).                              Ãﬁ›Ÿ≤2
000960     02  WR-TAN         PIC  9(005).                              ¿›∂
000970     02  WR-SKD         PIC  9(008).
000980     02  WR-GBI         PIC  X(010).
000990     02  WR-HKC         PIC  9(001).                              Õ›∂›∏Ãﬁ›
001000     02  WR-USO         PIC  9(001).
001010     02  F              PIC  X(014).
001020     02  WR-TSC         PIC  9(001).
001030     02  WR-NRC         PIC  9(001).
001040     02  WR-SSU         PIC  9(001).                              º÷≥∂≤Ω≥
001050 01  WR-AD.
001060     02  WR-D    OCCURS   6  PIC  X(128).
001070 01  WR-D2.
001080     02  W-KEY2.
001090       03  W-DNOB       PIC  9(006).                              º≠Ø∂ºΩﬁ
001100       03  W-GNOB       PIC  9(001).                              ∑ﬁÆ≥
001110     02  W-DCB          PIC  9(001).                              √ﬁ›∏
001120     02  W-DATEB        PIC  9(008).                              º≠Ø∂Àﬁºﬁ
001130     02  W-OTDB.                                                  ¡Æ∏ø≥ CD
001140       03  W-TCDB       PIC  9(004).                              ƒ∏≤∫∞ƒﬁ
001150       03  W-CCDB       PIC  9(003).                              ¡Æ∏ NO
001160     02  W-SOKB         PIC  9(001).                              ∏◊ ∫∞ƒﬁ
001170     02  W-BI           PIC  N(024).                              ìEóv
001180     02  F              PIC  X(056).
001190 01  W-ADC.
001200     02  W-DC    OCCURS   6  PIC  9(001).
001210 01  W-AKIN.
001220     02  W-KIN   OCCURS   6  PIC S9(008).
001230 01  WB-AD.
001240     02  WB-D    OCCURS  6.
001250       03  WB-HCD      PIC  9(006).
001260       03  WB-SIZ      PIC  9(001).
001270       03  WB-TAN      PIC  9(005).
001280 01  W-ASD.
001290     02  W-SD    OCCURS  10  PIC  9(001).
001300 01  W-DATA.
001310     02  W-L.
001320       03  W-L1         PIC  9(002).
001330       03  W-L2         PIC  9(002).
001340       03  W-L3         PIC  9(002).
001350     02  W-C            PIC S9(002).
001360     02  W-KIND         PIC S9(008).
001370     02  W-GSUT         PIC S9(006).
001380     02  W-RC           PIC  9(001).
001390     02  W-SC           PIC  9(002).
001400     02  W-DMM          PIC  9(001).
001410     02  W-DNOD         PIC  9(006).
001420     02  W-DNOO         PIC  9(006).
001430     02  W-NGP          PIC  9(008).
001440     02  W-NGPD  REDEFINES W-NGP.
001450       03  W-NGD.
001460         04  W-ND       PIC  9(004).
001470         04  W-NDD   REDEFINES W-ND.
001480           05  W-ND1    PIC  9(002).
001490           05  W-ND2    PIC  9(002).
001500         04  W-GD       PIC  9(002).
001510       03  W-PD         PIC  9(002).
001520     02  W-NGPSD REDEFINES W-NGP.
001530       03  F            PIC  9(002).
001540       03  W-NGPS       PIC  9(006).
001550     02  W-TCDD         PIC  9(004).
001560     02  W-CCDD         PIC  9(003).
001570     02  W-HCDD         PIC  9(006).
001580     02  W-HCDO         PIC  9(006).
001590     02  W-DCD          PIC  9(001).
001600     02  W-DCC          PIC  9(001).
001610     02  W-ZC           PIC  9(001).
001620     02  W-CNG.
001630       03  W-CN         PIC  9(004).
001640       03  W-CND   REDEFINES W-CN.
001650         04  W-CN1      PIC  9(002).
001660         04  W-CN2      PIC  9(002).
001670       03  W-CG         PIC  9(002).
001680     02  W-SNGD  REDEFINES W-CNG.
001690       03  F            PIC  9(002).
001700       03  W-CNGS       PIC  9(004).
001710     02  W-SNG          PIC  9(006).
001720     02  W-ENG          PIC  9(006).
001730     02  W-HSCD         PIC  9(001).
001740     02  W-HNC          PIC  9(001).
001750     02  W-HNCD         PIC  9(001).
001760     02  W-SCD          PIC  9(001).
001770     02  W-KOSUR        PIC  9(003).
001780     02  WK-TAN         PIC S9(005).
001790     02  W-FRCD         PIC  9(001).
001800     02  W-DTW1         PIC  9(003).
001810     02  W-DTW2         PIC  9(001).
001820     02  W-SDTD         PIC  9(008).
001830     02  W-SDTM  REDEFINES W-SDTD.
001840       03  W-SDTNG.
001850         04  W-SDTN     PIC  9(004).
001860         04  W-SDTG     PIC  9(002).
001870       03  W-SDTP       PIC  9(002).
001880     02  W-HMN          PIC  9(006).
001890     02  WK-SCD         PIC  9(001).
001900     02  WK-DC          PIC  9(001).
001910     02  WK-BI          PIC  N(024).
001920     02  W-EC           PIC  9(001).
001930     02  W-DEL          PIC  9(001).
001940     02  W-RCD          PIC  9(001).
001950     02  CNT            PIC  9(001).
001960     02  W-HC           PIC  9(001).
001970     02  W-LD           PIC  9(006).
001980     02  W-RCB          PIC  9(001).
001990     02  W-LB           PIC  9(006).
002000     02  W-DSPC         PIC  9(001).
002010     02  W-DKIN         PIC S9(008).
002020     02  W-SDATE        PIC  9(008).
002030     02  W-HIC          PIC  9(001).
002040     02  W-FTD          PIC  9(005).
002050     COPY LSTAT.
002060 SCREEN SECTION.
002070 SD  C-CRT
002080     END STATUS IS ESTAT.
002090 01  C-CLEAR.
002100     02  LINE   1  CLEAR SCREEN.
002110 01  C-ACP.
002120     02  LINE   1.
002130       03  A-HMN   COLUMN  25  PIC  9(006)
002140            USING W-HMN   CHECK OVERFLOW NO IFC.
002150       03  A-NGP   COLUMN  37  PIC  9(006)
002160            USING W-NGPS  CHECK OVERFLOW NO IFC.
002170       03  A-SOK   COLUMN  49  PIC  9(001)
002180            USING W-SCD   CHECK OVERFLOW NO IFC.
002190     02  LINE   3.
002200       03  A-CCD   COLUMN   6  PIC  9(003)
002210            USING W-CCDD  CHECK OVERFLOW NO IFC.
002220     02  LINE W-L1.
002230       03  A-DC    COLUMN   4  PIC  9(001)
002240            USING W-DC(W-RC) CHECK OVERFLOW NO IFC.
002250       03  A-HCD   COLUMN  11  PIC  9(006)
002260            USING WR-HCD  CHECK OVERFLOW NO IFC.
002270       03  A-GBI   COLUMN  71  PIC  X(010)
002280            USING WR-GBI  CHECK OVERFLOW NO IFC.
002290     02  LINE W-L3.
002300       03  A-SIZ   COLUMN   1  PIC  9(001)
002310            USING WR-SIZ  CHECK OVERFLOW NO IFC.
002320       03  A-SU    COLUMN W-C  PIC S9(004)
002330            USING WR-SU(W-SC) CHECK OVERFLOW NO IFC.
002340       03  A-SU1   COLUMN W-C  PIC S9(003)
002350            USING WR-SU(W-SC) CHECK OVERFLOW NO IFC.
002360       03  A-SUT   COLUMN  60  PIC S9(005)
002370            USING WR-SUT  CHECK OVERFLOW NO IFC.
002380       03  A-TAN   COLUMN  67  PIC  9(005)
002390            USING WR-TAN  CHECK OVERFLOW NO IFC.
002400       03  A-KIN   COLUMN  73  PIC S9(007)
002410            USING W-KIND  CHECK OVERFLOW NO IFC.
002420     02  A-BI    LINE  22  COLUMN   6  PIC  N(024)
002430          USING W-BI    CHECK OVERFLOW NO IFC.
002440     02  LINE  23.
002450       03  A-KOSU  COLUMN   6  PIC  9(003)
002460            USING W-KOSUR CHECK OVERFLOW NO IFC.
002470       03  A-SDT   COLUMN  33  PIC  9(008)
002480            USING W-SDTD  CHECK OVERFLOW NO IFC.
002490       03  A-DMM   COLUMN  63  PIC  9(001)
002500            USING W-DMM   CHECK OVERFLOW NO IFC.
002510 01  C-DSP.
002520     02  D-SNA   LINE   1  COLUMN  51  PIC  N(006) FROM
002530          JCON3-03.
002540     02  LINE   2.
002550       03  D-TCD   COLUMN   6  PIC  9(004) FROM  W-TCDD.
002560       03  D-TNA   COLUMN  11  PIC  N(026) FROM  T-NAME.
002570     02  D-CNA   LINE   3  COLUMN  11  PIC  N(026) FROM  TC-NAME.
002580     02  LINE W-L1.
002590       03  D-HNA   COLUMN  18  PIC  N(024) FROM  HI-NAME.
002600     02  LINE W-L2.
002610       03  D-S1.
002620         04  COLUMN   3  PIC  X(005) VALUE "     ".
002630         04  COLUMN   9  PIC  X(005) VALUE "     ".
002640         04  COLUMN  15  PIC  X(005) VALUE " SS  ".
002650         04  COLUMN  21  PIC  X(005) VALUE "  S  ".
002660         04  COLUMN  27  PIC  X(005) VALUE "  MÅ@".
002670         04  COLUMN  33  PIC  X(005) VALUE "  LÅ@".
002680         04  COLUMN  39  PIC  X(005) VALUE " LL  ".
002690         04  COLUMN  45  PIC  X(004) VALUE "28.0".
002700         04  COLUMN  50  PIC  X(004) VALUE "29.0".
002710         04  COLUMN  55  PIC  X(004) VALUE "30.0".
002720       03  D-S2.
002730         04  COLUMN   3  PIC  X(005) VALUE "12.5 ".
002740         04  COLUMN   9  PIC  X(005) VALUE "13.0 ".
002750         04  COLUMN  15  PIC  X(005) VALUE "13.5 ".
002760         04  COLUMN  21  PIC  X(005) VALUE "14.0 ".
002770         04  COLUMN  27  PIC  X(005) VALUE "15.0 ".
002780         04  COLUMN  33  PIC  X(005) VALUE "16.0 ".
002790         04  COLUMN  39  PIC  X(005) VALUE "17.0 ".
002800         04  COLUMN  45  PIC  X(004) VALUE "18.0".
002810         04  COLUMN  50  PIC  X(004) VALUE "19.0".
002820         04  COLUMN  55  PIC  X(004) VALUE "20.0".
002830       03  D-S3.
002840         04  COLUMN   3  PIC  X(005) VALUE "21.0 ".
002850         04  COLUMN   9  PIC  X(005) VALUE "21.5 ".
002860         04  COLUMN  15  PIC  X(005) VALUE "22.0 ".
002870         04  COLUMN  21  PIC  X(005) VALUE "22.5 ".
002880         04  COLUMN  27  PIC  X(005) VALUE "23.0 ".
002890         04  COLUMN  33  PIC  X(005) VALUE "23.5 ".
002900         04  COLUMN  39  PIC  X(005) VALUE "24.0 ".
002910         04  COLUMN  45  PIC  X(004) VALUE "24.5".
002920         04  COLUMN  50  PIC  X(004) VALUE "25.0".
002930         04  COLUMN  55  PIC  X(004) VALUE "    ".
002940       03  D-S4.
002950         04  COLUMN   3  PIC  X(005) VALUE "24.0 ".
002960         04  COLUMN   9  PIC  X(005) VALUE "24.5 ".
002970         04  COLUMN  15  PIC  X(005) VALUE "25.0 ".
002980         04  COLUMN  21  PIC  X(005) VALUE "25.5 ".
002990         04  COLUMN  27  PIC  X(005) VALUE "26.0 ".
003000         04  COLUMN  33  PIC  X(005) VALUE "26.5 ".
003010         04  COLUMN  39  PIC  X(005) VALUE "27.0 ".
003020         04  COLUMN  45  PIC  X(004) VALUE "27.5".
003030         04  COLUMN  50  PIC  X(004) VALUE "    ".
003040         04  COLUMN  55  PIC  X(004) VALUE "    ".
003050     02  LINE W-L3.
003060       03  D-SU    COLUMN W-C  PIC ZZZZ-     FROM  WR-SU(W-SC).
003070       03  D-SU1   COLUMN W-C  PIC ZZZ-      FROM  WR-SU(W-SC).
003080       03  D-SUT   COLUMN  60  PIC ZZZZZ-    FROM  WR-SUT.
003090       03  D-TAN   COLUMN  67  PIC ZZZZZ     FROM  WR-TAN.
003100       03  D-KIN   COLUMN  73  PIC ZZZZZZZ-  FROM  W-KIND.
003110     02  LINE  22.
003120       03  D-GSUT  COLUMN  58  PIC ZZZ,ZZZ-  FROM  W-GSUT.
003130     02  LINE  23.
003140       03  D-KOSU  COLUMN   6  PIC ZZ9       FROM  W-KOSUR.
003150 01  C-SPC.
003160     02  SU-HNO.
003170       03  LINE   1.
003180         04  SU-HMN   COLUMN  25  PIC  X(006) VALUE "      ".
003190         04  SU-DATE  COLUMN  37  PIC  X(006) VALUE "      ".
003200         04  SU-SOK   COLUMN  49  PIC  X(014) VALUE
003210              "            ".
003220     02  SU-CNA   LINE   3.
003230       03  COLUMN   6  PIC  X(003) VALUE "   ".
003240       03  COLUMN  11  PIC  X(052) VALUE
003250           "                                                    ".
003260     02  SU-D1    LINE W-L1.
003270       03  COLUMN   4  PIC  X(001) VALUE " ".
003280       03  COLUMN  11  PIC  X(006) VALUE "     ".
003290       03  COLUMN  18  PIC  X(048) VALUE
003300            "                                                ".
003310       03  SU-GBI   COLUMN  71  PIC  X(010) VALUE "          ".
003320     02  SU-D2    LINE W-L2.
003330       03  COLUMN   3  PIC  X(005) VALUE "     ".
003340       03  COLUMN   9  PIC  X(005) VALUE "     ".
003350       03  COLUMN  15  PIC  X(005) VALUE "     ".
003360       03  COLUMN  21  PIC  X(005) VALUE "     ".
003370       03  COLUMN  27  PIC  X(005) VALUE "     ".
003380       03  COLUMN  33  PIC  X(005) VALUE "     ".
003390       03  COLUMN  39  PIC  X(005) VALUE "     ".
003400       03  COLUMN  45  PIC  X(004) VALUE "    ".
003410       03  COLUMN  50  PIC  X(004) VALUE "    ".
003420       03  COLUMN  55  PIC  X(004) VALUE "    ".
003430     02  SU-D3    LINE W-L3.
003440       03  SU-D31.
003450         04  COLUMN   1  PIC  X(001) VALUE " ".
003460         04  COLUMN   3  PIC  X(005) VALUE "     ".
003470         04  COLUMN   9  PIC  X(005) VALUE "     ".
003480         04  COLUMN  15  PIC  X(005) VALUE "     ".
003490         04  COLUMN  21  PIC  X(005) VALUE "     ".
003500         04  COLUMN  27  PIC  X(005) VALUE "     ".
003510         04  COLUMN  33  PIC  X(005) VALUE "     ".
003520         04  COLUMN  39  PIC  X(005) VALUE "     ".
003530         04  COLUMN  45  PIC  X(004) VALUE "    ".
003540         04  COLUMN  50  PIC  X(004) VALUE "    ".
003550         04  COLUMN  55  PIC  X(004) VALUE "    ".
003560       03          COLUMN  60  PIC  X(006) VALUE "      ".
003570       03  SU-TAN   COLUMN  67  PIC  X(005) VALUE "     ".
003580       03  SU-KIN   COLUMN  73  PIC  X(008) VALUE "        ".
003590     02  LINE  23.
003600       03  SU-KOSU  COLUMN   6  PIC  X(003) VALUE "   ".
003610 01  C-ERR.
003620     02  LINE  24.
003630       03  E-ME1   COLUMN  15  PIC  X(015) VALUE
003640            "***  TM ≈º  ***".
003650       03  E-ME2   COLUMN  15  PIC  X(016) VALUE
003660            "***  TCM ≈º  ***".
003670       03  E-ME3   COLUMN  15  PIC  X(021) VALUE
003680            "***  PROGRAM ¥◊∞  ***".
003690       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
003700            "***  ãÊï™ÉGÉâÅ[  ***".
003710       03  E-ME5   COLUMN  15  PIC  X(020) VALUE
003720            "***  íºëóÉGÉâÅ[ ***".
003730       03  E-ME6.
003740         04  COLUMN  15  PIC  X(016) VALUE
003750              "***  HIM ≈º  ***".
003760         04  COLUMN  34  PIC  9(006) FROM  WR-HCD.
003770       03  E-ME7.
003780         04  COLUMN  15  PIC  X(022) VALUE
003790              "***  êUë÷íPâøñ≥Çµ  ***".
003800         04  COLUMN  40  PIC  9(006) FROM  WR-HCD.
003810       03  E-ME8   COLUMN  15  PIC  X(024) VALUE
003820            "***  óaÇËÉTÉCÉYñ≥Çµ  ***".
003830       03  E-ME9   COLUMN  15  PIC  X(020) VALUE
003840            "***  ÉTÉCÉYñ≥Çµ  ***".
003850       03  E-ME10  COLUMN  15  PIC  X(023) VALUE
003860            "***  ÇcÇ`ÇsÇ`ÉGÉâÅ[ ***".
003870       03  E-ME12  COLUMN  15  PIC  X(020) VALUE
003880            "***  ì˙ïtÉGÉâÅ[ ***".
003890       03  E-ME14  COLUMN  15  PIC  X(025) VALUE
003900            "***  î≠ëóñæç◊áÇ CHECK ***".
003910       03  E-ME15  COLUMN  15  PIC  X(025) VALUE
003920            "***  íPâø  ZERO CHECK ***".
003930       03  E-ME20  COLUMN  15  PIC  X(019) VALUE
003940            "***  ƒ∏≤ª∑ ¥◊∞  ***".
003950       03  E-ME21  COLUMN  15  PIC  X(017) VALUE
003960            "***  √ﬁ∞¿ ≈º  ***".
003970       03  E-ME22  COLUMN  15  PIC  X(028) VALUE
003980            "***  HSMSF DELETE ¥◊∞  ***".
003990       03  E-ME23  COLUMN  15  PIC  X(027) VALUE
004000            "***  HSMSF WRITE ¥◊∞  ***".
004010       03  E-ME25.
004020         04  COLUMN  15  PIC  N(008) VALUE
004030              NC"êøãÅèëÅ@î≠çsçœÇ›".
004040         04  COLUMN  34  PIC 9999/99/99  FROM  W-SDATE.
004050       03  E-ME26  COLUMN  15  PIC  X(024) VALUE
004060            "***  THTM WRITE ¥◊∞  ***".
004070       03  E-ME27  COLUMN  15  PIC  X(026) VALUE
004080            "***  THTM REWRITE ¥◊∞  ***".
004090       03  E-ME30  COLUMN  15  PIC  X(030) VALUE
004100            "***  ÉfÅ[É^Ç™ì¸Ç¡ÇƒÇ¢Ç»Ç¢  ***".
004110       03  E-ME90  COLUMN  15  PIC  X(021) VALUE
004120            "---   ÉLÉÉÉìÉZÉã  ---".
004130       03  MG-03   COLUMN  15  PIC  X(024) VALUE
004140            "***  ∫›ƒ€∞ŸÇeñ¢ìoò^  ***".
004150       03  MG-05   COLUMN  15  PIC  X(022) VALUE
004160            "***  ëqå…è»ó™ïsâ¬  ***".
004170       03  E-KEY   COLUMN  45  PIC  X(007) FROM  HSMS-KEY.
004180     COPY LSSEM.
004190     COPY LIBSCR.
004200 PROCEDURE DIVISION.
004210 M-05.
004220     COPY LIBCPR.
004230     MOVE ZERO TO W-CNG.
004240     MOVE D-NHNG TO W-CNGS.
004250     IF W-CN2 >= DATE-NF1 AND <= DATE-NT1
004260         ADD DATE-NC1 TO W-CN.
004270     IF W-CN2 >= DATE-NF2 AND <= DATE-NT2
004280         ADD DATE-NC2 TO W-CN.
004290     MOVE W-CNG TO W-SNG.
004300     ADD 1 TO W-CG.
004310     IF W-CG = 13
004320         ADD 1 TO W-CN
004330         MOVE 1 TO W-CG.
004340     MOVE W-CNG TO W-ENG.
004350*
004360     DISPLAY C-CLEAR.
004370     OPEN INPUT T-M HI-M TC-M JCON TSKF.
004380     OPEN I-O HSMSF.
004390     OPEN I-O THTM.
004400 M-30.
004410     PERFORM UAC-RTN THRU UAC-EX.
004420     IF W-END NOT = 0
004430         GO TO M-95.
004440     PERFORM UPD-RTN THRU UPD-EX.
004450     IF W-END = 0
004460         GO TO M-30.
004470 M-95.
004480     CLOSE T-M HI-M TC-M JCON TSKF.
004490     CLOSE HSMSF.
004500     CLOSE THTM.
004510     DISPLAY C-CLEAR.
004520     STOP RUN.
004530*----------  èoâ◊Å@ì¸óÕ  -------------------------------------------------
004540 UAC-RTN.
004550     CALL "SCHD15".
004560 UAC-020.
004570     ACCEPT A-HMN.
004580     DISPLAY E-CL.
004590     IF ESTAT = C2 OR PF9
004600         MOVE 1 TO W-END
004610         GO TO UAC-EX.
004620     IF ESTAT NOT = HTB AND SKP
004630         GO TO UAC-020.
004640     IF W-HMN = ZERO
004650         GO TO UAC-020.
004660     MOVE SPACE TO HSMS-KEY.
004670     MOVE W-HMN TO HSMS-01.
004680     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
004690         DISPLAY E-ME21 E-ME98
004700         GO TO UAC-020.
004710     READ HSMSF NEXT RECORD AT END
004720         DISPLAY E-ME21 E-ME98
004730         GO TO UAC-020.
004740     IF W-HMN NOT = HSMS-01
004750         DISPLAY E-ME21 E-ME98
004760         GO TO UAC-020.
004770     IF HSMS-02 = 7
004780         DISPLAY E-ME21 E-ME98
004790         GO TO UAC-020.
004800     PERFORM HMN-RTN THRU HMN-EX.
004810     IF W-INV = 1
004820         GO TO UAC-020.
004830     IF W-EC NOT = 0
004840         MOVE 0 TO W-EC
004850         GO TO UAC-020.
004860     MOVE 1 TO W-DSPC.
004870     PERFORM DSP-RTN THRU DSP-EX.
004880     IF W-TCDD NOT = 5000 AND 9850
004890         DISPLAY E-ME20 E-ME98
004900         GO TO UAC-020.
004910 UAC-040.
004920     DISPLAY A-NGP.
004930     ACCEPT A-NGP.
004940     DISPLAY E-CL.
004950     IF ESTAT = BTB
004960         GO TO UAC-020.
004970     IF ESTAT NOT = HTB AND SKP
004980         GO TO UAC-040.
004990     IF W-NGPS = 999999
005000         GO TO UAC-990.
005010     IF W-NGPS = ZERO
005020         MOVE DATE-02R TO W-NGPS
005030         DISPLAY A-NGP.
005040*
005050     MOVE ZERO TO W-ND1.
005060     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
005070         ADD DATE-NC1 TO W-ND.
005080     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
005090         ADD DATE-NC2 TO W-ND.
005100     IF W-NGD NOT = W-SNG AND W-ENG
005110         DISPLAY E-ME12 E-ME98
005120         GO TO UAC-020.
005130     IF W-PD < 1 OR > 31
005140         GO TO UAC-020.
005150*
005160     MOVE ZERO TO W-HNC.
005170     MOVE 0 TO W-RC.
005180     MOVE 1 TO W-L1.
005190     MOVE 2 TO W-L2.
005200     MOVE 3 TO W-L3.
005210 UAC-070.
005220     ADD 1 TO W-RC.
005230     ADD 3 TO W-L1 W-L2 W-L3.
005240     IF W-RC > 6
005250         GO TO UAC-800.
005260     MOVE WR-D(W-RC) TO WR-D1.
005270     IF WR-GNO = 0
005280         GO TO UAC-360.
005290     IF W-RCB = ZERO
005300         GO TO UAC-070.
005310     IF W-RC NOT = W-RCB
005320         GO TO UAC-070.
005330     MOVE W-RCB TO W-RC.
005340     MOVE W-LB TO W-L.
005350     GO TO UAC-360.
005360 UAC-080.
005370     MOVE W-SCD TO WK-SCD.
005380     ACCEPT A-SOK.
005390     DISPLAY E-CL.
005400     IF ESTAT = BTB
005410         GO TO UAC-040.
005420     IF ESTAT = ADV
005430         MOVE WK-SCD TO W-SCD
005440         MOVE 1 TO W-ADV
005450         GO TO UAC-090.
005460     IF ESTAT NOT = HTB AND SKP
005470         GO TO UAC-080.
005480 UAC-090.
005490     IF W-SCD = ZERO
005500         MOVE W-SCD TO WR-SOK
005510         DISPLAY SU-SOK
005520         GO TO UAC-100.
005530     MOVE 3 TO JCON3-01.
005540     MOVE W-SCD TO JCON3-02.
005550     READ JCON UNLOCK INVALID
005560         MOVE  SPACE TO JCON3-03
005570         DISPLAY D-SNA MG-03 E-ME98
005580         GO TO UAC-080.
005590     MOVE W-SCD TO WR-SOK.
005600     DISPLAY A-SOK D-SNA.
005610 UAC-100.
005620     IF ESTAT = ADV
005630         GO TO UAC-320.
005640 UAC-260.
005650     ACCEPT A-CCD.
005660     DISPLAY E-CL.
005670     IF ESTAT = BTB
005680         GO TO UAC-080.
005690     IF ESTAT NOT = HTB AND SKP
005700         GO TO UAC-260.
005710     PERFORM TCM-RTN THRU TCM-EX.
005720     IF W-INV = 1
005730         DISPLAY E-ME2 E-ME98
005740         GO TO UAC-260.
005750     IF W-INV = 9
005760         DISPLAY E-ME3 E-ME99
005770         MOVE 1 TO W-END
005780         GO TO UAC-EX.
005790 UAC-320.
005800     MOVE 1 TO W-L1.
005810     MOVE 2 TO W-L2.
005820     MOVE 3 TO W-L3.
005830     MOVE ZERO TO W-RC W-DCD W-ZC W-HSCD.
005840 UAC-340.
005850     MOVE 0 TO W-DEL.
005860     ADD 1 TO W-RC.
005870     ADD 3 TO W-L1 W-L2 W-L3.
005880     IF W-RC > 6
005890         GO TO UAC-760.
005900     IF W-ZC = 5
005910         GO TO UAC-420.
005920 UAC-360.
005930     MOVE WR-D(W-RC) TO WR-D1.
005940     MOVE W-SCD TO WR-SOK.
005950     MOVE W-NGP TO WR-DATE.
005960     MOVE W-TCDD TO WR-TCD.
005970     MOVE W-CCDD TO WR-CCD.
005980 UAC-380.
005990     IF W-DEL = 9
006000         MOVE 0 TO W-DEL
006010         GO TO UAC-400.
006020 UAC-400.
006030     MOVE W-DC(W-RC) TO WK-DC.
006040     MOVE 0 TO W-ADV.
006050     ACCEPT A-DC.
006060     DISPLAY E-CL.
006070     IF ESTAT = PF21
006080         MOVE W-RC TO W-RCD
006090         MOVE W-L TO W-LD
006100         GO TO UAC-430.
006110     IF ESTAT = C1 OR PF6
006120         MOVE 5 TO W-ZC
006130         GO TO UAC-420.
006140     IF ESTAT = FUK
006150         GO TO UAC-760.
006160     IF ESTAT = ADV
006170         IF WR-HCD NOT = ZERO
006180             MOVE WK-DC TO W-DC(W-RC)
006190             DISPLAY A-DC
006200             MOVE 1 TO W-ADV
006210             GO TO UAC-440.
006220     IF ESTAT NOT = BTB
006230         GO TO UAC-440.
006240 UAC-410.
006250     SUBTRACT 1 FROM W-RC.
006260     SUBTRACT 3 FROM W-L1 W-L2 W-L3.
006270     IF W-RC = ZERO
006280         GO TO UAC-260.
006290     MOVE WR-D(W-RC) TO WR-D1.
006300     IF WR-GNO = ZERO
006310         GO TO UAC-410.
006320     GO TO UAC-400.
006330 UAC-420.
006340     IF W-RC = 1
006350         MOVE ZERO TO WR-HCD WR-SIZ WR-SUT WR-TAN W-KIND WR-DC
006360                    WR-SU(01) WR-SU(02) WR-SU(03) WR-SU(04)
006370                    WR-SU(05) WR-SU(06) WR-SU(07) WR-SU(08)
006380                    WR-SU(09) WR-SU(10)           WR-SOK
006390         MOVE SPACE TO WR-GBI
006400         MOVE W-RC TO WR-GNO
006410         MOVE WR-D1 TO WR-D(W-RC)
006420         DISPLAY SU-D1 SU-D2 SU-D3
006430         GO TO UAC-340.
006440     MOVE ZERO TO WR-D1.
006450     MOVE ZERO TO WR-SU(01) WR-SU(02) WR-SU(03) WR-SU(04)
006460                  WR-SU(05) WR-SU(06) WR-SU(07) WR-SU(08)
006470                  WR-SU(09) WR-SU(10).
006480     MOVE SPACE TO WR-GBI.
006490     MOVE WR-D1 TO WR-D(W-RC).
006500     DISPLAY SU-D1 SU-D2 SU-D3.
006510     GO TO UAC-340.
006520 UAC-430.
006530     IF W-RC NOT = 6
006540         COMPUTE CNT = W-RC + 1
006550         MOVE WR-D(CNT) TO WR-D(W-RC)
006560         ADD 1 TO W-RC
006570         GO TO UAC-430.
006580     MOVE ZERO TO WR-D(W-RC).
006590     MOVE 0 TO W-DSPC.
006600     PERFORM DSP-RTN THRU DSP-EX.
006610     MOVE W-RCD TO W-RC.
006620     MOVE W-LD TO W-L.
006630     MOVE 9 TO W-DEL.
006640     GO TO UAC-360.
006650 UAC-440.
006660     IF ESTAT NOT = HTB AND SKP AND ADV
006670         GO TO UAC-380.
006680     IF W-DC(W-RC) NOT = 0 AND 1 AND 2 AND 4 AND 7
006690         GO TO UAC-380.
006700     IF W-DC(W-RC) NOT = 2
006710        IF WR-SOK = 0
006720             DISPLAY MG-05 E-ME98
006730             GO  TO  UAC-380.
006740     IF W-RC NOT = 1
006750         GO TO UAC-450.
006760     IF W-DC(W-RC) = 1 OR 2
006770         MOVE ZERO TO W-HNC.
006780     MOVE W-DC(W-RC) TO W-DCD.
006790     IF W-DC(W-RC) = 4  OR  7
006800         MOVE ZERO TO W-DCD.
006810 UAC-450.
006820     MOVE W-DC(W-RC) TO W-DCC.
006830     IF W-DC(W-RC) = 4  OR  7
006840         MOVE ZERO TO W-DCC.
006850     IF W-DCD NOT = W-DCC
006860         DISPLAY E-ME4 E-ME98
006870         GO TO UAC-380.
006880     MOVE WR-HCD TO W-HCDO.
006890 UAC-480.
006900     IF W-ADV NOT = 0
006910         GO TO UAC-490.
006920     ACCEPT A-HCD.
006930     DISPLAY E-CL.
006940     IF ESTAT = BTB
006950         GO TO UAC-400.
006960     IF ESTAT = C1 OR PF6
006970         MOVE 5 TO W-ZC
006980         GO TO UAC-420.
006990     IF ESTAT = FUK
007000         GO TO UAC-760.
007010     IF ESTAT NOT = HTB AND SKP
007020         GO TO UAC-480.
007030     IF WR-HCD = ZERO
007040         MOVE W-HCDD TO WR-HCD.
007050     IF WR-HCD NOT = W-HCDO
007060         MOVE ZERO TO WR-TAN.
007070 UAC-490.
007080     MOVE 0 TO W-HIC.
007090     PERFORM HI-RTN THRU HI-EX.
007100     IF W-EC NOT = ZERO
007110         MOVE 0 TO W-EC W-ADV
007120         GO TO UAC-480.
007130     IF W-DC(W-RC) = 3 OR 4 OR 9
007140        IF HI-S4(10) NOT = 1
007150            DISPLAY E-ME8 E-ME98
007160            MOVE 0 TO W-ADV
007170            GO  TO    UAC-480.
007180     IF WR-HCD > 999899
007190         GO TO UAC-480.
007200 UAC-550.
007210     IF W-ADV NOT = 0
007220         GO TO UAC-570.
007230 UAC-560.
007240     ACCEPT A-SIZ.
007250     DISPLAY E-CL.
007260     IF ESTAT = BTB
007270         MOVE 0 TO W-ADV
007280         GO TO UAC-440.
007290 UAC-570.
007300     IF WR-SIZ < 1 OR > 4
007310         MOVE 0 TO W-ADV
007320         GO TO UAC-560.
007330     IF WR-SIZ = 1
007340         DISPLAY D-S1
007350         MOVE HI-SS1 TO W-ASD.
007360     IF WR-SIZ = 2
007370         DISPLAY D-S2
007380         MOVE HI-SS2 TO W-ASD.
007390     IF WR-SIZ = 3
007400         DISPLAY D-S3
007410         MOVE HI-SS3 TO W-ASD.
007420     IF WR-SIZ = 4
007430         DISPLAY D-S4
007440         MOVE HI-SS4 TO W-ASD.
007450     IF W-ASD = ZERO OR SPACE
007460         MOVE 0 TO W-ADV
007470         DISPLAY E-ME9 E-ME98
007480         GO TO UAC-560.
007490     IF WR-SIZ = 4
007500         IF W-ASD = "0000000001"
007510             MOVE 0 TO W-ADV
007520             DISPLAY E-ME9 E-ME98
007530             GO TO UAC-560.
007540     IF WR-TAN = ZERO
007550         PERFORM TAN-RTN THRU TAN-EX.
007560     MOVE ZERO TO W-SC W-ZC.
007570     MOVE -3 TO W-C.
007580 UAC-580.
007590     ADD 1 TO W-SC.
007600     IF W-SC > 8
007610         ADD 5 TO W-C
007620       ELSE
007630         ADD 6 TO W-C.
007640     IF W-SC = 11
007650         MOVE ZERO TO W-SC WR-SUT
007660         GO TO UAC-630.
007670     IF (W-SD(W-SC) = ZERO) OR (W-ZC = 5)
007680         MOVE ZERO TO WR-SU(W-SC)
007690         GO TO UAC-610.
007700     IF W-SC = 10
007710         IF WR-SIZ = 4
007720             MOVE ZERO TO WR-SU(W-SC)
007730             GO TO UAC-580.
007740 UAC-600.
007750     IF W-ADV NOT = 0
007760         GO TO UAC-610.
007770     IF W-SC > 7
007780         ACCEPT A-SU1
007790       ELSE
007800         ACCEPT A-SU.
007810     IF ESTAT = BTB
007820         MOVE 0 TO W-ADV
007830         GO TO UAC-620.
007840     IF ESTAT = C1 OR PF6
007850         MOVE 5 TO W-ZC
007860         MOVE ZERO TO WR-SU(W-SC)
007870         MOVE 0 TO W-ADV
007880         GO TO UAC-610.
007890     IF ESTAT = FUK
007900         MOVE ZERO TO W-SC WR-SUT
007910         GO TO UAC-630.
007920     IF ESTAT NOT = HTB AND SKP
007930         MOVE 0 TO W-ADV
007940         GO TO UAC-600.
007950     IF W-SC > 7
007960         IF WR-SU(W-SC) > 999 OR < -999
007970             GO TO UAC-600.
007980 UAC-610.
007990     IF W-SC < 8
008000         DISPLAY D-SU
008010       ELSE
008020         DISPLAY D-SU1.
008030     GO TO UAC-580.
008040 UAC-620.
008050     IF W-ADV NOT = ZERO
008060         MOVE 0 TO W-ADV.
008070     SUBTRACT 1 FROM W-SC.
008080     IF W-SC > 7
008090         SUBTRACT 5 FROM W-C
008100       ELSE
008110         SUBTRACT 6 FROM W-C.
008120     IF W-SC = ZERO
008130         GO TO UAC-560.
008140     IF W-SD(W-SC) = ZERO
008150         GO TO UAC-620.
008160     IF W-SC = 10
008170         IF WR-SIZ = 4
008180             GO TO UAC-620.
008190     GO TO UAC-600.
008200 UAC-630.
008210     ADD 1 TO W-SC.
008220     IF W-SC < 11
008230         ADD WR-SU(W-SC) TO WR-SUT
008240         GO TO UAC-630.
008250     MOVE ZERO TO W-ZC.
008260     IF WR-SUT = ZERO
008270         MOVE ZERO TO W-SC
008280         MOVE -3 TO W-C
008290         MOVE 0 TO W-ADV
008300         GO TO UAC-580.
008310 UAC-660.
008320     DISPLAY D-SUT D-TAN.
008330     IF W-DC(W-RC) = 7
008340        MOVE ZERO TO WR-TAN W-KIND
008350        DISPLAY SU-TAN SU-KIN
008360        GO TO UAC-720.
008370     IF W-DC(W-RC) = 4
008380         COMPUTE W-KIND = WR-SUT * WR-TAN
008390         DISPLAY SU-KIN SU-TAN
008400         GO TO UAC-720.
008410     ACCEPT A-TAN.
008420     DISPLAY E-CL.
008430     IF ESTAT NOT = BTB
008440         GO TO UAC-670.
008450     MOVE 0 TO W-ADV.
008460     MOVE 11 TO W-SC.
008470     MOVE 60 TO W-C.
008480     GO TO UAC-620.
008490 UAC-670.
008500     IF ESTAT NOT = HTB AND SKP
008510         GO TO UAC-660.
008520     DISPLAY D-TAN.
008530     IF WR-HCD < 999900
008540         IF WR-TAN = ZERO
008550             IF W-DC(W-RC) = 2
008560                 DISPLAY E-ME15 E-ME99
008570                 DISPLAY E-CL
008580               ELSE
008590                 GO TO UAC-660.
008600     IF WR-HCD > 999899
008610         IF WR-TAN = ZERO
008620             DISPLAY E-ME15 E-ME99
008630             DISPLAY E-CL.
008640     COMPUTE W-KIND = WR-SUT * WR-TAN.
008650     DISPLAY D-KIN.
008660 UAC-720.
008670     IF T-BIK = 0
008680         MOVE SPACE TO WR-GBI
008690         DISPLAY SU-GBI
008700         GO TO UAC-740.
008710     ACCEPT A-GBI.
008720     DISPLAY E-CL.
008730     IF ESTAT = BTB
008740         IF W-DC(W-RC) = 4 OR 7
008750             GO TO UAC-620
008760           ELSE
008770             GO TO UAC-660.
008780 UAC-740.
008790     MOVE W-RC TO WR-GNO.
008800     MOVE WR-D1 TO WR-D(W-RC).
008810     GO TO UAC-340.
008820 UAC-760.
008830     MOVE ZERO TO W-GSUT W-RC W-ZC.
008840 UAC-770.
008850     ADD 1 TO W-RC.
008860     IF W-RC = 7
008870         DISPLAY D-GSUT
008880         IF W-ZC = 0
008890             DISPLAY E-ME30 E-ME99
008900             GO TO UAC-780
008910           ELSE
008920             GO TO UAC-780.
008930     MOVE ZERO TO WR-D1.
008940     MOVE WR-D(W-RC) TO WR-D1.
008950     IF WR-HCD < 999900
008960        ADD WR-SUT TO W-GSUT.
008970     IF WR-DATE NOT = ZERO
008980         MOVE W-RC TO W-HNCD.
008990     IF ZERO = WR-SU(01) AND WR-SU(02) AND WR-SU(03) AND
009000               WR-SU(04) AND WR-SU(05) AND WR-SU(06) AND
009010               WR-SU(07) AND WR-SU(08) AND WR-SU(09) AND
009020               WR-SU(10) AND WR-SUT AND W-KIND
009030         GO TO UAC-770.
009040     MOVE 1 TO W-ZC.
009050     GO TO UAC-770.
009060 UAC-780.
009070     IF W-BI = SPACE
009080         DISPLAY A-BI.
009090     IF W-HNCD < W-HNC
009100         DISPLAY E-ME14 E-ME98.
009110 UAC-800.
009120     MOVE 0 TO W-ADV.
009130     DISPLAY A-BI.
009140     MOVE W-BI TO WK-BI.
009150     ACCEPT A-BI.
009160     DISPLAY E-CL.
009170     IF ESTAT = BTB
009180         MOVE 7 TO W-RC
009190         MOVE 22 TO W-L1
009200         MOVE 23 TO W-L2
009210         MOVE 24 TO W-L3
009220         GO TO UAC-410.
009230     IF ESTAT = ADV
009240         MOVE WK-BI TO W-BI
009250         DISPLAY A-BI
009260         MOVE 1 TO W-ADV
009270         GO TO UAC-840.
009280     IF ESTAT NOT = HTB AND SKP
009290         GO TO UAC-780.
009300 UAC-840.
009310     IF W-ADV NOT = 0
009320         GO TO UAC-850.
009330     ACCEPT A-KOSU.
009340     DISPLAY E-CL.
009350     IF ESTAT = BTB
009360         GO TO UAC-800.
009370     IF ESTAT NOT = HTB AND SKP
009380         GO TO UAC-840.
009390 UAC-850.
009400     DISPLAY D-KOSU.
009410 UAC-940.
009420     DISPLAY A-SDT.
009430     IF W-SDTD NOT = ZERO
009440         GO TO UAC-980.
009450     IF T-SS = ZERO OR 99
009460         GO TO UAC-990.
009470 UAC-960.
009480     ACCEPT A-SDT.
009490     IF ESTAT = BTB
009500         MOVE 0 TO W-ADV
009510         GO TO UAC-840.
009520     IF ESTAT NOT = HTB AND SKP
009530         GO TO UAC-960.
009540     IF T-SS = ZERO OR 99
009550         IF W-SDTD NOT = ZERO
009560             GO TO UAC-960.
009570     IF W-DCD NOT = 3
009580         IF W-SDTD = 99999999
009590             GO TO UAC-960.
009600     IF W-SDTD = ZERO OR 99999999
009610         GO TO UAC-990.
009620     IF W-SDTG < 1 OR > 12
009630         GO TO UAC-960.
009640     IF W-SDTP < 1 OR > 31
009650         GO TO UAC-960.
009660     IF W-SDTN NOT = W-ND AND (W-ND + 1)
009670         GO TO UAC-960.
009680 UAC-980.
009690     IF W-SDATE NOT = ZERO
009700         IF W-SDATE >= W-SDTD
009710             DISPLAY E-ME25 E-ME99
009720             DISPLAY E-CL
009730             GO TO UAC-960.
009740     IF W-NGP > W-SDTD
009750         GO TO UAC-960.
009760 UAC-990.
009770     ACCEPT A-DMM.
009780     IF ESTAT = BTB
009790         IF W-NGPS = 999999
009800             GO TO UAC-040
009810           ELSE
009820             GO TO UAC-960.
009830     IF ESTAT NOT = HTB AND SKP
009840         GO TO UAC-990.
009850     IF W-DMM = 9
009860         DISPLAY E-ME90 E-ME98
009870         GO TO UAC-040.
009880     IF W-DMM NOT = 1
009890         GO TO UAC-990.
009900 UAC-EX.
009910     EXIT.
009920 TAN-RTN.
009930     MOVE 0 TO WK-TAN.
009940     MOVE WR-TCD TO THT-TCD.
009950     MOVE WR-HCD TO THT-HCD.
009960     MOVE WR-SIZ TO THT-SIZ.
009970     READ THTM UNLOCK INVALID
009980         MOVE ZERO TO THT-T.
009990     MOVE THT-T TO WK-TAN.
010000     IF WK-TAN NOT = ZERO
010010         GO TO TAN-090.
010020     MOVE WR-TCD TO THT-TCD.
010030     MOVE WR-HCD TO THT-HCD.
010040     MOVE 9 TO THT-SIZ.
010050     READ THTM UNLOCK INVALID
010060         MOVE ZERO TO THT-T.
010070     MOVE THT-T TO WK-TAN.
010080     IF WK-TAN NOT = ZERO
010090         GO TO TAN-090.
010100     IF HI-MHCD = HI-HCD
010110         GO TO TAN-090.
010120     MOVE WR-TCD TO THT-TCD.
010130     MOVE HI-MHCD TO THT-HCD.
010140     MOVE WR-SIZ TO THT-SIZ.
010150     READ THTM UNLOCK INVALID
010160         MOVE ZERO TO THT-T.
010170     MOVE THT-T TO WK-TAN.
010180     IF WK-TAN NOT = ZERO
010190         GO TO TAN-090.
010200     MOVE WR-TCD TO THT-TCD.
010210     MOVE HI-MHCD TO THT-HCD.
010220     MOVE 9 TO THT-SIZ.
010230     READ THTM UNLOCK INVALID
010240         MOVE ZERO TO THT-T.
010250     MOVE THT-T TO WK-TAN.
010260 TAN-090.
010270     IF WK-TAN NOT = ZERO
010280         MOVE WK-TAN TO WR-TAN
010290         GO TO TAN-EX.
010300 TAN-EX.
010310     EXIT.
010320*------------------------------------------------------------------------
010330 HMN-RTN.
010340     MOVE HSMS-05 TO W-NGP.
010350     DISPLAY A-NGP.
010360     INITIALIZE WR-AD WR-D2.
010370     MOVE SPACE TO W-BI.
010380     MOVE ZERO TO W-DCD W-AKIN W-ADC WB-AD.
010390     MOVE HSMS-061 TO W-TCDD.
010400     PERFORM TM-RTN THRU TM-EX.
010410     IF W-INV = 1
010420         DISPLAY E-ME2 E-ME99
010430         GO TO HMN-EX.
010440     MOVE 0 TO W-RC.
010450 HMN-020.
010460     IF HSMS-02 = 7
010470         MOVE HSMS-R2 TO WR-D2
010480         GO TO HMN-035.
010490     INITIALIZE WR-D1.
010500     MOVE HSMS-R1 TO WR-D1.
010510     MOVE 1 TO W-HIC.
010520     PERFORM HI-RTN THRU HI-EX.
010530     IF HSMS-25 NOT = 1
010540         PERFORM TAN-RTN THRU TAN-EX.
010550     ADD 1 TO W-RC.
010560     IF W-RC > 6
010570         MOVE 1 TO W-EC
010580         DISPLAY E-ME10 E-ME99
010590         GO TO HMN-EX.
010600     MOVE WR-D1 TO WR-D(W-RC).
010610     MOVE WR-HCD TO WB-HCD(W-RC).
010620     MOVE WR-SIZ TO WB-SIZ(W-RC).
010630     MOVE WR-TAN TO WB-TAN(W-RC).
010640     IF WR-ACD = 4 OR 5
010650         MOVE ZERO TO W-KIN(W-RC)
010660         MOVE 4 TO W-DC(W-RC)
010670       ELSE
010680         COMPUTE W-KIND = WR-SUT * WR-TAN
010690         MOVE W-KIND TO W-KIN(W-RC)
010700         MOVE WR-DC TO W-DC(W-RC).
010710 HMN-035.
010720     READ HSMSF NEXT RECORD AT END
010730         GO TO HMN-040.
010740     IF W-HMN = HSMS-01
010750         GO TO HMN-020.
010760 HMN-040.
010770     MOVE WR-SOK TO W-SCD.
010780     MOVE WR-CCD TO W-CCDD.
010790     MOVE WR-KSU TO W-KOSUR.
010800 HMN-060.
010810     MOVE 3 TO JCON3-01.
010820     MOVE W-SCD TO JCON3-02.
010830     READ JCON UNLOCK INVALID
010840         MOVE  SPACE TO JCON3-03.
010850     MOVE W-SCD TO WR-SOK.
010860     DISPLAY A-SOK D-SNA.
010870*
010880     IF WR-DC = 1 OR 2
010890         MOVE WR-DC TO W-DCD
010900         MOVE ZERO TO W-HNC
010910       ELSE
010920         MOVE 1 TO W-HNC.
010930     PERFORM TCM-RTN THRU TCM-EX.
010940     IF W-INV = 1
010950         DISPLAY E-ME1 E-ME99
010960         GO TO HMN-EX.
010970     DISPLAY A-BI D-KOSU.
010980 HMN-EX.
010990     EXIT.
011000*------------------------------------------------------------------------
011010 DSP-RTN.
011020     MOVE 1 TO W-L1.
011030     MOVE 2 TO W-L2.
011040     MOVE 3 TO W-L3.
011050     MOVE ZERO TO W-RC W-ZC W-GSUT W-RCB W-LB.
011060 DSP-020.
011070     ADD 1 TO W-RC.
011080     ADD 3 TO W-L1 W-L2 W-L3.
011090     IF W-RC > 6
011100         GO TO DSP-080.
011110*
011120     INITIALIZE WR-D1.
011130     MOVE WR-D(W-RC) TO WR-D1.
011140     IF WR-HCD = ZERO
011150         DISPLAY SU-D1 SU-D2 SU-D3
011160         GO TO DSP-020.
011170     MOVE W-KIN(W-RC) TO W-KIND.
011180     MOVE WR-HCD TO HI-KEY.
011190     READ HI-M WITH UNLOCK INVALID KEY
011200         MOVE SPACE TO HI-NAME.
011210     DISPLAY A-DC A-HCD D-HNA.
011220     IF WR-HCD >= 999900
011230         DISPLAY SU-D2 SU-D31
011240         GO TO DSP-060.
011250     DISPLAY A-SIZ.
011260     IF WR-SIZ = 1
011270         DISPLAY D-S1.
011280     IF WR-SIZ = 2
011290         DISPLAY D-S2.
011300     IF WR-SIZ = 3
011310         DISPLAY D-S3.
011320     IF WR-SIZ = 4
011330         DISPLAY D-S4.
011340     MOVE ZERO TO W-SC.
011350     MOVE -3 TO W-C.
011360 DSP-040.
011370     ADD 1 TO W-SC.
011380     IF W-SC > 8
011390         ADD 5 TO W-C
011400       ELSE
011410         ADD 6 TO W-C.
011420     IF W-SC = 11
011430         GO TO DSP-060.
011440     IF W-SC < 8
011450         DISPLAY D-SU
011460       ELSE
011470         DISPLAY D-SU1.
011480     GO TO DSP-040.
011490 DSP-060.
011500     DISPLAY D-SUT D-TAN D-KIN A-GBI.
011510     IF WR-DC = 4
011520         DISPLAY SU-KIN SU-TAN.
011530     ADD WR-SUT TO W-GSUT.
011540     IF WR-DC NOT = 7
011550         IF WR-TAN = ZERO
011560             DISPLAY E-ME15 E-ME99
011570             DISPLAY E-CL
011580             IF W-DSPC = 1
011590                 IF W-RCB = ZERO
011600                     MOVE W-RC TO W-RCB
011610                     MOVE W-L TO W-LB.
011620     GO TO DSP-020.
011630 DSP-080.
011640     DISPLAY D-GSUT.
011650 DSP-EX.
011660     EXIT.
011670*------------------------------------------------------------------------
011680 TM-RTN.
011690     MOVE 0 TO W-INV.
011700     MOVE W-TCDD TO T-KEY.
011710     READ T-M WITH UNLOCK INVALID KEY
011720         MOVE SPACE TO T-NAME
011730         MOVE 1 TO W-INV.
011740     DISPLAY D-TCD D-TNA.
011750*
011760     MOVE W-TCDD TO TSK-KEY.
011770     READ TSKF WITH UNLOCK INVALID KEY
011780         MOVE ZERO TO TSK-R.
011790     MOVE TSK-ZNGP(4) TO W-SDATE.
011800     IF TSK-ZNGP(5) NOT = ZERO
011810         MOVE TSK-ZNGP(5) TO W-SDATE.
011820*
011830     MOVE ZERO TO W-SDTD.
011840     MOVE W-NGP TO W-SDTD.
011850 TM-020.
011860     MOVE T-SS TO W-SDTP.
011870     IF W-SDTP = 00 OR 99
011880         MOVE ZERO TO W-SDTD
011890         GO TO TM-EX.
011900     IF W-SDTP = 30 OR 31
011910         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
011920             MOVE 31 TO W-SDTP
011930           ELSE
011940             IF W-SDTG = 4 OR 6 OR 9 OR 11
011950                 MOVE 30 TO W-SDTP
011960               ELSE
011970                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1
011980                                           REMAINDER W-DTW2
011990                 IF W-DTW2 = 0
012000                     MOVE 29 TO W-SDTP
012010                   ELSE
012020                     MOVE 28 TO W-SDTP.
012030     IF W-NGP > W-SDTD
012040         IF W-GD NOT = W-SDTG
012050             MOVE ZERO TO W-SDTD
012060             GO TO TM-EX
012070           ELSE
012080             ADD 1 TO W-SDTG
012090             GO TO TM-040.
012100     IF W-SDATE NOT = ZERO
012110         IF W-SDATE >= W-SDTD
012120             ADD 1 TO W-SDTG
012130             GO TO TM-040.
012140     GO TO TM-EX.
012150 TM-040.
012160     IF W-SDTG = 13
012170         MOVE 1 TO W-SDTG
012180         ADD 1 TO W-SDTN.
012190     GO TO TM-020.
012200 TM-EX.
012210     EXIT.
012220 TCM-RTN.
012230     IF W-CCDD = ZERO
012240         DISPLAY SU-CNA
012250         GO TO TCM-EX.
012260     MOVE 0 TO W-INV.
012270     MOVE W-TCDD TO TC-TCD.
012280     MOVE W-CCDD TO TC-CCD.
012290     READ TC-M WITH UNLOCK INVALID KEY
012300         MOVE SPACE TO TC-NAME
012310         MOVE 1 TO W-INV.
012320     DISPLAY A-CCD D-CNA.
012330     MOVE 9999999 TO TC-KEY.
012340     READ TC-M WITH UNLOCK INVALID KEY
012350         MOVE 9 TO W-INV.
012360 TCM-EX.
012370     EXIT.
012380*------------------------------------------------------------------------
012390 HI-RTN.
012400     MOVE WR-HCD TO W-HCDD.
012410     IF W-HIC = 0
012420         DISPLAY A-HCD.
012430     IF WR-HCD = ZERO
012440         MOVE 9 TO W-EC
012450         GO TO HI-EX.
012460     MOVE WR-HCD TO HI-KEY.
012470     READ HI-M WITH UNLOCK INVALID KEY
012480         MOVE 9 TO W-EC
012490         GO TO HI-EX.
012500     IF W-HIC = 0
012510         DISPLAY D-HNA.
012520     IF WR-HCD < 999900
012530        IF HI-FT = ZERO
012540           DISPLAY E-ME7 E-ME98.
012550     IF WR-DC NOT = 0 AND 3 AND 4 AND 5 AND 7
012560         IF WR-HCD < 999900
012570            IF HI-FT = 1
012580                DISPLAY E-ME7 E-ME98.
012590 HI-EX.
012600     EXIT.
012610*------------------------------------------------------------------------
012620 UPD-RTN.
012630     MOVE SPACE TO HSMS-KEY.
012640     MOVE W-HMN TO HSMS-01.
012650     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
012660         DISPLAY E-ME10 E-KEY E-ME99
012670         GO TO UPD-900.
012680     READ HSMSF NEXT RECORD AT END
012690         DISPLAY E-ME10 E-KEY E-ME99
012700         GO TO UPD-900.
012710     IF W-HMN NOT = HSMS-01
012720         DISPLAY E-ME10 E-KEY E-ME99
012730         GO TO UPD-900.
012740 UPD-020.
012750     DELETE HSMSF INVALID KEY
012760         DISPLAY E-STAT E-ME22 E-KEY E-ME99
012770         GO TO UPD-900.
012780*
012790     READ HSMSF NEXT RECORD AT END
012800         GO TO UPD-040.
012810     IF W-HMN = HSMS-01
012820         GO TO UPD-020.
012830 UPD-040.
012840     IF W-NGPS = 999999
012850         GO TO UPD-EX.
012860     MOVE ZERO TO W-RC.
012870 UPD-060.
012880     ADD 1 TO W-RC.
012890     IF W-RC > 6
012900         GO TO UPD-180.
012910     MOVE WR-D(W-RC) TO WR-D1.
012920     IF WR-DATE = ZERO
012930         GO TO UPD-180.
012940     MOVE W-SDTD TO WR-SKD.
012950     MOVE W-KOSUR TO WR-KSU.
012960     IF W-DC(W-RC) NOT = 4
012970         MOVE W-DC(W-RC) TO WR-DC
012980         MOVE 0 TO WR-ACD
012990       ELSE
013000         IF WR-ACD NOT = 4 AND 5
013010             MOVE 0 TO WR-DC
013020             MOVE 4 TO WR-ACD.
013030     IF WR-NRC NOT = 1
013040         IF (WR-HCD = WB-HCD(W-RC)) AND (WR-SIZ = WB-SIZ(W-RC))
013050             IF WR-TAN NOT = WB-TAN(W-RC)
013060                 MOVE 1 TO WR-NRC.
013070     MOVE WR-D1 TO HSMS-R1.
013080     WRITE HSMS-R1 INVALID KEY
013090         DISPLAY E-STAT E-ME23 E-KEY E-ME99
013100         GO TO UPD-900.
013110 UPD-080.
013120     IF WR-HCD = ZERO
013130         GO TO UPD-180.
013140     IF W-DC(W-RC) NOT = 0
013150         GO TO UPD-060.
013160     IF WR-TAN = ZERO
013170         GO TO UPD-060.
013180     MOVE SPACE TO THT-KEY.
013190     MOVE WR-TCD TO THT-TCD.
013200     MOVE WR-HCD TO THT-HCD.
013210     MOVE 9 TO THT-SIZ.
013220     READ THTM INVALID KEY
013230         GO TO UPD-120.
013240     GO TO UPD-160.
013250 UPD-120.
013260     MOVE SPACE TO THT-KEY.
013270     MOVE WR-TCD TO THT-TCD.
013280     MOVE WR-HCD TO THT-HCD.
013290     MOVE WR-SIZ TO THT-SIZ.
013300     READ THTM INVALID KEY
013310         GO TO UPD-140.
013320     GO TO UPD-160.
013330 UPD-140.
013340     MOVE ZERO TO THT-R.
013350     MOVE WR-TCD TO THT-TCD THT-TCD2.
013360     MOVE WR-HCD TO THT-HCD.
013370     MOVE 9 TO THT-SIZ.
013380     MOVE WR-TAN TO THT-T.
013390     MOVE T-TNC TO THT-TNC.
013400     MOVE W-NGD TO THT-NG.
013410     WRITE THT-R INVALID KEY
013420         DISPLAY E-STAT E-ME26 E-ME99
013430         DISPLAY E-CL
013440         GO TO UPD-020.
013450     CALL "CBLTCLS" USING THTM.
013460     GO TO UPD-060.
013470 UPD-160.
013480     IF W-NGD NOT = THT-NG
013490         MOVE W-NGD TO THT-NG
013500         REWRITE THT-R INVALID KEY
013510             DISPLAY E-STAT E-ME27 E-ME99
013520             DISPLAY E-CL.
013530     GO TO UPD-060.
013540 UPD-180.
013550     MOVE W-NGP TO W-DATEB.
013560     MOVE W-TCDD TO W-TCDB.
013570     MOVE W-CCDD TO W-CCDB.
013580     MOVE W-SCD TO W-SOKB.
013590     MOVE WR-D2 TO HSMS-R2.
013600     WRITE HSMS-R2 INVALID KEY
013610         DISPLAY E-STAT E-ME23 E-KEY E-ME99
013620         GO TO UPD-900.
013630     GO TO UPD-EX.
013640 UPD-900.
013650     MOVE 1 TO W-END.
013660 UPD-EX.
013670     EXIT.
