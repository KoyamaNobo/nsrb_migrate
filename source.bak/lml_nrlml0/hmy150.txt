000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMY150.
000030**************************************************************
000040*    PROGRAM         :  得意先月別販売対比ファイル　メンテ　 *
000050*    PRINTER TYPE    :  JIPS                                 *
000060*    SCREEN          :  SCHY15                               *
000070*        変更　　　  :  95/09/21                             *
000080*    COMPILE TYPE    :  COBOL                                *
000090**************************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170*****SELECT T-M ASSIGN TO T-MSD                                   D.000224
000180     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000224
000190         ORGANIZATION IS INDEXED
000200         ACCESS MODE IS RANDOM
000210         RECORD KEY IS T-KEY
000220         ALTERNATE RECORD KEY IS T-KEY2                           I.000224
000230         FILE STATUS IS ERR-STAT.
000240     SELECT TZNT-M ASSIGN TO TZNT-MSD
000250         ORGANIZATION IS INDEXED
000260         ACCESS MODE IS DYNAMIC
000270         RECORD KEY IS TZNT-KEY
000280         FILE STATUS IS ERR-STAT.
000290 I-O-CONTROL.
000300     APPLY SHARED-MODE ON M-DATE
000310     APPLY SHARED-MODE ON TZNT-M
000320     APPLY SHARED-MODE ON T-M.
000330 DATA DIVISION.
000340 FILE SECTION.
000350     COPY LIBFDD.
000360     COPY LITM.
000370 FD  TZNT-M
000380     BLOCK  1 RECORDS
000390     LABEL RECORD IS STANDARD
000400     VALUE OF IDENTIFICATION IS "TZNTM".
000410 01  TZNT-R.
000420     02  TZNT-KEY.
000430       03  TZNT-TCD     PIC  9(004).
000440       03  TZNT-IKC     PIC  9(001).
000450     02  TZNT-UD.
000460       03  TZNT-UK.
000470         04  TZNT-OUK1.
000480           05  TZNT-OU1   OCCURS   6  PIC S9(009).
000490         04  TZNT-OUK2.
000500           05  TZNT-OU2   OCCURS   6  PIC S9(009).
000510         04  TZNT-NUK1.
000520           05  TZNT-NU1   OCCURS   6  PIC S9(009).
000530         04  TZNT-NUK2.
000540           05  TZNT-NU2   OCCURS   6  PIC S9(009).
000550       03  TZNT-TU.
000560         04  TZNT-AOTU  PIC S9(010).
000570         04  TZNT-ANTU  PIC S9(010).
000580     02  TZNT-AD.
000590       03  TZNT-AK.
000600         04  TZNT-OAK1.
000610           05  TZNT-OA1   OCCURS   6  PIC S9(009).
000620         04  TZNT-OAK2.
000630           05  TZNT-OA2   OCCURS   6  PIC S9(009).
000640         04  TZNT-NAK1.
000650           05  TZNT-NA1   OCCURS   6  PIC S9(009).
000660         04  TZNT-NAK2.
000670           05  TZNT-NA2   OCCURS   6  PIC S9(009).
000680       03  TZNT-TA.
000690         04  TZNT-AOTA  PIC S9(010).
000700         04  TZNT-ANTA  PIC S9(010).
000710     02  TZNT-NG.
000720*****  03  TZNT-N       PIC  9(002).                              D.970723
000730       03  TZNT-N       PIC  9(004).                              I.970723
000740       03  TZNT-G       PIC  9(002).
000750     02  TZNT-TC.
000760       03  TZNT-TC1     PIC  9(001).
000770       03  TZNT-TC2     PIC  9(001).
000780     02  TZNT-BC        PIC  9(001).
000790     02  F              PIC  X(026).                              I.970723
000800*****02  F              PIC  X(028).                              D.970723
000810 WORKING-STORAGE SECTION.
000820 77  W-FILE             PIC  X(013).
000830 01  WR-D.
000840     02  WR-KEY.
000850       03  WR-TCD       PIC  9(004).
000860       03  WR-IKC       PIC  9(001).
000870     02  WR-UD.
000880       03  WR-UK.
000890         04  WR-OUK1.
000900           05  WR-OU1   OCCURS   6  PIC S9(009).
000910         04  WR-OUK2.
000920           05  WR-OU2   OCCURS   6  PIC S9(009).
000930         04  WR-NUK1.
000940           05  WR-NU1   OCCURS   6  PIC S9(009).
000950         04  WR-NUK2.
000960           05  WR-NU2   OCCURS   6  PIC S9(009).
000970       03  WR-TU.
000980         04  WR-AOTU    PIC S9(010).
000990         04  WR-ANTU    PIC S9(010).
001000     02  WR-AD.
001010       03  WR-AK.
001020         04  WR-OAK1.
001030           05  WR-OA1   OCCURS   6  PIC S9(009).
001040         04  WR-OAK2.
001050           05  WR-OA2   OCCURS   6  PIC S9(009).
001060         04  WR-NAK1.
001070           05  WR-NA1   OCCURS   6  PIC S9(009).
001080         04  WR-NAK2.
001090           05  WR-NA2   OCCURS   6  PIC S9(009).
001100       03  WR-TA.
001110         04  WR-AOTA    PIC S9(010).
001120         04  WR-ANTA    PIC S9(010).
001130*****02  WR-NG          PIC  9(004).                              D.970723
001140     02  WR-NG          PIC  9(006).                              I.970723
001150     02  WR-TC          PIC  9(002).
001160     02  WR-BC          PIC  9(001).
001170     02  F              PIC  X(026).                              I.970723
001180*****02  F              PIC  X(028).                              D.970723
001190 01  W-DATA.
001200     02  W-NG.
001210*****  03  W-NEN        PIC  9(002).                              D.970723
001220       03  W-NEN        PIC  9(004).                              I.970723
001230       03  W-NENL  REDEFINES W-NEN.                               I.970723
001240         04  W-NEN1     PIC  9(002).                              I.970723
001250         04  W-NEN2     PIC  9(002).                              I.970723
001260       03  W-GET        PIC  9(002).
001270     02  W-NGL   REDEFINES W-NG.                                  I.970723
001280       03  F            PIC  9(002).                              I.970723
001290       03  W-NGS        PIC  9(004).                              I.970723
001300     02  W-NGD.
001310       03  W-NEND       PIC  9(002).
001320       03  W-GETD       PIC  9(002).
001330     02  W-ANGD.
001340       03  W-ANG   OCCURS  24  PIC  9(004).
001350     02  W-GNGD  REDEFINES W-ANGD.
001360       03  W-GNG1  OCCURS   6.
001370         04  W-GNGD1    PIC  9(004).
001380       03  W-GNG2  OCCURS   6.
001390         04  W-GNGD2    PIC  9(004).
001400       03  W-GNG3  OCCURS   6.
001410         04  W-GNGD3    PIC  9(004).
001420       03  W-GNG4  OCCURS   6.
001430         04  W-GNGD4    PIC  9(004).
001440     02  W-GDD.
001450       03  W-GD    OCCURS   6  PIC S9(009).
001460     02  W-KIN          PIC S9(009).
001470     02  DCNT           PIC  9(002).
001480     02  GCNT           PIC  9(001).
001490     02  CNT            PIC  9(001).
001500     02  W-LC.
001510       03  W-L1         PIC  9(002).
001520       03  W-L2         PIC  9(002).
001530       03  W-L3         PIC  9(002).
001540       03  W-L4         PIC  9(002).
001550       03  W-L          PIC  9(002).
001560       03  W-C          PIC  9(002).
001570     02  W-KEY.
001580       03  W-TCD        PIC  9(004).
001590       03  W-IKC        PIC  9(001).
001600     02  CHK            PIC  9(001).
001610     02  W-ACT          PIC  9(001).
001620     02  W-DMM          PIC  9(001).
001630     02  W-IKM          PIC  N(003).                              I.020410
001640*****02  W-IKM          PIC  N(003).                              D.970109
001650*****02  W-IKM          PIC  N(004).                              D.020410
001660 01  ERR-STAT           PIC  X(002).
001670     COPY LSTAT.
001680 SCREEN SECTION.
001690 SD  C-CRT
001700     END STATUS IS ESTAT.
001710 01  C-CLEAR.
001720     02  C-CL   LINE   1  CLEAR SCREEN.
001730 01  C-ACP.
001740     02  A-ACT   LINE   3  COLUMN  51   PIC  9(001)
001750          USING W-ACT   CHECK OVERFLOW NO IFC.
001760     02  LINE   5.
001770       03  A-TCD   COLUMN   9   PIC  9(004)
001780            USING W-TCD   CHECK OVERFLOW NO IFC.
001790*****  03  A-IKC   COLUMN  68   PIC  9(001)                       D.020410
001800       03  A-IKC   COLUMN  72   PIC  9(001)                       I.020410
001810            USING W-IKC   CHECK OVERFLOW NO IFC.
001820     02  A-GD    LINE W-L  COLUMN W-C   PIC S9(009)
001830          USING W-GD(CNT) CHECK OVERFLOW NO IFC.
001840     02  A-DMM   LINE  23  COLUMN  51   PIC  9(001)
001850          USING W-DMM   CHECK OVERFLOW NO IFC.
001860 01  C-DSP.
001870     02  D-NEN.
001880       03  LINE W-L1.
001890         04  COLUMN   7  PIC 99/99  FROM  W-GNGD1(1) REVERSE.
001900         04  COLUMN  18  PIC 99/99  FROM  W-GNGD1(2) REVERSE.
001910         04  COLUMN  29  PIC 99/99  FROM  W-GNGD1(3) REVERSE.
001920         04  COLUMN  40  PIC 99/99  FROM  W-GNGD1(4) REVERSE.
001930         04  COLUMN  51  PIC 99/99  FROM  W-GNGD1(5) REVERSE.
001940         04  COLUMN  62  PIC 99/99  FROM  W-GNGD1(6) REVERSE.
001950       03  LINE W-L2.
001960         04  COLUMN   7  PIC 99/99  FROM  W-GNGD2(1) REVERSE.
001970         04  COLUMN  18  PIC 99/99  FROM  W-GNGD2(2) REVERSE.
001980         04  COLUMN  29  PIC 99/99  FROM  W-GNGD2(3) REVERSE.
001990         04  COLUMN  40  PIC 99/99  FROM  W-GNGD2(4) REVERSE.
002000         04  COLUMN  51  PIC 99/99  FROM  W-GNGD2(5) REVERSE.
002010         04  COLUMN  62  PIC 99/99  FROM  W-GNGD2(6) REVERSE.
002020       03  LINE W-L3.
002030         04  COLUMN   7  PIC 99/99  FROM  W-GNGD3(1) REVERSE.
002040         04  COLUMN  18  PIC 99/99  FROM  W-GNGD3(2) REVERSE.
002050         04  COLUMN  29  PIC 99/99  FROM  W-GNGD3(3) REVERSE.
002060         04  COLUMN  40  PIC 99/99  FROM  W-GNGD3(4) REVERSE.
002070         04  COLUMN  51  PIC 99/99  FROM  W-GNGD3(5) REVERSE.
002080         04  COLUMN  62  PIC 99/99  FROM  W-GNGD3(6) REVERSE.
002090       03  LINE W-L4.
002100         04  COLUMN   7  PIC 99/99  FROM  W-GNGD4(1) REVERSE.
002110         04  COLUMN  18  PIC 99/99  FROM  W-GNGD4(2) REVERSE.
002120         04  COLUMN  29  PIC 99/99  FROM  W-GNGD4(3) REVERSE.
002130         04  COLUMN  40  PIC 99/99  FROM  W-GNGD4(4) REVERSE.
002140         04  COLUMN  51  PIC 99/99  FROM  W-GNGD4(5) REVERSE.
002150         04  COLUMN  62  PIC 99/99  FROM  W-GNGD4(6) REVERSE.
002160     02  LINE   5.
002170       03  D-NAME  COLUMN  14  PIC  N(026) FROM  T-NAME.          I.020410
002180       03  D-IKM   COLUMN  74  PIC  N(003) FROM  W-IKM.           I.020410
002190*****  03  D-NAME  COLUMN  14  PIC  N(024) FROM  T-NAME.          D.020410
002200*****  03  D-IKM   COLUMN  70  PIC  N(003) FROM  W-IKM.           D.970109
002210*****  03  D-IKM   COLUMN  70  PIC  N(004) FROM  W-IKM.           D.020410
002220     02  D-GD    LINE W-L  COLUMN W-C   PIC ZZZZZZZZ9-
002230          FROM  W-GD(CNT).
002240     02  D-TOTAL.
002250       03  LINE   9  COLUMN  68   PIC ZZZZZZZZZ9-  FROM  WR-AOTU.
002260       03  LINE  13  COLUMN  68   PIC ZZZZZZZZZ9-  FROM  WR-ANTU.
002270       03  LINE  17  COLUMN  68   PIC ZZZZZZZZZ9-  FROM  WR-AOTA.
002280       03  LINE  21  COLUMN  68   PIC ZZZZZZZZZ9-  FROM  WR-ANTA.
002290 01  C-ERR.
002300     02  LINE  24.
002310       03  E-ME1   COLUMN  15   PIC  X(014) VALUE
002320            "現在使用　不可".
002330       03  E-ME2   COLUMN  15   PIC  X(017) VALUE
002340            "***  DATA ﾅｼ  ***".
002350       03  E-ME3   COLUMN  15   PIC  X(017) VALUE
002360            "***  DATA ｱﾘ  ***".
002370       03  E-ME11  COLUMN  15   PIC  X(019) VALUE
002380            "***  WRITE ｴﾗｰ  ***".
002390       03  E-ME12  COLUMN  15   PIC  X(021) VALUE
002400            "***  REWRITE ｴﾗｰ  ***".
002410       03  E-ME13  COLUMN  15   PIC  X(020) VALUE
002420            "***  DELETE ｴﾗｰ  ***".
002430     COPY LSSEM.
002440     COPY LIBSCR.
002450 PROCEDURE DIVISION.
002460 M-020.
002470     PERFORM S-020 THRU S-060.                                    日付ｾｯﾄ
002480     DISPLAY C-CLEAR.
002490     CALL "SCHY15".
002500     MOVE  6 TO W-L1.
002510     MOVE  8 TO W-L2.
002520     MOVE 10 TO W-L3.
002530     MOVE 12 TO W-L4.
002540     DISPLAY D-NEN.
002550     MOVE 14 TO W-L1.
002560     MOVE 16 TO W-L2.
002570     MOVE 18 TO W-L3.
002580     MOVE 20 TO W-L4.
002590     DISPLAY D-NEN.
002600     OPEN INPUT T-M.
002610     OPEN I-O TZNT-M.
002620 M-040.
002630     ACCEPT A-ACT.
002640     IF ESTAT NOT = HTB AND SKP
002650         GO TO M-040.
002660     IF W-ACT = 9
002670         GO TO M-980.
002680     IF W-ACT NOT = 1 AND 2 AND 3
002690         GO TO M-040.
002700 M-060.
002710     DISPLAY C-CLEAR.
002720     CALL "SCHY15".
002730     DISPLAY A-ACT.
002740     MOVE  6 TO W-L1.
002750     MOVE  8 TO W-L2.
002760     MOVE 10 TO W-L3.
002770     MOVE 12 TO W-L4.
002780     DISPLAY D-NEN.
002790     MOVE 14 TO W-L1.
002800     MOVE 16 TO W-L2.
002810     MOVE 18 TO W-L3.
002820     MOVE 20 TO W-L4.
002830     DISPLAY D-NEN.
002840 M-080.
002850     ACCEPT A-TCD.
002860     DISPLAY E-CL.
002870     IF ESTAT = BTB
002880         GO TO M-040.
002890     IF ESTAT NOT = HTB AND SKP
002900         GO TO M-080.
002910     MOVE W-TCD TO T-KEY.
002920     READ T-M WITH UNLOCK INVALID KEY
002930         GO TO M-080.
002940     DISPLAY D-NAME.
002950     IF T-BC NOT = 0
002960         MOVE 0 TO W-IKC
002970         MOVE NC"工品他" TO W-IKM                                 I.020410
002980*****    MOVE NC"工品他" TO W-IKM                                 D.970109
002990*****    MOVE NC"工品他　" TO W-IKM                               D.020410
003000         DISPLAY A-IKC D-IKM
003010         GO TO M-120.
003020 M-100.
003030     ACCEPT A-IKC.
003040     IF ESTAT = BTB
003050         GO TO M-080.
003060     IF ESTAT NOT = HTB AND SKP
003070         GO TO M-100.
003080*****IF W-IKC NOT = 1 AND 2                                       D.970109
003090     IF W-IKC NOT = 1 AND 2 AND 3                                 I.970109
003100         GO TO M-100.
003110     IF W-IKC = 1
003120         MOVE NC"一　般" TO W-IKM.                                I.020410
003130*****    MOVE NC"一　般　" TO W-IKM.                              D.020410
003140*****    MOVE NC"一　般" TO W-IKM                                 D.970109
003150*****  ELSE                                                       D.970109
003160*****    MOVE NC"教　育" TO W-IKM.                                D.970109
003170     IF W-IKC = 2                                                 I.970109
003180         MOVE NC"教　育" TO W-IKM.                                I.020410
003190*****    MOVE NC"教　育　" TO W-IKM.                              D.020410
003200     IF W-IKC = 3                                                 I.970109
003210         MOVE NC"ＶＩＶ" TO W-IKM.                                I.020410
003220*****    MOVE NC"ヴィヴェ" TO W-IKM.                              D.020410
003230     DISPLAY D-IKM.
003240 M-120.
003250     MOVE ZERO TO WR-D.
003260     MOVE W-KEY TO TZNT-KEY.
003270     READ TZNT-M INVALID KEY
003280         GO TO M-140.
003290     IF W-ACT = 1
003300         DISPLAY E-ME3 E-ME98
003310         GO TO M-080.
003320     MOVE TZNT-R TO WR-D.
003330     PERFORM S-080 THRU S-140.
003340     IF W-ACT = 3
003350         GO TO M-320.
003360     GO TO M-160.
003370 M-140.
003380     IF W-ACT NOT = 1
003390         DISPLAY E-ME2 E-ME98
003400         GO TO M-080.
003410     MOVE W-KEY TO WR-KEY.
003420     PERFORM S-080 THRU S-140.
003430 M-160.
003440     MOVE ZERO TO GCNT.
003450 M-180.
003460     ADD 1 TO GCNT.
003470     IF GCNT = 9
003480         GO TO M-320.
003490     PERFORM S-160 THRU S-200.
003500     MOVE ZERO TO CNT.
003510     MOVE 2 TO W-C.
003520 M-200.
003530     ADD 1 TO CNT.
003540     IF CNT = 7
003550         GO TO M-180.
003560 M-220.
003570     MOVE W-GD(CNT) TO W-KIN.
003580     ACCEPT A-GD.
003590*****IF ESTAT = PF22                                              D.001205
003600     IF ESTAT = PF22 OR PF7                                       I.001205
003610         MOVE W-KIN TO W-GD(CNT)
003620         DISPLAY D-GD
003630         GO TO M-260.
003640*****IF ESTAT = PF21                                              D.001205
003650     IF ESTAT = PF21 OR PF6                                       I.001205
003660         MOVE W-KIN TO W-GD(CNT)
003670         DISPLAY D-GD
003680         GO TO M-280.
003690     IF ESTAT = ADV
003700         MOVE W-KIN TO W-GD(CNT)
003710         DISPLAY D-GD
003720         GO TO M-300.
003730     IF ESTAT = BTB
003740         GO TO M-240.
003750     IF ESTAT NOT = HTB AND SKP
003760         GO TO M-220.
003770     PERFORM S-220 THRU S-240.                                    ｺﾞｳｹｲ
003780     DISPLAY D-GD D-TOTAL.
003790     ADD 11 TO W-C.
003800     GO TO M-200.
003810 M-240.
003820     SUBTRACT 1 FROM CNT.
003830     IF CNT NOT = 0
003840         SUBTRACT 11 FROM W-C
003850         GO TO M-220.
003860     SUBTRACT 1 FROM GCNT.
003870     IF GCNT = 0
003880         GO TO M-080.
003890     PERFORM S-160 THRU S-200.
003900     MOVE 6 TO CNT.
003910     MOVE 57 TO W-C.
003920     GO TO M-220.
003930 M-260.
003940     PERFORM S-220 THRU S-240.
003950     GO TO M-180.
003960 M-280.
003970     PERFORM S-220 THRU S-240.
003980     SUBTRACT 1 FROM GCNT.
003990     IF GCNT = 0
004000         GO TO M-080.
004010     PERFORM S-160 THRU S-200.
004020     MOVE 1 TO CNT.
004030     MOVE 2 TO W-C.
004040     GO TO M-220.
004050 M-300.
004060     PERFORM S-220 THRU S-240.
004070 M-320.
004080     ACCEPT A-DMM.
004090     IF ESTAT = BTB
004100         GO TO M-340.
004110     IF ESTAT NOT = HTB AND SKP
004120         GO TO M-320.
004130     IF W-DMM = 9
004140         GO TO M-160.
004150     IF W-DMM NOT = 1
004160         GO TO M-320.
004170     GO TO M-360.
004180 M-340.
004190     IF W-ACT = 3
004200         GO TO M-080.
004210     MOVE 8 TO GCNT.
004220     PERFORM S-160 THRU S-200.
004230     MOVE 6 TO CNT.
004240     MOVE 57 TO W-C.
004250     GO TO M-220.
004260 M-360.
004270     IF W-ACT = 3
004280         GO TO M-400.
004290     MOVE WR-D TO TZNT-R.
004300     IF W-ACT NOT = 1
004310         GO TO M-380.
004320     WRITE TZNT-R INVALID KEY
004330         DISPLAY E-ME78 E-STAT E-ME11 E-ME99
004340         GO TO M-980.
004350     GO TO M-060.
004360 M-380.
004370     REWRITE TZNT-R INVALID KEY
004380         DISPLAY E-ME78 E-STAT E-ME12 E-ME99
004390         GO TO M-980.
004400     GO TO M-060.
004410 M-400.
004420     DELETE TZNT-M INVALID KEY
004430         DISPLAY E-ME78 E-STAT E-ME13 E-ME99
004440         GO TO M-980.
004450     GO TO M-060.
004460 M-980.
004470     CLOSE T-M.
004480     CLOSE TZNT-M.
004490     DISPLAY C-CLEAR.
004500     STOP RUN.
004510*****  日付セット　
004520 S-020.
004530     COPY LIBCPR.
004540*****MOVE D-NHNG TO W-NG.                                         D.970723
004550     MOVE D-NHNG TO W-NGS.                                        I.970723
004560     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.970723
004570         ADD DATE-NC1 TO W-NEN.                                   I.970723
004580     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.970723
004590         ADD DATE-NC2 TO W-NEN.                                   I.970723
004600     MOVE D-NKNG TO W-NGD.
004610*****IF W-NG NOT = W-NGD                                          D.970723
004620     IF W-NGS NOT = W-NGD                                         I.970723
004630         DISPLAY E-ME1 E-ME99
004640         DISPLAY C-CLEAR
004650         STOP RUN.
004660     SUBTRACT 1 FROM W-GET.
004670     IF W-GET = ZERO
004680         MOVE 12 TO W-GET
004690         SUBTRACT 1 FROM W-NEN.
004700     IF W-GET < 5
004710         COMPUTE W-NEND = W-NEN - 1.
004720     IF W-NEND = ZERO                                             I.990402
004730         MOVE 99 TO W-NEND                                        I.990402
004740       ELSE                                                       I.990402
004750         SUBTRACT 1 FROM W-NEND.
004760     MOVE 4 TO W-GETD.
004770     MOVE ZERO TO DCNT W-ANGD.
004780 S-040.
004790     ADD 1 TO W-GETD DCNT.
004800     IF DCNT = 25
004810         GO TO S-060.
004820     IF W-GETD = 13
004830         MOVE 1 TO W-GETD
004840         ADD 1 TO W-NEND.
004850     MOVE W-NGD TO W-ANG(DCNT).
004860     GO TO S-040.
004870 S-060.
004880     EXIT.
004890*****   画面表示
004900 S-080.
004910     MOVE W-NG TO WR-NG.
004920     MOVE T-TNC TO WR-TC.
004930     MOVE T-BC TO WR-BC.
004940     MOVE ZERO TO GCNT.
004950 S-100.
004960     ADD 1 TO GCNT.
004970     IF GCNT = 9
004980         DISPLAY D-TOTAL
004990         GO TO S-140.
005000     PERFORM S-160 THRU S-200.
005010     MOVE ZERO TO CNT.
005020     MOVE 2 TO W-C.
005030 S-120.
005040     ADD 1 TO CNT.
005050     IF CNT NOT = 7
005060         DISPLAY D-GD
005070         ADD 11 TO W-C
005080         GO TO S-120.
005090     GO TO S-100.
005100 S-140.
005110     EXIT.
005120*****   行ＤＡＴＡ　入力ＤＡＴＡセット
005130 S-160.
005140     MOVE ZERO TO W-GDD.
005150 S-180.
005160     IF GCNT = 1
005170         MOVE  7 TO W-L
005180         MOVE WR-OUK1 TO W-GDD.
005190     IF GCNT = 2
005200         MOVE  9 TO W-L
005210         MOVE WR-OUK2 TO W-GDD.
005220     IF GCNT = 3
005230         MOVE 11 TO W-L
005240         MOVE WR-NUK1 TO W-GDD.
005250     IF GCNT = 4
005260         MOVE 13 TO W-L
005270         MOVE WR-NUK2 TO W-GDD.
005280     IF GCNT = 5
005290         MOVE 15 TO W-L
005300         MOVE WR-OAK1 TO W-GDD.
005310     IF GCNT = 6
005320         MOVE 17 TO W-L
005330         MOVE WR-OAK2 TO W-GDD.
005340     IF GCNT = 7
005350         MOVE 19 TO W-L
005360         MOVE WR-NAK1 TO W-GDD.
005370     IF GCNT = 8
005380         MOVE 21 TO W-L
005390         MOVE WR-NAK2 TO W-GDD.
005400 S-200.
005410     EXIT.
005420*****   合計セット
005430 S-220.
005440     IF GCNT = 1
005450         MOVE W-GDD TO WR-OUK1.
005460     IF GCNT = 2
005470         MOVE W-GDD TO WR-OUK2.
005480     IF GCNT = 3
005490         MOVE W-GDD TO WR-NUK1.
005500     IF GCNT = 4
005510         MOVE W-GDD TO WR-NUK2.
005520     IF GCNT = 5
005530         MOVE W-GDD TO WR-OAK1.
005540     IF GCNT = 6
005550         MOVE W-GDD TO WR-OAK2.
005560     IF GCNT = 7
005570         MOVE W-GDD TO WR-NAK1.
005580     IF GCNT = 8
005590         MOVE W-GDD TO WR-NAK2.
005600     COMPUTE WR-AOTU = WR-OU1(1) + WR-OU1(2) + WR-OU1(3) +
005610                       WR-OU1(4) + WR-OU1(5) + WR-OU1(6) +
005620                       WR-OU2(1) + WR-OU2(2) + WR-OU2(3) +
005630                       WR-OU2(4) + WR-OU2(5) + WR-OU2(6).
005640     COMPUTE WR-ANTU = WR-NU1(1) + WR-NU1(2) + WR-NU1(3) +
005650                       WR-NU1(4) + WR-NU1(5) + WR-NU1(6) +
005660                       WR-NU2(1) + WR-NU2(2) + WR-NU2(3) +
005670                       WR-NU2(4) + WR-NU2(5) + WR-NU2(6).
005680     COMPUTE WR-AOTA = WR-OA1(1) + WR-OA1(2) + WR-OA1(3) +
005690                       WR-OA1(4) + WR-OA1(5) + WR-OA1(6) +
005700                       WR-OA2(1) + WR-OA2(2) + WR-OA2(3) +
005710                       WR-OA2(4) + WR-OA2(5) + WR-OA2(6).
005720     COMPUTE WR-ANTA = WR-NA1(1) + WR-NA1(2) + WR-NA1(3) +
005730                       WR-NA1(4) + WR-NA1(5) + WR-NA1(6) +
005740                       WR-NA2(1) + WR-NA2(2) + WR-NA2(3) +
005750                       WR-NA2(4) + WR-NA2(5) + WR-NA2(6).
005760 S-240.
005770     EXIT.
