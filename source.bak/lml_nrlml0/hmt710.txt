000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMT710.
000030*********************************************************
000040*    PROGRAM         :  履物分類販売計画　入力　　　　　*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHT71                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  0=入力 , 1=月次更新             *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT HKBM ASSIGN TO HKB-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY HKB-KEY
000210         FILE STATUS ERR-STAT.
000220     SELECT HBHKF ASSIGN TO HBHK-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE DYNAMIC
000250         RECORD KEY HBHK-KEY
000260         FILE STATUS IS ERR-STAT.
000270     SELECT HBUHF ASSIGN TO HBUH-MSD.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON M-DATE
000300     APPLY SHARED-MODE ON HKBM.
000310 DATA DIVISION.
000320 FILE SECTION.
000330     COPY LIBFDD.
000340     COPY LIHKBM.
000350 FD  HBHKF
000360*****BLOCK  8 RECORDS                                             D.060710
000370     BLOCK  6 RECORDS                                             I.060710
000380     LABEL RECORD IS STANDARD
000390     VALUE OF IDENTIFICATION "HBHKF".
000400 01  HBHK-R.
000410     02  HBHK-KEY.
000420       03  HBHK-NG      PIC  9(006).                              I.060710
000430       03  HBHK-BC.
000440*****    04  HBHK-BC1   PIC  9(002).                              D.031001
000450*****    04  HBHK-BC2.                                            D.031001
000460*****      05  HBHK-BC21 PIC  9(001).                             D.031001
000470*****      05  HBHK-BC22 PIC  9(001).                             D.031001
000480         04  HBHK-BC3   PIC  9(002).
000490*****    04  HBHK-BMN   PIC  9(002).                              D.060710
000500         04  HBHK-BMNO  PIC  9(001).                              I.021114
000510         04  HBHK-BC1   PIC  9(002).                              I.031001
000520*****  03  HBHK-NG      PIC  9(006).                              D.060710
000530*****02  HBHK-KIN       PIC S9(010).                              D.060710
000540     02  HBHK-BMN       PIC  9(002).                              I.060710
000550     02  HBHK-KKIN      PIC S9(010).                              I.060710
000560     02  HBHK-JKIN      PIC S9(010).                              I.060710
000570     02  F              PIC  X(009).                              I.060710
000580*****02  F              PIC  X(002).                              D.060710
000590*****02  HBHK-GP        PIC  9(004).                              D.060710
000600*****02  HBHK-STN       PIC  X(003).                              D.060710
000610*****02  F              PIC  X(007).                              D.030930
000620*****02  F              PIC  X(010).                              D.021114
000630 FD  HBUHF
000640     BLOCK  2 RECORDS
000650     LABEL RECORD IS STANDARD
000660     VALUE OF IDENTIFICATION WK0128ID.
000670 01  HBUH-R.
000680     02  HBUH-KEY.
000690       03  HBUH-BC1     PIC  9(002).
000700       03  HBUH-BC2.
000710         04  HBUH-BC21  PIC  9(001).
000720         04  HBUH-BC22  PIC  9(001).
000730       03  HBUH-BC3     PIC  9(002).
000740       03  HBUH-BMC     PIC  9(002).                              I.021114
000750       03  HBUH-BMNO    PIC  9(001).                              I.021114
000760     02  HBUH-ZS        PIC S9(007).
000770     02  HBUH-ZK        PIC S9(010).
000780     02  HBUH-NS        PIC S9(007).
000790     02  HBUH-NK        PIC S9(010).
000800     02  HBUH-SS        PIC S9(007).
000810     02  HBUH-SK        PIC S9(010).
000820     02  HBUH-YS        PIC S9(007).
000830     02  HBUH-YK        PIC S9(010).
000840     02  HBUH-UG        PIC S9(010).
000850     02  F              PIC  X(041).                              I.021114
000860*****02  F              PIC  X(044).                              D.021114
000870 WORKING-STORAGE SECTION.
000880 77  JS-SIGN            PIC  9(001).                              I.060710
000890 77  W-END              PIC  9(001) VALUE 0.
000900 77  WK0128ID           PIC  X(009) VALUE SPACE.
000910 01  STN-NO.
000920     02  STN-NO1        PIC  X(003).
000930     02  STN-NO2        PIC  X(003).
000940 01  W-FID.
000950     02  W-FID1         PIC  X(006) VALUE "WK0128".
000960     02  W-FID2         PIC  X(003).
000970 01  W-MDD.
000980*****02  W-MD    OCCURS 36.                                       D.030930
000990     02  W-MD    OCCURS 38.                                       I.030930
001000       03  WM-TM        PIC  X(030).
001010       03  WM-MD    REDEFINES WM-TM.
001020         04  WM-M0      PIC  N(003).
001030*****    04  F          PIC  X(001).                              D.031001
001040         04  F          PIC  X(002).                              I.031001
001050         04  WM-M1      PIC  N(003).
001060*****    04  F          PIC  X(001).                              D.031001
001070         04  F          PIC  X(002).                              I.031001
001080         04  WM-M2      PIC  N(007).
001090       03  WM-HKK       PIC S9(010).
001100       03  WM-HGK       PIC S9(010).
001110       03  WM-TSR       PIC S9(003)V9(02).
001120       03  WM-BC.
001130*****    04  WM-BC1     PIC  9(002).                              D.031001
001140*****    04  WM-BC2     PIC  9(002).                              D.031001
001150         04  WM-BC3     PIC  9(002).
001160         04  WM-BMC     PIC  9(002).                              I.021114
001170         04  WM-BMNO    PIC  9(001).                              I.021114
001180         04  WM-BC1     PIC  9(002).                              I.031001
001190*****    04  WM-BC2     PIC  9(002).                              D.021114
001200*****    04  WM-BC1     PIC  9(002).                              D.021114
001210 01  W-DATA.
001220     02  W-L            PIC  9(002).
001230     02  W-C            PIC  9(002).
001240     02  W-CD           PIC  9(002).
001250     02  W-NGD          PIC  9(006).                              I.060710
001260     02  W-SNG          PIC  9(006).                              I.060710
001270     02  W-ENG          PIC  9(006).                              I.060710
001280     02  W-NGP.                                                   I.030626
001290       03  W-NG.                                                  I.030626
001300         04  W-NEN      PIC  9(004).                              I.030626
001310         04  W-NENL  REDEFINES W-NEN.                             I.030626
001320           05  W-NEN1   PIC  9(002).                              I.030626
001330           05  W-NEN2   PIC  9(002).                              I.030626
001340         04  W-GET      PIC  9(002).                              I.030626
001350       03  W-PEY        PIC  9(002).                              I.030626
001360     02  W-NGPL  REDEFINES W-NGP.                                 I.030626
001370       03  F            PIC  9(002).                              I.030626
001380       03  W-NGPS.                                                I.030626
001390         04  W-NGS      PIC  9(004).                              I.030626
001400         04  F          PIC  9(002).                              I.030626
001410*****02  W-NG.                                                    D.030626
001420*****  03  W-NEN        PIC  9(004).                              D.030626
001430*****  03  W-NENL  REDEFINES W-NEN.                               D.030626
001440*****    04  W-NEN1     PIC  9(002).                              D.030626
001450*****    04  W-NEN2     PIC  9(002).                              D.030626
001460*****  03  W-GET        PIC  9(002).                              D.030626
001470*****02  W-NGL   REDEFINES W-NG.                                  D.030626
001480*****  03  F            PIC  9(002).                              D.030626
001490*****  03  W-NGS        PIC  9(004).                              D.030626
001500     02  W-DMM          PIC  9(001).
001510*
001520     02  W-BC.
001530*****  03  W-BC1        PIC  9(002).                              D.031001
001540*****  03  W-BC2.                                                 D.031001
001550*****    04  W-BC21     PIC  9(001).                              D.031001
001560*****    04  W-BC22     PIC  9(001).                              D.031001
001570       03  W-BC3        PIC  9(002).
001580       03  W-BMC        PIC  9(002).                              I.021114
001590       03  W-BMNO       PIC  9(001).                              I.021114
001600       03  W-BC1        PIC  9(002).                              I.031001
001610     02  W-HKK          PIC S9(010).
001620     02  WA-D.
001630       03  WA-HKK       PIC S9(010).
001640       03  WA-HGK       PIC S9(010).
001650     02  CHK.
001660       03  CHK1         PIC  9(001).
001670       03  CHK2         PIC  9(001).
001680     02  W-PC           PIC  9(001).
001690     02  W-BTC          PIC  9(001) VALUE 0.
001700     02  W-BRN3         PIC  N(003).
001710     02  W-BMN          PIC  N(003).                              I.021114
001720*****02  W-BRN22        PIC  N(003).                              D.021114
001730     02  W-TSR          PIC S9(003)V9(02).
001740     02  W-TM           PIC  X(030) VALUE
001750          "　　　　【　合　計　】　　　　".
001760     02  W-NGPD.
001770       03  F            PIC  9(002).                              I.030930
001780       03  W-GPD        PIC  9(004).                              I.030930
001790 01  ERR-STAT           PIC  X(002).
001800     COPY LSTAT.
001810 SCREEN SECTION.
001820 SD  C-CRT
001830     END STATUS IS ESTAT.
001840 01  C-CLEAR.
001850     02  LINE   1  CLEAR SCREEN.
001860 01  C-MID.                                                       I.060710
001870     02  LINE   3  COLUMN  10  PIC  N(023) VALUE                  I.060710
001880          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
001890     02  LINE   4  COLUMN  10  PIC  N(023) VALUE                  I.060710
001900          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
001910     02  LINE   5  COLUMN  10  PIC  N(023) VALUE                  I.060710
001920          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.060710
001930     02  LINE   6  COLUMN  10  PIC  N(023) VALUE                  I.060710
001940          NC"＊＊＊　　履物分類販売計画　実績更新　　＊＊＊".     I.060710
001950     02  LINE   7  COLUMN  10  PIC  N(023) VALUE                  I.060710
001960          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.060710
001970     02  LINE   8  COLUMN  10  PIC  N(023) VALUE                  I.060710
001980          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
001990     02  LINE   9  COLUMN  10  PIC  N(023) VALUE                  I.060710
002000          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
002010 01  C-ACP.
002020     02  LINE   1.                                                I.060710
002030       03  A-NEN2  COLUMN  60  PIC  9(002)                        I.060710
002040            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.060710
002050       03  A-GET   COLUMN  64  PIC  9(002)                        I.060710
002060            USING W-GET   CHECK OVERFLOW NO IFC.                  I.060710
002070     02  A-HKK    LINE W-L  COLUMN  41  PIC S9(009)
002080          USING WM-HKK(W-C) CHECK OVERFLOW NO IFC.
002090     02  A-DMM    LINE  23  COLUMN  67  PIC  9(001)
002100          USING W-DMM   CHECK OVERFLOW NO IFC.
002110 01  C-DSP.
002120*****02  D-NGP   LINE   2.                                        D.030930
002130     02  D-NGP   LINE   1.                                        I.030930
002140       03  COLUMN  60  PIC  9(002) FROM  W-NEN2.                  I.030626
002150       03  COLUMN  64  PIC  Z(002) FROM  W-GET.                   I.030626
002160       03  COLUMN  68  PIC  Z(002) FROM  W-PEY.                   I.030626
002170*****02  D-NG    LINE   2.                                        D.030626
002180*****  03  COLUMN  62  PIC  9(002) FROM  W-NEN2.                  D.030626
002190*****  03  COLUMN  66  PIC  Z(002) FROM  W-GET.                   D.030626
002200     02  LINE W-L.
002210       03  D-MD.
002220         04  COLUMN   8  PIC  X(030)       FROM  WM-TM(W-C).
002230         04  COLUMN  41  PIC ZZZZZZZZ9-    FROM  WM-HKK(W-C).
002240         04  COLUMN  52  PIC ZZZ,ZZZ,ZZ9-  FROM  WM-HGK(W-C).
002250         04  COLUMN  65  PIC ZZ9.99-       FROM  WM-TSR(W-C).
002260       03  D-MIDE.
002270         04  COLUMN   8  PIC  X(030)       FROM  W-TM.
002280         04  COLUMN  41  PIC ZZZZZZZZ9-    FROM  WA-HKK.
002290         04  COLUMN  52  PIC ZZZ,ZZZ,ZZ9-  FROM  WA-HGK.
002300         04  COLUMN  65  PIC ZZ9.99-       FROM  W-TSR.
002310 01  C-ERR.
002320     02  LINE 24.
002330       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002340       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002350            "***  DATA ﾅｼ  ***".
002360       03  E-ME2   COLUMN  15  PIC  X(026) VALUE
002370            "***  ﾌﾞﾝﾙｲ ｶﾞ 38ｦ ｺｴﾀ  ***".                         I.030930
002380*****       "***  ﾌﾞﾝﾙｲ ｶﾞ 36ｦ ｺｴﾀ  ***".                         D.030930
002390       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
002400            "***  DATA ｴﾗｰ  ***".
002410       03  E-ME4   COLUMN  15  PIC  X(025) VALUE
002420            "***  HBHKF WRITE ｴﾗｰ  ***".
002430       03  E-ME5   COLUMN  15  PIC  X(027) VALUE
002440            "***  HBHKF REWRITE ｴﾗｰ  ***".
002450       03  E-ME6   COLUMN  15  PIC  X(026) VALUE                  I.060710
002460            "***  HBHKF DELETE ｴﾗｰ  ***".                         I.060710
002470       03  E-KEY   COLUMN  50  PIC  X(011) FROM  HBHK-KEY.        I.060710
002480       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002490       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002500     COPY LIBSCR.
002510 PROCEDURE DIVISION.
002520 M-05.
002530     ACCEPT JS-SIGN.                                              I.060710
002540     IF JS-SIGN > 1                                               I.060710
002550         STOP RUN.                                                I.060710
002560     COPY LIBCPR.
002570     DISPLAY C-CLEAR.
002580     IF JS-SIGN = 1                                               I.060710
002590         DISPLAY C-MID                                            I.060710
002600       ELSE                                                       I.060710
002610         CALL "SCHT71".
002620*****MOVE ZERO TO W-NG.                                           D.030626
002630     MOVE ZERO TO W-NGP.                                          I.030626
002640     IF D-HSD NOT = ZERO                                          I.030626
002650         MOVE D-HSD TO W-NGPS                                     I.030626
002660       ELSE                                                       I.030626
002670         MOVE D-NHNG TO W-NGS.
002680     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
002690         ADD DATE-NC1 TO W-NEN.
002700     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
002710         ADD DATE-NC2 TO W-NEN.
002720     MOVE W-NG TO W-NGD.                                          I.060710
002730     IF JS-SIGN = 1                                               I.060710
002740         GO TO M-17.                                              I.060710
002750     DISPLAY D-NGP.                                               I.030626
002760     IF W-GET > 3                                                 I.060710
002770         ADD 1 TO W-NEN.                                          I.060710
002780     MOVE 4 TO W-GET.                                             I.060710
002790     MOVE W-NG TO W-ENG.                                          I.060710
002800     MOVE W-NGD TO W-NG.                                          I.060710
002810     IF W-GET < 6                                                 I.060710
002820         SUBTRACT 1 FROM W-NEN.                                   I.060710
002830     MOVE 5 TO W-GET.                                             I.060710
002840     MOVE W-NG TO W-SNG.                                          I.060710
002850*****DISPLAY D-NG.                                                D.030626
002860 M-10.                                                            I.060710
002870     ACCEPT A-NEN2.                                               I.060710
002880     IF ESTAT = PF9                                               I.060710
002890         GO TO M-95.                                              I.060710
002900     IF ESTAT NOT = HTB AND SKP                                   I.060710
002910         GO TO M-10.                                              I.060710
002920     MOVE ZERO TO W-NEN1.                                         I.060710
002930     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.060710
002940         ADD DATE-NC1 TO W-NEN.                                   I.060710
002950     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.060710
002960         ADD DATE-NC2 TO W-NEN.                                   I.060710
002970 M-15.                                                            I.060710
002980     ACCEPT A-GET.                                                I.060710
002990     IF ESTAT = BTB                                               I.060710
003000         GO TO M-10.                                              I.060710
003010     IF ESTAT NOT = HTB AND SKP                                   I.060710
003020         GO TO M-15.                                              I.060710
003030     IF W-GET < 1 OR > 12                                         I.060710
003040         GO TO M-15.                                              I.060710
003050     IF W-NG < W-SNG OR > W-ENG                                   I.060710
003060         GO TO M-10.                                              I.060710
003070 M-17.                                                            I.060710
003080     MOVE ZERO TO W-C.
003090 M-20.
003100     ADD 1 TO W-C.
003110*****IF W-C NOT = 37                                              D.030930
003120     IF W-C NOT = 39                                              I.030930
003130         INITIALIZE W-MD(W-C)
003140         GO TO M-20.
003150*
003160     IF W-NG >= W-NGD                                             I.060710
003170         PERFORM SET1-RTN THRU SET1-EX                            I.060710
003180       ELSE                                                       I.060710
003190         PERFORM SET2-RTN THRU SET2-EX.                           I.060710
003200     IF W-END = 1                                                 I.060710
003210         GO TO M-95.                                              I.060710
003220*****CALL "CBLSTNNO" USING STN-NO.                                D.060710
003230*****MOVE STN-NO2 TO W-FID2.                                      D.060710
003240*****MOVE W-FID TO WK0128ID.                                      D.060710
003250*****OPEN INPUT HBUHF.                                            D.060710
003260*M-21.                                                            D.060710
003270*****READ HBUHF AT END                                            D.060710
003280*****    CLOSE HBUHF                                              D.060710
003290*****    DISPLAY E-ME1 E-ME99                                     D.060710
003300*****    GO TO M-95.                                              D.060710
003310*****IF HBUH-ZS = ZERO                                            D.001102
003320*****IF ZERO = HBUH-ZS AND HBUH-NS AND HBUH-SS AND HBUH-YS        D.030122
003330*****    GO TO M-21.                                              D.030122
003340*
003350*****OPEN INPUT HBHKF.                                            D.060710
003360*****OPEN INPUT HKBM.                                             D.060710
003370*
003380*****MOVE ZERO TO WA-D W-C.                                       D.060710
003390*M-22.                                                            D.060710
003400*****MOVE HBUH-BC3 TO W-BC3.                                      D.060710
003410*****MOVE ZERO TO CHK.                                            D.060710
003420*
003430*****MOVE SPACE TO HKB-KEY.                                       D.060710
003440*****MOVE "14" TO HKB-NO.                                         D.060710
003450*****MOVE W-BC3 TO HKB-BR3.                                       D.060710
003460*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003470*****    MOVE SPACE TO HKB-BRN3.                                  D.060710
003480*****MOVE HKB-BRN3 TO W-BRN3.                                     D.060710
003490*M-23.                                                            D.060710
003500*****MOVE HBUH-BC2 TO W-BC2.                                      D.031001
003510*****MOVE HBUH-BMC TO W-BMC.                                      D.060710
003520*****MOVE HBUH-BMNO TO W-BMNO.                                    D.060710
003530*****MOVE ZERO TO CHK2.                                           D.060710
003540*
003550*****MOVE SPACE TO HKB-KEY.                                       D.060710
003560*****MOVE "13" TO HKB-NO.                                         D.021114
003570*****MOVE W-BC22 TO HKB-BR22.                                     D.021114
003580*****MOVE "16" TO HKB-NO.                                         D.060710
003590*****MOVE W-BMC TO HKB-BMC.                                       D.060710
003600*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003610*****    MOVE SPACE TO HKB-BMN.                                   D.060710
003620*****MOVE HKB-BMN TO W-BMN.                                       D.060710
003630*****    MOVE SPACE TO HKB-BRN22.                                 D.021114
003640*****MOVE HKB-BRN22 TO W-BRN22.                                   D.021114
003650*M-24.                                                            D.060710
003660*****ADD 1 TO W-C.                                                D.060710
003670*****IF W-C > 36                                                  D.030930
003680*****IF W-C > 38                                                  D.060710
003690*****    CLOSE HBUHF                                              D.060710
003700*****    CLOSE HBHKF                                              D.060710
003710*****    CLOSE HKBM                                               D.060710
003720*****    DISPLAY E-ME2 E-ME99                                     D.060710
003730*****    GO TO M-95.                                              D.060710
003740*****IF CHK1 = 0                                                  D.060710
003750*****    MOVE 1 TO CHK1                                           D.060710
003760*****    MOVE W-BRN3 TO WM-M0(W-C).                               D.060710
003770*****IF CHK2 = 0                                                  D.060710
003780*****    MOVE 1 TO CHK2                                           D.060710
003790*****    MOVE W-BMN TO WM-M1(W-C).                                D.060710
003800*****    MOVE W-BRN22 TO WM-M1(W-C).                              D.021114
003810*
003820*****MOVE HBUH-BC1 TO W-BC1.                                      D.060710
003830*****MOVE SPACE TO HKB-KEY.                                       D.060710
003840*****MOVE "11" TO HKB-NO.                                         D.060710
003850*****MOVE HBUH-BC1 TO HKB-BR1.                                    D.060710
003860*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003870*****    MOVE SPACE TO HKB-BRN1.                                  D.060710
003880*****MOVE HKB-BRN1 TO WM-M2(W-C).                                 D.060710
003890*
003900*****MOVE HBUH-KEY TO WM-BC(W-C).                                 D.031001
003910*****MOVE HBUH-BC3 TO WM-BC3(W-C).                                D.060710
003920*****MOVE HBUH-BMC TO WM-BMC(W-C).                                D.060710
003930*****MOVE HBUH-BMNO TO WM-BMNO(W-C).                              D.060710
003940*****MOVE HBUH-BC1 TO WM-BC1(W-C).                                D.060710
003950*****MOVE HBUH-SK TO WM-HGK(W-C).                                 D.060710
003960*
003970*****ADD HBUH-SK TO WA-HGK.                                       D.060710
003980*
003990*****MOVE HBUH-KEY TO HBHK-BC.                                    D.031001
004000*****MOVE HBUH-BC3 TO HBHK-BC3.                                   D.060710
004010*****MOVE HBUH-BMC TO HBHK-BMN.                                   D.060710
004020*****MOVE HBUH-BMNO TO HBHK-BMNO.                                 D.060710
004030*****MOVE HBUH-BC1 TO HBHK-BC1.                                   D.060710
004040*****MOVE W-NG TO HBHK-NG.                                        D.060710
004050*****READ HBHKF WITH UNLOCK INVALID KEY                           D.060710
004060*****    GO TO M-26.                                              D.060710
004070*****MOVE HBHK-KIN TO WM-HKK(W-C).                                D.060710
004080*
004090*****ADD HBHK-KIN TO WA-HKK.                                      D.060710
004100*M-26.                                                            D.060710
004110*****READ HBUHF AT END                                            D.060710
004120*****    GO TO M-27.                                              D.060710
004130*****IF HBUH-ZS = ZERO                                            D.001102
004140*****IF ZERO = HBUH-ZS AND HBUH-NS AND HBUH-SS AND HBUH-YS        D.030122
004150*****    GO TO M-26.                                              D.030122
004160*****IF W-BC3 NOT = HBUH-BC3                                      D.060710
004170*****    GO TO M-22.                                              D.060710
004180*****IF W-BC22 = HBUH-BC22                                        D.021114
004190*****IF W-BMC = HBUH-BMC                                          D.060710
004200*****    GO TO M-24.                                              D.060710
004210*****GO TO M-23.                                                  D.060710
004220*M-27.                                                            D.060710
004230*****CLOSE HBUHF.                                                 D.060710
004240*****CLOSE HBHKF.                                                 D.060710
004250*****CLOSE HKBM.                                                  D.060710
004260     MOVE W-C TO W-CD.
004270     IF JS-SIGN = 1                                               I.060710
004280         GO TO M-67.                                              I.060710
004290     MOVE 1 TO W-PC.
004300 M-30.
004310     DISPLAY C-CLEAR.
004320     CALL "SCHT71".
004330     DISPLAY D-NGP.                                               I.030626
004340*****DISPLAY D-NG.                                                D.030626
004350*****MOVE 3 TO W-L.                                               D.030930
004360     MOVE 2 TO W-L.                                               I.030930
004370     IF W-PC = 1
004380         MOVE ZERO TO W-C
004390       ELSE
004400         MOVE 20 TO W-C.                                          I.030930
004410*****    MOVE 19 TO W-C.                                          D.030930
004420 M-35.
004430     ADD 1 TO W-C W-L.
004440*****IF (W-CD < W-C) OR (W-C = 37)                                D.030930
004450     IF (W-CD < W-C) OR (W-C = 39)                                I.030930
004460         GO TO M-40.
004470     IF W-PC = 1
004480*****    IF W-C = 20                                              D.030930
004490         IF W-C = 21                                              I.030930
004500             GO TO M-45.
004510*
004520     MOVE ZERO TO WM-TSR(W-C).
004530     IF WM-HKK(W-C) NOT = ZERO
004540         COMPUTE WM-TSR(W-C) ROUNDED =
004550                            (WM-HGK(W-C) / WM-HKK(W-C)) * 100.
004560     DISPLAY D-MD.
004570     GO TO M-35.
004580 M-40.
004590     MOVE ZERO TO W-TSR.
004600     IF WA-HKK NOT = ZERO
004610         COMPUTE W-TSR ROUNDED = (WA-HGK / WA-HKK) * 100.
004620     DISPLAY D-MIDE.
004630 M-45.
004640     IF W-BTC = 2
004650         GO TO M-55.
004660     IF W-BTC = 1
004670         MOVE 21 TO W-L
004680         MOVE 19 TO W-C                                           I.030930
004690*****    MOVE 18 TO W-C                                           D.030930
004700         GO TO M-50.
004710*****MOVE 3 TO W-L.                                               D.030930
004720     MOVE 2 TO W-L.                                               I.030930
004730     IF W-PC = 1
004740         MOVE ZERO TO W-C
004750       ELSE
004760         MOVE 20 TO W-C.                                          I.030930
004770*****    MOVE 19 TO W-C.                                          D.030930
004780 M-50.
004790     ADD 1 TO W-C W-L.
004800*****IF (W-CD < W-C) OR (W-C = 37)                                D.030930
004810     IF (W-CD < W-C) OR (W-C = 39)                                I.030930
004820         GO TO M-60.
004830     IF W-PC = 1
004840*****    IF W-C = 20                                              D.030930
004850         IF W-C = 21                                              I.030930
004860             MOVE 2 TO W-PC
004870             IF W-CD >= W-C
004880                 GO TO M-30
004890               ELSE
004900                 GO TO M-65.
004910 M-55.
004920     MOVE 0 TO W-BTC.
004930     SUBTRACT WM-HKK(W-C) FROM WA-HKK.
004940     MOVE WM-HKK(W-C) TO W-HKK.
004950     ACCEPT A-HKK.
004960     ADD WM-HKK(W-C) TO WA-HKK.
004970     IF ESTAT = PF9
004980         GO TO M-95.                                              I.030729
004990*****    MOVE W-HKK TO WM-HKK(W-C)                                D.030729
005000*****    DISPLAY D-MD                                             D.030729
005010*****    GO TO M-65.                                              D.030729
005020     IF ESTAT = BTB
005030         SUBTRACT 1 FROM W-C W-L
005040         IF W-C = 0
005050             GO TO M-45
005060           ELSE
005070*****        IF W-C NOT = 19                                      D.030930
005080             IF W-C NOT = 20                                      I.030930
005090                 GO TO M-55
005100               ELSE
005110                 MOVE 1 TO W-PC W-BTC
005120                 IF W-CD >= W-C
005130                     GO TO M-30
005140                   ELSE
005150                     GO TO M-65.
005160     IF ESTAT NOT = HTB AND SKP
005170         GO TO M-55.
005180     MOVE ZERO TO WM-TSR(W-C).
005190     IF WM-HKK(W-C) NOT = ZERO
005200         COMPUTE WM-TSR(W-C) ROUNDED =
005210                            (WM-HGK(W-C) / WM-HKK(W-C)) * 100.
005220     DISPLAY D-MD.
005230     GO TO M-50.
005240 M-60.
005250     MOVE ZERO TO W-TSR.
005260     IF WA-HKK NOT = ZERO
005270         COMPUTE W-TSR ROUNDED = (WA-HGK / WA-HKK) * 100.
005280     DISPLAY D-MIDE.
005290     IF W-CD >= W-C
005300         GO TO M-30.
005310 M-65.
005320     ACCEPT A-DMM.
005330     IF ESTAT = BTB
005340         SUBTRACT 1 FROM W-C W-L
005350         MOVE 2 TO W-BTC
005360         GO TO M-45.
005370     IF ESTAT NOT = HTB AND SKP
005380         GO TO M-65.
005390     IF W-DMM = 9
005400         GO TO M-95.                                              I.030729
005410*****    MOVE 1 TO W-PC                                           D.030729
005420*****    GO TO M-30.                                              D.030729
005430     IF W-DMM NOT = 1
005440         GO TO M-65.
005450 M-67.                                                            I.060710
005460     ACCEPT W-NGPD FROM DATE.                                     I.030930
005470     OPEN I-O HBHKF.
005480     IF W-NG >= W-NGD                                             I.060710
005490         PERFORM DEL-RTN THRU DEL-EX.                             I.060710
005500     IF W-END = 1                                                 I.060710
005510         GO TO M-80.                                              I.060710
005520     MOVE ZERO TO W-C.
005530 M-70.
005540     ADD 1 TO W-C.
005550     IF W-CD < W-C
005560         GO TO M-80.
005570     IF WM-BC(W-C) = ZERO
005580         GO TO M-70.
005590     IF W-NG >= W-NGD
005600         GO TO M-75.
005610*****MOVE WM-BC(W-C) TO HBHK-BC.                                  D.060710
005620     MOVE W-NG TO HBHK-NG.
005630     MOVE WM-BC3(W-C) TO HBHK-BC3.                                I.060710
005640     MOVE WM-BMNO(W-C) TO HBHK-BMNO.                              I.060710
005650     MOVE WM-BC1(W-C) TO HBHK-BC1.                                I.060710
005660     READ HBHKF INVALID KEY
005670         DISPLAY E-ME3 E-KEY E-ME99                               I.060710
005680         GO TO M-80.
005690*****MOVE WM-HKK(W-C) TO HBHK-KIN.                                D.060710
005700     MOVE WM-HKK(W-C) TO HBHK-KKIN.                               I.060710
005710     MOVE WM-HGK(W-C) TO HBHK-JKIN.                               I.060710
005720*****MOVE W-GPD TO HBHK-GP.                                       D.060710
005730*****MOVE STN-NO2 TO HBHK-STN.                                    D.060710
005740     REWRITE HBHK-R INVALID KEY
005750         DISPLAY E-STAT E-ME5 E-KEY E-ME99                        I.060710
005760*****    DISPLAY E-STAT E-ME5 E-ME99                              D.060710
005770         GO TO M-80.
005780     GO TO M-70.
005790 M-75.
005800     INITIALIZE HBHK-R.
005810*****MOVE WM-BC(W-C) TO HBHK-BC.                                  D.060710
005820     MOVE W-NG TO HBHK-NG.
005830     MOVE WM-BC3(W-C) TO HBHK-BC3.                                I.060710
005840     MOVE WM-BMNO(W-C) TO HBHK-BMNO.                              I.060710
005850     MOVE WM-BC1(W-C) TO HBHK-BC1.                                I.060710
005860     MOVE WM-BMC(W-C) TO HBHK-BMN.                                I.060710
005870*****MOVE WM-HKK(W-C) TO HBHK-KIN.                                D.060710
005880     MOVE WM-HKK(W-C) TO HBHK-KKIN.                               I.060710
005890     MOVE WM-HGK(W-C) TO HBHK-JKIN.                               I.060710
005900*****MOVE W-GPD TO HBHK-GP.                                       D.060710
005910*****MOVE STN-NO2 TO HBHK-STN.                                    D.060710
005920     WRITE HBHK-R INVALID KEY
005930         DISPLAY E-STAT E-ME4 E-KEY E-ME99                        I.060710
005940*****    DISPLAY E-STAT E-ME4 E-ME99                              D.060710
005950         GO TO M-80.
005960     GO TO M-70.
005970 M-80.
005980     CLOSE HBHKF.
005990     IF JS-SIGN = 0                                               I.060710
006000         GO TO M-10.                                              I.060710
006010 M-95.
006020     DISPLAY C-CLEAR.
006030     STOP RUN.
006040 SET1-RTN.                                                        I.060710
006050     CALL "CBLSTNNO" USING STN-NO.                                I.060710
006060     MOVE STN-NO2 TO W-FID2.                                      I.060710
006070     MOVE W-FID TO WK0128ID.                                      I.060710
006080     OPEN INPUT HBUHF.                                            I.060710
006090*
006100     READ HBUHF AT END                                            I.060710
006110         CLOSE HBUHF                                              I.060710
006120         MOVE 1 TO W-END                                          I.060710
006130         DISPLAY E-ME1 E-ME99                                     I.060710
006140         GO TO SET1-EX.                                           I.060710
006150*                                                                 I.060710
006160     OPEN INPUT HBHKF.                                            I.060710
006170     OPEN INPUT HKBM.                                             I.060710
006180*
006190     MOVE ZERO TO WA-D W-C.                                       I.060710
006200 SET1-010.                                                        I.060710
006210     MOVE HBUH-BC3 TO W-BC3.                                      I.060710
006220     MOVE ZERO TO CHK.                                            I.060710
006230*
006240     MOVE SPACE TO HKB-KEY.                                       I.060710
006250     MOVE "14" TO HKB-NO.                                         I.060710
006260     MOVE W-BC3 TO HKB-BR3.                                       I.060710
006270     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
006280         MOVE SPACE TO HKB-BRN3.                                  I.060710
006290     MOVE HKB-BRN3 TO W-BRN3.                                     I.060710
006300 SET1-020.                                                        I.060710
006310     MOVE HBUH-BMC TO W-BMC.                                      I.060710
006320     MOVE HBUH-BMNO TO W-BMNO.                                    I.060710
006330     MOVE ZERO TO CHK2.                                           I.060710
006340*
006350     MOVE SPACE TO HKB-KEY.                                       I.060710
006360     MOVE "16" TO HKB-NO.                                         I.060710
006370     MOVE W-BMC TO HKB-BMC.                                       I.060710
006380     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
006390         MOVE SPACE TO HKB-BMN.                                   I.060710
006400     MOVE HKB-BMN TO W-BMN.                                       I.060710
006410 SET1-030.                                                        I.060710
006420     ADD 1 TO W-C.                                                I.060710
006430     IF W-C > 38                                                  I.060710
006440         CLOSE HBUHF                                              I.060710
006450         CLOSE HBHKF                                              I.060710
006460         CLOSE HKBM                                               I.060710
006470         MOVE 1 TO W-END                                          I.060710
006480         DISPLAY E-ME2 E-ME99                                     I.060710
006490         GO TO SET1-EX.                                           I.060710
006500     IF CHK1 = 0                                                  I.060710
006510         MOVE 1 TO CHK1                                           I.060710
006520         MOVE W-BRN3 TO WM-M0(W-C).                               I.060710
006530     IF CHK2 = 0                                                  I.060710
006540         MOVE 1 TO CHK2                                           I.060710
006550         MOVE W-BMN TO WM-M1(W-C).                                I.060710
006560*
006570     MOVE HBUH-BC1 TO W-BC1.                                      I.060710
006580     MOVE SPACE TO HKB-KEY.                                       I.060710
006590     MOVE "11" TO HKB-NO.                                         I.060710
006600     MOVE HBUH-BC1 TO HKB-BR1.                                    I.060710
006610     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
006620         MOVE SPACE TO HKB-BRN1.                                  I.060710
006630     MOVE HKB-BRN1 TO WM-M2(W-C).                                 I.060710
006640 SET1-035.                                                        I.060710
006650     MOVE HBUH-BC3 TO WM-BC3(W-C).                                I.060710
006660     MOVE HBUH-BMC TO WM-BMC(W-C).                                I.060710
006670     MOVE HBUH-BMNO TO WM-BMNO(W-C).                              I.060710
006680     MOVE HBUH-BC1 TO WM-BC1(W-C).                                I.060710
006690     IF W-NG = W-NGD                                              I.060710
006700         MOVE HBUH-SK TO WM-HGK(W-C)                              I.060710
006710         ADD HBUH-SK TO WA-HGK.                                   I.060710
006720*
006730     MOVE W-NG TO HBHK-NG.                                        I.060710
006740     MOVE HBUH-BC3 TO HBHK-BC3.                                   I.060710
006750     MOVE HBUH-BMC TO HBHK-BMN.                                   I.060710
006760     MOVE HBUH-BMNO TO HBHK-BMNO.                                 I.060710
006770     MOVE HBUH-BC1 TO HBHK-BC1.                                   I.060710
006780     READ HBHKF WITH UNLOCK INVALID KEY                           I.060710
006790         GO TO SET1-040.                                          I.060710
006800     MOVE HBHK-KKIN TO WM-HKK(W-C).                               I.060710
006810*
006820     ADD HBHK-KKIN TO WA-HKK.                                     I.060710
006830 SET1-040.                                                        I.060710
006840     READ HBUHF AT END                                            I.060710
006850         GO TO SET1-050.                                          I.060710
006860     IF W-BC3 NOT = HBUH-BC3                                      I.060710
006870         GO TO SET1-010.                                          I.060710
006880     IF W-BMC = HBUH-BMC                                          I.060710
006890         GO TO SET1-030.                                          I.060710
006900     GO TO SET1-020.                                              I.060710
006910 SET1-050.                                                        I.060710
006920     CLOSE HBUHF.                                                 I.060710
006930     CLOSE HBHKF.                                                 I.060710
006940     CLOSE HKBM.                                                  I.060710
006950 SET1-EX.                                                         I.060710
006960     EXIT.                                                        I.060710
006970 SET2-RTN.                                                        I.060710
006980     OPEN INPUT HBHKF.                                            I.060710
006990     MOVE SPACE TO HBHK-KEY.                                      I.060710
007000     MOVE W-NG TO HBHK-NG.                                        I.060710
007010     START HBHKF KEY NOT < HBHK-KEY INVALID KEY                   I.060710
007020         CLOSE HBHKF                                              I.060710
007030         MOVE 1 TO W-END                                          I.060710
007040         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007050         GO TO SET2-EX.                                           I.060710
007060     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
007070         CLOSE HBHKF                                              I.060710
007080         MOVE 1 TO W-END                                          I.060710
007090         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007100         GO TO SET2-EX.                                           I.060710
007110     IF W-NG NOT = HBHK-NG                                        I.060710
007120         CLOSE HBHKF                                              I.060710
007130         MOVE 1 TO W-END                                          I.060710
007140         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007150         GO TO SET2-EX.                                           I.060710
007160*
007170     OPEN INPUT HKBM.                                             I.060710
007180*
007190     MOVE ZERO TO WA-D W-C.                                       I.060710
007200 SET2-010.                                                        I.060710
007210     MOVE HBHK-BC3 TO W-BC3.                                      I.060710
007220     MOVE ZERO TO CHK.                                            I.060710
007230*
007240     MOVE SPACE TO HKB-KEY.                                       I.060710
007250     MOVE "14" TO HKB-NO.                                         I.060710
007260     MOVE W-BC3 TO HKB-BR3.                                       I.060710
007270     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007280         MOVE SPACE TO HKB-BRN3.                                  I.060710
007290     MOVE HKB-BRN3 TO W-BRN3.                                     I.060710
007300 SET2-020.                                                        I.060710
007310     MOVE HBHK-BMN TO W-BMC.                                      I.060710
007320     MOVE HBHK-BMNO TO W-BMNO.                                    I.060710
007330     MOVE ZERO TO CHK2.                                           I.060710
007340*
007350     MOVE SPACE TO HKB-KEY.                                       I.060710
007360     MOVE "16" TO HKB-NO.                                         I.060710
007370     MOVE W-BMC TO HKB-BMC.                                       I.060710
007380     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007390         MOVE SPACE TO HKB-BMN.                                   I.060710
007400     MOVE HKB-BMN TO W-BMN.                                       I.060710
007410 SET2-030.                                                        I.060710
007420     ADD 1 TO W-C.                                                I.060710
007430     IF W-C > 38                                                  I.060710
007440         CLOSE HBHKF                                              I.060710
007450         CLOSE HKBM                                               I.060710
007460         MOVE 1 TO W-END                                          I.060710
007470         DISPLAY E-ME2 E-ME99                                     I.060710
007480         GO TO SET2-EX.                                           I.060710
007490     IF CHK1 = 0                                                  I.060710
007500         MOVE 1 TO CHK1                                           I.060710
007510         MOVE W-BRN3 TO WM-M0(W-C).                               I.060710
007520     IF CHK2 = 0                                                  I.060710
007530         MOVE 1 TO CHK2                                           I.060710
007540         MOVE W-BMN TO WM-M1(W-C).                                I.060710
007550*
007560     MOVE HBHK-BC1 TO W-BC1.                                      I.060710
007570     MOVE SPACE TO HKB-KEY.                                       I.060710
007580     MOVE "11" TO HKB-NO.                                         I.060710
007590     MOVE HBHK-BC1 TO HKB-BR1.                                    I.060710
007600     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007610         MOVE SPACE TO HKB-BRN1.                                  I.060710
007620     MOVE HKB-BRN1 TO WM-M2(W-C).                                 I.060710
007630*
007640     MOVE HBHK-BC3 TO WM-BC3(W-C).                                I.060710
007650     MOVE HBHK-BMN TO WM-BMC(W-C).                                I.060710
007660     MOVE HBHK-BMNO TO WM-BMNO(W-C).                              I.060710
007670     MOVE HBHK-BC1 TO WM-BC1(W-C).                                I.060710
007680     MOVE HBHK-KKIN TO WM-HKK(W-C).                               I.060710
007690     MOVE HBHK-JKIN TO WM-HGK(W-C)                                I.060710
007700     ADD HBHK-KKIN TO WA-HKK.                                     I.060710
007710     ADD HBHK-JKIN TO WA-HGK.                                     I.060710
007720 SET2-040.                                                        I.060710
007730     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
007740         GO TO SET2-050.                                          I.060710
007750     IF W-NG NOT = HBHK-NG                                        I.060710
007760         GO TO SET2-050.                                          I.060710
007770     IF W-BC3 NOT = HBHK-BC3                                      I.060710
007780         GO TO SET2-010.                                          I.060710
007790     IF W-BMC = HBHK-BMN                                          I.060710
007800         GO TO SET2-030.                                          I.060710
007810     GO TO SET2-020.                                              I.060710
007820 SET2-050.                                                        I.060710
007830     CLOSE HBHKF.                                                 I.060710
007840     CLOSE HKBM.                                                  I.060710
007850 SET2-EX.                                                         I.060710
007860     EXIT.                                                        I.060710
007870 DEL-RTN.                                                         I.060710
007880     MOVE SPACE TO HBHK-KEY.                                      I.060710
007890     MOVE W-NG TO HBHK-NG.                                        I.060710
007900     START HBHKF KEY NOT < HBHK-KEY INVALID KEY                   I.060710
007910         GO TO DEL-EX.                                            I.060710
007920 DEL-010.                                                         I.060710
007930     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
007940         GO TO DEL-EX.                                            I.060710
007950     IF W-NG NOT = HBHK-NG                                        I.060710
007960         GO TO DEL-EX.                                            I.060710
007970*
007980     DELETE HBHKF INVALID KEY                                     I.060710
007990         MOVE 1 TO W-END                                          I.060710
008000         DISPLAY E-ME6 E-KEY E-ME99                               I.060710
008010         GO TO DEL-EX.                                            I.060710
008020     GO TO DEL-010.                                               I.060710
008030 DEL-EX.                                                          I.060710
008040     EXIT.                                                        I.060710
