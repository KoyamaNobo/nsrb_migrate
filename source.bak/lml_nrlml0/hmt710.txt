000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMT710.
000030*********************************************************
000040*    PROGRAM         :  履物分類販売計画　入力　　　　　*
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHT71                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  0=入力 , 1=月次更新             *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT HKBM ASSIGN TO HKB-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY HKB-KEY
000210         FILE STATUS ERR-STAT.
000220     SELECT HBHKF ASSIGN TO HBHK-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE DYNAMIC
000250         RECORD KEY HBHK-KEY
000260         FILE STATUS IS ERR-STAT.
000270     SELECT HBUHF ASSIGN TO HBUH-MSD.
000280 I-O-CONTROL.
000290     APPLY SHARED-MODE ON M-DATE
000300     APPLY SHARED-MODE ON HKBM.
000310 DATA DIVISION.
000320 FILE SECTION.
000330     COPY LIBFDD.
000340     COPY LIHKBM.
000350 FD  HBHKF
000360*****BLOCK  8 RECORDS                                             D.060710
000370     BLOCK  6 RECORDS                                             I.060710
000380     LABEL RECORD IS STANDARD
000390     VALUE OF IDENTIFICATION "HBHKF".
000400 01  HBHK-R.
000410     02  HBHK-KEY.
000420       03  HBHK-NG      PIC  9(006).                              I.060710
000430       03  HBHK-BC.
000440*****    04  HBHK-BC1   PIC  9(002).                              D.031001
000450*****    04  HBHK-BC2.                                            D.031001
000460*****      05  HBHK-BC21 PIC  9(001).                             D.031001
000470*****      05  HBHK-BC22 PIC  9(001).                             D.031001
000480         04  HBHK-BC3   PIC  9(002).
000490*****    04  HBHK-BMN   PIC  9(002).                              D.060710
000500         04  HBHK-BMNO  PIC  9(001).                              I.021114
000510         04  HBHK-BC1   PIC  9(002).                              I.031001
000520*****  03  HBHK-NG      PIC  9(006).                              D.060710
000530*****02  HBHK-KIN       PIC S9(010).                              D.060710
000540     02  HBHK-BMN       PIC  9(002).                              I.060710
000550     02  HBHK-KKIN      PIC S9(010).                              I.060710
000560     02  HBHK-JKIN      PIC S9(010).                              I.060710
000570     02  F              PIC  X(009).                              I.060710
000580*****02  F              PIC  X(002).                              D.060710
000590*****02  HBHK-GP        PIC  9(004).                              D.060710
000600*****02  HBHK-STN       PIC  X(003).                              D.060710
000610*****02  F              PIC  X(007).                              D.030930
000620*****02  F              PIC  X(010).                              D.021114
000630 FD  HBUHF
000640     BLOCK  2 RECORDS
000650     LABEL RECORD IS STANDARD
000660     VALUE OF IDENTIFICATION WK0128ID.
000670 01  HBUH-R.
000680     02  HBUH-KEY.
000690       03  HBUH-BC1     PIC  9(002).
000700       03  HBUH-BC2.
000710         04  HBUH-BC21  PIC  9(001).
000720         04  HBUH-BC22  PIC  9(001).
000730       03  HBUH-BC3     PIC  9(002).
000740       03  HBUH-BMC     PIC  9(002).                              I.021114
000750       03  HBUH-BMNO    PIC  9(001).                              I.021114
000760     02  HBUH-ZS        PIC S9(007).
000770     02  HBUH-ZK        PIC S9(010).
000780     02  HBUH-NS        PIC S9(007).
000790     02  HBUH-NK        PIC S9(010).
000800     02  HBUH-SS        PIC S9(007).
000810     02  HBUH-SK        PIC S9(010).
000820     02  HBUH-YS        PIC S9(007).
000830     02  HBUH-YK        PIC S9(010).
000840     02  HBUH-UG        PIC S9(010).
000850     02  F              PIC  X(041).                              I.021114
000860*****02  F              PIC  X(044).                              D.021114
000870 WORKING-STORAGE SECTION.
000880 77  JS-SIGN            PIC  9(001).                              I.060710
000890 77  W-END              PIC  9(001) VALUE 0.
000900 77  WK0128ID           PIC  X(009) VALUE SPACE.
000910 01  STN-NO.
000920     02  STN-NO1        PIC  X(003).
000930     02  STN-NO2        PIC  X(003).
000940 01  W-FID.
000950     02  W-FID1         PIC  X(006) VALUE "WK0128".
000960     02  W-FID2         PIC  X(003).
000970 01  W-MDD.
000980*****02  W-MD    OCCURS 36.                                       D.030930
000990*****02  W-MD    OCCURS 38.                                       D.170619
001000     02  W-MD    OCCURS 57.                                       I.170619
001010       03  WM-TM        PIC  X(030).
001020       03  WM-MD    REDEFINES WM-TM.
001030         04  WM-M0      PIC  N(003).
001040*****    04  F          PIC  X(001).                              D.031001
001050         04  F          PIC  X(002).                              I.031001
001060         04  WM-M1      PIC  N(003).
001070*****    04  F          PIC  X(001).                              D.031001
001080         04  F          PIC  X(002).                              I.031001
001090         04  WM-M2      PIC  N(007).
001100       03  WM-HKK       PIC S9(010).
001110       03  WM-HGK       PIC S9(010).
001120       03  WM-TSR       PIC S9(003)V9(02).
001130       03  WM-BC.
001140*****    04  WM-BC1     PIC  9(002).                              D.031001
001150*****    04  WM-BC2     PIC  9(002).                              D.031001
001160         04  WM-BC3     PIC  9(002).
001170         04  WM-BMC     PIC  9(002).                              I.021114
001180         04  WM-BMNO    PIC  9(001).                              I.021114
001190         04  WM-BC1     PIC  9(002).                              I.031001
001200*****    04  WM-BC2     PIC  9(002).                              D.021114
001210*****    04  WM-BC1     PIC  9(002).                              D.021114
001220 01  W-DATA.
001230     02  W-L            PIC  9(002).
001240     02  W-C            PIC  9(002).
001250     02  W-CD           PIC  9(002).
001260     02  W-NGD          PIC  9(006).                              I.060710
001270     02  W-SNG          PIC  9(006).                              I.060710
001280     02  W-ENG          PIC  9(006).                              I.060710
001290     02  W-NGP.                                                   I.030626
001300       03  W-NG.                                                  I.030626
001310         04  W-NEN      PIC  9(004).                              I.030626
001320         04  W-NENL  REDEFINES W-NEN.                             I.030626
001330           05  W-NEN1   PIC  9(002).                              I.030626
001340           05  W-NEN2   PIC  9(002).                              I.030626
001350         04  W-GET      PIC  9(002).                              I.030626
001360       03  W-PEY        PIC  9(002).                              I.030626
001370     02  W-NGPL  REDEFINES W-NGP.                                 I.030626
001380       03  F            PIC  9(002).                              I.030626
001390       03  W-NGPS.                                                I.030626
001400         04  W-NGS      PIC  9(004).                              I.030626
001410         04  F          PIC  9(002).                              I.030626
001420*****02  W-NG.                                                    D.030626
001430*****  03  W-NEN        PIC  9(004).                              D.030626
001440*****  03  W-NENL  REDEFINES W-NEN.                               D.030626
001450*****    04  W-NEN1     PIC  9(002).                              D.030626
001460*****    04  W-NEN2     PIC  9(002).                              D.030626
001470*****  03  W-GET        PIC  9(002).                              D.030626
001480*****02  W-NGL   REDEFINES W-NG.                                  D.030626
001490*****  03  F            PIC  9(002).                              D.030626
001500*****  03  W-NGS        PIC  9(004).                              D.030626
001510     02  W-DMM          PIC  9(001).
001520*
001530     02  W-BC.
001540*****  03  W-BC1        PIC  9(002).                              D.031001
001550*****  03  W-BC2.                                                 D.031001
001560*****    04  W-BC21     PIC  9(001).                              D.031001
001570*****    04  W-BC22     PIC  9(001).                              D.031001
001580       03  W-BC3        PIC  9(002).
001590       03  W-BMC        PIC  9(002).                              I.021114
001600       03  W-BMNO       PIC  9(001).                              I.021114
001610       03  W-BC1        PIC  9(002).                              I.031001
001620     02  W-HKK          PIC S9(010).
001630     02  WA-D.
001640       03  WA-HKK       PIC S9(010).
001650       03  WA-HGK       PIC S9(010).
001660     02  CHK.
001670       03  CHK1         PIC  9(001).
001680       03  CHK2         PIC  9(001).
001690     02  W-PC           PIC  9(001).
001700     02  W-BTC          PIC  9(001) VALUE 0.
001710     02  W-BRN3         PIC  N(003).
001720     02  W-BMN          PIC  N(003).                              I.021114
001730*****02  W-BRN22        PIC  N(003).                              D.021114
001740     02  W-TSR          PIC S9(003)V9(02).
001750     02  W-TM           PIC  X(030) VALUE
001760          "　　　　【　合　計　】　　　　".
001770     02  W-NGPD.
001780       03  F            PIC  9(002).                              I.030930
001790       03  W-GPD        PIC  9(004).                              I.030930
001800 01  ERR-STAT           PIC  X(002).
001810     COPY LSTAT.
001820 SCREEN SECTION.
001830 SD  C-CRT
001840     END STATUS IS ESTAT.
001850 01  C-CLEAR.
001860     02  LINE   1  CLEAR SCREEN.
001870 01  C-MID.                                                       I.060710
001880     02  LINE   3  COLUMN  10  PIC  N(023) VALUE                  I.060710
001890          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
001900     02  LINE   4  COLUMN  10  PIC  N(023) VALUE                  I.060710
001910          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
001920     02  LINE   5  COLUMN  10  PIC  N(023) VALUE                  I.060710
001930          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.060710
001940     02  LINE   6  COLUMN  10  PIC  N(023) VALUE                  I.060710
001950          NC"＊＊＊　　履物分類販売計画　実績更新　　＊＊＊".     I.060710
001960     02  LINE   7  COLUMN  10  PIC  N(023) VALUE                  I.060710
001970          NC"＊＊＊　　　　　　　　　　　　　　　　　＊＊＊".     I.060710
001980     02  LINE   8  COLUMN  10  PIC  N(023) VALUE                  I.060710
001990          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
002000     02  LINE   9  COLUMN  10  PIC  N(023) VALUE                  I.060710
002010          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".     I.060710
002020 01  C-ACP.
002030     02  LINE   1.                                                I.060710
002040       03  A-NEN2  COLUMN  60  PIC  9(002)                        I.060710
002050            USING W-NEN2  CHECK OVERFLOW NO IFC.                  I.060710
002060       03  A-GET   COLUMN  64  PIC  9(002)                        I.060710
002070            USING W-GET   CHECK OVERFLOW NO IFC.                  I.060710
002080     02  A-HKK    LINE W-L  COLUMN  41  PIC S9(009)
002090          USING WM-HKK(W-C) CHECK OVERFLOW NO IFC.
002100     02  A-DMM    LINE  23  COLUMN  67  PIC  9(001)
002110          USING W-DMM   CHECK OVERFLOW NO IFC.
002120 01  C-DSP.
002130*****02  D-NGP   LINE   2.                                        D.030930
002140     02  D-NGP   LINE   1.                                        I.030930
002150       03  COLUMN  60  PIC  9(002) FROM  W-NEN2.                  I.030626
002160       03  COLUMN  64  PIC  Z(002) FROM  W-GET.                   I.030626
002170       03  COLUMN  68  PIC  Z(002) FROM  W-PEY.                   I.030626
002180*****02  D-NG    LINE   2.                                        D.030626
002190*****  03  COLUMN  62  PIC  9(002) FROM  W-NEN2.                  D.030626
002200*****  03  COLUMN  66  PIC  Z(002) FROM  W-GET.                   D.030626
002210     02  LINE W-L.
002220       03  D-MD.
002230         04  COLUMN   8  PIC  X(030)       FROM  WM-TM(W-C).
002240         04  COLUMN  41  PIC ZZZZZZZZ9-    FROM  WM-HKK(W-C).
002250         04  COLUMN  52  PIC ZZZ,ZZZ,ZZ9-  FROM  WM-HGK(W-C).
002260         04  COLUMN  65  PIC ZZ9.99-       FROM  WM-TSR(W-C).
002270       03  D-MIDE.
002280         04  COLUMN   8  PIC  X(030)       FROM  W-TM.
002290         04  COLUMN  41  PIC ZZZZZZZZ9-    FROM  WA-HKK.
002300         04  COLUMN  52  PIC ZZZ,ZZZ,ZZ9-  FROM  WA-HGK.
002310         04  COLUMN  65  PIC ZZ9.99-       FROM  W-TSR.
002320 01  C-ERR.
002330     02  LINE 24.
002340       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
002350       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
002360            "***  DATA ﾅｼ  ***".
002370       03  E-ME2   COLUMN  15  PIC  X(026) VALUE
002380            "***  ﾌﾞﾝﾙｲ ｶﾞ 57ｦ ｺｴﾀ  ***".                         I.170619
002390*****       "***  ﾌﾞﾝﾙｲ ｶﾞ 38ｦ ｺｴﾀ  ***".                         D.170619
002400*****       "***  ﾌﾞﾝﾙｲ ｶﾞ 36ｦ ｺｴﾀ  ***".                         D.030930
002410       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
002420            "***  DATA ｴﾗｰ  ***".
002430       03  E-ME4   COLUMN  15  PIC  X(025) VALUE
002440            "***  HBHKF WRITE ｴﾗｰ  ***".
002450       03  E-ME5   COLUMN  15  PIC  X(027) VALUE
002460            "***  HBHKF REWRITE ｴﾗｰ  ***".
002470       03  E-ME6   COLUMN  15  PIC  X(026) VALUE                  I.060710
002480            "***  HBHKF DELETE ｴﾗｰ  ***".                         I.060710
002490       03  E-KEY   COLUMN  50  PIC  X(011) FROM  HBHK-KEY.        I.060710
002500       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
002510       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
002520     COPY LIBSCR.
002530 PROCEDURE DIVISION.
002540 M-05.
002550     ACCEPT JS-SIGN.                                              I.060710
002560     IF JS-SIGN > 1                                               I.060710
002570         STOP RUN.                                                I.060710
002580     COPY LIBCPR.
002590     DISPLAY C-CLEAR.
002600     IF JS-SIGN = 1                                               I.060710
002610         DISPLAY C-MID                                            I.060710
002620       ELSE                                                       I.060710
002630         CALL "SCHT71".
002640*****MOVE ZERO TO W-NG.                                           D.030626
002650     MOVE ZERO TO W-NGP.                                          I.030626
002660     IF D-HSD NOT = ZERO                                          I.030626
002670         MOVE D-HSD TO W-NGPS                                     I.030626
002680       ELSE                                                       I.030626
002690         MOVE D-NHNG TO W-NGS.
002700     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
002710         ADD DATE-NC1 TO W-NEN.
002720     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
002730         ADD DATE-NC2 TO W-NEN.
002740     MOVE W-NG TO W-NGD.                                          I.060710
002750     IF JS-SIGN = 1                                               I.060710
002760         GO TO M-17.                                              I.060710
002770     DISPLAY D-NGP.                                               I.030626
002780     IF W-GET > 3                                                 I.060710
002790         ADD 1 TO W-NEN.                                          I.060710
002800     MOVE 4 TO W-GET.                                             I.060710
002810     MOVE W-NG TO W-ENG.                                          I.060710
002820     MOVE W-NGD TO W-NG.                                          I.060710
002830     IF W-GET < 6                                                 I.060710
002840         SUBTRACT 1 FROM W-NEN.                                   I.060710
002850     MOVE 5 TO W-GET.                                             I.060710
002860     MOVE W-NG TO W-SNG.                                          I.060710
002870*****DISPLAY D-NG.                                                D.030626
002880 M-10.                                                            I.060710
002890     ACCEPT A-NEN2.                                               I.060710
002900     IF ESTAT = PF9                                               I.060710
002910         GO TO M-95.                                              I.060710
002920     IF ESTAT NOT = HTB AND SKP                                   I.060710
002930         GO TO M-10.                                              I.060710
002940     MOVE ZERO TO W-NEN1.                                         I.060710
002950     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.060710
002960         ADD DATE-NC1 TO W-NEN.                                   I.060710
002970     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.060710
002980         ADD DATE-NC2 TO W-NEN.                                   I.060710
002990 M-15.                                                            I.060710
003000     ACCEPT A-GET.                                                I.060710
003010     IF ESTAT = BTB                                               I.060710
003020         GO TO M-10.                                              I.060710
003030     IF ESTAT NOT = HTB AND SKP                                   I.060710
003040         GO TO M-15.                                              I.060710
003050     IF W-GET < 1 OR > 12                                         I.060710
003060         GO TO M-15.                                              I.060710
003070     IF W-NG < W-SNG OR > W-ENG                                   I.060710
003080         GO TO M-10.                                              I.060710
003090 M-17.                                                            I.060710
003100     MOVE ZERO TO W-C.
003110 M-20.
003120     ADD 1 TO W-C.
003130*****IF W-C NOT = 37                                              D.030930
003140*****IF W-C NOT = 39                                              D.170619
003150     IF W-C NOT = 58                                              I.170619
003160         INITIALIZE W-MD(W-C)
003170         GO TO M-20.
003180*
003190     IF W-NG >= W-NGD                                             I.060710
003200         PERFORM SET1-RTN THRU SET1-EX                            I.060710
003210       ELSE                                                       I.060710
003220         PERFORM SET2-RTN THRU SET2-EX.                           I.060710
003230     IF W-END = 1                                                 I.060710
003240         GO TO M-95.                                              I.060710
003250*****CALL "CBLSTNNO" USING STN-NO.                                D.060710
003260*****MOVE STN-NO2 TO W-FID2.                                      D.060710
003270*****MOVE W-FID TO WK0128ID.                                      D.060710
003280*****OPEN INPUT HBUHF.                                            D.060710
003290*M-21.                                                            D.060710
003300*****READ HBUHF AT END                                            D.060710
003310*****    CLOSE HBUHF                                              D.060710
003320*****    DISPLAY E-ME1 E-ME99                                     D.060710
003330*****    GO TO M-95.                                              D.060710
003340*****IF HBUH-ZS = ZERO                                            D.001102
003350*****IF ZERO = HBUH-ZS AND HBUH-NS AND HBUH-SS AND HBUH-YS        D.030122
003360*****    GO TO M-21.                                              D.030122
003370*
003380*****OPEN INPUT HBHKF.                                            D.060710
003390*****OPEN INPUT HKBM.                                             D.060710
003400*
003410*****MOVE ZERO TO WA-D W-C.                                       D.060710
003420*M-22.                                                            D.060710
003430*****MOVE HBUH-BC3 TO W-BC3.                                      D.060710
003440*****MOVE ZERO TO CHK.                                            D.060710
003450*
003460*****MOVE SPACE TO HKB-KEY.                                       D.060710
003470*****MOVE "14" TO HKB-NO.                                         D.060710
003480*****MOVE W-BC3 TO HKB-BR3.                                       D.060710
003490*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003500*****    MOVE SPACE TO HKB-BRN3.                                  D.060710
003510*****MOVE HKB-BRN3 TO W-BRN3.                                     D.060710
003520*M-23.                                                            D.060710
003530*****MOVE HBUH-BC2 TO W-BC2.                                      D.031001
003540*****MOVE HBUH-BMC TO W-BMC.                                      D.060710
003550*****MOVE HBUH-BMNO TO W-BMNO.                                    D.060710
003560*****MOVE ZERO TO CHK2.                                           D.060710
003570*
003580*****MOVE SPACE TO HKB-KEY.                                       D.060710
003590*****MOVE "13" TO HKB-NO.                                         D.021114
003600*****MOVE W-BC22 TO HKB-BR22.                                     D.021114
003610*****MOVE "16" TO HKB-NO.                                         D.060710
003620*****MOVE W-BMC TO HKB-BMC.                                       D.060710
003630*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003640*****    MOVE SPACE TO HKB-BMN.                                   D.060710
003650*****MOVE HKB-BMN TO W-BMN.                                       D.060710
003660*****    MOVE SPACE TO HKB-BRN22.                                 D.021114
003670*****MOVE HKB-BRN22 TO W-BRN22.                                   D.021114
003680*M-24.                                                            D.060710
003690*****ADD 1 TO W-C.                                                D.060710
003700*****IF W-C > 36                                                  D.030930
003710*****IF W-C > 38                                                  D.060710
003720*****    CLOSE HBUHF                                              D.060710
003730*****    CLOSE HBHKF                                              D.060710
003740*****    CLOSE HKBM                                               D.060710
003750*****    DISPLAY E-ME2 E-ME99                                     D.060710
003760*****    GO TO M-95.                                              D.060710
003770*****IF CHK1 = 0                                                  D.060710
003780*****    MOVE 1 TO CHK1                                           D.060710
003790*****    MOVE W-BRN3 TO WM-M0(W-C).                               D.060710
003800*****IF CHK2 = 0                                                  D.060710
003810*****    MOVE 1 TO CHK2                                           D.060710
003820*****    MOVE W-BMN TO WM-M1(W-C).                                D.060710
003830*****    MOVE W-BRN22 TO WM-M1(W-C).                              D.021114
003840*
003850*****MOVE HBUH-BC1 TO W-BC1.                                      D.060710
003860*****MOVE SPACE TO HKB-KEY.                                       D.060710
003870*****MOVE "11" TO HKB-NO.                                         D.060710
003880*****MOVE HBUH-BC1 TO HKB-BR1.                                    D.060710
003890*****READ HKBM WITH UNLOCK INVALID KEY                            D.060710
003900*****    MOVE SPACE TO HKB-BRN1.                                  D.060710
003910*****MOVE HKB-BRN1 TO WM-M2(W-C).                                 D.060710
003920*
003930*****MOVE HBUH-KEY TO WM-BC(W-C).                                 D.031001
003940*****MOVE HBUH-BC3 TO WM-BC3(W-C).                                D.060710
003950*****MOVE HBUH-BMC TO WM-BMC(W-C).                                D.060710
003960*****MOVE HBUH-BMNO TO WM-BMNO(W-C).                              D.060710
003970*****MOVE HBUH-BC1 TO WM-BC1(W-C).                                D.060710
003980*****MOVE HBUH-SK TO WM-HGK(W-C).                                 D.060710
003990*
004000*****ADD HBUH-SK TO WA-HGK.                                       D.060710
004010*
004020*****MOVE HBUH-KEY TO HBHK-BC.                                    D.031001
004030*****MOVE HBUH-BC3 TO HBHK-BC3.                                   D.060710
004040*****MOVE HBUH-BMC TO HBHK-BMN.                                   D.060710
004050*****MOVE HBUH-BMNO TO HBHK-BMNO.                                 D.060710
004060*****MOVE HBUH-BC1 TO HBHK-BC1.                                   D.060710
004070*****MOVE W-NG TO HBHK-NG.                                        D.060710
004080*****READ HBHKF WITH UNLOCK INVALID KEY                           D.060710
004090*****    GO TO M-26.                                              D.060710
004100*****MOVE HBHK-KIN TO WM-HKK(W-C).                                D.060710
004110*
004120*****ADD HBHK-KIN TO WA-HKK.                                      D.060710
004130*M-26.                                                            D.060710
004140*****READ HBUHF AT END                                            D.060710
004150*****    GO TO M-27.                                              D.060710
004160*****IF HBUH-ZS = ZERO                                            D.001102
004170*****IF ZERO = HBUH-ZS AND HBUH-NS AND HBUH-SS AND HBUH-YS        D.030122
004180*****    GO TO M-26.                                              D.030122
004190*****IF W-BC3 NOT = HBUH-BC3                                      D.060710
004200*****    GO TO M-22.                                              D.060710
004210*****IF W-BC22 = HBUH-BC22                                        D.021114
004220*****IF W-BMC = HBUH-BMC                                          D.060710
004230*****    GO TO M-24.                                              D.060710
004240*****GO TO M-23.                                                  D.060710
004250*M-27.                                                            D.060710
004260*****CLOSE HBUHF.                                                 D.060710
004270*****CLOSE HBHKF.                                                 D.060710
004280*****CLOSE HKBM.                                                  D.060710
004290     MOVE W-C TO W-CD.
004300     IF JS-SIGN = 1                                               I.060710
004310         GO TO M-67.                                              I.060710
004320     MOVE 1 TO W-PC.
004330 M-30.
004340     DISPLAY C-CLEAR.
004350     CALL "SCHT71".
004360     DISPLAY D-NGP.                                               I.030626
004370*****DISPLAY D-NG.                                                D.030626
004380*****MOVE 3 TO W-L.                                               D.030930
004390     MOVE 2 TO W-L.                                               I.030930
004400     IF W-PC = 1
004410         MOVE ZERO TO W-C
004420       ELSE
004430         IF W-PC = 2
004440             MOVE 20 TO W-C                                       I.170619
004450           ELSE
004460             MOVE 40 TO W-C.                                      I.170619
004470*****    MOVE 20 TO W-C.                                          D.170619
004480*****    MOVE 19 TO W-C.                                          D.030930
004490 M-35.
004500     ADD 1 TO W-C W-L.
004510*****IF (W-CD < W-C) OR (W-C = 37)                                D.030930
004520*****IF (W-CD < W-C) OR (W-C = 39)                                D.170619
004530     IF (W-CD < W-C) OR (W-C = 58)                                I.170619
004540         GO TO M-40.
004550     IF W-PC = 1
004560*****    IF W-C = 20                                              D.030930
004570         IF W-C = 21                                              I.030930
004580             GO TO M-45.
004590     IF W-PC = 2                                                  I.170619
004600         IF W-C = 41                                              I.170619
004610             GO TO M-45.                                          I.170619
004620*
004630     MOVE ZERO TO WM-TSR(W-C).
004640     IF WM-HKK(W-C) NOT = ZERO
004650         COMPUTE WM-TSR(W-C) ROUNDED =
004660                            (WM-HGK(W-C) / WM-HKK(W-C)) * 100.
004670     DISPLAY D-MD.
004680     GO TO M-35.
004690 M-40.
004700     MOVE ZERO TO W-TSR.
004710     IF WA-HKK NOT = ZERO
004720         COMPUTE W-TSR ROUNDED = (WA-HGK / WA-HKK) * 100.
004730     DISPLAY D-MIDE.
004740 M-45.
004750*****IF W-BTC = 2                                                 D.170619
004760     IF W-BTC = 3                                                 I.170619
004770         GO TO M-55.
004780     IF W-BTC = 1
004790         MOVE 21 TO W-L
004800         MOVE 19 TO W-C                                           I.030930
004810*****    MOVE 18 TO W-C                                           D.030930
004820         GO TO M-50.
004830     IF W-BTC = 2                                                 I.170619
004840         MOVE 21 TO W-L                                           I.170619
004850         MOVE 39 TO W-C                                           I.170619
004860         GO TO M-50.                                              I.170619
004870*****MOVE 3 TO W-L.                                               D.030930
004880     MOVE 2 TO W-L.                                               I.030930
004890     IF W-PC = 1
004900         MOVE ZERO TO W-C
004910       ELSE
004920         IF W-PC = 2                                              I.170619
004930             MOVE 20 TO W-C                                       I.170619
004940           ELSE                                                   I.170619
004950             MOVE 40 TO W-C.                                      I.170619
004960*****    MOVE 20 TO W-C.                                          D.170619
004970*****    MOVE 19 TO W-C.                                          D.030930
004980 M-50.
004990     ADD 1 TO W-C W-L.
005000*****IF (W-CD < W-C) OR (W-C = 37)                                D.030930
005010*****IF (W-CD < W-C) OR (W-C = 39)                                D.170619
005020     IF (W-CD < W-C) OR (W-C = 58)                                I.170619
005030         GO TO M-60.
005040     IF W-PC = 1
005050*****    IF W-C = 20                                              D.030930
005060         IF W-C = 21                                              I.030930
005070             MOVE 2 TO W-PC
005080             IF W-CD >= W-C
005090                 GO TO M-30
005100               ELSE
005110                 GO TO M-65.
005120     IF W-PC = 2                                                  I.170619
005130         IF W-C = 41                                              I.170619
005140             MOVE 3 TO W-PC                                       I.170619
005150             IF W-CD >= W-C                                       I.170619
005160                 GO TO M-30                                       I.170619
005170               ELSE                                               I.170619
005180                 GO TO M-65.                                      I.170619
005190 M-55.
005200     MOVE 0 TO W-BTC.
005210     SUBTRACT WM-HKK(W-C) FROM WA-HKK.
005220     MOVE WM-HKK(W-C) TO W-HKK.
005230     ACCEPT A-HKK.
005240     ADD WM-HKK(W-C) TO WA-HKK.
005250     IF ESTAT = PF9
005260         GO TO M-95.                                              I.030729
005270*****    MOVE W-HKK TO WM-HKK(W-C)                                D.030729
005280*****    DISPLAY D-MD                                             D.030729
005290*****    GO TO M-65.                                              D.030729
005300     IF ESTAT NOT = BTB                                           I.170619
005310         GO TO M-57.                                              I.170619
005320     SUBTRACT 1 FROM W-C W-L.                                     I.170619
005330     IF W-C = 0                                                   I.170619
005340         GO TO M-45.                                              I.170619
005350     IF W-C NOT = 20 AND 40                                       I.170619
005360         GO TO M-55.                                              I.170619
005370     IF W-C = 20                                                  I.170619
005380         MOVE 1 TO W-PC W-BTC.                                    I.170619
005390     IF W-C = 40                                                  I.170619
005400         MOVE 2 TO W-PC W-BTC.                                    I.170619
005410*****IF ESTAT = BTB                                               D.170619
005420*****    SUBTRACT 1 FROM W-C W-L                                  D.170619
005430*****    IF W-C = 0                                               D.170619
005440*****        GO TO M-45                                           D.170619
005450*****      ELSE                                                   D.170619
005460*****        IF W-C NOT = 19                                      D.030930
005470*****        IF W-C NOT = 20                                      D.170619
005480*****            GO TO M-55                                       D.170619
005490*****          ELSE                                               D.170619
005500*****            MOVE 1 TO W-PC W-BTC                             D.170619
005510     IF W-CD >= W-C
005520         GO TO M-30
005530       ELSE
005540         GO TO M-65.
005550 M-57.                                                            I.170619
005560     IF ESTAT NOT = HTB AND SKP
005570         GO TO M-55.
005580     MOVE ZERO TO WM-TSR(W-C).
005590     IF WM-HKK(W-C) NOT = ZERO
005600         COMPUTE WM-TSR(W-C) ROUNDED =
005610                            (WM-HGK(W-C) / WM-HKK(W-C)) * 100.
005620     DISPLAY D-MD.
005630     GO TO M-50.
005640 M-60.
005650     MOVE ZERO TO W-TSR.
005660     IF WA-HKK NOT = ZERO
005670         COMPUTE W-TSR ROUNDED = (WA-HGK / WA-HKK) * 100.
005680     DISPLAY D-MIDE.
005690     IF W-CD >= W-C
005700         GO TO M-30.
005710 M-65.
005720     ACCEPT A-DMM.
005730     IF ESTAT = BTB
005740         SUBTRACT 1 FROM W-C W-L
005750*****    MOVE 2 TO W-BTC                                          D.170619
005760         MOVE 3 TO W-BTC                                          I.170619
005770         GO TO M-45.
005780     IF ESTAT NOT = HTB AND SKP
005790         GO TO M-65.
005800     IF W-DMM = 9
005810         GO TO M-95.                                              I.030729
005820*****    MOVE 1 TO W-PC                                           D.030729
005830*****    GO TO M-30.                                              D.030729
005840     IF W-DMM NOT = 1
005850         GO TO M-65.
005860 M-67.                                                            I.060710
005870     ACCEPT W-NGPD FROM DATE.                                     I.030930
005880     OPEN I-O HBHKF.
005890     IF W-NG >= W-NGD                                             I.060710
005900         PERFORM DEL-RTN THRU DEL-EX.                             I.060710
005910     IF W-END = 1                                                 I.060710
005920         GO TO M-80.                                              I.060710
005930     MOVE ZERO TO W-C.
005940 M-70.
005950     ADD 1 TO W-C.
005960     IF W-CD < W-C
005970         GO TO M-80.
005980     IF WM-BC(W-C) = ZERO
005990         GO TO M-70.
006000     IF W-NG >= W-NGD
006010         GO TO M-75.
006020*****MOVE WM-BC(W-C) TO HBHK-BC.                                  D.060710
006030     MOVE W-NG TO HBHK-NG.
006040     MOVE WM-BC3(W-C) TO HBHK-BC3.                                I.060710
006050     MOVE WM-BMNO(W-C) TO HBHK-BMNO.                              I.060710
006060     MOVE WM-BC1(W-C) TO HBHK-BC1.                                I.060710
006070     READ HBHKF INVALID KEY
006080         DISPLAY E-ME3 E-KEY E-ME99                               I.060710
006090         GO TO M-80.
006100*****MOVE WM-HKK(W-C) TO HBHK-KIN.                                D.060710
006110     MOVE WM-HKK(W-C) TO HBHK-KKIN.                               I.060710
006120     MOVE WM-HGK(W-C) TO HBHK-JKIN.                               I.060710
006130*****MOVE W-GPD TO HBHK-GP.                                       D.060710
006140*****MOVE STN-NO2 TO HBHK-STN.                                    D.060710
006150     REWRITE HBHK-R INVALID KEY
006160         DISPLAY E-STAT E-ME5 E-KEY E-ME99                        I.060710
006170*****    DISPLAY E-STAT E-ME5 E-ME99                              D.060710
006180         GO TO M-80.
006190     GO TO M-70.
006200 M-75.
006210     INITIALIZE HBHK-R.
006220*****MOVE WM-BC(W-C) TO HBHK-BC.                                  D.060710
006230     MOVE W-NG TO HBHK-NG.
006240     MOVE WM-BC3(W-C) TO HBHK-BC3.                                I.060710
006250     MOVE WM-BMNO(W-C) TO HBHK-BMNO.                              I.060710
006260     MOVE WM-BC1(W-C) TO HBHK-BC1.                                I.060710
006270     MOVE WM-BMC(W-C) TO HBHK-BMN.                                I.060710
006280*****MOVE WM-HKK(W-C) TO HBHK-KIN.                                D.060710
006290     MOVE WM-HKK(W-C) TO HBHK-KKIN.                               I.060710
006300     MOVE WM-HGK(W-C) TO HBHK-JKIN.                               I.060710
006310*****MOVE W-GPD TO HBHK-GP.                                       D.060710
006320*****MOVE STN-NO2 TO HBHK-STN.                                    D.060710
006330     WRITE HBHK-R INVALID KEY
006340         DISPLAY E-STAT E-ME4 E-KEY E-ME99                        I.060710
006350*****    DISPLAY E-STAT E-ME4 E-ME99                              D.060710
006360         GO TO M-80.
006370     GO TO M-70.
006380 M-80.
006390     CLOSE HBHKF.
006400     IF JS-SIGN = 0                                               I.060710
006410         GO TO M-10.                                              I.060710
006420 M-95.
006430     DISPLAY C-CLEAR.
006440     STOP RUN.
006450 SET1-RTN.                                                        I.060710
006460     CALL "CBLSTNNO" USING STN-NO.                                I.060710
006470     MOVE STN-NO2 TO W-FID2.                                      I.060710
006480     MOVE W-FID TO WK0128ID.                                      I.060710
006490     OPEN INPUT HBUHF.                                            I.060710
006500*
006510     READ HBUHF AT END                                            I.060710
006520         CLOSE HBUHF                                              I.060710
006530         MOVE 1 TO W-END                                          I.060710
006540         DISPLAY E-ME1 E-ME99                                     I.060710
006550         GO TO SET1-EX.                                           I.060710
006560*                                                                 I.060710
006570     OPEN INPUT HBHKF.                                            I.060710
006580     OPEN INPUT HKBM.                                             I.060710
006590*
006600     MOVE ZERO TO WA-D W-C.                                       I.060710
006610 SET1-010.                                                        I.060710
006620     MOVE HBUH-BC3 TO W-BC3.                                      I.060710
006630     MOVE ZERO TO CHK.                                            I.060710
006640*
006650     MOVE SPACE TO HKB-KEY.                                       I.060710
006660     MOVE "14" TO HKB-NO.                                         I.060710
006670     MOVE W-BC3 TO HKB-BR3.                                       I.060710
006680     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
006690         MOVE SPACE TO HKB-BRN3.                                  I.060710
006700     MOVE HKB-BRN3 TO W-BRN3.                                     I.060710
006710 SET1-020.                                                        I.060710
006720     MOVE HBUH-BMC TO W-BMC.                                      I.060710
006730     MOVE HBUH-BMNO TO W-BMNO.                                    I.060710
006740     MOVE ZERO TO CHK2.                                           I.060710
006750*
006760     MOVE SPACE TO HKB-KEY.                                       I.060710
006770     MOVE "16" TO HKB-NO.                                         I.060710
006780     MOVE W-BMC TO HKB-BMC.                                       I.060710
006790     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
006800         MOVE SPACE TO HKB-BMN.                                   I.060710
006810     MOVE HKB-BMN TO W-BMN.                                       I.060710
006820 SET1-030.                                                        I.060710
006830     ADD 1 TO W-C.                                                I.060710
006840*****IF W-C > 38                                                  D.170619
006850     IF W-C > 57                                                  I.170619
006860         CLOSE HBUHF                                              I.060710
006870         CLOSE HBHKF                                              I.060710
006880         CLOSE HKBM                                               I.060710
006890         MOVE 1 TO W-END                                          I.060710
006900         DISPLAY E-ME2 E-ME99                                     I.060710
006910         GO TO SET1-EX.                                           I.060710
006920     IF CHK1 = 0                                                  I.060710
006930         MOVE 1 TO CHK1                                           I.060710
006940         MOVE W-BRN3 TO WM-M0(W-C).                               I.060710
006950     IF CHK2 = 0                                                  I.060710
006960         MOVE 1 TO CHK2                                           I.060710
006970         MOVE W-BMN TO WM-M1(W-C).                                I.060710
006980*
006990     MOVE HBUH-BC1 TO W-BC1.                                      I.060710
007000     MOVE SPACE TO HKB-KEY.                                       I.060710
007010     MOVE "11" TO HKB-NO.                                         I.060710
007020     MOVE HBUH-BC1 TO HKB-BR1.                                    I.060710
007030     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007040         MOVE SPACE TO HKB-BRN1.                                  I.060710
007050     MOVE HKB-BRN1 TO WM-M2(W-C).                                 I.060710
007060 SET1-035.                                                        I.060710
007070     MOVE HBUH-BC3 TO WM-BC3(W-C).                                I.060710
007080     MOVE HBUH-BMC TO WM-BMC(W-C).                                I.060710
007090     MOVE HBUH-BMNO TO WM-BMNO(W-C).                              I.060710
007100     MOVE HBUH-BC1 TO WM-BC1(W-C).                                I.060710
007110     IF W-NG = W-NGD                                              I.060710
007120         MOVE HBUH-SK TO WM-HGK(W-C)                              I.060710
007130         ADD HBUH-SK TO WA-HGK.                                   I.060710
007140*
007150     MOVE W-NG TO HBHK-NG.                                        I.060710
007160     MOVE HBUH-BC3 TO HBHK-BC3.                                   I.060710
007170     MOVE HBUH-BMC TO HBHK-BMN.                                   I.060710
007180     MOVE HBUH-BMNO TO HBHK-BMNO.                                 I.060710
007190     MOVE HBUH-BC1 TO HBHK-BC1.                                   I.060710
007200     READ HBHKF WITH UNLOCK INVALID KEY                           I.060710
007210         GO TO SET1-040.                                          I.060710
007220     MOVE HBHK-KKIN TO WM-HKK(W-C).                               I.060710
007230*
007240     ADD HBHK-KKIN TO WA-HKK.                                     I.060710
007250 SET1-040.                                                        I.060710
007260     READ HBUHF AT END                                            I.060710
007270         GO TO SET1-050.                                          I.060710
007280     IF W-BC3 NOT = HBUH-BC3                                      I.060710
007290         GO TO SET1-010.                                          I.060710
007300     IF W-BMC = HBUH-BMC                                          I.060710
007310         GO TO SET1-030.                                          I.060710
007320     GO TO SET1-020.                                              I.060710
007330 SET1-050.                                                        I.060710
007340     CLOSE HBUHF.                                                 I.060710
007350     CLOSE HBHKF.                                                 I.060710
007360     CLOSE HKBM.                                                  I.060710
007370 SET1-EX.                                                         I.060710
007380     EXIT.                                                        I.060710
007390 SET2-RTN.                                                        I.060710
007400     OPEN INPUT HBHKF.                                            I.060710
007410     MOVE SPACE TO HBHK-KEY.                                      I.060710
007420     MOVE W-NG TO HBHK-NG.                                        I.060710
007430     START HBHKF KEY NOT < HBHK-KEY INVALID KEY                   I.060710
007440         CLOSE HBHKF                                              I.060710
007450         MOVE 1 TO W-END                                          I.060710
007460         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007470         GO TO SET2-EX.                                           I.060710
007480     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
007490         CLOSE HBHKF                                              I.060710
007500         MOVE 1 TO W-END                                          I.060710
007510         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007520         GO TO SET2-EX.                                           I.060710
007530     IF W-NG NOT = HBHK-NG                                        I.060710
007540         CLOSE HBHKF                                              I.060710
007550         MOVE 1 TO W-END                                          I.060710
007560         DISPLAY E-ME1 E-KEY E-ME99                               I.060710
007570         GO TO SET2-EX.                                           I.060710
007580*
007590     OPEN INPUT HKBM.                                             I.060710
007600*
007610     MOVE ZERO TO WA-D W-C.                                       I.060710
007620 SET2-010.                                                        I.060710
007630     MOVE HBHK-BC3 TO W-BC3.                                      I.060710
007640     MOVE ZERO TO CHK.                                            I.060710
007650*
007660     MOVE SPACE TO HKB-KEY.                                       I.060710
007670     MOVE "14" TO HKB-NO.                                         I.060710
007680     MOVE W-BC3 TO HKB-BR3.                                       I.060710
007690     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007700         MOVE SPACE TO HKB-BRN3.                                  I.060710
007710     MOVE HKB-BRN3 TO W-BRN3.                                     I.060710
007720 SET2-020.                                                        I.060710
007730     MOVE HBHK-BMN TO W-BMC.                                      I.060710
007740     MOVE HBHK-BMNO TO W-BMNO.                                    I.060710
007750     MOVE ZERO TO CHK2.                                           I.060710
007760*
007770     MOVE SPACE TO HKB-KEY.                                       I.060710
007780     MOVE "16" TO HKB-NO.                                         I.060710
007790     MOVE W-BMC TO HKB-BMC.                                       I.060710
007800     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
007810         MOVE SPACE TO HKB-BMN.                                   I.060710
007820     MOVE HKB-BMN TO W-BMN.                                       I.060710
007830 SET2-030.                                                        I.060710
007840     ADD 1 TO W-C.                                                I.060710
007850*****IF W-C > 38                                                  D.170619
007860     IF W-C > 57                                                  I.170619
007870         CLOSE HBHKF                                              I.060710
007880         CLOSE HKBM                                               I.060710
007890         MOVE 1 TO W-END                                          I.060710
007900         DISPLAY E-ME2 E-ME99                                     I.060710
007910         GO TO SET2-EX.                                           I.060710
007920     IF CHK1 = 0                                                  I.060710
007930         MOVE 1 TO CHK1                                           I.060710
007940         MOVE W-BRN3 TO WM-M0(W-C).                               I.060710
007950     IF CHK2 = 0                                                  I.060710
007960         MOVE 1 TO CHK2                                           I.060710
007970         MOVE W-BMN TO WM-M1(W-C).                                I.060710
007980*
007990     MOVE HBHK-BC1 TO W-BC1.                                      I.060710
008000     MOVE SPACE TO HKB-KEY.                                       I.060710
008010     MOVE "11" TO HKB-NO.                                         I.060710
008020     MOVE HBHK-BC1 TO HKB-BR1.                                    I.060710
008030     READ HKBM WITH UNLOCK INVALID KEY                            I.060710
008040         MOVE SPACE TO HKB-BRN1.                                  I.060710
008050     MOVE HKB-BRN1 TO WM-M2(W-C).                                 I.060710
008060*
008070     MOVE HBHK-BC3 TO WM-BC3(W-C).                                I.060710
008080     MOVE HBHK-BMN TO WM-BMC(W-C).                                I.060710
008090     MOVE HBHK-BMNO TO WM-BMNO(W-C).                              I.060710
008100     MOVE HBHK-BC1 TO WM-BC1(W-C).                                I.060710
008110     MOVE HBHK-KKIN TO WM-HKK(W-C).                               I.060710
008120     MOVE HBHK-JKIN TO WM-HGK(W-C)                                I.060710
008130     ADD HBHK-KKIN TO WA-HKK.                                     I.060710
008140     ADD HBHK-JKIN TO WA-HGK.                                     I.060710
008150 SET2-040.                                                        I.060710
008160     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
008170         GO TO SET2-050.                                          I.060710
008180     IF W-NG NOT = HBHK-NG                                        I.060710
008190         GO TO SET2-050.                                          I.060710
008200     IF W-BC3 NOT = HBHK-BC3                                      I.060710
008210         GO TO SET2-010.                                          I.060710
008220     IF W-BMC = HBHK-BMN                                          I.060710
008230         GO TO SET2-030.                                          I.060710
008240     GO TO SET2-020.                                              I.060710
008250 SET2-050.                                                        I.060710
008260     CLOSE HBHKF.                                                 I.060710
008270     CLOSE HKBM.                                                  I.060710
008280 SET2-EX.                                                         I.060710
008290     EXIT.                                                        I.060710
008300 DEL-RTN.                                                         I.060710
008310     MOVE SPACE TO HBHK-KEY.                                      I.060710
008320     MOVE W-NG TO HBHK-NG.                                        I.060710
008330     START HBHKF KEY NOT < HBHK-KEY INVALID KEY                   I.060710
008340         GO TO DEL-EX.                                            I.060710
008350 DEL-010.                                                         I.060710
008360     READ HBHKF NEXT RECORD WITH UNLOCK AT END                    I.060710
008370         GO TO DEL-EX.                                            I.060710
008380     IF W-NG NOT = HBHK-NG                                        I.060710
008390         GO TO DEL-EX.                                            I.060710
008400*
008410     DELETE HBHKF INVALID KEY                                     I.060710
008420         MOVE 1 TO W-END                                          I.060710
008430         DISPLAY E-ME6 E-KEY E-ME99                               I.060710
008440         GO TO DEL-EX.                                            I.060710
008450     GO TO DEL-010.                                               I.060710
008460 DEL-EX.                                                          I.060710
008470     EXIT.                                                        I.060710
