000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMN150.
000030*********************************************************
000040*    PROGRAM         :  棚卸Ｗチェックファイル　集計    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :                                  *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     SELECT HTWCF ASSIGN TO HTWC-MSD.
000160     SELECT HTWCW ASSIGN TO HTWCW-MSD.
000170 DATA DIVISION.
000180 FILE SECTION.
000190 FD  HTWCF
000200     BLOCK  2 RECORDS
000210     LABEL RECORD IS STANDARD
000220     VALUE OF IDENTIFICATION WK0128ID.
000230 01  HTWC-R.
000240     02  HTWC-KEY.
000250       03  HTWC-HCD     PIC  9(006).                              品名ｺｰﾄﾞ
000260       03  HTWC-SIZ     PIC  9(001).
000270     02  HTWC-ASUD.                                               棚卸数
000280       03  HTWC-ASU     PIC S9(006)  OCCURS  10.
000290     02  HTWC-BSUD.                                               棚卸数
000300       03  HTWC-BSU     PIC S9(006)  OCCURS  10.
000310     02  F              PIC  X(001).
000320 FD  HTWCW
000330     BLOCK  1 RECORDS
000340     LABEL RECORD IS STANDARD
000350     VALUE OF IDENTIFICATION WK0256ID.
000360 01  HTWCW-R.
000370     02  HTWCW-KEY.
000380       03  HTWCW-HCD    PIC  9(006).                              品名ｺｰﾄﾞ
000390       03  HTWCW-SIZ    PIC  9(001).
000400     02  HTWCW-ASUD.                                              棚卸数
000410       03  HTWCW-ASU    PIC S9(006)  OCCURS  10.
000420     02  HTWCW-BSUD.                                              棚卸数
000430       03  HTWCW-BSU    PIC S9(006)  OCCURS  10.
000440     02  F              PIC  X(001).
000450     02  F              PIC  X(128).
000460 WORKING-STORAGE SECTION.
000470 77  WK0128ID           PIC  X(009) VALUE SPACE.
000480 77  WK0256ID           PIC  X(009) VALUE SPACE.
000490 01  STN-NO.
000500     02  STN-NO1        PIC  X(003).
000510     02  STN-NO2        PIC  X(003).
000520 01  W-FID1.
000530     02  W-FID11        PIC  X(006) VALUE "WK0128".
000540     02  W-FID12        PIC  X(003).
000550 01  W-FID2.
000560     02  W-FID21        PIC  X(006) VALUE "WK0256".
000570     02  W-FID22        PIC  X(003).
000580 01  W-DATA.
000590     02  CNT            PIC  9(002).
000600 01  ERR-STAT           PIC  X(002).
000610 SCREEN SECTION.
000620 SD  C-CRT
000630     END STATUS IS ESTAT.
000640 01  C-CLEAR.
000650     02  LINE   1  CLEAR SCREEN.
000660 01  C-MID.
000670     02  LINE   3  COLUMN  10  PIC  N(024) VALUE
000680          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000690     02  LINE   4  COLUMN  10  PIC  N(024) VALUE
000700          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000710     02  LINE   5  COLUMN  10  PIC  N(024) VALUE
000720          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
000730     02  LINE   6  COLUMN  10  PIC  N(024) VALUE
000740          NC"＊＊＊　　棚卸Ｗチェックファイル　集計　　＊＊＊".
000750     02  LINE   7  COLUMN  10  PIC  N(024) VALUE
000760          NC"＊＊＊　　　　　　　　　　　　　　　　　　＊＊＊".
000770     02  LINE   8  COLUMN  10  PIC  N(024) VALUE
000780          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000790     02  LINE   9  COLUMN  10  PIC  N(024) VALUE
000800          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000810 01  C-ERR.
000820     02  LINE  24.
000830       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
000840            "***  DATA ﾅｼ  ***".
000850       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000860       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000870       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
000880       03  E-CL    COLUMN  10  PIC  X(050) VALUE
000890            "                                                  ".
000900 PROCEDURE DIVISION.
000910 M-05.
000920     DISPLAY C-CLEAR.
000930     DISPLAY C-MID.
000940*
000950     CALL "CBLSTNNO" USING STN-NO.
000960     MOVE STN-NO2 TO W-FID12 W-FID22.
000970     MOVE W-FID1 TO WK0128ID.
000980     MOVE W-FID2 TO WK0256ID.
000990     OPEN INPUT HTWCF.
001000     OPEN OUTPUT HTWCW.
001010     READ HTWCF AT END
001020         MOVE 255 TO COMPLETION-CODE
001030         DISPLAY E-ME1 E-ME99
001040         GO TO M-90.
001050 M-10.
001060     INITIALIZE HTWCW-R.
001070     MOVE HTWC-KEY TO HTWCW-KEY.
001080     MOVE ZERO TO HTWCW-ASUD HTWCW-BSUD.
001090 M-15.
001100     MOVE ZERO TO CNT.
001110 M-20.
001120     ADD 1 TO CNT.
001130     IF CNT NOT = 11
001140         ADD HTWC-ASU(CNT) TO HTWCW-ASU(CNT)
001150         ADD HTWC-BSU(CNT) TO HTWCW-BSU(CNT)
001160         GO TO M-20.
001170 M-25.
001180     READ HTWCF AT END
001190         GO TO M-30.
001200     IF HTWC-KEY = HTWCW-KEY
001210         GO TO M-15.
001220*
001230     WRITE HTWCW-R.
001240     GO TO M-10.
001250 M-30.
001260     WRITE HTWCW-R.
001270 M-90.
001280     CLOSE HTWCF.
001290     CLOSE HTWCW.
001300 M-95.
001310     DISPLAY C-CLEAR.
001320     STOP RUN.
