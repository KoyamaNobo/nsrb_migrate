000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMG990.
000030*********************************************************
000040*    PROGRAM         : 　出荷集計ワーク作成（年間用）他 *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  96/12/17                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*    JS-SIGN         :  0=月次更新  ,  1=月次作表(HGGET)*
000100*********************************************************
000110 ENVIRONMENT DIVISION.
000120 CONFIGURATION SECTION.
000130 SOURCE-COMPUTER. SYSTEM3100.
000140 OBJECT-COMPUTER. SYSTEM3100.
000150 INPUT-OUTPUT SECTION.
000160 FILE-CONTROL.
000170     COPY LIBCSE.                                                 I.000321
000180     SELECT SNTR-F ASSIGN TO SNTR-MSD.
000190     SELECT SSR-F ASSIGN TO SSR-MSD.
000200     SELECT TT-M ASSIGN TO TT-MSD                                 I.000321
000210         ORGANIZATION INDEXED                                     I.000321
000220         ACCESS MODE IS SEQUENTIAL                                I.000321
000230         RECORD KEY TT-KEY                                        I.000321
000240         FILE STATUS IS ERR-STAT.                                 I.000321
000250     SELECT TZNT-M ASSIGN TO TZNT-MSD                             I.000321
000260         ORGANIZATION INDEXED                                     I.000321
000270         ACCESS MODE DYNAMIC                                      I.000321
000280         RECORD KEY TZNT-KEY                                      I.000321
000290         FILE STATUS ERR-STAT.                                    I.000321
000300*****SELECT TMYF ASSIGN TO TMY-MSD                                D.000606
000310*****    FILE STATUS IS ERR-STAT.                                 D.000606
000320     SELECT TTMYR ASSIGN TO TTMYR-MSD                             I.000324
000330         FILE STATUS IS ERR-STAT.                                 I.000324
000340     SELECT ZD-F ASSIGN TO ZD-MSD                                 I.000324
000350         FILE STATUS ERR-STAT.                                    I.000324
000360     SELECT TZNTP-M ASSIGN TO TZNTP-MSD                           I.000906
000370         ORGANIZATION INDEXED                                     I.000906
000380         ACCESS MODE DYNAMIC                                      I.000906
000390         RECORD KEY TZNTP-KEY                                     I.000906
000400         FILE STATUS ERR-STAT.                                    I.000906
000410     SELECT TZNTMYR ASSIGN TO TZNTY-MSD                           I.040517
000420         FILE STATUS ERR-STAT.                                    I.040517
000430 I-O-CONTROL.                                                     I.000321
000440     APPLY SHARED-MODE ON M-DATE                                  I.000321
000450     APPLY SHARED-MODE ON TZNT-M.                                 I.000321
000460 DATA DIVISION.
000470 FILE SECTION.
000480     COPY LIBFDD.                                                 I.000321
000490     COPY LITTM.                                                  I.000321
000500 FD  SNTR-F
000510     BLOCK  2 RECORDS
000520     LABEL RECORD IS STANDARD
000530     VALUE OF IDENTIFICATION IS "SNTRF".
000540 01  SNTR-R.
000550*****02  SNTR-DATE      PIC  9(006).                              D.970328
000560*****02  F              PIC  X(007).                              D.000829
000570     02  SNTR-DNO       PIC  9(006).                              I.000829
000580     02  SNTR-GNO       PIC  9(001).                              I.000829
000590     02  SNTR-DATE.                                               I.970328
000600*****  03  SNTR-NG      PIC  9(004).                              D.970715
000610       03  SNTR-NG      PIC  9(006).                              I.970715
000620       03  SNTR-PEY     PIC  9(002).                              I.970328
000630     02  SNTR-TCD       PIC  9(004).
000640     02  SNTR-HCD       PIC  9(006).
000650*****02  F              PIC  X(041).                              D.000817
000660     02  F              PIC  X(031).                              I.000817
000670     02  SNTR-SU        PIC S9(005).
000680     02  SNTR-BT        PIC S9(005).
000690     02  SNTR-UKIN      PIC S9(008).
000700     02  F              PIC  X(001).
000710     02  SNTR-DC        PIC  9(001).
000720     02  SNTR-FT        PIC  9(005).
000730*****02  F              PIC  X(007).                              D.000817
000740     02  F              PIC  X(003).                              I.000817
000750     02  SNTR-BC.
000760       03  SNTR-BC1     PIC  9(002).
000770       03  SNTR-BC2     PIC  9(002).
000780       03  SNTR-BC3     PIC  9(002).
000790     02  SNTR-BCD   REDEFINES SNTR-BC.                            I.060525
000800       03  SNTR-BCD1    PIC  9(003).                              I.060525
000810       03  F            PIC  9(003).                              I.060525
000820     02  F              PIC  X(001).
000830     02  SNTR-TNC       PIC  9(002).
000840     02  SNTR-FKC       PIC  9(002).
000850*****02  F              PIC  X(027).                              D.970715
000860*****02  F              PIC  X(025).                              D.000817
000870*****02  F              PIC  X(032).                              D.020520
000880     02  F              PIC  X(027).                              I.020520
000890     02  SNTR-BMC       PIC  9(002).                              I.020520
000900     02  SNTR-BMNO      PIC  9(001).                              I.020520
000910     02  F              PIC  X(002).                              I.020520
000920     02  SNTR-SNC       PIC  9(001).
000930 FD  SSR-F
000940*****BLOCK  3 RECORDS                                             D.970520
000950     BLOCK  4 RECORDS                                             I.970520
000960     LABEL RECORD IS STANDARD
000970     VALUE OF IDENTIFICATION IS WK0064ID.                         I.970520
000980*****VALUE OF IDENTIFICATION IS WK0085ID.                         D.970520
000990 01  SSR-R.
001000     02  SSR-TCD        PIC  9(004).
001010     02  SSR-HCD        PIC  9(006).
001020     02  SSR-SU         PIC S9(007).
001030     02  SSR-UKIN       PIC S9(010).
001040     02  SSR-GKIN       PIC S9(010).
001050     02  SSR-TKC        PIC  9(002).
001060     02  SSR-TNC        PIC  9(002).
001070     02  SSR-BC.
001080       03  SSR-BC1      PIC  9(002).
001090       03  SSR-BC2      PIC  9(002).
001100       03  SSR-BC3      PIC  9(002).
001110     02  SSR-BMC        PIC  9(002).                              I.020520
001120     02  SSR-BMNO       PIC  9(001).                              I.020520
001130     02  SSR-FKC        PIC  9(002).
001140     02  SSR-NG         PIC  9(006).                              I.970715
001150     02  F              PIC  X(006).                              I.020520
001160*****02  F              PIC  X(009).                              D.020520
001170 FD  TZNT-M                                                       I.000321
001180     BLOCK  1 RECORDS                                             I.000321
001190     LABEL RECORD IS STANDARD                                     I.000321
001200     VALUE OF IDENTIFICATION "TZNTM".                             I.000321
001210 01  TZNT-R.                                                      I.000321
001220     02  TZNT-KEY.                                                I.000321
001230       03  TZNT-TCD     PIC  9(004).                              I.000321
001240       03  TZNT-IKC     PIC  9(001).                              I.000321
001250     02  TZNT-OUD       PIC  X(108).                              I.000321
001260     02  TZNT-NUD.                                                I.000321
001270       03  TZNT-NU05    PIC S9(009).                              I.000321
001280       03  TZNT-NU06    PIC S9(009).                              I.000321
001290       03  TZNT-NU07    PIC S9(009).                              I.000321
001300       03  TZNT-NU08    PIC S9(009).                              I.000321
001310       03  TZNT-NU09    PIC S9(009).                              I.000321
001320       03  TZNT-NU10    PIC S9(009).                              I.000321
001330       03  TZNT-NU11    PIC S9(009).                              I.000321
001340       03  TZNT-NU12    PIC S9(009).                              I.000321
001350       03  TZNT-NU01    PIC S9(009).                              I.000321
001360       03  TZNT-NU02    PIC S9(009).                              I.000321
001370       03  TZNT-NU03    PIC S9(009).                              I.000321
001380       03  TZNT-NU04    PIC S9(009).                              I.000321
001390     02  TZNT-TUD.                                                I.000321
001400       03  TZNT-OTU     PIC S9(010).                              I.000321
001410       03  TZNT-NTU     PIC S9(010).                              I.000321
001420     02  TZNT-OAD       PIC  X(108).                              I.000321
001430     02  TZNT-NAD.                                                I.000321
001440       03  TZNT-NA05    PIC S9(009).                              I.000321
001450       03  TZNT-NA06    PIC S9(009).                              I.000321
001460       03  TZNT-NA07    PIC S9(009).                              I.000321
001470       03  TZNT-NA08    PIC S9(009).                              I.000321
001480       03  TZNT-NA09    PIC S9(009).                              I.000321
001490       03  TZNT-NA10    PIC S9(009).                              I.000321
001500       03  TZNT-NA11    PIC S9(009).                              I.000321
001510       03  TZNT-NA12    PIC S9(009).                              I.000321
001520       03  TZNT-NA01    PIC S9(009).                              I.000321
001530       03  TZNT-NA02    PIC S9(009).                              I.000321
001540       03  TZNT-NA03    PIC S9(009).                              I.000321
001550       03  TZNT-NA04    PIC S9(009).                              I.000321
001560     02  TZNT-TAD.                                                I.000321
001570       03  TZNT-OTA     PIC S9(010).                              I.000321
001580       03  TZNT-NTA     PIC S9(010).                              I.000321
001590     02  TZNT-NG.                                                 I.000321
001600       03  TZNT-NEN     PIC  9(004).                              I.000321
001610       03  TZNT-GET     PIC  9(002).                              I.000321
001620     02  TZNT-TNC       PIC  9(002).                              I.000321
001630     02  TZNT-BC        PIC  9(001).                              I.000321
001640     02  F              PIC  X(026).                              I.000321
001650 FD  TZNTP-M                                                      I.000906
001660     BLOCK  1 RECORDS                                             I.000906
001670     LABEL RECORD IS STANDARD                                     I.000906
001680     VALUE OF IDENTIFICATION "TZNTPM".                            I.000906
001690 01  TZNTP-R.                                                     I.000906
001700     02  TZNTP-KEY.                                               I.000906
001710       03  TZNTP-TCD    PIC  9(004).                              I.000906
001720       03  TZNTP-IKC    PIC  9(001).                              I.000906
001730     02  TZNTP-OUD      PIC  X(108).                              I.000906
001740     02  TZNTP-NUD.                                               I.000906
001750       03  TZNTP-NU05   PIC S9(009).                              I.000906
001760       03  TZNTP-NU06   PIC S9(009).                              I.000906
001770       03  TZNTP-NU07   PIC S9(009).                              I.000906
001780       03  TZNTP-NU08   PIC S9(009).                              I.000906
001790       03  TZNTP-NU09   PIC S9(009).                              I.000906
001800       03  TZNTP-NU10   PIC S9(009).                              I.000906
001810       03  TZNTP-NU11   PIC S9(009).                              I.000906
001820       03  TZNTP-NU12   PIC S9(009).                              I.000906
001830       03  TZNTP-NU01   PIC S9(009).                              I.000906
001840       03  TZNTP-NU02   PIC S9(009).                              I.000906
001850       03  TZNTP-NU03   PIC S9(009).                              I.000906
001860       03  TZNTP-NU04   PIC S9(009).                              I.000906
001870     02  TZNTP-TUD.                                               I.000906
001880       03  TZNTP-OTU    PIC S9(010).                              I.000906
001890       03  TZNTP-NTU    PIC S9(010).                              I.000906
001900     02  TZNTP-OAD      PIC  X(108).                              I.000906
001910     02  TZNTP-NAD.                                               I.000906
001920       03  TZNTP-NA05   PIC S9(009).                              I.000906
001930       03  TZNTP-NA06   PIC S9(009).                              I.000906
001940       03  TZNTP-NA07   PIC S9(009).                              I.000906
001950       03  TZNTP-NA08   PIC S9(009).                              I.000906
001960       03  TZNTP-NA09   PIC S9(009).                              I.000906
001970       03  TZNTP-NA10   PIC S9(009).                              I.000906
001980       03  TZNTP-NA11   PIC S9(009).                              I.000906
001990       03  TZNTP-NA12   PIC S9(009).                              I.000906
002000       03  TZNTP-NA01   PIC S9(009).                              I.000906
002010       03  TZNTP-NA02   PIC S9(009).                              I.000906
002020       03  TZNTP-NA03   PIC S9(009).                              I.000906
002030       03  TZNTP-NA04   PIC S9(009).                              I.000906
002040     02  TZNTP-TAD.                                               I.000906
002050       03  TZNTP-OTA    PIC S9(010).                              I.000906
002060       03  TZNTP-NTA    PIC S9(010).                              I.000906
002070     02  TZNTP-NG.                                                I.000906
002080       03  TZNTP-NEN    PIC  9(004).                              I.000906
002090       03  TZNTP-GET    PIC  9(002).                              I.000906
002100     02  TZNTP-TNC      PIC  9(002).                              I.000906
002110     02  TZNTP-BC       PIC  9(001).                              I.000906
002120     02  F              PIC  X(026).                              I.000906
002130*****02  SSR-NG         PIC  9(004).                              D.970715
002140*****02  F              PIC  X(011).                              D.970715
002150*****02  F              PIC  X(032).                              D.970520
002160*****02  F              PIC  X(036).                              D.970328
002170*FD  TMYF                                                         D.000606
002180*****BLOCK  2 RECORDS                                             D.000606
002190*****LABEL RECORD STANDARD                                        D.000606
002200*****VALUE OF IDENTIFICATION "TMYF".                              D.000606
002210*01  TY-R.                                                        D.000606
002220*****02  TY-TCD         PIC  9(004).                              D.000606
002230*****02  TY-NG          PIC  9(006).                              D.000606
002240*****02  TY-ZUZ         PIC S9(009).                              D.000606
002250*****02  TY-ZUZZ        PIC S9(007).                              D.000606
002260*****02  TY-UZ          PIC S9(009).                              D.000606
002270*****02  TY-UZZ         PIC S9(007).                              D.000606
002280*****02  TY-UA          PIC S9(009).                              D.000606
002290*****02  TY-UAZ         PIC S9(007).                              D.000606
002300*****02  TY-UN          PIC S9(008).                              D.000606
002310*****02  TY-UNZ         PIC S9(006).                              D.000606
002320*****02  TY-N           PIC S9(009).                              D.000606
002330*****02  TY-NZ          PIC S9(007).                              D.000606
002340*****02  TY-UG          PIC S9(009).                              D.000606
002350*****02  TY-TKC         PIC  9(002).                              D.000606
002360*****02  TY-TNC         PIC  9(002).                              D.000606
002370*****02  TY-TFK         PIC  9(002).                              D.000606
002380*****02  TY-BC          PIC  9(001).                              D.000606
002390*****02  F              PIC  X(024).                              D.000606
002400 FD  TTMYR                                                        I.000324
002410*****BLOCK  4 RECORDS                                             D.001127
002420     BLOCK  2 RECORDS                                             I.001127
002430     LABEL RECORD IS STANDARD                                     I.000324
002440     VALUE OF IDENTIFICATION "TTMYR".                             I.000324
002450 01  TTMYR-R.                                                     I.000324
002460     02  TTMYR-KEY.                                               I.001127
002470       03  TTMYR-TCD    PIC  9(004).                              I.001127
002480     02  TTMYR-TD.                                                I.001127
002490       03  TTMYR-TZZ    PIC S9(009).                              I.001127
002500       03  TTMYR-TZZZ   PIC S9(007).                              I.001127
002510       03  TTMYR-TUZ    PIC S9(009).                              I.001127
002520       03  TTMYR-TUZZ   PIC S9(007).                              I.001127
002530       03  TTMYR-TUA    PIC S9(009).                              I.001127
002540       03  TTMYR-TUAZ   PIC S9(007).                              I.001127
002550       03  TTMYR-TNB    PIC S9(008).                              I.001127
002560       03  TTMYR-TNBZ   PIC S9(006).                              I.001127
002570       03  TTMYR-TNK    PIC S9(009).                              I.001127
002580       03  TTMYR-TNKZ   PIC S9(007).                              I.001127
002590       03  TTMYR-TUG    PIC S9(009).                              I.001127
002600     02  TTMYR-TKC      PIC  9(002).                              I.001127
002610     02  TTMYR-TNC      PIC  9(002).                              I.001127
002620     02  TTMYR-FKC      PIC  9(002).                              I.001127
002630     02  TTMYR-BC       PIC  9(001).                              I.001127
002640     02  TTMYR-DCN      PIC  9(003).                              I.001127
002650     02  F              PIC  X(021).                              I.001127
002660     02  TTMYR-DNG      PIC  9(006).                              I.001127
002670*****02  TTMYR-DATA.                                              D.001127
002680*****  03  TTMYR-KEY.                                             D.001127
002690*****    04  TTMYR-TCD  PIC  9(004).                              D.001127
002700*****  03  TTMYR-TD.                                              D.001127
002710*****    04  TTMYR-TZZ  PIC S9(009).                              D.001127
002720*****    04  TTMYR-TZZZ PIC S9(007).                              D.001127
002730*****    04  TTMYR-TUZ  PIC S9(009).                              D.001127
002740*****    04  TTMYR-TUZZ PIC S9(007).                              D.001127
002750*****    04  TTMYR-TUA  PIC S9(009).                              D.001127
002760*****    04  TTMYR-TUAZ PIC S9(007).                              D.001127
002770*****    04  TTMYR-TNB  PIC S9(008).                              D.001127
002780*****    04  TTMYR-TNBZ PIC S9(006).                              D.001127
002790*****    04  TTMYR-TNK  PIC S9(009).                              D.001127
002800*****    04  TTMYR-TNKZ PIC S9(007).                              D.001127
002810*****    04  TTMYR-TUG  PIC S9(009).                              D.001127
002820*****  03  TTMYR-SD.                                              D.001127
002830*****    04  TTMYR-SZZ  PIC S9(009).                              D.001127
002840*****    04  TTMYR-SZZZ PIC S9(007).                              D.001127
002850*****    04  TTMYR-SUA  PIC S9(009).                              D.001127
002860*****    04  TTMYR-SUAZ PIC S9(007).                              D.001127
002870*****    04  TTMYR-STS  PIC S9(007).                              D.001127
002880*****    04  TTMYR-STSZ PIC S9(005).                              D.001127
002890*****    04  TTMYR-SNK  PIC S9(009).                              D.001127
002900*****    04  TTMYR-SNKZ PIC S9(007).                              D.001127
002910*****  03  TTMYR-TKC    PIC  9(002).                              D.001127
002920*****  03  TTMYR-TNC    PIC  9(002).                              D.001127
002930*****  03  TTMYR-FKC    PIC  9(002).                              D.001127
002940*****  03  TTMYR-BC     PIC  9(001).                              D.001127
002950*****  03  TTMYR-SNG    PIC  9(004).                              D.001127
002960*****  03  F            PIC  X(003).                              D.001127
002970*****  03  TTMYR-SP     PIC  9(002).                              D.001127
002980*****  03  TTMYR-SK     PIC  9(001).                              D.001127
002990*****  03  F            PIC  X(002).                              D.001127
003000*****02  TTMYR-DNG      PIC  9(006).                              D.001127
003010*****02  F              PIC  X(016).                              D.001127
003020 FD  ZD-F                                                         I.000324
003030     BLOCK 12 RECORDS                                             I.000324
003040     LABEL RECORD IS STANDARD                                     I.000324
003050     VALUE OF IDENTIFICATION "ZDF".                               I.000324
003060 01  ZD-R.                                                        I.000324
003070     02  ZD-NO          PIC  9(002).                              I.000324
003080     02  ZD-KEY         PIC  9(004).                              I.000324
003090     02  ZD-KIN         PIC S9(010).                              I.000324
003100     02  ZD-NG          PIC  9(004).                              I.000324
003110     02  F              PIC  X(001).                              I.000324
003120 FD  TZNTMYR                                                      I.040517
003130     BLOCK  1 RECORDS                                             I.040517
003140     LABEL RECORD IS STANDARD                                     I.040517
003150     VALUE OF IDENTIFICATION "TZNTMYR".                           I.040517
003160 01  TZNTY-R.                                                     I.040517
003170     02  F              PIC  X(506).                              I.040517
003180     02  TZNTY-NG       PIC  9(006).                              I.040517
003190 WORKING-STORAGE SECTION.
003200 77  JS-SIGN            PIC  9(001).                              1.000906
003210 77  W-FILE             PIC  X(013).                              I.000321
003220*77  WK0085ID           PIC  X(009) VALUE SPACE.                  D.970520
003230 77  WK0064ID           PIC  X(009) VALUE SPACE.                  I.970520
003240 01  STN-NO.
003250     02  STN-NO1        PIC  X(003).
003260     02  STN-NO2        PIC  X(003).
003270 01  W-FID.
003280*****02  W-FID1         PIC  X(006) VALUE "WK0085".               D.970520
003290     02  W-FID1         PIC  X(006) VALUE "WK0064".               I.970520
003300     02  W-FID2         PIC  X(003).
003310 01  W-DATA.
003320     02  W-DATE         PIC  9(008).                              I.000321
003330     02  W-NGP   REDEFINES W-DATE.                                I.000321
003340       03  W-NG.                                                  I.000321
003350         04  W-NEN      PIC  9(004).                              I.000321
003360         04  W-NENL  REDEFINES W-NEN.                             I.000321
003370           05  W-NEN1   PIC  9(002).                              I.000321
003380           05  W-NEN2   PIC  9(002).                              I.000321
003390         04  W-GET      PIC  9(002).                              I.000321
003400       03  W-NGL   REDEFINES W-NG.                                I.000321
003410         04  F          PIC  9(002).                              I.000321
003420         04  W-NGS      PIC  9(004).                              I.000321
003430       03  W-PEY        PIC  9(002).                              I.000321
003440     02  W-NGPL  REDEFINES W-DATE.                                I.000321
003450       03  F            PIC  9(002).                              I.000321
003460       03  W-NGPS       PIC  9(006).                              I.000321
003470     02  W-RD.
003480       03  W-SU         PIC S9(005).
003490       03  W-UKIN       PIC S9(008).
003500       03  W-GKIN       PIC S9(008).
003510     02  W-KIN          PIC S9(009).                              I.000321
003520 01  ERR-STAT           PIC  X(002).
003530 SCREEN SECTION.
003540 SD  C-CRT
003550     END STATUS IS ESTAT.
003560 01  C-CLEAR.
003570     02  C-CL    LINE   1  CLEAR SCREEN.
003580 01  C-MID0.
003590     02  LINE   3  COLUMN  10  PIC  N(025) VALUE                  I.000324
003600          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000324
003610     02  LINE   4  COLUMN  10  PIC  N(025) VALUE                  I.000324
003620          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000324
003630     02  LINE   5  COLUMN  10  PIC  N(025) VALUE                  I.000324
003640          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊". I.000324
003650     02  LINE   6  COLUMN  10  PIC  N(025) VALUE                  I.000324
003660          NC"＊＊＊　　出荷集計ワーク作成　（年間用）　　＊＊＊". I.000324
003670     02  LINE   7  COLUMN  10  PIC  N(025) VALUE                  I.000324
003680          NC"＊＊＊　　得意先年間ファイル　累積・更新　　＊＊＊". I.000324
003690     02  LINE   8  COLUMN  10  PIC  N(025) VALUE                  I.000324
003700          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊". I.000324
003710     02  LINE   9  COLUMN  10  PIC  N(025) VALUE                  I.000324
003720          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000324
003730     02  LINE  10  COLUMN  10  PIC  N(025) VALUE                  I.000324
003740          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000324
003750 01  C-MID1.                                                      I.000906
003760     02  LINE   3  COLUMN  10  PIC  N(025) VALUE                  I.000906
003770          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000906
003780     02  LINE   4  COLUMN  10  PIC  N(025) VALUE                  I.000906
003790          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000906
003800     02  LINE   5  COLUMN  10  PIC  N(025) VALUE                  I.000906
003810          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊". I.000906
003820     02  LINE   6  COLUMN  10  PIC  N(025) VALUE                  I.000906
003830          NC"＊＊＊　得意先年間ファイル　更新　（作表）　＊＊＊". I.000906
003840     02  LINE   7  COLUMN  10  PIC  N(025) VALUE                  I.000906
003850          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊". I.000906
003860     02  LINE   8  COLUMN  10  PIC  N(025) VALUE                  I.000906
003870          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000906
003880     02  LINE   9  COLUMN  10  PIC  N(025) VALUE                  I.000906
003890          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊". I.000906
003900*****02  LINE   3  COLUMN  10  PIC  N(022) VALUE                  D.000324
003910*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       D.000324
003920*****02  LINE   4  COLUMN  10  PIC  N(022) VALUE                  D.000324
003930*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       D.000324
003940*****02  LINE   5  COLUMN  10  PIC  N(022) VALUE                  D.000324
003950*****     NC"＊＊　　　　　　　　　　　　　　　　　　＊＊".       D.000324
003960*****02  LINE   6  COLUMN  10  PIC  N(022) VALUE                  D.000324
003970*****     NC"＊＊　　出荷集計ワーク作成（年間用）　　＊＊".       D.000324
003980*****02  LINE   7  COLUMN  10  PIC  N(022) VALUE                  D.000324
003990*****     NC"＊＊　　　　　　　　　　　　　　　　　　＊＊".       D.000324
004000*****02  LINE   8  COLUMN  10  PIC  N(022) VALUE                  D.000324
004010*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       D.000324
004020*****02  LINE   9  COLUMN  10  PIC  N(022) VALUE                  D.000324
004030*****     NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".       D.000324
004040 01  C-ERR.
004050     02  LINE  24.
004060       03  E-ME2   COLUMN  15  PIC  X(025) VALUE                  I.000321
004070            "***  TZNTM WRITE ｴﾗｰ  ***".                          I.000321
004080       03  E-ME3   COLUMN  15  PIC  X(027) VALUE                  I.000321
004090            "***  TZNTM REWRITE ｴﾗｰ  ***".                        I.000321
004100       03  E-ME4   COLUMN  15  PIC  X(026) VALUE                  I.000321
004110            "***  TZNTM DELETE ｴﾗｰ  ***".                         I.000321
004120       03  E-ME5   COLUMN  15  PIC  X(026) VALUE                  I.000906
004130            "***  TZNTPM WRITE ｴﾗｰ  ***".                         I.000906
004140       03  E-ME6   COLUMN  15  PIC  X(028) VALUE                  I.000906
004150            "***  TZNTPM REWRITE ｴﾗｰ  ***".                       I.000906
004160       03  E-ME7   COLUMN  15  PIC  X(027) VALUE                  I.000906
004170            "***  TZNTPM DELETE ｴﾗｰ  ***".                        I.000906
004180*****  03  E-ME9   COLUMN  15  PIC  X(024) VALUE                  D.000606
004190*****       "***  TMYF WRITE ｴﾗｰ  ***".                           D.000606
004200       03  E-ME10  COLUMN  15  PIC  X(025) VALUE                  I.000324
004210            "***  TTMYR WRITE ｴﾗｰ  ***".                          I.000324
004220       03  E-ME11  COLUMN  15  PIC  X(023) VALUE                  I.000324
004230            "***  ZDF WRITE ｴﾗｰ  ***".                            I.000324
004240       03  E-ME12  COLUMN  15  PIC  X(027) VALUE                  I.040517
004250            "***  TZNTMYR WRITE ｴﾗｰ  ***".                        I.040517
004260       03  E-KEY   COLUMN  50  PIC  X(005) FROM  TZNT-KEY.        I.000321
004270       03  E-KEYP  COLUMN  50  PIC  X(005) FROM  TZNTP-KEY.       I.000906
004280*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.000321
004290*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.000321
004300     COPY LSSEM.                                                  I.000321
004310     COPY LIBSCR.                                                 I.000321
004320 PROCEDURE DIVISION.
004330 M-05.
004340     ACCEPT JS-SIGN.                                              I.000906
004350     IF JS-SIGN > 1                                               I.000906
004360         MOVE 255 TO COMPLETION-CODE                              I.000906
004370         GO TO M-95.                                              I.000906
004380     DISPLAY C-CLEAR.
004390     IF JS-SIGN = 1                                               I.000906
004400         DISPLAY C-MID1                                           I.000906
004410       ELSE                                                       I.000906
004420         DISPLAY C-MID0.
004430*
004440     MOVE ZERO TO W-DATE.                                         I.000321
004450     COPY LIBCPR.                                                 I.000321
004460     MOVE D-NHNG TO W-NGS.                                        I.000321
004470     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.000321
004480         ADD DATE-NC1 TO W-NEN.                                   I.000321
004490     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.000321
004500         ADD DATE-NC2 TO W-NEN.                                   I.000321
004510*
004520     IF JS-SIGN = 1                                               I.000906
004530         OPEN I-O TZNTP-M                                         I.000906
004540       ELSE                                                       I.000906
004550         OPEN I-O TZNT-M.                                         I.000321
004560     IF W-GET = 5                                                 I.000321
004570         PERFORM MZR-RTN THRU MZR-EX.                             I.000321
004580     IF COMPLETION-CODE = 255                                     I.000321
004590         GO TO M-95.                                              I.000906
004600*****    CLOSE TZNT-M                                             D.000906
004610*****    DISPLAY C-CLEAR                                          D.000906
004620*****    STOP RUN.                                                D.000906
004630*
004640     OPEN INPUT SNTR-F.                                           I.000906
004650     OPEN INPUT TT-M.                                             I.000906
004660     IF JS-SIGN = 1                                               I.000906
004670         GO TO M-10.                                              I.000906
004680     CALL "CBLSTNNO" USING STN-NO.
004690     MOVE STN-NO2 TO W-FID2.
004700*****MOVE W-FID TO WK0085ID.                                      D.970520
004710     MOVE W-FID TO WK0064ID.                                      I.970520
004720     OPEN OUTPUT SSR-F.
004730*****OPEN INPUT SNTR-F.                                           D.000906
004740*****OPEN INPUT TT-M.                                             D.000906
004750*****OPEN EXTEND TMYF.                                            D.000606
004760     OPEN EXTEND TTMYR.                                           I.000324
004770     OPEN EXTEND ZD-F.                                            I.000324
004780 M-10.
004790     READ SNTR-F AT END
004800         GO TO M-20.                                              I.000321
004810     IF SNTR-GNO = 9                                              I.000829
004820         GO TO M-10.                                              I.000829
004830*****    GO TO M-90.                                              D.000321
004840*****IF SNTR-DC = 4                                               D.970117
004850     IF SNTR-DC = 4 OR 8                                          I.970117
004860         GO TO M-10.
004870     PERFORM DST-RTN THRU DST-EX.
004880     IF ZERO = W-SU AND W-UKIN AND W-GKIN
004890         GO TO M-10.
004900     IF JS-SIGN = 1                                               I.000906
004910         GO TO M-15.                                              I.000906
004920     MOVE ZERO      TO SSR-R.
004930     MOVE SNTR-TCD  TO SSR-TCD.
004940     MOVE SNTR-HCD  TO SSR-HCD.
004950     MOVE W-SU   TO SSR-SU.
004960     MOVE W-UKIN TO SSR-UKIN.
004970     MOVE W-GKIN TO SSR-GKIN.
004980     MOVE SNTR-TNC  TO SSR-TNC.
004990     MOVE SNTR-BC   TO SSR-BC.
005000     MOVE SNTR-BMC  TO SSR-BMC.                                   I.020520
005010     MOVE SNTR-BMNO TO SSR-BMNO.                                  I.020520
005020     MOVE SNTR-FKC  TO SSR-FKC.
005030     MOVE SNTR-NG TO SSR-NG.                                      I.970328
005040     WRITE SSR-R.
005050 M-15.                                                            I.000906
005060     COMPUTE W-KIN = W-UKIN - W-GKIN.                             I.000321
005070     IF ZERO = W-UKIN AND W-KIN                                   I.000321
005080         GO TO M-10.                                              I.000321
005090     PERFORM MDR-RTN THRU MDR-EX.                                 I.000321
005100     IF COMPLETION-CODE = 255                                     I.000321
005110         GO TO M-90.                                              I.000321
005120     GO TO M-10.
005130 M-20.                                                            I.000321
005140     READ TT-M AT END                                             I.000321
005150         GO TO M-90.                                              I.000321
005160     IF JS-SIGN = 1                                               I.000906
005170         GO TO M-25.                                              I.000906
005180*
005190*****PERFORM TMY-RTN THRU TMY-EX.                                 D.000606
005200*****IF COMPLETION-CODE = 255                                     D.000606
005210*****    GO TO M-90.                                              D.000606
005220*
005230     PERFORM TYR-RTN THRU TYR-EX.                                 I.000324
005240     IF COMPLETION-CODE = 255                                     I.000324
005250         GO TO M-90.                                              I.000324
005260*
005270     PERFORM ZDW-RTN THRU ZDW-EX.                                 I.000324
005280     IF COMPLETION-CODE = 255                                     I.000324
005290         GO TO M-90.                                              I.000324
005300 M-25.                                                            I.000906
005310     IF TT-BC = 0                                                 I.000321
005320         GO TO M-20.                                              I.000321
005330     COMPUTE W-UKIN = TT-TUA - TT-TNB.                            I.000321
005340     COMPUTE W-KIN = W-UKIN - TT-TUG.                             I.000321
005350     IF ZERO = W-UKIN AND W-KIN                                   I.000321
005360         GO TO M-20.                                              I.000321
005370     PERFORM KDR-RTN THRU KDR-EX.                                 I.000321
005380     IF COMPLETION-CODE = 255                                     I.000321
005390         GO TO M-90.                                              I.000321
005400     GO TO M-20.                                                  I.000321
005410 M-90.
005420     CLOSE TT-M.                                                  I.000906
005430     CLOSE SNTR-F.
005440     IF JS-SIGN = 1                                               I.000906
005450         CLOSE TZNTP-M                                            I.000906
005460         GO TO M-95.                                              I.000906
005470     CLOSE SSR-F.
005480*****CLOSE TT-M.                                                  D.000906
005490     CLOSE TZNT-M.                                                I.000321
005500*****CLOSE TMYF.                                                  D.000606
005510     CLOSE TTMYR.                                                 I.000324
005520     CLOSE ZD-F.                                                  I.000324
005530 M-95.                                                            I.000906
005540     DISPLAY C-CLEAR.
005550     STOP RUN.
005560 DST-RTN.                                                         I.961217
005570     MOVE ZERO TO W-RD.                                           I.961217
005580*****IF (SNTR-SNC = 0) OR (SNTR-DC NOT = 2)                       D.131112
005590     IF (SNTR-SNC = 0) AND (SNTR-DC NOT = 2)                      I.131112
005600         COMPUTE W-GKIN = SNTR-SU * SNTR-FT.                      I.961217
005610     IF (SNTR-SNC = 1) OR (SNTR-DC = 1 OR 2 OR 5)                 I.961217
005620         COMPUTE W-SU = SNTR-SU * -1                              I.961217
005630         COMPUTE W-GKIN = W-GKIN * -1                             I.961217
005640         COMPUTE W-UKIN = SNTR-UKIN * -1                          I.961217
005650       ELSE                                                       I.961217
005660         MOVE SNTR-SU TO W-SU                                     I.961217
005670         MOVE SNTR-UKIN TO W-UKIN.                                I.961217
005680     IF (SNTR-HCD > 999899) OR (SNTR-SNC = 1) OR (SNTR-DC = 2)    I.961217
005690         MOVE ZERO TO W-SU.                                       I.961217
005700 DST-EX.                                                          I.961217
005710     EXIT.                                                        I.961213
005720 MZR-RTN.                                                         I.000321
005730     IF JS-SIGN = 1                                               I.000906
005740         GO TO MZR-060.                                           I.000906
005750     OPEN EXTEND TZNTMYR.                                         I.040517
005760 MZR-010.                                                         I.000906
005770     READ TZNT-M NEXT RECORD AT END                               I.000321
005780         CLOSE TZNTMYR                                            I.040517
005790         GO TO MZR-EX.                                            I.000321
005800 MZR-020.                                                         I.040517
005810     MOVE ZERO TO TZNTY-R.                                        I.040517
005820     MOVE TZNT-R TO TZNTY-R.                                      I.040517
005830     MOVE W-NG TO TZNTY-NG.                                       I.040517
005840     WRITE TZNTY-R.                                               I.040517
005850     IF ERR-STAT = "00"                                           I.040517
005860         GO TO MZR-030.                                           I.040517
005870     DISPLAY E-STAT E-ME12 E-ME99.                                I.040517
005880     IF ERR-STAT NOT = "34"                                       I.040517
005890         CLOSE TZNTMYR                                            I.040517
005900         MOVE 255 TO COMPLETION-CODE                              I.040517
005910         DISPLAY E-ME78 E-ME99                                    I.040517
005920         GO TO MZR-EX.                                            I.040517
005930     DISPLAY E-CL.                                                I.040517
005940     CLOSE TZNTMYR.                                               I.040517
005950     MOVE "TZNTMYR      " TO W-FILE.                              I.040517
005960     DISPLAY E-ME71 E-ME98 STOP " ".                              I.040517
005970     DISPLAY E-CL.                                                I.040517
005980     OPEN EXTEND TZNTMYR.                                         I.040517
005990     GO TO MZR-020.                                               I.040517
006000 MZR-030.                                                         I.040517
006010     IF ZERO = TZNT-NU05 AND TZNT-NU06 AND TZNT-NU07 AND          I.000321
006020               TZNT-NU08 AND TZNT-NU09 AND TZNT-NU10 AND          I.000321
006030               TZNT-NU11 AND TZNT-NU12 AND TZNT-NU01 AND          I.000321
006040               TZNT-NU02 AND TZNT-NU03 AND TZNT-NU04 AND          I.000321
006050               TZNT-NA05 AND TZNT-NA06 AND TZNT-NA07 AND          I.000321
006060               TZNT-NA08 AND TZNT-NA09 AND TZNT-NA10 AND          I.000321
006070               TZNT-NA11 AND TZNT-NA12 AND TZNT-NA01 AND          I.000321
006080               TZNT-NA02 AND TZNT-NA03 AND TZNT-NA04              I.000321
006090         GO TO MZR-040.                                           I.000321
006100     MOVE TZNT-NUD TO TZNT-OUD.                                   I.000321
006110     MOVE TZNT-NTU TO TZNT-OTU.                                   I.000321
006120     MOVE TZNT-NAD TO TZNT-OAD.                                   I.000321
006130     MOVE TZNT-NTA TO TZNT-OTA.                                   I.000321
006140     MOVE ZERO TO TZNT-NUD TZNT-NTU TZNT-NAD TZNT-NTA.            I.000321
006150     MOVE W-NG TO TZNT-NG.                                        I.000321
006160*
006170     REWRITE TZNT-R INVALID KEY                                   I.000321
006180         CLOSE TZNT-M                                             I.000906
006190         MOVE 255 TO COMPLETION-CODE                              I.000321
006200         DISPLAY E-ME78 E-STAT E-ME3 E-KEY E-ME99                 I.000321
006210         DISPLAY E-CL                                             I.000321
006220         GO TO MZR-EX.                                            I.000321
006230     GO TO MZR-010.                                               I.000906
006240*****GO TO MZR-RTN.                                               D.000906
006250 MZR-040.                                                         I.000321
006260     DELETE TZNT-M INVALID KEY                                    I.000321
006270         CLOSE TZNT-M                                             I.000906
006280         MOVE 255 TO COMPLETION-CODE                              I.000321
006290         DISPLAY E-ME78 E-STAT E-ME4 E-KEY E-ME99                 I.000321
006300         DISPLAY E-CL                                             I.000321
006310         GO TO MZR-EX.                                            I.000321
006320     GO TO MZR-010.                                               I.000906
006330*****CALL "CBLTCLS" USING TZNT-M.                                 D.000906
006340*****GO TO MZR-RTN.                                               D.000906
006350 MZR-060.                                                         I.000906
006360     READ TZNTP-M NEXT RECORD AT END                              I.000906
006370         GO TO MZR-EX.                                            I.000906
006380     IF ZERO = TZNTP-NU05 AND TZNTP-NU06 AND TZNTP-NU07 AND       I.000906
006390               TZNTP-NU08 AND TZNTP-NU09 AND TZNTP-NU10 AND       I.000906
006400               TZNTP-NU11 AND TZNTP-NU12 AND TZNTP-NU01 AND       I.000906
006410               TZNTP-NU02 AND TZNTP-NU03 AND TZNTP-NU04 AND       I.000906
006420               TZNTP-NA05 AND TZNTP-NA06 AND TZNTP-NA07 AND       I.000906
006430               TZNTP-NA08 AND TZNTP-NA09 AND TZNTP-NA10 AND       I.000906
006440               TZNTP-NA11 AND TZNTP-NA12 AND TZNTP-NA01 AND       I.000906
006450               TZNTP-NA02 AND TZNTP-NA03 AND TZNTP-NA04           I.000906
006460         GO TO MZR-070.                                           I.000906
006470     MOVE TZNTP-NUD TO TZNTP-OUD.                                 I.000906
006480     MOVE TZNTP-NTU TO TZNTP-OTU.                                 I.000906
006490     MOVE TZNTP-NAD TO TZNTP-OAD.                                 I.000906
006500     MOVE TZNTP-NTA TO TZNTP-OTA.                                 I.000906
006510     MOVE ZERO TO TZNTP-NUD TZNTP-NTU TZNTP-NAD TZNTP-NTA.        I.000906
006520     MOVE W-NG TO TZNTP-NG.                                       I.000906
006530*
006540     REWRITE TZNTP-R INVALID KEY                                  I.000906
006550         CLOSE TZNTP-M                                            I.000906
006560         MOVE 255 TO COMPLETION-CODE                              I.000906
006570         DISPLAY E-ME78 E-STAT E-ME6 E-KEYP E-ME99                I.000906
006580         DISPLAY E-CL                                             I.000906
006590         GO TO MZR-EX.                                            I.000906
006600     GO TO MZR-060.                                               I.000906
006610 MZR-070.                                                         I.000906
006620     DELETE TZNTP-M INVALID KEY                                   I.000906
006630         CLOSE TZNTP-M                                            I.000906
006640         MOVE 255 TO COMPLETION-CODE                              I.000906
006650         DISPLAY E-ME78 E-STAT E-ME7 E-KEYP E-ME99                I.000906
006660         DISPLAY E-CL                                             I.000906
006670         GO TO MZR-EX.                                            I.000906
006680     GO TO MZR-060.                                               I.000906
006690 MZR-EX.                                                          I.000321
006700     EXIT.                                                        I.000321
006710 MDR-RTN.                                                         I.000321
006720     IF JS-SIGN = 1                                               I.000906
006730         GO TO MDR-060.                                           I.000906
006740     MOVE ZERO TO TZNT-R.                                         I.000321
006750     MOVE SNTR-TCD TO TZNT-TCD.                                   I.000321
006760*****IF SNTR-BC1 NOT = 33 AND 71                                  D.020408
006770*****IF (SNTR-BC1 NOT = 33) OR (SNTR-BC3 NOT = 30)                D.060525
006780     IF (SNTR-BCD1 NOT = 322) OR (SNTR-BC3 NOT = 30)              I.060525
006790         MOVE 1 TO TZNT-IKC.                                      I.000321
006800*****IF SNTR-BC1 = 71                                             D.020408
006810     IF SNTR-BC3 = 30                                             I.020408
006820         MOVE 2 TO TZNT-IKC.                                      I.000321
006830*****IF SNTR-BC1 = 33                                             D.060525
006840     IF SNTR-BCD1 = 322                                           I.060525
006850         MOVE 3 TO TZNT-IKC.                                      I.000321
006860     READ TZNT-M INVALID KEY                                      I.000321
006870         GO TO MDR-010.                                           I.000321
006880     PERFORM SET-RTN THRU SET-EX.                                 I.000321
006890     MOVE SNTR-TNC TO TZNT-TNC.                                   I.000321
006900     MOVE 0 TO TZNT-BC.                                           I.000321
006910     REWRITE TZNT-R INVALID KEY                                   I.000321
006920         MOVE 255 TO COMPLETION-CODE                              I.000321
006930         DISPLAY E-ME78 E-STAT E-ME3 E-KEY E-ME99                 I.000321
006940         DISPLAY E-CL.                                            I.000321
006950     GO TO MDR-EX.                                                I.000321
006960 MDR-010.                                                         I.000321
006970     PERFORM SET-RTN THRU SET-EX.                                 I.000321
006980     MOVE SNTR-TNC TO TZNT-TNC.                                   I.000321
006990     MOVE 0 TO TZNT-BC.                                           I.000321
007000     WRITE TZNT-R INVALID KEY                                     I.000321
007010         DISPLAY E-STAT E-ME2 E-KEY E-ME99                        I.000321
007020         GO TO MDR-020.                                           I.000321
007030*****CALL "CBLTCLS" USING TZNT-M.                                 D.000906
007040     GO TO MDR-EX.                                                I.000321
007050 MDR-020.                                                         I.000321
007060     IF ERR-STAT NOT = "24"                                       I.000321
007070         MOVE 255 TO COMPLETION-CODE                              I.000321
007080         DISPLAY E-ME78 E-ME99                                    I.000321
007090         GO TO MDR-EX.                                            I.000321
007100     DISPLAY E-CL.                                                I.000321
007110     CLOSE TZNT-M.                                                I.000321
007120     MOVE "TZNTM        " TO W-FILE.                              I.000321
007130     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000321
007140     DISPLAY E-CL.                                                I.000321
007150     OPEN I-O TZNT-M.                                             I.000321
007160     MOVE ZERO TO TZNT-R.                                         I.000321
007170     MOVE SNTR-TCD TO TZNT-TCD.                                   I.000321
007180*****IF SNTR-BC1 NOT = 33 AND 71                                  D.020408
007190*****IF (SNTR-BC1 NOT = 33) OR (SNTR-BC3 NOT = 30)                D.060525
007200     IF (SNTR-BCD1 NOT = 322) OR (SNTR-BC3 NOT = 30)              I.060525
007210         MOVE 1 TO TZNT-IKC.                                      I.000321
007220*****IF SNTR-BC1 = 71                                             D.020408
007230     IF SNTR-BC3 = 30                                             I.020408
007240         MOVE 2 TO TZNT-IKC.                                      I.000321
007250*****IF SNTR-BC1 = 33                                             D.060525
007260     IF SNTR-BCD1 = 322                                           I.060525
007270         MOVE 3 TO TZNT-IKC.                                      I.000321
007280     GO TO MDR-010.                                               I.000321
007290 MDR-060.                                                         I.000906
007300     MOVE ZERO TO TZNTP-R.                                        I.000906
007310     MOVE SNTR-TCD TO TZNTP-TCD.                                  I.000906
007320*****IF SNTR-BC1 NOT = 33 AND 71                                  D.020408
007330*****IF (SNTR-BC1 NOT = 33) OR (SNTR-BC3 NOT = 30)                D.060525
007340     IF (SNTR-BCD1 NOT = 322) OR (SNTR-BC3 NOT = 30)              I.060525
007350         MOVE 1 TO TZNTP-IKC.                                     I.000906
007360*****IF SNTR-BC1 = 71                                             D.020408
007370     IF SNTR-BC3 = 30                                             I.020408
007380         MOVE 2 TO TZNTP-IKC.                                     I.000906
007390*****IF SNTR-BC1 = 33                                             D.060525
007400     IF SNTR-BCD1 = 322                                           I.060525
007410         MOVE 3 TO TZNTP-IKC.                                     I.000906
007420     READ TZNTP-M INVALID KEY                                     I.000906
007430         GO TO MDR-070.                                           I.000906
007440     PERFORM SET-RTN THRU SET-EX.                                 I.000906
007450     MOVE SNTR-TNC TO TZNTP-TNC.                                  I.000906
007460     MOVE 0 TO TZNTP-BC.                                          I.000906
007470     REWRITE TZNTP-R INVALID KEY                                  I.000906
007480         MOVE 255 TO COMPLETION-CODE                              I.000906
007490         DISPLAY E-ME78 E-STAT E-ME3 E-KEY E-ME99                 I.000906
007500         DISPLAY E-CL.                                            I.000906
007510     GO TO MDR-EX.                                                I.000906
007520 MDR-070.                                                         I.000906
007530     PERFORM SET-RTN THRU SET-EX.                                 I.000906
007540     MOVE SNTR-TNC TO TZNTP-TNC.                                  I.000906
007550     MOVE 0 TO TZNTP-BC.                                          I.000906
007560     WRITE TZNTP-R INVALID KEY                                    I.000906
007570         DISPLAY E-STAT E-ME2 E-KEY E-ME99                        I.000906
007580         GO TO MDR-080.                                           I.000906
007590     GO TO MDR-EX.                                                I.000906
007600 MDR-080.                                                         I.000906
007610     IF ERR-STAT NOT = "24"                                       I.000906
007620         MOVE 255 TO COMPLETION-CODE                              I.000906
007630         DISPLAY E-ME78 E-ME99                                    I.000906
007640         GO TO MDR-EX.                                            I.000906
007650     DISPLAY E-CL.                                                I.000906
007660     CLOSE TZNTP-M.                                               I.000906
007670     MOVE "TZNTPM       " TO W-FILE.                              I.000906
007680     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000906
007690     DISPLAY E-CL.                                                I.000906
007700     OPEN I-O TZNTP-M.                                            I.000906
007710     MOVE ZERO TO TZNTP-R.                                        I.000906
007720     MOVE SNTR-TCD TO TZNTP-TCD.                                  I.020408
007730*****IF SNTR-BC1 NOT = 33 AND 71                                  D.020408
007740*****IF (SNTR-BC1 NOT = 33) OR (SNTR-BC3 NOT = 30)                D.060525
007750     IF (SNTR-BCD1 NOT = 322) OR (SNTR-BC3 NOT = 30)              I.060525
007760         MOVE 1 TO TZNTP-IKC.                                     I.000906
007770*****IF SNTR-BC1 = 71                                             D.020408
007780     IF SNTR-BC3 = 30                                             I.020408
007790         MOVE 2 TO TZNTP-IKC.                                     I.000906
007800*****IF SNTR-BC1 = 33                                             D.060525
007810     IF SNTR-BCD1 = 322                                           I.060525
007820         MOVE 3 TO TZNTP-IKC.                                     I.000906
007830     GO TO MDR-070.                                               I.000906
007840 MDR-EX.                                                          I.000321
007850     EXIT.                                                        I.000321
007860 KDR-RTN.                                                         I.000321
007870     IF JS-SIGN = 1                                               I.000906
007880         GO TO KDR-060.                                           I.000906
007890     MOVE ZERO TO TZNT-R.                                         I.000321
007900     MOVE TT-TCD TO TZNT-TCD.                                     I.000321
007910     READ TZNT-M INVALID KEY                                      I.000321
007920         GO TO KDR-010.                                           I.000321
007930     PERFORM SET-RTN THRU SET-EX.                                 I.000321
007940     MOVE TT-TNC TO TZNT-TNC.                                     I.000321
007950     MOVE TT-BC TO TZNT-BC.                                       I.000321
007960     REWRITE TZNT-R INVALID KEY                                   I.000321
007970         MOVE 255 TO COMPLETION-CODE                              I.000321
007980         DISPLAY E-ME78 E-STAT E-ME3 E-KEY E-ME99                 I.000321
007990         DISPLAY E-CL.                                            I.000321
008000     GO TO KDR-EX.                                                I.000321
008010 KDR-010.                                                         I.000321
008020     PERFORM SET-RTN THRU SET-EX.                                 I.000321
008030     MOVE TT-TNC TO TZNT-TNC.                                     I.000321
008040     MOVE TT-BC TO TZNT-BC.                                       I.000321
008050     WRITE TZNT-R INVALID KEY                                     I.000321
008060         DISPLAY E-STAT E-ME2 E-KEY E-ME99                        I.000321
008070         GO TO KDR-020.                                           I.000321
008080*****CALL "CBLTCLS" USING TZNT-M.                                 D.000906
008090     GO TO KDR-EX.                                                I.000321
008100 KDR-020.                                                         I.000321
008110     IF ERR-STAT NOT = "24"                                       I.000321
008120         MOVE 255 TO COMPLETION-CODE                              I.000321
008130         DISPLAY E-ME78 E-ME99                                    I.000321
008140         GO TO KDR-EX.                                            I.000321
008150     DISPLAY E-CL.                                                I.000321
008160     CLOSE TZNT-M.                                                I.000321
008170     MOVE "TZNTM        " TO W-FILE.                              I.000321
008180     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000321
008190     DISPLAY E-CL.                                                I.000321
008200     OPEN I-O TZNT-M.                                             I.000321
008210     MOVE ZERO TO TZNT-R.                                         I.000321
008220     MOVE TT-TCD TO TZNT-TCD.                                     I.000321
008230     GO TO KDR-010.                                               I.000321
008240 KDR-060.                                                         I.000906
008250     MOVE ZERO TO TZNTP-R.                                        I.000906
008260     MOVE TT-TCD TO TZNTP-TCD.                                    I.000906
008270     READ TZNTP-M INVALID KEY                                     I.000906
008280         GO TO KDR-070.                                           I.000906
008290     PERFORM SET-RTN THRU SET-EX.                                 I.000906
008300     MOVE TT-TNC TO TZNTP-TNC.                                    I.000906
008310     MOVE TT-BC TO TZNTP-BC.                                      I.000906
008320     REWRITE TZNTP-R INVALID KEY                                  I.000906
008330         MOVE 255 TO COMPLETION-CODE                              I.000906
008340         DISPLAY E-ME78 E-STAT E-ME3 E-KEY E-ME99                 I.000906
008350         DISPLAY E-CL.                                            I.000906
008360     GO TO KDR-EX.                                                I.000906
008370 KDR-070.                                                         I.000906
008380     PERFORM SET-RTN THRU SET-EX.                                 I.000906
008390     MOVE TT-TNC TO TZNTP-TNC.                                    I.000906
008400     MOVE TT-BC TO TZNTP-BC.                                      I.000906
008410     WRITE TZNTP-R INVALID KEY                                    I.000906
008420         DISPLAY E-STAT E-ME2 E-KEY E-ME99                        I.000906
008430         GO TO KDR-080.                                           I.000906
008440     GO TO KDR-EX.                                                I.000906
008450 KDR-080.                                                         I.000906
008460     IF ERR-STAT NOT = "24"                                       I.000906
008470         MOVE 255 TO COMPLETION-CODE                              I.000906
008480         DISPLAY E-ME78 E-ME99                                    I.000906
008490         GO TO KDR-EX.                                            I.000906
008500     DISPLAY E-CL.                                                I.000906
008510     CLOSE TZNTP-M.                                               I.000906
008520     MOVE "TZNTPM       " TO W-FILE.                              I.000906
008530     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000906
008540     DISPLAY E-CL.                                                I.000906
008550     OPEN I-O TZNTP-M.                                            I.000906
008560     MOVE ZERO TO TZNTP-R.                                        I.000906
008570     MOVE TT-TCD TO TZNTP-TCD.                                    I.000906
008580     GO TO KDR-070.                                               I.000906
008590 KDR-EX.                                                          I.000321
008600     EXIT.                                                        I.000321
008610 SET-RTN.                                                         I.000321
008620     IF JS-SIGN = 1                                               I.000906
008630         GO TO SET-060.                                           I.000906
008640     IF W-GET = 5                                                 I.000321
008650         ADD W-UKIN TO TZNT-NU05 TZNT-NTU                         I.000321
008660         ADD W-KIN TO TZNT-NA05 TZNT-NTA.                         I.000321
008670     IF W-GET = 6                                                 I.000321
008680         ADD W-UKIN TO TZNT-NU06 TZNT-NTU                         I.000321
008690         ADD W-KIN TO TZNT-NA06 TZNT-NTA.                         I.000321
008700     IF W-GET = 7                                                 I.000321
008710         ADD W-UKIN TO TZNT-NU07 TZNT-NTU                         I.000321
008720         ADD W-KIN TO TZNT-NA07 TZNT-NTA.                         I.000321
008730     IF W-GET = 8                                                 I.000321
008740         ADD W-UKIN TO TZNT-NU08 TZNT-NTU                         I.000321
008750         ADD W-KIN TO TZNT-NA08 TZNT-NTA.                         I.000321
008760     IF W-GET = 9                                                 I.000321
008770         ADD W-UKIN TO TZNT-NU09 TZNT-NTU                         I.000321
008780         ADD W-KIN TO TZNT-NA09 TZNT-NTA.                         I.000321
008790     IF W-GET = 10                                                I.000321
008800         ADD W-UKIN TO TZNT-NU10 TZNT-NTU                         I.000321
008810         ADD W-KIN TO TZNT-NA10 TZNT-NTA.                         I.000321
008820     IF W-GET = 11                                                I.000321
008830         ADD W-UKIN TO TZNT-NU11 TZNT-NTU                         I.000321
008840         ADD W-KIN TO TZNT-NA11 TZNT-NTA.                         I.000321
008850     IF W-GET = 12                                                I.000321
008860         ADD W-UKIN TO TZNT-NU12 TZNT-NTU                         I.000321
008870         ADD W-KIN TO TZNT-NA12 TZNT-NTA.                         I.000321
008880     IF W-GET = 1                                                 I.000321
008890         ADD W-UKIN TO TZNT-NU01 TZNT-NTU                         I.000321
008900         ADD W-KIN TO TZNT-NA01 TZNT-NTA.                         I.000321
008910     IF W-GET = 2                                                 I.000321
008920         ADD W-UKIN TO TZNT-NU02 TZNT-NTU                         I.000321
008930         ADD W-KIN TO TZNT-NA02 TZNT-NTA.                         I.000321
008940     IF W-GET = 3                                                 I.000321
008950         ADD W-UKIN TO TZNT-NU03 TZNT-NTU                         I.000321
008960         ADD W-KIN TO TZNT-NA03 TZNT-NTA.                         I.000321
008970     IF W-GET = 4                                                 I.000321
008980         ADD W-UKIN TO TZNT-NU04 TZNT-NTU                         I.000321
008990         ADD W-KIN TO TZNT-NA04 TZNT-NTA.                         I.000321
009000     MOVE W-NG TO TZNT-NG.                                        I.000321
009010     GO TO SET-EX.                                                I.000906
009020 SET-060.                                                         I.000906
009030     IF W-GET = 5                                                 I.000906
009040         ADD W-UKIN TO TZNTP-NU05 TZNTP-NTU                       I.000906
009050         ADD W-KIN TO TZNTP-NA05 TZNTP-NTA.                       I.000906
009060     IF W-GET = 6                                                 I.000906
009070         ADD W-UKIN TO TZNTP-NU06 TZNTP-NTU                       I.000906
009080         ADD W-KIN TO TZNTP-NA06 TZNTP-NTA.                       I.000906
009090     IF W-GET = 7                                                 I.000906
009100         ADD W-UKIN TO TZNTP-NU07 TZNTP-NTU                       I.000906
009110         ADD W-KIN TO TZNTP-NA07 TZNTP-NTA.                       I.000906
009120     IF W-GET = 8                                                 I.000906
009130         ADD W-UKIN TO TZNTP-NU08 TZNTP-NTU                       I.000906
009140         ADD W-KIN TO TZNTP-NA08 TZNTP-NTA.                       I.000906
009150     IF W-GET = 9                                                 I.000906
009160         ADD W-UKIN TO TZNTP-NU09 TZNTP-NTU                       I.000906
009170         ADD W-KIN TO TZNTP-NA09 TZNTP-NTA.                       I.000906
009180     IF W-GET = 10                                                I.000906
009190         ADD W-UKIN TO TZNTP-NU10 TZNTP-NTU                       I.000906
009200         ADD W-KIN TO TZNTP-NA10 TZNTP-NTA.                       I.000906
009210     IF W-GET = 11                                                I.000906
009220         ADD W-UKIN TO TZNTP-NU11 TZNTP-NTU                       I.000906
009230         ADD W-KIN TO TZNTP-NA11 TZNTP-NTA.                       I.000906
009240     IF W-GET = 12                                                I.000906
009250         ADD W-UKIN TO TZNTP-NU12 TZNTP-NTU                       I.000906
009260         ADD W-KIN TO TZNTP-NA12 TZNTP-NTA.                       I.000906
009270     IF W-GET = 1                                                 I.000906
009280         ADD W-UKIN TO TZNTP-NU01 TZNTP-NTU                       I.000906
009290         ADD W-KIN TO TZNTP-NA01 TZNTP-NTA.                       I.000906
009300     IF W-GET = 2                                                 I.000906
009310         ADD W-UKIN TO TZNTP-NU02 TZNTP-NTU                       I.000906
009320         ADD W-KIN TO TZNTP-NA02 TZNTP-NTA.                       I.000906
009330     IF W-GET = 3                                                 I.000906
009340         ADD W-UKIN TO TZNTP-NU03 TZNTP-NTU                       I.000906
009350         ADD W-KIN TO TZNTP-NA03 TZNTP-NTA.                       I.000906
009360     IF W-GET = 4                                                 I.000906
009370         ADD W-UKIN TO TZNTP-NU04 TZNTP-NTU                       I.000906
009380         ADD W-KIN TO TZNTP-NA04 TZNTP-NTA.                       I.000906
009390     MOVE W-NG TO TZNTP-NG.                                       I.000906
009400 SET-EX.                                                          I.000321
009410     EXIT.                                                        I.000321
009420*TMY-RTN.                                                         D.000606
009430*****MOVE W-NG TO TY-NG.                                          D.000606
009440*****MOVE TT-KEY TO TY-TCD.                                       D.000606
009450*****MOVE TT-TUZ TO TY-UZ.                                        D.000606
009460*****MOVE TT-TUZZ TO TY-UZZ.                                      D.000606
009470*****MOVE TT-TZZ TO TY-ZUZ.                                       D.000606
009480*****MOVE TT-TZZZ TO TY-ZUZZ.                                     D.000606
009490*****MOVE TT-TUA TO TY-UA.                                        D.000606
009500*****MOVE TT-TUAZ TO TY-UAZ.                                      D.000606
009510*****MOVE TT-TNB TO TY-UN.                                        D.000606
009520*****MOVE TT-TNBZ TO TY-UNZ.                                      D.000606
009530*****MOVE TT-TNK TO TY-N.                                         D.000606
009540*****MOVE TT-TNKZ TO TY-NZ.                                       D.000606
009550*****MOVE TT-TUG TO TY-UG.                                        D.000606
009560*****MOVE TT-TKC TO TY-TKC.                                       D.000606
009570*****MOVE TT-TNC TO TY-TNC.                                       D.000606
009580*****MOVE TT-FKC TO TY-TFK.                                       D.000606
009590*****MOVE TT-BC TO TY-BC.                                         D.000606
009600*
009610*****WRITE TY-R.                                                  D.000606
009620*****IF ERR-STAT = "00"                                           D.000606
009630*****    GO TO TMY-EX.                                            D.000606
009640*****DISPLAY E-STAT E-ME9 E-ME99.                                 D.000606
009650*****IF ERR-STAT NOT = "34"                                       D.000606
009660*****    MOVE 255 TO COMPLETION-CODE                              D.000606
009670*****    DISPLAY E-ME78 E-ME99                                    D.000606
009680*****    GO TO TMY-EX.                                            D.000606
009690*****DISPLAY E-CL.                                                D.000606
009700*****CLOSE TMYF.                                                  D.000606
009710*****MOVE "TMYF         " TO W-FILE.                              D.000606
009720*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000606
009730*****DISPLAY E-CL.                                                D.000606
009740*****OPEN EXTEND TMYF.                                            D.000606
009750*****GO TO TMY-RTN.                                               D.000606
009760*TMY-EX.                                                          D.000606
009770*****EXIT.                                                        D.000606
009780 TYR-RTN.                                                         I.000324
009790     MOVE ZERO TO TTMYR-R.                                        I.000324
009800     MOVE TT-R TO TTMYR-R.                                        I.000324
009810     MOVE W-NG TO TTMYR-DNG.                                      I.000324
009820*
009830     WRITE TTMYR-R.                                               I.000324
009840     IF ERR-STAT = "00"                                           I.000324
009850         GO TO TYR-EX.                                            I.000324
009860*
009870     DISPLAY E-STAT E-ME10 E-ME99.                                I.000324
009880     IF ERR-STAT NOT = "34"                                       I.000324
009890         MOVE 255 TO COMPLETION-CODE                              I.000324
009900         DISPLAY E-ME78 E-ME99                                    I.000324
009910         GO TO TYR-EX.                                            I.000324
009920     DISPLAY E-CL.                                                I.000324
009930     CLOSE TTMYR.                                                 I.000324
009940     MOVE "TTMYR        " TO W-FILE.                              I.000324
009950     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000324
009960     DISPLAY E-CL.                                                I.000324
009970     OPEN EXTEND TTMYR.                                           I.000324
009980     GO TO TYR-RTN.                                               I.000324
009990 TYR-EX.                                                          I.000324
010000     EXIT.                                                        I.000324
010010 ZDW-RTN.                                                         I.000324
010020     IF TT-TUZ = ZERO                                             I.000324
010030         GO TO ZDW-010.                                           I.000324
010040     MOVE ZERO TO ZD-R.                                           I.000324
010050     MOVE 11 TO ZD-NO.                                            I.000324
010060     MOVE TT-KEY TO ZD-KEY.                                       I.000324
010070     MOVE TT-TUZ TO ZD-KIN.                                       I.000324
010080     MOVE W-NGS TO ZD-NG.                                         I.000324
010090     WRITE ZD-R.                                                  I.000324
010100     IF ERR-STAT = "00"                                           I.000324
010110         GO TO ZDW-010.                                           I.000324
010120     DISPLAY E-STAT E-ME11 E-ME99.                                I.000324
010130     IF ERR-STAT NOT = "34"                                       I.000324
010140         MOVE 255 TO COMPLETION-CODE                              I.000324
010150         DISPLAY E-ME78 E-ME99                                    I.000324
010160         GO TO ZDW-EX.                                            I.000324
010170     DISPLAY E-CL.                                                I.000324
010180     CLOSE ZD-F.                                                  I.000324
010190     MOVE "ZDF          " TO W-FILE.                              I.000324
010200     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000324
010210     DISPLAY E-CL.                                                I.000324
010220     OPEN EXTEND ZD-F.                                            I.000324
010230     GO TO ZDW-RTN.                                               I.000324
010240 ZDW-010.                                                         I.000324
010250     IF TT-TUZZ = ZERO                                            I.000324
010260         GO TO ZDW-EX.                                            I.000324
010270 ZDW-020.                                                         I.000324
010280     MOVE ZERO TO ZD-R.                                           I.000324
010290     MOVE 12 TO ZD-NO.                                            I.000324
010300     MOVE TT-KEY TO ZD-KEY.                                       I.000324
010310     MOVE TT-TUZZ TO ZD-KIN.                                      I.000324
010320     MOVE W-NGS TO ZD-NG.                                         I.000324
010330     WRITE ZD-R.                                                  I.000324
010340     IF ERR-STAT = "00"                                           I.000324
010350         GO TO ZDW-EX.                                            I.000324
010360     DISPLAY E-STAT E-ME11 E-ME99.                                I.000324
010370     IF ERR-STAT NOT = "34"                                       I.000324
010380         MOVE 255 TO COMPLETION-CODE                              I.000324
010390         DISPLAY E-ME78 E-ME99                                    I.000324
010400         GO TO ZDW-EX.                                            I.000324
010410     DISPLAY E-CL.                                                I.000324
010420     CLOSE ZD-F.                                                  I.000324
010430     MOVE "ZDF          " TO W-FILE.                              I.000324
010440     DISPLAY E-ME71 E-ME98 STOP " ".                              I.000324
010450     DISPLAY E-CL.                                                I.000324
010460     OPEN EXTEND ZD-F.                                            I.000324
010470     GO TO ZDW-020.                                               I.000324
010480 ZDW-EX.                                                          I.000324
010490     EXIT.                                                        I.000324
