000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD180.
000030************************************************************
000040*    PROGRAM         :  発送明細ファイル　単価・締日セット *
000050*    PRINTER TYPE    :  ****                               *
000060*    SCREEN          :  ******                             *
000070*    COMPILE TYPE    :  COBOL                              *
000080*    JS-SIGN         :  ワークマン=1 , ナフコ=2            *
000090************************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT HSMSF ASSIGN TO HSMS-MSD
000180         ORGANIZATION INDEXED
000190         RECORD KEY HSMS-KEY
000200         ACCESS MODE DYNAMIC
000210         FILE STATUS IS ERR-STAT.
000220     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000230         ORGANIZATION INDEXED
000240         ACCESS MODE RANDOM
000250         RECORD KEY T-KEY
000260         ALTERNATE RECORD KEY T-KEY2
000270         FILE STATUS IS ERR-STAT.
000280     SELECT TSKF ASSIGN TO TSK-MSD
000290         ORGANIZATION INDEXED
000300         RECORD KEY TSK-KEY
000310         ACCESS MODE RANDOM
000320         FILE STATUS IS ERR-STAT.
000330     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000340         ORGANIZATION INDEXED
000350         ACCESS MODE RANDOM
000360         RECORD KEY HI-KEY
000370         ALTERNATE RECORD KEY HI-KEY2
000380         FILE STATUS IS ERR-STAT.
000390     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD
000400         ORGANIZATION INDEXED
000410         ACCESS MODE RANDOM
000420         RECORD KEY THT-KEY
000430         ALTERNATE RECORD KEY THT-KEY2
000440         FILE STATUS IS ERR-STAT.
000450     SELECT HUH-M ASSIGN TO HUH-MSD
000460         ORGANIZATION INDEXED
000470         ACCESS MODE RANDOM
000480         RECORD KEY HUH-KEY
000490         FILE STATUS IS ERR-STAT.
000500 I-O-CONTROL.
000510     APPLY SHARED-MODE ON M-DATE
000520     APPLY SHARED-MODE ON T-M
000530     APPLY SHARED-MODE ON TSKF
000540     APPLY SHARED-MODE ON THTM
000550     APPLY SHARED-MODE ON HI-M
000560     APPLY SHARED-MODE ON HUH-M
000570     APPLY SHARED-MODE ON HSMSF.
000580 DATA DIVISION.
000590 FILE SECTION.
000600     COPY LIBFDD.
000610     COPY LITM.
000620     COPY LITSKF.
000630     COPY LITHTM.
000640     COPY LIHIM.
000650     COPY LIHUHM.
000660     COPY LIHSMS.
000670 WORKING-STORAGE SECTION.
000680 77  JS-SIGN            PIC  9(001).
000690 77  W-FILE             PIC  X(013).
000700 01  ERR-STAT           PIC  X(002).
000710 01  W-DATA.
000720     02  W-NGP.
000730       03  W-NG.
000740         04  W-NEN      PIC  9(004).
000750         04  W-NENL  REDEFINES W-NEN.
000760           05  W-NEN1   PIC  9(002).
000770           05  W-NEN2   PIC  9(002).
000780         04  W-GET      PIC  9(002).
000790       03  W-PEY        PIC  9(002).
000800     02  W-NGPD  REDEFINES W-NGP.
000810       03  F            PIC  9(002).
000820       03  W-NGS        PIC  9(004).
000830       03  F            PIC  9(002).
000840     02  W-NGD          PIC  9(006).
000850     02  W-ENGD         PIC  9(006).
000860     02  W-DMM          PIC  9(001).
000870     02  W-SNGP         PIC  9(008).
000880     02  W-MNGP         PIC  9(008).
000890     02  W-L            PIC  9(002).
000900     02  W-INV          PIC  9(001).
000910     02  W-NA           PIC  N(007).
000920     02  W-TAN          PIC  9(005).
000930     02  W-DTW1         PIC  9(003).
000940     02  W-DTW2         PIC  9(001).
000950     02  W-SDTD         PIC  9(008).
000960     02  W-SDTM  REDEFINES W-SDTD.
000970       03  W-SDTNG.
000980         04  W-SDTN     PIC  9(004).
000990         04  W-SDTG     PIC  9(002).
001000       03  W-SDTP       PIC  9(002).
001010     02  W-SDATE        PIC  9(008).
001020     02  W-FTD          PIC  9(005).
001030     02  W-SNO          PIC  9(006).
001040     COPY LSTAT.
001050 SCREEN SECTION.
001060 SD  C-CRT
001070     END STATUS IS ESTAT.
001080 01  C-CLEAR.
001090     02  LINE   1  CLEAR SCREEN.
001100 01  C-MID.
001110     02  LINE   1  COLUMN  15  PIC  N(024) VALUE
001120          NC"＊＊＊　　発送明細Ｆ　単価・締日セット　　＊＊＊".
001130     02  LINE   5  COLUMN  27  PIC  X(024) VALUE
001140          "発送日 　'  年   月   日".
001150     02  LINE   7  COLUMN  27  PIC  X(024) VALUE
001160          "請求日 　'  年   月   日".
001170     02  LINE  22  COLUMN  35  PIC  X(022) VALUE
001180          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
001190 01  C-ACP.
001200     02  A-NEN   LINE W-L  COLUMN  37  PIC  9(002)
001210          USING W-NEN2  CHECK OVERFLOW NO IFC.
001220     02  A-GET   LINE W-L  COLUMN  42  PIC  9(002)
001230          USING W-GET   CHECK OVERFLOW NO IFC.
001240     02  A-PEY   LINE W-L  COLUMN  47  PIC  9(002)
001250          USING W-PEY   CHECK OVERFLOW NO IFC.
001260     02  A-DMM   LINE  22  COLUMN  52  PIC  9(001)
001270          USING W-DMM   CHECK OVERFLOW NO IFC.
001280 01  C-DSP.
001290     02  D-MID   LINE   1  COLUMN   1  PIC  N(007) FROM  W-NA.
001300     02  D-INVM  LINE  10  COLUMN   1  PIC  X(034) VALUE
001310          "単価なし 指図№   ｺｰﾄﾞ  品      名".
001320     02  D-INV   LINE  W-L.
001330       03  COLUMN  10  PIC  X(007) FROM  HSMS-KEY.
001340       03  COLUMN  18  PIC  9(006) FROM  HSMS-09.
001350       03  COLUMN  25  PIC  N(024) FROM  HI-NAME.
001360     02  D-INVC  LINE  W-L.
001370       03  COLUMN  10  PIC  X(050) VALUE
001380            "                                                  ".
001390       03  COLUMN  60  PIC  X(013) VALUE "             ".
001400 01  C-ERR.
001410     02  LINE  24.
001420       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
001430            "***  ﾃﾞｰﾀ ﾅｼ  ***".
001440       03  E-ME2   COLUMN  15  PIC  X(018) VALUE
001450            "***  ﾄｸｲｻｷ ﾅｼ  ***".
001460       03  E-ME3   COLUMN  15  PIC  X(017) VALUE
001470            "***  ﾋﾝﾒｲ ﾅｼ  ***".
001480       03  E-ME4   COLUMN  15  PIC  X(017) VALUE
001490            "***  HUHM ﾅｼ  ***".
001500       03  E-ME5   COLUMN  15  PIC  X(021) VALUE
001510            "***  ﾌﾘｶｴﾀﾝｶ ｴﾗｰ  ***".
001520       03  E-ME10  COLUMN  15  PIC  X(021) VALUE
001530            "***  REWRITE ｴﾗｰ  ***".
001540       03  E-KEY   COLUMN  38  PIC  X(007) FROM  HSMS-KEY.
001550       03  E-TCD   COLUMN  46  PIC  9(004) FROM  T-TCD.
001560       03  E-HCD   COLUMN  51  PIC  9(006) FROM  HSMS-09.
001570       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".
001580       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
001590       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
001600       03  E-CL.
001610         04  COLUMN   1  PIC  X(040) VALUE
001620              "                                        ".
001630         04  COLUMN  41  PIC  X(040) VALUE
001640              "                                        ".
001650       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
001660     COPY LIBSCR.
001670 PROCEDURE DIVISION.
001680 M-05.
001690     ACCEPT JS-SIGN.
001700     IF JS-SIGN = 1
001710         MOVE NC"【ワークマン】" TO W-NA
001720       ELSE
001730         IF JS-SIGN = 2
001740             MOVE NC"　【ナフコ】　" TO W-NA
001750           ELSE
001760             MOVE 255 TO COMPLETION-CODE
001770             STOP RUN.
001780*
001790     DISPLAY C-CLEAR.
001800     DISPLAY C-MID.
001810     DISPLAY D-MID.
001820*
001830     COPY LIBCPR.
001840     MOVE ZERO TO W-NGP.
001850     MOVE D-NHNG TO W-NGS.
001860     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
001870         ADD DATE-NC1 TO W-NEN.
001880     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
001890         ADD DATE-NC2 TO W-NEN.
001900     MOVE W-NG TO W-NGD.
001910     ADD 1 TO W-GET.
001920     IF W-GET = 13
001930         ADD 1 TO W-NEN
001940         MOVE 1 TO W-GET.
001950     MOVE W-NG TO W-ENGD.
001960*
001970     OPEN I-O HSMSF.
001980*
001990     PERFORM SET-RTN THRU SET-EX.
002000     IF COMPLETION-CODE = 255
002010         GO TO M-95.
002020*
002030     OPEN INPUT T-M.
002040     OPEN INPUT TSKF.
002050*
002060     IF JS-SIGN = 1
002070         MOVE 9850 TO T-KEY
002080       ELSE
002090         IF JS-SIGN = 2
002100             MOVE 5000 TO T-KEY.
002110     READ T-M WITH UNLOCK INVALID KEY
002120         MOVE 255 TO COMPLETION-CODE
002130         CLOSE HSMSF
002140         CLOSE T-M TSKF
002150         DISPLAY E-ME2 E-TCD E-ME99
002160         GO TO M-95.
002170*
002180     MOVE 5 TO W-L.
002190     IF W-NGP = 99999999                                          I.130115
002200           MOVE ZERO TO W-NGP.                                    I.130115
002210     DISPLAY A-NEN A-GET A-PEY.                                   I.130115
002220 M-10.
002230     ACCEPT A-NEN.
002240     IF ESTAT = PF9
002250         MOVE 255 TO COMPLETION-CODE
002260         CLOSE HSMSF
002270         CLOSE T-M TSKF
002280         GO TO M-95.
002290     IF ESTAT NOT = HTB AND SKP
002300         GO TO M-10.
002310     MOVE ZERO TO W-NEN1.
002320     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
002330         ADD DATE-NC1 TO W-NEN.
002340     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
002350         ADD DATE-NC2 TO W-NEN.
002360 M-15.
002370     ACCEPT A-GET.
002380     IF ESTAT = BTB
002390         GO TO M-10.
002400     IF ESTAT NOT = HTB AND SKP
002410         GO TO M-15.
002420     IF W-GET < 1 OR > 12
002430         GO TO M-15.
002440 M-20.
002450     ACCEPT A-PEY.
002460     IF ESTAT = BTB
002470         GO TO M-15.
002480     IF ESTAT NOT = HTB AND SKP
002490         GO TO M-20.
002500     IF W-PEY < 1 OR > 31
002510         GO TO M-20.
002520     MOVE W-NGP TO W-SNGP.
002530     PERFORM SKD-RTN THRU SKD-EX.
002540     MOVE 7 TO W-L.
002550     MOVE W-SDTD TO W-NGP.
002560     DISPLAY A-NEN A-GET A-PEY.
002570 M-25.
002580     ACCEPT A-NEN.
002590     IF ESTAT = BTB
002600         MOVE 5 TO W-L
002610         MOVE W-SNGP TO W-NGP
002620         GO TO M-20.
002630     IF ESTAT NOT = HTB AND SKP
002640         GO TO M-25.
002650     MOVE ZERO TO W-NEN1.
002660     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
002670         ADD DATE-NC1 TO W-NEN.
002680     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
002690         ADD DATE-NC2 TO W-NEN.
002700 M-30.
002710     ACCEPT A-GET.
002720     IF ESTAT = BTB
002730         GO TO M-25.
002740     IF ESTAT NOT = HTB AND SKP
002750         GO TO M-30.
002760     IF W-GET < 1 OR > 12
002770         GO TO M-30.
002780     IF W-NG NOT = W-NGD AND W-ENGD
002790         GO TO M-30.
002800 M-35.
002810     ACCEPT A-PEY.
002820     IF ESTAT = BTB
002830         GO TO M-30.
002840     IF ESTAT NOT = HTB AND SKP
002850         GO TO M-35.
002860     IF W-PEY < 1 OR > 31
002870         GO TO M-35.
002880     MOVE W-NGP TO W-MNGP.
002890 M-40.
002900     ACCEPT A-DMM.
002910     IF ESTAT = BTB
002920         GO TO M-35.
002930     IF ESTAT NOT = HTB AND SKP
002940         GO TO M-40.
002950     IF W-DMM = 9
002960         MOVE 5 TO W-L
002970         MOVE W-SNGP TO W-NGP
002980         GO TO M-10.
002990     IF W-DMM NOT = 1
003000         GO TO M-40.
003010*
003020     CLOSE HSMSF.
003030     OPEN I-O HSMSF.
003040 M-45.
003050     READ HSMSF NEXT RECORD AT END
003060         CLOSE T-M TSKF
003070         CLOSE HSMSF
003080         MOVE 255 TO COMPLETION-CODE
003090         DISPLAY E-ME1 E-ME99
003100         GO TO M-95.
003110     IF HSMS-02 = 7
003120         GO TO M-45.
003130     IF HSMS-061 NOT = T-TCD
003140         GO TO M-45.
003150     IF HSMS-03 NOT = 0
003160         GO TO M-45.
003170     IF HSMS-05 NOT = W-SNGP
003180         GO TO M-45.
003190     IF HSMS-23 = 1
003200         GO TO M-45.
003210*
003220     OPEN INPUT HI-M.
003230     OPEN INPUT HUH-M.
003240     OPEN INPUT THTM.
003250     MOVE 0 TO W-INV.
003260 M-50.
003270     MOVE HSMS-01 TO W-SNO.
003280     IF HSMS-02 = 7
003290         GO TO M-75.
003300 M-55.
003310     IF HSMS-02 = 7
003320         GO TO M-70.
003330     MOVE 0 TO W-TAN.
003340     IF HSMS-25 = 1
003350         GO TO M-65.
003360     MOVE HSMS-061 TO THT-TCD.
003370     MOVE HSMS-09 TO THT-HCD.
003380     MOVE HSMS-10 TO THT-SIZ.
003390     READ THTM UNLOCK INVALID
003400         MOVE ZERO TO THT-T.
003410     MOVE THT-T TO W-TAN.
003420     IF W-TAN NOT = ZERO
003430         GO TO M-60.
003440     MOVE HSMS-061 TO THT-TCD.
003450     MOVE HSMS-09 TO THT-HCD.
003460     MOVE 9 TO THT-SIZ.
003470     READ THTM UNLOCK INVALID
003480         MOVE ZERO TO THT-T.
003490     MOVE THT-T TO W-TAN.
003500 M-60.
003510     IF W-TAN NOT = ZERO
003520         GO TO M-65.
003530     MOVE HSMS-09 TO HI-KEY.
003540     READ HI-M WITH UNLOCK INVALID KEY
003550         MOVE SPACE TO HI-NAME
003560         MOVE NC"＊＊　品名なし　＊＊" TO HI-NAME.
003570     IF W-INV = 0
003580         MOVE 1 TO W-INV
003590         MOVE 10 TO W-L
003600         DISPLAY D-INVM.
003610     ADD 1 TO W-L.
003620     IF W-L > 20
003630          PERFORM CLR-RTN THRU CLR-EX.
003640     DISPLAY D-INV E-ME99.
003650 M-65.
003660     PERFORM HUH-RTN THRU HUH-EX.
003670     IF COMPLETION-CODE = 255
003680         GO TO M-90.
003690     MOVE W-MNGP TO HSMS-18.
003700     IF HSMS-25 NOT = 1
003710         MOVE W-TAN TO HSMS-17.
003720 M-70.
003730     MOVE 1 TO HSMS-26.
003740     REWRITE HSMS-R1 INVALID KEY
003750         MOVE 255 TO COMPLETION-CODE
003760         DISPLAY E-STAT E-ME78 E-ME10 E-KEY E-TCD E-HCD E-ME99
003770         GO TO M-90.
003780 M-75.
003790     READ HSMSF NEXT RECORD AT END
003800         GO TO M-90.
003810     IF HSMS-01 = W-SNO
003820         GO TO M-55.
003830     IF HSMS-061 NOT = T-TCD
003840         GO TO M-75.
003850     IF HSMS-03 NOT = 0
003860         GO TO M-75.
003870     IF HSMS-05 NOT = W-SNGP
003880         GO TO M-75.
003890     IF HSMS-23 = 1
003900         GO TO M-75.
003910     GO TO M-50.
003920 M-90.
003930     CLOSE THTM.
003940     CLOSE HI-M.
003950     CLOSE HUH-M.
003960     CLOSE TSKF.
003970     CLOSE T-M.
003980     CLOSE HSMSF.
003990     IF W-INV = 1
004000         MOVE 255 TO COMPLETION-CODE.
004010 M-95.
004020     DISPLAY C-CLEAR.
004030     STOP RUN.
004040 SET-RTN.
004050     READ HSMSF NEXT RECORD AT END
004060         CLOSE HSMSF
004070         MOVE 255 TO COMPLETION-CODE
004080         DISPLAY E-ME1 E-ME99
004090         GO TO SET-EX.
004100     IF HSMS-061 NOT = 5000 AND 9850
004110         GO TO SET-RTN.
004120     MOVE 99999999 TO W-NGP.                                      I.130115
004130 SET-010.
004140     IF JS-SIGN = 1                                               I.130115
004150         IF HSMS-061 = 9850                                       I.130115
004160             IF HSMS-23 = 0                                       I.130115
004170                 IF HSMS-05 <= W-NGP                              I.130115
004180                     MOVE HSMS-05 TO W-NGP.                       I.130115
004190     IF JS-SIGN = 2                                               I.130115
004200         IF HSMS-061 = 5000                                       I.130115
004210             IF HSMS-23 = 0                                       I.130115
004220                 IF HSMS-05 <= W-NGP                              I.130115
004230                     MOVE HSMS-05 TO W-NGP.                       I.130115
004240     IF HSMS-26 = 0
004250         GO TO SET-020.
004260     MOVE 0 TO HSMS-26.
004270     REWRITE HSMS-R1 INVALID KEY
004280         CLOSE HSMSF
004290         MOVE 255 TO COMPLETION-CODE
004300         DISPLAY E-STAT E-ME78 E-ME10 E-KEY E-TCD E-HCD E-ME99
004310         GO TO SET-EX.
004320 SET-020.
004330     READ HSMSF NEXT RECORD AT END
004340         GO TO SET-EX.
004350     IF HSMS-061 NOT = 5000 AND 9850
004360         GO TO SET-020.
004370     GO TO SET-010.
004380 SET-EX.
004390     EXIT.
004400 CLR-RTN.
004410     MOVE 10 TO W-L.
004420 CLR-010.
004430     ADD 1 TO W-L.
004440     IF W-L < 21
004450         DISPLAY D-INVC
004460         GO TO CLR-010.
004470     MOVE 11 TO W-L.
004480 CLR-EX.
004490     EXIT.
004500 SKD-RTN.
004510     MOVE T-KEY TO TSK-KEY.
004520     READ TSKF WITH UNLOCK INVALID KEY
004530         MOVE ZERO TO TSK-R.
004540     MOVE TSK-ZNGP(4) TO W-SDATE.
004550     IF TSK-ZNGP(5) NOT = ZERO
004560         MOVE TSK-ZNGP(5) TO W-SDATE.
004570*
004580     MOVE ZERO TO W-SDTD.
004590     MOVE W-NGP TO W-SDTD.
004600 SKD-010.
004610     MOVE T-SS TO W-SDTP.
004620     IF W-SDTP = 00 OR 99
004630         MOVE ZERO TO W-SDTD
004640         GO TO SKD-EX.
004650     IF W-SDTP = 30 OR 31
004660         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
004670             MOVE 31 TO W-SDTP
004680           ELSE
004690             IF W-SDTG = 4 OR 6 OR 9 OR 11
004700                 MOVE 30 TO W-SDTP
004710               ELSE
004720                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1
004730                                           REMAINDER W-DTW2
004740                 IF W-DTW2 = 0
004750                     MOVE 29 TO W-SDTP
004760                   ELSE
004770                     MOVE 28 TO W-SDTP.
004780     IF W-NGP > W-SDTD
004790         IF W-GET NOT = W-SDTG
004800             MOVE ZERO TO W-SDTD
004810             GO TO SKD-EX
004820           ELSE
004830             ADD 1 TO W-SDTG
004840             GO TO SKD-020.
004850     IF W-SDATE NOT = ZERO
004860         IF W-SDATE >= W-SDTD
004870             ADD 1 TO W-SDTG
004880             GO TO SKD-020.
004890     GO TO SKD-EX.
004900 SKD-020.
004910     IF W-SDTG = 13
004920         MOVE 1 TO W-SDTG
004930         ADD 1 TO W-SDTN.
004940     GO TO SKD-010.
004950 SKD-EX.
004960     EXIT.
004970 HUH-RTN.
004980     MOVE HSMS-09 TO HI-KEY.
004990     READ HI-M WITH UNLOCK INVALID KEY
005000         MOVE 255 TO COMPLETION-CODE
005010         DISPLAY E-ME3 E-KEY E-HCD E-ME99
005020         GO TO HUH-EX.
005030     MOVE HSMS-09 TO HUH-KEY.
005040     READ HUH-M WITH UNLOCK INVALID KEY
005050         MOVE 255 TO COMPLETION-CODE
005060         DISPLAY E-ME4 E-KEY E-HCD E-ME99
005070         DISPLAY E-CL
005080         GO TO HUH-EX.
005090     IF (HUH-ZK NOT = ZERO) AND (HUH-ZS NOT = ZERO)
005100         COMPUTE W-FTD = HUH-ZK / HUH-ZS
005110         IF HI-FT NOT = W-FTD
005120             MOVE 255 TO COMPLETION-CODE
005130             DISPLAY E-ME5 E-KEY E-HCD E-ME99
005140             DISPLAY E-CL
005150             GO TO HUH-EX.
005160     IF (HUH-NK NOT = ZERO) AND (HUH-NS NOT = ZERO)
005170         COMPUTE W-FTD = HUH-NK / HUH-NS
005180         IF HI-FT NOT = W-FTD
005190             MOVE 255 TO COMPLETION-CODE
005200             DISPLAY E-ME5 E-KEY E-HCD E-ME99
005210             DISPLAY E-CL
005220             GO TO HUH-EX.
005230     IF (HUH-UG NOT = ZERO) AND (HUH-SS NOT = ZERO)
005240         COMPUTE W-FTD = HUH-UG / HUH-SS
005250         IF HI-FT NOT = W-FTD
005260             MOVE 255 TO COMPLETION-CODE
005270             DISPLAY E-ME5 E-KEY E-HCD E-ME99
005280             DISPLAY E-CL
005290             GO TO HUH-EX.
005300     IF (HUH-YK NOT = ZERO) AND (HUH-YS NOT = ZERO)
005310         COMPUTE W-FTD = HUH-YK / HUH-YS
005320         IF HI-FT NOT = W-FTD
005330             MOVE 255 TO COMPLETION-CODE
005340             DISPLAY E-ME5 E-KEY E-HCD E-ME99
005350             DISPLAY E-CL.
005360 HUH-EX.
005370     EXIT.
