000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD030.
000030*********************************************************
000040*    PROGRAM         :  出荷ファイル生成                *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  62/04/14                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160*****COPY LIBCSE.                                                 D.970108
000170*****SELECT HZ-M ASSIGN TO HZ-MSD                                 D.970108
000180*****    ORGANIZATION INDEXED                                     D.970108
000190*****    ACCESS MODE DYNAMIC                                      D.970108
000200*****    RECORD KEY HZ-KEY.                                       D.970108
000210     SELECT S-TRAN ASSIGN TO S-MSD.
000220*****SELECT SYU-F ASSIGN TO SYU-MSD.                              D.940620
000230*****SELECT SYU-F ASSIGN TO SYU-MSD                               D.970108
000240*****    FILE STATUS ERR-STAT.                                    D.970108
000250*****SELECT AZ-F ASSIGN TO AZ-MSD.                                D.940620
000260*****SELECT AZ-F ASSIGN TO AZ-MSD                                 D.970108
000270*****    FILE STATUS ERR-STAT.                                    D.970108
000280*****SELECT HPR-F ASSIGN TO HPR-MSD.                              D.940620
000290*****SELECT HPR-F ASSIGN TO HPR-MSD                               D.961105
000300*****    FILE STATUS ERR-STAT.                                    D.961105
000310*****SELECT FRHP-F ASSIGN TO FRHP-MSD                             D.961105
000320*****    ORGANIZATION INDEXED                                     D.961105
000330*****    ACCESS MODE DYNAMIC                                      D.961105
000340*****    RECORD KEY FR-KEY                                        D.961105
000350*****    FILE STATUS ERR-STAT.                                    D.961105
000360*****SELECT STRANYR ASSIGN TO STRANYR-MSD.                        D.940620
000370*****SELECT STRF ASSIGN TO STR-MSD                                D.961105
000380*****    FILE STATUS ERR-STAT.                                    D.961105
000390*****SELECT SNTRF ASSIGN TO SNTR-MSD                              D.970108
000400*****    FILE STATUS ERR-STAT.                                    D.970108
000410     SELECT STRANYR ASSIGN TO STRANYR-MSD                         I.940620
000420         FILE STATUS ERR-STAT.                                    I.940620
000430     SELECT R-STRANYR ASSIGN TO RSTRANYR-RDB                      I.040326
000440         FILE STATUS ERR-STAT.                                    I.040326
000450*I-O-CONTROL.                                                     D.970108
000460*****APPLY SHARED-MODE ON M-DATE                                  D.970108
000470*****APPLY SHARED-MODE ON HZ-M.                                   D.970108
000480 DATA DIVISION.
000490 FILE SECTION.
000500*****COPY LIBFDD.                                                 D.970108
000510*****COPY LIHZM.                                                  D.970108
000520 FD  S-TRAN
000530     BLOCK  2 RECORDS
000540     LABEL RECORD IS STANDARD
000550     VALUE OF IDENTIFICATION "STRAN".                             C 62/04
000560 01  ST-R.
000570     02  ST-KEY         PIC  9(007).                              I.000817
000580     02  ST-KEYD  REDEFINES ST-KEY.                               I.040326
000590       03  ST-DNO       PIC  9(006).                              I.040326
000600       03  ST-GNO       PIC  9(001).                              I.040326
000610     02  F              PIC  X(121).                              I.000817
000620*****02  ST-YMD         PIC  9(006).                              D.000817
000630*****02  ST-TCD         PIC  9(004).                              D.000817
000640*****02  ST-SCD         PIC  9(006).                              D.000817
000650*****02  ST-SIZ         PIC  9(001).                              D.000817
000660*****02  ST-SU    OCCURS  10  PIC S9(004).                        D.000817
000670*****02  ST-ST          PIC S9(005).                              D.000817
000680*****02  ST-TAN         PIC  9(004).                              D.941208
000690*****02  ST-TAN         PIC  9(005).                              D.000817
000700*****02  ST-KIN         PIC S9(008).                              D.000817
000710*****02  ST-CSC         PIC  9(001).                              D.000817
000720*****02  ST-DNK         PIC  9(001).                              D.000817
000730*****02  ST-FTN         PIC  9(004).                              D.941208
000740*****02  ST-FTN         PIC  9(005).                              D.000817
000750*****02  ST-NO.                                                   D.000817
000760*****  03  ST-SEQ       PIC  9(003).                              D.000817
000770*****  03  ST-GNO       PIC  9(001).                              D.000817
000780*****02  ST-CCD         PIC  9(003).                              D.000817
000790*****02  ST-BC1         PIC  9(002).                              D.000817
000800*****02  ST-BC2         PIC  9(002).                              D.000817
000810*****02  ST-BC3         PIC  9(002).                              D.000817
000820*****02  ST-SKC         PIC  9(001).                              D.000817
000830*****02  ST-TC2         PIC  9(002).                              D.000817
000840*****02  ST-FKC         PIC  9(002).                              D.000817
000850*****02  ST-19          PIC  9(001).                              D.000817
000860*****02  ST-20          PIC  9(006).                              D.000817
000870*****02  ST-21          PIC  9(003).                              D.000817
000880*****02  ST-22.                                                   D.000817
000890*****  03  ST-221       PIC  9(006).                              D.000817
000900*****  03  ST-222       PIC  9(001).                              D.000817
000910*****02  F              PIC  X(013).                              D.941208
000920*****02  F              PIC  X(011).                              D.000817
000930*FD  SYU-F                                                        D.970108
000940*****BLOCK  4 RECORDS                                             D.970108
000950*****LABEL RECORD IS STANDARD                                     D.970108
000960*****VALUE OF IDENTIFICATION  "SYUF".                             D.970108
000970*01  SYU-R.                                                       D.970108
000980*****02  S-DATE         PIC  9(006).                              D.970108
000990*****02  S-TCD          PIC  9(004).                              D.970108
001000*****02  S-HCD          PIC  9(006).                              D.970108
001010*****02  S-SIZ          PIC  9(001).                              D.970108
001020*****02  S-S            PIC  9(003).                              D.970108
001030*****02  S-SU           PIC S9(005).                              D.970108
001040*****02  S-T            PIC  9(004).                              D.941208
001050*****02  S-T            PIC  9(005).                              D.970108
001060*****02  S-UKI          PIC S9(008).                              D.970108
001070*****02  S-FT           PIC  9(004).                              D.941208
001080*****02  S-FT           PIC  9(005).                              D.970108
001090*****02  S-SKI          PIC S9(008).                              D.970108
001100*****02  S-DK           PIC  9(001).                              D.970108
001110*****02  S-BC1          PIC  9(002).                              D.970108
001120*****02  S-BC2          PIC  9(002).                              D.970108
001130*****02  S-BC3          PIC  9(002).                              D.970108
001140*****02  S-SKC          PIC  9(001).                              D.970108
001150*****02  S-TC2          PIC  9(002).                              D.970108
001160*****02  S-FKC          PIC  9(002).                              D.970108
001170*****02  F              PIC  X(003).                              D.941208
001180*****02  F              PIC  X(001).                              D.970108
001190*FD  AZ-F                                                         D.970108
001200*****BLOCK  8 RECORDS                                             D.970108
001210*****LABEL RECORD IS STANDARD                                     D.970108
001220*****VALUE OF IDENTIFICATION "AZF".                               D.970108
001230*01  AZ-R.                                                        D.970108
001240*****02  A-TCD          PIC  9(004).                              D.970108
001250*****02  A-HCD          PIC  9(006).                              D.970108
001260*****02  A-DATE         PIC  9(006).                              D.970108
001270*****02  A-DK           PIC  9(001).                              D.970108
001280*****02  A-SU           PIC S9(005).                              D.970108
001290*****02  A-NO.                                                    D.970108
001300*****  03  A-NO1        PIC  9(006).                              D.970108
001310*****  03  A-NO2        PIC  9(001).                              D.970108
001320*****02  F              PIC  X(003).                              D.970108
001330*FD  HPR-F                                                        D.961105
001340*****BLOCK  6 RECORDS                                             D.961105
001350*****LABEL RECORD IS STANDARD                                     D.961105
001360*****VALUE OF IDENTIFICATION "HPRF".                              D.961105
001370*01  HPR-R.                                                       D.961105
001380*****02  HP-YMD         PIC  9(006).                              D.961105
001390*****02  HP-TCD         PIC  9(004).                              D.961105
001400*****02  HP-SCD         PIC  9(006).                              D.961105
001410*****02  HP-ST          PIC S9(006).                              D.961105
001420*****02  HP-TAN         PIC  9(004).                              D.941208
001430*****02  HP-TAN         PIC  9(005).                              D.961105
001440*****02  HP-KIN         PIC S9(008).                              D.961105
001450*****02  HP-TC2         PIC  9(002).                              D.961105
001460*****02  F              PIC  X(006).                              D.941208
001470*****02  F              PIC  X(005).                              D.961105
001480*FD  FRHP-F                                                       D.961105
001490*****BLOCK  8 RECORDS                                             D.961105
001500*****LABEL RECORD IS STANDARD                                     D.961105
001510*****VALUE OF IDENTIFICATION "FRHPF".                             D.961105
001520*01  FRHP-R.                                                      D.961105
001530*****02  FR-KEY         PIC  X(006).                              D.961105
001540*****02  FR-SU          PIC S9(006).                              D.961105
001550*****02  FR-KIN         PIC S9(008).                              D.961105
001560*****02  FR-BC1         PIC  9(002).                              D.961105
001570*****02  FR-BC2         PIC  9(002).                              D.961105
001580*****02  FR-BC3         PIC  9(002).                              D.961105
001590*****02  F              PIC  X(002).                              D.961105
001600*****02  FR-NG          PIC  9(004).                              D.961105
001610*FD  STRF                                                         D.961105
001620*****BLOCK  5 RECORDS                                             D.961105
001630*****LABEL RECORD IS STANDARD                                     D.961105
001640*****VALUE OF IDENTIFICATION "STRF".                              D.961105
001650*01  STR-R.                                                       D.961105
001660*****02  STR-YMD        PIC  9(006).                              D.961105
001670*****02  STR-TCD        PIC  9(004).                              D.961105
001680*****02  STR-SCD        PIC  9(006).                              D.961105
001690*****02  STR-ST         PIC S9(005).                              D.961105
001700*****02  STR-TAN        PIC  9(004).                              D.941208
001710*****02  STR-TAN        PIC  9(005).                              D.961105
001720*****02  STR-KIN        PIC S9(008).                              D.961105
001730*****02  STR-FTN        PIC  9(004).                              D.941208
001740*****02  STR-FTN        PIC  9(005).                              D.961105
001750*****02  STR-CSC        PIC  9(001).                              D.961105
001760*****02  STR-DNK        PIC  9(001).                              D.961105
001770*****02  STR-BC1        PIC  9(002).                              D.961105
001780*****02  STR-BC2        PIC  9(002).                              D.961105
001790*****02  STR-BC3        PIC  9(002).                              D.961105
001800*****02  STR-TC2        PIC  9(002).                              D.961105
001810*****02  STR-UNC        PIC  9(001).                              D.961105
001820*****02  F              PIC  X(003).                              D.941208
001830*****02  F              PIC  X(001).                              D.961105
001840*FD  SNTRF                                                        D.970108
001850*****BLOCK  2 RECORDS                                             D.970108
001860*****LABEL RECORD IS STANDARD                                     D.970108
001870*****VALUE OF IDENTIFICATION "SNTRF".                             D.970108
001880*01  SNTR-R.                                                      D.970108
001890*****02  F              PIC  X(127).                              D.970108
001900*****02  SNTR-UNC       PIC  X(001).                              D.970108
001910 FD  STRANYR                                                      I.940413
001920     BLOCK  2 RECORDS                                             I.940413
001930     LABEL RECORD IS STANDARD                                     I.940413
001940     VALUE OF IDENTIFICATION "STRANYR".                           I.940413
001950 01  STRANYR-R          PIC  X(128).                              I.940413
001960 FD  R-STRANYR                                                    I.040326
001970     BLOCK  2 RECORDS                                             I.040326
001980     LABEL RECORD IS STANDARD                                     I.040326
001990     VALUE OF IDENTIFICATION "STRANYR-RDB".                       I.040326
002000 01  RSTRANYR-R         PIC  X(128).                              I.040326
002010 WORKING-STORAGE  SECTION.
002020 77  W-FILE             PIC  X(013).                              I.940620
002030 77  W-END              PIC  9(001) VALUE ZERO.                   I.961028
002040*77  W-EC               PIC  9(001) VALUE ZERO.                   D.970108
002050*77  CHK                PIC  9(001) VALUE ZERO.                   D.970108
002060*77  CNT                PIC  9(002) VALUE ZERO.                   D.970108
002070*77  W-NG               PIC  9(004) VALUE ZERO.                   D.970108
002080*01  TBLD.                                                        D.970108
002090*****02  TBL1           PIC  X(030) VALUE                         D.970108
002100*****     "003002001000201301401280290300".                       D.970108
002110*****02  TBL2           PIC  X(030) VALUE                         D.970108
002120*****     "125130135140150160170180190200".                       D.970108
002130*****02  TBL3           PIC  X(030) VALUE                         D.970108
002140*****     "210215220225230235240245250   ".                       D.970108
002150*****02  TBL4           PIC  X(030) VALUE                         D.970108
002160*****     "240245250255260265270275      ".                       D.970108
002170*01  TBLE.                                                        D.970108
002180*****02  TBL     OCCURS  10  PIC  X(003).                         D.970108
002190 01  ERR-STAT           PIC  X(002).
002200 SCREEN SECTION.
002210 SD  C-CRT
002220     END STATUS IS ESTAT.
002230 01  C-CLEAR.
002240     02  C-CL    LINE   1  CLEAR SCREEN.
002250 01  C-MID.
002260     02  LINE   3  COLUMN  10   PIC  N(016) VALUE
002270          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002280     02  LINE   4  COLUMN  10   PIC  N(016) VALUE
002290          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002300     02  LINE   5  COLUMN  10   PIC  N(016) VALUE
002310          NC"＊＊＊　　　　　　　　　　＊＊＊".
002320     02  LINE   6  COLUMN  10   PIC  N(016) VALUE
002330          NC"＊＊＊　出荷ファイル累積　＊＊＊".
002340     02  LINE   7  COLUMN  10   PIC  N(016) VALUE
002350          NC"＊＊＊　　　　　　　　　　＊＊＊".
002360     02  LINE   8  COLUMN  10   PIC  N(016) VALUE
002370          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002380     02  LINE   9  COLUMN  10   PIC  N(016) VALUE
002390          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
002400 01  C-ERR.
002410     02  LINE  24.
002420*****  03  E-ME1   COLUMN  15  PIC  X(025) VALUE                  D.961105
002430*****       "***  FRHPF WRITE ｴﾗｰ  ***".                          D.961105
002440*****  03  E-ME2   COLUMN  15  PIC  X(027) VALUE                  D.961105
002450*****       "***  FRHPF REWRITE ｴﾗｰ  ***".                        D.961105
002460*****  03  E-ME3   COLUMN  15  PIC  X(026) VALUE                  D.961105
002470*****       "***  FRHPF DELETE ｴﾗｰ  ***".                         D.961105
002480*****  03  E-ME4   COLUMN  15  PIC  X(016) VALUE                  D.970108
002490*****       "***  HZM ﾅｼ  ***".                                   D.970108
002500*****  03  E-ME5   COLUMN  15  PIC  X(024) VALUE                  D.970108
002510*****       "***  SYUF WRITE ｴﾗｰ  ***".                           D.970108
002520*****  03  E-ME6   COLUMN  15  PIC  X(023) VALUE                  D.970108
002530*****       "***  AZF WRITE ｴﾗｰ  ***".                            D.970108
002540*****  03  E-ME7   COLUMN  15  PIC  X(024) VALUE                  D.961105
002550*****       "***  HPRF WRITE ｴﾗｰ  ***".                           D.961105
002560       03  E-ME8   COLUMN  15  PIC  X(027) VALUE                  I.940620
002570            "***  STRANYR WRITE ｴﾗｰ  ***".                        I.940620
002580       03  E-ME11  COLUMN  15  PIC  X(029) VALUE                  I.040326
002590            "***  R-STRANYR WRITE ｴﾗｰ  ***".                      I.040326
002600*****  03  E-ME9   COLUMN  15  PIC  X(024) VALUE                  D.961105
002610*****       "***  STRF WRITE ｴﾗｰ  ***".                           D.961105
002620*****  03  E-ME10  COLUMN  15  PIC  X(025) VALUE                  D.970108
002630*****       "***  SNTRF WRITE ｴﾗｰ  ***".                          D.970108
002640*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.940620
002650*****  03  E-NO    COLUMN  50  PIC  X(004) FROM  ST-NO.           D.961028
002660*****  03  E-KEY   COLUMN  50  PIC  9(006) FROM  ST-SCD.          D.961028
002670*****  03  E-KEY.                                                 D.000817
002680*****    04  COLUMN  50  PIC  9(006) FROM  ST-20.                 D.000817
002690*****    04  COLUMN  58  PIC  X(004) FROM  ST-NO.                 D.000817
002700*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.940620
002710*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.940620
002720       03  E-KEY   COLUMN  50  PIC  9(007) FROM  ST-KEY.          I.000817
002730     COPY LSSEM.                                                  I.940620
002740*****COPY LIBSCR.                                                 D.970108
002750 PROCEDURE   DIVISION.
002760 M-05.
002770*****COPY LIBCPR.                                                 D.970108
002780*****MOVE D-NHNG TO W-NG.                                         D.970108
002790     DISPLAY C-CLEAR.
002800     DISPLAY C-MID.
002810     OPEN INPUT S-TRAN.
002820*****OPEN EXTEND SYU-F.                                           D.970108
002830*****OPEN EXTEND AZ-F.                                            D.970108
002840*****OPEN EXTEND HPR-F.                                           D.961105
002850     OPEN EXTEND STRANYR.                                         I.940413
002860     OPEN EXTEND R-STRANYR.                                       I.040326
002870*****OPEN EXTEND STRF.                                            D.961105
002880*****OPEN EXTEND SNTRF.                                           D.970108
002890*****OPEN I-O FRHP-F.                                             D.961105
002900*****OPEN INPUT HZ-M.                                             D.970108
002910 M-10.
002920     READ S-TRAN AT END
002930        GO TO M-95.
002940*****IF ST-SCD = ZERO                                             D.000817
002950*****    GO TO M-10.                                              D.000817
002960*
002970     PERFORM STYR-RTN THRU STYR-EX.                               I.961028
002980     IF W-END = 9                                                 I.961028
002990         GO TO M-95.                                              I.961028
003000     IF ST-GNO > 6                                                I.040326
003010         GO TO M-10.                                              I.040326
003020*
003030     PERFORM RSTYR-RTN THRU RSTYR-EX.                             I.040326
003040     IF W-END = 9                                                 I.040326
003050         GO TO M-95.                                              I.040326
003060*
003070*****PERFORM SNTR-RTN THRU SNTR-EX.                               D.970108
003080*****IF W-END = 9                                                 D.970108
003090*****    GO TO M-95.                                              D.970108
003100*M-15.                                                            D.961028
003110*****INITIALIZE STRANYR-R.                                        D.961028
003120*****MOVE ST-R TO STRANYR-R.                                      D.961028
003130*****WRITE STRANYR-R.                                             D.961028
003140*****IF ERR-STAT = "00"                                           D.961028
003150*****    CALL "CBLTCLS" USING STRANYR                             D.961028
003160*****    GO TO M-20.                                              D.961028
003170*****DISPLAY E-STAT E-ME8 E-ME99.                                 D.961028
003180*****IF ERR-STAT NOT = "34"                                       D.961028
003190*****    DISPLAY E-ME78 E-ME99                                    D.961028
003200*****    PERFORM S-90 THRU S-95.                                  D.961028
003210*****DISPLAY E-CL.                                                D.961028
003220*****CLOSE STRANYR.                                               D.961028
003230*****MOVE "STRANYR      " TO W-FILE.                              D.961028
003240*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961028
003250*****DISPLAY E-CL.                                                D.961028
003260*****OPEN EXTEND STRANYR.                                         D.961028
003270*****GO TO M-15.                                                  D.961028
003280*M-20.                                                            D.961028
003290*****IF ST-DNK = 8                                                D.970108
003300*****    GO TO M-10.                                              D.970108
003310*
003320*****PERFORM STR-RTN THRU STR-EX.                                 D.961105
003330*****IF W-END = 9                                                 D.961105
003340*****    GO TO M-95.                                              D.961105
003350*****INITIALIZE STR-R.                                            D.961028
003360*****MOVE ST-YMD TO STR-YMD.                                      D.961028
003370*****MOVE ST-TCD TO STR-TCD.                                      D.961028
003380*****MOVE ST-SCD TO STR-SCD.                                      D.961028
003390*****MOVE ST-ST TO STR-ST.                                        D.961028
003400*****MOVE ST-TAN TO STR-TAN.                                      D.961028
003410*****MOVE ST-KIN TO STR-KIN.                                      D.961028
003420*****MOVE ST-FTN TO STR-FTN.                                      D.961028
003430*****MOVE ST-CSC TO STR-CSC.                                      D.961028
003440*****MOVE ST-DNK TO STR-DNK.                                      D.961028
003450*****MOVE ST-BC1 TO STR-BC1.                                      D.961028
003460*****MOVE ST-BC2 TO STR-BC2.                                      D.961028
003470*****MOVE ST-BC3 TO STR-BC3.                                      D.961028
003480*****MOVE ST-TC2 TO STR-TC2.                                      D.961028
003490*****WRITE STR-R.                                                 D.961028
003500*****IF ERR-STAT = "00"                                           D.961028
003510*****    CALL "CBLTCLS" USING STRF                                D.961028
003520*****    GO TO M-22.                                              D.961028
003530*****DISPLAY E-STAT E-ME9 E-ME99.                                 D.961028
003540*****IF ERR-STAT NOT = "34"                                       D.961028
003550*****    DISPLAY E-ME78 E-ME99                                    D.961028
003560*****    PERFORM S-90 THRU S-95.                                  D.961028
003570*****DISPLAY E-CL.                                                D.961028
003580*****CLOSE STRF.                                                  D.961028
003590*****MOVE "STRF         " TO W-FILE.                              D.961028
003600*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961028
003610*****DISPLAY E-CL.                                                D.961028
003620*****OPEN EXTEND STRF.                                            D.961028
003630*****GO TO M-20.                                                  D.961028
003640*
003650*****PERFORM SYU-RTN THRU SYU-EX.                                 D.970108
003660*****IF W-END = 1                                                 D.970108
003670*****    MOVE 0 TO W-END                                          D.970108
003680*****    GO TO M-10.                                              D.970108
003690*****IF W-END = 9                                                 D.970108
003700*****    GO TO M-95.                                              D.970108
003710*M-22.                                                            D.961028
003720*****IF ST-DNK = 8 OR 6                                           *D920817
003730*****    GO TO M-60.                                              *D920817
003740*****IF ST-SCD < 999900                                           D.961028
003750*****    GO TO M-25.                                              D.961028
003760*****PERFORM S-05 THRU S-10.                                      D.961028
003770*****MOVE 1 TO S-SIZ.                                             *D920302
003780*****MOVE 003 TO S-S.                                             *D920302
003790*****MOVE ZERO TO HZ-KEY.                                         D.961028
003800*****MOVE ST-SCD TO HZ-HCD.                                       D.961028
003810*****START HZ-M KEY NOT < HZ-KEY INVALID KEY                      D.961028
003820*****    DISPLAY E-ME4 E-KEY E-ME99                               D.961028
003830*****    PERFORM S-90  THRU  S-95.                                D.961028
003840*****READ HZ-M NEXT RECORD WITH UNLOCK AT END                     D.961028
003850*****    DISPLAY E-ME4 E-KEY E-ME99                               D.961028
003860*****    PERFORM S-90 THRU S-95.                                  D.961028
003870*****IF ST-SCD NOT = HZ-HCD                                       D.961028
003880*****    DISPLAY E-ME4 E-KEY E-ME99                               D.961028
003890*****    PERFORM S-90 THRU S-95.                                  D.961028
003900*****MOVE HZ-SC TO S-SIZ.                                         D.961028
003910*****MOVE HZ-SIZ TO S-S.                                          D.961028
003920*****IF S-DK = ZERO                                               D.961028
003930*****    MOVE ST-KIN TO S-UKI                                     D.961028
003940*****  ELSE                                                       D.961028
003950*****    COMPUTE S-UKI = ST-KIN * -1.                             D.961028
003960*****WRITE SYU-R.                                                 D.961028
003970*****IF ERR-STAT = "00"                                           D.961028
003980*****    CALL "CBLTCLS" USING SYU-F                               D.961028
003990*****    GO TO M-10.                                              D.961028
004000*****PERFORM S-15 THRU S-20.                                      D.961028
004010*****GO TO M-20.                                                  D.961028
004020*M-25.                                                            D.961028
004030*****IF ST-DNK = 3                                                D.961028
004040*****    GO TO M-30.                                              D.961028
004050*****IF ST-SIZ = 1                                                D.961028
004060*****    MOVE TBL1 TO TBLE.                                       D.961028
004070*****IF ST-SIZ = 2                                                D.961028
004080*****    MOVE TBL2 TO TBLE.                                       D.961028
004090*****IF ST-SIZ = 3                                                D.961028
004100*****    MOVE TBL3 TO TBLE.                                       D.961028
004110*****IF ST-SIZ = 4                                                D.961028
004120*****    MOVE TBL4 TO TBLE.                                       D.961028
004130*M-30.                                                            D.961028
004140*****MOVE ZERO TO CNT.                                            D.961028
004150*M-35.                                                            D.961028
004160*****PERFORM S-05 THRU S-10.                                      D.961028
004170*****IF ST-DNK = 6                                                D.961028
004180*****    MOVE ST-KIN TO S-UKI                                     D.961028
004190*****    GO TO M-50.                                              D.961028
004200*****MOVE ST-SIZ TO S-SIZ.                                        D.961028
004210*****IF ST-DNK NOT = 4                                            *D911121
004220*****    MOVE ST-TAN TO S-T                                       *D911121
004230*****    MOVE ST-FTN TO S-FT.                                     *D911121
004240*****IF ST-DNK = 2                                                D.961028
004250*****    MOVE ST-TAN TO S-T                                       D.961028
004260*****  ELSE                                                       D.961028
004270*****    IF ST-DNK = 7                                            D.961028
004280*****        MOVE ST-FTN TO S-FT                                  D.961028
004290*****      ELSE                                                   D.961028
004300*****        IF ST-DNK NOT = 4                                    D.961028
004310*****            MOVE ST-TAN TO S-T                               D.961028
004320*****            MOVE ST-FTN TO S-FT.                             D.961028
004330*****IF ST-DNK = 3                                                *D911121
004340*****IF ST-DNK = 3 OR 9                                           D.961028
004350*****    MOVE 4 TO S-SIZ                                          D.961028
004360*****    MOVE 111 TO S-S                                          D.961028
004370*****    MOVE ST-ST TO S-SU                                       D.961028
004380*****    GO TO M-45.                                              D.961028
004390*M-40.                                                            D.961028
004400*****ADD 1 TO CNT.                                                D.961028
004410*****IF CNT > 10                                                  D.961028
004420*****    GO TO M-60.                                              D.961028
004430*****IF ST-SU (CNT) = ZERO                                        D.961028
004440*****    GO TO M-40.                                              D.961028
004450*****MOVE TBL (CNT) TO S-S.                                       D.961028
004460*****IF ST-DNK NOT = 0 AND 4 AND 7                                D.961028
004470*****    COMPUTE ST-SU (CNT) = ST-SU (CNT) * -1.                  D.961028
004480*****MOVE ST-SU (CNT) TO S-SU.                                    D.961028
004490*M-45.                                                            D.961028
004500*****COMPUTE S-UKI = S-SU * S-T.                                  D.961028
004510*****COMPUTE S-SKI = S-SU * S-FT.                                 D.961028
004520*****IF ST-DNK = 2 OR 6                                           *D911121
004530*****IF ST-DNK = 2                                                D.961028
004540*****    MOVE 0 TO S-SU S-T                                       D.961028
004550*****  ELSE                                                       D.961028
004560*****    IF ST-DNK = 4 OR 7                                       D.961028
004570*****        MOVE 0 TO S-T.                                       D.961028
004580*M-50.                                                            D.961028
004590*****WRITE SYU-R.                                                 D.961028
004600*****IF ERR-STAT = "00"                                           D.961028
004610*****    CALL "CBLTCLS" USING SYU-F                               D.961028
004620*****    GO TO M-55.                                              D.961028
004630*****PERFORM S-15 THRU S-20.                                      D.961028
004640*****IF ST-DNK NOT = 3 AND 6 AND 9                                D.961028
004650*****    SUBTRACT 1 FROM CNT.                                     D.961028
004660*****GO TO M-35.                                                  D.961028
004670*M-55.                                                            D.961028
004680*****IF S-DK = 6                                                  D.961028
004690*****    GO TO M-10.                                              D.961028
004700*****IF S-DK NOT = 3                                              *D911121
004710*****IF S-DK NOT = 3 AND 9                                        D.961028
004720*****    GO TO M-35.                                              D.961028
004730*M-60.                                                            D.961028
004740*****IF ST-DNK = 3 OR 4                                           *D911121
004750*****IF ST-DNK = 3 OR 4 OR 9                                      D.970108
004760*****    PERFORM AZ-RTN THRU AZ-EX.                               D.970108
004770*****IF W-END = 9                                                 D.970108
004780*****    GO TO M-95.                                              D.970108
004790*****    INITIALIZE AZ-R                                          D.940620
004800*****    MOVE ST-TCD TO A-TCD                                     D.940620
004810*****    MOVE ST-SCD TO A-HCD                                     D.940620
004820*****    MOVE ST-YMD TO A-DATE                                    D.940620
004830*****    MOVE ST-ST  TO A-SU                                      D.940620
004840*****    MOVE ST-22  TO A-NO                                      D.940620
004850*****    IF ST-DNK = 9                                            D.940620
004860*****       MOVE 3 TO A-DK                                        D.940620
004870*****       WRITE AZ-R                                            D.940620
004880*****    ELSE                                                     D.940620
004890*****       MOVE ST-DNK TO A-DK                                   D.940620
004900*****       WRITE AZ-R.                                           D.940620
004910*****IF ST-DNK = 1                                                D.961105
004920*****    PERFORM HPR-RTN THRU HPR-EX.                             D.961105
004930*****IF W-END = 9                                                 D.961105
004940*****    GO TO M-95.                                              D.961105
004950*****    INITIALIZE HPR-R                                         D.940620
004960*****    MOVE ST-YMD TO HP-YMD                                    D.940620
004970*****    MOVE ST-TCD TO HP-TCD                                    D.940620
004980*****    MOVE ST-SCD TO HP-SCD                                    D.940620
004990*****    MOVE ST-ST TO HP-ST                                      D.940620
005000*****    MOVE ST-TAN TO HP-TAN                                    D.940620
005010*****    MOVE ST-KIN TO HP-KIN                                    D.940620
005020*****    MOVE ST-TC2 TO HP-TC2                                    D.940620
005030*****    WRITE HPR-R.                                             D.940620
005040*****IF ST-DNK NOT = 2                                            D.961105
005050*****    GO TO M-10.                                              D.961105
005060*****IF ZERO = ST-ST AND ST-KIN                                   D.961105
005070*****    GO TO M-10.                                              D.961105
005080*
005090*****MOVE ST-SCD TO FR-KEY.                                       D.961028
005100*****READ FRHP-F INVALID KEY                                      D.961028
005110*****    GO TO M-70.                                              D.961028
005120*****ADD ST-ST TO FR-SU.                                          D.961028
005130*****ADD ST-KIN TO FR-KIN.                                        D.961028
005140*****IF ZERO = FR-SU AND FR-KIN                                   D.961028
005150*****    GO TO M-65.                                              D.961028
005160*****MOVE ST-BC1 TO FR-BC1.                                       D.961028
005170*****MOVE ST-BC2 TO FR-BC2.                                       D.961028
005180*****MOVE ST-BC3 TO FR-BC3.                                       D.961028
005190*****REWRITE FRHP-R INVALID KEY                                   D.961028
005200*****    DISPLAY E-STAT E-ME2 E-NO E-ME98                         D.961028
005210*****    PERFORM S-90 THRU S-95.                                  D.961028
005220*****GO TO M-10.                                                  D.961028
005230*M-65.                                                            D.961028
005240*****DELETE FRHP-F INVALID KEY                                    D.961028
005250*****    DISPLAY E-STAT E-ME3 E-NO E-ME98                         D.961028
005260*****    PERFORM S-90 THRU S-95.                                  D.961028
005270*****CALL "CBLTCLS" USING FRHP-F.                                 D.961028
005280*****PERFORM FRHP-RTN THRU FRHP-EX.                               D.961105
005290*****IF W-END = 9                                                 D.961105
005300*****    GO TO M-95.                                              D.961105
005310     GO TO M-10.
005320*M-70.                                                            D.961028
005330*****MOVE ZERO TO FRHP-R.                                         D.961028
005340*****MOVE ST-SCD TO FR-KEY.                                       D.961028
005350*****ADD ST-ST TO FR-SU.                                          D.961028
005360*****ADD ST-KIN TO FR-KIN.                                        D.961028
005370*****MOVE ST-BC1 TO FR-BC1.                                       D.961028
005380*****MOVE ST-BC2 TO FR-BC2.                                       D.961028
005390*****MOVE ST-BC3 TO FR-BC3.                                       D.961028
005400*****MOVE W-NG   TO FR-NG.                                        D.961028
005410*****WRITE FRHP-R INVALID KEY                                     D.961028
005420*****    GO TO M-75.                                              D.961028
005430*****    DISPLAY E-STAT E-ME1 E-NO E-ME98                         D.940620
005440*****    PERFORM S-90 THRU S-95.                                  D.940620
005450*****CALL "CBLTCLS" USING FRHP-F.                                 D.961028
005460*****GO TO M-10.                                                  D.961028
005470*M-75.                                                            D.961028
005480*****DISPLAY E-STAT E-ME1 E-NO E-ME99.                            D.961028
005490*****IF ERR-STAT NOT = "24"                                       D.961028
005500*****    DISPLAY E-ME78 E-ME99                                    D.961028
005510*****    PERFORM S-90 THRU S-95.                                  D.961028
005520*****DISPLAY E-CL.                                                D.961028
005530*****CLOSE FRHP-F.                                                D.961028
005540*****MOVE "FRHPF        " TO W-FILE.                              D.961028
005550*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961028
005560*****DISPLAY E-CL.                                                D.961028
005570*****OPEN I-O FRHP-F.                                             D.961028
005580*****GO TO M-70.                                                  D.961028
005590 M-95.
005600*****CLOSE HZ-M.                                                  D.970108
005610     CLOSE S-TRAN.
005620*****CLOSE SYU-F.                                                 D.970108
005630*****CLOSE AZ-F.                                                  D.970108
005640*****CLOSE HPR-F.                                                 D.961105
005650*****CLOSE FRHP-F.                                                D.961105
005660     CLOSE STRANYR.                                               I.940413
005670     CLOSE R-STRANYR.                                             I.040326
005680*****CLOSE SNTRF.                                                 D.970108
005690*****CLOSE STRF.                                                  D.961105
005700     DISPLAY C-CLEAR.
005710     STOP RUN.
005720*S-90.                                                            D.961028
005730*****DISPLAY E-ME99.                                              D.961028
005740*****GO TO S-90.                                                  D.961028
005750*S-95.                                                            D.961028
005760*****EXIT.                                                        D.961028
005770 STYR-RTN.                                                        I.961028
005780     INITIALIZE STRANYR-R.                                        I.961028
005790     MOVE ST-R TO STRANYR-R.                                      I.961028
005800     WRITE STRANYR-R.                                             I.961028
005810     IF ERR-STAT = "00"                                           I.961028
005820         CALL "CBLTCLS" USING STRANYR                             I.961028
005830         GO TO STYR-EX.                                           I.961028
005840     DISPLAY E-STAT E-ME8 E-KEY E-ME99.                           I.961028
005850     IF ERR-STAT NOT = "34"                                       I.961028
005860         MOVE 255 TO COMPLETION-CODE                              I.961028
005870         MOVE 9 TO W-END                                          I.961028
005880         DISPLAY E-ME78 E-ME99                                    I.961028
005890         GO TO STYR-EX.                                           I.961028
005900     DISPLAY E-CL.                                                I.961028
005910     CLOSE STRANYR.                                               I.961028
005920     MOVE "STRANYR      " TO W-FILE.                              I.961028
005930     DISPLAY E-ME71 E-ME98 STOP " ".                              I.961028
005940     DISPLAY E-CL.                                                I.961028
005950     OPEN EXTEND STRANYR.                                         I.961028
005960     GO TO STYR-RTN.                                              I.961028
005970 STYR-EX.                                                         I.961028
005980     EXIT.                                                        I.961028
005990 RSTYR-RTN.                                                       I.040326
006000     INITIALIZE RSTRANYR-R.                                       I.040326
006010     MOVE ST-R TO RSTRANYR-R.                                     I.040326
006020     WRITE RSTRANYR-R.                                            I.040326
006030     IF ERR-STAT = "00"                                           I.040326
006040         CALL "CBLTCLS" USING R-STRANYR                           I.040326
006050         GO TO RSTYR-EX.                                          I.040326
006060     DISPLAY E-STAT E-ME11 E-KEY E-ME99.                          I.040326
006070     IF ERR-STAT NOT = "34"                                       I.040326
006080         MOVE 255 TO COMPLETION-CODE                              I.040326
006090         MOVE 9 TO W-END                                          I.040326
006100         DISPLAY E-ME78 E-ME99                                    I.040326
006110         GO TO RSTYR-EX.                                          I.040326
006120     DISPLAY E-CL.                                                I.040326
006130     CLOSE R-STRANYR.                                             I.040326
006140     MOVE "R-STRANYR    " TO W-FILE.                              I.040326
006150     DISPLAY E-ME71 E-ME98 STOP " ".                              I.040326
006160     DISPLAY E-CL.                                                I.040326
006170     OPEN EXTEND R-STRANYR.                                       I.040326
006180     GO TO RSTYR-RTN.                                             I.040326
006190 RSTYR-EX.                                                        I.040326
006200     EXIT.                                                        I.040326
006210*SNTR-RTN.                                                        D.970108
006220*****INITIALIZE SNTR-R.                                           D.970108
006230*****MOVE ST-R TO SNTR-R.                                         D.970108
006240*****MOVE 0 TO SNTR-UNC.                                          D.970108
006250*****WRITE SNTR-R.                                                D.970108
006260*****IF ERR-STAT = "00"                                           D.970108
006270*****    CALL "CBLTCLS" USING SNTRF                               D.970108
006280*****    GO TO SNTR-EX.                                           D.970108
006290*****DISPLAY E-STAT E-ME10 E-KEY E-ME99.                          D.970108
006300*****IF ERR-STAT NOT = "34"                                       D.970108
006310*****    MOVE 255 TO COMPLETION-CODE                              D.970108
006320*****    MOVE 9 TO W-END                                          D.970108
006330*****    DISPLAY E-ME78 E-ME99                                    D.970108
006340*****    GO TO SNTR-EX.                                           D.970108
006350*****DISPLAY E-CL.                                                D.970108
006360*****CLOSE SNTRF.                                                 D.970108
006370*****MOVE "SNTRF        " TO W-FILE.                              D.970108
006380*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.970108
006390*****DISPLAY E-CL.                                                D.970108
006400*****OPEN EXTEND SNTRF.                                           D.970108
006410*****GO TO SNTR-RTN.                                              D.970108
006420*SNTR-EX.                                                         D.970108
006430*****EXIT.                                                        D.970108
006440*STR-RTN.                                                         D.961105
006450*****INITIALIZE STR-R.                                            D.961105
006460*****MOVE ST-YMD TO STR-YMD.                                      D.961105
006470*****MOVE ST-TCD TO STR-TCD.                                      D.961105
006480*****MOVE ST-SCD TO STR-SCD.                                      D.961105
006490*****MOVE ST-ST TO STR-ST.                                        D.961105
006500*****MOVE ST-TAN TO STR-TAN.                                      D.961105
006510*****MOVE ST-KIN TO STR-KIN.                                      D.961105
006520*****MOVE ST-FTN TO STR-FTN.                                      D.961105
006530*****MOVE ST-CSC TO STR-CSC.                                      D.961105
006540*****MOVE ST-DNK TO STR-DNK.                                      D.961105
006550*****MOVE ST-BC1 TO STR-BC1.                                      D.961105
006560*****MOVE ST-BC2 TO STR-BC2.                                      D.961105
006570*****MOVE ST-BC3 TO STR-BC3.                                      D.961105
006580*****MOVE ST-TC2 TO STR-TC2.                                      D.961105
006590*****WRITE STR-R.                                                 D.961105
006600*****IF ERR-STAT = "00"                                           D.961105
006610*****    CALL "CBLTCLS" USING STRF                                D.961105
006620*****    GO TO STR-EX.                                            D.961105
006630*****DISPLAY E-STAT E-ME9 E-KEY E-ME99.                           D.961105
006640*****IF ERR-STAT NOT = "34"                                       D.961105
006650*****    MOVE 255 TO COMPLETION-CODE                              D.961105
006660*****    MOVE 9 TO W-END                                          D.961105
006670*****    DISPLAY E-ME78 E-ME99                                    D.961105
006680*****    GO TO STR-EX.                                            D.961105
006690*****DISPLAY E-CL.                                                D.961105
006700*****CLOSE STRF.                                                  D.961105
006710*****MOVE "STRF         " TO W-FILE.                              D.961105
006720*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961105
006730*****DISPLAY E-CL.                                                D.961105
006740*****OPEN EXTEND STRF.                                            D.961105
006750*****GO TO STR-RTN.                                               D.961105
006760*STR-EX.                                                          D.961105
006770*****EXIT.                                                        D.961105
006780*SYU-RTN.                                                         D.970108
006790*****IF ST-SCD < 999900                                           D.970108
006800*****    GO TO SYU-010.                                           D.970108
006810*****PERFORM SYUM-RTN THRU SYUM-EX.                               D.970108
006820*****MOVE ZERO TO HZ-KEY.                                         D.970108
006830*****MOVE ST-SCD TO HZ-HCD.                                       D.970108
006840*****START HZ-M KEY NOT < HZ-KEY INVALID KEY                      D.970108
006850*****    DISPLAY E-ME4 E-KEY E-ME99                               D.970108
006860*****    MOVE 255 TO COMPLETION-CODE                              D.970108
006870*****    MOVE 9 TO W-END                                          D.970108
006880*****    DISPLAY E-ME78 E-ME99                                    D.970108
006890*****    GO TO SYU-EX.                                            D.970108
006900*****READ HZ-M NEXT RECORD WITH UNLOCK AT END                     D.970108
006910*****    DISPLAY E-ME4 E-KEY E-ME99                               D.970108
006920*****    MOVE 255 TO COMPLETION-CODE                              D.970108
006930*****    MOVE 9 TO W-END                                          D.970108
006940*****    DISPLAY E-ME78 E-ME99                                    D.970108
006950*****    GO TO SYU-EX.                                            D.970108
006960*****IF ST-SCD NOT = HZ-HCD                                       D.970108
006970*****    DISPLAY E-ME4 E-KEY E-ME99                               D.970108
006980*****    MOVE 255 TO COMPLETION-CODE                              D.970108
006990*****    MOVE 9 TO W-END                                          D.970108
007000*****    DISPLAY E-ME78 E-ME99                                    D.970108
007010*****    GO TO SYU-EX.                                            D.970108
007020*****MOVE HZ-SC TO S-SIZ.                                         D.970108
007030*****MOVE HZ-SIZ TO S-S.                                          D.970108
007040*****IF S-DK = ZERO                                               D.970108
007050*****    MOVE ST-KIN TO S-UKI                                     D.970108
007060*****  ELSE                                                       D.970108
007070*****    COMPUTE S-UKI = ST-KIN * -1.                             D.970108
007080*****WRITE SYU-R.                                                 D.970108
007090*****IF ERR-STAT = "00"                                           D.970108
007100*****    CALL "CBLTCLS" USING SYU-F                               D.970108
007110*****    MOVE 1 TO W-END                                          D.970108
007120*****    GO TO SYU-EX.                                            D.970108
007130*****PERFORM SYUE-RTN THRU SYUE-EX.                               D.970108
007140*****IF W-END = 9                                                 D.970108
007150*****    GO TO SYU-EX.                                            D.970108
007160*****GO TO SYU-RTN.                                               D.970108
007170*SYU-010.                                                         D.970108
007180*****IF ST-DNK = 3                                                D.970108
007190*****    GO TO SYU-020.                                           D.970108
007200*****IF ST-SIZ = 1                                                D.970108
007210*****    MOVE TBL1 TO TBLE.                                       D.970108
007220*****IF ST-SIZ = 2                                                D.970108
007230*****    MOVE TBL2 TO TBLE.                                       D.970108
007240*****IF ST-SIZ = 3                                                D.970108
007250*****    MOVE TBL3 TO TBLE.                                       D.970108
007260*****IF ST-SIZ = 4                                                D.970108
007270*****    MOVE TBL4 TO TBLE.                                       D.970108
007280*SYU-020.                                                         D.970108
007290*****MOVE ZERO TO CNT.                                            D.970108
007300*SYU-030.                                                         D.970108
007310*****PERFORM SYUM-RTN THRU SYUM-EX.                               D.970108
007320*****IF ST-DNK = 6                                                D.970108
007330*****    MOVE ST-KIN TO S-UKI                                     D.970108
007340*****    GO TO SYU-060.                                           D.970108
007350*****MOVE ST-SIZ TO S-SIZ.                                        D.970108
007360*****IF ST-DNK = 2                                                D.970108
007370*****    MOVE ST-TAN TO S-T                                       D.970108
007380*****  ELSE                                                       D.970108
007390*****    IF ST-DNK = 7                                            D.970108
007400*****        MOVE ST-FTN TO S-FT                                  D.970108
007410*****      ELSE                                                   D.970108
007420*****        IF ST-DNK NOT = 4                                    D.970108
007430*****            MOVE ST-TAN TO S-T                               D.970108
007440*****            MOVE ST-FTN TO S-FT.                             D.970108
007450*****IF ST-DNK = 3 OR 9                                           D.970108
007460*****    MOVE 4 TO S-SIZ                                          D.970108
007470*****    MOVE 111 TO S-S                                          D.970108
007480*****    MOVE ST-ST TO S-SU                                       D.970108
007490*****    GO TO SYU-050.                                           D.970108
007500*SYU-040.                                                         D.970108
007510*****ADD 1 TO CNT.                                                D.970108
007520*****IF CNT > 10                                                  D.970108
007530*****    GO TO SYU-EX.                                            D.970108
007540*****IF ST-SU (CNT) = ZERO                                        D.970108
007550*****    GO TO SYU-040.                                           D.970108
007560*****MOVE TBL (CNT) TO S-S.                                       D.970108
007570*****IF ST-DNK NOT = 0 AND 4 AND 7                                D.970108
007580*****    COMPUTE ST-SU (CNT) = ST-SU (CNT) * -1.                  D.970108
007590*****MOVE ST-SU (CNT) TO S-SU.                                    D.970108
007600*SYU-050.                                                         D.970108
007610*****COMPUTE S-UKI = S-SU * S-T.                                  D.970108
007620*****COMPUTE S-SKI = S-SU * S-FT.                                 D.970108
007630*****IF ST-DNK = 2                                                D.970108
007640*****    MOVE 0 TO S-SU S-T                                       D.970108
007650*****  ELSE                                                       D.970108
007660*****    IF ST-DNK = 4 OR 7                                       D.970108
007670*****        MOVE 0 TO S-T.                                       D.970108
007680*SYU-060.                                                         D.970108
007690*****WRITE SYU-R.                                                 D.970108
007700*****IF ERR-STAT = "00"                                           D.970108
007710*****    CALL "CBLTCLS" USING SYU-F                               D.970108
007720*****    GO TO SYU-070.                                           D.970108
007730*****PERFORM SYUE-RTN THRU SYUE-EX.                               D.970108
007740*****IF W-END = 9                                                 D.970108
007750*****    GO TO SYU-EX.                                            D.970108
007760*****IF ST-DNK NOT = 3 AND 6 AND 9                                D.970108
007770*****    SUBTRACT 1 FROM CNT.                                     D.970108
007780*****GO TO SYU-030.                                               D.970108
007790*SYU-070.                                                         D.970108
007800*****IF S-DK = 6                                                  D.970108
007810*****    MOVE 1 TO W-END                                          D.970108
007820*****    GO TO SYU-EX.                                            D.970108
007830*****IF S-DK NOT = 3 AND 9                                        D.970108
007840*****    GO TO SYU-030.                                           D.970108
007850*SYU-EX.                                                          D.970108
007860*****EXIT.                                                        D.970108
007870*SYUM-RTN.                                                        D.970108
007880*****INITIALIZE SYU-R.                                            D.970108
007890*****MOVE ST-YMD TO S-DATE.                                       D.970108
007900*****MOVE ST-TCD TO S-TCD.                                        D.970108
007910*****MOVE ST-SCD TO S-HCD.                                        D.970108
007920*****MOVE ST-DNK TO S-DK.                                         D.970108
007930*****MOVE ST-BC1 TO S-BC1.                                        D.970108
007940*****MOVE ST-BC2 TO S-BC2.                                        D.970108
007950*****MOVE ST-BC3 TO S-BC3.                                        D.970108
007960*****MOVE ST-SKC TO S-SKC.                                        D.970108
007970*****MOVE ST-TC2 TO S-TC2.                                        D.970108
007980*****MOVE ST-FKC TO S-FKC.                                        D.970108
007990*SYUM-EX.                                                         D.970108
008000*****EXIT.                                                        D.970108
008010*SYUE-RTN.                                                        D.970108
008020*****DISPLAY E-STAT E-ME5 E-KEY E-ME99.                           D.970108
008030*****IF ERR-STAT NOT = "34"                                       D.970108
008040*****    MOVE 255 TO COMPLETION-CODE                              D.970108
008050*****    MOVE 9 TO W-END                                          D.970108
008060*****    DISPLAY E-ME78 E-ME99                                    D.970108
008070*****    GO TO SYUE-EX.                                           D.970108
008080*****    DISPLAY E-ME78 E-ME99                                    D.961028
008090*****    PERFORM S-90 THRU S-95.                                  D.961028
008100*****DISPLAY E-CL.                                                D.970108
008110*****CLOSE SYU-F.                                                 D.970108
008120*****MOVE "SYUF         " TO W-FILE.                              D.970108
008130*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.970108
008140*****DISPLAY E-CL.                                                D.970108
008150*****OPEN EXTEND SYU-F.                                           D.970108
008160*SYUE-EX.                                                         D.970108
008170*****EXIT.                                                        D.970108
008180*AZ-RTN.                                                          D.970108
008190*****INITIALIZE AZ-R.                                             D.970108
008200*****MOVE ST-TCD TO A-TCD.                                        D.970108
008210*****MOVE ST-SCD TO A-HCD.                                        D.970108
008220*****MOVE ST-YMD TO A-DATE.                                       D.970108
008230*****MOVE ST-ST  TO A-SU.                                         D.970108
008240*****MOVE ST-22  TO A-NO.                                         D.970108
008250*****IF ST-DNK = 9                                                D.970108
008260*****    MOVE 3 TO A-DK                                           D.970108
008270*****  ELSE                                                       D.970108
008280*****    MOVE ST-DNK TO A-DK.                                     D.970108
008290*****WRITE AZ-R.                                                  D.970108
008300*****IF ERR-STAT = "00"                                           D.970108
008310*****    CALL "CBLTCLS" USING AZ-F                                D.970108
008320*****    GO TO AZ-EX.                                             D.970108
008330*****DISPLAY E-STAT E-ME6 E-KEY E-ME99.                           D.970108
008340*****IF ERR-STAT NOT = "34"                                       D.970108
008350*****    MOVE 255 TO COMPLETION-CODE                              D.970108
008360*****    MOVE 9 TO W-END                                          D.970108
008370*****    DISPLAY E-ME78 E-ME99                                    D.970108
008380*****    GO TO AZ-EX.                                             D.970108
008390*****    DISPLAY E-ME78 E-ME99                                    D.961028
008400*****    PERFORM S-90 THRU S-95.                                  D.961028
008410*****DISPLAY E-CL.                                                D.970108
008420*****CLOSE AZ-F.                                                  D.970108
008430*****MOVE "AZF          " TO W-FILE.                              D.970108
008440*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.970108
008450*****DISPLAY E-CL.                                                D.970108
008460*****OPEN EXTEND AZ-F.                                            D.970108
008470*****GO TO AZ-RTN.                                                D.970108
008480*AZ-EX.                                                           D.970108
008490*****EXIT.                                                        D.970108
008500*HPR-RTN.                                                         D.961105
008510*****INITIALIZE HPR-R.                                            D.961105
008520*****MOVE ST-YMD TO HP-YMD.                                       D.961105
008530*****MOVE ST-TCD TO HP-TCD.                                       D.961105
008540*****MOVE ST-SCD TO HP-SCD.                                       D.961105
008550*****MOVE ST-ST TO HP-ST.                                         D.961105
008560*****MOVE ST-TAN TO HP-TAN.                                       D.961105
008570*****MOVE ST-KIN TO HP-KIN.                                       D.961105
008580*****MOVE ST-TC2 TO HP-TC2.                                       D.961105
008590*****WRITE HPR-R.                                                 D.961105
008600*****IF ERR-STAT = "00"                                           D.961105
008610*****    CALL "CBLTCLS" USING HPR-F                               D.961105
008620*****    GO TO HPR-EX.                                            D.961105
008630*****DISPLAY E-STAT E-ME7 E-KEY E-ME99.                           D.961105
008640*****IF ERR-STAT NOT = "34"                                       D.961105
008650*****    MOVE 255 TO COMPLETION-CODE                              D.961105
008660*****    MOVE 9 TO W-END                                          D.961105
008670*****    DISPLAY E-ME78 E-ME99                                    D.961105
008680*****    GO TO HPR-EX.                                            D.961105
008690*****    DISPLAY E-ME78 E-ME99                                    D.961028
008700*****    PERFORM S-90 THRU S-95.                                  D.961028
008710*****DISPLAY E-CL.                                                D.961105
008720*****CLOSE HPR-F.                                                 D.961105
008730*****MOVE "HPRF         " TO W-FILE.                              D.961105
008740*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961105
008750*****DISPLAY E-CL.                                                D.961105
008760*****OPEN EXTEND HPR-F.                                           D.961105
008770*****GO TO HPR-RTN.                                               D.961105
008780*HPR-EX.                                                          D.961105
008790*****EXIT.                                                        D.961105
008800*FRHP-RTN.                                                        D.961105
008810*****MOVE ST-SCD TO FR-KEY.                                       D.961105
008820*****READ FRHP-F INVALID KEY                                      D.961105
008830*****    GO TO FRHP-020.                                          D.961105
008840*****ADD ST-ST TO FR-SU.                                          D.961105
008850*****ADD ST-KIN TO FR-KIN.                                        D.961105
008860*****IF ZERO = FR-SU AND FR-KIN                                   D.961105
008870*****    GO TO FRHP-010.                                          D.961105
008880*****MOVE ST-BC1 TO FR-BC1.                                       D.961105
008890*****MOVE ST-BC2 TO FR-BC2.                                       D.961105
008900*****MOVE ST-BC3 TO FR-BC3.                                       D.961105
008910*****REWRITE FRHP-R INVALID KEY                                   D.961105
008920*****    DISPLAY E-STAT E-ME2 E-KEY E-ME98                        D.961105
008930*****    MOVE 255 TO COMPLETION-CODE                              D.961105
008940*****    MOVE 9 TO W-END                                          D.961105
008950*****    DISPLAY E-ME78 E-ME99.                                   D.961105
008960*****GO TO FRHP-EX.                                               D.961105
008970*FRHP-010.                                                        D.961105
008980*****DELETE FRHP-F INVALID KEY                                    D.961105
008990*****    DISPLAY E-STAT E-ME3 E-KEY E-ME98                        D.961105
009000*****    MOVE 255 TO COMPLETION-CODE                              D.961105
009010*****    MOVE 9 TO W-END                                          D.961105
009020*****    DISPLAY E-ME78 E-ME99                                    D.961105
009030*****    GO TO FRHP-EX.                                           D.961105
009040*****CALL "CBLTCLS" USING FRHP-F.                                 D.961105
009050*****GO TO FRHP-EX.                                               D.961105
009060*FRHP-020.                                                        D.961105
009070*****MOVE ZERO TO FRHP-R.                                         D.961105
009080*****MOVE ST-SCD TO FR-KEY.                                       D.961105
009090*****ADD ST-ST TO FR-SU.                                          D.961105
009100*****ADD ST-KIN TO FR-KIN.                                        D.961105
009110*****MOVE ST-BC1 TO FR-BC1.                                       D.961105
009120*****MOVE ST-BC2 TO FR-BC2.                                       D.961105
009130*****MOVE ST-BC3 TO FR-BC3.                                       D.961105
009140*****MOVE W-NG   TO FR-NG.                                        D.961105
009150*****WRITE FRHP-R INVALID KEY                                     D.961105
009160*****    GO TO FRHP-030.                                          D.961105
009170*****CALL "CBLTCLS" USING FRHP-F.                                 D.961105
009180*****GO TO FRHP-EX.                                               D.961105
009190*FRHP-030.                                                        D.961105
009200*****DISPLAY E-STAT E-ME1 E-KEY E-ME99.                           D.961105
009210*****IF ERR-STAT NOT = "24"                                       D.961105
009220*****    MOVE 255 TO COMPLETION-CODE                              D.961105
009230*****    MOVE 9 TO W-END                                          D.961105
009240*****    DISPLAY E-ME78 E-ME99                                    D.961105
009250*****    GO TO FRHP-EX.                                           D.961105
009260*****DISPLAY E-CL.                                                D.961105
009270*****CLOSE FRHP-F.                                                D.961105
009280*****MOVE "FRHPF        " TO W-FILE.                              D.961105
009290*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.961105
009300*****DISPLAY E-CL.                                                D.961105
009310*****OPEN I-O FRHP-F.                                             D.961105
009320*****GO TO FRHP-020.                                              D.961105
009330*FRHP-EX.                                                         D.961105
009340*****EXIT.                                                        D.961105
