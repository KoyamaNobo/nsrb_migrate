000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD210.
000030*********************************************************
000040*    PROGRAM         :  履物売上・値引入力              *
000050*    SCREEN          :  SCHD01,SCHD11                   *
000060*    COMPILE TYPE    :  COBOL                           *
000070*    JS-SIGN         :  当月=0 , 選択=1                 *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT T-M ASSIGN TO T1-MSD T2-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY T-KEY
000200         ALTERNATE RECORD KEY T-KEY2.
000210*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000220     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000230         ORGANIZATION INDEXED
000240         ACCESS MODE RANDOM
000250         RECORD KEY HI-KEY                                        I.010802
000260         ALTERNATE RECORD KEY HI-KEY2.                            I.010802
000270*****    RECORD KEY HI-KEY.                                       D.010802
000280*****SELECT TAZ-M ASSIGN TO TAZ-MSD                               D.070124
000290*****    ACCESS MODE RANDOM                                       D.070124
000300*****    ORGANIZATION INDEXED                                     D.070124
000310*****    RECORD KEY TAZ-KEY                                       D.070124
000320*****    FILE STATUS IS ERR-STAT.                                 D.070124
000330     SELECT TC-M ASSIGN TO TC-MSD
000340         ORGANIZATION INDEXED
000350         ACCESS MODE RANDOM
000360         RECORD KEY TC-KEY.
000370     SELECT S-TRAN ASSIGN TO S-MSD
000380         FILE STATUS IS ERR-STAT.
000390     SELECT JCON ASSIGN TO F4-MSD
000400         ORGANIZATION INDEXED
000410         ACCESS MODE RANDOM
000420         RECORD KEY JCON3-KEY
000430         FILE STATUS IS ERR-STAT.
000440*****SELECT JT-THTN ASSIGN TO F5-MSD                              D.010419
000450     SELECT THTM ASSIGN TO THT1-MSD THT2-MSD                      I.010419
000460         ORGANIZATION INDEXED
000470         ACCESS MODE RANDOM
000480         RECORD KEY THT-KEY                                       I.010419
000490         ALTERNATE RECORD KEY THT-KEY2                            I.010419
000500*****    RECORD KEY THTN-KEY                                      D.010419
000510         FILE STATUS IS ERR-STAT.
000520     SELECT OTHTM ASSIGN TO OTHT1-MSD OTHT2-MSD                   I.110407
000530         ORGANIZATION INDEXED                                     I.110407
000540         ACCESS MODE RANDOM                                       I.110407
000550         RECORD KEY OTHT-KEY                                      I.110407
000560         ALTERNATE RECORD KEY OTHT-KEY2                           I.110407
000570         FILE STATUS IS ERR-STAT.                                 I.110407
000580     SELECT HSMSF ASSIGN TO HSMS-MSD
000590         ORGANIZATION INDEXED
000600         ACCESS MODE DYNAMIC
000610         RECORD KEY HSMS-KEY
000620         FILE STATUS IS ERR-STAT.
000630     SELECT HKBM  ASSIGN TO HKB-MSD
000640         ORGANIZATION INDEXED
000650         ACCESS MODE RANDOM
000660         RECORD KEY HKB-KEY
000670         FILE STATUS IS ERR-STAT.
000680     SELECT TSKF  ASSIGN TO TSK-MSD                               I.000922
000690         ORGANIZATION INDEXED                                     I.000922
000700         ACCESS MODE RANDOM                                       I.000922
000710         RECORD KEY TSK-KEY                                       I.000922
000720         FILE STATUS IS ERR-STAT.                                 I.000922
000730     SELECT HUH-M ASSIGN TO HUH-MSD                               I.020215
000740         ORGANIZATION INDEXED                                     I.020215
000750         ACCESS MODE RANDOM                                       I.020215
000760         RECORD KEY HUH-KEY                                       I.020215
000770         FILE STATUS IS ERR-STAT.                                 I.020215
000780     SELECT BBS-TRAN ASSIGN TO BBS-MSD                            I.170828
000790         FILE STATUS IS ERR-STAT.                                 I.170828
000800 I-O-CONTROL.
000810     APPLY SHARED-MODE ON T-M
000820     APPLY SHARED-MODE ON JCON
000830*****APPLY SHARED-MODE ON JT-THTN                                 D.010419
000840     APPLY SHARED-MODE ON THTM                                    I.010419
000850     APPLY SHARED-MODE ON OTHTM                                   I.110407
000860     APPLY SHARED-MODE ON HI-M
000870*****APPLY SHARED-MODE ON TAZ-M                                   D.070124
000880     APPLY SHARED-MODE ON TC-M
000890     APPLY SHARED-MODE ON HSMSF
000900     APPLY SHARED-MODE ON HKBM
000910     APPLY SHARED-MODE ON TSKF                                    I.000922
000920     APPLY SHARED-MODE ON HUH-M                                   I.020215
000930     APPLY SHARED-MODE ON M-DATE.
000940 DATA DIVISION.
000950 FILE SECTION.
000960     COPY LIBFDD.
000970     COPY LITM.
000980     COPY LIHIM.
000990     COPY LITCM.
001000     COPY LIHSMS.
001010     COPY LIHKBM.
001020*****COPY LTHTN.                                                  D.010419
001030     COPY LITHTM.                                                 I.010419
001040     COPY LIOTHT.                                                 I.110407
001050     COPY L-JCON.
001060     COPY LITSKF.                                                 I.000922
001070     COPY LIHUHM.                                                 I.020215
001080*FD  TAZ-M                                                        D.070124
001090*****BLOCK  8 RECORDS                                             D.020821
001100*****BLOCK  6 RECORDS                                             D.070124
001110*****LABEL RECORD IS STANDARD                                     D.070124
001120*****VALUE OF IDENTIFICATION "TAZM".                              D.070124
001130*01  TAZ-R.                                                       D.070124
001140*****02  TAZ-KEY.                                                 D.070124
001150*****  03  TAZ-TCD      PIC  9(004).                              D.070124
001160*****  03  TAZ-HCD      PIC  9(006).                              D.070124
001170*****02  TAZ-ZS         PIC S9(005).                              D.020821
001180*****02  TAZ-AS         PIC S9(005).                              D.020821
001190*****02  F              PIC  X(006).                              D.020821
001200*****02  F              PIC  X(026).                              D.070124
001210*****02  TAZ-NG         PIC  9(006).                              D.070124
001220 FD  S-TRAN
001230     BLOCK  2 RECORDS
001240     LABEL RECORD IS STANDARD
001250     VALUE OF IDENTIFICATION "STRAN".
001260 01  S-R.
001270     02  S-DNO          PIC  9(006).
001280     02  S-GNO          PIC  9(001).
001290     02  S-DATE         PIC  9(008).
001300     02  S-TCD          PIC  9(004).
001310     02  F              PIC  X(107).
001320     02  S-DHC          PIC  9(001).
001330     02  S-SNC          PIC  9(001).
001340 FD  BBS-TRAN
001350     BLOCK  2 RECORDS
001360     LABEL RECORD IS STANDARD
001370     VALUE OF IDENTIFICATION "BB-STRAN".
001380 01  BBS-R.
001390     02  BBS-DNO        PIC  9(006).
001400     02  BBS-GNO        PIC  9(001).
001410     02  BBS-CNG        PIC  9(006).
001420     02  F              PIC  9(002).
001430     02  BBS-TCD        PIC  9(004).
001440     02  F              PIC  X(107).
001450     02  BBS-DHC        PIC  9(001).
001460     02  BBS-SNC        PIC  9(001).
001470 WORKING-STORAGE SECTION.
001480 77  JS-SIGN            PIC  9(001).                              I.160907
001490 77  W-FILE             PIC  X(013).
001500 77  W-SEN              PIC  9(001) VALUE 0.                      I.170828
001510 77  W-END              PIC  9(001) VALUE 0.
001520 77  CHK                PIC  9(001) VALUE 0.
001530 77  W-INV              PIC  9(001) VALUE 0.
001540 77  W-ADV              PIC  9(001) VALUE 0.
001550 01  ERR-STAT           PIC  X(002).
001560 01  W-SR.
001570     02  W-DNO          PIC  9(006).
001580     02  W-GNO          PIC  9(001).
001590     02  W-DATE         PIC  9(008).
001600     02  W-TCD          PIC  9(004).
001610     02  W-DT1          PIC  X(107).
001620     02  W-DT2   REDEFINES W-DT1.
001630       03  W-ZD1.
001640         04  W-HCD      PIC  9(006).
001650         04  W-SIZ      PIC  9(001).
001660         04  W-SUS.
001670           05  W-SUSD  OCCURS  10.
001680             06  W-SU   PIC S9(004)  COMP-3.
001690         04  W-SUT      PIC S9(005).
001700         04  W-BT       PIC S9(005).
001710       03  W-KIN        PIC S9(008).
001720       03  W-CSC        PIC  9(001).
001730       03  W-DC         PIC  9(001).
001740       03  W-FT         PIC  9(005).
001750       03  W-CCD        PIC  9(003).
001760       03  W-ZD2.
001770         04  W-BC1      PIC  9(002).
001780         04  W-BC2.
001790           05  W-BC21   PIC  9(001).
001800           05  W-BC22   PIC  9(001).
001810         04  W-BC3      PIC  9(002).
001820         04  W-SOK      PIC  9(001).
001830       03  W-TC2        PIC  9(002).
001840       03  W-FKC        PIC  9(002).
001850       03  W-HSC        PIC  9(001).
001860       03  W-KOSU       PIC  9(003).
001870       03  W-FRC        PIC  9(001).
001880       03  W-TCD2       PIC  9(004).
001890       03  W-BIK        PIC  X(010).
001900       03  W-SDT        PIC  9(008).
001910       03  W-BMC        PIC  9(002).                              I.020517
001920       03  W-BMNO       PIC  9(001).                              I.020517
001930       03  W-USC        PIC  9(001).                              I.040324
001940*****  03  F            PIC  X(001).                              D.040324
001950*****  03  F            PIC  X(004).                              D.020517
001960     02  W-DHC          PIC  9(001).
001970     02  W-UNC          PIC  9(001).
001980 01  W-ASR.
001990     02  W-AS    OCCURS   6  PIC  X(128).
002000 01  W-BR.
002010     02  W-BI           PIC  N(024).
002020     02  W-HANO         PIC  9(006).                              I.081222
002030     02  F              PIC  X(030).                              I.081222
002040*****02  W-HANO.                                                  D.081222
002050*****  03  W-HA    OCCURS   6  PIC  9(006).                       D.081222
002060     02  W-TAX          PIC S9(007).
002070     02  W-UZZ          PIC S9(007).
002080     02  W-UZ           PIC S9(009).
002090 01  W-ASD.
002100     02  W-SD    OCCURS  10  PIC  9(001).
002110 01  W-DATA.
002120     02  W-L.
002130       03  W-L1         PIC  9(002).
002140       03  W-L2         PIC  9(002).
002150       03  W-L3         PIC  9(002).
002160     02  W-C            PIC S9(002).
002170     02  W-GSUT         PIC S9(006).
002180     02  W-UNCD         PIC  9(001).
002190     02  W-RC           PIC  9(001).
002200     02  W-SC           PIC  9(002).
002210     02  W-DMM          PIC  9(001).
002220     02  W-DNOD         PIC  9(006).
002230*****02  W-DNOO         PIC  9(006).                              D.170828
002240     02  W-NGP          PIC  9(008).
002250     02  W-NGPD  REDEFINES W-NGP.
002260       03  W-NGD.
002270         04  W-ND       PIC  9(004).
002280         04  W-NDD   REDEFINES W-ND.
002290           05  W-ND1    PIC  9(002).
002300           05  W-ND2    PIC  9(002).
002310         04  W-GD       PIC  9(002).
002320       03  W-PD         PIC  9(002).
002330     02  W-NGPSD REDEFINES W-NGP.
002340       03  F            PIC  9(002).
002350       03  W-NGPS       PIC  9(006).
002360     02  W-TCDD         PIC  9(004).
002370     02  W-TCDN         PIC  9(004).
002380     02  W-CCDD         PIC  9(003).
002390     02  W-HCDD         PIC  9(006).
002400     02  W-HCDO         PIC  9(006).                              I.010419
002410     02  W-CSCD         PIC  9(001).
002420     02  W-HNOD         PIC  9(006).                              I.081222
002430*****02  W-HNOD.                                                  D.081222
002440*****  03  W-HN1        PIC  9(006).                              D.081222
002450*****  03  W-HN2        PIC  9(006).                              D.081222
002460*****  03  W-HN3        PIC  9(006).                              D.081222
002470*****  03  W-HN4        PIC  9(006).                              D.081222
002480*****  03  W-HN5        PIC  9(006).                              D.081222
002490*****  03  W-HN6        PIC  9(006).                              D.081222
002500     02  W-DCD          PIC  9(001).
002510     02  W-DCC          PIC  9(001).
002520     02  W-ZC           PIC  9(001).
002530*****02  W-CNA          PIC  N(024).                              D.020425
002540     02  W-CNG.
002550       03  W-CN         PIC  9(004).
002560       03  W-CND   REDEFINES W-CN.
002570         04  W-CN1      PIC  9(002).
002580         04  W-CN2      PIC  9(002).
002590       03  W-CG         PIC  9(002).
002600     02  W-SNGD  REDEFINES W-CNG.
002610       03  F            PIC  9(002).
002620       03  W-CNGS       PIC  9(004).
002630     02  W-HSCD         PIC  9(001).
002640     02  W-HNC          PIC  9(001).
002650     02  W-HNCD         PIC  9(001).
002660     02  W-SCD          PIC  9(001).
002670     02  W-KOSUR        PIC  9(003).
002680     02  WK-TAN         PIC S9(005).
002690     02  W-FRCD         PIC  9(001).
002700     02  W-DTW1         PIC  9(003).
002710     02  W-DTW2         PIC  9(001).
002720     02  W-SDTD         PIC  9(008).
002730     02  W-SDTM  REDEFINES W-SDTD.
002740       03  W-SDTNG.
002750         04  W-SDTN     PIC  9(004).
002760         04  W-SDTG     PIC  9(002).
002770       03  W-SDTP       PIC  9(002).
002780     02  W-HMN          PIC  9(006).
002790     02  WK-SCD         PIC  9(001).
002800     02  WK-DC          PIC  9(001).
002810     02  WK-BI          PIC  N(024).
002820     02  W-EC           PIC  9(001).
002830     02  W-DEL          PIC  9(001).
002840     02  W-RCD          PIC  9(001).
002850     02  CNT            PIC  9(001).
002860     02  W-HC           PIC  9(001).                              I.011012
002870     02  W-LD           PIC  9(006).                              I.020404
002880     02  W-RCB          PIC  9(001).                              I.020404
002890     02  W-LB           PIC  9(006).                              I.020404
002900     02  W-DSPC         PIC  9(001).                              I.020404
002910*****02  W-LD.                                                    D.020404
002920*****  03  W-L1D        PIC  9(002).                              D.020404
002930*****  03  W-L2D        PIC  9(002).                              D.020404
002940*****  03  W-L3D        PIC  9(002).                              D.020404
002950*****02  W-CSN          PIC  N(003).                              D.020405
002960     02  W-DKIN         PIC S9(008).
002970     02  W-SDATE        PIC  9(008).                              I.000922
002980     02  W-HIC          PIC  9(001).                              I.020214
002990     02  W-FTD          PIC  9(005).                              I.020215
003000     02  W-TCHK         PIC  9(001).                              I.110407
003010     COPY LSTAT.
003020 SCREEN SECTION.
003030 SD  C-CRT
003040     END STATUS IS ESTAT.
003050 01  C-CLEAR.
003060     02  LINE   1  CLEAR SCREEN.
003070 01  C-MID.
003080     02  LINE   3  COLUMN  15  PIC  N(022) VALUE
003090          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003100     02  LINE   4  COLUMN  15  PIC  N(022) VALUE
003110          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003120     02  LINE   5  COLUMN  15  PIC  N(022) VALUE
003130          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003140     02  LINE   6  COLUMN  15  PIC  N(022) VALUE
003150          NC"＊＊＊　　履物売上・値引伝票　入力　　＊＊＊".
003160     02  LINE   7  COLUMN  15  PIC  N(022) VALUE
003170          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003180     02  LINE   8  COLUMN  15  PIC  N(022) VALUE
003190          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003200     02  LINE   9  COLUMN  15  PIC  N(022) VALUE
003210          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003220     02  LINE  15  COLUMN  26  PIC  X(022) VALUE
003230          "売上=0 , 値引=1   ﾘﾀｰﾝ".
003240 01  C-MID1.                                                      I.170828
003250     02  LINE  12  COLUMN  24  PIC  X(026) VALUE                  I.170828
003260          "当月分=0 , 翌月分=1   ﾘﾀｰﾝ".                           I.170828
003270 01  C-ACP.
003280     02  A-SEN   LINE  12  COLUMN  45  PIC  9(001)                I.170828
003290          USING W-SEN   CHECK OVERFLOW NO IFC.                    I.170828
003300     02  A-UNC   LINE  15  COLUMN  43  PIC  9(001)
003310          USING W-UNCD  CHECK OVERFLOW NO IFC.
003320*
003330     02  LINE   1.
003340       03  AU-NGP   COLUMN  16  PIC  9(006)
003350            USING W-NGPS  CHECK OVERFLOW NO IFC.
003360       03  AU-HMN   COLUMN  30  PIC  9(006)
003370            USING W-HMN   CHECK OVERFLOW NO IFC.
003380       03  AU-SOK   COLUMN  42  PIC  9(001)
003390            USING W-SCD   CHECK OVERFLOW NO IFC.
003400*****  03  AU-HN1   COLUMN  68  PIC  9(006)                       D.081222
003410*****       USING W-HN1   CHECK OVERFLOW NO IFC.                  D.081222
003420*****  03  AU-HN2   COLUMN  75  PIC  9(006)                       D.081222
003430*****       USING W-HN2   CHECK OVERFLOW NO IFC.                  D.081222
003440     02  LINE   2.
003450*****  03  AU-TCD   COLUMN   8  PIC  9(004)                       D.020405
003460       03  AU-TCD   COLUMN   6  PIC  9(004)                       I.020405
003470            USING W-TCDD  CHECK OVERFLOW NO IFC.
003480*****  03  AU-HN3   COLUMN  68  PIC  9(006)                       D.081222
003490*****       USING W-HN3   CHECK OVERFLOW NO IFC.                  D.081222
003500*****  03  AU-HN4   COLUMN  75  PIC  9(006)                       D.081222
003510*****       USING W-HN4   CHECK OVERFLOW NO IFC.                  D.081222
003520     02  LINE   3.
003530*****  03  AU-CCD   COLUMN   8  PIC  9(003)                       D.020405
003540       03  AU-CCD   COLUMN   6  PIC  9(003)                       I.020405
003550            USING W-CCDD  CHECK OVERFLOW NO IFC.
003560*****  03  AU-CSC   COLUMN  64  PIC  9(001)                       D.020405
003570       03  AU-CSC   COLUMN  65  PIC  9(001)                       I.020405
003580            USING W-CSCD  CHECK OVERFLOW NO IFC.
003590*****  03  AU-HN5   COLUMN  68  PIC  9(006)                       D.081222
003600*****       USING W-HN5   CHECK OVERFLOW NO IFC.                  D.081222
003610*****  03  AU-HN6   COLUMN  75  PIC  9(006)                       D.081222
003620*****       USING W-HN6   CHECK OVERFLOW NO IFC.                  D.081222
003630     02  LINE W-L1.
003640       03  AU-DC    COLUMN   4  PIC  9(001)
003650            USING W-DC    CHECK OVERFLOW NO IFC.
003660       03  AU-HCD   COLUMN  11  PIC  9(006)
003670            USING W-HCD   CHECK OVERFLOW NO IFC.
003680       03  AU-BIK   COLUMN  71  PIC  X(010)
003690            USING W-BIK   CHECK OVERFLOW NO IFC.
003700     02  LINE W-L3.
003710       03  AU-SIZ   COLUMN   1  PIC  9(001)
003720            USING W-SIZ   CHECK OVERFLOW NO IFC.
003730       03  AU-SU    COLUMN W-C  PIC S9(004)
003740            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003750       03  AU-SU1   COLUMN W-C  PIC S9(003)
003760            USING W-SU(W-SC) CHECK OVERFLOW NO IFC.
003770       03  AU-SUT   COLUMN  60  PIC S9(005)
003780            USING W-SUT   CHECK OVERFLOW NO IFC.
003790       03  AU-BT    COLUMN  67  PIC  9(005)
003800            USING W-BT    CHECK OVERFLOW NO IFC.
003810       03  AU-KIN   COLUMN  73  PIC S9(007)
003820            USING W-KIN   CHECK OVERFLOW NO IFC.
003830     02  AU-BI    LINE  22  COLUMN   6  PIC  N(024)
003840          USING W-BI    CHECK OVERFLOW NO IFC.
003850     02  LINE  23.
003860       03  AU-KOSU  COLUMN   6  PIC  9(003)
003870            USING W-KOSUR CHECK OVERFLOW NO IFC.
003880       03  AU-HSC   COLUMN  17  PIC  9(001)
003890            USING W-HSCD  CHECK OVERFLOW NO IFC.
003900       03  AU-FRC   COLUMN  24  PIC  9(001)
003910            USING W-FRCD  CHECK OVERFLOW NO IFC.
003920       03  AU-SDT   COLUMN  33  PIC  9(008)
003930            USING W-SDTD  CHECK OVERFLOW NO IFC.
003940       03  AU-DMM   COLUMN  63  PIC  9(001)
003950            USING W-DMM   CHECK OVERFLOW NO IFC.
003960*
003970     02  AN-NGP   LINE   4  COLUMN   8  PIC  9(006)
003980          USING W-NGPS  CHECK OVERFLOW NO IFC.
003990     02  AN-TCD   LINE   5  COLUMN   8  PIC  9(004)
004000          USING W-TCDD  CHECK OVERFLOW NO IFC.
004010*****02  AN-CSC   LINE   5  COLUMN  71  PIC  9(001)               D.020405
004020     02  AN-CSC   LINE   5  COLUMN  75  PIC  9(001)               I.020405
004030          USING W-CSCD  CHECK OVERFLOW NO IFC.
004040     02  LINE W-L1.
004050       03  AN-HCD   COLUMN  01  PIC  9(006)
004060            USING W-HCD  CHECK OVERFLOW NO IFC.
004070       03  AN-SUT   COLUMN  58  PIC S9(005)
004080            USING W-SUT  CHECK OVERFLOW NO IFC.
004090       03  AN-BT    COLUMN  65  PIC S9(004)
004100            USING W-BT   CHECK OVERFLOW NO IFC.
004110       03  AN-KIN   COLUMN  71  PIC S9(008)
004120            USING W-KIN   CHECK OVERFLOW NO IFC.
004130     02  AN-BI    LINE  15  COLUMN  08  PIC  N(024)
004140          USING W-BI    CHECK OVERFLOW NO IFC.
004150     02  AN-HSC   LINE  16  COLUMN  12  PIC  9(001)
004160          USING W-HSCD  CHECK OVERFLOW NO IFC.
004170     02  AN-SDT   LINE  17  COLUMN   8  PIC  9(008)
004180            USING W-SDTD  CHECK OVERFLOW NO IFC.
004190     02  AN-DMM   LINE  20  COLUMN  46  PIC  9(001)
004200          USING W-DMM   CHECK OVERFLOW NO IFC.
004210*
004220     02  A-CHK   LINE  24  COLUMN  55  PIC  9(001)
004230          USING CHK     CHECK OVERFLOW NO IFC.
004240 01  C-DSP.
004250     02  DU-SNA   LINE   1  COLUMN  44  PIC  N(006) FROM
004260          JCON3-03.
004270     02  DU-TNA   LINE   2  COLUMN  11  PIC  N(026) FROM  T-NAME. I.020405
004280     02  DU-CNA   LINE   3  COLUMN  11  PIC  N(026) FROM  TC-NAME.I.020405
004290*****02  DU-TNA   LINE   2  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004300*****02  DU-CNA   LINE   3  COLUMN  13  PIC  N(024) FROM  TC-NAME.D.020405
004310     02  LINE W-L1.
004320       03  DU-HNA   COLUMN  18  PIC  N(024)    FROM  HI-NAME.
004330       03  DU-SZM   COLUMN  18  PIC  N(006)    VALUE
004340            NC"消費税調整分".
004350     02  LINE W-L2.
004360       03  DU-S1.
004370*****    04  COLUMN   3  PIC  X(005) VALUE "３号 ".               D.081222
004380*****    04  COLUMN   9  PIC  X(005) VALUE "２号 ".               D.081222
004390*****    04  COLUMN  15  PIC  X(005) VALUE "１号 ".               D.081222
004400*****    04  COLUMN  21  PIC  X(005) VALUE "０号 ".               D.081222
004410*****    04  COLUMN  27  PIC  X(005) VALUE " 中　".               D.081222
004420*****    04  COLUMN  33  PIC  X(005) VALUE " 大　".               D.081222
004430*****    04  COLUMN  39  PIC  X(005) VALUE "特大 ".               D.081222
004440         04  COLUMN   3  PIC  X(005) VALUE "     ".               I.081222
004450         04  COLUMN   9  PIC  X(005) VALUE "     ".               I.081222
004460         04  COLUMN  15  PIC  X(005) VALUE " SS  ".               I.081222
004470         04  COLUMN  21  PIC  X(005) VALUE "  S  ".               I.081222
004480         04  COLUMN  27  PIC  X(005) VALUE "  M  ".               I.081222
004490         04  COLUMN  33  PIC  X(005) VALUE "  L  ".               I.081222
004500         04  COLUMN  39  PIC  X(005) VALUE " LL  ".               I.081222
004510         04  COLUMN  45  PIC  X(004) VALUE "28.0".
004520         04  COLUMN  50  PIC  X(004) VALUE "29.0".
004530         04  COLUMN  55  PIC  X(004) VALUE "30.0".
004540       03  DU-S2.
004550         04  COLUMN   3  PIC  X(005) VALUE "12.5 ".
004560         04  COLUMN   9  PIC  X(005) VALUE "13.0 ".
004570         04  COLUMN  15  PIC  X(005) VALUE "13.5 ".
004580         04  COLUMN  21  PIC  X(005) VALUE "14.0 ".
004590         04  COLUMN  27  PIC  X(005) VALUE "15.0 ".
004600         04  COLUMN  33  PIC  X(005) VALUE "16.0 ".
004610         04  COLUMN  39  PIC  X(005) VALUE "17.0 ".
004620         04  COLUMN  45  PIC  X(004) VALUE "18.0".
004630         04  COLUMN  50  PIC  X(004) VALUE "19.0".
004640         04  COLUMN  55  PIC  X(004) VALUE "20.0".
004650       03  DU-S3.
004660         04  COLUMN   3  PIC  X(005) VALUE "21.0 ".
004670         04  COLUMN   9  PIC  X(005) VALUE "21.5 ".
004680         04  COLUMN  15  PIC  X(005) VALUE "22.0 ".
004690         04  COLUMN  21  PIC  X(005) VALUE "22.5 ".
004700         04  COLUMN  27  PIC  X(005) VALUE "23.0 ".
004710         04  COLUMN  33  PIC  X(005) VALUE "23.5 ".
004720         04  COLUMN  39  PIC  X(005) VALUE "24.0 ".
004730         04  COLUMN  45  PIC  X(004) VALUE "24.5".
004740         04  COLUMN  50  PIC  X(004) VALUE "25.0".
004750         04  COLUMN  55  PIC  X(004) VALUE "    ".
004760       03  DU-S4.
004770         04  COLUMN   3  PIC  X(005) VALUE "24.0 ".
004780         04  COLUMN   9  PIC  X(005) VALUE "24.5 ".
004790         04  COLUMN  15  PIC  X(005) VALUE "25.0 ".
004800         04  COLUMN  21  PIC  X(005) VALUE "25.5 ".
004810         04  COLUMN  27  PIC  X(005) VALUE "26.0 ".
004820         04  COLUMN  33  PIC  X(005) VALUE "26.5 ".
004830         04  COLUMN  39  PIC  X(005) VALUE "27.0 ".
004840         04  COLUMN  45  PIC  X(004) VALUE "27.5".
004850         04  COLUMN  50  PIC  X(004) VALUE "    ".
004860         04  COLUMN  55  PIC  X(004) VALUE "    ".
004870     02  LINE W-L3.
004880       03  DU-SU    COLUMN W-C  PIC ZZZZ-     FROM  W-SU(W-SC).
004890       03  DU-SU1   COLUMN W-C  PIC ZZZ-      FROM  W-SU(W-SC).
004900       03  DU-SUT   COLUMN  60  PIC ZZZZZ-    FROM  W-SUT.
004910       03  DU-BT    COLUMN  67  PIC ZZZZZ     FROM  W-BT.
004920       03  DU-KIN   COLUMN  73  PIC ZZZZZZZ-  FROM  W-KIN.
004930     02  LINE  22.
004940       03  DU-GSUT  COLUMN  58  PIC ZZZ,ZZZ-  FROM  W-GSUT.
004950     02  LINE  23.
004960       03  DU-KOSU  COLUMN   6  PIC ZZ9       FROM  W-KOSUR.
004970*
004980*****02  DN-TNA   LINE   5  COLUMN  13  PIC  N(024) FROM  T-NAME. D.020405
004990*****02  DN-CSN   LINE   5  COLUMN  73  PIC  N(003) FROM  W-CSN.  D.020405
005000     02  DN-TNA   LINE   5  COLUMN  13  PIC  N(026) FROM  T-NAME. I.020405
005010     02  LINE W-L1.
005020       03  DN-HNA   COLUMN   8  PIC  N(024)    FROM  HI-NAME.
005030       03  DN-SUT   COLUMN  57  PIC ZZZZZZ-    FROM  W-SUT.
005040       03  DN-BT    COLUMN  65  PIC ZZZZ-      FROM  W-BT.
005050       03  DN-KIN   COLUMN  71  PIC ZZZZZZZZ-  FROM  W-KIN.
005060     02  DN-DKIN.
005070       03  LINE  14  COLUMN  69  PIC ZZ,ZZZ,ZZ9-  FROM  W-DKIN.
005080 01  C-SPC.
005090     02  SU-HNO.
005100       03  LINE   1.
005110         04  SU-DATE  COLUMN  16  PIC  X(006) VALUE "      ".
005120         04  SU-HMN   COLUMN  30  PIC  X(006) VALUE "      ".
005130         04  SU-SOK   COLUMN  42  PIC  X(014) VALUE
005140              "            ".
005150         04  SU-HNM   COLUMN  56  PIC  X(010) VALUE "          ".
005160*****    04  SU-HN1   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
005170*****    04  SU-HN2   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
005180*****  03  LINE  2.                                               D.081222
005190*****    04  SU-HN3   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
005200*****    04  SU-HN4   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
005210*****  03  LINE  3.                                               D.081222
005220*****    04  SU-HN5   COLUMN  68  PIC  X(006) VALUE "      ".     D.081222
005230*****    04  SU-HN6   COLUMN  75  PIC  X(006) VALUE "      ".     D.081222
005240     02  SU-CNA   LINE   3.
005250       03  COLUMN   6  PIC  X(003) VALUE "   ".                   I.020405
005260       03  COLUMN  11  PIC  X(052) VALUE                          I.020405
005270           "                                                    ".I.020405
005280*****  03  COLUMN   8  PIC  X(003) VALUE "   ".                   D.020405
005290*****  03  COLUMN  13  PIC  X(048) VALUE                          D.020405
005300*****       "                                                ".   D.020405
005310     02  SU-D1    LINE W-L1.
005320       03  COLUMN   4  PIC  X(001) VALUE " ".
005330       03  COLUMN  11  PIC  X(006) VALUE "     ".
005340       03  COLUMN  18  PIC  X(048) VALUE
005350            "                                                ".
005360       03  SU-BIK   COLUMN  71  PIC  X(010) VALUE "          ".
005370     02  SU-D2    LINE W-L2.
005380       03  COLUMN   3  PIC  X(005) VALUE "     ".
005390       03  COLUMN   9  PIC  X(005) VALUE "     ".
005400       03  COLUMN  15  PIC  X(005) VALUE "     ".
005410       03  COLUMN  21  PIC  X(005) VALUE "     ".
005420       03  COLUMN  27  PIC  X(005) VALUE "     ".
005430       03  COLUMN  33  PIC  X(005) VALUE "     ".
005440       03  COLUMN  39  PIC  X(005) VALUE "     ".
005450       03  COLUMN  45  PIC  X(004) VALUE "    ".
005460       03  COLUMN  50  PIC  X(004) VALUE "    ".
005470       03  COLUMN  55  PIC  X(004) VALUE "    ".
005480     02  SU-D3    LINE W-L3.
005490       03  SU-D31.
005500         04  COLUMN   1  PIC  X(001) VALUE " ".
005510         04  COLUMN   3  PIC  X(005) VALUE "     ".
005520         04  COLUMN   9  PIC  X(005) VALUE "     ".
005530         04  COLUMN  15  PIC  X(005) VALUE "     ".
005540         04  COLUMN  21  PIC  X(005) VALUE "     ".
005550         04  COLUMN  27  PIC  X(005) VALUE "     ".
005560         04  COLUMN  33  PIC  X(005) VALUE "     ".
005570         04  COLUMN  39  PIC  X(005) VALUE "     ".
005580         04  COLUMN  45  PIC  X(004) VALUE "    ".
005590         04  COLUMN  50  PIC  X(004) VALUE "    ".
005600         04  COLUMN  55  PIC  X(004) VALUE "    ".
005610       03          COLUMN  60  PIC  X(006) VALUE "      ".
005620       03  SU-BT    COLUMN  67  PIC  X(005) VALUE "     ".
005630       03  SU-KIN   COLUMN  73  PIC  X(008) VALUE "        ".
005640     02  LINE  23.
005650       03  SU-KOSU  COLUMN   6  PIC  X(003) VALUE "   ".
005660       03  SU-HSC   COLUMN  17  PIC  X(001) VALUE " ".
005670       03  SU-FRC   COLUMN  24  PIC  X(001) VALUE " ".
005680*
005690     02  SN-DS    LINE W-L1.
005700       03  COLUMN  01  PIC  X(006) VALUE "      ".
005710       03  COLUMN   8  PIC  X(048) VALUE
005720            "                                                ".
005730       03  COLUMN  57  PIC  X(007) VALUE "       ".
005740       03  COLUMN  65  PIC  X(005) VALUE "     ".
005750       03  COLUMN  71  PIC  X(009) VALUE "         ".
005760 01  C-ERR.
005770     02  LINE  24.
005780       03  E-ME1   COLUMN  15  PIC  X(015) VALUE
005790            "***  TM ﾅｼ  ***".
005800       03  E-ME2   COLUMN  15  PIC  X(016) VALUE
005810            "***  TCM ﾅｼ  ***".
005820       03  E-ME3   COLUMN  15  PIC  X(021) VALUE
005830            "***  PROGRAM ｴﾗｰ  ***".
005840       03  E-ME4   COLUMN  15  PIC  X(020) VALUE
005850            "***  区分エラー  ***".
005860       03  E-ME5   COLUMN  15  PIC  X(020) VALUE
005870            "***  直送エラー ***".
005880       03  E-ME6.                                                 I.020214
005890         04  COLUMN  15  PIC  X(016) VALUE                        I.020214
005900              "***  HIM ﾅｼ  ***".                                 I.020214
005910         04  COLUMN  34  PIC  9(006) FROM  W-HCD.                 I.020214
005920       03  E-ME7.                                                 I.020214
005930         04  COLUMN  15  PIC  X(022) VALUE                        I.020214
005940              "***  振替単価無し  ***".                           I.020214
005950         04  COLUMN  40  PIC  9(006) FROM  W-HCD.                 I.020214
005960*****  03  E-ME6   COLUMN  15  PIC  X(016) VALUE                  D.020214
005970*****       "***  HIM ﾅｼ  ***".                                   D.020214
005980*****  03  E-ME7   COLUMN  15  PIC  X(022) VALUE                  D.020214
005990*****       "***  振替単価無し  ***".                             D.020214
006000       03  E-ME8   COLUMN  15  PIC  X(024) VALUE
006010            "***  預りサイズ無し  ***".
006020       03  E-ME9   COLUMN  15  PIC  X(020) VALUE
006030            "***  サイズ無し  ***".
006040*****  03  E-ME10  COLUMN  15  PIC  X(025) VALUE                  D.070124
006050*****       "***  TAZ-M WRITE ｴﾗｰ  ***".                          D.070124
006060*****  03  E-ME11  COLUMN  15  PIC  X(022) VALUE                  D.070124
006070*****       "***  預りチェック  ***".                             D.070124
006080       03  E-ME12  COLUMN  15  PIC  X(020) VALUE
006090            "***  日付エラー ***".
006100*****  03  E-ME13  COLUMN  15  PIC  X(025) VALUE                  D.010531
006110*****       "***  価格ランクエラー ***".                          D.010531
006120       03  E-ME14  COLUMN  15  PIC  X(025) VALUE
006130            "***  発送明細№ CHECK ***".
006140       03  E-ME15  COLUMN  15  PIC  X(025) VALUE
006150            "***  単価  ZERO CHECK ***".
006160       03  E-ME16  COLUMN  15  PIC  X(025) VALUE
006170            "***  STRAN WRITE ｴﾗｰ  ***".
006180       03  E-ME17  COLUMN  15  PIC  X(027) VALUE
006190            "***  STRAN REWRITE ｴﾗｰ  ***".
006200       03  E-ME19  COLUMN  15  PIC  X(028) VALUE
006210            "***  未更新データ　有り  ***".
006220       03  E-ME20  COLUMN  15  PIC  X(041) VALUE
006230            "伝票未発行データ有り   消す  OK=1 NO=5   ".          I.050226
006240*****       "未更新データ　有り     消す  OK=1 NO=5   ".          D.050226
006250       03  E-ME21  COLUMN  15  PIC  X(017) VALUE
006260            "***  ﾃﾞｰﾀ ﾅｼ  ***".
006270       03  E-ME22  COLUMN  15  PIC  X(027) VALUE
006280            "***  HSMSF REWRITE ｴﾗｰ  ***".
006290       03  E-ME23  COLUMN  15  PIC  X(017) VALUE
006300            "***  HKBM ﾅｼ  ***".
006310       03  E-ME24  COLUMN  15  PIC  X(026) VALUE
006320            "***  HKBM REWRITE ｴﾗｰ  ***".
006330       03  E-ME25.                                                I.000922
006340         04  COLUMN  15  PIC  N(008) VALUE                        I.000922
006350              NC"請求書　発行済み".                               I.000922
006360         04  COLUMN  34  PIC 9999/99/99  FROM  W-SDATE.           I.000922
006370       03  E-ME26  COLUMN  15  PIC  X(024) VALUE                  I.010419
006380            "***  THTM WRITE ｴﾗｰ  ***".                           I.010419
006390       03  E-ME27  COLUMN  15  PIC  X(026) VALUE                  I.010419
006400            "***  THTM REWRITE ｴﾗｰ  ***".                         I.010419
006410       03  E-ME28  COLUMN  15  PIC  X(017) VALUE                  I.020215
006420            "***  HUHM ﾅｼ  ***".                                  I.020215
006430       03  E-ME29  COLUMN  15  PIC  X(030) VALUE                  I.020215
006440            "***  マスター　単価エラー  ***".                     I.020215
006450       03  E-ME30  COLUMN  15  PIC  X(030) VALUE                  I.050706
006460            "***  データが入っていない  ***".                     I.050706
006470       03  E-ME31  COLUMN  15  PIC  X(029) VALUE                  I.170828
006480            "***  BB-STRAN 年月エラー  ***".                      I.170828
006490       03  E-ME90  COLUMN  15  PIC  X(021) VALUE
006500            "---   キャンセル  ---".
006510       03  MG-03   COLUMN  15  PIC  X(024) VALUE
006520            "***  ｺﾝﾄﾛｰﾙＦ未登録  ***".
006530       03  MG-05   COLUMN  15  PIC  X(022) VALUE
006540            "***  倉庫省略不可  ***".
006550     COPY LSSEM.
006560     COPY LIBSCR.
006570 PROCEDURE DIVISION.
006580 M-05.
006590     COPY LIBCPR.
006600     MOVE ZERO TO W-CNG.
006610     MOVE D-NHNG TO W-CNGS.
006620     IF W-CN2 >= DATE-NF1 AND <= DATE-NT1
006630         ADD DATE-NC1 TO W-CN.
006640     IF W-CN2 >= DATE-NF2 AND <= DATE-NT2
006650         ADD DATE-NC2 TO W-CN.
006660     ACCEPT JS-SIGN.                                              I.160907
006670     IF JS-SIGN > 1                                               I.160907
006680         MOVE 255 TO COMPLETION-CODE                              I.160907
006690         STOP RUN.                                                I.190907
006700     DISPLAY C-CLEAR.                                             I.170828
006710     DISPLAY C-MID.                                               I.170828
006720     IF JS-SIGN = 1                                               I.160907
006730         PERFORM NGC-RTN THRU NGC-EX.                             I.160907
006740     IF W-END NOT = 0                                             I.170828
006750         MOVE 255 TO COMPLETION-CODE                              I.170828
006760         DISPLAY C-CLEAR                                          I.170828
006770         STOP RUN.                                                I.170828
006780*
006790     DISPLAY C-CLEAR.
006800     DISPLAY C-MID.
006810     IF JS-SIGN = 1                                               I.170828
006820         DISPLAY C-MID1 A-SEN.                                    I.170828
006830*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN.                       D.000922
006840*****OPEN INPUT T-M HI-M TC-M JCON JT-THTN TSKF.                  D.010419
006850*****OPEN INPUT T-M HI-M TC-M JCON TSKF.                          D.020215
006860     OPEN INPUT T-M HI-M TC-M JCON TSKF HUH-M.                    I.020215
006870     OPEN INPUT OTHTM.                                            I.110407
006880*****OPEN I-O TAZ-M.                                              D.070124
006890     OPEN I-O HSMSF.
006900     OPEN I-O THTM.                                               I.010419
006910     OPEN INPUT S-TRAN.
006920     READ S-TRAN AT END
006930         GO TO M-20.
006940 M-10.
006950     IF S-DHC NOT = 0
006960         DISPLAY E-ME19 E-ME99
006970         MOVE 255 TO COMPLETION-CODE
006980         GO TO M-95.
006990     READ S-TRAN AT END
007000         DISPLAY E-ME20 E-ME99
007010         GO TO M-15.
007020     GO TO M-10.
007030 M-15.
007040     ACCEPT A-CHK.
007050     IF ESTAT NOT = HTB AND SKP
007060         GO TO M-15.
007070     IF CHK = 1
007080         GO TO M-20.
007090     IF CHK = 5
007100         MOVE 255 TO COMPLETION-CODE
007110         GO TO M-95.
007120     GO TO M-15.
007130 M-20.
007140     CLOSE S-TRAN.
007150*****OPEN INPUT HKBM.                                             D.170828
007160*****MOVE SPACE TO HKB-KEY.                                       D.170828
007170*****MOVE "05" TO HKB-NO.                                         D.170828
007180*****READ HKBM WITH UNLOCK INVALID KEY                            D.170828
007190*****    CLOSE HKBM                                               D.170828
007200*****    DISPLAY E-ME78 E-ME23 E-ME99                             D.170828
007210*****    MOVE 255 TO COMPLETION-CODE                              D.170828
007220*****    GO TO M-95.                                              D.170828
007230*****MOVE HKB-UNN TO W-DNOD W-DNOO.                               D.170828
007240*****CLOSE HKBM.                                                  D.170828
007250     OPEN OUTPUT S-TRAN.
007260 M-25.
007270     ACCEPT A-UNC.
007280     IF ESTAT = C2 OR PF9
007290         GO TO M-95.
007300     IF ESTAT NOT = HTB AND SKP
007310         GO TO M-25.
007320*
007330     MOVE ZERO TO W-NGP.
007340     IF W-UNCD > 1
007350         GO TO M-25.
007360 M-30.
007370     IF W-UNCD = 1
007380         GO TO M-35.
007390*
007400     PERFORM UAC-RTN THRU UAC-EX.
007410     IF ESTAT = BTB
007420         DISPLAY C-CLEAR
007430         DISPLAY C-MID
007440         IF JS-SIGN = 1                                           I.170828
007450             DISPLAY C-MID1 A-SEN                                 I.170828
007460             GO TO M-25                                           I.170828
007470           ELSE                                                   I.170828
007480             GO TO M-25.
007490     IF W-END NOT = 0
007500         GO TO M-95.
007510     GO TO M-80.
007520 M-35.
007530     PERFORM NAC-RTN THRU NAC-EX.
007540     IF ESTAT = BTB
007550         DISPLAY C-CLEAR
007560         DISPLAY C-MID
007570         IF JS-SIGN = 1                                           I.170828
007580             DISPLAY C-MID1 A-SEN                                 I.170828
007590             GO TO M-25                                           I.170828
007600           ELSE                                                   I.170828
007610             GO TO M-25.
007620     IF W-END NOT = 0
007630         GO TO M-95.
007640 M-80.
007650     PERFORM UPD-RTN THRU UPD-EX.
007660     CLOSE THTM.                                                  I.150407
007670     OPEN I-O THTM.                                               I.150407
007680     IF W-END = 0
007690         GO TO M-30.
007700 M-95.
007710*****CLOSE T-M HI-M TC-M JCON JT-THTN.                            D.000922
007720*****CLOSE T-M HI-M TC-M JCON JT-THTN TSKF.                       D.010419
007730*****CLOSE T-M HI-M TC-M JCON TSKF.                               D.020215
007740     CLOSE T-M HI-M TC-M JCON TSKF HUH-M.                         I.020215
007750*****CLOSE TAZ-M.                                                 D.070124
007760     CLOSE HSMSF.
007770     CLOSE OTHTM.                                                 I.110407
007780     CLOSE THTM.                                                  I.010419
007790     CLOSE S-TRAN.
007800     DISPLAY C-CLEAR.
007810     STOP RUN.
007820 NGC-RTN.                                                         I.160907
007830     DISPLAY C-MID1.                                              I.170828
007840 NGC-020.                                                         I.170828
007850     ACCEPT A-SEN.                                                I.170828
007860     IF ESTAT = C2 OR PF9                                         I.170828
007870         MOVE 1 TO W-END                                          I.170828
007880         GO TO NGC-EX.                                            I.170828
007890     IF ESTAT NOT = HTB AND SKP                                   I.170828
007900         GO TO NGC-020.                                           I.170828
007910     IF W-SEN = 0                                                 I.170828
007920         GO TO NGC-040.                                           I.170828
007930     IF W-SEN NOT = 1                                             I.170828
007940         GO TO NGC-020.                                           I.170828
007950     ADD 1 TO W-CG.                                               I.160907
007960     IF W-CG = 13                                                 I.160907
007970         MOVE 1 TO W-CG                                           I.160907
007980         ADD 1 TO W-CN.                                           I.160907
007990 NGC-040.                                                         I.170828
008000     OPEN INPUT BBS-TRAN.                                         I.170828
008010     READ BBS-TRAN AT END                                         I.170828
008020         GO TO NGC-060.                                           I.170828
008030     IF BBS-CNG NOT = W-CNG                                       I.170828
008040         CLOSE BBS-TRAN                                           I.170828
008050         DISPLAY E-ME31 E-ME99                                    I.170828
008060         MOVE 1 TO W-END                                          I.170828
008070         GO TO NGC-EX.                                            I.170828
008080 NGC-060.                                                         I.170828
008090     CLOSE BBS-TRAN.                                              I.170828
008100 NGC-EX.                                                          I.160907
008110     EXIT.                                                        I.160907
008120*----------  出荷　入力  -------------------------------------------------
008130 UAC-RTN.
008140     IF W-NGP NOT = ZERO
008150         GO TO UAC-040.
008160     MOVE ZERO TO W-TCDD W-CSCD W-HNOD.
008170     MOVE ZERO TO W-NGP.
008180     MOVE DATE-02R TO W-NGPS.
008190 UAC-020.
008200     CALL "SCHD01".
008210     DISPLAY AU-NGP.
008220     ACCEPT AU-NGP.
008230     DISPLAY E-CL.
008240     IF ESTAT = C2 OR PF9
008250         MOVE 1 TO W-END
008260         GO TO UAC-EX.
008270     IF ESTAT = BTB
008280         GO TO UAC-EX.
008290     IF ESTAT NOT = HTB AND SKP
008300         GO TO UAC-020.
008310     IF W-NGPS = ZERO
008320         MOVE DATE-02R TO W-NGPS
008330         DISPLAY AU-NGP.
008340 UAC-040.
008350     CALL "SCHD01".
008360     DISPLAY AU-NGP.
008370     MOVE ZERO TO W-ND1.
008380     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
008390         ADD DATE-NC1 TO W-ND.
008400     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
008410         ADD DATE-NC2 TO W-ND.
008420     IF W-NGD NOT = W-CNG
008430         DISPLAY E-ME12 E-ME98
008440         GO TO UAC-020.
008450     IF W-PD < 1 OR > 31
008460         GO TO UAC-020.
008470     MOVE ZERO TO W-HNOD W-HNC W-CSCD.
008480 UAC-060.
008490     ACCEPT AU-HMN.
008500     DISPLAY E-CL.
008510     IF ESTAT = BTB
008520         GO TO UAC-020.
008530     IF ESTAT NOT = HTB AND SKP
008540         GO TO UAC-060.
008550     IF W-HMN = ZERO
008560         DISPLAY SU-HMN
008570         GO TO UAC-080.
008580     MOVE SPACE TO HSMS-KEY.
008590     MOVE W-HMN TO HSMS-01.
008600     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
008610         DISPLAY E-ME21 E-ME98
008620         MOVE 1 TO W-HNC                                          I.081222
008630         MOVE W-HMN TO W-HNOD                                     I.081222
008640         GO TO UAC-080.                                           I.081222
008650*****    GO TO UAC-060.                                           D.081222
008660     READ HSMSF NEXT RECORD AT END
008670         DISPLAY E-ME21 E-ME98
008680         MOVE 1 TO W-HNC                                          I.081222
008690         MOVE W-HMN TO W-HNOD                                     I.081222
008700         GO TO UAC-080.                                           I.081222
008710*****    GO TO UAC-060.                                           D.081222
008720     IF W-HMN NOT = HSMS-01
008730         DISPLAY E-ME21 E-ME98
008740         MOVE 1 TO W-HNC                                          I.081222
008750         MOVE W-HMN TO W-HNOD                                     I.081222
008760         GO TO UAC-080.                                           I.081222
008770*****    GO TO UAC-060.                                           D.081222
008780     IF HSMS-02 = 7
008790         DISPLAY E-ME21 E-ME98
008800         GO TO UAC-060.
008810     PERFORM HMN-RTN THRU HMN-EX.
008820     IF W-INV = 1                                                 I.001031
008830         GO TO UAC-060.                                           I.001031
008840     IF W-EC NOT = 0                                              I.020215
008850         MOVE 0 TO W-EC                                           I.020215
008860         GO TO UAC-060.                                           I.001031
008870     IF T-BC NOT = ZERO                                           I.001031
008880         DISPLAY E-ME1 E-ME98                                     I.001031
008890         GO TO UAC-060.                                           I.001031
008900*****IF T-KL < 1 OR > 5                                           D.010419
008910*****    DISPLAY E-ME13 E-ME98                                    D.010419
008920*****    GO TO UAC-060.                                           D.010419
008930     MOVE 1 TO W-DSPC.                                            I.020404
008940     PERFORM DSP-RTN THRU DSP-EX.
008950     MOVE 0 TO W-RC.                                              I.020214
008960     MOVE 1 TO W-L1.                                              I.020214
008970     MOVE 2 TO W-L2.                                              I.020214
008980     MOVE 3 TO W-L3.                                              I.020214
008990 UAC-070.                                                         I.020214
009000     ADD 1 TO W-RC.                                               I.020214
009010     ADD 3 TO W-L1 W-L2 W-L3.                                     I.020214
009020     IF W-RC > 6                                                  I.020214
009030         GO TO UAC-800.                                           I.020214
009040     MOVE W-AS(W-RC) TO W-SR.                                     I.020214
009050     IF W-GNO = 0                                                 I.020404
009060         GO TO UAC-360.                                           I.020404
009070*****IF W-GNO NOT = 0                                             D.020404
009080     IF W-RCB = ZERO                                              I.020404
009090         GO TO UAC-070.                                           I.020214
009100     IF W-RC NOT = W-RCB                                          I.020404
009110         GO TO UAC-070.                                           I.020404
009120     MOVE W-RCB TO W-RC.                                          I.020404
009130     MOVE W-LB TO W-L.                                            I.020404
009140     GO TO UAC-360.                                               I.020214
009150 UAC-080.
009160     MOVE W-SCD TO WK-SCD.
009170     ACCEPT AU-SOK.
009180     DISPLAY E-CL.
009190     IF ESTAT = BTB
009200         GO TO UAC-060.
009210     IF W-HMN NOT = ZERO
009220         IF W-HNC = 0                                             I.081222
009230             IF ESTAT = ADV
009240                 MOVE WK-SCD TO W-SCD
009250                 MOVE 1 TO W-ADV
009260                 GO TO UAC-090.
009270     IF ESTAT NOT = HTB AND SKP
009280         GO TO UAC-080.
009290 UAC-090.
009300     IF W-SCD = ZERO
009310         MOVE W-SCD TO W-SOK
009320         DISPLAY SU-SOK
009330         GO TO UAC-100.
009340     MOVE 3 TO JCON3-01.
009350     MOVE W-SCD TO JCON3-02.
009360     READ JCON UNLOCK INVALID
009370         MOVE  SPACE TO JCON3-03
009380         DISPLAY DU-SNA MG-03 E-ME98
009390         GO TO UAC-080.
009400     MOVE W-SCD TO W-SOK.
009410     DISPLAY AU-SOK DU-SNA.
009420 UAC-100.
009430     IF W-HMN NOT = ZERO
009440         IF W-HNC = 0                                             I.081222
009450             IF ESTAT = ADV
009460                 GO TO UAC-280.
009470 UAC-120.
009480     ACCEPT AU-TCD.
009490     DISPLAY E-CL.
009500     IF ESTAT = BTB
009510         GO TO UAC-080.
009520     IF ESTAT NOT = HTB AND SKP
009530         GO TO UAC-120.
009540     PERFORM TM-RTN THRU TM-EX.
009550     IF W-INV = 1
009560         DISPLAY E-ME1 E-ME98
009570         GO TO UAC-120.
009580     IF T-BC NOT = ZERO
009590         DISPLAY E-ME1 E-ME98
009600         GO TO UAC-120.
009610*****IF T-KL < 1 OR > 5                                           D.010531
009620*****    DISPLAY E-ME13 E-ME98                                    D.010531
009630*****    GO TO UAC-120.                                           D.010531
009640*UAC-140.                                                         D.081222
009650*****ACCEPT AU-HN1.                                               D.081222
009660*****IF ESTAT = BTB                                               D.081222
009670*****    GO TO UAC-080.                                           D.081222
009680*****IF ESTAT NOT = HTB AND SKP                                   D.081222
009690*****    GO TO UAC-140.                                           D.081222
009700*****IF W-HN1 = ZERO                                              D.081222
009710*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
009720*****    DISPLAY SU-HN1 SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6        D.081222
009730*****    GO TO UAC-260.                                           D.081222
009740*UAC-160.                                                         D.081222
009750*****ACCEPT AU-HN2.                                               D.081222
009760*****IF ESTAT = BTB                                               D.081222
009770*****    GO TO UAC-140.                                           D.081222
009780*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009790*****    GO TO UAC-160.                                           D.081222
009800*****IF ESTAT = ADV                                               D.081222
009810*****    COMPUTE W-HN2 = W-HN1 + 1                                D.081222
009820*****    DISPLAY AU-HN2.                                          D.081222
009830*****IF W-HN2 = ZERO                                              D.081222
009840*****    MOVE 1 TO W-HNC                                          D.081222
009850*****    MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                     D.081222
009860*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6               D.081222
009870*****    GO TO UAC-260.                                           D.081222
009880*UAC-180.                                                         D.081222
009890*****ACCEPT AU-HN3.                                               D.081222
009900*****IF ESTAT = BTB                                               D.081222
009910*****    GO TO UAC-160.                                           D.081222
009920*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
009930*****    GO TO UAC-180.                                           D.081222
009940*****IF ESTAT = ADV                                               D.081222
009950*****    COMPUTE W-HN3 = W-HN2 + 1                                D.081222
009960*****    DISPLAY AU-HN3.                                          D.081222
009970*****IF W-HN3 = ZERO                                              D.081222
009980*****    MOVE 2 TO W-HNC                                          D.081222
009990*****    MOVE ZERO TO W-HN4 W-HN5 W-HN6                           D.081222
010000*****    DISPLAY SU-HN3 SU-HN4 SU-HN5 SU-HN6                      D.081222
010010*****    GO TO UAC-260.                                           D.081222
010020*UAC-200.                                                         D.081222
010030*****ACCEPT AU-HN4.                                               D.081222
010040*****IF ESTAT = BTB                                               D.081222
010050*****    GO TO UAC-180.                                           D.081222
010060*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
010070*****    GO TO UAC-200.                                           D.081222
010080*****IF ESTAT = ADV                                               D.081222
010090*****    COMPUTE W-HN4 = W-HN3 + 1                                D.081222
010100*****    DISPLAY AU-HN4.                                          D.081222
010110*****IF W-HN4 = ZERO                                              D.081222
010120*****    MOVE 3 TO W-HNC                                          D.081222
010130*****    MOVE ZERO TO W-HN5 W-HN6                                 D.081222
010140*****    DISPLAY SU-HN4 SU-HN5 SU-HN6                             D.081222
010150*****    GO TO UAC-260.                                           D.081222
010160*UAC-220.                                                         D.081222
010170*****ACCEPT AU-HN5.                                               D.081222
010180*****IF ESTAT = BTB                                               D.081222
010190*****    GO TO UAC-200.                                           D.081222
010200*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
010210*****    GO TO UAC-220.                                           D.081222
010220*****IF ESTAT = ADV                                               D.081222
010230*****    COMPUTE W-HN5 = W-HN4 + 1                                D.081222
010240*****    DISPLAY AU-HN5.                                          D.081222
010250*****IF W-HN5 = ZERO                                              D.081222
010260*****    MOVE 4 TO W-HNC                                          D.081222
010270*****    MOVE ZERO TO W-HN6                                       D.081222
010280*****    DISPLAY SU-HN5 SU-HN6                                    D.081222
010290*****    GO TO UAC-260.                                           D.081222
010300*UAC-240.                                                         D.081222
010310*****ACCEPT AU-HN6.                                               D.081222
010320*****IF ESTAT = BTB                                               D.081222
010330*****    GO TO UAC-220.                                           D.081222
010340*****IF ESTAT NOT = HTB AND SKP AND ADV                           D.081222
010350*****    GO TO UAC-240.                                           D.081222
010360*****IF ESTAT = ADV                                               D.081222
010370*****    COMPUTE W-HN6 = W-HN5 + 1                                D.081222
010380*****    DISPLAY AU-HN6.                                          D.081222
010390*****IF W-HN6 = ZERO                                              D.081222
010400*****    MOVE 5 TO W-HNC                                          D.081222
010410*****    DISPLAY SU-HN6                                           D.081222
010420*****  ELSE                                                       D.081222
010430*****    MOVE 6 TO W-HNC.                                         D.081222
010440 UAC-260.
010450     ACCEPT AU-CCD.
010460     DISPLAY E-CL.
010470     IF ESTAT = BTB
010480         GO TO UAC-120.                                           I.081222
010490*****    IF W-HNC > 4                                             D.081222
010500*****        GO TO UAC-240.                                       D.081222
010510*****IF ESTAT = BTB                                               D.081222
010520*****    IF W-HNC = 4                                             D.081222
010530*****        GO TO UAC-220.                                       D.081222
010540*****IF ESTAT = BTB                                               D.081222
010550*****    IF W-HNC = 3                                             D.081222
010560*****        GO TO UAC-200.                                       D.081222
010570*****IF ESTAT = BTB                                               D.081222
010580*****    IF W-HNC = 2                                             D.081222
010590*****        GO TO UAC-180.                                       D.081222
010600*****IF ESTAT = BTB                                               D.081222
010610*****    IF W-HNC = 1                                             D.081222
010620*****        GO TO UAC-160.                                       D.081222
010630*****IF ESTAT = BTB                                               D.081222
010640*****    GO TO UAC-140.                                           D.081222
010650     IF ESTAT NOT = HTB AND SKP
010660         GO TO UAC-260.
010670     PERFORM TCM-RTN THRU TCM-EX.
010680     IF W-INV = 1
010690         DISPLAY E-ME2 E-ME98
010700         GO TO UAC-260.
010710     IF W-INV = 9
010720         DISPLAY E-ME3 E-ME99
010730         MOVE 1 TO W-END
010740         GO TO UAC-EX.
010750 UAC-280.
010760     DISPLAY AU-CSC.
010770     IF W-CSCD = ZERO
010780         GO TO UAC-320.
010790 UAC-300.
010800     ACCEPT AU-CSC.
010810     IF ESTAT = BTB
010820         GO TO UAC-260.
010830     IF ESTAT NOT = HTB AND SKP
010840         GO TO UAC-300.
010850     IF W-CSCD NOT = 0 AND 9
010860         GO TO UAC-300.
010870 UAC-320.
010880     MOVE 1 TO W-L1.
010890     MOVE 2 TO W-L2.
010900     MOVE 3 TO W-L3.
010910     MOVE ZERO TO W-RC W-DCD W-ZC.                                I.131228
010920*****IF W-CNGS < 1404                                             D.140328
010930*****    MOVE 5 TO W-HSCD                                         D.141328
010940*****  ELSE                                                       D.141328
010950     MOVE 8 TO W-HSCD.                                            I.131228
010960*****MOVE ZERO TO W-RC W-DCD W-ZC W-HSCD.                         D.131228
010970*****IF W-HMN = ZERO                                              D.081222
010980     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
010990*****    INITIALIZE W-ASR W-BR                                    D.171018
011000         INITIALIZE W-BR                                          I.171018
011010         MOVE ZERO TO W-ASR                                       I.171018
011020         MOVE ALL NX"2121" TO W-BI.
011030 UAC-340.
011040     MOVE 0 TO W-DEL.
011050     ADD 1 TO W-RC.
011060     ADD 3 TO W-L1 W-L2 W-L3.
011070     IF W-RC > 6
011080         GO TO UAC-760.
011090     IF W-RC = 2
011100         IF W-DC = 8
011110             MOVE 5 TO W-ZC.
011120     IF W-ZC = 5
011130         GO TO UAC-420.
011140 UAC-360.
011150     MOVE W-AS(W-RC) TO W-SR.
011160     MOVE W-SCD TO W-SOK.
011170     MOVE W-NGP TO W-DATE.
011180     MOVE W-TCDN TO W-TCD.
011190     MOVE W-TCDD TO W-TCD2.
011200     MOVE W-CSCD TO W-CSC.
011210     MOVE T-TNC TO W-TC2.
011220     MOVE T-FKC TO W-FKC.
011230     MOVE W-CCDD TO W-CCD.
011240 UAC-380.
011250     IF W-DEL = 9
011260         MOVE 0 TO W-DEL
011270         GO TO UAC-400.
011280     IF W-HMN NOT = ZERO
011290         IF W-HNC = 0                                             I.081222
011300             IF W-HCD NOT = ZERO
011310                 GO TO UAC-400.
011320     MOVE W-DCD TO W-DC.
011330     DISPLAY AU-DC.
011340 UAC-400.
011350     MOVE W-DC TO WK-DC.
011360     MOVE 0 TO W-ADV.
011370     ACCEPT AU-DC.
011380     DISPLAY E-CL.
011390     IF ESTAT = PF21
011400         MOVE W-RC TO W-RCD
011410         MOVE W-L TO W-LD
011420         GO TO UAC-430.
011430*****IF ESTAT = C1                                                D.001205
011440     IF ESTAT = C1 OR PF6                                         I.001205
011450         MOVE 5 TO W-ZC
011460         GO TO UAC-420.
011470*****IF ESTAT = FUK                                               D.081222
011480*****    GO TO UAC-760.                                           D.081222
011490     IF ESTAT = ADV
011500         IF W-HCD NOT = ZERO
011510             MOVE WK-DC TO W-DC
011520             DISPLAY AU-DC
011530             MOVE 1 TO W-ADV
011540             GO TO UAC-440.
011550     IF ESTAT NOT = BTB
011560         GO TO UAC-440.
011570*****IF W-HMN = ZERO                                              D.081222
011580     IF (W-HMN = ZERO) OR (W-HNC NOT = 0)                         I.081222
011590         IF W-GNO = ZERO
011600             MOVE ZERO TO W-SR
011610                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
011620                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
011630             MOVE W-SR TO W-AS(W-RC)
011640             DISPLAY SU-D1 SU-D2 SU-D3.
011650 UAC-410.
011660     SUBTRACT 1 FROM W-RC.
011670     SUBTRACT 3 FROM W-L1 W-L2 W-L3.
011680     IF W-RC = ZERO
011690         GO TO UAC-300.
011700     MOVE W-AS(W-RC) TO W-SR.
011710     IF W-GNO = ZERO
011720         GO TO UAC-410.
011730     GO TO UAC-400.
011740 UAC-420.
011750     IF W-RC = 1
011760*****    MOVE ZERO TO W-HCD W-SIZ W-SUS W-SUT W-BT W-KIN W-DC     D.000822
011770         MOVE ZERO TO W-HCD W-SIZ W-SUT W-BT W-KIN W-DC           I.000822
011780                      W-FT W-BC1 W-BC2 W-BC3 W-SOK
011790                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
011800                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
011810         MOVE SPACE TO W-BIK
011820         MOVE W-RC TO W-GNO
011830         MOVE W-SR TO W-AS(W-RC)
011840         DISPLAY SU-D1 SU-D2 SU-D3
011850         GO TO UAC-340.
011860     MOVE ZERO TO W-SR.
011870     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
011880                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
011890     MOVE SPACE TO W-BIK.
011900     MOVE W-SR TO W-AS(W-RC).
011910     DISPLAY SU-D1 SU-D2 SU-D3.
011920     GO TO UAC-340.
011930 UAC-430.
011940     IF W-RC NOT = 6
011950         COMPUTE CNT = W-RC + 1
011960         MOVE W-AS(CNT) TO W-AS(W-RC)
011970         ADD 1 TO W-RC
011980         GO TO UAC-430.
011990     MOVE ZERO TO W-AS(W-RC).
012000     MOVE 0 TO W-DSPC.                                            I.020404
012010     PERFORM DSP-RTN THRU DSP-EX.
012020     MOVE W-RCD TO W-RC.
012030     MOVE W-LD TO W-L.
012040     MOVE 9 TO W-DEL.
012050     GO TO UAC-360.
012060 UAC-440.
012070     IF ESTAT NOT = HTB AND SKP AND ADV
012080         GO TO UAC-380.
012090     IF W-CSCD = 9                                                I.131227
012100         IF W-DC NOT = 8                                          I.131227
012110             GO TO UAC-380.                                       I.070126
012120     IF W-DC = 8                                                  I.131227
012130         IF W-CSCD NOT = 9                                        I.131227
012140             GO TO UAC-380.                                       I.070126
012150     IF W-DC = 6 OR 9                                             I.070126
012160         GO TO UAC-380.                                           I.070126
012170     IF W-DC NOT = 2 AND 3 AND 6 AND 8 AND 9
012180         IF W-SOK = 0
012190             DISPLAY MG-05 E-ME98
012200             GO  TO  UAC-380.
012210     IF W-RC NOT = 1
012220         IF W-DC = 8
012230             DISPLAY E-ME4 E-ME98
012240             GO TO UAC-380.
012250     IF W-CCDD NOT = ZERO
012260         IF W-DC = 3 OR  9
012270             DISPLAY E-ME4 E-ME98
012280             GO TO UAC-380.
012290     IF W-CSC = 9
012300         IF W-DC = 4
012310             DISPLAY E-ME4 E-ME98
012320             GO TO UAC-380.
012330     IF W-RC NOT = 1
012340         GO TO UAC-450.
012350     IF W-DC = 1 OR 2                                             I.010327
012360         MOVE ZERO TO W-HNOD W-HNC.                               I.020214
012370*****    MOVE ZERO TO W-HNOD W-HNC                                D.020214
012380*****    DISPLAY SU-HMN.                                          D.020214
012390     MOVE W-DC TO W-DCD.
012400     IF W-DC = 4  OR  7
012410         MOVE ZERO TO W-DCD.
012420 UAC-450.
012430     MOVE W-DC TO W-DCC.
012440     IF W-DC = 4  OR  7
012450         MOVE ZERO TO W-DCC.
012460     IF W-DCD NOT = W-DCC
012470         DISPLAY E-ME4 E-ME98
012480         GO TO UAC-380.
012490     IF W-DC = 8
012500         DISPLAY SU-D2 SU-D3
012510*****    MOVE ZERO TO W-ZD1 W-ZD2 W-FT W-HSC                      D.131228
012520         MOVE ZERO TO W-ZD1 W-ZD2 W-FT                            I.131228
012530                     W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05) I.000822
012540                     W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10) I.000822
012550         DISPLAY DU-SZM
012560*****    IF W-CNGS < 1404                                         D.140328
012570*****        MOVE 5 TO W-HSC                                      D.140328
012580*****        GO TO UAC-700                                        D.140328
012590*****      ELSE                                                   D.140328
012600         MOVE 8 TO W-HSC                                          I.131228
012610         GO TO UAC-700.
012620     MOVE W-HCD TO W-HCDO.                                        I.010419
012630 UAC-480.
012640     IF W-ADV NOT = 0
012650         GO TO UAC-490.
012660     ACCEPT AU-HCD.
012670     DISPLAY E-CL.
012680     IF ESTAT = BTB
012690         GO TO UAC-400.
012700*****IF ESTAT = C1                                                D.001205
012710     IF ESTAT = C1 OR PF6                                         I.001205
012720         MOVE 5 TO W-ZC
012730         GO TO UAC-420.
012740*****IF ESTAT = FUK                                               D.081222
012750*****    GO TO UAC-760.                                           D.081222
012760     IF ESTAT NOT = HTB AND SKP
012770         GO TO UAC-480.
012780     IF W-HCD = ZERO
012790         MOVE W-HCDD TO W-HCD.
012800     IF W-HCD NOT = W-HCDO                                        I.010419
012810         MOVE ZERO TO W-BT.                                       I.010449
012820 UAC-490.
012830     MOVE 0 TO W-HIC.                                             I.020214
012840     PERFORM HI-RTN THRU HI-EX.
012850     IF W-EC NOT = ZERO
012860         MOVE 0 TO W-EC W-ADV
012870         GO TO UAC-480.
012880     IF W-DC = 3 OR 4 OR 9
012890        IF HI-S4(10) NOT = 1
012900            DISPLAY E-ME8 E-ME98
012910            MOVE 0 TO W-ADV
012920            GO  TO    UAC-480.
012930     IF W-HCD > 999899
012940*****    MOVE ZERO TO W-SIZ W-SUS W-FT                            D.000822
012950         MOVE ZERO TO W-SIZ W-FT                                  I.000822
012960                    W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)  I.000822
012970                    W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10)  I.000822
012980         DISPLAY SU-D2 SU-D31
012990         GO TO UAC-520.
013000     IF W-DC NOT = 3 AND 9
013010         GO TO UAC-550.
013020*****MOVE ZERO TO W-SIZ W-SUS.                                    D.000822
013030     MOVE ZERO TO W-SIZ                                           I.000822
013040                  W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
013050                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
013060     DISPLAY SU-D2 SU-D31.
013070 UAC-520.
013080     IF W-ADV NOT = 0
013090         GO TO UAC-540.
013100     ACCEPT AU-SUT.
013110     DISPLAY E-CL.
013120     IF ESTAT = BTB
013130         MOVE 0 TO W-ADV
013140         MOVE W-HCD TO W-HCDO                                     I.010419
013150         GO TO UAC-480.
013160     IF ESTAT NOT = HTB AND SKP
013170         GO TO UAC-520.
013180     IF W-HCD < 999900
013190         MOVE HI-FT TO W-FT.
013200 UAC-540.
013210*****IF W-BT NOT = ZERO                                           D.020401
013220     IF W-BT = ZERO                                               I.020401
013230         PERFORM TAN-RTN THRU TAN-EX.                             I.010419
013240*****IF WK-TAN   NOT = ZERO                                       D.010419
013250*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
013260*****    MOVE  WK-TAN  TO  W-BT                                   D.010419
013270*****    GO  TO  UAC-660.                                         D.010419
013280*****IF HI-SS4 NOT = ZERO                                         D.010419
013290*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
013300*****    GO TO UAC-660.                                           D.010419
013310*****IF HI-SS3 NOT = ZERO                                         D.010419
013320*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
013330*****    GO TO UAC-660.                                           D.010419
013340*****IF HI-SS2 NOT = ZERO                                         D.010419
013350*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
013360*****    GO TO UAC-660.                                           D.010419
013370*****MOVE HI-U1(T-KL) TO W-BT.                                    D.010419
013380     GO TO UAC-660.
013390 UAC-550.
013400*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
013410*****IF W-DC NOT = 0                                              D.050805
013420*****    GO TO UAC-555.                                           D.050805
013430*****MOVE W-TCD TO TAZ-TCD.                                       D.050805
013440*****MOVE W-HCD TO TAZ-HCD.                                       D.050805
013450*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.050805
013460*****    GO TO UAC-555.                                           D.050805
013470*****DISPLAY E-ME11 E-ME99.                                       D.050805
013480*UAC-555.                                                         D.050805
013490     IF W-ADV NOT = 0
013500         GO TO UAC-570.
013510 UAC-560.                                                         I.050420
013520     ACCEPT AU-SIZ.
013530     DISPLAY E-CL.
013540     IF ESTAT = BTB
013550         MOVE 0 TO W-ADV
013560         GO TO UAC-440.
013570 UAC-570.
013580     IF W-SIZ < 1 OR > 4
013590         MOVE 0 TO W-ADV
013600         GO TO UAC-560.                                           I.050420
013610*****    GO TO UAC-550.                                           D.050420
013620     MOVE HI-FT TO W-FT.
013630     IF W-SIZ = 1
013640*****    MOVE HI-U1(T-KL) TO W-BT                                 D.010419
013650         DISPLAY DU-S1
013660         MOVE HI-SS1 TO W-ASD.
013670     IF W-SIZ = 2
013680*****    MOVE HI-U2(T-KL) TO W-BT                                 D.010419
013690         DISPLAY DU-S2
013700         MOVE HI-SS2 TO W-ASD.
013710     IF W-SIZ = 3
013720*****    MOVE HI-U3(T-KL) TO W-BT                                 D.010419
013730         DISPLAY DU-S3
013740         MOVE HI-SS3 TO W-ASD.
013750     IF W-SIZ = 4
013760*****    MOVE HI-U4(T-KL) TO W-BT                                 D.010419
013770         DISPLAY DU-S4
013780         MOVE HI-SS4 TO W-ASD.
013790     IF W-ASD = ZERO OR SPACE
013800         MOVE 0 TO W-ADV
013810         DISPLAY E-ME9 E-ME98
013820         GO TO UAC-560.                                           I.050420
013830*****    GO TO UAC-550.                                           D.050420
013840     IF W-SIZ = 4
013850         IF W-ASD = "0000000001"
013860             MOVE 0 TO W-ADV
013870             DISPLAY E-ME9 E-ME98
013880             GO TO UAC-560.                                       I.050420
013890*****        GO TO UAC-550.                                       D.050420
013900     IF W-DC = 2 OR 6
013910         MOVE ZERO TO W-FT.
013920     IF W-BT = ZERO                                               I.010419
013930         PERFORM TAN-RTN THRU TAN-EX.
013940*****IF WK-TAN   NOT = ZERO                                       D.010419
013950*****    MOVE  WK-TAN  TO  W-BT.                                  D.010419
013960     MOVE ZERO TO W-SC W-ZC.
013970     MOVE -3 TO W-C.
013980 UAC-580.
013990     ADD 1 TO W-SC.
014000     IF W-SC > 8
014010         ADD 5 TO W-C
014020       ELSE
014030         ADD 6 TO W-C.
014040     IF W-SC = 11
014050         MOVE ZERO TO W-SC W-SUT
014060         GO TO UAC-630.
014070     IF (W-SD(W-SC) = ZERO) OR (W-ZC = 5)
014080         MOVE ZERO TO W-SU(W-SC)
014090         GO TO UAC-610.
014100     IF W-SC = 10
014110         IF W-SIZ = 4
014120             MOVE ZERO TO W-SU(W-SC)
014130             GO TO UAC-580.
014140 UAC-600.
014150     IF W-ADV NOT = 0
014160         GO TO UAC-610.
014170     IF W-SC > 7
014180         ACCEPT AU-SU1
014190       ELSE
014200         ACCEPT AU-SU.
014210     IF ESTAT = BTB
014220         MOVE 0 TO W-ADV
014230         GO TO UAC-620.
014240*****IF ESTAT = C1                                                D.001205
014250     IF ESTAT = C1 OR PF6                                         I.001205
014260         MOVE 5 TO W-ZC
014270         MOVE ZERO TO W-SU(W-SC)
014280         MOVE 0 TO W-ADV
014290         GO TO UAC-610.
014300*****IF ESTAT = FUK                                               D.081222
014310*****    MOVE ZERO TO W-SC W-SUT                                  D.081222
014320*****    GO TO UAC-630.                                           D.081222
014330     IF ESTAT NOT = HTB AND SKP
014340         MOVE 0 TO W-ADV
014350         GO TO UAC-600.
014360     IF W-SC > 7
014370         IF W-SU(W-SC) > 999 OR < -999
014380             GO TO UAC-600.
014390 UAC-610.
014400     IF W-SC < 8
014410         DISPLAY DU-SU
014420       ELSE
014430         DISPLAY DU-SU1.
014440     GO TO UAC-580.
014450 UAC-620.
014460     IF W-ADV NOT = ZERO
014470         MOVE 0 TO W-ADV.
014480     SUBTRACT 1 FROM W-SC.
014490     IF W-SC > 7
014500         SUBTRACT 5 FROM W-C
014510       ELSE
014520         SUBTRACT 6 FROM W-C.
014530     IF W-SC = ZERO
014540         GO TO UAC-560.                                           I.050420
014550*****    GO TO UAC-550.                                           D.050420
014560     IF W-SD(W-SC) = ZERO
014570         GO TO UAC-620.
014580     IF W-SC = 10
014590         IF W-SIZ = 4
014600             GO TO UAC-620.
014610     GO TO UAC-600.
014620 UAC-630.
014630     ADD 1 TO W-SC.
014640     IF W-SC < 11
014650         ADD W-SU(W-SC) TO W-SUT
014660         GO TO UAC-630.
014670     MOVE ZERO TO W-ZC.
014680     IF W-SUT = ZERO
014690         MOVE ZERO TO W-SC
014700         MOVE -3 TO W-C
014710         MOVE 0 TO W-ADV
014720         GO TO UAC-580.
014730 UAC-660.
014740     DISPLAY DU-SUT DU-BT.
014750     IF W-DC = 7
014760         MOVE ZERO TO W-BT W-KIN
014770         DISPLAY SU-BT SU-KIN
014780         GO TO UAC-720.
014790     IF W-DC = 4
014800         COMPUTE W-KIN = W-SUT * W-BT
014810         MOVE ZERO TO W-FT
014820         DISPLAY SU-KIN SU-BT
014830         GO TO UAC-720.
014840     ACCEPT AU-BT.
014850     DISPLAY E-CL.
014860     IF ESTAT NOT = BTB
014870         GO TO UAC-670.
014880     MOVE 0 TO W-ADV.
014890     IF W-HCD > 999899
014900         GO TO UAC-520.
014910     IF W-DC = 3 OR 9
014920         GO TO UAC-520.
014930     MOVE 11 TO W-SC.
014940     MOVE 60 TO W-C.
014950     GO TO UAC-620.
014960 UAC-670.
014970*****IF ESTAT NOT = HTB AND SKP                                   D.110407
014980     IF ESTAT NOT = HTB AND SKP AND PF4                           I.110407
014990         GO TO UAC-660.
015000     IF ESTAT = PF4                                               I.110407
015010         PERFORM TAO-RTN THRU TAO-EX.                             I.110407
015020     DISPLAY DU-BT.
015030     IF W-HCD < 999900
015040         IF W-BT = ZERO
015050*****        IF W-DC = 2                                          D.130703
015060             DISPLAY E-ME15 E-ME99                                I.070403
015070             DISPLAY E-CL.                                        I.130703
015080*****            DISPLAY E-CL                                     D.130703
015090*****          ELSE                                               D.130703
015100*****            GO TO UAC-660.                                   D.130703
015110     IF W-HCD > 999899
015120         IF W-BT = ZERO
015130             DISPLAY E-ME15 E-ME99
015140             DISPLAY E-CL.
015150     COMPUTE W-KIN = W-SUT * W-BT.
015160     DISPLAY DU-KIN.
015170     IF W-KIN = ZERO
015180         IF W-HCD > 999899
015190             GO TO UAC-700.
015200     GO TO UAC-720.
015210 UAC-700.
015220     ACCEPT AU-KIN.
015230     DISPLAY E-CL.
015240     IF ESTAT = BTB
015250         IF W-HCD > 999899
015260             GO  TO  UAC-660
015270           ELSE
015280             GO TO UAC-400.
015290     IF ESTAT NOT = HTB AND SKP
015300         GO TO UAC-700.
015310     DISPLAY DU-KIN.
015320 UAC-720.
015330     IF T-BIK = 0
015340         MOVE SPACE TO W-BIK
015350         DISPLAY SU-BIK
015360         GO TO UAC-740.
015370     ACCEPT AU-BIK.
015380     DISPLAY E-CL.
015390     IF ESTAT = BTB
015400         IF W-DC = 4 OR 7
015410             GO TO UAC-620
015420           ELSE
015430             GO TO UAC-660.
015440 UAC-740.
015450     MOVE W-RC TO W-GNO.
015460     MOVE W-SR TO W-AS(W-RC).
015470     GO TO UAC-340.
015480 UAC-760.
015490     MOVE ZERO TO W-GSUT W-RC W-ZC.
015500 UAC-770.
015510     ADD 1 TO W-RC.
015520     IF W-RC = 7
015530         DISPLAY DU-GSUT
015540         IF W-ZC = 0                                              I.050706
015550             DISPLAY E-ME30 E-ME99                                I.050706
015560             GO TO UAC-780                                        I.050706
015570           ELSE                                                   I.050706
015580             GO TO UAC-780.
015590     MOVE ZERO TO W-SR.
015600     MOVE W-AS(W-RC) TO W-SR.
015610     IF W-HCD < 999900
015620        ADD W-SUT TO W-GSUT.
015630     IF W-DATE NOT = ZERO
015640         MOVE W-RC TO W-HNCD.
015650     IF ZERO = W-SU(01) AND W-SU(02) AND W-SU(03) AND W-SU(04)    I.050706
015660           AND W-SU(05) AND W-SU(06) AND W-SU(07) AND W-SU(08)    I.050706
015670           AND W-SU(09) AND W-SU(10) AND W-SUT AND W-KIN          I.050706
015680         GO TO UAC-770.                                           I.050706
015690     MOVE 1 TO W-ZC.                                              I.050706
015700     GO TO UAC-770.
015710 UAC-780.
015720     IF W-BI = SPACE
015730         DISPLAY AU-BI.
015740     IF W-HNCD < W-HNC
015750         DISPLAY E-ME14 E-ME98.
015760 UAC-800.
015770     MOVE 0 TO W-ADV.
015780     DISPLAY AU-BI.
015790     MOVE W-BI TO WK-BI.
015800     ACCEPT AU-BI.
015810     DISPLAY E-CL.
015820     IF ESTAT = BTB
015830         MOVE 7 TO W-RC
015840         MOVE 22 TO W-L1
015850         MOVE 23 TO W-L2
015860         MOVE 24 TO W-L3
015870         GO TO UAC-410.
015880     IF ESTAT = ADV
015890         MOVE WK-BI TO W-BI
015900         DISPLAY AU-BI
015910         MOVE 1 TO W-ADV
015920         GO TO UAC-810.
015930     IF ESTAT NOT = HTB AND SKP
015940         GO TO UAC-780.
015950 UAC-810.
015960     MOVE W-HNOD TO W-HANO.
015970 UAC-840.
015980     IF W-DCD = 3
015990         MOVE ZERO TO W-KOSUR
016000         GO TO UAC-850.
016010     IF W-ADV NOT = 0
016020         GO TO UAC-850.
016030     ACCEPT AU-KOSU.
016040     DISPLAY E-CL.
016050     IF ESTAT = BTB
016060         GO TO UAC-800.
016070     IF ESTAT NOT = HTB AND SKP
016080         GO TO UAC-840.
016090 UAC-850.
016100     DISPLAY DU-KOSU.
016110*
016120     IF W-DCD = 8
016130*****    MOVE ZERO TO W-HSC                                       D.040708
016140*****    MOVE ZERO TO W-HSCD                                      D.131228
016150*****    IF W-CNGS < 1404                                         D.140328
016160*****        MOVE 5 TO W-HSCD                                     D.140328
016170*****        MOVE 0 TO W-FRCD                                     D.140328
016180*****        DISPLAY AU-HSC SU-FRC                                D.140328
016190*****        GO TO UAC-940                                        D.140328
016200*****      ELSE                                                   D.140328
016210         MOVE 8 TO W-HSCD                                         I.131228
016220         MOVE 0 TO W-FRCD
016230         DISPLAY AU-HSC SU-FRC
016240         GO TO UAC-940.
016250     IF T-ZEI = 1                                                 I.070319
016260*****    MOVE 8 TO W-HSCD                                         D.131228
016270         MOVE 0 TO W-HSCD                                         I.131228
016280         DISPLAY AU-HSC                                           I.070319
016290         GO TO UAC-920.                                           I.070319
016300     IF T-FKC = 99                                                I.040705
016310*****    MOVE 8 TO W-HSCD                                         D.131228
016320         MOVE 0 TO W-HSCD                                         I.131228
016330         DISPLAY AU-HSC                                           I.040705
016340         GO TO UAC-920.                                           I.040705
016350*****IF W-DCD = 0                                                 D.140415
016360*****    MOVE ZERO TO W-HSC                                       D.040708
016370*****    MOVE ZERO TO W-HSCD                                      D.131228
016380*****    IF W-CNGS < 1404                                         D.140328
016390*****        MOVE 5 TO W-HSCD                                     D.140328
016400*****        DISPLAY AU-HSC                                       D.140328
016410*****        GO TO UAC-920                                        D.140328
016420*****      ELSE                                                   D.140328
016430     IF W-DCD = 0 OR 1 OR 2 OR 5                                  I.140415
016440         MOVE 8 TO W-HSCD                                         I.131228
016450         DISPLAY AU-HSC
016460         GO TO UAC-920.
016470     IF W-DCD = 3
016480*****    IF W-GSUT > ZERO                                         D.140408
016490*****        MOVE ZERO TO W-HSC W-FRCD                            D.040708
016500*****        MOVE ZERO TO W-HSCD W-FRCD                           D.131228
016510             MOVE ZERO TO W-FRCD                                  I.131228
016520*****        IF W-CNGS < 1404                                     D.140328
016530*****            MOVE 5 TO W-HSCD                                 D.140328
016540*****            DISPLAY AU-HSC SU-FRC                            D.140328
016550*****            GO TO UAC-940                                    D.140328
016560*****          ELSE                                               D.140328
016570             MOVE 8 TO W-HSCD                                     I.131228
016580             DISPLAY AU-HSC SU-FRC
016590             GO TO UAC-940.
016600 UAC-880.
016610     IF  W-DCD = 9
016620*****    MOVE 8 TO W-HSCD                                         D.131228
016630         MOVE 0 TO W-HSCD                                         I.131228
016640         MOVE 0 TO W-FRCD
016650         DISPLAY AU-HSC SU-FRC
016660         GO TO UAC-940.
016670     IF  W-DCD = 7
016680*****    MOVE 8 TO W-HSCD                                         D.131228
016690         MOVE 0 TO W-HSCD                                         I.131228
016700         GO TO UAC-920.
016710     IF W-ADV NOT = 0
016720         GO TO UAC-890.
016730     ACCEPT AU-HSC.
016740     IF ESTAT = BTB
016750         MOVE 0 TO W-ADV
016760         IF W-DCD = 3
016770             GO TO UAC-800
016780           ELSE
016790             GO TO UAC-840.
016800     IF ESTAT NOT = HTB AND SKP
016810         GO TO UAC-880.
016820 UAC-890.
016830*****IF W-HSCD NOT = 0 AND 3 AND 8                                D.131228
016840     IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                    I.131228
016850         GO TO UAC-880.
016860 UAC-920.
016870*****IF W-DCD NOT = 5 AND 0 AND 4 AND 7                           D.030708
016880     IF W-DCD NOT = 0 AND 1 AND 2 AND 4 AND 5 AND 7               I.030708
016890         MOVE 0 TO W-FRCD
016900         DISPLAY SU-FRC
016910         GO TO UAC-940.
016920     IF W-ADV NOT = 0
016930         GO TO UAC-930.
016940     ACCEPT AU-FRC.
016950     IF ESTAT = BTB
016960         IF W-DCD = 7
016970             MOVE 0 TO W-ADV
016980             GO TO UAC-840.
016990     IF ESTAT = BTB
017000         MOVE 0 TO W-ADV
017010         GO TO UAC-880.
017020     IF ESTAT NOT = HTB AND SKP
017030         GO TO UAC-920.
017040 UAC-930.
017050     DISPLAY AU-FRC.
017060     IF W-FRCD > 1
017070         GO TO UAC-920.
017080 UAC-940.
017090     DISPLAY AU-SDT.
017100     IF W-SDTD NOT = ZERO
017110         GO TO UAC-980.                                           I.000922
017120*****    GO TO UAC-990.                                           D.000922
017130     IF T-SS = ZERO OR 99                                         I.000922
017140         GO TO UAC-990.                                           I.000922
017150 UAC-960.
017160     ACCEPT AU-SDT.
017170     IF ESTAT NOT = BTB
017180         GO TO UAC-970.
017190     MOVE 0 TO W-ADV.
017200     IF W-DCD = 8
017210         GO TO UAC-840.
017220     IF W-DCD = 9
017230         IF W-GSUT > ZERO
017240             GO TO UAC-840.
017250     IF W-DCD = 9
017260         GO TO UAC-840.
017270     IF W-DCD = 5 OR 0 OR 4 OR 7
017280         GO TO UAC-920.
017290     GO TO UAC-880.
017300 UAC-970.
017310     IF ESTAT NOT = HTB AND SKP
017320         GO TO UAC-960.                                           I.000922
017330*****    GO TO UAC-940.                                           D.000922
017340     IF T-SS = ZERO OR 99                                         I.000818
017350         IF W-SDTD NOT = ZERO                                     I.000922
017360             GO TO UAC-960.                                       I.000922
017370     IF W-DCD NOT = 3                                             I.020227
017380         IF W-SDTD = 99999999                                     I.020227
017390             GO TO UAC-960.                                       I.020227
017400*****IF W-SDTD = ZERO                                             D.020227
017410     IF W-SDTD = ZERO OR 99999999                                 I.020227
017420         GO TO UAC-990.                                           I.001030
017430*****    GO TO UAC-980.                                           D.001030
017440     IF W-SDTG < 1 OR > 12
017450         GO TO UAC-960.                                           I.000922
017460*****    GO TO UAC-940.                                           D.000922
017470     IF W-SDTP < 1 OR > 31
017480         GO TO UAC-960.                                           I.000922
017490*****    GO TO UAC-940.                                           D.000922
017500     IF W-SDTN NOT = W-ND AND (W-ND + 1)
017510         GO TO UAC-960.                                           I.000922
017520*****    GO TO UAC-940.                                           D.000922
017530*****IF W-NGP > W-SDTD                                            D.001025
017540*****    GO TO UAC-960.                                           D.001025
017550 UAC-980.                                                         I.000922
017560*****IF W-SDATE NOT = ZERO                                        D.020205
017570*****IF W-SDATE NOT = ZERO AND 99999999                           D.020227
017580     IF W-SDATE NOT = ZERO                                        I.020227
017590         IF W-SDATE >= W-SDTD                                     I.000922
017600             DISPLAY E-ME25 E-ME99                                I.000922
017610             DISPLAY E-CL                                         I.000922
017620             GO TO UAC-960.                                       I.000922
017630*****IF W-SDATE = 99999999                                        D.020227
017640*****    IF W-NGD >= W-SDTNG                                      D.020227
017650*****        DISPLAY E-ME25 E-ME99                                D.020227
017660*****        DISPLAY E-CL                                         D.020227
017670*****        GO TO UAC-960.                                       D.020227
017680     IF W-NGP > W-SDTD                                            I.001025
017690         GO TO UAC-960.                                           I.001025
017700*****    GO TO UAC-940.                                           D.000922
017710 UAC-990.
017720     ACCEPT AU-DMM.
017730     IF ESTAT = BTB
017740         GO TO UAC-960.
017750     IF ESTAT NOT = HTB AND SKP
017760         GO TO UAC-990.
017770     IF W-DMM = 9
017780         DISPLAY E-ME90 E-ME98
017790         GO TO UAC-040.
017800     IF W-DMM NOT = 1
017810         GO TO UAC-990.
017820 UAC-EX.
017830     EXIT.
017840*---------------  値引入力  ----------------------------------------------
017850 NAC-RTN.
017860     IF W-NGP NOT = ZERO
017870         GO TO NAC-040.
017880     DISPLAY C-CLEAR.
017890     CALL "SCHD11".
017900 NAC-020.
017910     ACCEPT AN-NGP.
017920     DISPLAY E-CL.
017930     IF ESTAT = C2 OR PF9
017940         MOVE 1 TO W-END
017950         GO TO NAC-EX.
017960     IF ESTAT = BTB
017970         GO TO NAC-EX.
017980     IF ESTAT NOT = HTB AND SKP
017990         GO TO NAC-020.
018000     IF W-NGPS = ZERO
018010         MOVE DATE-02R TO W-NGPS
018020         DISPLAY AN-NGP.
018030     IF W-GD > 12 OR < 1
018040         GO TO NAC-020.
018050     IF W-PD > 31 OR < 1
018060         GO TO NAC-020.
018070     MOVE ZERO TO W-ND1.
018080     IF W-ND2 >= DATE-NF1 AND <= DATE-NT1
018090         ADD DATE-NC1 TO W-ND.
018100     IF W-ND2 >= DATE-NF2 AND <= DATE-NT2
018110         ADD DATE-NC2 TO W-ND.
018120     IF W-CNG NOT = W-NGD
018130         DISPLAY E-ME12 E-ME98
018140         GO TO NAC-020.
018150 NAC-040.
018160     CALL "SCHD11".
018170     DISPLAY AN-NGP.
018180     ACCEPT AN-TCD.
018190     IF ESTAT = C2 OR PF9
018200         MOVE 1 TO W-END
018210         GO TO NAC-EX.
018220     IF ESTAT = BTB
018230         GO TO NAC-020.
018240     IF ESTAT NOT = HTB AND SKP
018250         GO TO NAC-040.
018260     PERFORM TM-RTN THRU TM-EX.
018270     IF W-INV = 1
018280         DISPLAY E-ME1 E-ME98
018290         GO TO NAC-040.
018300     IF T-BC NOT = ZERO
018310         DISPLAY E-ME1 E-ME98
018320         GO TO NAC-040.
018330 NAC-060.
018340     ACCEPT AN-CSC.
018350     IF ESTAT = BTB
018360         GO TO NAC-040.
018370     IF ESTAT NOT = HTB AND SKP
018380         GO TO NAC-060.
018390     IF W-CSCD NOT = 0 AND 9
018400         GO TO NAC-060.
018410*****MOVE SPACE TO W-CSN.                                         D.020405
018420*****IF W-CSCD = 9                                                D.020405
018430*****    MOVE NC"調整分" TO W-CSN.                                D.020405
018440*****DISPLAY DN-CSN.                                              D.020405
018450 NAC-080.
018460     MOVE ZERO TO W-SR W-BR.
018470     MOVE SPACE TO W-BI.
018480*****MOVE ZERO TO W-RC W-ASR W-HSCD.                              D.131228
018490     MOVE ZERO TO W-RC W-ASR.                                     I.131228
018500*****IF W-CNGS < 1404                                             D.140328
018510*****    MOVE 5 TO W-HSCD                                         D.140328
018520*****  ELSE                                                       D.140328
018530     MOVE 8 TO W-HSCD.                                            I.131228
018540     MOVE 7 TO W-L1.
018550     CALL "SCHD11".
018560     DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC.                         I.020405
018570*****DISPLAY AN-NGP AN-TCD DN-TNA AN-CSC DN-CSN.                  D.020405
018580 NAC-100.
018590     ADD 1 TO W-RC W-L1.
018600     IF W-RC = 7
018610         GO TO NAC-260.
018620     MOVE W-NGP TO W-DATE.
018630     MOVE W-TCDN TO W-TCD.
018640     MOVE W-CSCD TO W-CSC.
018650 NAC-120.
018660     ACCEPT AN-HCD.
018670     DISPLAY E-CL.
018680*****IF ESTAT = C1                                                D.001205
018690     IF ESTAT = C1 OR PF6                                         I.001205
018700         GO TO NAC-240.
018710     IF ESTAT NOT = BTB
018720         GO TO NAC-140.
018730     IF W-RC = 1
018740         GO TO NAC-040.
018750     SUBTRACT 1 FROM W-RC W-L1.
018760     MOVE W-AS(W-RC) TO W-SR.
018770*****IF W-HCD = 999977                                            D.020204
018780     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
018790         GO TO NAC-160.
018800     GO TO NAC-200.
018810 NAC-140.
018820     IF ESTAT NOT = HTB AND SKP
018830         GO TO NAC-120.
018840     MOVE 0 TO W-HIC.                                             I.020214
018850     PERFORM HI-RTN THRU HI-EX.
018860     IF W-EC NOT = ZERO
018870         MOVE 0 TO W-EC
018880         GO TO NAC-120.
018890     MOVE T-TNC TO W-TC2.
018900     MOVE T-FKC TO W-FKC.
018910 NAC-160.
018920*****IF W-HCD NOT = 999977                                        D.020204
018930     IF W-HCD NOT = 999977 AND 999991 AND 999992 AND 999993       I.020204
018940         GO TO NAC-180.
018950     ACCEPT AN-KIN.
018960     IF ESTAT = BTB
018970         GO TO NAC-120.
018980     IF ESTAT NOT = HTB AND SKP
018990         GO TO NAC-160.
019000     MOVE ZERO TO W-SUT W-BT.
019010     DISPLAY DN-SUT DN-BT DN-KIN.
019020     GO TO NAC-220.
019030 NAC-180.
019040     ACCEPT AN-SUT.
019050     IF ESTAT = BTB
019060         GO TO NAC-120.
019070     IF ESTAT NOT = HTB AND SKP
019080         GO TO NAC-180.
019090     DISPLAY DN-SUT.
019100     IF W-SUT < 0                                                 I.001121
019110         GO TO NAC-180.                                           I.001121
019120 NAC-200.
019130     ACCEPT AN-BT.
019140     IF ESTAT = BTB
019150         GO TO NAC-180.
019160     IF ESTAT NOT = HTB AND SKP
019170         GO TO NAC-200.
019180     COMPUTE W-KIN = W-SUT * W-BT.
019190     DISPLAY DN-BT DN-KIN.
019200 NAC-220.
019210     MOVE W-RC TO W-GNO.
019220*****MOVE ZERO TO W-SUS.                                          D.000821
019230     MOVE ZERO TO W-SU(01) W-SU(02) W-SU(03) W-SU(04) W-SU(05)    I.000822
019240                  W-SU(06) W-SU(07) W-SU(08) W-SU(09) W-SU(10).   I.000822
019250     MOVE W-SR TO W-AS(W-RC).
019260     GO TO NAC-100.
019270 NAC-240.
019280     MOVE ZERO TO W-SR.
019290     MOVE W-SR TO W-AS(W-RC).
019300     DISPLAY SN-DS.
019310     ADD 1 TO W-RC W-L1.
019320     IF W-RC NOT = 7
019330         GO TO NAC-240.
019340 NAC-260.
019350     MOVE ZERO TO W-DKIN CNT.
019360 NAC-280.
019370     ADD 1 TO CNT.
019380     IF CNT = 7
019390         DISPLAY DN-DKIN
019400         GO TO NAC-300.
019410     MOVE W-AS(CNT) TO W-SR.
019420     ADD W-KIN TO W-DKIN.
019430     GO TO NAC-280.
019440 NAC-300.
019450     DISPLAY AN-BI.
019460     ACCEPT AN-BI.
019470     IF ESTAT = BTB
019480         GO TO NAC-360.
019490     IF ESTAT NOT = HTB AND SKP
019500         GO TO NAC-300.
019510     IF T-ZEI = 1                                                 I.070319
019520         MOVE 0 TO W-HSCD.                                        I.131228
019530*****    MOVE 8 TO W-HSCD.                                        D.131228
019540     IF T-FKC = 99                                                I.040708
019550         MOVE 0 TO W-HSCD.                                        I.131228
019560*****    MOVE 8 TO W-HSCD.                                        D.131228
019570     DISPLAY AN-HSC AN-SDT.
019580*****IF W-SDTD = ZERO                                             D.000922
019590*****    GO TO NAC-330.                                           D.000922
019600     GO TO NAC-340.
019610 NAC-320.
019620     ACCEPT AN-HSC.
019630     IF ESTAT = BTB
019640         GO TO NAC-300.
019650     IF ESTAT NOT = HTB AND SKP
019660         GO TO NAC-320.
019670*****IF W-HSCD NOT = 0 AND 3 AND 8                                D.131228
019680     IF W-HSCD NOT = 0 AND 1 AND 3 AND 5 AND 8                    I.131228
019690         GO TO NAC-320.
019700     IF T-SS = 00 OR 99                                           I.001030
019710         MOVE ZERO TO W-SDTD                                      I.001030
019720         DISPLAY AN-SDT                                           I.001030
019730         GO TO NAC-340.                                           I.001030
019740 NAC-330.
019750     ACCEPT AN-SDT.
019760     IF ESTAT = BTB
019770         GO TO NAC-320.
019780     IF ESTAT NOT = HTB AND SKP
019790         GO TO NAC-330.
019800*****IF T-SS = ZERO OR 99                                         D.001030
019810     IF W-SDTD = ZERO                                             I.000818
019820         GO TO NAC-340.                                           I.000818
019830     IF W-SDTG < 1 OR > 12
019840         GO TO NAC-330.
019850     IF W-SDTP < 1 OR > 31
019860         GO TO NAC-330.
019870     IF W-SDTN NOT = W-ND AND (W-ND + 1)
019880         GO TO NAC-330.
019890     IF W-NGP > W-SDTD
019900         GO TO NAC-330.
019910     IF W-SDATE NOT = ZERO                                        I.000922
019920         IF W-SDATE >= W-SDTD                                     I.000922
019930             DISPLAY E-ME25 E-ME99                                I.000922
019940             DISPLAY E-CL                                         I.000922
019950             GO TO NAC-330.                                       I.000922
019960 NAC-340.
019970     ACCEPT AN-DMM.
019980     IF ESTAT = BTB
019990         IF T-SS = 00 OR 99                                       I.001030
020000             GO TO NAC-320                                        I.001030
020010           ELSE                                                   I.001030
020020             GO TO NAC-330.
020030     IF ESTAT NOT = HTB AND SKP
020040         GO TO NAC-340.
020050     IF W-DMM = 1
020060         GO TO NAC-EX.
020070     IF W-DMM = 9
020080         GO TO NAC-040.
020090     GO TO NAC-340.
020100 NAC-360.
020110     IF W-RC = 1
020120         GO TO NAC-080.
020130     SUBTRACT 1 FROM W-RC.
020140     MOVE W-AS(W-RC) TO W-SR.
020150     SUBTRACT 1 FROM W-L1.
020160     IF W-HCD = ZERO
020170         GO TO NAC-360.
020180*****IF W-HCD = 999977                                            D.020204
020190     IF W-HCD = 999977 OR 999991 OR 999992 OR 999993              I.020204
020200         GO TO NAC-160.
020210     GO TO NAC-200.
020220 NAC-EX.
020230     EXIT.
020240*------------------------------------------------------------------------
020250 TAN-RTN.
020260     MOVE 0 TO WK-TAN.
020270*****MOVE W-TCDD TO THTN-01.                                      D.010419
020280*****MOVE W-HCD TO THTN-02.                                       D.010419
020290*****MOVE W-SIZ TO THTN-03.                                       D.010419
020300*****READ JT-THTN UNLOCK INVALID                                  D.010419
020310     MOVE W-TCD TO THT-TCD.                                       I.010419
020320     MOVE W-HCD TO THT-HCD.                                       I.010419
020330     MOVE W-SIZ TO THT-SIZ.                                       I.010419
020340     READ THTM UNLOCK INVALID                                     I.010419
020350         MOVE ZERO TO THT-T.                                      I.020405
020360*****    GO TO TAN-020.                                           D.020405
020370     MOVE THT-T TO WK-TAN.                                        I.010419
020380*****MOVE THTN-04 TO WK-TAN.                                      D.010419
020390*TAN-020.                                                         D.020405
020400     IF WK-TAN NOT = ZERO
020410         GO TO TAN-090.                                           I.010419
020420*****    GO TO TAN-EX.                                            D.010419
020430*****MOVE W-TCDD TO THTN-01.                                      D.010419
020440*****MOVE W-HCD TO THTN-02.                                       D.010419
020450*****MOVE 9 TO THTN-03.                                           D.010419
020460*****READ JT-THTN UNLOCK INVALID                                  D.010419
020470     MOVE W-TCD TO THT-TCD.                                       I.010419
020480     MOVE W-HCD TO THT-HCD.                                       I.010419
020490     MOVE 9 TO THT-SIZ.                                           I.010419
020500     READ THTM UNLOCK INVALID                                     I.010419
020510         MOVE ZERO TO THT-T.                                      I.020405
020520*****    GO TO TAN-040.                                           D.020405
020530*****    GO TO TAN-EX.                                            D.010802
020540     MOVE THT-T TO WK-TAN.                                        I.010419
020550     IF WK-TAN NOT = ZERO                                         I.010802
020560         GO TO TAN-090.                                           I.010802
020570*****MOVE THTN-04 TO WK-TAN.                                      D.010419
020580*TAN-040.                                                         D.020405
020590     IF HI-MHCD = HI-HCD                                          I.010802
020600         GO TO TAN-090.                                           I.020405
020610*****    GO TO TAN-EX.                                            D.020405
020620     MOVE W-TCD TO THT-TCD.                                       I.010802
020630     MOVE HI-MHCD TO THT-HCD.                                     I.010802
020640     MOVE W-SIZ TO THT-SIZ.                                       I.010802
020650     READ THTM UNLOCK INVALID                                     I.010802
020660         MOVE ZERO TO THT-T.                                      I.020405
020670*****    GO TO TAN-060.                                           D.020405
020680     MOVE THT-T TO WK-TAN.                                        I.010802
020690*TAN-060.                                                         D.020405
020700     IF WK-TAN NOT = ZERO                                         I.010802
020710         GO TO TAN-090.                                           I.010802
020720     MOVE W-TCD TO THT-TCD.                                       I.010802
020730     MOVE HI-MHCD TO THT-HCD.                                     I.010802
020740     MOVE 9 TO THT-SIZ.                                           I.010802
020750     READ THTM UNLOCK INVALID                                     I.010802
020760         MOVE ZERO TO THT-T.                                      I.020405
020770*****    GO TO TAN-090.                                           D.020405
020780*****    GO TO TAN-EX.                                            D.020215
020790     MOVE THT-T TO WK-TAN.                                        I.010802
020800 TAN-090.                                                         I.010419
020810     IF WK-TAN NOT = ZERO                                         I.010419
020820         MOVE WK-TAN TO W-BT                                      I.010802
020830         GO TO TAN-EX.                                            I.010802
020840*****IF HI-BC1 > 19 AND < 30                                      D.070305
020850*****    MOVE HI-SB TO WK-TAN                                     D.070305
020860*****    MOVE WK-TAN TO W-BT.                                     D.070305
020870*****    MOVE HI-SB TO WK-TAN.                                    D.020401
020880*****    MOVE WK-TAN TO W-BT.                                     D.010802
020890 TAN-EX.
020900     EXIT.
020910*
020920 TAO-RTN.                                                         I.110407
020930     MOVE 0 TO WK-TAN.                                            I.110407
020940     MOVE W-TCD TO OTHT-TCD.                                      I.110407
020950     MOVE W-HCD TO OTHT-HCD.                                      I.110407
020960     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
020970     READ OTHTM UNLOCK INVALID                                    I.110407
020980         MOVE ZERO TO OTHT-T.                                     I.110407
020990     MOVE OTHT-T TO WK-TAN.                                       I.110407
021000     IF WK-TAN NOT = ZERO                                         I.110407
021010         GO TO TAO-090.                                           I.110407
021020     MOVE W-TCD TO OTHT-TCD.                                      I.110407
021030     MOVE W-HCD TO OTHT-HCD.                                      I.110407
021040     MOVE 9 TO OTHT-SIZ.                                          I.110407
021050     READ OTHTM UNLOCK INVALID                                    I.110407
021060         MOVE ZERO TO OTHT-T.                                     I.110407
021070     MOVE OTHT-T TO WK-TAN.                                       I.110407
021080     IF WK-TAN NOT = ZERO                                         I.110407
021090         GO TO TAO-090.                                           I.110407
021100     IF HI-MHCD = HI-HCD                                          I.110407
021110         GO TO TAO-090.                                           I.110407
021120     MOVE W-TCD TO OTHT-TCD.                                      I.110407
021130     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
021140     MOVE W-SIZ TO OTHT-SIZ.                                      I.110407
021150     READ OTHTM UNLOCK INVALID                                    I.110407
021160         MOVE ZERO TO OTHT-T.                                     I.110407
021170     MOVE OTHT-T TO WK-TAN.                                       I.110407
021180     IF WK-TAN NOT = ZERO                                         I.110407
021190         GO TO TAO-090.                                           I.110407
021200     MOVE W-TCD TO OTHT-TCD.                                      I.110407
021210     MOVE HI-MHCD TO OTHT-HCD.                                    I.110407
021220     MOVE 9 TO OTHT-SIZ.                                          I.110407
021230     READ OTHTM UNLOCK INVALID                                    I.110407
021240         MOVE ZERO TO OTHT-T.                                     I.110407
021250     MOVE OTHT-T TO WK-TAN.                                       I.110407
021260 TAO-090.                                                         I.110407
021270     IF WK-TAN NOT = ZERO                                         I.110407
021280         MOVE WK-TAN TO W-BT                                      I.110407
021290         GO TO TAO-EX.                                            I.110407
021300 TAO-EX.                                                          I.110407
021310     EXIT.                                                        I.110407
021320*------------------------------------------------------------------------
021330 SD-RTN.
021340     CLOSE S-TRAN.
021350     OPEN I-O S-TRAN.
021360 SD-020.
021370     READ S-TRAN AT END
021380         GO TO SD-EX.
021390     IF W-DNO NOT = S-DNO
021400         GO TO SD-020.
021410     MOVE ""FF"" TO S-R.
021420     REWRITE S-R.
021430     IF ERR-STAT NOT = "00"
021440         DISPLAY E-STAT E-ME17 E-ME99.
021450     GO TO SD-020.
021460 SD-EX.
021470     EXIT.
021480*------------------------------------------------------------------------
021490 HMN-RTN.
021500*****INITIALIZE W-ASR W-BR.                                       D.171018
021510     INITIALIZE W-BR.                                             I.171018
021520     MOVE ZERO TO W-ASR.                                          I.171018
021530     MOVE SPACE TO W-BI.
021540     MOVE ZERO TO W-DCD.                                          I.010327
021550     MOVE HSMS-061 TO W-TCDD.                                     I.020214
021560     PERFORM TM-RTN THRU TM-EX.                                   I.020214
021570     IF W-INV = 1                                                 I.020214
021580         DISPLAY E-ME2 E-ME99                                     I.020214
021590         GO TO HMN-EX.                                            I.020214
021600 HMN-020.
021610*****IF HSMS-02 NOT = 7                                           D.010419
021620     IF HSMS-02 = 7                                               I.010419
021630         MOVE HSMS-15 TO W-BI                                     I.010419
021640         GO TO HMN-035.                                           I.010419
021650     IF HSMS-13 = 4 OR 5
021660         MOVE 4 TO HSMS-03.
021670     MOVE ZERO TO W-SR.                                           I.010419
021680     MOVE SPACE TO W-BIK.                                         I.010419
021690     MOVE HSMS-02 TO W-GNO.                                       I.020214
021700     MOVE W-NGP TO W-DATE.                                        I.010419
021710     MOVE HSMS-03 TO W-DC.                                        I.010419
021720     MOVE W-TCDN TO W-TCD.                                        I.020205
021730     MOVE W-TCDD TO W-TCD2.                                       I.020205
021740*****MOVE HSMS-061 TO W-TCD W-TCD2.                               D.020205
021750     MOVE HSMS-09 TO W-HCD.                                       I.010419
021760     MOVE HSMS-10 TO W-SIZ.                                       I.010419
021770     MOVE HSMS-1211(01) TO W-SU(01).                              I.010419
021780     MOVE HSMS-1211(02) TO W-SU(02).                              I.010419
021790     MOVE HSMS-1211(03) TO W-SU(03).                              I.010419
021800     MOVE HSMS-1211(04) TO W-SU(04).                              I.010419
021810     MOVE HSMS-1211(05) TO W-SU(05).                              I.010419
021820     MOVE HSMS-1211(06) TO W-SU(06).                              I.010419
021830     MOVE HSMS-1211(07) TO W-SU(07).                              I.010419
021840     MOVE HSMS-1211(08) TO W-SU(08).                              I.010419
021850     MOVE HSMS-1211(09) TO W-SU(09).                              I.010419
021860     MOVE HSMS-1211(10) TO W-SU(10).                              I.010419
021870     MOVE HSMS-122 TO W-SUT.                                      I.010419
021880     MOVE HSMS-07 TO W-SOK.                                       I.010419
021890     MOVE HSMS-14 TO W-KOSU.                                      I.010419
021900     MOVE HSMS-062 TO W-CCD.                                      I.010419
021910     MOVE HSMS-22 TO W-BIK.                                       I.010419
021920     MOVE HSMS-24 TO W-USC.                                       I.040324
021930     MOVE 1 TO W-HIC.                                             I.020214
021940     PERFORM HI-RTN THRU HI-EX.                                   I.020214
021950     PERFORM TAN-RTN THRU TAN-EX.                                 I.010419
021960     COMPUTE W-KIN = W-SUT * W-BT.                                I.010419
021970     IF W-DC = 2 OR 6                                             I.020221
021980         MOVE ZERO TO W-FT                                        I.020221
021990       ELSE                                                       I.020221
022000         MOVE HI-FT TO W-FT.                                      I.020214
022010     MOVE T-TNC TO W-TC2.                                         I.020214
022020     MOVE T-FKC TO W-FKC.                                         I.020214
022030     MOVE W-SR TO W-AS(HSMS-02).                                  I.010419
022040*****IF HSMS-02 NOT = 7                                           D.010314
022050*****    IF HSMS-03 NOT = 0 AND 4                                 D.010314
022060*****        MOVE 0 TO HSMS-03.                                   D.010314
022070*****IF HSMS-02 NOT = 7                                           D.010419
022080*****    MOVE ZERO TO W-SR                                        D.010419
022090*****    MOVE SPACE TO W-BIK                                      D.010419
022100*****    MOVE W-NGP TO W-DATE                                     D.010419
022110*****    MOVE HSMS-03 TO W-DC                                     D.010419
022120*****    MOVE HSMS-061 TO W-TCD W-TCD2                            D.010419
022130*****    MOVE HSMS-09 TO W-HCD                                    D.010419
022140*****    MOVE HSMS-10 TO W-SIZ                                    D.010419
022150*****    MOVE HSMS-1211(01) TO W-SU(01)                           D.010419
022160*****    MOVE HSMS-1211(02) TO W-SU(02)                           D.010419
022170*****    MOVE HSMS-1211(03) TO W-SU(03)                           D.010419
022180*****    MOVE HSMS-1211(04) TO W-SU(04)                           D.010419
022190*****    MOVE HSMS-1211(05) TO W-SU(05)                           D.010419
022200*****    MOVE HSMS-1211(06) TO W-SU(06)                           D.010419
022210*****    MOVE HSMS-1211(07) TO W-SU(07)                           D.010419
022220*****    MOVE HSMS-1211(08) TO W-SU(08)                           D.010419
022230*****    MOVE HSMS-1211(09) TO W-SU(09)                           D.010419
022240*****    MOVE HSMS-1211(10) TO W-SU(10)                           D.010419
022250*****    MOVE HSMS-122 TO W-SUT                                   D.010419
022260*****    MOVE HSMS-07 TO W-SOK                                    D.010419
022270*****    MOVE HSMS-14 TO W-KOSU                                   D.010419
022280*****    MOVE HSMS-062 TO W-CCD                                   D.010419
022290*****    MOVE HSMS-22 TO W-BIK                                    D.010419
022300*****    MOVE W-SR TO W-AS(HSMS-02)                               D.010419
022310*****  ELSE                                                       D.010419
022320*****    MOVE HSMS-15 TO W-BI.                                    D.010419
022330 HMN-035.                                                         I.010419
022340     READ HSMSF NEXT RECORD AT END
022350         GO TO HMN-040.
022360     IF W-HMN = HSMS-01
022370         GO TO HMN-020.
022380 HMN-040.
022390     MOVE W-SOK TO W-SCD.
022400*****MOVE W-DATE TO W-NGP.                                        D.020214
022410*****MOVE W-TCD TO W-TCDN W-TCDD.                                 D.020214
022420     MOVE W-CCD TO W-CCDD.
022430     MOVE W-KOSU TO W-KOSUR.
022440*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.131228
022450     MOVE ZERO TO W-FRCD.                                         I.131228
022460*****IF W-CNGS < 1404                                             D.140328
022470*****    MOVE 5 TO W-HSCD                                         D.140328
022480*****  ELSE                                                       D.140328
022490     MOVE 8 TO W-HSCD.                                            I.131228
022500 HMN-060.
022510     MOVE 3 TO JCON3-01.
022520     MOVE W-SCD TO JCON3-02.
022530     READ JCON UNLOCK INVALID
022540         MOVE  SPACE TO JCON3-03.
022550     MOVE W-SCD TO W-SOK.
022560     DISPLAY AU-SOK DU-SNA.
022570*
022580*****PERFORM TM-RTN THRU TM-EX.                                   D.020214
022590*****IF W-INV = 1                                                 D.020214
022600*****    DISPLAY E-ME2 E-ME99                                     D.020214
022610*****    GO TO HMN-EX.                                            D.020214
022620*****MOVE W-HMN TO W-HN1.                                         D.010327
022630*****DISPLAY AU-HN1.                                              D.010327
022640*****MOVE 1 TO W-HNC.                                             D.010327
022650*****MOVE ZERO TO W-HN3 W-HN4 W-HN5 W-HN6                         D.010327
022660     IF W-DC = 1 OR 2                                             I.010327
022670         MOVE W-DC TO W-DCD                                       I.020320
022680         MOVE ZERO TO W-HNOD                                      I.081222
022690*****    MOVE ZERO TO W-HNOD W-HNC                                D.081222
022700*****    DISPLAY SU-HMN                                           D.020214
022710       ELSE                                                       I.010327
022720         MOVE W-HMN TO W-HNOD.                                    I.081222
022730*****    MOVE W-HMN TO W-HN1                                      D.081222
022740*****    DISPLAY AU-HN1                                           D.081222
022750*****    MOVE 1 TO W-HNC                                          D.081222
022760*****    MOVE ZERO TO W-HN2 W-HN3 W-HN4 W-HN5 W-HN6               D.081222
022770*****    DISPLAY SU-HN2 SU-HN3 SU-HN4 SU-HN5 SU-HN6.              D.081222
022780     PERFORM TCM-RTN THRU TCM-EX.
022790     IF W-INV = 1                                                 I.001031
022800         DISPLAY E-ME1 E-ME99                                     I.001031
022810         GO TO HMN-EX.                                            I.001031
022820*****MOVE ZERO TO W-HSCD W-FRCD.                                  D.131228
022830     MOVE ZERO TO W-FRCD.                                         I.131228
022840*****IF W-CNGS < 1404                                             D.140328
022850*****    MOVE 5 TO W-HSCD                                         D.140328
022860*****  ELSE                                                       D.140328
022870     MOVE 8 TO W-HSCD.                                            I.131228
022880     DISPLAY AU-BI DU-KOSU AU-HSC AU-FRC.
022890 HMN-EX.
022900     EXIT.
022910*------------------------------------------------------------------------
022920 DSP-RTN.
022930     MOVE 1 TO W-L1.
022940     MOVE 2 TO W-L2.
022950     MOVE 3 TO W-L3.
022960     MOVE ZERO TO W-RC W-ZC W-GSUT W-RCB W-LB.                    I.020409
022970*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT W-RCB W-LB.              D.020409
022980*****MOVE ZERO TO W-RC W-DCD W-ZC W-GSUT.                         D.020403
022990 DSP-020.
023000     ADD 1 TO W-RC.
023010     ADD 3 TO W-L1 W-L2 W-L3.
023020     IF W-RC > 6
023030         GO TO DSP-080.
023040*
023050     INITIALIZE W-SR.
023060     MOVE W-AS(W-RC) TO W-SR.
023070     IF W-HCD = ZERO
023080         DISPLAY SU-D1 SU-D2 SU-D3
023090         GO TO DSP-020.
023100*****PERFORM TAZ-RTN THRU TAZ-EX.                                 D.070124
023110     MOVE W-HCD TO HI-KEY.
023120     READ HI-M WITH UNLOCK INVALID KEY
023130         MOVE SPACE TO HI-NAME.
023140     DISPLAY AU-DC AU-HCD DU-HNA.
023150     IF W-HCD >= 999900
023160         DISPLAY SU-D2 SU-D31
023170         GO TO DSP-060.
023180     DISPLAY AU-SIZ.
023190     IF W-SIZ = 1
023200         DISPLAY DU-S1.
023210     IF W-SIZ = 2
023220         DISPLAY DU-S2.
023230     IF W-SIZ = 3
023240         DISPLAY DU-S3.
023250     IF W-SIZ = 4
023260         DISPLAY DU-S4.
023270     MOVE ZERO TO W-SC.
023280     MOVE -3 TO W-C.
023290 DSP-040.
023300     ADD 1 TO W-SC.
023310     IF W-SC > 8
023320         ADD 5 TO W-C
023330       ELSE
023340         ADD 6 TO W-C.
023350     IF W-SC = 11
023360         GO TO DSP-060.
023370     IF W-SC < 8
023380         DISPLAY DU-SU
023390       ELSE
023400         DISPLAY DU-SU1.
023410     GO TO DSP-040.
023420 DSP-060.
023430     DISPLAY DU-SUT DU-BT DU-KIN AU-BIK.
023440     IF W-DC = 4
023450         MOVE ZERO TO W-FT
023460         DISPLAY SU-KIN SU-BT.
023470     IF W-HCD < 999900                                            I.090120
023480         ADD W-SUT TO W-GSUT.
023490     IF W-DC NOT = 7                                              I.020401
023500         IF W-BT = ZERO                                           I.020401
023510             DISPLAY E-ME15 E-ME99                                I.020401
023520             DISPLAY E-CL                                         I.020404
023530             IF W-DSPC = 1                                        I.020404
023540                 IF W-RCB = ZERO                                  I.020404
023550                     MOVE W-RC TO W-RCB                           I.020404
023560                     MOVE W-L TO W-LB.                            I.020404
023570*****        DISPLAY E-CL.                                        D.020404
023580     GO TO DSP-020.
023590 DSP-080.
023600     DISPLAY DU-GSUT.
023610 DSP-EX.
023620     EXIT.
023630*------------------------------------------------------------------------
023640 TM-RTN.
023650     MOVE 0 TO W-INV.
023660     MOVE W-TCDD TO W-TCDN.
023670     IF W-TCDN = 0460
023680         MOVE 0458 TO W-TCDN.                                     I.010206
023690*****    MOVE 0459 TO W-TCDN.                                     D.010206
023700     MOVE W-TCDN TO T-KEY.
023710     READ T-M WITH UNLOCK INVALID KEY
023720         MOVE SPACE TO T-NAME
023730         MOVE 1 TO W-INV.
023740     IF W-UNCD = 0
023750         DISPLAY AU-TCD DU-TNA
023760       ELSE
023770         DISPLAY AN-TCD DN-TNA.
023780*
023790     MOVE W-TCDN TO TSK-KEY.                                      I.000922
023800     READ TSKF WITH UNLOCK INVALID KEY                            I.000922
023810         MOVE ZERO TO TSK-R.                                      I.000922
023820     MOVE TSK-ZNGP(4) TO W-SDATE.                                 I.000922
023830     IF TSK-ZNGP(5) NOT = ZERO                                    I.000922
023840         MOVE TSK-ZNGP(5) TO W-SDATE.                             I.020207
023850*****    MOVE 99999999 TO W-SDATE.                                D.020207
023860*
023870     MOVE ZERO TO W-SDTD.
023880*****IF W-SDATE = 99999999                                        D.020207
023890*****    GO TO TM-EX.                                             D.020207
023900     MOVE W-NGP TO W-SDTD.
023910 TM-020.
023920     MOVE T-SS TO W-SDTP.
023930     IF W-SDTP = 00 OR 99
023940         MOVE ZERO TO W-SDTD
023950         GO TO TM-EX.
023960     IF W-SDTP = 30 OR 31
023970         IF W-SDTG = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
023980             MOVE 31 TO W-SDTP
023990           ELSE
024000             IF W-SDTG = 4 OR 6 OR 9 OR 11
024010                 MOVE 30 TO W-SDTP
024020               ELSE
024030                 DIVIDE 4 INTO W-SDTN GIVING W-DTW1
024040                                           REMAINDER W-DTW2
024050                 IF W-DTW2 = 0
024060                     MOVE 29 TO W-SDTP
024070                   ELSE
024080                     MOVE 28 TO W-SDTP.
024090     IF W-NGP > W-SDTD
024100         IF W-GD NOT = W-SDTG
024110             MOVE ZERO TO W-SDTD
024120             GO TO TM-EX                                          I.001102
024130*****        MOVE T-SS TO W-SDTP                                  D.001102
024140           ELSE
024150             ADD 1 TO W-SDTG
024160             GO TO TM-040.                                        I.001102
024170*****        GO TO TM-020.                                        D.001102
024180     IF W-SDATE NOT = ZERO                                        I.000922
024190         IF W-SDATE >= W-SDTD                                     I.000922
024200             ADD 1 TO W-SDTG
024210             GO TO TM-040.                                        I.001102
024220     GO TO TM-EX.                                                 I.001102
024230*****        GO TO TM-020.                                        D.001102
024240 TM-040.                                                          I.001102
024250     IF W-SDTG = 13                                               I.001102
024260         MOVE 1 TO W-SDTG                                         I.001102
024270         ADD 1 TO W-SDTN.                                         I.001102
024280     GO TO TM-020.                                                I.001102
024290 TM-EX.
024300     EXIT.
024310*------------------------------------------------------------------------
024320*TAZ-RTN.                                                         D.070124
024330*****IF W-DC NOT = 0                                              D.070124
024340*****    GO TO TAZ-EX.                                            D.070124
024350*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
024360*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
024370*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
024380*****    GO TO TAZ-EX.                                            D.070124
024390*****DISPLAY E-ME11 E-ME99.                                       D.070124
024400*TAZ-EX.                                                          D.070124
024410*****EXIT.                                                        D.070124
024420*------------------------------------------------------------------------
024430 TCM-RTN.
024440     IF W-CCDD = ZERO
024450         DISPLAY SU-CNA
024460*****    MOVE SPACE TO W-CNA                                      D.020425
024470         GO TO TCM-EX.
024480     MOVE 0 TO W-INV.
024490     MOVE W-TCDD TO TC-TCD.
024500     MOVE W-CCDD TO TC-CCD.
024510     READ TC-M WITH UNLOCK INVALID KEY
024520         MOVE SPACE TO TC-NAME
024530         MOVE 1 TO W-INV.
024540     DISPLAY AU-CCD DU-CNA.
024550*****MOVE TC-NAME TO W-CNA.                                       D.020425
024560*****IF W-CCDD = 001                                              D.020425
024570*****    MOVE SPACE TO W-CNA.                                     D.020425
024580     MOVE 9999999 TO TC-KEY.
024590     READ TC-M WITH UNLOCK INVALID KEY
024600         MOVE 9 TO W-INV.
024610 TCM-EX.
024620     EXIT.
024630*------------------------------------------------------------------------
024640 HI-RTN.
024650     MOVE W-HCD TO W-HCDD.
024660     IF W-HIC = 0                                                 I.020214
024670         IF W-UNCD = 0
024680             DISPLAY AU-HCD
024690           ELSE
024700             DISPLAY AN-HCD.
024710     IF W-HCD = ZERO
024720         MOVE 9 TO W-EC
024730         GO TO HI-EX.
024740     MOVE W-HCD TO HI-KEY.
024750     READ HI-M WITH UNLOCK INVALID KEY
024760         MOVE 9 TO W-EC
024770         GO TO HI-EX.
024780     IF W-HIC = 0                                                 I.020214
024790         IF W-UNCD = 0
024800             DISPLAY DU-HNA
024810           ELSE
024820             DISPLAY DN-HNA.
024830     MOVE HI-BC1 TO W-BC1.
024840     MOVE HI-BC2 TO W-BC2.
024850     MOVE HI-BC3 TO W-BC3.
024860     MOVE HI-BMC TO W-BMC.                                        I.020511
024870     MOVE HI-BMNO TO W-BMNO.                                      I.020511
024880     IF W-UNCD NOT = 0
024890         GO TO HI-EX.
024900     IF W-HCD < 999900
024910        IF HI-FT = ZERO
024920           DISPLAY E-ME7 E-ME98.
024930     IF W-DC NOT = 0 AND 3 AND 4 AND 5 AND 7
024940         IF W-HCD < 999900
024950            IF HI-FT = 1
024960                DISPLAY E-ME7 E-ME98.                             I.020418
024970*****           DISPLAY E-ME7 E-ME98                              D.020418
024980*****           MOVE 9 TO W-EC.                                   D.020418
024990*
025000     MOVE W-HCD TO HUH-KEY.                                       I.020215
025010     READ HUH-M WITH UNLOCK INVALID KEY                           I.020215
025020         DISPLAY E-ME28 E-ME99                                    I.020215
025030         DISPLAY E-CL                                             I.020215
025040         GO TO HI-EX.                                             I.020215
025050     IF (HUH-ZK NOT = ZERO) AND (HUH-ZS NOT = ZERO)               I.020215
025060         COMPUTE W-FTD = HUH-ZK / HUH-ZS                          I.020215
025070         IF HI-FT NOT = W-FTD                                     I.020215
025080             MOVE 9 TO W-EC                                       I.020215
025090             DISPLAY E-ME29 E-ME99                                I.020215
025100             DISPLAY E-CL                                         I.020215
025110             GO TO HI-EX.                                         I.020215
025120     IF (HUH-NK NOT = ZERO) AND (HUH-NS NOT = ZERO)               I.020215
025130         COMPUTE W-FTD = HUH-NK / HUH-NS                          I.020215
025140         IF HI-FT NOT = W-FTD                                     I.020215
025150             MOVE 9 TO W-EC                                       I.020215
025160             DISPLAY E-ME29 E-ME99                                I.020215
025170             DISPLAY E-CL                                         I.020215
025180             GO TO HI-EX.                                         I.020215
025190     IF (HUH-UG NOT = ZERO) AND (HUH-SS NOT = ZERO)               I.020215
025200         COMPUTE W-FTD = HUH-UG / HUH-SS                          I.020215
025210         IF HI-FT NOT = W-FTD                                     I.020215
025220             MOVE 9 TO W-EC                                       I.020215
025230             DISPLAY E-ME29 E-ME99                                I.020215
025240             DISPLAY E-CL                                         I.020215
025250             GO TO HI-EX.                                         I.020215
025260     IF (HUH-YK NOT = ZERO) AND (HUH-YS NOT = ZERO)               I.020215
025270         COMPUTE W-FTD = HUH-YK / HUH-YS                          I.020215
025280         IF HI-FT NOT = W-FTD                                     I.020215
025290             MOVE 9 TO W-EC                                       I.020215
025300             DISPLAY E-ME29 E-ME99                                I.020215
025310             DISPLAY E-CL.                                        I.020215
025320 HI-EX.
025330     EXIT.
025340*------------------------------------------------------------------------
025350 UPD-RTN.
025360     OPEN I-O HKBM.                                               I.170828
025370     MOVE SPACE TO HKB-KEY.                                       I.170828
025380     MOVE "05" TO HKB-NO.                                         I.170828
025390     READ HKBM INVALID KEY                                        I.170828
025400         CLOSE HKBM                                               I.170828
025410         MOVE 1 TO W-END                                          I.170828
025420         DISPLAY E-ME78 E-ME23 E-ME99                             I.170828
025430         MOVE 255 TO COMPLETION-CODE                              I.170828
025440         GO TO UPD-EX.                                            I.170828
025450     MOVE HKB-UNN TO W-DNOD.                                      I.170828
025460     ADD 1 TO W-DNOD.                                             I.170828
025470     IF W-DNOD = ZERO                                             I.170828
025480         MOVE 1 TO W-DNOD.                                        I.170828
025490     MOVE W-DNOD TO HKB-UNN.                                      I.170828
025500     REWRITE HKB-R INVALID KEY                                    I.170828
025510         CLOSE HKBM                                               I.170828
025520         MOVE 1 TO W-END                                          I.170828
025530         DISPLAY E-STAT E-ME78 E-ME24 E-ME99                      I.170828
025540         MOVE 255 TO COMPLETION-CODE                              I.170828
025550         GO TO UPD-EX.                                            I.170828
025560     CLOSE HKBM.                                                  I.170828
025570*
025580     MOVE ZERO TO W-RC.
025590 UPD-020.
025600     ADD 1 TO W-RC.
025610     IF W-RC > 6
025620         GO TO UPD-180.
025630     MOVE W-AS(W-RC) TO W-SR.
025640     IF W-DATE = ZERO
025650         GO TO UPD-180.
025660     MOVE W-DNOD TO W-DNO.
025670     MOVE W-SDTD TO W-SDT.
025680     MOVE W-HSCD TO W-HSC.
025690     IF W-UNCD = 0
025700         MOVE W-KOSUR TO W-KOSU
025710         MOVE W-FRCD TO W-FRC.
025720     MOVE W-UNCD TO W-UNC.
025730     MOVE W-SR TO S-R.
025740     WRITE S-R.
025750     IF ERR-STAT = "00"
025760         CALL "CBLTCLS" USING S-TRAN
025770         GO TO UPD-040.
025780     DISPLAY E-STAT E-ME16 E-ME99.
025790     GO TO UPD-900.
025800 UPD-040.
025810     IF W-UNCD = 1
025820         GO TO UPD-020.                                           I.000821
025830*****    GO TO UPD-180.                                           D.000821
025840     IF W-HCD = ZERO
025850         GO TO UPD-180.
025860*****IF W-DC NOT = 3 AND 4 AND 9                                  D.070124
025870*****    GO TO UPD-100.                                           D.070124
025880*****    GO TO UPD-020.                                           D.010419
025890*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
025900*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
025910*****READ TAZ-M WITH UNLOCK INVALID KEY                           D.070124
025920*****    GO TO UPD-060.                                           D.070124
025930*****GO TO UPD-100.                                               D.070124
025940*****GO TO UPD-020.                                               D.010419
025950*UPD-060.                                                         D.070124
025960*****MOVE ZERO TO TAZ-R                                           D.070124
025970*****MOVE W-TCD TO TAZ-TCD.                                       D.070124
025980*****MOVE W-HCD TO TAZ-HCD.                                       D.070124
025990*****MOVE W-CNG TO TAZ-NG.                                        D.070124
026000*****WRITE TAZ-R INVALID KEY                                      D.070124
026010*****    DISPLAY E-STAT E-ME10 E-ME99                             D.070124
026020*****    GO TO UPD-080.                                           D.070124
026030*****CALL "CBLTCLS" USING TAZ-M.                                  D.070124
026040*****GO TO UPD-100.                                               D.070124
026050*****GO TO UPD-020.                                               D.010419
026060*UPD-080.                                                         D.070124
026070*****IF ERR-STAT NOT = "24"                                       D.070124
026080*****    DISPLAY E-ME78 E-ME99                                    D.070124
026090*****    DISPLAY E-CL                                             D.070124
026100*****    GO TO UPD-100.                                           D.070124
026110*****    GO TO UPD-020.                                           D.010419
026120*****DISPLAY E-CL.                                                D.070124
026130*****CLOSE TAZ-M.                                                 D.070124
026140*****MOVE "TAZM         " TO W-FILE.                              D.070124
026150*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.070124
026160*****DISPLAY E-CL.                                                D.070124
026170*****OPEN I-O TAZ-M.                                              D.070124
026180*****GO TO UPD-060.                                               D.070124
026190*UPD-100.                                                         D.070124
026200     IF W-DC NOT = 0 AND 3                                        I.010419
026210         GO TO UPD-020.                                           I.010419
026220     IF ZERO = W-TCD OR W-HCD                                     I.010419
026230         GO TO UPD-020.                                           I.010419
026240     IF W-BT = ZERO                                               I.060629
026250         GO TO UPD-020.                                           I.060629
026260     MOVE SPACE TO THT-KEY.                                       I.010419
026270     MOVE W-TCD TO THT-TCD.                                       I.010419
026280     MOVE W-HCD TO THT-HCD.                                       I.010419
026290     MOVE 9 TO THT-SIZ.                                           I.010419
026300     READ THTM INVALID KEY                                        I.010419
026310         GO TO UPD-120.                                           I.010419
026320     GO TO UPD-160.                                               I.010419
026330 UPD-120.                                                         I.010419
026340     MOVE SPACE TO THT-KEY.                                       I.010419
026350     MOVE W-TCD TO THT-TCD.                                       I.010419
026360     MOVE W-HCD TO THT-HCD.                                       I.010419
026370     MOVE W-SIZ TO THT-SIZ.                                       I.010419
026380     READ THTM INVALID KEY                                        I.010419
026390         GO TO UPD-140.                                           I.010419
026400     GO TO UPD-160.                                               I.010419
026410 UPD-140.                                                         I.010419
026420     MOVE ZERO TO THT-R.                                          I.010419
026430     MOVE W-TCD TO THT-TCD THT-TCD2.                              I.010419
026440     MOVE W-HCD TO THT-HCD.                                       I.010419
026450     MOVE 9 TO THT-SIZ.                                           I.010419
026460     MOVE W-BT TO THT-T.                                          I.010419
026470     MOVE W-TC2 TO THT-TNC.                                       I.010419
026480     MOVE W-NGD TO THT-NG.                                        I.010419
026490     WRITE THT-R INVALID KEY                                      I.010419
026500         DISPLAY E-STAT E-ME26 E-ME99                             I.010419
026510         DISPLAY E-CL                                             I.010419
026520         GO TO UPD-020.                                           I.010419
026530     CALL "CBLTCLS" USING THTM.                                   I.010419
026540     GO TO UPD-020.                                               I.010419
026550 UPD-160.                                                         I.010419
026560     IF W-NGD NOT = THT-NG                                        I.010419
026570         MOVE W-NGD TO THT-NG                                     I.010419
026580         REWRITE THT-R INVALID KEY                                I.010419
026590             DISPLAY E-STAT E-ME27 E-ME99                         I.010419
026600             DISPLAY E-CL.                                        I.010419
026610     GO TO UPD-020.                                               I.010419
026620 UPD-180.
026630     INITIALIZE W-SR.
026640     MOVE W-BR TO W-DT1.
026650     MOVE W-DNOD TO W-DNO.
026660     MOVE 9 TO W-GNO.
026670     MOVE W-NGP TO W-DATE.
026680     MOVE W-TCDN TO W-TCD.
026690     MOVE W-UNCD TO W-UNC.
026700     MOVE W-SR TO S-R.
026710     WRITE S-R.
026720     IF ERR-STAT = "00"
026730         CALL "CBLTCLS" USING S-TRAN
026740         GO TO UPD-200.
026750     DISPLAY E-STAT E-ME16 E-ME99.
026760     GO TO UPD-900.
026770 UPD-200.
026780*****OPEN I-O HKBM.                                               D.170828
026790*****MOVE SPACE TO HKB-KEY.                                       D.170828
026800*****MOVE "05" TO HKB-NO.                                         D.170828
026810*****READ HKBM INVALID KEY                                        D.170828
026820*****    CLOSE HKBM                                               D.170828
026830*****    MOVE 1 TO W-END                                          D.170828
026840*****    DISPLAY E-ME78 E-ME23 E-ME99                             D.170828
026850*****    MOVE 255 TO COMPLETION-CODE                              D.170828
026860*****    GO TO UPD-EX.                                            D.170828
026870*****MOVE W-DNOD TO HKB-UNN.                                      D.170828
026880*****IF HKB-UNN = ZERO                                            D.170828
026890*****    MOVE 1 TO HKB-UNN.                                       D.170828
026900*****REWRITE HKB-R INVALID KEY                                    D.170828
026910*****    CLOSE HKBM                                               D.170828
026920*****    MOVE 1 TO W-END                                          D.170828
026930*****    DISPLAY E-STAT E-ME78 E-ME24 E-ME99                      D.170828
026940*****    MOVE 255 TO COMPLETION-CODE                              D.170828
026950*****    GO TO UPD-EX.                                            D.170828
026960*****CLOSE HKBM.                                                  D.170828
026970*
026980     IF (W-HMN = ZERO) OR (W-HNC = 1)                             I.081222
026990         GO TO UPD-EX.                                            I.081222
027000*****IF W-HMN = ZERO                                              D.011012
027010*****MOVE 0 TO W-HC.                                              D.081222
027020 UPD-220.                                                         I.011012
027030*****ADD 1 TO W-HC.                                               D.081222
027040*****IF W-HC > 6                                                  D.081222
027050*****    GO TO UPD-EX.                                            D.081222
027060*****IF W-HC = 1                                                  D.081222
027070*****    IF W-HMN NOT = ZERO                                      D.081222
027080*****        MOVE W-HMN TO HSMS-01                                D.081222
027090*****        GO TO UPD-230.                                       D.081222
027100*****IF W-HA(W-HC) = ZERO                                         D.081222
027110*****    GO TO UPD-EX.                                            D.081222
027120     MOVE SPACE TO HSMS-KEY.
027130     MOVE W-HMN TO HSMS-01.                                       I.011012
027140*****MOVE W-HMN TO HSMS-01.                                       D.011012
027150*****MOVE W-HA(W-HC) TO HSMS-01.                                  D.081222
027160 UPD-230.                                                         I.030418
027170     START HSMSF KEY NOT < HSMS-KEY INVALID KEY
027180         GO TO UPD-EX.                                            I.081222
027190*****    GO TO UPD-220.                                           D.081222
027200*****    GO TO UPD-EX.                                            D.011012
027210 UPD-240.
027220     READ HSMSF NEXT RECORD AT END
027230         GO TO UPD-EX.                                            I.081222
027240*****    GO TO UPD-220.                                           D.081222
027250*****IF W-HC = 1                                                  D.081222
027260     IF W-HMN NOT = HSMS-01                                       I.030418
027270         GO TO UPD-EX.                                            I.081222
027280*****        GO TO UPD-220.                                       D.081222
027290*****IF W-HC NOT = 1                                              D.081222
027300*****    IF W-HA(W-HC) NOT = HSMS-01                              D.081222
027310*****        GO TO UPD-220.                                       D.081222
027320*****    GO TO UPD-EX.                                            D.011012
027330*****IF W-HMN NOT = HSMS-01                                       D.011012
027340*****    GO TO UPD-EX.                                            D.011012
027350     IF HSMS-19 = 9
027360         GO TO UPD-EX.                                            I.081222
027370*****    GO TO UPD-220.                                           D.081222
027380*****    GO TO UPD-EX.                                            D.011012
027390     ADD 1 TO HSMS-19.
027400     REWRITE HSMS-R1 INVALID KEY
027410         DISPLAY E-STAT E-ME22 E-ME99
027420         DISPLAY E-CL.
027430     GO TO UPD-240.
027440 UPD-900.
027450     PERFORM SD-RTN THRU SD-EX.
027460     MOVE 1 TO W-END.
027470 UPD-EX.
027480     EXIT.
