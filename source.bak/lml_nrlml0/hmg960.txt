000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMG960.
000030************************************************************
000040*    PROGRAM         :  履物月次　マスター更新・クリア　　 *
000050*    PRINTER TYPE    :  ****                               *
000060*    SCREEN          :  ******                             *
000070*        変更　　　  :  62/05/22                           *
000080*    COMPILE TYPE    :  COBOL                              *
000090************************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170*****SELECT HT-M ASSIGN TO HT-MSD                                 D.000222
000180*****SELECT TT-M ASSIGN TO TT-MSD                                 D.000323
000190*****    ORGANIZATION INDEXED                                     D.000323
000200*****    ACCESS MODE DYNAMIC                                      D.000323
000210*****    RECORD KEY TT-KEY                                        D.000323
000220*****    RECORD KEY HT-KEY                                        D.000222
000230*****    FILE STATUS IS ERR-STAT.                                 D.000323
000240*****SELECT HZ-M ASSIGN TO HZ-MSD                                 D.990225
000250*****    ORGANIZATION INDEXED                                     D.990225
000260*****    RECORD KEY HZ-KEY                                        D.990225
000270*****    ACCESS MODE DYNAMIC                                      D.990225
000280*****    FILE STATUS IS ERR-STAT.                                 D.990225
000290*****SELECT HHTF ASSIGN TO HHT-MSD                                D.010806
000300     SELECT HHTF ASSIGN TO HHT1-MSD HHT2-MSD                      I.010806
000310         ORGANIZATION INDEXED                                     I.990203
000320         ACCESS MODE DYNAMIC                                      I.990203
000330         RECORD KEY HHT-KEY                                       I.990203
000340         ALTERNATE RECORD KEY HHT-KEY2                            I.010806
000350         FILE STATUS IS ERR-STAT.                                 I.990203
000360*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010806
000370     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010806
000380         ORGANIZATION INDEXED                                     I.930406
000390         ACCESS MODE DYNAMIC                                      I.930406
000400         RECORD KEY HI-KEY                                        I.930406
000410         ALTERNATE RECORD KEY HI-KEY2                             I.010806
000420         FILE STATUS IS ERR-STAT.                                 I.930406
000430     SELECT HUH-M ASSIGN TO HUH-MSD
000440         ORGANIZATION INDEXED
000450         RECORD KEY HUH-KEY
000460         ACCESS MODE DYNAMIC
000470         FILE STATUS IS ERR-STAT.
000480*****SELECT TCU-M ASSIGN TO TCU-MSD                               D.941215
000490*****    ORGANIZATION INDEXED                                     D.941215
000500*****    RECORD KEY TU-KEY                                        D.941215
000510*****    ACCESS MODE DYNAMIC                                      D.941215
000520*****    FILE STATUS IS ERR-STAT.                                 D.941215
000530*****SELECT SSR-F ASSIGN TO SSR-MSD.                              D.970108
000540*****SELECT SUSR-F ASSIGN TO SUSR-MSD.                            D.970115
000550*****SELECT AZ-F ASSIGN TO AZ-MSD.                                D.970108
000560     SELECT UTR-F ASSIGN TO UTR-MSD.                              I.970115
000570     SELECT TAZ-M ASSIGN TO TAZ-MSD
000580         ORGANIZATION INDEXED
000590         ACCESS MODE DYNAMIC
000600         RECORD KEY TAZ-KEY
000610         FILE STATUS IS ERR-STAT.
000620*****SELECT HPR-F ASSIGN TO HPR-MSD.                              D.961105
000630*****SELECT HKS-F ASSIGN TO HKS-MSD.                              D.970108
000640*****SELECT YG-F ASSIGN TO YG-MSD.                                D 920614
000650*****SELECT HUNDR-F ASSIGN TO HUNDR-MSD.                          D.000829
000660     SELECT SNTRF ASSIGN TO SNTR-MSD.                             I.961005
000670*****SELECT HBHKF ASSIGN TO HBHK-MSD                              D.060711
000680*****    ORGANIZATION INDEXED                                     D.060711
000690*****    ACCESS MODE DYNAMIC                                      D.060711
000700*****    RECORD KEY HBHK-KEY                                      D.060711
000710*****    FILE STATUS IS ERR-STAT.                                 D.060711
000720*****SELECT STRF ASSIGN TO STR-MSD.                               D.961105
000730*****SELECT STRAN-T ASSIGN TO STRANT-MSD.                         D.000531
000740*****SELECT FRHP-F ASSIGN TO FRHP-MSD                             D.961105
000750*****    ORGANIZATION INDEXED                                     D.961105
000760*****    ACCESS MODE DYNAMIC                                      D.961105
000770*****    RECORD KEY FR-KEY                                        D.961105
000780*****    FILE STATUS IS ERR-STAT.                                 D.961105
000790*****SELECT JZAI  ASSIGN TO JZAI-MSD                              D.970321
000800*****    ORGANIZATION IS INDEXED                                  D.970321
000810*****    ACCESS MODE IS DYNAMIC                                   D.970321
000820*****    RECORD KEY JZAI-KEY                                      D.970321
000830*****    FILE STATUS IS ERR-STAT.                                 D.970321
000840*****SELECT JNSR  ASSIGN TO JNSR-MSD                              D.970321
000850*****    ORGANIZATION IS INDEXED                                  D.970321
000860*****    ACCESS MODE IS SEQUENTIAL                                D.970321
000870*****    RECORD KEY JNSR-KEY                                      D.970321
000880*****    FILE STATUS IS ERR-STAT.                                 D.970321
000890*****SELECT TMS-F ASSIGN TO TMS-MSD                               D.000322
000900*****    FILE STATUS IS ERR-STAT.                                 D.000322
000910*****SELECT HKBM ASSIGN TO HKB-MSD                                D.000323
000920*****    ORGANIZATION IS INDEXED                                  D.000323
000930*****    ACCESS MODE IS RANDOM                                    D.000323
000940*****    RECORD KEY IS HKB-KEY                                    D.000323
000950*****    FILE STATUS IS ERR-STAT.                                 D.000323
000960*****SELECT TUKF ASSIGN TO TUK-MSD                                D.000323
000970*****    ORGANIZATION INDEXED                                     D.000323
000980*****    RECORD KEY TUK-KEY                                       D.000323
000990*****    ACCESS MODE RANDOM                                       D.000323
001000*****    FILE STATUS IS ERR-STAT.                                 D.000323
001010*****SELECT CALNM ASSIGN TO CALN-MSD                              D.000322
001020*****    ORGANIZATION IS INDEXED                                  D.000322
001030*****    ACCESS MODE IS DYNAMIC                                   D.000322
001040*****    RECORD KEY CL-KEY                                        D.000322
001050*****    FILE STATUS IS ERR-STAT.                                 D.000322
001060 I-O-CONTROL.
001070     APPLY SHARED-MODE ON HI-M                                    I.990203
001080*****APPLY SHARED-MODE ON HKBM                                    D.000323
001090*****APPLY SHARED-MODE ON TUKF                                    D.000323
001100*****APPLY SHARED-MODE ON CALNM                                   D.000322
001110     APPLY SHARED-MODE ON M-DATE.
001120 DATA DIVISION.
001130 FILE SECTION.
001140     COPY LIBFDD.
001150*****COPY LITTM.                                                  D.000323
001160*****COPY LIHTM.                                                  D.000222
001170*****COPY LIHZM.                                                  D.990225
001180     COPY LIHHTF.                                                 I.990203
001190     COPY LIHIM.                                                  I.930406
001200     COPY LIHUHM.
001210*****COPY LIHKBM.                                                 D.000323
001220*****COPY LITUKF.                                                 D.000323
001230*****COPY LICAL.                                                  D.000322
001240*****COPY L-JZAI.                                                 D.970321
001250*****COPY L-JNSR.                                                 D.970321
001260*****COPY LICALN.                                                 D.970716
001270*FD  TCU-M                                                        D.941215
001280*****BLOCK  6 RECORDS                                             D.941215
001290*****LABEL RECORD IS STANDARD                                     D.941215
001300*****VALUE OF IDENTIFICATION "TCUM".                              D.941215
001310*01  TCU-R.                                                       D.941215
001320*****02  TU-KEY.                                                  D.941215
001330*****  03  TU-TCD       PIC  9(004).                              D.941215
001340*****  03  TU-CCD       PIC  9(003).                              D.941215
001350*****  03  TU-HCD       PIC  9(006).                              D.941215
001360*****02  TU-US          PIC S9(006).                              D.941215
001370*****02  TU-UK          PIC S9(008).                              D.941215
001380*****02  TU-NK          PIC S9(008).                              D.941215
001390*****02  F              PIC  X(007).                              D.941215
001400*FD  SSR-F                                                        D.970108
001410*****BLOCK  5 RECORDS                                             D.970108
001420*****LABEL RECORD IS STANDARD                                     D.970108
001430*****VALUE OF IDENTIFICATION "SSRF".                              D.970108
001440*01  SSR-R              PIC  X(051).                              D.970108
001450*FD  SUSR-F                                                       D.970115
001460*****BLOCK  6 RECORDS                                             D.970115
001470 FD  UTR-F                                                        I.970115
001480*****BLOCK  5 RECORDS                                             D.020517
001490     BLOCK  2 RECORDS                                             I.020517
001500     LABEL RECORD IS STANDARD
001510     VALUE OF IDENTIFICATION "UTRF".                              I.970115
001520 01  UTR-R              PIC  X(128).                              I.020517
001530*01  UTR-R              PIC  X(102).                              D.020517
001540*****VALUE OF IDENTIFICATION "SUSRF".                             D.970115
001550*01  SUSR-R             PIC  X(042).                              D.970115
001560*FD  AZ-F                                                         D.970108
001570*****BLOCK  8 RECORDS                                             D.970108
001580*****LABEL RECORD IS STANDARD                                     D.970108
001590*****VALUE OF IDENTIFICATION "AZRF".                              D.970108
001600*01  AZ-R               PIC  X(032).                              D.970108
001610 FD  TAZ-M
001620*****BLOCK  8 RECORDS                                             D.020822
001630     BLOCK  6 RECORDS                                             I.020822
001640     LABEL RECORD IS STANDARD
001650     VALUE OF IDENTIFICATION "TAZM".                              C 62/05
001660 01  TAZ-R.
001670     02  TAZ-KEY.
001680       03  TAZ-TCD      PIC  9(004).
001690       03  TAZ-HCD      PIC  9(006).                                C 62/0
001700*****  03  TAZ-NO.                                                D.000622
001710*****    04  TAZ-NO1    PIC  9(006).                              D.000622
001720*****    04  TAZ-NO2    PIC  9(001).                              D.000622
001730     02  TAZ-AZS        PIC S9(005).
001740     02  TAZ-AAS        PIC S9(005).
001750     02  TAZ-SZS        PIC S9(005).                              I.020822
001760     02  TAZ-SAS        PIC S9(005).                              I.020822
001770     02  F              PIC  X(006).                              I.000622
001780     02  TAZ-NG         PIC  9(006).                              I.000622
001790*****02  F              PIC  X(005).                              D.000622
001800*FD  HPR-F                                                        D.961105
001810*****BLOCK  6 RECORDS                                             D.961105
001820*****LABEL RECORD IS STANDARD                                     D.961105
001830*****VALUE OF IDENTIFICATION "HPRF".                              D.961105
001840*01  HPR-R              PIC  X(042).                              D.961105
001850*FD  HKS-F                                                        D.970108
001860*****BLOCK  8 RECORDS                                             D.970108
001870*****LABEL RECORD IS STANDARD                                     D.970108
001880*****VALUE OF IDENTIFICATION "HKSF".                              D.970108
001890*01  HKS-R              PIC  X(032).                              D.970108
001900*FD**YG-F                                                         D 920614
001910*****BLOCK 16 RECORDS                                                 :
001920*****LABEL RECORD IS STANDARD                                         :
001930*****VALUE OF IDENTIFICATION "YGF".                                   :
001940*01**YG-R.                                                            :
001950*****02  YG-TCD     PIC 9(4).                                         :
001960*****02  YG-UZ      PIC S9(6).                                        :
001970*****02  YG-ZC      PIC 9.                                            :
001980*****02  F          PIC X(5).                                     D 920614
001990*FD  HUNDR-F                                                      D.000829
002000*****BLOCK  8 RECORDS                                             D.950224
002010*****BLOCK  6 RECORDS                                             D.000829
002020*****LABEL RECORD IS STANDARD                                     D.000829
002030*****VALUE OF IDENTIFICATION "HUNDRF".                            D.000829
002040*01  HUNDR-R            PIC  X(042).                              D.000829
002050*01  HUNDR-R            PIC  X(032).                              D.950224
002060*FD  FRHP-F                                                       D.961105
002070*****BLOCK  8 RECORDS                                             D.961105
002080*****LABEL RECORD IS STANDARD                                     D.961105
002090*****VALUE OF IDENTIFICATION "FRHPF".                             D.961105
002100*01  FRHP-R.                                                      D.961105
002110*****02  FR-KEY         PIC  X(006).                              D.961105
002120*****02  F              PIC  X(026).                              D.961105
002130*FD  STRF                                                         D.961105
002140*****BLOCK  5 RECORDS                                             D.961105
002150*****LABEL RECORD IS STANDARD                                     D.961105
002160*****VALUE OF IDENTIFICATION "STRF".                              D.961105
002170*01  STR-R              PIC  X(051).                              D.961105
002180 FD  SNTRF                                                        I.961005
002190     BLOCK  2 RECORDS                                             I.961005
002200     LABEL RECORD IS STANDARD                                     I.961005
002210     VALUE OF IDENTIFICATION "SNTRF".                             I.961005
002220 01  SNTR-R             PIC  X(128).                              I.961005
002230*FD  HBHKF                                                        D.060711
002240*****BLOCK  8 RECORDS                                             D.060711
002250*****LABEL RECORD IS STANDARD                                     D.060711
002260*****VALUE OF IDENTIFICATION "HBHKF".                             D.060711
002270*01  HBHK-R.                                                      D.060711
002280*****02  HBHK-KEY       PIC  X(013).                              D.060711
002290*****02  F              PIC  X(019).                              D.060711
002300*****02  HBHK-KEY       PIC  X(015).                              D.031001
002310*****02  F              PIC  X(017).                              D.031001
002320*****02  HBHK-KEY       PIC  X(012).                              D.021205
002330*****02  F              PIC  X(020).                              D.021205
002340*FD  STRAN-T                                                      D.000531
002350*****BLOCK  2 RECORDS                                             D.000531
002360*****LABEL RECORD IS STANDARD                                     D.000531
002370*****VALUE OF IDENTIFICATION "STRAN-T".                           D.000531
002380*01  STRANT-R           PIC  X(128).                              D.000531
002390*FD  TMS-F                                                        D.000322
002400*****BLOCK  6 RECORDS                                             D.970716
002410*****BLOCK  5 RECORDS                                             D.000322
002420*****LABEL RECORD STANDARD                                        D.000322
002430*****VALUE OF IDENTIFICATION "TMSF".                              D.000322
002440*01  TMS-R.                                                       D.000322
002450*****02  TMS-TCD        PIC  9(004).                              D.000322
002460*****02  TMS-SP         PIC  9(002).                              D.000322
002470*****02  TMS-SK         PIC  9(001).                              D.000322
002480*****02  TMS-DATE       PIC  9(006).                              D.970716
002490*****02  TMS-DATE       PIC  9(008).                              D.000322
002500*****02  TMS-KIN        PIC S9(009).                              D.000322
002510*****02  TMS-SHZ        PIC S9(007).                              D.000322
002520*****02  TMS-KBN        PIC  9(001).                              D.000322
002530*****02  F              PIC  X(019).                              D.000322
002540*****02  F              PIC  X(012).                              D.970716
002550 WORKING-STORAGE SECTION.
002560 77  W-FILE             PIC  X(013).                              I.940707
002570*77  CHK-SW             PIC  9(001).                              D.970321
002580 77  I                  PIC  9(002).                              *I911125
002590 01  W-DATA.
002600     02  W-NGD          PIC  9(006).                              I.000622
002610     02  W-NGDD  REDEFINES W-NGD.                                 I.000622
002620       03  W-NEND       PIC  9(004).                              I.000622
002630       03  W-NENDL REDEFINES W-NEND.                              I.000622
002640         04  W-NEND1    PIC  9(002).                              I.000622
002650         04  W-NEND2    PIC  9(002).                              I.000622
002660       03  W-GETD       PIC  9(002).                              I.000622
002670     02  W-NGDL  REDEFINES W-NGD.                                 I.000622
002680       03  F            PIC  9(002).                              I.000622
002690       03  W-NGDS       PIC  9(004).                              I.000622
002700*****02  W-NGPD.                                                  D.000622
002710*****  03  W-NGD        PIC  9(006).                              D.000622
002720*****  03  W-NGDD  REDEFINES W-NGD.                               D.000622
002730*****    04  W-NEND     PIC  9(004).                              D.000622
002740*****    04  W-NENDL REDEFINES W-NEND.                            D.000622
002750*****      05  W-NEND1  PIC  9(002).                              D.000622
002760*****      05  W-NEND2  PIC  9(002).                              D.000622
002770*****    04  W-GETD     PIC  9(002).                              D.000622
002780*****  03  W-NGDL  REDEFINES W-NGD.                               D.000622
002790*****    04  F          PIC  9(002).                              D.000622
002800*****    04  W-NGDS     PIC  9(004).                              D.000622
002810*****  03  W-PEYD       PIC  9(002).                              D.000622
002820*****02  W-NGD          PIC  9(004).                              D.970716
002830*****02  W-NGD          PIC  9(006).                              D.991004
002840*****02  W-NGDD  REDEFINES W-NGD.                                 D.991004
002850*****  03  W-NEND       PIC  9(004).                              D.991004
002860*****  03  W-NENDL REDEFINES W-NEND.                              D.991004
002870*****    04  W-NEND1    PIC  9(002).                              D.991004
002880*****    04  W-NEND2    PIC  9(002).                              D.991004
002890*****  03  W-GETD       PIC  9(002).                              D.991004
002900*****02  W-NGDL  REDEFINES W-NGD.                                 D.991004
002910*****  03  F            PIC  9(002).                              D.991004
002920*****  03  W-NGDS       PIC  9(004).                              D.991004
002930*****02  W-ZKK          PIC S9(008).                              D.990203
002940*****02  W-YUZ      PIC S9(6).                                    D 920614
002950*****02  W-UZ       PIC S9(6)V9(3).                                   :
002960*****02  W-UZD  REDEFINES W-UZ  PIC S9(9).                        D 920614
002970     02  W-D.
002980       03  W-HCD        PIC  9(006).
002990       03  W-ZSU        PIC S9(006).
003000       03  W-ZKIN       PIC S9(009).
003010*****02  W-KIN          PIC S9(009).                              D.000322
003020*****02  W-SHZ          PIC S9(007).                              D.000322
003030*****02  W-DATE         PIC  9(006).                              D.970716
003040*****02  W-DATE         PIC  9(008).                              D.000322
003050*****02  W-NGP   REDEFINES W-DATE.                                D.000322
003060*****  03  W-NG.                                                  D.000322
003070*****    04  W-NEN      PIC  9(002).                              D.970716
003080*****    04  W-NEN      PIC  9(004).                              D.000322
003090*****    04  W-GET      PIC  9(002).                              D.000322
003100*****  03  W-PEY        PIC  9(002).                              D.000322
003110     02  W-NG.                                                    I.000322
003120       03  W-NEN        PIC  9(004).                              I.000322
003130       03  W-GET        PIC  9(002).                              I.000322
003140     02  W-ASS          PIC S9(006).                              I.990203
003150     02  CNT            PIC  9(002).                              I.990203
003160 01  ERR-STAT           PIC  X(002).
003170     COPY LDAIW.                                                  I.991004
003180     COPY LWMSG.                                                  *I911125
003190 SCREEN SECTION.
003200 SD  C-CRT
003210     END STATUS IS ESTAT.
003220 01  C-CLEAR.
003230     02  C-CL    LINE   1  CLEAR SCREEN.
003240 01  C-MID.
003250     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
003260          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003270     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
003280          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003290     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
003300          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
003310     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
003320          NC"＊＊＊　　履物月次　マスター更新・クリア　　＊＊＊".
003330     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
003340          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
003350     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
003360          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003370     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
003380          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003390 01  C-DSP.
003400     02  D-ME.
003410       03  LINE  13.
003420         04  COLUMN  21  PIC  X(001) VALUE "(".
003430         04  COLUMN  22  PIC  9(006) FROM  W-HCD.
003440         04  COLUMN  28  PIC  X(001) VALUE ")".
003450         04  COLUMN  30  PIC  N(010) VALUE
003460              NC"在庫数量　　在庫金額".
003470       03  LINE  14.
003480*****    04  COLUMN  21  PIC  N(004)       VALUE NC"ＨＺＭ　".    D.990203
003490         04  COLUMN  21  PIC  N(004)       VALUE NC"ＨＨＴＦ".    I.990203
003500         04  COLUMN  30  PIC ----,--9      FROM  W-ZSU.
003510         04  COLUMN  38  PIC ----,---,--9  FROM  W-ZKIN.
003520       03  LINE  15.
003530         04  COLUMN  21  PIC  N(004)       VALUE NC"ＨＵＨＭ".
003540         04  COLUMN  30  PIC ----,--9      FROM  HUH-YS.
003550         04  COLUMN  38  PIC ----,---,--9  FROM  HUH-YK.
003560 01  C-ERR.
003570     02  LINE  24.
003580*****  03  E-ME1   COLUMN  15  PIC  X(026) VALUE                  D.000323
003590*****       "***  TT-M REWRITE ｴﾗ-  ***".                         D.000323
003600*****       "***  HT-M REWRITE ｴﾗ-  ***".                         D.000222
003610*****  03  E-ME2   COLUMN  15  PIC  X(025) VALUE                  D.990225
003620*****       "***  HZM REWRITE ｴﾗ-  ***".                          D.990225
003630       03  E-ME3   COLUMN  15  PIC  X(027) VALUE
003640            "***  TAZ-M REWRITE ｴﾗｰ  ***".
003650       03  E-ME4   COLUMN  15  PIC  X(027) VALUE
003660            "***  TAZ-M DELETE  ｴﾗｰ  ***".
003670       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
003680            "***  HUHM REWRITE ｴﾗｰ  ***".
003690       03  E-ME6   COLUMN  15  PIC  X(018) VALUE
003700            "***  ｻﾞｲｺ ｴﾗｰ  ***".
003710       03  E-ME7   COLUMN  15  PIC  X(017) VALUE
003720            "***  HUHM ﾅｼ  ***".
003730       03  E-ME8   COLUMN  15  PIC  X(016) VALUE                  I.930406
003740            "***  HIM ﾅｼ  ***".                                   I.930406
003750*****  03  E-ME9.                                                 D.000322
003760*****    04  COLUMN  15  PIC  X(027) VALUE                        D.000322
003770*****         "***  CALNM ﾅｼ (      )  ***".                      D.000322
003780*****    04  COLUMN  30  PIC  X(006) FROM  W-NG.                  D.000322
003790*****    04  COLUMN  15  PIC  X(025) VALUE                        D.970716
003800*****         "***  CALNM ﾅｼ (    )  ***".                        D.970716
003810*****    04  COLUMN  30  PIC  X(004) FROM  W-NG.                  D.970716
003820*****  03  E-ME10  COLUMN  15  PIC  X(024) VALUE                  D.000322
003830*****       "***  TMSF WRITE ｴﾗｰ  ***".                           D.000322
003840       03  E-ME11  COLUMN  15  PIC  X(026) VALUE                  I.990203
003850            "***  HHTF REWRITE ｴﾗ-  ***".                         I.990203
003860*****  03  E-ME21  COLUMN  15  PIC  X(017) VALUE                  D.000323
003870*****       "***  HKBM ﾅｼ  ***".                                  D.000323
003880*****  03  E-ME22  COLUMN  15  PIC  X(026) VALUE                  D.000323
003890*****       "***  HKBM REWRITE ｴﾗｰ  ***".                         D.000323
003900*****  03  E-ME23  COLUMN  15  PIC  X(024) VALUE                  D.000323
003910*****       "***  HKBM WRITE ｴﾗｰ  ***".                           D.000323
003920*****  03  E-ME28  COLUMN  15  PIC  X(026) VALUE                  D.000323
003930*****       "***   TUKF WRITE ｴﾗｰ   ***".                         D.000323
003940*****  03  E-ME50  COLUMN  15  PIC  X(026) VALUE                  D.000323
003950*****       "***   ﾀﾞｲﾁｮｳNO ｵｰﾊﾞｰ   ***".                         D.000323
003960*****  03  E-TTM   COLUMN  50  PIC  X(004) FROM  TT-KEY.          D.000323
003970*****  03  E-HTM   COLUMN  50  PIC  X(004) FROM  HT-KEY.          D.000222
003980*****  03  E-HZM   COLUMN  50  PIC  X(010) FROM  HZ-KEY.          D.990225
003990       03  E-HHTF  COLUMN  50  PIC  X(007) FROM  HHT-KEY.         I.990203
004000       03  E-HUHM  COLUMN  50  PIC  X(006) FROM  HUH-KEY.         I.940707
004010       03  E-TAZM  COLUMN  50  PIC  X(017) FROM  TAZ-KEY.         I.940707
004020*****  03  E-HCD   COLUMN  40  PIC  9(006) FROM  W-HCD.           D.940707
004030*****  03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".     D.940707
004040*****  03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".     D.940707
004050*****  03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.        D.940707
004060*****  03  E-CL    COLUMN  10  PIC  X(050) VALUE                  D.940707
004070*****       "                                                  ". D.940707
004080     COPY LSSEM.                                                  I.940707
004090     COPY LIBSCR.
004100     COPY LSMSG.                                                  *I911125
004110 PROCEDURE DIVISION.
004120 M-05.
004130     DISPLAY C-CLEAR.
004140     DISPLAY C-MID.
004150     COPY LIBCPR.
004160*****MOVE ZERO TO W-NGD.                                          D.991004
004170*****MOVE ZERO TO W-NGPD.                                         D.000622
004180     MOVE ZERO TO W-NGD.                                          I.000622
004190     MOVE D-NHNG TO W-NGDS.                                       I.970716
004200     IF W-NEND2 >= DATE-NF1 AND <= DATE-NT1                       I.970716
004210         ADD DATE-NC1 TO W-NEND.                                  I.970716
004220     IF W-NEND2 >= DATE-NF2 AND <= DATE-NT2                       I.970716
004230         ADD DATE-NC2 TO W-NEND.                                  I.970716
004240*****MOVE 1 TO W-PEYD.                                            D.000622
004250     MOVE W-NGD TO W-NG.                                          I.000322
004260     ADD 1 TO W-GETD.                                             I.000322
004270     IF W-GETD = 13                                               I.000322
004280         ADD 1 TO W-NEND                                          I.000322
004290         MOVE 1 TO W-GETD.                                        I.000322
004300*****MOVE D-NHNG TO W-NGD.                                        D.970716
004310*****MOVE DATE-02R TO W-DATE.                                     D.950510
004320*****PERFORM S-20 THRU S-30.                                      D.000322
004330*
004340*****OPEN INPUT HKBM.                                             D.991005
004350*****MOVE SPACE TO HKB-KEY.                                       D.991005
004360*****MOVE "05" TO HKB-NO.                                         D.991005
004370*****READ HKBM WITH UNLOCK INVALID KEY                            D.991005
004380*****    INITIALIZE HKB-DAI                                       D.991005
004390*****    DISPLAY E-ME21 E-ME99.                                   D.991005
004400*****MOVE HKB-DAI TO W-DAI.                                       D.991005
004410*****CLOSE HKBM.                                                  D.991005
004420*
004430*****OPEN I-O HT-M HZ-M TAZ-M JZAI.                               D.970321
004440*****OPEN I-O HT-M HZ-M TAZ-M.                                    D.990203
004450*****OPEN I-O HZ-M.                                               D.990225
004460*****OPEN I-O HT-M HHTF TAZ-M.                                    D.000222
004470*****OPEN I-O TT-M HHTF TAZ-M.                                    D.000323
004480     OPEN I-O HHTF TAZ-M.                                         I.000323
004490     OPEN INPUT HUH-M HI-M.                                       I.990203
004500     OPEN OUTPUT SNTRF UTR-F.                                     I.060711
004510*****OPEN OUTPUT SNTRF UTR-F HBHKF.                               D.060711
004520*****OPEN OUTPUT SNTRF UTR-F.                                     D.010323
004530*****OPEN OUTPUT HUNDR-F SNTRF UTR-F.                             D.000829
004540*****OPEN INPUT HUH-M.                                            D.990203
004550*****OPEN OUTPUT TCU-M SSR-F SUSR-F AZ-F HPR-F HKS-F HUNDR-F      D.941215
004560*****OPEN OUTPUT SSR-F SUSR-F AZ-F HPR-F HKS-F HUNDR-F            D.961105
004570*****            FRHP-F JNSR.                                     D.940715
004580*****            FRHP-F JNSR STRF.                                D.960729
004590*****            FRHP-F JNSR STRF STRAN-T.                        D.961105
004600*****            FRHP-F JNSR STRF SNTRF STRAN-T.                  D.961105
004610*****OPEN OUTPUT SSR-F SUSR-F AZ-F HKS-F HUNDR-F                  D.970108
004620*****OPEN OUTPUT SUSR-F HUNDR-F                                   D.970115
004630*****            JNSR  SNTRF STRAN-T.                             D.970115
004640*****OPEN EXTEND YG-F.                                            D 920614
004650*****OPEN OUTPUT HUNDR-F JNSR  SNTRF STRAN-T  UTR-F.              D.970321
004660*****OPEN OUTPUT HUNDR-F SNTRF STRAN-T  UTR-F.                    D.000531
004670*****OPEN EXTEND TMS-F.                                           D.000322
004680*****OPEN I-O TUKF.                                               D.000323
004690*M-10.                                                            D.000323
004700*****READ HT-M NEXT RECORD AT END                                 D.000222
004710*****READ TT-M NEXT RECORD AT END                                 D.000323
004720*****    GO TO M-15.                                              D.000323
004730*****IF TT-BC NOT = 0                                             D.000323
004740*****    GO TO M-10.                                              D.000323
004750*****    GO TO M-12.                                              D.990225
004760*****PERFORM S-05 THRU S-15.                                      D.000322
004770*****MOVE HT-TUZ TO HT-TZZ.                                       D.000222
004780*****MOVE HT-TUZZ TO HT-TZZZ.                                     D.000222
004790*****MOVE ZERO TO HT-TUA HT-TUAZ HT-TNB HT-TNBZ                   D.000222
004800*****             HT-TNK HT-TNKZ HT-TUG.                          D.000222
004810*****MOVE ZERO TO HT-SP HT-SK.                                    D.000222
004820*****REWRITE HT-R INVALID KEY                                     D.000222
004830*****MOVE TT-TUZ TO TT-TZZ.                                       D.000323
004840*****MOVE TT-TUZZ TO TT-TZZZ.                                     D.000323
004850*****MOVE ZERO TO TT-TUA TT-TUAZ TT-TNB TT-TNBZ                   D.000323
004860*****             TT-TNK TT-TNKZ TT-TUG.                          D.000323
004870*****MOVE ZERO TO TT-SP TT-SK.                                    D.000323
004880*****REWRITE TT-R INVALID KEY                                     D.000323
004890*****    MOVE 255 TO COMPLETION-CODE                              D.000323
004900*****    DISPLAY E-ME78 E-STAT E-ME1 E-TTM E-ME99                 D.000323
004910*****    DISPLAY E-ME78 E-STAT E-ME1 E-HTM E-ME99                 D.000222
004920*****    GO TO M-95.                                              D.000323
004930*****IF ZERO = HT-TZZ AND HT-TZZZ                                 D.000222
004940*****IF ZERO = TT-TZZ AND TT-TZZZ                                 D.000323
004950*****    GO TO M-10.                                              D.000323
004960*****PERFORM HKB-RTN THRU HKB-EX.                                 D.000323
004970*****IF COMPLETION-CODE = 255                                     D.000323
004980*****    GO TO M-95.                                              D.000323
004990*****PERFORM TUK-RTN THRU TUK-EX.                                 D.000323
005000*****IF COMPLETION-CODE = 255                                     D.000323
005010*****    GO TO M-95.                                              D.000323
005020*****PERFORM HKB-RTN THRU HKB-EX.                                 D.991005
005030*****IF COMPLETION-CODE = 255                                     D.991005
005040*****    GO TO M-95.                                              D.991005
005050*****COMPUTE W-UZD = HT-TUZ + HT-TUZZ.                            D 920614
005060*****COMPUTE W-YUZ ROUNDED = W-UZ * 1.                                :
005070*****IF W-YUZ NOT = ZERO                                              :
005080*****    MOVE ZERO TO YG-R                                            :
005090*****    MOVE HT-TCD TO YG-TCD                                        :
005100*****    MOVE W-YUZ TO YG-UZ                                          :
005110*****    MOVE 2 TO YG-ZC                                              :
005120*****    WRITE YG-R.                                              D 920614
005130*****GO TO M-10.                                                  D.000323
005140*M-12.                                                            D.990225
005150*****READ HZ-M NEXT RECORD AT END                                 D.990225
005160*****    GO TO M-15.                                              D.990225
005170*****    GO TO M-50.                                              D.990203
005180*****MOVE HZ-GSU TO HZ-ZSU.                                       D.990225
005190*****MOVE HZ-GSU TO HZ-TCS.                                       D.990225
005200*****IF HZ-SIZ = 111                                              D.990225
005210*****    MOVE HZ-GSU TO HZ-TTS.                                   D.990225
005220*****MOVE ZERO TO HZ-NSU HZ-USU HZ-ASS.                           D.990225
005230*****REWRITE HZ-R INVALID KEY                                     D.990225
005240*****    DISPLAY E-ME78 E-STAT E-ME2 E-HZM E-ME99                 D.990225
005250*****    GO TO M-95.                                              D.990225
005260*****GO TO M-12.                                                  D.990225
005270*****    GO TO M-55.                                              D.930406
005280 M-15.                                                            I.990203
005290     READ HHTF NEXT RECORD AT END                                 I.990203
005300         GO TO M-50.                                              I.990203
005310 M-20.
005320     MOVE ZERO TO W-D W-ASS.                                      I.990203
005330     MOVE HHT-HCD TO W-HCD.                                       I.990203
005340*****MOVE ZERO TO W-D.                                            D.990203
005350*****MOVE HZ-HCD TO W-HCD.                                        D.990203
005360 M-25.
005370     MOVE ZERO TO CNT.                                            I.990203
005380 M-30.                                                            I.990203
005390     ADD 1 TO CNT.                                                I.990203
005400     IF CNT = 11                                                  I.990203
005410         GO TO M-35.                                              I.990203
005420     IF (HHT-SIZ = 4) AND (CNT = 10)                              I.990203
005430         COMPUTE HHT-ZSU(CNT) = HHT-ZSU(CNT) + W-ASS -            I.990203
005440                                HHT-USU(CNT)                      I.990203
005450       ELSE                                                       I.990203
005460         ADD HHT-ASS(CNT) TO W-ASS                                I.990203
005470         COMPUTE HHT-ZSU(CNT) = HHT-ZSU(CNT) + HHT-NSU(CNT) -     I.990203
005480                                HHT-USU(CNT) - HHT-ASS(CNT).      I.990203
005490     MOVE ZERO TO HHT-NSU(CNT) HHT-USU(CNT) HHT-ASS(CNT).         I.990203
005500     IF W-GET = 04 OR 10                                          I.990203
005510         MOVE HHT-ZSU(CNT) TO HHT-TZS(CNT)                        I.990203
005520         IF (HHT-SIZ = 4) AND (CNT = 10)                          I.990203
005530             MOVE HHT-ZSU(CNT) TO HHT-TSU(CNT).                   I.990203
005540*----教育のみ０９／０７で棚卸を行う---------------------------------------
005550*****IF W-NG = 200907                                             D.150728
005560     IF W-NG = 201507                                             I.150728
005570         MOVE HHT-ZSU(CNT) TO HHT-TZS(CNT)                        I.090729
005580         IF HHT-BC3 NOT = 30                                      I.090729
005590             MOVE HHT-ZSU(CNT) TO HHT-TSU(CNT)                    I.090729
005600           ELSE                                                   I.090729
005610             IF (HHT-SIZ = 4) AND (CNT = 10)                      I.090729
005620                 MOVE HHT-ZSU(CNT) TO HHT-TSU(CNT).               I.090729
005630*-------------------------------------------------------------------------
005640     ADD HHT-ZSU(CNT) TO W-ZSU.                                   I.990203
005650     GO TO M-30.                                                  I.990203
005660*****MOVE HZ-GSU TO HZ-ZSU.                                       D.990203
005670*****MOVE HZ-GSU TO HZ-TCS.                                       D.990203
005680*****IF HZ-SIZ = 111                                              D.990203
005690*****    MOVE HZ-GSU TO HZ-TTS.                                   D.990203
005700*****MOVE ZERO TO HZ-NSU HZ-USU.                                  D.950419
005710*****MOVE ZERO TO HZ-NSU HZ-USU HZ-ASS.                           D.990203
005720 M-35.                                                            I.990203
005730*****REWRITE HZ-R INVALID KEY                                     D.990203
005740*****    DISPLAY E-ME78 E-STAT E-ME2 E-HZM E-ME99                 D.990203
005750     REWRITE HHT-R INVALID KEY                                    I.990203
005760         MOVE 255 TO COMPLETION-CODE                              I.991004
005770         DISPLAY E-ME78 E-STAT E-ME11 E-HHTF E-ME99               I.990203
005780         GO TO M-95.
005790*
005800*****COMPUTE W-ZKK = HZ-FT * HZ-GSU.                              D.990203
005810*****ADD HZ-ZSU TO W-ZSU.                                         D.990203
005820*****ADD W-ZKK TO W-ZKIN.                                         D.990203
005830*
005840*****READ HZ-M NEXT RECORD AT END                                 D.990203
005850     READ HHTF NEXT RECORD AT END                                 I.990203
005860         GO TO M-40.
005870*****IF HZ-HCD = W-HCD                                            D.990203
005880     IF HHT-HCD = W-HCD                                           I.990203
005890         GO TO M-25.
005900*
005910     MOVE W-HCD TO HI-KEY.                                        I.990203
005920     READ HI-M WITH UNLOCK INVALID KEY                            I.990203
005930         DISPLAY E-ME8 E-HHTF E-ME99                              I.990203
005940         MOVE ZERO TO HI-FT                                       I.990203
005950         DISPLAY E-CL.                                            I.990203
005960     COMPUTE W-ZKIN = HI-FT * W-ZSU.                              I.990203
005970*
005980     MOVE W-HCD TO HUH-KEY.
005990     READ HUH-M INVALID KEY
006000*****    DISPLAY E-ME7 E-HCD                                      D.940715
006010         DISPLAY E-ME7 E-HUHM                                     I.940715
006020         GO TO M-20.
006030     IF (HUH-YS NOT = W-ZSU) OR (HUH-YK NOT = W-ZKIN)
006040         DISPLAY E-ME6 D-ME E-ME99.
006050     GO TO M-20.
006060 M-40.
006070     IF (HUH-YS NOT = W-ZSU) OR (HUH-YK NOT = W-ZKIN)
006080         DISPLAY E-ME6 D-ME E-ME99.
006090 M-50.                                                            I.930406
006100     CLOSE HUH-M.
006110     OPEN I-O HUH-M.
006120*****OPEN INPUT HI-M.                                             D.990203
006130 M-55.
006140     READ HUH-M NEXT RECORD AT END
006150*****    CLOSE HI-M                                               D.990203
006160         GO TO M-70.
006170     MOVE W-NGD TO HUH-NG.
006180     MOVE HUH-YS TO HUH-ZS.
006190     MOVE HUH-YK TO HUH-ZK.
006200     MOVE ZERO TO HUH-NS HUH-NK HUH-SS HUH-SK HUH-UG.
006210     MOVE HUH-KEY TO HI-KEY W-HCD.                                I.930406
006220     READ HI-M WITH UNLOCK INVALID KEY                            I.930406
006230*****    DISPLAY E-ME8 E-HCD E-ME99                               D.940715
006240         DISPLAY E-ME8 E-HUHM E-ME99                              I.940715
006250         DISPLAY E-CL                                             I.930406
006260         GO TO M-60.                                              I.930406
006270     COMPUTE HUH-YK = HUH-YS * HI-FT.                             I.930406
006280 M-60.                                                            I.930406
006290     REWRITE HUH-R INVALID KEY
006300         MOVE 255 TO COMPLETION-CODE                              I.991004
006310         DISPLAY E-ME78 E-STAT E-ME5 E-HUHM E-ME99                C.940707
006320*****    CLOSE HI-M                                               D.990203
006330         GO TO M-95.
006340     GO TO M-55.
006350 M-70.
006360     READ TAZ-M NEXT RECORD AT END
006370         GO TO M-95.
006380*****IF TAZ-AAS = ZERO                                            D.020822
006390     IF ZERO = TAZ-AAS AND TAZ-SAS                                I.020822
006400         GO TO M-75.
006410     MOVE TAZ-AAS TO TAZ-AZS.
006420     MOVE TAZ-SAS TO TAZ-SZS.                                     I.020822
006430     MOVE W-NGD TO TAZ-NG.                                        I.000622
006440     REWRITE TAZ-R INVALID KEY
006450         DISPLAY E-ME78 E-STAT E-ME3 E-TAZM E-ME99.               C.940707
006460     GO TO M-70.
006470 M-75.
006480     DELETE TAZ-M INVALID KEY
006490         DISPLAY E-ME78 E-STAT E-ME4 E-TAZM E-ME99                C.940707
006500         GO TO M-70.                                              I.940707
006510     CALL "CBLTCLS" USING TAZ-M.                                  I.940707
006520     GO TO M-70.
006530 M-95.
006540*****PERFORM UPD-RTN  THRU  UPD-EX.                               D.970321
006550     PERFORM END-RTN  THRU  END-EX.                               *I911125
006560     DISPLAY C-CLEAR.
006570     STOP RUN.
006580*S-05.                                                            D.000322
006590*****IF ZERO = HT-TZZ AND HT-TZZZ                                 D.000222
006600*****IF ZERO = TT-TZZ AND TT-TZZZ                                 D.000322
006610*****    GO TO S-10.                                              D.000322
006620*****MOVE ZERO TO TMS-R.                                          D.000322
006630*****MOVE TT-TCD TO TMS-TCD.                                      D.000322
006640*****MOVE TT-TZZ TO TMS-KIN.                                      D.000322
006650*****MOVE TT-TZZZ TO TMS-SHZ.                                     D.000322
006660*****MOVE HT-TCD TO TMS-TCD.                                      D.000222
006670*****MOVE HT-TZZ TO TMS-KIN.                                      D.000222
006680*****MOVE HT-TZZZ TO TMS-SHZ.                                     D.000222
006690*****WRITE TMS-R.                                                 D.000322
006700*****IF ERR-STAT = "00"                                           D.000322
006710*****    CALL "CBLTCLS" USING TMS-F                               D.000322
006720*****    GO TO S-10.                                              D.000322
006730*****DISPLAY E-STAT E-ME10 E-ME99.                                D.000322
006740*****IF ERR-STAT NOT = "34"                                       D.000322
006750*****    DISPLAY E-ME78 E-ME99                                    D.000322
006760*****    GO TO S-05.                                              D.000322
006770*****DISPLAY E-CL.                                                D.000322
006780*****CLOSE TMS-F.                                                 D.000322
006790*****MOVE "TMSF         " TO W-FILE.                              D.000322
006800*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000322
006810*****DISPLAY E-CL.                                                D.000322
006820*****OPEN EXTEND TMS-F.                                           D.000322
006830*****GO TO S-05.                                                  D.000322
006840*S-10.                                                            D.000322
006850*****IF HT-SP = ZERO                                              D.000222
006860*****    COMPUTE W-KIN = HT-TUA - HT-TNB                          D.000222
006870*****    COMPUTE W-SHZ = HT-TUAZ - HT-TNBZ                        D.000222
006880*****IF TT-SP = ZERO                                              D.000322
006890*****    COMPUTE W-KIN = TT-TUA - TT-TNB                          D.000322
006900*****    COMPUTE W-SHZ = TT-TUAZ - TT-TNBZ                        D.000322
006910*****  ELSE                                                       D.000322
006920*****    COMPUTE W-KIN = TT-SUA + TT-STS                          D.000322
006930*****    COMPUTE W-SHZ = TT-SUAZ + TT-STSZ.                       D.000322
006940*****    COMPUTE W-KIN = HT-SUA + HT-STS                          D.000222
006950*****    COMPUTE W-SHZ = HT-SUAZ + HT-STSZ.                       D.000222
006960*****IF ZERO = W-KIN AND W-SHZ                                    D.000322
006970*****    GO TO S-15.                                              D.000322
006980*
006990*****MOVE ZERO TO TMS-R.                                          D.000322
007000*****MOVE HT-TCD TO TMS-TCD.                                      D.000222
007010*****MOVE TT-TCD TO TMS-TCD.                                      D.000322
007020*****MOVE 99 TO TMS-SP.                                           D.000322
007030*****MOVE 9 TO TMS-SK TMS-KBN.                                    D.000322
007040*****MOVE W-DATE TO TMS-DATE.                                     D.000322
007050*****MOVE W-KIN TO TMS-KIN.                                       D.000322
007060*****MOVE W-SHZ TO TMS-SHZ.                                       D.000322
007070*****WRITE TMS-R.                                                 D.000322
007080*****IF ERR-STAT = "00"                                           D.000322
007090*****    CALL "CBLTCLS" USING TMS-F                               D.000322
007100*****    GO TO S-15.                                              D.000322
007110*
007120*****DISPLAY E-STAT E-ME10 E-ME99.                                D.000322
007130*****IF ERR-STAT NOT = "34"                                       D.000322
007140*****    DISPLAY E-ME78 E-ME99                                    D.000322
007150*****    GO TO S-10.                                              D.000322
007160*****DISPLAY E-CL.                                                D.000322
007170*****CLOSE TMS-F.                                                 D.000322
007180*****MOVE "TMSF         " TO W-FILE.                              D.000322
007190*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000322
007200*****DISPLAY E-CL.                                                D.000322
007210*****OPEN EXTEND TMS-F.                                           D.000322
007220*****GO TO S-10.                                                  D.000322
007230*S-15.                                                            D.000322
007240*****EXIT.                                                        D.000322
007250*S-20.                                                            D.000322
007260*****MOVE D-NHNG TO W-NG.                                         D.970716
007270*****MOVE W-NGD TO W-NG.                                          D.000322
007280*****SUBTRACT 1 FROM W-GET.                                       D.000322
007290*****IF W-GET = ZERO                                              D.000322
007300*****    SUBTRACT 1 FROM W-NEN                                    D.000322
007310*****    MOVE 12 TO W-GET.                                        D.000322
007320*****OPEN INPUT CALNM.                                            D.000322
007330*****MOVE ZERO TO CL-KEY.                                         D.000322
007340*****MOVE W-NG TO CL-NG.                                          D.000322
007350*****START CALNM KEY NOT < CL-KEY INVALID KEY                     D.000322
007360*****    CLOSE CALNM                                              D.000322
007370*****    DISPLAY E-ME9 E-ME99                                     D.000322
007380*****    DISPLAY E-CL                                             D.000322
007390*****    GO TO S-20.                                              D.000322
007400*****READ CALNM NEXT RECORD WITH UNLOCK AT END                    D.000322
007410*****    CLOSE CALNM                                              D.000322
007420*****    DISPLAY E-ME9 E-ME99                                     D.000322
007430*****    DISPLAY E-CL                                             D.000322
007440*****    GO TO S-20.                                              D.000322
007450*****IF W-NG NOT = CL-NG                                          D.000322
007460*****    CLOSE CALNM                                              D.000322
007470*****    DISPLAY E-ME9 E-ME99                                     D.000322
007480*****    DISPLAY E-CL                                             D.000322
007490*****    GO TO S-20.                                              D.000322
007500*S-25.                                                            D.000322
007510*****MOVE CL-KEY TO W-DATE                                        D.000322
007520*****READ CALNM NEXT RECORD WITH UNLOCK AT END                    D.000322
007530*****    CLOSE CALNM                                              D.000322
007540*****    GO TO S-30.                                              D.000322
007550*****IF W-NG = CL-NG                                              D.000322
007560*****    GO TO S-25.                                              D.000322
007570*S-30.                                                            D.000322
007580*****EXIT.                                                        D.000322
007590*HKB-RTN.                                                         D.000323
007600*****OPEN I-O HKBM.                                               D.000323
007610*****MOVE SPACE TO HKB-KEY.                                       D.000323
007620*****MOVE "05" TO HKB-NO.                                         D.000323
007630*****READ HKBM INVALID KEY                                        D.000323
007640*****    DISPLAY E-ME21 E-ME99                                    D.000323
007650*****    GO TO HKB-010.                                           D.000323
007660*****MOVE HKB-DAI TO W-DAI.                                       D.000323
007670*****MOVE W-DAI TO HKB-DAI.                                       D.991005
007680*****REWRITE HKB-R INVALID KEY                                    D.991005
007690*****    DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      D.991005
007700*****    MOVE 255 TO COMPLETION-CODE.                             D.991005
007710*****CLOSE HKBM.                                                  D.991005
007720*****GO TO HKB-EX.                                                D.000323
007730*HKB-010.                                                         D.000323
007740*****INITIALIZE HKB-R.                                            D.000323
007750*****MOVE SPACE TO HKB-KEY.                                       D.000323
007760*****MOVE "05" TO HKB-NO.                                         D.000323
007770*****MOVE W-DAI TO HKB-DAI.                                       D.991005
007780*****MOVE ZERO TO HKB-SKN HKB-NKN.                                D.991005
007790*****WRITE HKB-R INVALID KEY                                      D.000323
007800*****    DISPLAY E-ME78 E-STAT E-ME23 E-ME99                      D.000323
007810*****    MOVE 255 TO COMPLETION-CODE.                             D.000323
007820*****INITIALIZE W-DAI.                                            D.000323
007830*****CLOSE HKBM.                                                  D.991005
007840*HKB-EX.                                                          D.000323
007850*****EXIT.                                                        D.000323
007860*TUK-RTN.                                                         D.000323
007870*****COPY LDAIP.                                                  D.000323
007880*****IF W-DAI1 = "999"                                            D.000323
007890*****    DISPLAY E-ME78 E-ME50 E-ME99                             D.000323
007900*****    DISPLAY E-CL.                                            D.000323
007910*****MOVE W-DAI TO HKB-DAI.                                       D.000323
007920*****REWRITE HKB-R INVALID KEY                                    D.000323
007930*****    CLOSE HKBM                                               D.000323
007940*****    MOVE 255 TO COMPLETION-CODE                              D.000323
007950*****    DISPLAY E-ME78 E-STAT E-ME22 E-ME99                      D.000323
007960*****    GO TO TUK-EX.                                            D.000323
007970*****CLOSE HKBM.                                                  D.000323
007980*TUK-010.                                                         D.000323
007990*****INITIALIZE TUK-R.                                            D.000323
008000*****MOVE HT-KEY TO TUK-TCD.                                      D.000222
008010*****MOVE TT-KEY TO TUK-TCD.                                      D.000323
008020*****MOVE W-DAI TO TUK-DAI.                                       D.000323
008030*****MOVE W-NGPD TO TUK-DATE.                                     D.000323
008040*****MOVE 0 TO TUK-DC.                                            D.000323
008050*****MOVE HT-TZZ TO TUK-KIN.                                      D.000222
008060*****MOVE HT-TZZZ TO TUK-SHZ.                                     D.000222
008070*****MOVE HT-BC TO TUK-BMC.                                       D.000222
008080*****MOVE TT-TZZ TO TUK-KIN.                                      D.000323
008090*****MOVE TT-TZZZ TO TUK-SHZ.                                     D.000323
008100*****MOVE TT-BC TO TUK-BMC.                                       D.000323
008110*****WRITE TUK-R INVALID KEY                                      D.000323
008120*****    DISPLAY E-STAT E-ME28 E-ME99                             D.000323
008130*****    GO TO TUK-020.                                           D.000323
008140*****GO TO TUK-EX.                                                D.000323
008150*TUK-020.                                                         D.000323
008160*****IF ERR-STAT NOT = "24"                                       D.000323
008170*****    MOVE 255 TO COMPLETION-CODE                              D.000323
008180*****    DISPLAY E-ME78 E-ME99                                    D.000323
008190*****    GO TO TUK-EX.                                            D.000323
008200*****DISPLAY E-CL.                                                D.000323
008210*****CLOSE TUKF.                                                  D.000323
008220*****MOVE "TUKF         " TO W-FILE.                              D.000323
008230*****DISPLAY E-ME71 E-ME98 STOP " ".                              D.000323
008240*****DISPLAY E-CL.                                                D.000323
008250*****OPEN I-O TUKF.                                               D.000323
008260*****GO TO TUK-010.                                               D.000323
008270*TUK-EX.                                                          D.000323
008280*****EXIT.                                                        D.000323
008290 END-RTN.                                                         *I911125
008300*****CLOSE HT-M HHTF HUH-M TAZ-M.                                 D.000222
008310*****CLOSE HZ-M.                                                  D.990225
008320*****CLOSE HT-M HZ-M HUH-M TAZ-M.                                 D.990203
008330*****CLOSE HT-M HZ-M HUH-M TAZ-M JZAI.                            D.970321
008340*****CLOSE TCU-M SSR-F SUSR-F AZ-F HPR-F HKS-F HUNDR-F FRHP-F.    D.941215
008350*****CLOSE SSR-F SUSR-F AZ-F HPR-F HKS-F HUNDR-F FRHP-F.          D.961105
008360*****CLOSE YG-F JNSR.                                             D 920614
008370*****CLOSE      JNSR.                                             D.940715
008380*****CLOSE      JNSR STRF.                                        D.960729
008390*****CLOSE      JNSR STRF STRAN-T.                                D.961105
008400*****CLOSE      JNSR STRF SNTRF STRAN-T.                          D.961105
008410*****CLOSE SSR-F SUSR-F AZ-F HKS-F HUNDR-F.                       D.970108
008420*****CLOSE SUSR-F HUNDR-F.                                        D.970115
008430*****CLOSE JNSR  SNTRF STRAN-T.                                   D.970115
008440*****CLOSE HUNDR-F JNSR  SNTRF STRAN-T  UTR-F.                    D.970321
008450*****CLOSE TT-M HHTF HUH-M TAZ-M.                                 D.000323
008460     CLOSE HHTF HUH-M TAZ-M.                                      I.000323
008470     CLOSE SNTRF UTR-F.                                           I.060711
008480*****CLOSE SNTRF UTR-F HBHKF.                                     D.060711
008490*****CLOSE SNTRF UTR-F.                                           D.010323
008500*****CLOSE HUNDR-F SNTRF UTR-F.                                   D.000829
008510*****CLOSE HUNDR-F SNTRF STRAN-T  UTR-F.                          D.000531
008520*****CLOSE TMS-F.                                                 D.000322
008530*****CLOSE TUKF.                                                  D.000323
008540     CLOSE HI-M.                                                  I.990203
008550 END-EX.
008560     EXIT.
008570*****
008580*UPD-RTN.                                                         D.970321
008590*****READ  JZAI  NEXT  AT END                                     D.970321
008600*****      GO  TO  UPD-EX.                                        D.970321
008610*****PERFORM  COM-RTN  THRU  COM-EX                               D.970321
008620*****         VARYING  I  FROM  1  BY  1                          D.970321
008630*****         UNTIL    I  >  10.                                  D.970321
008640*****MOVE     0   TO   CHK-SW.                                    D.970321
008650*****PERFORM  CHK-RTN  THRU  CHK-EX                               D.970321
008660*****         VARYING  I  FROM  1  BY  1                          D.970321
008670*****         UNTIL  ( I  >  10 ) OR ( CHK-SW = 1 ).              D.970321
008680*****IF       CHK-SW = 0     GO  TO  UPD-050.                     D.970321
008690*****REWRITE  JZAI-R   INVALID                                    D.970321
008700*****         MOVE  "R"    TO  ERR-M                              D.970321
008710*****         MOVE  "JZAI" TO  ERR-F                              D.970321
008720*****         MOVE  JZAI-KEY TO ERR-K                             D.970321
008730*****         PERFORM ERR-RTN  THRU  ERR-EX.                      D.970321
008740*****GO  TO   UPD-RTN.                                            D.970321
008750*UPD-050.                                                         D.970321
008760*****DELETE   JZAI     INVALID                                    D.970321
008770*****         MOVE  "D"    TO  ERR-M                              D.970321
008780*****         MOVE  "JZAI" TO  ERR-F                              D.970321
008790*****         MOVE  JZAI-KEY TO ERR-K                             D.970321
008800*****         PERFORM ERR-RTN  THRU  ERR-EX.                      D.970321
008810*****CALL     "CBLTCLS"   USING  JZAI.                            D.970321
008820*****GO  TO   UPD-RTN.                                            D.970321
008830*UPD-EX.                                                          D.970321
008840*****EXIT.                                                        D.970321
008850*****
008860*COM-RTN.                                                         D.970321
008870*****COMPUTE  JZAI-0411(I) = JZAI-0411(I) + JZAI-0511(I)          D.970321
008880*****                      - JZAI-0611(I).                        D.970321
008890*****MOVE     0    TO   JZAI-0511(I) JZAI-0611(I).                D.970321
008900*COM-EX.                                                          D.970321
008910*****EXIT.                                                        D.970321
008920*****
008930*CHK-RTN.                                                         D.970321
008940*****IF  JZAI-0411(I) NOT = 0                                     D.970321
008950*****  OR  JZAI-0511(I) NOT = 0                                   D.970321
008960*****    OR  JZAI-0611(I) NOT = 0                                 D.970321
008970*****        MOVE  1  TO  CHK-SW.                                 D.970321
008980*CHK-EX.                                                          D.970321
008990*****EXIT.                                                        D.970321
009000 COPY   LPMSG.
