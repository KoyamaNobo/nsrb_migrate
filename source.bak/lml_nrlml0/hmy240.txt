000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMY250.
000030****************************************************************
000040*****     担当得意先品種月別　年間売上数量集計表　選択     *****
000050****************************************************************
000060 ENVIRONMENT DIVISION.
000070 CONFIGURATION SECTION.
000080 SOURCE-COMPUTER. SYSTEM3100.
000090 OBJECT-COMPUTER. SYSTEM3100.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     COPY LIBCSE.
000130 I-O-CONTROL.
000140     APPLY SHARED-MODE ON M-DATE.
000150 DATA DIVISION.
000160 FILE SECTION.
000170     COPY LIBFDD.
000180 WORKING-STORAGE  SECTION.
000190 01  W-DATA.
000200     02  W-S            PIC  9(001).
000210     02  W-SNG.
000220       03  W-SNEN       PIC  9(002).
000230       03  W-SGET       PIC  9(002).
000240     02  W-ENG.
000250       03  W-ENEN       PIC  9(002).
000260       03  W-EGET       PIC  9(002).
000270     02  W-DMM          PIC  9(001).
000280     COPY LSTAT.
000290 SCREEN SECTION.
000300 SD  C-CRT
000310     END STATUS IS ESTAT.
000320 01  C-CLEAR.
000330     02  LINE   1  CLEAR SCREEN.
000340 01  C-MID.
000350     02  LINE   3  COLUMN  10  PIC  N(025) VALUE
000360          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000370     02  LINE   4  COLUMN  10  PIC  N(025) VALUE
000380          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000390     02  LINE   5  COLUMN  10  PIC  N(025) VALUE
000400          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
000410     02  LINE   6  COLUMN  10  PIC  N(025) VALUE
000420          NC"＊＊＊　　得意先品種　月別　売上数集計表　　＊＊＊".
000430     02  LINE   7  COLUMN  10  PIC  N(025) VALUE
000440          NC"＊＊＊　　　　　　　　　　　　　　　　　　　＊＊＊".
000450     02  LINE   8  COLUMN  10  PIC  N(025) VALUE
000460          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000470     02  LINE   9  COLUMN  10  PIC  N(025) VALUE
000480          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000490     02  LINE  13  COLUMN  23  PIC  X(024) VALUE
000500          "'  年   月 〜 '  年   月".
000510     02  LINE  15  COLUMN  18  PIC  X(034) VALUE
000520          "一般=1 Ｖｉ=3 教育=5 終了=9   ﾘﾀｰﾝ".
000530     02  LINE  20  COLUMN  24  PIC  X(022) VALUE
000540          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
000550 01  C-ACP.
000560     02  LINE  15.
000570       03  A-S     COLUMN  47  PIC  9(001)
000580            USING W-S     CHECK OVERFLOW NO IFC.
000590     02  A-DMM   LINE  20  COLUMN  41  PIC  9(001)
000600          USING W-DMM   CHECK OVERFLOW NO IFC.
000610 01  C-DSP.
000620     02  D-NG    LINE  13.
000630       03  COLUMN  24  PIC  9(002) FROM  W-SNEN.
000640       03  COLUMN  29  PIC  9(002) FROM  W-SGET.
000650       03  COLUMN  38  PIC  9(002) FROM  W-ENEN.
000660       03  COLUMN  43  PIC  9(002) FROM  W-EGET.
000670 01  C-ERR.
000680     02  LINE  24.
000690       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000700       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000710       03  E-CL    COLUMN  10  PIC  X(050) VALUE
000720            "                                                  ".
000730     COPY LIBSCR.
000740 PROCEDURE DIVISION.
000750 M-05.
000760     COPY LIBCPR.
000770     MOVE D-SPNG TO W-SNG.
000780     MOVE D-EPNG TO W-ENG.
000790     DISPLAY C-CLEAR.
000800     DISPLAY C-MID.
000810     DISPLAY D-NG.
000820 M-10.
000830     ACCEPT A-S.
000840     IF ESTAT = PF9
000850         MOVE 255 TO COMPLETION-CODE
000860         GO TO M-95.
000870     IF ESTAT NOT = HTB AND SKP
000880         GO TO M-10.
000890     IF W-S NOT = 1 AND 3 AND 5 AND 9
000900         GO TO M-10.
000910 M-15.
000920     ACCEPT A-DMM.
000930     IF ESTAT = BTB
000940         GO TO M-10.
000950     IF ESTAT NOT = HTB AND SKP
000960         GO TO M-15.
000970     IF W-DMM = 9
000980         MOVE 255 TO COMPLETION-CODE
000990         GO TO M-95.
001000     IF W-DMM NOT = 1
001010         GO TO M-15.
001020*
001030     IF W-S = 1
001040         MOVE 110 TO COMPLETION-CODE.
001050     IF W-S = 3
001060         MOVE 130 TO COMPLETION-CODE.
001070     IF W-S = 5
001080         MOVE 150 TO COMPLETION-CODE.
001090     IF W-S = 9
001100         MOVE 255 TO COMPLETION-CODE.
001110 M-95.
001120     DISPLAY C-CLEAR.
001130     STOP RUN.
