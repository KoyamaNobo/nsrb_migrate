000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMD310.
000030*********************************************************
000040*    PROGRAM         :  仕上・受入入力　　　　　　　　  *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHD31                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  0=入力 , 1=購買変換             *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170*****SELECT HI-M ASSIGN TO HI-MSD                                 D.010802
000180     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD                        I.010802
000190         ORGANIZATION INDEXED
000200         ACCESS MODE IS RANDOM
000210         RECORD KEY IS HI-KEY
000220         ALTERNATE RECORD KEY IS HI-KEY2                          I.010802
000230         FILE STATUS IS ERR-STAT.
000240     SELECT JCON ASSIGN TO JCON-MSD
000250         ORGANIZATION INDEXED
000260         ACCESS MODE IS RANDOM
000270         RECORD KEY IS JCON3-KEY
000280         FILE STATUS IS ERR-STAT.
000290     SELECT HKBM ASSIGN TO HKB-MSD                                I.960918
000300         ORGANIZATION INDEXED                                     I.960918
000310         ACCESS MODE IS DYNAMIC                                   I.960918
000320         RECORD KEY IS HKB-KEY                                    I.960918
000330         FILE STATUS IS ERR-STAT.                                 I.960918
000340*****SELECT HN-SUSZ ASSIGN TO SUSZ-MSD                            D.970110
000350*****    ORGANIZATION INDEXED                                     D.970110
000360*****    ACCESS MODE IS DYNAMIC                                   D.970110
000370*****    RECORD KEY IS SUSZ-KEY                                   D.970110
000380*****    FILE STATUS IS ERR-STAT.                                 D.970110
000390*****SELECT SU-F ASSIGN TO SU-MSD.                                D.970110
000400*****SELECT HN-UTRN ASSIGN TO UTRN-MSD.                           D.970110
000410     SELECT HSS-F ASSIGN TO HSS-MSD                               I.010105
000420         ORGANIZATION INDEXED                                     I.010105
000430         ACCESS MODE IS DYNAMIC                                   I.010105
000440         RECORD KEY IS HSS-KEY                                    I.010105
000450         FILE STATUS IS ERR-STAT.                                 I.010105
000460*****SELECT HSKWF ASSIGN TO HSKW-MSD.                             D.060605
000470*****SELECT HSKDF ASSIGN TO HSKD-MSD                              D.060605
000480*****    ORGANIZATION INDEXED                                     D.060605
000490*****    ACCESS MODE IS DYNAMIC                                   D.060605
000500*****    RECORD KEY IS HSKD-KEY                                   D.060605
000510*****    FILE STATUS IS ERR-STAT.                                 D.060605
000520     SELECT HUH-M ASSIGN TO HUH-MSD                               I.020215
000530         ORGANIZATION INDEXED                                     I.020215
000540         ACCESS MODE IS RANDOM                                    I.020215
000550         RECORD KEY IS HUH-KEY                                    I.020215
000560         FILE STATUS IS ERR-STAT.                                 I.020215
000570     SELECT UTRAN ASSIGN TO UTRAN-MSD.                            I.970110
000580     SELECT SP-F ASSIGN TO P-PRN999.
000590 I-O-CONTROL.
000600     APPLY SHARED-MODE ON M-DATE
000610     APPLY SHARED-MODE ON HI-M
000620     APPLY SHARED-MODE ON JCON
000630     APPLY SHARED-MODE ON HKBM                                    I.960918
000640     APPLY SHARED-MODE ON HUH-M                                   I.020215
000650*****APPLY SHARED-MODE ON HN-SUSZ                                 D.970110
000660     APPLY SHIFT-CODE  ON SP-F.                                   A 62/04
000670 DATA DIVISION.
000680 FILE SECTION.
000690     COPY LIBFDD.
000700     COPY LIHIM.
000710     COPY L-JCON.
000720     COPY LIHKBM.                                                 I.960918
000730     COPY LIHSSF.                                                 I.010105
000740*****COPY LIHSKD.                                                 D.060605
000750     COPY LIHUHM.                                                 I.020215
000760*****COPY LNSUSZ.                                                 D.970110
000770*****COPY LNUTRN.                                                 D.970110
000780     COPY LUTRAN.                                                 I.970110
000790     COPY LSPF.
000800*FD  HSKWF                                                        D.060605
000810*****BLOCK  1 RECORDS                                             D.060605
000820*****LABEL RECORD IS STANDARD                                     D.060605
000830*****VALUE OF IDENTIFICATION WK0256ID.                            D.060605
000840*01  HSKW-R.                                                      D.060605
000850*****02  HSKW-KEY.                                                D.060605
000860*****  03  HSKW-RNO.                                              D.060605
000870*****    04  HSKW-NEN   PIC  9(004).                              D.060605
000880*****    04  HSKW-DNO.                                            D.060605
000890*****      05  HSKW-GET PIC  9(002).                              D.060605
000900*****      05  HSKW-NO  PIC  9(003).                              D.060605
000910*****      05  HSKW-SUB PIC  9(001).                              D.060605
000920*****  03  HSKW-DATE    PIC  9(008).                              D.060605
000930*****  03  HSKW-NGPD  REDEFINES HSKW-DATE.                        D.060605
000940*****    04  HSKW-NGD   PIC  9(006).                              D.060605
000950*****    04  HSKW-NGDD  REDEFINES HSKW-NGD.                       D.060605
000960*****      05  HSKW-NEND PIC  9(004).                             D.060605
000970*****      05  HSKW-GETD PIC  9(002).                             D.060605
000980*****    04  HSKW-PEYD  PIC  9(002).                              D.060605
000990*****  03  HSKW-SEQ     PIC  9(002).                              D.060605
001000*****  03  HSKW-SKC     PIC  9(001).                              D.060605
001010*****02  HSKW-HCD       PIC  9(006).                              D.060605
001020*****02  HSKW-ASUD.                                               D.060605
001030*****  03  HSKW-ASU  OCCURS   4.                                  D.060605
001040*****    04  HSKW-SUD   OCCURS  10.                               D.060605
001050*****      05  HSKW-SU  PIC S9(003).                              D.060605
001060*****02  HSKW-END       PIC  9(001).                              D.060605
001070*****02  HSKW-UNO       PIC  9(006).                              D.060605
001080*****02  F              PIC  X(011).                              D.020318
001090*****02  F              PIC  X(007).                              D.060605
001100*****02  HSKW-PRI       PIC  9(003).                              D.060605
001110*****02  HSKW-IPD       PIC  9(002).                              D.060605
001120*****02  HSKW-HHD       PIC  9(002).                              D.060605
001130*****02  HSKW-GHD       PIC  9(002).                              D.060605
001140*****02  HSKW-HHC       PIC  9(001).                              D.020318
001150*****02  HSKW-GHC       PIC  9(001).                              D.020318
001160*****02  F              PIC  X(086).                              D.060605
001170*FD  SU-F                                                         D.970110
001180*****BLOCK 5 RECORDS                                              D.970110
001190*****LABEL RECORD IS STANDARD                                     D.970110
001200*****VALUE OF IDENTIFICATION "SUF".                               D.970110
001210*01  SU-R.                                                        D.970110
001220*****02  U-DATE       PIC  9(006).                                D.970110
001230*****02  U-HCD        PIC  9(006).                                D.970110
001240*****02  U-SIZ        PIC  9(001).                                D.970110
001250*****02  U-S          PIC  9(003).                                D.970110
001260*****02  U-SU         PIC S9(006).                                D.970110
001270*****02  U-BK         PIC S9(008).                                D.970110
001280*****02  U-FK         PIC S9(008).                                D.970110
001290*****02  U-SK         PIC  9(001).                                D.970110
001300*****02  U-BC1        PIC  9(002).                                D.970110
001310*****02  U-BC2        PIC  9(002).                                D.970110
001320*****02  U-BC3        PIC  9(002).                                D.970110
001330*****02  U-NC         PIC  9(001).                                D.970110
001340**** 02  F            PIC  X(005).                                D 920615
001350*****02  U-SKC        PIC  9(001).                                D.970110
001360*****02  F            PIC  X(004).                                D.970110
001370 WORKING-STORAGE SECTION.
001380 77  JS-SIGN            PIC  9(001).                              I.010105
001390*77  WK0256ID           PIC  X(009) VALUE SPACE.                  D.060605
001400*01  STN-NO.                                                      D.060605
001410*****02  STN-NO1        PIC  X(003).                              D.060605
001420*****02  STN-NO2        PIC  X(003).                              D.060605
001430*01  W-FID.                                                       D.060605
001440*****02  W-FID1         PIC  X(006) VALUE "WK0256".               D.060605
001450*****02  W-FID2         PIC  X(003).                              D.060605
001460 01  ERR-STAT           PIC  X(002).
001470 01  HEAD1.
001480     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".           A 62/0
001490*****02  F              PIC  X(029) VALUE SPACE.                  D.950615
001500*****02  F              PIC  X(031) VALUE SPACE.                  D.970110
001510*****02  F              PIC  N(027) VALUE                         D.970110
001520*****  NC"＊＊＊　　仕上・受入　確定入力プルーフリスト　　＊＊＊".D.970110
001530*****02  F              PIC  X(026) VALUE SPACE.                  D.950615
001540*****02  F              PIC  X(029) VALUE SPACE.                  D.970110
001550     02  F              PIC  X(038) VALUE SPACE.                  I.970110
001560     02  H-MID          PIC  N(025) VALUE                         I.010105
001570          NC"＊＊＊　　仕上・受入入力　プルーフリスト　　＊＊＊". I.970110
001580     02  F              PIC  X(026) VALUE SPACE.                  I.970110
001590     02  F              PIC  X(005) VALUE "DATE ".
001600     02  H-DATE         PIC 99B99B99.
001610     02  F              PIC  X(007) VALUE "     P.".
001620     02  H-PAGE         PIC Z9.
001630 01  HEAD2.
001640     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001650     02  F              PIC  N(002) VALUE NC"入力".               I.950615
001660     02  F              PIC  X(001) VALUE SPACE.                  I.950615
001670*****02  F              PIC  N(004) VALUE NC"入力区分".           D.950615
001680*****02  F              PIC  X(002) VALUE SPACE.                  D.950615
001690*****02  F              PIC  N(004) VALUE NC"日　　付".           D.970110
001700     02  F              PIC  N(004) VALUE NC"　日付　".           I.970110
001710     02  F              PIC  X(001) VALUE SPACE.                  I.950615
001720     02  F              PIC  N(002) VALUE NC"倉庫".               I.950615
001730     02  F              PIC  X(001) VALUE SPACE.                  I.950615
001740     02  F              PIC  N(004) VALUE NC"受入№　".           I.950615
001750     02  F              PIC  N(002) VALUE NC"返品".               I.950615
001760     02  F              PIC  X(001) VALUE SPACE.                  I.950615
001770     02  F              PIC  N(002) VALUE NC"生産".               I.950615
001780*****02  F              PIC  X(002) VALUE SPACE.                  D.950615
001790*****02  F              PIC  N(004) VALUE NC"生産区分".           D.950615
001800*****02  F              PIC  X(008) VALUE "  ｺｰﾄﾞ  ".             D.950615
001810     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              I.950615
001820     02  F              PIC  N(006) VALUE NC"品　　　　名".
001830     02  F              PIC  X(092) VALUE SPACE.                  I.950615
001840*****02  F              PIC  X(027) VALUE SPACE.                  D.950615
001850*****02  F              PIC  N(006) VALUE NC"倉　　　　庫".       D.950615
001860*****02  F              PIC  X(004) VALUE SPACE.                  D.950615
001870*****02  F              PIC  N(004) VALUE NC"受入№　".           D.950615
001880*****02  W-2K           PIC  X(005) VALUE ""3FE04FE080"".         D.950615
001890 01  HEAD3.
001900*****02  F              PIC  X(031) VALUE SPACE.                  D.950615
001910     02  F              PIC  X(035) VALUE SPACE.                  I.950615
001920     02  F              PIC  X(001) VALUE "1".
001930     02  F              PIC  X(004) VALUE SPACE.
001940     02  F              PIC  N(002) VALUE NC"３号".
001950*****02  F              PIC  X(003) VALUE SPACE.                  D.950615
001960     02  F              PIC  X(004) VALUE SPACE.                  I.950615
001970     02  F              PIC  N(002) VALUE NC"２号".
001980*****02  F              PIC  X(003) VALUE SPACE.                  D.950615
001990     02  F              PIC  X(004) VALUE SPACE.                  I.950615
002000     02  F              PIC  N(002) VALUE NC"１号".
002010*****02  F              PIC  X(003) VALUE SPACE.                  D.950615
002020     02  F              PIC  X(004) VALUE SPACE.                  I.950615
002030     02  F              PIC  N(002) VALUE NC"０号".
002040     02  F              PIC  X(004) VALUE SPACE.                  I.950615
002050     02  F              PIC  N(002) VALUE NC"　中".               I.950615
002060     02  F              PIC  X(004) VALUE SPACE.                  I.950615
002070     02  F              PIC  N(002) VALUE NC"　大".               I.950615
002080*****02  F              PIC  X(005) VALUE SPACE.                  D.950615
002090*****02  F              PIC  N(001) VALUE NC"中".                 D.950615
002100*****02  F              PIC  X(005) VALUE SPACE.                  D.950615
002110*****02  F              PIC  N(001) VALUE NC"大".                 D.950615
002120*****02  F              PIC  X(003) VALUE SPACE.                  D.950615
002130     02  F              PIC  X(004) VALUE SPACE.                  I.950615
002140     02  F              PIC  N(002) VALUE NC"特大".
002150     02  F              PIC  X(021) VALUE                         I.950615
002160          "   28.0   29.0   30.0".                                I.950615
002170     02  F              PIC  X(030) VALUE SPACE.                  I.950615
002180*****02  F              PIC  X(026) VALUE                         D.950615
002190*****     "   28.0   29.0   30.0    ".                            D.950615
002200*****02  F              PIC  N(002) VALUE NC"合計".               D.950615
002210*****02  F              PIC  X(022) VALUE SPACE.                  D.950615
002220 01  HEAD4.
002230*****02  F              PIC  X(031) VALUE SPACE.                  D.950615
002240*****02  F              PIC  X(040) VALUE                         D.950615
002250*****     "2    12.5   13.0   13.5   14.0   15.0   ".             D.950615
002260     02  F              PIC  X(035) VALUE SPACE.                  I.950615
002270     02  F              PIC  X(039) VALUE                         I.950615
002280          "2   12.5   13.0   13.5   14.0   15.0   ".              I.950615
002290     02  F              PIC  X(032) VALUE
002300          "16.0   17.0   18.0   19.0   20.0".
002310     02  F              PIC  X(030) VALUE SPACE.
002320 01  HEAD5.
002330*****02  F              PIC  X(031) VALUE SPACE.                  D.950615
002340*****02  F              PIC  X(040) VALUE                         D.950615
002350*****     "3    21.0   21.5   22.0   22.5   23.0   ".             D.950615
002360     02  F              PIC  X(035) VALUE SPACE.                  I.950615
002370     02  F              PIC  X(039) VALUE                         I.950615
002380          "3   21.0   21.5   22.0   22.5   23.0   ".              I.950615
002390     02  F              PIC  X(032) VALUE
002400          "23.5   24.0   24.5   25.0       ".
002410     02  F              PIC  X(030) VALUE SPACE.
002420 01  HEAD6.
002430*****02  F              PIC  X(031) VALUE SPACE.                  D.950615
002440*****02  F              PIC  X(040) VALUE                         D.950615
002450*****     "4    24.0   24.5   25.0   25.5   26.0   ".             D.950615
002460     02  F              PIC  X(035) VALUE SPACE.                  I.950615
002470     02  F              PIC  X(039) VALUE                         I.950615
002480          "4   24.0   24.5   25.0   25.5   26.0   ".              I.950615
002490     02  F              PIC  X(032) VALUE
002500          "26.5   27.0   27.5              ".
002510     02  F              PIC  X(005) VALUE SPACE.                  I.950615
002520     02  F              PIC  N(002) VALUE NC"合計".               I.950615
002530*****02  F              PIC  X(011) VALUE SPACE.                  D.950615
002540     02  F              PIC  X(005) VALUE SPACE.                  I.950615
002550     02  F              PIC  N(004) VALUE NC"売価金額".
002560*****02  F              PIC  X(003) VALUE SPACE.                  D.950615
002570     02  F              PIC  X(005) VALUE SPACE.                  I.950615
002580     02  F              PIC  N(004) VALUE NC"振替金額".
002590 01  W-MID1             PIC  N(025) VALUE                         I.010105
002600      NC"＊＊＊　　製品仕入　変換　プルーフリスト　　＊＊＊".     I.060605
002610***** NC"＊＊＊　　仕入・製造変換　プルーフリスト　　＊＊＊".     D.060605
002620***** NC"＊＊＊　　製品仕入　変換　プルーフリスト　　＊＊＊".     D.020126
002630 01  W-P1.
002640*****02  P-15K          PIC  X(005).                              D.950615
002650*****02  F              PIC  X(003).                              D.950615
002660     02  F              PIC  X(001).                              I.950615
002670     02  P-NRC          PIC  9(001).
002680*****02  F              PIC  X(003).                              D.950615
002690     02  F              PIC  X(001).                              I.950615
002700     02  P-DATE         PIC 99/99/99.
002710     02  F              PIC  X(001).                              I.950615
002720     02  P-SKC          PIC  9(001).                              I.950615
002730     02  F              PIC  X(001).                              I.950615
002740     02  P-UNO          PIC  9(006).                              I.950615
002750     02  F              PIC  X(002).                              I.950615
002760     02  P-HPC          PIC  9(001).                              I.950615
002770*****02  F              PIC  X(004).                              D.950615
002780     02  F              PIC  X(003).                              I.950615
002790     02  P-SSC          PIC  9(001).
002800*****02  F              PIC  X(003).                              D.950615
002810     02  F              PIC  X(001).                              I.950615
002820     02  P-HCD          PIC  9(006).                                C 62/0
002830     02  F              PIC  X(001).
002840     02  P-NAME         PIC  N(024).                                C 62/0
002850     02  F              PIC  X(065).                              I.950615
002860*****02  F              PIC  X(001).                              D.950615
002870*****02  P-SKC          PIC  9(001).                              D.950615
002880*****02  F              PIC  X(001).                              D.950615
002890*****02  P-SNM          PIC  N(006).                              D.950615
002900*****02  F              PIC  X(001).                              D.950615
002910*****02  P-UNO          PIC  9(006).                              D.950615
002920 01  W-P2.
002930*****02  P-20K          PIC  X(005).                              D.950615
002940*****02  F              PIC  X(031).                              D.950615
002950     02  F              PIC  X(035).                              I.950615
002960     02  P-SIZ          PIC  9(001).
002970*****02  F              PIC  X(001).                              D.950615
002980     02  P-SU           PIC ---,---       OCCURS  10.
002990     02  P-GS           PIC ----,--9.
003000     02  P-BK           PIC ---,---,--9.
003010     02  P-FK           PIC ---,---,--9.
003020 01  W-P3.                                                        *I 92/07
003030*****02  P-20KK         PIC  X(005).                              D.950615
003040*****02  F              PIC  X(092).                              D.950615
003050*****02  P-GOK          PIC  N(003).                              D.950615
003060*****02  F              PIC  X(005).                              D.950615
003070     02  F              PIC  X(094).                              I.950615
003080     02  P-GOK          PIC  N(008).                              I.950615
003090     02  P-GGS          PIC ----,--9.
003100     02  P-GBK          PIC ---,---,--9.
003110     02  P-GFK          PIC ---,---,--9.
003120*01  W-TBL.                                                       D.970110
003130*****02  W-TBL1         PIC  X(030) VALUE                         D.970110
003140*****     "003002001000201301401280290300".                       D.970110
003150*****02  W-TBL2         PIC  X(030) VALUE                         D.970110
003160*****     "125130135140150160170180190200".                       D.970110
003170*****02  W-TBL3         PIC  X(030) VALUE                         D.970110
003180*****     "210215220225230235240245250   ".                       D.970110
003190*****02  W-TBL4         PIC  X(030) VALUE                         D.970110
003200*****     "240245250255260265270275      ".                       D.970110
003210*01  W-SS.                                                        D.970110
003220*****02  W-SS1          PIC  X(003)       OCCURS  10.             D.970110
003230 01  W-ID.
003240     02  W-UNO          PIC  9(006).
003250     02  W-SCD          PIC  9(001).
003260*****02  W-SNM          PIC  N(006).                              D.950615
003270*****02  W-DATE         PIC  9(006).                              D.970711
003280     02  W-DATE         PIC  9(008).                              I.970711
003290     02  W-DATEL REDEFINES W-DATE.                                I.970711
003300       03  F            PIC  9(002).                              I.970711
003310       03  W-DATES      PIC  9(006).                              I.970711
003320     02  W-SSC          PIC  9(001).
003330     02  W-ID1.
003340       03  W-HCD        PIC  9(006).                                C 62/0
003350       03  W-SIZ        PIC  9(001).
003360     02  W-ID2.
003370       03  W-SU         PIC S9(004)       OCCURS  10.
003380       03  W-GS         PIC S9(006).                              I.990407
003390*****  03  W-GS         PIC S9(005).                              D.990407
003400     02  W-NAME         PIC  N(024).                                C 62/0
003410 01  W-DATA.
003420     02  W-NRC          PIC  9(001).                                I.9109
003430     02  W-AIDD.
003440       03  W-AID        PIC  X(117)       OCCURS   6.             I.990407
003450*****  03  W-AID        PIC  X(116)       OCCURS   6.             D.990407
003460*****  03  W-AID        PIC  X(127)       OCCURS   6.             D.950615
003470*****  03  W-AID        PIC  X(115)       OCCURS   6.             D.970110
003480*****  03  W-AID        PIC  X(114)       OCCURS   6.             D.970711
003490     02  W-IDD          PIC  9(007).
003500*****02  W-NGD          PIC  9(004).                              D.970711
003510     02  W-NGD          PIC  9(006).                              I.970711
003520     02  W-NGDD  REDEFINES W-NGD.                                 I.970711
003530       03  W-NEND       PIC  9(004).                              I.970711
003540       03  W-NENDD REDEFINES W-NEND.                              I.970711
003550         04  W-NEND1    PIC  9(002).                              I.970711
003560         04  W-NEND2    PIC  9(002).                              I.970711
003570       03  W-GETD       PIC  9(002).                              I.970711
003580     02  W-NGDSD REDEFINES W-NGD.                                 I.970711
003590       03  F            PIC  9(002).                              I.970711
003600       03  W-NGDS       PIC  9(004).                              I.970711
003610*****02  W-NGP          PIC  9(006).                              D.970711
003620     02  W-NGP          PIC  9(008).                              I.970711
003630     02  W-NGPD  REDEFINES W-NGP.
003640       03  W-NG.
003650*****    04  W-NEN      PIC  9(002).                              D.970711
003660         04  W-NEN      PIC  9(004).                              I.970711
003670         04  W-NENL  REDEFINES W-NEN.                             I.970711
003680           05  W-NEN1   PIC  9(002).                              I.970711
003690           05  W-NEN2   PIC  9(002).                              I.970711
003700         04  W-GET      PIC  9(002).
003710       03  W-PEY        PIC  9(002).
003720     02  W-NGPSD REDEFINES W-NGP.                                 I.970711
003730       03  F            PIC  9(002).                              I.970711
003740       03  W-NGPS       PIC  9(006).                              I.970711
003750*****02  W-UK           PIC  9(006).                              D.970110
003760     02  W-SKC          PIC  9(001).
003770     02  W-SON          PIC  N(006).
003780     02  W-SUD          PIC S9(004).
003790     02  W-HPC          PIC  9(001).                              I.950615
003800     02  W-D.
003810       03  W-NRCD       PIC  9(001).
003820*****  03  W-DATED      PIC  9(006).                              D.970711
003830       03  W-DATED      PIC  9(008).                              I.970711
003840       03  W-SSCD       PIC  9(001).
003850       03  W-HCDD       PIC  9(006).                                C 62/0
003860       03  W-SKCD       PIC  9(001).                              *I 92/07
003870       03  W-HPCD       PIC  9(001).                              I.950615
003880     02  W-BK           PIC S9(008).                                C 62/0
003890     02  W-FK           PIC S9(008).                                C 62/0
003900     02  W-LC.
003910       03  W-L.
003920         04  W-L1       PIC  9(002).
003930         04  W-L2       PIC  9(002).
003940         04  W-L3       PIC  9(002).
003950       03  W-C          PIC  9(002).
003960     02  W-GN           PIC  9(001).
003970     02  CNT            PIC  9(002).
003980     02  W-DMM          PIC  9(001).
003990     02  W-PMCD.                                                  I.950615
004000       03  W-PMC        PIC  9(001)       OCCURS   6.             I.950615
004010     02  W-BIT.
004020       03  W-BITD       PIC  9(001)       OCCURS  10.
004030     02  W-EC           PIC  9(001).
004040*****02  W-NCMA         PIC  N(020) VALUE                         D.960918
004050*****     NC"検査あがり成型あがり外注・仕入倉庫間移動".           D.960918
004060*****02  W-NCMA         PIC  N(020) VALUE SPACE.                  D.971028
004070     02  W-NCMA         PIC  N(025) VALUE SPACE.                  I.971028
004080     02  W-NCMD  REDEFINES W-NCMA.
004090       03  W-NCM        PIC  N(005)       OCCURS   5.             I.971028
004100*****  03  W-NCM        PIC  N(005)       OCCURS   4.             D.971028
004110     02  CHK            PIC  9(001) VALUE ZERO.
004120     02  W-PAGE         PIC  9(002) VALUE ZERO.
004130     02  W-POC          PIC  9(001) VALUE ZERO.
004140     02  W-END          PIC  9(001) VALUE ZERO.                   I.960918
004150*****02  SV-HINCD.                                                D.970110
004160*****    03  SV-HCD     PIC  9(06)  OCCURS 6.                     D.970110
004170     02  WK-UNO         PIC  9(006).
004180     02  W-FHCD         PIC  9(006) VALUE ZERO.                   I.970110
004190     02  W-DC           PIC  9(004).                              I.981215
004200     02  W-DEC          PIC  9(001).                              I.010117
004210     02  W-FT           PIC  9(005).                              I.020216
004220     02  W-ERR          PIC  9(001).                              I.020216
004230     02  W-SNGP.                                                  I.020318
004240       03  W-SNEN       PIC  9(002).                              I.020318
004250       03  W-SGET       PIC  9(002).                              I.020318
004260       03  W-SPEY       PIC  9(002).                              I.020318
004270 01  G-AREA.                                                      *I 92/07
004280     02  G-GS           PIC S9(006).                              I.990407
004290*****02  G-GS           PIC S9(005).                              D.990407
004300     02  G-BK           PIC S9(008).                              *I 92/07
004310     02  G-FK           PIC S9(008).                              *I 92/07
004320 01  WA-D.                                                        I.010117
004330     02  WA-GS          PIC S9(006).                              I.010117
004340     02  WA-BK          PIC S9(008).                              I.010117
004350     02  WA-FK          PIC S9(008).                              I.010117
004360     COPY LSTAT.
004370     COPY LWMSG.
004380 SCREEN SECTION.
004390 SD  C-CRT
004400     END STATUS IS ESTAT.
004410 01  C-CLEAR.
004420     02  LINE   1 CLEAR SCREEN.
004430 01  C-MID.
004440     02  LINE   3  COLUMN  10  PIC  N(020) VALUE                  I.910919
004450          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.910919
004460     02  LINE   4  COLUMN  10  PIC  N(020) VALUE                  I.910919
004470          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.910919
004480     02  LINE   5  COLUMN  10  PIC  N(020) VALUE                  I.910919
004490          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.910919
004500     02  LINE   6  COLUMN  10  PIC  N(020) VALUE                  I.910919
004510          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.010105
004520*****     NC"＊＊＊　　仕上・受入伝票　入力　　＊＊＊".           D.010105
004530*****     NC"＊＊＊　　仕上・受入確定　入力　　＊＊＊".           D.970110
004540     02  LINE   7  COLUMN  10  PIC  N(020) VALUE                  I.910919
004550          NC"＊＊＊　　　　　　　　　　　　　　＊＊＊".           I.910919
004560     02  LINE   8  COLUMN  10  PIC  N(020) VALUE                  I.910919
004570          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.910919
004580     02  LINE   9  COLUMN  10  PIC  N(020) VALUE                  I.910919
004590          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".           I.910919
004600*****02  LINE  12.                                                D.010105
004610*****  03  COLUMN  16  PIC  N(005) VALUE NC"検査あがり".          D.960918
004620*****  03  COLUMN  16  PIC  N(005) FROM  W-NCM(1).                D.010105
004630*****  03  COLUMN  26  PIC  X(004) VALUE " = 1".                  D.010105
004640*****02  LINE  13.                                                D.010105
004650*****  03  COLUMN  16  PIC  N(005) VALUE NC"成型あがり".          D.960918
004660*****  03  COLUMN  16  PIC  N(005) FROM  W-NCM(2).                D.010105
004670*****  03  COLUMN  26  PIC  X(004) VALUE " = 2".                  D.010105
004680*****02  LINE  14  COLUMN  16  PIC  X(014) VALUE                  D.960918
004690*****     "外注・仕入 = 3".                                       D.960918
004700*****02  LINE  14.                                                D.010105
004710*****  03  COLUMN  16  PIC  N(005) FROM  W-NCM(3).                D.010105
004720*****  03  COLUMN  26  PIC  X(004) VALUE " = 3".                  D.010105
004730*****02  LINE  15.                                                D.010105
004740*****  03  COLUMN  16  PIC  N(005) VALUE NC"倉庫間移動".          D.960918
004750*****  03  COLUMN  16  PIC  N(005) FROM  W-NCM(4).                D.010105
004760*****  03  COLUMN  26  PIC  X(004) VALUE " = 4".                  D.010105
004770*****02  LINE  16.                                                D.010105
004780*****  03  COLUMN  16  PIC  N(005) FROM  W-NCM(5).                D.010105
004790*****  03  COLUMN  26  PIC  X(004) VALUE " = 5".                  D.010105
004800*****02  LINE  16  COLUMN  16  PIC  X(028) VALUE                  D.971028
004810*****02  LINE  17  COLUMN  16  PIC  X(028) VALUE                  D.010105
004820*****     "終　　　了 = 9 .......  ﾘﾀｰﾝ".                         D.010105
004830     02  LINE  23  COLUMN  33  PIC  X(022) VALUE                  I.910919
004840          "確認  OK=1 NO=9   ﾘﾀｰﾝ".                               I.910919
004850 01  C-ACP.
004860*****02  A-NRC   LINE  16  COLUMN  39  PIC  9(001)                D.971028
004870     02  A-NRC   LINE  17  COLUMN  39  PIC  9(001)                I.971028
004880          USING W-NRC   CHECK OVERFLOW NO IFC.                    I.910919
004890*****02  A-UNO   LINE   3  COLUMN  11  PIC  9(006)                D.970110
004900*****     USING W-UK    CHECK OVERFLOW NO IFC.                    D.970110
004910     02  A-DATE  LINE   3  COLUMN  23  PIC  9(006)
004920          USING W-NGPS  CHECK OVERFLOW NO IFC.                    I.970711
004930*****     USING W-NGP   CHECK OVERFLOW NO IFC.                    D.970711
004940     02  A-SCD   LINE   3  COLUMN  35  PIC  9(001)
004950          USING W-SKC   CHECK OVERFLOW NO IFC.
004960*****02  D-SNM   LINE   3  COLUMN  37  PIC  N(006)                D.950615
004970*****     USING W-SON   CHECK OVERFLOW NO IFC.                    D.950615
004980     02  LINE W-L1.
004990       03  A-HCD   COLUMN   9  PIC  9(006)                        I.011031
005000            USING W-HCD   CHECK OVERFLOW NO IFC.                  I.011030
005010*****  03  A-SK    COLUMN   9  PIC  9(001)                        D.011031
005020       03  A-SK    COLUMN  75  PIC  9(001)                        I.011031
005030            USING W-SSC   CHECK OVERFLOW NO IFC.
005040*****  03  A-HCD   COLUMN  16  PIC  9(006)                        D.011031
005050*****       USING W-HCD   CHECK OVERFLOW NO IFC.                  D.011030
005060     02  LINE W-L3.
005070       03  A-SIZ   COLUMN   5  PIC  9(001)
005080            USING W-SIZ   CHECK OVERFLOW NO IFC.
005090       03  A-SU    COLUMN W-C  PIC S9(004)
005100            USING W-SUD   CHECK OVERFLOW NO IFC.
005110     02  A-HPC   LINE  22  COLUMN  20  PIC  9(001)                I.950615
005120          USING W-HPC   CHECK OVERFLOW NO IFC.                    I.950615
005130     02  A-DMM   LINE  23  COLUMN  50  PIC  9(001)
005140          USING W-DMM   CHECK OVERFLOW NO IFC.
005150 01  C-DSP.
005160     02  D-MID1.                                                  I.010105
005170       03  LINE   6  COLUMN  10  PIC  N(020) VALUE                I.010105
005180            NC"＊＊＊　　仕上・受入伝票　入力　　＊＊＊".         I.010105
005190       03  LINE  12.                                              I.010105
005200         04  COLUMN  16  PIC  N(005) FROM  W-NCM(1).              I.010105
005210         04  COLUMN  26  PIC  X(004) VALUE " = 1".                I.010105
005220*****  03  LINE  13.                                              D.070322
005230*****    04  COLUMN  16  PIC  N(005) FROM  W-NCM(2).              D.070322
005240*****    04  COLUMN  26  PIC  X(004) VALUE " = 2".                D.070322
005250       03  LINE  14.                                              I.010105
005260         04  COLUMN  16  PIC  N(005) FROM  W-NCM(3).              I.010105
005270         04  COLUMN  26  PIC  X(004) VALUE " = 3".                I.010105
005280*****  03  LINE  15.                                              D.060620
005290*****    04  COLUMN  16  PIC  N(005) FROM  W-NCM(4).              D.060620
005300*****    04  COLUMN  26  PIC  X(004) VALUE " = 4".                D.060620
005310*****  03  LINE  16.                                              D.060620
005320*****    04  COLUMN  16  PIC  N(005) FROM  W-NCM(5).              D.060620
005330*****    04  COLUMN  26  PIC  X(004) VALUE " = 5".                D.060620
005340       03  LINE  16.                                              I.070322
005350         04  COLUMN  16  PIC  N(005) FROM  W-NCM(5).              I.070322
005360         04  COLUMN  26  PIC  X(004) VALUE " = 5".                I.070322
005370       03  LINE  17 COLUMN  16  PIC  X(028) VALUE                 I.010105
005380            "終　　　了 = 9 .......  ﾘﾀｰﾝ".                       I.010105
005390     02  D-MID2  LINE   6  COLUMN  10  PIC  N(020) VALUE          I.010105
005400          NC"＊＊＊　　製品仕入　変換処理　　　＊＊＊".           I.060605
005410*****     NC"＊＊＊　　仕入・製造　変換処理　　＊＊＊".           D.060605
005420*****     NC"＊＊＊　　製品仕入　変換処理　　　＊＊＊".           D.020126
005430     02  D-NCM   LINE   3  COLUMN  67  PIC  N(005) FROM
005440          W-NCM(W-NRC) REVERSE.
005450     02  D-SNM   LINE   3  COLUMN  37  PIC  N(006) FROM  W-SON.   I.950615
005460     02  LINE W-L1.
005470       03  D-NAME  COLUMN  21  PIC  N(024) FROM  W-NAME.          I.011031
005480*****  03  D-NAME  COLUMN  28  PIC  N(024) FROM  W-NAME.          D.011031
005490     02  LINE W-L2.
005500       03  D-TBL1.
005510         04  COLUMN   9  PIC  N(002) VALUE NC"３号".
005520         04  COLUMN  15  PIC  N(002) VALUE NC"２号".
005530         04  COLUMN  21  PIC  N(002) VALUE NC"１号".
005540         04  COLUMN  27  PIC  N(002) VALUE NC"０号".
005550         04  COLUMN  34  PIC  X(005) VALUE "  中 ".
005560         04  COLUMN  40  PIC  X(005) VALUE "  大 ".
005570         04  COLUMN  45  PIC  N(002) VALUE NC"特大".
005580         04  COLUMN  51  PIC  X(005) VALUE "28.0 ".
005590         04  COLUMN  57  PIC  X(005) VALUE "29.0 ".
005600         04  COLUMN  63  PIC  X(005) VALUE "30.0 ".
005610       03  D-TBL2.
005620         04  COLUMN   9  PIC  X(005) VALUE "12.5 ".
005630         04  COLUMN  15  PIC  X(005) VALUE "13.0 ".
005640         04  COLUMN  21  PIC  X(005) VALUE "13.5 ".
005650         04  COLUMN  27  PIC  X(005) VALUE "14.0 ".
005660         04  COLUMN  33  PIC  X(005) VALUE "15.0 ".
005670         04  COLUMN  39  PIC  X(005) VALUE "16.0 ".
005680         04  COLUMN  45  PIC  X(005) VALUE "17.0 ".
005690         04  COLUMN  51  PIC  X(005) VALUE "18.0 ".
005700         04  COLUMN  57  PIC  X(005) VALUE "19.0 ".
005710         04  COLUMN  63  PIC  X(005) VALUE "20.0 ".
005720       03  D-TBL3.
005730         04  COLUMN   9  PIC  X(005) VALUE "21.0 ".
005740         04  COLUMN  15  PIC  X(005) VALUE "21.5 ".
005750         04  COLUMN  21  PIC  X(005) VALUE "22.0 ".
005760         04  COLUMN  27  PIC  X(005) VALUE "22.5 ".
005770         04  COLUMN  33  PIC  X(005) VALUE "23.0 ".
005780         04  COLUMN  39  PIC  X(005) VALUE "23.5 ".
005790         04  COLUMN  45  PIC  X(005) VALUE "24.0 ".
005800         04  COLUMN  51  PIC  X(005) VALUE "24.5 ".
005810         04  COLUMN  57  PIC  X(005) VALUE "25.0 ".
005820         04  COLUMN  63  PIC  X(005) VALUE "     ".
005830       03  D-TBL4.
005840         04  COLUMN   9  PIC  X(005) VALUE "24.0 ".
005850         04  COLUMN  15  PIC  X(005) VALUE "24.5 ".
005860         04  COLUMN  21  PIC  X(005) VALUE "25.0 ".
005870         04  COLUMN  27  PIC  X(005) VALUE "25.5 ".
005880         04  COLUMN  33  PIC  X(005) VALUE "26.0 ".
005890         04  COLUMN  39  PIC  X(005) VALUE "26.5 ".
005900         04  COLUMN  45  PIC  X(005) VALUE "27.0 ".
005910         04  COLUMN  51  PIC  X(005) VALUE "27.5 ".
005920         04  COLUMN  57  PIC  X(005) VALUE "     ".
005930         04  COLUMN  63  PIC  X(005) VALUE "     ".
005940     02  LINE W-L3.
005950       03  D-SU    COLUMN W-C  PIC ZZZZ-     FROM  W-SUD.
005960       03  D-GS    COLUMN  70  PIC ---,---   FROM  W-GS.          I.970110
005970       03  D-SU1   COLUMN   9  PIC ZZZZ-     FROM  W-SU(1).       I.981215
005980       03  D-SU2   COLUMN  15  PIC ZZZZ-     FROM  W-SU(2).       I.981215
005990       03  D-SU3   COLUMN  21  PIC ZZZZ-     FROM  W-SU(3).       I.981215
006000       03  D-SU4   COLUMN  27  PIC ZZZZ-     FROM  W-SU(4).       I.981215
006010       03  D-SU5   COLUMN  33  PIC ZZZZ-     FROM  W-SU(5).       I.981215
006020       03  D-SU6   COLUMN  39  PIC ZZZZ-     FROM  W-SU(6).       I.981215
006030       03  D-SU7   COLUMN  45  PIC ZZZZ-     FROM  W-SU(7).       I.981215
006040       03  D-SU8   COLUMN  51  PIC ZZZZ-     FROM  W-SU(8).       I.981215
006050       03  D-SU9   COLUMN  57  PIC ZZZZ-     FROM  W-SU(9).       I.981215
006060       03  D-SU10  COLUMN  63  PIC ZZZZ-     FROM  W-SU(10).      I.981215
006070     02  D-PRN   LINE   1  COLUMN  19  PIC  N(021) VALUE          I.981215
006080          NC"＊＊＊　　仕上・受入　入力リスト　　＊＊＊".         I.981215
006090*****  03  D-GS    COLUMN  69  PIC ----,---  FROM  W-GS.          D.970110
006100*01  D-SUR.                                                       D.981215
006110*****  03  D-SU1  LINE  W-L3  COLUMN   9  PIC ZZZZ-  FROM W-SU(1).D.981215
006120*****  03  D-SU2  LINE  W-L3  COLUMN  15  PIC ZZZZ-  FROM W-SU(2).D.981215
006130*****  03  D-SU3  LINE  W-L3  COLUMN  21  PIC ZZZZ-  FROM W-SU(3).D.981215
006140*****  03  D-SU4  LINE  W-L3  COLUMN  27  PIC ZZZZ-  FROM W-SU(4).D.981215
006150*****  03  D-SU5  LINE  W-L3  COLUMN  33  PIC ZZZZ-  FROM W-SU(5).D.981215
006160*****  03  D-SU6  LINE  W-L3  COLUMN  39  PIC ZZZZ-  FROM W-SU(6).D.981215
006170*****  03  D-SU7  LINE  W-L3  COLUMN  45  PIC ZZZZ-  FROM W-SU(7).D.981215
006180*****  03  D-SU8  LINE  W-L3  COLUMN  51  PIC ZZZZ-  FROM W-SU(8).D.981215
006190*****  03  D-SU9  LINE  W-L3  COLUMN  57  PIC ZZZZ-  FROM W-SU(9).D.981215
006200*****  03  D-SU10 LINE  W-L3  COLUMN  63  PIC ZZZZ- FROM W-SU(10).D.981215
006210 01  C-SPC.
006220     02  S-SPACE.
006230       03  LINE W-L1.
006240*****    04  S-SK    COLUMN   9  PIC  X(001) VALUE " ".           D.011031
006250*****    04  S-HCD   COLUMN  16  PIC  X(006) VALUE "      ".      D.011031
006260*****    04  S-NAME  COLUMN  28  PIC  X(048) VALUE                D.011031
006270         04  S-HCD   COLUMN   9  PIC  X(006) VALUE "      ".      I.011031
006280         04  S-NAME  COLUMN  21  PIC  X(048) VALUE                I.011031
006290              "                                                ".
006300         04  S-SK    COLUMN  75  PIC  X(001) VALUE " ".           I.011031
006310       03  LINE W-L2.
006320         04  COLUMN   9  PIC  X(005) VALUE "     ".
006330         04  COLUMN  15  PIC  X(005) VALUE "     ".
006340         04  COLUMN  21  PIC  X(005) VALUE "     ".
006350         04  COLUMN  27  PIC  X(005) VALUE "     ".
006360         04  COLUMN  33  PIC  X(005) VALUE "     ".
006370         04  COLUMN  39  PIC  X(005) VALUE "     ".
006380         04  COLUMN  45  PIC  X(005) VALUE "     ".
006390         04  COLUMN  51  PIC  X(005) VALUE "     ".
006400         04  COLUMN  57  PIC  X(005) VALUE "     ".
006410         04  COLUMN  63  PIC  X(005) VALUE "     ".
006420       03  LINE W-L3.
006430         04  S-SIZ   COLUMN   5  PIC  X(001) VALUE " ".
006440         04          COLUMN   9  PIC  X(005) VALUE "     ".
006450         04          COLUMN  15  PIC  X(005) VALUE "     ".
006460         04          COLUMN  21  PIC  X(005) VALUE "     ".
006470         04          COLUMN  27  PIC  X(005) VALUE "     ".
006480         04          COLUMN  33  PIC  X(005) VALUE "     ".
006490         04          COLUMN  39  PIC  X(005) VALUE "     ".
006500         04          COLUMN  45  PIC  X(005) VALUE "     ".
006510         04          COLUMN  51  PIC  X(005) VALUE "     ".
006520         04          COLUMN  57  PIC  X(005) VALUE "     ".
006530         04          COLUMN  63  PIC  X(005) VALUE "     ".
006540         04  S-GS    COLUMN  69  PIC  X(008) VALUE "        ".
006550     02  LINE W-L3.
006560       03  S-SU    COLUMN W-C  PIC  X(005) VALUE "     ".
006570 01  C-ERR.
006580     02  LINE  24.
006590*****  03  E-ME1   COLUMN  15  PIC  X(016) VALUE                  D.020216
006600       03  E-ME1.                                                 I.020216
006610         04  COLUMN  15  PIC  X(016) VALUE                        I.020216
006620              "***  HIM ﾅｼ  ***".
006630         04  COLUMN  35  PIC  9(006) FROM  HI-HCD.                I.020216
006640       03  E-ME2   COLUMN  15  PIC  X(021) VALUE
006650            "***  PROGRAM ｴﾗｰ  ***".
006660*****  03  E-ME3   COLUMN  15  PIC  X(024) VALUE                  D.960730
006670*****       "***  振替 単価 ZERO  ***".                           D.960730
006680       03  E-ME3   COLUMN  15  PIC  X(026) VALUE                  I.960730
006690            "***  振替 単価 未決定  ***".                         I.960730
006700       03  E-ME4   COLUMN  15  PIC  X(019) VALUE
006710            "***  ﾈﾝｹﾞﾂ ｴﾗｰ  ***".
006720       03  E-ME5   COLUMN  15  PIC  X(018) VALUE
006730            "***  ｸﾌﾞﾝ ｴﾗｰ  ***".
006740       03  E-ME6   COLUMN  15  PIC  N(011) VALUE
006750            NC"コントロールＦ　未登録".
006760       03  E-ME7   COLUMN  15  PIC  N(007) VALUE
006770            NC"倉庫名　未登録".
006780       03  E-ME8   COLUMN  15  PIC  N(009) VALUE                  I.950208
006790            NC"未更新データ　有り".                               I.950208
006800       03  E-ME9   COLUMN  15  PIC  X(021) VALUE                  I.960918
006810            "***  ｸﾌﾞﾝﾏｽﾀｰ ﾅｼ  ***".                              I.960918
006820       03  E-ME11  COLUMN  15  PIC  X(019) VALUE                  I.970110
006830            "***  WRITE ｴﾗｰ  ***".                                I.970110
006840       03  E-ME12  COLUMN  15  PIC  X(027) VALUE                  I.970110
006850            "***  JCON ﾃﾞﾝﾋﾟｮｳNO ﾅｼ  ***".                        I.970110
006860       03  E-ME13  COLUMN  15  PIC  X(026) VALUE                  I.970110
006870            "***  JCON REWRITE ｴﾗｰ  ***".                         I.970110
006880       03  E-ME14  COLUMN  15  PIC  X(026) VALUE                  I.010105
006890            "***  HSSF REWRITE ｴﾗｰ  ***".                         I.010105
006900*****  03  E-ME15  COLUMN  15  PIC  X(027) VALUE                  D.060605
006910*****       "***  HSKDF REWRITE ｴﾗｰ  ***".                        D.060605
006920*****  03  E-ME16.                                                D.060605
006930*****    04  COLUMN  15  PIC  X(018) VALUE                        D.060605
006940*****         "***  HSKDF ﾅｼ  ***".                               D.060605
006950*****    04  COLUMN  35  PIC  X(021) FROM  HSKW-KEY.              D.060605
006960*****  03  E-ME17  COLUMN  15  PIC  X(025) VALUE                  D.060605
006970*****       "***  UTRAN ｾｲｹｲ ﾁｪｯｸ  ***".                          D.060605
006980       03  E-ME18.                                                I.020216
006990         04  COLUMN  15  PIC  X(017) VALUE                        I.020216
007000              "***  HUHM ﾅｼ  ***".                                I.020126
007010         04  COLUMN  35  PIC  9(006) FROM  HUH-HCD.               I.020216
007020       03  E-ME19  COLUMN  32  PIC  X(032) VALUE                  I.020216
007030            "***  品名マスタ　原価エラー  ***".                   I.020216
007040       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
007050       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
007060       03  E-CL    COLUMN  10  PIC  X(050) VALUE
007070            "                                                  ".
007080     COPY LIBSCR.
007090     COPY LSMSG.
007100 PROCEDURE DIVISION.
007110 M-020.
007120     ACCEPT JS-SIGN.                                              I.010105
007130     IF JS-SIGN > 1                                               I.010105
007140         MOVE 255 TO COMPLETION-CODE                              I.010105
007150         STOP RUN.                                                I.010105
007160     COPY LIBCPR.
007170     MOVE DATE-02R TO H-DATE.
007180     MOVE ZERO TO W-NGD.                                          I.970711
007190     MOVE D-NHNG TO W-NGDS.                                       I.970711
007200     IF W-NEND2 >= DATE-NF1 AND <= DATE-NT1                       I.970711
007210         ADD DATE-NC1 TO W-NEND.                                  I.970711
007220     IF W-NEND2 >= DATE-NF2 AND <= DATE-NT2                       I.970711
007230         ADD DATE-NC2 TO W-NEND.                                  I.970711
007240*****MOVE D-NHNG TO W-NGD.                                        D.970711
007250*
007260     DISPLAY C-CLEAR.                                             I.950208
007270     DISPLAY C-MID.                                               I.950208
007280     IF JS-SIGN = 0                                               I.010105
007290         DISPLAY D-MID1                                           I.010105
007300       ELSE                                                       I.010105
007310         MOVE W-MID1 TO H-MID                                     I.010105
007320         DISPLAY D-MID2.                                          I.010105
007330*****OPEN INPUT HN-UTRN.                                          D.970110
007340*****READ HN-UTRN AT END                                          D.970110
007350*****    CLOSE HN-UTRN                                            D.970110
007360*
007370     OPEN INPUT UTRAN.                                            I.970110
007380     READ UTRAN AT END                                            I.970110
007390         CLOSE UTRAN                                              I.970110
007400         GO TO M-040.                                             I.950208
007410     DISPLAY  E-ME8 E-ME99.                                       I.950208
007420     CLOSE UTRAN.                                                 I.970110
007430*****CLOSE HN-UTRN.                                               D.970110
007440*****GO TO M-020.                                                 D.950705
007450     MOVE 255 TO COMPLETION-CODE.                                 I.010105
007460     DISPLAY C-CLEAR.                                             I.950705
007470     STOP RUN.                                                    I.950705
007480 M-040.                                                           I.950208
007490     IF JS-SIGN = 1                                               I.010105
007500         GO TO M-070.                                             I.030613
007510*****    GO TO M-060.                                             D.030613
007520     OPEN INPUT HKBM.                                             I.960918
007530     PERFORM HKB-RTN THRU HKB-EX.                                 I.960918
007540     IF W-END = 9                                                 I.960918
007550         DISPLAY E-ME9 E-ME99                                     I.960918
007560         CLOSE HKBM                                               I.960918
007570         DISPLAY C-CLEAR                                          I.960918
007580         STOP RUN.                                                I.960918
007590*M-060.                                                           D.030613
007600*****MOVE ZERO TO W-D.                                            D.030613
007610*****INITIALIZE  G-AREA.                                          D.030613
007620*****OPEN INPUT HI-M.                                             D.010105
007630     OPEN I-O JCON.                                               I.970110
007640*****OPEN OUTPUT UTRAN.                                           D.010105
007650*****OPEN I-O JCON  HN-SUSZ.                                      D.970110
007660*****OPEN EXTEND SU-F.                                            D.970110
007670*****OPEN OUTPUT HN-UTRN.                                         D.970110
007680*M-061.                                                           D.010105
007690*****DISPLAY E-CL.                                                D.010105
007700     MOVE "18" TO JCON5-KEY.
007710     READ JCON UNLOCK INVALID
007720         CLOSE HKBM                                               I.010105
007730         CLOSE JCON                                               I.010105
007740         DISPLAY E-ME6 DISP-BUZ-B
007750         MOVE 255 TO COMPLETION-CODE                              I.010105
007760         STOP RUN.                                                I.010105
007770*****    GO TO M-061.                                             D.010105
007780 M-070.                                                           I.030613
007790     MOVE ZERO TO W-D.                                            I.030613
007800     INITIALIZE  G-AREA.                                          I.030613
007810     OPEN INPUT HI-M.                                             I.010105
007820     OPEN INPUT HUH-M.                                            I.020216
007830     OPEN OUTPUT UTRAN.                                           I.010105
007840 M-080.
007850     DISPLAY C-CLEAR.
007860     DISPLAY C-MID.
007870     IF JS-SIGN = 0                                               I.010105
007880         DISPLAY D-MID1                                           I.010105
007890       ELSE                                                       I.010505
007900         DISPLAY D-MID2                                           I.010105
007910         GO TO M-120.                                             I.010105
007920 M-100.
007930     ACCEPT A-NRC.
007940     IF ESTAT NOT = HTB AND SKP
007950         GO TO M-100.
007960*****IF W-NRC NOT = 1 AND 2 AND 3 AND 4 AND 9                     D.971028
007970*****IF W-NRC NOT = 1 AND 2 AND 3 AND 4 AND 5 AND 9               D.060620
007980*****IF W-NRC NOT = 1 AND 2 AND 3 AND 9                           D.070322
007990     IF W-NRC NOT = 1 AND 3 AND 5 AND 9                           I.070322
008000         GO TO M-100.
008010 M-120.
008020     ACCEPT A-DMM.
008030     IF JS-SIGN = 0                                               I.010105
008040         IF ESTAT = BTB
008050             GO TO M-100.
008060     IF ESTAT NOT = HTB AND SKP
008070         GO TO M-120.
008080     IF W-DMM = 9
008090         IF JS-SIGN = 1                                           I.010105
008100             CLOSE HI-M                                           I.010105
008110             CLOSE HUH-M                                          I.020216
008120*****        CLOSE JCON                                           D.030613
008130             CLOSE UTRAN                                          I.010105
008140             MOVE 255 TO COMPLETION-CODE                          I.010105
008150             DISPLAY C-CLEAR                                      I.010105
008160             STOP RUN                                             I.010105
008170           ELSE                                                   I.010105
008180             GO TO M-100.
008190     IF W-DMM NOT = 1
008200         GO TO M-120.
008210     IF JS-SIGN = 1                                               I.010105
008220         GO TO M-680.                                             I.010105
008230*-------------------------------------------------------------------------
008240     IF W-NRC = 9
008250         GO TO M-800.                                             I.981215
008260*****    GO TO M-980.                                             D.981215
008270     MOVE ZERO TO W-D.
008280 M-200.
008290*****CALL "SH160I".                                               D.970110
008300     CALL "SCHD31".                                               I.970110
008310     DISPLAY D-NCM.
008320*M-201.                                                           D.020128
008330     MOVE ZERO TO W-AIDD.
008340*****ACCEPT A-UNO.                                                D.970110
008350*****DISPLAY DISP-MSG-SPACE.                                      D.970110
008360*****IF ESTAT = C2                                                D.970110
008370*****    GO TO M-980.                                             D.970110
008380*****IF ESTAT = BTB                                               D.970110
008390*****    GO TO M-080.                                             D.970110
008400*****IF ESTAT NOT = HTB AND SKP                                   D.970110
008410*****    GO TO M-201.                                             D.970110
008420*****IF W-UK  = ZERO                                              D.970110
008430*****    GO TO M-220.                                             D.970110
008440***
008450*****MOVE ZERO    TO SV-HINCD.                                    D.970110
008460*****MOVE 0       TO W-GN.                                        D.970110
008470*****MOVE 4       TO W-L1 W-L2 W-L3.                              D.970110
008480*****ADD  1       TO W-L2.                                        D.970110
008490*****ADD  2       TO W-L3.                                        D.970110
008500*****MOVE W-UK    TO SUSZ-011.                                    D.970110
008510*****MOVE 0       TO SUSZ-012.                                    D.970110
008520*****START HN-SUSZ KEY NOT < SUSZ-KEY                             D.970110
008530*****     INVALID DISPLAY INV-D01 GO TO M-204.                    D.970110
008540*M-202.                                                           D.970110
008550*****READ HN-SUSZ NEXT UNLOCK AT END GO TO M-204.                 D.970110
008560*****IF W-UK  NOT = SUSZ-011                                      D.970110
008570*****    GO TO M-204.                                             D.970110
008580*****IF W-NRC  NOT = SUSZ-10                                      D.970110
008590*****    DISPLAY E-ME5 GO TO M-201.                               D 920804
008600*****    DISPLAY E-ME5 DISP-BUZ-B.                                D.970110
008610*
008620*****MOVE SUSZ-012 TO W-GN.                                       D.970110
008630*****IF  W-GN     > 1                                             D.970110
008640*****     GO TO M-203.                                            D.970110
008650*****MOVE W-UK    TO W-UNO.                                       D.970110
008660*****MOVE SUSZ-03 TO W-NGP.                                       D.970110
008670*****MOVE 3       TO JCON3-01.                                    D.970110
008680*****MOVE SUSZ-04 TO JCON3-02 W-SKC.                              D.970110
008690*****READ JCON UNLOCK INVALID                                     D.970110
008700*****     MOVE SPACE  TO JCON3-03.                                D.970110
008710*****MOVE JCON3-03 TO W-SON.                                      D.970110
008720*****DISPLAY A-DATE A-SCD D-SNM.                                  D.970110
008730*M-203.                                                           D.970110
008740*****MOVE SUSZ-05 TO W-SSC.                                       D.970110
008750*****MOVE SUSZ-06 TO HI-KEY W-HCD  SV-HCD(W-GN).                  D.970110
008760*****READ HI-M UNLOCK INVALID                                     D.970110
008770*****     MOVE SPACE   TO HI-NAME.                                D.970110
008780*****MOVE HI-NAME TO W-NAME.                                      D.970110
008790*****MOVE SUSZ-07 TO W-SIZ.                                       D.970110
008800*****MOVE SUSZ-081(1) TO W-SU(1).                                 D.970110
008810*****MOVE SUSZ-081(2) TO W-SU(2).                                 D.970110
008820*****MOVE SUSZ-081(3) TO W-SU(3).                                 D.970110
008830*****MOVE SUSZ-081(4) TO W-SU(4).                                 D.970110
008840*****MOVE SUSZ-081(5) TO W-SU(5).                                 D.970110
008850*****MOVE SUSZ-081(6) TO W-SU(6).                                 D.970110
008860*****MOVE SUSZ-081(7) TO W-SU(7).                                 D.970110
008870*****MOVE SUSZ-081(8) TO W-SU(8).                                 D.970110
008880*****MOVE SUSZ-081(9) TO W-SU(9).                                 D.970110
008890*****MOVE SUSZ-081(10) TO W-SU(10).                               D.970110
008900*****COMPUTE W-GS = W-SU(1) + W-SU(2) + W-SU(3) + W-SU(4) +       D.970110
008910*****               W-SU(5) + W-SU(6) + W-SU(7) + W-SU(8) +       D.970110
008920*****               W-SU(9) + W-SU(10).                           D.970110
008930*****MOVE W-ID   TO W-AID(W-GN).                                  D.970110
008940*****PERFORM BIT-RTN THRU BIT-EX.                                 D.970110
008950*****DISPLAY A-SK A-HCD D-NAME A-SIZ D-SUR D-GS.                  D.970110
008960*****ADD  3      TO W-L1 W-L2 W-L3.                               D.970110
008970*****GO TO M-202.                                                 D.970110
008980*M-204.                                                           D.970110
008990*****IF W-GN  NOT = 0    GO TO M-220.                             D.970110
009000*****DISPLAY  INV-D01.                                            D.970110
009010*****GO TO M-201.                                                 D.970110
009020 M-220.
009030     ACCEPT A-DATE.
009040     DISPLAY DISP-MSG-SPACE.
009050*****IF ESTAT = C2                                                D.981013
009060     IF ESTAT = C2 OR PF9                                         I.981013
009070         GO TO M-800.                                             I.981215
009080*****    GO TO M-980.                                             D.981215
009090     IF ESTAT = BTB
009100         GO TO M-080.                                             I.970110
009110*****    GO TO M-201.                                             D.970110
009120     IF ESTAT NOT = HTB AND SKP
009130         GO TO M-220.
009140*****IF W-NGP = ZERO                                              D.970711
009150*****    MOVE DATE-02R TO W-NGP                                   D.970711
009160     IF W-NGPS = ZERO                                             I.970711
009170         MOVE DATE-02R TO W-NGPS                                  I.970711
009180         DISPLAY A-DATE.                                          I.950615
009190*****IF W-NEN < 90                                                D.940729
009200*****    GO TO M-220.                                             D.940729
009210     IF W-GET < 1 OR > 12
009220         GO TO M-220.
009230     IF W-PEY < 1 OR > 31
009240         GO TO M-220.
009250     MOVE ZERO TO W-NEN1.                                         I.970711
009260     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.970711
009270         ADD DATE-NC1 TO W-NEN.                                   I.970711
009280     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.970711
009290         ADD DATE-NC2 TO W-NEN.                                   I.970711
009300     IF W-NG NOT = W-NGD
009310         DISPLAY E-ME4 E-ME98
009320         GO TO M-220.
009330*M-221.                                                           D.020128
009340*****IF W-UNO NOT = ZERO                                          D 920616
009350*****    GO TO M-260.                                             D   :
009360*****IF W-NRC = 2                                                 D   :
009370*****    MOVE 0     TO W-SCD                                      D   :
009380*****    MOVE SPACE TO W-SNM                                      D   :
009390*****    DISPLAY A-SCD D-SNM                                      D   :
009400*****    GO TO M-260.                                             D 920616
009410*****IF  W-NRC NOT = 2                                            D.970110
009420*****    IF   W-UNO     = ZERO  GO TO M-240                       D.970110
009430*****    ELSE                   GO TO M-260.                      D.970110
009440*****MOVE  0      TO  W-SCD W-SKC.                                D.970110
009450*****MOVE  SPACE  TO  W-SNM W-SON.                                D.950615
009460*****MOVE  SPACE  TO  W-SON.                                      D.970110
009470*****DISPLAY  A-SCD D-SNM.                                        D.970110
009480*****IF  W-NRC = 2                                                D.971028
009490*****IF W-NRC = 2 OR 5                                            D.060620
009500*****IF W-NRC = 2                                                 D.070322
009510*****    MOVE 0 TO  W-SCD W-SKC                                   D.070322
009520*****    MOVE SPACE  TO  W-SON                                    D.070322
009530*****    DISPLAY A-SCD D-SNM                                      D.070322
009540*****    GO TO M-260.                                             D.070322
009550 M-240.
009560     ACCEPT A-SCD.
009570     DISPLAY DISP-MSG-SPACE.
009580     IF ESTAT = BTB
009590         GO TO M-220.
009600     IF ESTAT NOT = HTB AND SKP
009610         GO TO M-240.
009620     IF W-SKC = 9                                                 I.040303
009630         GO TO M-240.                                             I.040303
009640     MOVE 3 TO JCON3-01.
009650     MOVE W-SKC TO JCON3-02.
009660     READ JCON UNLOCK INVALID
009670         DISPLAY E-ME7
009680         GO TO M-240.
009690     MOVE JCON3-03 TO W-SON.
009700     DISPLAY D-SNM.
009710     MOVE W-SKC TO W-SCD.
009720*****MOVE W-SON TO W-SNM.                                         D.950615
009730 M-260.
009740*****IF W-UK NOT = ZERO                                           D.970110
009750*****    GO TO M-261.                                             D.970110
009760*****CALL "SH160I".                                               D.970110
009770     CALL "SCHD31".                                               I.970110
009780     DISPLAY D-NCM.
009790     MOVE ZERO TO W-ID.
009800     MOVE W-NGP TO W-DATE.
009810*****MOVE ZERO  TO W-UK.                                          D.970110
009820     MOVE W-SKC TO W-SCD.
009830     DISPLAY A-DATE A-SCD D-SNM.                                  I.970110
009840*****MOVE W-SON TO W-SNM.                                         D.950615
009850*****DISPLAY A-UNO A-DATE A-SCD D-SNM.                            D.970110
009860*M-261.                                                           D.020128
009870     MOVE 1 TO W-GN.
009880     MOVE 4 TO W-L1.
009890     COMPUTE W-L2 = W-L1 + 1.
009900     COMPUTE W-L3 = W-L2 + 1.
009910     MOVE W-AID(W-GN) TO W-ID.
009920     MOVE ZERO TO W-PMCD.                                         I.950615
009930 M-280.
009940*****ACCEPT A-SK.                                                 D.011031
009950     ACCEPT A-HCD.                                                I.011031
009960     DISPLAY DISP-MSG-SPACE.
009970     IF ESTAT = BTB
009980         GO TO M-520.
009990*****IF W-UNO = ZERO                                              D.970110
010000*****IF ESTAT = C1                                                D.001205
010010     IF ESTAT = C1 OR PF6                                         I.001205
010020         GO TO M-440.
010030     IF ESTAT NOT = HTB AND SKP
010040         GO TO M-280.
010050     IF W-HCD = ZERO                                              I.011031
010060         IF W-FHCD NOT = ZERO                                     I.011031
010070             MOVE W-FHCD TO W-HCD.                                I.011031
010080     DISPLAY A-HCD.                                               I.011031
010090     MOVE W-HCD TO HI-KEY.                                        I.011031
010100     READ HI-M WITH UNLOCK INVALID KEY                            I.011031
010110         DISPLAY E-ME1 E-ME98                                     I.011031
010120         GO TO M-280.                                             I.011031
010130     MOVE W-HCD TO W-FHCD.                                        I.011031
010140     MOVE W-NGP TO W-DATE.                                        I.011031
010150     MOVE W-SKC TO W-SCD.                                         I.011031
010160     MOVE HI-NAME TO W-NAME.                                      I.011031
010170     DISPLAY D-NAME.                                              I.011031
010180*
010190     PERFORM TAN-RTN THRU TAN-EX.                                 I.020216
010200     IF W-ERR = 1                                                 I.020216
010210         GO TO M-280.                                             I.020216
010220     IF HI-FT < 2                                                 I.011031
010230         DISPLAY E-ME3 E-ME98                                     I.071106
010240         IF W-NRC = 5                                             I.071106
010250             GO TO M-280.                                         I.071106
010260*****    DISPLAY E-ME3 E-ME98.                                    D.071106
010270     IF HI-BC22 NOT = 1                                           I.011031
010280         IF W-NRC = 1 OR 2                                        I.011031
010290             DISPLAY E-ME5 E-ME98                                 I.011031
010300             DISPLAY E-CL.                                        I.011031
010310*****IF W-NRC = 4                                                 D.060620
010320*****    MOVE 0 TO W-SSC                                          D.060620
010330*****    DISPLAY S-SK                                             D.060620
010340*****    GO TO M-320.                                             D.060620
010350     IF HI-BC22 = 1                                               I.011031
010360         IF W-NRC NOT = 3                                         I.011106
010370             MOVE HI-KRC TO W-SSC                                 I.011031
010380             DISPLAY A-SK.                                        I.011031
010390*****MOVE SPACE TO HKB-KEY.                                       D.011031
010400*****MOVE "42" TO HKB-NO.                                         D.011031
010410*****MOVE W-SSC TO HKB-SSC.                                       D.011031
010420*****READ HKBM WITH UNLOCK INVALID KEY                            D.011031
010430*****    DISPLAY E-ME9 E-ME98                                     D.011031
010440*****IF W-SSC > 5                                                 D.931021
010450*****IF W-SSC NOT = 0 AND 1 AND 2 AND 4 AND 5                     D.940729
010460*****IF W-SSC NOT = 0 AND 1 AND 2 AND 4 AND 5 AND 6               D.960918
010470*****    GO TO M-280.                                             D.011031
010480*****DISPLAY A-SK.                                                D.011031
010490*****IF W-SSC = 1 OR 2                                            D.000529
010500*****IF W-SSC = 1 OR 2 OR 3                                       D.011031
010510*****    IF W-NRC = 3                                             D.011031
010520*****        DISPLAY E-ME5 E-ME98                                 D.011031
010530*****        GO TO M-280.                                         D.011031
010540*****IF W-SSC = 0 OR 3 OR 4 OR 5                                  D.931021
010550*****IF W-SSC = 0 OR 4 OR 5                                       D.940729
010560*****IF W-SSC = 0 OR 4 OR 5 OR 6                                  D.011031
010570*****    IF W-NRC = 1 OR 2                                        D.011031
010580*****        DISPLAY E-ME5 E-ME98                                 D.011031
010590*****        GO TO M-280.                                         D.011031
010600*****IF W-SSC NOT = 1 AND 2                                       D.000529
010610*****IF W-SSC NOT = 1 AND 2 AND 3                                 D.011031
010620*****    IF W-NRC = 5                                             D.011031
010630*****        DISPLAY E-ME5 E-ME98                                 D.011031
010640*****        GO TO M-280.                                         D.011031
010650 M-300.
010660*****ACCEPT A-HCD.                                                D.011031
010670     ACCEPT A-SK.                                                 I.011031
010680     DISPLAY DISP-MSG-SPACE.
010690     IF ESTAT = BTB
010700         GO TO M-280.
010710     IF ESTAT NOT = HTB AND SKP
010720         GO TO M-300.
010730     MOVE SPACE TO HKB-KEY.                                       I.011031
010740     MOVE "42" TO HKB-NO.                                         I.011031
010750     MOVE W-SSC TO HKB-SSC.                                       I.011031
010760     READ HKBM WITH UNLOCK INVALID KEY                            I.011031
010770         DISPLAY E-ME9 E-ME98                                     I.011031
010780         GO TO M-300.                                             I.011031
010790     DISPLAY A-SK.                                                I.011031
010800     IF W-SSC = 1 OR 2 OR 3                                       I.011031
010810         IF W-NRC = 3                                             I.011031
010820             DISPLAY E-ME5 E-ME98                                 I.011031
010830             GO TO M-300.                                         I.011031
010840     IF W-SSC = 0 OR 4 OR 5 OR 6                                  I.011031
010850         IF W-NRC = 1 OR 2                                        I.011031
010860             DISPLAY E-ME5 E-ME98                                 I.011031
010870             GO TO M-300.                                         I.011031
010880*****IF W-SSC NOT = 1 AND 2 AND 3                                 D.060620
010890*****    IF W-NRC = 5                                             D.060620
010900*****        DISPLAY E-ME5 E-ME98                                 D.060620
010910*****        GO TO M-300.                                         D.060620
010920*****IF W-HCD = ZERO                                              D.011031
010930*****    IF W-FHCD NOT = ZERO                                     D.011031
010940*****        MOVE W-FHCD TO W-HCD.                                D.011031
010950*****DISPLAY  A-HCD.                                              D.011031
010960*****MOVE W-HCD TO HI-KEY.                                        D.011031
010970*****READ HI-M WITH UNLOCK INVALID KEY                            D.011031
010980*****    DISPLAY E-ME1 E-ME98                                     D.011031
010990*****    GO TO M-300.                                             D.011031
011000*****MOVE W-HCD TO W-FHCD.                                        D.011031
011010*****MOVE W-NGP TO W-DATE.                                        D.011031
011020*****MOVE W-SKC TO W-SCD.                                         D.011031
011030*****MOVE W-SON TO W-SNM.                                         D.950615
011040*****MOVE W-UK  TO W-UNO.                                         D.970110
011050*****MOVE HI-NAME TO W-NAME.                                      D.011031
011060*****DISPLAY D-NAME.                                              D.011031
011070*****IF HI-FT = ZERO                                              D.960730
011080*****IF HI-FT < 2                                                 D.011031
011090*****    DISPLAY E-ME3 E-ME98.                                    D.011031
011100*****IF W-UK  NOT = ZERO                                          D.970110
011110*****    MOVE 9 TO CHK  GO TO M-421.                              D.970110
011120 M-320.
011130     ACCEPT A-SIZ.
011140     DISPLAY DISP-MSG-SPACE.
011150     IF ESTAT = BTB
011160*****    IF W-NRC = 4                                             D.060620
011170*****        GO TO M-280                                          D.060620
011180*****      ELSE                                                   D.060620
011190         GO TO M-300.
011200     IF ESTAT NOT = HTB AND SKP
011210         GO TO M-320.
011220     IF W-SIZ < 1 OR > 4
011230         GO TO M-320.
011240     IF W-ID1 NOT = W-IDD
011250         MOVE ZERO TO W-ID2
011260         PERFORM CLR-RTN THRU CLR-EX.
011270     PERFORM BIT-RTN THRU BIT-EX.
011280*M-321.                                                           D.020128
011290     MOVE ZERO TO CNT W-EC.
011300     MOVE 3 TO W-C.                                               C 62/04
011310 M-340.
011320     IF CNT = 10
011330*****    MOVE ZERO TO CHK CNT W-GS                                D.950615
011340         MOVE ZERO TO CHK CNT W-GS W-PMC(W-GN)                    I.950615
011350         GO TO M-400.
011360     ADD 1 TO CNT.
011370     ADD 6 TO W-C.
011380     IF W-BITD(CNT) = 0
011390         MOVE ZERO TO W-SUD                                       I.950615
011400         DISPLAY D-SU                                             I.950615
011410         MOVE W-SUD TO W-SU(CNT)                                  I.950615
011420         GO TO M-340.
011430     IF W-EC NOT = 5
011440         GO TO M-380.
011450     MOVE ZERO TO W-SUD.
011460     DISPLAY D-SU.
011470     MOVE W-SUD TO W-SU(CNT).
011480     GO TO M-340.
011490 M-360.
011500     SUBTRACT 1 FROM CNT.
011510     SUBTRACT 6 FROM W-C.
011520     IF CNT = 0
011530         GO TO M-320.
011540     IF W-BITD(CNT) = 0
011550         GO TO M-360.
011560 M-380.
011570     ACCEPT A-SU.
011580     DISPLAY DISP-MSG-SPACE.
011590     IF ESTAT = BTB
011600         GO TO M-360.
011610     IF ESTAT = ADV
011620         MOVE 5 TO W-EC.
011630     IF ESTAT NOT = HTB AND SKP AND ADV
011640         GO TO M-380.
011650     DISPLAY D-SU.
011660     MOVE W-SUD TO W-SU(CNT).
011670     GO TO M-340.
011680 M-400.
011690     IF CNT = 10
011700         GO TO M-420.
011710     ADD 1 TO CNT.
011720     ADD W-SU(CNT) TO W-GS.
011730     IF CHK NOT = 9
011740         IF W-SU(CNT) NOT = ZERO
011750             MOVE 9 TO CHK.
011760     IF W-SU(CNT) > 0                                             I.950615
011770         MOVE 1 TO W-PMC(W-GN).                                   I.950615
011780     GO TO M-400.
011790 M-420.
011800     DISPLAY D-GS.
011810     MOVE ZERO TO W-EC.
011820*M-421.                                                           D.020128
011830     MOVE W-ID TO W-AID(W-GN).
011840     MOVE ZERO TO W-ID.
011850     IF CHK NOT = 9
011860         GO TO M-280.
011870     ADD 1 TO W-GN.
011880     ADD 3 TO W-L1.
011890     COMPUTE W-L2 = W-L1 + 1.
011900     COMPUTE W-L3 = W-L2 + 1.
011910     IF W-GN = 7
011920         GO TO M-460.                                             I.950615
011930*****    GO TO M-500.                                             D.950615
011940     MOVE W-AID(W-GN) TO W-ID.
011950     MOVE W-ID1 TO W-IDD.
011960*****IF  W-UK   NOT = ZERO                                        D.970110
011970*****    AND  W-HCD = ZERO   GO TO M-500.                         D.950615
011980*****    AND  W-HCD = ZERO   GO TO M-460.                         D.970110
011990     GO TO M-280.
012000 M-440.
012010**** MOVE W-ID TO W-AID(W-GN).                                    D 920615
012020     MOVE ZERO TO W-ID.
012030     MOVE W-ID TO W-AID(W-GN).                                    A 920615
012040     MOVE 0 TO W-PMC(W-GN).                                       I.950615
012050     DISPLAY S-SPACE.
012060     ADD 1 TO W-GN.
012070     ADD 3 TO W-L1.
012080     COMPUTE W-L2 = W-L1 + 1.
012090     COMPUTE W-L3 = W-L2 + 1.
012100     IF W-GN NOT = 7
012110         GO TO M-440.
012120 M-460.                                                           I.950615
012130*****IF W-NRC = 2                                                 D.971028
012140*****IF W-NRC = 2 OR 5                                            D.060620
012150*****IF W-NRC = 2                                                 D.070322
012160*****    MOVE 0 TO W-HPC                                          D.070322
012170*****    DISPLAY A-HPC                                            D.070322
012180*****    GO TO M-500.                                             D.070322
012190*****IF W-NRC NOT = 3                                             D.960615
012200*****    MOVE 1 TO W-HPC                                          D.960615
012210*****    DISPLAY A-HPC                                            D.960615
012220*****    GO TO M-500.                                             D.960615
012230*****IF 1 = W-PMC(1) OR W-PMC(2) OR W-PMC(3) OR W-PMC(4)          D.960615
012240*****                            OR W-PMC(5) OR W-PMC(6)          D.960615
012250*****    MOVE 1 TO W-HPC                                          D.960615
012260*****    DISPLAY A-HPC                                            D.960615
012270*****    GO TO M-500.                                             D.960615
012280 M-480.                                                           I.950615
012290     ACCEPT A-HPC.                                                I.950615
012300     IF ESTAT = BTB                                               I.950615
012310         GO TO M-520.                                             I.950615
012320     IF ESTAT NOT = HTB AND SKP                                   I.950615
012330         GO TO M-480.                                             I.950615
012340     IF W-HPC NOT = 0 AND 1                                       I.950615
012350         GO TO M-480.                                             I.950615
012360 M-500.
012370     ACCEPT A-DMM.
012380     DISPLAY DISP-MSG-SPACE.
012390*****IF ESTAT NOT = BTB                                           D.970110
012400*****    GO TO M-501.                                             D.970110
012410*****IF W-NRC NOT = 3                                             D.960615
012420*****    GO TO M-520.                                             D.960615
012430*****IF ESTAT = BTB                                               D.950615
012440*****IF 1 = W-PMC(1) OR W-PMC(2) OR W-PMC(3) OR W-PMC(4)          D.960615
012450*****                            OR W-PMC(5) OR W-PMC(6)          D.960615
012460*****    GO TO M-520.                                             D.960615
012470     IF ESTAT = BTB                                               I.970110
012480*****    IF W-NRC = 2 OR 5                                        D.060620
012490*****    IF W-NRC = 2                                             D.070322
012500*****        GO TO M-520                                          D.070322
012510*****      ELSE                                                   D.070322
012520         GO TO M-480.                                             I.950615
012530*M-501.                                                           D.970110
012540     IF ESTAT NOT = HTB AND SKP
012550         GO TO M-500.
012560     IF W-DMM = 1
012570         GO TO M-600.
012580     IF W-DMM = 9
012590         GO TO M-260.
012600     GO TO M-500.
012610 M-520.
012620     SUBTRACT 1 FROM W-GN.
012630     SUBTRACT 3 FROM W-L1.
012640     COMPUTE W-L2 = W-L1 + 1.
012650     COMPUTE W-L3 = W-L2 + 1.
012660     IF W-GN = ZERO
012670         GO TO M-200.
012680     MOVE 11 TO CNT.
012690     MOVE 69 TO W-C.
012700     MOVE ZERO TO W-ID.
012710     MOVE W-AID(W-GN) TO W-ID.
012720     IF W-HCD = ZERO
012730         GO TO M-520.
012740     MOVE W-HCD TO HI-KEY.
012750     READ HI-M WITH UNLOCK INVALID KEY
012760         DISPLAY E-ME2 E-ME99
012770         GO TO M-980.
012780     PERFORM BIT-RTN THRU BIT-EX.
012790     MOVE W-ID1 TO W-IDD.
012800*****IF  W-UK NOT = ZERO                                          D.970110
012810*****     GO TO M-300.                                            D.970110
012820     GO TO M-360.
012830 M-600.
012840*<<< 更新　＆　作表　処理 >>>*
012850     MOVE ZERO TO W-GN.
012860     MOVE ZERO TO WK-UNO.                                         I.970110
012870*****MOVE W-UK TO WK-UNO.                                         D.970110
012880 M-620.
012890     ADD 1 TO W-GN.
012900     IF W-GN = 7
012910         GO TO M-660.
012920     MOVE ZERO TO W-ID.
012930     MOVE W-AID(W-GN) TO W-ID.
012940     IF W-HCD = ZERO
012950         GO TO M-660.
012960     MOVE W-HCD TO HI-KEY.
012970     READ HI-M WITH UNLOCK INVALID KEY
012980         DISPLAY E-ME2 E-ME99
012990         GO TO M-980.
013000*****IF W-SIZ = 1                                                 D.970110
013010*****    MOVE W-TBL1 TO W-SS.                                     D.970110
013020*****IF W-SIZ = 2                                                 D.970110
013030*****    MOVE W-TBL2 TO W-SS.                                     D.970110
013040*****IF W-SIZ = 3                                                 D.970110
013050*****    MOVE W-TBL3 TO W-SS.                                     D.970110
013060*****IF W-SIZ = 4                                                 D.970110
013070*****    MOVE W-TBL4 TO W-SS.                                     D.970110
013080     MOVE ZERO TO CNT W-BK W-FK.
013090*M-621.                                                           D.020128
013100*****IF WK-UNO NOT = 0  OR  W-NRC = 2 OR W-GN NOT = 1             D.970110
013110*****    GO TO M-622.                                             D.970110
013120*****IF (W-NRC = 2) OR (W-GN NOT = 1)                             D.971028
013130*****IF (W-NRC = 2 OR 5) OR (W-GN NOT = 1)                        D.060620
013140     IF (W-NRC = 2) OR (W-GN NOT = 1)                             I.060620
013150         GO TO M-640.                                             I.970110
013160     MOVE "18" TO JCON5-KEY  ERR-K.
013170     READ JCON INVALID
013180         DISPLAY E-ME12 E-ME99                                    I.970110
013190         GO TO M-980.                                             I.970110
013200*****     MOVE "G" TO ERR-M                                       D.970110
013210*****     MOVE "JCON" TO ERR-F                                    D.970110
013220*****     PERFORM ERR-RTN THRU ERR-EX.                            D.970110
013230     ADD 1 TO JCON5-03.
013240     MOVE JCON5-03 TO WK-UNO.
013250     REWRITE JCON5-R  INVALID
013260         DISPLAY E-ME13 E-ME99                                    I.970110
013270         GO TO M-980.                                             I.970110
013280*****     MOVE "R" TO ERR-M                                       D.970110
013290*****     MOVE "JCON" TO ERR-F                                    D.970110
013300*****     PERFORM ERR-RTN THRU ERR-EX.                            D.970110
013310*M-622.                                                           D.970110
013320*****IF CNT = 10                                                  D.970110
013330*****    GO TO M-640.                                             D.970110
013340*****ADD 1 TO CNT.                                                D.970110
013350*****IF W-SU(CNT) = ZERO                                          D.970110
013360*****    GO TO M-622.                                             D.970110
013370*****MOVE ZERO TO SU-R.                                           D.970110
013380*****MOVE W-DATE TO U-DATE.                                       D.970110
013390*****MOVE W-SSC TO U-SK.                                          D.970110
013400*****MOVE W-HCD TO U-HCD.                                         D.970110
013410*****MOVE W-SIZ TO U-SIZ.                                         D.970110
013420*****MOVE W-SS1(CNT) TO U-S.                                      D.970110
013430*****MOVE W-SU(CNT) TO U-SU.                                      D.970110
013440*****COMPUTE U-BK = U-SU * HI-TS(W-SIZ).                          D.970110
013450*****COMPUTE U-FK = U-SU * HI-FT.                                 D.970110
013460*****MOVE HI-BC1 TO U-BC1.                                        D.970110
013470*****MOVE HI-BC2 TO U-BC2.                                        D.970110
013480*****MOVE HI-BC3 TO U-BC3.                                        D.970110
013490*****MOVE W-NRC   TO U-NC.                                        D.970110
013500*****MOVE W-SCD  TO U-SKC.                                        D.970110
013510*****WRITE SU-R.                                                  D.970110
013520*****ADD U-BK TO W-BK.                                            D.970110
013530*****ADD U-FK TO W-FK.                                            D.970110
013540*****GO TO M-622.                                                 D.970110
013550 M-640.
013560*****COMPUTE W-BK = W-GS * HI-TS(W-SIZ).                          D.010802
013570     COMPUTE W-BK = W-GS * HI-SB.                                 I.010802
013580     COMPUTE W-FK = W-GS * HI-FT.                                 I.970110
013590*
013600     MOVE ZERO TO UTRAN-R.                                        I.970110
013610     MOVE WK-UNO TO UTRAN-UNO.                                    I.970110
013620     MOVE W-GN TO UTRAN-GYO.                                      I.970110
013630     MOVE W-DATE TO UTRAN-DATE.                                   I.970110
013640     MOVE W-HCD TO UTRAN-HCD.                                     I.970110
013650     MOVE W-SIZ TO UTRAN-SIZ.                                     I.970110
013660     MOVE W-SU(1) TO UTRAN-SU(1).                                 I.970110
013670     MOVE W-SU(2) TO UTRAN-SU(2).                                 I.970110
013680     MOVE W-SU(3) TO UTRAN-SU(3).                                 I.970110
013690     MOVE W-SU(4) TO UTRAN-SU(4).                                 I.970110
013700     MOVE W-SU(5) TO UTRAN-SU(5).                                 I.970110
013710     MOVE W-SU(6) TO UTRAN-SU(6).                                 I.970110
013720     MOVE W-SU(7) TO UTRAN-SU(7).                                 I.970110
013730     MOVE W-SU(8) TO UTRAN-SU(8).                                 I.970110
013740     MOVE W-SU(9) TO UTRAN-SU(9).                                 I.970110
013750     MOVE W-SU(10) TO UTRAN-SU(10).                               I.970110
013760     MOVE W-GS TO UTRAN-SUT.                                      I.970110
013770     MOVE W-BK TO UTRAN-BKIN.                                     I.970110
013780     MOVE W-FK TO UTRAN-FKIN.                                     I.970110
013790     MOVE W-NRC TO UTRAN-NRC.                                     I.970110
013800     MOVE W-SSC TO UTRAN-SSC.                                     I.970110
013810     MOVE W-HPC TO UTRAN-HPC.                                     I.970110
013820     MOVE W-SCD TO UTRAN-SKC.                                     I.970110
013830     MOVE HI-BC1 TO UTRAN-BC1.                                    I.970110
013840     MOVE HI-BC2 TO UTRAN-BC2.                                    I.970110
013850     MOVE HI-BC3 TO UTRAN-BC3.                                    I.970110
013860     MOVE HI-BMC TO UTRAN-BMC.                                    I.020516
013870     MOVE HI-BMNO TO UTRAN-BMNO.                                  I.020516
013880     WRITE UTRAN-R.                                               I.970110
013890     IF ERR-STAT NOT = "00"                                       I.970110
013900         DISPLAY E-ME11 E-ME99                                    I.970110
013910         GO TO M-800.                                             I.981215
013920*****    GO TO M-980.                                             D.981215
013930*****MOVE SPACE TO UTRN-R.                                        D.970110
013940*****INITIALIZE    UTRN-R.                                        D.970110
013950*****MOVE WK-UNO TO UTRN-01.                                      D.970110
013960*****MOVE W-GN  TO UTRN-02.                                       D.970110
013970*****MOVE W-DATE TO UTRN-03.                                      D.970110
013980*****MOVE W-HCD TO UTRN-04.                                       D.970110
013990*****MOVE W-SIZ TO UTRN-05.                                       D.970110
014000*****MOVE W-SU(1) TO UTRN-061(1).                                 D.970110
014010*****MOVE W-SU(2) TO UTRN-061(2).                                 D.970110
014020*****MOVE W-SU(3) TO UTRN-061(3).                                 D.970110
014030*****MOVE W-SU(4) TO UTRN-061(4).                                 D.970110
014040*****MOVE W-SU(5) TO UTRN-061(5).                                 D.970110
014050*****MOVE W-SU(6) TO UTRN-061(6).                                 D.970110
014060*****MOVE W-SU(7) TO UTRN-061(7).                                 D.970110
014070*****MOVE W-SU(8) TO UTRN-061(8).                                 D.970110
014080*****MOVE W-SU(9) TO UTRN-061(9).                                 D.970110
014090*****MOVE W-SU(10) TO UTRN-061(10).                               D.970110
014100*****MOVE W-SSC  TO UTRN-07.                                      D.970110
014110*****MOVE W-SCD TO UTRN-08.                                       D.970110
014120*****MOVE W-NRC  TO UTRN-09.                                      D.970110
014130*****IF W-UK  = ZERO                                              D.970110
014140*****     MOVE ZERO   TO UTRN-10                                  D.970110
014150*****ELSE MOVE SV-HCD(W-GN) TO UTRN-10.                           D.970110
014160*****MOVE W-HPC TO UTRN-11.                                       D.970110
014170*****WRITE UTRN-R.                                                D.970110
014180*****IF ERR-STAT NOT = "00"                                       D.970110
014190*****     MOVE "W" TO ERR-M                                       D.970110
014200*****     MOVE "HN-UTRN" TO ERR-F                                 D.970110
014210*****     PERFORM ERR-RTN THRU ERR-EX.                            D.970110
014220*M-641.                                                           D.970110
014230*
014240*****PERFORM MEI-RTN THRU MEI-EX.                                 D.981215
014250     GO TO M-620.
014260 M-660.
014270*****IF W-UK  = ZERO                                              D.970110
014280*****    GO TO M-662.                                             D.970110
014290*****MOVE W-UK  TO SUSZ-011.                                      D.970110
014300*****MOVE 0     TO SUSZ-012.                                      D.970110
014310*****START HN-SUSZ KEY NOT < SUSZ-KEY                             D.970110
014320*****              INVALID   GO TO M-662.                         D.970110
014330*M-661.                                                           D.970110
014340*****READ HN-SUSZ  NEXT AT END  GO TO M-662.                      D.970110
014350*****IF SUSZ-011 NOT = W-UK     GO TO M-662.                      D.970110
014360*****MOVE SUSZ-KEY TO ERR-K.                                      D.970110
014370*****DELETE  HN-SUSZ INVALID                                      D.970110
014380*****     MOVE "D" TO ERR-M                                       D.970110
014390*****     MOVE "HN-SUSZ" TO ERR-F                                 D.970110
014400*****     PERFORM ERR-RTN THRU ERR-EX.                            D.970110
014410*****GO  TO  M-661.                                               D.970110
014420*M-662.                                                           D.970110
014430     MOVE ZERO TO W-AIDD.
014440*****IF  W-UK  NOT = ZERO    GO TO M-200.                         D.970110
014450     GO TO M-260.
014460 M-680.                                                           I.010105
014470     PERFORM CHK-RTN THRU CHK-EX.                                 I.020216
014480     IF COMPLETION-CODE = 255                                     I.020216
014490         GO TO M-980.                                             I.020216
014500     PERFORM KOB-RTN THRU KOB-EX.                                 I.020126
014510*****PERFORM SZO-RTN THRU SZO-EX.                                 D.060605
014520*****OPEN I-O HSS-F.                                              D.020126
014530*M-681.                                                           D.020126
014540*****READ HSS-F NEXT RECORD AT END                                D.020126
014550*****    GO TO M-687.                                             D.020126
014560*****IF HSS-NG NOT = W-NGD                                        D.020126
014570*****    GO TO M-681.                                             D.020126
014580*****IF HSS-HHC = 1                                               D.020126
014590*****    GO TO M-681.                                             D.020126
014600*****IF HSS-HKC NOT = 1                                           D.020126
014610*****    GO TO M-681.                                             D.020126
014620*
014630*****MOVE HSS-HCD TO HI-KEY.                                      D.020126
014640*****READ HI-M WITH UNLOCK INVALID KEY                            D.020126
014650*****    DISPLAY E-ME1 E-ME99                                     D.020126
014660*****    DISPLAY E-CL                                             D.020126
014670*****    GO TO M-681.                                             D.020126
014680*****IF HI-FT = ZERO                                              D.020126
014690*****    GO TO M-681.                                             D.020126
014700*****MOVE "18" TO JCON5-KEY.                                      D.020126
014710*****READ JCON INVALID                                            D.020126
014720*****     DISPLAY E-ME12 E-ME99                                   D.020126
014730*****     GO TO M-687.                                            D.020126
014740*****ADD  1 TO JCON5-03.                                          D.020126
014750*****MOVE JCON5-03 TO WK-UNO.                                     D.020126
014760*****REWRITE JCON5-R  INVALID                                     D.020126
014770*****     DISPLAY E-ME13 E-ME99                                   D.020126
014780*****     GO TO M-687.                                            D.020126
014790*
014800*****MOVE ZERO TO W-SIZ W-GN.                                     D.020126
014810*M-682.                                                           D.020126
014820*****ADD 1 TO W-SIZ.                                              D.020126
014830*****IF W-SIZ = 5                                                 D.020126
014840*****    GO TO M-686.                                             D.020126
014850*****IF ZERO = HSS-SU(W-SIZ,01) AND HSS-SU(W-SIZ,02) AND          D.020126
014860*****          HSS-SU(W-SIZ,03) AND HSS-SU(W-SIZ,04) AND          D.020126
014870*****          HSS-SU(W-SIZ,05) AND HSS-SU(W-SIZ,06) AND          D.020126
014880*****          HSS-SU(W-SIZ,07) AND HSS-SU(W-SIZ,08) AND          D.020126
014890*****          HSS-SU(W-SIZ,09) AND HSS-SU(W-SIZ,10)              D.020126
014900*****    GO TO M-682.                                             D.020126
014910*
014920*****ADD 1 TO W-GN.                                               D.020126
014930*****MOVE ZERO TO UTRAN-R.                                        D.020126
014940*****MOVE WK-UNO TO UTRAN-UNO.                                    D.020126
014950*****MOVE W-GN TO UTRAN-GYO.                                      D.020126
014960*****MOVE HSS-DATE TO UTRAN-DATE.                                 D.020126
014970*****MOVE HSS-HCD TO UTRAN-HCD.                                   D.020126
014980*****MOVE W-SIZ TO UTRAN-SIZ.                                     D.020126
014990*****MOVE 3 TO UTRAN-NRC.                                         D.020126
015000*****MOVE 0 TO UTRAN-SSC.                                         D.020126
015010*****MOVE 1 TO UTRAN-HPC.                                         D.020126
015020*****MOVE HSS-SKC TO UTRAN-SKC.                                   D.020126
015030*****MOVE HI-BC TO UTRAN-BC.                                      D.020126
015040*****MOVE HSS-DNO TO UTRAN-KBN.                                   D.020126
015050*
015060*****MOVE ZERO TO CNT.                                            D.020126
015070*M-683.                                                           D.020126
015080*****ADD 1 TO CNT.                                                D.020126
015090*****IF CNT NOT = 11                                              D.020126
015100*****    MOVE HSS-SU(W-SIZ,CNT) TO UTRAN-SU(CNT)                  D.020126
015110*****    ADD HSS-SU(W-SIZ,CNT) TO UTRAN-SUT                       D.020126
015120*****    GO TO M-683.                                             D.020126
015130*****COMPUTE UTRAN-BKIN = UTRAN-SUT * HI-TS(W-SIZ).               D.010802
015140*****COMPUTE UTRAN-BKIN = UTRAN-SUT * HI-SB.                      D.020126
015150*****COMPUTE UTRAN-FKIN = UTRAN-SUT * HI-FT.                      D.020126
015160*****WRITE UTRAN-R.                                               D.020126
015170*****IF ERR-STAT NOT = "00"                                       D.020126
015180*****    DISPLAY E-ME11 E-ME99                                    D.020126
015190*****    GO TO M-684.                                             D.020126
015200*****GO TO M-682.                                                 D.020126
015210*M-684.                                                           D.020126
015220*****CLOSE UTRAN.                                                 D.020126
015230*****OPEN I-O UTRAN.                                              D.020126
015240*M-685.                                                           D.020126
015250*****READ UTRAN AT END                                            D.020126
015260*****    GO TO M-687.                                             D.020126
015270*****IF WK-UNO NOT = UTRAN-UNO                                    D.020126
015280*****    GO TO M-685.                                             D.020126
015290*****MOVE ALL ""FF"" TO UTRAN-R.                                  D.020126
015300*****REWRITE UTRAN-R.                                             D.020126
015310*****GO TO M-685.                                                 D.020126
015320*M-686.                                                           D.020126
015330*****MOVE 1 TO HSS-HHC.                                           D.020126
015340*****REWRITE HSS-R INVALID                                        D.020126
015350*****     DISPLAY E-ME14 E-ME99                                   D.020126
015360*****     GO TO M-687.                                            D.020126
015370*****GO TO M-681.                                                 D.020126
015380*M-687.                                                           D.020126
015390*****CLOSE HSS-F.                                                 D.020126
015400 M-800.                                                           I.981215
015410     CLOSE UTRAN.                                                 I.981215
015420     DISPLAY C-CLEAR.                                             I.981215
015430     DISPLAY D-PRN.                                               I.981215
015440     OPEN I-O UTRAN.                                              I.981215
015450 M-820.                                                           I.981215
015460     READ UTRAN AT END                                            I.981215
015470         MOVE 255 TO COMPLETION-CODE                              I.010105
015480         GO TO M-980.                                             I.981215
015490     IF UTRAN-PRC = 9                                             I.981215
015500         GO TO M-820.                                             I.981215
015510     MOVE ZERO TO WA-D W-DEC.                                     I.010117
015520     MOVE ZERO TO W-D G-AREA W-DC.                                I.981215
015530 M-840.                                                           I.981215
015540     PERFORM MEI-RTN THRU MEI-EX.                                 I.981215
015550 M-860.                                                           I.981215
015560     READ UTRAN AT END                                            I.981215
015570         MOVE 1 TO W-DEC                                          I.010117
015580         GO TO M-980.                                             I.981215
015590     IF UTRAN-PRC = 9                                             I.981215
015600         GO TO M-860.                                             I.981215
015610     GO TO M-840.                                                 I.981215
015620 M-980.
015630     IF W-POC NOT = ZERO                                          *I 92/07
015640*****    PERFORM KEI-RTN THRU KEI-EX.                             D.020216
015650*
015660*****IF W-POC NOT = ZERO                                          D.020216
015670         PERFORM KEI-RTN THRU KEI-EX                              I.020216
015680         CLOSE SP-F.
015690     CLOSE HI-M.
015700*****CLOSE SU-F.                                                  D.970110
015710*****CLOSE JCON.                                                  D.030613
015720     IF JS-SIGN = 0                                               I.010105
015730         CLOSE JCON                                               I.030613
015740         CLOSE HKBM.                                              I.010105
015750*****CLOSE HN-SUSZ.                                               D.970110
015760*****CLOSE HN-UTRN.                                               D.970110
015770     CLOSE HUH-M.                                                 I.020216
015780     CLOSE UTRAN.                                                 I.970110
015790     DISPLAY C-CLEAR.
015800     STOP RUN.
015810 BIT-RTN.
015820     IF W-SIZ = 1
015830         MOVE HI-SS1 TO W-BIT
015840         DISPLAY D-TBL1.
015850     IF W-SIZ = 2
015860         MOVE HI-SS2 TO W-BIT
015870         DISPLAY D-TBL2.
015880     IF W-SIZ = 3
015890         MOVE HI-SS3 TO W-BIT
015900         DISPLAY D-TBL3.
015910     IF W-SIZ = 4
015920         MOVE HI-SS4 TO W-BIT
015930         MOVE ZERO TO W-BITD(10)
015940         DISPLAY D-TBL4.
015950 BIT-EX.
015960     EXIT.
015970 CLR-RTN.
015980     DISPLAY S-GS.
015990     MOVE 3 TO W-C.                                               C 62/04
016000 CLR-020.
016010     ADD 6 TO W-C.
016020     IF W-C < 63
016030         DISPLAY S-SU
016040         GO TO CLR-020.
016050 CLR-EX.
016060     EXIT.
016070 TAN-RTN.                                                         I.020216
016080     MOVE 0 TO W-ERR.                                             I.020216
016090     MOVE W-HCD TO HUH-KEY.                                       I.020216
016100     READ HUH-M WITH UNLOCK INVALID KEY                           I.020216
016110         DISPLAY E-ME18 E-ME99                                    I.020216
016120         GO TO TAN-100.                                           I.020216
016130     IF (HUH-ZK NOT = ZERO) AND (HUH-ZS NOT = ZERO)               I.020216
016140         COMPUTE W-FT = HUH-ZK / HUH-ZS                           I.020216
016150         IF HI-FT NOT = W-FT                                      I.020216
016160             DISPLAY E-ME19 E-ME98                                I.020216
016170             GO TO TAN-100.                                       I.020216
016180     IF (HUH-NK NOT = ZERO) AND (HUH-NS NOT = ZERO)               I.020216
016190         COMPUTE W-FT = HUH-NK / HUH-NS                           I.020216
016200         IF HI-FT NOT = W-FT                                      I.020216
016210             DISPLAY E-ME19 E-ME98                                I.020216
016220             GO TO TAN-100.                                       I.020216
016230     IF (HUH-UG NOT = ZERO) AND (HUH-SS NOT = ZERO)               I.020216
016240         COMPUTE W-FT = HUH-UG / HUH-SS                           I.020216
016250         IF HI-FT NOT = W-FT                                      I.020216
016260             DISPLAY E-ME19 E-ME98                                I.020216
016270             GO TO TAN-100.                                       I.020216
016280     IF (HUH-YK NOT = ZERO) AND (HUH-YS NOT = ZERO)               I.020216
016290         COMPUTE W-FT = HUH-YK / HUH-YS                           I.020216
016300         IF HI-FT NOT = W-FT                                      I.020216
016310             DISPLAY E-ME19 E-ME98                                I.020216
016320             GO TO TAN-100.                                       I.020216
016330     GO TO TAN-EX.                                                I.020216
016340 TAN-100.                                                         I.020216
016350     IF JS-SIGN = 0                                               I.020216
016360         MOVE 1 TO W-ERR                                          I.020216
016370       ELSE                                                       I.020216
016380         MOVE 255 TO COMPLETION-CODE.                             I.020216
016390 TAN-EX.                                                          I.020216
016400     EXIT.                                                        I.020216
016410 CHK-RTN.                                                         I.020216
016420     OPEN INPUT HSS-F.                                            I.020216
016430 CHK-020.                                                         I.020216
016440     READ HSS-F NEXT RECORD AT END                                I.020216
016450         GO TO CHK-100.                                           I.020216
016460     IF HSS-NG NOT = W-NGD                                        I.020216
016470         GO TO CHK-020.                                           I.020216
016480     IF HSS-HHC = 1                                               I.020216
016490         GO TO CHK-020.                                           I.020216
016500     IF HSS-HKC NOT = 1                                           I.020216
016510         GO TO CHK-020.                                           I.020216
016520*
016530     MOVE HSS-HCD TO HI-KEY.                                      I.020216
016540     READ HI-M WITH UNLOCK INVALID KEY                            I.020216
016550         GO TO CHK-020.                                           I.020216
016560     IF HI-FT = ZERO                                              I.020216
016570         GO TO CHK-020.                                           I.020216
016580*
016590     MOVE HSS-HCD TO W-HCD.                                       I.020216
016600     PERFORM TAN-RTN THRU TAN-EX.                                 I.020216
016610     IF COMPLETION-CODE = 255                                     I.020216
016620         CLOSE HSS-F                                              I.020216
016630         GO TO CHK-EX.                                            I.020216
016640     GO TO CHK-020.                                               I.020216
016650 CHK-100.                                                         I.020216
016660     CLOSE HSS-F.                                                 I.020216
016670*                                                                 I.020216
016680*****CALL "CBLSTNNO" USING STN-NO.                                D.060605
016690*****MOVE STN-NO2 TO W-FID2.                                      D.060605
016700*****MOVE W-FID TO WK0256ID.                                      D.060605
016710*****OPEN INPUT HSKWF.                                            D.060605
016720*CHK-120.                                                         D.060605
016730*****READ HSKWF NEXT RECORD AT END                                D.060605
016740*****    GO TO CHK-200.                                           D.060605
016750*****IF HSKW-SKC = 1 OR 3                                         D.060605
016760*****    GO TO CHK-120.                                           D.060605
016770*****IF HSKW-NGD NOT = W-NGD                                      D.060605
016780*****    GO TO CHK-120.                                           D.060605
016790*****IF HSKW-GHC NOT = 1                                          D.020318
016800*****IF HSKW-GHD = ZERO                                           D.060605
016810*****    GO TO CHK-120.                                           D.060605
016820*****IF HSKW-HHC = 1                                              D.020318
016830*****IF HSKW-HHD NOT = ZERO                                       D.060605
016840*****    GO TO CHK-120.                                           D.060600
016850*
016860*****MOVE HSKW-HCD TO HI-KEY.                                     D.060605
016870*****READ HI-M WITH UNLOCK INVALID KEY                            D.060605
016880*****    DISPLAY E-ME1 E-ME99                                     D.060605
016890*****    DISPLAY E-CL                                             D.060605
016900*****    GO TO CHK-120.                                           D.060605
016910*****IF HI-FT = ZERO                                              D.060605
016920*****    GO TO CHK-120.                                           D.060605
016930*
016940*****MOVE HSKW-HCD TO W-HCD.                                      D.060605
016950*****PERFORM TAN-RTN THRU TAN-EX.                                 D.060605
016960*****IF COMPLETION-CODE = 255                                     D.060605
016970*****    GO TO CHK-200.                                           D.060605
016980*****GO TO CHK-120.                                               D.060605
016990*CHK-200.                                                         D.060605
017000*****CLOSE HSKWF.                                                 D.060605
017010 CHK-EX.                                                          I.020216
017020     EXIT.                                                        I.020216
017030 KOB-RTN.                                                         I.020126
017040     OPEN I-O HSS-F.                                              I.020126
017050 KOB-020.                                                         I.020126
017060     READ HSS-F NEXT RECORD AT END                                I.020126
017070         GO TO KOB-140.                                           I.020126
017080     IF HSS-NG NOT = W-NGD                                        I.020126
017090         GO TO KOB-020.                                           I.020126
017100     IF HSS-HHC = 1                                               I.020126
017110         GO TO KOB-020.                                           I.020126
017120     IF HSS-HKC NOT = 1                                           I.020126
017130         GO TO KOB-020.                                           I.020126
017140*
017150     MOVE HSS-HCD TO HI-KEY.                                      I.020126
017160     READ HI-M WITH UNLOCK INVALID KEY                            I.020126
017170         DISPLAY E-ME1 E-ME99                                     I.020126
017180         DISPLAY E-CL                                             I.020126
017190         GO TO KOB-020.                                           I.020126
017200     IF HI-FT = ZERO                                              I.020126
017210         GO TO KOB-020.                                           I.020126
017220*****MOVE "18" TO JCON5-KEY.                                      D.030613
017230*****READ JCON INVALID                                            D.030613
017240*****    DISPLAY E-ME12 E-ME99                                    D.030613
017250*****    GO TO KOB-140.                                           D.030613
017260*****ADD 1 TO JCON5-03.                                           D.030613
017270*****MOVE JCON5-03 TO WK-UNO.                                     D.030613
017280*****REWRITE JCON5-R  INVALID                                     D.030613
017290*****    DISPLAY E-ME13 E-ME99                                    D.030613
017300*****    GO TO KOB-140.                                           D.030613
017310*
017320     MOVE ZERO TO W-SIZ W-GN.                                     I.020126
017330 KOB-040.                                                         I.020126
017340     ADD 1 TO W-SIZ.                                              I.020126
017350     IF W-SIZ = 5                                                 I.020126
017360         GO TO KOB-120.                                           I.020126
017370     IF ZERO = HSS-SU(W-SIZ,01) AND HSS-SU(W-SIZ,02) AND          I.020126
017380               HSS-SU(W-SIZ,03) AND HSS-SU(W-SIZ,04) AND          I.020126
017390               HSS-SU(W-SIZ,05) AND HSS-SU(W-SIZ,06) AND          I.020126
017400               HSS-SU(W-SIZ,07) AND HSS-SU(W-SIZ,08) AND          I.020126
017410               HSS-SU(W-SIZ,09) AND HSS-SU(W-SIZ,10)              I.020126
017420         GO TO KOB-040.                                           I.020126
017430*
017440     ADD 1 TO W-GN.                                               I.020126
017450     MOVE ZERO TO UTRAN-R.                                        I.020126
017460*****MOVE WK-UNO TO UTRAN-UNO.                                    D.030613
017470     MOVE HSS-UNO TO UTRAN-UNO.                                   I.030613
017480     MOVE W-GN TO UTRAN-GYO.                                      I.020126
017490     MOVE HSS-DATE TO UTRAN-DATE.                                 I.020126
017500     MOVE HSS-HCD TO UTRAN-HCD.                                   I.020126
017510     MOVE W-SIZ TO UTRAN-SIZ.                                     I.020126
017520     MOVE 3 TO UTRAN-NRC.                                         I.020126
017530     MOVE 0 TO UTRAN-SSC.                                         I.020126
017540     MOVE 0 TO UTRAN-HPC.                                         I.030204
017550*****MOVE 1 TO UTRAN-HPC.                                         D.030204
017560     MOVE HSS-SKC TO UTRAN-SKC.                                   I.020126
017570     MOVE HI-BC TO UTRAN-BC.                                      I.020126
017580     MOVE HI-BMC TO UTRAN-BMC.                                    I.020516
017590     MOVE HI-BMNO TO UTRAN-BMNO.                                  I.020516
017600     MOVE HSS-DNO TO UTRAN-KBN.                                   I.020126
017610*
017620     MOVE ZERO TO CNT.                                            I.020126
017630 KOB-060.                                                         I.020126
017640     ADD 1 TO CNT.                                                I.020126
017650     IF CNT NOT = 11                                              I.020126
017660         MOVE HSS-SU(W-SIZ,CNT) TO UTRAN-SU(CNT)                  I.020126
017670         ADD HSS-SU(W-SIZ,CNT) TO UTRAN-SUT                       I.020126
017680         GO TO KOB-060.                                           I.020126
017690     COMPUTE UTRAN-BKIN = UTRAN-SUT * HI-SB.                      I.020126
017700     COMPUTE UTRAN-FKIN = UTRAN-SUT * HI-FT.                      I.020126
017710     WRITE UTRAN-R.                                               I.020126
017720     IF ERR-STAT NOT = "00"                                       I.020126
017730         DISPLAY E-ME11 E-ME99                                    I.020126
017740         GO TO KOB-080.                                           I.020126
017750     GO TO KOB-040.                                               I.020126
017760 KOB-080.                                                         I.020126
017770     CLOSE UTRAN.                                                 I.020126
017780     OPEN I-O UTRAN.                                              I.020126
017790 KOB-100.                                                         I.020126
017800     READ UTRAN AT END                                            I.020126
017810         GO TO KOB-140.                                           I.020126
017820*****IF WK-UNO NOT = UTRAN-UNO                                    D.030613
017830     IF HSS-UNO NOT = UTRAN-UNO                                   I.030613
017840         GO TO KOB-100.                                           I.020126
017850     MOVE ALL ""FF"" TO UTRAN-R.                                  I.020126
017860     REWRITE UTRAN-R.                                             I.020126
017870     GO TO KOB-100.                                               I.020126
017880 KOB-120.                                                         I.020126
017890     MOVE 1 TO HSS-HHC.                                           I.020126
017900     REWRITE HSS-R INVALID                                        I.020126
017910         DISPLAY E-ME14 E-ME99                                    I.020126
017920         GO TO KOB-140.                                           I.020126
017930     GO TO KOB-020.                                               I.020126
017940 KOB-140.                                                         I.020126
017950     CLOSE HSS-F.                                                 I.020126
017960 KOB-EX.                                                          I.020126
017970     EXIT.                                                        I.020126
017980*SZO-RTN.                                                         D.060605
017990*****CALL "CBLSTNNO" USING STN-NO.                                D.060605
018000*****MOVE STN-NO2 TO W-FID2.                                      D.060605
018010*****MOVE W-FID TO WK0256ID.                                      D.060605
018020*****OPEN INPUT HSKWF.                                            D.060605
018030*****OPEN I-O HSKDF.                                              D.060605
018040*****ACCEPT W-SNGP FROM DATE.                                     D.060605
018050*SZO-020.                                                         D.060605
018060*****READ HSKWF NEXT RECORD AT END                                D.060605
018070*****    GO TO SZO-140.                                           D.060605
018080*****IF HSKW-SKC = 3                                              D.060605
018090*****    GO TO SZO-020.                                           D.060605
018100*****IF HSKW-NGD NOT = W-NGD                                      D.060605
018110*****    GO TO SZO-020.                                           D.060605
018120*****IF HSKW-GHC NOT = 1                                          D.020318
018130*****IF HSKW-GHD = ZERO                                           D.060605
018140*****    GO TO SZO-020.                                           D.060605
018150*****IF HSKW-HHC = 1                                              D.020318
018160*****IF HSKW-HHD NOT = ZERO                                       D.060605
018170*****    GO TO SZO-020.                                           D.060605
018180*
018190*****MOVE HSKW-KEY TO HSKD-KEY.                                   D.060605
018200*****READ HSKDF INVALID KEY                                       D.060605
018210*****    DISPLAY E-ME16 E-ME99                                    D.060605
018220*****    DISPLAY E-CL                                             D.060605
018230*****    GO TO SZO-020.                                           D.060605
018240*
018250*****MOVE HSKW-HCD TO HI-KEY.                                     D.060605
018260*****READ HI-M WITH UNLOCK INVALID KEY                            D.060605
018270*****    DISPLAY E-ME1 E-ME99                                     D.060605
018280*****    DISPLAY E-CL                                             D.060605
018290*****    GO TO SZO-020.                                           D.060605
018300*****IF HI-FT = ZERO                                              D.060605
018310*****    GO TO SZO-020.                                           D.060605
018320*
018330*****MOVE ZERO TO W-SIZ W-GN.                                     D.060605
018340*SZO-040.                                                         D.060605
018350*****ADD 1 TO W-SIZ.                                              D.060605
018360*****IF W-SIZ = 5                                                 D.060605
018370*****    GO TO SZO-120.                                           D.060605
018380*****IF ZERO = HSKW-SU(W-SIZ,01) AND HSKW-SU(W-SIZ,02) AND        D.060605
018390*****          HSKW-SU(W-SIZ,03) AND HSKW-SU(W-SIZ,04) AND        D.060605
018400*****          HSKW-SU(W-SIZ,05) AND HSKW-SU(W-SIZ,06) AND        D.060605
018410*****          HSKW-SU(W-SIZ,07) AND HSKW-SU(W-SIZ,08) AND        D.060605
018420*****          HSKW-SU(W-SIZ,09) AND HSKW-SU(W-SIZ,10)            D.060605
018430*****    GO TO SZO-040.                                           D.060605
018440*
018450*****ADD 1 TO W-GN.                                               D.060605
018460*****MOVE ZERO TO UTRAN-R.                                        D.060605
018470*****MOVE HSKW-UNO TO UTRAN-UNO.                                  D.060605
018480*****MOVE W-GN TO UTRAN-GYO.                                      D.060605
018490*****MOVE HSKW-DATE TO UTRAN-DATE.                                D.060605
018500*****MOVE HSKW-HCD TO UTRAN-HCD.                                  D.060605
018510*****MOVE W-SIZ TO UTRAN-SIZ.                                     D.060605
018520*****IF HSKW-SKC = 1                                              D.060605
018530*****    MOVE 2 TO UTRAN-NRC.                                     D.060605
018540*****IF HSKW-SKC = 2                                              D.060605
018550*****    MOVE 1 TO UTRAN-NRC.                                     D.060605
018560*****MOVE HI-KRC TO UTRAN-SSC.                                    D.060605
018570*****MOVE 0 TO UTRAN-HPC.                                         D.060605
018580*****MOVE 1 TO UTRAN-SKC.                                         D.060605
018590*****MOVE HI-BC TO UTRAN-BC.                                      D.060605
018600*****MOVE HI-BMC TO UTRAN-BMC.                                    D.060605
018610*****MOVE HI-BMNO TO UTRAN-BMNO.                                  D.060605
018620*****MOVE HSKW-DNO TO UTRAN-KBN.                                  D.060605
018630*
018640*****MOVE ZERO TO CNT.                                            D.060605
018650*SZO-060.                                                         D.060605
018660*****ADD 1 TO CNT.                                                D.060605
018670*****IF CNT NOT = 11                                              D.060605
018680*****    MOVE HSKW-SU(W-SIZ,CNT) TO UTRAN-SU(CNT)                 D.060605
018690*****    ADD HSKW-SU(W-SIZ,CNT) TO UTRAN-SUT                      D.060605
018700*****    GO TO SZO-060.                                           D.060605
018710*****COMPUTE UTRAN-BKIN = UTRAN-SUT * HI-SB.                      D.060605
018720*****COMPUTE UTRAN-FKIN = UTRAN-SUT * HI-FT.                      D.060605
018730*****WRITE UTRAN-R.                                               D.060605
018740*****IF ERR-STAT NOT = "00"                                       D.060605
018750*****    DISPLAY E-ME11 E-ME99                                    D.060605
018760*****    DISPLAY E-CL                                             D.060605
018770*****    GO TO SZO-080.                                           D.060605
018780*****GO TO SZO-040.                                               D.060605
018790*SZO-080.                                                         D.060605
018800*****CLOSE UTRAN.                                                 D.060605
018810*****DF HSKD-SKC = 1                                              D.060605
018820*****    DISPLAY E-ME17 E-ME99                                    D.060605
018830*****    DISPLAY E-CL.                                            D.060605
018840*****OPEN I-O UTRAN.                                              D.060605
018850*SZO-100.                                                         D.060605
018860*****READ UTRAN AT END                                            D.060605
018870*****    GO TO SZO-140.                                           D.060605
018880*****IF HSKW-DNO NOT = UTRAN-KBN                                  D.060605
018890*****    GO TO SZO-100.                                           D.060605
018900*****IF HSKW-UNO NOT = UTRAN-UNO                                  D.060605
018910*****    GO TO SZO-100.                                           D.060605
018920*****IF HSKW-DATE NOT = UTRAN-DATE                                D.060605
018930*****    GO TO SZO-100.                                           D.060605
018940*****MOVE ALL ""FF"" TO UTRAN-R.                                  D.060605
018950*****REWRITE UTRAN-R.                                             D.060605
018960*****GO TO SZO-100.                                               D.060605
018970*SZO-120.                                                         D.060605
018980*****MOVE 1 TO HSKD-HHC.                                          D.020318
018990*****MOVE W-SPEY TO HSKD-HHD.                                     D.060605
019000*****REWRITE HSKD-R INVALID                                       D.060605
019010*****    DISPLAY E-ME15 E-ME99                                    D.060605
019020*****    GO TO SZO-140.                                           D.060605
019030*****GO TO SZO-020.                                               D.060605
019040*SZO-140.                                                         D.060605
019050*****CLOSE HSKDF.                                                 D.060605
019060*SZO-EX.                                                          D.060605
019070*****EXIT.                                                        D.060605
019080 MID-RTN.
019090     MOVE SPACE TO SP-R.
019100     WRITE SP-R AFTER PAGE.
019110 MID-010.
019120     ADD 1 TO W-PAGE.
019130     MOVE W-PAGE TO H-PAGE.
019140     MOVE SPACE TO SP-R.
019150     MOVE HEAD1 TO SP-R.
019160     WRITE SP-R.
019170     MOVE SPACE TO SP-R.
019180     MOVE HEAD2 TO SP-R.
019190     WRITE SP-R AFTER 2.
019200     MOVE SPACE TO SP-R.
019210     MOVE HEAD3 TO SP-R.
019220     WRITE SP-R.
019230     MOVE SPACE TO SP-R.
019240     MOVE HEAD4 TO SP-R.
019250     WRITE SP-R.
019260     MOVE SPACE TO SP-R.
019270     MOVE HEAD5 TO SP-R.
019280     WRITE SP-R.
019290     MOVE SPACE TO SP-R.
019300     MOVE HEAD6 TO SP-R.
019310     WRITE SP-R.
019320     MOVE SPACE TO SP-R.
019330 MID-EX.
019340     EXIT.
019350 MEI-RTN.
019360     IF W-POC = ZERO
019370         MOVE 5 TO W-POC
019380         OPEN OUTPUT SP-F
019390         PERFORM MID-010 THRU MID-EX.
019400     MOVE SPACE TO W-P1 W-P2.
019410*****MOVE W-15K TO P-15K.                                         D.950615
019420*****MOVE W-20K TO P-20K.                                         D.950615
019430     MOVE SPACE TO P-NAME.
019440*****IF W-NRCD = W-NRC                                            D.981215
019450*****    IF W-DATED = W-DATE                                      D.981215
019460*****        IF W-SSCD = W-SSC                                    D.981215
019470*****            IF W-HCDD = W-HCD                                D.981215
019480*****                IF W-SKCD = W-SOC                            D.981215
019490*****                    IF W-HPCD = W-HPC                        D.981215
019500     IF UTRAN-NRC = W-NRCD                                        I.981215
019510         IF UTRAN-DATE = W-DATED                                  I.981215
019520             IF UTRAN-SSC = W-SSCD                                I.981215
019530                 IF UTRAN-HCD = W-HCDD                            I.981215
019540                     IF UTRAN-SKC = W-SKCD                        I.981215
019550                         IF UTRAN-HPC = W-HPCD                    I.981215
019560                             GO TO MEI-020.
019570     MOVE UTRAN-HCD TO HI-KEY.                                    I.981215
019580     READ HI-M WITH UNLOCK INVALID KEY                            I.981215
019590         MOVE SPACE TO HI-NAME.                                   I.981215
019600     MOVE HI-NAME TO W-NAME.                                      I.981215
019610*****IF (W-NRCD NOT = W-NRC) OR (W-DATED NOT = W-DATE)            D.981215
019620     IF (UTRAN-NRC NOT = W-NRCD) OR (UTRAN-DATE NOT = W-DATED)    I.981215
019630         PERFORM KEI-RTN THRU KEI-EX                              *I 92/07
019640         MOVE UTRAN-NRC TO W-NRCD P-NRC                           I.981215
019650         MOVE UTRAN-DATE TO W-DATED                               I.981215
019660         MOVE UTRAN-NGPS TO P-DATE.                               I.981215
019670*****    MOVE W-NRC TO W-NRCD                                     D.981215
019680*****    MOVE W-DATE TO W-DATED                                   D.981215
019690*****    MOVE W-NRC TO P-NRC                                      D.981215
019700*****    MOVE W-DATES TO P-DATE.                                  D.981215
019710*****    MOVE W-DATE TO P-DATE.                                   D.970711
019720*****MOVE W-HPC TO W-HPCD.                                        D.981215
019730*****MOVE W-SSC TO W-SSCD.                                        D.981215
019740*****MOVE W-HCD TO W-HCDD.                                        D.981215
019750*****MOVE W-SKC TO W-SKCD.                                        D.981215
019760*****MOVE W-SSC TO P-SSC.                                         D.981215
019770*****MOVE W-HCD  TO P-HCD.                                        D.981215
019780     MOVE UTRAN-HPC TO W-HPCD.                                    I.981215
019790     MOVE UTRAN-SSC TO W-SSCD P-SSC.                              I.981215
019800     MOVE UTRAN-HCD TO W-HCDD P-HCD.                              I.981215
019810     MOVE UTRAN-SKC TO W-SKCD.                                    I.981215
019820     MOVE W-NAME TO P-NAME.
019830*****IF UTRAN-NRC NOT = 2 AND 5                                   D.060620
019840     IF UTRAN-NRC NOT = 2                                         I.060620
019850         MOVE UTRAN-UNO TO P-UNO                                  I.981215
019860         MOVE UTRAN-SKC TO P-SKC.                                 I.981215
019870     MOVE UTRAN-HPC TO P-HPC.                                     I.981215
019880*****IF W-NRC NOT = 2                                             D.971028
019890*****    MOVE WK-UNO TO P-UNO.                                    D.950615
019900*****IF W-NRC NOT = 2 AND 5                                       D.981215
019910*****    MOVE WK-UNO TO P-UNO                                     D.981215
019920*****    MOVE W-SKC  TO P-SKC.                                    D.981215
019930*****MOVE W-HPC  TO P-HPC.                                        D.981215
019940*****MOVE W-SON  TO P-SNM.                                        D.950615
019950     IF LINAGE-COUNTER > 59
019960         MOVE UTRAN-NRC TO P-NRC                                  I.981215
019970         MOVE UTRAN-NGPS TO P-DATE                                I.981215
019980*****    MOVE W-NRC TO P-NRC                                      D.981215
019990*****    MOVE W-DATES TO P-DATE                                   D.981215
020000*****    MOVE W-DATE TO P-DATE                                    D.970711
020010         PERFORM MID-RTN THRU MID-EX.
020020     MOVE W-P1 TO SP-R.
020030     WRITE SP-R.
020040     MOVE SPACE TO SP-R.
020050 MEI-020.
020060*****MOVE W-SIZ TO P-SIZ.                                         D.981215
020070     MOVE UTRAN-SIZ TO P-SIZ.                                     I.981215
020080     MOVE ZERO TO CNT.
020090 MEI-040.
020100     IF CNT NOT = 10
020110         ADD 1 TO CNT
020120         MOVE UTRAN-SU(CNT) TO P-SU(CNT)                          I.981215
020130*****    MOVE W-SU(CNT) TO P-SU(CNT)                              D.981215
020140         GO TO MEI-040.
020150     MOVE UTRAN-SUT TO P-GS.                                      I.981215
020160     MOVE UTRAN-BKIN TO P-BK.                                     I.981215
020170     MOVE UTRAN-FKIN TO P-FK.                                     I.981215
020180*
020190     ADD UTRAN-SUT TO G-GS.                                       I.981215
020200     ADD UTRAN-BKIN TO G-BK.                                      I.981215
020210     ADD UTRAN-FKIN TO G-FK.                                      I.981215
020220*****MOVE W-GS TO P-GS.                                           D.981215
020230*****MOVE W-BK TO P-BK.                                           D.981215
020240*****MOVE W-FK TO P-FK.                                           D.981215
020250*****ADD  W-GS TO G-GS.                                           D.981215
020260*****ADD  W-BK TO G-BK.                                           D.981215
020270*****ADD  W-FK TO G-FK.                                           D.981215
020280     IF LINAGE-COUNTER < 61
020290         GO TO MEI-060.
020300     PERFORM MID-RTN THRU MID-EX.
020310     MOVE UTRAN-NRC TO P-NRC.                                     I.981215
020320     MOVE UTRAN-NGPS TO P-DATE.                                   I.981215
020330*****MOVE W-NRC TO P-NRC.                                         D.981215
020340*****MOVE W-DATES TO P-DATE.                                      D.981215
020350*****MOVE W-DATE TO P-DATE.                                       D.970711
020360*****MOVE W-SSC TO P-SSC.                                         D.981215
020370*****MOVE W-HCD  TO P-HCD.                                        D.981215
020380     MOVE UTRAN-SSC TO P-SSC.                                     I.981215
020390     MOVE UTRAN-HCD TO P-HCD.                                     I.981215
020400     MOVE W-NAME TO P-NAME.
020410*****IF UTRAN-NRC NOT = 2 AND 5                                   D.060620
020420     IF UTRAN-NRC NOT = 2                                         I.060620
020430         MOVE UTRAN-UNO TO P-UNO                                  I.981215
020440         MOVE UTRAN-SKC TO P-SKC.                                 I.981215
020450     MOVE UTRAN-HPC TO P-HPC.                                     I.981215
020460*****IF W-NRC NOT = 2                                             D.971028
020470*****IF W-NRC NOT = 2 AND 5                                       D.981215
020480*****    MOVE WK-UNO TO P-UNO                                     D.981215
020490*****    MOVE W-SKC  TO P-SKC.                                    D.981215
020500*****MOVE W-HPC  TO P-HPC.                                        D.981215
020510     MOVE W-P1 TO SP-R.
020520     WRITE SP-R.
020530     MOVE SPACE TO SP-R.
020540 MEI-060.
020550     MOVE W-P2 TO SP-R.
020560     WRITE SP-R.
020570     MOVE SPACE TO SP-R.
020580     ADD 1 TO W-DC.                                               I.981215
020590*
020600     MOVE 9 TO UTRAN-PRC.                                         I.981216
020610     REWRITE UTRAN-R.                                             I.981216
020620 MEI-EX.
020630     EXIT.
020640 KEI-RTN.                                                         *I 92/07
020650     IF W-DC = 0                                                  I.981215
020660         GO TO KEI-020.                                           I.010117
020670*****    GO TO KEI-010.                                           D.010117
020680     IF W-DC = 1                                                  I.981215
020690         MOVE SPACE TO SP-R                                       I.981215
020700         WRITE SP-R                                               I.981215
020710         GO TO KEI-010.                                           I.981215
020720     IF W-POC = ZERO                                              *I 92/07
020730         MOVE 5 TO W-POC                                          *I 92/07
020740         GO TO KEI-EX.                                            QI 92/07
020750*****MOVE W-20K TO P-20KK.                                        D.950615
020760*****MOVE NC"合　計" TO P-GOK.                                    D.950615
020770*****MOVE NC"【　合　計　】　" TO P-GOK.                          D.010117
020780     MOVE NC"　［　合　計　］" TO P-GOK.                          I.010117
020790     MOVE G-GS TO P-GGS.                                          *I 92/07
020800     MOVE G-BK TO P-GBK.                                          *I 92/07
020810     MOVE G-FK TO P-GFK.                                          *I 92/07
020820     IF LINAGE-COUNTER > 60                                       I.010117
020830         PERFORM MID-RTN THRU MID-EX.                             I.010117
020840     MOVE W-P3 TO SP-R.                                           *I 92/07
020850     WRITE SP-R.                                                  *I 92/07
020860     MOVE SPACE TO SP-R.                                          *I 92/07
020870 KEI-010.                                                         I.981215
020880     IF JS-SIGN NOT = 1                                           I.010117
020890         GO TO KEI-020.                                           I.010117
020900*****ADD G-GS TO WA-GS.                                           D.020126
020910*****ADD G-BK TO WA-BK.                                           D.020126
020920     IF W-NRCD = 1 OR 3                                           I.020126
020930         ADD G-GS TO WA-GS                                        I.020126
020940         ADD G-BK TO WA-BK                                        I.020126
020950         ADD G-FK TO WA-FK.                                       I.010117
020960     IF W-DEC = 0                                                 I.010117
020970         GO TO KEI-020.                                           I.010117
020980     MOVE NC"【　総合計　】　" TO P-GOK.                          I.010117
020990     MOVE WA-GS TO P-GGS.                                         I.010117
021000     MOVE WA-BK TO P-GBK.                                         I.010117
021010     MOVE WA-FK TO P-GFK.                                         I.010117
021020     IF LINAGE-COUNTER > 60                                       I.010117
021030         PERFORM MID-RTN THRU MID-EX.                             I.010117
021040     MOVE W-P3 TO SP-R.                                           I.010117
021050     WRITE SP-R.                                                  I.010117
021060 KEI-020.                                                         I.010117
021070     INITIALIZE G-AREA.                                           *I 92/07
021080     MOVE ZERO TO W-DC.                                           I.981215
021090 KEI-EX.                                                          *I 92/07
021100     EXIT.                                                        *I 92/07
021110 HKB-RTN.                                                         I.960918
021120     MOVE SPACE TO HKB-KEY.                                       I.960918
021130     MOVE "41" TO HKB-NO.                                         I.960918
021140     START HKBM KEY NOT < HKB-KEY INVALID KEY                     I.960918
021150         MOVE 9 TO W-END                                          I.960918
021160         GO TO HKB-EX.                                            I.960918
021170 HKB-020.                                                         I.960918
021180     READ HKBM NEXT RECORD WITH UNLOCK AT END                     I.960918
021190         GO TO HKB-100.                                           I.960918
021200     IF HKB-NO NOT = "41"                                         I.960918
021210         GO TO HKB-100.                                           I.960918
021220*****IF HKB-SUC < 1 OR > 4                                        D.971028
021230     IF HKB-SUC < 1 OR > 5                                        I.971028
021240         GO TO HKB-100.                                           I.960918
021250     MOVE HKB-SUNA TO W-NCM(HKB-SUC).                             I.960918
021260     GO TO HKB-020.                                               I.960918
021270 HKB-100.                                                         I.960918
021280     IF W-NCMA = SPACE                                            I.960918
021290         MOVE 9 TO W-END.                                         I.960918
021300 HKB-EX.                                                          I.960918
021310     EXIT.                                                        I.960918
021320*****COPY LPMSG.                                                  D.970110
