000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMM020.
000030***********************************************************
000040*    PROGRAM         :  品名　製造原価　リスト            *
000050*    PRINTER TYPE    :  JIPS                              *
000060*    SCREEN          :  ******                            *
000070*        変更　　　  :  62/04/13                          *
000080*    COMPILE TYPE    :  COBOL                             *
000090***********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT HI-M ASSIGN TO HI-MSD
000180         FILE STATUS IS ERR-STAT.
000190     SELECT HKBM ASSIGN TO HKB-MSD                                I.960913
000200         ORGANIZATION INDEXED                                     I.960913
000210         ACCESS MODE DYNAMIC                                      I.960913
000220         RECORD KEY HKB-KEY                                       I.960913
000230         FILE STATUS IS ERR-STAT.                                 I.960913
000240     SELECT SP-F ASSIGN TO P-PRN999.
000250 I-O-CONTROL.
000260     APPLY SHARED-MODE ON M-DATE
000270     APPLY SHARED-MODE ON HKBM                                    I.960913
000280     APPLY SHIFT-CODE  ON SP-F.                                   A 62/04
000290 DATA DIVISION.
000300 FILE SECTION.
000310     COPY LIBFDD.
000320     COPY LIHKBM.                                                 I.960913
000330     COPY LSPF.
000340 FD  HI-M
000350     BLOCK  1 RECORDS
000360     LABEL RECORD IS STANDARD
000370     VALUE OF IDENTIFICATION WK0256ID.                            I.970519
000380*****VALUE OF IDENTIFICATION "HA256".                             D.950613
000390*****VALUE OF IDENTIFICATION WK0512ID.                            D.970519
000400 01  HI-R.
000410     02  I-MHCD         PIC  9(006).                              I.010803
000420     02  I-HCD          PIC  9(006).                              I.010803
000430*****02  I-KEY.                                                   D.010803
000440*****  03  I-KEY1       PIC  9(003).                              D.010803
000450*****  03  I-KEY2       PIC  9(003).                              D.010803
000460*****02  I-HCD   REDEFINES I-KEY  PIC  9(006).                    D.010803
000470     02  I-NAME         PIC  N(024).                              品名
000480     02  I-BC1          PIC  9(002).                              I.940607
000490*****02  I-BC1.                                                   D.940607
000500*****  03  I-CC         PIC  9(001).                              D.940607
000510*****  03  I-NC         PIC  9(001).                              D.940607
000520     02  I-BC2          PIC  9(002).                              分類２
000530     02  I-BCD2  REDEFINES I-BC2.                                 I.940607
000540       03  I-CC         PIC  9(001).                              I.940607
000550       03  I-NC         PIC  9(001).                              I.940607
000560     02  I-BC3          PIC  9(002).                              分類３
000570*****02  I-SOC          PIC  9(001).                              D.010803
000580*    [   ｻｲｽﾞ区分 内訳   ]
000590     02  I-SCUD.
000600       03  I-SC    OCCURS   4.
000610*****    04  I-UT.                                                D.010803
000620*****      05  I-TS     PIC  9(004).                              D.941207
000630*****      05  I-TA     PIC  9(004).                              D.941207
000640*****      05  I-TB     PIC  9(004).                              D.941207
000650*****      05  I-TC     PIC  9(004).                              D.941207
000660*****      05  I-TD     PIC  9(004).                              D.941207
000670*****      05  I-TS     PIC  9(005).                              D.010803
000680*****      05  I-TA     PIC  9(005).                              D.010803
000690*****      05  I-TB     PIC  9(005).                              D.010803
000700*****      05  I-TC     PIC  9(005).                              D.010803
000710*****      05  I-TD     PIC  9(005).                              D.010803
000720         04  I-SS       PIC  9(010).                              使用ｻｲｽﾞ
000730     02  I-SCU   REDEFINES I-SCUD.
000740       03  I-SC1.
000750*****    04  I-UTD1.                                              D.010803
000760*****      05  I-U1   OCCURS   5  PIC  9(004).                    D.941207
000770*****      05  I-U1   OCCURS   5  PIC  9(005).                    D.010803
000780*****    04  I-UT1   REDEFINES I-UTD1.                            D.010803
000790*****      05  I-TS1    PIC  9(004).                              D.941207
000800*****      05  I-TA1    PIC  9(004).                              D.941207
000810*****      05  I-TB1    PIC  9(004).                              D.941207
000820*****      05  I-TC1    PIC  9(004).                              D.941207
000830*****      05  I-TD1    PIC  9(004).                              D.941207
000840*****      05  I-TS1    PIC  9(005).                              D.010803
000850*****      05  I-TA1    PIC  9(005).                              D.010803
000860*****      05  I-TB1    PIC  9(005).                              D.010803
000870*****      05  I-TC1    PIC  9(005).                              D.010803
000880*****      05  I-TD1    PIC  9(005).                              D.010803
000890         04  I-SS1      PIC  9(010).                              ｻｲｽﾞ1
000900         04  I-SD1   REDEFINES I-SS1.
000910           05  I-S1    OCCURS  10  PIC  9(001).
000920       03  I-SC2.
000930*****    04  I-UTD2.                                              D.010803
000940*****      05  I-U2    OCCURS   5  PIC  9(004).                   D.941207
000950*****      05  I-U2    OCCURS   5  PIC  9(005).                   D.010803
000960*****    04  I-UT2   REDEFINES I-UTD2.                            D.010803
000970*****      05  I-TS2    PIC  9(004).                              D.941207
000980*****      05  I-TA2    PIC  9(004).                              D.941207
000990*****      05  I-TB2    PIC  9(004).                              D.941207
001000*****      05  I-TC2    PIC  9(004).                              D.941207
001010*****      05  I-TD2    PIC  9(004).                              D.941207
001020*****      05  I-TS2    PIC  9(005).                              D.010803
001030*****      05  I-TA2    PIC  9(005).                              D.010803
001040*****      05  I-TB2    PIC  9(005).                              D.010803
001050*****      05  I-TC2    PIC  9(005).                              D.010803
001060*****      05  I-TD2    PIC  9(005).                              D.010803
001070         04  I-SS2      PIC  9(010).                              ｻｲｽﾞ2
001080         04  I-SD2   REDEFINES I-SS2.
001090           05  I-S2    OCCURS  10  PIC  9(001).
001100       03  I-SC3.
001110*****    04  I-UTD3.                                              D.010803
001120*****      05  I-U3    OCCURS   5  PIC  9(004).                   D.941207
001130*****      05  I-U3    OCCURS   5  PIC  9(005).                   D.010803
001140*****    04  I-UT3   REDEFINES I-UTD3.                            D.010803
001150*****      05  I-TS3    PIC  9(004).                              D.941207
001160*****      05  I-TA3    PIC  9(004).                              D.941207
001170*****      05  I-TB3    PIC  9(004).                              D.941207
001180*****      05  I-TC3    PIC  9(004).                              D.941207
001190*****      05  I-TD3    PIC  9(004).                              D.941207
001200*****      05  I-TS3    PIC  9(005).                              D.010803
001210*****      05  I-TA3    PIC  9(005).                              D.010803
001220*****      05  I-TB3    PIC  9(005).                              D.010803
001230*****      05  I-TC3    PIC  9(005).                              D.010803
001240*****      05  I-TD3    PIC  9(005).                              D.010803
001250         04  I-SS3      PIC  9(010).                              ｻｲｽﾞ3
001260         04  I-SD3   REDEFINES I-SS3.
001270           05  I-S3    OCCURS  10  PIC  9(001).
001280       03  I-SC4.
001290*****    04  I-UTD4.                                              D.010803
001300*****      05  I-U4    OCCURS   5  PIC  9(004).                   D.941207
001310*****      05  I-U4    OCCURS   5  PIC  9(005).                   D.010803
001320*****    04  I-UT4   REDEFINES I-UTD4.                            D.010803
001330*****      05  I-TS4    PIC  9(004).                              D.941207
001340*****      05  I-TA4    PIC  9(004).                              D.941207
001350*****      05  I-TB4    PIC  9(004).                              D.941207
001360*****      05  I-TC4    PIC  9(004).                              D.941207
001370*****      05  I-TD4    PIC  9(004).                              D.941207
001380*****      05  I-TS4    PIC  9(005).                              D.010803
001390*****      05  I-TA4    PIC  9(005).                              D.010803
001400*****      05  I-TB4    PIC  9(005).                              D.010803
001410*****      05  I-TC4    PIC  9(005).                              D.010803
001420*****      05  I-TD4    PIC  9(005).                              D.010803
001430         04  I-SS4      PIC  9(010).                              ｻｲｽﾞ4
001440         04  I-SD4   REDEFINES I-SS4.
001450           05  I-S4    OCCURS  10  PIC  9(001).
001460*****02  I-FT           PIC  9(004).                              D.941207
001470     02  I-SB           PIC  9(005).                              I.010803
001480     02  I-FT           PIC  9(005).                              I.941207
001490*    [   製造原価   ]
001500*****02  I-ZRG          PIC  9(004).                              D.941207
001510*****02  I-SKG          PIC  9(004).                              D.941207
001520*****02  I-GKG          PIC  9(004).                              D.941207
001530     02  I-ZRG          PIC  9(005).                              I.941207
001540     02  I-SKG          PIC  9(005).                              I.941207
001550     02  I-GKG          PIC  9(005).                              I.941207
001560*****02  I-KNC          PIC  9(001).                              D.010803
001570     02  I-KNG          PIC  9(004).                              I.000524
001580*****02  F              PIC  X(051).                              D.940629
001590*****02  F              PIC  X(050).                              D.941207
001600*****02  F              PIC  X(026).                              D.000524
001610*****02  F              PIC  X(022).                              D.010803
001620     02  F              PIC  X(113).                              I.010803
001630     02  I-SNG          PIC  9(004).                              登録日付
001640     02  I-ENG          PIC  9(004).                              廃止日付
001650*****02  F              PIC  X(256).                              D.970519
001660 WORKING-STORAGE SECTION.
001670*77  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".         D.010803
001680*77  WK0512ID           PIC  X(009) VALUE SPACE.                  D.970519
001690 77  WK0256ID           PIC  X(009) VALUE SPACE.                  I.970519
001700 01  STN-NO.                                                      I.950613
001710     02  STN-NO1        PIC  X(003).                              I.950613
001720     02  STN-NO2        PIC  X(003).                              I.950613
001730 01  W-FID.                                                       I.950613
001740*****02  W-FID1         PIC  X(006) VALUE "WK0512".               D.970519
001750     02  W-FID1         PIC  X(006) VALUE "WK0256".               I.970519
001760     02  W-FID2         PIC  X(003).                              I.950613
001770 01  HEAD1.
001780     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".           A 62/0
001790*****02  F              PIC  X(035) VALUE SPACE.                  D.000524
001800*****02  F              PIC  X(036) VALUE SPACE.                  D.010803
001810     02  F              PIC  N(001) VALUE NC"【".                 I.010803
001820     02  H-NM           PIC  N(003).                              I.010803
001830     02  F              PIC  N(001) VALUE NC"】".                 I.010803
001840     02  F              PIC  X(030) VALUE SPACE.                  I.010803
001850     02  F              PIC  N(021) VALUE
001860          NC"＊＊＊　　品名　製造原価　リスト　　＊＊＊".
001870     02  F              PIC  X(028) VALUE SPACE.
001880     02  F              PIC  X(005) VALUE "DATE ".
001890     02  H-DATE         PIC 99B99B99.
001900     02  F              PIC  X(007) VALUE "     P.".
001910     02  H-PAGE         PIC Z9.
001920     02  F              PIC  X(003) VALUE SPACE.                  I.010803
001930*01  HEAD2.                                                       D.010803
001940*****02  F              PIC  X(067) VALUE SPACE.                  D.940629
001950*****02  F              PIC  X(039) VALUE                         D.940629
001960*****     "D=B*0.11  E=(A+B+C+D)*0.22  F=A+B+C+D+E".              D.940629
001970*****02  F              PIC  X(021) VALUE SPACE.                  D.940629
001980*****02  F              PIC  X(049) VALUE SPACE.                  D.960510
001990*****02  F              PIC  X(030) VALUE SPACE.                  D.960913
002000*****02  F              PIC  X(028) VALUE SPACE.                  D.970512
002010*****02  F              PIC  X(016) VALUE SPACE.                  D.000524
002020*****02  F              PIC  X(058) VALUE SPACE.                  D.010803
002030*****02  F              PIC  N(001) VALUE NC"｛".                 D.010803
002040*****02  F              PIC  X(015) VALUE "  D = B*0.11   ".      D.960510
002050*****02  F              PIC  X(016) VALUE "  D = B*0.125   ".     D.960913
002060*****02  F              PIC  X(008) VALUE "  D = B*".             D.010803
002070 01  HEAD21.                                                      I.010803
002080     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".         I.010803
002090     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              I.010803
002100     02  F              PIC  N(008) VALUE NC"品　　　　　名　".   I.010803
002110     02  F              PIC  X(047) VALUE SPACE.                  I.010803
002120     02  F              PIC  X(003) VALUE " : ".                  I.010803
002130     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              I.010803
002140     02  F              PIC  N(008) VALUE NC"品　　　　　名　".   I.010803
002150     02  F              PIC  X(018) VALUE SPACE.                  I.010803
002160     02  F              PIC  N(002) VALUE NC"（　".               I.010803
002170     02  F              PIC  N(004) VALUE NC"直接経費".           I.010803
002180     02  F              PIC  X(003) VALUE " = ".                  I.010803
002190     02  F              PIC  N(004) VALUE NC"社内加工".           I.010803
002200     02  F              PIC  X(003) VALUE " X ".                  I.010803
002210     02  H-CKR          PIC 9.999.                                I.960913
002220     02  F              PIC  N(002) VALUE NC"　）".               I.010803
002230 01  HEAD31.                                                      I.010803
002240     02  F              PIC  X(013) VALUE SPACE.                  I.010803
002250     02  F              PIC  N(004) VALUE NC"　材料費".           I.010803
002260     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002270     02  F              PIC  N(004) VALUE NC"社内加工".           I.010803
002280     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002290     02  F              PIC  N(004) VALUE NC"社外加工".           I.010803
002300     02  F              PIC  N(004) VALUE NC"　直接費".           I.010803
002310     02  F              PIC  N(004) VALUE NC"　間接費".           I.010803
002320     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002330     02  F              PIC  N(004) VALUE NC"製造原価".           I.010803
002340     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002350     02  F              PIC  N(004) VALUE NC"振替単価".           I.010803
002360     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002370     02  F              PIC  N(004) VALUE NC"予定売価".           I.010803
002380     02  F              PIC  X(003) VALUE " : ".                  I.010803
002390     02  F              PIC  X(013) VALUE SPACE.                  I.010803
002400     02  F              PIC  N(004) VALUE NC"　材料費".           I.010803
002410     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002420     02  F              PIC  N(004) VALUE NC"社内加工".           I.010803
002430     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002440     02  F              PIC  N(004) VALUE NC"社外加工".           I.010803
002450     02  F              PIC  N(004) VALUE NC"　直接費".           I.010803
002460     02  F              PIC  N(004) VALUE NC"　間接費".           I.010803
002470     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002480     02  F              PIC  N(004) VALUE NC"製造原価".           I.010803
002490     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002500     02  F              PIC  N(004) VALUE NC"振替単価".           I.010803
002510     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002520     02  F              PIC  N(004) VALUE NC"予定売価".           I.010803
002530     02  F              PIC  X(005) VALUE ""3FE04FE080"".         I.010803
002540 01  HEAD22.                                                      I.010803
002550     02  F              PIC  X(005) VALUE ""3FE04F40A0"".         I.010803
002560     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              I.010803
002570     02  F              PIC  N(008) VALUE NC"品　　　　　名　".   I.010803
002580     02  F              PIC  X(025) VALUE SPACE.                  I.010803
002590     02  F              PIC  N(004) VALUE NC"振替単価".           I.010803
002600     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002610     02  F              PIC  N(004) VALUE NC"予定売価".           I.010803
002620     02  F              PIC  X(009) VALUE SPACE.                  I.010803
002630     02  F              PIC  X(003) VALUE " : ".                  I.010803
002640     02  F              PIC  X(007) VALUE " ｺｰﾄﾞ  ".              I.010803
002650     02  F              PIC  N(008) VALUE NC"品　　　　　名　".   I.010803
002660     02  F              PIC  X(025) VALUE SPACE.                  I.010803
002670     02  F              PIC  N(004) VALUE NC"振替単価".           I.010803
002680     02  F              PIC  X(001) VALUE SPACE.                  I.010803
002690     02  F              PIC  N(004) VALUE NC"予定売価".           I.010803
002700     02  F              PIC  X(009) VALUE SPACE.                  I.010803
002710 01  W-P1.                                                        I.010803
002720     02  W-PD1   OCCURS  58.                                      I.010803
002730       03  P1-OD.                                                 I.010803
002740         04  P1-FHCD    PIC  9(006).                              I.010803
002750         04  F          PIC  X(001).                              I.010803
002760         04  P1-FNAME   PIC  N(024).                              I.010803
002770         04  F          PIC  X(011).                              I.010803
002780       03  P1-ODD   REDEFINES P1-OD.                              I.010803
002790         04  F          PIC  X(013).                              I.010803
002800         04  P1-FZRG    PIC ZZ,ZZ9.                               I.010803
002810         04  F          PIC  X(001).                              I.010803
002820         04  P1-FSKG    PIC ZZ,ZZ9.                               I.010803
002830         04  F          PIC  X(001).                              I.010803
002840         04  P1-FGKG    PIC ZZ,ZZ9.                               I.010803
002850         04  F          PIC  X(001).                              I.010803
002860         04  P1-FCSG    PIC Z,ZZ9.                                I.010803
002870         04  F          PIC  X(001).                              I.010803
002880         04  P1-FKNG    PIC Z,ZZ9.                                I.010803
002890         04  F          PIC  X(001).                              I.010803
002900         04  P1-FSZG    PIC ZZ,ZZ9.                               I.010803
002910         04  F          PIC  X(001).                              I.010803
002920         04  P1-FFT     PIC ZZ,ZZ9.                               I.010803
002930         04  F          PIC  X(001).                              I.010803
002940         04  P1-FSB     PIC ZZ,ZZ9.                               I.010803
002950       03  F            PIC  X(001).                              I.010803
002960       03  P1-MK        PIC  X(001).                              I.010803
002970       03  F            PIC  X(001).                              I.010803
002980       03  P1-UD.                                                 I.010803
002990         04  P1-RHCD    PIC  9(006).                              I.010803
003000         04  F          PIC  X(001).                              I.010803
003010         04  P1-RNAME   PIC  N(024).                              I.010803
003020         04  F          PIC  X(011).                              I.010803
003030       03  P1-UDD   REDEFINES P1-UD.                              I.010803
003040         04  F          PIC  X(013).                              I.010803
003050         04  P1-RZRG    PIC ZZ,ZZ9.                               I.010803
003060         04  F          PIC  X(001).                              I.010803
003070         04  P1-RSKG    PIC ZZ,ZZ9.                               I.010803
003080         04  F          PIC  X(001).                              I.010803
003090         04  P1-RGKG    PIC ZZ,ZZ9.                               I.010803
003100         04  F          PIC  X(001).                              I.010803
003110         04  P1-RCSG    PIC Z,ZZ9.                                I.010803
003120         04  F          PIC  X(001).                              I.010803
003130         04  P1-RKNG    PIC Z,ZZ9.                                I.010803
003140         04  F          PIC  X(001).                              I.010803
003150         04  P1-RSZG    PIC ZZ,ZZ9.                               I.010803
003160         04  F          PIC  X(001).                              I.010803
003170         04  P1-RFT     PIC ZZ,ZZ9.                               I.010803
003180         04  F          PIC  X(001).                              I.010803
003190         04  P1-RSB     PIC ZZ,ZZ9.                               I.010803
003200 01  W-P2.                                                        I.010803
003210     02  W-PD2   OCCURS  59.                                      I.010803
003220       03  P2-15K       PIC  X(005).                              I.010803
003230       03  P2-FHCD      PIC  9(006).                              I.010803
003240       03  F            PIC  X(001).                              I.010803
003250       03  P2-FNAME     PIC  N(024).                              I.010803
003260       03  F            PIC  X(001).                              I.010803
003270       03  P2-FFT       PIC ZZ,ZZ9.                               I.010803
003280       03  F            PIC  X(001).                              I.010803
003290       03  P2-FSB       PIC ZZ,ZZ9.                               I.010803
003300       03  F            PIC  X(009).                              I.010803
003310       03  F            PIC  X(001).                              I.010803
003320       03  P2-MK        PIC  X(001).                              I.010803
003330       03  F            PIC  X(001).                              I.010803
003340       03  P2-RHCD      PIC  9(006).                              I.010803
003350       03  F            PIC  X(001).                              I.010803
003360       03  P2-RNAME     PIC  N(024).                              I.010803
003370       03  F            PIC  X(001).                              I.010803
003380       03  P2-RFT       PIC ZZ,ZZ9.                               I.010803
003390       03  F            PIC  X(001).                              I.010803
003400       03  P2-RSB       PIC ZZ,ZZ9.                               I.010803
003410       03  F            PIC  X(009).                              I.010803
003420*****02  F              PIC  X(003) VALUE SPACE.                  D.010803
003430*****02  F              PIC  X(041) VALUE                         D.960510
003440*****     "E =  0:(A+B+C+D)*0.22  1:81  2:152  3:367".            D.960510
003450*****02  F              PIC  X(043) VALUE                         D.960913
003460*****     "E = 0:(A+B+C+D)*0.22 , 1:81 , 2:152 , 3:367".          D.960913
003470*****02  F              PIC  X(016) VALUE " , 4:279 , 5:360".     D.960913
003480*****02  F              PIC  X(016) VALUE "E = 0:(A+B+C+D)*".     D.000524
003490*****02  F              PIC  X(014) VALUE "E = (A+B+C+D)*".       D.010803
003500*****02  H-KKR          PIC 9.999.                                D.010803
003510*****02  F              PIC  X(013) VALUE " , # 印は固定".        D.010803
003520*****02  F              PIC  X(005) VALUE " , 1:".                D.000524
003530*****02  H-KNKH1        PIC ZZ9.                                  D.000524
003540*****02  F              PIC  X(005) VALUE " , 2:".                D.000524
003550*****02  H-KNKH2        PIC ZZ9.                                  D.000524
003560*****02  F              PIC  X(005) VALUE " , 3:".                D.000524
003570*****02  H-KNKH3        PIC ZZ9.                                  D.000524
003580*****02  F              PIC  X(005) VALUE " , 4:".                D.000524
003590*****02  H-KNKH4        PIC ZZ9.                                  D.000524
003600*****02  F              PIC  X(005) VALUE " , 5:".                D.000524
003610*****02  H-KNKH5        PIC ZZ9.                                  D.000524
003620*****02  F              PIC  X(005) VALUE " , 6:".                D.000524
003630*****02  H-KNKH6        PIC ZZ9.                                  D.000524
003640*****02  F              PIC  X(005) VALUE " , 7:".                D.000524
003650*****02  H-KNKH7        PIC ZZ9.                                  D.000524
003660*****02  F              PIC  X(005) VALUE " , 8:".                D.000524
003670*****02  H-KNKH8        PIC ZZ9.                                  D.000524
003680*****02  F              PIC  X(005) VALUE " , 9:".                D.000524
003690*****02  H-KNKH9        PIC ZZ9.                                  D.000524
003700*01  HEAD3.                                                       D.000524
003710*****02  F              PIC  X(108) VALUE SPACE.                  D.000524
003720*****02  F              PIC  X(018) VALUE "   F = A+B+C+D+E  ".   D.010803
003730*****02  F              PIC  N(001) VALUE NC"｝".                 D.010803
003740*01  HEAD4.                                                       D.010803
003750*****02  F              PIC  X(049) VALUE SPACE.                  D.010803
003760*****02  F              PIC  X(049) VALUE                         D.000524
003770*****     "-- A ------ B ------- C ---     D       E       F".    D.000524
003780*****02  F              PIC  X(050) VALUE                         D.010803
003790*****     "-- A ------ B ------- C ---     D       E        F".   D.010803
003800*****02  F              PIC  X(029) VALUE SPACE.                  D.010803
003810*01  HEAD5.                                                       D.010803
003820*****02  F              PIC  X(021) VALUE                         D.010803
003830*****     "       ｺｰﾄﾞ  品　　名".                                D.010803
003840*****02  F              PIC  X(029) VALUE SPACE.                  D.010803
003850*****02  F              PIC  X(007) VALUE "材料費 ".              D.010803
003860*****02  F              PIC  X(029) VALUE                         D.010803
003870*****     "社内加工　 外注加工 直接経費 ".                        D.010803
003880*****02  F              PIC  X(042) VALUE                         D.010803
003890*****     "間接費   製造原価　振替単価 　予定売価(SA)".           D.010803
003900*****02  F              PIC  X(041) VALUE                         D.000524
003910*****     "間接費　製造原価　振替単価 　予定売価(SA)".            D.000524
003920*01  HEAD6.                                                       D.010803
003930*****02  F              PIC  X(021) VALUE                         D.010803
003940*****     "       ｺｰﾄﾞ  品　　名".                                D.010803
003950*****02  F              PIC  X(030) VALUE SPACE.                  D.000524
003960*****02  F              PIC  X(031) VALUE SPACE.                  D.010803
003970*****02  F              PIC  X(023) VALUE                         D.010803
003980*****     "振替単価   予定売価(SA)".                              D.010803
003990*****02  F              PIC  X(053) VALUE SPACE.                  D.010803
004000*01  W-P.                                                         D.010803
004010*****02  P-15K          PIC  X(005).                              D.010803
004020*****02  P-NM           PIC  N(004).                              D.010803
004030*****02  P-HCD          PIC  X(006).                              D.010803
004040*****02  F              PIC  X(001).                              D.010803
004050*****02  P-NAME         PIC  N(024).                              D.010803
004060*****02  P-D1.                                                    D.010803
004070*****  03  P-ZI         PIC ZZZ,ZZ9.                              D.010803
004080*****  03  P-SK         PIC ZZZZZ,ZZ9.                            D.010803
004090*****  03  P-GK         PIC ZZZZZZZ,ZZ9.                          D.010803
004100*****02  P-D2    REDEFINES P-D1.                                  D.010803
004110*****  03  P-FT2        PIC ZZZZZZ,ZZ9.                           D.010803
004120*****  03  F            PIC  X(005).                              D.010803
004130*****  03  P-SA2        PIC ZZZZZZ,ZZ9.                           D.010803
004140*****  03  F            PIC  X(002).                              D.010803
004150*****02  P-CSG          PIC ZZZZZ,ZZ9.                            D.010803
004160*****02  P-KN           PIC ZZZ,ZZ9.                              D.010803
004170*****02  P-KNC          PIC  X(001).                              D.010803
004180*****02  P-SZG          PIC ZZZZZZ,ZZ9.                           D.010803
004190*****02  P-FT1          PIC ZZZZZZ,ZZ9.                           D.010803
004200*****02  F              PIC  X(005).                              D.010803
004210*****02  P-SA1          PIC ZZZZZZ,ZZ9.                           D.010803
004220*****02  P-20K          PIC  X(005).                              D.010803
004230 01  W-DATA.
004240     02  W-D.
004250       03  W-CSG        PIC  9(004).                              I.010803
004260       03  W-SZG        PIC  9(005).                              I.010803
004270*****  03  W-CSG        PIC  9(005).                              D.010803
004280*****  03  W-KN         PIC  9(005).                              D.010803
004290*****  03  W-SZG        PIC  9(006).                              D.010803
004300     02  W-ALL          PIC  9(006)V9(02).
004310     02  W-NC           PIC  9(001).
004320*****02  W-TS           PIC  9(004).                              D.941207
004330     02  W-TS           PIC  9(005).                              I.941207
004340     02  W-PAGE         PIC  9(002).
004350     02  W-DMM          PIC  9(001).
004360*****02  W-NM           PIC  N(004).                              D.960913
004370     02  CHK            PIC  9(001).
004380     02  W-PC           PIC  9(001).                              I.010803
004390     02  W-SHCD         PIC  9(006).                              I.010803
004400     02  W-EHCD         PIC  9(006).                              I.010803
004410     02  W-DC           PIC  9(001).                              I.010803
004420     02  W-MC           PIC  9(001).                              I.010803
004430     02  W-CKR          PIC  9(001)V9(03).                        I.010803
004440     02  W-LD           PIC  9(002).                              I.010803
004450     02  W-CD           PIC  9(001).                              I.010803
004460     02  W-POC          PIC  9(001) VALUE 0.                      I.010803
004470*****02  W-MSD.                                                   D.010803
004480*****  03  W-CKR        PIC  9(001)V9(03).                        D.010803
004490*****  03  W-KKR        PIC  9(001)V9(03).                        D.010803
004500*****  03  W-KNKH       PIC  9(003)     OCCURS  5.                D.970512
004510*****  03  W-KNKH       PIC  9(003)     OCCURS  9.                D.000524
004520     02  W-END          PIC  9(001) VALUE 0.                      I.960913
004530 01  ERR-STAT           PIC  X(002).
004540     COPY LSTAT.
004550 SCREEN SECTION.
004560 SD  C-CRT
004570     END STATUS IS ESTAT.
004580 01  C-CLEAR.
004590     02  LINE   1  CLEAR SCREEN.
004600 01  C-MID.
004610     02  LINE   3  COLUMN  10  PIC  N(022) VALUE
004620          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
004630     02  LINE   4  COLUMN  10  PIC  N(022) VALUE
004640          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
004650     02  LINE   5  COLUMN  10  PIC  N(022) VALUE
004660          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
004670     02  LINE   6  COLUMN  10  PIC  N(022) VALUE
004680          NC"＊＊＊　　履物品名製造原価　リスト　　＊＊＊".       I.010803
004690*****     NC"＊＊＊　　ＨＩＭ　製造原価　リスト　　＊＊＊".       D.010803
004700     02  LINE   7  COLUMN  10  PIC  N(022) VALUE
004710          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
004720     02  LINE   8  COLUMN  10  PIC  N(022) VALUE
004730          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
004740     02  LINE   9  COLUMN  10  PIC  N(022) VALUE
004750          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
004760     02  LINE  12.
004770       03  COLUMN  10  PIC  N(002) VALUE NC"内作".                I.010803
004780       03  COLUMN  14  PIC  X(007) VALUE " = 1 , ".               I.010803
004790       03  COLUMN  21  PIC  N(002) VALUE NC"輸入".                I.010803
004800       03  COLUMN  25  PIC  X(007) VALUE " = 2 , ".               I.010803
004810       03  COLUMN  32  PIC  N(002) VALUE NC"仕入".                I.010803
004820       03  COLUMN  36  PIC  X(007) VALUE " = 3 , ".               I.010803
004830       03  COLUMN  43  PIC  N(002) VALUE NC"終了".                I.010803
004840       03  COLUMN  47  PIC  X(007) VALUE " = 9   ".               I.010803
004850     02  LINE  15  COLUMN  19  PIC  X(026) VALUE                  I.010803
004860          "品名ｺｰﾄﾞ  000000 〜 999999".                           I.010803
004870     02  LINE  23  COLUMN  21  PIC  X(022) VALUE                  I.010803
004880          "確認  OK=1 NO=9   ﾘﾀｰﾝ".                               I.010803
004890*****  03  COLUMN  10  PIC  N(006) VALUE NC"＜内作・外作".        D.940607
004900*****  03  COLUMN  22  PIC  X(002) VALUE "=1".                    D.940607
004910*****  03  COLUMN  27  PIC  N(005) VALUE NC"仕入・輸入".          D.940607
004920*****  03  COLUMN  37  PIC  X(002) VALUE "=5".                    D.940607
004930*****  03  COLUMN  42  PIC  N(002) VALUE NC"終り".                D.940607
004940*****  03  COLUMN  46  PIC  X(009) VALUE "=9   ﾘﾀｰﾝ".             D.940607
004950*****  03  COLUMN  55  PIC  N(001) VALUE NC"＞".                  D.940607
004960*****  03  COLUMN  10  PIC  N(005) VALUE NC"＜　内外作".          D.010803
004970*****  03  COLUMN  20  PIC  X(004) VALUE "=1  ".                  D.010803
004980*****  03  COLUMN  24  PIC  N(002) VALUE NC"輸入".                D.010803
004990*****  03  COLUMN  28  PIC  X(001) VALUE "･".                     D.010803
005000*****  03  COLUMN  29  PIC  N(002) VALUE NC"仕入".                D.010803
005010*****  03  COLUMN  33  PIC  X(004) VALUE "=5  ".                  D.010803
005020*****  03  COLUMN  37  PIC  N(002) VALUE NC"終了".                D.010803
005030*****  03  COLUMN  41  PIC  X(011) VALUE "=9   ﾘﾀｰﾝ  ".           D.010803
005040*****  03  COLUMN  52  PIC  N(001) VALUE NC"＞".                  D.010803
005050 01  C-ACP.
005060     02  A-PC    LINE  12  COLUMN  53  PIC  9(001)                I.010803
005070          USING W-PC    CHECK OVERFLOW NO IFC.                    I.010803
005080     02  LINE  15.                                                I.010803
005090       03  A-SHCD  COLUMN  29  PIC  9(006)                        I.010803
005100            USING W-SHCD  CHECK OVERFLOW NO IFC.                  I.010803
005110       03  A-EHCD  COLUMN  39  PIC  9(006)                        I.010803
005120            USING W-EHCD  CHECK OVERFLOW NO IFC.                  I.010803
005130*****02  A-DMM   LINE  12  COLUMN  50  PIC  9(001)                D.940607
005140*****02  A-DMM   LINE  12  COLUMN  45  PIC  9(001)                D.010803
005150     02  A-DMM   LINE  23  COLUMN  38  PIC  9(001)                I.010803
005160          USING W-DMM   CHECK OVERFLOW NO IFC.
005170 01  C-ERR.
005180     02  LINE  24.
005190*****  03  E-ME1   COLUMN  15  PIC  N(019) VALUE                  D.970512
005200*****       NC"区分マスターの間接費が変更の為処理不可".           D.970512
005210       03  E-ME2   COLUMN  15  PIC  X(017) VALUE                  I.000524
005220            "***  HKBM ﾅｼ  ***".                                  I.000524
005230       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
005240       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
005250     COPY LIBSCR.
005260 PROCEDURE DIVISION.
005270 M-05.
005280     COPY LIBCPR.
005290     DISPLAY C-CLEAR.
005300     DISPLAY C-MID.
005310     OPEN INPUT HKBM.                                             I.960913
005320     PERFORM SET-RTN THRU SET-EX.                                 I.960913
005330     IF W-END = 9                                                 I.960913
005340         GO TO M-95.                                              I.010803
005350     MOVE DATE-02R TO H-DATE.                                     I.010803
005360*****    CLOSE HKBM                                               D.010803
005370*****    DISPLAY C-CLEAR                                          D.010803
005380*****    STOP RUN.                                                D.010803
005390     CALL "CBLSTNNO" USING STN-NO.                                I.950613
005400     MOVE STN-NO2 TO W-FID2.                                      I.950613
005410     MOVE W-FID TO WK0256ID.                                      I.970519
005420*****MOVE W-FID TO WK0512ID.                                      D.970519
005430 M-10.                                                            I.010803
005440     ACCEPT A-PC.                                                 I.010803
005450     IF ESTAT = PF9                                               I.010803
005460         GO TO M-95.                                              I.010803
005470     IF ESTAT NOT = HTB AND SKP                                   I.010803
005480         GO TO M-10.                                              I.010803
005490     IF W-PC = 9                                                  I.010803
005500         GO TO M-25.                                              I.010803
005510     IF W-PC NOT = 1 AND 2 AND 3                                  I.010803
005520         GO TO M-10.                                              I.010803
005530 M-15.                                                            I.010803
005540     ACCEPT A-SHCD.                                               I.010803
005550     IF ESTAT = BTB                                               I.010803
005560         GO TO M-10.                                              I.010803
005570     IF ESTAT NOT = HTB AND SKP                                   I.010803
005580         GO TO M-15.                                              I.010803
005590 M-20.                                                            I.010803
005600     ACCEPT A-EHCD.                                               I.010803
005610     IF ESTAT = BTB                                               I.010803
005620         GO TO M-15.                                              I.010803
005630     IF ESTAT NOT = HTB AND SKP                                   I.010803
005640         GO TO M-20.                                              I.010803
005650     IF W-SHCD > W-EHCD                                           I.010803
005660         GO TO M-20.                                              I.010803
005670 M-25.
005680     ACCEPT A-DMM.
005690     IF ESTAT = BTB                                               I.010803
005700         IF W-PC = 9                                              I.010803
005710             GO TO M-10                                           I.010803
005720           ELSE                                                   I.010803
005730             GO TO M-20.                                          I.010803
005740*****    GO TO M-05.                                              D.010803
005750     IF ESTAT NOT = HTB AND SKP
005760         GO TO M-25.
005770     IF W-DMM = 9
005780         GO TO M-10.                                              I.010803
005790*****    GO TO M-95.                                              D.010803
005800*****IF W-DMM NOT = 1 AND 5                                       D.010803
005810     IF W-DMM NOT = 1                                             I.010803
005820         GO TO M-25.
005830     IF W-PC = 9                                                  I.010803
005840         GO TO M-95.                                              I.010803
005850*M-27.                                                            D.010803
005860     OPEN INPUT HI-M.
005870     IF W-PC = 1                                                  I.010803
005880         MOVE SPACE TO W-P1                                       I.010803
005890       ELSE                                                       I.010803
005900         PERFORM SPC-RTN THRU SPC-EX.                             I.010803
005910     MOVE ZERO TO W-LD W-CD.                                      I.010803
005920*****OPEN OUTPUT SP-F.                                            D.010803
005930*****MOVE DATE-02R TO H-DATE.                                     D.010803
005940*****MOVE ZERO TO W-PAGE.                                         D.010803
005950*****PERFORM MID-020 THRU MID-EX.                                 D.010803
005960 M-30.
005970     READ HI-M AT END
005980         GO TO M-45.                                              I.010803
005990*****    GO TO M-44.                                              D.010803
006000     IF I-ENG NOT = ZERO
006010         GO TO M-30.
006020*****IF I-NC NOT = 0 AND 1 AND 2 AND 3                            D.940607
006030*****IF I-NC NOT = 1 AND 2 AND 3                                  D.010803
006040     IF I-NC NOT = W-PC                                           I.010803
006050         GO TO M-30.
006060     IF I-HCD < W-SHCD OR > W-EHCD                                I.010803
006070         GO TO M-30.                                              I.010803
006080*****IF W-DMM = 5                                                 D.960913
006090*****    GO TO M-33.                                              D.960913
006100*****IF W-DMM = 1                                                 D.010803
006110*****    IF I-NC > 1                                              D.010803
006120*****    GO TO M-44.                                              D.960913
006130*****        GO TO M-44                                           D.010803
006140*****      ELSE                                                   D.010803
006150*****        GO TO M-34.                                          D.010803
006160*M-33.                                                            D.960913
006170*****IF I-NC < 2                                                  D.010803
006180*****    GO TO M-30.                                              D.010803
006190*M-34.                                                            D.010803
006200*****MOVE I-NC TO W-NC.                                           D.010803
006210*****MOVE ZERO TO CHK.                                            D.010803
006220     MOVE SPACE TO HKB-KEY.                                       I.960913
006230     MOVE 13 TO HKB-NO.                                           I.960913
006240     MOVE W-PC TO HKB-BR22.                                       I.010803
006250*****MOVE W-NC TO HKB-BR22.                                       D.010803
006260     READ HKBM WITH UNLOCK INVALID KEY                            I.960913
006270         MOVE NC"　　　" TO HKB-BRN22.                            I.960913
006280     MOVE HKB-BRN22 TO H-NM.                                      I.010803
006290*****IF W-NC = 0                                                  D.940607
006300*****    MOVE NC"内　作　" TO W-NM.                               D.940607
006310*****IF W-NC = 1                                                  D.960913
006320*****    MOVE NC"内外作　" TO W-NM.                               D.960913
006330*****    MOVE NC"外　作　" TO W-NM.                               D.940607
006340*****IF W-NC = 2                                                  D.960913
006350*****    MOVE NC"輸　入　" TO W-NM.                               D.960913
006360*****IF W-NC = 3                                                  D.960913
006370*****    MOVE NC"仕　入　" TO W-NM.                               D.960913
006380 M-35.
006390     PERFORM MOV-RTN THRU MOV-EX.
006400 M-40.
006410     READ HI-M AT END
006420         GO TO M-45.                                              I.010803
006430*****    GO TO M-44.                                              D.010803
006440     IF I-ENG NOT = ZERO
006450         GO TO M-40.
006460*****IF I-NC NOT = 0 AND 1 AND 2 AND 3                            D.940607
006470*****IF I-NC NOT = 1 AND 2 AND 3                                  D.010803
006480     IF I-NC NOT = W-PC                                           I.010803
006490         GO TO M-40.
006500     IF I-HCD < W-SHCD OR > W-EHCD                                I.010803
006510         GO TO M-40.                                              I.010803
006520     GO TO M-35.                                                  I.010803
006530*****IF W-DMM = 5                                                 D.960913
006540*****    GO TO M-42.                                              D.960913
006550*****IF W-DMM = 1                                                 D.010803
006560*****    IF I-NC > 1                                              D.010803
006570*****    GO TO M-44.                                              D.960913
006580*****        GO TO M-44                                           D.010803
006590*****      ELSE                                                   D.010803
006600*****        GO TO M-43.                                          D.010803
006610*M-42.                                                            D.960913
006620*****IF I-NC < 2                                                  D.010803
006630*****    GO TO M-40.                                              D.010803
006640*M-43.                                                            D.010803
006650*****IF W-NC = I-NC                                               D.010803
006660*****    GO TO M-35.                                              D.010803
006670*****MOVE SPACE TO SP-R.                                          D.010803
006680*****WRITE SP-R.                                                  D.010803
006690*****GO TO M-34.                                                  D.010803
006700*M-44.                                                            D.010803
006710*****CLOSE HI-M.                                                  D.010803
006720*****CLOSE SP-F.                                                  D.010803
006730 M-45.                                                            I.010803
006740     IF W-LD NOT = ZERO                                           I.010803
006750         PERFORM PRI-RTN THRU PRI-EX.                             I.010803
006760     CLOSE HI-M.                                                  I.010803
006770     IF W-POC NOT = 0                                             I.010803
006780         MOVE 0 TO W-POC                                          I.010803
006790         CLOSE SP-F.                                              I.010803
006800     GO TO M-10.
006810 M-95.
006820     CLOSE HKBM.                                                  I.960913
006830     DISPLAY C-CLEAR.
006840     STOP RUN.
006850*----------------  見出し　印字　-----------------------------------------
006860 MID-RTN.
006870     MOVE SPACE TO SP-R.
006880     WRITE SP-R AFTER PAGE.
006890 MID-020.
006900     ADD 1 TO W-PAGE.
006910     MOVE W-PAGE TO H-PAGE.
006920     MOVE SPACE TO SP-R.
006930     MOVE HEAD1 TO SP-R.
006940     WRITE SP-R.
006950     MOVE SPACE TO SP-R.
006960*****IF W-DMM = 1                                                 D.010803
006970*****    MOVE HEAD2 TO SP-R                                       D.010803
006980     IF W-PC = 1                                                  I.010803
006990         MOVE HEAD21 TO SP-R                                      I.010803
007000         WRITE SP-R AFTER 2
007010         MOVE SPACE TO SP-R
007020*****    MOVE HEAD3 TO SP-R                                       D.000524
007030*****    WRITE SP-R                                               D.000524
007040*****    MOVE SPACE TO SP-R                                       D.000524
007050*****    MOVE HEAD4 TO SP-R                                       D.010803
007060         MOVE HEAD31 TO SP-R                                      I.010803
007070         WRITE SP-R
007080*****    MOVE SPACE TO SP-R                                       D.010803
007090*****    MOVE HEAD5 TO SP-R                                       D.010803
007100*****    WRITE SP-R                                               D.010803
007110       ELSE
007120*****    MOVE HEAD6 TO SP-R                                       D.010803
007130         MOVE HEAD22 TO SP-R                                      I.010803
007140         WRITE SP-R AFTER 2.
007150     MOVE SPACE TO SP-R.
007160 MID-EX.
007170     EXIT.
007180*----------------  明細　印字　-------------------------------------------
007190 MOV-RTN.
007200*****MOVE SPACE TO W-P.                                           D.010803
007210*****MOVE W-15K TO P-15K.                                         D.010803
007220*****MOVE W-20K TO P-20K.                                         D.010803
007230*****MOVE SPACE TO P-NM P-NAME.                                   D.010803
007240*****IF CHK = ZERO                                                D.010803
007250*****    MOVE 5 TO CHK                                            D.010803
007260*****    MOVE W-NM TO P-NM.                                       D.960913
007270*****    MOVE HKB-BRN22 TO P-NM.                                  D.010803
007280*****MOVE I-HCD TO P-HCD.                                         D.010803
007290*****MOVE I-NAME TO P-NAME.                                       D.010803
007300*****MOVE ZERO TO W-TS.                                           D.010803
007310*****IF I-TS1 NOT = ZERO                                          D.010803
007320*****    MOVE I-TS1 TO W-TS.                                      D.010803
007330*****IF I-TS2 NOT = ZERO                                          D.010803
007340*****    MOVE I-TS2 TO W-TS.                                      D.010803
007350*****IF I-TS3 NOT = ZERO                                          D.010803
007360*****    MOVE I-TS3 TO W-TS.                                      D.010803
007370*****IF I-TS4 NOT = ZERO                                          D.010803
007380*****    MOVE I-TS4 TO W-TS.                                      D.010803
007390*****IF W-DMM = 5                                                 D.010803
007400*****    MOVE I-FT TO P-FT2                                       D.010803
007410*****    MOVE W-TS TO P-SA2                                       D.010803
007420*****  ELSE                                                       D.010803
007430*****    MOVE I-FT TO P-FT1                                       D.010803
007440*****    MOVE W-TS TO P-SA1.                                      D.010803
007450*****IF W-DMM = 5                                                 D.010803
007460*****    GO TO MOV-020.                                           D.010803
007470     PERFORM GYO-RTN THRU GYO-EX.                                 I.010803
007480     IF W-PC NOT = 1                                              I.010803
007490         GO TO MOV-020.                                           I.010803
007500     IF W-CD = 0                                                  I.010803
007510         MOVE ":" TO P1-MK(W-LD)                                  I.010803
007520         MOVE I-HCD TO P1-FHCD(W-LD)                              I.010803
007530         MOVE I-NAME TO P1-FNAME(W-LD)                            I.010803
007540       ELSE                                                       I.010803
007550         MOVE I-HCD TO P1-RHCD(W-LD)                              I.010803
007560         MOVE I-NAME TO P1-RNAME(W-LD).                           I.010803
007570     MOVE ZERO TO W-D.
007580*****MOVE I-ZRG TO P-ZI.                                          D.010803
007590*****MOVE I-SKG TO P-SK.                                          D.010803
007600*****MOVE I-GKG TO P-GK.                                          D.010803
007610*****COMPUTE W-ALL ROUNDED = I-SKG * 0.11.                        D.960510
007620*****COMPUTE W-ALL ROUNDED = I-SKG * 0.125.                       D.960913
007630     COMPUTE W-ALL ROUNDED = I-SKG * W-CKR.                       I.960913
007640     COMPUTE W-ALL = W-ALL + 0.99.
007650     MOVE W-ALL TO W-CSG.
007660     COMPUTE W-SZG = I-ZRG + I-SKG + I-GKG + W-CSG + I-KNG.       I.010803
007670*****MOVE W-CSG TO P-CSG.                                         D.010803
007680*****MOVE ZERO TO W-ALL.                                          D.010803
007690*****IF I-KNC = 0                                                 D.010803
007700*****    COMPUTE W-ALL ROUNDED =                                  D.010803
007710*****                     (I-ZRG + I-SKG + I-GKG + W-CSG) * W-KKR D.010803
007720*****  ELSE                                                       D.010803
007730*****    MOVE I-KNG TO W-ALL.                                     D.010803
007740*****                                                    * W-KKR. D.000524
007750*****                                                    * 0.22.  D.960913
007760*****IF I-KNC = 1                                                 D.960913
007770*****    MOVE 81 TO W-ALL.                                        D.960913
007780*****IF I-KNC = 2                                                 D.960913
007790*****    MOVE 152 TO W-ALL.                                       D.960913
007800*****IF I-KNC = 3                                                 D.960913
007810*****    MOVE 367 TO W-ALL.                                       D.960913
007820*****IF I-KNC = 4                                                 D.960913
007830*****    MOVE 286 TO W-ALL.                                       D.960510
007840*****    MOVE 279 TO W-ALL.                                       D.960913
007850*****IF I-KNC = 5                                                 D.960913
007860*****    MOVE 360 TO W-ALL.                                       D.960913
007870*****IF I-KNC NOT = 0                                             D.000524
007880*****    MOVE W-KNKH(I-KNC) TO W-ALL.                             D.000524
007890*****COMPUTE W-ALL = W-ALL + 0.99.                                D.010803
007900*****MOVE W-ALL TO W-KN.                                          D.010803
007910*****MOVE W-KN TO P-KN.                                           D.010803
007920*****IF I-KNC NOT = 0                                             D.010803
007930******   MOVE "#" TO P-KNC.                                       D.010803
007940*****COMPUTE W-SZG = I-ZRG + I-SKG + I-GKG + W-CSG + W-KN.        D.010803
007950*****MOVE W-SZG TO P-SZG.                                         D.010803
007960     PERFORM GYO-RTN THRU GYO-EX.                                 I.010803
007970     IF W-CD = 0                                                  I.010803
007980         MOVE ":" TO P1-MK(W-LD)                                  I.010803
007990         MOVE I-ZRG TO P1-FZRG(W-LD)                              I.010803
008000         MOVE I-SKG TO P1-FSKG(W-LD)                              I.010803
008010         MOVE I-GKG TO P1-FGKG(W-LD)                              I.010803
008020         MOVE W-CSG TO P1-FCSG(W-LD)                              I.010803
008030         MOVE I-KNG TO P1-FKNG(W-LD)                              I.010803
008040         MOVE W-SZG TO P1-FSZG(W-LD)                              I.010803
008050         MOVE I-FT TO P1-FFT(W-LD)                                I.010803
008060         MOVE I-SB TO P1-FSB(W-LD)                                I.010803
008070       ELSE                                                       I.010803
008080         MOVE I-ZRG TO P1-RZRG(W-LD)                              I.010803
008090         MOVE I-SKG TO P1-RSKG(W-LD)                              I.010803
008100         MOVE I-GKG TO P1-RGKG(W-LD)                              I.010803
008110         MOVE W-CSG TO P1-RCSG(W-LD)                              I.010803
008120         MOVE I-KNG TO P1-RKNG(W-LD)                              I.010803
008130         MOVE W-SZG TO P1-RSZG(W-LD)                              I.010803
008140         MOVE I-FT TO P1-RFT(W-LD)                                I.010803
008150         MOVE I-SB TO P1-RSB(W-LD).                               I.010803
008160     GO TO MOV-EX.                                                I.010803
008170 MOV-020.
008180     IF W-CD = 0                                                  I.010803
008190         MOVE ":" TO P2-MK(W-LD)                                  I.010803
008200         MOVE I-HCD TO P2-FHCD(W-LD)                              I.010803
008210         MOVE I-NAME TO P2-FNAME(W-LD)                            I.010803
008220         MOVE I-FT TO P2-FFT(W-LD)                                I.010803
008230         MOVE I-SB TO P2-FSB(W-LD)                                I.010803
008240       ELSE                                                       I.010803
008250         MOVE I-HCD TO P2-RHCD(W-LD)                              I.010803
008260         MOVE I-NAME TO P2-RNAME(W-LD)                            I.010803
008270         MOVE I-FT TO P2-RFT(W-LD)                                I.010803
008280         MOVE I-SB TO P2-RSB(W-LD).                               I.010803
008290*****IF LINAGE-COUNTER > 60                                       D.010803
008300*****    MOVE HKB-BRN22 TO P-NM                                   D.010803
008310*****    MOVE W-NM TO P-NM                                        D.960913
008320*****    PERFORM MID-RTN THRU MID-EX.                             D.010803
008330*****MOVE SPACE TO SP-R.                                          D.010803
008340*****MOVE W-P TO SP-R.                                            D.010803
008350*****WRITE SP-R.                                                  D.010803
008360*****MOVE SPACE TO SP-R.                                          D.010803
008370 MOV-EX.
008380     EXIT.
008390*----------------  ＷＯＲＫ・見出し　セット　-----------------------------
008400 SET-RTN.                                                         I.960913
008410*****MOVE ZERO TO W-MSD.                                          D.010803
008420     MOVE SPACE TO HKB-KEY.                                       I.960913
008430     MOVE 19 TO HKB-NO.                                           I.000524
008440     READ HKBM WITH UNLOCK INVALID KEY                            I.000524
008450         DISPLAY E-ME2 E-ME99                                     I.000524
008460         MOVE ZERO TO HKB-CKR.                                    I.010803
008470*****    MOVE ZERO TO HKB-CKR HKB-KKR.                            D.010803
008480     MOVE HKB-CKR TO W-CKR H-CKR.                                 I.000524
008490*****MOVE HKB-KKR TO W-KKR H-KKR.                                 D.010803
008500*****MOVE 18 TO HKB-NO.                                           D.000524
008510*****START HKBM KEY NOT < HKB-KEY INVALID KEY                     D.000524
008520*****    GO TO SET-040.                                           D.000524
008530*SET-020.                                                         D.000524
008540*****READ HKBM NEXT WITH UNLOCK AT END                            D.000524
008550*****    GO TO SET-040.                                           D.000524
008560*****IF HKB-NO > 19                                               D.000524
008570*****    GO TO SET-040.                                           D.000524
008580*****IF HKB-NO = 19                                               D.000524
008590*****    MOVE HKB-CKR TO W-CKR                                    D.000524
008600*****    MOVE HKB-KKR TO W-KKR                                    D.000524
008610*****    GO TO SET-040.                                           D.000524
008620*****IF HKB-KNC = 0                                               D.000524
008630*****    GO TO SET-020.                                           D.000524
008640*****IF HKB-KNC > 5                                               D.970512
008650*****    MOVE 9 TO W-END                                          D.970512
008660*****    DISPLAY E-ME1 E-ME99                                     D.970512
008670*****    GO TO SET-EX.                                            D.970512
008680*****MOVE HKB-KNKH TO W-KNKH(HKB-KNC).                            D.000524
008690*****GO TO SET-020.                                               D.000524
008700*SET-040.                                                         D.000524
008710*****MOVE W-CKR TO H-CKR.                                         D.000524
008720*****MOVE W-KKR TO H-KKR.                                         D.000524
008730*****MOVE W-KNKH(1) TO H-KNKH1.                                   D.000524
008740*****MOVE W-KNKH(2) TO H-KNKH2.                                   D.000524
008750*****MOVE W-KNKH(3) TO H-KNKH3.                                   D.000524
008760*****MOVE W-KNKH(4) TO H-KNKH4.                                   D.000524
008770*****MOVE W-KNKH(5) TO H-KNKH5.                                   D.000524
008780*****MOVE W-KNKH(6) TO H-KNKH6.                                   D.000524
008790*****MOVE W-KNKH(7) TO H-KNKH7.                                   D.000524
008800*****MOVE W-KNKH(8) TO H-KNKH8.                                   D.000524
008810*****MOVE W-KNKH(9) TO H-KNKH9.                                   D.000524
008820 SET-EX.                                                          I.960913
008830     EXIT.                                                        I.960913
008840*----------------  ＰＲＩＮＴ行　セット　---------------------------------
008850 GYO-RTN.                                                         I.010803
008860     ADD 1 TO W-LD.                                               I.010803
008870     IF W-PC = 1                                                  I.010803
008880         IF W-LD NOT = 59                                         I.010803
008890             GO TO GYO-EX.                                        I.010803
008900     IF W-PC NOT = 1                                              I.010803
008910         IF W-LD NOT = 60                                         I.010803
008920                 GO TO GYO-EX.                                    I.010803
008930     IF W-CD = 0                                                  I.010803
008940         MOVE 1 TO W-CD                                           I.010803
008950         MOVE ZERO TO W-LD W-MC                                   I.010803
008960         GO TO GYO-RTN.                                           I.010803
008970     PERFORM PRI-RTN THRU PRI-EX.                                 I.010803
008980     IF W-PC = 1                                                  I.010803
008990         MOVE SPACE TO W-P1                                       I.010803
009000       ELSE                                                       I.010803
009010         PERFORM SPC-RTN THRU SPC-EX.                             I.010803
009020     MOVE ZERO TO W-LD W-CD W-MC.                                 I.010803
009030     GO TO GYO-RTN.                                               I.010803
009040 GYO-EX.                                                          I.010803
009050     EXIT.                                                        I.010803
009060*----------------  ＰＲＩＮＴ  -------------------------------------------
009070 PRI-RTN.                                                         I.010803
009080     IF W-POC = 0                                                 I.010803
009090         MOVE 5 TO W-POC                                          I.010803
009100         OPEN OUTPUT SP-F                                         I.010803
009110         PERFORM MID-020 THRU MID-EX                              I.010803
009120       ELSE                                                       I.010803
009130         PERFORM MID-RTN THRU MID-EX.                             I.010803
009140     MOVE ZERO TO W-LD.                                           I.010803
009150 PRI-020.                                                         I.010803
009160     ADD 1 TO W-LD.                                               I.010803
009170     IF W-PC = 1                                                  I.010803
009180         IF W-LD = 59                                             I.010803
009190             GO TO PRI-EX.                                        I.010803
009200     IF W-PC NOT = 1                                              I.010803
009210         IF W-LD = 60                                             I.010803
009220             GO TO PRI-EX.                                        I.010803
009230     IF W-PC = 1                                                  I.010803
009240         IF P1-MK(W-LD) = SPACE                                   I.010803
009250             GO TO PRI-EX.                                        I.010803
009260     IF W-PC NOT = 1                                              I.010803
009270         IF P2-MK(W-LD) = SPACE                                   I.010803
009280             GO TO PRI-EX.                                        I.010803
009290     MOVE SPACE TO SP-R.                                          I.010803
009300     IF W-PC = 1                                                  I.010803
009310         MOVE W-PD1(W-LD) TO SP-R                                 I.010803
009320       ELSE                                                       I.010803
009330         MOVE W-PD2(W-LD) TO SP-R.                                I.010803
009340     WRITE SP-R.                                                  I.010803
009350     MOVE SPACE TO SP-R.                                          I.010803
009360     GO TO PRI-020.                                               I.010803
009370 PRI-EX.                                                          I.010803
009380     EXIT.                                                        I.010803
009390*----------------  Ｗ−Ｐ２　クリア  -------------------------------------
009400 SPC-RTN.                                                         I.010803
009410     MOVE SPACE TO W-P2.                                          I.010803
009420     MOVE ZERO TO W-LD.                                           I.010803
009430 SPC-020.                                                         I.010803
009440     ADD 1 TO W-LD.                                               I.010803
009450     IF W-LD NOT = 60                                             I.010803
009460         MOVE W-15K TO P2-15K(W-LD)                               I.010803
009470         MOVE SPACE TO P2-FNAME(W-LD) P2-RNAME(W-LD)              I.010803
009480         GO TO SPC-020.                                           I.010803
009490 SPC-EX.                                                          I.010803
009500     EXIT.                                                        I.010803
