000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMY930.
000030*********************************************************
000040*    PROGRAM         :  年間履物品名サイズ別　受払表    *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  ******                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*    JS-SIGN         :  作表=0 , EXCEL変換=1            *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT HHTF ASSIGN TO HHT-MSD.
000180     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000190         ORGANIZATION IS INDEXED
000200         ACCESS MODE IS DYNAMIC
000210         RECORD KEY IS HI-KEY
000220         ALTERNATE RECORD KEY IS HI-KEY2
000230         FILE STATUS IS ERR-STAT.
000240     SELECT EXL-F ASSIGN TO EXL-MSD.
000250     SELECT SP-F ASSIGN TO P-PRN999.
000260 I-O-CONTROL.
000270     APPLY SHARED-MODE ON M-DATE
000280     APPLY SHARED-MODE ON HI-M
000290     APPLY SHIFT-CODE  ON SP-F.
000300 DATA DIVISION.
000310 FILE SECTION.
000320     COPY LIBFDD.
000330     COPY LIHIM.
000340     COPY LSPF.
000350 FD  HHTF
000360     BLOCK  1 RECORDS
000370     LABEL RECORD IS STANDARD
000380     VALUE OF IDENTIFICATION WK0512ID.
000390 01  HHT-R.
000400     02  HHT-KEY.
000410       03  HHT-HCD      PIC  9(006).                              品名ｺｰﾄﾞ
000420       03  HHT-HCDD  REDEFINES HHT-HCD.
000430         04  HHT-HCD1   PIC  9(004).
000440         04  HHT-HCD2   PIC  9(002).
000450       03  HHT-SIZ      PIC  9(001).                              ｻｲｽﾞ区分
000460     02  HHT-AZSU.                                                前月残数
000470       03  HHT-ZSUD  OCCURS  10.
000480         04  HHT-ZSU    PIC S9(006)  COMP-3.
000490     02  HHT-ANSU.                                                入庫数
000500       03  HHT-NSUD  OCCURS  10.
000510         04  HHT-NSU    PIC S9(006)  COMP-3.
000520     02  HHT-AUSU.                                                出庫数
000530       03  HHT-USUD  OCCURS  10.
000540         04  HHT-USU    PIC S9(006)  COMP-3.
000550     02  HHT-AYSU.                                                前月残数
000560       03  HHT-YSUD  OCCURS  10.
000570         04  HHT-YSU    PIC S9(006)  COMP-3.
000580     02  F              PIC  9(002).
000590     02  HHT-SNEN       PIC  9(002).
000600     02  HHT-SGET       PIC  9(002).
000610     02  F              PIC  9(002).
000620     02  HHT-ENEN       PIC  9(002).
000630     02  HHT-EGET       PIC  9(002).
000640     02  HHT-BCD1.
000650       03  HHT-BC1      PIC  9(002).
000660       03  HHT-BC21     PIC  9(001).
000670     02  HHT-BC22       PIC  9(001).
000680     02  HHT-BC3        PIC  9(002).                              分類CD3
000690     02  HHT-BMNO       PIC  9(001).
000700     02  F              PIC  X(070).
000710     02  F              PIC  X(256).
000720 FD  EXL-F
000730     BLOCK  1 RECORDS
000740     LABEL RECORD IS STANDARD
000750     VALUE OF IDENTIFICATION "WK0256000".
000760 01  EXL-R.
000770     02  EXL-HCD        PIC  9(006).
000780     02  EXL-HNA        PIC  N(024).
000790     02  EXL-KBN        PIC  N(002).
000800     02  EXL-SIZ        PIC  9(001).
000810     02  EXL-ASU.
000820       03  EXL-SUD  OCCURS  10.
000830         04  EXL-SU     PIC S9(006).
000840       03  EXL-SUT      PIC S9(007).
000850     02  EXL-FT         PIC  9(005).
000860     02  EXL-KIN        PIC S9(010).
000870     02  F              PIC  X(115).
000880 WORKING-STORAGE SECTION.
000890 77  JS-SIGN            PIC  9(001).
000900 77  WK0512ID           PIC  X(009) VALUE SPACE.
000910 01  STN-NO.
000920     02  STN-NO1        PIC  X(003).
000930     02  STN-NO2        PIC  X(003).
000940 01  W-FID.
000950     02  W-FID1         PIC  X(006) VALUE "WK0512".
000960     02  W-FID2         PIC  X(003).
000970 01  HEAD1.
000980     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
000990     02  F              PIC  N(002) VALUE NC"【　".
001000     02  F              PIC  X(001) VALUE "'".
001010     02  H-SNEN         PIC  9(002).
001020     02  F              PIC  N(001) VALUE NC"年".
001030     02  H-SGET         PIC Z9.
001040     02  F              PIC  N(001) VALUE NC"月".
001050     02  F              PIC  X(001) VALUE SPACE.
001060     02  F              PIC  N(001) VALUE NC"〜".
001070     02  F              PIC  X(001) VALUE SPACE.
001080     02  F              PIC  X(001) VALUE "'".
001090     02  H-ENEN         PIC  9(002).
001100     02  F              PIC  N(001) VALUE NC"年".
001110     02  H-EGET         PIC Z9.
001120     02  F              PIC  N(001) VALUE NC"月".
001130     02  F              PIC  N(002) VALUE NC"　】".
001140     02  F              PIC  X(007) VALUE SPACE.
001150     02  F              PIC  N(025) VALUE
001160          NC"＊＊＊　　履物　年間品名サイズ別　受払表　　＊＊＊".
001170     02  F              PIC  X(024) VALUE SPACE.
001180     02  F              PIC  X(005) VALUE "DATE ".
001190     02  H-DATE         PIC 99B99B99.
001200     02  F              PIC  X(007) VALUE "     P.".
001210     02  H-PAGE         PIC ZZ9.
001220 01  HEAD2.
001230     02  W-15K          PIC  X(005) VALUE ""3FE04F40A0"".
001240     02  F              PIC  X(004) VALUE SPACE.
001250     02  F              PIC  X(006) VALUE "ｺｰﾄﾞ  ".
001260     02  F              PIC  N(006) VALUE NC"品　　　名　".
001270     02  F              PIC  X(003) VALUE SPACE.
001280     02  F              PIC  X(001) VALUE "1".
001290     02  F              PIC  X(016) VALUE SPACE.
001300     02  F              PIC  X(004) VALUE SPACE.
001310     02  F              PIC  X(004) VALUE "  SS".
001320     02  F              PIC  X(004) VALUE SPACE.
001330     02  F              PIC  X(004) VALUE "   S".
001340     02  F              PIC  X(004) VALUE SPACE.
001350     02  F              PIC  X(004) VALUE "   M".
001360     02  F              PIC  X(004) VALUE SPACE.
001370     02  F              PIC  X(004) VALUE "   L".
001380     02  F              PIC  X(004) VALUE SPACE.
001390     02  F              PIC  X(004) VALUE "  LL".
001400     02  F              PIC  X(004) VALUE SPACE.
001410     02  F              PIC  X(004) VALUE "28.0".
001420     02  F              PIC  X(004) VALUE SPACE.
001430     02  F              PIC  X(004) VALUE "29.0".
001440     02  F              PIC  X(004) VALUE SPACE.
001450     02  F              PIC  X(004) VALUE "30.0".
001460     02  F              PIC  X(031) VALUE SPACE.
001470 01  HEAD3.
001480     02  F              PIC  X(022) VALUE SPACE.
001490     02  F              PIC  X(001) VALUE "2".
001500     02  F              PIC  X(004) VALUE SPACE.
001510     02  F              PIC  X(004) VALUE "12.5".
001520     02  F              PIC  X(004) VALUE SPACE.
001530     02  F              PIC  X(004) VALUE "13.0".
001540     02  F              PIC  X(004) VALUE SPACE.
001550     02  F              PIC  X(004) VALUE "13.5".
001560     02  F              PIC  X(004) VALUE SPACE.
001570     02  F              PIC  X(004) VALUE "14.0".
001580     02  F              PIC  X(004) VALUE SPACE.
001590     02  F              PIC  X(004) VALUE "15.0".
001600     02  F              PIC  X(004) VALUE SPACE.
001610     02  F              PIC  X(004) VALUE "16.0".
001620     02  F              PIC  X(004) VALUE SPACE.
001630     02  F              PIC  X(004) VALUE "17.0".
001640     02  F              PIC  X(004) VALUE SPACE.
001650     02  F              PIC  X(004) VALUE "18.0".
001660     02  F              PIC  X(004) VALUE SPACE.
001670     02  F              PIC  X(004) VALUE "19.0".
001680     02  F              PIC  X(004) VALUE SPACE.
001690     02  F              PIC  X(004) VALUE "20.0".
001700     02  F              PIC  X(031) VALUE SPACE.
001710 01  HEAD4.
001720     02  F              PIC  X(022) VALUE SPACE.
001730     02  F              PIC  X(001) VALUE "3".
001740     02  F              PIC  X(004) VALUE SPACE.
001750     02  F              PIC  X(004) VALUE "21.0".
001760     02  F              PIC  X(004) VALUE SPACE.
001770     02  F              PIC  X(004) VALUE "21.5".
001780     02  F              PIC  X(004) VALUE SPACE.
001790     02  F              PIC  X(004) VALUE "22.0".
001800     02  F              PIC  X(004) VALUE SPACE.
001810     02  F              PIC  X(004) VALUE "22.5".
001820     02  F              PIC  X(004) VALUE SPACE.
001830     02  F              PIC  X(004) VALUE "23.0".
001840     02  F              PIC  X(004) VALUE SPACE.
001850     02  F              PIC  X(004) VALUE "23.5".
001860     02  F              PIC  X(004) VALUE SPACE.
001870     02  F              PIC  X(004) VALUE "24.0".
001880     02  F              PIC  X(004) VALUE SPACE.
001890     02  F              PIC  X(004) VALUE "24.5".
001900     02  F              PIC  X(004) VALUE SPACE.
001910     02  F              PIC  X(004) VALUE "25.0".
001920     02  F              PIC  X(039) VALUE SPACE.
001930 01  HEAD5.
001940     02  F              PIC  X(022) VALUE SPACE.
001950     02  F              PIC  X(001) VALUE "4".
001960     02  F              PIC  X(004) VALUE SPACE.
001970     02  F              PIC  X(004) VALUE "24.0".
001980     02  F              PIC  X(004) VALUE SPACE.
001990     02  F              PIC  X(004) VALUE "24.5".
002000     02  F              PIC  X(004) VALUE SPACE.
002010     02  F              PIC  X(004) VALUE "25.0".
002020     02  F              PIC  X(004) VALUE SPACE.
002030     02  F              PIC  X(004) VALUE "25.5".
002040     02  F              PIC  X(004) VALUE SPACE.
002050     02  F              PIC  X(004) VALUE "26.0".
002060     02  F              PIC  X(004) VALUE SPACE.
002070     02  F              PIC  X(004) VALUE "26.5".
002080     02  F              PIC  X(004) VALUE SPACE.
002090     02  F              PIC  X(004) VALUE "27.0".
002100     02  F              PIC  X(004) VALUE SPACE.
002110     02  F              PIC  X(004) VALUE "27.5".
002120     02  F              PIC  X(013) VALUE SPACE.
002130     02  F              PIC  X(003) VALUE SPACE.
002140     02  F              PIC  X(004) VALUE SPACE.
002150     02  F              PIC  N(004) VALUE NC"　合　計".
002160     02  F              PIC  X(001) VALUE SPACE.
002170     02  F              PIC  N(004) VALUE NC"振替単価".
002180     02  F              PIC  X(008) VALUE SPACE.
002190     02  F              PIC  N(004) VALUE NC"振替金額".
002200     02  W-20K          PIC  X(005) VALUE ""3FE04FE080"".
002210 01  W-P1.
002220     02  F              PIC  X(003).
002230     02  P-HCD          PIC  9(006).
002240     02  F              PIC  X(001).
002250     02  P-HNA          PIC  N(024).
002260     02  F              PIC  X(076).
002270 01  W-P2.
002280     02  P-TM           PIC  N(007).
002290     02  F              PIC  X(001).
002300     02  P-UHM          PIC  N(003).
002310     02  F              PIC  X(001).
002320     02  P-SIZ          PIC  9(001).
002330     02  P-SUD.
002340       03  P-SU         PIC ----,--9  OCCURS  10 TIMES.
002350     02  P-SUT          PIC --,---,--9.
002360     02  P-FT           PIC ZZZ,ZZ9.
002370     02  P-KIN          PIC --,---,---,--9.
002380 01  W-DATA.
002390     02  W-SHCD         PIC  9(006).
002400     02  W-EHCD         PIC  9(006) VALUE 999999.                 I.151118
002410*****02  W-EHCD         PIC  9(006).                              D.151118
002420     02  W-DMM          PIC  9(001).
002430     02  W-HCD          PIC  9(006).
002440     02  CNT            PIC  9(002).
002450     02  W-DZC          PIC  9(001).
002460     02  W-PAGE         PIC  9(003) VALUE ZERO.
002470     02  W-BC3          PIC  9(002).
002480     02  W-BMNO         PIC  9(001).
002490     02  W-BC1          PIC  9(002).
002500     02  W-C            PIC  9(001).
002510     02  W-CC           PIC  9(001).
002520     02  W-MC           PIC  9(001) VALUE 0.
002530     02  W-HC           PIC  9(001).
002540     02  W-SC           PIC  9(001).
002550     02  W-ZCD.
002560       03  W-ZC    OCCURS   4  PIC  9(001).
002570     02  W-SU           PIC S9(006).
002580     02  W-NG.
002590       03  W-NEN        PIC  9(004).
002600       03  W-NEND  REDEFINES W-NEN.
002610         04  W-NEN1     PIC  9(002).
002620         04  W-NEN2     PIC  9(002).
002630       03  W-GET        PIC  9(002).
002640     02  W-NGD   REDEFINES W-NG.
002650       03  F            PIC  9(002).
002660       03  W-NGS        PIC  9(004).
002670 01  W-D.
002680     02  W-AZC.
002690       03  W-ZZCD.
002700         04  W-ZZC   OCCURS   4  PIC  9(001).
002710       03  W-NZCD.
002720         04  W-NZC   OCCURS   4  PIC  9(001).
002730       03  W-SZCD.
002740         04  W-SZC   OCCURS   4  PIC  9(001).
002750       03  W-YZCD.
002760         04  W-YZC   OCCURS   4  PIC  9(001).
002770     02  W-ASUD.
002780       03  W-ASU   OCCURS   4.
002790         04  W-ZSU   OCCURS  10  PIC S9(006).
002800         04  W-NSU   OCCURS  10  PIC S9(006).
002810         04  W-SSU   OCCURS  10  PIC S9(006).
002820         04  W-YSU   OCCURS  10  PIC S9(006).
002830     02  W-SUTD.
002840       03  W-SUT   OCCURS   4  PIC S9(007).
002850     02  W-KIND.
002860       03  W-KIN   OCCURS   4  PIC S9(010).
002870 01  WA-D.
002880     02  WA-AZC.
002890       03  WA-ZZCD.
002900         04  WA-ZZC   OCCURS   4  PIC  9(001).
002910       03  WA-NZCD.
002920         04  WA-NZC   OCCURS   4  PIC  9(001).
002930       03  WA-SZCD.
002940         04  WA-SZC   OCCURS   4  PIC  9(001).
002950       03  WA-YZCD.
002960         04  WA-YZC   OCCURS   4  PIC  9(001).
002970     02  WA-SUD.
002980       03  WA-SU    OCCURS   4.
002990         04  WA-ZSU   OCCURS  10  PIC S9(006).
003000         04  WA-NSU   OCCURS  10  PIC S9(006).
003010         04  WA-SSU   OCCURS  10  PIC S9(006).
003020         04  WA-YSU   OCCURS  10  PIC S9(006).
003030     02  WA-SUTD.
003040       03  WA-SUT   OCCURS   4  PIC S9(007).
003050     02  WA-KIND.
003060       03  WA-KIN   OCCURS   4  PIC S9(010).
003070 01  ERR-STAT           PIC  X(002).
003080     COPY LSTAT.
003090 SCREEN SECTION.
003100 SD  C-CRT
003110     END STATUS IS ESTAT.
003120 01  C-CLEAR.
003130     02  C-CL    LINE   1  CLEAR SCREEN.
003140 01  C-MID.
003150     02  LINE   3  COLUMN  10  PIC  N(022) VALUE
003160          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003170     02  LINE   4  COLUMN  10  PIC  N(022) VALUE
003180          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003190     02  LINE   5  COLUMN  10  PIC  N(022) VALUE
003200          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003210     02  LINE   6  COLUMN  10  PIC  N(022) VALUE
003220          NC"＊＊＊　　年間品名サイズ別　受払表　　＊＊＊".
003230     02  LINE   7  COLUMN  10  PIC  N(022) VALUE
003240          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
003250     02  LINE   8  COLUMN  10  PIC  N(022) VALUE
003260          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003270     02  LINE   9  COLUMN  10  PIC  N(022) VALUE
003280          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
003290     02  LINE  12  COLUMN  19  PIC  X(024) VALUE
003300          "'  年   月 〜 '  年   月".
003310     02  LINE  15  COLUMN  19  PIC  X(026) VALUE
003320          "品名ｺｰﾄﾞ  000000 〜 999999".
003330     02  LINE  22  COLUMN  34  PIC X(22) VALUE
003340          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
003350 01  C-ACP.
003360     02  LINE  15.
003370       03  A-SHCD  COLUMN  29  PIC  9(006)
003380            USING W-SHCD  CHECK OVERFLOW NO IFC.
003390       03  A-EHCD  COLUMN  39  PIC  9(006)
003400            USING W-EHCD  CHECK OVERFLOW NO IFC.
003410     02  A-DMM   LINE  22  COLUMN  51  PIC  9(001)
003420          USING W-DMM   CHECK OVERFLOW NO IFC.
003430 01  C-DSP.
003440     02  D-NG    LINE  12.
003450       03  COLUMN  20  PIC  9(002) FROM  HHT-SNEN.
003460       03  COLUMN  25  PIC Z9      FROM  HHT-SGET.
003470       03  COLUMN  34  PIC  9(002) FROM  HHT-ENEN.
003480       03  COLUMN  39  PIC Z9      FROM  HHT-EGET.
003490     02  D-EXL   LINE   7  COLUMN  10  PIC  N(022) VALUE
003500          NC"＊＊＊　　（　ＥＸＣＥＬ　変換　）　　＊＊＊".
003510 01  C-ERR.
003520     02  LINE  24.
003530       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
003540       03  E-ME1   COLUMN  15  PIC  X(017) VALUE
003550            "***  DATA ﾅｼ  ***".
003560       03  E-ME5   COLUMN  15  PIC  X(018) VALUE
003570            "***  DATA ｴﾗｰ  ***".
003580       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
003590       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
003600       03  E-CL    COLUMN  10  PIC  X(050) VALUE
003610            "                                                  ".
003620     COPY LIBSCR.
003630 PROCEDURE DIVISION.
003640 M-05.
003650     ACCEPT JS-SIGN.
003660     IF JS-SIGN > 1
003670         STOP RUN.
003680     DISPLAY C-CLEAR.
003690     DISPLAY C-MID.
003700     IF JS-SIGN = 1
003710         DISPLAY D-EXL.
003720     CALL "CBLSTNNO" USING STN-NO.
003730     MOVE STN-NO2 TO W-FID2.
003740     MOVE W-FID TO WK0512ID.
003750     OPEN INPUT HHTF.
003760     READ HHTF AT END
003770         CLOSE HHTF
003780         DISPLAY E-ME1 E-ME99
003790         GO TO M-95.
003800     DISPLAY D-NG.
003810     IF JS-SIGN = 0
003820         MOVE HHT-SNEN TO H-SNEN
003830         MOVE HHT-SGET TO H-SGET
003840         MOVE HHT-ENEN TO H-ENEN
003850         MOVE HHT-EGET TO H-EGET.
003860     CLOSE HHTF.
003870 M-10.
003880     ACCEPT A-SHCD.
003890     IF ESTAT = PF9 OR C2
003900         GO TO M-95.
003910     IF ESTAT NOT = HTB AND SKP
003920         GO TO M-10.
003930 M-15.
003940     ACCEPT A-EHCD.
003950     IF ESTAT = PF9 OR C2
003960         GO TO M-95.
003970     IF ESTAT = BTB
003980         GO TO M-10.
003990     IF ESTAT NOT = HTB AND SKP
004000         GO TO M-15.
004010     IF W-SHCD > W-EHCD
004020         GO TO M-15.
004030 M-20.
004040     ACCEPT A-DMM.
004050     IF ESTAT = BTB
004060         GO TO M-15.
004070     IF ESTAT NOT = HTB AND SKP
004080         GO TO M-20.
004090     IF W-DMM = 9
004100         GO TO M-10.
004110     IF W-DMM NOT = 1
004120         GO TO M-20.
004130     DISPLAY C-CLEAR.
004140     DISPLAY C-MID.
004150     IF JS-SIGN = 1
004160         DISPLAY D-EXL.
004170     DISPLAY D-NG A-SHCD A-EHCD A-DMM.
004180*
004190     OPEN INPUT HHTF.
004200     OPEN INPUT HI-M.
004210 M-30.
004220     READ HHTF AT END
004230         DISPLAY E-ME1 E-ME99
004240         CLOSE HHTF
004250         CLOSE HI-M
004260         GO TO M-95.
004270     IF HHT-HCD < W-SHCD OR > W-EHCD
004280         GO TO M-30.
004290     MOVE HHT-HCD TO HI-KEY.
004300     READ HI-M WITH UNLOCK INVALID KEY
004310         MOVE 1 TO HI-OL.
004320     IF HI-OL = 1
004330         GO TO M-30.
004340     PERFORM CHK-RTN THRU CHK-EX.
004350     IF W-DZC = 0
004360         GO TO M-30.
004370*
004380     IF JS-SIGN = 1
004390         OPEN OUTPUT EXL-F
004400         GO TO M-35.
004410     COPY LIBCPR.
004420     MOVE DATE-02R TO H-DATE.
004430     OPEN OUTPUT SP-F.
004440     PERFORM MID-020 THRU MID-EX.
004450 M-35.
004460     MOVE ZERO TO WA-D W-C.
004470     MOVE HHT-BC3 TO W-BC3.
004480     MOVE HHT-BMNO TO W-BMNO.
004490     MOVE HHT-BC1 TO W-BC1.
004500 M-40.
004510     MOVE ZERO TO W-D W-HC.
004520     MOVE HHT-HCD TO W-HCD.
004530 M-45.
004540     PERFORM SET-RTN THRU SET-EX.
004550 M-50.
004560     READ HHTF AT END
004570         GO TO M-90.
004580     IF HHT-HCD < W-SHCD OR > W-EHCD
004590         GO TO M-50.
004600     MOVE HHT-HCD TO HI-KEY.
004610     READ HI-M WITH UNLOCK INVALID KEY
004620         MOVE 1 TO HI-OL.
004630     IF HI-OL = 1
004640         GO TO M-50.
004650     PERFORM CHK-RTN THRU CHK-EX.
004660     IF W-DZC = 0
004670         GO TO M-50.
004680     IF (HHT-BC3 NOT = W-BC3) OR (HHT-BMNO NOT = W-BMNO) OR
004690        (HHT-BC1 NOT = W-BC1)
004700         GO TO M-55.
004710     IF HHT-HCD = W-HCD
004720         GO TO M-45.
004730     IF JS-SIGN = 0
004740         PERFORM PR2-RTN THRU PR2-EX
004750       ELSE
004760         PERFORM PRE-RTN THRU PRE-EX.
004770     GO TO M-40.
004780 M-55.
004790     IF JS-SIGN = 0
004800         PERFORM PR2-RTN THRU PR2-EX
004810         PERFORM KEI-RTN THRU KEI-EX
004820       ELSE
004830         PERFORM PRE-RTN THRU PRE-EX
004840         PERFORM KEE-RTN THRU KEE-EX.
004850     GO TO M-35.
004860 M-90.
004870     IF JS-SIGN = 0
004880         PERFORM PR2-RTN THRU PR2-EX
004890         PERFORM KEI-RTN THRU KEI-EX
004900       ELSE
004910         PERFORM PRE-RTN THRU PRE-EX
004920         PERFORM KEE-RTN THRU KEE-EX.
004930     CLOSE HI-M.
004940     CLOSE HHTF.
004950     IF JS-SIGN = 1
004960         CLOSE EXL-F
004970       ELSE
004980         CLOSE SP-F.
004990 M-95.
005000     DISPLAY C-CLEAR.
005010     STOP RUN.
005020 MID-RTN.
005030     MOVE SPACE TO SP-R.
005040     WRITE SP-R AFTER PAGE.
005050 MID-020.
005060     ADD 1 TO W-PAGE.
005070     MOVE W-PAGE TO H-PAGE.
005080     MOVE SPACE TO SP-R.
005090     MOVE HEAD1 TO SP-R.
005100     WRITE SP-R.
005110     MOVE SPACE TO SP-R.
005120     MOVE HEAD2 TO SP-R.
005130     WRITE SP-R AFTER 2.
005140     MOVE SPACE TO SP-R.
005150     MOVE HEAD3 TO SP-R.
005160     WRITE SP-R.
005170     MOVE SPACE TO SP-R.
005180     MOVE HEAD4 TO SP-R.
005190     WRITE SP-R.
005200     MOVE SPACE TO SP-R.
005210     MOVE HEAD5 TO SP-R.
005220     WRITE SP-R.
005230     MOVE SPACE TO SP-R.
005240 MID-EX.
005250     EXIT.
005260 CHK-RTN.
005270     MOVE ZERO TO W-DZC CNT.
005280 CHK-020.
005290     ADD 1 TO CNT.
005300     IF CNT = 11
005310         GO TO CHK-EX.
005320     IF HHT-SIZ = 4
005330         IF CNT = 10
005340             GO TO CHK-020.
005350     IF ZERO = HHT-ZSU(CNT) AND HHT-NSU(CNT)
005360                            AND HHT-USU(CNT) AND HHT-YSU(CNT)
005370         GO TO CHK-020.
005380     MOVE 1 TO W-DZC.
005390 CHK-EX.
005400     EXIT.
005410 SET-RTN.
005420     MOVE ZERO TO CNT.
005430 SET-020.
005440     ADD 1 TO CNT.
005450     IF CNT = 11
005460         GO TO SET-EX.
005470     IF HHT-ZSU(CNT) NOT = ZERO
005480         MOVE 1 TO W-ZZC(HHT-SIZ) WA-ZZC(HHT-SIZ)
005490         ADD HHT-ZSU(CNT) TO
005500                           W-ZSU(HHT-SIZ,CNT) WA-ZSU(HHT-SIZ,CNT)
005510                           W-SUT(1) WA-SUT(1).
005520     IF HHT-NSU(CNT) NOT = ZERO
005530         MOVE 1 TO W-NZC(HHT-SIZ) WA-NZC(HHT-SIZ)
005540         ADD HHT-NSU(CNT) TO
005550                           W-NSU(HHT-SIZ,CNT) WA-NSU(HHT-SIZ,CNT)
005560                           W-SUT(2) WA-SUT(2).
005570     IF HHT-USU(CNT) NOT = ZERO
005580         MOVE 1 TO W-SZC(HHT-SIZ) WA-SZC(HHT-SIZ)
005590         ADD HHT-USU(CNT) TO
005600                           W-SSU(HHT-SIZ,CNT) WA-SSU(HHT-SIZ,CNT)
005610                           W-SUT(3) WA-SUT(3).
005620     IF HHT-YSU(CNT) NOT = ZERO
005630         MOVE 1 TO W-YZC(HHT-SIZ) WA-YZC(HHT-SIZ)
005640         ADD HHT-YSU(CNT) TO
005650                           W-YSU(HHT-SIZ,CNT) WA-YSU(HHT-SIZ,CNT)
005660                           W-SUT(4) WA-SUT(4).
005670     GO TO SET-020.
005680 SET-EX.
005690     EXIT.
005700 PR1-RTN.
005710     MOVE W-HCD TO HI-KEY.
005720     READ HI-M WITH UNLOCK INVALID KEY
005730         MOVE ZERO TO HI-FT
005740         MOVE NC"　＊＊　ＨＩＭ　なし　＊＊　" TO HI-NAME.
005750     MOVE SPACE TO W-P1.
005760     MOVE W-HCD TO P-HCD.
005770     MOVE HI-NAME TO P-HNA.
005780     IF LINAGE-COUNTER > 59
005790         PERFORM MID-RTN THRU MID-EX.
005800     MOVE SPACE TO SP-R.
005810     MOVE W-P1 TO SP-R.
005820     WRITE SP-R.
005830     MOVE SPACE TO SP-R.
005840     MOVE 1 TO W-HC.
005850 PR1-EX.
005860     EXIT.
005870 PR2-RTN.
005880     MOVE ZERO TO W-SC.
005890 PR2-020.
005900     ADD 1 TO W-SC.
005910     IF W-SC > 4
005920         GO TO PR2-EX.
005930     MOVE ZERO TO W-CC W-MC.
005940 PR2-040.
005950     ADD 1 TO W-CC.
005960     IF W-CC > 4
005970         GO TO PR2-020.
005980     MOVE ZERO TO CNT.
005990 PR2-060.
006000     ADD 1 TO CNT.
006010     IF CNT > 10
006020         GO TO PR2-040.
006030     IF W-SC = 1
006040         MOVE W-ZSU(W-CC,CNT) TO W-SU.
006050     IF W-SC = 2
006060         MOVE W-NSU(W-CC,CNT) TO W-SU.
006070     IF W-SC = 3
006080         MOVE W-SSU(W-CC,CNT) TO W-SU.
006090     IF W-SC = 4
006100         MOVE W-YSU(W-CC,CNT) TO W-SU.
006110     IF W-SU = ZERO
006120         GO TO PR2-060.
006130     MOVE SPACE TO W-P2.
006140     MOVE W-CC TO P-SIZ.
006150     MOVE ZERO TO CNT.
006160 PR2-080.
006170     ADD 1 TO CNT.
006180     IF CNT > 10
006190         GO TO PR2-100.
006200     IF (W-CC = 3) AND (CNT = 10)
006210         GO TO PR2-080.
006220     IF (W-CC = 4) AND (CNT > 8)
006230         GO TO PR2-080.
006240     IF W-SC = 1
006250         MOVE W-ZSU(W-CC,CNT) TO W-SU.
006260     IF W-SC = 2
006270         MOVE W-NSU(W-CC,CNT) TO W-SU.
006280     IF W-SC = 3
006290         MOVE W-SSU(W-CC,CNT) TO W-SU.
006300     IF W-SC = 4
006310         MOVE W-YSU(W-CC,CNT) TO W-SU.
006320     MOVE W-SU TO P-SU(CNT).
006330     GO TO PR2-080.
006340 PR2-100.
006350     IF W-HC = 0
006360         PERFORM PR1-RTN THRU PR1-EX.
006370     IF LINAGE-COUNTER NOT > 60
006380         GO TO PR2-120.
006390     MOVE 0 TO W-MC.
006400     PERFORM MID-RTN THRU MID-EX.
006410     PERFORM PR1-RTN THRU PR1-EX.
006420 PR2-120.
006430     IF W-SC = 1
006440         MOVE W-ZZCD TO W-ZCD
006450         IF W-MC = 0
006460             MOVE 1 TO W-MC
006470             MOVE NC"前残　" TO P-UHM
006480             IF W-HC = 1
006490                 MOVE 9 TO W-HC.
006500     IF W-SC = 2
006510         MOVE W-NZCD TO W-ZCD
006520         IF W-MC = 0
006530             MOVE 1 TO W-MC
006540             MOVE NC"入庫　" TO P-UHM
006550             IF W-HC = 9
006560                 MOVE SPACE TO SP-R
006570                 WRITE SP-R
006580               ELSE
006590                 MOVE 9 TO W-HC.
006600     IF W-SC = 3
006610         MOVE W-SZCD TO W-ZCD
006620         IF W-MC = 0
006630             MOVE 1 TO W-MC
006640             MOVE NC"出庫　" TO P-UHM
006650             IF W-HC = 9
006660                 MOVE SPACE TO SP-R
006670                 WRITE SP-R
006680               ELSE
006690                 MOVE 9 TO W-HC.
006700     IF W-SC = 4
006710         MOVE W-YZCD TO W-ZCD
006720         IF W-MC = 0
006730             MOVE 1 TO W-MC
006740             MOVE NC"在庫　" TO P-UHM
006750             IF W-HC = 9
006760                 MOVE SPACE TO SP-R
006770                 WRITE SP-R.
006780*
006790     IF W-CC = 1
006800         IF ZERO NOT = W-ZC(2) OR W-ZC(3) OR W-ZC(4)
006810             GO TO PR2-140.
006820     IF W-CC = 2
006830         IF ZERO NOT = W-ZC(3) OR W-ZC(4)
006840             GO TO PR2-140.
006850     IF W-CC = 3
006860         IF ZERO NOT = W-ZC(4)
006870             GO TO PR2-140.
006880     MOVE W-SUT(W-SC) TO P-SUT.
006890     MOVE HI-FT TO P-FT.
006900     COMPUTE W-KIN(W-SC) = W-SUT(W-SC) * HI-FT.
006910     MOVE W-KIN(W-SC) TO P-KIN.
006920     ADD W-KIN(W-SC) TO WA-KIN(W-SC).
006930 PR2-140.
006940     IF W-SC = 1
006950         IF ZERO = W-NZCD AND W-SZCD
006960             MOVE 1 TO W-HC
006970             GO TO PR2-040.
006980     MOVE SPACE TO SP-R.
006990     MOVE W-P2 TO SP-R.
007000     WRITE SP-R.
007010     MOVE SPACE TO SP-R.
007020     GO TO PR2-040.
007030 PR2-EX.
007040     EXIT.
007050 KEI-RTN.
007060     MOVE ZERO TO W-SC W-HC.
007070 KEI-020.
007080     ADD 1 TO W-SC.
007090     IF W-SC > 4
007100         GO TO KEI-160.
007110     MOVE ZERO TO W-CC W-MC.
007120 KEI-040.
007130     ADD 1 TO W-CC.
007140     IF W-CC > 4
007150         GO TO KEI-020.
007160     MOVE ZERO TO CNT.
007170 KEI-060.
007180     ADD 1 TO CNT.
007190     IF CNT > 10
007200         GO TO KEI-040.
007210     IF W-SC = 1
007220         MOVE WA-ZSU(W-CC,CNT) TO W-SU.
007230     IF W-SC = 2
007240         MOVE WA-NSU(W-CC,CNT) TO W-SU.
007250     IF W-SC = 3
007260         MOVE WA-SSU(W-CC,CNT) TO W-SU.
007270     IF W-SC = 4
007280         MOVE WA-YSU(W-CC,CNT) TO W-SU.
007290     IF W-SU = ZERO
007300         GO TO KEI-060.
007310     MOVE SPACE TO W-P2.
007320     MOVE W-CC TO P-SIZ.
007330     MOVE ZERO TO CNT.
007340 KEI-080.
007350     ADD 1 TO CNT.
007360     IF CNT > 10
007370         GO TO KEI-100.
007380     IF (W-CC = 3) AND (CNT = 10)
007390         GO TO KEI-080.
007400     IF (W-CC = 4) AND (CNT > 8)
007410         GO TO KEI-080.
007420     IF W-SC = 1
007430         MOVE WA-ZSU(W-CC,CNT) TO W-SU.
007440     IF W-SC = 2
007450         MOVE WA-NSU(W-CC,CNT) TO W-SU.
007460     IF W-SC = 3
007470         MOVE WA-SSU(W-CC,CNT) TO W-SU.
007480     IF W-SC = 4
007490         MOVE WA-YSU(W-CC,CNT) TO W-SU.
007500     MOVE W-SU TO P-SU(CNT).
007510     GO TO KEI-080.
007520 KEI-100.
007530     IF W-HC = 0
007540         MOVE 1 TO W-HC
007550         MOVE NC"【　合　計　】" TO P-TM.
007560     IF LINAGE-COUNTER NOT > 60
007570         GO TO KEI-120.
007580     MOVE 0 TO W-MC.
007590     PERFORM MID-RTN THRU MID-EX.
007600     MOVE 1 TO W-HC.
007610     MOVE NC"【　合　計　】" TO P-TM.
007620 KEI-120.
007630     IF W-SC = 1
007640         MOVE WA-ZZCD TO W-ZCD
007650         IF W-MC = 0
007660             MOVE 1 TO W-MC
007670             MOVE NC"前残　" TO P-UHM
007680             IF W-HC = 1
007690                 MOVE 9 TO W-HC.
007700     IF W-SC = 2
007710         MOVE WA-NZCD TO W-ZCD
007720         IF W-MC = 0
007730             MOVE 1 TO W-MC
007740             MOVE NC"入庫　" TO P-UHM
007750             IF W-HC = 9
007760                 MOVE SPACE TO SP-R
007770                 WRITE SP-R
007780               ELSE
007790                 MOVE 9 TO W-HC.
007800     IF W-SC = 3
007810         MOVE WA-SZCD TO W-ZCD
007820         IF W-MC = 0
007830             MOVE 1 TO W-MC
007840             MOVE NC"出庫　" TO P-UHM
007850             IF W-HC = 9
007860                 MOVE SPACE TO SP-R
007870                 WRITE SP-R
007880               ELSE
007890                 MOVE 9 TO W-HC.
007900     IF W-SC = 4
007910         MOVE WA-YZCD TO W-ZCD
007920         IF W-MC = 0
007930             MOVE 1 TO W-MC
007940             MOVE NC"在庫　" TO P-UHM
007950             IF W-HC = 9
007960                 MOVE SPACE TO SP-R
007970                 WRITE SP-R.
007980*
007990     IF W-CC = 1
008000         IF ZERO NOT = W-ZC(2) OR W-ZC(3) OR W-ZC(4)
008010             GO TO KEI-140.
008020     IF W-CC = 2
008030         IF ZERO NOT = W-ZC(3) OR W-ZC(4)
008040             GO TO KEI-140.
008050     IF W-CC = 3
008060         IF ZERO NOT = W-ZC(4)
008070             GO TO KEI-140.
008080     MOVE WA-SUT(W-SC) TO P-SUT.
008090     MOVE WA-KIN(W-SC) TO P-KIN.
008100 KEI-140.
008110     IF W-SC = 1
008120         IF ZERO = WA-NZCD AND WA-SZCD
008130             MOVE 0 TO W-HC
008140             GO TO KEI-040.
008150     MOVE SPACE TO SP-R.
008160     MOVE W-P2 TO SP-R.
008170     WRITE SP-R.
008180     MOVE SPACE TO SP-R.
008190     GO TO KEI-040.
008200 KEI-160.
008210     MOVE SPACE TO SP-R.
008220     WRITE SP-R.
008230 KEI-EX.
008240     EXIT.
008250*------------------- ＥＸＣＥＬ変換 --------------------------------------
008260 PRE-RTN.
008270     MOVE W-HCD TO HI-KEY.
008280     READ HI-M WITH UNLOCK INVALID KEY
008290         MOVE ZERO TO HI-FT
008300         MOVE NC"　＊＊　ＨＩＭ　なし　＊＊　" TO HI-NAME.
008310     MOVE ZERO TO W-SC.
008320 PRE-020.
008330     ADD 1 TO W-SC.
008340     IF W-SC > 4
008350         GO TO PRE-EX.
008360     MOVE ZERO TO W-CC W-MC.
008370 PRE-040.
008380     ADD 1 TO W-CC.
008390     IF W-CC > 4
008400         GO TO PRE-020.
008410     MOVE ZERO TO CNT.
008420 PRE-060.
008430     ADD 1 TO CNT.
008440     IF CNT > 10
008450         GO TO PRE-040.
008460     IF W-SC = 1
008470         MOVE W-ZSU(W-CC,CNT) TO W-SU.
008480     IF W-SC = 2
008490         MOVE W-NSU(W-CC,CNT) TO W-SU.
008500     IF W-SC = 3
008510         MOVE W-SSU(W-CC,CNT) TO W-SU.
008520     IF W-SC = 4
008530         MOVE W-YSU(W-CC,CNT) TO W-SU.
008540     IF W-SU = ZERO
008550         GO TO PRE-060.
008560*
008570     MOVE SPACE TO EXL-R.
008580     MOVE SPACE TO EXL-HNA EXL-KBN.
008590     MOVE ZERO TO EXL-ASU EXL-FT EXL-KIN.
008600     MOVE W-CC TO EXL-SIZ.
008610     MOVE ZERO TO CNT.
008620 PRE-080.
008630     ADD 1 TO CNT.
008640     IF CNT > 10
008650         GO TO PRE-100.
008660     IF (W-CC = 3) AND (CNT = 10)
008670         GO TO PRE-080.
008680     IF (W-CC = 4) AND (CNT > 8)
008690         GO TO PRE-080.
008700     IF W-SC = 1
008710         MOVE W-ZSU(W-CC,CNT) TO W-SU.
008720     IF W-SC = 2
008730         MOVE W-NSU(W-CC,CNT) TO W-SU.
008740     IF W-SC = 3
008750         MOVE W-SSU(W-CC,CNT) TO W-SU.
008760     IF W-SC = 4
008770         MOVE W-YSU(W-CC,CNT) TO W-SU.
008780     MOVE W-SU TO EXL-SU(CNT).
008790     GO TO PRE-080.
008800 PRE-100.
008810     IF W-HC NOT = 0
008820         GO TO PRE-120.
008830     MOVE W-HCD TO EXL-HCD.
008840     MOVE HI-NAME TO EXL-HNA.
008850     MOVE 1 TO W-HC.
008860 PRE-120.
008870     IF W-SC = 1
008880         MOVE W-ZZCD TO W-ZCD
008890         IF W-MC = 0
008900             MOVE 1 TO W-MC
008910             MOVE NC"前残" TO EXL-KBN
008920             IF W-HC = 1
008930                 MOVE 9 TO W-HC.
008940     IF W-SC = 2
008950         MOVE W-NZCD TO W-ZCD
008960         IF W-MC = 0
008970             MOVE 1 TO W-MC
008980             MOVE NC"入庫" TO EXL-KBN
008990             IF W-HC = 1
009000                 MOVE 9 TO W-HC.
009010     IF W-SC = 3
009020         MOVE W-SZCD TO W-ZCD
009030         IF W-MC = 0
009040             MOVE 1 TO W-MC
009050             MOVE NC"出庫" TO EXL-KBN
009060             IF W-HC = 1
009070                 MOVE 9 TO W-HC.
009080     IF W-SC = 4
009090         MOVE W-YZCD TO W-ZCD
009100         IF W-MC = 0
009110             MOVE 1 TO W-MC
009120             MOVE NC"在庫" TO EXL-KBN.
009130*
009140     IF W-CC = 1
009150         IF ZERO NOT = W-ZC(2) OR W-ZC(3) OR W-ZC(4)
009160             GO TO PRE-140.
009170     IF W-CC = 2
009180         IF ZERO NOT = W-ZC(3) OR W-ZC(4)
009190             GO TO PRE-140.
009200     IF W-CC = 3
009210         IF ZERO NOT = W-ZC(4)
009220             GO TO PRE-140.
009230     MOVE W-SUT(W-SC) TO EXL-SUT.
009240     MOVE HI-FT TO EXL-FT.
009250     COMPUTE W-KIN(W-SC) = W-SUT(W-SC) * HI-FT.
009260     MOVE W-KIN(W-SC) TO EXL-KIN.
009270     ADD W-KIN(W-SC) TO WA-KIN(W-SC).
009280 PRE-140.
009290     IF W-SC = 1
009300         IF ZERO = W-NZCD AND W-SZCD
009310             MOVE 0 TO W-HC
009320             GO TO PRE-040.
009330     WRITE EXL-R.
009340     GO TO PRE-040.
009350 PRE-EX.
009360     EXIT.
009370 KEE-RTN.
009380     MOVE ZERO TO W-SC W-HC.
009390 KEE-020.
009400     ADD 1 TO W-SC.
009410     IF W-SC > 4
009420         GO TO KEE-EX.
009430     MOVE ZERO TO W-CC W-MC.
009440 KEE-040.
009450     ADD 1 TO W-CC.
009460     IF W-CC > 4
009470         GO TO KEE-020.
009480     MOVE ZERO TO CNT.
009490 KEE-060.
009500     ADD 1 TO CNT.
009510     IF CNT > 10
009520         GO TO KEE-040.
009530     IF W-SC = 1
009540         MOVE WA-ZSU(W-CC,CNT) TO W-SU.
009550     IF W-SC = 2
009560         MOVE WA-NSU(W-CC,CNT) TO W-SU.
009570     IF W-SC = 3
009580         MOVE WA-SSU(W-CC,CNT) TO W-SU.
009590     IF W-SC = 4
009600         MOVE WA-YSU(W-CC,CNT) TO W-SU.
009610     IF W-SU = ZERO
009620         GO TO KEE-060.
009630*
009640     MOVE SPACE TO EXL-R.
009650     MOVE SPACE TO EXL-HNA EXL-KBN.
009660     MOVE ZERO TO EXL-ASU EXL-FT EXL-KIN.
009670     MOVE W-CC TO EXL-SIZ.
009680     MOVE ZERO TO CNT.
009690 KEE-080.
009700     ADD 1 TO CNT.
009710     IF CNT > 10
009720         GO TO KEE-100.
009730     IF (W-CC = 3) AND (CNT = 10)
009740         GO TO KEE-080.
009750     IF (W-CC = 4) AND (CNT > 8)
009760         GO TO KEE-080.
009770     IF W-SC = 1
009780         MOVE WA-ZSU(W-CC,CNT) TO W-SU.
009790     IF W-SC = 2
009800         MOVE WA-NSU(W-CC,CNT) TO W-SU.
009810     IF W-SC = 3
009820         MOVE WA-SSU(W-CC,CNT) TO W-SU.
009830     IF W-SC = 4
009840         MOVE WA-YSU(W-CC,CNT) TO W-SU.
009850     MOVE W-SU TO EXL-SU(CNT).
009860     GO TO KEE-080.
009870 KEE-100.
009880     IF W-HC = 0
009890         MOVE 1 TO W-HC
009900         MOVE NC"　　　　　　　　　　【　合　計　】" TO EXL-HNA.
009910     IF W-SC = 1
009920         MOVE WA-ZZCD TO W-ZCD
009930         IF W-MC = 0
009940             MOVE 1 TO W-MC
009950             MOVE NC"前残" TO EXL-KBN
009960             IF W-HC = 1
009970                 MOVE 9 TO W-HC.
009980     IF W-SC = 2
009990         MOVE WA-NZCD TO W-ZCD
010000         IF W-MC = 0
010010             MOVE 1 TO W-MC
010020             MOVE NC"入庫" TO EXL-KBN
010030             IF W-HC = 1
010040                 MOVE 9 TO W-HC.
010050     IF W-SC = 3
010060         MOVE WA-SZCD TO W-ZCD
010070         IF W-MC = 0
010080             MOVE 1 TO W-MC
010090             MOVE NC"出庫" TO EXL-KBN
010100             IF W-HC = 1
010110                 MOVE 9 TO W-HC.
010120     IF W-SC = 4
010130         MOVE WA-YZCD TO W-ZCD
010140         IF W-MC = 0
010150             MOVE 1 TO W-MC
010160             MOVE NC"在庫" TO EXL-KBN.
010170*
010180     IF W-CC = 1
010190         IF ZERO NOT = W-ZC(2) OR W-ZC(3) OR W-ZC(4)
010200             GO TO KEE-140.
010210     IF W-CC = 2
010220         IF ZERO NOT = W-ZC(3) OR W-ZC(4)
010230             GO TO KEE-140.
010240     IF W-CC = 3
010250         IF ZERO NOT = W-ZC(4)
010260             GO TO KEE-140.
010270     MOVE WA-SUT(W-SC) TO EXL-SUT.
010280     MOVE WA-KIN(W-SC) TO EXL-KIN.
010290 KEE-140.
010300     IF W-SC = 1
010310         IF ZERO = WA-NZCD AND WA-SZCD
010320             MOVE 0 TO W-HC
010330             GO TO KEE-040.
010340     WRITE EXL-R.
010350     GO TO KEE-040.
010360 KEE-EX.
010370     EXIT.
