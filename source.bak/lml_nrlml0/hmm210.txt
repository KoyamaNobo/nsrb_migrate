000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. HMM210.
000030*********************************************************
000040*    PROGRAM         :  直送先マスターメンテナンス      *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCHM21                          *
000070*        変更　　　  :  62/03/27                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     COPY LIBCSE.
000170     SELECT TC-M ASSIGN TO TC-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY TC-KEY
000210         FILE STATUS IS ERR-STAT.
000220     SELECT T-M ASSIGN TO T1-MSD T2-MSD                           I.000703
000230         ORGANIZATION INDEXED                                     I.000703
000240         ACCESS MODE RANDOM                                       I.000703
000250         RECORD KEY T-KEY                                         I.000703
000260         ALTERNATE RECORD KEY T-KEY2                              I.000703
000270         FILE STATUS IS ERR-STAT.                                 I.000703
000280     SELECT JCON ASSIGN TO JCON-MSD                               I.930315
000290         ORGANIZATION INDEXED                                     I.930315
000300         ACCESS MODE RANDOM                                       I.930315
000310         RECORD KEY JCON1-KEY                                     I.930315
000320         FILE STATUS IS ERR-STAT.
000330     SELECT HKBM ASSIGN TO HKB-MSD                                I.960913
000340         ORGANIZATION INDEXED                                     I.960913
000350         ACCESS MODE RANDOM                                       I.960913
000360         RECORD KEY HKB-KEY                                       I.960913
000370         FILE STATUS IS ERR-STAT.                                 I.960913
000380*****SELECT STENM ASSIGN TO STENM-RDB                             D.100329
000390*****    ORGANIZATION INDEXED                                     D.100329
000400*****    ACCESS MODE RANDOM                                       D.100329
000410*****    RECORD KEY STE-KEY1                                      D.100329
000420*****    FILE STATUS IS ERR-STAT.                                 D.100329
000430*****SELECT MSTRN ASSIGN TO MS-MSD                                D.100329
000440*****    ORGANIZATION INDEXED                                     D.100329
000450*****    ACCESS MODE DYNAMIC                                      D.100329
000460*****    RECORD KEY MS-KEY                                        D.100329
000470*****    FILE STATUS IS ERR-STAT.                                 D.100329
000480     SELECT SP-F ASSIGN TO P-PRN999.
000490 I-O-CONTROL.
000500     APPLY SHARED-MODE ON M-DATE
000510*****APPLY SHARED-MODE ON STENM                                   D.100329
000520     APPLY SHARED-MODE ON T-M                                     I.000703
000530     APPLY SHARED-MODE ON JCON                                    I.930315
000540     APPLY SHARED-MODE ON HKBM                                    I.960913
000550     APPLY SHARED-MODE ON TC-M
000560*****APPLY SHARED-MODE ON MSTRN                                   D.100329
000570     APPLY SHIFT-CODE  ON SP-F.                                   A 62/03
000580 DATA DIVISION.
000590 FILE SECTION.
000600     COPY LIBFDD.
000610*****COPY LSTENM.                                                 D.100329
000620     COPY LITM.                                                   I.000703
000630     COPY L-JCON.                                                 I.930315
000640     COPY LIHKBM.                                                 I.960913
000650     COPY LITCM.
000660     COPY LSPF.
000670*FD  MSTRN                                                        D.100329
000680*****BLOCK 12 RECORDS                                             D.100329
000690*****LABEL RECORD IS STANDARD                                     D.100329
000700*****VALUE OF IDENTIFICATION "MSTRN".                             D.100329
000710*01  MS-R.                                                        D.100329
000720*****02  MS-KEY.                                                  D.100329
000730*****  03  MS-ID        PIC  X(001).                              D.100329
000740*****  03  MS-TCD       PIC  9(004).                              D.100329
000750*****  03  MS-CCD       PIC  9(003).                              D.100329
000760*****02  F              PIC  X(006).                              D.100329
000770*****02  MS-ACT         PIC  9(001).                              D.100329
000780*****02  MS-NGP         PIC  9(006).                              D.100329
000790 WORKING-STORAGE SECTION.
000800 77  W-FILE             PIC  X(013).                              I.940610
000810 01  ERR-STAT           PIC  X(002).
000820 01  W-20K              PIC  X(005) VALUE ""3FE04FE080"".         I.040126
000830 01  W-15K              PIC  X(005) VALUE ""3FE04F40A0"".         I.040126
000840 01  HEAD1.
000850     02  P-20           PIC  X(005).                              I.040126
000860*****02  F              PIC  X(036) VALUE SPACE.                  D.040323
000870*****02  F              PIC  X(034) VALUE SPACE.                  D.040708
000880     02  F              PIC  X(038) VALUE SPACE.                  I.040708
000890     02  F              PIC  N(025) VALUE
000900          NC"＊＊＊　　直送先マスター　プルーフリスト　　＊＊＊".
000910*****02  F              PIC  X(023) VALUE SPACE.                  D.040323
000920*****02  F              PIC  X(021) VALUE SPACE.                  D.050824
000930     02  F              PIC  X(023) VALUE SPACE.                  I.050824
000940     02  F              PIC  X(005) VALUE "DATE ".
000950     02  H-DATE         PIC 99B99B99.
000960     02  F              PIC  X(007) VALUE "     P.".
000970     02  H-PAGE         PIC ZZZ9.                                 I.980313
000980 01  HEAD2.
000990     02  P-15A          PIC  X(005).                              I.040126
001000     02  F              PIC  X(009) VALUE "  ｺｰﾄﾞ   ".            I.940610
001010     02  F              PIC  N(010) VALUE                         I.940610
001020          NC"直　　送　　先　　名".                               I.940610
001030     02  F              PIC  X(025) VALUE SPACE.                  I.020402
001040     02  F              PIC  N(008) VALUE NC"住　　　　　所　".   I.940610
001050     02  F              PIC  X(019) VALUE SPACE.                  I.020402
001060     02  F              PIC  N(004) VALUE NC"郵便番号".           I.940610
001070     02  F              PIC  X(003) VALUE SPACE.                  I.020402
001080     02  F              PIC  N(004) VALUE NC"電話番号".           I.020402
001090*****02  F              PIC  X(001) VALUE "/".                    D.140829
001100*****02  F              PIC  N(002) VALUE NC"社店".               D.140829
001110*****02  F              PIC  X(002) VALUE "CD".                   D.140829
001120*****02  F              PIC  X(03)  VALUE SPACE.                  D.050824
001130*****02  F              PIC  X(002) VALUE SPACE.                  D.140829
001140     02  F              PIC  X(008) VALUE SPACE.                  I.140829
001150     02  F              PIC  N(002) VALUE NC"府県".
001160     02  F              PIC  X(001) VALUE SPACE.
001170     02  F              PIC  N(002) VALUE NC"運送".
001180*****02  F              PIC  X(001) VALUE SPACE.                  D.040323
001190*****02  F              PIC  N(002) VALUE NC"通販".               D.040323
001200     02  F              PIC  X(001) VALUE SPACE.                  I.040708
001210     02  F              PIC  N(002) VALUE NC"出指".               I.040708
001220     02  F              PIC  X(001) VALUE SPACE.                  I.990428
001230     02  F              PIC  N(002) VALUE NC"売上".               I.000703
001240     02  F              PIC  X(001) VALUE SPACE.                  I.020402
001250     02  F              PIC  N(002) VALUE NC"備考".               I.020402
001260     02  F              PIC  X(001) VALUE SPACE.                  I.050824
001270     02  F              PIC  N(002) VALUE NC"作表".               I.050824
001280*****02  F              PIC  X(003) VALUE SPACE.                  D.050824
001290     02  F              PIC  X(002) VALUE SPACE.                  I.050824
001300     02  F              PIC  N(004) VALUE NC"最終日付".           I.000703
001310     02  F              PIC  X(001) VALUE SPACE.                  I.000703
001320     02  P-20A          PIC  X(005).                              I.040126
001330 01  W-P.
001340     02  P-15B          PIC  X(005).                              I.040126
001350     02  P-TCD          PIC  9(004).                              I.940610
001360     02  P-V            PIC  X(001).                              I.940610
001370     02  P-CCD          PIC  9(003).                              I.940610
001380     02  F              PIC  X(001).                              I.940610
001390     02  P-NAME         PIC  N(026).                              I.020402
001400     02  F              PIC  X(001).                              I.940610
001410     02  P-JS           PIC  N(020).                              I.020402
001420     02  F              PIC  X(001).                              I.940610
001430     02  P-UNO          PIC  X(008).                              I.970123
001440     02  F              PIC  X(001).                              I.000703
001450     02  P-TEL          PIC  X(014).                              I.020402
001460*****02  F              PIC  X(002).                              D.050824
001470     02  F              PIC  X(001).                              I.050824
001480     02  P-FKC          PIC  9(002).                              I.940610
001490     02  F              PIC  X(003).                              I.000703
001500     02  P-UCD          PIC  9(001).                              I.940610
001510*****02  F              PIC  X(003).                              D.040323
001520*****02  P-STK          PIC  9(001).                              D.040323
001530     02  F              PIC  X(003).                              I.040708
001540     02  P-SSC          PIC  9(001).                              I.040708
001550     02  F              PIC  X(003).                              I.990428
001560     02  P-DHC          PIC  9(001).                              I.000703
001570     02  F              PIC  X(003).                              I.020402
001580     02  P-BIK          PIC  9(001).                              I.020402
001590     02  F              PIC  X(002).                              I.000703
001600     02  P-PNO          PIC  9(002).                              I.050824
001610     02  F              PIC  X(001).                              I.050824
001620     02  P-YMD          PIC  99/99/99.                            I.000703
001630     02  P-20B          PIC  X(005).                              I.040126
001640 01  W-R.
001650     02  W-KEY.
001660       03  W-TCD        PIC  9(004).
001670       03  W-CCD        PIC  9(003).
001680     02  W-NAME         PIC  N(026).                              I.020402
001690     02  W-JSU          PIC  N(020).                              I.020402
001700     02  W-JSS          PIC  N(020).                              I.020402
001710     02  W-UNO          PIC  X(008).                              I.970123
001720     02  W-TEL          PIC  X(014).                              I.970123
001730     02  W-FKC          PIC  9(002).
001740     02  W-UCD          PIC  9(001).
001750*****02  F              PIC  9(001).                              D.040708
001760*****02  W-STK          PIC  9(001).                              D.040323
001770     02  W-SSC          PIC  9(001).                              I.040708
001780     02  W-BIK          PIC  9(001).                              I.990428
001790     02  W-DHC          PIC  9(001).                              I.000703
001800*****02  W-SEK          PIC  9(001).                              D.100329
001810*****02  W-STC          PIC  9(009).                              D.100329
001820*****02  F              PIC  X(009).                              D.050824
001830*****02  F              PIC  X(007).                              D.090515
001840*****02  F              PIC  X(010).                              D.140515
001850*****02  W-2N           PIC  9(004).                              D.140515
001860*****02  F              PIC  X(003).                              D.100329
001870*****02  F              PIC  X(001).                              D.140515
001880*****02  F              PIC  X(015).                              D.160210
001890     02  F              PIC  X(014).                              I.160210
001900     02  W-MIC          PIC  9(001).                              I.160210
001910     02  W-MZC          PIC  9(001).                              I.100329
001920*****02  F              PIC  X(001).                              D.140829
001930     02  W-NFN          PIC  9(001).                              I.140829
001940     02  W-PNO          PIC  9(002).                              I.050824
001950     02  W-YMD          PIC  9(006).
001960 01  W-DATA.
001970     02  W-ACT          PIC  9(001).
001980     02  W-DMM          PIC  9(001).
001990     02  W-TCDD         PIC  9(004).
002000     02  W-PC           PIC  9(001).
002010     02  W-BIKD         PIC  9(001).                              I.990428
002020     02  CHK            PIC  9(001).                              I.940610
002030     02  W-SEKEY.
002040       03  W-SKEY       PIC  9(004).
002050       03  W-EKEY       PIC  9(004).
002060     02  W-PAGE         PIC  9(004).                              I.980313
002070*****02  W-OD.                                                    D.100329
002080*****  03  W-ONAME      PIC  N(026).                              D.100329
002090*****  03  W-OJSU       PIC  N(020).                              D.100329
002100*****  03  W-OJSS       PIC  N(020).                              D.100329
002110*****  03  W-OUNO       PIC  X(008).                              D.100329
002120*****  03  W-OTEL       PIC  X(014).                              D.100329
002130*****  03  W-OFKC       PIC  9(002).                              D.100329
002140*****  03  W-OUCD       PIC  9(001).                              D.100329
002150*****  03  W-OSEK       PIC  9(001).                              D.100329
002160*****  03  W-OSTC       PIC  9(009).                              D.100329
002170     02  W-DATE         PIC  9(006).
002180     02  W-YMDD         PIC  9(006).
002190     02  W-END          PIC  9(001) VALUE 0.                      I.960913
002200     02  W-BS           PIC  9(001).                              I.960913
002210     02  W-ACP          PIC  9(001).                              I.960913
002220     02  W-INV          PIC  9(001).                              I.960913
002230*****02  W-OVR          PIC  9(001) VALUE 0.                      D.100329
002240     02  W-SNGP         PIC  9(008).                              I.050927
002250     02  W-ENGP         PIC  9(008).                              I.050927
002260     02  W-NGP.                                                   I.050927
002270       03  W-NEN        PIC  9(004).                              I.050927
002280       03  W-NENL  REDEFINES W-NEN.                               I.050927
002290         04  W-NEN1     PIC  9(002).                              I.050927
002300         04  W-NEN2     PIC  9(002).                              I.050927
002310       03  W-GET        PIC  9(002).                              I.050927
002320       03  W-PEY        PIC  9(002).                              I.050927
002330     02  W-NGPL  REDEFINES W-NGP.                                 I.050927
002340       03  F            PIC  9(002).                              I.050927
002350       03  W-NGPS       PIC  9(006).                              I.050927
002360     02  W-DHCC         PIC  9(001).                              I.090218
002370*01  W-STENM.                                                     D.100329
002380*****02  W-SKEY2.                                                 D.100329
002390*****  03  W-S01.                                                 D.100329
002400*****    04  W-S011     PIC  9(004).                              D.100329
002410*****    04  W-S012     PIC  9(003).                              D.100329
002420*****  03  W-SKEY1.                                               D.100329
002430*****    04  W-S02      PIC  9(009).                              D.100329
002440*****02  W-S03          PIC  N(015).                              D.100329
002450*****02  W-S04          PIC  N(015).                              D.100329
002460*****02  W-S05          PIC  9(006).                              D.100329
002470*****02  W-S06          PIC  X(004).                              D.100329
002480*****02  W-S07          PIC  9(002).                              D.100329
002490*****02  W-S08.                                                   D.100329
002500*****  03  W-S081       PIC  9(010).                              D.100329
002510*****  03  W-S082       PIC  9(010).                              D.100329
002520*****  03  W-S083       PIC  9(010).                              D.100329
002530*****02  W-S09          PIC  9(001).                              D.100329
002540*****02  W-S10          PIC  9(001).                              D.100329
002550*****02  W-S11          PIC  9(001).                              D.100329
002560*****02  W-S12          PIC  9(001).                              D.100329
002570*****02  F              PIC  X(048).                              D.100329
002580*****02  F              PIC  X(049).                              D.040511
002590     COPY LSTAT.
002600 SCREEN SECTION.
002610 SD  C-CRT
002620     END STATUS ESTAT.
002630 01  C-CLEAR.
002640     02  LINE   1  CLEAR SCREEN.
002650 01  C-ACP.
002660     02  A-ACT   LINE   3  COLUMN  56  PIC  9(001)                I.020402
002670          USING W-ACT   CHECK OVERFLOW NO IFC.
002680     02  A-TCD   LINE   5  COLUMN  10  PIC  9(004)                I.020402
002690          USING W-TCDD  CHECK OVERFLOW NO IFC.
002700     02  LINE   6.
002710       03  A-CCD   COLUMN  11  PIC  9(003)                        I.020402
002720            USING W-CCD   CHECK OVERFLOW NO IFC.
002730       03  A-NAME  COLUMN  24  PIC  N(026)                        I.020402
002740            USING W-NAME  CHECK OVERFLOW NO IFC.
002750*****02  A-2N    LINE   7  COLUMN  10  PIC  9(004)                D.140515
002760*****     USING W-2N    CHECK OVERFLOW NO IFC.                    D.140515
002770     02  A-PNO   LINE   7  COLUMN  74  PIC  9(002)                I.050824
002780          USING W-PNO   CHECK OVERFLOW NO IFC.                    I.050824
002790     02  A-FKC   LINE   8  COLUMN  16  PIC  9(002)                I.020402
002800          USING W-FKC   CHECK OVERFLOW NO IFC.                    I.000711
002810     02  A-JSU   LINE   9  COLUMN  16  PIC  N(020)                I.020402
002820          USING W-JSU   CHECK OVERFLOW NO IFC.
002830     02  A-JSS   LINE  10  COLUMN  16  PIC  N(020)                I.020402
002840          USING W-JSS   CHECK OVERFLOW NO IFC.
002850     02  A-UNO   LINE  11  COLUMN  16  PIC  X(008)                I.020402
002860          USING W-UNO   CHECK OVERFLOW NO IFC.
002870     02  A-TEL   LINE  12  COLUMN  16  PIC  X(014)                I.020402
002880          USING W-TEL   CHECK OVERFLOW NO IFC.
002890     02  A-UCD   LINE  13  COLUMN  16  PIC  9(001)                I.020402
002900          USING W-UCD   CHECK OVERFLOW NO IFC.                    I.020402
002910*****02  A-STK   LINE  14  COLUMN  16  PIC  9(001)                D.040323
002920*****     USING W-STK   CHECK OVERFLOW NO IFC.                    D.040323
002930*****02  A-DHC   LINE  15  COLUMN  16  PIC  9(001)                D.040323
002940     02  A-DHC   LINE  14  COLUMN  16  PIC  9(001)                I.040323
002950          USING W-DHC   CHECK OVERFLOW NO IFC.                    I.000703
002960     02  A-SSC   LINE  14  COLUMN  66  PIC  9(001)                I.040708
002970          USING W-SSC   CHECK OVERFLOW NO IFC.                    I.040708
002980     02  A-MZC   LINE  15  COLUMN  16  PIC  9(001)                I.100329
002990          USING W-MZC   CHECK OVERFLOW NO IFC.                    I.100329
003000     02  A-NFN   LINE  16  COLUMN  16  PIC  9(001)                I.140829
003010          USING W-NFN   CHECK OVERFLOW NO IFC.                    I.140829
003020     02  A-MIC   LINE  17  COLUMN  16  PIC  9(001)                I.160210
003030          USING W-MIC   CHECK OVERFLOW NO IFC.                    I.160210
003040*****02  A-SEK   LINE  16  COLUMN  16  PIC  9(001)                D.040323
003050*****02  A-SEK   LINE  15  COLUMN  16  PIC  9(001)                D.100329
003060*****     USING W-SEK   CHECK OVERFLOW NO IFC.                    D.100329
003070*****02  LINE  17.                                                D.040323
003080*****02  LINE  16.                                                D.100329
003090*****  03  A-STC   COLUMN  16  PIC  9(009)                        D.100329
003100*****       USING W-STC   CHECK OVERFLOW NO IFC.                  D.100329
003110*****  03  A-S03   COLUMN  26  PIC  N(015)                        D.100329
003120*****       USING W-S03   CHECK OVERFLOW NO IFC.                  D.100329
003130*****02  A-S04   LINE  18  COLUMN  26  PIC  N(015)                D.040323
003140*****02  A-S04   LINE  17  COLUMN  26  PIC  N(015)                D.100329
003150*****       USING W-S04   CHECK OVERFLOW NO IFC.                  D.100329
003160*****02  LINE  19.                                                D.040323
003170*****02  LINE  18.                                                D.100329
003180*****  03  A-S05   COLUMN  16  PIC  9(006)                        D.100329
003190*****       USING W-S05   CHECK OVERFLOW NO IFC.                  D.100329
003200*****  03  A-S12   COLUMN  32  PIC  9(001)                        D.040617
003210*****  03  A-S12   COLUMN  33  PIC  9(001)                        D.100329
003220*****       USING W-S12   CHECK OVERFLOW NO IFC.                  D.100329
003230*****  03  A-S09   COLUMN  32  PIC  9(001)                        D.040511
003240*****       USING W-S09   CHECK OVERFLOW NO IFC.                  D.040511
003250*****02  LINE  20.                                                D.040323
003260*****02  LINE  19.                                                D.100329
003270*****  03  A-S06   COLUMN  16  PIC  X(004)                        D.100329
003280*****       USING W-S06   CHECK OVERFLOW NO IFC.                  D.100329
003290*****  03  A-S09   COLUMN  32  PIC  9(001)                        D.040617
003300*****  03  A-S09   COLUMN  33  PIC  9(001)                        D.100329
003310*****       USING W-S09   CHECK OVERFLOW NO IFC.                  D.100329
003320*****  03  A-S10   COLUMN  32  PIC  9(001)                        D.040511
003330*****       USING W-S10   CHECK OVERFLOW NO IFC.                  D.040511
003340*****02  LINE  21.                                                D.040323
003350*****02  LINE  20.                                                D.100329
003360*****  03  A-S07   COLUMN  16  PIC  9(002)                        D.100329
003370*****       USING W-S07   CHECK OVERFLOW NO IFC.                  D.100329
003380*****  03  A-S10   COLUMN  32  PIC  9(001)                        D.040617
003390*****  03  A-S10   COLUMN  33  PIC  9(001)                        D.100329
003400*****       USING W-S10   CHECK OVERFLOW NO IFC.                  D.100329
003410*****  03  A-S11   COLUMN  32  PIC  9(001)                        D.040511
003420*****       USING W-S11   CHECK OVERFLOW NO IFC.                  D.040511
003430*****02  LINE  22.                                                D.040323
003440*****02  LINE  21.                                                D.100329
003450*****  03  A-S11   COLUMN  32  PIC  9(001)                        D.040617
003460*****  03  A-S11   COLUMN  33  PIC  9(001)                        D.100329
003470*****       USING W-S11   CHECK OVERFLOW NO IFC.                  D.100329
003480*****02  LINE  22.                                                D.100329
003490*****  03  A-S081  COLUMN  24  PIC  9(010)                        D.100329
003500*****       USING W-S081  CHECK OVERFLOW NO IFC.                  D.100329
003510*****  03  A-S082  COLUMN  35  PIC  9(010)                        D.100329
003520*****       USING W-S082  CHECK OVERFLOW NO IFC.                  D.100329
003530*****  03  A-S083  COLUMN  46  PIC  9(010)                        D.100329
003540*****       USING W-S083  CHECK OVERFLOW NO IFC.                  D.100329
003550*****02  LINE  23.                                                D.040323
003560*****02  LINE  22.                                                D.040511
003570*****02  LINE  23.                                                D.100329
003580     02  LINE  22.                                                I.100329
003590       03  A-SKEY  COLUMN  19  PIC  9(004)                        I.040122
003600            USING W-SKEY  CHECK OVERFLOW NO IFC.                  I.040122
003610       03  A-EKEY  COLUMN  29  PIC  9(004)                        I.040122
003620            USING W-EKEY  CHECK OVERFLOW NO IFC.                  I.040122
003630*****02 A-DMM    LINE  24  COLUMN  66  PIC  9(001)                D.100329
003640     02 A-DMM    LINE  23  COLUMN  66  PIC  9(001)                D.100329
003650            USING W-DMM   CHECK OVERFLOW NO IFC.                  I.040122
003660 01  C-DSP.
003670     02  D-TNA   LINE   5  COLUMN  24  PIC  N(026) FROM  TC-NAME. I.020402
003680*****02  D-2ND   LINE   7  COLUMN  15  PIC  N(022) FROM  T-NAME.  D.140515
003690*****02  D-2NC   LINE   7  COLUMN  10  PIC  X(049) VALUE          D.140515
003700*****     "                                                 ".    D.140515
003710     02  LINE  08.                                                I.000711
003720       03  D-FKN   COLUMN  19  PIC  N(004) FROM  HKB-FKNA.        I.020402
003730       03  S-FKN   COLUMN  19  PIC  X(008) VALUE "        ".      I.020402
003740     02  LINE  13.                                                I.020402
003750       03  D-UN    COLUMN  18  PIC  N(006) FROM  JCON2-03.        I.020402
003760       03  S-UN    COLUMN  18  PIC  X(012) VALUE "            ".  I.020402
003770     02  D-SSM.                                                   I.040708
003780       03  LINE  14  COLUMN  57  PIC  N(004) VALUE NC"出荷指示".  I.040708
003790       03  LINE  15.                                              I.040708
003800         04  COLUMN  66  PIC  N(002) VALUE NC"あり".              I.040708
003810         04  COLUMN  70  PIC  X(003) VALUE "=0,".                 I.040708
003820         04  COLUMN  73  PIC  N(002) VALUE NC"なし".              I.040708
003830         04  COLUMN  77  PIC  X(002) VALUE "=1".                  I.040708
003840     02  S-SSM.                                                   I.040708
003850       03  LINE  14  COLUMN  57  PIC  X(008) VALUE "        ".    I.040708
003860       03  LINE  14  COLUMN  66  PIC  X(001) VALUE " ".           I.040708
003870       03  LINE  15  COLUMN  66  PIC  X(013) VALUE                I.040708
003880            "             ".                                      I.040708
003890     02  D-NFN   LINE  16  COLUMN  16  PIC  Z(001) FROM  W-NFN.   I.140829
003900*****02  D-DENC  LINE  22  COLUMN  24  PIC  X(032) VALUE          D.040323
003910*****02  D-DENC  LINE  21  COLUMN  24  PIC  X(032) VALUE          D.040511
003920*****02  D-DENC  LINE  22  COLUMN  24  PIC  X(032) VALUE          D.100329
003930*****     "                                ".                     D.100329
003940*****02  D-PM    LINE  23  COLUMN  05  PIC  X(040) VALUE          D.040323
003950*****02  D-PM    LINE  22  COLUMN  05  PIC  X(040) VALUE          D.040511
003960*****02  D-PM    LINE  23  COLUMN  05  PIC  X(040) VALUE          D.100329
003970     02  D-PM    LINE  22  COLUMN  05  PIC  X(040) VALUE          D.100329
003980          "<  得意先ｺｰﾄﾞ      より      迄打出し  >".
003990*****02  D-EQ    LINE  23.                                        D.040323
004000*****02  D-EQ    LINE  22.                                        D.040511
004010*****02  D-EQ    LINE  23.                                        D.100329
004020     02  D-EQ    LINE  22.                                        I.100329
004030       03  COLUMN   4  PIC  X(010) VALUE "直送先ｺｰﾄﾞ".            I.930315
004040       03  COLUMN  16  PIC  9(003) FROM  TC-CCD.                  I.930315
004050       03  COLUMN  20  PIC  N(004) VALUE NC"直送先名".            I.930315
004060       03  COLUMN  29  PIC  N(026) FROM  TC-NAME.                 I.020402
004070*****02  D-EQC   LINE  23.                                        D.040323
004080*****02  D-EQC   LINE  22.                                        D.040511
004090*****02  D-EQC   LINE  23.                                        D.100329
004100     02  D-EQC   LINE  22.                                        I.100329
004110       03  COLUMN   4  PIC  X(025) VALUE                          I.930315
004120            "                         ".                          I.930315
004130       03  COLUMN  29  PIC  X(052) VALUE                          I.020402
004140           "                                                    ".I.020402
004150 01  C-ERR.
004160     02  LINE  24.
004170       03  E-ME1   COLUMN  15  PIC  X(023) VALUE
004180            "***  TC-M ﾄｳﾛｸ ｽﾞﾐ  ***".
004190       03  E-ME2   COLUMN  15  PIC  X(017) VALUE
004200            "***  TC-M ﾅｼ  ***".
004210       03  E-ME3   COLUMN  15  PIC  X(017) VALUE
004220            "***  ｳﾝｿｳ ﾅｼ  ***".
004230       03  E-ME4   COLUMN  15  PIC  X(019) VALUE
004240            "***  キャンセル ***".
004250       03  E-ME5   COLUMN  15  PIC  X(024) VALUE
004260            "***  TC-M WRITE ｴﾗｰ  ***".
004270       03  E-ME6   COLUMN  15  PIC  X(026) VALUE
004280            "***  TC-M REWRITE ｴﾗｰ  ***".
004290       03  E-ME7   COLUMN  15  PIC  X(025) VALUE
004300            "***  TC-M DELETE ｴﾗｰ  ***".
004310*****  03  E-ME8   COLUMN  15  PIC  X(025) VALUE                  D.100329
004320*****       "***  MSTRN WRITE ｴﾗｰ  ***".                          D.100329
004330*****  03  E-ME9   COLUMN  15  PIC  X(027) VALUE                  D.100329
004340*****       "***  MSTRN REWRITE ｴﾗｰ  ***".                        D.100329
004350       03  E-ME10  COLUMN  15  PIC  X(019) VALUE                  I.930315
004360            "***  TEL.NO ｱﾘ  ***".                                I.930315
004370       03  E-ME11  COLUMN  15  PIC  X(020) VALUE                  I.960913
004380            "***  ﾄﾄﾞｳﾌｹﾝ ﾅｼ  ***".                               I.960913
004390       03  E-ME12  COLUMN  15  PIC  X(018) VALUE                  I.000703
004400            "***  ﾄｸｲｻｷ ﾅｼ  ***".                                 I.000703
004410       03  E-ME13  COLUMN  15  PIC  X(14)  VALUE                  I.040122
004420            "他で使用中ｺｰﾄﾞ".                                     I.040122
004430       03  E-ME14  COLUMN  15  PIC  N(04)  VALUE                  I.050927
004440            NC"削除不可".                                         I.050927
004450*****  03  E-ME15  COLUMN  15  PIC  X(025) VALUE                  D.100329
004460*****       "***  STENM WRITE ｴﾗｰ  ***".                          D.100329
004470*****  03  E-ME17  COLUMN  15  PIC  X(026) VALUE                  D.100329
004480*****       "***  STENM DELETE ｴﾗｰ  ***".                         D.100329
004490       03  E-ME20  COLUMN  15  PIC  X(13)  VALUE                  I.090218
004500            "売上区分 ﾁｪｯｸ".                                      I.090218
004510       03  E-SPACE COLUMN  15  PIC  X(27)  VALUE                  I.040122
004520            "                           ".                        I.040122
004530     COPY LSSEM.                                                  I.940610
004540     COPY LIBSCR.
004550 PROCEDURE DIVISION.
004560 M-020.
004570     MOVE 000 TO COMPLETION-CODE.                                 I.050215
004580     COPY LIBCPR.
004590     DISPLAY C-CLEAR.
004600     OPEN I-O TC-M.
004610*****OPEN I-O STENM.                                              D.100329
004620     OPEN INPUT T-M.                                              I.000703
004630*****OPEN I-O MSTRN.                                              D.100329
004640     ACCEPT W-DATE FROM DATE.
004650*
004660     MOVE ZERO TO W-NGP.                                          I.050927
004670     MOVE W-DATE TO W-NGPS.                                       I.050927
004680     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.050927
004690         ADD DATE-NC1 TO W-NEN.                                   I.050927
004700     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.050927
004710         ADD DATE-NC2 TO W-NEN.                                   I.050927
004720     MOVE W-NGP TO W-ENGP.                                        I.050927
004730     SUBTRACT 1 FROM W-GET.                                       I.050927
004740     IF W-GET = ZERO                                              I.050927
004750         SUBTRACT 1 FROM W-NEN                                    I.050927
004760         MOVE 12 TO W-GET.                                        I.050927
004770     SUBTRACT 1 FROM W-GET.                                       I.050927
004780     IF W-GET = ZERO                                              I.050927
004790         SUBTRACT 1 FROM W-NEN                                    I.050927
004800         MOVE 12 TO W-GET.                                        I.050927
004810     SUBTRACT 1 FROM W-GET.                                       I.050927
004820     IF W-GET = ZERO                                              I.050927
004830         SUBTRACT 1 FROM W-NEN                                    I.050927
004840         MOVE 12 TO W-GET.                                        I.050927
004850     SUBTRACT 1 FROM W-GET.                                       I.050927
004860     IF W-GET = ZERO                                              I.050927
004870         SUBTRACT 1 FROM W-NEN                                    I.050927
004880         MOVE 12 TO W-GET.                                        I.050927
004890     SUBTRACT 1 FROM W-GET.                                       I.050927
004900     IF W-GET = ZERO                                              I.050927
004910         SUBTRACT 1 FROM W-NEN                                    I.050927
004920         MOVE 12 TO W-GET.                                        I.050927
004930     SUBTRACT 1 FROM W-GET.                                       I.050927
004940     IF W-GET = ZERO                                              I.050927
004950         SUBTRACT 1 FROM W-NEN                                    I.050927
004960         MOVE 12 TO W-GET.                                        I.050927
004970     MOVE W-NGP TO W-SNGP.                                        I.050927
004980*
004990     MOVE DATE-02R TO H-DATE.
005000     MOVE ZERO TO W-PAGE W-TCDD W-PC.
005010 M-040.
005020     CALL "SCHM21".
005030     ACCEPT A-ACT.
005040     IF ESTAT NOT = HTB AND SKP
005050         GO TO M-040.
005060     IF W-ACT = 9
005070         GO TO M-980.
005080     IF W-ACT = 4
005090         GO TO M-700.
005100     IF W-ACT < 1 OR > 4
005110         GO TO M-040.
005120     MOVE 0 TO W-ACP.                                             I.960913
005130 M-100.
005140     PERFORM ACP-RTN THRU ACP-EX.                                 I.960913
005150     IF W-BS = 9                                                  I.960913
005160         GO TO M-040.                                             I.960913
005170 M-500.                                                           I.940610
005180*****IF COMPLETION-CODE = 000                                     D.100329
005190*****    IF W-SEK = 1                                             D.100329
005200*****        MOVE 100 TO COMPLETION-CODE.                         D.100329
005210     PERFORM WRD-RTN THRU WRD-EX.                                 I.960913
005220     IF W-END = 9                                                 I.960913
005230         GO TO M-980.                                             I.960913
005240     GO TO M-100.
005250 M-700.
005260     PERFORM LST-RTN THRU LST-EX.                                 I.960913
005270 M-980.
005280     CLOSE TC-M.                                                  I.960913
005290     CLOSE T-M.                                                   I.000703
005300*****CLOSE MSTRN.                                                 D.100329
005310     IF W-PC NOT = ZERO
005320         CLOSE SP-F.
005330     DISPLAY C-CLEAR.
005340     STOP RUN.
005350*---------------　入　　力　----------------------------------------------
005360 ACP-RTN.                                                         I.960913
005370     IF W-ACP = 1                                                 I.960913
005380         GO TO ACP-020.                                           I.960913
005390     MOVE 0 TO W-BS.                                              I.960913
005400     CALL "SCHM21".                                               I.960913
005410     DISPLAY A-ACT.                                               I.960913
005420     IF W-TCDD NOT = ZERO                                         I.960913
005430         DISPLAY A-TCD.                                           I.960913
005440     ACCEPT A-TCD.                                                I.960913
005450     IF ESTAT = BTB                                               I.960913
005460         MOVE 9 TO W-BS                                           I.960913
005470         GO TO ACP-EX.                                            I.960913
005480     IF ESTAT NOT = HTB AND SKP                                   I.960913
005490         GO TO ACP-RTN.                                           I.960913
005500     IF W-TCDD = 9999                                             I.960913
005510         GO TO ACP-RTN.                                           I.960913
005520 ACP-020.                                                         I.960913
005530     MOVE ZERO TO TC-KEY.                                         I.960913
005540     MOVE W-TCDD TO TC-TCD.                                       I.960913
005550     MOVE 001 TO TC-CCD.                                          I.960913
005560     READ TC-M INVALID KEY                                        I.960913
005570         DISPLAY E-ME2 E-ME98                                     I.960913
005580         GO TO ACP-RTN.                                           I.960913
005590     CALL "SCHM21".                                               I.960913
005600     DISPLAY A-ACT A-TCD D-TNA.                                   I.960913
005610     MOVE TC-BIK TO W-BIKD.                                       I.990428
005620     MOVE TC-DHC TO W-DHCC.                                       I.080218
005630     INITIALIZE W-R.                                              I.960913
005640     MOVE ALL NX"2121"  TO W-NAME W-JSU W-JSS.                    I.960913
005650     IF W-ACT NOT = 1                                             I.960913
005660         GO TO ACP-060.                                           I.960913
005670     MOVE W-BIKD TO W-BIK.                                        I.990428
005680     MOVE 1 TO W-CCD.                                             I.960913
005690 ACP-040.                                                         I.960913
005700     ADD 1 TO W-CCD.                                              I.960913
005710     READ TC-M NEXT RECORD WITH UNLOCK AT END                     I.960913
005720         GO TO ACP-060.                                           I.960913
005730     IF TC-TCD NOT = W-TCDD                                       I.960913
005740         GO TO ACP-060.                                           I.960913
005750     IF TC-CCD = W-CCD                                            I.960913
005760         GO TO ACP-040.                                           I.960913
005770 ACP-060.                                                         I.960913
005780     DISPLAY A-CCD.                                               I.960913
005790     ACCEPT A-CCD.                                                I.960913
005800     DISPLAY E-SPACE.                                             I.040122
005810     IF ESTAT = BTB                                               I.960913
005820         MOVE 0 TO W-ACP                                          I.960913
005830         GO TO ACP-RTN.                                           I.960913
005840     IF ESTAT NOT = HTB AND SKP                                   I.960913
005850         GO TO ACP-060.                                           I.960913
005860     IF W-CCD = 000 OR 999                                        I.960913
005870         GO TO ACP-060.                                           I.960913
005880     IF W-CCD = 001                                               I.040708
005890         DISPLAY D-SSM                                            I.040708
005900       ELSE                                                       I.040708
005910         MOVE 0 TO W-SSC                                          I.040708
005920         DISPLAY S-SSM.                                           I.040708
005930     MOVE W-TCDD TO W-TCD.                                        I.960913
005940     MOVE W-KEY TO TC-KEY.                                        I.960913
005950     READ TC-M INVALID KEY                                        I.960913
005960         GO TO ACP-080.                                           I.960913
005970     IF W-ACT = 1                                                 I.960913
005980         DISPLAY E-ME1 E-ME98                                     I.960913
005990         GO TO ACP-060.                                           I.960913
006000     MOVE TC-R TO W-R.                                            I.960913
006010     MOVE W-BIKD TO W-BIK.                                        I.990428
006020*****DISPLAY A-NAME A-JSU A-JSS A-UNO A-FKC                       D.050824
006030     DISPLAY A-NAME A-PNO A-JSU A-JSS A-UNO A-FKC                 I.050824
006040             A-UCD  A-TEL A-DHC A-MZC A-MIC                       I.160210
006050*****        A-UCD  A-TEL A-DHC A-MZC                             D.160210
006060         IF W-TCDD = 5000                                         I.151218
006070             DISPLAY D-NFN.                                       I.151218
006080*****        A-UCD  A-TEL A-DHC A-MZC.                            D.151218
006090*****        A-UCD  A-TEL A-DHC A-SEK A-STC.                      D.100329
006100*****        A-UCD  A-TEL A-STK A-DHC A-SEK A-STC.                D.040323
006110*****IF W-TCDD NOT = 4038                                         D.091105
006120*****IF W-TCDD NOT = 4038 AND 4054 AND 4056 AND 4057              D.140515
006130*****    DISPLAY D-2NC                                            D.140515
006140*****    GO TO ACP-065.                                           D.140515
006150*****MOVE W-2N TO T-KEY.                                          D.140515
006160*****READ T-M WITH UNLOCK INVALID KEY                             D.140515
006170*****    MOVE SPACE TO T-NAME                                     D.140515
006180*****    MOVE NC"得意先なし" TO T-NAME.                           D.140515
006190*****DISPLAY A-2N D-2ND.                                          D.140515
006200 ACP-065.                                                         I.090515
006210     PERFORM HKBM-RTN THRU HKBM-EX.                               I.960913
006220     PERFORM JCON-RTN THRU JCON-EX.                               I.960913
006230*****PERFORM STENM-RTN THRU STENM-EX.                             D.100329
006240     IF W-FKC NOT = ZERO                                          I.960913
006250         DISPLAY D-FKN                                            I.960913
006260       ELSE                                                       I.960913
006270         DISPLAY S-FKN.                                           I.960913
006280     IF W-UCD NOT = 0                                             I.960913
006290         DISPLAY D-UN                                             I.960913
006300       ELSE                                                       I.960913
006310         DISPLAY S-UN.                                            I.960913
006320     IF W-CCD = 001                                               I.040708
006330         DISPLAY A-SSC.                                           I.040708
006340*****IF W-INV = 9                                                 D.100329
006350*****    INITIALIZE W-STENM                                       D.100329
006360*****  ELSE                                                       D.100329
006370*****    MOVE STE-R TO W-STENM.                                   D.100329
006380*****MOVE 0 TO W-INV.                                             D.100329
006390*****DISPLAY A-S03 A-S04 A-S05 A-S06                              D.100329
006400*****        A-S07 A-S09 A-S10 A-S11 A-S12.                       D.100329
006410*****        A-S07 A-S09 A-S10 A-S11.                             D.040511
006420*****IF W-S11 = ZERO                                              D.100329
006430*****    MOVE ZERO TO W-S081 W-S082 W-S083                        D.100329
006440*****    DISPLAY D-DENC                                           D.100329
006450*****ELSE                                                         D.100329
006460*****    DISPLAY A-S081 A-S082 A-S083.                            D.100329
006470     IF W-ACT = 2                                                 I.960913
006480*****    INITIALIZE W-OD                                          D.100329
006490*****    MOVE W-NAME TO W-ONAME                                   D.100329
006500*****    MOVE W-JSU TO W-OJSU                                     D.100329
006510*****    MOVE W-JSS TO W-OJSS                                     D.100329
006520*****    MOVE W-UNO TO W-OUNO                                     D.100329
006530*****    MOVE W-FKC TO W-OFKC                                     D.100329
006540*****    MOVE W-UCD TO W-OUCD                                     D.100329
006550*****    MOVE W-TEL TO W-OTEL                                     D.100329
006560*****    MOVE W-SEK TO W-OSEK                                     D.100329
006570*****    MOVE W-STC TO W-OSTC                                     D.100329
006580         GO TO ACP-100.                                           I.960913
006590     IF W-CCD = 001                                               I.960913
006600         GO TO ACP-060.                                           I.960913
006610     IF W-YMD = ZERO                                              I.050927
006620         GO TO ACP-520.                                           I.050927
006630     MOVE ZERO TO W-NGP.                                          I.050927
006640     MOVE W-YMD TO W-NGPS.                                        I.050927
006650     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1                        I.050927
006660         ADD DATE-NC1 TO W-NEN.                                   I.050927
006670     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2                        I.050927
006680         ADD DATE-NC2 TO W-NEN.                                   I.050927
006690     IF W-SNGP < W-NGP                                            I.050927
006700         DISPLAY E-ME14 E-ME98                                    I.050927
006710         GO TO ACP-060.                                           I.050927
006720     GO TO ACP-520.                                               I.960913
006730 ACP-080.                                                         I.960913
006740     IF W-ACT NOT = 1                                             I.960913
006750         DISPLAY E-ME2 E-ME98                                     I.960913
006760         GO TO ACP-060.                                           I.960913
006770 ACP-100.                                                         I.960913
006780     DISPLAY A-NAME.                                              I.960913
006790     ACCEPT A-NAME.                                               I.960913
006800     IF ESTAT = BTB                                               I.960913
006810         GO TO ACP-060.                                           I.960913
006820     IF ESTAT NOT = HTB AND SKP                                   I.960913
006830         GO TO ACP-100.                                           I.960913
006840*****IF W-TCDD NOT = 4038                                         D.091105
006850*****IF W-TCDD NOT = 4038 AND 4054 AND 4056 AND 4057              D.140515
006860*****    DISPLAY D-2NC                                            D.140515
006870*****    GO TO ACP-105.                                           D.140515
006880*ACP-101.                                                         D.140515
006890*****DISPLAY A-2N.                                                D.140515
006900*****ACCEPT A-2N.                                                 D.140515
006910*****IF ESTAT = BTB                                               D.140515
006920*****    GO TO ACP-100.                                           D.140515
006930*****IF ESTAT NOT = HTB AND SKP                                   D.140515
006940*****    GO TO ACP-101.                                           D.140515
006950*****MOVE W-2N TO T-KEY.                                          D.140515
006960*****READ T-M WITH UNLOCK INVALID KEY                             D.140515
006970******   GO TO ACP-101.                                           D.140515
006980*****DISPLAY D-2ND.                                               D.140515
006990 ACP-105.                                                         I.050824
007000     DISPLAY A-PNO.                                               I.050824
007010     ACCEPT A-PNO.                                                I.050824
007020     IF ESTAT = BTB                                               I.050824
007030*****    IF W-TCDD = 4038                                         D.091105
007040*****    IF W-TCDD = 4038 OR 4054 OR 4056 OR 4057                 D.140515
007050*****        GO TO ACP-101                                        D.140515
007060*****      ELSE                                                   D.140515
007070         GO TO ACP-100.                                           I.050824
007080     IF ESTAT NOT = HTB AND SKP                                   I.050824
007090         GO TO ACP-105.                                           I.050824
007100 ACP-110.                                                         I.000711
007110     ACCEPT A-FKC.                                                I.000711
007120     IF ESTAT = BTB                                               I.000711
007130         GO TO ACP-105.                                           I.050824
007140*****    GO TO ACP-100.                                           D.050824
007150     IF ESTAT NOT = HTB AND SKP                                   I.000711
007160         GO TO ACP-110.                                           I.000711
007170     PERFORM HKBM-RTN THRU HKBM-EX.                               I.000711
007180     IF W-INV = 9                                                 I.000711
007190         MOVE 0 TO W-INV                                          I.000711
007200         DISPLAY E-ME11 E-ME98                                    I.000711
007210         GO TO ACP-110.                                           I.000711
007220     IF W-FKC = ZERO                                              I.000711
007230         GO TO ACP-110.                                           I.000711
007240     DISPLAY D-FKN.                                               I.000711
007250     IF W-ACT = 1                                                 I.000711
007260         IF W-JSU = SPACE                                         I.000711
007270             MOVE HKB-FKNA TO W-JSU.                              I.000711
007280 ACP-120.                                                         I.960913
007290     DISPLAY A-JSU.                                               I.960913
007300     ACCEPT A-JSU.                                                I.960913
007310     IF ESTAT = BTB                                               I.960913
007320         GO TO ACP-110.                                           I.000711
007330     IF ESTAT NOT = HTB AND SKP                                   I.960913
007340         GO TO ACP-120.                                           I.960913
007350 ACP-140.                                                         I.960913
007360     DISPLAY A-JSS.                                               I.960913
007370     ACCEPT A-JSS.                                                I.960913
007380     IF ESTAT = BTB                                               I.960913
007390         GO TO ACP-120.                                           I.960913
007400     IF ESTAT NOT = HTB AND SKP                                   I.960913
007410         GO TO ACP-140.                                           I.960913
007420 ACP-160.                                                         I.960913
007430     ACCEPT A-UNO.                                                I.960913
007440     IF ESTAT = BTB                                               I.960913
007450         GO TO ACP-140.                                           I.960913
007460     IF ESTAT NOT = HTB AND SKP                                   I.960913
007470         GO TO ACP-160.                                           I.960913
007480     IF W-FKC NOT = 99                                            I.140515
007490         IF W-UNO = SPACE                                         I.140515
007500             GO TO ACP-160.                                       I.140515
007510 ACP-170.                                                         I.020402
007520     ACCEPT A-TEL.                                                I.020402
007530     IF ESTAT = BTB                                               I.020402
007540         GO TO ACP-160.                                           I.020402
007550     IF ESTAT NOT = HTB AND SKP                                   I.020402
007560         GO TO ACP-170.                                           I.020402
007570     IF W-ACT = 1                                                 I.020402
007580         IF W-TEL NOT = SPACE                                     I.020402
007590             PERFORM TEL-RTN THRU TEL-EX.                         I.020402
007600 ACP-200.                                                         I.960913
007610     ACCEPT A-UCD.                                                I.960913
007620     DISPLAY E-SPACE.                                             I.040122
007630     IF ESTAT = BTB                                               I.960913
007640         GO TO ACP-170.                                           I.020402
007650     IF ESTAT NOT = HTB AND SKP                                   I.960913
007660         GO TO ACP-200.                                           I.960913
007670     PERFORM JCON-RTN THRU JCON-EX.                               I.960913
007680     IF W-INV = 9                                                 I.960913
007690         MOVE 0 TO W-INV                                          I.960913
007700         DISPLAY E-ME3 E-ME98                                     I.960913
007710         GO TO ACP-200.                                           I.960913
007720     IF W-UCD = ZERO                                              I.960913
007730         DISPLAY S-UN                                             I.960913
007740       ELSE                                                       I.960913
007750         DISPLAY D-UN.                                            I.960913
007760*ACP-205.                                                         D.040323
007770     IF W-CCD = 001                                               I.971006
007780*****    MOVE 0 TO W-STK W-DHC                                    D.040323
007790*****    DISPLAY A-STK A-DHC                                      D.040323
007800*****    MOVE 0 TO W-DHC                                          D.090218
007810*****    DISPLAY A-DHC                                            D.090218
007820         GO TO ACP-240.                                           I.040708
007830*****    GO TO ACP-260.                                           D.040708
007840*****ACCEPT A-STK.                                                D.040323
007850*****IF ESTAT = BTB                                               D.040323
007860*****    GO TO ACP-200.                                           D.040323
007870*****IF ESTAT NOT = HTB AND SKP                                   D.040323
007880*****    GO TO ACP-205.                                           D.040323
007890*****IF W-STK NOT = 0 AND 5                                       D.040323
007900*****    GO TO ACP-205.                                           D.040323
007910     MOVE W-TCD TO T-KEY.                                         I.000703
007920     READ T-M WITH UNLOCK INVALID KEY                             I.000703
007930         MOVE 99 TO T-SS.                                         I.000703
007940     IF T-SS NOT = ZERO                                           I.000703
007950         IF W-DHCC NOT = 5                                        I.090218
007960             IF W-DHC = 0                                         I.070712
007970*****            MOVE 0 TO W-DHC                                  D.090218
007980                 DISPLAY A-DHC                                    I.000703
007990                 GO TO ACP-250.                                   I.090218
008000*****            GO TO ACP-260.                                   D.090218
008010 ACP-220.                                                         I.000703
008020     ACCEPT A-DHC.                                                I.000703
008030     IF ESTAT = BTB                                               I.000703
008040         GO TO ACP-200.                                           I.040323
008050*****    GO TO ACP-205.                                           D.040323
008060     IF ESTAT NOT = HTB AND SKP                                   I.000703
008070         GO TO ACP-220.                                           I.000703
008080     IF W-DHC NOT = 0 AND 5                                       I.000703
008090         GO TO ACP-220.                                           I.000703
008100     IF W-CCD NOT = 001                                           I.090218
008110         GO TO ACP-250.                                           I.090218
008120*****GO TO ACP-260.                                               D.090218
008130 ACP-240.                                                         I.040708
008140     ACCEPT A-SSC.                                                I.040708
008150     IF ESTAT = BTB                                               I.040708
008160         GO TO ACP-220.                                           I.090218
008170*****    GO TO ACP-200.                                           D.090218
008180     IF ESTAT NOT = HTB AND SKP                                   I.040708
008190         GO TO ACP-240.                                           I.040708
008200     IF W-SSC > 1                                                 I.040708
008210         GO TO ACP-240.                                           I.040708
008220 ACP-250.                                                         I.090218
008230     IF W-CCD = 001                                               I.090218
008240         GO TO ACP-260.                                           I.090218
008250     IF W-DHCC = 5                                                I.090218
008260         IF W-DHC = 0                                             I.090218
008270             DISPLAY E-ME20 E-ME99.                               I.090218
008280     DISPLAY E-CL.                                                I.090218
008290 ACP-260.                                                         I.040122
008300*****ACCEPT A-SEK.                                                D.100329
008310     ACCEPT A-MZC.                                                I.100329
008320     IF ESTAT = BTB                                               I.040122
008330         IF W-CCD = 001                                           I.040122
008340             GO TO ACP-240                                        I.040708
008350*****        GO TO ACP-200                                        D.040708
008360           ELSE                                                   I.040122
008370*****        IF T-SS NOT = ZERO                                   D.070712
008380*****            GO TO ACP-200                                    D.070712
008390*****            GO TO ACP-205                                    D.040323
008400*****          ELSE                                               D.070712
008410             GO TO ACP-220.                                       I.040122
008420     IF ESTAT NOT = HTB AND SKP                                   I.040122
008430         GO TO ACP-260.                                           I.040122
008440*****IF W-SEK NOT = 0 AND 1                                       I.100329
008450     IF W-MZC NOT = 0 AND 1                                       I.100329
008460         GO TO ACP-260.                                           I.040122
008470     IF W-TCDD NOT = 5000                                         I.140829
008480         MOVE 0 TO W-NFN                                          I.140829
008490         DISPLAY D-NFN                                            I.140829
008500         GO TO ACP-280.                                           I.160210
008510*****    GO TO ACP-520.                                           D.160210
008520 ACP-270.                                                         I.140829
008530     ACCEPT A-NFN.                                                I.140829
008540     IF ESTAT = BTB                                               I.140829
008550         GO TO ACP-260.                                           I.140829
008560     IF ESTAT NOT = HTB AND SKP                                   I.140829
008570         GO TO ACP-270.                                           I.140829
008580     DISPLAY D-NFN.                                               I.140829
008590*****IF W-NFN = 0                                                 D.151216
008600     IF W-NFN < 1 OR > 2                                          I.151216
008610         GO TO ACP-270.                                           I.140829
008620 ACP-280.                                                         I.160210
008630     ACCEPT A-MIC.                                                I.160210
008640     IF ESTAT = BTB                                               I.160210
008650         IF W-TCDD = 5000                                         I.160210
008660             GO TO ACP-270                                        I.160210
008670           ELSE                                                   I.160210
008680             GO TO ACP-260.                                       I.160210
008690     IF ESTAT NOT = HTB AND SKP                                   I.160210
008700         GO TO ACP-280.                                           I.160210
008710     IF W-MIC > 1                                                 I.160210
008720         GO TO ACP-280.                                           I.160210
008730*****IF W-SEK = 0                                                 D.100329
008740*****    INITIALIZE W-STENM W-STC                                 D.100329
008750*****    DISPLAY A-STC A-S03 A-S04 A-S05 A-S06                    D.100329
008760*****            A-S07 A-S09 A-S10 A-S11 A-S12 D-DENC             D.100329
008770*****            A-S07 A-S09 A-S10 A-S11 D-DENC                   D.040511
008780*****    GO TO ACP-520.                                           D.100329
008790*ACP-380.                                                         D.100329
008800*****ACCEPT A-STC.                                                D.100329
008810*****DISPLAY E-SPACE.                                             D.100329
008820*****IF ESTAT = BTB                                               D.100329
008830*****    GO TO ACP-260.                                           D.100329
008840*****IF ESTAT NOT = HTB AND SKP                                   D.100329
008850*****    GO TO ACP-380.                                           D.100329
008860*****IF W-STC = ZERO                                              D.100329
008870*****    GO TO ACP-380.                                           D.100329
008880*****PERFORM STENM-RTN THRU STENM-EX.                             D.100329
008890*****IF W-INV = 0                                                 D.100329
008900*****    IF W-ACT = 1                                             D.100329
008910*****        DISPLAY E-ME13 E-ME98                                D.100329
008920*****        GO TO ACP-380                                        D.100329
008930*****      ELSE                                                   D.100329
008940*****        IF W-CCD NOT = STE-012                               D.100329
008950*****            DISPLAY E-ME13 E-ME98                            D.100329
008960*****            GO TO ACP-380.                                   D.100329
008970*****MOVE 0 TO W-INV.                                             D.100329
008980*ACP-390.                                                         D.100329
008990*****ACCEPT A-S03.                                                D.100329
009000*****IF ESTAT = BTB                                               D.100329
009010*****    GO TO ACP-380.                                           D.100329
009020*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009030*****    GO TO ACP-390.                                           D.100329
009040*ACP-400.                                                         D.100329
009050*****ACCEPT A-S04.                                                D.100329
009060*****IF ESTAT = BTB                                               D.100329
009070*****    GO TO ACP-390.                                           D.100329
009080*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009090*****    GO TO ACP-400.                                           D.100329
009100*ACP-410.                                                         D.100329
009110*****ACCEPT A-S05.                                                D.100329
009120*****IF ESTAT = BTB                                               D.100329
009130*****    GO TO ACP-400.                                           D.100329
009140*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009150*****    GO TO ACP-410.                                           D.100329
009160*ACP-420.                                                         D.100329
009170*****ACCEPT A-S06.                                                D.100329
009180*****IF ESTAT = BTB                                               D.100329
009190*****    GO TO ACP-410.                                           D.100329
009200*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009210*****    GO TO ACP-420.                                           D.100329
009220*ACP-430.                                                         D.100329
009230*****ACCEPT A-S07.                                                D.100329
009240*****IF ESTAT = BTB                                               D.100329
009250*****    GO TO ACP-420.                                           D.100329
009260*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009270*****    GO TO ACP-430.                                           D.100329
009280*ACP-435.                                                         D.100329
009290*****ACCEPT A-S12.                                                D.100329
009300*****IF ESTAT = BTB                                               D.100329
009310*****    GO TO ACP-430.                                           D.100329
009320*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009330*****    GO TO ACP-435.                                           D.100329
009340*****IF W-S12 NOT = 0 AND 1                                       D.040617
009350*****IF W-S12 NOT = 0 AND 1 AND 2 AND 3                           D.100329
009360*****    GO TO ACP-435.                                           D.100329
009370*ACP-440.                                                         D.100329
009380*****ACCEPT A-S09.                                                D.100329
009390*****IF ESTAT = BTB                                               D.100329
009400*****    GO TO ACP-435.                                           D.100329
009410*****    GO TO ACP-430.                                           D.040511
009420*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009430*****    GO TO ACP-440.                                           D.100329
009440*****IF W-S09 NOT = 0 AND 1                                       D.100329
009450*****    GO TO ACP-440.                                           D.100329
009460*ACP-450.                                                         D.100329
009470*****ACCEPT A-S10.                                                D.100329
009480*****IF ESTAT = BTB                                               D.100329
009490*****    GO TO ACP-440.                                           D.100329
009500*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009510*****    GO TO ACP-450.                                           D.100329
009520*****IF W-S10 NOT = 0 AND 1                                       D.040408
009530*****IF W-S10 NOT = 0 AND 1 AND 2                                 D.100329
009540*****    GO TO ACP-450.                                           D.100329
009550*ACP-460.                                                         D.100329
009560*****ACCEPT A-S11.                                                D.100329
009570*****IF ESTAT = BTB                                               D.100329
009580*****    GO TO ACP-450.                                           D.100329
009590*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009600*****    GO TO ACP-460.                                           D.100329
009610*****IF W-S11 NOT = 0 AND 1                                       D.100329
009620*****    GO TO ACP-460.                                           D.100329
009630*****IF W-S11 = 0                                                 D.100329
009640*****    MOVE ZERO TO W-S081 W-S082 W-S083                        D.100329
009650*****    DISPLAY D-DENC                                           D.100329
009660*****    GO TO ACP-520.                                           D.100329
009670*****DISPLAY A-S081 A-S082 A-S083.                                D.100329
009680*ACP-470.                                                         D.100329
009690*****ACCEPT A-S081.                                               D.100329
009700*****IF ESTAT = BTB                                               D.100329
009710*****    GO TO ACP-460.                                           D.100329
009720*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009730*****    GO TO ACP-470.                                           D.100329
009740*ACP-480.                                                         D.100329
009750*****ACCEPT A-S082.                                               D.100329
009760*****IF ESTAT = BTB                                               D.100329
009770*****    GO TO ACP-470.                                           D.100329
009780*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009790*****    GO TO ACP-480.                                           D.100329
009800*****IF W-S081 > W-S082                                           D.100329
009810*****    GO TO ACP-480.                                           D.100329
009820*****IF W-S082 = ZERO                                             D.100329
009830*****    MOVE ZERO TO W-S083                                      D.100329
009840*****    GO TO ACP-520.                                           D.100329
009850*ACP-490.                                                         D.100329
009860*****ACCEPT A-S083.                                               D.100329
009870*****IF ESTAT = BTB                                               D.100329
009880*****    GO TO ACP-480.                                           D.100329
009890*****IF ESTAT NOT = HTB AND SKP                                   D.100329
009900*****    GO TO ACP-490.                                           D.100329
009910*****IF W-S083 < W-S081 OR W-S083 > W-S082                        D.100329
009920*****    GO TO ACP-490.                                           D.100329
009930 ACP-520.                                                         I.960913
009940     ACCEPT A-DMM.                                                I.960913
009950     IF ESTAT = BTB                                               I.960913
009960         IF W-ACT = 3                                             I.960913
009970             GO TO ACP-020                                        I.960913
009980           ELSE                                                   I.960913
009990             GO TO ACP-280.                                       I.160210
010000*****        IF W-TCDD = 5000                                     D.160210
010010*****            GO TO ACP-270                                    D.160210
010020*****          ELSE                                               D.160210
010030*****            GO TO ACP-260.                                   D.160210
010040     IF ESTAT NOT = HTB AND SKP                                   I.960913
010050         GO TO ACP-520.                                           I.960913
010060     IF W-DMM = 9                                                 I.960913
010070         DISPLAY E-ME4 E-ME98                                     I.960913
010080         GO TO ACP-020.                                           I.960913
010090     IF W-DMM NOT = 1                                             I.960913
010100         GO TO ACP-520.                                           I.960913
010110 ACP-EX.                                                          I.960913
010120     EXIT.                                                        I.960913
010130*---------------　ＨＫＢＭ　ＲＥＡＤ　------------------------------------
010140 HKBM-RTN.                                                        I.960913
010150     MOVE 0 TO W-INV.                                             I.960913
010160     IF W-FKC = ZERO                                              I.960913
010170         GO TO HKBM-EX.                                           I.960913
010180     OPEN INPUT HKBM.                                             I.960913
010190     MOVE 01 TO HKB-NO.                                           I.960913
010200     MOVE W-FKC TO HKB-TDFK.                                      I.960913
010210     READ HKBM WITH UNLOCK INVALID KEY                            I.960913
010220         MOVE NC"　　　　" TO HKB-FKNA                            I.960913
010230         MOVE 9 TO W-INV.                                         I.960913
010240     CLOSE HKBM.                                                  I.960913
010250 HKBM-EX.                                                         I.960913
010260     EXIT.                                                        I.960913
010270*---------------　ＪＣＯＮ　ＲＥＡＤ　------------------------------------
010280 JCON-RTN.                                                        I.960913
010290     MOVE 0 TO W-INV.                                             I.960913
010300     IF W-UCD = ZERO                                              I.960913
010310         GO TO JCON-EX.                                           I.960913
010320     OPEN INPUT JCON.                                             I.960913
010330     MOVE 2 TO JCON2-01.                                          I.960913
010340     MOVE W-UCD TO JCON2-02.                                      I.960913
010350     READ JCON WITH UNLOCK INVALID KEY                            I.960913
010360         MOVE NC"　　　　　　" TO JCON2-03                        I.960913
010370         MOVE 9 TO W-INV.                                         I.960913
010380     CLOSE JCON.                                                  I.960913
010390 JCON-EX.                                                         I.960913
010400     EXIT.                                                        I.960913
010410*---------------　ＳＴＥＮＭ　ＲＥＡＤ　----------------------------------
010420*STENM-RTN.                                                       D.100329
010430*****MOVE 0 TO W-INV.                                             D.100329
010440*****IF W-SEK = ZERO                                              D.100329
010450*****    MOVE 9 TO W-INV                                          D.100329
010460*****    GO TO STENM-EX.                                          D.100329
010470*****MOVE W-STC TO STE-02                                         D.100329
010480*****READ STENM WITH UNLOCK INVALID KEY                           D.100329
010490*****    MOVE 9 TO W-INV.                                         D.100329
010500*STENM-EX.                                                        D.100329
010510*****EXIT.                                                        D.100329
010520*---------------　ＴＥＬ　チェック　--------------------------------------
010530 TEL-RTN.                                                         I.930315
010540     MOVE ZERO TO TC-KEY.                                         I.930315
010550     MOVE W-TCDD TO TC-TCD.                                       I.930315
010560     START TC-M KEY NOT < TC-KEY INVALID KEY                      I.930315
010570         GO TO TEL-EX.                                            I.930315
010580 TEL-020.                                                         I.930315
010590     READ TC-M NEXT RECORD WITH UNLOCK AT END                     I.930315
010600         GO TO TEL-EX.                                            I.930315
010610     IF TC-TCD NOT = W-TCDD                                       I.930315
010620         GO TO TEL-EX.                                            I.930315
010630     IF TC-TEL NOT = SPACE                                        I.930315
010640         IF TC-TEL = W-TEL                                        I.930315
010650             DISPLAY D-EQ E-ME10 E-ME99                           I.930315
010660             DISPLAY D-EQC E-SPACE.                               I.040122
010670     GO TO TEL-020.                                               I.930315
010680 TEL-EX.                                                          I.930315
010690     EXIT.                                                        I.930315
010700*----------  ＷＲＩＴＥ・ＲＥＷＲＩＴＥ・ＤＥＬＥＴＥ　-------------------
010710 WRD-RTN.                                                         I.960913
010720     MOVE W-R TO TC-R.                                            I.960913
010730     IF W-ACT NOT = 1                                             I.960913
010740         GO TO WRD-060.                                           I.960913
010750     WRITE TC-R INVALID KEY                                       I.960913
010760         DISPLAY E-STAT E-ME5 E-ME99                              I.960913
010770         GO TO WRD-020.                                           I.960913
010780     CALL "CBLTCLS" USING TC-M.                                   I.960913
010790     GO TO WRD-900.                                               I.960913
010800 WRD-020.                                                         I.960913
010810     IF ERR-STAT NOT = "24"                                       I.960913
010820         DISPLAY E-ME78 E-ME99                                    I.960913
010830         MOVE 9 TO W-END                                          I.960913
010840         GO TO WRD-EX.                                            I.960913
010850     DISPLAY E-SPACE.                                             I.040122
010860     CLOSE TC-M.                                                  I.960913
010870     MOVE "TCM          " TO W-FILE.                              I.960913
010880     DISPLAY E-ME71 E-ME98 STOP " ".                              I.960913
010890     DISPLAY E-SPACE.                                             I.040122
010900     OPEN I-O TC-M.                                               I.960913
010910     GO TO WRD-RTN.                                               I.960913
010920 WRD-060.                                                         I.960913
010930     IF W-ACT NOT = 2                                             I.960913
010940         GO TO WRD-100.                                           I.960913
010950     REWRITE TC-R INVALID KEY                                     I.960913
010960         DISPLAY E-STAT E-ME6 E-ME99                              I.960913
010970         MOVE 9 TO W-END                                          I.960913
010980         GO TO WRD-EX.                                            I.960913
010990*****IF W-NAME NOT = W-ONAME                                      D.100329
011000     GO TO WRD-900.                                               I.960913
011010*****IF W-JSU NOT = W-OJSU                                        D.100329
011020*****    GO TO WRD-900.                                           D.100329
011030*****IF W-JSS NOT = W-OJSS                                        D.100329
011040*****    GO TO WRD-900.                                           D.100329
011050*****IF W-UNO NOT = W-OUNO                                        D.100329
011060*****    GO TO WRD-900.                                           D.100329
011070*****IF W-FKC NOT = W-OFKC                                        D.100329
011080*****    GO TO WRD-900.                                           D.100329
011090*****IF W-UCD NOT = W-OUCD                                        D.100329
011100*****    GO TO WRD-900.                                           D.100329
011110*****IF W-TEL NOT = W-OTEL                                        D.100329
011120*****    GO TO WRD-900.                                           D.100329
011130*****GO TO WRD-901.                                               D.100329
011140 WRD-100.                                                         I.960913
011150     DELETE TC-M INVALID KEY                                      I.960913
011160         DISPLAY E-STAT E-ME7 E-ME99                              I.960913
011170         MOVE 9 TO W-END                                          I.960913
011180         GO TO WRD-EX.                                            I.960913
011190     CALL "CBLTCLS" USING TC-M.                                   I.960913
011200 WRD-900.                                                         I.960913
011210*****PERFORM MS-RTN THRU MS-EX.                                   D.100329
011220     IF W-ACT = 1 OR 2                                            I.960913
011230         MOVE 1 TO W-ACP.                                         I.960913
011240*WRD-901.                                                         D.100329
011250*****IF W-ACT = 1                                                 D.100329
011260*****    IF W-SEK = 1                                             D.100329
011270*****        PERFORM ST-WRI-RTN THRU ST-WRI-EX                    D.100329
011280*****        GO TO WRD-EX                                         D.100329
011290*****      ELSE                                                   D.100329
011300*****        GO TO WRD-EX.                                        D.100329
011310*****IF W-ACT = 3                                                 D.100329
011320*****    MOVE W-STC TO W-OSTC                                     D.100329
011330*****    PERFORM ST-DEL-RTN THRU ST-DEL-EX                        D.100329
011340*****    GO TO WRD-EX.                                            D.100329
011350*****IF W-OSEK = 0                                                D.100329
011360*****    IF W-SEK = 0                                             D.100329
011370*****        GO TO WRD-EX                                         D.100329
011380*****      ELSE                                                   D.100329
011390*****        PERFORM ST-WRI-RTN THRU ST-WRI-EX                    D.100329
011400*****        GO TO WRD-EX.                                        D.100329
011410*****PERFORM ST-DEL-RTN THRU ST-DEL-EX.                           D.100329
011420*****IF W-SEK = 1                                                 D.100329
011430*****    PERFORM ST-WRI-RTN THRU ST-WRI-EX.                       D.100329
011440 WRD-EX.                                                          I.960913
011450     EXIT.                                                        I.960913
011460*---------------　ＭＳＴＲＮ　更新　--------------------------------------
011470*MS-RTN.                                                          D.100329
011480*****MOVE "1" TO MS-ID.                                           D.100329
011490*****MOVE W-TCD TO MS-TCD.                                        D.100329
011500*****MOVE W-CCD TO MS-CCD.                                        D.100329
011510*****READ MSTRN INVALID KEY                                       D.100329
011520*****    GO TO MS-020.                                            D.100329
011530*****MOVE W-ACT TO MS-ACT.                                        D.100329
011540*****MOVE W-DATE TO MS-NGP.                                       D.100329
011550*****REWRITE MS-R INVALID KEY                                     D.100329
011560*****    DISPLAY E-STAT E-ME9 E-ME99.                             D.100329
011570*****GO TO MS-EX.                                                 D.100329
011580*MS-020.                                                          D.100329
011590*****MOVE ZERO TO MS-R.                                           D.100329
011600*****MOVE "1" TO MS-ID.                                           D.100329
011610*****MOVE W-TCD TO MS-TCD.                                        D.100329
011620*****MOVE W-CCD TO MS-CCD.                                        D.100329
011630*****MOVE W-ACT TO MS-ACT.                                        D.100329
011640*****MOVE W-DATE TO MS-NGP.                                       D.100329
011650*****WRITE MS-R INVALID KEY                                       D.100329
011660*****    GO TO MS-030.                                            D.100329
011670*****GO TO MS-EX.                                                 D.100329
011680*MS-030.                                                          D.100329
011690*****IF W-OVR = 0                                                 D.100329
011700*****    MOVE 1 TO W-OVR                                          D.100329
011710*****    DISPLAY E-STAT E-ME8 E-ME99.                             D.100329
011720*MS-EX.                                                           D.100329
011730*****EXIT.                                                        D.100329
011740*---------------　ＳＴＥＮＭ　登録　--------------------------------------
011750*ST-WRI-RTN.                                                      D.100329
011760*****MOVE 0 TO W-INV.                                             D.100329
011770*****MOVE W-STC TO STE-02.                                        D.100329
011780*****READ STENM INVALID KEY                                       D.100329
011790*****    MOVE 9 TO W-INV.                                         D.100329
011800*****IF W-INV = 0                                                 D.100329
011810*****    GO TO ST-WRI-EX.                                         D.100329
011820*****MOVE 0 TO W-INV.                                             D.100329
011830*****MOVE W-TCDD TO W-S011.                                       D.100329
011840*****MOVE W-CCD TO W-S012.                                        D.100329
011850*****MOVE W-STC TO W-S02.                                         D.100329
011860*****MOVE W-STENM TO STE-R.                                       D.100329
011870*****WRITE STE-R INVALID KEY                                      D.100329
011880*****    DISPLAY E-STAT E-ME15 E-ME99.                            D.100329
011890*****    DISPLAY E-STAT E-ME5 E-ME99.                             D.040511
011900*****CALL "CBLTCLS" USING STENM.                                  D.100329
011910*ST-WRI-EX.                                                       D.100329
011920*****EXIT.                                                        D.100329
011930*---------------　ＳＴＥＮＭ　削除　--------------------------------------
011940*ST-DEL-RTN.                                                      D.100329
011950*****MOVE W-OSTC TO STE-02.                                       D.100329
011960*****MOVE 0 TO W-INV.                                             D.100329
011970*****READ STENM INVALID KEY                                       D.100329
011980*****    MOVE 9 TO W-INV.                                         D.100329
011990*****IF W-INV = 9                                                 D.100329
012000*****    MOVE 0 TO W-INV                                          D.100329
012010*****    GO TO ST-DEL-EX.                                         D.100329
012020*****DELETE STENM INVALID KEY                                     D.100329
012030*****    DISPLAY E-STAT E-ME17 E-ME99.                            D.100329
012040*****    DISPLAY E-STAT E-ME7 E-ME99.                             D.040511
012050*****CALL "CBLTCLS" USING STENM.                                  D.100329
012060*ST-DEL-EX.                                                       D.100329
012070*****EXIT.                                                        D.100329
012080*---------------　作　　表　----------------------------------------------
012090 LST-RTN.                                                         I.960913
012100     MOVE ZERO TO W-SEKEY.                                        I.960913
012110     DISPLAY D-PM.                                                I.960913
012120     ACCEPT A-SKEY.                                               I.960913
012130     IF ESTAT = BTB                                               I.960913
012140         GO TO LST-EX.                                            I.960913
012150     IF ESTAT NOT = HTB AND SKP                                   I.960913
012160         GO TO LST-RTN.                                           I.960913
012170 LST-020.                                                         I.960913
012180     ACCEPT A-EKEY.                                               I.960913
012190     IF ESTAT = BTB                                               I.960913
012200         GO TO LST-RTN.                                           I.960913
012210     IF ESTAT NOT = HTB AND SKP                                   I.960913
012220         GO TO LST-020.                                           I.960913
012230     IF W-SKEY > W-EKEY                                           I.960913
012240         GO TO LST-RTN.                                           I.960913
012250 LST-040.                                                         I.960913
012260     ACCEPT A-DMM.                                                I.960913
012270     IF ESTAT = BTB                                               I.960913
012280         GO TO LST-020.                                           I.960913
012290     IF ESTAT NOT = HTB AND SKP                                   I.960913
012300         GO TO LST-RTN.                                           I.960913
012310     IF W-DMM = 9                                                 I.960913
012320         GO TO LST-RTN.                                           I.960913
012330     IF W-DMM NOT = 1                                             I.960913
012340         GO TO LST-040.                                           I.960913
012350*
012360     CLOSE TC-M.                                                  I.960913
012370     OPEN INPUT TC-M.                                             I.960913
012380*
012390     MOVE ZERO TO TC-KEY.                                         I.960913
012400     MOVE W-SKEY TO TC-TCD.                                       I.960913
012410     START TC-M KEY NOT < TC-KEY INVALID KEY                      I.960913
012420         DISPLAY E-ME2 E-ME98                                     I.960913
012430         GO TO LST-RTN.                                           I.960913
012440     READ TC-M NEXT RECORD WITH UNLOCK AT END                     I.960913
012450         DISPLAY E-ME2 E-ME98                                     I.960913
012460         GO TO LST-RTN.                                           I.960913
012470     IF TC-TCD > W-EKEY                                           I.960913
012480         DISPLAY E-ME2 E-ME98                                     I.960913
012490         GO TO LST-RTN.                                           I.960913
012500     IF W-PC = ZERO                                               I.960913
012510         MOVE 5 TO W-PC                                           I.960913
012520         OPEN OUTPUT SP-F                                         I.960913
012530         PERFORM MID-020 THRU MID-EX.                             I.960913
012540 LST-060.                                                         I.960913
012550     MOVE 0 TO CHK.                                               I.960913
012560     MOVE TC-TCD TO W-TCD.                                        I.960913
012570 LST-080.                                                         I.960913
012580     MOVE SPACE TO W-P.                                           I.960913
012590     MOVE SPACE TO P-NAME P-JS.                                   I.960913
012600     IF CHK = 0                                                   I.960913
012610         MOVE 5 TO CHK                                            I.960913
012620         MOVE W-TCD TO P-TCD                                      I.960913
012630         MOVE "-" TO P-V.                                         I.960913
012640     MOVE TC-CCD TO P-CCD.                                        I.960913
012650     MOVE TC-NAME TO P-NAME.                                      I.960913
012660     MOVE TC-JSU TO P-JS.                                         I.960913
012670     MOVE TC-UNO TO P-UNO.                                        I.960913
012680     IF TC-FKC NOT = ZERO                                         I.960913
012690         MOVE TC-FKC TO P-FKC.                                    I.960913
012700     IF TC-UCD NOT = ZERO                                         I.960913
012710         MOVE TC-UCD TO P-UCD.                                    I.960913
012720     MOVE TC-TEL TO P-TEL.                                        I.960913
012730     IF TC-DATE NOT = ZERO                                        I.960913
012740         MOVE TC-DATE TO P-YMD.                                   I.960913
012750*****MOVE TC-STK TO P-STK.                                        D.040323
012760     MOVE TC-BIK TO P-BIK.                                        I.990428
012770     MOVE TC-DHC TO P-DHC.                                        I.000703
012780     IF TC-PNO NOT = ZERO                                         I.050824
012790         MOVE TC-PNO TO P-PNO.                                    I.050824
012800     IF TC-CCD = 001                                              I.040708
012810         MOVE TC-SSC TO P-SSC.                                    I.040708
012820     IF LINAGE-COUNTER > 61                                       I.960913
012830         MOVE W-TCD TO P-TCD                                      I.960913
012840         MOVE "-" TO P-V                                          I.960913
012850         PERFORM MID-RTN THRU MID-EX.                             I.960913
012860     MOVE W-15K TO P-15B.                                         I.040126
012870     MOVE W-20K TO P-20B.                                         I.040126
012880     MOVE SPACE TO SP-R.                                          I.960913
012890     MOVE W-P TO SP-R.                                            I.960913
012900     WRITE SP-R.                                                  I.960913
012910     MOVE SPACE TO SP-R.                                          I.960913
012920*****IF NOT(TC-JSS = SPACE AND TC-STC = ZERO)                     D.140829
012930     IF TC-JSS NOT = SPACE                                        I.140829
012940         MOVE SPACE TO W-P                                        I.960913
012950         MOVE SPACE TO P-NAME P-JS                                I.960913
012960         MOVE TC-JSS TO P-JS                                      I.020402
012970*****    MOVE TC-STC TO P-TEL                                     D.140829
012980         MOVE W-15K TO P-15B                                      I.040126
012990         MOVE W-20K TO P-20B                                      I.040126
013000         MOVE SPACE TO SP-R                                       I.960913
013010         MOVE W-P TO SP-R                                         I.960913
013020         WRITE SP-R                                               I.960913
013030         MOVE SPACE TO SP-R.                                      I.960913
013040 LST-100.                                                         I.960913
013050     READ TC-M NEXT RECORD WITH UNLOCK AT END                     I.960913
013060         GO TO LST-900.                                           I.960913
013070     IF TC-TCD > W-EKEY                                           I.960913
013080         GO TO LST-900.                                           I.960913
013090     IF TC-TCD = 9999                                             I.960913
013100         GO TO LST-900.                                           I.960913
013110     IF TC-TCD NOT = W-TCD                                        I.960913
013120         GO TO LST-060.                                           I.960913
013130     GO TO LST-080.                                               I.960913
013140 LST-900.                                                         I.960913
013150     CLOSE TC-M.                                                  I.960913
013160     OPEN I-O TC-M.                                               I.960913
013170 LST-EX.                                                          I.960913
013180     EXIT.                                                        I.960913
013190*---------------　見出し　印字　------------------------------------------
013200 MID-RTN.
013210     MOVE SPACE TO SP-R.
013220     WRITE SP-R AFTER PAGE.
013230 MID-020.
013240     ADD 1 TO W-PAGE.
013250     MOVE W-PAGE TO H-PAGE.
013260     MOVE W-20K TO P-20.                                          I.040126
013270     MOVE SPACE TO SP-R.
013280     MOVE HEAD1 TO SP-R.
013290     WRITE SP-R.
013300     MOVE SPACE TO SP-R.
013310     MOVE W-15K TO P-15A.                                         I.040126
013320     MOVE W-20K TO P-20A.                                         I.040126
013330     MOVE HEAD2 TO SP-R.
013340     WRITE SP-R AFTER 2.
013350     MOVE SPACE TO SP-R.
013360 MID-EX.
013370     EXIT.
