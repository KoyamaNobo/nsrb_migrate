000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KBY070.
000030*********************************************************
000040*    PROGRAM         :  材料棚卸セット　　　　　　　    *
000050*    PRINTER TYPE    :  ****                            *
000060*    SCREEN          :  ******                          *
000070*        変更　　　  :  99/04/26                        *
000080*    COMPILE TYPE    :  COBOL                           *
000090*********************************************************
000100 ENVIRONMENT DIVISION.
000110 CONFIGURATION SECTION.
000120 SOURCE-COMPUTER. SYSTEM3100.
000130 OBJECT-COMPUTER. SYSTEM3100.
000140 INPUT-OUTPUT SECTION.
000150 FILE-CONTROL.
000160     SELECT JTIF ASSIGN TO JTI-MSD.
000170     SELECT JT-M ASSIGN TO JT-MSD
000180         ORGANIZATION INDEXED
000190         ACCESS MODE DYNAMIC
000200         RECORD KEY JT-KEY
000210         FILE STATUS IS ERR-STAT.
000220 I-O-CONTROL.
000230     APPLY SHARED-MODE ON JT-M.
000240 DATA DIVISION.
000250 FILE SECTION.
000260     COPY LIJTM.
000270 FD  JTIF
000280     BLOCK 12 RECORDS
000290     LABEL RECORD IS STANDARD
000300     VALUE OF IDENTIFICATION "JTIF".
000310 01  JTI-R.
000320     02  JTI-KEY        PIC  9(006).
000330     02  JTI-BSC        PIC  9(002).
000340     02  JTI-TSU        PIC S9(007)V9(02).
000350     02  F              PIC  X(003).
000360     02  JTI-PC         PIC  9(001).
000370 WORKING-STORAGE SECTION.
000380 01  W-D.
000390     02  W-L          PIC  9(002).
000400     02  W-DMM        PIC  9(001).
000410     02  W-C          PIC  9(001).
000420 01  ERR-STAT         PIC  X(002).
000430     COPY LSTAT.
000440 SCREEN SECTION.
000450 SD  C-CRT
000460     END STATUS IS ESTAT.
000470 01  C-CLEAR.
000480     02  C-CL    LINE   1  CLEAR SCREEN.
000490 01  C-MID.
000500     02  LINE   3  COLUMN  10  PIC  N(022) VALUE
000510          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000520     02  LINE   4  COLUMN  10  PIC  N(022) VALUE
000530          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000540     02  LINE   5  COLUMN  10  PIC  N(022) VALUE
000550          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
000560     02  LINE   6  COLUMN  10  PIC  N(022) VALUE
000570          NC"＊＊＊　　材料棚卸　在庫数　セット　　＊＊＊".
000580     02  LINE   7  COLUMN  10  PIC  N(022) VALUE
000590          NC"＊＊＊　　　　　　　　　　　　　　　　＊＊＊".
000600     02  LINE   8  COLUMN  10  PIC  N(022) VALUE
000610          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000620     02  LINE   9  COLUMN  10  PIC  N(022) VALUE
000630          NC"＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊".
000640     02  LINE  20  COLUMN  21  PIC  X(022) VALUE
000650          "確認  OK=1 NO=9   ﾘﾀｰﾝ".
000660 01  C-ACT.
000670     02  A-DMM   LINE  20  COLUMN  38  PIC  9(001)
000680          USING W-DMM   CHECK OVERFLOW NO IFC.
000690 01  C-ERR.
000700     02  LINE  24.
000710       03  E-STAT  COLUMN  10  PIC  X(002) FROM  ERR-STAT.
000720       03  E-ME3   COLUMN  15  PIC  X(018) VALUE
000730            "***   JTM ﾅｼ   ***".
000740       03  E-ME5   COLUMN  15  PIC  X(023) VALUE
000750            "***   REWRITE ｴﾗｰ   ***".
000760       03  E-KEY   COLUMN  45  PIC  9(006) FROM  JT-KEY.
000770       03  E-ME78  COLUMN   5  PIC  N(002) VALUE NC"連絡".
000780       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000790       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000800       03  E-CL.
000810         04  COLUMN   1  PIC  X(040) VALUE
000820              "                                        ".
000830         04  COLUMN  41  PIC  X(040) VALUE
000840              "                                        ".
000850 PROCEDURE DIVISION.
000860 M-05.
000870     DISPLAY C-CLEAR.
000880     DISPLAY C-MID.
000890 M-10.
000900     ACCEPT A-DMM.
000910     IF ESTAT NOT = HTB AND SKP
000920         GO TO M-10.
000930     IF W-DMM = 9
000940         DISPLAY C-CLEAR
000950         STOP RUN.
000960     IF W-DMM NOT = 1
000970         GO TO M-10.
000980     OPEN I-O JT-M.
000990 M-15.
001000     READ JT-M NEXT RECORD AT END
001010         GO TO M-20.
001020     MOVE ZERO TO JT-TSU.
001030     REWRITE JT-R INVALID KEY
001040         DISPLAY E-ME78 E-STAT E-ME5 E-ME99
001050         GO TO M-95.
001060     GO TO M-15.
001070 M-20.
001080     OPEN INPUT JTIF.
001090 M-25.
001100     READ JTIF AT END
001110         GO TO M-95.
001120     MOVE JTI-KEY TO JT-KEY.
001130     READ JT-M INVALID KEY
001140         DISPLAY E-ME3 E-KEY E-ME99
001150         DISPLAY E-CL
001160         GO TO M-25.
001170     ADD JTI-TSU TO JT-TSU.
001180     REWRITE JT-R INVALID KEY
001190         DISPLAY E-ME78 E-STAT E-ME5 E-KEY E-ME99
001200         GO TO M-95.
001210     GO TO M-25.
001220 M-95.
001230     CLOSE JTIF.
001240     CLOSE JT-M.
001250     DISPLAY C-CLEAR.
001260     STOP RUN.
