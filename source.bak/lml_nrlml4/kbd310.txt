000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KBD310.
000030*********************************************************
000040*    PROGRAM         :  履物製品仕入発注入力            *
000050*    PRINTER TYPE    :  JIPS                            *
000060*    SCREEN          :  SCBD31                          *
000070*    COMPILE TYPE    :  COBOL                           *
000080*********************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT S-M ASSIGN TO S-MSD
000170         ORGANIZATION INDEXED
000180         ACCESS MODE RANDOM
000190         RECORD KEY S-KEY
000200         FILE STATUS IS ERR-STAT.
000210     SELECT HI-M ASSIGN TO HI1-MSD HI2-MSD
000220         ORGANIZATION INDEXED
000230         ACCESS MODE RANDOM
000240         RECORD KEY HI-KEY
000250         ALTERNATE RECORD KEY HI-KEY2
000260         FILE STATUS IS ERR-STAT.
000270     SELECT HSHF ASSIGN TO HSH1-MSD HSH2-MSD HSH3-MSD
000280         ORGANIZATION INDEXED
000290         ACCESS MODE DYNAMIC
000300         RECORD KEY HSH-KEY
000310         ALTERNATE RECORD KEY HSH-KEY2
000320         ALTERNATE RECORD KEY HSH-KEY3
000330         FILE STATUS IS ERR-STAT.
000340     SELECT HSHNF ASSIGN TO HSHN-MSD
000350         ORGANIZATION INDEXED
000360         ACCESS MODE DYNAMIC
000370         RECORD KEY HSHN-KEY
000380         FILE STATUS IS ERR-STAT.
000390     SELECT HSS-F ASSIGN TO HSS-MSD
000400         ORGANIZATION INDEXED
000410         ACCESS MODE DYNAMIC
000420         RECORD KEY HSS-KEY
000430         FILE STATUS IS ERR-STAT.
000440 I-O-CONTROL.
000450     APPLY SHARED-MODE ON M-DATE
000460     APPLY SHARED-MODE ON S-M
000470     APPLY SHARED-MODE ON HI-M
000480     APPLY SHARED-MODE ON HSHNF
000490     APPLY SHARED-MODE ON HSS-F
000500     APPLY SHARED-MODE ON HSHF.
000510 DATA DIVISION.
000520 FILE SECTION.
000530     COPY LIBFDD.
000540     COPY LISM.
000550     COPY LIHIM.
000560     COPY LIHSHF.
000570     COPY LIHSHN.
000580     COPY LIHSSF.
000590 WORKING-STORAGE SECTION.
000600 01  W-DATA.
000610     02  W-ACT          PIC  9(001).
000620     02  W-EC           PIC  9(001).
000630     02  W-DMM          PIC  9(001).
000640     02  W-RNO.
000650       03  W-RSN        PIC  9(002).
000660       03  W-RNG        PIC  9(004).
000670       03  W-RNGD  REDEFINES W-RNG.
000680         04  W-RNEN     PIC  9(002).
000690         04  W-RGET     PIC  9(002).
000700       03  W-RND        PIC  9(002).
000710     02  W-SU           PIC  9(004).
000720     02  W-SUT          PIC  9(005).
000730     02  W-KIN          PIC  9(008).
000740     02  W-L            PIC  9(002).
000750     02  W-C            PIC S9(002).
000760     02  CNT            PIC  9(002).
000770     02  W-S            PIC  9(001).
000780     02  W-SD           PIC  9(001).
000790     02  W-DATE         PIC  9(008).
000800     02  W-NGP   REDEFINES W-DATE.
000810       03  W-NEN        PIC  9(004).
000820       03  W-NEND  REDEFINES W-NEN.
000830         04  W-NEN1     PIC  9(002).
000840         04  W-NEN2     PIC  9(002).
000850       03  W-GET        PIC  9(002).
000860       03  W-PEY        PIC  9(002).
000870     02  W-NGPD  REDEFINES W-DATE.
000880       03  F            PIC  9(002).
000890       03  W-NGPS       PIC  9(006).
000900     02  W-HNGP.
000910       03  W-HNEN       PIC  9(004).
000920       03  W-HGET       PIC  9(002).
000930       03  W-HPEY       PIC  9(002).
000940     02  W-ENGP         PIC  9(006).
000950     02  W-HNGPS        PIC  9(006).
000960     02  W-SCD          PIC  9(004).
000970 01  W-EM               PIC  X(030) VALUE SPACE.
000980 01  W-FILE             PIC  X(013) VALUE SPACE.
000990 01  ERR-STAT           PIC  X(002).
001000     COPY LSTAT.
001010 SCREEN SECTION.
001020 SD  C-CRT
001030     END STATUS IS ESTAT.
001040 01  C-CLEAR.
001050     02  C-CL    LINE   1  CLEAR SCREEN.
001060 01  C-ACP.
001070     02  A-ACT   LINE   2  COLUMN  59   PIC  9(001)
001080          USING W-ACT    CHECK OVERFLOW NO IFC.
001090     02  LINE   3.
001100       03  A-RSN   COLUMN  11   PIC  9(002)
001110            USING W-RSN                     NO IFC.
001120       03  A-RNG   COLUMN  14   PIC  9(004)
001130            USING W-RNG                     NO IFC.
001140       03  A-RND   COLUMN  19   PIC  9(002)
001150            USING W-RND      CHECK OVERFLOW NO IFC.
001160     02  A-HDD   LINE   4  COLUMN  11   PIC  9(006)
001170          USING HSH-HNGPS  CHECK OVERFLOW NO IFC.
001180     02  A-SCD   LINE   5  COLUMN  11   PIC  9(004)
001190          USING HSH-SCD    CHECK OVERFLOW NO IFC.
001200     02  A-HCD   LINE   6  COLUMN  11   PIC  9(006)
001210          USING HSH-HCD    CHECK OVERFLOW NO IFC.
001220     02  A-HSU   LINE W-L  COLUMN W-C   PIC  9(004)
001230          USING HSH-HSU(W-S,CNT) CHECK OVERFLOW NO IFC.
001240     02  A-T     LINE  18  COLUMN  59   PIC  9(005)
001250          USING HSH-T      CHECK OVERFLOW NO IFC.
001260     02  A-NDD   LINE  21  COLUMN   2   PIC  9(006)
001270          USING HSH-NNGPS  CHECK OVERFLOW NO IFC.
001280     02  A-EC    LINE  21  COLUMN  58   PIC  9(001)
001290          USING W-EC       CHECK OVERFLOW NO IFC.
001300     02  A-DMM   LINE  23  COLUMN  62   PIC  9(001)
001310          USING W-DMM      CHECK OVERFLOW NO IFC.
001320 01  C-DSP.
001330     02  D-SNA   LINE   5  COLUMN  16  PIC  N(024) FROM  S-NAME.
001340     02  D-HNA   LINE   6  COLUMN  18  PIC  N(024) FROM  HI-NAME.
001350     02  D-HSU   LINE W-L  COLUMN W-C  PIC  Z(004) FROM
001360                                           HSH-HSU(W-S,CNT).
001370     02  D-SUT   LINE  18  COLUMN  52  PIC ZZ,ZZ9  FROM  W-SUT.
001380     02  D-T     LINE  18  COLUMN  59  PIC  Z(005) FROM  HSH-T.
001390     02  D-KIN   LINE  18  COLUMN  65  PIC ZZ,ZZZ,ZZZ
001400                                                   FROM  W-KIN.
001410 01  C-ERR.
001420     02  LINE  24.
001430       03  E-ME    COLUMN  15   PIC  X(030) FROM  W-EM.
001440     COPY LSSEM.
001450     COPY LIBSCR.
001460 PROCEDURE DIVISION.
001470 M-05.
001480     CALL "SCBD31".
001490     COPY LIBCPR.
001500     MOVE ZERO TO W-DATA.
001510     ACCEPT W-ENGP FROM DATE.
001520     MOVE W-ENGP TO W-NGPS.
001530     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
001540         ADD DATE-NC1 TO W-NEN.
001550     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
001560         ADD DATE-NC2 TO W-NEN.
001570     MOVE W-DATE TO W-HNGP.
001580     SUBTRACT 1 FROM W-HGET.
001590     IF W-HGET = ZERO
001600         SUBTRACT 1 FROM W-HNEN
001610         MOVE 12 TO W-HGET.
001620     OPEN INPUT S-M HI-M HSHNF.
001630     OPEN I-O HSHF.
001640 M-10.
001650     ACCEPT A-ACT.
001660     IF ESTAT NOT = HTB AND SKP
001670         GO TO M-10.
001680     IF W-ACT = 9
001690         GO TO M-90.
001700     IF W-ACT NOT = 1 AND 2 AND 3
001710         GO TO M-10.
001720 M-15.
001730     ACCEPT A-RSN.
001740     DISPLAY E-CL.
001750     IF ESTAT = BTB
001760         GO TO M-10.
001770     IF ESTAT NOT = NOC AND HTB AND SKP
001780         GO TO M-15.
001790     IF W-RSN = ZERO
001800         GO TO M-15.
001810 M-20.
001820     ACCEPT A-RNG.
001830     DISPLAY E-CL.
001840     IF ESTAT = BTB
001850         GO TO M-15.
001860     IF ESTAT NOT = NOC AND HTB AND SKP
001870         GO TO M-20.
001880     IF W-RNG = ZERO
001890         GO TO M-20.
001900 M-25.
001910     ACCEPT A-RND.
001920     DISPLAY E-CL.
001930     IF ESTAT = BTB
001940         GO TO M-20.
001950     IF ESTAT NOT = HTB AND SKP
001960         GO TO M-25.
001970     IF W-RND = ZERO
001980         GO TO M-25.
001990*
002000     INITIALIZE HSH-R.
002010     MOVE W-RNO TO HSH-KEY.
002020     READ HSHF INVALID KEY
002030         GO TO M-40.
002040     IF W-ACT = 1
002050         MOVE "***  DATA ｱﾘ  ***             " TO W-EM
002060         DISPLAY E-ME E-ME98
002070         GO TO M-25.
002080     PERFORM DSP-RTN THRU DSP-EX.
002090     IF W-ACT NOT = 3
002100         GO TO M-45.
002110*
002120     MOVE SPACE TO HSHN-KEY.
002130     MOVE W-RNO TO HSHN-RNO.
002140     START HSHNF KEY NOT < HSHN-KEY INVALID KEY
002150         GO TO M-30.
002160     READ HSHNF NEXT RECORD WITH UNLOCK AT END
002170         GO TO M-30.
002180     IF W-RNO NOT = HSHN-RNO
002190         GO TO M-30.
002200     MOVE "***  ｼﾞｯｾｷ ﾃﾞｰﾀ ｱﾘ  ***       " TO W-EM.
002210     DISPLAY E-ME E-ME98.
002220     GO TO M-25.
002230 M-30.
002240     OPEN INPUT HSS-F.
002250 M-35.
002260     READ HSS-F NEXT RECORD WITH UNLOCK AT END
002270         CLOSE HSS-F
002280         GO TO M-45.
002290     IF W-RNO = HSS-RNO
002300         CLOSE HSS-F
002310         MOVE "***  ﾆｭｳﾘｮｸ ﾃﾞｰﾀ ｱﾘ  ***      " TO W-EM
002320         DISPLAY E-ME E-ME98
002330         GO TO M-25.
002340     GO TO M-35.
002350 M-40.
002360     IF W-ACT NOT = 1
002370         MOVE "***  DATA ﾅｼ  ***             " TO W-EM
002380         DISPLAY E-ME E-ME98
002390         GO TO M-25.
002400 M-45.
002410     PERFORM ACP-RTN THRU ACP-EX.
002420     IF ESTAT = BTB
002430         GO TO M-25.
002440     IF W-ACT = 3
002450         IF W-DMM = 9
002460             GO TO M-25.
002470*
002480     IF W-ACT NOT = 1
002490         GO TO M-50.
002500     WRITE HSH-R INVALID KEY
002510         MOVE "***  WRITE ｴﾗｰ  ***           " TO W-EM
002520         DISPLAY E-ME E-ME99
002530         GO TO M-90.
002540     GO TO M-60.
002550 M-50.
002560     IF W-ACT NOT = 2
002570         GO TO M-55.
002580     REWRITE HSH-R INVALID KEY
002590         MOVE "***  REWRITE ｴﾗｰ  ***         " TO W-EM
002600         DISPLAY E-ME E-ME99
002610         GO TO M-90.
002620     GO TO M-60.
002630 M-55.
002640     DELETE HSHF INVALID KEY
002650         MOVE "***  DELETE ｴﾗｰ  ***          " TO W-EM
002660         DISPLAY E-ME E-ME99
002670         GO TO M-90.
002680 M-60.
002690     CALL "SCBD31".
002700     DISPLAY A-ACT.
002710     IF W-ACT = 1
002720         MOVE HSH-HNGPS TO W-HNGPS
002730         MOVE HSH-SCD TO W-SCD
002740         DISPLAY A-RSN A-RNG A-RND A-HDD A-SCD D-SNA.
002750     GO TO M-15.
002760 M-90.
002770     CLOSE S-M.
002780     CLOSE HI-M.
002790     CLOSE HSHNF.
002800     CLOSE HSHF.
002810 M-95.
002820     DISPLAY C-CLEAR.
002830     STOP RUN.
002840 DSP-RTN.
002850     MOVE HSH-SCD TO S-KEY.
002860     READ S-M WITH UNLOCK INVALID KEY
002870         MOVE SPACE TO S-NAME
002880         MOVE NC"＊＊＊　仕入先　なし　　＊＊＊" TO S-NAME.
002890*
002900     MOVE HSH-HCD TO HI-KEY.
002910     READ HI-M WITH UNLOCK INVALID KEY
002920         MOVE SPACE TO HI-NAME
002930         MOVE NC"＊＊＊　品名　なし　　＊＊＊　" TO HI-NAME.
002940*
002950     IF HSH-ENGP = ZERO
002960         MOVE 0 TO W-EC
002970       ELSE
002980         MOVE 1 TO W-EC.
002990     DISPLAY A-HDD A-SCD D-SNA A-HCD D-HNA A-NDD A-EC.
003000     MOVE ZERO TO W-SUT W-KIN.
003010     MOVE 0 TO W-SD.
003020     MOVE 6 TO W-L.
003030 DSP-010.
003040     ADD 1 TO W-SD.
003050     IF W-SD > 4
003060         GO TO DSP-030.
003070     ADD 3 TO W-L.
003080     IF W-SD = 1
003090         MOVE 2 TO W-S.
003100     IF W-SD = 2
003110         MOVE 3 TO W-S.
003120     IF W-SD = 3
003130         MOVE 4 TO W-S.
003140     IF W-SD = 4
003150         MOVE 1 TO W-S.
003160     MOVE ZERO TO CNT.
003170     MOVE -3 TO W-C.
003180 DSP-020.
003190     ADD 1 TO CNT.
003200     IF CNT > 10
003210         GO TO DSP-010.
003220     ADD 5 TO W-C.
003230     DISPLAY D-HSU.
003240     ADD HSH-HSU(W-S,CNT) TO W-SUT.
003250     GO TO DSP-020.
003260 DSP-030.
003270     COMPUTE W-KIN = W-SUT * HSH-T.
003280     DISPLAY D-SUT D-T D-KIN.
003290 DSP-EX.
003300     EXIT.
003310 ACP-RTN.
003320     IF W-ACT = 3
003330         GO TO ACP-340.
003340 ACP-020.
003350     ACCEPT A-HDD.
003360     DISPLAY E-CL.
003370     IF ESTAT = BTB
003380         GO TO ACP-EX.
003390     IF ESTAT NOT = HTB AND SKP
003400         GO TO ACP-020.
003410     IF HSH-HNGPS = ZERO
003420         MOVE W-ENGP TO HSH-HNGPS
003430         DISPLAY A-HDD.
003440     MOVE ZERO TO HSH-HNEN1.
003450     IF HSH-HNEN2 >= DATE-NF1 AND <= DATE-NT1
003460         ADD DATE-NC1 TO HSH-HNEN.
003470     IF HSH-HNEN2 >= DATE-NF2 AND <= DATE-NT2
003480         ADD DATE-NC2 TO HSH-HNEN.
003490     IF HSH-HDD > W-DATE OR < W-HNGP
003500         IF W-ACT = 1
003510             MOVE "***  ﾋﾂﾞｹ ｴﾗｰ  ***            " TO W-EM
003520             DISPLAY E-ME E-ME98
003530             GO TO ACP-020
003540           ELSE
003550             MOVE "***  ﾋﾂﾞｹ ﾁｪｯｸ  ***           " TO W-EM
003560             DISPLAY E-ME E-ME98.
003570 ACP-040.
003580     ACCEPT A-SCD.
003590     DISPLAY E-CL.
003600     IF ESTAT = BTB
003610         GO TO ACP-020.
003620     IF ESTAT NOT = HTB AND SKP
003630         GO TO ACP-040.
003640     MOVE HSH-SCD TO S-KEY.
003650     READ S-M WITH UNLOCK INVALID KEY
003660         MOVE "***  ｼｲﾚｻｷ ﾅｼ  ***            " TO W-EM
003670         DISPLAY E-ME E-ME98
003680         GO TO ACP-040.
003690     DISPLAY D-SNA.
003700     IF HSH-SCD < 5000
003710         GO TO ACP-040.
003720 ACP-060.
003730     ACCEPT A-HCD.
003740     DISPLAY E-CL.
003750     IF ESTAT = BTB
003760         GO TO ACP-040.
003770     IF ESTAT NOT = HTB AND SKP
003780         GO TO ACP-060.
003790     MOVE HSH-HCD TO HI-KEY.
003800     READ HI-M WITH UNLOCK INVALID KEY
003810         MOVE "***  ﾋﾝﾒｲ ﾅｼ  ***             " TO W-EM
003820         DISPLAY E-ME E-ME98
003830         GO TO ACP-060.
003840     DISPLAY D-HNA.
003850*****IF HI-BC1 NOT = 26                                           D.080312
003860*****    MOVE "***  ｾｲｷｮｳ ﾌﾞﾝﾙｲ ｴﾗｰ  ***     " TO W-EM            D.080312
003870*****    DISPLAY E-ME E-ME99                                      D.080312
003880*****    DISPLAY E-CL.                                            D.080312
003890 ACP-070.
003900     MOVE 0 TO W-SD.
003910     MOVE 6 TO W-L.
003920     MOVE 0 TO HI-S(4,10).
003930 ACP-080.
003940     ADD 1 TO W-SD.
003950     IF W-SD > 4
003960         GO TO ACP-180.
003970     ADD 3 TO W-L.
003980     IF W-SD = 1
003990         MOVE 2 TO W-S.
004000     IF W-SD = 2
004010         MOVE 3 TO W-S.
004020     IF W-SD = 3
004030         MOVE 4 TO W-S.
004040     IF W-SD = 4
004050         MOVE 1 TO W-S.
004060     MOVE ZERO TO CNT.
004070     MOVE -3 TO W-C.
004080 ACP-100.
004090     ADD 1 TO CNT.
004100     IF CNT > 10
004110         GO TO ACP-080.
004120     ADD 5 TO W-C.
004130     IF HI-S(W-S,CNT) = ZERO
004140         MOVE ZERO TO HSH-HSU(W-S,CNT)
004150         DISPLAY D-HSU
004160         GO TO ACP-100.
004170 ACP-120.
004180     MOVE HSH-HSU(W-S,CNT) TO W-SU.
004190     ACCEPT A-HSU.
004200     IF ESTAT = ADV
004210         MOVE W-SU TO HSH-HSU(W-S,CNT)
004220         DISPLAY D-HSU
004230         GO TO ACP-180.
004240     IF ESTAT = BTB
004250         GO TO ACP-140.
004260     IF ESTAT NOT = HTB AND SKP
004270         GO TO ACP-120.
004280     DISPLAY D-HSU.
004290     GO TO ACP-100.
004300 ACP-140.
004310     SUBTRACT 1 FROM CNT.
004320     IF CNT = ZERO
004330         GO TO ACP-160.
004340     SUBTRACT 5 FROM W-C.
004350     IF HI-S(W-S,CNT) = ZERO
004360         GO TO ACP-140.
004370     GO TO ACP-120.
004380 ACP-160.
004390     SUBTRACT 1 FROM W-SD.
004400     IF W-SD = 0
004410         GO TO ACP-060.
004420     SUBTRACT 3 FROM W-L.
004430     IF W-SD = 1
004440         MOVE 2 TO W-S.
004450     IF W-SD = 2
004460         MOVE 3 TO W-S.
004470     IF W-SD = 3
004480         MOVE 4 TO W-S.
004490     IF W-SD = 4
004500         MOVE 1 TO W-S.
004510     MOVE 11 TO CNT.
004520     MOVE 52 TO W-C.
004530     GO TO ACP-140.
004540 ACP-180.
004550     MOVE ZERO TO W-SD W-SUT.
004560 ACP-200.
004570     ADD 1 TO W-SD.
004580     IF W-SD > 4
004590         GO TO ACP-240.
004600     MOVE ZERO TO CNT.
004610 ACP-220.
004620     ADD 1 TO CNT.
004630     IF CNT > 10
004640         GO TO ACP-200.
004650     ADD HSH-HSU(W-SD,CNT) TO W-SUT.
004660     GO TO ACP-220.
004670 ACP-240.
004680     DISPLAY D-SUT.
004690 ACP-260.
004700     ACCEPT A-T.
004710     IF ESTAT = BTB
004720         MOVE 5 TO W-SD
004730         MOVE 21 TO W-L
004740         GO TO ACP-160.
004750     IF ESTAT NOT = HTB AND SKP
004760         GO TO ACP-260.
004770     COMPUTE W-KIN = W-SUT * HSH-T.
004780     DISPLAY D-T D-KIN.
004790 ACP-280.
004800     ACCEPT A-NDD.
004810     DISPLAY E-CL.
004820     IF ESTAT = BTB
004830         GO TO ACP-260.
004840     IF ESTAT NOT = HTB AND SKP
004850         GO TO ACP-280.
004860     MOVE ZERO TO HSH-NNEN1.
004870     IF HSH-NNGPS = ZERO
004880         GO TO ACP-300.
004890     IF HSH-NNGPS = 999999
004900         MOVE 99 TO HSH-NNEN1
004910         GO TO ACP-300.
004920     IF HSH-NNEN2 >= DATE-NF1 AND <= DATE-NT1
004930         ADD DATE-NC1 TO HSH-NNEN.
004940     IF HSH-NNEN2 >= DATE-NF2 AND <= DATE-NT2
004950         ADD DATE-NC2 TO HSH-NNEN.
004960     IF HSH-HDD > HSH-NDD
004970         MOVE "***  ﾋﾂﾞｹ ｴﾗｰ  ***            " TO W-EM
004980         DISPLAY E-ME E-ME98
004990         GO TO ACP-280.
005000 ACP-300.
005010     IF W-ACT = 1
005020         MOVE 0 TO W-EC
005030         DISPLAY A-EC
005040         GO TO ACP-340.
005050 ACP-320.
005060     ACCEPT A-EC.
005070     IF ESTAT = BTB
005080         GO TO ACP-280.
005090     IF ESTAT NOT = HTB AND SKP
005100         GO TO ACP-320.
005110     IF W-EC > 1
005120         GO TO ACP-320.
005130     IF (HSH-ENGP NOT = ZERO) OR (W-EC = 0)
005140         GO TO ACP-340.
005150*
005160     MOVE SPACE TO HSHN-KEY.
005170     MOVE W-RNO TO HSHN-RNO.
005180     START HSHNF KEY NOT < HSHN-KEY INVALID KEY
005190         MOVE "***  ﾆｭｳｺ ﾃﾞｰﾀ ﾅｼ  ***        " TO W-EM
005200         DISPLAY E-ME E-ME98
005210         GO TO ACP-320.
005220     READ HSHNF NEXT RECORD WITH UNLOCK AT END
005230         MOVE "***  ﾆｭｳｺ ﾃﾞｰﾀ ﾅｼ  ***        " TO W-EM
005240         DISPLAY E-ME E-ME98
005250         GO TO ACP-320.
005260     IF W-RNO NOT = HSHN-RNO
005270         MOVE "***  ﾆｭｳｺ ﾃﾞｰﾀ ﾅｼ  ***        " TO W-EM
005280         DISPLAY E-ME E-ME98
005290         GO TO ACP-320.
005300 ACP-340.
005310     ACCEPT A-DMM.
005320     IF ESTAT = BTB
005330         IF W-ACT = 3
005340             GO TO ACP-EX
005350           ELSE
005360             IF W-ACT = 1
005370                 GO TO ACP-280
005380               ELSE
005390                 GO TO ACP-320.
005400     IF ESTAT NOT = HTB AND SKP
005410         GO TO ACP-340.
005420     IF W-DMM = 9
005430         IF W-ACT NOT = 3
005440             GO TO ACP-070
005450           ELSE
005460             GO TO ACP-EX.
005470     IF W-DMM NOT = 1
005480         GO TO ACP-340.
005490*
005500     IF HSH-ENGP = ZERO
005510         IF W-EC = 1
005520             MOVE W-ENGP TO HSH-ENGP.
005530     IF HSH-ENGP NOT = ZERO
005540         IF W-EC = 0
005550             MOVE ZERO TO HSH-ENGP.
005560 ACP-EX.
005570     EXIT.
