000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. KBG930.
000030*******************************************************
000040*    PROGRAM        :  çwîÉåééüó›êœ                   *
000050*    PRINTER TYPE   :  ****                           *
000060*    SCREEN         :  ******                         *
000070*    COMPILE TYPE   :  COBOL                          *
000080*******************************************************
000090 ENVIRONMENT DIVISION.
000100 CONFIGURATION SECTION.
000110 SOURCE-COMPUTER. SYSTEM3100.
000120 OBJECT-COMPUTER. SYSTEM3100.
000130 INPUT-OUTPUT SECTION.
000140 FILE-CONTROL.
000150     COPY LIBCSE.
000160     SELECT S-M ASSIGN TO S-MSD
000170         ORGANIZATION INDEXED
000180         RECORD KEY S-KEY
000190         ACCESS MODE DYNAMIC
000200         FILE STATUS IS ERR-STAT.
000210     SELECT ST-M ASSIGN TO ST-MSD
000220         ORGANIZATION INDEXED
000230         RECORD KEY ST-KEY
000240         ACCESS MODE SEQUENTIAL
000250         FILE STATUS IS ERR-STAT.
000260     SELECT J-M ASSIGN TO J-MSD
000270         ORGANIZATION INDEXED
000280         RECORD KEY J-KEY
000290         ACCESS MODE DYNAMIC
000300         FILE STATUS IS ERR-STAT.
000310     SELECT JT-M ASSIGN TO JT-MSD
000320         ORGANIZATION INDEXED
000330         RECORD KEY JT-KEY
000340         ACCESS MODE SEQUENTIAL
000350         FILE STATUS IS ERR-STAT.
000360     SELECT JSSR-F ASSIGN TO JSSR-MSD.
000370     SELECT HAR-F ASSIGN TO HAR-MSD.
000380*
000390     SELECT SMYR ASSIGN TO SMY-MSD
000400         FILE STATUS IS ERR-STAT.
000410     SELECT STY-F ASSIGN TO STY-MSD
000420         FILE STATUS IS ERR-STAT.
000430     SELECT JMYR ASSIGN TO JMY-MSD
000440         FILE STATUS IS ERR-STAT.
000450     SELECT JTY-F ASSIGN TO JTY-MSD
000460         FILE STATUS IS ERR-STAT.
000470     SELECT JSSRYR ASSIGN TO JSSRYR-MSD
000480         FILE STATUS IS ERR-STAT.
000490     SELECT HARYR ASSIGN TO HARY-MSD
000500         FILE STATUS IS ERR-STAT.
000510*
000520     SELECT JSS-F ASSIGN TO JSS-MSD
000530         ORGANIZATION INDEXED
000540         ACCESS MODE SEQUENTIAL
000550         RECORD KEY JSS-KEY
000560         FILE STATUS IS ERR-STAT.
000570     SELECT HA-F ASSIGN TO HA-MSD
000580         ORGANIZATION INDEXED
000590         ACCESS MODE SEQUENTIAL
000600         RECORD KEY HA-KEY
000610         FILE STATUS IS ERR-STAT.
000620 I-O-CONTROL.
000630     APPLY SHARED-MODE ON S-M
000640     APPLY SHARED-MODE ON J-M
000650     APPLY SHARED-MODE ON M-DATE.
000660 DATA DIVISION.
000670 FILE SECTION.
000680     COPY LIBFDD.
000690     COPY LISM.
000700     COPY LIJM.
000710     COPY LIJTM.
000720     COPY LISTM.
000730 FD  JSSR-F
000740     BLOCK  5 RECORDS
000750     LABEL RECORD IS STANDARD
000760     VALUE OF IDENTIFICATION "JSSRF".
000770 01  JSSR-R.
000780     02  JS-DK          PIC  9(002).
000790     02  JS-SD          PIC  9(008).
000800     02  JS-SCD         PIC  9(004).
000810     02  JS-JCD         PIC  9(006).
000820     02  JS-SSU         PIC S9(007)V9(02).
000830     02  JS-TN          PIC S9(006)V9(02).
000840     02  JS-KIN         PIC S9(008).
000850     02  F              PIC  X(007).
000860     02  JS-CD          PIC  9(006).
000870     02  F              PIC  X(013).
000880     02  JS-YOC         PIC  9(001).
000890     02  JS-TNC         PIC  9(001).
000900     02  JS-SEC         PIC  9(001).
000910     02  JS-SC          PIC  9(001).
000920     02  F              PIC  X(027).
000930 FD  HAR-F
000940     BLOCK  8 RECORDS
000950     LABEL RECORD IS STANDARD
000960     VALUE OF IDENTIFICATION "HARF".
000970 01  HAR-R              PIC  X(032).
000980*
000990 FD  SMYR
001000     BLOCK  1 RECORDS
001010     LABEL RECORD IS STANDARD
001020     VALUE OF IDENTIFICATION "SMYR".
001030 01  SMY-R.
001040     02  SMY-KEY.                                                 ÇjÇdÇx
001050       03  SMY-TCD      PIC  9(004).                              édì¸êÊCD
001060     02  SMY-NAME       PIC  N(024).                              édì¸êÊñº
001070     02  SMY-JSU        PIC  N(024).                              èZèä(è„)
001080     02  SMY-JSS        PIC  N(012).                              èZèä(â∫)
001090     02  SMY-UNO        PIC  X(008).
001100     02  SMY-TEL        PIC  X(014).
001110     02  SMY-FAX        PIC  X(014).
001120     02  SMY-FKC        PIC  9(002).                              ï{åß∫∞ƒﬁ
001130     02  SMY-SZC        PIC  9(001).                              è¡îÔê≈C
001140     02  SMY-TTS        PIC  9(002).                              éxéËª≤ƒ
001150     02  SMY-THN        PIC  9(002).                              éxéË ì˙
001160     02  SMY-TMC        PIC  9(001).                              éxéËï°êî
001170     02  SMY-SKR        PIC  9(001).                              ëóã‡óøC
001180     02  SMY-PC         PIC  9(002).
001190     02  SMY-BKC        PIC  9(002).
001200     02  F              PIC  X(070).
001210     02  SMY-NG         PIC  9(006).
001220     02  SMY-ENG        PIC  9(004).
001230     02  SMY-KKC        PIC  9(001).                              îÉä|ãÊï™
001240     02  SMY-SFC        PIC  9(001).                              êUçûãÊï™
001250     02  SMY-TGC        PIC  9(001).                              éËå`ãÊï™
001260 FD  JMYR
001270     BLOCK  2 RECORDS
001280     LABEL RECORD IS STANDARD
001290     VALUE OF IDENTIFICATION "JMYR".
001300 01  JMY-R.
001310     02  JMY-JCD        PIC  9(006).                              çﬁóø∫∞ƒﬁ
001320     02  JMY-NAME       PIC  N(024).                              çﬁóøñº
001330     02  JMY-YC         PIC  9(001).                              ópìrãÊï™
001340     02  JMY-ZC         PIC  9(001).                              ç›å…ãÊï™
001350     02  JMY-SC         PIC  9(001).                              êªïiãÊï™
001360     02  JMY-TC1        PIC  9(001).                              íPà ãÊï™
001370     02  JMY-ST         PIC S9(006)V9(02).                        ç≈èIíPâø
001380     02  JMY-TC2        PIC  9(001).                              íPà ãÊï™
001390     02  JMY-YT         PIC S9(006)V9(02).                        ó\íËíPâø
001400     02  JMY-MCD        PIC  9(006).                              â¡çHëOCD
001410     02  JMY-KT         PIC  9(006)V9(02).                        â¡çHíPâø
001420     02  FILLER         PIC  X(022).                              FILLER
001430     02  JMY-BKC        PIC  9(002).                              ïîñÂä«óù
001440     02  F              PIC  X(003).                              FILLER
001450     02  JMY-NG         PIC  9(006).
001460     02  JMY-ED         PIC  9(006).                              ç≈èIì˙ït
001470 FD  STY-F
001480     BLOCK  3 RECORDS
001490     LABEL RECORD IS STANDARD
001500     VALUE OF IDENTIFICATION "STYF".
001510 01  STY-R.
001520     02  STY-KEY.
001530       03  STY-KEY1     PIC  9(001).
001540       03  STY-KEY2     PIC  9(003).
001550*****02  STY-ZKZ        PIC S9(008).                              D.120829
001560*****02  STY-ZKZZ       PIC S9(007).                              D.120829
001570*****02  STY-KZ         PIC S9(008).                              D.120829
001580*****02  STY-KZZ        PIC S9(007).                              D.120829
001590     02  STY-ZKZ        PIC S9(009).                              I.120829
001600     02  STY-ZKZZ       PIC S9(008).                              I.120829
001610     02  STY-KZ         PIC S9(009).                              I.120829
001620     02  STY-KZZ        PIC S9(008).                              I.120829
001630     02  STY-TSK        PIC S9(009).                              I.141122
001640     02  STY-TSKZ       PIC S9(008).                              I.141122
001650     02  STY-THK        PIC S9(009).                              I.141122
001660     02  STY-THKZ       PIC S9(008).                              I.141122
001670*****02  STY-TSK        PIC S9(008).                              D.141122
001680*****02  STY-TSKZ       PIC S9(007).                              D.141122
001690*****02  STY-THK        PIC S9(008).                              D.141122
001700*****02  STY-THKZ       PIC S9(007).                              D.141122
001710     02  STY-PC         PIC  9(004).
001720*****02  F              PIC  X(011).                              D.120829
001730*****02  F              PIC  X(007).                              D.141122
001740     02  F              PIC  X(003).                              I.141122
001750     02  STY-NG         PIC  9(006).
001760 FD  JTY-F
001770     BLOCK  3 RECORDS
001780     LABEL RECORD IS STANDARD
001790     VALUE OF IDENTIFICATION "JTYF".
001800 01  JTY-R.
001810     02  JTY-KEY.
001820       03  JTY-KEYD.
001830         04  JTY-BC     PIC  9(001).
001840         04  JTY-RC     PIC  9(002).
001850       03  JTY-JC       PIC  9(003).
001860     02  JTY-TSU        PIC S9(007)V9(02).
001870     02  JTY-SSU        PIC S9(007)V9(02).
001880     02  JTY-SIK        PIC S9(008).
001890     02  JTY-HSU        PIC S9(007)V9(02).
001900     02  JTY-ZKS        PIC S9(007)V9(02).
001910     02  JTY-ZKK        PIC S9(008).
001920     02  JTY-YC         PIC  9(001).
001930     02  JTY-ZC         PIC  9(001).
001940     02  JTY-SC         PIC  9(001).
001950     02  JTY-CSU        PIC S9(007)V9(02).
001960     02  F              PIC  X(009).
001970     02  JTY-NG         PIC  9(006).
001980 FD  JSSRYR
001990     BLOCK  5 RECORDS
002000     LABEL RECORD IS STANDARD
002010     VALUE OF IDENTIFICATION "JSSRYR".
002020 01  JSSRYR-R           PIC  X(102).
002030 FD  HARYR
002040     BLOCK  8 RECORDS
002050     LABEL RECORD IS STANDARD
002060     VALUE OF IDENTIFICATION "HARYR".
002070 01  HARYR-R            PIC  X(032).
002080*
002090 FD  JSS-F
002100     BLOCK  5 RECORDS
002110     LABEL RECORD IS STANDARD
002120     VALUE OF IDENTIFICATION "JSSF".
002130 01  JSS-R.
002140     02  F              PIC  X(094).
002150     02  JSS-KEY        PIC  X(007).
002160     02  F              PIC  X(001).
002170 FD  HA-F
002180     BLOCK  8 RECORDS
002190     LABEL RECORD IS STANDARD
002200     VALUE OF IDENTIFICATION "HAF".
002210 01  HA-R.
002220     02  F              PIC  X(023).
002230     02  HA-KEY         PIC  X(007).
002240     02  F              PIC  X(002).
002250 WORKING-STORAGE SECTION.
002260 77  W-FILE             PIC  X(013).
002270 01  W-DATA.
002280     02  W-NG           PIC  9(006).
002290     02  W-NGD   REDEFINES W-NG.
002300       03  W-NEN        PIC  9(004).
002310       03  W-NENL  REDEFINES W-NEN.
002320         04  W-NEN1     PIC  9(002).
002330         04  W-NEN2     PIC  9(002).
002340       03  W-GET        PIC  9(002).
002350     02  W-NGL   REDEFINES W-NG.
002360       03  F            PIC  9(002).
002370       03  W-NGS        PIC  9(004).
002380     02  W-DMM          PIC  9(001).
002390 01  ERR-STAT           PIC  X(002).
002400     COPY LSTAT.
002410 SCREEN SECTION.
002420 SD  C-CRT
002430     END STATUS IS ESTAT.
002440 01  C-CLEAR.
002450     02  C-CL    LINE   1  CLEAR SCREEN.
002460 01  C-MID.
002470     02  LINE   3  COLUMN  10  PIC  N(017) VALUE
002480          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002490     02  LINE   4  COLUMN  10  PIC  N(017) VALUE
002500          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002510     02  LINE   5  COLUMN  10  PIC  N(017) VALUE
002520          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".
002530     02  LINE   6  COLUMN  10  PIC  N(017) VALUE
002540          NC"ÅñÅñÅñÅ@Å@çwîÉÅ@åééüó›êœÅ@Å@ÅñÅñÅñ".
002550     02  LINE   7  COLUMN  10  PIC  N(017) VALUE
002560          NC"ÅñÅñÅñÅ@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ÅñÅñÅñ".
002570     02  LINE   8  COLUMN  10  PIC  N(017) VALUE
002580          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002590     02  LINE   9  COLUMN  10  PIC  N(017) VALUE
002600          NC"ÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñÅñ".
002610     02  LINE  12  COLUMN  18  PIC  X(018) VALUE
002620            "ÅmÅ@  îN  åéï™Å@Ån".
002630     02  LINE  20  COLUMN  16  PIC  X(022) VALUE
002640            "ämîF  OK=1 NO=9   ÿ¿∞›".
002650 01  C-ACP.
002660     02  A-DMM   LINE  20  COLUMN  33  PIC  9(001)
002670          USING W-DMM   CHECK OVERFLOW NO IFC.
002680 01  C-DSP.
002690     02  D-NG    LINE  12.
002700       03  COLUMN  22  PIC  9(002) FROM  W-NEN2.
002710       03  COLUMN  26  PIC Z9      FROM  W-GET.
002720 01  E-ERR.
002730     02  LINE  24.
002740       03  E-ME1   COLUMN  15  PIC  X(024) VALUE
002750            "***  SMYR WRITE ¥◊∞  ***".
002760       03  E-ME2   COLUMN  15  PIC  X(024) VALUE
002770            "***  JMYR WRITE ¥◊∞  ***".
002780       03  E-ME3   COLUMN  15  PIC  X(024) VALUE
002790            "***  STYF WRITE ¥◊∞  ***".
002800       03  E-ME4   COLUMN  15  PIC  X(024) VALUE
002810            "***  JTYF WRITE ¥◊∞  ***".
002820       03  E-ME5   COLUMN  15  PIC  X(026) VALUE
002830            "***  JSSRYR WRITE ¥◊∞  ***".
002840       03  E-ME6   COLUMN  15  PIC  X(025) VALUE
002850            "***  HARYR WRITE ¥◊∞  ***".
002860       03  E-ME7   COLUMN  15  PIC  N(008) VALUE
002870            NC"ñ¢çXêVÉfÅ[É^Ç†ÇË".
002880     COPY LSSEM.
002890     COPY LIBSCR.
002900 PROCEDURE DIVISION.
002910 M-05.
002920     DISPLAY C-CLEAR.
002930     DISPLAY C-MID.
002940     INITIALIZE W-DATA.
002950     COPY LIBCPR.
002960     MOVE D-NBNG TO W-NGS.
002970     IF W-NEN2 >= DATE-NF1 AND <= DATE-NT1
002980         ADD DATE-NC1 TO W-NEN.
002990     IF W-NEN2 >= DATE-NF2 AND <= DATE-NT2
003000         ADD DATE-NC2 TO W-NEN.
003010     DISPLAY D-NG.
003020     PERFORM CHK-RTN THRU CHK-EX.
003030     IF COMPLETION-CODE = 255
003040         GO TO M-95.
003050 M-10.
003060     ACCEPT A-DMM.
003070     IF ESTAT NOT = HTB AND SKP
003080         GO TO M-10.
003090     IF W-DMM = 9
003100         MOVE 255 TO COMPLETION-CODE
003110         GO TO M-95.
003120     IF W-DMM NOT = 1
003130         GO TO M-10.
003140*
003150     PERFORM SM-RTN THRU SM-EX.
003160     IF COMPLETION-CODE = 255
003170         GO TO M-95.
003180*
003190     PERFORM JM-RTN THRU JM-EX.
003200     IF COMPLETION-CODE = 255
003210         GO TO M-95.
003220*
003230     PERFORM STM-RTN THRU STM-EX.
003240     IF COMPLETION-CODE = 255
003250         GO TO M-95.
003260*
003270     PERFORM JTM-RTN THRU JTM-EX.
003280     IF COMPLETION-CODE = 255
003290         GO TO M-95.
003300*
003310     PERFORM JS-RTN THRU JS-EX.
003320     IF COMPLETION-CODE = 255
003330         GO TO M-95.
003340*
003350     PERFORM HA-RTN THRU HA-EX.
003360     IF COMPLETION-CODE = 255
003370         GO TO M-95.
003380 M-95.
003390     DISPLAY C-CLEAR.
003400     STOP RUN.
003410 CHK-RTN.
003420     OPEN INPUT JSS-F.
003430     READ JSS-F AT END
003440         GO TO CHK-010.
003450     CLOSE JSS-F.
003460     GO TO CHK-020.
003470 CHK-010.
003480     CLOSE JSS-F.
003490     OPEN INPUT HA-F.
003500     READ HA-F AT END
003510         GO TO CHK-030.
003520     CLOSE HA-F.
003530 CHK-020.
003540     MOVE 255 TO COMPLETION-CODE.
003550     DISPLAY E-ME7 E-ME99.
003560     GO TO CHK-EX.
003570 CHK-030.
003580     CLOSE HA-F.
003590 CHK-EX.
003600     EXIT.
003610*
003620 SM-RTN.
003630     OPEN INPUT S-M.
003640     OPEN EXTEND SMYR.
003650 SM-020.
003660     READ S-M NEXT RECORD AT END
003670         GO TO SM-060.
003680 SM-040.
003690     INITIALIZE SMY-R.
003700     MOVE S-R TO SMY-R.
003710     MOVE W-NG TO SMY-NG.
003720     WRITE SMY-R.
003730     IF ERR-STAT = "00"
003740         GO TO SM-020.
003750*
003760     DISPLAY E-STAT E-ME1 E-ME99.
003770     IF ERR-STAT = "34"
003780         DISPLAY E-CL
003790         CLOSE SMYR
003800         MOVE "SMYR         " TO W-FILE
003810         DISPLAY E-ME71 E-ME98 STOP " "
003820         DISPLAY E-CL
003830         OPEN EXTEND SMYR
003840         GO TO SM-040.
003850     MOVE 255 TO COMPLETION-CODE.
003860     DISPLAY E-ME78 E-ME99.
003870 SM-060.
003880     CLOSE S-M.
003890     CLOSE SMYR.
003900 SM-EX.
003910     EXIT.
003920*
003930 JM-RTN.
003940     OPEN INPUT J-M.
003950     OPEN EXTEND JMYR.
003960 JM-020.
003970     READ J-M NEXT RECORD AT END
003980         GO TO JM-060.
003990 JM-040.
004000     INITIALIZE JMY-R.
004010     MOVE J-R TO JMY-R.
004020     MOVE W-NG TO JMY-NG.
004030     WRITE JMY-R.
004040     IF ERR-STAT = "00"
004050         GO TO JM-020.
004060*
004070     DISPLAY E-STAT E-ME2 E-ME99.
004080     IF ERR-STAT = "34"
004090         DISPLAY E-CL
004100         CLOSE JMYR
004110         MOVE "JMYR         " TO W-FILE
004120         DISPLAY E-ME71 E-ME98 STOP " "
004130         DISPLAY E-CL
004140         OPEN EXTEND JMYR
004150         GO TO JM-040.
004160     MOVE 255 TO COMPLETION-CODE.
004170     DISPLAY E-ME78 E-ME99.
004180 JM-060.
004190     CLOSE J-M.
004200     CLOSE JMYR.
004210 JM-EX.
004220     EXIT.
004230*
004240 STM-RTN.
004250     OPEN INPUT ST-M.
004260     OPEN EXTEND STY-F.
004270 STM-020.
004280     READ ST-M NEXT RECORD AT END
004290         GO TO STM-060.
004300 STM-040.
004310     INITIALIZE STY-R.
004320     MOVE ST-R TO STY-R.
004330     MOVE W-NG TO STY-NG.
004340     WRITE STY-R.
004350     IF ERR-STAT = "00"
004360         GO TO STM-020.
004370*
004380     DISPLAY E-STAT E-ME3 E-ME99.
004390     IF ERR-STAT = "34"
004400         DISPLAY E-CL
004410         CLOSE STY-F
004420         MOVE "STYF         " TO W-FILE
004430         DISPLAY E-ME71 E-ME98 STOP " "
004440         DISPLAY E-CL
004450         OPEN EXTEND STY-F
004460         GO TO STM-040.
004470     MOVE 255 TO COMPLETION-CODE.
004480     DISPLAY E-ME78 E-ME99.
004490 STM-060.
004500     CLOSE ST-M.
004510     CLOSE STY-F.
004520 STM-EX.
004530     EXIT.
004540*
004550 JTM-RTN.
004560     OPEN INPUT JT-M.
004570     OPEN EXTEND JTY-F.
004580 JTM-020.
004590     READ JT-M NEXT RECORD AT END
004600         GO TO JTM-060.
004610 JTM-040.
004620     INITIALIZE JTY-R.
004630     MOVE JT-R TO JTY-R.
004640     MOVE W-NG TO JTY-NG.
004650     WRITE JTY-R.
004660     IF ERR-STAT = "00"
004670         GO TO JTM-020.
004680*
004690     DISPLAY E-STAT E-ME4 E-ME99.
004700     IF ERR-STAT = "34"
004710         DISPLAY E-CL
004720         CLOSE JTY-F
004730         MOVE "JTYF         " TO W-FILE
004740         DISPLAY E-ME71 E-ME98 STOP " "
004750         DISPLAY E-CL
004760         OPEN EXTEND JTY-F
004770         GO TO JTM-040.
004780     MOVE 255 TO COMPLETION-CODE.
004790     DISPLAY E-ME78 E-ME99.
004800 JTM-060.
004810     CLOSE JT-M.
004820     CLOSE JTY-F.
004830 JTM-EX.
004840     EXIT.
004850*
004860 JS-RTN.
004870     OPEN INPUT JSSR-F.
004880     OPEN EXTEND JSSRYR.
004890 JS-020.
004900     READ JSSR-F NEXT RECORD AT END
004910         GO TO JS-060.
004920     DISPLAY E-CL.
004930 JS-040.
004940     MOVE ZERO TO JSSRYR-R.
004950     MOVE JSSR-R TO JSSRYR-R.
004960     WRITE JSSRYR-R.
004970     IF ERR-STAT = "00"
004980         GO TO JS-020.
004990*
005000     DISPLAY E-STAT E-ME5 E-ME99.
005010     IF ERR-STAT = "34"
005020         DISPLAY E-CL
005030         CLOSE JSSRYR
005040         MOVE "JSSRYR       " TO W-FILE
005050         DISPLAY E-ME71 E-ME98 STOP " "
005060         DISPLAY E-CL
005070         OPEN EXTEND JSSRYR
005080         GO TO JS-040.
005090     MOVE 255 TO COMPLETION-CODE.
005100     DISPLAY E-ME78 E-ME99.
005110 JS-060.
005120     CLOSE JSSR-F.
005130     CLOSE JSSRYR.
005140 JS-EX.
005150     EXIT.
005160*
005170 HA-RTN.
005180     OPEN INPUT HAR-F.
005190     OPEN EXTEND HARYR.
005200 HA-020.
005210     READ HAR-F NEXT RECORD AT END
005220         GO TO HA-060.
005230     DISPLAY E-CL.
005240 HA-040.
005250     MOVE ZERO TO HARYR-R.
005260     MOVE HAR-R TO HARYR-R.
005270     WRITE HARYR-R.
005280     IF ERR-STAT = "00"
005290         GO TO HA-020.
005300*
005310     DISPLAY E-STAT E-ME6 E-ME99.
005320     IF ERR-STAT = "34"
005330         DISPLAY E-CL
005340         CLOSE HARYR
005350         MOVE "HARYR        " TO W-FILE
005360         DISPLAY E-ME71 E-ME98 STOP " "
005370         DISPLAY E-CL
005380         OPEN EXTEND HARYR
005390         GO TO HA-040.
005400     MOVE 255 TO COMPLETION-CODE.
005410     DISPLAY E-ME78 E-ME99.
005420 HA-060.
005430     CLOSE HAR-F.
005440     CLOSE HARYR.
005450 HA-EX.
005460     EXIT.
