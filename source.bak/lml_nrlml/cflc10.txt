000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. CFLC10.
000030*************************************************************
000040**   ä»à’ïœä∑èàóù                                          **
000050**    #FLCNVãNìÆ (CBLRUN)                                  **
000060*************************************************************
000070 ENVIRONMENT DIVISION.
000080 CONFIGURATION SECTION.
000090 SOURCE-COMPUTER. SYSTEM7200.
000100 OBJECT-COMPUTER. SYSTEM7200.
000110 INPUT-OUTPUT SECTION.
000120 FILE-CONTROL.
000130 DATA DIVISION.
000140 FILE SECTION.
000150 WORKING-STORAGE SECTION.
000160 01  ERR-STAT           PIC  X(002).
000170 01  STN-NO.
000180     03  STN-NO-1       PIC  X(003) VALUE SPACE.
000190     03  STN-NO-2       PIC  9(003) VALUE ZERO.
000200 01  W-DATA.
000210     02  HIZUKE.
000220       03  YY           PIC  9(002) VALUE ZERO.
000230       03  MM           PIC  9(002) VALUE ZERO.
000240       03  DD           PIC  9(002) VALUE ZERO.
000250     02  K-MSG          PIC  X(040) VALUE SPACE.
000260     02  W-KBN          PIC  9(002) VALUE ZERO.
000270     02  W-FID1.
000280       03  W-FID11      PIC  X(006) VALUE SPACE.
000290       03  W-FID12      PIC  9(003).
000300       03  W-FID13      PIC  X(003) VALUE SPACE.
000310     02  W-FID2.
000320       03  W-FID21      PIC  X(006) VALUE SPACE.
000330       03  W-FID22      PIC  9(003).
000340       03  W-FID23      PIC  X(003) VALUE SPACE.
000350     02  I-ID           PIC  X(012) VALUE SPACE.
000360     02  O-ID           PIC  X(012) VALUE SPACE.
000370     02  FLCIFO         PIC  X(003) VALUE SPACE.
000380     02  FLCMOD         PIC  X(003) VALUE SPACE.
000390     02  FLCOUT1        PIC  X(072) VALUE SPACE.
000400     02  FLCOUT2        PIC  X(072) VALUE SPACE.
000410     02  FLCOUT3        PIC  X(072) VALUE SPACE.
000420     02  FLCOUT4        PIC  X(007) VALUE SPACE.
000430     02  FLCSEL1        PIC  X(072) VALUE SPACE.
000440     02  FLCSEL2        PIC  X(048) VALUE SPACE.
000450*
000460*****Å@éwíËÅ@Å@Å@Å@Å@      Å®  ÉèÅ[ÉN(ÇrÇsÇmëŒâû)    W-KBN = 01
000470*****Å@ÉèÅ[ÉN(ÇrÇsÇmëŒâû)  Å®  éwíË                  W-KBN = 10
000480*****Å@ÉèÅ[ÉN(ÇrÇsÇmëŒâû)  Å®  ÉèÅ[ÉN(ÇrÇsÇmëŒâû)    W-KBN = 11
000490 01  AFLCNV-PAR.
000500     03  F              PIC  X(007) VALUE "#FLCNV;".
000510     03  F              PIC  X(017) VALUE
000520          "IDE=MSD_ICI=_IFI=".
000530     03  A-I-ID         PIC  X(012) VALUE SPACE.
000540     03  F              PIC  X(010) VALUE
000550          "_IGN=_IFO=".
000560     03  A-FLCIFO       PIC  X(003) VALUE SPACE.
000570     03  F              PIC  X(018) VALUE
000580          "_ODE=MSD_OCI=_OFI=".
000590     03  A-O-ID         PIC  X(012) VALUE SPACE.
000600     03  F              PIC  X(025) VALUE
000610          "_OGN=_LST=NO_ERR=ABO_MOD=".
000620     03  A-FLCMOD       PIC  X(003) VALUE SPACE.
000630     03  F              PIC  X(039) VALUE
000640          "_AMD=LOG_UMD=NO_GTR=_DEL=NO_CLR=NO_OUT=".
000650     03  A-FLCOUT1      PIC  X(072) VALUE SPACE.
000660     03  A-FLCOUT2      PIC  X(072) VALUE SPACE.
000670     03  A-FLCOUT3      PIC  X(072) VALUE SPACE.
000680     03  A-FLCOUT4      PIC  X(007) VALUE SPACE.
000690     03  F              PIC  X(010) VALUE "_RNG=_SEL=".
000700     03  A-FLCSEL1      PIC  X(072) VALUE SPACE.
000710     03  A-FLCSEL2      PIC  X(048) VALUE SPACE.
000720     03  F              PIC  X(011) VALUE "_SAV=_NXT=_".
000730     03  F              PIC  X(002) VALUE "/>".
000740 01  PAR-SIZ.
000750     03  PAR-SIZ01      PIC  9(004) VALUE 512.
000760 SCREEN SECTION.
000770 SD  C-CRT
000780     END  STATUS    ESTS.
000790 01  C-MID1    CLEAR    SCREEN.
000800     02  LINE  01.
000810       03  COLUMN  20  PIC  X(040) FROM  K-MSG  REVERSE.
000820       03  COLUMN  68  PIC  X(011) VALUE "DATE.  /  /".
000830       03  COLUMN  73  PIC  9(002) FROM  YY.
000840       03  COLUMN  76  PIC  9(002) FROM  MM.
000850       03  COLUMN  79  PIC  9(002) FROM  DD.
000860 01  C-MID2.
000870     03  LINE  12  COLUMN  25  VALUE "*************************".
000880     03  LINE  13  COLUMN  25  VALUE "**                     **".
000890     03  LINE  13  COLUMN  27  VALUE   "  ïœä∑èàóùÅ@é¿çsíÜ".
000900     03  LINE  14  COLUMN  25  VALUE "*************************".
000910 01  C-ERR.
000920     02  LINE  24.
000930       03  E-ME98  COLUMN  75  PIC  X(005) VALUE ""27"J"05"".
000940       03  E-ME99  COLUMN  75  PIC  X(005) VALUE ""27"B"05"".
000950 PROCEDURE                   DIVISION.
000960 M-05.
000970     CALL "CBLSTNNO" USING STN-NO.
000980     MOVE STN-NO-2 TO W-FID12 W-FID22.
000990     ACCEPT HIZUKE FROM DATE.
001000*
001010     ACCEPT W-KBN.
001020     IF W-KBN NOT = 01 AND 10 AND 11
001030         MOVE 255 TO COMPLETION-CODE
001040         STOP RUN.
001050*
001060     IF W-KBN = 01
001070         ACCEPT I-ID.
001080     IF W-KBN = 10 OR 11
001090         ACCEPT W-FID11
001100         MOVE W-FID1 TO I-ID.
001110     IF I-ID = SPACE
001120         MOVE 255 TO COMPLETION-CODE
001130         STOP RUN.
001140*
001150     ACCEPT FLCIFO.
001160     IF FLCIFO NOT = "PRO" AND "SHA"
001170         MOVE 255 TO COMPLETION-CODE
001180         STOP RUN.
001190*
001200     IF W-KBN = 01 OR 11
001210         ACCEPT W-FID21
001220         MOVE W-FID2 TO O-ID.
001230     IF W-KBN = 10
001240         ACCEPT O-ID.
001250     IF O-ID = SPACE
001260         MOVE 255 TO COMPLETION-CODE
001270         STOP RUN.
001280*
001290     ACCEPT FLCMOD.
001300     IF FLCMOD NOT = "ADD" AND "CRE"
001310         MOVE 255 TO COMPLETION-CODE
001320         STOP RUN.
001330*
001340     ACCEPT FLCOUT1.
001350     ACCEPT FLCOUT2.
001360     ACCEPT FLCOUT3.
001370     ACCEPT FLCOUT4.
001380*
001390     ACCEPT FLCSEL1.
001400     ACCEPT FLCSEL2.
001410*
001420     ACCEPT K-MSG.
001430*
001440     DISPLAY C-MID1.
001450     DISPLAY C-MID2.
001460*
001470     MOVE I-ID TO A-I-ID.
001480     MOVE FLCIFO TO A-FLCIFO.
001490     MOVE O-ID TO A-O-ID.
001500     MOVE FLCMOD TO A-FLCMOD.
001510     MOVE FLCOUT1 TO A-FLCOUT1.
001520     MOVE FLCOUT2 TO A-FLCOUT2.
001530     MOVE FLCOUT3 TO A-FLCOUT3.
001540     MOVE FLCOUT4 TO A-FLCOUT4.
001550     MOVE FLCSEL1 TO A-FLCSEL1.
001560     MOVE FLCSEL2 TO A-FLCSEL2.
001570     CALL "CBLRUN" USING AFLCNV-PAR PAR-SIZ.
001580     STOP RUN.
